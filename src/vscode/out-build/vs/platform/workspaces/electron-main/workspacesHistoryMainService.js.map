{"version":3,"sources":["vs/platform/workspaces/electron-main/workspacesHistoryMainService.ts"],"names":[],"mappings":"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","file":"workspacesHistoryMainService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { app, JumpListCategory, JumpListItem } from 'electron';\nimport { coalesce } from '../../../base/common/arrays.js';\nimport { ThrottledDelayer } from '../../../base/common/async.js';\nimport { Emitter, Event as CommonEvent } from '../../../base/common/event.js';\nimport { normalizeDriveLetter, splitRecentLabel } from '../../../base/common/labels.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { isMacintosh, isWindows } from '../../../base/common/platform.js';\nimport { basename, extUriBiasedIgnorePathCase, originalFSPath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { Promises } from '../../../base/node/pfs.js';\nimport { localize } from '../../../nls.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { ILifecycleMainService, LifecycleMainPhase } from '../../lifecycle/electron-main/lifecycleMainService.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { StorageScope, StorageTarget } from '../../storage/common/storage.js';\nimport { IApplicationStorageMainService } from '../../storage/electron-main/storageMainService.js';\nimport { IRecent, IRecentFile, IRecentFolder, IRecentlyOpened, IRecentWorkspace, isRecentFile, isRecentFolder, isRecentWorkspace, restoreRecentlyOpened, toStoreData } from '../common/workspaces.js';\nimport { IWorkspaceIdentifier, WORKSPACE_EXTENSION } from '../../workspace/common/workspace.js';\nimport { IWorkspacesManagementMainService } from './workspacesManagementMainService.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { IDialogMainService } from '../../dialogs/electron-main/dialogMainService.js';\n\nexport const IWorkspacesHistoryMainService = createDecorator<IWorkspacesHistoryMainService>('workspacesHistoryMainService');\n\nexport interface IWorkspacesHistoryMainService {\n\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidChangeRecentlyOpened: CommonEvent<void>;\n\n\taddRecentlyOpened(recents: IRecent[]): Promise<void>;\n\tgetRecentlyOpened(): Promise<IRecentlyOpened>;\n\tremoveRecentlyOpened(paths: URI[]): Promise<void>;\n\tclearRecentlyOpened(options?: { confirm?: boolean }): Promise<void>;\n}\n\nexport class WorkspacesHistoryMainService extends Disposable implements IWorkspacesHistoryMainService {\n\n\tprivate static readonly MAX_TOTAL_RECENT_ENTRIES = 500;\n\n\tprivate static readonly RECENTLY_OPENED_STORAGE_KEY = 'history.recentlyOpenedPathsList';\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeRecentlyOpened = this._register(new Emitter<void>());\n\treadonly onDidChangeRecentlyOpened = this._onDidChangeRecentlyOpened.event;\n\n\tconstructor(\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IWorkspacesManagementMainService private readonly workspacesManagementMainService: IWorkspacesManagementMainService,\n\t\t@ILifecycleMainService private readonly lifecycleMainService: ILifecycleMainService,\n\t\t@IApplicationStorageMainService private readonly applicationStorageMainService: IApplicationStorageMainService,\n\t\t@IDialogMainService private readonly dialogMainService: IDialogMainService\n\t) {\n\t\tsuper();\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Install window jump list delayed after opening window\n\t\t// because perf measurements have shown this to be slow\n\t\tthis.lifecycleMainService.when(LifecycleMainPhase.Eventually).then(() => this.handleWindowsJumpList());\n\n\t\t// Add to history when entering workspace\n\t\tthis._register(this.workspacesManagementMainService.onDidEnterWorkspace(event => this.addRecentlyOpened([{ workspace: event.workspace, remoteAuthority: event.window.remoteAuthority }])));\n\t}\n\n\t//#region Workspaces History\n\n\tasync addRecentlyOpened(recentToAdd: IRecent[]): Promise<void> {\n\t\tlet workspaces: Array<IRecentFolder | IRecentWorkspace> = [];\n\t\tlet files: IRecentFile[] = [];\n\n\t\tfor (const recent of recentToAdd) {\n\n\t\t\t// Workspace\n\t\t\tif (isRecentWorkspace(recent)) {\n\t\t\t\tif (!this.workspacesManagementMainService.isUntitledWorkspace(recent.workspace) && !this.containsWorkspace(workspaces, recent.workspace)) {\n\t\t\t\t\tworkspaces.push(recent);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Folder\n\t\t\telse if (isRecentFolder(recent)) {\n\t\t\t\tif (!this.containsFolder(workspaces, recent.folderUri)) {\n\t\t\t\t\tworkspaces.push(recent);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// File\n\t\t\telse {\n\t\t\t\tconst alreadyExistsInHistory = this.containsFile(files, recent.fileUri);\n\t\t\t\tconst shouldBeFiltered = recent.fileUri.scheme === Schemas.file && WorkspacesHistoryMainService.COMMON_FILES_FILTER.indexOf(basename(recent.fileUri)) >= 0;\n\n\t\t\t\tif (!alreadyExistsInHistory && !shouldBeFiltered) {\n\t\t\t\t\tfiles.push(recent);\n\n\t\t\t\t\t// Add to recent documents (Windows only, macOS later)\n\t\t\t\t\tif (isWindows && recent.fileUri.scheme === Schemas.file) {\n\t\t\t\t\t\tapp.addRecentDocument(recent.fileUri.fsPath);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst mergedEntries = await this.mergeEntriesFromStorage({ workspaces, files });\n\t\tworkspaces = mergedEntries.workspaces;\n\t\tfiles = mergedEntries.files;\n\n\t\tif (workspaces.length > WorkspacesHistoryMainService.MAX_TOTAL_RECENT_ENTRIES) {\n\t\t\tworkspaces.length = WorkspacesHistoryMainService.MAX_TOTAL_RECENT_ENTRIES;\n\t\t}\n\n\t\tif (files.length > WorkspacesHistoryMainService.MAX_TOTAL_RECENT_ENTRIES) {\n\t\t\tfiles.length = WorkspacesHistoryMainService.MAX_TOTAL_RECENT_ENTRIES;\n\t\t}\n\n\t\tawait this.saveRecentlyOpened({ workspaces, files });\n\t\tthis._onDidChangeRecentlyOpened.fire();\n\n\t\t// Schedule update to recent documents on macOS dock\n\t\tif (isMacintosh) {\n\t\t\tthis.macOSRecentDocumentsUpdater.trigger(() => this.updateMacOSRecentDocuments());\n\t\t}\n\t}\n\n\tasync removeRecentlyOpened(recentToRemove: URI[]): Promise<void> {\n\t\tconst keep = (recent: IRecent) => {\n\t\t\tconst uri = this.location(recent);\n\t\t\tfor (const resourceToRemove of recentToRemove) {\n\t\t\t\tif (extUriBiasedIgnorePathCase.isEqual(resourceToRemove, uri)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t};\n\n\t\tconst mru = await this.getRecentlyOpened();\n\t\tconst workspaces = mru.workspaces.filter(keep);\n\t\tconst files = mru.files.filter(keep);\n\n\t\tif (workspaces.length !== mru.workspaces.length || files.length !== mru.files.length) {\n\t\t\tawait this.saveRecentlyOpened({ files, workspaces });\n\t\t\tthis._onDidChangeRecentlyOpened.fire();\n\n\t\t\t// Schedule update to recent documents on macOS dock\n\t\t\tif (isMacintosh) {\n\t\t\t\tthis.macOSRecentDocumentsUpdater.trigger(() => this.updateMacOSRecentDocuments());\n\t\t\t}\n\t\t}\n\t}\n\n\tasync clearRecentlyOpened(options?: { confirm?: boolean }): Promise<void> {\n\t\tif (options?.confirm) {\n\t\t\tconst { response } = await this.dialogMainService.showMessageBox({\n\t\t\t\ttype: 'warning',\n\t\t\t\tbuttons: [\n\t\t\t\t\tlocalize({ key: 'clearButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Clear\"),\n\t\t\t\t\tlocalize({ key: 'cancel', comment: ['&& denotes a mnemonic'] }, \"&&Cancel\")\n\t\t\t\t],\n\t\t\t\tmessage: localize('confirmClearRecentsMessage', \"Do you want to clear all recently opened files and workspaces?\"),\n\t\t\t\tdetail: localize('confirmClearDetail', \"This action is irreversible!\"),\n\t\t\t\tcancelId: 1\n\t\t\t});\n\n\t\t\tif (response !== 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tawait this.saveRecentlyOpened({ workspaces: [], files: [] });\n\t\tapp.clearRecentDocuments();\n\n\t\t// Event\n\t\tthis._onDidChangeRecentlyOpened.fire();\n\t}\n\n\tasync getRecentlyOpened(): Promise<IRecentlyOpened> {\n\t\treturn this.mergeEntriesFromStorage();\n\t}\n\n\tprivate async mergeEntriesFromStorage(existingEntries?: IRecentlyOpened): Promise<IRecentlyOpened> {\n\n\t\t// Build maps for more efficient lookup of existing entries that\n\t\t// are passed in by storing based on workspace/file identifier\n\n\t\tconst mapWorkspaceIdToWorkspace = new ResourceMap<IRecentFolder | IRecentWorkspace>(uri => extUriBiasedIgnorePathCase.getComparisonKey(uri));\n\t\tif (existingEntries?.workspaces) {\n\t\t\tfor (const workspace of existingEntries.workspaces) {\n\t\t\t\tmapWorkspaceIdToWorkspace.set(this.location(workspace), workspace);\n\t\t\t}\n\t\t}\n\n\t\tconst mapFileIdToFile = new ResourceMap<IRecentFile>(uri => extUriBiasedIgnorePathCase.getComparisonKey(uri));\n\t\tif (existingEntries?.files) {\n\t\t\tfor (const file of existingEntries.files) {\n\t\t\t\tmapFileIdToFile.set(this.location(file), file);\n\t\t\t}\n\t\t}\n\n\t\t// Merge in entries from storage, preserving existing known entries\n\n\t\tconst recentFromStorage = await this.getRecentlyOpenedFromStorage();\n\t\tfor (const recentWorkspaceFromStorage of recentFromStorage.workspaces) {\n\t\t\tconst existingRecentWorkspace = mapWorkspaceIdToWorkspace.get(this.location(recentWorkspaceFromStorage));\n\t\t\tif (existingRecentWorkspace) {\n\t\t\t\texistingRecentWorkspace.label = existingRecentWorkspace.label ?? recentWorkspaceFromStorage.label;\n\t\t\t} else {\n\t\t\t\tmapWorkspaceIdToWorkspace.set(this.location(recentWorkspaceFromStorage), recentWorkspaceFromStorage);\n\t\t\t}\n\t\t}\n\n\t\tfor (const recentFileFromStorage of recentFromStorage.files) {\n\t\t\tconst existingRecentFile = mapFileIdToFile.get(this.location(recentFileFromStorage));\n\t\t\tif (existingRecentFile) {\n\t\t\t\texistingRecentFile.label = existingRecentFile.label ?? recentFileFromStorage.label;\n\t\t\t} else {\n\t\t\t\tmapFileIdToFile.set(this.location(recentFileFromStorage), recentFileFromStorage);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tworkspaces: [...mapWorkspaceIdToWorkspace.values()],\n\t\t\tfiles: [...mapFileIdToFile.values()]\n\t\t};\n\t}\n\n\tprivate async getRecentlyOpenedFromStorage(): Promise<IRecentlyOpened> {\n\n\t\t// Wait for global storage to be ready\n\t\tawait this.applicationStorageMainService.whenReady;\n\n\t\tlet storedRecentlyOpened: object | undefined = undefined;\n\n\t\t// First try with storage service\n\t\tconst storedRecentlyOpenedRaw = this.applicationStorageMainService.get(WorkspacesHistoryMainService.RECENTLY_OPENED_STORAGE_KEY, StorageScope.APPLICATION);\n\t\tif (typeof storedRecentlyOpenedRaw === 'string') {\n\t\t\ttry {\n\t\t\t\tstoredRecentlyOpened = JSON.parse(storedRecentlyOpenedRaw);\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error('Unexpected error parsing opened paths list', error);\n\t\t\t}\n\t\t}\n\n\t\treturn restoreRecentlyOpened(storedRecentlyOpened, this.logService);\n\t}\n\n\tprivate async saveRecentlyOpened(recent: IRecentlyOpened): Promise<void> {\n\n\t\t// Wait for global storage to be ready\n\t\tawait this.applicationStorageMainService.whenReady;\n\n\t\t// Store in global storage (but do not sync since this is mainly local paths)\n\t\tthis.applicationStorageMainService.store(WorkspacesHistoryMainService.RECENTLY_OPENED_STORAGE_KEY, JSON.stringify(toStoreData(recent)), StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t}\n\n\tprivate location(recent: IRecent): URI {\n\t\tif (isRecentFolder(recent)) {\n\t\t\treturn recent.folderUri;\n\t\t}\n\n\t\tif (isRecentFile(recent)) {\n\t\t\treturn recent.fileUri;\n\t\t}\n\n\t\treturn recent.workspace.configPath;\n\t}\n\n\tprivate containsWorkspace(recents: IRecent[], candidate: IWorkspaceIdentifier): boolean {\n\t\treturn !!recents.find(recent => isRecentWorkspace(recent) && recent.workspace.id === candidate.id);\n\t}\n\n\tprivate containsFolder(recents: IRecent[], candidate: URI): boolean {\n\t\treturn !!recents.find(recent => isRecentFolder(recent) && extUriBiasedIgnorePathCase.isEqual(recent.folderUri, candidate));\n\t}\n\n\tprivate containsFile(recents: IRecentFile[], candidate: URI): boolean {\n\t\treturn !!recents.find(recent => extUriBiasedIgnorePathCase.isEqual(recent.fileUri, candidate));\n\t}\n\n\t//#endregion\n\n\n\t//#region macOS Dock / Windows JumpList\n\n\tprivate static readonly MAX_MACOS_DOCK_RECENT_WORKSPACES = 7; \t\t// prefer higher number of workspaces...\n\tprivate static readonly MAX_MACOS_DOCK_RECENT_ENTRIES_TOTAL = 10; \t// ...over number of files\n\n\tprivate static readonly MAX_WINDOWS_JUMP_LIST_ENTRIES = 7;\n\n\t// Exclude some very common files from the dock/taskbar\n\tprivate static readonly COMMON_FILES_FILTER = [\n\t\t'COMMIT_EDITMSG',\n\t\t'MERGE_MSG',\n\t\t'git-rebase-todo'\n\t];\n\n\tprivate readonly macOSRecentDocumentsUpdater = this._register(new ThrottledDelayer<void>(800));\n\n\tprivate async handleWindowsJumpList(): Promise<void> {\n\t\tif (!isWindows) {\n\t\t\treturn; // only on windows\n\t\t}\n\n\t\tawait this.updateWindowsJumpList();\n\t\tthis._register(this.onDidChangeRecentlyOpened(() => this.updateWindowsJumpList()));\n\t}\n\n\tprivate async updateWindowsJumpList(): Promise<void> {\n\t\tif (!isWindows) {\n\t\t\treturn; // only on windows\n\t\t}\n\n\t\tconst jumpList: JumpListCategory[] = [];\n\n\t\t// Tasks\n\t\tjumpList.push({\n\t\t\ttype: 'tasks',\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'task',\n\t\t\t\t\ttitle: localize('newWindow', \"New Window\"),\n\t\t\t\t\tdescription: localize('newWindowDesc', \"Opens a new window\"),\n\t\t\t\t\tprogram: process.execPath,\n\t\t\t\t\targs: '-n', // force new window\n\t\t\t\t\ticonPath: process.execPath,\n\t\t\t\t\ticonIndex: 0\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\t// Recent Workspaces\n\t\tif ((await this.getRecentlyOpened()).workspaces.length > 0) {\n\n\t\t\t// The user might have meanwhile removed items from the jump list and we have to respect that\n\t\t\t// so we need to update our list of recent paths with the choice of the user to not add them again\n\t\t\t// Also: Windows will not show our custom category at all if there is any entry which was removed\n\t\t\t// by the user! See https://github.com/microsoft/vscode/issues/15052\n\t\t\tconst toRemove: URI[] = [];\n\t\t\tfor (const item of app.getJumpListSettings().removedItems) {\n\t\t\t\tconst args = item.args;\n\t\t\t\tif (args) {\n\t\t\t\t\tconst match = /^--(folder|file)-uri\\s+\"([^\"]+)\"$/.exec(args);\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\ttoRemove.push(URI.parse(match[2]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait this.removeRecentlyOpened(toRemove);\n\n\t\t\t// Add entries\n\t\t\tlet hasWorkspaces = false;\n\t\t\tconst items: JumpListItem[] = coalesce((await this.getRecentlyOpened()).workspaces.slice(0, WorkspacesHistoryMainService.MAX_WINDOWS_JUMP_LIST_ENTRIES).map(recent => {\n\t\t\t\tconst workspace = isRecentWorkspace(recent) ? recent.workspace : recent.folderUri;\n\n\t\t\t\tconst { title, description } = this.getWindowsJumpListLabel(workspace, recent.label);\n\t\t\t\tlet args;\n\t\t\t\tif (URI.isUri(workspace)) {\n\t\t\t\t\targs = `--folder-uri \"${workspace.toString()}\"`;\n\t\t\t\t} else {\n\t\t\t\t\thasWorkspaces = true;\n\t\t\t\t\targs = `--file-uri \"${workspace.configPath.toString()}\"`;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'task',\n\t\t\t\t\ttitle: title.substr(0, 255), \t\t\t\t// Windows seems to be picky around the length of entries\n\t\t\t\t\tdescription: description.substr(0, 255),\t// (see https://github.com/microsoft/vscode/issues/111177)\n\t\t\t\t\tprogram: process.execPath,\n\t\t\t\t\targs,\n\t\t\t\t\ticonPath: 'explorer.exe', // simulate folder icon\n\t\t\t\t\ticonIndex: 0\n\t\t\t\t};\n\t\t\t}));\n\n\t\t\tif (items.length > 0) {\n\t\t\t\tjumpList.push({\n\t\t\t\t\ttype: 'custom',\n\t\t\t\t\tname: hasWorkspaces ? localize('recentFoldersAndWorkspaces', \"Recent Folders & Workspaces\") : localize('recentFolders', \"Recent Folders\"),\n\t\t\t\t\titems\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Recent\n\t\tjumpList.push({\n\t\t\ttype: 'recent' // this enables to show files in the \"recent\" category\n\t\t});\n\n\t\ttry {\n\t\t\tconst res = app.setJumpList(jumpList);\n\t\t\tif (res && res !== 'ok') {\n\t\t\t\tthis.logService.warn(`updateWindowsJumpList#setJumpList unexpected result: ${res}`);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.logService.warn('updateWindowsJumpList#setJumpList', error); // since setJumpList is relatively new API, make sure to guard for errors\n\t\t}\n\t}\n\n\tprivate getWindowsJumpListLabel(workspace: IWorkspaceIdentifier | URI, recentLabel: string | undefined): { title: string; description: string } {\n\n\t\t// Prefer recent label\n\t\tif (recentLabel) {\n\t\t\treturn { title: splitRecentLabel(recentLabel).name, description: recentLabel };\n\t\t}\n\n\t\t// Single Folder\n\t\tif (URI.isUri(workspace)) {\n\t\t\treturn { title: basename(workspace), description: this.renderJumpListPathDescription(workspace) };\n\t\t}\n\n\t\t// Workspace: Untitled\n\t\tif (this.workspacesManagementMainService.isUntitledWorkspace(workspace)) {\n\t\t\treturn { title: localize('untitledWorkspace', \"Untitled (Workspace)\"), description: '' };\n\t\t}\n\n\t\t// Workspace: normal\n\t\tlet filename = basename(workspace.configPath);\n\t\tif (filename.endsWith(WORKSPACE_EXTENSION)) {\n\t\t\tfilename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n\t\t}\n\n\t\treturn { title: localize('workspaceName', \"{0} (Workspace)\", filename), description: this.renderJumpListPathDescription(workspace.configPath) };\n\t}\n\n\tprivate renderJumpListPathDescription(uri: URI) {\n\t\treturn uri.scheme === 'file' ? normalizeDriveLetter(uri.fsPath) : uri.toString();\n\t}\n\n\tprivate async updateMacOSRecentDocuments(): Promise<void> {\n\t\tif (!isMacintosh) {\n\t\t\treturn;\n\t\t}\n\n\t\t// We clear all documents first to ensure an up-to-date view on the set. Since entries\n\t\t// can get deleted on disk, this ensures that the list is always valid\n\t\tapp.clearRecentDocuments();\n\n\t\tconst mru = await this.getRecentlyOpened();\n\n\t\t// Collect max-N recent workspaces that are known to exist\n\t\tconst workspaceEntries: string[] = [];\n\t\tlet entries = 0;\n\t\tfor (let i = 0; i < mru.workspaces.length && entries < WorkspacesHistoryMainService.MAX_MACOS_DOCK_RECENT_WORKSPACES; i++) {\n\t\t\tconst loc = this.location(mru.workspaces[i]);\n\t\t\tif (loc.scheme === Schemas.file) {\n\t\t\t\tconst workspacePath = originalFSPath(loc);\n\t\t\t\tif (await Promises.exists(workspacePath)) {\n\t\t\t\t\tworkspaceEntries.push(workspacePath);\n\t\t\t\t\tentries++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Collect max-N recent files that are known to exist\n\t\tconst fileEntries: string[] = [];\n\t\tfor (let i = 0; i < mru.files.length && entries < WorkspacesHistoryMainService.MAX_MACOS_DOCK_RECENT_ENTRIES_TOTAL; i++) {\n\t\t\tconst loc = this.location(mru.files[i]);\n\t\t\tif (loc.scheme === Schemas.file) {\n\t\t\t\tconst filePath = originalFSPath(loc);\n\t\t\t\tif (\n\t\t\t\t\tWorkspacesHistoryMainService.COMMON_FILES_FILTER.includes(basename(loc)) || // skip some well known file entries\n\t\t\t\t\tworkspaceEntries.includes(filePath)\t\t\t\t\t\t\t\t\t\t\t// prefer a workspace entry over a file entry (e.g. for .code-workspace)\n\t\t\t\t) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (await Promises.exists(filePath)) {\n\t\t\t\t\tfileEntries.push(filePath);\n\t\t\t\t\tentries++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// The apple guidelines (https://developer.apple.com/design/human-interface-guidelines/macos/menus/menu-anatomy/)\n\t\t// explain that most recent entries should appear close to the interaction by the user (e.g. close to the\n\t\t// mouse click). Most native macOS applications that add recent documents to the dock, show the most recent document\n\t\t// to the bottom (because the dock menu is not appearing from top to bottom, but from the bottom to the top). As such\n\t\t// we fill in the entries in reverse order so that the most recent shows up at the bottom of the menu.\n\t\t//\n\t\t// On top of that, the maximum number of documents can be configured by the user (defaults to 10). To ensure that\n\t\t// we are not failing to show the most recent entries, we start by adding files first (in reverse order of recency)\n\t\t// and then add folders (in reverse order of recency). Given that strategy, we can ensure that the most recent\n\t\t// N folders are always appearing, even if the limit is low (https://github.com/microsoft/vscode/issues/74788)\n\t\tfileEntries.reverse().forEach(fileEntry => app.addRecentDocument(fileEntry));\n\t\tworkspaceEntries.reverse().forEach(workspaceEntry => app.addRecentDocument(workspaceEntry));\n\t}\n\n\t//#endregion\n}\n"]}