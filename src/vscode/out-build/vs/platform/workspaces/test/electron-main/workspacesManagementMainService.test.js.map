{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/workspaces/test/electron-main/workspacesManagementMainService.test.ts","vs/platform/workspaces/test/electron-main/workspacesManagementMainService.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,KAAK,EAAE,MAAM,IAAI,CAAC;AACzB,OAAO,KAAK,EAAE,MAAM,IAAI,CAAC;AACzB,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,oCAAoC,CAAC;AACtE,OAAO,EAAE,oBAAoB,EAAE,MAAM,mCAAmC,CAAC;AACzE,OAAO,KAAK,IAAI,MAAM,iCAAiC,CAAC;AACxD,OAAO,EAAE,SAAS,EAAE,MAAM,qCAAqC,CAAC;AAChE,OAAO,EAAE,0BAA0B,EAAE,MAAM,sCAAsC,CAAC;AAClF,OAAO,EAAE,GAAG,EAAE,MAAM,gCAAgC,CAAC;AACrD,OAAO,KAAK,GAAG,MAAM,8BAA8B,CAAC;AACpD,OAAO,EAAE,uCAAuC,EAAE,MAAM,uCAAuC,CAAC;AAChG,OAAO,EAAE,UAAU,EAAE,iBAAiB,EAAE,MAAM,yCAAyC,CAAC;AAMxF,OAAO,EAAE,sBAAsB,EAAE,MAAM,8DAA8D,CAAC;AACtG,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,mCAAmC,CAAC;AACvE,OAAO,EAAE,WAAW,EAAE,MAAM,sCAAsC,CAAC;AACnE,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAC;AAC5D,OAAO,OAAO,MAAM,oCAAoC,CAAC;AAEzD,OAAO,EAAgB,YAAY,EAAE,MAAM,qCAAqC,CAAC;AACjF,OAAO,EAAE,kBAAkB,EAAE,MAAM,mDAAmD,CAAC;AACvF,OAAO,EAAE,2BAA2B,EAAE,MAAM,2DAA2D,CAAC;AACxG,OAAO,EAAmD,mBAAmB,EAAE,MAAM,wCAAwC,CAAC;AAC9H,OAAO,EAA0E,kCAAkC,EAAE,MAAM,4BAA4B,CAAC;AACxJ,OAAO,EAAE,+BAA+B,EAAE,MAAM,wDAAwD,CAAC;AAEzG,UAAU,CAAC,iCAAiC,EAAE,GAAG,EAAE;IAElD,MAAM,qBAAqB;QAI1B,cAAc,CAAC,OAAiC,EAAE,MAA2C,IAAmC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC7K,UAAU,CAAC,OAAiC,EAAE,MAA2C,IAAmC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACzK,QAAQ,CAAC,OAAiC,EAAE,MAA2C,IAAmC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACvK,aAAa,CAAC,OAAiC,EAAE,MAA2C,IAAmC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC5K,cAAc,CAAC,OAAmC,EAAE,MAA2C,IAA6C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACzL,cAAc,CAAC,OAAmC,EAAE,MAA2C,IAA6C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACzL,cAAc,CAAC,OAAmC,EAAE,MAA2C,IAA6C,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;KACzL;IAED,MAAM,qBAAqB;QAI1B,gBAAgB,KAAc,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC3E,qBAAqB,KAA+B,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAGjG,uBAAuB,CAAC,aAAsB,EAAE,WAAqB,IAA8B,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAChJ,oBAAoB,CAAC,MAAyB,IAAY,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACvG,yBAAyB,CAAC,KAA6B,IAAY,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAChH,KAAK,CAAC,kBAAkB,KAA4D,OAAO,EAAE,CAAC,CAAC,CAAC;KAChG;IAED,SAAS,uBAAuB,CAAC,OAAiB,EAAE,KAAgB;QACnE,OAAO,OAAO,CAAC,uBAAuB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAmC,CAAA,CAAC,CAAC,CAAC;IAC7K,CAAC;IAED,SAAS,eAAe,CAAC,mBAA2B,EAAE,OAAyB,EAAE,KAAgB;QAChG,MAAM,EAAE,GAAqB;YAC5B,OAAO,EAAE,EAAE;SACX,CAAC;QAEF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACzC,MAAM,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YACrB,MAAM,CAAC,GAA2B,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;YACzF,IAAI,KAAK,EAAE,CAAC;gBACX,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACnB,CAAC;YACD,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC;QAED,EAAE,CAAC,aAAa,CAAC,mBAAmB,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3D,CAAC;IAED,IAAI,OAAe,CAAC;IACpB,IAAI,0BAAkC,CAAC;IACvC,IAAI,sBAA8C,CAAC;IACnD,IAAI,OAAwC,CAAC;IAE7C,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC;IAC1B,MAAM,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;IAE3B,KAAK,CAAC,KAAK,IAAI,EAAE;QAChB,OAAO,GAAG,iBAAiB,CAAC,MAAM,EAAE,UAAU,EAAE,iCAAiC,CAAC,CAAC;QACnF,0BAA0B,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;QAE9D,MAAM,cAAc,GAAoB,EAAE,aAAa,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,CAAC;QAEjF,sBAAsB,GAAG,IAAI,MAAM,sBAAuB,SAAQ,sBAAsB;YAEvF;gBACC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;YACzD,CAAC;YAED,IAAa,sBAAsB;gBAClC,OAAO,GAAG,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC;YAC7C,CAAC;SACD,CAAC;QAEF,MAAM,UAAU,GAAG,IAAI,cAAc,EAAE,CAAC;QACxC,MAAM,WAAW,GAAG,IAAI,WAAW,CAAC,UAAU,CAAC,CAAC;QAChD,OAAO,GAAG,IAAI,+BAA+B,CAAC,sBAAsB,EAAE,UAAU,EAAE,IAAI,2BAA2B,CAAC,IAAI,YAAY,+BAAuB,sBAAsB,EAAE,UAAU,EAAE,WAAW,CAAC,EAAE,IAAI,kBAAkB,CAAC,WAAW,CAAC,EAAE,sBAAsB,EAAE,WAAW,EAAE,UAAU,CAAC,EAAE,IAAI,qBAAqB,EAAE,EAAE,IAAI,qBAAqB,EAAE,CAAC,CAAC;QAE5V,OAAO,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,0BAA0B,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;IAC3E,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,GAAG,EAAE;QACb,OAAO,CAAC,OAAO,EAAE,CAAC;QAElB,OAAO,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,SAAS,gBAAgB,CAAC,mBAA2B,EAAE,UAAkB;QACxE,IAAI,SAAS,EAAE,CAAC;YACf,mBAAmB,GAAG,oBAAoB,CAAC,mBAAmB,CAAC,CAAC;YAChE,UAAU,GAAG,oBAAoB,CAAC,UAAU,CAAC,CAAC;YAC9C,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC;gBACxB,UAAU,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,uEAAuE;YAC5G,CAAC;QACF,CAAC;QAED,MAAM,CAAC,WAAW,CAAC,mBAAmB,EAAE,UAAU,CAAC,CAAC;IACrD,CAAC;IAED,SAAS,cAAc,CAAC,EAAO,EAAE,EAAO;QACvC,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,QAAQ,EAAE,EAAE,EAAE,CAAC,QAAQ,EAAE,CAAC,CAAC;IAClD,CAAC;IAED,IAAI,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;QAC5C,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACrB,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACtD,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;QAElD,MAAM,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAsB,CAAC;QACrG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACrE,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACxE,MAAM,CAAC,EAAE,CAAC,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,CAAC;QAC1D,MAAM,CAAC,EAAE,CAAC,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,CAAC;IAC3D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;QACtD,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,CAAC,yBAAyB,EAAE,SAAS,CAAC,CAAC,CAAC;QACvG,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACrB,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACtD,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;QAElD,MAAM,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAsB,CAAC;QACrG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACrE,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,yBAAyB,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC9E,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;QAC3E,MAAM,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;QAC5D,MAAM,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;QAE5D,MAAM,SAAS,GAAG,MAAM,OAAO,CAAC,uBAAuB,CAAC,CAAC,EAAE,GAAG,EAAE,UAAU,EAAE,EAAE,EAAE,GAAG,EAAE,UAAU,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC9G,MAAM,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACrB,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACtD,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;QAElD,MAAM,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAsB,CAAC;QACrG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAA0B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,GAAG,EAAE,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QAC3F,MAAM,CAAC,WAAW,CAA0B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,GAAG,EAAE,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QAC3F,MAAM,CAAC,EAAE,CAAC,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,CAAC;QAC1D,MAAM,CAAC,EAAE,CAAC,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,CAAC;QAC1D,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE;QACnC,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,MAAM,CAAC,EAAE,CAAC,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;QAErE,iCAAiC;QACjC,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,aAAa,mBAAmB,EAAE,CAAC,CAAC;QACzG,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACpD,SAAS,CAAC,UAAU,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAEzC,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,QAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAChD,cAAc,CAAC,QAAS,CAAC,UAAU,EAAE,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3D,MAAM,CAAC,EAAE,CAAC,QAAS,CAAC,EAAE,CAAC,CAAC;QACxB,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,SAAS,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,oBAAoB;QAE/G,MAAM,eAAe,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAClF,MAAM,CAAC,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC;QAE5B,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,sBAAsB;QACvH,MAAM,iBAAiB,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QACpF,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;QAC5D,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,yBAAyB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAElH,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3E,cAAc,CAAC,QAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,mBAAmB,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;IACtI,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;QAC/D,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,kCAAkC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAE3H,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3E,cAAc,CAAC,QAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,mBAAmB,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;IACxI,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;QAC/D,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,uBAAuB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAEhH,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3E,cAAc,CAAC,QAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,mBAAmB,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;IACtI,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oEAAoE,EAAE,KAAK,IAAI,EAAE;QACrF,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,4DAA4D,CAAC,CAAC,CAAC,iBAAiB;QAE9H,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC3E,cAAc,CAAC,QAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,mBAAmB,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;IACtI,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;QACrD,MAAM,OAAO,GAAG,GAAG,CAAC,CAAE,0CAA0C;QAChE,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QAEjD,MAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,6BAA6B,CAAC,CAAC;QACzE,eAAe,CAAC,eAAe,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;QACzF,MAAM,WAAW,GAAG,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAC;QAEhE,IAAI,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC/C,IAAI,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,6BAA6B,CAAC,CAAC,CAAC;QAC/F,IAAI,UAAU,GAAG,kCAAkC,CAAC,WAAW,EAAE,cAAc,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACzI,IAAI,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QACtD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,0CAA0C;QACpH,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACrE,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QAE9E,cAAc,GAAG,mBAAmB,CAAC;QACrC,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,6BAA6B,CAAC,CAAC,CAAC;QACjF,UAAU,GAAG,kCAAkC,CAAC,UAAU,EAAE,cAAc,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACpI,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACzE,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAC1E,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;QAErF,cAAc,GAAG,mBAAmB,CAAC;QACrC,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,6BAA6B,CAAC,CAAC,CAAC;QAC1F,UAAU,GAAG,kCAAkC,CAAC,UAAU,EAAE,cAAc,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACpI,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACzE,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC7E,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,sBAAsB,CAAC,CAAC;QAExF,cAAc,GAAG,mBAAmB,CAAC;QACrC,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,2CAA2C,CAAC,CAAC;QAC7E,UAAU,GAAG,kCAAkC,CAAC,UAAU,EAAE,cAAc,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACpI,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAA0B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QAClG,MAAM,CAAC,WAAW,CAA0B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QACvG,MAAM,CAAC,WAAW,CAA0B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,YAAY,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QAEhI,EAAE,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC;IAChC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;QAC1E,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;QAChG,MAAM,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,eAAe,IAAI,CAAC,GAAG,EAAE,IAAI,mBAAmB,EAAE,CAAC,CAAC,CAAC;QAE5G,IAAI,WAAW,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC1E,WAAW,GAAG,yBAAyB,WAAW,EAAE,CAAC;QAErD,MAAM,UAAU,GAAG,kCAAkC,CAAC,WAAW,EAAE,SAAS,CAAC,UAAU,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACjJ,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,UAAU,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,CAAC;QAClE,MAAM,OAAO,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gEAAgE,EAAE,KAAK,IAAI,EAAE;QACjF,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;QAChG,MAAM,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,eAAe,IAAI,CAAC,GAAG,EAAE,IAAI,mBAAmB,EAAE,CAAC,CAAC,CAAC;QAE5G,IAAI,WAAW,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC1E,WAAW,GAAG,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC,6BAA6B;QAE9E,MAAM,UAAU,GAAG,kCAAkC,CAAC,WAAW,EAAE,SAAS,CAAC,UAAU,EAAE,KAAK,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACjJ,MAAM,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAA2B,CAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACtF,MAAM,OAAO,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,gDAAgD,EAAE,KAAK,IAAI,EAAE;QAC5F,MAAM,iBAAiB,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACrD,MAAM,eAAe,GAAG,SAAS,CAAC;QAClC,MAAM,eAAe,GAAG,gCAAgC,CAAC;QACzD,MAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;QAEtE,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,eAAe,EAAE,eAAe,EAAE,eAAe,CAAC,CAAC,CAAC;QACrG,MAAM,mBAAmB,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,eAAe,IAAI,CAAC,GAAG,EAAE,IAAI,mBAAmB,EAAE,CAAC,CAAC,CAAC;QACvH,MAAM,WAAW,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC5E,MAAM,UAAU,GAAG,kCAAkC,CAAC,WAAW,EAAE,SAAS,CAAC,UAAU,EAAE,IAAI,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QAChJ,MAAM,EAAE,GAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAsB,CAAC;QACxD,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QACjF,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QACjF,gBAAgB,CAA2B,EAAE,CAAC,OAAO,CAAC,CAAC,CAAE,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QAE9E,MAAM,OAAO,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;QACrD,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QACtD,MAAM,OAAO,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;QACjD,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;QAClD,MAAM,SAAS,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QAC/D,MAAM,OAAO,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,sBAAsB,EAAE,KAAK;QACjC,MAAM,OAAO,CAAC,UAAU,EAAE,CAAC;QAC3B,IAAI,QAAQ,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEvC,MAAM,WAAW,GAAG,MAAM,uBAAuB,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;QACjE,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,WAAW,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;QAExD,MAAM,OAAO,CAAC,UAAU,EAAE,CAAC;QAC3B,QAAQ,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;QAC3C,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;QACvC,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;QAE7D,MAAM,OAAO,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;QACnD,MAAM,OAAO,CAAC,UAAU,EAAE,CAAC;QAC3B,QAAQ,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;QAC3C,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,uCAAuC,EAAE,CAAC;AAC3C,CAAC,CAAC,CAAC","file":"workspacesManagementMainService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport { isUNC, toSlashes } from '../../../../base/common/extpath.js';\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { isWindows } from '../../../../base/common/platform.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as pfs from '../../../../base/node/pfs.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { flakySuite, getRandomTestPath } from '../../../../base/test/node/testUtils.js';\nimport { IWorkspaceBackupInfo, IFolderBackupInfo } from '../../../backup/common/backup.js';\nimport { IBackupMainService } from '../../../backup/electron-main/backup.js';\nimport { IEmptyWindowBackupInfo } from '../../../backup/node/backup.js';\nimport { INativeOpenDialogOptions } from '../../../dialogs/common/dialogs.js';\nimport { IDialogMainService } from '../../../dialogs/electron-main/dialogMainService.js';\nimport { EnvironmentMainService } from '../../../environment/electron-main/environmentMainService.js';\nimport { OPTIONS, parseArgs } from '../../../environment/node/argv.js';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport product from '../../../product/common/product.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { SaveStrategy, StateService } from '../../../state/node/stateService.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { UserDataProfilesMainService } from '../../../userDataProfile/electron-main/userDataProfile.js';\nimport { IRawFileWorkspaceFolder, IRawUriWorkspaceFolder, WORKSPACE_EXTENSION } from '../../../workspace/common/workspace.js';\nimport { IStoredWorkspace, IStoredWorkspaceFolder, IWorkspaceFolderCreationData, rewriteWorkspaceFileForNewLocation } from '../../common/workspaces.js';\nimport { WorkspacesManagementMainService } from '../../electron-main/workspacesManagementMainService.js';\n\nflakySuite('WorkspacesManagementMainService', () => {\n\n\tclass TestDialogMainService implements IDialogMainService {\n\n\t\tdeclare readonly _serviceBrand: undefined;\n\n\t\tpickFileFolder(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickFolder(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickFile(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickWorkspace(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tshowMessageBox(options: Electron.MessageBoxOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.MessageBoxReturnValue> { throw new Error('Method not implemented.'); }\n\t\tshowSaveDialog(options: Electron.SaveDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.SaveDialogReturnValue> { throw new Error('Method not implemented.'); }\n\t\tshowOpenDialog(options: Electron.OpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.OpenDialogReturnValue> { throw new Error('Method not implemented.'); }\n\t}\n\n\tclass TestBackupMainService implements IBackupMainService {\n\n\t\tdeclare readonly _serviceBrand: undefined;\n\n\t\tisHotExitEnabled(): boolean { throw new Error('Method not implemented.'); }\n\t\tgetEmptyWindowBackups(): IEmptyWindowBackupInfo[] { throw new Error('Method not implemented.'); }\n\t\tregisterWorkspaceBackup(workspaceInfo: IWorkspaceBackupInfo): string;\n\t\tregisterWorkspaceBackup(workspaceInfo: IWorkspaceBackupInfo, migrateFrom: string): Promise<string>;\n\t\tregisterWorkspaceBackup(workspaceInfo: unknown, migrateFrom?: unknown): string | Promise<string> { throw new Error('Method not implemented.'); }\n\t\tregisterFolderBackup(folder: IFolderBackupInfo): string { throw new Error('Method not implemented.'); }\n\t\tregisterEmptyWindowBackup(empty: IEmptyWindowBackupInfo): string { throw new Error('Method not implemented.'); }\n\t\tasync getDirtyWorkspaces(): Promise<(IWorkspaceBackupInfo | IFolderBackupInfo)[]> { return []; }\n\t}\n\n\tfunction createUntitledWorkspace(folders: string[], names?: string[]) {\n\t\treturn service.createUntitledWorkspace(folders.map((folder, index) => ({ uri: URI.file(folder), name: names ? names[index] : undefined } as IWorkspaceFolderCreationData)));\n\t}\n\n\tfunction createWorkspace(workspaceConfigPath: string, folders: (string | URI)[], names?: string[]): void {\n\t\tconst ws: IStoredWorkspace = {\n\t\t\tfolders: []\n\t\t};\n\n\t\tfor (let i = 0; i < folders.length; i++) {\n\t\t\tconst f = folders[i];\n\t\t\tconst s: IStoredWorkspaceFolder = f instanceof URI ? { uri: f.toString() } : { path: f };\n\t\t\tif (names) {\n\t\t\t\ts.name = names[i];\n\t\t\t}\n\t\t\tws.folders.push(s);\n\t\t}\n\n\t\tfs.writeFileSync(workspaceConfigPath, JSON.stringify(ws));\n\t}\n\n\tlet testDir: string;\n\tlet untitledWorkspacesHomePath: string;\n\tlet environmentMainService: EnvironmentMainService;\n\tlet service: WorkspacesManagementMainService;\n\n\tconst cwd = process.cwd();\n\tconst tmpDir = os.tmpdir();\n\n\tsetup(async () => {\n\t\ttestDir = getRandomTestPath(tmpDir, 'vsctests', 'workspacesmanagementmainservice');\n\t\tuntitledWorkspacesHomePath = path.join(testDir, 'Workspaces');\n\n\t\tconst productService: IProductService = { _serviceBrand: undefined, ...product };\n\n\t\tenvironmentMainService = new class TestEnvironmentService extends EnvironmentMainService {\n\n\t\t\tconstructor() {\n\t\t\t\tsuper(parseArgs(process.argv, OPTIONS), productService);\n\t\t\t}\n\n\t\t\toverride get untitledWorkspacesHome(): URI {\n\t\t\t\treturn URI.file(untitledWorkspacesHomePath);\n\t\t\t}\n\t\t};\n\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = new FileService(logService);\n\t\tservice = new WorkspacesManagementMainService(environmentMainService, logService, new UserDataProfilesMainService(new StateService(SaveStrategy.DELAYED, environmentMainService, logService, fileService), new UriIdentityService(fileService), environmentMainService, fileService, logService), new TestBackupMainService(), new TestDialogMainService());\n\n\t\treturn fs.promises.mkdir(untitledWorkspacesHomePath, { recursive: true });\n\t});\n\n\tteardown(() => {\n\t\tservice.dispose();\n\n\t\treturn pfs.Promises.rm(testDir);\n\t});\n\n\tfunction assertPathEquals(pathInWorkspaceFile: string, pathOnDisk: string): void {\n\t\tif (isWindows) {\n\t\t\tpathInWorkspaceFile = normalizeDriveLetter(pathInWorkspaceFile);\n\t\t\tpathOnDisk = normalizeDriveLetter(pathOnDisk);\n\t\t\tif (!isUNC(pathOnDisk)) {\n\t\t\t\tpathOnDisk = toSlashes(pathOnDisk); // workspace file is using slashes for all paths except where mandatory\n\t\t\t}\n\t\t}\n\n\t\tassert.strictEqual(pathInWorkspaceFile, pathOnDisk);\n\t}\n\n\tfunction assertEqualURI(u1: URI, u2: URI): void {\n\t\tassert.strictEqual(u1.toString(), u2.toString());\n\t}\n\n\ttest('createWorkspace (folders)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, cwd);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, tmpDir);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[0]).name);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[1]).name);\n\t});\n\n\ttest('createWorkspace (folders with name)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir], ['currentworkingdirectory', 'tempdir']);\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, cwd);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, tmpDir);\n\t\tassert.strictEqual((<IRawFileWorkspaceFolder>ws.folders[0]).name, 'currentworkingdirectory');\n\t\tassert.strictEqual((<IRawFileWorkspaceFolder>ws.folders[1]).name, 'tempdir');\n\t});\n\n\ttest('createUntitledWorkspace (folders as other resource URIs)', async () => {\n\t\tconst folder1URI = URI.parse('myscheme://server/work/p/f1');\n\t\tconst folder2URI = URI.parse('myscheme://server/work/o/f3');\n\n\t\tconst workspace = await service.createUntitledWorkspace([{ uri: folder1URI }, { uri: folder2URI }], 'server');\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[0]).uri, folder1URI.toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[1]).uri, folder2URI.toString(true));\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[0]).name);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[1]).name);\n\t\tassert.strictEqual(ws.remoteAuthority, 'server');\n\t});\n\n\ttest('resolveWorkspace', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(await service.resolveLocalWorkspace(workspace.configPath));\n\n\t\t// make it a valid workspace path\n\t\tconst newPath = path.join(path.dirname(workspace.configPath.fsPath), `workspace.${WORKSPACE_EXTENSION}`);\n\t\tfs.renameSync(workspace.configPath.fsPath, newPath);\n\t\tworkspace.configPath = URI.file(newPath);\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.strictEqual(2, resolved!.folders.length);\n\t\tassertEqualURI(resolved!.configPath, workspace.configPath);\n\t\tassert.ok(resolved!.id);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ something: 'something' })); // invalid workspace\n\n\t\tconst resolvedInvalid = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.ok(!resolvedInvalid);\n\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ transient: true, folders: [] })); // transient worksapce\n\t\tconst resolvedTransient = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.ok(resolvedTransient?.transient);\n\t});\n\n\ttest('resolveWorkspace (support relative paths)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: './ticino-playground/lib' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('resolveWorkspace (support relative paths #2)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: './ticino-playground/lib/../other' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'other')));\n\t});\n\n\ttest('resolveWorkspace (support relative paths #3)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: 'ticino-playground/lib' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('resolveWorkspace (support invalid JSON via fault tolerant parsing)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, '{ \"folders\": [ { \"path\": \"./ticino-playground/lib\" } , ] }'); // trailing comma\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation', async () => {\n\t\tconst folder1 = cwd;  // absolute path because outside of tmpDir\n\t\tconst tmpInsideDir = path.join(tmpDir, 'inside');\n\n\t\tconst firstConfigPath = path.join(tmpDir, 'myworkspace0.code-workspace');\n\t\tcreateWorkspace(firstConfigPath, [folder1, 'inside', path.join('inside', 'somefolder')]);\n\t\tconst origContent = fs.readFileSync(firstConfigPath).toString();\n\n\t\tlet origConfigPath = URI.file(firstConfigPath);\n\t\tlet workspaceConfigPath = URI.file(path.join(tmpDir, 'inside', 'myworkspace1.code-workspace'));\n\t\tlet newContent = rewriteWorkspaceFileForNewLocation(origContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tlet ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1); // absolute path because outside of tmpdir\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, '.');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.file(path.join(tmpDir, 'myworkspace2.code-workspace'));\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, 'inside');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'inside/somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.file(path.join(tmpDir, 'other', 'myworkspace2.code-workspace'));\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, '../inside');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, '../inside/somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.parse('foo://foo/bar/myworkspace2.code-workspace');\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[0]).uri, URI.file(folder1).toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[1]).uri, URI.file(tmpInsideDir).toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[2]).uri, URI.file(path.join(tmpInsideDir, 'somefolder')).toString(true));\n\n\t\tfs.unlinkSync(firstConfigPath);\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation (preserves comments)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir, path.join(tmpDir, 'somefolder')]);\n\t\tconst workspaceConfigPath = URI.file(path.join(tmpDir, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\n\t\tlet origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\torigContent = `// this is a comment\\n${origContent}`;\n\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tassert.strictEqual(0, newContent.indexOf('// this is a comment'));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation (preserves forward slashes)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir, path.join(tmpDir, 'somefolder')]);\n\t\tconst workspaceConfigPath = URI.file(path.join(tmpDir, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\n\t\tlet origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\torigContent = origContent.replace(/[\\\\]/g, '/'); // convert backslash to slash\n\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tconst ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.ok(ws.folders.every(f => (<IRawFileWorkspaceFolder>f).path.indexOf('\\\\') < 0));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\t(!isWindows ? test.skip : test)('rewriteWorkspaceFileForNewLocation (unc paths)', async () => {\n\t\tconst workspaceLocation = path.join(tmpDir, 'wsloc');\n\t\tconst folder1Location = 'x:\\\\foo';\n\t\tconst folder2Location = '\\\\\\\\server\\\\share2\\\\some\\\\path';\n\t\tconst folder3Location = path.join(workspaceLocation, 'inner', 'more');\n\n\t\tconst workspace = await createUntitledWorkspace([folder1Location, folder2Location, folder3Location]);\n\t\tconst workspaceConfigPath = URI.file(path.join(workspaceLocation, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\t\tconst origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, true, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tconst ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1Location);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, folder2Location);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'inner/more');\n\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('deleteUntitledWorkspace (untitled)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t\tassert.ok(!fs.existsSync(workspace.configPath.fsPath));\n\t});\n\n\ttest('deleteUntitledWorkspace (saved)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('getUntitledWorkspace', async function () {\n\t\tawait service.initialize();\n\t\tlet untitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(untitled.length, 0);\n\n\t\tconst untitledOne = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(fs.existsSync(untitledOne.configPath.fsPath));\n\n\t\tawait service.initialize();\n\t\tuntitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(1, untitled.length);\n\t\tassert.strictEqual(untitledOne.id, untitled[0].workspace.id);\n\n\t\tawait service.deleteUntitledWorkspace(untitledOne);\n\t\tawait service.initialize();\n\t\tuntitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(0, untitled.length);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport { isUNC, toSlashes } from '../../../../base/common/extpath.js';\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { isWindows } from '../../../../base/common/platform.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as pfs from '../../../../base/node/pfs.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { flakySuite, getRandomTestPath } from '../../../../base/test/node/testUtils.js';\nimport { IWorkspaceBackupInfo, IFolderBackupInfo } from '../../../backup/common/backup.js';\nimport { IBackupMainService } from '../../../backup/electron-main/backup.js';\nimport { IEmptyWindowBackupInfo } from '../../../backup/node/backup.js';\nimport { INativeOpenDialogOptions } from '../../../dialogs/common/dialogs.js';\nimport { IDialogMainService } from '../../../dialogs/electron-main/dialogMainService.js';\nimport { EnvironmentMainService } from '../../../environment/electron-main/environmentMainService.js';\nimport { OPTIONS, parseArgs } from '../../../environment/node/argv.js';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport product from '../../../product/common/product.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { SaveStrategy, StateService } from '../../../state/node/stateService.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { UserDataProfilesMainService } from '../../../userDataProfile/electron-main/userDataProfile.js';\nimport { IRawFileWorkspaceFolder, IRawUriWorkspaceFolder, WORKSPACE_EXTENSION } from '../../../workspace/common/workspace.js';\nimport { IStoredWorkspace, IStoredWorkspaceFolder, IWorkspaceFolderCreationData, rewriteWorkspaceFileForNewLocation } from '../../common/workspaces.js';\nimport { WorkspacesManagementMainService } from '../../electron-main/workspacesManagementMainService.js';\n\nflakySuite('WorkspacesManagementMainService', () => {\n\n\tclass TestDialogMainService implements IDialogMainService {\n\n\t\tdeclare readonly _serviceBrand: undefined;\n\n\t\tpickFileFolder(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickFolder(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickFile(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tpickWorkspace(options: INativeOpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<string[] | undefined> { throw new Error('Method not implemented.'); }\n\t\tshowMessageBox(options: Electron.MessageBoxOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.MessageBoxReturnValue> { throw new Error('Method not implemented.'); }\n\t\tshowSaveDialog(options: Electron.SaveDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.SaveDialogReturnValue> { throw new Error('Method not implemented.'); }\n\t\tshowOpenDialog(options: Electron.OpenDialogOptions, window?: Electron.BrowserWindow | undefined): Promise<Electron.OpenDialogReturnValue> { throw new Error('Method not implemented.'); }\n\t}\n\n\tclass TestBackupMainService implements IBackupMainService {\n\n\t\tdeclare readonly _serviceBrand: undefined;\n\n\t\tisHotExitEnabled(): boolean { throw new Error('Method not implemented.'); }\n\t\tgetEmptyWindowBackups(): IEmptyWindowBackupInfo[] { throw new Error('Method not implemented.'); }\n\t\tregisterWorkspaceBackup(workspaceInfo: IWorkspaceBackupInfo): string;\n\t\tregisterWorkspaceBackup(workspaceInfo: IWorkspaceBackupInfo, migrateFrom: string): Promise<string>;\n\t\tregisterWorkspaceBackup(workspaceInfo: unknown, migrateFrom?: unknown): string | Promise<string> { throw new Error('Method not implemented.'); }\n\t\tregisterFolderBackup(folder: IFolderBackupInfo): string { throw new Error('Method not implemented.'); }\n\t\tregisterEmptyWindowBackup(empty: IEmptyWindowBackupInfo): string { throw new Error('Method not implemented.'); }\n\t\tasync getDirtyWorkspaces(): Promise<(IWorkspaceBackupInfo | IFolderBackupInfo)[]> { return []; }\n\t}\n\n\tfunction createUntitledWorkspace(folders: string[], names?: string[]) {\n\t\treturn service.createUntitledWorkspace(folders.map((folder, index) => ({ uri: URI.file(folder), name: names ? names[index] : undefined } as IWorkspaceFolderCreationData)));\n\t}\n\n\tfunction createWorkspace(workspaceConfigPath: string, folders: (string | URI)[], names?: string[]): void {\n\t\tconst ws: IStoredWorkspace = {\n\t\t\tfolders: []\n\t\t};\n\n\t\tfor (let i = 0; i < folders.length; i++) {\n\t\t\tconst f = folders[i];\n\t\t\tconst s: IStoredWorkspaceFolder = f instanceof URI ? { uri: f.toString() } : { path: f };\n\t\t\tif (names) {\n\t\t\t\ts.name = names[i];\n\t\t\t}\n\t\t\tws.folders.push(s);\n\t\t}\n\n\t\tfs.writeFileSync(workspaceConfigPath, JSON.stringify(ws));\n\t}\n\n\tlet testDir: string;\n\tlet untitledWorkspacesHomePath: string;\n\tlet environmentMainService: EnvironmentMainService;\n\tlet service: WorkspacesManagementMainService;\n\n\tconst cwd = process.cwd();\n\tconst tmpDir = os.tmpdir();\n\n\tsetup(async () => {\n\t\ttestDir = getRandomTestPath(tmpDir, 'vsctests', 'workspacesmanagementmainservice');\n\t\tuntitledWorkspacesHomePath = path.join(testDir, 'Workspaces');\n\n\t\tconst productService: IProductService = { _serviceBrand: undefined, ...product };\n\n\t\tenvironmentMainService = new class TestEnvironmentService extends EnvironmentMainService {\n\n\t\t\tconstructor() {\n\t\t\t\tsuper(parseArgs(process.argv, OPTIONS), productService);\n\t\t\t}\n\n\t\t\toverride get untitledWorkspacesHome(): URI {\n\t\t\t\treturn URI.file(untitledWorkspacesHomePath);\n\t\t\t}\n\t\t};\n\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = new FileService(logService);\n\t\tservice = new WorkspacesManagementMainService(environmentMainService, logService, new UserDataProfilesMainService(new StateService(SaveStrategy.DELAYED, environmentMainService, logService, fileService), new UriIdentityService(fileService), environmentMainService, fileService, logService), new TestBackupMainService(), new TestDialogMainService());\n\n\t\treturn fs.promises.mkdir(untitledWorkspacesHomePath, { recursive: true });\n\t});\n\n\tteardown(() => {\n\t\tservice.dispose();\n\n\t\treturn pfs.Promises.rm(testDir);\n\t});\n\n\tfunction assertPathEquals(pathInWorkspaceFile: string, pathOnDisk: string): void {\n\t\tif (isWindows) {\n\t\t\tpathInWorkspaceFile = normalizeDriveLetter(pathInWorkspaceFile);\n\t\t\tpathOnDisk = normalizeDriveLetter(pathOnDisk);\n\t\t\tif (!isUNC(pathOnDisk)) {\n\t\t\t\tpathOnDisk = toSlashes(pathOnDisk); // workspace file is using slashes for all paths except where mandatory\n\t\t\t}\n\t\t}\n\n\t\tassert.strictEqual(pathInWorkspaceFile, pathOnDisk);\n\t}\n\n\tfunction assertEqualURI(u1: URI, u2: URI): void {\n\t\tassert.strictEqual(u1.toString(), u2.toString());\n\t}\n\n\ttest('createWorkspace (folders)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, cwd);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, tmpDir);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[0]).name);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[1]).name);\n\t});\n\n\ttest('createWorkspace (folders with name)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir], ['currentworkingdirectory', 'tempdir']);\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, cwd);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, tmpDir);\n\t\tassert.strictEqual((<IRawFileWorkspaceFolder>ws.folders[0]).name, 'currentworkingdirectory');\n\t\tassert.strictEqual((<IRawFileWorkspaceFolder>ws.folders[1]).name, 'tempdir');\n\t});\n\n\ttest('createUntitledWorkspace (folders as other resource URIs)', async () => {\n\t\tconst folder1URI = URI.parse('myscheme://server/work/p/f1');\n\t\tconst folder2URI = URI.parse('myscheme://server/work/o/f3');\n\n\t\tconst workspace = await service.createUntitledWorkspace([{ uri: folder1URI }, { uri: folder2URI }], 'server');\n\t\tassert.ok(workspace);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tassert.ok(service.isUntitledWorkspace(workspace));\n\n\t\tconst ws = (JSON.parse(fs.readFileSync(workspace.configPath.fsPath).toString()) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 2);\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[0]).uri, folder1URI.toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[1]).uri, folder2URI.toString(true));\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[0]).name);\n\t\tassert.ok(!(<IRawFileWorkspaceFolder>ws.folders[1]).name);\n\t\tassert.strictEqual(ws.remoteAuthority, 'server');\n\t});\n\n\ttest('resolveWorkspace', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(await service.resolveLocalWorkspace(workspace.configPath));\n\n\t\t// make it a valid workspace path\n\t\tconst newPath = path.join(path.dirname(workspace.configPath.fsPath), `workspace.${WORKSPACE_EXTENSION}`);\n\t\tfs.renameSync(workspace.configPath.fsPath, newPath);\n\t\tworkspace.configPath = URI.file(newPath);\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.strictEqual(2, resolved!.folders.length);\n\t\tassertEqualURI(resolved!.configPath, workspace.configPath);\n\t\tassert.ok(resolved!.id);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ something: 'something' })); // invalid workspace\n\n\t\tconst resolvedInvalid = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.ok(!resolvedInvalid);\n\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ transient: true, folders: [] })); // transient worksapce\n\t\tconst resolvedTransient = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassert.ok(resolvedTransient?.transient);\n\t});\n\n\ttest('resolveWorkspace (support relative paths)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: './ticino-playground/lib' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('resolveWorkspace (support relative paths #2)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: './ticino-playground/lib/../other' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'other')));\n\t});\n\n\ttest('resolveWorkspace (support relative paths #3)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, JSON.stringify({ folders: [{ path: 'ticino-playground/lib' }] }));\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('resolveWorkspace (support invalid JSON via fault tolerant parsing)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tfs.writeFileSync(workspace.configPath.fsPath, '{ \"folders\": [ { \"path\": \"./ticino-playground/lib\" } , ] }'); // trailing comma\n\n\t\tconst resolved = await service.resolveLocalWorkspace(workspace.configPath);\n\t\tassertEqualURI(resolved!.folders[0].uri, URI.file(path.join(path.dirname(workspace.configPath.fsPath), 'ticino-playground', 'lib')));\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation', async () => {\n\t\tconst folder1 = cwd;  // absolute path because outside of tmpDir\n\t\tconst tmpInsideDir = path.join(tmpDir, 'inside');\n\n\t\tconst firstConfigPath = path.join(tmpDir, 'myworkspace0.code-workspace');\n\t\tcreateWorkspace(firstConfigPath, [folder1, 'inside', path.join('inside', 'somefolder')]);\n\t\tconst origContent = fs.readFileSync(firstConfigPath).toString();\n\n\t\tlet origConfigPath = URI.file(firstConfigPath);\n\t\tlet workspaceConfigPath = URI.file(path.join(tmpDir, 'inside', 'myworkspace1.code-workspace'));\n\t\tlet newContent = rewriteWorkspaceFileForNewLocation(origContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tlet ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1); // absolute path because outside of tmpdir\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, '.');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.file(path.join(tmpDir, 'myworkspace2.code-workspace'));\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, 'inside');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'inside/somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.file(path.join(tmpDir, 'other', 'myworkspace2.code-workspace'));\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, '../inside');\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, '../inside/somefolder');\n\n\t\torigConfigPath = workspaceConfigPath;\n\t\tworkspaceConfigPath = URI.parse('foo://foo/bar/myworkspace2.code-workspace');\n\t\tnewContent = rewriteWorkspaceFileForNewLocation(newContent, origConfigPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.strictEqual(ws.folders.length, 3);\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[0]).uri, URI.file(folder1).toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[1]).uri, URI.file(tmpInsideDir).toString(true));\n\t\tassert.strictEqual((<IRawUriWorkspaceFolder>ws.folders[2]).uri, URI.file(path.join(tmpInsideDir, 'somefolder')).toString(true));\n\n\t\tfs.unlinkSync(firstConfigPath);\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation (preserves comments)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir, path.join(tmpDir, 'somefolder')]);\n\t\tconst workspaceConfigPath = URI.file(path.join(tmpDir, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\n\t\tlet origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\torigContent = `// this is a comment\\n${origContent}`;\n\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tassert.strictEqual(0, newContent.indexOf('// this is a comment'));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('rewriteWorkspaceFileForNewLocation (preserves forward slashes)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir, path.join(tmpDir, 'somefolder')]);\n\t\tconst workspaceConfigPath = URI.file(path.join(tmpDir, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\n\t\tlet origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\torigContent = origContent.replace(/[\\\\]/g, '/'); // convert backslash to slash\n\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, false, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tconst ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassert.ok(ws.folders.every(f => (<IRawFileWorkspaceFolder>f).path.indexOf('\\\\') < 0));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\t(!isWindows ? test.skip : test)('rewriteWorkspaceFileForNewLocation (unc paths)', async () => {\n\t\tconst workspaceLocation = path.join(tmpDir, 'wsloc');\n\t\tconst folder1Location = 'x:\\\\foo';\n\t\tconst folder2Location = '\\\\\\\\server\\\\share2\\\\some\\\\path';\n\t\tconst folder3Location = path.join(workspaceLocation, 'inner', 'more');\n\n\t\tconst workspace = await createUntitledWorkspace([folder1Location, folder2Location, folder3Location]);\n\t\tconst workspaceConfigPath = URI.file(path.join(workspaceLocation, `myworkspace.${Date.now()}.${WORKSPACE_EXTENSION}`));\n\t\tconst origContent = fs.readFileSync(workspace.configPath.fsPath).toString();\n\t\tconst newContent = rewriteWorkspaceFileForNewLocation(origContent, workspace.configPath, true, workspaceConfigPath, extUriBiasedIgnorePathCase);\n\t\tconst ws = (JSON.parse(newContent) as IStoredWorkspace);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[0]).path, folder1Location);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[1]).path, folder2Location);\n\t\tassertPathEquals((<IRawFileWorkspaceFolder>ws.folders[2]).path, 'inner/more');\n\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('deleteUntitledWorkspace (untitled)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(fs.existsSync(workspace.configPath.fsPath));\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t\tassert.ok(!fs.existsSync(workspace.configPath.fsPath));\n\t});\n\n\ttest('deleteUntitledWorkspace (saved)', async () => {\n\t\tconst workspace = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tawait service.deleteUntitledWorkspace(workspace);\n\t});\n\n\ttest('getUntitledWorkspace', async function () {\n\t\tawait service.initialize();\n\t\tlet untitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(untitled.length, 0);\n\n\t\tconst untitledOne = await createUntitledWorkspace([cwd, tmpDir]);\n\t\tassert.ok(fs.existsSync(untitledOne.configPath.fsPath));\n\n\t\tawait service.initialize();\n\t\tuntitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(1, untitled.length);\n\t\tassert.strictEqual(untitledOne.id, untitled[0].workspace.id);\n\n\t\tawait service.deleteUntitledWorkspace(untitledOne);\n\t\tawait service.initialize();\n\t\tuntitled = service.getUntitledWorkspaces();\n\t\tassert.strictEqual(0, untitled.length);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}