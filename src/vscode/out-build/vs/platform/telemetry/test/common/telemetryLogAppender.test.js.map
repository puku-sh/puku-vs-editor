{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/telemetry/test/common/telemetryLogAppender.test.ts","vs/platform/telemetry/test/common/telemetryLogAppender.test.ts"],"names":[],"mappings":"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","file":"telemetryLogAppender.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { Event } from '../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { TestInstantiationService } from '../../../instantiation/test/common/instantiationServiceMock.js';\nimport { AbstractLogger, DEFAULT_LOG_LEVEL, ILogger, ILoggerService, LogLevel } from '../../../log/common/log.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { TelemetryLogAppender } from '../../common/telemetryLogAppender.js';\n\nclass TestTelemetryLogger extends AbstractLogger implements ILogger {\n\n\tpublic logs: string[] = [];\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t}\n\n\ttrace(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Trace)) {\n\t\t\tthis.logs.push(message + JSON.stringify(args));\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Debug)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Info)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Warning)) {\n\t\t\tthis.logs.push(message.toString());\n\t\t}\n\t}\n\n\terror(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Error)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\tflush(): void { }\n}\n\nexport class TestTelemetryLoggerService implements ILoggerService {\n\t_serviceBrand: undefined;\n\n\tlogger?: TestTelemetryLogger;\n\n\tconstructor(private readonly logLevel: LogLevel) { }\n\n\tgetLogger() {\n\t\treturn this.logger;\n\t}\n\n\tcreateLogger() {\n\t\tif (!this.logger) {\n\t\t\tthis.logger = new TestTelemetryLogger(this.logLevel);\n\t\t}\n\n\t\treturn this.logger;\n\t}\n\n\tonDidChangeVisibility = Event.None;\n\tonDidChangeLogLevel = Event.None;\n\tonDidChangeLoggers = Event.None;\n\tsetLogLevel(): void { }\n\tgetLogLevel() { return LogLevel.Info; }\n\tsetVisibility(): void { }\n\tgetDefaultLogLevel() { return this.logLevel; }\n\tregisterLogger() { }\n\tderegisterLogger(): void { }\n\tgetRegisteredLoggers() { return []; }\n\tgetRegisteredLogger() { return undefined; }\n}\n\nsuite('TelemetryLogAdapter', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Do not Log Telemetry if log level is not trace', async () => {\n\t\tconst testLoggerService = new TestTelemetryLoggerService(DEFAULT_LOG_LEVEL);\n\t\tconst testInstantiationService = new TestInstantiationService();\n\t\tconst testObject = new TelemetryLogAppender('', false, testLoggerService, testInstantiationService.stub(IEnvironmentService, {}), testInstantiationService.stub(IProductService, {}));\n\t\ttestObject.log('testEvent', { hello: 'world', isTrue: true, numberBetween1And3: 2 });\n\t\tassert.strictEqual(testLoggerService.createLogger().logs.length, 0);\n\t\ttestObject.dispose();\n\t\ttestInstantiationService.dispose();\n\t});\n\n\ttest('Log Telemetry if log level is trace', async () => {\n\t\tconst testLoggerService = new TestTelemetryLoggerService(LogLevel.Trace);\n\t\tconst testInstantiationService = new TestInstantiationService();\n\t\tconst testObject = new TelemetryLogAppender('', false, testLoggerService, testInstantiationService.stub(IEnvironmentService, {}), testInstantiationService.stub(IProductService, {}));\n\t\ttestObject.log('testEvent', { hello: 'world', isTrue: true, numberBetween1And3: 2 });\n\t\tassert.strictEqual(testLoggerService.createLogger().logs[0], 'telemetry/testEvent' + JSON.stringify([{\n\t\t\tproperties: {\n\t\t\t\thello: 'world',\n\t\t\t},\n\t\t\tmeasurements: {\n\t\t\t\tisTrue: 1, numberBetween1And3: 2\n\t\t\t}\n\t\t}]));\n\t\ttestObject.dispose();\n\t\ttestInstantiationService.dispose();\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { Event } from '../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { TestInstantiationService } from '../../../instantiation/test/common/instantiationServiceMock.js';\nimport { AbstractLogger, DEFAULT_LOG_LEVEL, ILogger, ILoggerService, LogLevel } from '../../../log/common/log.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { TelemetryLogAppender } from '../../common/telemetryLogAppender.js';\n\nclass TestTelemetryLogger extends AbstractLogger implements ILogger {\n\n\tpublic logs: string[] = [];\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t}\n\n\ttrace(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Trace)) {\n\t\t\tthis.logs.push(message + JSON.stringify(args));\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Debug)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Info)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Warning)) {\n\t\t\tthis.logs.push(message.toString());\n\t\t}\n\t}\n\n\terror(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Error)) {\n\t\t\tthis.logs.push(message);\n\t\t}\n\t}\n\tflush(): void { }\n}\n\nexport class TestTelemetryLoggerService implements ILoggerService {\n\t_serviceBrand: undefined;\n\n\tlogger?: TestTelemetryLogger;\n\n\tconstructor(private readonly logLevel: LogLevel) { }\n\n\tgetLogger() {\n\t\treturn this.logger;\n\t}\n\n\tcreateLogger() {\n\t\tif (!this.logger) {\n\t\t\tthis.logger = new TestTelemetryLogger(this.logLevel);\n\t\t}\n\n\t\treturn this.logger;\n\t}\n\n\tonDidChangeVisibility = Event.None;\n\tonDidChangeLogLevel = Event.None;\n\tonDidChangeLoggers = Event.None;\n\tsetLogLevel(): void { }\n\tgetLogLevel() { return LogLevel.Info; }\n\tsetVisibility(): void { }\n\tgetDefaultLogLevel() { return this.logLevel; }\n\tregisterLogger() { }\n\tderegisterLogger(): void { }\n\tgetRegisteredLoggers() { return []; }\n\tgetRegisteredLogger() { return undefined; }\n}\n\nsuite('TelemetryLogAdapter', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Do not Log Telemetry if log level is not trace', async () => {\n\t\tconst testLoggerService = new TestTelemetryLoggerService(DEFAULT_LOG_LEVEL);\n\t\tconst testInstantiationService = new TestInstantiationService();\n\t\tconst testObject = new TelemetryLogAppender('', false, testLoggerService, testInstantiationService.stub(IEnvironmentService, {}), testInstantiationService.stub(IProductService, {}));\n\t\ttestObject.log('testEvent', { hello: 'world', isTrue: true, numberBetween1And3: 2 });\n\t\tassert.strictEqual(testLoggerService.createLogger().logs.length, 0);\n\t\ttestObject.dispose();\n\t\ttestInstantiationService.dispose();\n\t});\n\n\ttest('Log Telemetry if log level is trace', async () => {\n\t\tconst testLoggerService = new TestTelemetryLoggerService(LogLevel.Trace);\n\t\tconst testInstantiationService = new TestInstantiationService();\n\t\tconst testObject = new TelemetryLogAppender('', false, testLoggerService, testInstantiationService.stub(IEnvironmentService, {}), testInstantiationService.stub(IProductService, {}));\n\t\ttestObject.log('testEvent', { hello: 'world', isTrue: true, numberBetween1And3: 2 });\n\t\tassert.strictEqual(testLoggerService.createLogger().logs[0], 'telemetry/testEvent' + JSON.stringify([{\n\t\t\tproperties: {\n\t\t\t\thello: 'world',\n\t\t\t},\n\t\t\tmeasurements: {\n\t\t\t\tisTrue: 1, numberBetween1And3: 2\n\t\t\t}\n\t\t}]));\n\t\ttestObject.dispose();\n\t\ttestInstantiationService.dispose();\n\t});\n});\n"]}