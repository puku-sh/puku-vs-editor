{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/extensionManagement/test/common/allowedExtensionsService.test.ts","vs/platform/extensionManagement/test/common/allowedExtensionsService.test.ts"],"names":[],"mappings":"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","file":"allowedExtensionsService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { AllowedExtensionsService } from '../../common/allowedExtensionsService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { TestConfigurationService } from '../../../configuration/test/common/testConfigurationService.js';\nimport { AllowedExtensionsConfigKey, IGalleryExtension, ILocalExtension } from '../../common/extensionManagement.js';\nimport { ExtensionType, IExtensionManifest, TargetPlatform } from '../../../extensions/common/extensions.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { ConfigurationTarget } from '../../../configuration/common/configuration.js';\nimport { getGalleryExtensionId } from '../../common/extensionManagementUtil.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IStringDictionary } from '../../../../base/common/collections.js';\n\nsuite('AllowedExtensionsService', () => {\n\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst configurationService = new TestConfigurationService();\n\n\tsetup(() => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, '*');\n\t});\n\n\ttest('should allow all extensions if no allowed extensions are configured', () => {\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should not allow specific extension if not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should allow specific extension if in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should not allow pre-release extension if only stable is allowed', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow pre-release extension if pre-release is allowed', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, true);\n\t});\n\n\ttest('should allow specific version of an extension when configured to that version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow any version of an extension when a specific version is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should allow any version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should allow a version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow a pre-release version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow specific version of an extension when configured to multiple versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3', '2.0.1', '3.1.2'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow platform specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_X64 }) === true, true);\n\t});\n\n\ttest('should allow universal platform specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.UNIVERSAL }) === true, true);\n\t});\n\n\ttest('should allow specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow platform specific version of an extension when configured to multiple versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.0.0', '1.2.3@darwin-x64', '1.2.3@darwin-arm64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_X64 }) === true, true);\n\t});\n\n\ttest('should not allow platform specific version of an extension when configured to different platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_ARM64 }) === true, false);\n\t});\n\n\ttest('should specific version of an extension when configured to different versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.0.0', '1.2.3@darwin-x64', '1.2.3@darwin-arm64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.0.1' }) === true, false);\n\t});\n\n\ttest('should allow extension if publisher is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should allow extension if publisher is not in allowed list and has publisher mapping', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(['hello']), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: 'Hello' }), true);\n\t});\n\n\ttest('should allow extension if publisher is not in allowed list and has different publisher mapping', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(['bar']), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: 'Hello' }) === true, false);\n\t});\n\n\ttest('should not allow extension if publisher is not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should not allow prerelease extension if publisher is allowed only to stable', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow extension if publisher is set to random value', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': 'hello' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, true);\n\t});\n\n\ttest('should allow extension if only wildcard is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should allow extension if wildcard is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true, 'hello': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should not allow extension if wildcard is not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': false, 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should allow a gallery extension', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'pub': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed(aGalleryExtension('name')) === true, true);\n\t});\n\n\ttest('should allow a local extension', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'pub': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed(aLocalExtension('pub.name')) === true, true);\n\t});\n\n\ttest('should trigger change event when allowed list change', async () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tconst promise = Event.toPromise(testObject.onDidChangeAllowedExtensionsConfigValue);\n\t\tconfigurationService.onDidChangeConfigurationEmitter.fire({ affectsConfiguration: () => true, affectedKeys: new Set([AllowedExtensionsConfigKey]), change: { keys: [], overrides: [] }, source: ConfigurationTarget.USER });\n\t\tawait promise;\n\t});\n\n\tfunction aProductService(extensionPublisherOrgs?: string[]): IProductService {\n\t\treturn {\n\t\t\t_serviceBrand: undefined,\n\t\t\textensionPublisherOrgs\n\t\t} as IProductService;\n\t}\n\n\tfunction aGalleryExtension(name: string, properties: Partial<IGalleryExtension> = {}, galleryExtensionProperties: IStringDictionary<unknown> = {}): IGalleryExtension {\n\t\tconst galleryExtension = <IGalleryExtension>Object.create({ type: 'gallery', name, publisher: 'pub', publisherDisplayName: 'Pub', version: '1.0.0', allTargetPlatforms: [TargetPlatform.UNIVERSAL], properties: {}, assets: {}, isSigned: true, ...properties });\n\t\tgalleryExtension.properties = { ...galleryExtension.properties, dependencies: [], ...galleryExtensionProperties };\n\t\tgalleryExtension.identifier = { id: getGalleryExtensionId(galleryExtension.publisher, galleryExtension.name), uuid: generateUuid() };\n\t\treturn <IGalleryExtension>galleryExtension;\n\t}\n\n\tfunction aLocalExtension(id: string, manifest: Partial<IExtensionManifest> = {}, properties: IStringDictionary<unknown> = {}): ILocalExtension {\n\t\tconst [publisher, name] = id.split('.');\n\t\tmanifest = { name, publisher, ...manifest };\n\t\tproperties = {\n\t\t\tidentifier: { id },\n\t\t\tlocation: URI.file(`pub.${name}`),\n\t\t\tgalleryIdentifier: { id, uuid: undefined },\n\t\t\ttype: ExtensionType.User,\n\t\t\t...properties,\n\t\t\tisValid: properties.isValid ?? true,\n\t\t};\n\t\tproperties.isBuiltin = properties.type === ExtensionType.System;\n\t\treturn <ILocalExtension>Object.create({ manifest, ...properties });\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { AllowedExtensionsService } from '../../common/allowedExtensionsService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { TestConfigurationService } from '../../../configuration/test/common/testConfigurationService.js';\nimport { AllowedExtensionsConfigKey, IGalleryExtension, ILocalExtension } from '../../common/extensionManagement.js';\nimport { ExtensionType, IExtensionManifest, TargetPlatform } from '../../../extensions/common/extensions.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { ConfigurationTarget } from '../../../configuration/common/configuration.js';\nimport { getGalleryExtensionId } from '../../common/extensionManagementUtil.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IStringDictionary } from '../../../../base/common/collections.js';\n\nsuite('AllowedExtensionsService', () => {\n\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst configurationService = new TestConfigurationService();\n\n\tsetup(() => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, '*');\n\t});\n\n\ttest('should allow all extensions if no allowed extensions are configured', () => {\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should not allow specific extension if not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should allow specific extension if in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should not allow pre-release extension if only stable is allowed', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow pre-release extension if pre-release is allowed', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, true);\n\t});\n\n\ttest('should allow specific version of an extension when configured to that version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow any version of an extension when a specific version is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should allow any version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, true);\n\t});\n\n\ttest('should allow a version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow a pre-release version of an extension when stable is configured', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow specific version of an extension when configured to multiple versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3', '2.0.1', '3.1.2'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow platform specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_X64 }) === true, true);\n\t});\n\n\ttest('should allow universal platform specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.UNIVERSAL }) === true, true);\n\t});\n\n\ttest('should allow specific version of an extension when configured to platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3' }) === true, true);\n\t});\n\n\ttest('should allow platform specific version of an extension when configured to multiple versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.0.0', '1.2.3@darwin-x64', '1.2.3@darwin-arm64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_X64 }) === true, true);\n\t});\n\n\ttest('should not allow platform specific version of an extension when configured to different platform specific version', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.2.3@darwin-x64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.2.3', targetPlatform: TargetPlatform.DARWIN_ARM64 }) === true, false);\n\t});\n\n\ttest('should specific version of an extension when configured to different versions', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test.extension': ['1.0.0', '1.2.3@darwin-x64', '1.2.3@darwin-arm64'] });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, version: '1.0.1' }) === true, false);\n\t});\n\n\ttest('should allow extension if publisher is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should allow extension if publisher is not in allowed list and has publisher mapping', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(['hello']), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: 'Hello' }), true);\n\t});\n\n\ttest('should allow extension if publisher is not in allowed list and has different publisher mapping', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(['bar']), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: 'Hello' }) === true, false);\n\t});\n\n\ttest('should not allow extension if publisher is not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should not allow prerelease extension if publisher is allowed only to stable', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': 'stable' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, false);\n\t});\n\n\ttest('should allow extension if publisher is set to random value', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'test': 'hello' });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined, prerelease: true }) === true, true);\n\t});\n\n\ttest('should allow extension if only wildcard is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should allow extension if wildcard is in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true, 'hello': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }), true);\n\t});\n\n\ttest('should not allow extension if wildcard is not in allowed list', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': false, 'hello': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed({ id: 'test.extension', publisherDisplayName: undefined }) === true, false);\n\t});\n\n\ttest('should allow a gallery extension', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'pub': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed(aGalleryExtension('name')) === true, true);\n\t});\n\n\ttest('should allow a local extension', () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { 'pub': true });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tassert.strictEqual(testObject.isAllowed(aLocalExtension('pub.name')) === true, true);\n\t});\n\n\ttest('should trigger change event when allowed list change', async () => {\n\t\tconfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': false });\n\t\tconst testObject = disposables.add(new AllowedExtensionsService(aProductService(), configurationService));\n\t\tconst promise = Event.toPromise(testObject.onDidChangeAllowedExtensionsConfigValue);\n\t\tconfigurationService.onDidChangeConfigurationEmitter.fire({ affectsConfiguration: () => true, affectedKeys: new Set([AllowedExtensionsConfigKey]), change: { keys: [], overrides: [] }, source: ConfigurationTarget.USER });\n\t\tawait promise;\n\t});\n\n\tfunction aProductService(extensionPublisherOrgs?: string[]): IProductService {\n\t\treturn {\n\t\t\t_serviceBrand: undefined,\n\t\t\textensionPublisherOrgs\n\t\t} as IProductService;\n\t}\n\n\tfunction aGalleryExtension(name: string, properties: Partial<IGalleryExtension> = {}, galleryExtensionProperties: IStringDictionary<unknown> = {}): IGalleryExtension {\n\t\tconst galleryExtension = <IGalleryExtension>Object.create({ type: 'gallery', name, publisher: 'pub', publisherDisplayName: 'Pub', version: '1.0.0', allTargetPlatforms: [TargetPlatform.UNIVERSAL], properties: {}, assets: {}, isSigned: true, ...properties });\n\t\tgalleryExtension.properties = { ...galleryExtension.properties, dependencies: [], ...galleryExtensionProperties };\n\t\tgalleryExtension.identifier = { id: getGalleryExtensionId(galleryExtension.publisher, galleryExtension.name), uuid: generateUuid() };\n\t\treturn <IGalleryExtension>galleryExtension;\n\t}\n\n\tfunction aLocalExtension(id: string, manifest: Partial<IExtensionManifest> = {}, properties: IStringDictionary<unknown> = {}): ILocalExtension {\n\t\tconst [publisher, name] = id.split('.');\n\t\tmanifest = { name, publisher, ...manifest };\n\t\tproperties = {\n\t\t\tidentifier: { id },\n\t\t\tlocation: URI.file(`pub.${name}`),\n\t\t\tgalleryIdentifier: { id, uuid: undefined },\n\t\t\ttype: ExtensionType.User,\n\t\t\t...properties,\n\t\t\tisValid: properties.isValid ?? true,\n\t\t};\n\t\tproperties.isBuiltin = properties.type === ExtensionType.System;\n\t\treturn <ILocalExtension>Object.create({ manifest, ...properties });\n\t}\n});\n"]}