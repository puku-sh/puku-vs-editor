{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/extensionManagement/test/common/extensionsProfileScannerService.test.ts","vs/platform/extensionManagement/test/common/extensionsProfileScannerService.test.ts"],"names":[],"mappings":"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","file":"extensionsProfileScannerService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { AbstractExtensionsProfileScannerService, ProfileExtensionsEvent } from '../../common/extensionsProfileScannerService.js';\nimport { ExtensionType, IExtension, IExtensionManifest, TargetPlatform } from '../../../extensions/common/extensions.js';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { IFileService } from '../../../files/common/files.js';\nimport { InMemoryFileSystemProvider } from '../../../files/common/inMemoryFilesystemProvider.js';\nimport { TestInstantiationService } from '../../../instantiation/test/common/instantiationServiceMock.js';\nimport { ILogService, NullLogService } from '../../../log/common/log.js';\nimport { ITelemetryService } from '../../../telemetry/common/telemetry.js';\nimport { NullTelemetryService } from '../../../telemetry/common/telemetryUtils.js';\nimport { IUriIdentityService } from '../../../uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { IUserDataProfilesService, UserDataProfilesService } from '../../../userDataProfile/common/userDataProfile.js';\n\nclass TestObject extends AbstractExtensionsProfileScannerService { }\n\nsuite('ExtensionsProfileScannerService', () => {\n\n\tconst ROOT = URI.file('/ROOT');\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst extensionsLocation = joinPath(ROOT, 'extensions');\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(async () => {\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = disposables.add(new FileService(logService));\n\t\tconst fileSystemProvider = disposables.add(new InMemoryFileSystemProvider());\n\t\tdisposables.add(fileService.registerProvider(ROOT.scheme, fileSystemProvider));\n\t\tinstantiationService.stub(ILogService, logService);\n\t\tinstantiationService.stub(IFileService, fileService);\n\t\tinstantiationService.stub(ITelemetryService, NullTelemetryService);\n\t\tconst uriIdentityService = instantiationService.stub(IUriIdentityService, disposables.add(new UriIdentityService(fileService)));\n\t\tconst environmentService = instantiationService.stub(IEnvironmentService, { userRoamingDataHome: ROOT, cacheHome: joinPath(ROOT, 'cache'), });\n\t\tconst userDataProfilesService = disposables.add(new UserDataProfilesService(environmentService, fileService, uriIdentityService, logService));\n\t\tinstantiationService.stub(IUserDataProfilesService, userDataProfilesService);\n\t});\n\n\tsuiteTeardown(() => sinon.restore());\n\n\ttest('write extensions located in the same extensions folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t});\n\n\ttest('write extensions located in the different folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t});\n\n\ttest('write extensions located in the same extensions folder has relative location ', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(actual, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('write extensions located in different extensions folder does not has relative location ', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(actual, [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is read and migrated', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is not migrated if not exists in same location', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is read and migrated during write', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst extension2 = aExtension('pub.b', joinPath(extensionsLocation, 'pub.b-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension2, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }\n\t\t]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), relativeLocation: 'pub.b-1.0.0', version: extension2.manifest.version }\n\t\t]);\n\t});\n\n\ttest('extensions in old format and new format is read and migrated', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tconst extension2 = aExtension('pub.b', joinPath(extensionsLocation, 'pub.b-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}, {\n\t\t\tidentifier: extension2.identifier,\n\t\t\tlocation: extension2.location.toJSON(),\n\t\t\trelativeLocation: 'pub.b-1.0.0',\n\t\t\tversion: extension2.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }\n\t\t]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), relativeLocation: 'pub.b-1.0.0', version: extension2.manifest.version }\n\t\t]);\n\t});\n\n\ttest('throws error if extension has invalid relativePath', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 2\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no location', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 'pub.a-1.0.0'\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension location is invalid', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: {},\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 'pub.a-1.0.0'\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no identifier', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension identifier is invalid', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: 'pub.a',\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no version', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('read extension when manifest is empty', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(''));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('read extension when manifest has empty lines and spaces', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(`\n\n\n\t\t`));\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('read extension when the relative location is empty', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\trelativeLocation: '',\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('add extension trigger events', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onDidAddExtensions(target2));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension.location.toString());\n\t});\n\n\ttest('remove extensions trigger events', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tdisposables.add(testObject.onRemoveExtensions(target1));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target2));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tconst extension2 = aExtension('pub.b', joinPath(ROOT, 'foo', 'pub.b-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined], [extension2, undefined]], extensionsManifest);\n\t\tawait testObject.removeExtensionsFromProfile([extension1.identifier, extension2.identifier], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.length, 0);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 2);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 2);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].location.toString(), extension2.location.toString());\n\t});\n\n\ttest('add extension with same id but different version', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tconst extension2 = aExtension('pub.a', joinPath(ROOT, 'pub.a-2.0.0'), undefined, { version: '2.0.0' });\n\t\tawait testObject.addExtensionsToProfile([[extension2, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\n\t\tassert.ok(target3.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target4.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t});\n\n\ttest('add same extension', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('add same extension with different metadata', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension, { isApplicationScoped: true }]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON(), metadata: a.metadata })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: { isApplicationScoped: true } }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('add extension with different version and metadata', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined]], extensionsManifest);\n\t\tconst extension2 = aExtension('pub.a', joinPath(ROOT, 'pub.a-2.0.0'), undefined, { version: '2.0.0' });\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension2, { isApplicationScoped: true }]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON(), metadata: a.metadata })), [{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: { isApplicationScoped: true } }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\n\t\tassert.ok(target3.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target4.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t});\n\n\ttest('add extension with same id and version located in the different folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tlet extension = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\textension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('read extension when uuid is different in identifier and manifest', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: {\n\t\t\t\tid: 'pub.a',\n\t\t\t\tuuid: 'uuid1`'\n\t\t\t},\n\t\t\tversion: '1.0.0',\n\t\t\tlocation: joinPath(extensionsLocation, 'pub.a-1.0.0').toString(),\n\t\t\trelativeLocation: 'pub.a-1.0.0',\n\t\t\tmetadata: {\n\t\t\t\tid: 'uuid',\n\t\t\t}\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.length, 1);\n\t\tassert.deepStrictEqual(actual[0].identifier.id, 'pub.a');\n\t\tassert.deepStrictEqual(actual[0].identifier.uuid, 'uuid');\n\t});\n\n\tfunction aExtension(id: string, location: URI, e?: Partial<IExtension>, manifest?: Partial<IExtensionManifest>): IExtension {\n\t\treturn {\n\t\t\tidentifier: { id },\n\t\t\tlocation,\n\t\t\ttype: ExtensionType.User,\n\t\t\ttargetPlatform: TargetPlatform.DARWIN_X64,\n\t\t\tisBuiltin: false,\n\t\t\tmanifest: {\n\t\t\t\tname: 'name',\n\t\t\t\tpublisher: 'publisher',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tengines: { vscode: '1.0.0' },\n\t\t\t\t...manifest,\n\t\t\t},\n\t\t\tisValid: true,\n\t\t\tpreRelease: false,\n\t\t\tvalidations: [],\n\t\t\t...e\n\t\t};\n\t}\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { AbstractExtensionsProfileScannerService, ProfileExtensionsEvent } from '../../common/extensionsProfileScannerService.js';\nimport { ExtensionType, IExtension, IExtensionManifest, TargetPlatform } from '../../../extensions/common/extensions.js';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { IFileService } from '../../../files/common/files.js';\nimport { InMemoryFileSystemProvider } from '../../../files/common/inMemoryFilesystemProvider.js';\nimport { TestInstantiationService } from '../../../instantiation/test/common/instantiationServiceMock.js';\nimport { ILogService, NullLogService } from '../../../log/common/log.js';\nimport { ITelemetryService } from '../../../telemetry/common/telemetry.js';\nimport { NullTelemetryService } from '../../../telemetry/common/telemetryUtils.js';\nimport { IUriIdentityService } from '../../../uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { IUserDataProfilesService, UserDataProfilesService } from '../../../userDataProfile/common/userDataProfile.js';\n\nclass TestObject extends AbstractExtensionsProfileScannerService { }\n\nsuite('ExtensionsProfileScannerService', () => {\n\n\tconst ROOT = URI.file('/ROOT');\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst extensionsLocation = joinPath(ROOT, 'extensions');\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(async () => {\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = disposables.add(new FileService(logService));\n\t\tconst fileSystemProvider = disposables.add(new InMemoryFileSystemProvider());\n\t\tdisposables.add(fileService.registerProvider(ROOT.scheme, fileSystemProvider));\n\t\tinstantiationService.stub(ILogService, logService);\n\t\tinstantiationService.stub(IFileService, fileService);\n\t\tinstantiationService.stub(ITelemetryService, NullTelemetryService);\n\t\tconst uriIdentityService = instantiationService.stub(IUriIdentityService, disposables.add(new UriIdentityService(fileService)));\n\t\tconst environmentService = instantiationService.stub(IEnvironmentService, { userRoamingDataHome: ROOT, cacheHome: joinPath(ROOT, 'cache'), });\n\t\tconst userDataProfilesService = disposables.add(new UserDataProfilesService(environmentService, fileService, uriIdentityService, logService));\n\t\tinstantiationService.stub(IUserDataProfilesService, userDataProfilesService);\n\t});\n\n\tsuiteTeardown(() => sinon.restore());\n\n\ttest('write extensions located in the same extensions folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t});\n\n\ttest('write extensions located in the different folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t});\n\n\ttest('write extensions located in the same extensions folder has relative location ', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(actual, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('write extensions located in different extensions folder does not has relative location ', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(actual, [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is read and migrated', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is not migrated if not exists in same location', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version }]);\n\t});\n\n\ttest('extension in old format is read and migrated during write', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst extension2 = aExtension('pub.b', joinPath(extensionsLocation, 'pub.b-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension2, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }\n\t\t]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), relativeLocation: 'pub.b-1.0.0', version: extension2.manifest.version }\n\t\t]);\n\t});\n\n\ttest('extensions in old format and new format is read and migrated', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tconst extension2 = aExtension('pub.b', joinPath(extensionsLocation, 'pub.b-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}, {\n\t\t\tidentifier: extension2.identifier,\n\t\t\tlocation: extension2.location.toJSON(),\n\t\t\trelativeLocation: 'pub.b-1.0.0',\n\t\t\tversion: extension2.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }\n\t\t]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [\n\t\t\t{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version },\n\t\t\t{ identifier: extension2.identifier, location: extension2.location.toJSON(), relativeLocation: 'pub.b-1.0.0', version: extension2.manifest.version }\n\t\t]);\n\t});\n\n\ttest('throws error if extension has invalid relativePath', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 2\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no location', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 'pub.a-1.0.0'\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension location is invalid', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: {},\n\t\t\tversion: extension.manifest.version,\n\t\t\trelativePath: 'pub.a-1.0.0'\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no identifier', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension identifier is invalid', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: 'pub.a',\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('throws error if extension has no version', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\ttry {\n\t\t\tawait testObject.scanProfileExtensions(extensionsManifest);\n\t\t\tassert.fail('Should throw error');\n\t\t} catch (error) { /*expected*/ }\n\t});\n\n\ttest('read extension when manifest is empty', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(''));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('read extension when manifest has empty lines and spaces', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(`\n\n\n\t\t`));\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('read extension when the relative location is empty', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(extensionsLocation, 'pub.a-1.0.0'));\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: extension.identifier,\n\t\t\tlocation: extension.location.toJSON(),\n\t\t\trelativeLocation: '',\n\t\t\tversion: extension.manifest.version,\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tconst manifestContent = JSON.parse((await instantiationService.get(IFileService).readFile(extensionsManifest)).value.toString());\n\t\tassert.deepStrictEqual(manifestContent, [{ identifier: extension.identifier, location: extension.location.toJSON(), relativeLocation: 'pub.a-1.0.0', version: extension.manifest.version }]);\n\t});\n\n\ttest('add extension trigger events', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onDidAddExtensions(target2));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension.location.toString());\n\t});\n\n\ttest('remove extensions trigger events', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tdisposables.add(testObject.onRemoveExtensions(target1));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target2));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tconst extension2 = aExtension('pub.b', joinPath(ROOT, 'foo', 'pub.b-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined], [extension2, undefined]], extensionsManifest);\n\t\tawait testObject.removeExtensionsFromProfile([extension1.identifier, extension2.identifier], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.length, 0);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 2);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[1].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 2);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[1].location.toString(), extension2.location.toString());\n\t});\n\n\ttest('add extension with same id but different version', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tconst extension2 = aExtension('pub.a', joinPath(ROOT, 'pub.a-2.0.0'), undefined, { version: '2.0.0' });\n\t\tawait testObject.addExtensionsToProfile([[extension2, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: undefined }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\n\t\tassert.ok(target3.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target4.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t});\n\n\ttest('add same extension', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('add same extension with different metadata', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension, { isApplicationScoped: true }]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON(), metadata: a.metadata })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: { isApplicationScoped: true } }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('add extension with different version and metadata', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tconst extension1 = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension1, undefined]], extensionsManifest);\n\t\tconst extension2 = aExtension('pub.a', joinPath(ROOT, 'pub.a-2.0.0'), undefined, { version: '2.0.0' });\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\tawait testObject.addExtensionsToProfile([[extension2, { isApplicationScoped: true }]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON(), metadata: a.metadata })), [{ identifier: extension2.identifier, location: extension2.location.toJSON(), version: extension2.manifest.version, metadata: { isApplicationScoped: true } }]);\n\n\t\tassert.ok(target1.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target2.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\n\t\tassert.ok(target3.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].identifier, extension2.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].version, extension2.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target1.args[0][0])).extensions[0].location.toString(), extension2.location.toString());\n\n\t\tassert.ok(target4.calledOnce);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).profileLocation.toString(), extensionsManifest.toString());\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions.length, 1);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].identifier, extension1.identifier);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].version, extension1.manifest.version);\n\t\tassert.deepStrictEqual((<ProfileExtensionsEvent>(target2.args[0][0])).extensions[0].location.toString(), extension1.location.toString());\n\t});\n\n\ttest('add extension with same id and version located in the different folder', async () => {\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\n\t\tlet extension = aExtension('pub.a', joinPath(ROOT, 'foo', 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst target1 = sinon.stub();\n\t\tconst target2 = sinon.stub();\n\t\tconst target3 = sinon.stub();\n\t\tconst target4 = sinon.stub();\n\t\tdisposables.add(testObject.onAddExtensions(target1));\n\t\tdisposables.add(testObject.onRemoveExtensions(target2));\n\t\tdisposables.add(testObject.onDidAddExtensions(target3));\n\t\tdisposables.add(testObject.onDidRemoveExtensions(target4));\n\t\textension = aExtension('pub.a', joinPath(ROOT, 'pub.a-1.0.0'));\n\t\tawait testObject.addExtensionsToProfile([[extension, undefined]], extensionsManifest);\n\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.map(a => ({ ...a, location: a.location.toJSON() })), [{ identifier: extension.identifier, location: extension.location.toJSON(), version: extension.manifest.version, metadata: undefined }]);\n\t\tassert.ok(target1.notCalled);\n\t\tassert.ok(target2.notCalled);\n\t\tassert.ok(target3.notCalled);\n\t\tassert.ok(target4.notCalled);\n\t});\n\n\ttest('read extension when uuid is different in identifier and manifest', async () => {\n\t\tconst extensionsManifest = joinPath(extensionsLocation, 'extensions.json');\n\t\tawait instantiationService.get(IFileService).writeFile(extensionsManifest, VSBuffer.fromString(JSON.stringify([{\n\t\t\tidentifier: {\n\t\t\t\tid: 'pub.a',\n\t\t\t\tuuid: 'uuid1`'\n\t\t\t},\n\t\t\tversion: '1.0.0',\n\t\t\tlocation: joinPath(extensionsLocation, 'pub.a-1.0.0').toString(),\n\t\t\trelativeLocation: 'pub.a-1.0.0',\n\t\t\tmetadata: {\n\t\t\t\tid: 'uuid',\n\t\t\t}\n\t\t}])));\n\n\t\tconst testObject = disposables.add(instantiationService.createInstance(TestObject, extensionsLocation));\n\t\tconst actual = await testObject.scanProfileExtensions(extensionsManifest);\n\t\tassert.deepStrictEqual(actual.length, 1);\n\t\tassert.deepStrictEqual(actual[0].identifier.id, 'pub.a');\n\t\tassert.deepStrictEqual(actual[0].identifier.uuid, 'uuid');\n\t});\n\n\tfunction aExtension(id: string, location: URI, e?: Partial<IExtension>, manifest?: Partial<IExtensionManifest>): IExtension {\n\t\treturn {\n\t\t\tidentifier: { id },\n\t\t\tlocation,\n\t\t\ttype: ExtensionType.User,\n\t\t\ttargetPlatform: TargetPlatform.DARWIN_X64,\n\t\t\tisBuiltin: false,\n\t\t\tmanifest: {\n\t\t\t\tname: 'name',\n\t\t\t\tpublisher: 'publisher',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tengines: { vscode: '1.0.0' },\n\t\t\t\t...manifest,\n\t\t\t},\n\t\t\tisValid: true,\n\t\t\tpreRelease: false,\n\t\t\tvalidations: [],\n\t\t\t...e\n\t\t};\n\t}\n\n});\n"]}