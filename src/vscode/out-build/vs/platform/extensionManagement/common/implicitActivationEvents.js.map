{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/extensionManagement/common/implicitActivationEvents.ts","vs/platform/extensionManagement/common/implicitActivationEvents.ts"],"names":[],"mappings":"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","file":"implicitActivationEvents.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../extensions/common/extensions.js';\n\nexport interface IActivationEventsGenerator<T> {\n\t(contributions: readonly T[]): Iterable<string>;\n}\n\nexport class ImplicitActivationEventsImpl {\n\n\tprivate readonly _generators = new Map<string, IActivationEventsGenerator<unknown>>();\n\tprivate readonly _cache = new WeakMap<IExtensionDescription, string[]>();\n\n\tpublic register<T>(extensionPointName: string, generator: IActivationEventsGenerator<T>): void {\n\t\tthis._generators.set(extensionPointName, generator as IActivationEventsGenerator<unknown>);\n\t}\n\n\t/**\n\t * This can run correctly only on the renderer process because that is the only place\n\t * where all extension points and all implicit activation events generators are known.\n\t */\n\tpublic readActivationEvents(extensionDescription: IExtensionDescription): string[] {\n\t\tif (!this._cache.has(extensionDescription)) {\n\t\t\tthis._cache.set(extensionDescription, this._readActivationEvents(extensionDescription));\n\t\t}\n\t\treturn this._cache.get(extensionDescription)!;\n\t}\n\n\t/**\n\t * This can run correctly only on the renderer process because that is the only place\n\t * where all extension points and all implicit activation events generators are known.\n\t */\n\tpublic createActivationEventsMap(extensionDescriptions: IExtensionDescription[]): { [extensionId: string]: string[] } {\n\t\tconst result: { [extensionId: string]: string[] } = Object.create(null);\n\t\tfor (const extensionDescription of extensionDescriptions) {\n\t\t\tconst activationEvents = this.readActivationEvents(extensionDescription);\n\t\t\tif (activationEvents.length > 0) {\n\t\t\t\tresult[ExtensionIdentifier.toKey(extensionDescription.identifier)] = activationEvents;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _readActivationEvents(desc: IExtensionDescription): string[] {\n\t\tif (typeof desc.main === 'undefined' && typeof desc.browser === 'undefined') {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst activationEvents: string[] = (Array.isArray(desc.activationEvents) ? desc.activationEvents.slice(0) : []);\n\n\t\tfor (let i = 0; i < activationEvents.length; i++) {\n\t\t\t// TODO@joao: there's no easy way to contribute this\n\t\t\tif (activationEvents[i] === 'onUri') {\n\t\t\t\tactivationEvents[i] = `onUri:${ExtensionIdentifier.toKey(desc.identifier)}`;\n\t\t\t}\n\t\t}\n\n\t\tif (!desc.contributes) {\n\t\t\t// no implicit activation events\n\t\t\treturn activationEvents;\n\t\t}\n\n\t\tfor (const extPointName in desc.contributes) {\n\t\t\tconst generator = this._generators.get(extPointName);\n\t\t\tif (!generator) {\n\t\t\t\t// There's no generator for this extension point\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst contrib = (desc.contributes as IStringDictionary<unknown>)[extPointName];\n\t\t\tconst contribArr = Array.isArray(contrib) ? contrib : [contrib];\n\t\t\ttry {\n\t\t\t\tactivationEvents.push(...generator(contribArr));\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\treturn activationEvents;\n\t}\n}\n\nexport const ImplicitActivationEvents: ImplicitActivationEventsImpl = new ImplicitActivationEventsImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../extensions/common/extensions.js';\n\nexport interface IActivationEventsGenerator<T> {\n\t(contributions: readonly T[]): Iterable<string>;\n}\n\nexport class ImplicitActivationEventsImpl {\n\n\tprivate readonly _generators = new Map<string, IActivationEventsGenerator<unknown>>();\n\tprivate readonly _cache = new WeakMap<IExtensionDescription, string[]>();\n\n\tpublic register<T>(extensionPointName: string, generator: IActivationEventsGenerator<T>): void {\n\t\tthis._generators.set(extensionPointName, generator as IActivationEventsGenerator<unknown>);\n\t}\n\n\t/**\n\t * This can run correctly only on the renderer process because that is the only place\n\t * where all extension points and all implicit activation events generators are known.\n\t */\n\tpublic readActivationEvents(extensionDescription: IExtensionDescription): string[] {\n\t\tif (!this._cache.has(extensionDescription)) {\n\t\t\tthis._cache.set(extensionDescription, this._readActivationEvents(extensionDescription));\n\t\t}\n\t\treturn this._cache.get(extensionDescription)!;\n\t}\n\n\t/**\n\t * This can run correctly only on the renderer process because that is the only place\n\t * where all extension points and all implicit activation events generators are known.\n\t */\n\tpublic createActivationEventsMap(extensionDescriptions: IExtensionDescription[]): { [extensionId: string]: string[] } {\n\t\tconst result: { [extensionId: string]: string[] } = Object.create(null);\n\t\tfor (const extensionDescription of extensionDescriptions) {\n\t\t\tconst activationEvents = this.readActivationEvents(extensionDescription);\n\t\t\tif (activationEvents.length > 0) {\n\t\t\t\tresult[ExtensionIdentifier.toKey(extensionDescription.identifier)] = activationEvents;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _readActivationEvents(desc: IExtensionDescription): string[] {\n\t\tif (typeof desc.main === 'undefined' && typeof desc.browser === 'undefined') {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst activationEvents: string[] = (Array.isArray(desc.activationEvents) ? desc.activationEvents.slice(0) : []);\n\n\t\tfor (let i = 0; i < activationEvents.length; i++) {\n\t\t\t// TODO@joao: there's no easy way to contribute this\n\t\t\tif (activationEvents[i] === 'onUri') {\n\t\t\t\tactivationEvents[i] = `onUri:${ExtensionIdentifier.toKey(desc.identifier)}`;\n\t\t\t}\n\t\t}\n\n\t\tif (!desc.contributes) {\n\t\t\t// no implicit activation events\n\t\t\treturn activationEvents;\n\t\t}\n\n\t\tfor (const extPointName in desc.contributes) {\n\t\t\tconst generator = this._generators.get(extPointName);\n\t\t\tif (!generator) {\n\t\t\t\t// There's no generator for this extension point\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst contrib = (desc.contributes as IStringDictionary<unknown>)[extPointName];\n\t\t\tconst contribArr = Array.isArray(contrib) ? contrib : [contrib];\n\t\t\ttry {\n\t\t\t\tactivationEvents.push(...generator(contribArr));\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\treturn activationEvents;\n\t}\n}\n\nexport const ImplicitActivationEvents: ImplicitActivationEventsImpl = new ImplicitActivationEventsImpl();\n"]}