{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/theme/electron-main/themeMainServiceImpl.ts","vs/platform/theme/electron-main/themeMainServiceImpl.ts"],"names":[],"mappings":"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","file":"themeMainServiceImpl.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport electron from 'electron';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isLinux, isMacintosh, isWindows } from '../../../base/common/platform.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IStateService } from '../../state/node/state.js';\nimport { IPartsSplash } from '../common/themeService.js';\nimport { IColorScheme } from '../../window/common/window.js';\nimport { ThemeTypeSelector } from '../common/theme.js';\nimport { ISingleFolderWorkspaceIdentifier, IWorkspaceIdentifier } from '../../workspace/common/workspace.js';\nimport { coalesce } from '../../../base/common/arrays.js';\nimport { getAllWindowsExcludingOffscreen } from '../../windows/electron-main/windows.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IThemeMainService } from './themeMainService.js';\n\n// These default colors match our default themes\n// editor background color (\"Dark Modern\", etc...)\nconst DEFAULT_BG_LIGHT = '#FFFFFF';\nconst DEFAULT_BG_DARK = '#1F1F1F';\nconst DEFAULT_BG_HC_BLACK = '#000000';\nconst DEFAULT_BG_HC_LIGHT = '#FFFFFF';\n\nconst THEME_STORAGE_KEY = 'theme';\nconst THEME_BG_STORAGE_KEY = 'themeBackground';\n\nconst THEME_WINDOW_SPLASH_KEY = 'windowSplash';\nconst THEME_WINDOW_SPLASH_OVERRIDE_KEY = 'windowSplashWorkspaceOverride';\n\nconst AUXILIARYBAR_DEFAULT_VISIBILITY = 'workbench.secondarySideBar.defaultVisibility';\n\nnamespace ThemeSettings {\n\texport const DETECT_COLOR_SCHEME = 'window.autoDetectColorScheme';\n\texport const DETECT_HC = 'window.autoDetectHighContrast';\n\texport const SYSTEM_COLOR_THEME = 'window.systemColorTheme';\n}\n\ninterface IPartSplashOverrideWorkspaces {\n\t[workspaceId: string]: {\n\t\tsideBarVisible: boolean;\n\t\tauxiliaryBarVisible: boolean;\n\t};\n}\n\ninterface IPartsSplashOverride {\n\tlayoutInfo: {\n\t\tsideBarWidth: number;\n\t\tauxiliaryBarWidth: number;\n\n\t\tworkspaces: IPartSplashOverrideWorkspaces;\n\t};\n}\n\nexport class ThemeMainService extends Disposable implements IThemeMainService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static readonly DEFAULT_BAR_WIDTH = 300;\n\n\tprivate static readonly WORKSPACE_OVERRIDE_LIMIT = 50;\n\n\tprivate readonly _onDidChangeColorScheme = this._register(new Emitter<IColorScheme>());\n\treadonly onDidChangeColorScheme = this._onDidChangeColorScheme.event;\n\n\tconstructor(\n\t\t@IStateService private stateService: IStateService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@ILogService private logService: ILogService\n\t) {\n\t\tsuper();\n\n\t\t// System Theme\n\t\tif (!isLinux) {\n\t\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\t\tif (e.affectsConfiguration(ThemeSettings.SYSTEM_COLOR_THEME) || e.affectsConfiguration(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\t\t\tthis.updateSystemColorTheme();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tthis.updateSystemColorTheme();\n\n\t\t// Color Scheme changes\n\t\tthis._register(Event.fromNodeEventEmitter(electron.nativeTheme, 'updated')(() => this._onDidChangeColorScheme.fire(this.getColorScheme())));\n\t}\n\n\tprivate updateSystemColorTheme(): void {\n\t\tif (isLinux || this.configurationService.getValue(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\telectron.nativeTheme.themeSource = 'system'; // only with `system` we can detect the system color scheme\n\t\t} else {\n\t\t\tswitch (this.configurationService.getValue<'default' | 'auto' | 'light' | 'dark'>(ThemeSettings.SYSTEM_COLOR_THEME)) {\n\t\t\t\tcase 'dark':\n\t\t\t\t\telectron.nativeTheme.themeSource = 'dark';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'light':\n\t\t\t\t\telectron.nativeTheme.themeSource = 'light';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auto':\n\t\t\t\t\tswitch (this.getPreferredBaseTheme() ?? this.getStoredBaseTheme()) {\n\t\t\t\t\t\tcase ThemeTypeSelector.VS: electron.nativeTheme.themeSource = 'light'; break;\n\t\t\t\t\t\tcase ThemeTypeSelector.VS_DARK: electron.nativeTheme.themeSource = 'dark'; break;\n\t\t\t\t\t\tdefault: electron.nativeTheme.themeSource = 'system';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\telectron.nativeTheme.themeSource = 'system';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetColorScheme(): IColorScheme {\n\n\t\t// high contrast is reflected by the shouldUseInvertedColorScheme property\n\t\tif (isWindows) {\n\t\t\tif (electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\t// shouldUseInvertedColorScheme is dark, !shouldUseInvertedColorScheme is light\n\t\t\t\treturn { dark: electron.nativeTheme.shouldUseInvertedColorScheme, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\t// high contrast is set if one of shouldUseInvertedColorScheme or shouldUseHighContrastColors is set,\n\t\t// reflecting the 'Invert colours' and `Increase contrast` settings in MacOS\n\t\telse if (isMacintosh) {\n\t\t\tif (electron.nativeTheme.shouldUseInvertedColorScheme || electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\treturn { dark: electron.nativeTheme.shouldUseDarkColors, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\t// ubuntu gnome seems to have 3 states, light dark and high contrast\n\t\telse if (isLinux) {\n\t\t\tif (electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\treturn { dark: true, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdark: electron.nativeTheme.shouldUseDarkColors,\n\t\t\thighContrast: false\n\t\t};\n\t}\n\n\tgetPreferredBaseTheme(): ThemeTypeSelector | undefined {\n\t\tconst colorScheme = this.getColorScheme();\n\t\tif (this.configurationService.getValue(ThemeSettings.DETECT_HC) && colorScheme.highContrast) {\n\t\t\treturn colorScheme.dark ? ThemeTypeSelector.HC_BLACK : ThemeTypeSelector.HC_LIGHT;\n\t\t}\n\n\t\tif (this.configurationService.getValue(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\treturn colorScheme.dark ? ThemeTypeSelector.VS_DARK : ThemeTypeSelector.VS;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetBackgroundColor(): string {\n\t\tconst preferred = this.getPreferredBaseTheme();\n\t\tconst stored = this.getStoredBaseTheme();\n\n\t\t// If the stored theme has the same base as the preferred, we can return the stored background\n\t\tif (preferred === undefined || preferred === stored) {\n\t\t\tconst storedBackground = this.stateService.getItem<string | null>(THEME_BG_STORAGE_KEY, null);\n\t\t\tif (storedBackground) {\n\t\t\t\treturn storedBackground;\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise we return the default background for the preferred base theme. If there's no preferred, use the stored one.\n\t\tswitch (preferred ?? stored) {\n\t\t\tcase ThemeTypeSelector.VS: return DEFAULT_BG_LIGHT;\n\t\t\tcase ThemeTypeSelector.HC_BLACK: return DEFAULT_BG_HC_BLACK;\n\t\t\tcase ThemeTypeSelector.HC_LIGHT: return DEFAULT_BG_HC_LIGHT;\n\t\t\tdefault: return DEFAULT_BG_DARK;\n\t\t}\n\t}\n\n\tprivate getStoredBaseTheme(): ThemeTypeSelector {\n\t\tconst baseTheme = this.stateService.getItem<ThemeTypeSelector>(THEME_STORAGE_KEY, ThemeTypeSelector.VS_DARK).split(' ')[0];\n\t\tswitch (baseTheme) {\n\t\t\tcase ThemeTypeSelector.VS: return ThemeTypeSelector.VS;\n\t\t\tcase ThemeTypeSelector.HC_BLACK: return ThemeTypeSelector.HC_BLACK;\n\t\t\tcase ThemeTypeSelector.HC_LIGHT: return ThemeTypeSelector.HC_LIGHT;\n\t\t\tdefault: return ThemeTypeSelector.VS_DARK;\n\t\t}\n\t}\n\n\tsaveWindowSplash(windowId: number | undefined, workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined, splash: IPartsSplash): void {\n\n\t\t// Update override as needed\n\t\tconst splashOverride = this.updateWindowSplashOverride(workspace, splash);\n\n\t\t// Update in storage\n\t\tthis.stateService.setItems(coalesce([\n\t\t\t{ key: THEME_STORAGE_KEY, data: splash.baseTheme },\n\t\t\t{ key: THEME_BG_STORAGE_KEY, data: splash.colorInfo.background },\n\t\t\t{ key: THEME_WINDOW_SPLASH_KEY, data: splash },\n\t\t\tsplashOverride ? { key: THEME_WINDOW_SPLASH_OVERRIDE_KEY, data: splashOverride } : undefined\n\t\t]));\n\n\t\t// Update in opened windows\n\t\tif (typeof windowId === 'number') {\n\t\t\tthis.updateBackgroundColor(windowId, splash);\n\t\t}\n\n\t\t// Update system theme\n\t\tthis.updateSystemColorTheme();\n\t}\n\n\tprivate updateWindowSplashOverride(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined, splash: IPartsSplash): IPartsSplashOverride | undefined {\n\t\tlet splashOverride: IPartsSplashOverride | undefined = undefined;\n\t\tlet changed = false;\n\t\tif (workspace) {\n\t\t\tsplashOverride = { ...this.getWindowSplashOverride() }; // make a copy for modifications\n\n\t\t\tchanged = this.doUpdateWindowSplashOverride(workspace, splash, splashOverride, 'sideBar');\n\t\t\tchanged = this.doUpdateWindowSplashOverride(workspace, splash, splashOverride, 'auxiliaryBar') || changed;\n\t\t}\n\n\t\treturn changed ? splashOverride : undefined;\n\t}\n\n\tprivate doUpdateWindowSplashOverride(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier, splash: IPartsSplash, splashOverride: IPartsSplashOverride, part: 'sideBar' | 'auxiliaryBar'): boolean {\n\t\tconst currentWidth = part === 'sideBar' ? splash.layoutInfo?.sideBarWidth : splash.layoutInfo?.auxiliaryBarWidth;\n\t\tconst overrideWidth = part === 'sideBar' ? splashOverride.layoutInfo.sideBarWidth : splashOverride.layoutInfo.auxiliaryBarWidth;\n\n\t\t// No layout info: remove override\n\t\tlet changed = false;\n\t\tif (typeof currentWidth !== 'number') {\n\t\t\tif (splashOverride.layoutInfo.workspaces[workspace.id]) {\n\t\t\t\tdelete splashOverride.layoutInfo.workspaces[workspace.id];\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\treturn changed;\n\t\t}\n\n\t\tlet workspaceOverride = splashOverride.layoutInfo.workspaces[workspace.id];\n\t\tif (!workspaceOverride) {\n\t\t\tconst workspaceEntries = Object.keys(splashOverride.layoutInfo.workspaces);\n\t\t\tif (workspaceEntries.length >= ThemeMainService.WORKSPACE_OVERRIDE_LIMIT) {\n\t\t\t\tdelete splashOverride.layoutInfo.workspaces[workspaceEntries[0]];\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\tworkspaceOverride = { sideBarVisible: false, auxiliaryBarVisible: false };\n\t\t\tsplashOverride.layoutInfo.workspaces[workspace.id] = workspaceOverride;\n\t\t\tchanged = true;\n\t\t}\n\n\t\t// Part has width: update width & visibility override\n\t\tif (currentWidth > 0) {\n\t\t\tif (overrideWidth !== currentWidth) {\n\t\t\t\tsplashOverride.layoutInfo[part === 'sideBar' ? 'sideBarWidth' : 'auxiliaryBarWidth'] = currentWidth;\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\tswitch (part) {\n\t\t\t\tcase 'sideBar':\n\t\t\t\t\tif (!workspaceOverride.sideBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.sideBarVisible = true;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auxiliaryBar':\n\t\t\t\t\tif (!workspaceOverride.auxiliaryBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.auxiliaryBarVisible = true;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Part is hidden: update visibility override\n\t\telse {\n\t\t\tswitch (part) {\n\t\t\t\tcase 'sideBar':\n\t\t\t\t\tif (workspaceOverride.sideBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.sideBarVisible = false;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auxiliaryBar':\n\t\t\t\t\tif (workspaceOverride.auxiliaryBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.auxiliaryBarVisible = false;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tprivate updateBackgroundColor(windowId: number, splash: IPartsSplash): void {\n\t\tfor (const window of getAllWindowsExcludingOffscreen()) {\n\t\t\tif (window.id === windowId) {\n\t\t\t\twindow.setBackgroundColor(splash.colorInfo.background);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWindowSplash(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined): IPartsSplash | undefined {\n\t\ttry {\n\t\t\treturn this.doGetWindowSplash(workspace);\n\t\t} catch (error) {\n\t\t\tthis.logService.error('[theme main service] Failed to get window splash', error);\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate doGetWindowSplash(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined): IPartsSplash | undefined {\n\t\tconst partSplash = this.stateService.getItem<IPartsSplash>(THEME_WINDOW_SPLASH_KEY);\n\t\tif (!partSplash?.layoutInfo) {\n\t\t\treturn partSplash; // return early: overrides currently only apply to layout info\n\t\t}\n\n\t\tconst override = this.getWindowSplashOverride();\n\n\t\t// Figure out side bar width based on workspace and overrides\n\t\tlet sideBarWidth: number;\n\t\tif (workspace) {\n\t\t\tif (override.layoutInfo.workspaces[workspace.id]?.sideBarVisible === false) {\n\t\t\t\tsideBarWidth = 0;\n\t\t\t} else {\n\t\t\t\tsideBarWidth = override.layoutInfo.sideBarWidth || partSplash.layoutInfo.sideBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t}\n\t\t} else {\n\t\t\tsideBarWidth = 0;\n\t\t}\n\n\t\t// Figure out auxiliary bar width based on workspace, configuration and overrides\n\t\tconst auxiliaryBarDefaultVisibility = this.configurationService.getValue(AUXILIARYBAR_DEFAULT_VISIBILITY) ?? 'visibleInWorkspace';\n\t\tlet auxiliaryBarWidth: number;\n\t\tif (workspace) {\n\t\t\tconst auxiliaryBarVisible = override.layoutInfo.workspaces[workspace.id]?.auxiliaryBarVisible;\n\t\t\tif (auxiliaryBarVisible === true) {\n\t\t\t\tauxiliaryBarWidth = override.layoutInfo.auxiliaryBarWidth || partSplash.layoutInfo.auxiliaryBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t} else if (auxiliaryBarVisible === false) {\n\t\t\t\tauxiliaryBarWidth = 0;\n\t\t\t} else {\n\t\t\t\tif (auxiliaryBarDefaultVisibility === 'visible' || auxiliaryBarDefaultVisibility === 'visibleInWorkspace') {\n\t\t\t\t\tauxiliaryBarWidth = override.layoutInfo.auxiliaryBarWidth || partSplash.layoutInfo.auxiliaryBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t\t} else if (auxiliaryBarDefaultVisibility === 'maximized' || auxiliaryBarDefaultVisibility === 'maximizedInWorkspace') {\n\t\t\t\t\tauxiliaryBarWidth = Number.MAX_SAFE_INTEGER; // marker for a maximised auxiliary bar\n\t\t\t\t} else {\n\t\t\t\t\tauxiliaryBarWidth = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tauxiliaryBarWidth = 0; // technically not true if configured 'visible', but we never store splash per empty window, so we decide on a default here\n\t\t}\n\n\t\treturn {\n\t\t\t...partSplash,\n\t\t\tlayoutInfo: {\n\t\t\t\t...partSplash.layoutInfo,\n\t\t\t\tsideBarWidth,\n\t\t\t\tauxiliaryBarWidth\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate getWindowSplashOverride(): IPartsSplashOverride {\n\t\tlet override = this.stateService.getItem<IPartsSplashOverride>(THEME_WINDOW_SPLASH_OVERRIDE_KEY);\n\n\t\tif (!override?.layoutInfo) {\n\t\t\toverride = {\n\t\t\t\tlayoutInfo: {\n\t\t\t\t\tsideBarWidth: ThemeMainService.DEFAULT_BAR_WIDTH,\n\t\t\t\t\tauxiliaryBarWidth: ThemeMainService.DEFAULT_BAR_WIDTH,\n\t\t\t\t\tworkspaces: {}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tif (!override.layoutInfo.sideBarWidth) {\n\t\t\toverride.layoutInfo.sideBarWidth = ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t}\n\n\t\tif (!override.layoutInfo.auxiliaryBarWidth) {\n\t\t\toverride.layoutInfo.auxiliaryBarWidth = ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t}\n\n\t\tif (!override.layoutInfo.workspaces) {\n\t\t\toverride.layoutInfo.workspaces = {};\n\t\t}\n\n\t\treturn override;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport electron from 'electron';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isLinux, isMacintosh, isWindows } from '../../../base/common/platform.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IStateService } from '../../state/node/state.js';\nimport { IPartsSplash } from '../common/themeService.js';\nimport { IColorScheme } from '../../window/common/window.js';\nimport { ThemeTypeSelector } from '../common/theme.js';\nimport { ISingleFolderWorkspaceIdentifier, IWorkspaceIdentifier } from '../../workspace/common/workspace.js';\nimport { coalesce } from '../../../base/common/arrays.js';\nimport { getAllWindowsExcludingOffscreen } from '../../windows/electron-main/windows.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IThemeMainService } from './themeMainService.js';\n\n// These default colors match our default themes\n// editor background color (\"Dark Modern\", etc...)\nconst DEFAULT_BG_LIGHT = '#FFFFFF';\nconst DEFAULT_BG_DARK = '#1F1F1F';\nconst DEFAULT_BG_HC_BLACK = '#000000';\nconst DEFAULT_BG_HC_LIGHT = '#FFFFFF';\n\nconst THEME_STORAGE_KEY = 'theme';\nconst THEME_BG_STORAGE_KEY = 'themeBackground';\n\nconst THEME_WINDOW_SPLASH_KEY = 'windowSplash';\nconst THEME_WINDOW_SPLASH_OVERRIDE_KEY = 'windowSplashWorkspaceOverride';\n\nconst AUXILIARYBAR_DEFAULT_VISIBILITY = 'workbench.secondarySideBar.defaultVisibility';\n\nnamespace ThemeSettings {\n\texport const DETECT_COLOR_SCHEME = 'window.autoDetectColorScheme';\n\texport const DETECT_HC = 'window.autoDetectHighContrast';\n\texport const SYSTEM_COLOR_THEME = 'window.systemColorTheme';\n}\n\ninterface IPartSplashOverrideWorkspaces {\n\t[workspaceId: string]: {\n\t\tsideBarVisible: boolean;\n\t\tauxiliaryBarVisible: boolean;\n\t};\n}\n\ninterface IPartsSplashOverride {\n\tlayoutInfo: {\n\t\tsideBarWidth: number;\n\t\tauxiliaryBarWidth: number;\n\n\t\tworkspaces: IPartSplashOverrideWorkspaces;\n\t};\n}\n\nexport class ThemeMainService extends Disposable implements IThemeMainService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static readonly DEFAULT_BAR_WIDTH = 300;\n\n\tprivate static readonly WORKSPACE_OVERRIDE_LIMIT = 50;\n\n\tprivate readonly _onDidChangeColorScheme = this._register(new Emitter<IColorScheme>());\n\treadonly onDidChangeColorScheme = this._onDidChangeColorScheme.event;\n\n\tconstructor(\n\t\t@IStateService private stateService: IStateService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@ILogService private logService: ILogService\n\t) {\n\t\tsuper();\n\n\t\t// System Theme\n\t\tif (!isLinux) {\n\t\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\t\tif (e.affectsConfiguration(ThemeSettings.SYSTEM_COLOR_THEME) || e.affectsConfiguration(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\t\t\tthis.updateSystemColorTheme();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tthis.updateSystemColorTheme();\n\n\t\t// Color Scheme changes\n\t\tthis._register(Event.fromNodeEventEmitter(electron.nativeTheme, 'updated')(() => this._onDidChangeColorScheme.fire(this.getColorScheme())));\n\t}\n\n\tprivate updateSystemColorTheme(): void {\n\t\tif (isLinux || this.configurationService.getValue(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\telectron.nativeTheme.themeSource = 'system'; // only with `system` we can detect the system color scheme\n\t\t} else {\n\t\t\tswitch (this.configurationService.getValue<'default' | 'auto' | 'light' | 'dark'>(ThemeSettings.SYSTEM_COLOR_THEME)) {\n\t\t\t\tcase 'dark':\n\t\t\t\t\telectron.nativeTheme.themeSource = 'dark';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'light':\n\t\t\t\t\telectron.nativeTheme.themeSource = 'light';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auto':\n\t\t\t\t\tswitch (this.getPreferredBaseTheme() ?? this.getStoredBaseTheme()) {\n\t\t\t\t\t\tcase ThemeTypeSelector.VS: electron.nativeTheme.themeSource = 'light'; break;\n\t\t\t\t\t\tcase ThemeTypeSelector.VS_DARK: electron.nativeTheme.themeSource = 'dark'; break;\n\t\t\t\t\t\tdefault: electron.nativeTheme.themeSource = 'system';\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\telectron.nativeTheme.themeSource = 'system';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetColorScheme(): IColorScheme {\n\n\t\t// high contrast is reflected by the shouldUseInvertedColorScheme property\n\t\tif (isWindows) {\n\t\t\tif (electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\t// shouldUseInvertedColorScheme is dark, !shouldUseInvertedColorScheme is light\n\t\t\t\treturn { dark: electron.nativeTheme.shouldUseInvertedColorScheme, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\t// high contrast is set if one of shouldUseInvertedColorScheme or shouldUseHighContrastColors is set,\n\t\t// reflecting the 'Invert colours' and `Increase contrast` settings in MacOS\n\t\telse if (isMacintosh) {\n\t\t\tif (electron.nativeTheme.shouldUseInvertedColorScheme || electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\treturn { dark: electron.nativeTheme.shouldUseDarkColors, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\t// ubuntu gnome seems to have 3 states, light dark and high contrast\n\t\telse if (isLinux) {\n\t\t\tif (electron.nativeTheme.shouldUseHighContrastColors) {\n\t\t\t\treturn { dark: true, highContrast: true };\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdark: electron.nativeTheme.shouldUseDarkColors,\n\t\t\thighContrast: false\n\t\t};\n\t}\n\n\tgetPreferredBaseTheme(): ThemeTypeSelector | undefined {\n\t\tconst colorScheme = this.getColorScheme();\n\t\tif (this.configurationService.getValue(ThemeSettings.DETECT_HC) && colorScheme.highContrast) {\n\t\t\treturn colorScheme.dark ? ThemeTypeSelector.HC_BLACK : ThemeTypeSelector.HC_LIGHT;\n\t\t}\n\n\t\tif (this.configurationService.getValue(ThemeSettings.DETECT_COLOR_SCHEME)) {\n\t\t\treturn colorScheme.dark ? ThemeTypeSelector.VS_DARK : ThemeTypeSelector.VS;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetBackgroundColor(): string {\n\t\tconst preferred = this.getPreferredBaseTheme();\n\t\tconst stored = this.getStoredBaseTheme();\n\n\t\t// If the stored theme has the same base as the preferred, we can return the stored background\n\t\tif (preferred === undefined || preferred === stored) {\n\t\t\tconst storedBackground = this.stateService.getItem<string | null>(THEME_BG_STORAGE_KEY, null);\n\t\t\tif (storedBackground) {\n\t\t\t\treturn storedBackground;\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise we return the default background for the preferred base theme. If there's no preferred, use the stored one.\n\t\tswitch (preferred ?? stored) {\n\t\t\tcase ThemeTypeSelector.VS: return DEFAULT_BG_LIGHT;\n\t\t\tcase ThemeTypeSelector.HC_BLACK: return DEFAULT_BG_HC_BLACK;\n\t\t\tcase ThemeTypeSelector.HC_LIGHT: return DEFAULT_BG_HC_LIGHT;\n\t\t\tdefault: return DEFAULT_BG_DARK;\n\t\t}\n\t}\n\n\tprivate getStoredBaseTheme(): ThemeTypeSelector {\n\t\tconst baseTheme = this.stateService.getItem<ThemeTypeSelector>(THEME_STORAGE_KEY, ThemeTypeSelector.VS_DARK).split(' ')[0];\n\t\tswitch (baseTheme) {\n\t\t\tcase ThemeTypeSelector.VS: return ThemeTypeSelector.VS;\n\t\t\tcase ThemeTypeSelector.HC_BLACK: return ThemeTypeSelector.HC_BLACK;\n\t\t\tcase ThemeTypeSelector.HC_LIGHT: return ThemeTypeSelector.HC_LIGHT;\n\t\t\tdefault: return ThemeTypeSelector.VS_DARK;\n\t\t}\n\t}\n\n\tsaveWindowSplash(windowId: number | undefined, workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined, splash: IPartsSplash): void {\n\n\t\t// Update override as needed\n\t\tconst splashOverride = this.updateWindowSplashOverride(workspace, splash);\n\n\t\t// Update in storage\n\t\tthis.stateService.setItems(coalesce([\n\t\t\t{ key: THEME_STORAGE_KEY, data: splash.baseTheme },\n\t\t\t{ key: THEME_BG_STORAGE_KEY, data: splash.colorInfo.background },\n\t\t\t{ key: THEME_WINDOW_SPLASH_KEY, data: splash },\n\t\t\tsplashOverride ? { key: THEME_WINDOW_SPLASH_OVERRIDE_KEY, data: splashOverride } : undefined\n\t\t]));\n\n\t\t// Update in opened windows\n\t\tif (typeof windowId === 'number') {\n\t\t\tthis.updateBackgroundColor(windowId, splash);\n\t\t}\n\n\t\t// Update system theme\n\t\tthis.updateSystemColorTheme();\n\t}\n\n\tprivate updateWindowSplashOverride(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined, splash: IPartsSplash): IPartsSplashOverride | undefined {\n\t\tlet splashOverride: IPartsSplashOverride | undefined = undefined;\n\t\tlet changed = false;\n\t\tif (workspace) {\n\t\t\tsplashOverride = { ...this.getWindowSplashOverride() }; // make a copy for modifications\n\n\t\t\tchanged = this.doUpdateWindowSplashOverride(workspace, splash, splashOverride, 'sideBar');\n\t\t\tchanged = this.doUpdateWindowSplashOverride(workspace, splash, splashOverride, 'auxiliaryBar') || changed;\n\t\t}\n\n\t\treturn changed ? splashOverride : undefined;\n\t}\n\n\tprivate doUpdateWindowSplashOverride(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier, splash: IPartsSplash, splashOverride: IPartsSplashOverride, part: 'sideBar' | 'auxiliaryBar'): boolean {\n\t\tconst currentWidth = part === 'sideBar' ? splash.layoutInfo?.sideBarWidth : splash.layoutInfo?.auxiliaryBarWidth;\n\t\tconst overrideWidth = part === 'sideBar' ? splashOverride.layoutInfo.sideBarWidth : splashOverride.layoutInfo.auxiliaryBarWidth;\n\n\t\t// No layout info: remove override\n\t\tlet changed = false;\n\t\tif (typeof currentWidth !== 'number') {\n\t\t\tif (splashOverride.layoutInfo.workspaces[workspace.id]) {\n\t\t\t\tdelete splashOverride.layoutInfo.workspaces[workspace.id];\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\treturn changed;\n\t\t}\n\n\t\tlet workspaceOverride = splashOverride.layoutInfo.workspaces[workspace.id];\n\t\tif (!workspaceOverride) {\n\t\t\tconst workspaceEntries = Object.keys(splashOverride.layoutInfo.workspaces);\n\t\t\tif (workspaceEntries.length >= ThemeMainService.WORKSPACE_OVERRIDE_LIMIT) {\n\t\t\t\tdelete splashOverride.layoutInfo.workspaces[workspaceEntries[0]];\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\tworkspaceOverride = { sideBarVisible: false, auxiliaryBarVisible: false };\n\t\t\tsplashOverride.layoutInfo.workspaces[workspace.id] = workspaceOverride;\n\t\t\tchanged = true;\n\t\t}\n\n\t\t// Part has width: update width & visibility override\n\t\tif (currentWidth > 0) {\n\t\t\tif (overrideWidth !== currentWidth) {\n\t\t\t\tsplashOverride.layoutInfo[part === 'sideBar' ? 'sideBarWidth' : 'auxiliaryBarWidth'] = currentWidth;\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\tswitch (part) {\n\t\t\t\tcase 'sideBar':\n\t\t\t\t\tif (!workspaceOverride.sideBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.sideBarVisible = true;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auxiliaryBar':\n\t\t\t\t\tif (!workspaceOverride.auxiliaryBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.auxiliaryBarVisible = true;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Part is hidden: update visibility override\n\t\telse {\n\t\t\tswitch (part) {\n\t\t\t\tcase 'sideBar':\n\t\t\t\t\tif (workspaceOverride.sideBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.sideBarVisible = false;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'auxiliaryBar':\n\t\t\t\t\tif (workspaceOverride.auxiliaryBarVisible) {\n\t\t\t\t\t\tworkspaceOverride.auxiliaryBarVisible = false;\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tprivate updateBackgroundColor(windowId: number, splash: IPartsSplash): void {\n\t\tfor (const window of getAllWindowsExcludingOffscreen()) {\n\t\t\tif (window.id === windowId) {\n\t\t\t\twindow.setBackgroundColor(splash.colorInfo.background);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWindowSplash(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined): IPartsSplash | undefined {\n\t\ttry {\n\t\t\treturn this.doGetWindowSplash(workspace);\n\t\t} catch (error) {\n\t\t\tthis.logService.error('[theme main service] Failed to get window splash', error);\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate doGetWindowSplash(workspace: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined): IPartsSplash | undefined {\n\t\tconst partSplash = this.stateService.getItem<IPartsSplash>(THEME_WINDOW_SPLASH_KEY);\n\t\tif (!partSplash?.layoutInfo) {\n\t\t\treturn partSplash; // return early: overrides currently only apply to layout info\n\t\t}\n\n\t\tconst override = this.getWindowSplashOverride();\n\n\t\t// Figure out side bar width based on workspace and overrides\n\t\tlet sideBarWidth: number;\n\t\tif (workspace) {\n\t\t\tif (override.layoutInfo.workspaces[workspace.id]?.sideBarVisible === false) {\n\t\t\t\tsideBarWidth = 0;\n\t\t\t} else {\n\t\t\t\tsideBarWidth = override.layoutInfo.sideBarWidth || partSplash.layoutInfo.sideBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t}\n\t\t} else {\n\t\t\tsideBarWidth = 0;\n\t\t}\n\n\t\t// Figure out auxiliary bar width based on workspace, configuration and overrides\n\t\tconst auxiliaryBarDefaultVisibility = this.configurationService.getValue(AUXILIARYBAR_DEFAULT_VISIBILITY) ?? 'visibleInWorkspace';\n\t\tlet auxiliaryBarWidth: number;\n\t\tif (workspace) {\n\t\t\tconst auxiliaryBarVisible = override.layoutInfo.workspaces[workspace.id]?.auxiliaryBarVisible;\n\t\t\tif (auxiliaryBarVisible === true) {\n\t\t\t\tauxiliaryBarWidth = override.layoutInfo.auxiliaryBarWidth || partSplash.layoutInfo.auxiliaryBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t} else if (auxiliaryBarVisible === false) {\n\t\t\t\tauxiliaryBarWidth = 0;\n\t\t\t} else {\n\t\t\t\tif (auxiliaryBarDefaultVisibility === 'visible' || auxiliaryBarDefaultVisibility === 'visibleInWorkspace') {\n\t\t\t\t\tauxiliaryBarWidth = override.layoutInfo.auxiliaryBarWidth || partSplash.layoutInfo.auxiliaryBarWidth || ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t\t\t} else if (auxiliaryBarDefaultVisibility === 'maximized' || auxiliaryBarDefaultVisibility === 'maximizedInWorkspace') {\n\t\t\t\t\tauxiliaryBarWidth = Number.MAX_SAFE_INTEGER; // marker for a maximised auxiliary bar\n\t\t\t\t} else {\n\t\t\t\t\tauxiliaryBarWidth = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tauxiliaryBarWidth = 0; // technically not true if configured 'visible', but we never store splash per empty window, so we decide on a default here\n\t\t}\n\n\t\treturn {\n\t\t\t...partSplash,\n\t\t\tlayoutInfo: {\n\t\t\t\t...partSplash.layoutInfo,\n\t\t\t\tsideBarWidth,\n\t\t\t\tauxiliaryBarWidth\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate getWindowSplashOverride(): IPartsSplashOverride {\n\t\tlet override = this.stateService.getItem<IPartsSplashOverride>(THEME_WINDOW_SPLASH_OVERRIDE_KEY);\n\n\t\tif (!override?.layoutInfo) {\n\t\t\toverride = {\n\t\t\t\tlayoutInfo: {\n\t\t\t\t\tsideBarWidth: ThemeMainService.DEFAULT_BAR_WIDTH,\n\t\t\t\t\tauxiliaryBarWidth: ThemeMainService.DEFAULT_BAR_WIDTH,\n\t\t\t\t\tworkspaces: {}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tif (!override.layoutInfo.sideBarWidth) {\n\t\t\toverride.layoutInfo.sideBarWidth = ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t}\n\n\t\tif (!override.layoutInfo.auxiliaryBarWidth) {\n\t\t\toverride.layoutInfo.auxiliaryBarWidth = ThemeMainService.DEFAULT_BAR_WIDTH;\n\t\t}\n\n\t\tif (!override.layoutInfo.workspaces) {\n\t\t\toverride.layoutInfo.workspaces = {};\n\t\t}\n\n\t\treturn override;\n\t}\n}\n"]}