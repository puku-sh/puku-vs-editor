{"version":3,"sources":["vs/platform/files/node/diskFileSystemProvider.ts"],"names":[],"mappings":"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","file":"diskFileSystemProvider.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Stats, promises } from 'fs';\nimport { Barrier, retry } from '../../../base/common/async.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { Event } from '../../../base/common/event.js';\nimport { isEqual } from '../../../base/common/extpath.js';\nimport { DisposableStore, IDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { basename, dirname, join } from '../../../base/common/path.js';\nimport { isLinux, isWindows } from '../../../base/common/platform.js';\nimport { extUriBiasedIgnorePathCase, joinPath, basename as resourcesBasename, dirname as resourcesDirname } from '../../../base/common/resources.js';\nimport { newWriteableStream, ReadableStreamEvents } from '../../../base/common/stream.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IDirent, Promises, RimRafMode, SymlinkSupport } from '../../../base/node/pfs.js';\nimport { localize } from '../../../nls.js';\nimport { createFileSystemProviderError, IFileAtomicReadOptions, IFileDeleteOptions, IFileOpenOptions, IFileOverwriteOptions, IFileReadStreamOptions, FileSystemProviderCapabilities, FileSystemProviderError, FileSystemProviderErrorCode, FileType, IFileWriteOptions, IFileSystemProviderWithFileAtomicReadCapability, IFileSystemProviderWithFileCloneCapability, IFileSystemProviderWithFileFolderCopyCapability, IFileSystemProviderWithFileReadStreamCapability, IFileSystemProviderWithFileReadWriteCapability, IFileSystemProviderWithOpenReadWriteCloseCapability, isFileOpenForWriteOptions, IStat, FilePermission, IFileSystemProviderWithFileAtomicWriteCapability, IFileSystemProviderWithFileAtomicDeleteCapability, IFileChange, IFileSystemProviderWithFileRealpathCapability } from '../common/files.js';\nimport { readFileIntoStream } from '../common/io.js';\nimport { AbstractNonRecursiveWatcherClient, AbstractUniversalWatcherClient, ILogMessage } from '../common/watcher.js';\nimport { AbstractDiskFileSystemProvider } from '../common/diskFileSystemProvider.js';\nimport { UniversalWatcherClient } from './watcher/watcherClient.js';\nimport { NodeJSWatcherClient } from './watcher/nodejs/nodejsClient.js';\n\nexport class DiskFileSystemProvider extends AbstractDiskFileSystemProvider implements\n\tIFileSystemProviderWithFileReadWriteCapability,\n\tIFileSystemProviderWithOpenReadWriteCloseCapability,\n\tIFileSystemProviderWithFileReadStreamCapability,\n\tIFileSystemProviderWithFileFolderCopyCapability,\n\tIFileSystemProviderWithFileAtomicReadCapability,\n\tIFileSystemProviderWithFileAtomicWriteCapability,\n\tIFileSystemProviderWithFileAtomicDeleteCapability,\n\tIFileSystemProviderWithFileCloneCapability,\n\tIFileSystemProviderWithFileRealpathCapability {\n\n\tprivate static TRACE_LOG_RESOURCE_LOCKS = false; // not enabled by default because very spammy\n\n\t//#region File Capabilities\n\n\treadonly onDidChangeCapabilities = Event.None;\n\n\tprivate _capabilities: FileSystemProviderCapabilities | undefined;\n\tget capabilities(): FileSystemProviderCapabilities {\n\t\tif (!this._capabilities) {\n\t\t\tthis._capabilities =\n\t\t\t\tFileSystemProviderCapabilities.FileReadWrite |\n\t\t\t\tFileSystemProviderCapabilities.FileOpenReadWriteClose |\n\t\t\t\tFileSystemProviderCapabilities.FileReadStream |\n\t\t\t\tFileSystemProviderCapabilities.FileFolderCopy |\n\t\t\t\tFileSystemProviderCapabilities.FileWriteUnlock |\n\t\t\t\tFileSystemProviderCapabilities.FileAtomicRead |\n\t\t\t\tFileSystemProviderCapabilities.FileAtomicWrite |\n\t\t\t\tFileSystemProviderCapabilities.FileAtomicDelete |\n\t\t\t\tFileSystemProviderCapabilities.FileClone |\n\t\t\t\tFileSystemProviderCapabilities.FileRealpath;\n\n\t\t\tif (isLinux) {\n\t\t\t\tthis._capabilities |= FileSystemProviderCapabilities.PathCaseSensitive;\n\t\t\t}\n\t\t}\n\n\t\treturn this._capabilities;\n\t}\n\n\t//#endregion\n\n\t//#region File Metadata Resolving\n\n\tasync stat(resource: URI): Promise<IStat> {\n\t\ttry {\n\t\t\tconst { stat, symbolicLink } = await SymlinkSupport.stat(this.toFilePath(resource)); // cannot use fs.stat() here to support links properly\n\n\t\t\treturn {\n\t\t\t\ttype: this.toType(stat, symbolicLink),\n\t\t\t\tctime: stat.birthtime.getTime(), // intentionally not using ctime here, we want the creation time\n\t\t\t\tmtime: stat.mtime.getTime(),\n\t\t\t\tsize: stat.size,\n\t\t\t\tpermissions: (stat.mode & 0o200) === 0 ? FilePermission.Locked : undefined\n\t\t\t};\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tprivate async statIgnoreError(resource: URI): Promise<IStat | undefined> {\n\t\ttry {\n\t\t\treturn await this.stat(resource);\n\t\t} catch (error) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync realpath(resource: URI): Promise<string> {\n\t\tconst filePath = this.toFilePath(resource);\n\n\t\treturn Promises.realpath(filePath);\n\t}\n\n\tasync readdir(resource: URI): Promise<[string, FileType][]> {\n\t\ttry {\n\t\t\tconst children = await Promises.readdir(this.toFilePath(resource), { withFileTypes: true });\n\n\t\t\tconst result: [string, FileType][] = [];\n\t\t\tawait Promise.all(children.map(async child => {\n\t\t\t\ttry {\n\t\t\t\t\tlet type: FileType;\n\t\t\t\t\tif (child.isSymbolicLink()) {\n\t\t\t\t\t\ttype = (await this.stat(joinPath(resource, child.name))).type; // always resolve target the link points to if any\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttype = this.toType(child);\n\t\t\t\t\t}\n\n\t\t\t\t\tresult.push([child.name, type]);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.logService.trace(error); // ignore errors for individual entries that can arise from permission denied\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\treturn result;\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tprivate toType(entry: Stats | IDirent, symbolicLink?: { dangling: boolean }): FileType {\n\n\t\t// Signal file type by checking for file / directory, except:\n\t\t// - symbolic links pointing to nonexistent files are FileType.Unknown\n\t\t// - files that are neither file nor directory are FileType.Unknown\n\t\tlet type: FileType;\n\t\tif (symbolicLink?.dangling) {\n\t\t\ttype = FileType.Unknown;\n\t\t} else if (entry.isFile()) {\n\t\t\ttype = FileType.File;\n\t\t} else if (entry.isDirectory()) {\n\t\t\ttype = FileType.Directory;\n\t\t} else {\n\t\t\ttype = FileType.Unknown;\n\t\t}\n\n\t\t// Always signal symbolic link as file type additionally\n\t\tif (symbolicLink) {\n\t\t\ttype |= FileType.SymbolicLink;\n\t\t}\n\n\t\treturn type;\n\t}\n\n\t//#endregion\n\n\t//#region File Reading/Writing\n\n\tprivate readonly resourceLocks = new ResourceMap<Barrier>(resource => extUriBiasedIgnorePathCase.getComparisonKey(resource));\n\n\tprivate async createResourceLock(resource: URI): Promise<IDisposable> {\n\t\tconst filePath = this.toFilePath(resource);\n\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - request to acquire resource lock (${filePath})`);\n\n\t\t// Await pending locks for resource. It is possible for a new lock being\n\t\t// added right after opening, so we have to loop over locks until no lock\n\t\t// remains.\n\t\tlet existingLock: Barrier | undefined = undefined;\n\t\twhile (existingLock = this.resourceLocks.get(resource)) {\n\t\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - waiting for resource lock to be released (${filePath})`);\n\t\t\tawait existingLock.wait();\n\t\t}\n\n\t\t// Store new\n\t\tconst newLock = new Barrier();\n\t\tthis.resourceLocks.set(resource, newLock);\n\n\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - new resource lock created (${filePath})`);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock dispose() (${filePath})`);\n\n\t\t\t// Delete lock if it is still ours\n\t\t\tif (this.resourceLocks.get(resource) === newLock) {\n\t\t\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock removed from resource-lock map (${filePath})`);\n\t\t\t\tthis.resourceLocks.delete(resource);\n\t\t\t}\n\n\t\t\t// Open lock\n\t\t\tthis.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock barrier open() (${filePath})`);\n\t\t\tnewLock.open();\n\t\t});\n\t}\n\n\tasync readFile(resource: URI, options?: IFileAtomicReadOptions): Promise<Uint8Array> {\n\t\tlet lock: IDisposable | undefined = undefined;\n\t\ttry {\n\t\t\tif (options?.atomic) {\n\t\t\t\tthis.traceLock(`[Disk FileSystemProvider]: atomic read operation started (${this.toFilePath(resource)})`);\n\n\t\t\t\t// When the read should be atomic, make sure\n\t\t\t\t// to await any pending locks for the resource\n\t\t\t\t// and lock for the duration of the read.\n\t\t\t\tlock = await this.createResourceLock(resource);\n\t\t\t}\n\n\t\t\tconst filePath = this.toFilePath(resource);\n\n\t\t\treturn await promises.readFile(filePath);\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t} finally {\n\t\t\tlock?.dispose();\n\t\t}\n\t}\n\n\tprivate traceLock(msg: string): void {\n\t\tif (DiskFileSystemProvider.TRACE_LOG_RESOURCE_LOCKS) {\n\t\t\tthis.logService.trace(msg);\n\t\t}\n\t}\n\n\treadFileStream(resource: URI, opts: IFileReadStreamOptions, token: CancellationToken): ReadableStreamEvents<Uint8Array> {\n\t\tconst stream = newWriteableStream<Uint8Array>(data => VSBuffer.concat(data.map(data => VSBuffer.wrap(data))).buffer);\n\n\t\treadFileIntoStream(this, resource, stream, data => data.buffer, {\n\t\t\t...opts,\n\t\t\tbufferSize: 256 * 1024 // read into chunks of 256kb each to reduce IPC overhead\n\t\t}, token);\n\n\t\treturn stream;\n\t}\n\n\tasync writeFile(resource: URI, content: Uint8Array, opts: IFileWriteOptions): Promise<void> {\n\t\tif (opts?.atomic !== false && opts?.atomic?.postfix && await this.canWriteFileAtomic(resource)) {\n\t\t\treturn this.doWriteFileAtomic(resource, joinPath(resourcesDirname(resource), `${resourcesBasename(resource)}${opts.atomic.postfix}`), content, opts);\n\t\t} else {\n\t\t\treturn this.doWriteFile(resource, content, opts);\n\t\t}\n\t}\n\n\tprivate async canWriteFileAtomic(resource: URI): Promise<boolean> {\n\t\ttry {\n\t\t\tconst filePath = this.toFilePath(resource);\n\t\t\tconst { symbolicLink } = await SymlinkSupport.stat(filePath);\n\t\t\tif (symbolicLink) {\n\t\t\t\t// atomic writes are unsupported for symbolic links because\n\t\t\t\t// we need to ensure that the `rename` operation is atomic\n\t\t\t\t// and that only works if the link is on the same disk.\n\t\t\t\t// Since we do not know where the symbolic link points to\n\t\t\t\t// we refuse to write atomically.\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// ignore stat errors here and just proceed trying to write\n\t\t}\n\n\t\treturn true; // atomic writing supported\n\t}\n\n\tprivate async doWriteFileAtomic(resource: URI, tempResource: URI, content: Uint8Array, opts: IFileWriteOptions): Promise<void> {\n\n\t\t// Ensure to create locks for all resources involved\n\t\t// since atomic write involves mutiple disk operations\n\t\t// and resources.\n\n\t\tconst locks = new DisposableStore();\n\n\t\ttry {\n\t\t\tlocks.add(await this.createResourceLock(resource));\n\t\t\tlocks.add(await this.createResourceLock(tempResource));\n\n\t\t\t// Write to temp resource first\n\t\t\tawait this.doWriteFile(tempResource, content, opts, true /* disable write lock */);\n\n\t\t\ttry {\n\n\t\t\t\t// Rename over existing to ensure atomic replace\n\t\t\t\tawait this.rename(tempResource, resource, { overwrite: true });\n\n\t\t\t} catch (error) {\n\n\t\t\t\t// Cleanup in case of rename error\n\t\t\t\ttry {\n\t\t\t\t\tawait this.delete(tempResource, { recursive: false, useTrash: false, atomic: false });\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// ignore - we want the outer error to bubble up\n\t\t\t\t}\n\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t} finally {\n\t\t\tlocks.dispose();\n\t\t}\n\t}\n\n\tprivate async doWriteFile(resource: URI, content: Uint8Array, opts: IFileWriteOptions, disableWriteLock?: boolean): Promise<void> {\n\t\tlet handle: number | undefined = undefined;\n\t\ttry {\n\t\t\tconst filePath = this.toFilePath(resource);\n\n\t\t\t// Validate target unless { create: true, overwrite: true }\n\t\t\tif (!opts.create || !opts.overwrite) {\n\t\t\t\tconst fileExists = await Promises.exists(filePath);\n\t\t\t\tif (fileExists) {\n\t\t\t\t\tif (!opts.overwrite) {\n\t\t\t\t\t\tthrow createFileSystemProviderError(localize('fileExists', \"File already exists\"), FileSystemProviderErrorCode.FileExists);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!opts.create) {\n\t\t\t\t\t\tthrow createFileSystemProviderError(localize('fileNotExists', \"File does not exist\"), FileSystemProviderErrorCode.FileNotFound);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Open\n\t\t\thandle = await this.open(resource, { create: true, unlock: opts.unlock }, disableWriteLock);\n\n\t\t\t// Write content at once\n\t\t\tawait this.write(handle, 0, content, 0, content.byteLength);\n\t\t} catch (error) {\n\t\t\tthrow await this.toFileSystemProviderWriteError(resource, error);\n\t\t} finally {\n\t\t\tif (typeof handle === 'number') {\n\t\t\t\tawait this.close(handle);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate readonly mapHandleToPos = new Map<number, number>();\n\tprivate readonly mapHandleToLock = new Map<number, IDisposable>();\n\n\tprivate readonly writeHandles = new Map<number, URI>();\n\n\tprivate static canFlush = true;\n\n\tstatic configureFlushOnWrite(enabled: boolean): void {\n\t\tDiskFileSystemProvider.canFlush = enabled;\n\t}\n\n\tasync open(resource: URI, opts: IFileOpenOptions, disableWriteLock?: boolean): Promise<number> {\n\t\tconst filePath = this.toFilePath(resource);\n\n\t\t// Writes: guard multiple writes to the same resource\n\t\t// behind a single lock to prevent races when writing\n\t\t// from multiple places at the same time to the same file\n\t\tlet lock: IDisposable | undefined = undefined;\n\t\tif (isFileOpenForWriteOptions(opts) && !disableWriteLock) {\n\t\t\tlock = await this.createResourceLock(resource);\n\t\t}\n\n\t\tlet fd: number | undefined = undefined;\n\t\ttry {\n\n\t\t\t// Determine whether to unlock the file (write only)\n\t\t\tif (isFileOpenForWriteOptions(opts) && opts.unlock) {\n\t\t\t\ttry {\n\t\t\t\t\tconst { stat } = await SymlinkSupport.stat(filePath);\n\t\t\t\t\tif (!(stat.mode & 0o200 /* File mode indicating writable by owner */)) {\n\t\t\t\t\t\tawait promises.chmod(filePath, stat.mode | 0o200);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (error.code !== 'ENOENT') {\n\t\t\t\t\t\tthis.logService.trace(error); // log errors but do not give up writing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Windows gets special treatment (write only)\n\t\t\tif (isWindows && isFileOpenForWriteOptions(opts)) {\n\t\t\t\ttry {\n\n\t\t\t\t\t// We try to use 'r+' for opening (which will fail if the file does not exist)\n\t\t\t\t\t// to prevent issues when saving hidden files or preserving alternate data\n\t\t\t\t\t// streams.\n\t\t\t\t\t// Related issues:\n\t\t\t\t\t// - https://github.com/microsoft/vscode/issues/931\n\t\t\t\t\t// - https://github.com/microsoft/vscode/issues/6363\n\t\t\t\t\tfd = await Promises.open(filePath, 'r+');\n\n\t\t\t\t\t// The flag 'r+' will not truncate the file, so we have to do this manually\n\t\t\t\t\tawait Promises.ftruncate(fd, 0);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (error.code !== 'ENOENT') {\n\t\t\t\t\t\tthis.logService.trace(error); // log errors but do not give up writing\n\t\t\t\t\t}\n\n\t\t\t\t\t// Make sure to close the file handle if we have one\n\t\t\t\t\tif (typeof fd === 'number') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait Promises.close(fd);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tthis.logService.trace(error); // log errors but do not give up writing\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Reset `fd` to be able to try again with 'w'\n\t\t\t\t\t\tfd = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof fd !== 'number') {\n\t\t\t\tfd = await Promises.open(filePath, isFileOpenForWriteOptions(opts) ?\n\t\t\t\t\t// We take `opts.create` as a hint that the file is opened for writing\n\t\t\t\t\t// as such we use 'w' to truncate an existing or create the\n\t\t\t\t\t// file otherwise. we do not allow reading.\n\t\t\t\t\t'w' :\n\t\t\t\t\t// Otherwise we assume the file is opened for reading\n\t\t\t\t\t// as such we use 'r' to neither truncate, nor create\n\t\t\t\t\t// the file.\n\t\t\t\t\t'r'\n\t\t\t\t);\n\t\t\t}\n\n\t\t} catch (error) {\n\n\t\t\t// Release lock because we have no valid handle\n\t\t\t// if we did open a lock during this operation\n\t\t\tlock?.dispose();\n\n\t\t\t// Rethrow as file system provider error\n\t\t\tif (isFileOpenForWriteOptions(opts)) {\n\t\t\t\tthrow await this.toFileSystemProviderWriteError(resource, error);\n\t\t\t} else {\n\t\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t\t}\n\t\t}\n\n\t\t// Remember this handle to track file position of the handle\n\t\t// we init the position to 0 since the file descriptor was\n\t\t// just created and the position was not moved so far (see\n\t\t// also http://man7.org/linux/man-pages/man2/open.2.html -\n\t\t// \"The file offset is set to the beginning of the file.\")\n\t\tthis.mapHandleToPos.set(fd, 0);\n\n\t\t// remember that this handle was used for writing\n\t\tif (isFileOpenForWriteOptions(opts)) {\n\t\t\tthis.writeHandles.set(fd, resource);\n\t\t}\n\n\t\tif (lock) {\n\t\t\tconst previousLock = this.mapHandleToLock.get(fd);\n\n\t\t\t// Remember that this handle has an associated lock\n\t\t\tthis.traceLock(`[Disk FileSystemProvider]: open() - storing lock for handle ${fd} (${filePath})`);\n\t\t\tthis.mapHandleToLock.set(fd, lock);\n\n\t\t\t// There is a slight chance that a resource lock for a\n\t\t\t// handle was not yet disposed when we acquire a new\n\t\t\t// lock, so we must ensure to dispose the previous lock\n\t\t\t// before storing a new one for the same handle, other\n\t\t\t// wise we end up in a deadlock situation\n\t\t\t// https://github.com/microsoft/vscode/issues/142462\n\t\t\tif (previousLock) {\n\t\t\t\tthis.traceLock(`[Disk FileSystemProvider]: open() - disposing a previous lock that was still stored on same handle ${fd} (${filePath})`);\n\t\t\t\tpreviousLock.dispose();\n\t\t\t}\n\t\t}\n\n\t\treturn fd;\n\t}\n\n\tasync close(fd: number): Promise<void> {\n\n\t\t// It is very important that we keep any associated lock\n\t\t// for the file handle before attempting to call `fs.close(fd)`\n\t\t// because of a possible race condition: as soon as a file\n\t\t// handle is released, the OS may assign the same handle to\n\t\t// the next `fs.open` call and as such it is possible that our\n\t\t// lock is getting overwritten\n\t\tconst lockForHandle = this.mapHandleToLock.get(fd);\n\n\t\ttry {\n\n\t\t\t// Remove this handle from map of positions\n\t\t\tthis.mapHandleToPos.delete(fd);\n\n\t\t\t// If a handle is closed that was used for writing, ensure\n\t\t\t// to flush the contents to disk if possible.\n\t\t\tif (this.writeHandles.delete(fd) && DiskFileSystemProvider.canFlush) {\n\t\t\t\ttry {\n\t\t\t\t\tawait Promises.fdatasync(fd); // https://github.com/microsoft/vscode/issues/9589\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// In some exotic setups it is well possible that node fails to sync\n\t\t\t\t\t// In that case we disable flushing and log the error to our logger\n\t\t\t\t\tDiskFileSystemProvider.configureFlushOnWrite(false);\n\t\t\t\t\tthis.logService.error(error);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn await Promises.close(fd);\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t} finally {\n\t\t\tif (lockForHandle) {\n\t\t\t\tif (this.mapHandleToLock.get(fd) === lockForHandle) {\n\t\t\t\t\tthis.traceLock(`[Disk FileSystemProvider]: close() - resource lock removed from handle-lock map ${fd}`);\n\t\t\t\t\tthis.mapHandleToLock.delete(fd); // only delete from map if this is still our lock!\n\t\t\t\t}\n\n\t\t\t\tthis.traceLock(`[Disk FileSystemProvider]: close() - disposing lock for handle ${fd}`);\n\t\t\t\tlockForHandle.dispose();\n\t\t\t}\n\t\t}\n\t}\n\n\tasync read(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number> {\n\t\tconst normalizedPos = this.normalizePos(fd, pos);\n\n\t\tlet bytesRead: number | null = null;\n\t\ttry {\n\t\t\tbytesRead = (await Promises.read(fd, data, offset, length, normalizedPos)).bytesRead;\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t} finally {\n\t\t\tthis.updatePos(fd, normalizedPos, bytesRead);\n\t\t}\n\n\t\treturn bytesRead;\n\t}\n\n\tprivate normalizePos(fd: number, pos: number): number | null {\n\n\t\t// When calling fs.read/write we try to avoid passing in the \"pos\" argument and\n\t\t// rather prefer to pass in \"null\" because this avoids an extra seek(pos)\n\t\t// call that in some cases can even fail (e.g. when opening a file over FTP -\n\t\t// see https://github.com/microsoft/vscode/issues/73884).\n\t\t//\n\t\t// as such, we compare the passed in position argument with our last known\n\t\t// position for the file descriptor and use \"null\" if they match.\n\t\tif (pos === this.mapHandleToPos.get(fd)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\tprivate updatePos(fd: number, pos: number | null, bytesLength: number | null): void {\n\t\tconst lastKnownPos = this.mapHandleToPos.get(fd);\n\t\tif (typeof lastKnownPos === 'number') {\n\n\t\t\t// pos !== null signals that previously a position was used that is\n\t\t\t// not null. node.js documentation explains, that in this case\n\t\t\t// the internal file pointer is not moving and as such we do not move\n\t\t\t// our position pointer.\n\t\t\t//\n\t\t\t// Docs: \"If position is null, data will be read from the current file position,\n\t\t\t// and the file position will be updated. If position is an integer, the file position\n\t\t\t// will remain unchanged.\"\n\t\t\tif (typeof pos === 'number') {\n\t\t\t\t// do not modify the position\n\t\t\t}\n\n\t\t\t// bytesLength = number is a signal that the read/write operation was\n\t\t\t// successful and as such we need to advance the position in the Map\n\t\t\t//\n\t\t\t// Docs (http://man7.org/linux/man-pages/man2/read.2.html):\n\t\t\t// \"On files that support seeking, the read operation commences at the\n\t\t\t// file offset, and the file offset is incremented by the number of\n\t\t\t// bytes read.\"\n\t\t\t//\n\t\t\t// Docs (http://man7.org/linux/man-pages/man2/write.2.html):\n\t\t\t// \"For a seekable file (i.e., one to which lseek(2) may be applied, for\n\t\t\t// example, a regular file) writing takes place at the file offset, and\n\t\t\t// the file offset is incremented by the number of bytes actually\n\t\t\t// written.\"\n\t\t\telse if (typeof bytesLength === 'number') {\n\t\t\t\tthis.mapHandleToPos.set(fd, lastKnownPos + bytesLength);\n\t\t\t}\n\n\t\t\t// bytesLength = null signals an error in the read/write operation\n\t\t\t// and as such we drop the handle from the Map because the position\n\t\t\t// is unspecificed at this point.\n\t\t\telse {\n\t\t\t\tthis.mapHandleToPos.delete(fd);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync write(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number> {\n\n\t\t// We know at this point that the file to write to is truncated and thus empty\n\t\t// if the write now fails, the file remains empty. as such we really try hard\n\t\t// to ensure the write succeeds by retrying up to three times.\n\t\treturn retry(() => this.doWrite(fd, pos, data, offset, length), 100 /* ms delay */, 3 /* retries */);\n\t}\n\n\tprivate async doWrite(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number> {\n\t\tconst normalizedPos = this.normalizePos(fd, pos);\n\n\t\tlet bytesWritten: number | null = null;\n\t\ttry {\n\t\t\tbytesWritten = (await Promises.write(fd, data, offset, length, normalizedPos)).bytesWritten;\n\t\t} catch (error) {\n\t\t\tthrow await this.toFileSystemProviderWriteError(this.writeHandles.get(fd), error);\n\t\t} finally {\n\t\t\tthis.updatePos(fd, normalizedPos, bytesWritten);\n\t\t}\n\n\t\treturn bytesWritten;\n\t}\n\n\t//#endregion\n\n\t//#region Move/Copy/Delete/Create Folder\n\n\tasync mkdir(resource: URI): Promise<void> {\n\t\ttry {\n\t\t\tawait promises.mkdir(this.toFilePath(resource));\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tasync delete(resource: URI, opts: IFileDeleteOptions): Promise<void> {\n\t\ttry {\n\t\t\tconst filePath = this.toFilePath(resource);\n\t\t\tif (opts.recursive) {\n\t\t\t\tlet rmMoveToPath: string | undefined = undefined;\n\t\t\t\tif (opts?.atomic !== false && opts.atomic.postfix) {\n\t\t\t\t\trmMoveToPath = join(dirname(filePath), `${basename(filePath)}${opts.atomic.postfix}`);\n\t\t\t\t}\n\n\t\t\t\tawait Promises.rm(filePath, RimRafMode.MOVE, rmMoveToPath);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tawait promises.unlink(filePath);\n\t\t\t\t} catch (unlinkError) {\n\n\t\t\t\t\t// `fs.unlink` will throw when used on directories\n\t\t\t\t\t// we try to detect this error and then see if the\n\t\t\t\t\t// provided resource is actually a directory. in that\n\t\t\t\t\t// case we use `fs.rmdir` to delete the directory.\n\n\t\t\t\t\tif (unlinkError.code === 'EPERM' || unlinkError.code === 'EISDIR') {\n\t\t\t\t\t\tlet isDirectory = false;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst { stat, symbolicLink } = await SymlinkSupport.stat(filePath);\n\t\t\t\t\t\t\tisDirectory = stat.isDirectory() && !symbolicLink;\n\t\t\t\t\t\t} catch (statError) {\n\t\t\t\t\t\t\t// ignore\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isDirectory) {\n\t\t\t\t\t\t\tawait promises.rmdir(filePath);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow unlinkError;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow unlinkError;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tasync rename(from: URI, to: URI, opts: IFileOverwriteOptions): Promise<void> {\n\t\tconst fromFilePath = this.toFilePath(from);\n\t\tconst toFilePath = this.toFilePath(to);\n\n\t\tif (fromFilePath === toFilePath) {\n\t\t\treturn; // simulate node.js behaviour here and do a no-op if paths match\n\t\t}\n\n\t\ttry {\n\n\t\t\t// Validate the move operation can perform\n\t\t\tawait this.validateMoveCopy(from, to, 'move', opts.overwrite);\n\n\t\t\t// Rename\n\t\t\tawait Promises.rename(fromFilePath, toFilePath);\n\t\t} catch (error) {\n\n\t\t\t// Rewrite some typical errors that can happen especially around symlinks\n\t\t\t// to something the user can better understand\n\t\t\tif (error.code === 'EINVAL' || error.code === 'EBUSY' || error.code === 'ENAMETOOLONG') {\n\t\t\t\terror = new Error(localize('moveError', \"Unable to move '{0}' into '{1}' ({2}).\", basename(fromFilePath), basename(dirname(toFilePath)), error.toString()));\n\t\t\t}\n\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tasync copy(from: URI, to: URI, opts: IFileOverwriteOptions): Promise<void> {\n\t\tconst fromFilePath = this.toFilePath(from);\n\t\tconst toFilePath = this.toFilePath(to);\n\n\t\tif (fromFilePath === toFilePath) {\n\t\t\treturn; // simulate node.js behaviour here and do a no-op if paths match\n\t\t}\n\n\t\ttry {\n\n\t\t\t// Validate the copy operation can perform\n\t\t\tawait this.validateMoveCopy(from, to, 'copy', opts.overwrite);\n\n\t\t\t// Copy\n\t\t\tawait Promises.copy(fromFilePath, toFilePath, { preserveSymlinks: true });\n\t\t} catch (error) {\n\n\t\t\t// Rewrite some typical errors that can happen especially around symlinks\n\t\t\t// to something the user can better understand\n\t\t\tif (error.code === 'EINVAL' || error.code === 'EBUSY' || error.code === 'ENAMETOOLONG') {\n\t\t\t\terror = new Error(localize('copyError', \"Unable to copy '{0}' into '{1}' ({2}).\", basename(fromFilePath), basename(dirname(toFilePath)), error.toString()));\n\t\t\t}\n\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t}\n\t}\n\n\tprivate async validateMoveCopy(from: URI, to: URI, mode: 'move' | 'copy', overwrite?: boolean): Promise<void> {\n\t\tconst fromFilePath = this.toFilePath(from);\n\t\tconst toFilePath = this.toFilePath(to);\n\n\t\tlet isSameResourceWithDifferentPathCase = false;\n\t\tconst isPathCaseSensitive = !!(this.capabilities & FileSystemProviderCapabilities.PathCaseSensitive);\n\t\tif (!isPathCaseSensitive) {\n\t\t\tisSameResourceWithDifferentPathCase = isEqual(fromFilePath, toFilePath, true /* ignore case */);\n\t\t}\n\n\t\tif (isSameResourceWithDifferentPathCase) {\n\n\t\t\t// You cannot copy the same file to the same location with different\n\t\t\t// path case unless you are on a case sensitive file system\n\t\t\tif (mode === 'copy') {\n\t\t\t\tthrow createFileSystemProviderError(localize('fileCopyErrorPathCase', \"File cannot be copied to same path with different path case\"), FileSystemProviderErrorCode.FileExists);\n\t\t\t}\n\n\t\t\t// You can move the same file to the same location with different\n\t\t\t// path case on case insensitive file systems\n\t\t\telse if (mode === 'move') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Here we have to see if the target to move/copy to exists or not.\n\t\t// We need to respect the `overwrite` option to throw in case the\n\t\t// target exists.\n\n\t\tconst fromStat = await this.statIgnoreError(from);\n\t\tif (!fromStat) {\n\t\t\tthrow createFileSystemProviderError(localize('fileMoveCopyErrorNotFound', \"File to move/copy does not exist\"), FileSystemProviderErrorCode.FileNotFound);\n\t\t}\n\n\t\tconst toStat = await this.statIgnoreError(to);\n\t\tif (!toStat) {\n\t\t\treturn; // target does not exist so we are good\n\t\t}\n\n\t\tif (!overwrite) {\n\t\t\tthrow createFileSystemProviderError(localize('fileMoveCopyErrorExists', \"File at target already exists and thus will not be moved/copied to unless overwrite is specified\"), FileSystemProviderErrorCode.FileExists);\n\t\t}\n\n\t\t// Handle existing target for move/copy\n\t\tif ((fromStat.type & FileType.File) !== 0 && (toStat.type & FileType.File) !== 0) {\n\t\t\treturn; // node.js can move/copy a file over an existing file without having to delete it first\n\t\t} else {\n\t\t\tawait this.delete(to, { recursive: true, useTrash: false, atomic: false });\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region Clone File\n\n\tasync cloneFile(from: URI, to: URI): Promise<void> {\n\t\treturn this.doCloneFile(from, to, false /* optimistically assume parent folders exist */);\n\t}\n\n\tprivate async doCloneFile(from: URI, to: URI, mkdir: boolean): Promise<void> {\n\t\tconst fromFilePath = this.toFilePath(from);\n\t\tconst toFilePath = this.toFilePath(to);\n\n\t\tconst isPathCaseSensitive = !!(this.capabilities & FileSystemProviderCapabilities.PathCaseSensitive);\n\t\tif (isEqual(fromFilePath, toFilePath, !isPathCaseSensitive)) {\n\t\t\treturn; // cloning is only supported `from` and `to` are different files\n\t\t}\n\n\t\t// Implement clone by using `fs.copyFile`, however setup locks\n\t\t// for both `from` and `to` because node.js does not ensure\n\t\t// this to be an atomic operation\n\n\t\tconst locks = new DisposableStore();\n\n\t\ttry {\n\t\t\tlocks.add(await this.createResourceLock(from));\n\t\t\tlocks.add(await this.createResourceLock(to));\n\n\t\t\tif (mkdir) {\n\t\t\t\tawait promises.mkdir(dirname(toFilePath), { recursive: true });\n\t\t\t}\n\n\t\t\tawait promises.copyFile(fromFilePath, toFilePath);\n\t\t} catch (error) {\n\t\t\tif (error.code === 'ENOENT' && !mkdir) {\n\t\t\t\treturn this.doCloneFile(from, to, true);\n\t\t\t}\n\n\t\t\tthrow this.toFileSystemProviderError(error);\n\t\t} finally {\n\t\t\tlocks.dispose();\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region File Watching\n\n\tprotected createUniversalWatcher(\n\t\tonChange: (changes: IFileChange[]) => void,\n\t\tonLogMessage: (msg: ILogMessage) => void,\n\t\tverboseLogging: boolean\n\t): AbstractUniversalWatcherClient {\n\t\treturn new UniversalWatcherClient(changes => onChange(changes), msg => onLogMessage(msg), verboseLogging);\n\t}\n\n\tprotected createNonRecursiveWatcher(\n\t\tonChange: (changes: IFileChange[]) => void,\n\t\tonLogMessage: (msg: ILogMessage) => void,\n\t\tverboseLogging: boolean\n\t): AbstractNonRecursiveWatcherClient {\n\t\treturn new NodeJSWatcherClient(changes => onChange(changes), msg => onLogMessage(msg), verboseLogging);\n\t}\n\n\t//#endregion\n\n\t//#region Helpers\n\n\tprivate toFileSystemProviderError(error: NodeJS.ErrnoException): FileSystemProviderError {\n\t\tif (error instanceof FileSystemProviderError) {\n\t\t\treturn error; // avoid double conversion\n\t\t}\n\n\t\tlet resultError: Error | string = error;\n\t\tlet code: FileSystemProviderErrorCode;\n\t\tswitch (error.code) {\n\t\t\tcase 'ENOENT':\n\t\t\t\tcode = FileSystemProviderErrorCode.FileNotFound;\n\t\t\t\tbreak;\n\t\t\tcase 'EISDIR':\n\t\t\t\tcode = FileSystemProviderErrorCode.FileIsADirectory;\n\t\t\t\tbreak;\n\t\t\tcase 'ENOTDIR':\n\t\t\t\tcode = FileSystemProviderErrorCode.FileNotADirectory;\n\t\t\t\tbreak;\n\t\t\tcase 'EEXIST':\n\t\t\t\tcode = FileSystemProviderErrorCode.FileExists;\n\t\t\t\tbreak;\n\t\t\tcase 'EPERM':\n\t\t\tcase 'EACCES':\n\t\t\t\tcode = FileSystemProviderErrorCode.NoPermissions;\n\t\t\t\tbreak;\n\t\t\tcase 'ERR_UNC_HOST_NOT_ALLOWED':\n\t\t\t\tresultError = `${error.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`;\n\t\t\t\tcode = FileSystemProviderErrorCode.Unknown;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcode = FileSystemProviderErrorCode.Unknown;\n\t\t}\n\n\t\treturn createFileSystemProviderError(resultError, code);\n\t}\n\n\tprivate async toFileSystemProviderWriteError(resource: URI | undefined, error: NodeJS.ErrnoException): Promise<FileSystemProviderError> {\n\t\tlet fileSystemProviderWriteError = this.toFileSystemProviderError(error);\n\n\t\t// If the write error signals permission issues, we try\n\t\t// to read the file's mode to see if the file is write\n\t\t// locked.\n\t\tif (resource && fileSystemProviderWriteError.code === FileSystemProviderErrorCode.NoPermissions) {\n\t\t\ttry {\n\t\t\t\tconst { stat } = await SymlinkSupport.stat(this.toFilePath(resource));\n\t\t\t\tif (!(stat.mode & 0o200 /* File mode indicating writable by owner */)) {\n\t\t\t\t\tfileSystemProviderWriteError = createFileSystemProviderError(error, FileSystemProviderErrorCode.FileWriteLocked);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.trace(error); // ignore - return original error\n\t\t\t}\n\t\t}\n\n\t\treturn fileSystemProviderWriteError;\n\t}\n\n\t//#endregion\n}\n"]}