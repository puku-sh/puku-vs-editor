{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/files/node/watcher/watcher.ts","vs/platform/files/node/watcher/watcher.ts"],"names":[],"mappings":"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","file":"watcher.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ILogMessage, isRecursiveWatchRequest, IUniversalWatcher, IUniversalWatchRequest } from '../../common/watcher.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { ParcelWatcher } from './parcel/parcelWatcher.js';\nimport { NodeJSWatcher } from './nodejs/nodejsWatcher.js';\nimport { Promises } from '../../../../base/common/async.js';\nimport { computeStats } from './watcherStats.js';\n\nexport class UniversalWatcher extends Disposable implements IUniversalWatcher {\n\n\tprivate readonly recursiveWatcher = this._register(new ParcelWatcher());\n\tprivate readonly nonRecursiveWatcher = this._register(new NodeJSWatcher(this.recursiveWatcher));\n\n\treadonly onDidChangeFile = Event.any(this.recursiveWatcher.onDidChangeFile, this.nonRecursiveWatcher.onDidChangeFile);\n\treadonly onDidError = Event.any(this.recursiveWatcher.onDidError, this.nonRecursiveWatcher.onDidError);\n\n\tprivate readonly _onDidLogMessage = this._register(new Emitter<ILogMessage>());\n\treadonly onDidLogMessage = Event.any(this._onDidLogMessage.event, this.recursiveWatcher.onDidLogMessage, this.nonRecursiveWatcher.onDidLogMessage);\n\n\tprivate requests: IUniversalWatchRequest[] = [];\n\tprivate failedRecursiveRequests = 0;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._register(this.recursiveWatcher.onDidError(e => {\n\t\t\tif (e.request) {\n\t\t\t\tthis.failedRecursiveRequests++;\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync watch(requests: IUniversalWatchRequest[]): Promise<void> {\n\t\tthis.requests = requests;\n\t\tthis.failedRecursiveRequests = 0;\n\n\t\t// Watch recursively first to give recursive watchers a chance\n\t\t// to step in for non-recursive watch requests, thus reducing\n\t\t// watcher duplication.\n\n\t\tlet error: Error | undefined;\n\t\ttry {\n\t\t\tawait this.recursiveWatcher.watch(requests.filter(request => isRecursiveWatchRequest(request)));\n\t\t} catch (e) {\n\t\t\terror = e;\n\t\t}\n\n\t\ttry {\n\t\t\tawait this.nonRecursiveWatcher.watch(requests.filter(request => !isRecursiveWatchRequest(request)));\n\t\t} catch (e) {\n\t\t\tif (!error) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync setVerboseLogging(enabled: boolean): Promise<void> {\n\n\t\t// Log stats\n\t\tif (enabled && this.requests.length > 0) {\n\t\t\tthis._onDidLogMessage.fire({ type: 'trace', message: computeStats(this.requests, this.failedRecursiveRequests, this.recursiveWatcher, this.nonRecursiveWatcher) });\n\t\t}\n\n\t\t// Forward to watchers\n\t\tawait Promises.settled([\n\t\t\tthis.recursiveWatcher.setVerboseLogging(enabled),\n\t\t\tthis.nonRecursiveWatcher.setVerboseLogging(enabled)\n\t\t]);\n\t}\n\n\tasync stop(): Promise<void> {\n\t\tawait Promises.settled([\n\t\t\tthis.recursiveWatcher.stop(),\n\t\t\tthis.nonRecursiveWatcher.stop()\n\t\t]);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ILogMessage, isRecursiveWatchRequest, IUniversalWatcher, IUniversalWatchRequest } from '../../common/watcher.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { ParcelWatcher } from './parcel/parcelWatcher.js';\nimport { NodeJSWatcher } from './nodejs/nodejsWatcher.js';\nimport { Promises } from '../../../../base/common/async.js';\nimport { computeStats } from './watcherStats.js';\n\nexport class UniversalWatcher extends Disposable implements IUniversalWatcher {\n\n\tprivate readonly recursiveWatcher = this._register(new ParcelWatcher());\n\tprivate readonly nonRecursiveWatcher = this._register(new NodeJSWatcher(this.recursiveWatcher));\n\n\treadonly onDidChangeFile = Event.any(this.recursiveWatcher.onDidChangeFile, this.nonRecursiveWatcher.onDidChangeFile);\n\treadonly onDidError = Event.any(this.recursiveWatcher.onDidError, this.nonRecursiveWatcher.onDidError);\n\n\tprivate readonly _onDidLogMessage = this._register(new Emitter<ILogMessage>());\n\treadonly onDidLogMessage = Event.any(this._onDidLogMessage.event, this.recursiveWatcher.onDidLogMessage, this.nonRecursiveWatcher.onDidLogMessage);\n\n\tprivate requests: IUniversalWatchRequest[] = [];\n\tprivate failedRecursiveRequests = 0;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._register(this.recursiveWatcher.onDidError(e => {\n\t\t\tif (e.request) {\n\t\t\t\tthis.failedRecursiveRequests++;\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync watch(requests: IUniversalWatchRequest[]): Promise<void> {\n\t\tthis.requests = requests;\n\t\tthis.failedRecursiveRequests = 0;\n\n\t\t// Watch recursively first to give recursive watchers a chance\n\t\t// to step in for non-recursive watch requests, thus reducing\n\t\t// watcher duplication.\n\n\t\tlet error: Error | undefined;\n\t\ttry {\n\t\t\tawait this.recursiveWatcher.watch(requests.filter(request => isRecursiveWatchRequest(request)));\n\t\t} catch (e) {\n\t\t\terror = e;\n\t\t}\n\n\t\ttry {\n\t\t\tawait this.nonRecursiveWatcher.watch(requests.filter(request => !isRecursiveWatchRequest(request)));\n\t\t} catch (e) {\n\t\t\tif (!error) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync setVerboseLogging(enabled: boolean): Promise<void> {\n\n\t\t// Log stats\n\t\tif (enabled && this.requests.length > 0) {\n\t\t\tthis._onDidLogMessage.fire({ type: 'trace', message: computeStats(this.requests, this.failedRecursiveRequests, this.recursiveWatcher, this.nonRecursiveWatcher) });\n\t\t}\n\n\t\t// Forward to watchers\n\t\tawait Promises.settled([\n\t\t\tthis.recursiveWatcher.setVerboseLogging(enabled),\n\t\t\tthis.nonRecursiveWatcher.setVerboseLogging(enabled)\n\t\t]);\n\t}\n\n\tasync stop(): Promise<void> {\n\t\tawait Promises.settled([\n\t\t\tthis.recursiveWatcher.stop(),\n\t\t\tthis.nonRecursiveWatcher.stop()\n\t\t]);\n\t}\n}\n"]}