{"version":3,"sources":["vs/platform/files/electron-main/diskFileSystemProviderServer.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,KAAK,EAAE,MAAM,UAAU,CAAC;AACjC,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAC;AAC3C,OAAO,EAAE,SAAS,EAAE,MAAM,kCAAkC,CAAC;AAE7D,OAAO,EAAE,GAAG,EAAiB,MAAM,6BAA6B,CAAC;AACjE,OAAO,EAAkD,6BAA6B,EAAE,2BAA2B,EAAE,MAAM,oBAAoB,CAAC;AAEhJ,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,8BAA8B,CAAC;AAGnE,OAAO,EAAE,qCAAqC,EAAE,0BAA0B,EAAuB,MAAM,yCAAyC,CAAC;AACjJ,OAAO,EAAE,qBAAqB,EAAmB,MAAM,gCAAgC,CAAC;AAExF,OAAO,EAAE,cAAc,EAAE,MAAM,sCAAsC,CAAC;AAEtE,MAAM,OAAO,6BAA8B,SAAQ,qCAA8C;IAEhG,YACC,QAAgC,EAChC,UAAuB,EACN,kBAAuC;QAExD,KAAK,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAFX,uBAAkB,GAAlB,kBAAkB,CAAqB;IAGzD,CAAC;IAEkB,iBAAiB,CAAC,GAAY;QAChD,OAAO,qBAAqB,CAAC;IAC9B,CAAC;IAEkB,iBAAiB,CAAC,cAA+B,EAAE,SAAwB;QAC7F,OAAO,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAC9B,CAAC;IAED,8DAA8D;IAE3C,KAAK,CAAC,MAAM,CAAC,cAA+B,EAAE,SAAwB,EAAE,IAAwB;QAClH,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;YACpB,OAAO,KAAK,CAAC,MAAM,CAAC,cAAc,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;QACtD,CAAC;QAED,MAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;QACnE,MAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC5C,IAAI,CAAC;YACJ,MAAM,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;QACjC,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YAChB,MAAM,6BAA6B,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAW,EAAE,IAA+C,EAAE,QAAQ,CAAC,QAAQ,CAAC,EAAE,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAa,EAAE,IAAyC,EAAE,QAAQ,CAAC,QAAQ,CAAC,EAAE,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE,2BAA2B,CAAC,OAAO,CAAC,CAAC;QACzT,CAAC;IACF,CAAC;IAED,YAAY;IAEZ,uBAAuB;IAEb,wBAAwB,CAAC,cAA+B,EAAE,OAAwC;QAC3G,OAAO,IAAI,kBAAkB,CAAC,cAAc,EAAE,OAAO,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;IAClG,CAAC;CAID;AAED,MAAM,kBAAmB,SAAQ,0BAA0B;IAEjD,KAAK,CAAC,GAAW,EAAE,QAAa,EAAE,IAAmB;QAC7D,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACpB,MAAM,6BAA6B,CAAC,qFAAqF,EAAE,2BAA2B,CAAC,WAAW,CAAC,CAAC;QACrK,CAAC;QAED,OAAO,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;IACzC,CAAC;CACD","file":"diskFileSystemProviderServer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { shell } from 'electron';\nimport { localize } from '../../../nls.js';\nimport { isWindows } from '../../../base/common/platform.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { IFileDeleteOptions, IFileChange, IWatchOptions, createFileSystemProviderError, FileSystemProviderErrorCode } from '../common/files.js';\nimport { DiskFileSystemProvider } from '../node/diskFileSystemProvider.js';\nimport { basename, normalize } from '../../../base/common/path.js';\nimport { IDisposable } from '../../../base/common/lifecycle.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { AbstractDiskFileSystemProviderChannel, AbstractSessionFileWatcher, ISessionFileWatcher } from '../node/diskFileSystemProviderServer.js';\nimport { DefaultURITransformer, IURITransformer } from '../../../base/common/uriIpc.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { toErrorMessage } from '../../../base/common/errorMessage.js';\n\nexport class DiskFileSystemProviderChannel extends AbstractDiskFileSystemProviderChannel<unknown> {\n\n\tconstructor(\n\t\tprovider: DiskFileSystemProvider,\n\t\tlogService: ILogService,\n\t\tprivate readonly environmentService: IEnvironmentService\n\t) {\n\t\tsuper(provider, logService);\n\t}\n\n\tprotected override getUriTransformer(ctx: unknown): IURITransformer {\n\t\treturn DefaultURITransformer;\n\t}\n\n\tprotected override transformIncoming(uriTransformer: IURITransformer, _resource: UriComponents): URI {\n\t\treturn URI.revive(_resource);\n\t}\n\n\t//#region Delete: override to support Electron's trash support\n\n\tprotected override async delete(uriTransformer: IURITransformer, _resource: UriComponents, opts: IFileDeleteOptions): Promise<void> {\n\t\tif (!opts.useTrash) {\n\t\t\treturn super.delete(uriTransformer, _resource, opts);\n\t\t}\n\n\t\tconst resource = this.transformIncoming(uriTransformer, _resource);\n\t\tconst filePath = normalize(resource.fsPath);\n\t\ttry {\n\t\t\tawait shell.trashItem(filePath);\n\t\t} catch (error) {\n\t\t\tthrow createFileSystemProviderError(isWindows ? localize('binFailed', \"Failed to move '{0}' to the recycle bin ({1})\", basename(filePath), toErrorMessage(error)) : localize('trashFailed', \"Failed to move '{0}' to the trash ({1})\", basename(filePath), toErrorMessage(error)), FileSystemProviderErrorCode.Unknown);\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region File Watching\n\n\tprotected createSessionFileWatcher(uriTransformer: IURITransformer, emitter: Emitter<IFileChange[] | string>): ISessionFileWatcher {\n\t\treturn new SessionFileWatcher(uriTransformer, emitter, this.logService, this.environmentService);\n\t}\n\n\t//#endregion\n\n}\n\nclass SessionFileWatcher extends AbstractSessionFileWatcher {\n\n\toverride watch(req: number, resource: URI, opts: IWatchOptions): IDisposable {\n\t\tif (opts.recursive) {\n\t\t\tthrow createFileSystemProviderError('Recursive file watching is not supported from main process for performance reasons.', FileSystemProviderErrorCode.Unavailable);\n\t\t}\n\n\t\treturn super.watch(req, resource, opts);\n\t}\n}\n"]}