{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/files/test/node/parcelWatcher.test.ts","vs/platform/files/test/node/parcelWatcher.test.ts"],"names":[],"mappings":"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","file":"parcelWatcher.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { realpathSync, promises } from 'fs';\nimport { tmpdir } from 'os';\nimport { timeout } from '../../../../base/common/async.js';\nimport { dirname, join } from '../../../../base/common/path.js';\nimport { isLinux, isMacintosh, isWindows } from '../../../../base/common/platform.js';\nimport { Promises, RimRafMode } from '../../../../base/node/pfs.js';\nimport { getRandomTestPath } from '../../../../base/test/node/testUtils.js';\nimport { FileChangeFilter, FileChangeType, IFileChange } from '../../common/files.js';\nimport { ParcelWatcher } from '../../node/watcher/parcel/parcelWatcher.js';\nimport { IRecursiveWatchRequest } from '../../common/watcher.js';\nimport { getDriveLetter } from '../../../../base/common/extpath.js';\nimport { ltrim } from '../../../../base/common/strings.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { addUNCHostToAllowlist } from '../../../../base/node/unc.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\nexport class TestParcelWatcher extends ParcelWatcher {\n\n\tprotected override readonly suspendedWatchRequestPollingInterval = 100;\n\n\tprivate readonly _onDidWatch = this._register(new Emitter<void>());\n\treadonly onDidWatch = this._onDidWatch.event;\n\n\treadonly onWatchFail = this._onDidWatchFail.event;\n\n\tasync testRemoveDuplicateRequests(paths: string[], excludes: string[] = []): Promise<string[]> {\n\n\t\t// Work with strings as paths to simplify testing\n\t\tconst requests: IRecursiveWatchRequest[] = paths.map(path => {\n\t\t\treturn { path, excludes, recursive: true };\n\t\t});\n\n\t\treturn (await this.removeDuplicateRequests(requests, false /* validate paths skipped for tests */)).map(request => request.path);\n\t}\n\n\tprotected override getUpdateWatchersDelay(): number {\n\t\treturn 0;\n\t}\n\n\tprotected override async doWatch(requests: IRecursiveWatchRequest[]): Promise<void> {\n\t\tawait super.doWatch(requests);\n\t\tawait this.whenReady();\n\n\t\tthis._onDidWatch.fire();\n\t}\n\n\tasync whenReady(): Promise<void> {\n\t\tfor (const watcher of this.watchers) {\n\t\t\tawait watcher.ready;\n\t\t}\n\t}\n}\n\n// this suite has shown flaky runs in Azure pipelines where\n// tasks would just hang and timeout after a while (not in\n// mocha but generally). as such they will run only on demand\n// whenever we update the watcher library.\n\nsuite.skip('File Watcher (parcel)', function () {\n\n\tthis.timeout(10000);\n\n\tlet testDir: string;\n\tlet watcher: TestParcelWatcher;\n\n\tlet loggingEnabled = false;\n\n\tfunction enableLogging(enable: boolean) {\n\t\tloggingEnabled = enable;\n\t\twatcher?.setVerboseLogging(enable);\n\t}\n\n\tenableLogging(loggingEnabled);\n\n\tsetup(async () => {\n\t\twatcher = new TestParcelWatcher();\n\t\twatcher.setVerboseLogging(loggingEnabled);\n\n\t\twatcher.onDidLogMessage(e => {\n\t\t\tif (loggingEnabled) {\n\t\t\t\tconsole.log(`[recursive watcher test message] ${e.message}`);\n\t\t\t}\n\t\t});\n\n\t\twatcher.onDidError(e => {\n\t\t\tif (loggingEnabled) {\n\t\t\t\tconsole.log(`[recursive watcher test error] ${e.error}`);\n\t\t\t}\n\t\t});\n\n\t\t// Rule out strange testing conditions by using the realpath\n\t\t// here. for example, on macOS the tmp dir is potentially a\n\t\t// symlink in some of the root folders, which is a rather\n\t\t// unrealisic case for the file watcher.\n\t\ttestDir = URI.file(getRandomTestPath(realpathSync(tmpdir()), 'vsctests', 'filewatcher')).fsPath;\n\n\t\tconst sourceDir = FileAccess.asFileUri('vs/platform/files/test/node/fixtures/service').fsPath;\n\n\t\tawait Promises.copy(sourceDir, testDir, { preserveSymlinks: false });\n\t});\n\n\tteardown(async () => {\n\t\tconst watchers = Array.from(watcher.watchers).length;\n\t\tlet stoppedInstances = 0;\n\t\tfor (const instance of watcher.watchers) {\n\t\t\tEvent.once(instance.onDidStop)(() => {\n\t\t\t\tif (instance.stopped) {\n\t\t\t\t\tstoppedInstances++;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tawait watcher.stop();\n\t\tassert.strictEqual(stoppedInstances, watchers, 'All watchers must be stopped before the test ends');\n\t\twatcher.dispose();\n\n\t\t// Possible that the file watcher is still holding\n\t\t// onto the folders on Windows specifically and the\n\t\t// unlink would fail. In that case, do not fail the\n\t\t// test suite.\n\t\treturn Promises.rm(testDir).catch(error => console.error(error));\n\t});\n\n\tfunction toMsg(type: FileChangeType): string {\n\t\tswitch (type) {\n\t\t\tcase FileChangeType.ADDED: return 'added';\n\t\t\tcase FileChangeType.DELETED: return 'deleted';\n\t\t\tdefault: return 'changed';\n\t\t}\n\t}\n\n\tasync function awaitEvent(watcher: TestParcelWatcher, path: string, type: FileChangeType, failOnEventReason?: string, correlationId?: number | null, expectedCount?: number): Promise<IFileChange[]> {\n\t\tif (loggingEnabled) {\n\t\t\tconsole.log(`Awaiting change type '${toMsg(type)}' on file '${path}'`);\n\t\t}\n\n\t\t// Await the event\n\t\tconst res = await new Promise<IFileChange[]>((resolve, reject) => {\n\t\t\tlet counter = 0;\n\t\t\tconst disposable = watcher.onDidChangeFile(events => {\n\t\t\t\tfor (const event of events) {\n\t\t\t\t\tif (extUriBiasedIgnorePathCase.isEqual(event.resource, URI.file(path)) && event.type === type && (correlationId === null || event.cId === correlationId)) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\tif (typeof expectedCount === 'number' && counter < expectedCount) {\n\t\t\t\t\t\t\tcontinue; // not yet\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\t\tif (failOnEventReason) {\n\t\t\t\t\t\t\treject(new Error(`Unexpected file event: ${failOnEventReason}`));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetImmediate(() => resolve(events)); // copied from parcel watcher tests, seems to drop unrelated events on macOS\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Unwind from the event call stack: we have seen crashes in Parcel\n\t\t// when e.g. calling `unsubscribe` directly from the stack of a file\n\t\t// change event\n\t\t// Refs: https://github.com/microsoft/vscode/issues/137430\n\t\tawait timeout(1);\n\n\t\treturn res;\n\t}\n\n\tfunction awaitMessage(watcher: TestParcelWatcher, type: 'trace' | 'warn' | 'error' | 'info' | 'debug'): Promise<void> {\n\t\tif (loggingEnabled) {\n\t\t\tconsole.log(`Awaiting message of type ${type}`);\n\t\t}\n\n\t\t// Await the message\n\t\treturn new Promise<void>(resolve => {\n\t\t\tconst disposable = watcher.onDidLogMessage(msg => {\n\t\t\t\tif (msg.type === type) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\ttest('basics', async function () {\n\t\tconst request = { path: testDir, excludes: [], recursive: true };\n\t\tawait watcher.watch([request]);\n\n\t\tconst instance = Array.from(watcher.watchers)[0];\n\t\tassert.strictEqual(request, instance.request);\n\t\tassert.strictEqual(instance.failed, false);\n\t\tassert.strictEqual(instance.stopped, false);\n\n\t\tconst disposables = new DisposableStore();\n\n\t\tconst subscriptions1 = new Map<string, FileChangeType>();\n\t\tconst subscriptions2 = new Map<string, FileChangeType>();\n\n\t\t// New file\n\t\tconst newFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tdisposables.add(instance.subscribe(newFilePath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tdisposables.add(instance.subscribe(newFilePath, change => subscriptions2.set(change.resource.fsPath, change.type))); // can subscribe multiple times\n\t\tassert.strictEqual(instance.include(newFilePath), true);\n\t\tassert.strictEqual(instance.exclude(newFilePath), false);\n\t\tlet changeFuture: Promise<unknown> = awaitEvent(watcher, newFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFilePath), FileChangeType.ADDED);\n\t\tassert.strictEqual(subscriptions2.get(newFilePath), FileChangeType.ADDED);\n\n\t\t// New folder\n\t\tconst newFolderPath = join(testDir, 'deep', 'New Folder');\n\t\tdisposables.add(instance.subscribe(newFolderPath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tconst disposable = instance.subscribe(newFolderPath, change => subscriptions2.set(change.resource.fsPath, change.type));\n\t\tdisposable.dispose();\n\t\tassert.strictEqual(instance.include(newFolderPath), true);\n\t\tassert.strictEqual(instance.exclude(newFolderPath), false);\n\t\tchangeFuture = awaitEvent(watcher, newFolderPath, FileChangeType.ADDED);\n\t\tawait promises.mkdir(newFolderPath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFolderPath), FileChangeType.ADDED);\n\t\tassert.strictEqual(subscriptions2.has(newFolderPath), false /* subscription was disposed before the event */);\n\n\t\t// Rename file\n\t\tlet renamedFilePath = join(testDir, 'deep', 'renamedFile.txt');\n\t\tdisposables.add(instance.subscribe(renamedFilePath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, newFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(newFilePath, renamedFilePath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFilePath), FileChangeType.DELETED);\n\t\tassert.strictEqual(subscriptions1.get(renamedFilePath), FileChangeType.ADDED);\n\n\t\t// Rename folder\n\t\tlet renamedFolderPath = join(testDir, 'deep', 'Renamed Folder');\n\t\tdisposables.add(instance.subscribe(renamedFolderPath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, newFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(newFolderPath, renamedFolderPath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFolderPath), FileChangeType.DELETED);\n\t\tassert.strictEqual(subscriptions1.get(renamedFolderPath), FileChangeType.ADDED);\n\n\t\t// Rename file (same name, different case)\n\t\tconst caseRenamedFilePath = join(testDir, 'deep', 'RenamedFile.txt');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, caseRenamedFilePath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFilePath, caseRenamedFilePath);\n\t\tawait changeFuture;\n\t\trenamedFilePath = caseRenamedFilePath;\n\n\t\t// Rename folder (same name, different case)\n\t\tconst caseRenamedFolderPath = join(testDir, 'deep', 'REnamed Folder');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, caseRenamedFolderPath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFolderPath, caseRenamedFolderPath);\n\t\tawait changeFuture;\n\t\trenamedFolderPath = caseRenamedFolderPath;\n\n\t\t// Move file\n\t\tconst movedFilepath = join(testDir, 'movedFile.txt');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, movedFilepath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFilePath, movedFilepath);\n\t\tawait changeFuture;\n\n\t\t// Move folder\n\t\tconst movedFolderpath = join(testDir, 'Moved Folder');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, movedFolderpath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFolderPath, movedFolderpath);\n\t\tawait changeFuture;\n\n\t\t// Copy file\n\t\tconst copiedFilepath = join(testDir, 'deep', 'copiedFile.txt');\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.ADDED);\n\t\tawait promises.copyFile(movedFilepath, copiedFilepath);\n\t\tawait changeFuture;\n\n\t\t// Copy folder\n\t\tconst copiedFolderpath = join(testDir, 'deep', 'Copied Folder');\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.ADDED);\n\t\tawait Promises.copy(movedFolderpath, copiedFolderpath, { preserveSymlinks: false });\n\t\tawait changeFuture;\n\n\t\t// Change file\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.UPDATED);\n\t\tawait Promises.writeFile(copiedFilepath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Create new file\n\t\tconst anotherNewFilePath = join(testDir, 'deep', 'anotherNewFile.txt');\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(anotherNewFilePath, 'Hello Another World');\n\t\tawait changeFuture;\n\n\t\t// Read file does not emit event\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.UPDATED, 'unexpected-event-from-read-file');\n\t\tawait promises.readFile(anotherNewFilePath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Stat file does not emit event\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.UPDATED, 'unexpected-event-from-stat');\n\t\tawait promises.stat(anotherNewFilePath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Stat folder does not emit event\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.UPDATED, 'unexpected-event-from-stat');\n\t\tawait promises.stat(copiedFolderpath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.DELETED);\n\t\tdisposables.add(instance.subscribe(copiedFilepath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tawait promises.unlink(copiedFilepath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(copiedFilepath), FileChangeType.DELETED);\n\n\t\t// Delete folder\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.DELETED);\n\t\tdisposables.add(instance.subscribe(copiedFolderpath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tawait promises.rmdir(copiedFolderpath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(copiedFolderpath), FileChangeType.DELETED);\n\n\t\tdisposables.dispose();\n\t});\n\n\t(isMacintosh /* this test seems not possible with fsevents backend */ ? test.skip : test)('basics (atomic writes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\t// Delete + Recreate file\n\t\tconst newFilePath = join(testDir, 'deep', 'conway.js');\n\t\tconst changeFuture = awaitEvent(watcher, newFilePath, FileChangeType.UPDATED);\n\t\tawait promises.unlink(newFilePath);\n\t\tPromises.writeFile(newFilePath, 'Hello Atomic World');\n\t\tawait changeFuture;\n\t});\n\n\t(!isLinux /* polling is only used in linux environments (WSL) */ ? test.skip : test)('basics (polling)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], pollingInterval: 100, recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\tasync function basicCrudTest(filePath: string, correlationId?: number | null, expectedCount?: number): Promise<void> {\n\n\t\t// New file\n\t\tlet changeFuture = awaitEvent(watcher, filePath, FileChangeType.ADDED, undefined, correlationId, expectedCount);\n\t\tawait Promises.writeFile(filePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\t// Change file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.UPDATED, undefined, correlationId, expectedCount);\n\t\tawait Promises.writeFile(filePath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.DELETED, undefined, correlationId, expectedCount);\n\t\tawait promises.unlink(filePath);\n\t\tawait changeFuture;\n\t}\n\n\ttest('multiple events', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\t\tawait promises.mkdir(join(testDir, 'deep-multiple'));\n\n\t\t// multiple add\n\n\t\tconst newFilePath1 = join(testDir, 'newFile-1.txt');\n\t\tconst newFilePath2 = join(testDir, 'newFile-2.txt');\n\t\tconst newFilePath3 = join(testDir, 'newFile-3.txt');\n\t\tconst newFilePath4 = join(testDir, 'deep-multiple', 'newFile-1.txt');\n\t\tconst newFilePath5 = join(testDir, 'deep-multiple', 'newFile-2.txt');\n\t\tconst newFilePath6 = join(testDir, 'deep-multiple', 'newFile-3.txt');\n\n\t\tconst addedFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.ADDED);\n\t\tconst addedFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.ADDED);\n\t\tconst addedFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.ADDED);\n\t\tconst addedFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.ADDED);\n\t\tconst addedFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.ADDED);\n\t\tconst addedFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.ADDED);\n\n\t\tawait Promise.all([\n\t\t\tawait Promises.writeFile(newFilePath1, 'Hello World 1'),\n\t\t\tawait Promises.writeFile(newFilePath2, 'Hello World 2'),\n\t\t\tawait Promises.writeFile(newFilePath3, 'Hello World 3'),\n\t\t\tawait Promises.writeFile(newFilePath4, 'Hello World 4'),\n\t\t\tawait Promises.writeFile(newFilePath5, 'Hello World 5'),\n\t\t\tawait Promises.writeFile(newFilePath6, 'Hello World 6')\n\t\t]);\n\n\t\tawait Promise.all([addedFuture1, addedFuture2, addedFuture3, addedFuture4, addedFuture5, addedFuture6]);\n\n\t\t// multiple change\n\n\t\tconst changeFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.UPDATED);\n\t\tconst changeFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.UPDATED);\n\t\tconst changeFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.UPDATED);\n\t\tconst changeFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.UPDATED);\n\t\tconst changeFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.UPDATED);\n\t\tconst changeFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.UPDATED);\n\n\t\tawait Promise.all([\n\t\t\tawait Promises.writeFile(newFilePath1, 'Hello Update 1'),\n\t\t\tawait Promises.writeFile(newFilePath2, 'Hello Update 2'),\n\t\t\tawait Promises.writeFile(newFilePath3, 'Hello Update 3'),\n\t\t\tawait Promises.writeFile(newFilePath4, 'Hello Update 4'),\n\t\t\tawait Promises.writeFile(newFilePath5, 'Hello Update 5'),\n\t\t\tawait Promises.writeFile(newFilePath6, 'Hello Update 6')\n\t\t]);\n\n\t\tawait Promise.all([changeFuture1, changeFuture2, changeFuture3, changeFuture4, changeFuture5, changeFuture6]);\n\n\t\t// copy with multiple files\n\n\t\tconst copyFuture1 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-1.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture2 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-2.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture3 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-3.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture4 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy'), FileChangeType.ADDED);\n\n\t\tawait Promises.copy(join(testDir, 'deep-multiple'), join(testDir, 'deep-multiple-copy'), { preserveSymlinks: false });\n\n\t\tawait Promise.all([copyFuture1, copyFuture2, copyFuture3, copyFuture4]);\n\n\t\t// multiple delete (single files)\n\n\t\tconst deleteFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.DELETED);\n\t\tconst deleteFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.DELETED);\n\t\tconst deleteFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.DELETED);\n\t\tconst deleteFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.DELETED);\n\t\tconst deleteFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.DELETED);\n\t\tconst deleteFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.DELETED);\n\n\t\tawait Promise.all([\n\t\t\tawait promises.unlink(newFilePath1),\n\t\t\tawait promises.unlink(newFilePath2),\n\t\t\tawait promises.unlink(newFilePath3),\n\t\t\tawait promises.unlink(newFilePath4),\n\t\t\tawait promises.unlink(newFilePath5),\n\t\t\tawait promises.unlink(newFilePath6)\n\t\t]);\n\n\t\tawait Promise.all([deleteFuture1, deleteFuture2, deleteFuture3, deleteFuture4, deleteFuture5, deleteFuture6]);\n\n\t\t// multiple delete (folder)\n\n\t\tconst deleteFolderFuture1 = awaitEvent(watcher, join(testDir, 'deep-multiple'), FileChangeType.DELETED);\n\t\tconst deleteFolderFuture2 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy'), FileChangeType.DELETED);\n\n\t\tawait Promise.all([Promises.rm(join(testDir, 'deep-multiple'), RimRafMode.UNLINK), Promises.rm(join(testDir, 'deep-multiple-copy'), RimRafMode.UNLINK)]);\n\n\t\tawait Promise.all([deleteFolderFuture1, deleteFolderFuture2]);\n\t});\n\n\ttest('subsequent watch updates watchers (path)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [join(realpathSync(testDir), 'unrelated')], recursive: true }]);\n\n\t\t// New file (*.txt)\n\t\tlet newTextFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tlet changeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [join(realpathSync(testDir), 'unrelated')], recursive: true }]);\n\t\tnewTextFilePath = join(testDir, 'deep', 'newFile2.txt');\n\t\tchangeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [realpathSync(testDir)], recursive: true }]);\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [], recursive: true }]);\n\t\tnewTextFilePath = join(testDir, 'deep', 'newFile3.txt');\n\t\tchangeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t});\n\n\ttest('invalid path does not crash watcher', async function () {\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true },\n\t\t\t{ path: join(testDir, 'invalid-folder'), excludes: [], recursive: true },\n\t\t\t{ path: FileAccess.asFileUri('').fsPath, excludes: [], recursive: true }\n\t\t]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('subsequent watch updates watchers (excludes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [realpathSync(testDir)], recursive: true }]);\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('subsequent watch updates watchers (includes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['nothing'], recursive: true }]);\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['**/deep/**'], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported (relative pattern explicit)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: [{ base: testDir, pattern: 'deep/newFile.txt' }], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported (relative pattern implicit)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['deep/newFile.txt'], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('excludes are supported (path)', async function () {\n\t\treturn testExcludes([join(realpathSync(testDir), 'deep')]);\n\t});\n\n\ttest('excludes are supported (glob)', function () {\n\t\treturn testExcludes(['deep/**']);\n\t});\n\n\tasync function testExcludes(excludes: string[]) {\n\t\tawait watcher.watch([{ path: testDir, excludes, recursive: true }]);\n\n\t\t// New file (*.txt)\n\t\tconst newTextFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tconst changeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\n\t\tconst res = await Promise.any([\n\t\t\ttimeout(500).then(() => true),\n\t\t\tchangeFuture.then(() => false)\n\t\t]);\n\n\t\tif (!res) {\n\t\t\tassert.fail('Unexpected change event');\n\t\t}\n\t}\n\n\t(isWindows /* windows: cannot create file symbolic link without elevated context */ ? test.skip : test)('symlink support (root)', async function () {\n\t\tconst link = join(testDir, 'deep-linked');\n\t\tconst linkTarget = join(testDir, 'deep');\n\t\tawait promises.symlink(linkTarget, link);\n\n\t\tawait watcher.watch([{ path: link, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(link, 'newFile.txt'));\n\t});\n\n\t(isWindows /* windows: cannot create file symbolic link without elevated context */ ? test.skip : test)('symlink support (via extra watch)', async function () {\n\t\tconst link = join(testDir, 'deep-linked');\n\t\tconst linkTarget = join(testDir, 'deep');\n\t\tawait promises.symlink(linkTarget, link);\n\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }, { path: link, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(link, 'newFile.txt'));\n\t});\n\n\t(!isWindows /* UNC is windows only */ ? test.skip : test)('unc support', async function () {\n\t\taddUNCHostToAllowlist('localhost');\n\n\t\t// Local UNC paths are in the form of: \\\\localhost\\c$\\my_dir\n\t\tconst uncPath = `\\\\\\\\localhost\\\\${getDriveLetter(testDir)?.toLowerCase()}$\\\\${ltrim(testDir.substr(testDir.indexOf(':') + 1), '\\\\')}`;\n\n\t\tawait watcher.watch([{ path: uncPath, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(uncPath, 'deep', 'newFile.txt'));\n\t});\n\n\t(isLinux /* linux: is case sensitive */ ? test.skip : test)('wrong casing', async function () {\n\t\tconst deepWrongCasedPath = join(testDir, 'DEEP');\n\n\t\tawait watcher.watch([{ path: deepWrongCasedPath, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(deepWrongCasedPath, 'newFile.txt'));\n\t});\n\n\ttest('invalid folder does not explode', async function () {\n\t\tconst invalidPath = join(testDir, 'invalid');\n\n\t\tawait watcher.watch([{ path: invalidPath, excludes: [], recursive: true }]);\n\t});\n\n\t(isWindows /* flaky on windows */ ? test.skip : test)('deleting watched path without correlation restarts watching', async function () {\n\t\tconst watchedPath = join(testDir, 'deep');\n\n\t\tawait watcher.watch([{ path: watchedPath, excludes: [], recursive: true }]);\n\n\t\t// Delete watched path and await\n\t\tconst warnFuture = awaitMessage(watcher, 'warn');\n\t\tawait Promises.rm(watchedPath, RimRafMode.UNLINK);\n\t\tawait warnFuture;\n\n\t\t// Restore watched path\n\t\tawait timeout(1500); // node.js watcher used for monitoring folder restore is async\n\t\tawait promises.mkdir(watchedPath);\n\t\tawait timeout(1500); // restart is delayed\n\t\tawait watcher.whenReady();\n\n\t\t// Verify events come in again\n\t\tconst newFilePath = join(watchedPath, 'newFile.txt');\n\t\tconst changeFuture = awaitEvent(watcher, newFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t});\n\n\ttest('correlationId is supported', async function () {\n\t\tconst correlationId = Math.random();\n\t\tawait watcher.watch([{ correlationId, path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'newFile.txt'), correlationId);\n\t});\n\n\ttest('should not exclude roots that do not overlap', async () => {\n\t\tif (isWindows) {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a']), ['C:\\\\a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b', 'C:\\\\c\\\\d\\\\e']), ['C:\\\\a', 'C:\\\\b', 'C:\\\\c\\\\d\\\\e']);\n\t\t} else {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a']), ['/a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b', '/c/d/e']), ['/a', '/b', '/c/d/e']);\n\t\t}\n\t});\n\n\ttest('should remove sub-folders of other paths', async () => {\n\t\tif (isWindows) {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\a\\\\b']), ['C:\\\\a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b', 'C:\\\\a\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\b\\\\a', 'C:\\\\a', 'C:\\\\b', 'C:\\\\a\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\a\\\\b', 'C:\\\\a\\\\c\\\\d']), ['C:\\\\a']);\n\t\t} else {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/a/b']), ['/a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b', '/a/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/b/a', '/a', '/b', '/a/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/a/b', '/a/c/d']), ['/a']);\n\t\t}\n\t});\n\n\ttest('should ignore when everything excluded', async () => {\n\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/foo/bar', '/bar'], ['**', 'something']), []);\n\t});\n\n\ttest('watching same or overlapping paths supported when correlation is applied', async () => {\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 }\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 1);\n\n\t\t// same path, same options\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2, },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: undefined }\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'otherNewFile.txt'), null, 3);\n\n\t\t// same path, different options\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: undefined },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'deep')], recursive: true, correlationId: 3 },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'other')], recursive: true, correlationId: 4 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 5);\n\t\tawait basicCrudTest(join(testDir, 'otherNewFile.txt'), null, 5);\n\n\t\t// overlapping paths (same options)\n\t\tawait watcher.watch([\n\t\t\t{ path: dirname(testDir), excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [], recursive: true, correlationId: 3 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'deep', 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'deep', 'otherNewFile.txt'), null, 3);\n\n\t\t// overlapping paths (different options)\n\t\tawait watcher.watch([\n\t\t\t{ path: dirname(testDir), excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'some')], recursive: true, correlationId: 2 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [join(realpathSync(testDir), 'other')], recursive: true, correlationId: 3 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'deep', 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'deep', 'otherNewFile.txt'), null, 3);\n\t});\n\n\ttest('watching missing path emits watcher fail event', async function () {\n\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\n\t\tconst folderPath = join(testDir, 'missing');\n\t\twatcher.watch([{ path: folderPath, excludes: [], recursive: true }]);\n\n\t\tawait onDidWatchFail;\n\t});\n\n\ttest('deleting watched path emits watcher fail and delete event if correlated', async function () {\n\t\tconst folderPath = join(testDir, 'deep');\n\n\t\tawait watcher.watch([{ path: folderPath, excludes: [], recursive: true, correlationId: 1 }]);\n\n\t\tlet failed = false;\n\t\tconst instance = Array.from(watcher.watchers)[0];\n\t\tassert.strictEqual(instance.include(folderPath), true);\n\t\tinstance.onDidFail(() => failed = true);\n\n\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\tconst changeFuture = awaitEvent(watcher, folderPath, FileChangeType.DELETED, undefined, 1);\n\t\tPromises.rm(folderPath, RimRafMode.UNLINK);\n\t\tawait onDidWatchFail;\n\t\tawait changeFuture;\n\t\tassert.strictEqual(failed, true);\n\t\tassert.strictEqual(instance.failed, true);\n\t});\n\n\t(!isMacintosh /* Linux/Windows: times out for some reason */ ? test.skip : test)('watch requests support suspend/resume (folder, does not exist in beginning, not reusing watcher)', async () => {\n\t\tawait testWatchFolderDoesNotExist(false);\n\t});\n\n\ttest('watch requests support suspend/resume (folder, does not exist in beginning, reusing watcher)', async () => {\n\t\tawait testWatchFolderDoesNotExist(true);\n\t});\n\n\tasync function testWatchFolderDoesNotExist(reuseExistingWatcher: boolean) {\n\t\tlet onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\n\t\tconst folderPath = join(testDir, 'not-found');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [];\n\t\tif (reuseExistingWatcher) {\n\t\t\trequests.push({ path: testDir, excludes: [], recursive: true });\n\t\t\tawait watcher.watch(requests);\n\t\t}\n\n\t\tconst request: IRecursiveWatchRequest = { path: folderPath, excludes: [], recursive: true };\n\t\trequests.push(request);\n\n\t\tawait watcher.watch(requests);\n\t\tawait onDidWatchFail;\n\n\t\tif (reuseExistingWatcher) {\n\t\t\tassert.strictEqual(watcher.isSuspended(request), true);\n\t\t} else {\n\t\t\tassert.strictEqual(watcher.isSuspended(request), 'polling');\n\t\t}\n\n\t\tlet changeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\tlet onDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\tawait promises.mkdir(folderPath);\n\t\tawait changeFuture;\n\t\tawait onDidWatch;\n\n\t\tassert.strictEqual(watcher.isSuspended(request), false);\n\n\t\tconst filePath = join(folderPath, 'newFile.txt');\n\t\tawait basicCrudTest(filePath);\n\n\t\tif (!reuseExistingWatcher) {\n\t\t\tonDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\t\tawait Promises.rm(folderPath);\n\t\t\tawait onDidWatchFail;\n\n\t\t\tchangeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\t\tonDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\t\tawait promises.mkdir(folderPath);\n\t\t\tawait changeFuture;\n\t\t\tawait onDidWatch;\n\n\t\t\tawait basicCrudTest(filePath);\n\t\t}\n\t}\n\n\t(!isMacintosh /* Linux/Windows: times out for some reason */ ? test.skip : test)('watch requests support suspend/resume (folder, exist in beginning, not reusing watcher)', async () => {\n\t\tawait testWatchFolderExists(false);\n\t});\n\n\ttest('watch requests support suspend/resume (folder, exist in beginning, reusing watcher)', async () => {\n\t\tawait testWatchFolderExists(true);\n\t});\n\n\tasync function testWatchFolderExists(reuseExistingWatcher: boolean) {\n\t\tconst folderPath = join(testDir, 'deep');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [{ path: folderPath, excludes: [], recursive: true }];\n\t\tif (reuseExistingWatcher) {\n\t\t\trequests.push({ path: testDir, excludes: [], recursive: true });\n\t\t}\n\n\t\tawait watcher.watch(requests);\n\n\t\tconst filePath = join(folderPath, 'newFile.txt');\n\t\tawait basicCrudTest(filePath);\n\n\t\tif (!reuseExistingWatcher) {\n\t\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\t\tawait Promises.rm(folderPath);\n\t\t\tawait onDidWatchFail;\n\n\t\t\tconst changeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\t\tconst onDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\t\tawait promises.mkdir(folderPath);\n\t\t\tawait changeFuture;\n\t\t\tawait onDidWatch;\n\n\t\t\tawait basicCrudTest(filePath);\n\t\t}\n\t}\n\n\ttest('watch request reuses another recursive watcher even when requests are coming in at the same time', async function () {\n\t\tconst folderPath1 = join(testDir, 'deep', 'not-existing1');\n\t\tconst folderPath2 = join(testDir, 'deep', 'not-existing2');\n\t\tconst folderPath3 = join(testDir, 'not-existing3');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [\n\t\t\t{ path: folderPath1, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: folderPath2, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: folderPath3, excludes: [], recursive: true, correlationId: 3 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [], recursive: true }\n\t\t];\n\n\t\tawait watcher.watch(requests);\n\n\t\tassert.strictEqual(watcher.isSuspended(requests[0]), true);\n\t\tassert.strictEqual(watcher.isSuspended(requests[1]), true);\n\t\tassert.strictEqual(watcher.isSuspended(requests[2]), 'polling');\n\t\tassert.strictEqual(watcher.isSuspended(requests[3]), false);\n\t});\n\n\ttest('event type filter', async function () {\n\t\tconst request = { path: testDir, excludes: [], recursive: true, filter: FileChangeFilter.ADDED | FileChangeFilter.DELETED, correlationId: 1 };\n\t\tawait watcher.watch([request]);\n\n\t\t// Change file\n\t\tconst filePath = join(testDir, 'lorem-newfile.txt');\n\t\tlet changeFuture = awaitEvent(watcher, filePath, FileChangeType.ADDED, undefined, 1);\n\t\tawait Promises.writeFile(filePath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.DELETED, undefined, 1);\n\t\tawait promises.unlink(filePath);\n\t\tawait changeFuture;\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { realpathSync, promises } from 'fs';\nimport { tmpdir } from 'os';\nimport { timeout } from '../../../../base/common/async.js';\nimport { dirname, join } from '../../../../base/common/path.js';\nimport { isLinux, isMacintosh, isWindows } from '../../../../base/common/platform.js';\nimport { Promises, RimRafMode } from '../../../../base/node/pfs.js';\nimport { getRandomTestPath } from '../../../../base/test/node/testUtils.js';\nimport { FileChangeFilter, FileChangeType, IFileChange } from '../../common/files.js';\nimport { ParcelWatcher } from '../../node/watcher/parcel/parcelWatcher.js';\nimport { IRecursiveWatchRequest } from '../../common/watcher.js';\nimport { getDriveLetter } from '../../../../base/common/extpath.js';\nimport { ltrim } from '../../../../base/common/strings.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { addUNCHostToAllowlist } from '../../../../base/node/unc.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\nexport class TestParcelWatcher extends ParcelWatcher {\n\n\tprotected override readonly suspendedWatchRequestPollingInterval = 100;\n\n\tprivate readonly _onDidWatch = this._register(new Emitter<void>());\n\treadonly onDidWatch = this._onDidWatch.event;\n\n\treadonly onWatchFail = this._onDidWatchFail.event;\n\n\tasync testRemoveDuplicateRequests(paths: string[], excludes: string[] = []): Promise<string[]> {\n\n\t\t// Work with strings as paths to simplify testing\n\t\tconst requests: IRecursiveWatchRequest[] = paths.map(path => {\n\t\t\treturn { path, excludes, recursive: true };\n\t\t});\n\n\t\treturn (await this.removeDuplicateRequests(requests, false /* validate paths skipped for tests */)).map(request => request.path);\n\t}\n\n\tprotected override getUpdateWatchersDelay(): number {\n\t\treturn 0;\n\t}\n\n\tprotected override async doWatch(requests: IRecursiveWatchRequest[]): Promise<void> {\n\t\tawait super.doWatch(requests);\n\t\tawait this.whenReady();\n\n\t\tthis._onDidWatch.fire();\n\t}\n\n\tasync whenReady(): Promise<void> {\n\t\tfor (const watcher of this.watchers) {\n\t\t\tawait watcher.ready;\n\t\t}\n\t}\n}\n\n// this suite has shown flaky runs in Azure pipelines where\n// tasks would just hang and timeout after a while (not in\n// mocha but generally). as such they will run only on demand\n// whenever we update the watcher library.\n\nsuite.skip('File Watcher (parcel)', function () {\n\n\tthis.timeout(10000);\n\n\tlet testDir: string;\n\tlet watcher: TestParcelWatcher;\n\n\tlet loggingEnabled = false;\n\n\tfunction enableLogging(enable: boolean) {\n\t\tloggingEnabled = enable;\n\t\twatcher?.setVerboseLogging(enable);\n\t}\n\n\tenableLogging(loggingEnabled);\n\n\tsetup(async () => {\n\t\twatcher = new TestParcelWatcher();\n\t\twatcher.setVerboseLogging(loggingEnabled);\n\n\t\twatcher.onDidLogMessage(e => {\n\t\t\tif (loggingEnabled) {\n\t\t\t\tconsole.log(`[recursive watcher test message] ${e.message}`);\n\t\t\t}\n\t\t});\n\n\t\twatcher.onDidError(e => {\n\t\t\tif (loggingEnabled) {\n\t\t\t\tconsole.log(`[recursive watcher test error] ${e.error}`);\n\t\t\t}\n\t\t});\n\n\t\t// Rule out strange testing conditions by using the realpath\n\t\t// here. for example, on macOS the tmp dir is potentially a\n\t\t// symlink in some of the root folders, which is a rather\n\t\t// unrealisic case for the file watcher.\n\t\ttestDir = URI.file(getRandomTestPath(realpathSync(tmpdir()), 'vsctests', 'filewatcher')).fsPath;\n\n\t\tconst sourceDir = FileAccess.asFileUri('vs/platform/files/test/node/fixtures/service').fsPath;\n\n\t\tawait Promises.copy(sourceDir, testDir, { preserveSymlinks: false });\n\t});\n\n\tteardown(async () => {\n\t\tconst watchers = Array.from(watcher.watchers).length;\n\t\tlet stoppedInstances = 0;\n\t\tfor (const instance of watcher.watchers) {\n\t\t\tEvent.once(instance.onDidStop)(() => {\n\t\t\t\tif (instance.stopped) {\n\t\t\t\t\tstoppedInstances++;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tawait watcher.stop();\n\t\tassert.strictEqual(stoppedInstances, watchers, 'All watchers must be stopped before the test ends');\n\t\twatcher.dispose();\n\n\t\t// Possible that the file watcher is still holding\n\t\t// onto the folders on Windows specifically and the\n\t\t// unlink would fail. In that case, do not fail the\n\t\t// test suite.\n\t\treturn Promises.rm(testDir).catch(error => console.error(error));\n\t});\n\n\tfunction toMsg(type: FileChangeType): string {\n\t\tswitch (type) {\n\t\t\tcase FileChangeType.ADDED: return 'added';\n\t\t\tcase FileChangeType.DELETED: return 'deleted';\n\t\t\tdefault: return 'changed';\n\t\t}\n\t}\n\n\tasync function awaitEvent(watcher: TestParcelWatcher, path: string, type: FileChangeType, failOnEventReason?: string, correlationId?: number | null, expectedCount?: number): Promise<IFileChange[]> {\n\t\tif (loggingEnabled) {\n\t\t\tconsole.log(`Awaiting change type '${toMsg(type)}' on file '${path}'`);\n\t\t}\n\n\t\t// Await the event\n\t\tconst res = await new Promise<IFileChange[]>((resolve, reject) => {\n\t\t\tlet counter = 0;\n\t\t\tconst disposable = watcher.onDidChangeFile(events => {\n\t\t\t\tfor (const event of events) {\n\t\t\t\t\tif (extUriBiasedIgnorePathCase.isEqual(event.resource, URI.file(path)) && event.type === type && (correlationId === null || event.cId === correlationId)) {\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\tif (typeof expectedCount === 'number' && counter < expectedCount) {\n\t\t\t\t\t\t\tcontinue; // not yet\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\t\tif (failOnEventReason) {\n\t\t\t\t\t\t\treject(new Error(`Unexpected file event: ${failOnEventReason}`));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetImmediate(() => resolve(events)); // copied from parcel watcher tests, seems to drop unrelated events on macOS\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Unwind from the event call stack: we have seen crashes in Parcel\n\t\t// when e.g. calling `unsubscribe` directly from the stack of a file\n\t\t// change event\n\t\t// Refs: https://github.com/microsoft/vscode/issues/137430\n\t\tawait timeout(1);\n\n\t\treturn res;\n\t}\n\n\tfunction awaitMessage(watcher: TestParcelWatcher, type: 'trace' | 'warn' | 'error' | 'info' | 'debug'): Promise<void> {\n\t\tif (loggingEnabled) {\n\t\t\tconsole.log(`Awaiting message of type ${type}`);\n\t\t}\n\n\t\t// Await the message\n\t\treturn new Promise<void>(resolve => {\n\t\t\tconst disposable = watcher.onDidLogMessage(msg => {\n\t\t\t\tif (msg.type === type) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\ttest('basics', async function () {\n\t\tconst request = { path: testDir, excludes: [], recursive: true };\n\t\tawait watcher.watch([request]);\n\n\t\tconst instance = Array.from(watcher.watchers)[0];\n\t\tassert.strictEqual(request, instance.request);\n\t\tassert.strictEqual(instance.failed, false);\n\t\tassert.strictEqual(instance.stopped, false);\n\n\t\tconst disposables = new DisposableStore();\n\n\t\tconst subscriptions1 = new Map<string, FileChangeType>();\n\t\tconst subscriptions2 = new Map<string, FileChangeType>();\n\n\t\t// New file\n\t\tconst newFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tdisposables.add(instance.subscribe(newFilePath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tdisposables.add(instance.subscribe(newFilePath, change => subscriptions2.set(change.resource.fsPath, change.type))); // can subscribe multiple times\n\t\tassert.strictEqual(instance.include(newFilePath), true);\n\t\tassert.strictEqual(instance.exclude(newFilePath), false);\n\t\tlet changeFuture: Promise<unknown> = awaitEvent(watcher, newFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFilePath), FileChangeType.ADDED);\n\t\tassert.strictEqual(subscriptions2.get(newFilePath), FileChangeType.ADDED);\n\n\t\t// New folder\n\t\tconst newFolderPath = join(testDir, 'deep', 'New Folder');\n\t\tdisposables.add(instance.subscribe(newFolderPath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tconst disposable = instance.subscribe(newFolderPath, change => subscriptions2.set(change.resource.fsPath, change.type));\n\t\tdisposable.dispose();\n\t\tassert.strictEqual(instance.include(newFolderPath), true);\n\t\tassert.strictEqual(instance.exclude(newFolderPath), false);\n\t\tchangeFuture = awaitEvent(watcher, newFolderPath, FileChangeType.ADDED);\n\t\tawait promises.mkdir(newFolderPath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFolderPath), FileChangeType.ADDED);\n\t\tassert.strictEqual(subscriptions2.has(newFolderPath), false /* subscription was disposed before the event */);\n\n\t\t// Rename file\n\t\tlet renamedFilePath = join(testDir, 'deep', 'renamedFile.txt');\n\t\tdisposables.add(instance.subscribe(renamedFilePath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, newFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(newFilePath, renamedFilePath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFilePath), FileChangeType.DELETED);\n\t\tassert.strictEqual(subscriptions1.get(renamedFilePath), FileChangeType.ADDED);\n\n\t\t// Rename folder\n\t\tlet renamedFolderPath = join(testDir, 'deep', 'Renamed Folder');\n\t\tdisposables.add(instance.subscribe(renamedFolderPath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, newFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(newFolderPath, renamedFolderPath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(newFolderPath), FileChangeType.DELETED);\n\t\tassert.strictEqual(subscriptions1.get(renamedFolderPath), FileChangeType.ADDED);\n\n\t\t// Rename file (same name, different case)\n\t\tconst caseRenamedFilePath = join(testDir, 'deep', 'RenamedFile.txt');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, caseRenamedFilePath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFilePath, caseRenamedFilePath);\n\t\tawait changeFuture;\n\t\trenamedFilePath = caseRenamedFilePath;\n\n\t\t// Rename folder (same name, different case)\n\t\tconst caseRenamedFolderPath = join(testDir, 'deep', 'REnamed Folder');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, caseRenamedFolderPath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFolderPath, caseRenamedFolderPath);\n\t\tawait changeFuture;\n\t\trenamedFolderPath = caseRenamedFolderPath;\n\n\t\t// Move file\n\t\tconst movedFilepath = join(testDir, 'movedFile.txt');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFilePath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, movedFilepath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFilePath, movedFilepath);\n\t\tawait changeFuture;\n\n\t\t// Move folder\n\t\tconst movedFolderpath = join(testDir, 'Moved Folder');\n\t\tchangeFuture = Promise.all([\n\t\t\tawaitEvent(watcher, renamedFolderPath, FileChangeType.DELETED),\n\t\t\tawaitEvent(watcher, movedFolderpath, FileChangeType.ADDED)\n\t\t]);\n\t\tawait Promises.rename(renamedFolderPath, movedFolderpath);\n\t\tawait changeFuture;\n\n\t\t// Copy file\n\t\tconst copiedFilepath = join(testDir, 'deep', 'copiedFile.txt');\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.ADDED);\n\t\tawait promises.copyFile(movedFilepath, copiedFilepath);\n\t\tawait changeFuture;\n\n\t\t// Copy folder\n\t\tconst copiedFolderpath = join(testDir, 'deep', 'Copied Folder');\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.ADDED);\n\t\tawait Promises.copy(movedFolderpath, copiedFolderpath, { preserveSymlinks: false });\n\t\tawait changeFuture;\n\n\t\t// Change file\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.UPDATED);\n\t\tawait Promises.writeFile(copiedFilepath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Create new file\n\t\tconst anotherNewFilePath = join(testDir, 'deep', 'anotherNewFile.txt');\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(anotherNewFilePath, 'Hello Another World');\n\t\tawait changeFuture;\n\n\t\t// Read file does not emit event\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.UPDATED, 'unexpected-event-from-read-file');\n\t\tawait promises.readFile(anotherNewFilePath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Stat file does not emit event\n\t\tchangeFuture = awaitEvent(watcher, anotherNewFilePath, FileChangeType.UPDATED, 'unexpected-event-from-stat');\n\t\tawait promises.stat(anotherNewFilePath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Stat folder does not emit event\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.UPDATED, 'unexpected-event-from-stat');\n\t\tawait promises.stat(copiedFolderpath);\n\t\tawait Promise.race([timeout(100), changeFuture]);\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, copiedFilepath, FileChangeType.DELETED);\n\t\tdisposables.add(instance.subscribe(copiedFilepath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tawait promises.unlink(copiedFilepath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(copiedFilepath), FileChangeType.DELETED);\n\n\t\t// Delete folder\n\t\tchangeFuture = awaitEvent(watcher, copiedFolderpath, FileChangeType.DELETED);\n\t\tdisposables.add(instance.subscribe(copiedFolderpath, change => subscriptions1.set(change.resource.fsPath, change.type)));\n\t\tawait promises.rmdir(copiedFolderpath);\n\t\tawait changeFuture;\n\t\tassert.strictEqual(subscriptions1.get(copiedFolderpath), FileChangeType.DELETED);\n\n\t\tdisposables.dispose();\n\t});\n\n\t(isMacintosh /* this test seems not possible with fsevents backend */ ? test.skip : test)('basics (atomic writes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\t// Delete + Recreate file\n\t\tconst newFilePath = join(testDir, 'deep', 'conway.js');\n\t\tconst changeFuture = awaitEvent(watcher, newFilePath, FileChangeType.UPDATED);\n\t\tawait promises.unlink(newFilePath);\n\t\tPromises.writeFile(newFilePath, 'Hello Atomic World');\n\t\tawait changeFuture;\n\t});\n\n\t(!isLinux /* polling is only used in linux environments (WSL) */ ? test.skip : test)('basics (polling)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], pollingInterval: 100, recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\tasync function basicCrudTest(filePath: string, correlationId?: number | null, expectedCount?: number): Promise<void> {\n\n\t\t// New file\n\t\tlet changeFuture = awaitEvent(watcher, filePath, FileChangeType.ADDED, undefined, correlationId, expectedCount);\n\t\tawait Promises.writeFile(filePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\t// Change file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.UPDATED, undefined, correlationId, expectedCount);\n\t\tawait Promises.writeFile(filePath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.DELETED, undefined, correlationId, expectedCount);\n\t\tawait promises.unlink(filePath);\n\t\tawait changeFuture;\n\t}\n\n\ttest('multiple events', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\t\tawait promises.mkdir(join(testDir, 'deep-multiple'));\n\n\t\t// multiple add\n\n\t\tconst newFilePath1 = join(testDir, 'newFile-1.txt');\n\t\tconst newFilePath2 = join(testDir, 'newFile-2.txt');\n\t\tconst newFilePath3 = join(testDir, 'newFile-3.txt');\n\t\tconst newFilePath4 = join(testDir, 'deep-multiple', 'newFile-1.txt');\n\t\tconst newFilePath5 = join(testDir, 'deep-multiple', 'newFile-2.txt');\n\t\tconst newFilePath6 = join(testDir, 'deep-multiple', 'newFile-3.txt');\n\n\t\tconst addedFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.ADDED);\n\t\tconst addedFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.ADDED);\n\t\tconst addedFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.ADDED);\n\t\tconst addedFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.ADDED);\n\t\tconst addedFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.ADDED);\n\t\tconst addedFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.ADDED);\n\n\t\tawait Promise.all([\n\t\t\tawait Promises.writeFile(newFilePath1, 'Hello World 1'),\n\t\t\tawait Promises.writeFile(newFilePath2, 'Hello World 2'),\n\t\t\tawait Promises.writeFile(newFilePath3, 'Hello World 3'),\n\t\t\tawait Promises.writeFile(newFilePath4, 'Hello World 4'),\n\t\t\tawait Promises.writeFile(newFilePath5, 'Hello World 5'),\n\t\t\tawait Promises.writeFile(newFilePath6, 'Hello World 6')\n\t\t]);\n\n\t\tawait Promise.all([addedFuture1, addedFuture2, addedFuture3, addedFuture4, addedFuture5, addedFuture6]);\n\n\t\t// multiple change\n\n\t\tconst changeFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.UPDATED);\n\t\tconst changeFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.UPDATED);\n\t\tconst changeFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.UPDATED);\n\t\tconst changeFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.UPDATED);\n\t\tconst changeFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.UPDATED);\n\t\tconst changeFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.UPDATED);\n\n\t\tawait Promise.all([\n\t\t\tawait Promises.writeFile(newFilePath1, 'Hello Update 1'),\n\t\t\tawait Promises.writeFile(newFilePath2, 'Hello Update 2'),\n\t\t\tawait Promises.writeFile(newFilePath3, 'Hello Update 3'),\n\t\t\tawait Promises.writeFile(newFilePath4, 'Hello Update 4'),\n\t\t\tawait Promises.writeFile(newFilePath5, 'Hello Update 5'),\n\t\t\tawait Promises.writeFile(newFilePath6, 'Hello Update 6')\n\t\t]);\n\n\t\tawait Promise.all([changeFuture1, changeFuture2, changeFuture3, changeFuture4, changeFuture5, changeFuture6]);\n\n\t\t// copy with multiple files\n\n\t\tconst copyFuture1 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-1.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture2 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-2.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture3 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy', 'newFile-3.txt'), FileChangeType.ADDED);\n\t\tconst copyFuture4 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy'), FileChangeType.ADDED);\n\n\t\tawait Promises.copy(join(testDir, 'deep-multiple'), join(testDir, 'deep-multiple-copy'), { preserveSymlinks: false });\n\n\t\tawait Promise.all([copyFuture1, copyFuture2, copyFuture3, copyFuture4]);\n\n\t\t// multiple delete (single files)\n\n\t\tconst deleteFuture1 = awaitEvent(watcher, newFilePath1, FileChangeType.DELETED);\n\t\tconst deleteFuture2 = awaitEvent(watcher, newFilePath2, FileChangeType.DELETED);\n\t\tconst deleteFuture3 = awaitEvent(watcher, newFilePath3, FileChangeType.DELETED);\n\t\tconst deleteFuture4 = awaitEvent(watcher, newFilePath4, FileChangeType.DELETED);\n\t\tconst deleteFuture5 = awaitEvent(watcher, newFilePath5, FileChangeType.DELETED);\n\t\tconst deleteFuture6 = awaitEvent(watcher, newFilePath6, FileChangeType.DELETED);\n\n\t\tawait Promise.all([\n\t\t\tawait promises.unlink(newFilePath1),\n\t\t\tawait promises.unlink(newFilePath2),\n\t\t\tawait promises.unlink(newFilePath3),\n\t\t\tawait promises.unlink(newFilePath4),\n\t\t\tawait promises.unlink(newFilePath5),\n\t\t\tawait promises.unlink(newFilePath6)\n\t\t]);\n\n\t\tawait Promise.all([deleteFuture1, deleteFuture2, deleteFuture3, deleteFuture4, deleteFuture5, deleteFuture6]);\n\n\t\t// multiple delete (folder)\n\n\t\tconst deleteFolderFuture1 = awaitEvent(watcher, join(testDir, 'deep-multiple'), FileChangeType.DELETED);\n\t\tconst deleteFolderFuture2 = awaitEvent(watcher, join(testDir, 'deep-multiple-copy'), FileChangeType.DELETED);\n\n\t\tawait Promise.all([Promises.rm(join(testDir, 'deep-multiple'), RimRafMode.UNLINK), Promises.rm(join(testDir, 'deep-multiple-copy'), RimRafMode.UNLINK)]);\n\n\t\tawait Promise.all([deleteFolderFuture1, deleteFolderFuture2]);\n\t});\n\n\ttest('subsequent watch updates watchers (path)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [join(realpathSync(testDir), 'unrelated')], recursive: true }]);\n\n\t\t// New file (*.txt)\n\t\tlet newTextFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tlet changeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [join(realpathSync(testDir), 'unrelated')], recursive: true }]);\n\t\tnewTextFilePath = join(testDir, 'deep', 'newFile2.txt');\n\t\tchangeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [realpathSync(testDir)], recursive: true }]);\n\t\tawait watcher.watch([{ path: join(testDir, 'deep'), excludes: [], recursive: true }]);\n\t\tnewTextFilePath = join(testDir, 'deep', 'newFile3.txt');\n\t\tchangeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t});\n\n\ttest('invalid path does not crash watcher', async function () {\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true },\n\t\t\t{ path: join(testDir, 'invalid-folder'), excludes: [], recursive: true },\n\t\t\t{ path: FileAccess.asFileUri('').fsPath, excludes: [], recursive: true }\n\t\t]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('subsequent watch updates watchers (excludes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [realpathSync(testDir)], recursive: true }]);\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('subsequent watch updates watchers (includes)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['nothing'], recursive: true }]);\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['**/deep/**'], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported (relative pattern explicit)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: [{ base: testDir, pattern: 'deep/newFile.txt' }], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('includes are supported (relative pattern implicit)', async function () {\n\t\tawait watcher.watch([{ path: testDir, excludes: [], includes: ['deep/newFile.txt'], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'deep', 'newFile.txt'));\n\t});\n\n\ttest('excludes are supported (path)', async function () {\n\t\treturn testExcludes([join(realpathSync(testDir), 'deep')]);\n\t});\n\n\ttest('excludes are supported (glob)', function () {\n\t\treturn testExcludes(['deep/**']);\n\t});\n\n\tasync function testExcludes(excludes: string[]) {\n\t\tawait watcher.watch([{ path: testDir, excludes, recursive: true }]);\n\n\t\t// New file (*.txt)\n\t\tconst newTextFilePath = join(testDir, 'deep', 'newFile.txt');\n\t\tconst changeFuture = awaitEvent(watcher, newTextFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newTextFilePath, 'Hello World');\n\n\t\tconst res = await Promise.any([\n\t\t\ttimeout(500).then(() => true),\n\t\t\tchangeFuture.then(() => false)\n\t\t]);\n\n\t\tif (!res) {\n\t\t\tassert.fail('Unexpected change event');\n\t\t}\n\t}\n\n\t(isWindows /* windows: cannot create file symbolic link without elevated context */ ? test.skip : test)('symlink support (root)', async function () {\n\t\tconst link = join(testDir, 'deep-linked');\n\t\tconst linkTarget = join(testDir, 'deep');\n\t\tawait promises.symlink(linkTarget, link);\n\n\t\tawait watcher.watch([{ path: link, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(link, 'newFile.txt'));\n\t});\n\n\t(isWindows /* windows: cannot create file symbolic link without elevated context */ ? test.skip : test)('symlink support (via extra watch)', async function () {\n\t\tconst link = join(testDir, 'deep-linked');\n\t\tconst linkTarget = join(testDir, 'deep');\n\t\tawait promises.symlink(linkTarget, link);\n\n\t\tawait watcher.watch([{ path: testDir, excludes: [], recursive: true }, { path: link, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(link, 'newFile.txt'));\n\t});\n\n\t(!isWindows /* UNC is windows only */ ? test.skip : test)('unc support', async function () {\n\t\taddUNCHostToAllowlist('localhost');\n\n\t\t// Local UNC paths are in the form of: \\\\localhost\\c$\\my_dir\n\t\tconst uncPath = `\\\\\\\\localhost\\\\${getDriveLetter(testDir)?.toLowerCase()}$\\\\${ltrim(testDir.substr(testDir.indexOf(':') + 1), '\\\\')}`;\n\n\t\tawait watcher.watch([{ path: uncPath, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(uncPath, 'deep', 'newFile.txt'));\n\t});\n\n\t(isLinux /* linux: is case sensitive */ ? test.skip : test)('wrong casing', async function () {\n\t\tconst deepWrongCasedPath = join(testDir, 'DEEP');\n\n\t\tawait watcher.watch([{ path: deepWrongCasedPath, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(deepWrongCasedPath, 'newFile.txt'));\n\t});\n\n\ttest('invalid folder does not explode', async function () {\n\t\tconst invalidPath = join(testDir, 'invalid');\n\n\t\tawait watcher.watch([{ path: invalidPath, excludes: [], recursive: true }]);\n\t});\n\n\t(isWindows /* flaky on windows */ ? test.skip : test)('deleting watched path without correlation restarts watching', async function () {\n\t\tconst watchedPath = join(testDir, 'deep');\n\n\t\tawait watcher.watch([{ path: watchedPath, excludes: [], recursive: true }]);\n\n\t\t// Delete watched path and await\n\t\tconst warnFuture = awaitMessage(watcher, 'warn');\n\t\tawait Promises.rm(watchedPath, RimRafMode.UNLINK);\n\t\tawait warnFuture;\n\n\t\t// Restore watched path\n\t\tawait timeout(1500); // node.js watcher used for monitoring folder restore is async\n\t\tawait promises.mkdir(watchedPath);\n\t\tawait timeout(1500); // restart is delayed\n\t\tawait watcher.whenReady();\n\n\t\t// Verify events come in again\n\t\tconst newFilePath = join(watchedPath, 'newFile.txt');\n\t\tconst changeFuture = awaitEvent(watcher, newFilePath, FileChangeType.ADDED);\n\t\tawait Promises.writeFile(newFilePath, 'Hello World');\n\t\tawait changeFuture;\n\t});\n\n\ttest('correlationId is supported', async function () {\n\t\tconst correlationId = Math.random();\n\t\tawait watcher.watch([{ correlationId, path: testDir, excludes: [], recursive: true }]);\n\n\t\treturn basicCrudTest(join(testDir, 'newFile.txt'), correlationId);\n\t});\n\n\ttest('should not exclude roots that do not overlap', async () => {\n\t\tif (isWindows) {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a']), ['C:\\\\a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b', 'C:\\\\c\\\\d\\\\e']), ['C:\\\\a', 'C:\\\\b', 'C:\\\\c\\\\d\\\\e']);\n\t\t} else {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a']), ['/a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b', '/c/d/e']), ['/a', '/b', '/c/d/e']);\n\t\t}\n\t});\n\n\ttest('should remove sub-folders of other paths', async () => {\n\t\tif (isWindows) {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\a\\\\b']), ['C:\\\\a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\b', 'C:\\\\a\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\b\\\\a', 'C:\\\\a', 'C:\\\\b', 'C:\\\\a\\\\b']), ['C:\\\\a', 'C:\\\\b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['C:\\\\a', 'C:\\\\a\\\\b', 'C:\\\\a\\\\c\\\\d']), ['C:\\\\a']);\n\t\t} else {\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/a/b']), ['/a']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/b', '/a/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/b/a', '/a', '/b', '/a/b']), ['/a', '/b']);\n\t\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/a', '/a/b', '/a/c/d']), ['/a']);\n\t\t}\n\t});\n\n\ttest('should ignore when everything excluded', async () => {\n\t\tassert.deepStrictEqual(await watcher.testRemoveDuplicateRequests(['/foo/bar', '/bar'], ['**', 'something']), []);\n\t});\n\n\ttest('watching same or overlapping paths supported when correlation is applied', async () => {\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 }\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 1);\n\n\t\t// same path, same options\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2, },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: undefined }\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'otherNewFile.txt'), null, 3);\n\n\t\t// same path, different options\n\t\tawait watcher.watch([\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: undefined },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'deep')], recursive: true, correlationId: 3 },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'other')], recursive: true, correlationId: 4 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'newFile.txt'), null, 5);\n\t\tawait basicCrudTest(join(testDir, 'otherNewFile.txt'), null, 5);\n\n\t\t// overlapping paths (same options)\n\t\tawait watcher.watch([\n\t\t\t{ path: dirname(testDir), excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [], recursive: true, correlationId: 3 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'deep', 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'deep', 'otherNewFile.txt'), null, 3);\n\n\t\t// overlapping paths (different options)\n\t\tawait watcher.watch([\n\t\t\t{ path: dirname(testDir), excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: testDir, excludes: [join(realpathSync(testDir), 'some')], recursive: true, correlationId: 2 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [join(realpathSync(testDir), 'other')], recursive: true, correlationId: 3 },\n\t\t]);\n\n\t\tawait basicCrudTest(join(testDir, 'deep', 'newFile.txt'), null, 3);\n\t\tawait basicCrudTest(join(testDir, 'deep', 'otherNewFile.txt'), null, 3);\n\t});\n\n\ttest('watching missing path emits watcher fail event', async function () {\n\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\n\t\tconst folderPath = join(testDir, 'missing');\n\t\twatcher.watch([{ path: folderPath, excludes: [], recursive: true }]);\n\n\t\tawait onDidWatchFail;\n\t});\n\n\ttest('deleting watched path emits watcher fail and delete event if correlated', async function () {\n\t\tconst folderPath = join(testDir, 'deep');\n\n\t\tawait watcher.watch([{ path: folderPath, excludes: [], recursive: true, correlationId: 1 }]);\n\n\t\tlet failed = false;\n\t\tconst instance = Array.from(watcher.watchers)[0];\n\t\tassert.strictEqual(instance.include(folderPath), true);\n\t\tinstance.onDidFail(() => failed = true);\n\n\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\tconst changeFuture = awaitEvent(watcher, folderPath, FileChangeType.DELETED, undefined, 1);\n\t\tPromises.rm(folderPath, RimRafMode.UNLINK);\n\t\tawait onDidWatchFail;\n\t\tawait changeFuture;\n\t\tassert.strictEqual(failed, true);\n\t\tassert.strictEqual(instance.failed, true);\n\t});\n\n\t(!isMacintosh /* Linux/Windows: times out for some reason */ ? test.skip : test)('watch requests support suspend/resume (folder, does not exist in beginning, not reusing watcher)', async () => {\n\t\tawait testWatchFolderDoesNotExist(false);\n\t});\n\n\ttest('watch requests support suspend/resume (folder, does not exist in beginning, reusing watcher)', async () => {\n\t\tawait testWatchFolderDoesNotExist(true);\n\t});\n\n\tasync function testWatchFolderDoesNotExist(reuseExistingWatcher: boolean) {\n\t\tlet onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\n\t\tconst folderPath = join(testDir, 'not-found');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [];\n\t\tif (reuseExistingWatcher) {\n\t\t\trequests.push({ path: testDir, excludes: [], recursive: true });\n\t\t\tawait watcher.watch(requests);\n\t\t}\n\n\t\tconst request: IRecursiveWatchRequest = { path: folderPath, excludes: [], recursive: true };\n\t\trequests.push(request);\n\n\t\tawait watcher.watch(requests);\n\t\tawait onDidWatchFail;\n\n\t\tif (reuseExistingWatcher) {\n\t\t\tassert.strictEqual(watcher.isSuspended(request), true);\n\t\t} else {\n\t\t\tassert.strictEqual(watcher.isSuspended(request), 'polling');\n\t\t}\n\n\t\tlet changeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\tlet onDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\tawait promises.mkdir(folderPath);\n\t\tawait changeFuture;\n\t\tawait onDidWatch;\n\n\t\tassert.strictEqual(watcher.isSuspended(request), false);\n\n\t\tconst filePath = join(folderPath, 'newFile.txt');\n\t\tawait basicCrudTest(filePath);\n\n\t\tif (!reuseExistingWatcher) {\n\t\t\tonDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\t\tawait Promises.rm(folderPath);\n\t\t\tawait onDidWatchFail;\n\n\t\t\tchangeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\t\tonDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\t\tawait promises.mkdir(folderPath);\n\t\t\tawait changeFuture;\n\t\t\tawait onDidWatch;\n\n\t\t\tawait basicCrudTest(filePath);\n\t\t}\n\t}\n\n\t(!isMacintosh /* Linux/Windows: times out for some reason */ ? test.skip : test)('watch requests support suspend/resume (folder, exist in beginning, not reusing watcher)', async () => {\n\t\tawait testWatchFolderExists(false);\n\t});\n\n\ttest('watch requests support suspend/resume (folder, exist in beginning, reusing watcher)', async () => {\n\t\tawait testWatchFolderExists(true);\n\t});\n\n\tasync function testWatchFolderExists(reuseExistingWatcher: boolean) {\n\t\tconst folderPath = join(testDir, 'deep');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [{ path: folderPath, excludes: [], recursive: true }];\n\t\tif (reuseExistingWatcher) {\n\t\t\trequests.push({ path: testDir, excludes: [], recursive: true });\n\t\t}\n\n\t\tawait watcher.watch(requests);\n\n\t\tconst filePath = join(folderPath, 'newFile.txt');\n\t\tawait basicCrudTest(filePath);\n\n\t\tif (!reuseExistingWatcher) {\n\t\t\tconst onDidWatchFail = Event.toPromise(watcher.onWatchFail);\n\t\t\tawait Promises.rm(folderPath);\n\t\t\tawait onDidWatchFail;\n\n\t\t\tconst changeFuture = awaitEvent(watcher, folderPath, FileChangeType.ADDED);\n\t\t\tconst onDidWatch = Event.toPromise(watcher.onDidWatch);\n\t\t\tawait promises.mkdir(folderPath);\n\t\t\tawait changeFuture;\n\t\t\tawait onDidWatch;\n\n\t\t\tawait basicCrudTest(filePath);\n\t\t}\n\t}\n\n\ttest('watch request reuses another recursive watcher even when requests are coming in at the same time', async function () {\n\t\tconst folderPath1 = join(testDir, 'deep', 'not-existing1');\n\t\tconst folderPath2 = join(testDir, 'deep', 'not-existing2');\n\t\tconst folderPath3 = join(testDir, 'not-existing3');\n\n\t\tconst requests: IRecursiveWatchRequest[] = [\n\t\t\t{ path: folderPath1, excludes: [], recursive: true, correlationId: 1 },\n\t\t\t{ path: folderPath2, excludes: [], recursive: true, correlationId: 2 },\n\t\t\t{ path: folderPath3, excludes: [], recursive: true, correlationId: 3 },\n\t\t\t{ path: join(testDir, 'deep'), excludes: [], recursive: true }\n\t\t];\n\n\t\tawait watcher.watch(requests);\n\n\t\tassert.strictEqual(watcher.isSuspended(requests[0]), true);\n\t\tassert.strictEqual(watcher.isSuspended(requests[1]), true);\n\t\tassert.strictEqual(watcher.isSuspended(requests[2]), 'polling');\n\t\tassert.strictEqual(watcher.isSuspended(requests[3]), false);\n\t});\n\n\ttest('event type filter', async function () {\n\t\tconst request = { path: testDir, excludes: [], recursive: true, filter: FileChangeFilter.ADDED | FileChangeFilter.DELETED, correlationId: 1 };\n\t\tawait watcher.watch([request]);\n\n\t\t// Change file\n\t\tconst filePath = join(testDir, 'lorem-newfile.txt');\n\t\tlet changeFuture = awaitEvent(watcher, filePath, FileChangeType.ADDED, undefined, 1);\n\t\tawait Promises.writeFile(filePath, 'Hello Change');\n\t\tawait changeFuture;\n\n\t\t// Delete file\n\t\tchangeFuture = awaitEvent(watcher, filePath, FileChangeType.DELETED, undefined, 1);\n\t\tawait promises.unlink(filePath);\n\t\tawait changeFuture;\n\t});\n});\n"]}