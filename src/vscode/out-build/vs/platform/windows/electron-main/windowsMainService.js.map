{"version":3,"sources":["vs/platform/windows/electron-main/windowsMainService.ts"],"names":[],"mappings":"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","file":"windowsMainService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\nimport { app, BrowserWindow, WebContents, shell } from 'electron';\nimport { addUNCHostToAllowlist } from '../../../base/node/unc.js';\nimport { hostname, release, arch } from 'os';\nimport { coalesce, distinct } from '../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { CharCode } from '../../../base/common/charCode.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { isWindowsDriveLetter, parseLineAndColumnAware, sanitizeFilePath, toSlashes } from '../../../base/common/extpath.js';\nimport { getPathLabel } from '../../../base/common/labels.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { basename, join, normalize, posix } from '../../../base/common/path.js';\nimport { getMarks, mark } from '../../../base/common/performance.js';\nimport { IProcessEnvironment, isMacintosh, isWindows, OS } from '../../../base/common/platform.js';\nimport { cwd } from '../../../base/common/process.js';\nimport { extUriBiasedIgnorePathCase, isEqualAuthority, normalizePath, originalFSPath, removeTrailingPathSeparator } from '../../../base/common/resources.js';\nimport { assertReturnsDefined } from '../../../base/common/types.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { getNLSLanguage, getNLSMessages, localize } from '../../../nls.js';\nimport { IBackupMainService } from '../../backup/electron-main/backup.js';\nimport { IEmptyWindowBackupInfo } from '../../backup/node/backup.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IDialogMainService } from '../../dialogs/electron-main/dialogMainService.js';\nimport { NativeParsedArgs } from '../../environment/common/argv.js';\nimport { IEnvironmentMainService } from '../../environment/electron-main/environmentMainService.js';\nimport { FileType, IFileService } from '../../files/common/files.js';\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\nimport { ILifecycleMainService } from '../../lifecycle/electron-main/lifecycleMainService.js';\nimport { ILogService } from '../../log/common/log.js';\nimport product from '../../product/common/product.js';\nimport { IProtocolMainService } from '../../protocol/electron-main/protocol.js';\nimport { getRemoteAuthority } from '../../remote/common/remoteHosts.js';\nimport { IStateService } from '../../state/node/state.js';\nimport { IAddRemoveFoldersRequest, INativeOpenFileRequest, INativeWindowConfiguration, IOpenEmptyWindowOptions, IPath, IPathsToWaitFor, isFileToOpen, isFolderToOpen, isWorkspaceToOpen, IWindowOpenable, IWindowSettings } from '../../window/common/window.js';\nimport { CodeWindow } from './windowImpl.js';\nimport { IOpenConfiguration, IOpenEmptyConfiguration, IWindowsCountChangedEvent, IWindowsMainService, OpenContext, getLastFocused } from './windows.js';\nimport { findWindowOnExtensionDevelopmentPath, findWindowOnFile, findWindowOnWorkspaceOrFolder } from './windowsFinder.js';\nimport { IWindowState, WindowsStateHandler } from './windowsStateHandler.js';\nimport { IRecent } from '../../workspaces/common/workspaces.js';\nimport { hasWorkspaceFileExtension, IAnyWorkspaceIdentifier, ISingleFolderWorkspaceIdentifier, isSingleFolderWorkspaceIdentifier, isWorkspaceIdentifier, IWorkspaceIdentifier, toWorkspaceIdentifier } from '../../workspace/common/workspace.js';\nimport { createEmptyWorkspaceIdentifier, getSingleFolderWorkspaceIdentifier, getWorkspaceIdentifier } from '../../workspaces/node/workspaces.js';\nimport { IWorkspacesHistoryMainService } from '../../workspaces/electron-main/workspacesHistoryMainService.js';\nimport { IWorkspacesManagementMainService } from '../../workspaces/electron-main/workspacesManagementMainService.js';\nimport { ICodeWindow, UnloadReason } from '../../window/electron-main/window.js';\nimport { IThemeMainService } from '../../theme/electron-main/themeMainService.js';\nimport { IEditorOptions, ITextEditorOptions } from '../../editor/common/editor.js';\nimport { IUserDataProfile } from '../../userDataProfile/common/userDataProfile.js';\nimport { IPolicyService } from '../../policy/common/policy.js';\nimport { IUserDataProfilesMainService } from '../../userDataProfile/electron-main/userDataProfile.js';\nimport { ILoggerMainService } from '../../log/electron-main/loggerService.js';\nimport { IAuxiliaryWindowsMainService } from '../../auxiliaryWindow/electron-main/auxiliaryWindows.js';\nimport { IAuxiliaryWindow } from '../../auxiliaryWindow/electron-main/auxiliaryWindow.js';\nimport { ICSSDevelopmentService } from '../../cssDev/node/cssDevService.js';\nimport { ResourceSet } from '../../../base/common/map.js';\n\n//#region Helper Interfaces\n\ntype RestoreWindowsSetting = 'preserve' | 'all' | 'folders' | 'one' | 'none';\n\ninterface IOpenBrowserWindowOptions {\n\treadonly userEnv?: IProcessEnvironment;\n\treadonly cli?: NativeParsedArgs;\n\n\treadonly workspace?: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier;\n\n\treadonly remoteAuthority?: string;\n\n\treadonly initialStartup?: boolean;\n\n\treadonly filesToOpen?: IFilesToOpen;\n\n\treadonly forceNewWindow?: boolean;\n\treadonly forceNewTabbedWindow?: boolean;\n\treadonly windowToUse?: ICodeWindow;\n\n\treadonly emptyWindowBackupInfo?: IEmptyWindowBackupInfo;\n\treadonly forceProfile?: string;\n\treadonly forceTempProfile?: boolean;\n}\n\ninterface IPathResolveOptions {\n\n\t/**\n\t * By default, resolving a path will check\n\t * if the path exists. This can be disabled\n\t * with this flag.\n\t */\n\treadonly ignoreFileNotFound?: boolean;\n\n\t/**\n\t * Will reject a path if it points to a transient\n\t * workspace as indicated by a `transient: true`\n\t * property in the workspace file.\n\t */\n\treadonly rejectTransientWorkspaces?: boolean;\n\n\t/**\n\t * If enabled, will resolve the path line/column\n\t * aware and properly remove this information\n\t * from the resulting file path.\n\t */\n\treadonly gotoLineMode?: boolean;\n\n\t/**\n\t * Forces to resolve the provided path as workspace\n\t * file instead of opening it as a file.\n\t */\n\treadonly forceOpenWorkspaceAsFile?: boolean;\n\n\t/**\n\t * The remoteAuthority to use if the URL to open is\n\t * neither `file` nor `vscode-remote`.\n\t */\n\treadonly remoteAuthority?: string;\n}\n\ninterface IFilesToOpen {\n\treadonly remoteAuthority?: string;\n\n\tfilesToOpenOrCreate: IPath[];\n\tfilesToDiff: IPath[];\n\tfilesToMerge: IPath[];\n\n\tfilesToWait?: IPathsToWaitFor;\n}\n\ninterface IPathToOpen<T = IEditorOptions> extends IPath<T> {\n\n\t/**\n\t * The workspace to open\n\t */\n\treadonly workspace?: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier;\n\n\t/**\n\t * Whether the path is considered to be transient or not\n\t * for example, a transient workspace should not add to\n\t * the workspaces history and should never restore.\n\t */\n\treadonly transient?: boolean;\n\n\t/**\n\t * The backup path to use\n\t */\n\treadonly backupPath?: string;\n\n\t/**\n\t * The remote authority for the Code instance to open. Undefined if not remote.\n\t */\n\treadonly remoteAuthority?: string;\n\n\t/**\n\t * Optional label for the recent history\n\t */\n\tlabel?: string;\n}\n\nconst EMPTY_WINDOW: IPathToOpen = Object.create(null);\n\ninterface IWorkspacePathToOpen extends IPathToOpen {\n\treadonly workspace: IWorkspaceIdentifier;\n}\n\ninterface ISingleFolderWorkspacePathToOpen extends IPathToOpen {\n\treadonly workspace: ISingleFolderWorkspaceIdentifier;\n}\n\nfunction isWorkspacePathToOpen(path: IPathToOpen | undefined): path is IWorkspacePathToOpen {\n\treturn isWorkspaceIdentifier(path?.workspace);\n}\n\nfunction isSingleFolderWorkspacePathToOpen(path: IPathToOpen | undefined): path is ISingleFolderWorkspacePathToOpen {\n\treturn isSingleFolderWorkspaceIdentifier(path?.workspace);\n}\n\n//#endregion\n\nexport class WindowsMainService extends Disposable implements IWindowsMainService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidOpenWindow = this._register(new Emitter<ICodeWindow>());\n\treadonly onDidOpenWindow = this._onDidOpenWindow.event;\n\n\tprivate readonly _onDidSignalReadyWindow = this._register(new Emitter<ICodeWindow>());\n\treadonly onDidSignalReadyWindow = this._onDidSignalReadyWindow.event;\n\n\tprivate readonly _onDidDestroyWindow = this._register(new Emitter<ICodeWindow>());\n\treadonly onDidDestroyWindow = this._onDidDestroyWindow.event;\n\n\tprivate readonly _onDidChangeWindowsCount = this._register(new Emitter<IWindowsCountChangedEvent>());\n\treadonly onDidChangeWindowsCount = this._onDidChangeWindowsCount.event;\n\n\tprivate readonly _onDidMaximizeWindow = this._register(new Emitter<ICodeWindow>());\n\treadonly onDidMaximizeWindow = this._onDidMaximizeWindow.event;\n\n\tprivate readonly _onDidUnmaximizeWindow = this._register(new Emitter<ICodeWindow>());\n\treadonly onDidUnmaximizeWindow = this._onDidUnmaximizeWindow.event;\n\n\tprivate readonly _onDidChangeFullScreen = this._register(new Emitter<{ window: ICodeWindow; fullscreen: boolean }>());\n\treadonly onDidChangeFullScreen = this._onDidChangeFullScreen.event;\n\n\tprivate readonly _onDidTriggerSystemContextMenu = this._register(new Emitter<{ window: ICodeWindow; x: number; y: number }>());\n\treadonly onDidTriggerSystemContextMenu = this._onDidTriggerSystemContextMenu.event;\n\n\tprivate readonly windows = new Map<number, ICodeWindow>();\n\n\tprivate readonly windowsStateHandler: WindowsStateHandler;\n\n\tconstructor(\n\t\tprivate readonly machineId: string,\n\t\tprivate readonly sqmId: string,\n\t\tprivate readonly devDeviceId: string,\n\t\tprivate readonly initialUserEnv: IProcessEnvironment,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@ILoggerMainService private readonly loggerService: ILoggerMainService,\n\t\t@IStateService stateService: IStateService,\n\t\t@IPolicyService private readonly policyService: IPolicyService,\n\t\t@IEnvironmentMainService private readonly environmentMainService: IEnvironmentMainService,\n\t\t@IUserDataProfilesMainService private readonly userDataProfilesMainService: IUserDataProfilesMainService,\n\t\t@ILifecycleMainService private readonly lifecycleMainService: ILifecycleMainService,\n\t\t@IBackupMainService private readonly backupMainService: IBackupMainService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspacesHistoryMainService private readonly workspacesHistoryMainService: IWorkspacesHistoryMainService,\n\t\t@IWorkspacesManagementMainService private readonly workspacesManagementMainService: IWorkspacesManagementMainService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IDialogMainService private readonly dialogMainService: IDialogMainService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IProtocolMainService private readonly protocolMainService: IProtocolMainService,\n\t\t@IThemeMainService private readonly themeMainService: IThemeMainService,\n\t\t@IAuxiliaryWindowsMainService private readonly auxiliaryWindowsMainService: IAuxiliaryWindowsMainService,\n\t\t@ICSSDevelopmentService private readonly cssDevelopmentService: ICSSDevelopmentService\n\t) {\n\t\tsuper();\n\n\t\tthis.windowsStateHandler = this._register(new WindowsStateHandler(this, stateService, this.lifecycleMainService, this.logService, this.configurationService));\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Signal a window is ready after having entered a workspace\n\t\tthis._register(this.workspacesManagementMainService.onDidEnterWorkspace(event => this._onDidSignalReadyWindow.fire(event.window)));\n\n\t\t// Update valid roots in protocol service for extension dev windows\n\t\tthis._register(this.onDidSignalReadyWindow(window => {\n\t\t\tif (window.config?.extensionDevelopmentPath || window.config?.extensionTestsPath) {\n\t\t\t\tconst disposables = new DisposableStore();\n\t\t\t\tdisposables.add(Event.any(window.onDidClose, window.onDidDestroy)(() => disposables.dispose()));\n\n\t\t\t\t// Allow access to extension development path\n\t\t\t\tif (window.config.extensionDevelopmentPath) {\n\t\t\t\t\tfor (const extensionDevelopmentPath of window.config.extensionDevelopmentPath) {\n\t\t\t\t\t\tdisposables.add(this.protocolMainService.addValidFileRoot(extensionDevelopmentPath));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Allow access to extension tests path\n\t\t\t\tif (window.config.extensionTestsPath) {\n\t\t\t\t\tdisposables.add(this.protocolMainService.addValidFileRoot(window.config.extensionTestsPath));\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\topenEmptyWindow(openConfig: IOpenEmptyConfiguration, options?: IOpenEmptyWindowOptions): Promise<ICodeWindow[]> {\n\t\tconst cli = this.environmentMainService.args;\n\t\tconst remoteAuthority = options?.remoteAuthority || undefined;\n\t\tconst forceEmpty = true;\n\t\tconst forceReuseWindow = options?.forceReuseWindow;\n\t\tconst forceNewWindow = !forceReuseWindow;\n\n\t\treturn this.open({ ...openConfig, cli, forceEmpty, forceNewWindow, forceReuseWindow, remoteAuthority, forceTempProfile: options?.forceTempProfile, forceProfile: options?.forceProfile });\n\t}\n\n\topenExistingWindow(window: ICodeWindow, openConfig: IOpenConfiguration): void {\n\n\t\t// Bring window to front\n\t\twindow.focus();\n\n\t\t// Handle `<app> --wait`\n\t\tthis.handleWaitMarkerFile(openConfig, [window]);\n\n\t\t// Handle `<app> chat`\n\t\tthis.handleChatRequest(openConfig, [window]);\n\t}\n\n\tasync open(openConfig: IOpenConfiguration): Promise<ICodeWindow[]> {\n\t\tthis.logService.trace('windowsManager#open');\n\n\t\t// Make sure addMode/removeMode is only enabled if we have an active window\n\t\tif ((openConfig.addMode || openConfig.removeMode) && (openConfig.initialStartup || !this.getLastActiveWindow())) {\n\t\t\topenConfig.addMode = false;\n\t\t\topenConfig.removeMode = false;\n\t\t}\n\n\t\tconst foldersToAdd: ISingleFolderWorkspacePathToOpen[] = [];\n\t\tconst foldersToRemove: ISingleFolderWorkspacePathToOpen[] = [];\n\n\t\tconst foldersToOpen: ISingleFolderWorkspacePathToOpen[] = [];\n\n\t\tconst workspacesToOpen: IWorkspacePathToOpen[] = [];\n\t\tconst untitledWorkspacesToRestore: IWorkspacePathToOpen[] = [];\n\n\t\tconst emptyWindowsWithBackupsToRestore: IEmptyWindowBackupInfo[] = [];\n\n\t\tlet filesToOpen: IFilesToOpen | undefined;\n\t\tlet maybeOpenEmptyWindow = false;\n\n\t\t// Identify things to open from open config\n\t\tconst pathsToOpen = await this.getPathsToOpen(openConfig);\n\t\tthis.logService.trace('windowsManager#open pathsToOpen', pathsToOpen);\n\t\tfor (const path of pathsToOpen) {\n\t\t\tif (isSingleFolderWorkspacePathToOpen(path)) {\n\t\t\t\tif (openConfig.addMode) {\n\t\t\t\t\t// When run with --add, take the folders that are to be opened as\n\t\t\t\t\t// folders that should be added to the currently active window.\n\t\t\t\t\tfoldersToAdd.push(path);\n\t\t\t\t} else if (openConfig.removeMode) {\n\t\t\t\t\t// When run with --remove, take the folders that are to be opened as\n\t\t\t\t\t// folders that should be removed from the currently active window.\n\t\t\t\t\tfoldersToRemove.push(path);\n\t\t\t\t} else {\n\t\t\t\t\tfoldersToOpen.push(path);\n\t\t\t\t}\n\t\t\t} else if (isWorkspacePathToOpen(path)) {\n\t\t\t\tworkspacesToOpen.push(path);\n\t\t\t} else if (path.fileUri) {\n\t\t\t\tif (!filesToOpen) {\n\t\t\t\t\tfilesToOpen = { filesToOpenOrCreate: [], filesToDiff: [], filesToMerge: [], remoteAuthority: path.remoteAuthority };\n\t\t\t\t}\n\t\t\t\tfilesToOpen.filesToOpenOrCreate.push(path);\n\t\t\t} else if (path.backupPath) {\n\t\t\t\temptyWindowsWithBackupsToRestore.push({ backupFolder: basename(path.backupPath), remoteAuthority: path.remoteAuthority });\n\t\t\t} else {\n\t\t\t\tmaybeOpenEmptyWindow = true; // depends on other parameters such as `forceEmpty` and how many windows have opened already\n\t\t\t}\n\t\t}\n\n\t\t// When run with --diff, take the first 2 files to open as files to diff\n\t\tif (openConfig.diffMode && filesToOpen && filesToOpen.filesToOpenOrCreate.length >= 2) {\n\t\t\tfilesToOpen.filesToDiff = filesToOpen.filesToOpenOrCreate.slice(0, 2);\n\t\t\tfilesToOpen.filesToOpenOrCreate = [];\n\t\t}\n\n\t\t// When run with --merge, take the first 4 files to open as files to merge\n\t\tif (openConfig.mergeMode && filesToOpen && filesToOpen.filesToOpenOrCreate.length === 4) {\n\t\t\tfilesToOpen.filesToMerge = filesToOpen.filesToOpenOrCreate.slice(0, 4);\n\t\t\tfilesToOpen.filesToOpenOrCreate = [];\n\t\t\tfilesToOpen.filesToDiff = [];\n\t\t}\n\n\t\t// When run with --wait, make sure we keep the paths to wait for\n\t\tif (filesToOpen && openConfig.waitMarkerFileURI) {\n\t\t\tfilesToOpen.filesToWait = { paths: coalesce([...filesToOpen.filesToDiff, filesToOpen.filesToMerge[3] /* [3] is the resulting merge file */, ...filesToOpen.filesToOpenOrCreate]), waitMarkerFileUri: openConfig.waitMarkerFileURI };\n\t\t}\n\n\t\t// These are windows to restore because of hot-exit or from previous session (only performed once on startup!)\n\t\tif (openConfig.initialStartup) {\n\n\t\t\t// Untitled workspaces are always restored\n\t\t\tuntitledWorkspacesToRestore.push(...this.workspacesManagementMainService.getUntitledWorkspaces());\n\t\t\tworkspacesToOpen.push(...untitledWorkspacesToRestore);\n\n\t\t\t// Empty windows with backups are always restored\n\t\t\temptyWindowsWithBackupsToRestore.push(...this.backupMainService.getEmptyWindowBackups());\n\t\t} else {\n\t\t\temptyWindowsWithBackupsToRestore.length = 0;\n\t\t}\n\n\t\t// Open based on config\n\t\tconst { windows: usedWindows, filesOpenedInWindow } = await this.doOpen(openConfig, workspacesToOpen, foldersToOpen, emptyWindowsWithBackupsToRestore, maybeOpenEmptyWindow, filesToOpen, foldersToAdd, foldersToRemove);\n\n\t\tthis.logService.trace(`windowsManager#open used window count ${usedWindows.length} (workspacesToOpen: ${workspacesToOpen.length}, foldersToOpen: ${foldersToOpen.length}, emptyToRestore: ${emptyWindowsWithBackupsToRestore.length}, maybeOpenEmptyWindow: ${maybeOpenEmptyWindow})`);\n\n\t\t// Make sure to pass focus to the most relevant of the windows if we open multiple\n\t\tif (usedWindows.length > 1) {\n\n\t\t\t// 1.) focus window we opened files in always with highest priority\n\t\t\tif (filesOpenedInWindow) {\n\t\t\t\tfilesOpenedInWindow.focus();\n\t\t\t}\n\n\t\t\t// Otherwise, find a good window based on open params\n\t\t\telse {\n\t\t\t\tconst focusLastActive = this.windowsStateHandler.state.lastActiveWindow && !openConfig.forceEmpty && !openConfig.cli._.length && !openConfig.cli['file-uri'] && !openConfig.cli['folder-uri'] && !openConfig.urisToOpen?.length;\n\t\t\t\tlet focusLastOpened = true;\n\t\t\t\tlet focusLastWindow = true;\n\n\t\t\t\t// 2.) focus last active window if we are not instructed to open any paths\n\t\t\t\tif (focusLastActive) {\n\t\t\t\t\tconst lastActiveWindow = usedWindows.filter(window => this.windowsStateHandler.state.lastActiveWindow && window.backupPath === this.windowsStateHandler.state.lastActiveWindow.backupPath);\n\t\t\t\t\tif (lastActiveWindow.length) {\n\t\t\t\t\t\tlastActiveWindow[0].focus();\n\t\t\t\t\t\tfocusLastOpened = false;\n\t\t\t\t\t\tfocusLastWindow = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// 3.) if instructed to open paths, focus last window which is not restored\n\t\t\t\tif (focusLastOpened) {\n\t\t\t\t\tfor (let i = usedWindows.length - 1; i >= 0; i--) {\n\t\t\t\t\t\tconst usedWindow = usedWindows[i];\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(usedWindow.openedWorkspace && untitledWorkspacesToRestore.some(workspace => usedWindow.openedWorkspace && workspace.workspace.id === usedWindow.openedWorkspace.id)) ||\t// skip over restored workspace\n\t\t\t\t\t\t\t(usedWindow.backupPath && emptyWindowsWithBackupsToRestore.some(empty => usedWindow.backupPath && empty.backupFolder === basename(usedWindow.backupPath)))\t\t\t\t\t\t\t// skip over restored empty window\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tusedWindow.focus();\n\t\t\t\t\t\tfocusLastWindow = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// 4.) finally, always ensure to have at least last used window focused\n\t\t\t\tif (focusLastWindow) {\n\t\t\t\t\tusedWindows[usedWindows.length - 1].focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Remember in recent document list (unless this opens for extension development)\n\t\t// Also do not add paths when files are opened for diffing or merging, only if opened individually\n\t\tconst isDiff = filesToOpen && filesToOpen.filesToDiff.length > 0;\n\t\tconst isMerge = filesToOpen && filesToOpen.filesToMerge.length > 0;\n\t\tif (!usedWindows.some(window => window.isExtensionDevelopmentHost) && !isDiff && !isMerge && !openConfig.noRecentEntry) {\n\t\t\tconst recents: IRecent[] = [];\n\t\t\tfor (const pathToOpen of pathsToOpen) {\n\t\t\t\tif (isWorkspacePathToOpen(pathToOpen) && !pathToOpen.transient /* never add transient workspaces to history */) {\n\t\t\t\t\trecents.push({ label: pathToOpen.label, workspace: pathToOpen.workspace, remoteAuthority: pathToOpen.remoteAuthority });\n\t\t\t\t} else if (isSingleFolderWorkspacePathToOpen(pathToOpen)) {\n\t\t\t\t\trecents.push({ label: pathToOpen.label, folderUri: pathToOpen.workspace.uri, remoteAuthority: pathToOpen.remoteAuthority });\n\t\t\t\t} else if (pathToOpen.fileUri) {\n\t\t\t\t\trecents.push({ label: pathToOpen.label, fileUri: pathToOpen.fileUri, remoteAuthority: pathToOpen.remoteAuthority });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.workspacesHistoryMainService.addRecentlyOpened(recents);\n\t\t}\n\n\t\t// Handle `<app> --wait`\n\t\tthis.handleWaitMarkerFile(openConfig, usedWindows);\n\n\t\t// Handle `<app> chat`\n\t\tthis.handleChatRequest(openConfig, usedWindows);\n\n\t\treturn usedWindows;\n\t}\n\n\tprivate handleWaitMarkerFile(openConfig: IOpenConfiguration, usedWindows: ICodeWindow[]): void {\n\n\t\t// If we got started with --wait from the CLI, we need to signal to the outside when the window\n\t\t// used for the edit operation is closed or loaded to a different folder so that the waiting\n\t\t// process can continue. We do this by deleting the waitMarkerFilePath.\n\t\tconst waitMarkerFileURI = openConfig.waitMarkerFileURI;\n\t\tif (openConfig.context === OpenContext.CLI && waitMarkerFileURI && usedWindows.length === 1 && usedWindows[0]) {\n\t\t\t(async () => {\n\t\t\t\tawait usedWindows[0].whenClosedOrLoaded;\n\n\t\t\t\ttry {\n\t\t\t\t\tawait this.fileService.del(waitMarkerFileURI);\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// ignore - could have been deleted from the window already\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\t}\n\n\tprivate handleChatRequest(openConfig: IOpenConfiguration, usedWindows: ICodeWindow[]): void {\n\t\tif (openConfig.context !== OpenContext.CLI || !openConfig.cli.chat || usedWindows.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet windowHandlingChatRequest: ICodeWindow | undefined;\n\t\tif (usedWindows.length === 1) {\n\t\t\twindowHandlingChatRequest = usedWindows[0];\n\t\t} else {\n\t\t\tconst chatRequestFolder = openConfig.cli._[0]; // chat request gets cwd() as folder to open\n\t\t\tif (chatRequestFolder) {\n\t\t\t\twindowHandlingChatRequest = findWindowOnWorkspaceOrFolder(usedWindows, URI.file(chatRequestFolder));\n\t\t\t}\n\t\t}\n\n\t\tif (windowHandlingChatRequest) {\n\t\t\twindowHandlingChatRequest.sendWhenReady('vscode:handleChatRequest', CancellationToken.None, openConfig.cli.chat);\n\t\t\twindowHandlingChatRequest.focus();\n\t\t}\n\t}\n\n\tprivate async doOpen(\n\t\topenConfig: IOpenConfiguration,\n\t\tworkspacesToOpen: IWorkspacePathToOpen[],\n\t\tfoldersToOpen: ISingleFolderWorkspacePathToOpen[],\n\t\temptyToRestore: IEmptyWindowBackupInfo[],\n\t\tmaybeOpenEmptyWindow: boolean,\n\t\tfilesToOpen: IFilesToOpen | undefined,\n\t\tfoldersToAdd: ISingleFolderWorkspacePathToOpen[],\n\t\tfoldersToRemove: ISingleFolderWorkspacePathToOpen[]\n\t): Promise<{ windows: ICodeWindow[]; filesOpenedInWindow: ICodeWindow | undefined }> {\n\n\t\t// Keep track of used windows and remember\n\t\t// if files have been opened in one of them\n\t\tconst usedWindows: ICodeWindow[] = [];\n\t\tlet filesOpenedInWindow: ICodeWindow | undefined = undefined;\n\t\tfunction addUsedWindow(window: ICodeWindow, openedFiles?: boolean): void {\n\t\t\tusedWindows.push(window);\n\n\t\t\tif (openedFiles) {\n\t\t\t\tfilesOpenedInWindow = window;\n\t\t\t\tfilesToOpen = undefined; // reset `filesToOpen` since files have been opened\n\t\t\t}\n\t\t}\n\n\t\t// Settings can decide if files/folders open in new window or not\n\t\tlet { openFolderInNewWindow, openFilesInNewWindow } = this.shouldOpenNewWindow(openConfig);\n\n\t\t// Handle folders to add/remove by looking for the last active workspace (not on initial startup)\n\t\tif (!openConfig.initialStartup && (foldersToAdd.length > 0 || foldersToRemove.length > 0)) {\n\t\t\tconst authority = foldersToAdd.at(0)?.remoteAuthority ?? foldersToRemove.at(0)?.remoteAuthority;\n\t\t\tconst lastActiveWindow = this.getLastActiveWindowForAuthority(authority);\n\t\t\tif (lastActiveWindow) {\n\t\t\t\taddUsedWindow(this.doAddRemoveFoldersInExistingWindow(lastActiveWindow, foldersToAdd.map(folderToAdd => folderToAdd.workspace.uri), foldersToRemove.map(folderToRemove => folderToRemove.workspace.uri)));\n\t\t\t}\n\t\t}\n\n\t\t// Handle files to open/diff/merge or to create when we dont open a folder and we do not restore any\n\t\t// folder/untitled from hot-exit by trying to open them in the window that fits best\n\t\tconst potentialNewWindowsCount = foldersToOpen.length + workspacesToOpen.length + emptyToRestore.length;\n\t\tif (filesToOpen && potentialNewWindowsCount === 0) {\n\n\t\t\t// Find suitable window or folder path to open files in\n\t\t\tconst fileToCheck: IPath<IEditorOptions> | undefined = filesToOpen.filesToOpenOrCreate[0] || filesToOpen.filesToDiff[0] || filesToOpen.filesToMerge[3] /* [3] is the resulting merge file */;\n\n\t\t\t// only look at the windows with correct authority\n\t\t\tconst windows = this.getWindows().filter(window => filesToOpen && isEqualAuthority(window.remoteAuthority, filesToOpen.remoteAuthority));\n\n\t\t\t// figure out a good window to open the files in if any\n\t\t\t// with a fallback to the last active window.\n\t\t\t//\n\t\t\t// in case `openFilesInNewWindow` is enforced, we skip\n\t\t\t// this step.\n\t\t\tlet windowToUseForFiles: ICodeWindow | undefined = undefined;\n\t\t\tif (fileToCheck?.fileUri && !openFilesInNewWindow) {\n\t\t\t\tif (openConfig.context === OpenContext.DESKTOP || openConfig.context === OpenContext.CLI || openConfig.context === OpenContext.DOCK || openConfig.context === OpenContext.LINK) {\n\t\t\t\t\twindowToUseForFiles = await findWindowOnFile(windows, fileToCheck.fileUri, async workspace => workspace.configPath.scheme === Schemas.file ? this.workspacesManagementMainService.resolveLocalWorkspace(workspace.configPath) : undefined);\n\t\t\t\t}\n\n\t\t\t\tif (!windowToUseForFiles) {\n\t\t\t\t\twindowToUseForFiles = this.doGetLastActiveWindow(windows);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We found a window to open the files in\n\t\t\tif (windowToUseForFiles) {\n\n\t\t\t\t// Window is workspace\n\t\t\t\tif (isWorkspaceIdentifier(windowToUseForFiles.openedWorkspace)) {\n\t\t\t\t\tworkspacesToOpen.push({ workspace: windowToUseForFiles.openedWorkspace, remoteAuthority: windowToUseForFiles.remoteAuthority });\n\t\t\t\t}\n\n\t\t\t\t// Window is single folder\n\t\t\t\telse if (isSingleFolderWorkspaceIdentifier(windowToUseForFiles.openedWorkspace)) {\n\t\t\t\t\tfoldersToOpen.push({ workspace: windowToUseForFiles.openedWorkspace, remoteAuthority: windowToUseForFiles.remoteAuthority });\n\t\t\t\t}\n\n\t\t\t\t// Window is empty\n\t\t\t\telse {\n\t\t\t\t\taddUsedWindow(this.doOpenFilesInExistingWindow(openConfig, windowToUseForFiles, filesToOpen), true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Finally, if no window or folder is found, just open the files in an empty window\n\t\t\telse {\n\t\t\t\taddUsedWindow(await this.openInBrowserWindow({\n\t\t\t\t\tuserEnv: openConfig.userEnv,\n\t\t\t\t\tcli: openConfig.cli,\n\t\t\t\t\tinitialStartup: openConfig.initialStartup,\n\t\t\t\t\tfilesToOpen,\n\t\t\t\t\tforceNewWindow: true,\n\t\t\t\t\tremoteAuthority: filesToOpen.remoteAuthority,\n\t\t\t\t\tforceNewTabbedWindow: openConfig.forceNewTabbedWindow,\n\t\t\t\t\tforceProfile: openConfig.forceProfile,\n\t\t\t\t\tforceTempProfile: openConfig.forceTempProfile\n\t\t\t\t}), true);\n\t\t\t}\n\t\t}\n\n\t\t// Handle workspaces to open (instructed and to restore)\n\t\tconst allWorkspacesToOpen = distinct(workspacesToOpen, workspace => workspace.workspace.id); // prevent duplicates\n\t\tif (allWorkspacesToOpen.length > 0) {\n\n\t\t\t// Check for existing instances\n\t\t\tconst windowsOnWorkspace = coalesce(allWorkspacesToOpen.map(workspaceToOpen => findWindowOnWorkspaceOrFolder(this.getWindows(), workspaceToOpen.workspace.configPath)));\n\t\t\tif (windowsOnWorkspace.length > 0) {\n\t\t\t\tconst windowOnWorkspace = windowsOnWorkspace[0];\n\t\t\t\tconst filesToOpenInWindow = isEqualAuthority(filesToOpen?.remoteAuthority, windowOnWorkspace.remoteAuthority) ? filesToOpen : undefined;\n\n\t\t\t\t// Do open files\n\t\t\t\taddUsedWindow(this.doOpenFilesInExistingWindow(openConfig, windowOnWorkspace, filesToOpenInWindow), !!filesToOpenInWindow);\n\n\t\t\t\topenFolderInNewWindow = true; // any other folders to open must open in new window then\n\t\t\t}\n\n\t\t\t// Open remaining ones\n\t\t\tfor (const workspaceToOpen of allWorkspacesToOpen) {\n\t\t\t\tif (windowsOnWorkspace.some(window => window.openedWorkspace && window.openedWorkspace.id === workspaceToOpen.workspace.id)) {\n\t\t\t\t\tcontinue; // ignore folders that are already open\n\t\t\t\t}\n\n\t\t\t\tconst remoteAuthority = workspaceToOpen.remoteAuthority;\n\t\t\t\tconst filesToOpenInWindow = isEqualAuthority(filesToOpen?.remoteAuthority, remoteAuthority) ? filesToOpen : undefined;\n\n\t\t\t\t// Do open folder\n\t\t\t\taddUsedWindow(await this.doOpenFolderOrWorkspace(openConfig, workspaceToOpen, openFolderInNewWindow, filesToOpenInWindow), !!filesToOpenInWindow);\n\n\t\t\t\topenFolderInNewWindow = true; // any other folders to open must open in new window then\n\t\t\t}\n\t\t}\n\n\t\t// Handle folders to open (instructed and to restore)\n\t\tconst allFoldersToOpen = distinct(foldersToOpen, folder => extUriBiasedIgnorePathCase.getComparisonKey(folder.workspace.uri)); // prevent duplicates\n\t\tif (allFoldersToOpen.length > 0) {\n\n\t\t\t// Check for existing instances\n\t\t\tconst windowsOnFolderPath = coalesce(allFoldersToOpen.map(folderToOpen => findWindowOnWorkspaceOrFolder(this.getWindows(), folderToOpen.workspace.uri)));\n\t\t\tif (windowsOnFolderPath.length > 0) {\n\t\t\t\tconst windowOnFolderPath = windowsOnFolderPath[0];\n\t\t\t\tconst filesToOpenInWindow = isEqualAuthority(filesToOpen?.remoteAuthority, windowOnFolderPath.remoteAuthority) ? filesToOpen : undefined;\n\n\t\t\t\t// Do open files\n\t\t\t\taddUsedWindow(this.doOpenFilesInExistingWindow(openConfig, windowOnFolderPath, filesToOpenInWindow), !!filesToOpenInWindow);\n\n\t\t\t\topenFolderInNewWindow = true; // any other folders to open must open in new window then\n\t\t\t}\n\n\t\t\t// Open remaining ones\n\t\t\tfor (const folderToOpen of allFoldersToOpen) {\n\t\t\t\tif (windowsOnFolderPath.some(window => isSingleFolderWorkspaceIdentifier(window.openedWorkspace) && extUriBiasedIgnorePathCase.isEqual(window.openedWorkspace.uri, folderToOpen.workspace.uri))) {\n\t\t\t\t\tcontinue; // ignore folders that are already open\n\t\t\t\t}\n\n\t\t\t\tconst remoteAuthority = folderToOpen.remoteAuthority;\n\t\t\t\tconst filesToOpenInWindow = isEqualAuthority(filesToOpen?.remoteAuthority, remoteAuthority) ? filesToOpen : undefined;\n\n\t\t\t\t// Do open folder\n\t\t\t\taddUsedWindow(await this.doOpenFolderOrWorkspace(openConfig, folderToOpen, openFolderInNewWindow, filesToOpenInWindow), !!filesToOpenInWindow);\n\n\t\t\t\topenFolderInNewWindow = true; // any other folders to open must open in new window then\n\t\t\t}\n\t\t}\n\n\t\t// Handle empty to restore\n\t\tconst allEmptyToRestore = distinct(emptyToRestore, info => info.backupFolder); // prevent duplicates\n\t\tif (allEmptyToRestore.length > 0) {\n\t\t\tfor (const emptyWindowBackupInfo of allEmptyToRestore) {\n\t\t\t\tconst remoteAuthority = emptyWindowBackupInfo.remoteAuthority;\n\t\t\t\tconst filesToOpenInWindow = isEqualAuthority(filesToOpen?.remoteAuthority, remoteAuthority) ? filesToOpen : undefined;\n\n\t\t\t\taddUsedWindow(await this.doOpenEmpty(openConfig, true, remoteAuthority, filesToOpenInWindow, emptyWindowBackupInfo), !!filesToOpenInWindow);\n\n\t\t\t\topenFolderInNewWindow = true; // any other folders to open must open in new window then\n\t\t\t}\n\t\t}\n\n\t\t// Finally, open an empty window if\n\t\t// - we still have files to open\n\t\t// - user forces an empty window (e.g. via command line)\n\t\t// - no window has opened yet\n\t\tif (filesToOpen || (maybeOpenEmptyWindow && (openConfig.forceEmpty || usedWindows.length === 0))) {\n\t\t\tconst remoteAuthority = filesToOpen ? filesToOpen.remoteAuthority : openConfig.remoteAuthority;\n\n\t\t\taddUsedWindow(await this.doOpenEmpty(openConfig, openFolderInNewWindow, remoteAuthority, filesToOpen), !!filesToOpen);\n\t\t}\n\n\t\treturn { windows: distinct(usedWindows), filesOpenedInWindow };\n\t}\n\n\tprivate doOpenFilesInExistingWindow(configuration: IOpenConfiguration, window: ICodeWindow, filesToOpen?: IFilesToOpen): ICodeWindow {\n\t\tthis.logService.trace('windowsManager#doOpenFilesInExistingWindow', { filesToOpen });\n\n\t\tthis.focusMainOrChildWindow(window); // make sure window or any of the children has focus\n\n\t\tconst params: INativeOpenFileRequest = {\n\t\t\tfilesToOpenOrCreate: filesToOpen?.filesToOpenOrCreate,\n\t\t\tfilesToDiff: filesToOpen?.filesToDiff,\n\t\t\tfilesToMerge: filesToOpen?.filesToMerge,\n\t\t\tfilesToWait: filesToOpen?.filesToWait,\n\t\t\ttermProgram: configuration?.userEnv?.['TERM_PROGRAM']\n\t\t};\n\t\twindow.sendWhenReady('vscode:openFiles', CancellationToken.None, params);\n\n\t\treturn window;\n\t}\n\n\tprivate focusMainOrChildWindow(mainWindow: ICodeWindow): void {\n\t\tlet windowToFocus: ICodeWindow | IAuxiliaryWindow = mainWindow;\n\n\t\tconst focusedWindow = BrowserWindow.getFocusedWindow();\n\t\tif (focusedWindow && focusedWindow.id !== mainWindow.id) {\n\t\t\tconst auxiliaryWindowCandidate = this.auxiliaryWindowsMainService.getWindowByWebContents(focusedWindow.webContents);\n\t\t\tif (auxiliaryWindowCandidate && auxiliaryWindowCandidate.parentId === mainWindow.id) {\n\t\t\t\twindowToFocus = auxiliaryWindowCandidate;\n\t\t\t}\n\t\t}\n\n\t\twindowToFocus.focus();\n\t}\n\n\tprivate doAddRemoveFoldersInExistingWindow(window: ICodeWindow, foldersToAdd: URI[], foldersToRemove: URI[]): ICodeWindow {\n\t\tthis.logService.trace('windowsManager#doAddRemoveFoldersToExistingWindow', { foldersToAdd, foldersToRemove });\n\n\t\twindow.focus(); // make sure window has focus\n\n\t\tconst request: IAddRemoveFoldersRequest = { foldersToAdd, foldersToRemove };\n\t\twindow.sendWhenReady('vscode:addRemoveFolders', CancellationToken.None, request);\n\n\t\treturn window;\n\t}\n\n\tprivate doOpenEmpty(openConfig: IOpenConfiguration, forceNewWindow: boolean, remoteAuthority: string | undefined, filesToOpen: IFilesToOpen | undefined, emptyWindowBackupInfo?: IEmptyWindowBackupInfo): Promise<ICodeWindow> {\n\t\tthis.logService.trace('windowsManager#doOpenEmpty', { restore: !!emptyWindowBackupInfo, remoteAuthority, filesToOpen, forceNewWindow });\n\n\t\tlet windowToUse: ICodeWindow | undefined;\n\t\tif (!forceNewWindow && typeof openConfig.contextWindowId === 'number') {\n\t\t\twindowToUse = this.getWindowById(openConfig.contextWindowId); // fix for https://github.com/microsoft/vscode/issues/97172\n\t\t}\n\n\t\treturn this.openInBrowserWindow({\n\t\t\tuserEnv: openConfig.userEnv,\n\t\t\tcli: openConfig.cli,\n\t\t\tinitialStartup: openConfig.initialStartup,\n\t\t\tremoteAuthority,\n\t\t\tforceNewWindow,\n\t\t\tforceNewTabbedWindow: openConfig.forceNewTabbedWindow,\n\t\t\tfilesToOpen,\n\t\t\twindowToUse,\n\t\t\temptyWindowBackupInfo,\n\t\t\tforceProfile: openConfig.forceProfile,\n\t\t\tforceTempProfile: openConfig.forceTempProfile\n\t\t});\n\t}\n\n\tprivate doOpenFolderOrWorkspace(openConfig: IOpenConfiguration, folderOrWorkspace: IWorkspacePathToOpen | ISingleFolderWorkspacePathToOpen, forceNewWindow: boolean, filesToOpen: IFilesToOpen | undefined, windowToUse?: ICodeWindow): Promise<ICodeWindow> {\n\t\tthis.logService.trace('windowsManager#doOpenFolderOrWorkspace', { folderOrWorkspace, filesToOpen });\n\n\t\tif (!forceNewWindow && !windowToUse && typeof openConfig.contextWindowId === 'number') {\n\t\t\twindowToUse = this.getWindowById(openConfig.contextWindowId); // fix for https://github.com/microsoft/vscode/issues/49587\n\t\t}\n\n\t\treturn this.openInBrowserWindow({\n\t\t\tworkspace: folderOrWorkspace.workspace,\n\t\t\tuserEnv: openConfig.userEnv,\n\t\t\tcli: openConfig.cli,\n\t\t\tinitialStartup: openConfig.initialStartup,\n\t\t\tremoteAuthority: folderOrWorkspace.remoteAuthority,\n\t\t\tforceNewWindow,\n\t\t\tforceNewTabbedWindow: openConfig.forceNewTabbedWindow,\n\t\t\tfilesToOpen,\n\t\t\twindowToUse,\n\t\t\tforceProfile: openConfig.forceProfile,\n\t\t\tforceTempProfile: openConfig.forceTempProfile\n\t\t});\n\t}\n\n\tprivate async getPathsToOpen(openConfig: IOpenConfiguration): Promise<IPathToOpen[]> {\n\t\tlet pathsToOpen: IPathToOpen[];\n\t\tlet isCommandLineOrAPICall = false;\n\t\tlet isRestoringPaths = false;\n\n\t\t// Extract paths: from API\n\t\tif (openConfig.urisToOpen && openConfig.urisToOpen.length > 0) {\n\t\t\tpathsToOpen = await this.doExtractPathsFromAPI(openConfig);\n\t\t\tisCommandLineOrAPICall = true;\n\t\t}\n\n\t\t// Check for force empty\n\t\telse if (openConfig.forceEmpty) {\n\t\t\tpathsToOpen = [EMPTY_WINDOW];\n\t\t}\n\n\t\t// Extract paths: from CLI\n\t\telse if (openConfig.cli._.length || openConfig.cli['folder-uri'] || openConfig.cli['file-uri']) {\n\t\t\tpathsToOpen = await this.doExtractPathsFromCLI(openConfig.cli);\n\t\t\tif (pathsToOpen.length === 0) {\n\t\t\t\tpathsToOpen.push(EMPTY_WINDOW); // add an empty window if we did not have windows to open from command line\n\t\t\t}\n\n\t\t\tisCommandLineOrAPICall = true;\n\t\t}\n\n\t\t// Extract paths: from previous session\n\t\telse {\n\t\t\tpathsToOpen = await this.doGetPathsFromLastSession();\n\t\t\tif (pathsToOpen.length === 0) {\n\t\t\t\tpathsToOpen.push(EMPTY_WINDOW); // add an empty window if we did not have windows to restore\n\t\t\t}\n\n\t\t\tisRestoringPaths = true;\n\t\t}\n\n\t\t// Handle the case of multiple folders being opened from CLI while we are\n\t\t// not in `--add` or `--remove` mode by creating an untitled workspace, only if:\n\t\t// - they all share the same remote authority\n\t\t// - there is no existing workspace to open that matches these folders\n\t\tif (!openConfig.addMode && !openConfig.removeMode && isCommandLineOrAPICall) {\n\t\t\tconst foldersToOpen = pathsToOpen.filter(path => isSingleFolderWorkspacePathToOpen(path));\n\t\t\tif (foldersToOpen.length > 1) {\n\t\t\t\tconst remoteAuthority = foldersToOpen[0].remoteAuthority;\n\t\t\t\tif (foldersToOpen.every(folderToOpen => isEqualAuthority(folderToOpen.remoteAuthority, remoteAuthority))) {\n\t\t\t\t\tlet workspace: IWorkspaceIdentifier | undefined;\n\n\t\t\t\t\tconst lastSessionWorkspaceMatchingFolders = await this.doGetWorkspaceMatchingFoldersFromLastSession(remoteAuthority, foldersToOpen);\n\t\t\t\t\tif (lastSessionWorkspaceMatchingFolders) {\n\t\t\t\t\t\tworkspace = lastSessionWorkspaceMatchingFolders;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tworkspace = await this.workspacesManagementMainService.createUntitledWorkspace(foldersToOpen.map(folder => ({ uri: folder.workspace.uri })));\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add workspace and remove folders thereby\n\t\t\t\t\tpathsToOpen.push({ workspace, remoteAuthority });\n\t\t\t\t\tpathsToOpen = pathsToOpen.filter(path => !isSingleFolderWorkspacePathToOpen(path));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check for `window.restoreWindows` setting to include all windows\n\t\t// from the previous session if this is the initial startup and we have\n\t\t// not restored windows already otherwise.\n\t\t// Use `unshift` to ensure any new window to open comes last for proper\n\t\t// focus treatment.\n\t\tif (openConfig.initialStartup && !isRestoringPaths && this.configurationService.getValue<IWindowSettings | undefined>('window')?.restoreWindows === 'preserve') {\n\t\t\tconst lastSessionPaths = await this.doGetPathsFromLastSession();\n\t\t\tpathsToOpen.unshift(...lastSessionPaths.filter(path => isWorkspacePathToOpen(path) || isSingleFolderWorkspacePathToOpen(path) || path.backupPath));\n\t\t}\n\n\t\treturn pathsToOpen;\n\t}\n\n\tprivate async doExtractPathsFromAPI(openConfig: IOpenConfiguration): Promise<IPathToOpen[]> {\n\t\tconst pathResolveOptions: IPathResolveOptions = {\n\t\t\tgotoLineMode: openConfig.gotoLineMode,\n\t\t\tremoteAuthority: openConfig.remoteAuthority\n\t\t};\n\n\t\tconst pathsToOpen = await Promise.all(coalesce(openConfig.urisToOpen || []).map(async pathToOpen => {\n\t\t\tconst path = await this.resolveOpenable(pathToOpen, pathResolveOptions);\n\n\t\t\t// Path exists\n\t\t\tif (path) {\n\t\t\t\tpath.label = pathToOpen.label;\n\n\t\t\t\treturn path;\n\t\t\t}\n\n\t\t\t// Path does not exist: show a warning box\n\t\t\tconst uri = this.resourceFromOpenable(pathToOpen);\n\n\t\t\tthis.dialogMainService.showMessageBox({\n\t\t\t\ttype: 'info',\n\t\t\t\tbuttons: [localize({ key: 'ok', comment: ['&& denotes a mnemonic'] }, \"&&OK\")],\n\t\t\t\tmessage: uri.scheme === Schemas.file ? localize('pathNotExistTitle', \"Path does not exist\") : localize('uriInvalidTitle', \"URI can not be opened\"),\n\t\t\t\tdetail: uri.scheme === Schemas.file ?\n\t\t\t\t\tlocalize('pathNotExistDetail', \"The path '{0}' does not exist on this computer.\", getPathLabel(uri, { os: OS, tildify: this.environmentMainService })) :\n\t\t\t\t\tlocalize('uriInvalidDetail', \"The URI '{0}' is not valid and can not be opened.\", uri.toString(true))\n\t\t\t}, BrowserWindow.getFocusedWindow() ?? undefined);\n\n\t\t\treturn undefined;\n\t\t}));\n\n\t\treturn coalesce(pathsToOpen);\n\t}\n\n\tprivate async doExtractPathsFromCLI(cli: NativeParsedArgs): Promise<IPath[]> {\n\t\tconst pathsToOpen: IPathToOpen[] = [];\n\t\tconst pathResolveOptions: IPathResolveOptions = {\n\t\t\tignoreFileNotFound: true,\n\t\t\tgotoLineMode: cli.goto,\n\t\t\tremoteAuthority: cli.remote || undefined,\n\t\t\tforceOpenWorkspaceAsFile:\n\t\t\t\t// special case diff / merge mode to force open\n\t\t\t\t// workspace as file\n\t\t\t\t// https://github.com/microsoft/vscode/issues/149731\n\t\t\t\tcli.diff && cli._.length === 2 ||\n\t\t\t\tcli.merge && cli._.length === 4\n\t\t};\n\n\t\t// folder uris\n\t\tconst folderUris = cli['folder-uri'];\n\t\tif (folderUris) {\n\t\t\tconst resolvedFolderUris = await Promise.all(folderUris.map(rawFolderUri => {\n\t\t\t\tconst folderUri = this.cliArgToUri(rawFolderUri);\n\t\t\t\tif (!folderUri) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn this.resolveOpenable({ folderUri }, pathResolveOptions);\n\t\t\t}));\n\n\t\t\tpathsToOpen.push(...coalesce(resolvedFolderUris));\n\t\t}\n\n\t\t// file uris\n\t\tconst fileUris = cli['file-uri'];\n\t\tif (fileUris) {\n\t\t\tconst resolvedFileUris = await Promise.all(fileUris.map(rawFileUri => {\n\t\t\t\tconst fileUri = this.cliArgToUri(rawFileUri);\n\t\t\t\tif (!fileUri) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn this.resolveOpenable(hasWorkspaceFileExtension(rawFileUri) ? { workspaceUri: fileUri } : { fileUri }, pathResolveOptions);\n\t\t\t}));\n\n\t\t\tpathsToOpen.push(...coalesce(resolvedFileUris));\n\t\t}\n\n\t\t// folder or file paths\n\t\tconst resolvedCliPaths = await Promise.all(cli._.map(cliPath => {\n\t\t\treturn pathResolveOptions.remoteAuthority ? this.doResolveRemotePath(cliPath, pathResolveOptions) : this.doResolveFilePath(cliPath, pathResolveOptions);\n\t\t}));\n\n\t\tpathsToOpen.push(...coalesce(resolvedCliPaths));\n\n\t\treturn pathsToOpen;\n\t}\n\n\tprivate cliArgToUri(arg: string): URI | undefined {\n\t\ttry {\n\t\t\tconst uri = URI.parse(arg);\n\t\t\tif (!uri.scheme) {\n\t\t\t\tthis.logService.error(`Invalid URI input string, scheme missing: ${arg}`);\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (!uri.path) {\n\t\t\t\treturn uri.with({ path: '/' });\n\t\t\t}\n\n\t\t\treturn uri;\n\t\t} catch (e) {\n\t\t\tthis.logService.error(`Invalid URI input string: ${arg}, ${e.message}`);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async doGetPathsFromLastSession(): Promise<IPathToOpen[]> {\n\t\tconst restoreWindowsSetting = this.getRestoreWindowsSetting();\n\n\t\tswitch (restoreWindowsSetting) {\n\n\t\t\t// none: no window to restore\n\t\t\tcase 'none':\n\t\t\t\treturn [];\n\n\t\t\t// one: restore last opened workspace/folder or empty window\n\t\t\t// all: restore all windows\n\t\t\t// folders: restore last opened folders only\n\t\t\tcase 'one':\n\t\t\tcase 'all':\n\t\t\tcase 'preserve':\n\t\t\tcase 'folders': {\n\n\t\t\t\t// Collect previously opened windows\n\t\t\t\tconst lastSessionWindows: IWindowState[] = [];\n\t\t\t\tif (restoreWindowsSetting !== 'one') {\n\t\t\t\t\tlastSessionWindows.push(...this.windowsStateHandler.state.openedWindows);\n\t\t\t\t}\n\t\t\t\tif (this.windowsStateHandler.state.lastActiveWindow) {\n\t\t\t\t\tlastSessionWindows.push(this.windowsStateHandler.state.lastActiveWindow);\n\t\t\t\t}\n\n\t\t\t\tconst pathsToOpen = await Promise.all(lastSessionWindows.map(async lastSessionWindow => {\n\n\t\t\t\t\t// Workspaces\n\t\t\t\t\tif (lastSessionWindow.workspace) {\n\t\t\t\t\t\tconst pathToOpen = await this.resolveOpenable({ workspaceUri: lastSessionWindow.workspace.configPath }, { remoteAuthority: lastSessionWindow.remoteAuthority, rejectTransientWorkspaces: true /* https://github.com/microsoft/vscode/issues/119695 */ });\n\t\t\t\t\t\tif (isWorkspacePathToOpen(pathToOpen)) {\n\t\t\t\t\t\t\treturn pathToOpen;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Folders\n\t\t\t\t\telse if (lastSessionWindow.folderUri) {\n\t\t\t\t\t\tconst pathToOpen = await this.resolveOpenable({ folderUri: lastSessionWindow.folderUri }, { remoteAuthority: lastSessionWindow.remoteAuthority });\n\t\t\t\t\t\tif (isSingleFolderWorkspacePathToOpen(pathToOpen)) {\n\t\t\t\t\t\t\treturn pathToOpen;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Empty window, potentially editors open to be restored\n\t\t\t\t\telse if (restoreWindowsSetting !== 'folders' && lastSessionWindow.backupPath) {\n\t\t\t\t\t\treturn { backupPath: lastSessionWindow.backupPath, remoteAuthority: lastSessionWindow.remoteAuthority };\n\t\t\t\t\t}\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t}));\n\n\t\t\t\treturn coalesce(pathsToOpen);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getRestoreWindowsSetting(): RestoreWindowsSetting {\n\t\tlet restoreWindows: RestoreWindowsSetting;\n\t\tif (this.lifecycleMainService.wasRestarted) {\n\t\t\trestoreWindows = 'all'; // always reopen all windows when an update was applied\n\t\t} else {\n\t\t\tconst windowConfig = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\t\t\trestoreWindows = windowConfig?.restoreWindows || 'all'; // by default restore all windows\n\n\t\t\tif (!['preserve', 'all', 'folders', 'one', 'none'].includes(restoreWindows)) {\n\t\t\t\trestoreWindows = 'all'; // by default restore all windows\n\t\t\t}\n\t\t}\n\n\t\treturn restoreWindows;\n\t}\n\n\tprivate async doGetWorkspaceMatchingFoldersFromLastSession(remoteAuthority: string | undefined, folders: ISingleFolderWorkspacePathToOpen[]): Promise<IWorkspaceIdentifier | undefined> {\n\t\tconst workspaces = (await this.doGetPathsFromLastSession()).filter(path => isWorkspacePathToOpen(path));\n\t\tconst folderUris = folders.map(folder => folder.workspace.uri);\n\n\t\tfor (const { workspace } of workspaces) {\n\t\t\tconst resolvedWorkspace = await this.workspacesManagementMainService.resolveLocalWorkspace(workspace.configPath);\n\t\t\tif (\n\t\t\t\t!resolvedWorkspace ||\n\t\t\t\tresolvedWorkspace.remoteAuthority !== remoteAuthority ||\n\t\t\t\tresolvedWorkspace.transient ||\n\t\t\t\tresolvedWorkspace.folders.length !== folders.length\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst folderSet = new ResourceSet(folderUris, uri => extUriBiasedIgnorePathCase.getComparisonKey(uri));\n\t\t\tif (resolvedWorkspace.folders.every(folder => folderSet.has(folder.uri))) {\n\t\t\t\treturn resolvedWorkspace;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async resolveOpenable(openable: IWindowOpenable, options: IPathResolveOptions = Object.create(null)): Promise<IPathToOpen | undefined> {\n\n\t\t// handle file:// openables with some extra validation\n\t\tconst uri = this.resourceFromOpenable(openable);\n\t\tif (uri.scheme === Schemas.file) {\n\t\t\tif (isFileToOpen(openable)) {\n\t\t\t\toptions = { ...options, forceOpenWorkspaceAsFile: true };\n\t\t\t}\n\n\t\t\treturn this.doResolveFilePath(uri.fsPath, options);\n\t\t}\n\n\t\t// handle non file:// openables\n\t\treturn this.doResolveRemoteOpenable(openable, options);\n\t}\n\n\tprivate doResolveRemoteOpenable(openable: IWindowOpenable, options: IPathResolveOptions): IPathToOpen<ITextEditorOptions> | undefined {\n\t\tlet uri = this.resourceFromOpenable(openable);\n\n\t\t// use remote authority from vscode\n\t\tconst remoteAuthority = getRemoteAuthority(uri) || options.remoteAuthority;\n\n\t\t// normalize URI\n\t\turi = removeTrailingPathSeparator(normalizePath(uri));\n\n\t\t// File\n\t\tif (isFileToOpen(openable)) {\n\t\t\tif (options.gotoLineMode) {\n\t\t\t\tconst { path, line, column } = parseLineAndColumnAware(uri.path);\n\n\t\t\t\treturn {\n\t\t\t\t\tfileUri: uri.with({ path }),\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselection: line ? { startLineNumber: line, startColumn: column || 1 } : undefined\n\t\t\t\t\t},\n\t\t\t\t\tremoteAuthority\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn { fileUri: uri, remoteAuthority };\n\t\t}\n\n\t\t// Workspace\n\t\telse if (isWorkspaceToOpen(openable)) {\n\t\t\treturn { workspace: getWorkspaceIdentifier(uri), remoteAuthority };\n\t\t}\n\n\t\t// Folder\n\t\treturn { workspace: getSingleFolderWorkspaceIdentifier(uri), remoteAuthority };\n\t}\n\n\tprivate resourceFromOpenable(openable: IWindowOpenable): URI {\n\t\tif (isWorkspaceToOpen(openable)) {\n\t\t\treturn openable.workspaceUri;\n\t\t}\n\n\t\tif (isFolderToOpen(openable)) {\n\t\t\treturn openable.folderUri;\n\t\t}\n\n\t\treturn openable.fileUri;\n\t}\n\n\tprivate async doResolveFilePath(path: string, options: IPathResolveOptions, skipHandleUNCError?: boolean): Promise<IPathToOpen<ITextEditorOptions> | undefined> {\n\n\t\t// Extract line/col information from path\n\t\tlet lineNumber: number | undefined;\n\t\tlet columnNumber: number | undefined;\n\t\tif (options.gotoLineMode) {\n\t\t\t({ path, line: lineNumber, column: columnNumber } = parseLineAndColumnAware(path));\n\t\t}\n\n\t\t// Ensure the path is normalized and absolute\n\t\tpath = sanitizeFilePath(normalize(path), cwd());\n\n\t\ttry {\n\t\t\tconst pathStat = await fs.promises.stat(path);\n\n\t\t\t// File\n\t\t\tif (pathStat.isFile()) {\n\n\t\t\t\t// Workspace (unless disabled via flag)\n\t\t\t\tif (!options.forceOpenWorkspaceAsFile) {\n\t\t\t\t\tconst workspace = await this.workspacesManagementMainService.resolveLocalWorkspace(URI.file(path));\n\t\t\t\t\tif (workspace) {\n\n\t\t\t\t\t\t// If the workspace is transient and we are to ignore\n\t\t\t\t\t\t// transient workspaces, reject it.\n\t\t\t\t\t\tif (workspace.transient && options.rejectTransientWorkspaces) {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tworkspace: { id: workspace.id, configPath: workspace.configPath },\n\t\t\t\t\t\t\ttype: FileType.File,\n\t\t\t\t\t\t\texists: true,\n\t\t\t\t\t\t\tremoteAuthority: workspace.remoteAuthority,\n\t\t\t\t\t\t\ttransient: workspace.transient\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tfileUri: URI.file(path),\n\t\t\t\t\ttype: FileType.File,\n\t\t\t\t\texists: true,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselection: lineNumber ? { startLineNumber: lineNumber, startColumn: columnNumber || 1 } : undefined\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Folder\n\t\t\telse if (pathStat.isDirectory()) {\n\t\t\t\treturn {\n\t\t\t\t\tworkspace: getSingleFolderWorkspaceIdentifier(URI.file(path), pathStat),\n\t\t\t\t\ttype: FileType.Directory,\n\t\t\t\t\texists: true\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Special device: in POSIX environments, we may get /dev/null passed\n\t\t\t// in (for example git uses it to signal one side of a diff does not\n\t\t\t// exist). In that special case, treat it like a file to support this\n\t\t\t// scenario ()\n\t\t\telse if (!isWindows && path === '/dev/null') {\n\t\t\t\treturn {\n\t\t\t\t\tfileUri: URI.file(path),\n\t\t\t\t\ttype: FileType.File,\n\t\t\t\t\texists: true\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (error) {\n\n\t\t\tif (error.code === 'ERR_UNC_HOST_NOT_ALLOWED' && !skipHandleUNCError) {\n\t\t\t\treturn this.onUNCHostNotAllowed(path, options);\n\t\t\t}\n\n\t\t\tconst fileUri = URI.file(path);\n\n\t\t\t// since file does not seem to exist anymore, remove from recent\n\t\t\tthis.workspacesHistoryMainService.removeRecentlyOpened([fileUri]);\n\n\t\t\t// assume this is a file that does not yet exist\n\t\t\tif (options.ignoreFileNotFound && error.code === 'ENOENT') {\n\t\t\t\treturn {\n\t\t\t\t\tfileUri,\n\t\t\t\t\ttype: FileType.File,\n\t\t\t\t\texists: false\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.logService.error(`Invalid path provided: ${path}, ${error.message}`);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async onUNCHostNotAllowed(path: string, options: IPathResolveOptions): Promise<IPathToOpen<ITextEditorOptions> | undefined> {\n\t\tconst uri = URI.file(path);\n\n\t\tconst { response, checkboxChecked } = await this.dialogMainService.showMessageBox({\n\t\t\ttype: 'warning',\n\t\t\tbuttons: [\n\t\t\t\tlocalize({ key: 'allow', comment: ['&& denotes a mnemonic'] }, \"&&Allow\"),\n\t\t\t\tlocalize({ key: 'cancel', comment: ['&& denotes a mnemonic'] }, \"&&Cancel\"),\n\t\t\t\tlocalize({ key: 'learnMore', comment: ['&& denotes a mnemonic'] }, \"&&Learn More\"),\n\t\t\t],\n\t\t\tmessage: localize('confirmOpenMessage', \"The host '{0}' was not found in the list of allowed hosts. Do you want to allow it anyway?\", uri.authority),\n\t\t\tdetail: localize('confirmOpenDetail', \"The path '{0}' uses a host that is not allowed. Unless you trust the host, you should press 'Cancel'\", getPathLabel(uri, { os: OS, tildify: this.environmentMainService })),\n\t\t\tcheckboxLabel: localize('doNotAskAgain', \"Permanently allow host '{0}'\", uri.authority),\n\t\t\tcancelId: 1\n\t\t});\n\n\t\tif (response === 0) {\n\t\t\taddUNCHostToAllowlist(uri.authority);\n\n\t\t\tif (checkboxChecked) {\n\t\t\t\t// Due to https://github.com/microsoft/vscode/issues/195436, we can only\n\t\t\t\t// update settings from within a window. But we do not know if a window\n\t\t\t\t// is about to open or can already handle the request, so we have to send\n\t\t\t\t// to any current window and any newly opening window.\n\t\t\t\tconst request = { channel: 'vscode:configureAllowedUNCHost', args: uri.authority };\n\t\t\t\tthis.sendToFocused(request.channel, request.args);\n\t\t\t\tthis.sendToOpeningWindow(request.channel, request.args);\n\t\t\t}\n\n\t\t\treturn this.doResolveFilePath(path, options, true /* do not handle UNC error again */);\n\t\t}\n\n\t\tif (response === 2) {\n\t\t\tshell.openExternal('https://aka.ms/vscode-windows-unc');\n\n\t\t\treturn this.onUNCHostNotAllowed(path, options); // keep showing the dialog until decision (https://github.com/microsoft/vscode/issues/181956)\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate doResolveRemotePath(path: string, options: IPathResolveOptions): IPathToOpen<ITextEditorOptions> | undefined {\n\t\tconst first = path.charCodeAt(0);\n\t\tconst remoteAuthority = options.remoteAuthority;\n\n\t\t// Extract line/col information from path\n\t\tlet lineNumber: number | undefined;\n\t\tlet columnNumber: number | undefined;\n\n\t\tif (options.gotoLineMode) {\n\t\t\t({ path, line: lineNumber, column: columnNumber } = parseLineAndColumnAware(path));\n\t\t}\n\n\t\t// make absolute\n\t\tif (first !== CharCode.Slash) {\n\t\t\tif (isWindowsDriveLetter(first) && path.charCodeAt(path.charCodeAt(1)) === CharCode.Colon) {\n\t\t\t\tpath = toSlashes(path);\n\t\t\t}\n\n\t\t\tpath = `/${path}`;\n\t\t}\n\n\t\tconst uri = URI.from({ scheme: Schemas.vscodeRemote, authority: remoteAuthority, path: path });\n\n\t\t// guess the file type:\n\t\t// - if it ends with a slash it's a folder\n\t\t// - if in goto line mode or if it has a file extension, it's a file or a workspace\n\t\t// - by defaults it's a folder\n\t\tif (path.charCodeAt(path.length - 1) !== CharCode.Slash) {\n\n\t\t\t// file name ends with .code-workspace\n\t\t\tif (hasWorkspaceFileExtension(path)) {\n\t\t\t\tif (options.forceOpenWorkspaceAsFile) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tfileUri: uri,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselection: lineNumber ? { startLineNumber: lineNumber, startColumn: columnNumber || 1 } : undefined\n\t\t\t\t\t\t},\n\t\t\t\t\t\tremoteAuthority: options.remoteAuthority\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn { workspace: getWorkspaceIdentifier(uri), remoteAuthority };\n\t\t\t}\n\n\t\t\t// file name starts with a dot or has an file extension\n\t\t\telse if (options.gotoLineMode || posix.basename(path).indexOf('.') !== -1) {\n\t\t\t\treturn {\n\t\t\t\t\tfileUri: uri,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselection: lineNumber ? { startLineNumber: lineNumber, startColumn: columnNumber || 1 } : undefined\n\t\t\t\t\t},\n\t\t\t\t\tremoteAuthority\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn { workspace: getSingleFolderWorkspaceIdentifier(uri), remoteAuthority };\n\t}\n\n\tprivate shouldOpenNewWindow(openConfig: IOpenConfiguration): { openFolderInNewWindow: boolean; openFilesInNewWindow: boolean } {\n\n\t\t// let the user settings override how folders are open in a new window or same window unless we are forced\n\t\tconst windowConfig = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\t\tconst openFolderInNewWindowConfig = windowConfig?.openFoldersInNewWindow || 'default' /* default */;\n\t\tconst openFilesInNewWindowConfig = windowConfig?.openFilesInNewWindow || 'off' /* default */;\n\n\t\tlet openFolderInNewWindow = (openConfig.preferNewWindow || openConfig.forceNewWindow) && !openConfig.forceReuseWindow;\n\t\tif (!openConfig.forceNewWindow && !openConfig.forceReuseWindow && (openFolderInNewWindowConfig === 'on' || openFolderInNewWindowConfig === 'off')) {\n\t\t\topenFolderInNewWindow = (openFolderInNewWindowConfig === 'on');\n\t\t}\n\n\t\t// let the user settings override how files are open in a new window or same window unless we are forced (not for extension development though)\n\t\tlet openFilesInNewWindow = false;\n\t\tif (openConfig.forceNewWindow || openConfig.forceReuseWindow) {\n\t\t\topenFilesInNewWindow = !!openConfig.forceNewWindow && !openConfig.forceReuseWindow;\n\t\t} else {\n\n\t\t\t// macOS: by default we open files in a new window if this is triggered via DOCK context\n\t\t\tif (isMacintosh) {\n\t\t\t\tif (openConfig.context === OpenContext.DOCK) {\n\t\t\t\t\topenFilesInNewWindow = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Linux/Windows: by default we open files in the new window unless triggered via DIALOG / MENU context\n\t\t\t// or from the integrated terminal where we assume the user prefers to open in the current window\n\t\t\telse {\n\t\t\t\tif (openConfig.context !== OpenContext.DIALOG && openConfig.context !== OpenContext.MENU && !(openConfig.userEnv && openConfig.userEnv['TERM_PROGRAM'] === 'vscode')) {\n\t\t\t\t\topenFilesInNewWindow = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// finally check for overrides of default\n\t\t\tif (!openConfig.cli.extensionDevelopmentPath && (openFilesInNewWindowConfig === 'on' || openFilesInNewWindowConfig === 'off')) {\n\t\t\t\topenFilesInNewWindow = (openFilesInNewWindowConfig === 'on');\n\t\t\t}\n\t\t}\n\n\t\treturn { openFolderInNewWindow: !!openFolderInNewWindow, openFilesInNewWindow };\n\t}\n\n\tasync openExtensionDevelopmentHostWindow(extensionDevelopmentPaths: string[], openConfig: IOpenConfiguration): Promise<ICodeWindow[]> {\n\n\t\t// Reload an existing extension development host window on the same path\n\t\t// We currently do not allow more than one extension development window\n\t\t// on the same extension path.\n\t\tconst existingWindow = findWindowOnExtensionDevelopmentPath(this.getWindows(), extensionDevelopmentPaths);\n\t\tif (existingWindow) {\n\t\t\tthis.lifecycleMainService.reload(existingWindow, openConfig.cli);\n\t\t\texistingWindow.focus(); // make sure it gets focus and is restored\n\n\t\t\treturn [existingWindow];\n\t\t}\n\n\t\tlet folderUris = openConfig.cli['folder-uri'] || [];\n\t\tlet fileUris = openConfig.cli['file-uri'] || [];\n\t\tlet cliArgs = openConfig.cli._;\n\n\t\t// Fill in previously opened workspace unless an explicit path is provided and we are not unit testing\n\t\tif (!cliArgs.length && !folderUris.length && !fileUris.length && !openConfig.cli.extensionTestsPath) {\n\t\t\tconst extensionDevelopmentWindowState = this.windowsStateHandler.state.lastPluginDevelopmentHostWindow;\n\t\t\tconst workspaceToOpen = extensionDevelopmentWindowState?.workspace ?? extensionDevelopmentWindowState?.folderUri;\n\t\t\tif (workspaceToOpen) {\n\t\t\t\tif (URI.isUri(workspaceToOpen)) {\n\t\t\t\t\tif (workspaceToOpen.scheme === Schemas.file) {\n\t\t\t\t\t\tcliArgs = [workspaceToOpen.fsPath];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfolderUris = [workspaceToOpen.toString()];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (workspaceToOpen.configPath.scheme === Schemas.file) {\n\t\t\t\t\t\tcliArgs = [originalFSPath(workspaceToOpen.configPath)];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfileUris = [workspaceToOpen.configPath.toString()];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet remoteAuthority = openConfig.remoteAuthority;\n\t\tfor (const extensionDevelopmentPath of extensionDevelopmentPaths) {\n\t\t\tif (extensionDevelopmentPath.match(/^[a-zA-Z][a-zA-Z0-9\\+\\-\\.]+:/)) {\n\t\t\t\tconst url = URI.parse(extensionDevelopmentPath);\n\t\t\t\tconst extensionDevelopmentPathRemoteAuthority = getRemoteAuthority(url);\n\t\t\t\tif (extensionDevelopmentPathRemoteAuthority) {\n\t\t\t\t\tif (remoteAuthority) {\n\t\t\t\t\t\tif (!isEqualAuthority(extensionDevelopmentPathRemoteAuthority, remoteAuthority)) {\n\t\t\t\t\t\t\tthis.logService.error('more than one extension development path authority');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tremoteAuthority = extensionDevelopmentPathRemoteAuthority;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Make sure that we do not try to open:\n\t\t// - a workspace or folder that is already opened\n\t\t// - a workspace or file that has a different authority as the extension development.\n\n\t\tcliArgs = cliArgs.filter(path => {\n\t\t\tconst uri = URI.file(path);\n\t\t\tif (findWindowOnWorkspaceOrFolder(this.getWindows(), uri)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn isEqualAuthority(getRemoteAuthority(uri), remoteAuthority);\n\t\t});\n\n\t\tfolderUris = folderUris.filter(folderUriStr => {\n\t\t\tconst folderUri = this.cliArgToUri(folderUriStr);\n\t\t\tif (folderUri && findWindowOnWorkspaceOrFolder(this.getWindows(), folderUri)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn folderUri ? isEqualAuthority(getRemoteAuthority(folderUri), remoteAuthority) : false;\n\t\t});\n\n\t\tfileUris = fileUris.filter(fileUriStr => {\n\t\t\tconst fileUri = this.cliArgToUri(fileUriStr);\n\t\t\tif (fileUri && findWindowOnWorkspaceOrFolder(this.getWindows(), fileUri)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn fileUri ? isEqualAuthority(getRemoteAuthority(fileUri), remoteAuthority) : false;\n\t\t});\n\n\t\topenConfig.cli._ = cliArgs;\n\t\topenConfig.cli['folder-uri'] = folderUris;\n\t\topenConfig.cli['file-uri'] = fileUris;\n\n\t\t// Open it\n\t\tconst openArgs: IOpenConfiguration = {\n\t\t\tcontext: openConfig.context,\n\t\t\tcli: openConfig.cli,\n\t\t\tforceNewWindow: true,\n\t\t\tforceEmpty: !cliArgs.length && !folderUris.length && !fileUris.length,\n\t\t\tuserEnv: openConfig.userEnv,\n\t\t\tnoRecentEntry: true,\n\t\t\twaitMarkerFileURI: openConfig.waitMarkerFileURI,\n\t\t\tremoteAuthority,\n\t\t\tforceProfile: openConfig.forceProfile,\n\t\t\tforceTempProfile: openConfig.forceTempProfile\n\t\t};\n\n\t\treturn this.open(openArgs);\n\t}\n\n\tprivate async openInBrowserWindow(options: IOpenBrowserWindowOptions): Promise<ICodeWindow> {\n\t\tconst windowConfig = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\n\t\tconst lastActiveWindow = this.getLastActiveWindow();\n\t\tconst newWindowProfile = windowConfig?.newWindowProfile\n\t\t\t? this.userDataProfilesMainService.profiles.find(profile => profile.name === windowConfig.newWindowProfile) : undefined;\n\t\tconst defaultProfile = newWindowProfile ?? lastActiveWindow?.profile ?? this.userDataProfilesMainService.defaultProfile;\n\n\t\tlet window: ICodeWindow | undefined;\n\t\tif (!options.forceNewWindow && !options.forceNewTabbedWindow) {\n\t\t\twindow = options.windowToUse || lastActiveWindow;\n\t\t\tif (window) {\n\t\t\t\twindow.focus();\n\t\t\t}\n\t\t}\n\n\t\t// Build up the window configuration from provided options, config and environment\n\t\tconst configuration: INativeWindowConfiguration = {\n\n\t\t\t// Inherit CLI arguments from environment and/or\n\t\t\t// the specific properties from this launch if provided\n\t\t\t...this.environmentMainService.args,\n\t\t\t...options.cli,\n\n\t\t\tmachineId: this.machineId,\n\t\t\tsqmId: this.sqmId,\n\t\t\tdevDeviceId: this.devDeviceId,\n\n\t\t\twindowId: -1,\t// Will be filled in by the window once loaded later\n\n\t\t\tmainPid: process.pid,\n\n\t\t\tappRoot: this.environmentMainService.appRoot,\n\t\t\texecPath: process.execPath,\n\t\t\tcodeCachePath: this.environmentMainService.codeCachePath,\n\t\t\t// If we know the backup folder upfront (for empty windows to restore), we can set it\n\t\t\t// directly here which helps for restoring UI state associated with that window.\n\t\t\t// For all other cases we first call into registerEmptyWindowBackup() to set it before\n\t\t\t// loading the window.\n\t\t\tbackupPath: options.emptyWindowBackupInfo ? join(this.environmentMainService.backupHome, options.emptyWindowBackupInfo.backupFolder) : undefined,\n\n\t\t\tprofiles: {\n\t\t\t\thome: this.userDataProfilesMainService.profilesHome,\n\t\t\t\tall: this.userDataProfilesMainService.profiles,\n\t\t\t\t// Set to default profile first and resolve and update the profile\n\t\t\t\t// only after the workspace-backup is registered.\n\t\t\t\t// Because, workspace identifier of an empty window is known only then.\n\t\t\t\tprofile: defaultProfile\n\t\t\t},\n\n\t\t\thomeDir: this.environmentMainService.userHome.with({ scheme: Schemas.file }).fsPath,\n\t\t\ttmpDir: this.environmentMainService.tmpDir.with({ scheme: Schemas.file }).fsPath,\n\t\t\tuserDataDir: this.environmentMainService.userDataPath,\n\n\t\t\tremoteAuthority: options.remoteAuthority,\n\t\t\tworkspace: options.workspace,\n\t\t\tuserEnv: { ...this.initialUserEnv, ...options.userEnv },\n\n\t\t\tnls: {\n\t\t\t\tmessages: getNLSMessages(),\n\t\t\t\tlanguage: getNLSLanguage()\n\t\t\t},\n\n\t\t\tfilesToOpenOrCreate: options.filesToOpen?.filesToOpenOrCreate,\n\t\t\tfilesToDiff: options.filesToOpen?.filesToDiff,\n\t\t\tfilesToMerge: options.filesToOpen?.filesToMerge,\n\t\t\tfilesToWait: options.filesToOpen?.filesToWait,\n\n\t\t\tlogLevel: this.loggerService.getLogLevel(),\n\t\t\tloggers: this.loggerService.getGlobalLoggers(),\n\t\t\tlogsPath: this.environmentMainService.logsHome.with({ scheme: Schemas.file }).fsPath,\n\n\t\t\tproduct,\n\t\t\tisInitialStartup: options.initialStartup,\n\t\t\tperfMarks: getMarks(),\n\t\t\tos: { release: release(), hostname: hostname(), arch: arch() },\n\n\t\t\tautoDetectHighContrast: windowConfig?.autoDetectHighContrast ?? true,\n\t\t\tautoDetectColorScheme: windowConfig?.autoDetectColorScheme ?? false,\n\t\t\taccessibilitySupport: app.accessibilitySupportEnabled,\n\t\t\tcolorScheme: this.themeMainService.getColorScheme(),\n\t\t\tpoliciesData: this.policyService.serialize(),\n\t\t\tcontinueOn: this.environmentMainService.continueOn,\n\n\t\t\tcssModules: this.cssDevelopmentService.isEnabled ? await this.cssDevelopmentService.getCssModules() : undefined\n\t\t};\n\n\t\t// New window\n\t\tif (!window) {\n\t\t\tconst state = this.windowsStateHandler.getNewWindowState(configuration);\n\n\t\t\t// Create the window\n\t\t\tmark('code/willCreateCodeWindow');\n\t\t\tconst createdWindow = window = this.instantiationService.createInstance(CodeWindow, {\n\t\t\t\tstate,\n\t\t\t\textensionDevelopmentPath: configuration.extensionDevelopmentPath,\n\t\t\t\tisExtensionTestHost: !!configuration.extensionTestsPath\n\t\t\t});\n\t\t\tmark('code/didCreateCodeWindow');\n\n\t\t\t// Add as window tab if configured (macOS only)\n\t\t\tif (options.forceNewTabbedWindow) {\n\t\t\t\tconst activeWindow = this.getLastActiveWindow();\n\t\t\t\tactiveWindow?.addTabbedWindow(createdWindow);\n\t\t\t}\n\n\t\t\t// Add to our list of windows\n\t\t\tthis.windows.set(createdWindow.id, createdWindow);\n\n\t\t\t// Indicate new window via event\n\t\t\tthis._onDidOpenWindow.fire(createdWindow);\n\n\t\t\t// Indicate number change via event\n\t\t\tthis._onDidChangeWindowsCount.fire({ oldCount: this.getWindowCount() - 1, newCount: this.getWindowCount() });\n\n\t\t\t// Window Events\n\t\t\tconst disposables = new DisposableStore();\n\t\t\tdisposables.add(createdWindow.onDidSignalReady(() => this._onDidSignalReadyWindow.fire(createdWindow)));\n\t\t\tdisposables.add(Event.once(createdWindow.onDidClose)(() => this.onWindowClosed(createdWindow, disposables)));\n\t\t\tdisposables.add(Event.once(createdWindow.onDidDestroy)(() => this.onWindowDestroyed(createdWindow)));\n\t\t\tdisposables.add(createdWindow.onDidMaximize(() => this._onDidMaximizeWindow.fire(createdWindow)));\n\t\t\tdisposables.add(createdWindow.onDidUnmaximize(() => this._onDidUnmaximizeWindow.fire(createdWindow)));\n\t\t\tdisposables.add(createdWindow.onDidEnterFullScreen(() => this._onDidChangeFullScreen.fire({ window: createdWindow, fullscreen: true })));\n\t\t\tdisposables.add(createdWindow.onDidLeaveFullScreen(() => this._onDidChangeFullScreen.fire({ window: createdWindow, fullscreen: false })));\n\t\t\tdisposables.add(createdWindow.onDidTriggerSystemContextMenu(({ x, y }) => this._onDidTriggerSystemContextMenu.fire({ window: createdWindow, x, y })));\n\n\t\t\tconst webContents = assertReturnsDefined(createdWindow.win?.webContents);\n\t\t\twebContents.removeAllListeners('devtools-reload-page'); // remove built in listener so we can handle this on our own\n\t\t\tdisposables.add(Event.fromNodeEventEmitter(webContents, 'devtools-reload-page')(() => this.lifecycleMainService.reload(createdWindow)));\n\n\t\t\t// Lifecycle\n\t\t\tthis.lifecycleMainService.registerWindow(createdWindow);\n\t\t}\n\n\t\t// Existing window\n\t\telse {\n\n\t\t\t// Some configuration things get inherited if the window is being reused and we are\n\t\t\t// in extension development host mode. These options are all development related.\n\t\t\tconst currentWindowConfig = window.config;\n\t\t\tif (!configuration.extensionDevelopmentPath && currentWindowConfig?.extensionDevelopmentPath) {\n\t\t\t\tconfiguration.extensionDevelopmentPath = currentWindowConfig.extensionDevelopmentPath;\n\t\t\t\tconfiguration.extensionDevelopmentKind = currentWindowConfig.extensionDevelopmentKind;\n\t\t\t\tconfiguration['enable-proposed-api'] = currentWindowConfig['enable-proposed-api'];\n\t\t\t\tconfiguration.verbose = currentWindowConfig.verbose;\n\t\t\t\tconfiguration['inspect-extensions'] = currentWindowConfig['inspect-extensions'];\n\t\t\t\tconfiguration['inspect-brk-extensions'] = currentWindowConfig['inspect-brk-extensions'];\n\t\t\t\tconfiguration.debugId = currentWindowConfig.debugId;\n\t\t\t\tconfiguration.extensionEnvironment = currentWindowConfig.extensionEnvironment;\n\t\t\t\tconfiguration['extensions-dir'] = currentWindowConfig['extensions-dir'];\n\t\t\t\tconfiguration['disable-extensions'] = currentWindowConfig['disable-extensions'];\n\t\t\t\tconfiguration['disable-extension'] = currentWindowConfig['disable-extension'];\n\t\t\t}\n\t\t}\n\n\t\t// Update window identifier and session now\n\t\t// that we have the window object in hand.\n\t\tconfiguration.windowId = window.id;\n\n\t\t// If the window was already loaded, make sure to unload it\n\t\t// first and only load the new configuration if that was\n\t\t// not vetoed\n\t\tif (window.isReady) {\n\t\t\tthis.lifecycleMainService.unload(window, UnloadReason.LOAD).then(async veto => {\n\t\t\t\tif (!veto) {\n\t\t\t\t\tawait this.doOpenInBrowserWindow(window, configuration, options, defaultProfile);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tawait this.doOpenInBrowserWindow(window, configuration, options, defaultProfile);\n\t\t}\n\n\t\treturn window;\n\t}\n\n\tprivate async doOpenInBrowserWindow(window: ICodeWindow, configuration: INativeWindowConfiguration, options: IOpenBrowserWindowOptions, defaultProfile: IUserDataProfile): Promise<void> {\n\n\t\t// Register window for backups unless the window\n\t\t// is for extension development, where we do not\n\t\t// keep any backups.\n\n\t\tif (!configuration.extensionDevelopmentPath) {\n\t\t\tif (isWorkspaceIdentifier(configuration.workspace)) {\n\t\t\t\tconfiguration.backupPath = this.backupMainService.registerWorkspaceBackup({\n\t\t\t\t\tworkspace: configuration.workspace,\n\t\t\t\t\tremoteAuthority: configuration.remoteAuthority\n\t\t\t\t});\n\t\t\t} else if (isSingleFolderWorkspaceIdentifier(configuration.workspace)) {\n\t\t\t\tconfiguration.backupPath = this.backupMainService.registerFolderBackup({\n\t\t\t\t\tfolderUri: configuration.workspace.uri,\n\t\t\t\t\tremoteAuthority: configuration.remoteAuthority\n\t\t\t\t});\n\t\t\t} else {\n\n\t\t\t\t// Empty windows are special in that they provide no workspace on\n\t\t\t\t// their configuration. To properly register them with the backup\n\t\t\t\t// service, we either use the provided associated `backupFolder`\n\t\t\t\t// in case we restore a previously opened empty window or we have\n\t\t\t\t// to generate a new empty window workspace identifier to be used\n\t\t\t\t// as `backupFolder`.\n\n\t\t\t\tconfiguration.backupPath = this.backupMainService.registerEmptyWindowBackup({\n\t\t\t\t\tbackupFolder: options.emptyWindowBackupInfo?.backupFolder ?? createEmptyWorkspaceIdentifier().id,\n\t\t\t\t\tremoteAuthority: configuration.remoteAuthority\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst workspace = configuration.workspace ?? toWorkspaceIdentifier(configuration.backupPath, false);\n\t\tconst profilePromise = this.resolveProfileForBrowserWindow(options, workspace, defaultProfile);\n\t\tconst profile = profilePromise instanceof Promise ? await profilePromise : profilePromise;\n\t\tconfiguration.profiles.profile = profile;\n\n\t\tif (!configuration.extensionDevelopmentPath) {\n\t\t\t// Associate the configured profile to the workspace\n\t\t\t// unless the window is for extension development,\n\t\t\t// where we do not persist the associations\n\t\t\tawait this.userDataProfilesMainService.setProfileForWorkspace(workspace, profile);\n\t\t}\n\n\t\t// Load it\n\t\twindow.load(configuration);\n\t}\n\n\tprivate resolveProfileForBrowserWindow(options: IOpenBrowserWindowOptions, workspace: IAnyWorkspaceIdentifier, defaultProfile: IUserDataProfile): Promise<IUserDataProfile> | IUserDataProfile {\n\t\tif (options.forceProfile) {\n\t\t\treturn this.userDataProfilesMainService.profiles.find(p => p.name === options.forceProfile) ?? this.userDataProfilesMainService.createNamedProfile(options.forceProfile);\n\t\t}\n\n\t\tif (options.forceTempProfile) {\n\t\t\treturn this.userDataProfilesMainService.createTransientProfile();\n\t\t}\n\n\t\treturn this.userDataProfilesMainService.getProfileForWorkspace(workspace) ?? defaultProfile;\n\t}\n\n\tprivate onWindowClosed(window: ICodeWindow, disposables: IDisposable): void {\n\n\t\t// Remove from our list so that Electron can clean it up\n\t\tthis.windows.delete(window.id);\n\n\t\t// Emit\n\t\tthis._onDidChangeWindowsCount.fire({ oldCount: this.getWindowCount() + 1, newCount: this.getWindowCount() });\n\n\t\t// Clean up\n\t\tdisposables.dispose();\n\t}\n\n\tprivate onWindowDestroyed(window: ICodeWindow): void {\n\n\t\t// Remove from our list so that Electron can clean it up\n\t\tthis.windows.delete(window.id);\n\n\t\t// Emit\n\t\tthis._onDidDestroyWindow.fire(window);\n\t}\n\n\tgetFocusedWindow(): ICodeWindow | undefined {\n\t\tconst window = BrowserWindow.getFocusedWindow();\n\t\tif (window) {\n\t\t\treturn this.getWindowById(window.id);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetLastActiveWindow(): ICodeWindow | undefined {\n\t\treturn this.doGetLastActiveWindow(this.getWindows());\n\t}\n\n\tprivate getLastActiveWindowForAuthority(remoteAuthority: string | undefined): ICodeWindow | undefined {\n\t\treturn this.doGetLastActiveWindow(this.getWindows().filter(window => isEqualAuthority(window.remoteAuthority, remoteAuthority)));\n\t}\n\n\tprivate doGetLastActiveWindow(windows: ICodeWindow[]): ICodeWindow | undefined {\n\t\treturn getLastFocused(windows);\n\t}\n\n\tsendToFocused(channel: string, ...args: unknown[]): void {\n\t\tconst focusedWindow = this.getFocusedWindow() || this.getLastActiveWindow();\n\n\t\tfocusedWindow?.sendWhenReady(channel, CancellationToken.None, ...args);\n\t}\n\n\tsendToOpeningWindow(channel: string, ...args: unknown[]): void {\n\t\tthis._register(Event.once(this.onDidSignalReadyWindow)(window => {\n\t\t\twindow.sendWhenReady(channel, CancellationToken.None, ...args);\n\t\t}));\n\t}\n\n\tsendToAll(channel: string, payload?: unknown, windowIdsToIgnore?: number[]): void {\n\t\tfor (const window of this.getWindows()) {\n\t\t\tif (windowIdsToIgnore && windowIdsToIgnore.indexOf(window.id) >= 0) {\n\t\t\t\tcontinue; // do not send if we are instructed to ignore it\n\t\t\t}\n\n\t\t\twindow.sendWhenReady(channel, CancellationToken.None, payload);\n\t\t}\n\t}\n\n\tgetWindows(): ICodeWindow[] {\n\t\treturn Array.from(this.windows.values());\n\t}\n\n\tgetWindowCount(): number {\n\t\treturn this.windows.size;\n\t}\n\n\tgetWindowById(windowId: number): ICodeWindow | undefined {\n\t\treturn this.windows.get(windowId);\n\t}\n\n\tgetWindowByWebContents(webContents: WebContents): ICodeWindow | undefined {\n\t\tconst browserWindow = BrowserWindow.fromWebContents(webContents);\n\t\tif (!browserWindow) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst window = this.getWindowById(browserWindow.id);\n\n\t\treturn window?.matches(webContents) ? window : undefined;\n\t}\n}\n"]}