{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/windows/test/electron-main/windowsFinder.test.ts","vs/platform/windows/test/electron-main/windowsFinder.test.ts"],"names":[],"mappings":"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","file":"windowsFinder.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { join } from '../../../../base/common/path.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI, UriDto } from '../../../../base/common/uri.js';\nimport { ICommandAction } from '../../../action/common/action.js';\nimport { NativeParsedArgs } from '../../../environment/common/argv.js';\nimport { INativeWindowConfiguration } from '../../../window/common/window.js';\nimport { ICodeWindow, ILoadEvent, IWindowState } from '../../../window/electron-main/window.js';\nimport { findWindowOnFile } from '../../electron-main/windowsFinder.js';\nimport { toWorkspaceFolders } from '../../../workspaces/common/workspaces.js';\nimport { IWorkspaceIdentifier } from '../../../workspace/common/workspace.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { FocusMode } from '../../../native/common/native.js';\n\nsuite('WindowsFinder', () => {\n\n\tconst fixturesFolder = FileAccess.asFileUri('vs/platform/windows/test/electron-main/fixtures').fsPath;\n\n\tconst testWorkspace: IWorkspaceIdentifier = {\n\t\tid: Date.now().toString(),\n\t\tconfigPath: URI.file(join(fixturesFolder, 'workspaces.json'))\n\t};\n\n\tconst testWorkspaceFolders = toWorkspaceFolders([{ path: join(fixturesFolder, 'vscode_workspace_1_folder') }, { path: join(fixturesFolder, 'vscode_workspace_2_folder') }], testWorkspace.configPath, extUriBiasedIgnorePathCase);\n\tconst localWorkspaceResolver = async (workspace: IWorkspaceIdentifier) => { return workspace === testWorkspace ? { id: testWorkspace.id, configPath: workspace.configPath, folders: testWorkspaceFolders } : undefined; };\n\n\tfunction createTestCodeWindow(options: { lastFocusTime: number; openedFolderUri?: URI; openedWorkspace?: IWorkspaceIdentifier }): ICodeWindow {\n\t\treturn new class implements ICodeWindow {\n\t\t\treadonly onWillLoad: Event<ILoadEvent> = Event.None;\n\t\t\tonDidMaximize = Event.None;\n\t\t\tonDidUnmaximize = Event.None;\n\t\t\treadonly onDidTriggerSystemContextMenu: Event<{ x: number; y: number }> = Event.None;\n\t\t\treadonly onDidSignalReady: Event<void> = Event.None;\n\t\t\treadonly onDidClose: Event<void> = Event.None;\n\t\t\treadonly onDidDestroy: Event<void> = Event.None;\n\t\t\treadonly onDidEnterFullScreen: Event<void> = Event.None;\n\t\t\treadonly onDidLeaveFullScreen: Event<void> = Event.None;\n\t\t\twhenClosedOrLoaded: Promise<void> = Promise.resolve();\n\t\t\tid: number = -1;\n\t\t\twin: Electron.BrowserWindow = null!;\n\t\t\tconfig: INativeWindowConfiguration | undefined;\n\t\t\topenedWorkspace = options.openedFolderUri ? { id: '', uri: options.openedFolderUri } : options.openedWorkspace;\n\t\t\tbackupPath?: string | undefined;\n\t\t\tremoteAuthority?: string | undefined;\n\t\t\tisExtensionDevelopmentHost = false;\n\t\t\tisExtensionTestHost = false;\n\t\t\tlastFocusTime = options.lastFocusTime;\n\t\t\tisFullScreen = false;\n\t\t\tisReady = true;\n\n\t\t\tready(): Promise<ICodeWindow> { throw new Error('Method not implemented.'); }\n\t\t\tsetReady(): void { throw new Error('Method not implemented.'); }\n\t\t\taddTabbedWindow(window: ICodeWindow): void { throw new Error('Method not implemented.'); }\n\t\t\tload(config: INativeWindowConfiguration, options: { isReload?: boolean }): void { throw new Error('Method not implemented.'); }\n\t\t\treload(cli?: NativeParsedArgs): void { throw new Error('Method not implemented.'); }\n\t\t\tfocus(options?: { mode: FocusMode }): void { throw new Error('Method not implemented.'); }\n\t\t\tclose(): void { throw new Error('Method not implemented.'); }\n\t\t\tgetBounds(): Electron.Rectangle { throw new Error('Method not implemented.'); }\n\t\t\tsend(channel: string, ...args: unknown[]): void { throw new Error('Method not implemented.'); }\n\t\t\tsendWhenReady(channel: string, token: CancellationToken, ...args: unknown[]): void { throw new Error('Method not implemented.'); }\n\t\t\ttoggleFullScreen(): void { throw new Error('Method not implemented.'); }\n\t\t\tsetRepresentedFilename(name: string): void { throw new Error('Method not implemented.'); }\n\t\t\tgetRepresentedFilename(): string | undefined { throw new Error('Method not implemented.'); }\n\t\t\tsetDocumentEdited(edited: boolean): void { throw new Error('Method not implemented.'); }\n\t\t\tisDocumentEdited(): boolean { throw new Error('Method not implemented.'); }\n\t\t\tupdateTouchBar(items: UriDto<ICommandAction>[][]): void { throw new Error('Method not implemented.'); }\n\t\t\tserializeWindowState(): IWindowState { throw new Error('Method not implemented'); }\n\t\t\tupdateWindowControls(options: { height?: number | undefined; backgroundColor?: string | undefined; foregroundColor?: string | undefined }): void { throw new Error('Method not implemented.'); }\n\t\t\tnotifyZoomLevel(level: number): void { throw new Error('Method not implemented.'); }\n\t\t\tmatches(webContents: Electron.WebContents): boolean { throw new Error('Method not implemented.'); }\n\t\t\tdispose(): void { }\n\t\t};\n\t}\n\n\tconst vscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder')) });\n\tconst lastActiveWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 3, openedFolderUri: undefined });\n\tconst noVscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\tconst windows: ICodeWindow[] = [\n\t\tvscodeFolderWindow,\n\t\tlastActiveWindow,\n\t\tnoVscodeFolderWindow,\n\t];\n\n\ttest('New window without folder when no windows exist', async () => {\n\t\tassert.strictEqual(await findWindowOnFile([], URI.file('nonexisting'), localWorkspaceResolver), undefined);\n\t\tassert.strictEqual(await findWindowOnFile([], URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), undefined);\n\t});\n\n\ttest('Existing window with folder', async () => {\n\t\tassert.strictEqual(await findWindowOnFile(windows, URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), noVscodeFolderWindow);\n\n\t\tassert.strictEqual(await findWindowOnFile(windows, URI.file(join(fixturesFolder, 'vscode_folder', 'file.txt')), localWorkspaceResolver), vscodeFolderWindow);\n\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(await findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n\n\ttest('More specific existing window wins', async () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\t\tconst nestedFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(await findWindowOnFile([window, nestedFolderWindow], URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), nestedFolderWindow);\n\t});\n\n\ttest('Workspace folder wins', async () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedWorkspace: testWorkspace });\n\t\tassert.strictEqual(await findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_workspace_2_folder', 'nested_vscode_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { join } from '../../../../base/common/path.js';\nimport { extUriBiasedIgnorePathCase } from '../../../../base/common/resources.js';\nimport { URI, UriDto } from '../../../../base/common/uri.js';\nimport { ICommandAction } from '../../../action/common/action.js';\nimport { NativeParsedArgs } from '../../../environment/common/argv.js';\nimport { INativeWindowConfiguration } from '../../../window/common/window.js';\nimport { ICodeWindow, ILoadEvent, IWindowState } from '../../../window/electron-main/window.js';\nimport { findWindowOnFile } from '../../electron-main/windowsFinder.js';\nimport { toWorkspaceFolders } from '../../../workspaces/common/workspaces.js';\nimport { IWorkspaceIdentifier } from '../../../workspace/common/workspace.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { FocusMode } from '../../../native/common/native.js';\n\nsuite('WindowsFinder', () => {\n\n\tconst fixturesFolder = FileAccess.asFileUri('vs/platform/windows/test/electron-main/fixtures').fsPath;\n\n\tconst testWorkspace: IWorkspaceIdentifier = {\n\t\tid: Date.now().toString(),\n\t\tconfigPath: URI.file(join(fixturesFolder, 'workspaces.json'))\n\t};\n\n\tconst testWorkspaceFolders = toWorkspaceFolders([{ path: join(fixturesFolder, 'vscode_workspace_1_folder') }, { path: join(fixturesFolder, 'vscode_workspace_2_folder') }], testWorkspace.configPath, extUriBiasedIgnorePathCase);\n\tconst localWorkspaceResolver = async (workspace: IWorkspaceIdentifier) => { return workspace === testWorkspace ? { id: testWorkspace.id, configPath: workspace.configPath, folders: testWorkspaceFolders } : undefined; };\n\n\tfunction createTestCodeWindow(options: { lastFocusTime: number; openedFolderUri?: URI; openedWorkspace?: IWorkspaceIdentifier }): ICodeWindow {\n\t\treturn new class implements ICodeWindow {\n\t\t\treadonly onWillLoad: Event<ILoadEvent> = Event.None;\n\t\t\tonDidMaximize = Event.None;\n\t\t\tonDidUnmaximize = Event.None;\n\t\t\treadonly onDidTriggerSystemContextMenu: Event<{ x: number; y: number }> = Event.None;\n\t\t\treadonly onDidSignalReady: Event<void> = Event.None;\n\t\t\treadonly onDidClose: Event<void> = Event.None;\n\t\t\treadonly onDidDestroy: Event<void> = Event.None;\n\t\t\treadonly onDidEnterFullScreen: Event<void> = Event.None;\n\t\t\treadonly onDidLeaveFullScreen: Event<void> = Event.None;\n\t\t\twhenClosedOrLoaded: Promise<void> = Promise.resolve();\n\t\t\tid: number = -1;\n\t\t\twin: Electron.BrowserWindow = null!;\n\t\t\tconfig: INativeWindowConfiguration | undefined;\n\t\t\topenedWorkspace = options.openedFolderUri ? { id: '', uri: options.openedFolderUri } : options.openedWorkspace;\n\t\t\tbackupPath?: string | undefined;\n\t\t\tremoteAuthority?: string | undefined;\n\t\t\tisExtensionDevelopmentHost = false;\n\t\t\tisExtensionTestHost = false;\n\t\t\tlastFocusTime = options.lastFocusTime;\n\t\t\tisFullScreen = false;\n\t\t\tisReady = true;\n\n\t\t\tready(): Promise<ICodeWindow> { throw new Error('Method not implemented.'); }\n\t\t\tsetReady(): void { throw new Error('Method not implemented.'); }\n\t\t\taddTabbedWindow(window: ICodeWindow): void { throw new Error('Method not implemented.'); }\n\t\t\tload(config: INativeWindowConfiguration, options: { isReload?: boolean }): void { throw new Error('Method not implemented.'); }\n\t\t\treload(cli?: NativeParsedArgs): void { throw new Error('Method not implemented.'); }\n\t\t\tfocus(options?: { mode: FocusMode }): void { throw new Error('Method not implemented.'); }\n\t\t\tclose(): void { throw new Error('Method not implemented.'); }\n\t\t\tgetBounds(): Electron.Rectangle { throw new Error('Method not implemented.'); }\n\t\t\tsend(channel: string, ...args: unknown[]): void { throw new Error('Method not implemented.'); }\n\t\t\tsendWhenReady(channel: string, token: CancellationToken, ...args: unknown[]): void { throw new Error('Method not implemented.'); }\n\t\t\ttoggleFullScreen(): void { throw new Error('Method not implemented.'); }\n\t\t\tsetRepresentedFilename(name: string): void { throw new Error('Method not implemented.'); }\n\t\t\tgetRepresentedFilename(): string | undefined { throw new Error('Method not implemented.'); }\n\t\t\tsetDocumentEdited(edited: boolean): void { throw new Error('Method not implemented.'); }\n\t\t\tisDocumentEdited(): boolean { throw new Error('Method not implemented.'); }\n\t\t\tupdateTouchBar(items: UriDto<ICommandAction>[][]): void { throw new Error('Method not implemented.'); }\n\t\t\tserializeWindowState(): IWindowState { throw new Error('Method not implemented'); }\n\t\t\tupdateWindowControls(options: { height?: number | undefined; backgroundColor?: string | undefined; foregroundColor?: string | undefined }): void { throw new Error('Method not implemented.'); }\n\t\t\tnotifyZoomLevel(level: number): void { throw new Error('Method not implemented.'); }\n\t\t\tmatches(webContents: Electron.WebContents): boolean { throw new Error('Method not implemented.'); }\n\t\t\tdispose(): void { }\n\t\t};\n\t}\n\n\tconst vscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder')) });\n\tconst lastActiveWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 3, openedFolderUri: undefined });\n\tconst noVscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\tconst windows: ICodeWindow[] = [\n\t\tvscodeFolderWindow,\n\t\tlastActiveWindow,\n\t\tnoVscodeFolderWindow,\n\t];\n\n\ttest('New window without folder when no windows exist', async () => {\n\t\tassert.strictEqual(await findWindowOnFile([], URI.file('nonexisting'), localWorkspaceResolver), undefined);\n\t\tassert.strictEqual(await findWindowOnFile([], URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), undefined);\n\t});\n\n\ttest('Existing window with folder', async () => {\n\t\tassert.strictEqual(await findWindowOnFile(windows, URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), noVscodeFolderWindow);\n\n\t\tassert.strictEqual(await findWindowOnFile(windows, URI.file(join(fixturesFolder, 'vscode_folder', 'file.txt')), localWorkspaceResolver), vscodeFolderWindow);\n\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(await findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n\n\ttest('More specific existing window wins', async () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\t\tconst nestedFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(await findWindowOnFile([window, nestedFolderWindow], URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), nestedFolderWindow);\n\t});\n\n\ttest('Workspace folder wins', async () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedWorkspace: testWorkspace });\n\t\tassert.strictEqual(await findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_workspace_2_folder', 'nested_vscode_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}