{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/remote/electron-browser/electronRemoteResourceLoader.ts","vs/platform/remote/electron-browser/electronRemoteResourceLoader.ts"],"names":[],"mappings":"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","file":"electronRemoteResourceLoader.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer, encodeBase64 } from '../../../base/common/buffer.js';\nimport { Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { getMediaOrTextMime } from '../../../base/common/mime.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IServerChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { FileOperationError, FileOperationResult, IFileContent, IFileService } from '../../files/common/files.js';\nimport { IMainProcessService } from '../../ipc/common/mainProcessService.js';\nimport { NODE_REMOTE_RESOURCE_CHANNEL_NAME, NODE_REMOTE_RESOURCE_IPC_METHOD_NAME, NodeRemoteResourceResponse } from '../common/electronRemoteResources.js';\n\nexport class ElectronRemoteResourceLoader extends Disposable {\n\tconstructor(\n\t\tprivate readonly windowId: number,\n\t\t@IMainProcessService mainProcessService: IMainProcessService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t) {\n\t\tsuper();\n\n\t\tconst channel: IServerChannel = {\n\t\t\tlisten<T>(_: unknown, event: string): Event<T> {\n\t\t\t\tthrow new Error(`Event not found: ${event}`);\n\t\t\t},\n\n\t\t\tcall: (_: unknown, command: string, arg?: any): Promise<any> => {\n\t\t\t\tswitch (command) {\n\t\t\t\t\tcase NODE_REMOTE_RESOURCE_IPC_METHOD_NAME: return this.doRequest(URI.revive(arg[0]));\n\t\t\t\t}\n\n\t\t\t\tthrow new Error(`Call not found: ${command}`);\n\t\t\t}\n\t\t};\n\n\t\tmainProcessService.registerChannel(NODE_REMOTE_RESOURCE_CHANNEL_NAME, channel);\n\t}\n\n\tprivate async doRequest(uri: URI): Promise<NodeRemoteResourceResponse> {\n\t\tlet content: IFileContent;\n\t\ttry {\n\t\t\tconst params = new URLSearchParams(uri.query);\n\t\t\tconst actual = uri.with({\n\t\t\t\tscheme: params.get('scheme')!,\n\t\t\t\tauthority: params.get('authority')!,\n\t\t\t\tquery: '',\n\t\t\t});\n\t\t\tcontent = await this.fileService.readFile(actual);\n\t\t} catch (e) {\n\t\t\tconst str = encodeBase64(VSBuffer.fromString(e.message));\n\t\t\tif (e instanceof FileOperationError && e.fileOperationResult === FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\treturn { statusCode: 404, body: str };\n\t\t\t} else {\n\t\t\t\treturn { statusCode: 500, body: str };\n\t\t\t}\n\t\t}\n\n\t\tconst mimeType = uri.path && getMediaOrTextMime(uri.path);\n\t\treturn { statusCode: 200, body: encodeBase64(content.value), mimeType };\n\t}\n\n\tpublic getResourceUriProvider() {\n\t\treturn (uri: URI) => uri.with({\n\t\t\tscheme: Schemas.vscodeManagedRemoteResource,\n\t\t\tauthority: `window:${this.windowId}`,\n\t\t\tquery: new URLSearchParams({ authority: uri.authority, scheme: uri.scheme }).toString(),\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer, encodeBase64 } from '../../../base/common/buffer.js';\nimport { Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { getMediaOrTextMime } from '../../../base/common/mime.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IServerChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { FileOperationError, FileOperationResult, IFileContent, IFileService } from '../../files/common/files.js';\nimport { IMainProcessService } from '../../ipc/common/mainProcessService.js';\nimport { NODE_REMOTE_RESOURCE_CHANNEL_NAME, NODE_REMOTE_RESOURCE_IPC_METHOD_NAME, NodeRemoteResourceResponse } from '../common/electronRemoteResources.js';\n\nexport class ElectronRemoteResourceLoader extends Disposable {\n\tconstructor(\n\t\tprivate readonly windowId: number,\n\t\t@IMainProcessService mainProcessService: IMainProcessService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t) {\n\t\tsuper();\n\n\t\tconst channel: IServerChannel = {\n\t\t\tlisten<T>(_: unknown, event: string): Event<T> {\n\t\t\t\tthrow new Error(`Event not found: ${event}`);\n\t\t\t},\n\n\t\t\tcall: (_: unknown, command: string, arg?: any): Promise<any> => {\n\t\t\t\tswitch (command) {\n\t\t\t\t\tcase NODE_REMOTE_RESOURCE_IPC_METHOD_NAME: return this.doRequest(URI.revive(arg[0]));\n\t\t\t\t}\n\n\t\t\t\tthrow new Error(`Call not found: ${command}`);\n\t\t\t}\n\t\t};\n\n\t\tmainProcessService.registerChannel(NODE_REMOTE_RESOURCE_CHANNEL_NAME, channel);\n\t}\n\n\tprivate async doRequest(uri: URI): Promise<NodeRemoteResourceResponse> {\n\t\tlet content: IFileContent;\n\t\ttry {\n\t\t\tconst params = new URLSearchParams(uri.query);\n\t\t\tconst actual = uri.with({\n\t\t\t\tscheme: params.get('scheme')!,\n\t\t\t\tauthority: params.get('authority')!,\n\t\t\t\tquery: '',\n\t\t\t});\n\t\t\tcontent = await this.fileService.readFile(actual);\n\t\t} catch (e) {\n\t\t\tconst str = encodeBase64(VSBuffer.fromString(e.message));\n\t\t\tif (e instanceof FileOperationError && e.fileOperationResult === FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\treturn { statusCode: 404, body: str };\n\t\t\t} else {\n\t\t\t\treturn { statusCode: 500, body: str };\n\t\t\t}\n\t\t}\n\n\t\tconst mimeType = uri.path && getMediaOrTextMime(uri.path);\n\t\treturn { statusCode: 200, body: encodeBase64(content.value), mimeType };\n\t}\n\n\tpublic getResourceUriProvider() {\n\t\treturn (uri: URI) => uri.with({\n\t\t\tscheme: Schemas.vscodeManagedRemoteResource,\n\t\t\tauthority: `window:${this.windowId}`,\n\t\t\tquery: new URLSearchParams({ authority: uri.authority, scheme: uri.scheme }).toString(),\n\t\t});\n\t}\n}\n"]}