{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/webview/electron-main/webviewMainService.ts","vs/platform/webview/electron-main/webviewMainService.ts"],"names":[],"mappings":"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","file":"webviewMainService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { WebContents, webContents, WebFrameMain } from 'electron';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { FindInFrameOptions, FoundInFrameResult, IWebviewManagerService, WebviewWebContentsId, WebviewWindowId } from '../common/webviewManagerService.js';\nimport { WebviewProtocolProvider } from './webviewProtocolProvider.js';\nimport { IWindowsMainService } from '../../windows/electron-main/windows.js';\nimport { IFileService } from '../../files/common/files.js';\n\nexport class WebviewMainService extends Disposable implements IWebviewManagerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onFoundInFrame = this._register(new Emitter<FoundInFrameResult>());\n\tpublic readonly onFoundInFrame = this._onFoundInFrame.event;\n\n\tconstructor(\n\t\t@IFileService fileService: IFileService,\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t) {\n\t\tsuper();\n\t\tthis._register(new WebviewProtocolProvider(fileService));\n\t}\n\n\tpublic async setIgnoreMenuShortcuts(id: WebviewWebContentsId | WebviewWindowId, enabled: boolean): Promise<void> {\n\t\tlet contents: WebContents | undefined;\n\n\t\tif (typeof (id as WebviewWindowId).windowId === 'number') {\n\t\t\tconst { windowId } = (id as WebviewWindowId);\n\t\t\tconst window = this.windowsMainService.getWindowById(windowId);\n\t\t\tif (!window?.win) {\n\t\t\t\tthrow new Error(`Invalid windowId: ${windowId}`);\n\t\t\t}\n\t\t\tcontents = window.win.webContents;\n\t\t} else {\n\t\t\tconst { webContentsId } = (id as WebviewWebContentsId);\n\t\t\tcontents = webContents.fromId(webContentsId);\n\t\t\tif (!contents) {\n\t\t\t\tthrow new Error(`Invalid webContentsId: ${webContentsId}`);\n\t\t\t}\n\t\t}\n\n\t\tif (!contents.isDestroyed()) {\n\t\t\tcontents.setIgnoreMenuShortcuts(enabled);\n\t\t}\n\t}\n\n\tpublic async findInFrame(windowId: WebviewWindowId, frameName: string, text: string, options: { findNext?: boolean; forward?: boolean }): Promise<void> {\n\t\tconst initialFrame = this.getFrameByName(windowId, frameName);\n\n\t\ttype WebFrameMainWithFindSupport = WebFrameMain & {\n\t\t\tfindInFrame?(text: string, findOptions: FindInFrameOptions): void;\n\t\t\ton(event: 'found-in-frame', listener: Function): WebFrameMain;\n\t\t\tremoveListener(event: 'found-in-frame', listener: Function): WebFrameMain;\n\t\t};\n\t\tconst frame = initialFrame as unknown as WebFrameMainWithFindSupport;\n\t\tif (typeof frame.findInFrame === 'function') {\n\t\t\tframe.findInFrame(text, {\n\t\t\t\tfindNext: options.findNext,\n\t\t\t\tforward: options.forward,\n\t\t\t});\n\t\t\tconst foundInFrameHandler = (_: unknown, result: FoundInFrameResult) => {\n\t\t\t\tif (result.finalUpdate) {\n\t\t\t\t\tthis._onFoundInFrame.fire(result);\n\t\t\t\t\tframe.removeListener('found-in-frame', foundInFrameHandler);\n\t\t\t\t}\n\t\t\t};\n\t\t\tframe.on('found-in-frame', foundInFrameHandler);\n\t\t}\n\t}\n\n\tpublic async stopFindInFrame(windowId: WebviewWindowId, frameName: string, options: { keepSelection?: boolean }): Promise<void> {\n\t\tconst initialFrame = this.getFrameByName(windowId, frameName);\n\n\t\ttype WebFrameMainWithFindSupport = WebFrameMain & {\n\t\t\tstopFindInFrame?(stopOption: 'keepSelection' | 'clearSelection'): void;\n\t\t};\n\n\t\tconst frame = initialFrame as unknown as WebFrameMainWithFindSupport;\n\t\tif (typeof frame.stopFindInFrame === 'function') {\n\t\t\tframe.stopFindInFrame(options.keepSelection ? 'keepSelection' : 'clearSelection');\n\t\t}\n\t}\n\n\tprivate getFrameByName(windowId: WebviewWindowId, frameName: string): WebFrameMain {\n\t\tconst window = this.windowsMainService.getWindowById(windowId.windowId);\n\t\tif (!window?.win) {\n\t\t\tthrow new Error(`Invalid windowId: ${windowId}`);\n\t\t}\n\t\tconst frame = window.win.webContents.mainFrame.framesInSubtree.find(frame => {\n\t\t\treturn frame.name === frameName;\n\t\t});\n\t\tif (!frame) {\n\t\t\tthrow new Error(`Unknown frame: ${frameName}`);\n\t\t}\n\t\treturn frame;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { WebContents, webContents, WebFrameMain } from 'electron';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { FindInFrameOptions, FoundInFrameResult, IWebviewManagerService, WebviewWebContentsId, WebviewWindowId } from '../common/webviewManagerService.js';\nimport { WebviewProtocolProvider } from './webviewProtocolProvider.js';\nimport { IWindowsMainService } from '../../windows/electron-main/windows.js';\nimport { IFileService } from '../../files/common/files.js';\n\nexport class WebviewMainService extends Disposable implements IWebviewManagerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onFoundInFrame = this._register(new Emitter<FoundInFrameResult>());\n\tpublic readonly onFoundInFrame = this._onFoundInFrame.event;\n\n\tconstructor(\n\t\t@IFileService fileService: IFileService,\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t) {\n\t\tsuper();\n\t\tthis._register(new WebviewProtocolProvider(fileService));\n\t}\n\n\tpublic async setIgnoreMenuShortcuts(id: WebviewWebContentsId | WebviewWindowId, enabled: boolean): Promise<void> {\n\t\tlet contents: WebContents | undefined;\n\n\t\tif (typeof (id as WebviewWindowId).windowId === 'number') {\n\t\t\tconst { windowId } = (id as WebviewWindowId);\n\t\t\tconst window = this.windowsMainService.getWindowById(windowId);\n\t\t\tif (!window?.win) {\n\t\t\t\tthrow new Error(`Invalid windowId: ${windowId}`);\n\t\t\t}\n\t\t\tcontents = window.win.webContents;\n\t\t} else {\n\t\t\tconst { webContentsId } = (id as WebviewWebContentsId);\n\t\t\tcontents = webContents.fromId(webContentsId);\n\t\t\tif (!contents) {\n\t\t\t\tthrow new Error(`Invalid webContentsId: ${webContentsId}`);\n\t\t\t}\n\t\t}\n\n\t\tif (!contents.isDestroyed()) {\n\t\t\tcontents.setIgnoreMenuShortcuts(enabled);\n\t\t}\n\t}\n\n\tpublic async findInFrame(windowId: WebviewWindowId, frameName: string, text: string, options: { findNext?: boolean; forward?: boolean }): Promise<void> {\n\t\tconst initialFrame = this.getFrameByName(windowId, frameName);\n\n\t\ttype WebFrameMainWithFindSupport = WebFrameMain & {\n\t\t\tfindInFrame?(text: string, findOptions: FindInFrameOptions): void;\n\t\t\ton(event: 'found-in-frame', listener: Function): WebFrameMain;\n\t\t\tremoveListener(event: 'found-in-frame', listener: Function): WebFrameMain;\n\t\t};\n\t\tconst frame = initialFrame as unknown as WebFrameMainWithFindSupport;\n\t\tif (typeof frame.findInFrame === 'function') {\n\t\t\tframe.findInFrame(text, {\n\t\t\t\tfindNext: options.findNext,\n\t\t\t\tforward: options.forward,\n\t\t\t});\n\t\t\tconst foundInFrameHandler = (_: unknown, result: FoundInFrameResult) => {\n\t\t\t\tif (result.finalUpdate) {\n\t\t\t\t\tthis._onFoundInFrame.fire(result);\n\t\t\t\t\tframe.removeListener('found-in-frame', foundInFrameHandler);\n\t\t\t\t}\n\t\t\t};\n\t\t\tframe.on('found-in-frame', foundInFrameHandler);\n\t\t}\n\t}\n\n\tpublic async stopFindInFrame(windowId: WebviewWindowId, frameName: string, options: { keepSelection?: boolean }): Promise<void> {\n\t\tconst initialFrame = this.getFrameByName(windowId, frameName);\n\n\t\ttype WebFrameMainWithFindSupport = WebFrameMain & {\n\t\t\tstopFindInFrame?(stopOption: 'keepSelection' | 'clearSelection'): void;\n\t\t};\n\n\t\tconst frame = initialFrame as unknown as WebFrameMainWithFindSupport;\n\t\tif (typeof frame.stopFindInFrame === 'function') {\n\t\t\tframe.stopFindInFrame(options.keepSelection ? 'keepSelection' : 'clearSelection');\n\t\t}\n\t}\n\n\tprivate getFrameByName(windowId: WebviewWindowId, frameName: string): WebFrameMain {\n\t\tconst window = this.windowsMainService.getWindowById(windowId.windowId);\n\t\tif (!window?.win) {\n\t\t\tthrow new Error(`Invalid windowId: ${windowId}`);\n\t\t}\n\t\tconst frame = window.win.webContents.mainFrame.framesInSubtree.find(frame => {\n\t\t\treturn frame.name === frameName;\n\t\t});\n\t\tif (!frame) {\n\t\t\tthrow new Error(`Unknown frame: ${frameName}`);\n\t\t}\n\t\treturn frame;\n\t}\n}\n"]}