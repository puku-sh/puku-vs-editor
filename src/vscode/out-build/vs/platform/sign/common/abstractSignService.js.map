{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/sign/common/abstractSignService.ts","vs/platform/sign/common/abstractSignService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAchG,MAAM,OAAgB,mBAAmB;IAAzC;QAIkB,eAAU,GAAG,IAAI,GAAG,EAA0B,CAAC;IAkDjE,CAAC;aAnDe,YAAO,GAAG,CAAH,AAAI,CAAC;IAMpB,KAAK,CAAC,gBAAgB,CAAC,KAAa;QAC1C,IAAI,CAAC;YACJ,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,EAAE,CAAC;YAC5C,IAAI,SAAS,EAAE,CAAC;gBACf,MAAM,EAAE,GAAG,MAAM,CAAC,mBAAmB,CAAC,OAAO,EAAE,CAAC,CAAC;gBACjD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;gBACnC,OAAO;oBACN,EAAE,EAAE,EAAE;oBACN,IAAI,EAAE,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC;iBACvC,CAAC;YACH,CAAC;QACF,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,yBAAyB;QAC1B,CAAC;QACD,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;IAChC,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,OAAiB,EAAE,KAAa;QAC9C,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC;YACjB,OAAO,IAAI,CAAC;QACb,CAAC;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAClD,IAAI,CAAC,SAAS,EAAE,CAAC;YAChB,OAAO,KAAK,CAAC;QACd,CAAC;QACD,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACnC,IAAI,CAAC;YACJ,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,CAAC;QAC7C,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,yBAAyB;YACzB,OAAO,KAAK,CAAC;QACd,CAAC;gBAAS,CAAC;YACV,SAAS,CAAC,OAAO,EAAE,EAAE,CAAC;QACvB,CAAC;IACF,CAAC;IAED,KAAK,CAAC,IAAI,CAAC,KAAa;QACvB,IAAI,CAAC;YACJ,OAAO,MAAM,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACpC,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,yBAAyB;QAC1B,CAAC;QACD,OAAO,KAAK,CAAC;IACd,CAAC","file":"abstractSignService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMessage, ISignService } from './sign.js';\n\nexport interface IVsdaSigner {\n\tsign(arg: string): string;\n}\n\nexport interface IVsdaValidator {\n\tcreateNewMessage(arg: string): string;\n\tvalidate(arg: string): 'ok' | 'error';\n\tdispose?(): void;\n}\n\nexport abstract class AbstractSignService implements ISignService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static _nextId = 1;\n\tprivate readonly validators = new Map<string, IVsdaValidator>();\n\n\tprotected abstract getValidator(): Promise<IVsdaValidator>;\n\tprotected abstract signValue(arg: string): Promise<string>;\n\n\tpublic async createNewMessage(value: string): Promise<IMessage> {\n\t\ttry {\n\t\t\tconst validator = await this.getValidator();\n\t\t\tif (validator) {\n\t\t\t\tconst id = String(AbstractSignService._nextId++);\n\t\t\t\tthis.validators.set(id, validator);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tdata: validator.createNewMessage(value)\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn { id: '', data: value };\n\t}\n\n\tasync validate(message: IMessage, value: string): Promise<boolean> {\n\t\tif (!message.id) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst validator = this.validators.get(message.id);\n\t\tif (!validator) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.validators.delete(message.id);\n\t\ttry {\n\t\t\treturn (validator.validate(value) === 'ok');\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tvalidator.dispose?.();\n\t\t}\n\t}\n\n\tasync sign(value: string): Promise<string> {\n\t\ttry {\n\t\t\treturn await this.signValue(value);\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn value;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMessage, ISignService } from './sign.js';\n\nexport interface IVsdaSigner {\n\tsign(arg: string): string;\n}\n\nexport interface IVsdaValidator {\n\tcreateNewMessage(arg: string): string;\n\tvalidate(arg: string): 'ok' | 'error';\n\tdispose?(): void;\n}\n\nexport abstract class AbstractSignService implements ISignService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static _nextId = 1;\n\tprivate readonly validators = new Map<string, IVsdaValidator>();\n\n\tprotected abstract getValidator(): Promise<IVsdaValidator>;\n\tprotected abstract signValue(arg: string): Promise<string>;\n\n\tpublic async createNewMessage(value: string): Promise<IMessage> {\n\t\ttry {\n\t\t\tconst validator = await this.getValidator();\n\t\t\tif (validator) {\n\t\t\t\tconst id = String(AbstractSignService._nextId++);\n\t\t\t\tthis.validators.set(id, validator);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tdata: validator.createNewMessage(value)\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn { id: '', data: value };\n\t}\n\n\tasync validate(message: IMessage, value: string): Promise<boolean> {\n\t\tif (!message.id) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst validator = this.validators.get(message.id);\n\t\tif (!validator) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.validators.delete(message.id);\n\t\ttry {\n\t\t\treturn (validator.validate(value) === 'ok');\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tvalidator.dispose?.();\n\t\t}\n\t}\n\n\tasync sign(value: string): Promise<string> {\n\t\ttry {\n\t\t\treturn await this.signValue(value);\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn value;\n\t}\n}\n"]}