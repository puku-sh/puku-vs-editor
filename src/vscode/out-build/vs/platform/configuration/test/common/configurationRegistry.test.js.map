{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/configuration/test/common/configurationRegistry.test.ts","vs/platform/configuration/test/common/configurationRegistry.test.ts"],"names":[],"mappings":"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","file":"configurationRegistry.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { Extensions as ConfigurationExtensions, IConfigurationRegistry } from '../../common/configurationRegistry.js';\nimport { Registry } from '../../../registry/common/platform.js';\nimport { PolicyCategory } from '../../../../base/common/policy.js';\n\nsuite('ConfigurationRegistry', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst configurationRegistry = Registry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration);\n\n\tsetup(() => reset());\n\tteardown(() => reset());\n\n\tfunction reset() {\n\t\tconfigurationRegistry.deregisterConfigurations(configurationRegistry.getConfigurations());\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(configurationRegistry.getRegisteredDefaultConfigurations());\n\t}\n\n\ttest('configuration override', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { a: 2, c: 3 });\n\t});\n\n\ttest('configuration override defaults - prevent overriding default value', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config.preventDefaultValueOverride': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tdefault: { a: 0 },\n\t\t\t\t\t'disallowConfigurationDefault': true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config.preventDefaultValueOverride': { a: 1, b: 2 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config.preventDefaultValueOverride'].default, { a: 0 });\n\t});\n\n\ttest('configuration override defaults - merges defaults', async () => {\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { a: 2, b: 2, c: 3 });\n\t});\n\n\ttest('configuration defaults - merge object default overrides', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\t});\n\n\ttest('registering multiple settings with same policy', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'policy1': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tpolicy: {\n\t\t\t\t\t\tname: 'policy',\n\t\t\t\t\t\tcategory: PolicyCategory.Extensions,\n\t\t\t\t\t\tminimumVersion: '1.0.0',\n\t\t\t\t\t\tlocalization: { description: { key: '', value: '' }, }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'policy2': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tpolicy: {\n\t\t\t\t\t\tname: 'policy',\n\t\t\t\t\t\tcategory: PolicyCategory.Extensions,\n\t\t\t\t\t\tminimumVersion: '1.0.0',\n\t\t\t\t\t\tlocalization: { description: { key: '', value: '' }, }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst actual = configurationRegistry.getConfigurationProperties();\n\t\tassert.ok(actual['policy1'] !== undefined);\n\t\tassert.ok(actual['policy2'] === undefined);\n\t});\n\n\ttest('configuration defaults - deregister merged object default override', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { 'config': { a: 1, b: 2 } }, source: { id: 'source1', displayName: 'source1' } }];\n\t\tconst overrides2 = [{ overrides: { 'config': { a: 2, c: 3 } }, source: { id: 'source2', displayName: 'source2' } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, {});\n\t});\n\n\ttest('configuration defaults - deregister merged object default override without source', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { 'config': { a: 1, b: 2 } } }];\n\t\tconst overrides2 = [{ overrides: { 'config': { a: 2, c: 3 } } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, {});\n\t});\n\n\ttest('configuration defaults - deregister merged object default language overrides', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { '[lang]': { 'config': { a: 1, b: 2 } } }, source: { id: 'source1', displayName: 'source1' } }];\n\t\tconst overrides2 = [{ overrides: { '[lang]': { 'config': { a: 2, c: 3 } } }, source: { id: 'source2', displayName: 'source2' } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { 'config': { a: 2, b: 2, c: 3 } });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { 'config': { a: 1, b: 2 } });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'], undefined);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { Extensions as ConfigurationExtensions, IConfigurationRegistry } from '../../common/configurationRegistry.js';\nimport { Registry } from '../../../registry/common/platform.js';\nimport { PolicyCategory } from '../../../../base/common/policy.js';\n\nsuite('ConfigurationRegistry', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst configurationRegistry = Registry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration);\n\n\tsetup(() => reset());\n\tteardown(() => reset());\n\n\tfunction reset() {\n\t\tconfigurationRegistry.deregisterConfigurations(configurationRegistry.getConfigurations());\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(configurationRegistry.getRegisteredDefaultConfigurations());\n\t}\n\n\ttest('configuration override', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { a: 2, c: 3 });\n\t});\n\n\ttest('configuration override defaults - prevent overriding default value', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config.preventDefaultValueOverride': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tdefault: { a: 0 },\n\t\t\t\t\t'disallowConfigurationDefault': true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config.preventDefaultValueOverride': { a: 1, b: 2 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config.preventDefaultValueOverride'].default, { a: 0 });\n\t});\n\n\ttest('configuration override defaults - merges defaults', async () => {\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { '[lang]': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { a: 2, b: 2, c: 3 });\n\t});\n\n\ttest('configuration defaults - merge object default overrides', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 1, b: 2 } } }]);\n\t\tconfigurationRegistry.registerDefaultConfigurations([{ overrides: { 'config': { a: 2, c: 3 } } }]);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\t});\n\n\ttest('registering multiple settings with same policy', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'policy1': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tpolicy: {\n\t\t\t\t\t\tname: 'policy',\n\t\t\t\t\t\tcategory: PolicyCategory.Extensions,\n\t\t\t\t\t\tminimumVersion: '1.0.0',\n\t\t\t\t\t\tlocalization: { description: { key: '', value: '' }, }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'policy2': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t\tpolicy: {\n\t\t\t\t\t\tname: 'policy',\n\t\t\t\t\t\tcategory: PolicyCategory.Extensions,\n\t\t\t\t\t\tminimumVersion: '1.0.0',\n\t\t\t\t\t\tlocalization: { description: { key: '', value: '' }, }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst actual = configurationRegistry.getConfigurationProperties();\n\t\tassert.ok(actual['policy1'] !== undefined);\n\t\tassert.ok(actual['policy2'] === undefined);\n\t});\n\n\ttest('configuration defaults - deregister merged object default override', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { 'config': { a: 1, b: 2 } }, source: { id: 'source1', displayName: 'source1' } }];\n\t\tconst overrides2 = [{ overrides: { 'config': { a: 2, c: 3 } }, source: { id: 'source2', displayName: 'source2' } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, {});\n\t});\n\n\ttest('configuration defaults - deregister merged object default override without source', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { 'config': { a: 1, b: 2 } } }];\n\t\tconst overrides2 = [{ overrides: { 'config': { a: 2, c: 3 } } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 2, b: 2, c: 3 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, { a: 1, b: 2 });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['config'].default, {});\n\t});\n\n\ttest('configuration defaults - deregister merged object default language overrides', async () => {\n\t\tconfigurationRegistry.registerConfiguration({\n\t\t\t'id': '_test_default',\n\t\t\t'type': 'object',\n\t\t\t'properties': {\n\t\t\t\t'config': {\n\t\t\t\t\t'type': 'object',\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst overrides1 = [{ overrides: { '[lang]': { 'config': { a: 1, b: 2 } } }, source: { id: 'source1', displayName: 'source1' } }];\n\t\tconst overrides2 = [{ overrides: { '[lang]': { 'config': { a: 2, c: 3 } } }, source: { id: 'source2', displayName: 'source2' } }];\n\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides1);\n\t\tconfigurationRegistry.registerDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { 'config': { a: 2, b: 2, c: 3 } });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides2);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'].default, { 'config': { a: 1, b: 2 } });\n\n\t\tconfigurationRegistry.deregisterDefaultConfigurations(overrides1);\n\n\t\tassert.deepStrictEqual(configurationRegistry.getConfigurationProperties()['[lang]'], undefined);\n\t});\n});\n"]}