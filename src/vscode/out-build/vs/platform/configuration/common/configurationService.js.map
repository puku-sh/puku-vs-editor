{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/configuration/common/configurationService.ts","vs/platform/configuration/common/configurationService.ts"],"names":[],"mappings":"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","file":"configurationService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct, equals as arrayEquals } from '../../../base/common/arrays.js';\nimport { Queue, RunOnceScheduler } from '../../../base/common/async.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { JSONPath, ParseError, parse } from '../../../base/common/json.js';\nimport { applyEdits, setProperty } from '../../../base/common/jsonEdit.js';\nimport { Edit, FormattingOptions } from '../../../base/common/jsonFormatter.js';\nimport { Disposable, IDisposable } from '../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { equals } from '../../../base/common/objects.js';\nimport { OS, OperatingSystem } from '../../../base/common/platform.js';\nimport { extUriBiasedIgnorePathCase } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ConfigurationTarget, IConfigurationChange, IConfigurationChangeEvent, IConfigurationData, IConfigurationOverrides, IConfigurationService, IConfigurationUpdateOptions, IConfigurationUpdateOverrides, IConfigurationValue, isConfigurationOverrides, isConfigurationUpdateOverrides } from './configuration.js';\nimport { Configuration, ConfigurationChangeEvent, ConfigurationModel, UserSettings } from './configurationModels.js';\nimport { keyFromOverrideIdentifiers } from './configurationRegistry.js';\nimport { DefaultConfiguration, IPolicyConfiguration, NullPolicyConfiguration, PolicyConfiguration } from './configurations.js';\nimport { FileOperationError, FileOperationResult, IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IPolicyService, NullPolicyService } from '../../policy/common/policy.js';\n\nexport class ConfigurationService extends Disposable implements IConfigurationService, IDisposable {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate configuration: Configuration;\n\tprivate readonly defaultConfiguration: DefaultConfiguration;\n\tprivate readonly policyConfiguration: IPolicyConfiguration;\n\tprivate readonly userConfiguration: UserSettings;\n\tprivate readonly reloadConfigurationScheduler: RunOnceScheduler;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<IConfigurationChangeEvent> = this._register(new Emitter<IConfigurationChangeEvent>());\n\treadonly onDidChangeConfiguration: Event<IConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tprivate readonly configurationEditing: ConfigurationEditing;\n\n\tconstructor(\n\t\tprivate readonly settingsResource: URI,\n\t\tfileService: IFileService,\n\t\tpolicyService: IPolicyService,\n\t\tprivate readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\t\tthis.defaultConfiguration = this._register(new DefaultConfiguration(logService));\n\t\tthis.policyConfiguration = policyService instanceof NullPolicyService ? new NullPolicyConfiguration() : this._register(new PolicyConfiguration(this.defaultConfiguration, policyService, logService));\n\t\tthis.userConfiguration = this._register(new UserSettings(this.settingsResource, {}, extUriBiasedIgnorePathCase, fileService, logService));\n\t\tthis.configuration = new Configuration(\n\t\t\tthis.defaultConfiguration.configurationModel,\n\t\t\tthis.policyConfiguration.configurationModel,\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tlogService\n\t\t);\n\t\tthis.configurationEditing = new ConfigurationEditing(settingsResource, fileService, this);\n\n\t\tthis.reloadConfigurationScheduler = this._register(new RunOnceScheduler(() => this.reloadConfiguration(), 50));\n\t\tthis._register(this.defaultConfiguration.onDidChangeConfiguration(({ defaults, properties }) => this.onDidDefaultConfigurationChange(defaults, properties)));\n\t\tthis._register(this.policyConfiguration.onDidChangeConfiguration(model => this.onDidPolicyConfigurationChange(model)));\n\t\tthis._register(this.userConfiguration.onDidChange(() => this.reloadConfigurationScheduler.schedule()));\n\t}\n\n\tasync initialize(): Promise<void> {\n\t\tconst [defaultModel, policyModel, userModel] = await Promise.all([this.defaultConfiguration.initialize(), this.policyConfiguration.initialize(), this.userConfiguration.loadConfiguration()]);\n\t\tthis.configuration = new Configuration(\n\t\t\tdefaultModel,\n\t\t\tpolicyModel,\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tuserModel,\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tthis.logService\n\t\t);\n\t}\n\n\tgetConfigurationData(): IConfigurationData {\n\t\treturn this.configuration.toData();\n\t}\n\n\tgetValue<T>(): T;\n\tgetValue<T>(section: string): T;\n\tgetValue<T>(overrides: IConfigurationOverrides): T;\n\tgetValue<T>(section: string, overrides: IConfigurationOverrides): T;\n\tgetValue(arg1?: unknown, arg2?: unknown): unknown {\n\t\tconst section = typeof arg1 === 'string' ? arg1 : undefined;\n\t\tconst overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\n\t\treturn this.configuration.getValue(section, overrides, undefined);\n\t}\n\n\tupdateValue(key: string, value: unknown): Promise<void>;\n\tupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides): Promise<void>;\n\tupdateValue(key: string, value: unknown, target: ConfigurationTarget): Promise<void>;\n\tupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides, target: ConfigurationTarget, options?: IConfigurationUpdateOptions): Promise<void>;\n\tasync updateValue(key: string, value: unknown, arg3?: unknown, arg4?: unknown, options?: IConfigurationUpdateOptions): Promise<void> {\n\t\tconst overrides: IConfigurationUpdateOverrides | undefined = isConfigurationUpdateOverrides(arg3) ? arg3\n\t\t\t: isConfigurationOverrides(arg3) ? { resource: arg3.resource, overrideIdentifiers: arg3.overrideIdentifier ? [arg3.overrideIdentifier] : undefined } : undefined;\n\n\t\tconst target: ConfigurationTarget | undefined = (overrides ? arg4 : arg3) as ConfigurationTarget | undefined;\n\t\tif (target !== undefined) {\n\t\t\tif (target !== ConfigurationTarget.USER_LOCAL && target !== ConfigurationTarget.USER) {\n\t\t\t\tthrow new Error(`Unable to write ${key} to target ${target}.`);\n\t\t\t}\n\t\t}\n\n\t\tif (overrides?.overrideIdentifiers) {\n\t\t\toverrides.overrideIdentifiers = distinct(overrides.overrideIdentifiers);\n\t\t\toverrides.overrideIdentifiers = overrides.overrideIdentifiers.length ? overrides.overrideIdentifiers : undefined;\n\t\t}\n\n\t\tconst inspect = this.inspect(key, { resource: overrides?.resource, overrideIdentifier: overrides?.overrideIdentifiers ? overrides.overrideIdentifiers[0] : undefined });\n\t\tif (inspect.policyValue !== undefined) {\n\t\t\tthrow new Error(`Unable to write ${key} because it is configured in system policy.`);\n\t\t}\n\n\t\t// Remove the setting, if the value is same as default value\n\t\tif (equals(value, inspect.defaultValue)) {\n\t\t\tvalue = undefined;\n\t\t}\n\n\t\tif (overrides?.overrideIdentifiers?.length && overrides.overrideIdentifiers.length > 1) {\n\t\t\tconst overrideIdentifiers = overrides.overrideIdentifiers.sort();\n\t\t\tconst existingOverrides = this.configuration.localUserConfiguration.overrides.find(override => arrayEquals([...override.identifiers].sort(), overrideIdentifiers));\n\t\t\tif (existingOverrides) {\n\t\t\t\toverrides.overrideIdentifiers = existingOverrides.identifiers;\n\t\t\t}\n\t\t}\n\n\t\tconst path = overrides?.overrideIdentifiers?.length ? [keyFromOverrideIdentifiers(overrides.overrideIdentifiers), key] : [key];\n\n\t\tawait this.configurationEditing.write(path, value);\n\t\tawait this.reloadConfiguration();\n\t}\n\n\tinspect<T>(key: string, overrides: IConfigurationOverrides = {}): IConfigurationValue<T> {\n\t\treturn this.configuration.inspect<T>(key, overrides, undefined);\n\t}\n\n\tkeys(): {\n\t\tdefault: string[];\n\t\tpolicy: string[];\n\t\tuser: string[];\n\t\tworkspace: string[];\n\t\tworkspaceFolder: string[];\n\t} {\n\t\treturn this.configuration.keys(undefined);\n\t}\n\n\tasync reloadConfiguration(): Promise<void> {\n\t\tconst configurationModel = await this.userConfiguration.loadConfiguration();\n\t\tthis.onDidChangeUserConfiguration(configurationModel);\n\t}\n\n\tprivate onDidChangeUserConfiguration(userConfigurationModel: ConfigurationModel): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdateLocalUserConfiguration(userConfigurationModel);\n\t\tthis.trigger(change, previous, ConfigurationTarget.USER);\n\t}\n\n\tprivate onDidDefaultConfigurationChange(defaultConfigurationModel: ConfigurationModel, properties: string[]): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdateDefaultConfiguration(defaultConfigurationModel, properties);\n\t\tthis.trigger(change, previous, ConfigurationTarget.DEFAULT);\n\t}\n\n\tprivate onDidPolicyConfigurationChange(policyConfiguration: ConfigurationModel): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdatePolicyConfiguration(policyConfiguration);\n\t\tthis.trigger(change, previous, ConfigurationTarget.DEFAULT);\n\t}\n\n\tprivate trigger(configurationChange: IConfigurationChange, previous: IConfigurationData, source: ConfigurationTarget): void {\n\t\tconst event = new ConfigurationChangeEvent(configurationChange, { data: previous }, this.configuration, undefined, this.logService);\n\t\tevent.source = source;\n\t\tthis._onDidChangeConfiguration.fire(event);\n\t}\n}\n\nclass ConfigurationEditing {\n\n\tprivate readonly queue: Queue<void>;\n\n\tconstructor(\n\t\tprivate readonly settingsResource: URI,\n\t\tprivate readonly fileService: IFileService,\n\t\tprivate readonly configurationService: IConfigurationService,\n\t) {\n\t\tthis.queue = new Queue<void>();\n\t}\n\n\twrite(path: JSONPath, value: unknown): Promise<void> {\n\t\treturn this.queue.queue(() => this.doWriteConfiguration(path, value)); // queue up writes to prevent race conditions\n\t}\n\n\tprivate async doWriteConfiguration(path: JSONPath, value: unknown): Promise<void> {\n\t\tlet content: string;\n\t\ttry {\n\t\t\tconst fileContent = await this.fileService.readFile(this.settingsResource);\n\t\t\tcontent = fileContent.value.toString();\n\t\t} catch (error) {\n\t\t\tif ((<FileOperationError>error).fileOperationResult === FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tcontent = '{}';\n\t\t\t} else {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t\tconst parseErrors: ParseError[] = [];\n\t\tparse(content, parseErrors, { allowTrailingComma: true, allowEmptyContent: true });\n\t\tif (parseErrors.length > 0) {\n\t\t\tthrow new Error('Unable to write into the settings file. Please open the file to correct errors/warnings in the file and try again.');\n\t\t}\n\n\t\tconst edits = this.getEdits(content, path, value);\n\t\tcontent = applyEdits(content, edits);\n\n\t\tawait this.fileService.writeFile(this.settingsResource, VSBuffer.fromString(content));\n\t}\n\n\tprivate getEdits(content: string, path: JSONPath, value: unknown): Edit[] {\n\t\tconst { tabSize, insertSpaces, eol } = this.formattingOptions;\n\n\t\t// With empty path the entire file is being replaced, so we just use JSON.stringify\n\t\tif (!path.length) {\n\t\t\tconst content = JSON.stringify(value, null, insertSpaces ? ' '.repeat(tabSize) : '\\t');\n\t\t\treturn [{\n\t\t\t\tcontent,\n\t\t\t\tlength: content.length,\n\t\t\t\toffset: 0\n\t\t\t}];\n\t\t}\n\n\t\treturn setProperty(content, path, value, { tabSize, insertSpaces, eol });\n\t}\n\n\tprivate _formattingOptions: Required<FormattingOptions> | undefined;\n\tprivate get formattingOptions(): Required<FormattingOptions> {\n\t\tif (!this._formattingOptions) {\n\t\t\tlet eol = OS === OperatingSystem.Linux || OS === OperatingSystem.Macintosh ? '\\n' : '\\r\\n';\n\t\t\tconst configuredEol = this.configurationService.getValue('files.eol', { overrideIdentifier: 'jsonc' });\n\t\t\tif (configuredEol && typeof configuredEol === 'string' && configuredEol !== 'auto') {\n\t\t\t\teol = configuredEol;\n\t\t\t}\n\t\t\tthis._formattingOptions = {\n\t\t\t\teol,\n\t\t\t\tinsertSpaces: !!this.configurationService.getValue('editor.insertSpaces', { overrideIdentifier: 'jsonc' }),\n\t\t\t\ttabSize: this.configurationService.getValue('editor.tabSize', { overrideIdentifier: 'jsonc' })\n\t\t\t};\n\t\t}\n\t\treturn this._formattingOptions;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct, equals as arrayEquals } from '../../../base/common/arrays.js';\nimport { Queue, RunOnceScheduler } from '../../../base/common/async.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { JSONPath, ParseError, parse } from '../../../base/common/json.js';\nimport { applyEdits, setProperty } from '../../../base/common/jsonEdit.js';\nimport { Edit, FormattingOptions } from '../../../base/common/jsonFormatter.js';\nimport { Disposable, IDisposable } from '../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { equals } from '../../../base/common/objects.js';\nimport { OS, OperatingSystem } from '../../../base/common/platform.js';\nimport { extUriBiasedIgnorePathCase } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ConfigurationTarget, IConfigurationChange, IConfigurationChangeEvent, IConfigurationData, IConfigurationOverrides, IConfigurationService, IConfigurationUpdateOptions, IConfigurationUpdateOverrides, IConfigurationValue, isConfigurationOverrides, isConfigurationUpdateOverrides } from './configuration.js';\nimport { Configuration, ConfigurationChangeEvent, ConfigurationModel, UserSettings } from './configurationModels.js';\nimport { keyFromOverrideIdentifiers } from './configurationRegistry.js';\nimport { DefaultConfiguration, IPolicyConfiguration, NullPolicyConfiguration, PolicyConfiguration } from './configurations.js';\nimport { FileOperationError, FileOperationResult, IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IPolicyService, NullPolicyService } from '../../policy/common/policy.js';\n\nexport class ConfigurationService extends Disposable implements IConfigurationService, IDisposable {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate configuration: Configuration;\n\tprivate readonly defaultConfiguration: DefaultConfiguration;\n\tprivate readonly policyConfiguration: IPolicyConfiguration;\n\tprivate readonly userConfiguration: UserSettings;\n\tprivate readonly reloadConfigurationScheduler: RunOnceScheduler;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<IConfigurationChangeEvent> = this._register(new Emitter<IConfigurationChangeEvent>());\n\treadonly onDidChangeConfiguration: Event<IConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tprivate readonly configurationEditing: ConfigurationEditing;\n\n\tconstructor(\n\t\tprivate readonly settingsResource: URI,\n\t\tfileService: IFileService,\n\t\tpolicyService: IPolicyService,\n\t\tprivate readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\t\tthis.defaultConfiguration = this._register(new DefaultConfiguration(logService));\n\t\tthis.policyConfiguration = policyService instanceof NullPolicyService ? new NullPolicyConfiguration() : this._register(new PolicyConfiguration(this.defaultConfiguration, policyService, logService));\n\t\tthis.userConfiguration = this._register(new UserSettings(this.settingsResource, {}, extUriBiasedIgnorePathCase, fileService, logService));\n\t\tthis.configuration = new Configuration(\n\t\t\tthis.defaultConfiguration.configurationModel,\n\t\t\tthis.policyConfiguration.configurationModel,\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tConfigurationModel.createEmptyModel(logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tlogService\n\t\t);\n\t\tthis.configurationEditing = new ConfigurationEditing(settingsResource, fileService, this);\n\n\t\tthis.reloadConfigurationScheduler = this._register(new RunOnceScheduler(() => this.reloadConfiguration(), 50));\n\t\tthis._register(this.defaultConfiguration.onDidChangeConfiguration(({ defaults, properties }) => this.onDidDefaultConfigurationChange(defaults, properties)));\n\t\tthis._register(this.policyConfiguration.onDidChangeConfiguration(model => this.onDidPolicyConfigurationChange(model)));\n\t\tthis._register(this.userConfiguration.onDidChange(() => this.reloadConfigurationScheduler.schedule()));\n\t}\n\n\tasync initialize(): Promise<void> {\n\t\tconst [defaultModel, policyModel, userModel] = await Promise.all([this.defaultConfiguration.initialize(), this.policyConfiguration.initialize(), this.userConfiguration.loadConfiguration()]);\n\t\tthis.configuration = new Configuration(\n\t\t\tdefaultModel,\n\t\t\tpolicyModel,\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tuserModel,\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tConfigurationModel.createEmptyModel(this.logService),\n\t\t\tnew ResourceMap<ConfigurationModel>(),\n\t\t\tthis.logService\n\t\t);\n\t}\n\n\tgetConfigurationData(): IConfigurationData {\n\t\treturn this.configuration.toData();\n\t}\n\n\tgetValue<T>(): T;\n\tgetValue<T>(section: string): T;\n\tgetValue<T>(overrides: IConfigurationOverrides): T;\n\tgetValue<T>(section: string, overrides: IConfigurationOverrides): T;\n\tgetValue(arg1?: unknown, arg2?: unknown): unknown {\n\t\tconst section = typeof arg1 === 'string' ? arg1 : undefined;\n\t\tconst overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\n\t\treturn this.configuration.getValue(section, overrides, undefined);\n\t}\n\n\tupdateValue(key: string, value: unknown): Promise<void>;\n\tupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides): Promise<void>;\n\tupdateValue(key: string, value: unknown, target: ConfigurationTarget): Promise<void>;\n\tupdateValue(key: string, value: unknown, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides, target: ConfigurationTarget, options?: IConfigurationUpdateOptions): Promise<void>;\n\tasync updateValue(key: string, value: unknown, arg3?: unknown, arg4?: unknown, options?: IConfigurationUpdateOptions): Promise<void> {\n\t\tconst overrides: IConfigurationUpdateOverrides | undefined = isConfigurationUpdateOverrides(arg3) ? arg3\n\t\t\t: isConfigurationOverrides(arg3) ? { resource: arg3.resource, overrideIdentifiers: arg3.overrideIdentifier ? [arg3.overrideIdentifier] : undefined } : undefined;\n\n\t\tconst target: ConfigurationTarget | undefined = (overrides ? arg4 : arg3) as ConfigurationTarget | undefined;\n\t\tif (target !== undefined) {\n\t\t\tif (target !== ConfigurationTarget.USER_LOCAL && target !== ConfigurationTarget.USER) {\n\t\t\t\tthrow new Error(`Unable to write ${key} to target ${target}.`);\n\t\t\t}\n\t\t}\n\n\t\tif (overrides?.overrideIdentifiers) {\n\t\t\toverrides.overrideIdentifiers = distinct(overrides.overrideIdentifiers);\n\t\t\toverrides.overrideIdentifiers = overrides.overrideIdentifiers.length ? overrides.overrideIdentifiers : undefined;\n\t\t}\n\n\t\tconst inspect = this.inspect(key, { resource: overrides?.resource, overrideIdentifier: overrides?.overrideIdentifiers ? overrides.overrideIdentifiers[0] : undefined });\n\t\tif (inspect.policyValue !== undefined) {\n\t\t\tthrow new Error(`Unable to write ${key} because it is configured in system policy.`);\n\t\t}\n\n\t\t// Remove the setting, if the value is same as default value\n\t\tif (equals(value, inspect.defaultValue)) {\n\t\t\tvalue = undefined;\n\t\t}\n\n\t\tif (overrides?.overrideIdentifiers?.length && overrides.overrideIdentifiers.length > 1) {\n\t\t\tconst overrideIdentifiers = overrides.overrideIdentifiers.sort();\n\t\t\tconst existingOverrides = this.configuration.localUserConfiguration.overrides.find(override => arrayEquals([...override.identifiers].sort(), overrideIdentifiers));\n\t\t\tif (existingOverrides) {\n\t\t\t\toverrides.overrideIdentifiers = existingOverrides.identifiers;\n\t\t\t}\n\t\t}\n\n\t\tconst path = overrides?.overrideIdentifiers?.length ? [keyFromOverrideIdentifiers(overrides.overrideIdentifiers), key] : [key];\n\n\t\tawait this.configurationEditing.write(path, value);\n\t\tawait this.reloadConfiguration();\n\t}\n\n\tinspect<T>(key: string, overrides: IConfigurationOverrides = {}): IConfigurationValue<T> {\n\t\treturn this.configuration.inspect<T>(key, overrides, undefined);\n\t}\n\n\tkeys(): {\n\t\tdefault: string[];\n\t\tpolicy: string[];\n\t\tuser: string[];\n\t\tworkspace: string[];\n\t\tworkspaceFolder: string[];\n\t} {\n\t\treturn this.configuration.keys(undefined);\n\t}\n\n\tasync reloadConfiguration(): Promise<void> {\n\t\tconst configurationModel = await this.userConfiguration.loadConfiguration();\n\t\tthis.onDidChangeUserConfiguration(configurationModel);\n\t}\n\n\tprivate onDidChangeUserConfiguration(userConfigurationModel: ConfigurationModel): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdateLocalUserConfiguration(userConfigurationModel);\n\t\tthis.trigger(change, previous, ConfigurationTarget.USER);\n\t}\n\n\tprivate onDidDefaultConfigurationChange(defaultConfigurationModel: ConfigurationModel, properties: string[]): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdateDefaultConfiguration(defaultConfigurationModel, properties);\n\t\tthis.trigger(change, previous, ConfigurationTarget.DEFAULT);\n\t}\n\n\tprivate onDidPolicyConfigurationChange(policyConfiguration: ConfigurationModel): void {\n\t\tconst previous = this.configuration.toData();\n\t\tconst change = this.configuration.compareAndUpdatePolicyConfiguration(policyConfiguration);\n\t\tthis.trigger(change, previous, ConfigurationTarget.DEFAULT);\n\t}\n\n\tprivate trigger(configurationChange: IConfigurationChange, previous: IConfigurationData, source: ConfigurationTarget): void {\n\t\tconst event = new ConfigurationChangeEvent(configurationChange, { data: previous }, this.configuration, undefined, this.logService);\n\t\tevent.source = source;\n\t\tthis._onDidChangeConfiguration.fire(event);\n\t}\n}\n\nclass ConfigurationEditing {\n\n\tprivate readonly queue: Queue<void>;\n\n\tconstructor(\n\t\tprivate readonly settingsResource: URI,\n\t\tprivate readonly fileService: IFileService,\n\t\tprivate readonly configurationService: IConfigurationService,\n\t) {\n\t\tthis.queue = new Queue<void>();\n\t}\n\n\twrite(path: JSONPath, value: unknown): Promise<void> {\n\t\treturn this.queue.queue(() => this.doWriteConfiguration(path, value)); // queue up writes to prevent race conditions\n\t}\n\n\tprivate async doWriteConfiguration(path: JSONPath, value: unknown): Promise<void> {\n\t\tlet content: string;\n\t\ttry {\n\t\t\tconst fileContent = await this.fileService.readFile(this.settingsResource);\n\t\t\tcontent = fileContent.value.toString();\n\t\t} catch (error) {\n\t\t\tif ((<FileOperationError>error).fileOperationResult === FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tcontent = '{}';\n\t\t\t} else {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t\tconst parseErrors: ParseError[] = [];\n\t\tparse(content, parseErrors, { allowTrailingComma: true, allowEmptyContent: true });\n\t\tif (parseErrors.length > 0) {\n\t\t\tthrow new Error('Unable to write into the settings file. Please open the file to correct errors/warnings in the file and try again.');\n\t\t}\n\n\t\tconst edits = this.getEdits(content, path, value);\n\t\tcontent = applyEdits(content, edits);\n\n\t\tawait this.fileService.writeFile(this.settingsResource, VSBuffer.fromString(content));\n\t}\n\n\tprivate getEdits(content: string, path: JSONPath, value: unknown): Edit[] {\n\t\tconst { tabSize, insertSpaces, eol } = this.formattingOptions;\n\n\t\t// With empty path the entire file is being replaced, so we just use JSON.stringify\n\t\tif (!path.length) {\n\t\t\tconst content = JSON.stringify(value, null, insertSpaces ? ' '.repeat(tabSize) : '\\t');\n\t\t\treturn [{\n\t\t\t\tcontent,\n\t\t\t\tlength: content.length,\n\t\t\t\toffset: 0\n\t\t\t}];\n\t\t}\n\n\t\treturn setProperty(content, path, value, { tabSize, insertSpaces, eol });\n\t}\n\n\tprivate _formattingOptions: Required<FormattingOptions> | undefined;\n\tprivate get formattingOptions(): Required<FormattingOptions> {\n\t\tif (!this._formattingOptions) {\n\t\t\tlet eol = OS === OperatingSystem.Linux || OS === OperatingSystem.Macintosh ? '\\n' : '\\r\\n';\n\t\t\tconst configuredEol = this.configurationService.getValue('files.eol', { overrideIdentifier: 'jsonc' });\n\t\t\tif (configuredEol && typeof configuredEol === 'string' && configuredEol !== 'auto') {\n\t\t\t\teol = configuredEol;\n\t\t\t}\n\t\t\tthis._formattingOptions = {\n\t\t\t\teol,\n\t\t\t\tinsertSpaces: !!this.configurationService.getValue('editor.insertSpaces', { overrideIdentifier: 'jsonc' }),\n\t\t\t\ttabSize: this.configurationService.getValue('editor.tabSize', { overrideIdentifier: 'jsonc' })\n\t\t\t};\n\t\t}\n\t\treturn this._formattingOptions;\n\t}\n}\n"]}