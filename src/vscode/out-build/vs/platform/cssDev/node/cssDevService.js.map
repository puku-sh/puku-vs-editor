{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/cssDev/node/cssDevService.ts","vs/platform/cssDev/node/cssDevService.ts"],"names":[],"mappings":"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","file":"cssDevService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { spawn } from 'child_process';\nimport { relative } from '../../../base/common/path.js';\nimport { FileAccess } from '../../../base/common/network.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { ILogService } from '../../log/common/log.js';\n\nexport const ICSSDevelopmentService = createDecorator<ICSSDevelopmentService>('ICSSDevelopmentService');\n\nexport interface ICSSDevelopmentService {\n\t_serviceBrand: undefined;\n\tisEnabled: boolean;\n\tgetCssModules(): Promise<string[]>;\n}\n\nexport class CSSDevelopmentService implements ICSSDevelopmentService {\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate _cssModules?: Promise<string[]>;\n\n\tconstructor(\n\t\t@IEnvironmentService private readonly envService: IEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService\n\t) { }\n\n\tget isEnabled(): boolean {\n\t\treturn !this.envService.isBuilt;\n\t}\n\n\tgetCssModules(): Promise<string[]> {\n\t\tthis._cssModules ??= this.computeCssModules();\n\t\treturn this._cssModules;\n\t}\n\n\tprivate async computeCssModules(): Promise<string[]> {\n\t\tif (!this.isEnabled) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst rg = await import('@vscode/ripgrep');\n\t\treturn await new Promise<string[]>((resolve) => {\n\n\t\t\tconst sw = StopWatch.create();\n\n\t\t\tconst chunks: Buffer[] = [];\n\t\t\tconst basePath = FileAccess.asFileUri('').fsPath;\n\t\t\tconst process = spawn(rg.rgPath, ['-g', '**/*.css', '--files', '--no-ignore', basePath], {});\n\n\t\t\tprocess.stdout.on('data', data => {\n\t\t\t\tchunks.push(data);\n\t\t\t});\n\t\t\tprocess.on('error', err => {\n\t\t\t\tthis.logService.error('[CSS_DEV] FAILED to compute CSS data', err);\n\t\t\t\tresolve([]);\n\t\t\t});\n\t\t\tprocess.on('close', () => {\n\t\t\t\tconst data = Buffer.concat(chunks).toString('utf8');\n\t\t\t\tconst result = data.split('\\n').filter(Boolean).map(path => relative(basePath, path).replace(/\\\\/g, '/')).filter(Boolean).sort();\n\t\t\t\tif (result.some(path => path.indexOf('vs/') !== 0)) {\n\t\t\t\t\tthis.logService.error(`[CSS_DEV] Detected invalid paths in css modules, raw output: ${data}`);\n\t\t\t\t}\n\t\t\t\tresolve(result);\n\t\t\t\tthis.logService.info(`[CSS_DEV] DONE, ${result.length} css modules (${Math.round(sw.elapsed())}ms)`);\n\t\t\t});\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { spawn } from 'child_process';\nimport { relative } from '../../../base/common/path.js';\nimport { FileAccess } from '../../../base/common/network.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { ILogService } from '../../log/common/log.js';\n\nexport const ICSSDevelopmentService = createDecorator<ICSSDevelopmentService>('ICSSDevelopmentService');\n\nexport interface ICSSDevelopmentService {\n\t_serviceBrand: undefined;\n\tisEnabled: boolean;\n\tgetCssModules(): Promise<string[]>;\n}\n\nexport class CSSDevelopmentService implements ICSSDevelopmentService {\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate _cssModules?: Promise<string[]>;\n\n\tconstructor(\n\t\t@IEnvironmentService private readonly envService: IEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService\n\t) { }\n\n\tget isEnabled(): boolean {\n\t\treturn !this.envService.isBuilt;\n\t}\n\n\tgetCssModules(): Promise<string[]> {\n\t\tthis._cssModules ??= this.computeCssModules();\n\t\treturn this._cssModules;\n\t}\n\n\tprivate async computeCssModules(): Promise<string[]> {\n\t\tif (!this.isEnabled) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst rg = await import('@vscode/ripgrep');\n\t\treturn await new Promise<string[]>((resolve) => {\n\n\t\t\tconst sw = StopWatch.create();\n\n\t\t\tconst chunks: Buffer[] = [];\n\t\t\tconst basePath = FileAccess.asFileUri('').fsPath;\n\t\t\tconst process = spawn(rg.rgPath, ['-g', '**/*.css', '--files', '--no-ignore', basePath], {});\n\n\t\t\tprocess.stdout.on('data', data => {\n\t\t\t\tchunks.push(data);\n\t\t\t});\n\t\t\tprocess.on('error', err => {\n\t\t\t\tthis.logService.error('[CSS_DEV] FAILED to compute CSS data', err);\n\t\t\t\tresolve([]);\n\t\t\t});\n\t\t\tprocess.on('close', () => {\n\t\t\t\tconst data = Buffer.concat(chunks).toString('utf8');\n\t\t\t\tconst result = data.split('\\n').filter(Boolean).map(path => relative(basePath, path).replace(/\\\\/g, '/')).filter(Boolean).sort();\n\t\t\t\tif (result.some(path => path.indexOf('vs/') !== 0)) {\n\t\t\t\t\tthis.logService.error(`[CSS_DEV] Detected invalid paths in css modules, raw output: ${data}`);\n\t\t\t\t}\n\t\t\t\tresolve(result);\n\t\t\t\tthis.logService.info(`[CSS_DEV] DONE, ${result.length} css modules (${Math.round(sw.elapsed())}ms)`);\n\t\t\t});\n\t\t});\n\t}\n}\n"]}