{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/userDataSync/test/common/userDataSyncStoreService.test.ts","vs/platform/userDataSync/test/common/userDataSyncStoreService.test.ts"],"names":[],"mappings":"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","file":"userDataSyncStoreService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../base/common/async.js';\nimport { newWriteableBufferStream } from '../../../../base/common/buffer.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { IRequestService } from '../../../request/common/request.js';\nimport { IUserDataSyncStoreService, SyncResource, UserDataSyncErrorCode, UserDataSyncStoreError } from '../../common/userDataSync.js';\nimport { RequestsSession, UserDataSyncStoreService } from '../../common/userDataSyncStoreService.js';\nimport { UserDataSyncClient, UserDataSyncTestServer } from './userDataSyncClient.js';\n\nsuite('UserDataSyncStoreService', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('test read manifest for the first time', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\t\tconst productService = client.instantiationService.get(IProductService);\n\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Client-Name'], `${productService.applicationName}${isWeb ? '-web' : ''}`);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Client-Version'], productService.version);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test read manifest for the second time when session is not yet created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test session id header is not set in the first manifest request after session is created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test session id header is set from the second manifest request after session is created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are send for write request', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are send for read request', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.readResource(SyncResource.Settings, null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are reset after session is cleared ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.clear();\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test old headers are sent after session is changed on server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\t\tawait target.clear();\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test old headers are reset from second request after session is changed on server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\t\tawait target.clear();\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test old headers are sent after session is cleared from another server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test headers are reset after session is cleared from another server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are reset after session is cleared from another server - started syncing again', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test rate limit on server with retry after', async () => {\n\t\tconst target = new UserDataSyncTestServer(1, 1);\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\n\t\tconst promise = Event.toPromise(testObject.onDidChangeDonotMakeRequestsUntil);\n\t\ttry {\n\t\t\tawait testObject.manifest(null);\n\t\t\tassert.fail('should fail');\n\t\t} catch (e) {\n\t\t\tassert.ok(e instanceof UserDataSyncStoreError);\n\t\t\tassert.deepStrictEqual((<UserDataSyncStoreError>e).code, UserDataSyncErrorCode.TooManyRequestsAndRetryAfter);\n\t\t\tawait promise;\n\t\t\tassert.ok(!!testObject.donotMakeRequestsUntil);\n\t\t}\n\t});\n\n\ttest('test donotMakeRequestsUntil is reset after retry time is finished', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 0.25)));\n\t\t\tawait client.setUp();\n\t\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\t\tawait testObject.manifest(null);\n\t\t\ttry {\n\t\t\t\tawait testObject.manifest(null);\n\t\t\t\tassert.fail('should fail');\n\t\t\t} catch (e) { }\n\n\t\t\tconst promise = Event.toPromise(testObject.onDidChangeDonotMakeRequestsUntil);\n\t\t\tawait timeout(300);\n\t\t\tawait promise;\n\t\t\tassert.ok(!testObject.donotMakeRequestsUntil);\n\t\t});\n\t});\n\n\ttest('test donotMakeRequestsUntil is retrieved', async () => {\n\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 1)));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\ttry {\n\t\t\tawait testObject.manifest(null);\n\t\t} catch (e) { }\n\n\t\tconst target = disposableStore.add(client.instantiationService.createInstance(UserDataSyncStoreService));\n\t\tassert.strictEqual(target.donotMakeRequestsUntil?.getTime(), testObject.donotMakeRequestsUntil?.getTime());\n\t});\n\n\ttest('test donotMakeRequestsUntil is checked and reset after retreived', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 0.25)));\n\t\t\tawait client.setUp();\n\t\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\t\tawait testObject.manifest(null);\n\t\t\ttry {\n\t\t\t\tawait testObject.manifest(null);\n\t\t\t\tassert.fail('should fail');\n\t\t\t} catch (e) { }\n\n\t\t\tawait timeout(300);\n\t\t\tconst target = disposableStore.add(client.instantiationService.createInstance(UserDataSyncStoreService));\n\t\t\tassert.ok(!target.donotMakeRequestsUntil);\n\t\t});\n\t});\n\n\ttest('test read resource request handles 304', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait client.sync();\n\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\t\tconst expected = await testObject.readResource(SyncResource.Settings, null);\n\t\tconst actual = await testObject.readResource(SyncResource.Settings, expected);\n\n\t\tassert.strictEqual(actual, expected);\n\t});\n\n});\n\nsuite('UserDataSyncRequestsSession', () => {\n\n\tconst requestService: IRequestService = {\n\t\t_serviceBrand: undefined,\n\t\tasync request() { return { res: { headers: {} }, stream: newWriteableBufferStream() }; },\n\t\tasync resolveProxy() { return undefined; },\n\t\tasync lookupAuthorization() { return undefined; },\n\t\tasync lookupKerberosAuthorization() { return undefined; },\n\t\tasync loadCertificates() { return []; }\n\t};\n\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('too many requests are thrown when limit exceeded', async () => {\n\t\tconst testObject = new RequestsSession(1, 500, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\n\t\ttry {\n\t\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\t} catch (error) {\n\t\t\tassert.ok(error instanceof UserDataSyncStoreError);\n\t\t\tassert.strictEqual((<UserDataSyncStoreError>error).code, UserDataSyncErrorCode.LocalTooManyRequests);\n\t\t\treturn;\n\t\t}\n\t\tassert.fail('Should fail with limit exceeded');\n\t});\n\n\ttest('requests are handled after session is expired', () => runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst testObject = new RequestsSession(1, 100, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\tawait timeout(125);\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t}));\n\n\ttest('too many requests are thrown after session is expired', () => runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst testObject = new RequestsSession(1, 100, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\tawait timeout(125);\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\n\t\ttry {\n\t\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\t} catch (error) {\n\t\t\tassert.ok(error instanceof UserDataSyncStoreError);\n\t\t\tassert.strictEqual((<UserDataSyncStoreError>error).code, UserDataSyncErrorCode.LocalTooManyRequests);\n\t\t\treturn;\n\t\t}\n\t\tassert.fail('Should fail with limit exceeded');\n\t}));\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../base/common/async.js';\nimport { newWriteableBufferStream } from '../../../../base/common/buffer.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport { IProductService } from '../../../product/common/productService.js';\nimport { IRequestService } from '../../../request/common/request.js';\nimport { IUserDataSyncStoreService, SyncResource, UserDataSyncErrorCode, UserDataSyncStoreError } from '../../common/userDataSync.js';\nimport { RequestsSession, UserDataSyncStoreService } from '../../common/userDataSyncStoreService.js';\nimport { UserDataSyncClient, UserDataSyncTestServer } from './userDataSyncClient.js';\n\nsuite('UserDataSyncStoreService', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('test read manifest for the first time', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\t\tconst productService = client.instantiationService.get(IProductService);\n\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Client-Name'], `${productService.applicationName}${isWeb ? '-web' : ''}`);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Client-Version'], productService.version);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test read manifest for the second time when session is not yet created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test session id header is not set in the first manifest request after session is created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test session id header is set from the second manifest request after session is created', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are send for write request', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are send for read request', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\n\t\ttarget.reset();\n\t\tawait testObject.readResource(SyncResource.Settings, null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are reset after session is cleared ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.clear();\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test old headers are sent after session is changed on server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\t\tawait target.clear();\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test old headers are reset from second request after session is changed on server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\t\tawait target.clear();\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.writeResource(SyncResource.Settings, 'some content', null);\n\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test old headers are sent after session is cleared from another server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t});\n\n\ttest('test headers are reset after session is cleared from another server ', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.strictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test headers are reset after session is cleared from another server - started syncing again', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\t\tconst machineSessionId = target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'];\n\t\tconst userSessionId = target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'];\n\n\t\t// client 2\n\t\tconst client2 = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client2.setUp();\n\t\tconst testObject2 = client2.instantiationService.get(IUserDataSyncStoreService);\n\t\tawait testObject2.clear();\n\n\t\tawait testObject.manifest(null);\n\t\tawait testObject.writeResource(SyncResource.Settings, 'some content', null);\n\t\tawait testObject.manifest(null);\n\t\ttarget.reset();\n\t\tawait testObject.manifest(null);\n\n\t\tassert.strictEqual(target.requestsWithAllHeaders.length, 1);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], undefined);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-Machine-Session-Id'], machineSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], userSessionId);\n\t\tassert.notStrictEqual(target.requestsWithAllHeaders[0].headers!['X-User-Session-Id'], undefined);\n\t});\n\n\ttest('test rate limit on server with retry after', async () => {\n\t\tconst target = new UserDataSyncTestServer(1, 1);\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\n\t\tconst promise = Event.toPromise(testObject.onDidChangeDonotMakeRequestsUntil);\n\t\ttry {\n\t\t\tawait testObject.manifest(null);\n\t\t\tassert.fail('should fail');\n\t\t} catch (e) {\n\t\t\tassert.ok(e instanceof UserDataSyncStoreError);\n\t\t\tassert.deepStrictEqual((<UserDataSyncStoreError>e).code, UserDataSyncErrorCode.TooManyRequestsAndRetryAfter);\n\t\t\tawait promise;\n\t\t\tassert.ok(!!testObject.donotMakeRequestsUntil);\n\t\t}\n\t});\n\n\ttest('test donotMakeRequestsUntil is reset after retry time is finished', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 0.25)));\n\t\t\tawait client.setUp();\n\t\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\t\tawait testObject.manifest(null);\n\t\t\ttry {\n\t\t\t\tawait testObject.manifest(null);\n\t\t\t\tassert.fail('should fail');\n\t\t\t} catch (e) { }\n\n\t\t\tconst promise = Event.toPromise(testObject.onDidChangeDonotMakeRequestsUntil);\n\t\t\tawait timeout(300);\n\t\t\tawait promise;\n\t\t\tassert.ok(!testObject.donotMakeRequestsUntil);\n\t\t});\n\t});\n\n\ttest('test donotMakeRequestsUntil is retrieved', async () => {\n\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 1)));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\tawait testObject.manifest(null);\n\t\ttry {\n\t\t\tawait testObject.manifest(null);\n\t\t} catch (e) { }\n\n\t\tconst target = disposableStore.add(client.instantiationService.createInstance(UserDataSyncStoreService));\n\t\tassert.strictEqual(target.donotMakeRequestsUntil?.getTime(), testObject.donotMakeRequestsUntil?.getTime());\n\t});\n\n\ttest('test donotMakeRequestsUntil is checked and reset after retreived', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst client = disposableStore.add(new UserDataSyncClient(new UserDataSyncTestServer(1, 0.25)));\n\t\t\tawait client.setUp();\n\t\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\n\t\t\tawait testObject.manifest(null);\n\t\t\ttry {\n\t\t\t\tawait testObject.manifest(null);\n\t\t\t\tassert.fail('should fail');\n\t\t\t} catch (e) { }\n\n\t\t\tawait timeout(300);\n\t\t\tconst target = disposableStore.add(client.instantiationService.createInstance(UserDataSyncStoreService));\n\t\t\tassert.ok(!target.donotMakeRequestsUntil);\n\t\t});\n\t});\n\n\ttest('test read resource request handles 304', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait client.sync();\n\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncStoreService);\n\t\tconst expected = await testObject.readResource(SyncResource.Settings, null);\n\t\tconst actual = await testObject.readResource(SyncResource.Settings, expected);\n\n\t\tassert.strictEqual(actual, expected);\n\t});\n\n});\n\nsuite('UserDataSyncRequestsSession', () => {\n\n\tconst requestService: IRequestService = {\n\t\t_serviceBrand: undefined,\n\t\tasync request() { return { res: { headers: {} }, stream: newWriteableBufferStream() }; },\n\t\tasync resolveProxy() { return undefined; },\n\t\tasync lookupAuthorization() { return undefined; },\n\t\tasync lookupKerberosAuthorization() { return undefined; },\n\t\tasync loadCertificates() { return []; }\n\t};\n\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('too many requests are thrown when limit exceeded', async () => {\n\t\tconst testObject = new RequestsSession(1, 500, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\n\t\ttry {\n\t\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\t} catch (error) {\n\t\t\tassert.ok(error instanceof UserDataSyncStoreError);\n\t\t\tassert.strictEqual((<UserDataSyncStoreError>error).code, UserDataSyncErrorCode.LocalTooManyRequests);\n\t\t\treturn;\n\t\t}\n\t\tassert.fail('Should fail with limit exceeded');\n\t});\n\n\ttest('requests are handled after session is expired', () => runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst testObject = new RequestsSession(1, 100, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\tawait timeout(125);\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t}));\n\n\ttest('too many requests are thrown after session is expired', () => runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst testObject = new RequestsSession(1, 100, requestService, new NullLogService());\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\tawait timeout(125);\n\t\tawait testObject.request('url', {}, CancellationToken.None);\n\n\t\ttry {\n\t\t\tawait testObject.request('url', {}, CancellationToken.None);\n\t\t} catch (error) {\n\t\t\tassert.ok(error instanceof UserDataSyncStoreError);\n\t\t\tassert.strictEqual((<UserDataSyncStoreError>error).code, UserDataSyncErrorCode.LocalTooManyRequests);\n\t\t\treturn;\n\t\t}\n\t\tassert.fail('Should fail with limit exceeded');\n\t}));\n\n});\n"]}