{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/userDataSync/test/common/userDataSyncService.test.ts","vs/platform/userDataSync/test/common/userDataSyncService.test.ts"],"names":[],"mappings":"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","file":"userDataSyncService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { dirname, joinPath } from '../../../../base/common/resources.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { IFileService } from '../../../files/common/files.js';\nimport { IUserDataProfilesService } from '../../../userDataProfile/common/userDataProfile.js';\nimport { IUserDataSyncEnablementService, IUserDataSyncService, SyncResource, SyncStatus } from '../../common/userDataSync.js';\nimport { UserDataSyncClient, UserDataSyncTestServer } from './userDataSyncClient.js';\n\nsuite('UserDataSyncService', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('test first time sync ever', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '0' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Tasks\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test first time sync ever when a sync resource is disabled', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Settings, false);\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test first time sync ever with no data', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp(true);\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test first time sync from the client with no changes - merge', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test first time sync from the client with changes - merge', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client with changes\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst fileService = testClient.instantiationService.get(IFileService);\n\t\tconst environmentService = testClient.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'mine.prompt.md'), VSBuffer.fromString('text'));\n\t\tawait fileService.writeFile(joinPath(dirname(userDataProfilesService.defaultProfile.settingsResource), 'tasks.json'), VSBuffer.fromString(JSON.stringify({})));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t]);\n\n\t});\n\n\ttest('test first time sync from the client with changes - merge with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client with changes\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst fileService = testClient.instantiationService.get(IFileService);\n\t\tconst environmentService = testClient.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'my.prompt.md'), VSBuffer.fromString('some prompt text'));\n\t\tawait fileService.writeFile(joinPath(dirname(userDataProfilesService.defaultProfile.settingsResource), 'tasks.json'), VSBuffer.fromString(JSON.stringify({})));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync when there are no changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// sync from the client again\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'shared.prompt.md'), VSBuffer.fromString('prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'default.prompt.md'), VSBuffer.fromString('some prompt file contents'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes and sync resource is disabled', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, '1.prompt.md'), VSBuffer.fromString('random prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Snippets, false);\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Prompts, false);\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are remote changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'unknown.prompt.md'), VSBuffer.fromString('prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync when there are remote changes with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'global.prompt.md'), VSBuffer.fromString('some text goes here'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/profiles/latest`, headers: { 'If-None-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test delete', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from the client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Reset from the client\n\t\ttarget.reset();\n\t\tawait testObject.reset();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'DELETE', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'DELETE', url: `${target.url}/v1/resource`, headers: {} },\n\t\t]);\n\n\t});\n\n\ttest('test delete and sync', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from the client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Reset from the client\n\t\tawait testObject.reset();\n\n\t\t// Sync again\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '0' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Tasks\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// sync from the client\n\t\tconst actualStatuses: SyncStatus[] = [];\n\t\tconst disposable = testObject.onDidChangeStatus(status => actualStatuses.push(status));\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tdisposable.dispose();\n\t\tassert.deepStrictEqual(actualStatuses, [SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle]);\n\t});\n\n\ttest('test sync conflicts status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tlet fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tfileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.HasConflicts);\n\t\tassert.deepStrictEqual(testObject.conflicts.map(({ syncResource }) => syncResource), [SyncResource.Settings]);\n\t});\n\n\ttest('test sync will sync other non conflicted areas', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client and get conflicts in settings\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testFileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait testFileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// sync from the first client with changes in keybindings\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// sync from the test client\n\t\ttarget.reset();\n\t\tconst actualStatuses: SyncStatus[] = [];\n\t\tconst disposable = testObject.onDidChangeStatus(status => actualStatuses.push(status));\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tdisposable.dispose();\n\t\tassert.deepStrictEqual(actualStatuses, []);\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.HasConflicts);\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test stop sync reset status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tlet fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tfileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\n\t\tconst syncTask = (await testObject.createSyncTask(null));\n\t\tsyncTask.run().then(null, () => null /* ignore error */);\n\t\tawait syncTask.stop();\n\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.Idle);\n\t\tassert.deepStrictEqual(testObject.conflicts, []);\n\t});\n\n\ttest('test sync send execution id header', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tfor (const request of target.requestsWithAllHeaders) {\n\t\t\tconst hasExecutionIdHeader = request.headers && request.headers['X-Execution-Id'] && request.headers['X-Execution-Id'].length > 0;\n\t\t\tassert.ok(hasExecutionIdHeader, `Should have execution header: ${request.url}`);\n\t\t}\n\n\t});\n\n\ttest('test can run sync taks only once', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\tconst syncTask = await testObject.createSyncTask(null);\n\t\tawait syncTask.run();\n\n\t\ttry {\n\t\t\tawait syncTask.run();\n\t\t\tassert.fail('Should fail running the task again');\n\t\t} catch (error) {\n\t\t\t/* expected */\n\t\t}\n\t});\n\n\ttest('test sync when there are local profile that uses default profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1', { useDefaultFlags: { settings: true } });\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, '2.prompt.md'), VSBuffer.fromString('file contents'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there is a remote profile that uses default profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1', { useDefaultFlags: { keybindings: true } });\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'best.prompt.md'), VSBuffer.fromString('prompt prompt'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/profiles/latest`, headers: { 'If-None-Match': '0' } },\n\t\t]);\n\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { dirname, joinPath } from '../../../../base/common/resources.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IEnvironmentService } from '../../../environment/common/environment.js';\nimport { IFileService } from '../../../files/common/files.js';\nimport { IUserDataProfilesService } from '../../../userDataProfile/common/userDataProfile.js';\nimport { IUserDataSyncEnablementService, IUserDataSyncService, SyncResource, SyncStatus } from '../../common/userDataSync.js';\nimport { UserDataSyncClient, UserDataSyncTestServer } from './userDataSyncClient.js';\n\nsuite('UserDataSyncService', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('test first time sync ever', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '0' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Tasks\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test first time sync ever when a sync resource is disabled', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Settings, false);\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test first time sync ever with no data', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp(true);\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync for first time\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test first time sync from the client with no changes - merge', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test first time sync from the client with changes - merge', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client with changes\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst fileService = testClient.instantiationService.get(IFileService);\n\t\tconst environmentService = testClient.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'mine.prompt.md'), VSBuffer.fromString('text'));\n\t\tawait fileService.writeFile(joinPath(dirname(userDataProfilesService.defaultProfile.settingsResource), 'tasks.json'), VSBuffer.fromString(JSON.stringify({})));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t]);\n\n\t});\n\n\ttest('test first time sync from the client with changes - merge with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client with changes\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst fileService = testClient.instantiationService.get(IFileService);\n\t\tconst environmentService = testClient.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'my.prompt.md'), VSBuffer.fromString('some prompt text'));\n\t\tawait fileService.writeFile(joinPath(dirname(userDataProfilesService.defaultProfile.settingsResource), 'tasks.json'), VSBuffer.fromString(JSON.stringify({})));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// Sync (merge) from the test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/tasks/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: {} },\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync when there are no changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// sync from the client again\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'shared.prompt.md'), VSBuffer.fromString('prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'default.prompt.md'), VSBuffer.fromString('some prompt file contents'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are local changes and sync resource is disabled', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, '1.prompt.md'), VSBuffer.fromString('random prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Snippets, false);\n\t\tclient.instantiationService.get(IUserDataSyncEnablementService).setResourceEnablement(SyncResource.Prompts, false);\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there are remote changes', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'unknown.prompt.md'), VSBuffer.fromString('prompt text'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync when there are remote changes with profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1');\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'global.prompt.md'), VSBuffer.fromString('some text goes here'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/profiles/latest`, headers: { 'If-None-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test delete', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from the client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Reset from the client\n\t\ttarget.reset();\n\t\tawait testObject.reset();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'DELETE', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'DELETE', url: `${target.url}/v1/resource`, headers: {} },\n\t\t]);\n\n\t});\n\n\ttest('test delete and sync', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from the client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Reset from the client\n\t\tawait testObject.reset();\n\n\t\t// Sync again\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '0' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '0' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '0' } },\n\t\t\t// Tasks\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/tasks`, headers: { 'If-Match': '0' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '0' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '0' } },\n\t\t]);\n\n\t});\n\n\ttest('test sync status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\t// sync from the client\n\t\tconst actualStatuses: SyncStatus[] = [];\n\t\tconst disposable = testObject.onDidChangeStatus(status => actualStatuses.push(status));\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tdisposable.dispose();\n\t\tassert.deepStrictEqual(actualStatuses, [SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle, SyncStatus.Syncing, SyncStatus.Idle]);\n\t});\n\n\ttest('test sync conflicts status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tlet fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tfileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\t\t// sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.HasConflicts);\n\t\tassert.deepStrictEqual(testObject.conflicts.map(({ syncResource }) => syncResource), [SyncResource.Settings]);\n\t});\n\n\ttest('test sync will sync other non conflicted areas', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client and get conflicts in settings\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testFileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait testFileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// sync from the first client with changes in keybindings\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// sync from the test client\n\t\ttarget.reset();\n\t\tconst actualStatuses: SyncStatus[] = [];\n\t\tconst disposable = testObject.onDidChangeStatus(status => actualStatuses.push(status));\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tdisposable.dispose();\n\t\tassert.deepStrictEqual(actualStatuses, []);\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.HasConflicts);\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t]);\n\t});\n\n\ttest('test stop sync reset status', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tlet fileService = client.instantiationService.get(IFileService);\n\t\tlet userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Setup the test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tfileService = testClient.instantiationService.get(IFileService);\n\t\tuserDataProfilesService = testClient.instantiationService.get(IUserDataProfilesService);\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 16 })));\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\n\n\t\tconst syncTask = (await testObject.createSyncTask(null));\n\t\tsyncTask.run().then(null, () => null /* ignore error */);\n\t\tawait syncTask.stop();\n\n\t\tassert.deepStrictEqual(testObject.status, SyncStatus.Idle);\n\t\tassert.deepStrictEqual(testObject.conflicts, []);\n\t});\n\n\ttest('test sync send execution id header', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tfor (const request of target.requestsWithAllHeaders) {\n\t\t\tconst hasExecutionIdHeader = request.headers && request.headers['X-Execution-Id'] && request.headers['X-Execution-Id'].length > 0;\n\t\t\tassert.ok(hasExecutionIdHeader, `Should have execution header: ${request.url}`);\n\t\t}\n\n\t});\n\n\ttest('test can run sync taks only once', async () => {\n\t\t// Setup the client\n\t\tconst target = new UserDataSyncTestServer();\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\n\t\tconst syncTask = await testObject.createSyncTask(null);\n\t\tawait syncTask.run();\n\n\t\ttry {\n\t\t\tawait syncTask.run();\n\t\t\tassert.fail('Should fail running the task again');\n\t\t} catch (error) {\n\t\t\t/* expected */\n\t\t}\n\t});\n\n\ttest('test sync when there are local profile that uses default profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Setup and sync from the client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tconst testObject = client.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\t\ttarget.reset();\n\n\t\t// Do changes in the client\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1', { useDefaultFlags: { settings: true } });\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{}`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, '2.prompt.md'), VSBuffer.fromString('file contents'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\n\t\t// Sync from the client\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/settings`, headers: { 'If-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/keybindings`, headers: { 'If-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/snippets`, headers: { 'If-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/globalState`, headers: { 'If-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/prompts`, headers: { 'If-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'POST', url: `${target.url}/v1/collection`, headers: {} },\n\t\t\t{ type: 'POST', url: `${target.url}/v1/resource/profiles`, headers: { 'If-Match': '0' } },\n\t\t]);\n\t});\n\n\ttest('test sync when there is a remote profile that uses default profile', async () => {\n\t\tconst target = new UserDataSyncTestServer();\n\n\t\t// Sync from first client\n\t\tconst client = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait client.setUp();\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\tconst testClient = disposableStore.add(new UserDataSyncClient(target));\n\t\tawait testClient.setUp();\n\t\tconst testObject = testClient.instantiationService.get(IUserDataSyncService);\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\t// Do changes in first client and sync\n\t\tconst fileService = client.instantiationService.get(IFileService);\n\t\tconst environmentService = client.instantiationService.get(IEnvironmentService);\n\t\tconst userDataProfilesService = client.instantiationService.get(IUserDataProfilesService);\n\t\tawait userDataProfilesService.createNamedProfile('1', { useDefaultFlags: { keybindings: true } });\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.settingsResource, VSBuffer.fromString(JSON.stringify({ 'editor.fontSize': 14 })));\n\t\tawait fileService.writeFile(userDataProfilesService.defaultProfile.keybindingsResource, VSBuffer.fromString(JSON.stringify([{ 'command': 'abcd', 'key': 'cmd+c' }])));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.snippetsHome, 'html.json'), VSBuffer.fromString(`{ \"a\": \"changed\" }`));\n\t\tawait fileService.writeFile(joinPath(userDataProfilesService.defaultProfile.promptsHome, 'best.prompt.md'), VSBuffer.fromString('prompt prompt'));\n\t\tawait fileService.writeFile(environmentService.argvResource, VSBuffer.fromString(JSON.stringify({ 'locale': 'de' })));\n\t\tawait (await client.instantiationService.get(IUserDataSyncService).createSyncTask(null)).run();\n\n\t\t// Sync from test client\n\t\ttarget.reset();\n\t\tawait (await testObject.createSyncTask(null)).run();\n\n\t\tassert.deepStrictEqual(target.requests, [\n\t\t\t// Manifest\n\t\t\t{ type: 'GET', url: `${target.url}/v1/manifest`, headers: {} },\n\t\t\t// Settings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/settings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Keybindings\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/keybindings/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Snippets\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/snippets/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Global state\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/globalState/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Prompts\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/prompts/latest`, headers: { 'If-None-Match': '1' } },\n\t\t\t// Profiles\n\t\t\t{ type: 'GET', url: `${target.url}/v1/resource/profiles/latest`, headers: { 'If-None-Match': '0' } },\n\t\t]);\n\n\t});\n});\n"]}