{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/userDataSync/common/userDataSyncEnablementService.ts","vs/platform/userDataSync/common/userDataSyncEnablementService.ts"],"names":[],"mappings":"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","file":"userDataSyncEnablementService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isWeb } from '../../../base/common/platform.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { IApplicationStorageValueChangeEvent, IStorageService, StorageScope, StorageTarget } from '../../storage/common/storage.js';\nimport { ALL_SYNC_RESOURCES, getEnablementKey, IUserDataSyncEnablementService, IUserDataSyncStoreManagementService, SyncResource } from './userDataSync.js';\n\nconst enablementKey = 'sync.enable';\n\nexport class UserDataSyncEnablementService extends Disposable implements IUserDataSyncEnablementService {\n\n\t_serviceBrand: undefined;\n\n\tprivate _onDidChangeEnablement = new Emitter<boolean>();\n\treadonly onDidChangeEnablement: Event<boolean> = this._onDidChangeEnablement.event;\n\n\tprivate _onDidChangeResourceEnablement = new Emitter<[SyncResource, boolean]>();\n\treadonly onDidChangeResourceEnablement: Event<[SyncResource, boolean]> = this._onDidChangeResourceEnablement.event;\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IEnvironmentService protected readonly environmentService: IEnvironmentService,\n\t\t@IUserDataSyncStoreManagementService private readonly userDataSyncStoreManagementService: IUserDataSyncStoreManagementService,\n\t) {\n\t\tsuper();\n\t\tthis._register(storageService.onDidChangeValue(StorageScope.APPLICATION, undefined, this._store)(e => this.onDidStorageChange(e)));\n\t}\n\n\tisEnabled(): boolean {\n\t\tswitch (this.environmentService.sync) {\n\t\t\tcase 'on':\n\t\t\t\treturn true;\n\t\t\tcase 'off':\n\t\t\t\treturn false;\n\t\t}\n\t\treturn this.storageService.getBoolean(enablementKey, StorageScope.APPLICATION, false);\n\t}\n\n\tcanToggleEnablement(): boolean {\n\t\treturn this.userDataSyncStoreManagementService.userDataSyncStore !== undefined && this.environmentService.sync === undefined;\n\t}\n\n\tsetEnablement(enabled: boolean): void {\n\t\tif (enabled && !this.canToggleEnablement()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.storageService.store(enablementKey, enabled, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t}\n\n\tisResourceEnabled(resource: SyncResource, defaultValue?: boolean): boolean {\n\t\tconst storedValue = this.storageService.getBoolean(getEnablementKey(resource), StorageScope.APPLICATION);\n\t\tdefaultValue = defaultValue ?? resource !== SyncResource.Prompts;\n\t\treturn storedValue ?? defaultValue;\n\t}\n\n\tisResourceEnablementConfigured(resource: SyncResource): boolean {\n\t\tconst storedValue = this.storageService.getBoolean(getEnablementKey(resource), StorageScope.APPLICATION);\n\n\t\treturn (storedValue !== undefined);\n\t}\n\n\tsetResourceEnablement(resource: SyncResource, enabled: boolean): void {\n\t\tif (this.isResourceEnabled(resource) !== enabled) {\n\t\t\tconst resourceEnablementKey = getEnablementKey(resource);\n\t\t\tthis.storeResourceEnablement(resourceEnablementKey, enabled);\n\t\t}\n\t}\n\n\tgetResourceSyncStateVersion(resource: SyncResource): string | undefined {\n\t\treturn undefined;\n\t}\n\n\tprivate storeResourceEnablement(resourceEnablementKey: string, enabled: boolean): void {\n\t\tthis.storageService.store(resourceEnablementKey, enabled, StorageScope.APPLICATION, isWeb ? StorageTarget.USER /* sync in web */ : StorageTarget.MACHINE);\n\t}\n\n\tprivate onDidStorageChange(storageChangeEvent: IApplicationStorageValueChangeEvent): void {\n\t\tif (enablementKey === storageChangeEvent.key) {\n\t\t\tthis._onDidChangeEnablement.fire(this.isEnabled());\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceKey = ALL_SYNC_RESOURCES.filter(resourceKey => getEnablementKey(resourceKey) === storageChangeEvent.key)[0];\n\t\tif (resourceKey) {\n\t\t\tthis._onDidChangeResourceEnablement.fire([resourceKey, this.isResourceEnabled(resourceKey)]);\n\t\t\treturn;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isWeb } from '../../../base/common/platform.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { IApplicationStorageValueChangeEvent, IStorageService, StorageScope, StorageTarget } from '../../storage/common/storage.js';\nimport { ALL_SYNC_RESOURCES, getEnablementKey, IUserDataSyncEnablementService, IUserDataSyncStoreManagementService, SyncResource } from './userDataSync.js';\n\nconst enablementKey = 'sync.enable';\n\nexport class UserDataSyncEnablementService extends Disposable implements IUserDataSyncEnablementService {\n\n\t_serviceBrand: undefined;\n\n\tprivate _onDidChangeEnablement = new Emitter<boolean>();\n\treadonly onDidChangeEnablement: Event<boolean> = this._onDidChangeEnablement.event;\n\n\tprivate _onDidChangeResourceEnablement = new Emitter<[SyncResource, boolean]>();\n\treadonly onDidChangeResourceEnablement: Event<[SyncResource, boolean]> = this._onDidChangeResourceEnablement.event;\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IEnvironmentService protected readonly environmentService: IEnvironmentService,\n\t\t@IUserDataSyncStoreManagementService private readonly userDataSyncStoreManagementService: IUserDataSyncStoreManagementService,\n\t) {\n\t\tsuper();\n\t\tthis._register(storageService.onDidChangeValue(StorageScope.APPLICATION, undefined, this._store)(e => this.onDidStorageChange(e)));\n\t}\n\n\tisEnabled(): boolean {\n\t\tswitch (this.environmentService.sync) {\n\t\t\tcase 'on':\n\t\t\t\treturn true;\n\t\t\tcase 'off':\n\t\t\t\treturn false;\n\t\t}\n\t\treturn this.storageService.getBoolean(enablementKey, StorageScope.APPLICATION, false);\n\t}\n\n\tcanToggleEnablement(): boolean {\n\t\treturn this.userDataSyncStoreManagementService.userDataSyncStore !== undefined && this.environmentService.sync === undefined;\n\t}\n\n\tsetEnablement(enabled: boolean): void {\n\t\tif (enabled && !this.canToggleEnablement()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.storageService.store(enablementKey, enabled, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t}\n\n\tisResourceEnabled(resource: SyncResource, defaultValue?: boolean): boolean {\n\t\tconst storedValue = this.storageService.getBoolean(getEnablementKey(resource), StorageScope.APPLICATION);\n\t\tdefaultValue = defaultValue ?? resource !== SyncResource.Prompts;\n\t\treturn storedValue ?? defaultValue;\n\t}\n\n\tisResourceEnablementConfigured(resource: SyncResource): boolean {\n\t\tconst storedValue = this.storageService.getBoolean(getEnablementKey(resource), StorageScope.APPLICATION);\n\n\t\treturn (storedValue !== undefined);\n\t}\n\n\tsetResourceEnablement(resource: SyncResource, enabled: boolean): void {\n\t\tif (this.isResourceEnabled(resource) !== enabled) {\n\t\t\tconst resourceEnablementKey = getEnablementKey(resource);\n\t\t\tthis.storeResourceEnablement(resourceEnablementKey, enabled);\n\t\t}\n\t}\n\n\tgetResourceSyncStateVersion(resource: SyncResource): string | undefined {\n\t\treturn undefined;\n\t}\n\n\tprivate storeResourceEnablement(resourceEnablementKey: string, enabled: boolean): void {\n\t\tthis.storageService.store(resourceEnablementKey, enabled, StorageScope.APPLICATION, isWeb ? StorageTarget.USER /* sync in web */ : StorageTarget.MACHINE);\n\t}\n\n\tprivate onDidStorageChange(storageChangeEvent: IApplicationStorageValueChangeEvent): void {\n\t\tif (enablementKey === storageChangeEvent.key) {\n\t\t\tthis._onDidChangeEnablement.fire(this.isEnabled());\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceKey = ALL_SYNC_RESOURCES.filter(resourceKey => getEnablementKey(resourceKey) === storageChangeEvent.key)[0];\n\t\tif (resourceKey) {\n\t\t\tthis._onDidChangeResourceEnablement.fire([resourceKey, this.isResourceEnabled(resourceKey)]);\n\t\t\treturn;\n\t\t}\n\t}\n}\n"]}