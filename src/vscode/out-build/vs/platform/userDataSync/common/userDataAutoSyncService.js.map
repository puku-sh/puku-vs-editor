{"version":3,"sources":["vs/platform/userDataSync/common/userDataAutoSyncService.ts"],"names":[],"mappings":"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","file":"userDataAutoSyncService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancelablePromise, createCancelablePromise, disposableTimeout, ThrottledDelayer, timeout } from '../../../base/common/async.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { toLocalISOString } from '../../../base/common/date.js';\nimport { toErrorMessage } from '../../../base/common/errorMessage.js';\nimport { isCancellationError } from '../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable, IDisposable, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { isWeb } from '../../../base/common/platform.js';\nimport { isEqual } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { IProductService } from '../../product/common/productService.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../storage/common/storage.js';\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\nimport { IUserDataSyncTask, IUserDataAutoSyncService, IUserDataManifest, IUserDataSyncLogService, IUserDataSyncEnablementService, IUserDataSyncService, IUserDataSyncStoreManagementService, IUserDataSyncStoreService, UserDataAutoSyncError, UserDataSyncError, UserDataSyncErrorCode, SyncOptions } from './userDataSync.js';\nimport { IUserDataSyncAccountService } from './userDataSyncAccount.js';\nimport { IUserDataSyncMachinesService } from './userDataSyncMachines.js';\n\nconst disableMachineEventuallyKey = 'sync.disableMachineEventually';\nconst sessionIdKey = 'sync.sessionId';\nconst storeUrlKey = 'sync.storeUrl';\nconst productQualityKey = 'sync.productQuality';\n\nexport class UserDataAutoSyncService extends Disposable implements IUserDataAutoSyncService {\n\n\t_serviceBrand: undefined;\n\n\tprivate readonly autoSync = this._register(new MutableDisposable<AutoSync>());\n\tprivate successiveFailures: number = 0;\n\tprivate lastSyncTriggerTime: number | undefined = undefined;\n\tprivate readonly syncTriggerDelayer: ThrottledDelayer<void>;\n\tprivate suspendUntilRestart: boolean = false;\n\n\tprivate readonly _onError: Emitter<UserDataSyncError> = this._register(new Emitter<UserDataSyncError>());\n\treadonly onError: Event<UserDataSyncError> = this._onError.event;\n\n\tprivate lastSyncUrl: URI | undefined;\n\tprivate get syncUrl(): URI | undefined {\n\t\tconst value = this.storageService.get(storeUrlKey, StorageScope.APPLICATION);\n\t\treturn value ? URI.parse(value) : undefined;\n\t}\n\tprivate set syncUrl(syncUrl: URI | undefined) {\n\t\tif (syncUrl) {\n\t\t\tthis.storageService.store(storeUrlKey, syncUrl.toString(), StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t} else {\n\t\t\tthis.storageService.remove(storeUrlKey, StorageScope.APPLICATION);\n\t\t}\n\t}\n\n\tprivate previousProductQuality: string | undefined;\n\tprivate get productQuality(): string | undefined {\n\t\treturn this.storageService.get(productQualityKey, StorageScope.APPLICATION);\n\t}\n\tprivate set productQuality(productQuality: string | undefined) {\n\t\tif (productQuality) {\n\t\t\tthis.storageService.store(productQualityKey, productQuality, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t} else {\n\t\t\tthis.storageService.remove(productQualityKey, StorageScope.APPLICATION);\n\t\t}\n\t}\n\n\tconstructor(\n\t\t@IProductService productService: IProductService,\n\t\t@IUserDataSyncStoreManagementService private readonly userDataSyncStoreManagementService: IUserDataSyncStoreManagementService,\n\t\t@IUserDataSyncStoreService private readonly userDataSyncStoreService: IUserDataSyncStoreService,\n\t\t@IUserDataSyncEnablementService private readonly userDataSyncEnablementService: IUserDataSyncEnablementService,\n\t\t@IUserDataSyncService private readonly userDataSyncService: IUserDataSyncService,\n\t\t@IUserDataSyncLogService private readonly logService: IUserDataSyncLogService,\n\t\t@IUserDataSyncAccountService private readonly userDataSyncAccountService: IUserDataSyncAccountService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IUserDataSyncMachinesService private readonly userDataSyncMachinesService: IUserDataSyncMachinesService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t) {\n\t\tsuper();\n\t\tthis.syncTriggerDelayer = this._register(new ThrottledDelayer<void>(this.getSyncTriggerDelayTime()));\n\n\t\tthis.lastSyncUrl = this.syncUrl;\n\t\tthis.syncUrl = userDataSyncStoreManagementService.userDataSyncStore?.url;\n\n\t\tthis.previousProductQuality = this.productQuality;\n\t\tthis.productQuality = productService.quality;\n\n\t\tif (this.syncUrl) {\n\n\t\t\tthis.logService.info('[AutoSync] Using settings sync service', this.syncUrl.toString());\n\t\t\tthis._register(userDataSyncStoreManagementService.onDidChangeUserDataSyncStore(() => {\n\t\t\t\tif (!isEqual(this.syncUrl, userDataSyncStoreManagementService.userDataSyncStore?.url)) {\n\t\t\t\t\tthis.lastSyncUrl = this.syncUrl;\n\t\t\t\t\tthis.syncUrl = userDataSyncStoreManagementService.userDataSyncStore?.url;\n\t\t\t\t\tif (this.syncUrl) {\n\t\t\t\t\t\tthis.logService.info('[AutoSync] Using settings sync service', this.syncUrl.toString());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tif (this.userDataSyncEnablementService.isEnabled()) {\n\t\t\t\tthis.logService.info('[AutoSync] Enabled.');\n\t\t\t} else {\n\t\t\t\tthis.logService.info('[AutoSync] Disabled.');\n\t\t\t}\n\t\t\tthis.updateAutoSync();\n\n\t\t\tif (this.hasToDisableMachineEventually()) {\n\t\t\t\tthis.disableMachineEventually();\n\t\t\t}\n\n\t\t\tthis._register(userDataSyncAccountService.onDidChangeAccount(() => this.updateAutoSync()));\n\t\t\tthis._register(userDataSyncStoreService.onDidChangeDonotMakeRequestsUntil(() => this.updateAutoSync()));\n\t\t\tthis._register(userDataSyncService.onDidChangeLocal(source => this.triggerSync([source])));\n\t\t\tthis._register(Event.filter(this.userDataSyncEnablementService.onDidChangeResourceEnablement, ([, enabled]) => enabled)(() => this.triggerSync(['resourceEnablement'])));\n\t\t\tthis._register(this.userDataSyncStoreManagementService.onDidChangeUserDataSyncStore(() => this.triggerSync(['userDataSyncStoreChanged'])));\n\t\t}\n\t}\n\n\tprivate updateAutoSync(): void {\n\t\tconst { enabled, message } = this.isAutoSyncEnabled();\n\t\tif (enabled) {\n\t\t\tif (this.autoSync.value === undefined) {\n\t\t\t\tthis.autoSync.value = new AutoSync(this.lastSyncUrl, 1000 * 60 * 5 /* 5 miutes */, this.userDataSyncStoreManagementService, this.userDataSyncStoreService, this.userDataSyncService, this.userDataSyncMachinesService, this.logService, this.telemetryService, this.storageService);\n\t\t\t\tthis.autoSync.value.register(this.autoSync.value.onDidStartSync(() => this.lastSyncTriggerTime = new Date().getTime()));\n\t\t\t\tthis.autoSync.value.register(this.autoSync.value.onDidFinishSync(e => this.onDidFinishSync(e)));\n\t\t\t\tif (this.startAutoSync()) {\n\t\t\t\t\tthis.autoSync.value.start();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.syncTriggerDelayer.cancel();\n\t\t\tif (this.autoSync.value !== undefined) {\n\t\t\t\tif (message) {\n\t\t\t\t\tthis.logService.info(message);\n\t\t\t\t}\n\t\t\t\tthis.autoSync.clear();\n\t\t\t}\n\n\t\t\t/* log message when auto sync is not disabled by user */\n\t\t\telse if (message && this.userDataSyncEnablementService.isEnabled()) {\n\t\t\t\tthis.logService.info(message);\n\t\t\t}\n\t\t}\n\t}\n\n\t// For tests purpose only\n\tprotected startAutoSync(): boolean { return true; }\n\n\tprivate isAutoSyncEnabled(): { enabled: boolean; message?: string } {\n\t\tif (!this.userDataSyncEnablementService.isEnabled()) {\n\t\t\treturn { enabled: false, message: '[AutoSync] Disabled.' };\n\t\t}\n\t\tif (!this.userDataSyncAccountService.account) {\n\t\t\treturn { enabled: false, message: '[AutoSync] Suspended until auth token is available.' };\n\t\t}\n\t\tif (this.userDataSyncStoreService.donotMakeRequestsUntil) {\n\t\t\treturn { enabled: false, message: `[AutoSync] Suspended until ${toLocalISOString(this.userDataSyncStoreService.donotMakeRequestsUntil)} because server is not accepting requests until then.` };\n\t\t}\n\t\tif (this.suspendUntilRestart) {\n\t\t\treturn { enabled: false, message: '[AutoSync] Suspended until restart.' };\n\t\t}\n\t\treturn { enabled: true };\n\t}\n\n\tasync turnOn(): Promise<void> {\n\t\tthis.stopDisableMachineEventually();\n\t\tthis.lastSyncUrl = this.syncUrl;\n\t\tthis.updateEnablement(true);\n\t}\n\n\tasync turnOff(everywhere: boolean, softTurnOffOnError?: boolean, donotRemoveMachine?: boolean): Promise<void> {\n\t\ttry {\n\n\t\t\t// Remove machine\n\t\t\tif (this.userDataSyncAccountService.account && !donotRemoveMachine) {\n\t\t\t\tawait this.userDataSyncMachinesService.removeCurrentMachine();\n\t\t\t}\n\n\t\t\t// Disable Auto Sync\n\t\t\tthis.updateEnablement(false);\n\n\t\t\t// Reset Session\n\t\t\tthis.storageService.remove(sessionIdKey, StorageScope.APPLICATION);\n\n\t\t\t// Reset\n\t\t\tif (everywhere) {\n\t\t\t\tawait this.userDataSyncService.reset();\n\t\t\t} else {\n\t\t\t\tawait this.userDataSyncService.resetLocal();\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t\tif (softTurnOffOnError) {\n\t\t\t\tthis.updateEnablement(false);\n\t\t\t} else {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateEnablement(enabled: boolean): void {\n\t\tif (this.userDataSyncEnablementService.isEnabled() !== enabled) {\n\t\t\tthis.userDataSyncEnablementService.setEnablement(enabled);\n\t\t\tthis.updateAutoSync();\n\t\t}\n\t}\n\n\tprivate hasProductQualityChanged(): boolean {\n\t\treturn !!this.previousProductQuality && !!this.productQuality && this.previousProductQuality !== this.productQuality;\n\t}\n\n\tprivate async onDidFinishSync(error: Error | undefined): Promise<void> {\n\t\tthis.logService.debug('[AutoSync] Sync Finished');\n\t\tif (!error) {\n\t\t\t// Sync finished without errors\n\t\t\tthis.successiveFailures = 0;\n\t\t\treturn;\n\t\t}\n\n\t\t// Error while syncing\n\t\tconst userDataSyncError = UserDataSyncError.toUserDataSyncError(error);\n\n\t\t// Session got expired\n\t\tif (userDataSyncError.code === UserDataSyncErrorCode.SessionExpired) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\tthis.logService.info('[AutoSync] Turned off sync because current session is expired');\n\t\t}\n\n\t\t// Turned off from another device\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.TurnedOff) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\tthis.logService.info('[AutoSync] Turned off sync because sync is turned off in the cloud');\n\t\t}\n\n\t\t// Exceeded Rate Limit on Client\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.LocalTooManyRequests) {\n\t\t\tthis.suspendUntilRestart = true;\n\t\t\tthis.logService.info('[AutoSync] Suspended sync because of making too many requests to server');\n\t\t\tthis.updateAutoSync();\n\t\t}\n\n\t\t// Exceeded Rate Limit on Server\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.TooManyRequests) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */,\n\t\t\t\ttrue /* do not disable machine because disabling a machine makes request to server and can fail with TooManyRequests */);\n\t\t\tthis.disableMachineEventually();\n\t\t\tthis.logService.info('[AutoSync] Turned off sync because of making too many requests to server');\n\t\t}\n\n\t\t// Method Not Found\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.MethodNotFound) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\tthis.logService.info('[AutoSync] Turned off sync because current client is making requests to server that are not supported');\n\t\t}\n\n\t\t// Upgrade Required or Gone\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.UpgradeRequired || userDataSyncError.code === UserDataSyncErrorCode.Gone) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */,\n\t\t\t\ttrue /* do not disable machine because disabling a machine makes request to server and can fail with upgrade required or gone */);\n\t\t\tthis.disableMachineEventually();\n\t\t\tthis.logService.info('[AutoSync] Turned off sync because current client is not compatible with server. Requires client upgrade.');\n\t\t}\n\n\t\t// Incompatible Local Content\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.IncompatibleLocalContent) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\tthis.logService.info(`[AutoSync] Turned off sync because server has ${userDataSyncError.resource} content with newer version than of client. Requires client upgrade.`);\n\t\t}\n\n\t\t// Incompatible Remote Content\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.IncompatibleRemoteContent) {\n\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\tthis.logService.info(`[AutoSync] Turned off sync because server has ${userDataSyncError.resource} content with older version than of client. Requires server reset.`);\n\t\t}\n\n\t\t// Service changed\n\t\telse if (userDataSyncError.code === UserDataSyncErrorCode.ServiceChanged || userDataSyncError.code === UserDataSyncErrorCode.DefaultServiceChanged) {\n\n\t\t\t// Check if default settings sync service has changed in web without changing the product quality\n\t\t\t// Then turn off settings sync and ask user to turn on again\n\t\t\tif (isWeb && userDataSyncError.code === UserDataSyncErrorCode.DefaultServiceChanged && !this.hasProductQualityChanged()) {\n\t\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */);\n\t\t\t\tthis.logService.info('[AutoSync] Turned off sync because default sync service is changed.');\n\t\t\t}\n\n\t\t\t// Service has changed by the user. So turn off and turn on sync.\n\t\t\t// Show a prompt to the user about service change.\n\t\t\telse {\n\t\t\t\tawait this.turnOff(false, true /* force soft turnoff on error */, true /* do not disable machine */);\n\t\t\t\tawait this.turnOn();\n\t\t\t\tthis.logService.info('[AutoSync] Sync Service changed. Turned off auto sync, reset local state and turned on auto sync.');\n\t\t\t}\n\n\t\t}\n\n\t\telse {\n\t\t\tthis.logService.error(userDataSyncError);\n\t\t\tthis.successiveFailures++;\n\t\t}\n\n\t\tthis._onError.fire(userDataSyncError);\n\t}\n\n\tprivate async disableMachineEventually(): Promise<void> {\n\t\tthis.storageService.store(disableMachineEventuallyKey, true, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\tawait timeout(1000 * 60 * 10);\n\n\t\t// Return if got stopped meanwhile.\n\t\tif (!this.hasToDisableMachineEventually()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.stopDisableMachineEventually();\n\n\t\t// disable only if sync is disabled\n\t\tif (!this.userDataSyncEnablementService.isEnabled() && this.userDataSyncAccountService.account) {\n\t\t\tawait this.userDataSyncMachinesService.removeCurrentMachine();\n\t\t}\n\t}\n\n\tprivate hasToDisableMachineEventually(): boolean {\n\t\treturn this.storageService.getBoolean(disableMachineEventuallyKey, StorageScope.APPLICATION, false);\n\t}\n\n\tprivate stopDisableMachineEventually(): void {\n\t\tthis.storageService.remove(disableMachineEventuallyKey, StorageScope.APPLICATION);\n\t}\n\n\tprivate sources: string[] = [];\n\tasync triggerSync(sources: string[], options?: SyncOptions): Promise<void> {\n\t\tif (this.autoSync.value === undefined) {\n\t\t\treturn this.syncTriggerDelayer.cancel();\n\t\t}\n\n\t\tif (options?.skipIfSyncedRecently && this.lastSyncTriggerTime && new Date().getTime() - this.lastSyncTriggerTime < 10_000) {\n\t\t\tthis.logService.debug('[AutoSync] Skipping because sync was triggered recently.', sources);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sources.push(...sources);\n\t\treturn this.syncTriggerDelayer.trigger(async () => {\n\t\t\tthis.logService.trace('[AutoSync] Activity sources', ...this.sources);\n\t\t\tthis.sources = [];\n\t\t\tif (this.autoSync.value) {\n\t\t\t\tawait this.autoSync.value.sync('Activity', !!options?.disableCache);\n\t\t\t}\n\t\t}, this.successiveFailures\n\t\t\t? Math.min(this.getSyncTriggerDelayTime() * this.successiveFailures, 60_000) /* Delay linearly until max 1 minute */\n\t\t\t: options?.immediately ? 0 : this.getSyncTriggerDelayTime());\n\n\t}\n\n\tprotected getSyncTriggerDelayTime(): number {\n\t\tif (this.lastSyncTriggerTime && new Date().getTime() - this.lastSyncTriggerTime > 10_000) {\n\t\t\tthis.logService.debug('[AutoSync] Sync immediately because last sync was triggered more than 10 seconds ago.');\n\t\t\treturn 0;\n\t\t}\n\t\treturn 3_000; /* Debounce for 3 seconds if there are no failures */\n\t}\n\n}\n\nclass AutoSync extends Disposable {\n\n\tprivate static readonly INTERVAL_SYNCING = 'Interval';\n\n\tprivate readonly intervalHandler = this._register(new MutableDisposable<IDisposable>());\n\n\tprivate readonly _onDidStartSync = this._register(new Emitter<void>());\n\treadonly onDidStartSync = this._onDidStartSync.event;\n\n\tprivate readonly _onDidFinishSync = this._register(new Emitter<Error | undefined>());\n\treadonly onDidFinishSync = this._onDidFinishSync.event;\n\n\tprivate manifest: IUserDataManifest | null = null;\n\tprivate syncTask: IUserDataSyncTask | undefined;\n\tprivate syncPromise: CancelablePromise<void> | undefined;\n\n\tconstructor(\n\t\tprivate readonly lastSyncUrl: URI | undefined,\n\t\tprivate readonly interval: number /* in milliseconds */,\n\t\tprivate readonly userDataSyncStoreManagementService: IUserDataSyncStoreManagementService,\n\t\tprivate readonly userDataSyncStoreService: IUserDataSyncStoreService,\n\t\tprivate readonly userDataSyncService: IUserDataSyncService,\n\t\tprivate readonly userDataSyncMachinesService: IUserDataSyncMachinesService,\n\t\tprivate readonly logService: IUserDataSyncLogService,\n\t\tprivate readonly telemetryService: ITelemetryService,\n\t\tprivate readonly storageService: IStorageService,\n\t) {\n\t\tsuper();\n\t}\n\n\tstart(): void {\n\t\tthis._register(this.onDidFinishSync(() => this.waitUntilNextIntervalAndSync()));\n\t\tthis._register(toDisposable(() => {\n\t\t\tif (this.syncPromise) {\n\t\t\t\tthis.syncPromise.cancel();\n\t\t\t\tthis.logService.info('[AutoSync] Cancelled sync that is in progress');\n\t\t\t\tthis.syncPromise = undefined;\n\t\t\t}\n\t\t\tthis.syncTask?.stop();\n\t\t\tthis.logService.info('[AutoSync] Stopped');\n\t\t}));\n\t\tthis.sync(AutoSync.INTERVAL_SYNCING, false);\n\t}\n\n\tprivate waitUntilNextIntervalAndSync(): void {\n\t\tthis.intervalHandler.value = disposableTimeout(() => {\n\t\t\tthis.sync(AutoSync.INTERVAL_SYNCING, false);\n\t\t\tthis.intervalHandler.value = undefined;\n\t\t}, this.interval);\n\t}\n\n\tsync(reason: string, disableCache: boolean): Promise<void> {\n\t\tconst syncPromise = createCancelablePromise(async token => {\n\t\t\tif (this.syncPromise) {\n\t\t\t\ttry {\n\t\t\t\t\t// Wait until existing sync is finished\n\t\t\t\t\tthis.logService.debug('[AutoSync] Waiting until sync is finished.');\n\t\t\t\t\tawait this.syncPromise;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (isCancellationError(error)) {\n\t\t\t\t\t\t// Cancelled => Disposed. Donot continue sync.\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.doSync(reason, disableCache, token);\n\t\t});\n\t\tthis.syncPromise = syncPromise;\n\t\tthis.syncPromise.finally(() => this.syncPromise = undefined);\n\t\treturn this.syncPromise;\n\t}\n\n\tprivate hasSyncServiceChanged(): boolean {\n\t\treturn this.lastSyncUrl !== undefined && !isEqual(this.lastSyncUrl, this.userDataSyncStoreManagementService.userDataSyncStore?.url);\n\t}\n\n\tprivate async hasDefaultServiceChanged(): Promise<boolean> {\n\t\tconst previous = await this.userDataSyncStoreManagementService.getPreviousUserDataSyncStore();\n\t\tconst current = this.userDataSyncStoreManagementService.userDataSyncStore;\n\t\t// check if defaults changed\n\t\treturn !!current && !!previous &&\n\t\t\t(!isEqual(current.defaultUrl, previous.defaultUrl) ||\n\t\t\t\t!isEqual(current.insidersUrl, previous.insidersUrl) ||\n\t\t\t\t!isEqual(current.stableUrl, previous.stableUrl));\n\t}\n\n\tprivate async doSync(reason: string, disableCache: boolean, token: CancellationToken): Promise<void> {\n\t\tthis.logService.info(`[AutoSync] Triggered by ${reason}`);\n\t\tthis._onDidStartSync.fire();\n\n\t\tlet error: Error | undefined;\n\t\ttry {\n\t\t\tawait this.createAndRunSyncTask(disableCache, token);\n\t\t} catch (e) {\n\t\t\tthis.logService.error(e);\n\t\t\terror = e;\n\t\t\tif (UserDataSyncError.toUserDataSyncError(e).code === UserDataSyncErrorCode.MethodNotFound) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.logService.info('[AutoSync] Client is making invalid requests. Cleaning up data...');\n\t\t\t\t\tawait this.userDataSyncService.cleanUpRemoteData();\n\t\t\t\t\tthis.logService.info('[AutoSync] Retrying sync...');\n\t\t\t\t\tawait this.createAndRunSyncTask(disableCache, token);\n\t\t\t\t\terror = undefined;\n\t\t\t\t} catch (e1) {\n\t\t\t\t\tthis.logService.error(e1);\n\t\t\t\t\terror = e1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._onDidFinishSync.fire(error);\n\t}\n\n\tprivate async createAndRunSyncTask(disableCache: boolean, token: CancellationToken): Promise<void> {\n\t\tthis.syncTask = await this.userDataSyncService.createSyncTask(this.manifest, disableCache);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\t\tthis.manifest = this.syncTask.manifest;\n\n\t\t// Server has no data but this machine was synced before\n\t\tif (this.manifest === null && await this.userDataSyncService.hasPreviouslySynced()) {\n\t\t\tif (this.hasSyncServiceChanged()) {\n\t\t\t\tif (await this.hasDefaultServiceChanged()) {\n\t\t\t\t\tthrow new UserDataAutoSyncError(localize('default service changed', \"Cannot sync because default service has changed\"), UserDataSyncErrorCode.DefaultServiceChanged);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new UserDataAutoSyncError(localize('service changed', \"Cannot sync because sync service has changed\"), UserDataSyncErrorCode.ServiceChanged);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Sync was turned off in the cloud\n\t\t\t\tthrow new UserDataAutoSyncError(localize('turned off', \"Cannot sync because syncing is turned off in the cloud\"), UserDataSyncErrorCode.TurnedOff);\n\t\t\t}\n\t\t}\n\n\t\tconst sessionId = this.storageService.get(sessionIdKey, StorageScope.APPLICATION);\n\t\t// Server session is different from client session\n\t\tif (sessionId && this.manifest && sessionId !== this.manifest.session) {\n\t\t\tif (this.hasSyncServiceChanged()) {\n\t\t\t\tif (await this.hasDefaultServiceChanged()) {\n\t\t\t\t\tthrow new UserDataAutoSyncError(localize('default service changed', \"Cannot sync because default service has changed\"), UserDataSyncErrorCode.DefaultServiceChanged);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new UserDataAutoSyncError(localize('service changed', \"Cannot sync because sync service has changed\"), UserDataSyncErrorCode.ServiceChanged);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new UserDataAutoSyncError(localize('session expired', \"Cannot sync because current session is expired\"), UserDataSyncErrorCode.SessionExpired);\n\t\t\t}\n\t\t}\n\n\t\tconst machines = await this.userDataSyncMachinesService.getMachines(this.manifest || undefined);\n\t\t// Return if cancellation is requested\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentMachine = machines.find(machine => machine.isCurrent);\n\t\t// Check if sync was turned off from other machine\n\t\tif (currentMachine?.disabled) {\n\t\t\t// Throw TurnedOff error\n\t\t\tthrow new UserDataAutoSyncError(localize('turned off machine', \"Cannot sync because syncing is turned off on this machine from another machine.\"), UserDataSyncErrorCode.TurnedOff);\n\t\t}\n\n\t\tconst startTime = new Date().getTime();\n\t\tawait this.syncTask.run();\n\t\tthis.telemetryService.publicLog2<{\n\t\t\tduration: number;\n\t\t}, {\n\t\t\towner: 'sandy081';\n\t\t\tcomment: 'Report when running a sync operation';\n\t\t\tduration: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'Time taken to run sync operation' };\n\t\t}>('settingsSync:sync', { duration: new Date().getTime() - startTime });\n\n\t\t// After syncing, get the manifest if it was not available before\n\t\tif (this.manifest === null) {\n\t\t\ttry {\n\t\t\t\tthis.manifest = await this.userDataSyncStoreService.manifest(null);\n\t\t\t} catch (error) {\n\t\t\t\tthrow new UserDataAutoSyncError(toErrorMessage(error), error instanceof UserDataSyncError ? error.code : UserDataSyncErrorCode.Unknown);\n\t\t\t}\n\t\t}\n\n\t\t// Update local session id\n\t\tif (this.manifest && this.manifest.session !== sessionId) {\n\t\t\tthis.storageService.store(sessionIdKey, this.manifest.session, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t}\n\n\t\t// Return if cancellation is requested\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Add current machine\n\t\tif (!currentMachine) {\n\t\t\tawait this.userDataSyncMachinesService.addCurrentMachine(this.manifest || undefined);\n\t\t}\n\t}\n\n\tregister<T extends IDisposable>(t: T): T {\n\t\treturn super._register(t);\n\t}\n\n}\n"]}