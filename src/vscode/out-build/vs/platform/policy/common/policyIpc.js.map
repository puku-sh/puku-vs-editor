{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/policy/common/policyIpc.ts","vs/platform/policy/common/policyIpc.ts"],"names":[],"mappings":"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","file":"policyIpc.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { Event } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { PolicyName } from '../../../base/common/policy.js';\nimport { IChannel, IServerChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition, PolicyValue } from './policy.js';\n\n\nexport class PolicyChannel implements IServerChannel {\n\n\tprivate readonly disposables = new DisposableStore();\n\n\tconstructor(private service: IPolicyService) { }\n\n\tlisten(_: unknown, event: string): Event<any> {\n\t\tswitch (event) {\n\t\t\tcase 'onDidChange': return Event.map(\n\t\t\t\tthis.service.onDidChange,\n\t\t\t\tnames => names.reduce<object>((r, name) => ({ ...r, [name]: this.service.getPolicyValue(name) ?? null }), {}),\n\t\t\t\tthis.disposables\n\t\t\t);\n\t\t}\n\n\t\tthrow new Error(`Event not found: ${event}`);\n\t}\n\n\tcall(_: unknown, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\t\t\tcase 'updatePolicyDefinitions': return this.service.updatePolicyDefinitions(arg as IStringDictionary<PolicyDefinition>);\n\t\t}\n\n\t\tthrow new Error(`Call not found: ${command}`);\n\t}\n\n\tdispose() {\n\t\tthis.disposables.dispose();\n\t}\n}\n\nexport class PolicyChannelClient extends AbstractPolicyService implements IPolicyService {\n\n\tconstructor(policiesData: IStringDictionary<{ definition: PolicyDefinition; value: PolicyValue }>, private readonly channel: IChannel) {\n\t\tsuper();\n\t\tfor (const name in policiesData) {\n\t\t\tconst { definition, value } = policiesData[name];\n\t\t\tthis.policyDefinitions[name] = definition;\n\t\t\tif (value !== undefined) {\n\t\t\t\tthis.policies.set(name, value);\n\t\t\t}\n\t\t}\n\t\tthis.channel.listen<object>('onDidChange')(policies => {\n\t\t\tfor (const name in policies) {\n\t\t\t\tconst value = policies[name as keyof typeof policies];\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\tthis.policies.delete(name);\n\t\t\t\t} else {\n\t\t\t\t\tthis.policies.set(name, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._onDidChange.fire(Object.keys(policies));\n\t\t});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tconst result = await this.channel.call<{ [name: PolicyName]: PolicyValue }>('updatePolicyDefinitions', policyDefinitions);\n\t\tfor (const name in result) {\n\t\t\tthis.policies.set(name, result[name]);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { Event } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { PolicyName } from '../../../base/common/policy.js';\nimport { IChannel, IServerChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition, PolicyValue } from './policy.js';\n\n\nexport class PolicyChannel implements IServerChannel {\n\n\tprivate readonly disposables = new DisposableStore();\n\n\tconstructor(private service: IPolicyService) { }\n\n\tlisten(_: unknown, event: string): Event<any> {\n\t\tswitch (event) {\n\t\t\tcase 'onDidChange': return Event.map(\n\t\t\t\tthis.service.onDidChange,\n\t\t\t\tnames => names.reduce<object>((r, name) => ({ ...r, [name]: this.service.getPolicyValue(name) ?? null }), {}),\n\t\t\t\tthis.disposables\n\t\t\t);\n\t\t}\n\n\t\tthrow new Error(`Event not found: ${event}`);\n\t}\n\n\tcall(_: unknown, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\t\t\tcase 'updatePolicyDefinitions': return this.service.updatePolicyDefinitions(arg as IStringDictionary<PolicyDefinition>);\n\t\t}\n\n\t\tthrow new Error(`Call not found: ${command}`);\n\t}\n\n\tdispose() {\n\t\tthis.disposables.dispose();\n\t}\n}\n\nexport class PolicyChannelClient extends AbstractPolicyService implements IPolicyService {\n\n\tconstructor(policiesData: IStringDictionary<{ definition: PolicyDefinition; value: PolicyValue }>, private readonly channel: IChannel) {\n\t\tsuper();\n\t\tfor (const name in policiesData) {\n\t\t\tconst { definition, value } = policiesData[name];\n\t\t\tthis.policyDefinitions[name] = definition;\n\t\t\tif (value !== undefined) {\n\t\t\t\tthis.policies.set(name, value);\n\t\t\t}\n\t\t}\n\t\tthis.channel.listen<object>('onDidChange')(policies => {\n\t\t\tfor (const name in policies) {\n\t\t\t\tconst value = policies[name as keyof typeof policies];\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\tthis.policies.delete(name);\n\t\t\t\t} else {\n\t\t\t\t\tthis.policies.set(name, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._onDidChange.fire(Object.keys(policies));\n\t\t});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tconst result = await this.channel.call<{ [name: PolicyName]: PolicyValue }>('updatePolicyDefinitions', policyDefinitions);\n\t\tfor (const name in result) {\n\t\t\tthis.policies.set(name, result[name]);\n\t\t}\n\t}\n}\n"]}