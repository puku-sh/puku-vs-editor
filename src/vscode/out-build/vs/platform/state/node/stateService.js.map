{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/state/node/stateService.ts","vs/platform/state/node/stateService.ts"],"names":[],"mappings":"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","file":"stateService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ThrottledDelayer } from '../../../base/common/async.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isUndefined, isUndefinedOrNull } from '../../../base/common/types.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { FileOperationError, FileOperationResult, IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IStateReadService, IStateService } from './state.js';\n\ntype StorageDatabase = { [key: string]: unknown };\n\nexport const enum SaveStrategy {\n\tIMMEDIATE,\n\tDELAYED\n}\n\nexport class FileStorage extends Disposable {\n\n\tprivate storage: StorageDatabase = Object.create(null);\n\tprivate lastSavedStorageContents = '';\n\n\tprivate readonly flushDelayer: ThrottledDelayer<void>;\n\n\tprivate initializing: Promise<void> | undefined = undefined;\n\tprivate closing: Promise<void> | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly storagePath: URI,\n\t\tsaveStrategy: SaveStrategy,\n\t\tprivate readonly logService: ILogService,\n\t\tprivate readonly fileService: IFileService,\n\t) {\n\t\tsuper();\n\n\t\tthis.flushDelayer = this._register(new ThrottledDelayer<void>(saveStrategy === SaveStrategy.IMMEDIATE ? 0 : 100 /* buffer saves over a short time */));\n\t}\n\n\tinit(): Promise<void> {\n\t\tif (!this.initializing) {\n\t\t\tthis.initializing = this.doInit();\n\t\t}\n\n\t\treturn this.initializing;\n\t}\n\n\tprivate async doInit(): Promise<void> {\n\t\ttry {\n\t\t\tthis.lastSavedStorageContents = (await this.fileService.readFile(this.storagePath)).value.toString();\n\t\t\tthis.storage = JSON.parse(this.lastSavedStorageContents);\n\t\t} catch (error) {\n\t\t\tif ((<FileOperationError>error).fileOperationResult !== FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetItem<T>(key: string, defaultValue: T): T;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined {\n\t\tconst res = this.storage[key];\n\t\tif (isUndefinedOrNull(res)) {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn res as T;\n\t}\n\n\tsetItem(key: string, data?: object | string | number | boolean | undefined | null): void {\n\t\tthis.setItems([{ key, data }]);\n\t}\n\n\tsetItems(items: readonly { key: string; data?: object | string | number | boolean | undefined | null }[]): void {\n\t\tlet save = false;\n\n\t\tfor (const { key, data } of items) {\n\n\t\t\t// Shortcut for data that did not change\n\t\t\tif (this.storage[key] === data) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Remove items when they are undefined or null\n\t\t\tif (isUndefinedOrNull(data)) {\n\t\t\t\tif (!isUndefined(this.storage[key])) {\n\t\t\t\t\tthis.storage[key] = undefined;\n\t\t\t\t\tsave = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Otherwise add an item\n\t\t\telse {\n\t\t\t\tthis.storage[key] = data;\n\t\t\t\tsave = true;\n\t\t\t}\n\t\t}\n\n\t\tif (save) {\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tremoveItem(key: string): void {\n\n\t\t// Only update if the key is actually present (not undefined)\n\t\tif (!isUndefined(this.storage[key])) {\n\t\t\tthis.storage[key] = undefined;\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tprivate async save(): Promise<void> {\n\t\tif (this.closing) {\n\t\t\treturn; // already about to close\n\t\t}\n\n\t\treturn this.flushDelayer.trigger(() => this.doSave());\n\t}\n\n\tprivate async doSave(): Promise<void> {\n\t\tif (!this.initializing) {\n\t\t\treturn; // if we never initialized, we should not save our state\n\t\t}\n\n\t\t// Make sure to wait for init to finish first\n\t\tawait this.initializing;\n\n\t\t// Return early if the database has not changed\n\t\tconst serializedDatabase = JSON.stringify(this.storage, null, 4);\n\t\tif (serializedDatabase === this.lastSavedStorageContents) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Write to disk\n\t\ttry {\n\t\t\tawait this.fileService.writeFile(this.storagePath, VSBuffer.fromString(serializedDatabase), { atomic: { postfix: '.vsctmp' } });\n\t\t\tthis.lastSavedStorageContents = serializedDatabase;\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t}\n\t}\n\n\tasync close(): Promise<void> {\n\t\tif (!this.closing) {\n\t\t\tthis.closing = this.flushDelayer.trigger(() => this.doSave(), 0 /* as soon as possible */);\n\t\t}\n\n\t\treturn this.closing;\n\t}\n}\n\nexport class StateReadonlyService extends Disposable implements IStateReadService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprotected readonly fileStorage: FileStorage;\n\n\tconstructor(\n\t\tsaveStrategy: SaveStrategy,\n\t\t@IEnvironmentService environmentService: IEnvironmentService,\n\t\t@ILogService logService: ILogService,\n\t\t@IFileService fileService: IFileService\n\t) {\n\t\tsuper();\n\n\t\tthis.fileStorage = this._register(new FileStorage(environmentService.stateResource, saveStrategy, logService, fileService));\n\t}\n\n\tasync init(): Promise<void> {\n\t\tawait this.fileStorage.init();\n\t}\n\n\tgetItem<T>(key: string, defaultValue: T): T;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined {\n\t\treturn this.fileStorage.getItem(key, defaultValue);\n\t}\n}\n\nexport class StateService extends StateReadonlyService implements IStateService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tsetItem(key: string, data?: object | string | number | boolean | undefined | null): void {\n\t\tthis.fileStorage.setItem(key, data);\n\t}\n\n\tsetItems(items: readonly { key: string; data?: object | string | number | boolean | undefined | null }[]): void {\n\t\tthis.fileStorage.setItems(items);\n\t}\n\n\tremoveItem(key: string): void {\n\t\tthis.fileStorage.removeItem(key);\n\t}\n\n\tclose(): Promise<void> {\n\t\treturn this.fileStorage.close();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ThrottledDelayer } from '../../../base/common/async.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { isUndefined, isUndefinedOrNull } from '../../../base/common/types.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { FileOperationError, FileOperationResult, IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IStateReadService, IStateService } from './state.js';\n\ntype StorageDatabase = { [key: string]: unknown };\n\nexport const enum SaveStrategy {\n\tIMMEDIATE,\n\tDELAYED\n}\n\nexport class FileStorage extends Disposable {\n\n\tprivate storage: StorageDatabase = Object.create(null);\n\tprivate lastSavedStorageContents = '';\n\n\tprivate readonly flushDelayer: ThrottledDelayer<void>;\n\n\tprivate initializing: Promise<void> | undefined = undefined;\n\tprivate closing: Promise<void> | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly storagePath: URI,\n\t\tsaveStrategy: SaveStrategy,\n\t\tprivate readonly logService: ILogService,\n\t\tprivate readonly fileService: IFileService,\n\t) {\n\t\tsuper();\n\n\t\tthis.flushDelayer = this._register(new ThrottledDelayer<void>(saveStrategy === SaveStrategy.IMMEDIATE ? 0 : 100 /* buffer saves over a short time */));\n\t}\n\n\tinit(): Promise<void> {\n\t\tif (!this.initializing) {\n\t\t\tthis.initializing = this.doInit();\n\t\t}\n\n\t\treturn this.initializing;\n\t}\n\n\tprivate async doInit(): Promise<void> {\n\t\ttry {\n\t\t\tthis.lastSavedStorageContents = (await this.fileService.readFile(this.storagePath)).value.toString();\n\t\t\tthis.storage = JSON.parse(this.lastSavedStorageContents);\n\t\t} catch (error) {\n\t\t\tif ((<FileOperationError>error).fileOperationResult !== FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetItem<T>(key: string, defaultValue: T): T;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined {\n\t\tconst res = this.storage[key];\n\t\tif (isUndefinedOrNull(res)) {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn res as T;\n\t}\n\n\tsetItem(key: string, data?: object | string | number | boolean | undefined | null): void {\n\t\tthis.setItems([{ key, data }]);\n\t}\n\n\tsetItems(items: readonly { key: string; data?: object | string | number | boolean | undefined | null }[]): void {\n\t\tlet save = false;\n\n\t\tfor (const { key, data } of items) {\n\n\t\t\t// Shortcut for data that did not change\n\t\t\tif (this.storage[key] === data) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Remove items when they are undefined or null\n\t\t\tif (isUndefinedOrNull(data)) {\n\t\t\t\tif (!isUndefined(this.storage[key])) {\n\t\t\t\t\tthis.storage[key] = undefined;\n\t\t\t\t\tsave = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Otherwise add an item\n\t\t\telse {\n\t\t\t\tthis.storage[key] = data;\n\t\t\t\tsave = true;\n\t\t\t}\n\t\t}\n\n\t\tif (save) {\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tremoveItem(key: string): void {\n\n\t\t// Only update if the key is actually present (not undefined)\n\t\tif (!isUndefined(this.storage[key])) {\n\t\t\tthis.storage[key] = undefined;\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tprivate async save(): Promise<void> {\n\t\tif (this.closing) {\n\t\t\treturn; // already about to close\n\t\t}\n\n\t\treturn this.flushDelayer.trigger(() => this.doSave());\n\t}\n\n\tprivate async doSave(): Promise<void> {\n\t\tif (!this.initializing) {\n\t\t\treturn; // if we never initialized, we should not save our state\n\t\t}\n\n\t\t// Make sure to wait for init to finish first\n\t\tawait this.initializing;\n\n\t\t// Return early if the database has not changed\n\t\tconst serializedDatabase = JSON.stringify(this.storage, null, 4);\n\t\tif (serializedDatabase === this.lastSavedStorageContents) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Write to disk\n\t\ttry {\n\t\t\tawait this.fileService.writeFile(this.storagePath, VSBuffer.fromString(serializedDatabase), { atomic: { postfix: '.vsctmp' } });\n\t\t\tthis.lastSavedStorageContents = serializedDatabase;\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t}\n\t}\n\n\tasync close(): Promise<void> {\n\t\tif (!this.closing) {\n\t\t\tthis.closing = this.flushDelayer.trigger(() => this.doSave(), 0 /* as soon as possible */);\n\t\t}\n\n\t\treturn this.closing;\n\t}\n}\n\nexport class StateReadonlyService extends Disposable implements IStateReadService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprotected readonly fileStorage: FileStorage;\n\n\tconstructor(\n\t\tsaveStrategy: SaveStrategy,\n\t\t@IEnvironmentService environmentService: IEnvironmentService,\n\t\t@ILogService logService: ILogService,\n\t\t@IFileService fileService: IFileService\n\t) {\n\t\tsuper();\n\n\t\tthis.fileStorage = this._register(new FileStorage(environmentService.stateResource, saveStrategy, logService, fileService));\n\t}\n\n\tasync init(): Promise<void> {\n\t\tawait this.fileStorage.init();\n\t}\n\n\tgetItem<T>(key: string, defaultValue: T): T;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined;\n\tgetItem<T>(key: string, defaultValue?: T): T | undefined {\n\t\treturn this.fileStorage.getItem(key, defaultValue);\n\t}\n}\n\nexport class StateService extends StateReadonlyService implements IStateService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tsetItem(key: string, data?: object | string | number | boolean | undefined | null): void {\n\t\tthis.fileStorage.setItem(key, data);\n\t}\n\n\tsetItems(items: readonly { key: string; data?: object | string | number | boolean | undefined | null }[]): void {\n\t\tthis.fileStorage.setItems(items);\n\t}\n\n\tremoveItem(key: string): void {\n\t\tthis.fileStorage.removeItem(key);\n\t}\n\n\tclose(): Promise<void> {\n\t\treturn this.fileStorage.close();\n\t}\n}\n"]}