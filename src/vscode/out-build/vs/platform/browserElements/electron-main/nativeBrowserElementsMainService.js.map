{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/browserElements/electron-main/nativeBrowserElementsMainService.ts","vs/platform/browserElements/electron-main/nativeBrowserElementsMainService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,WAAW,EAA+C,MAAM,8BAA8B,CAAC;AAGxG,OAAO,EAAiB,WAAW,EAAE,MAAM,UAAU,CAAC;AAGtD,OAAO,EAAE,4BAA4B,EAAE,MAAM,yDAAyD,CAAC;AACvG,OAAO,EAAE,mBAAmB,EAAE,MAAM,wCAAwC,CAAC;AAC7E,OAAO,EAAE,eAAe,EAAE,MAAM,6CAA6C,CAAC;AAC9E,OAAO,EAAE,UAAU,EAAE,MAAM,mCAAmC,CAAC;AAG/D,MAAM,CAAC,MAAM,iCAAiC,GAAG,eAAe,CAAoC,4BAA4B,CAAC,CAAC;AAS3H,IAAM,gCAAgC,GAAtC,MAAM,gCAAiC,SAAQ,UAAU;IAK/D,YACuC,kBAAuC,EAC9B,2BAAyD;QAGxG,KAAK,EAAE,CAAC;QAJ8B,uBAAkB,GAAlB,kBAAkB,CAAqB;QAC9B,gCAA2B,GAA3B,2BAA2B,CAA8B;IAIzG,CAAC;IAED,IAAI,QAAQ,KAAY,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC,CAAC,CAAC;IAE9E,KAAK,CAAC,iBAAiB,CAAC,SAAc,EAAE,QAAgB,EAAE,WAAwB;QACjF,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;QACzE,IAAI,MAAM,GAA2C,SAAS,CAAC;QAC/D,MAAM,cAAc,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,UAA2B,EAAE,EAAE;YACvE,IAAI,CAAC;gBACJ,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBACpC,IAAI,WAAW,KAAK,WAAW,CAAC,UAAU,EAAE,CAAC;oBAC5C,OAAO,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,CAAC,KAAK,uBAAuB,CAAC;gBACtG,CAAC;qBAAM,IAAI,WAAW,KAAK,WAAW,CAAC,aAAa,EAAE,CAAC;oBACtD,OAAO,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,QAAQ,CAAC,QAAQ,EAAE,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,CAAC,KAAK,uBAAuB,CAAC;gBACpI,CAAC;gBACD,OAAO,KAAK,CAAC;YACd,CAAC;YAAC,OAAO,GAAG,EAAE,CAAC;gBACd,OAAO,KAAK,CAAC;YACd,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,2CAA2C;QAC3C,IAAI,cAAc,EAAE,CAAC;YACpB,IAAI,QAA4B,CAAC;YACjC,IAAI,GAAoB,CAAC;YACzB,IAAI,CAAC;gBACJ,GAAG,GAAG,IAAI,GAAG,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;gBAClC,QAAQ,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAE,CAAC;YACxC,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACZ,OAAO,SAAS,CAAC;YAClB,CAAC;YAED,MAAM,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,UAA2B,EAAE,EAAE;gBACzD,IAAI,CAAC;oBACJ,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oBACpC,MAAM,YAAY,GAAG,WAAW,KAAK,WAAW,CAAC,UAAU,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,gBAAgB,CAAC,KAAK,QAAQ,CAAC;oBACnH,MAAM,eAAe,GAAG,WAAW,KAAK,WAAW,CAAC,aAAa,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,QAAQ,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;oBAC3J,IAAI,YAAY,IAAI,eAAe,EAAE,CAAC;wBACrC,IAAI,CAAC,mBAAmB,GAAG,GAAG,CAAC,MAAM,CAAC;wBACtC,OAAO,IAAI,CAAC;oBACb,CAAC;oBACD,OAAO,KAAK,CAAC;gBACd,CAAC;gBAAC,OAAO,CAAC,EAAE,CAAC;oBACZ,OAAO,KAAK,CAAC;gBACd,CAAC;YACF,CAAC,CAAC,CAAC;YAEH,IAAI,MAAM,EAAE,CAAC;gBACZ,OAAO,MAAM,CAAC,QAAQ,CAAC;YACxB,CAAC;QACF,CAAC;QAED,0EAA0E;QAC1E,MAAM,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,UAA2B,EAAE,EAAE;YACzD,IAAI,CAAC;gBACJ,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBACpC,OAAO,CAAC,IAAI,CAAC,mBAAmB,KAAK,GAAG,CAAC,MAAM,CAAC,CAAC;YAClD,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACZ,OAAO,KAAK,CAAC;YACd,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,MAAM,EAAE,CAAC;YACb,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,OAAO,MAAM,CAAC,QAAQ,CAAC;IACxB,CAAC;IAED,KAAK,CAAC,qBAAqB,CAAC,SAAc,EAAE,QAAgB,EAAE,WAAwB;QACrF,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACzB,MAAM,OAAO,GAAG,KAAK,CAAC;QAEtB,OAAO,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,GAAG,OAAO,EAAE,CAAC;YACrC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC;YAChF,IAAI,QAAQ,EAAE,CAAC;gBACd,OAAO,QAAQ,CAAC;YACjB,CAAC;YAED,gDAAgD;YAChD,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;QACxD,CAAC;QAED,SAAS,CAAC,MAAM,EAAE,CAAC;QACnB,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,QAA4B,EAAE,KAAwB,EAAE,WAAwB,EAAE,iBAA0B;QACnI,MAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QACzC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC;YAClB,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,kCAAkC;QAClC,MAAM,cAAc,GAAG,WAAW,CAAC,iBAAiB,EAAE,CAAC;QACvD,MAAM,oBAAoB,GAAG,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;QAE5F,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC3B,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,SAAS,GAAG,oBAAoB,CAAC,QAAQ,CAAC;QAChD,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC;YAC7B,SAAS,CAAC,MAAM,EAAE,CAAC;QACpB,CAAC;QAED,IAAI,CAAC;YACJ,MAAM,gBAAgB,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,SAAS,EAAE,QAAS,EAAE,WAAW,CAAC,CAAC;YAC7F,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBACvB,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC;oBAC5B,SAAS,CAAC,MAAM,EAAE,CAAC;gBACpB,CAAC;gBACD,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;YACpC,CAAC;QAEF,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC;gBAC5B,SAAS,CAAC,MAAM,EAAE,CAAC;YACpB,CAAC;YACD,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;QACpC,CAAC;QAED,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,aAAa,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,uBAAuB,EAAE,EAAE;YAC1F,IAAI,OAAO,KAAK,8BAA8B,iBAAiB,EAAE,EAAE,CAAC;gBACnE,IAAI,iBAAiB,KAAK,uBAAuB,EAAE,CAAC;oBACnD,OAAO;gBACR,CAAC;gBACD,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC;oBAC5B,SAAS,CAAC,MAAM,EAAE,CAAC;gBACpB,CAAC;gBACD,IAAI,MAAM,CAAC,GAAG,EAAE,CAAC;oBAChB,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;gBAC1D,CAAC;YACF,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,SAAc,EAAE,SAA6B;QAChE,IAAI,SAAS,CAAC,UAAU,EAAE,IAAI,SAAS,EAAE,CAAC;YACzC,MAAM,SAAS,CAAC,WAAW,CAAC,wBAAwB,EAAE;gBACrD,IAAI,EAAE,MAAM;gBACZ,eAAe,EAAE;oBAChB,QAAQ,EAAE,KAAK;oBACf,UAAU,EAAE,KAAK;iBACjB;aACD,EAAE,SAAS,CAAC,CAAC;YACd,MAAM,SAAS,CAAC,WAAW,CAAC,uBAAuB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YACpE,MAAM,SAAS,CAAC,WAAW,CAAC,iBAAiB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YAC9D,SAAS,CAAC,MAAM,EAAE,CAAC;QACpB,CAAC;IACF,CAAC;IAED,KAAK,CAAC,cAAc,CAAC,QAA4B,EAAE,IAAgB,EAAE,KAAwB,EAAE,WAAwB,EAAE,cAAuB;QAC/I,MAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QACzC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC;YAClB,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,kCAAkC;QAClC,MAAM,cAAc,GAAG,WAAW,CAAC,iBAAiB,EAAE,CAAC;QACvD,MAAM,oBAAoB,GAAG,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;QAE5F,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC3B,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,SAAS,GAAG,oBAAoB,CAAC,QAAQ,CAAC;QAChD,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,CAAC;YAC7B,SAAS,CAAC,MAAM,EAAE,CAAC;QACpB,CAAC;QAED,IAAI,eAAe,GAAuB,SAAS,CAAC;QACpD,IAAI,CAAC;YACJ,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,QAAS,EAAE,WAAW,CAAC,CAAC;YACjF,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,uBAAuB,EAAE;gBAC1E,QAAQ,EAAE,QAAQ;gBAClB,OAAO,EAAE,IAAI;aACb,CAAC,CAAC;YAEH,eAAe,GAAG,SAAS,CAAC;YAE5B,MAAM,SAAS,CAAC,WAAW,CAAC,YAAY,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YACzD,MAAM,SAAS,CAAC,WAAW,CAAC,YAAY,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YACzD,MAAM,SAAS,CAAC,WAAW,CAAC,gBAAgB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YAC7D,MAAM,SAAS,CAAC,WAAW,CAAC,iBAAiB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YAC9D,MAAM,SAAS,CAAC,WAAW,CAAC,gBAAgB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;YAE7D,MAAM,SAAS,CAAC,WAAW,CAAC,kBAAkB,EAAE;gBAC/C,UAAU,EAAE;;;;;YAKJ;aACR,EAAE,SAAS,CAAC,CAAC;YAEd,uDAAuD;YACvD,MAAM,SAAS,CAAC,WAAW,CAAC,wBAAwB,EAAE;gBACrD,IAAI,EAAE,eAAe;gBACrB,eAAe,EAAE;oBAChB,QAAQ,EAAE,IAAI;oBACd,UAAU,EAAE,KAAK;oBACjB,UAAU,EAAE,IAAI;oBAChB,qBAAqB,EAAE,IAAI;oBAC3B,kBAAkB,EAAE,KAAK;oBACzB,iBAAiB,EAAE,IAAI;oBACvB,YAAY,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBAChD,YAAY,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBAChD,WAAW,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBAC/C,WAAW,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBAC/C,gBAAgB,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBACpD,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBAC9C,gBAAgB,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;oBACpD,mBAAmB,EAAE;wBACpB,WAAW,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBAC/C,aAAa,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBACjD,cAAc,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBAClD,gBAAgB,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBACpD,YAAY,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBACxC,eAAe,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;wBAC3C,WAAW,EAAE,IAAI;wBACjB,cAAc,EAAE,IAAI;qBACpB;oBACD,4BAA4B,EAAE;wBAC7B,eAAe,EAAE;4BAChB,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BACjC,OAAO,EAAE,OAAO;yBAChB;wBACD,aAAa,EAAE;4BACd,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BACjC,OAAO,EAAE,OAAO;yBAChB;wBACD,aAAa,EAAE;4BACd,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BACjC,OAAO,EAAE,OAAO;yBAChB;wBACD,oBAAoB,EAAE;4BACrB,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BAC9C,SAAS,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBAC7C;wBACD,qBAAqB,EAAE;4BACtB,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BAC9C,SAAS,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBAC7C;wBACD,WAAW,EAAE;4BACZ,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BAC9C,SAAS,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBAC7C;wBACD,cAAc,EAAE;4BACf,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BAC9C,SAAS,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBAC7C;qBACD;oBACD,uBAAuB,EAAE;wBACxB,WAAW,EAAE;4BACZ,UAAU,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBAC9C;wBACD,cAAc,EAAE;4BACf,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;4BACjC,OAAO,EAAE,OAAO;yBAChB;wBACD,gBAAgB,EAAE;4BACjB,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;yBACjC;qBACD;iBACD;aACD,EAAE,SAAS,CAAC,CAAC;QACf,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,SAAS,CAAC,MAAM,EAAE,CAAC;YACnB,MAAM,IAAI,KAAK,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC;QACvC,CAAC;QAED,IAAI,CAAC,eAAe,EAAE,CAAC;YACtB,SAAS,CAAC,MAAM,EAAE,CAAC;YACnB,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;QAC/C,CAAC;QAED,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE,SAAS,EAAE,MAAM,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;QAChG,MAAM,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;QAErD,MAAM,UAAU,GAAG,oBAAoB,CAAC,aAAa,EAAE,CAAC;QACxD,MAAM,cAAc,GAAG;YACtB,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC7B,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC7B,KAAK,EAAE,QAAQ,CAAC,MAAM,CAAC,KAAK;YAC5B,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,MAAM;SAC9B,CAAC;QAEF,MAAM,aAAa,GAAG;YACrB,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;YACrC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;YACrC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,GAAG,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;YAC/H,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;SAClI,CAAC;QAEF,MAAM,YAAY,GAAG;YACpB,CAAC,EAAE,aAAa,CAAC,CAAC,GAAG,UAAU;YAC/B,CAAC,EAAE,aAAa,CAAC,CAAC,GAAG,UAAU;YAC/B,KAAK,EAAE,aAAa,CAAC,KAAK,GAAG,UAAU;YACvC,MAAM,EAAE,aAAa,CAAC,MAAM,GAAG,UAAU;SACzC,CAAC;QAEF,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC,SAAS,EAAE,aAAa,EAAE,QAAQ,CAAC,aAAa,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC;IACvG,CAAC;IAED,KAAK,CAAC,WAAW,CAAC,SAAiB,EAAE,SAAc,EAAE,MAAqB,EAAE,cAAuB;QAClG,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACtC,MAAM,SAAS,GAAG,KAAK,EAAE,KAAU,EAAE,MAAc,EAAE,MAAiC,EAAE,EAAE;gBACzF,IAAI,MAAM,KAAK,8BAA8B,EAAE,CAAC;oBAC/C,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;oBACpC,MAAM,SAAS,CAAC,WAAW,CAAC,kBAAkB,EAAE;wBAC/C,UAAU,EAAE;;;eAGH;qBACT,EAAE,SAAS,CAAC,CAAC;oBAEd,MAAM,aAAa,GAAG,MAAM,EAAE,aAAa,CAAC;oBAC5C,IAAI,CAAC,aAAa,EAAE,CAAC;wBACpB,MAAM,IAAI,KAAK,CAAC,qDAAqD,CAAC,CAAC;oBACxE,CAAC;oBAED,IAAI,CAAC;wBACJ,MAAM,SAAS,CAAC,WAAW,CAAC,iBAAiB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;wBAC9D,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,qCAAqC,EAAE,EAAE,cAAc,EAAE,CAAC,aAAa,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;wBACvI,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;4BACtC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;wBAC5C,CAAC;wBACD,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;wBAE1B,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,iBAAiB,EAAE,EAAE,MAAM,EAAE,EAAE,SAAS,CAAC,CAAC;wBACxF,IAAI,CAAC,KAAK,EAAE,CAAC;4BACZ,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;wBAC7C,CAAC;wBAED,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;wBAC9B,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;wBAC5B,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC1C,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,kCAAkC;wBACpF,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;wBACvE,MAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;wBAExE,MAAM,OAAO,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,6BAA6B,EAAE,EAAE,MAAM,EAAE,EAAE,SAAS,CAAC,CAAC;wBAClG,IAAI,CAAC,OAAO,EAAE,CAAC;4BACd,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;wBAC/C,CAAC;wBAED,MAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;wBACpD,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,kBAAkB,EAAE,EAAE,MAAM,EAAE,EAAE,SAAS,CAAC,CAAC;wBAC7F,IAAI,CAAC,SAAS,EAAE,CAAC;4BAChB,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;wBAC7C,CAAC;wBAED,OAAO,CAAC;4BACP,SAAS;4BACT,aAAa,EAAE,SAAS;4BACxB,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE;yBAC/B,CAAC,CAAC;oBACJ,CAAC;oBAAC,OAAO,GAAG,EAAE,CAAC;wBACd,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;wBACpC,SAAS,CAAC,MAAM,EAAE,CAAC;wBACnB,MAAM,CAAC,GAAG,CAAC,CAAC;oBACb,CAAC;gBACF,CAAC;YACF,CAAC,CAAC;YAEF,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,aAAa,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,oBAAoB,EAAE,EAAE;gBACnF,IAAI,OAAO,KAAK,gCAAgC,cAAc,EAAE,EAAE,CAAC;oBAClE,IAAI,cAAc,KAAK,oBAAoB,EAAE,CAAC;wBAC7C,OAAO;oBACR,CAAC;oBACD,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;oBACpC,MAAM,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;oBAC/C,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;gBACtD,CAAC;YACF,CAAC,CAAC,CAAC;YAEH,SAAS,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QACpC,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,mBAAmB,CAAC,OAAY;QAC/B,MAAM,KAAK,GAAa,EAAE,CAAC;QAE3B,SAAS;QACT,IAAI,OAAO,CAAC,WAAW,EAAE,aAAa,EAAE,MAAM,EAAE,CAAC;YAChD,KAAK,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;YACjC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACxB,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC;gBACtD,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;oBAC7B,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;gBAC9C,CAAC;YACF,CAAC;YACD,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACnB,CAAC;QAED,UAAU;QACV,IAAI,OAAO,CAAC,eAAe,EAAE,MAAM,EAAE,CAAC;YACrC,KAAK,MAAM,SAAS,IAAI,OAAO,CAAC,eAAe,EAAE,CAAC;gBACjD,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;gBAC5B,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACjF,KAAK,CAAC,IAAI,CAAC,wBAAwB,IAAI,CAAC,MAAM,KAAK,CAAC,CAAC;gBACrD,KAAK,CAAC,IAAI,CAAC,GAAG,SAAS,IAAI,CAAC,CAAC;gBAC7B,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;oBAC7C,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;wBAC7B,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;oBAC9C,CAAC;gBACF,CAAC;gBACD,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACnB,CAAC;QACF,CAAC;QAED,kBAAkB;QAClB,IAAI,OAAO,CAAC,SAAS,EAAE,MAAM,EAAE,CAAC;YAC/B,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,KAAK,MAAM,SAAS,IAAI,OAAO,CAAC,SAAS,EAAE,CAAC;gBAC3C,MAAM,KAAK,GAAG,SAAS,CAAC,eAAe,IAAI,EAAE,CAAC;gBAC9C,KAAK,MAAM,SAAS,IAAI,KAAK,EAAE,CAAC;oBAC/B,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;oBAC5B,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACjF,KAAK,CAAC,IAAI,CAAC,oCAAoC,KAAK,KAAK,IAAI,CAAC,MAAM,MAAM,CAAC,CAAC;oBAC5E,KAAK,CAAC,IAAI,CAAC,GAAG,SAAS,IAAI,CAAC,CAAC;oBAC7B,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;wBAC7C,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;4BAC7B,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;wBAC9C,CAAC;oBACF,CAAC;oBACD,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACnB,CAAC;gBACD,KAAK,EAAE,CAAC;YACT,CAAC;QACF,CAAC;QAED,OAAO,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAEO,UAAU,CAAC,QAA4B,EAAE,oBAA6B;QAC7E,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,CAAC;IACzH,CAAC;IAEO,cAAc,CAAC,QAA4B;QAClD,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE,CAAC;YAClC,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,OAAO,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IACxD,CAAC;IAEO,mBAAmB,CAAC,QAA4B;QACvD,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE,CAAC;YAClC,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC9C,IAAI,CAAC,QAAQ,EAAE,CAAC;YACf,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,OAAO,IAAI,CAAC,2BAA2B,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC;IAC1E,CAAC;CACD,CAAA;AAvdY,gCAAgC;IAM1C,WAAA,mBAAmB,CAAA;IACnB,WAAA,4BAA4B,CAAA;GAPlB,gCAAgC,CAud5C","file":"nativeBrowserElementsMainService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { BrowserType, IElementData, INativeBrowserElementsService } from '../common/browserElements.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { IRectangle } from '../../window/common/window.js';\nimport { BrowserWindow, webContents } from 'electron';\nimport { IAuxiliaryWindow } from '../../auxiliaryWindow/electron-main/auxiliaryWindow.js';\nimport { ICodeWindow } from '../../window/electron-main/window.js';\nimport { IAuxiliaryWindowsMainService } from '../../auxiliaryWindow/electron-main/auxiliaryWindows.js';\nimport { IWindowsMainService } from '../../windows/electron-main/windows.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { AddFirstParameterToFunctions } from '../../../base/common/types.js';\n\nexport const INativeBrowserElementsMainService = createDecorator<INativeBrowserElementsMainService>('browserElementsMainService');\nexport interface INativeBrowserElementsMainService extends AddFirstParameterToFunctions<INativeBrowserElementsService, Promise<unknown> /* only methods, not events */, number | undefined /* window ID */> { }\n\ninterface NodeDataResponse {\n\touterHTML: string;\n\tcomputedStyle: string;\n\tbounds: IRectangle;\n}\n\nexport class NativeBrowserElementsMainService extends Disposable implements INativeBrowserElementsMainService {\n\t_serviceBrand: undefined;\n\n\tcurrentLocalAddress: string | undefined;\n\n\tconstructor(\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t\t@IAuxiliaryWindowsMainService private readonly auxiliaryWindowsMainService: IAuxiliaryWindowsMainService,\n\n\t) {\n\t\tsuper();\n\t}\n\n\tget windowId(): never { throw new Error('Not implemented in electron-main'); }\n\n\tasync findWebviewTarget(debuggers: any, windowId: number, browserType: BrowserType): Promise<string | undefined> {\n\t\tconst { targetInfos } = await debuggers.sendCommand('Target.getTargets');\n\t\tlet target: typeof targetInfos[number] | undefined = undefined;\n\t\tconst matchingTarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\ttry {\n\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\tif (browserType === BrowserType.LiveServer) {\n\t\t\t\t\treturn url.searchParams.get('id') && url.searchParams.get('extensionId') === 'ms-vscode.live-server';\n\t\t\t\t} else if (browserType === BrowserType.SimpleBrowser) {\n\t\t\t\t\treturn url.searchParams.get('parentId') === windowId.toString() && url.searchParams.get('extensionId') === 'vscode.simple-browser';\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} catch (err) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\t// search for webview via search parameters\n\t\tif (matchingTarget) {\n\t\t\tlet resultId: string | undefined;\n\t\t\tlet url: URL | undefined;\n\t\t\ttry {\n\t\t\t\turl = new URL(matchingTarget.url);\n\t\t\t\tresultId = url.searchParams.get('id')!;\n\t\t\t} catch (e) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\ttarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\t\tconst isLiveServer = browserType === BrowserType.LiveServer && url.searchParams.get('serverWindowId') === resultId;\n\t\t\t\t\tconst isSimpleBrowser = browserType === BrowserType.SimpleBrowser && url.searchParams.get('id') === resultId && url.searchParams.has('vscodeBrowserReqId');\n\t\t\t\t\tif (isLiveServer || isSimpleBrowser) {\n\t\t\t\t\t\tthis.currentLocalAddress = url.origin;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (target) {\n\t\t\t\treturn target.targetId;\n\t\t\t}\n\t\t}\n\n\t\t// fallback: search for webview without parameters based on current origin\n\t\ttarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\ttry {\n\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\treturn (this.currentLocalAddress === url.origin);\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tif (!target) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn target.targetId;\n\t}\n\n\tasync waitForWebviewTargets(debuggers: any, windowId: number, browserType: BrowserType): Promise<any> {\n\t\tconst start = Date.now();\n\t\tconst timeout = 10000;\n\n\t\twhile (Date.now() - start < timeout) {\n\t\t\tconst targetId = await this.findWebviewTarget(debuggers, windowId, browserType);\n\t\t\tif (targetId) {\n\t\t\t\treturn targetId;\n\t\t\t}\n\n\t\t\t// Wait for a short period before checking again\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 500));\n\t\t}\n\n\t\tdebuggers.detach();\n\t\treturn undefined;\n\t}\n\n\tasync startDebugSession(windowId: number | undefined, token: CancellationToken, browserType: BrowserType, cancelAndDetachId?: number): Promise<void> {\n\t\tconst window = this.windowById(windowId);\n\t\tif (!window?.win) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Find the simple browser webview\n\t\tconst allWebContents = webContents.getAllWebContents();\n\t\tconst simpleBrowserWebview = allWebContents.find(webContent => webContent.id === window.id);\n\n\t\tif (!simpleBrowserWebview) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst debuggers = simpleBrowserWebview.debugger;\n\t\tif (!debuggers.isAttached()) {\n\t\t\tdebuggers.attach();\n\t\t}\n\n\t\ttry {\n\t\t\tconst matchingTargetId = await this.waitForWebviewTargets(debuggers, windowId!, browserType);\n\t\t\tif (!matchingTargetId) {\n\t\t\t\tif (debuggers.isAttached()) {\n\t\t\t\t\tdebuggers.detach();\n\t\t\t\t}\n\t\t\t\tthrow new Error('No target found');\n\t\t\t}\n\n\t\t} catch (e) {\n\t\t\tif (debuggers.isAttached()) {\n\t\t\t\tdebuggers.detach();\n\t\t\t}\n\t\t\tthrow new Error('No target found');\n\t\t}\n\n\t\twindow.win.webContents.on('ipc-message', async (event, channel, closedCancelAndDetachId) => {\n\t\t\tif (channel === `vscode:cancelCurrentSession${cancelAndDetachId}`) {\n\t\t\t\tif (cancelAndDetachId !== closedCancelAndDetachId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (debuggers.isAttached()) {\n\t\t\t\t\tdebuggers.detach();\n\t\t\t\t}\n\t\t\t\tif (window.win) {\n\t\t\t\t\twindow.win.webContents.removeAllListeners('ipc-message');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tasync finishOverlay(debuggers: any, sessionId: string | undefined): Promise<void> {\n\t\tif (debuggers.isAttached() && sessionId) {\n\t\t\tawait debuggers.sendCommand('Overlay.setInspectMode', {\n\t\t\t\tmode: 'none',\n\t\t\t\thighlightConfig: {\n\t\t\t\t\tshowInfo: false,\n\t\t\t\t\tshowStyles: false\n\t\t\t\t}\n\t\t\t}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.hideHighlight', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.disable', {}, sessionId);\n\t\t\tdebuggers.detach();\n\t\t}\n\t}\n\n\tasync getElementData(windowId: number | undefined, rect: IRectangle, token: CancellationToken, browserType: BrowserType, cancellationId?: number): Promise<IElementData | undefined> {\n\t\tconst window = this.windowById(windowId);\n\t\tif (!window?.win) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Find the simple browser webview\n\t\tconst allWebContents = webContents.getAllWebContents();\n\t\tconst simpleBrowserWebview = allWebContents.find(webContent => webContent.id === window.id);\n\n\t\tif (!simpleBrowserWebview) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst debuggers = simpleBrowserWebview.debugger;\n\t\tif (!debuggers.isAttached()) {\n\t\t\tdebuggers.attach();\n\t\t}\n\n\t\tlet targetSessionId: string | undefined = undefined;\n\t\ttry {\n\t\t\tconst targetId = await this.findWebviewTarget(debuggers, windowId!, browserType);\n\t\t\tconst { sessionId } = await debuggers.sendCommand('Target.attachToTarget', {\n\t\t\t\ttargetId: targetId,\n\t\t\t\tflatten: true,\n\t\t\t});\n\n\t\t\ttargetSessionId = sessionId;\n\n\t\t\tawait debuggers.sendCommand('DOM.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('CSS.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Debugger.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Runtime.enable', {}, sessionId);\n\n\t\t\tawait debuggers.sendCommand('Runtime.evaluate', {\n\t\t\t\texpression: `(function() {\n\t\t\t\t\t\t\tconst style = document.createElement('style');\n\t\t\t\t\t\t\tstyle.id = '__pseudoBlocker__';\n\t\t\t\t\t\t\tstyle.textContent = '*::before, *::after { pointer-events: none !important; }';\n\t\t\t\t\t\t\tdocument.head.appendChild(style);\n\t\t\t\t\t\t})();`,\n\t\t\t}, sessionId);\n\n\t\t\t// slightly changed default CDP debugger inspect colors\n\t\t\tawait debuggers.sendCommand('Overlay.setInspectMode', {\n\t\t\t\tmode: 'searchForNode',\n\t\t\t\thighlightConfig: {\n\t\t\t\t\tshowInfo: true,\n\t\t\t\t\tshowRulers: false,\n\t\t\t\t\tshowStyles: true,\n\t\t\t\t\tshowAccessibilityInfo: true,\n\t\t\t\t\tshowExtensionLines: false,\n\t\t\t\t\tcontrastAlgorithm: 'aa',\n\t\t\t\t\tcontentColor: { r: 173, g: 216, b: 255, a: 0.8 },\n\t\t\t\t\tpaddingColor: { r: 150, g: 200, b: 255, a: 0.5 },\n\t\t\t\t\tborderColor: { r: 120, g: 180, b: 255, a: 0.7 },\n\t\t\t\t\tmarginColor: { r: 200, g: 220, b: 255, a: 0.4 },\n\t\t\t\t\teventTargetColor: { r: 130, g: 160, b: 255, a: 0.8 },\n\t\t\t\t\tshapeColor: { r: 130, g: 160, b: 255, a: 0.8 },\n\t\t\t\t\tshapeMarginColor: { r: 130, g: 160, b: 255, a: 0.5 },\n\t\t\t\t\tgridHighlightConfig: {\n\t\t\t\t\t\trowGapColor: { r: 140, g: 190, b: 255, a: 0.3 },\n\t\t\t\t\t\trowHatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\tcolumnGapColor: { r: 140, g: 190, b: 255, a: 0.3 },\n\t\t\t\t\t\tcolumnHatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\trowLineColor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\tcolumnLineColor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\trowLineDash: true,\n\t\t\t\t\t\tcolumnLineDash: true\n\t\t\t\t\t},\n\t\t\t\t\tflexContainerHighlightConfig: {\n\t\t\t\t\t\tcontainerBorder: {\n\t\t\t\t\t\t\tcolor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\titemSeparator: {\n\t\t\t\t\t\t\tcolor: { r: 140, g: 190, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlineSeparator: {\n\t\t\t\t\t\t\tcolor: { r: 140, g: 190, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmainDistributedSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcrossDistributedSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\trowGapSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcolumnGapSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tflexItemHighlightConfig: {\n\t\t\t\t\t\tbaseSizeBox: {\n\t\t\t\t\t\t\thatchColor: { r: 130, g: 170, b: 255, a: 0.6 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbaseSizeBorder: {\n\t\t\t\t\t\t\tcolor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tflexibilityArrow: {\n\t\t\t\t\t\t\tcolor: { r: 130, g: 190, b: 255 }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}, sessionId);\n\t\t} catch (e) {\n\t\t\tdebuggers.detach();\n\t\t\tthrow new Error('No target found', e);\n\t\t}\n\n\t\tif (!targetSessionId) {\n\t\t\tdebuggers.detach();\n\t\t\tthrow new Error('No target session id found');\n\t\t}\n\n\t\tconst nodeData = await this.getNodeData(targetSessionId, debuggers, window.win, cancellationId);\n\t\tawait this.finishOverlay(debuggers, targetSessionId);\n\n\t\tconst zoomFactor = simpleBrowserWebview.getZoomFactor();\n\t\tconst absoluteBounds = {\n\t\t\tx: rect.x + nodeData.bounds.x,\n\t\t\ty: rect.y + nodeData.bounds.y,\n\t\t\twidth: nodeData.bounds.width,\n\t\t\theight: nodeData.bounds.height\n\t\t};\n\n\t\tconst clippedBounds = {\n\t\t\tx: Math.max(absoluteBounds.x, rect.x),\n\t\t\ty: Math.max(absoluteBounds.y, rect.y),\n\t\t\twidth: Math.max(0, Math.min(absoluteBounds.x + absoluteBounds.width, rect.x + rect.width) - Math.max(absoluteBounds.x, rect.x)),\n\t\t\theight: Math.max(0, Math.min(absoluteBounds.y + absoluteBounds.height, rect.y + rect.height) - Math.max(absoluteBounds.y, rect.y))\n\t\t};\n\n\t\tconst scaledBounds = {\n\t\t\tx: clippedBounds.x * zoomFactor,\n\t\t\ty: clippedBounds.y * zoomFactor,\n\t\t\twidth: clippedBounds.width * zoomFactor,\n\t\t\theight: clippedBounds.height * zoomFactor\n\t\t};\n\n\t\treturn { outerHTML: nodeData.outerHTML, computedStyle: nodeData.computedStyle, bounds: scaledBounds };\n\t}\n\n\tasync getNodeData(sessionId: string, debuggers: any, window: BrowserWindow, cancellationId?: number): Promise<NodeDataResponse> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst onMessage = async (event: any, method: string, params: { backendNodeId: number }) => {\n\t\t\t\tif (method === 'Overlay.inspectNodeRequested') {\n\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\tawait debuggers.sendCommand('Runtime.evaluate', {\n\t\t\t\t\t\texpression: `(() => {\n\t\t\t\t\t\t\t\t\t\tconst style = document.getElementById('__pseudoBlocker__');\n\t\t\t\t\t\t\t\t\t\tif (style) style.remove();\n\t\t\t\t\t\t\t\t\t})();`,\n\t\t\t\t\t}, sessionId);\n\n\t\t\t\t\tconst backendNodeId = params?.backendNodeId;\n\t\t\t\t\tif (!backendNodeId) {\n\t\t\t\t\t\tthrow new Error('Missing backendNodeId in inspectNodeRequested event');\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait debuggers.sendCommand('DOM.getDocument', {}, sessionId);\n\t\t\t\t\t\tconst { nodeIds } = await debuggers.sendCommand('DOM.pushNodesByBackendIdsToFrontend', { backendNodeIds: [backendNodeId] }, sessionId);\n\t\t\t\t\t\tif (!nodeIds || nodeIds.length === 0) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get node IDs.');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst nodeId = nodeIds[0];\n\n\t\t\t\t\t\tconst { model } = await debuggers.sendCommand('DOM.getBoxModel', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!model) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get box model.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst content = model.content;\n\t\t\t\t\t\tconst margin = model.margin;\n\t\t\t\t\t\tconst x = Math.min(margin[0], content[0]);\n\t\t\t\t\t\tconst y = Math.min(margin[1], content[1]) + 32.4; // 32.4 is height of the title bar\n\t\t\t\t\t\tconst width = Math.max(margin[2] - margin[0], content[2] - content[0]);\n\t\t\t\t\t\tconst height = Math.max(margin[5] - margin[1], content[5] - content[1]);\n\n\t\t\t\t\t\tconst matched = await debuggers.sendCommand('CSS.getMatchedStylesForNode', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!matched) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get matched css.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst formatted = this.formatMatchedStyles(matched);\n\t\t\t\t\t\tconst { outerHTML } = await debuggers.sendCommand('DOM.getOuterHTML', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!outerHTML) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get outerHTML.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\touterHTML,\n\t\t\t\t\t\t\tcomputedStyle: formatted,\n\t\t\t\t\t\t\tbounds: { x, y, width, height }\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\t\tdebuggers.detach();\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\twindow.webContents.on('ipc-message', async (event, channel, closedCancellationId) => {\n\t\t\t\tif (channel === `vscode:cancelElementSelection${cancellationId}`) {\n\t\t\t\t\tif (cancellationId !== closedCancellationId) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\tawait this.finishOverlay(debuggers, sessionId);\n\t\t\t\t\twindow.webContents.removeAllListeners('ipc-message');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdebuggers.on('message', onMessage);\n\t\t});\n\t}\n\n\tformatMatchedStyles(matched: any): string {\n\t\tconst lines: string[] = [];\n\n\t\t// inline\n\t\tif (matched.inlineStyle?.cssProperties?.length) {\n\t\t\tlines.push('/* Inline style */');\n\t\t\tlines.push('element {');\n\t\t\tfor (const prop of matched.inlineStyle.cssProperties) {\n\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlines.push('}\\n');\n\t\t}\n\n\t\t// matched\n\t\tif (matched.matchedCSSRules?.length) {\n\t\t\tfor (const ruleEntry of matched.matchedCSSRules) {\n\t\t\t\tconst rule = ruleEntry.rule;\n\t\t\t\tconst selectors = rule.selectorList.selectors.map((s: any) => s.text).join(', ');\n\t\t\t\tlines.push(`/* Matched Rule from ${rule.origin} */`);\n\t\t\t\tlines.push(`${selectors} {`);\n\t\t\t\tfor (const prop of rule.style.cssProperties) {\n\t\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlines.push('}\\n');\n\t\t\t}\n\t\t}\n\n\t\t// inherited rules\n\t\tif (matched.inherited?.length) {\n\t\t\tlet level = 1;\n\t\t\tfor (const inherited of matched.inherited) {\n\t\t\t\tconst rules = inherited.matchedCSSRules || [];\n\t\t\t\tfor (const ruleEntry of rules) {\n\t\t\t\t\tconst rule = ruleEntry.rule;\n\t\t\t\t\tconst selectors = rule.selectorList.selectors.map((s: any) => s.text).join(', ');\n\t\t\t\t\tlines.push(`/* Inherited from ancestor level ${level} (${rule.origin}) */`);\n\t\t\t\t\tlines.push(`${selectors} {`);\n\t\t\t\t\tfor (const prop of rule.style.cssProperties) {\n\t\t\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlines.push('}\\n');\n\t\t\t\t}\n\t\t\t\tlevel++;\n\t\t\t}\n\t\t}\n\n\t\treturn '\\n' + lines.join('\\n');\n\t}\n\n\tprivate windowById(windowId: number | undefined, fallbackCodeWindowId?: number): ICodeWindow | IAuxiliaryWindow | undefined {\n\t\treturn this.codeWindowById(windowId) ?? this.auxiliaryWindowById(windowId) ?? this.codeWindowById(fallbackCodeWindowId);\n\t}\n\n\tprivate codeWindowById(windowId: number | undefined): ICodeWindow | undefined {\n\t\tif (typeof windowId !== 'number') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.windowsMainService.getWindowById(windowId);\n\t}\n\n\tprivate auxiliaryWindowById(windowId: number | undefined): IAuxiliaryWindow | undefined {\n\t\tif (typeof windowId !== 'number') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst contents = webContents.fromId(windowId);\n\t\tif (!contents) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.auxiliaryWindowsMainService.getWindowByWebContents(contents);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { BrowserType, IElementData, INativeBrowserElementsService } from '../common/browserElements.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { IRectangle } from '../../window/common/window.js';\nimport { BrowserWindow, webContents } from 'electron';\nimport { IAuxiliaryWindow } from '../../auxiliaryWindow/electron-main/auxiliaryWindow.js';\nimport { ICodeWindow } from '../../window/electron-main/window.js';\nimport { IAuxiliaryWindowsMainService } from '../../auxiliaryWindow/electron-main/auxiliaryWindows.js';\nimport { IWindowsMainService } from '../../windows/electron-main/windows.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { AddFirstParameterToFunctions } from '../../../base/common/types.js';\n\nexport const INativeBrowserElementsMainService = createDecorator<INativeBrowserElementsMainService>('browserElementsMainService');\nexport interface INativeBrowserElementsMainService extends AddFirstParameterToFunctions<INativeBrowserElementsService, Promise<unknown> /* only methods, not events */, number | undefined /* window ID */> { }\n\ninterface NodeDataResponse {\n\touterHTML: string;\n\tcomputedStyle: string;\n\tbounds: IRectangle;\n}\n\nexport class NativeBrowserElementsMainService extends Disposable implements INativeBrowserElementsMainService {\n\t_serviceBrand: undefined;\n\n\tcurrentLocalAddress: string | undefined;\n\n\tconstructor(\n\t\t@IWindowsMainService private readonly windowsMainService: IWindowsMainService,\n\t\t@IAuxiliaryWindowsMainService private readonly auxiliaryWindowsMainService: IAuxiliaryWindowsMainService,\n\n\t) {\n\t\tsuper();\n\t}\n\n\tget windowId(): never { throw new Error('Not implemented in electron-main'); }\n\n\tasync findWebviewTarget(debuggers: any, windowId: number, browserType: BrowserType): Promise<string | undefined> {\n\t\tconst { targetInfos } = await debuggers.sendCommand('Target.getTargets');\n\t\tlet target: typeof targetInfos[number] | undefined = undefined;\n\t\tconst matchingTarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\ttry {\n\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\tif (browserType === BrowserType.LiveServer) {\n\t\t\t\t\treturn url.searchParams.get('id') && url.searchParams.get('extensionId') === 'ms-vscode.live-server';\n\t\t\t\t} else if (browserType === BrowserType.SimpleBrowser) {\n\t\t\t\t\treturn url.searchParams.get('parentId') === windowId.toString() && url.searchParams.get('extensionId') === 'vscode.simple-browser';\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} catch (err) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\t// search for webview via search parameters\n\t\tif (matchingTarget) {\n\t\t\tlet resultId: string | undefined;\n\t\t\tlet url: URL | undefined;\n\t\t\ttry {\n\t\t\t\turl = new URL(matchingTarget.url);\n\t\t\t\tresultId = url.searchParams.get('id')!;\n\t\t\t} catch (e) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\ttarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\t\tconst isLiveServer = browserType === BrowserType.LiveServer && url.searchParams.get('serverWindowId') === resultId;\n\t\t\t\t\tconst isSimpleBrowser = browserType === BrowserType.SimpleBrowser && url.searchParams.get('id') === resultId && url.searchParams.has('vscodeBrowserReqId');\n\t\t\t\t\tif (isLiveServer || isSimpleBrowser) {\n\t\t\t\t\t\tthis.currentLocalAddress = url.origin;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (target) {\n\t\t\t\treturn target.targetId;\n\t\t\t}\n\t\t}\n\n\t\t// fallback: search for webview without parameters based on current origin\n\t\ttarget = targetInfos.find((targetInfo: { url: string }) => {\n\t\t\ttry {\n\t\t\t\tconst url = new URL(targetInfo.url);\n\t\t\t\treturn (this.currentLocalAddress === url.origin);\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tif (!target) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn target.targetId;\n\t}\n\n\tasync waitForWebviewTargets(debuggers: any, windowId: number, browserType: BrowserType): Promise<any> {\n\t\tconst start = Date.now();\n\t\tconst timeout = 10000;\n\n\t\twhile (Date.now() - start < timeout) {\n\t\t\tconst targetId = await this.findWebviewTarget(debuggers, windowId, browserType);\n\t\t\tif (targetId) {\n\t\t\t\treturn targetId;\n\t\t\t}\n\n\t\t\t// Wait for a short period before checking again\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 500));\n\t\t}\n\n\t\tdebuggers.detach();\n\t\treturn undefined;\n\t}\n\n\tasync startDebugSession(windowId: number | undefined, token: CancellationToken, browserType: BrowserType, cancelAndDetachId?: number): Promise<void> {\n\t\tconst window = this.windowById(windowId);\n\t\tif (!window?.win) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Find the simple browser webview\n\t\tconst allWebContents = webContents.getAllWebContents();\n\t\tconst simpleBrowserWebview = allWebContents.find(webContent => webContent.id === window.id);\n\n\t\tif (!simpleBrowserWebview) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst debuggers = simpleBrowserWebview.debugger;\n\t\tif (!debuggers.isAttached()) {\n\t\t\tdebuggers.attach();\n\t\t}\n\n\t\ttry {\n\t\t\tconst matchingTargetId = await this.waitForWebviewTargets(debuggers, windowId!, browserType);\n\t\t\tif (!matchingTargetId) {\n\t\t\t\tif (debuggers.isAttached()) {\n\t\t\t\t\tdebuggers.detach();\n\t\t\t\t}\n\t\t\t\tthrow new Error('No target found');\n\t\t\t}\n\n\t\t} catch (e) {\n\t\t\tif (debuggers.isAttached()) {\n\t\t\t\tdebuggers.detach();\n\t\t\t}\n\t\t\tthrow new Error('No target found');\n\t\t}\n\n\t\twindow.win.webContents.on('ipc-message', async (event, channel, closedCancelAndDetachId) => {\n\t\t\tif (channel === `vscode:cancelCurrentSession${cancelAndDetachId}`) {\n\t\t\t\tif (cancelAndDetachId !== closedCancelAndDetachId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (debuggers.isAttached()) {\n\t\t\t\t\tdebuggers.detach();\n\t\t\t\t}\n\t\t\t\tif (window.win) {\n\t\t\t\t\twindow.win.webContents.removeAllListeners('ipc-message');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tasync finishOverlay(debuggers: any, sessionId: string | undefined): Promise<void> {\n\t\tif (debuggers.isAttached() && sessionId) {\n\t\t\tawait debuggers.sendCommand('Overlay.setInspectMode', {\n\t\t\t\tmode: 'none',\n\t\t\t\thighlightConfig: {\n\t\t\t\t\tshowInfo: false,\n\t\t\t\t\tshowStyles: false\n\t\t\t\t}\n\t\t\t}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.hideHighlight', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.disable', {}, sessionId);\n\t\t\tdebuggers.detach();\n\t\t}\n\t}\n\n\tasync getElementData(windowId: number | undefined, rect: IRectangle, token: CancellationToken, browserType: BrowserType, cancellationId?: number): Promise<IElementData | undefined> {\n\t\tconst window = this.windowById(windowId);\n\t\tif (!window?.win) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Find the simple browser webview\n\t\tconst allWebContents = webContents.getAllWebContents();\n\t\tconst simpleBrowserWebview = allWebContents.find(webContent => webContent.id === window.id);\n\n\t\tif (!simpleBrowserWebview) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst debuggers = simpleBrowserWebview.debugger;\n\t\tif (!debuggers.isAttached()) {\n\t\t\tdebuggers.attach();\n\t\t}\n\n\t\tlet targetSessionId: string | undefined = undefined;\n\t\ttry {\n\t\t\tconst targetId = await this.findWebviewTarget(debuggers, windowId!, browserType);\n\t\t\tconst { sessionId } = await debuggers.sendCommand('Target.attachToTarget', {\n\t\t\t\ttargetId: targetId,\n\t\t\t\tflatten: true,\n\t\t\t});\n\n\t\t\ttargetSessionId = sessionId;\n\n\t\t\tawait debuggers.sendCommand('DOM.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('CSS.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Overlay.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Debugger.enable', {}, sessionId);\n\t\t\tawait debuggers.sendCommand('Runtime.enable', {}, sessionId);\n\n\t\t\tawait debuggers.sendCommand('Runtime.evaluate', {\n\t\t\t\texpression: `(function() {\n\t\t\t\t\t\t\tconst style = document.createElement('style');\n\t\t\t\t\t\t\tstyle.id = '__pseudoBlocker__';\n\t\t\t\t\t\t\tstyle.textContent = '*::before, *::after { pointer-events: none !important; }';\n\t\t\t\t\t\t\tdocument.head.appendChild(style);\n\t\t\t\t\t\t})();`,\n\t\t\t}, sessionId);\n\n\t\t\t// slightly changed default CDP debugger inspect colors\n\t\t\tawait debuggers.sendCommand('Overlay.setInspectMode', {\n\t\t\t\tmode: 'searchForNode',\n\t\t\t\thighlightConfig: {\n\t\t\t\t\tshowInfo: true,\n\t\t\t\t\tshowRulers: false,\n\t\t\t\t\tshowStyles: true,\n\t\t\t\t\tshowAccessibilityInfo: true,\n\t\t\t\t\tshowExtensionLines: false,\n\t\t\t\t\tcontrastAlgorithm: 'aa',\n\t\t\t\t\tcontentColor: { r: 173, g: 216, b: 255, a: 0.8 },\n\t\t\t\t\tpaddingColor: { r: 150, g: 200, b: 255, a: 0.5 },\n\t\t\t\t\tborderColor: { r: 120, g: 180, b: 255, a: 0.7 },\n\t\t\t\t\tmarginColor: { r: 200, g: 220, b: 255, a: 0.4 },\n\t\t\t\t\teventTargetColor: { r: 130, g: 160, b: 255, a: 0.8 },\n\t\t\t\t\tshapeColor: { r: 130, g: 160, b: 255, a: 0.8 },\n\t\t\t\t\tshapeMarginColor: { r: 130, g: 160, b: 255, a: 0.5 },\n\t\t\t\t\tgridHighlightConfig: {\n\t\t\t\t\t\trowGapColor: { r: 140, g: 190, b: 255, a: 0.3 },\n\t\t\t\t\t\trowHatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\tcolumnGapColor: { r: 140, g: 190, b: 255, a: 0.3 },\n\t\t\t\t\t\tcolumnHatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\trowLineColor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\tcolumnLineColor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\trowLineDash: true,\n\t\t\t\t\t\tcolumnLineDash: true\n\t\t\t\t\t},\n\t\t\t\t\tflexContainerHighlightConfig: {\n\t\t\t\t\t\tcontainerBorder: {\n\t\t\t\t\t\t\tcolor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\titemSeparator: {\n\t\t\t\t\t\t\tcolor: { r: 140, g: 190, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlineSeparator: {\n\t\t\t\t\t\t\tcolor: { r: 140, g: 190, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmainDistributedSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcrossDistributedSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\trowGapSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcolumnGapSpace: {\n\t\t\t\t\t\t\thatchColor: { r: 140, g: 190, b: 255, a: 0.7 },\n\t\t\t\t\t\t\tfillColor: { r: 140, g: 190, b: 255, a: 0.4 }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tflexItemHighlightConfig: {\n\t\t\t\t\t\tbaseSizeBox: {\n\t\t\t\t\t\t\thatchColor: { r: 130, g: 170, b: 255, a: 0.6 }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbaseSizeBorder: {\n\t\t\t\t\t\t\tcolor: { r: 120, g: 180, b: 255 },\n\t\t\t\t\t\t\tpattern: 'solid'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tflexibilityArrow: {\n\t\t\t\t\t\t\tcolor: { r: 130, g: 190, b: 255 }\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}, sessionId);\n\t\t} catch (e) {\n\t\t\tdebuggers.detach();\n\t\t\tthrow new Error('No target found', e);\n\t\t}\n\n\t\tif (!targetSessionId) {\n\t\t\tdebuggers.detach();\n\t\t\tthrow new Error('No target session id found');\n\t\t}\n\n\t\tconst nodeData = await this.getNodeData(targetSessionId, debuggers, window.win, cancellationId);\n\t\tawait this.finishOverlay(debuggers, targetSessionId);\n\n\t\tconst zoomFactor = simpleBrowserWebview.getZoomFactor();\n\t\tconst absoluteBounds = {\n\t\t\tx: rect.x + nodeData.bounds.x,\n\t\t\ty: rect.y + nodeData.bounds.y,\n\t\t\twidth: nodeData.bounds.width,\n\t\t\theight: nodeData.bounds.height\n\t\t};\n\n\t\tconst clippedBounds = {\n\t\t\tx: Math.max(absoluteBounds.x, rect.x),\n\t\t\ty: Math.max(absoluteBounds.y, rect.y),\n\t\t\twidth: Math.max(0, Math.min(absoluteBounds.x + absoluteBounds.width, rect.x + rect.width) - Math.max(absoluteBounds.x, rect.x)),\n\t\t\theight: Math.max(0, Math.min(absoluteBounds.y + absoluteBounds.height, rect.y + rect.height) - Math.max(absoluteBounds.y, rect.y))\n\t\t};\n\n\t\tconst scaledBounds = {\n\t\t\tx: clippedBounds.x * zoomFactor,\n\t\t\ty: clippedBounds.y * zoomFactor,\n\t\t\twidth: clippedBounds.width * zoomFactor,\n\t\t\theight: clippedBounds.height * zoomFactor\n\t\t};\n\n\t\treturn { outerHTML: nodeData.outerHTML, computedStyle: nodeData.computedStyle, bounds: scaledBounds };\n\t}\n\n\tasync getNodeData(sessionId: string, debuggers: any, window: BrowserWindow, cancellationId?: number): Promise<NodeDataResponse> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst onMessage = async (event: any, method: string, params: { backendNodeId: number }) => {\n\t\t\t\tif (method === 'Overlay.inspectNodeRequested') {\n\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\tawait debuggers.sendCommand('Runtime.evaluate', {\n\t\t\t\t\t\texpression: `(() => {\n\t\t\t\t\t\t\t\t\t\tconst style = document.getElementById('__pseudoBlocker__');\n\t\t\t\t\t\t\t\t\t\tif (style) style.remove();\n\t\t\t\t\t\t\t\t\t})();`,\n\t\t\t\t\t}, sessionId);\n\n\t\t\t\t\tconst backendNodeId = params?.backendNodeId;\n\t\t\t\t\tif (!backendNodeId) {\n\t\t\t\t\t\tthrow new Error('Missing backendNodeId in inspectNodeRequested event');\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait debuggers.sendCommand('DOM.getDocument', {}, sessionId);\n\t\t\t\t\t\tconst { nodeIds } = await debuggers.sendCommand('DOM.pushNodesByBackendIdsToFrontend', { backendNodeIds: [backendNodeId] }, sessionId);\n\t\t\t\t\t\tif (!nodeIds || nodeIds.length === 0) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get node IDs.');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst nodeId = nodeIds[0];\n\n\t\t\t\t\t\tconst { model } = await debuggers.sendCommand('DOM.getBoxModel', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!model) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get box model.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst content = model.content;\n\t\t\t\t\t\tconst margin = model.margin;\n\t\t\t\t\t\tconst x = Math.min(margin[0], content[0]);\n\t\t\t\t\t\tconst y = Math.min(margin[1], content[1]) + 32.4; // 32.4 is height of the title bar\n\t\t\t\t\t\tconst width = Math.max(margin[2] - margin[0], content[2] - content[0]);\n\t\t\t\t\t\tconst height = Math.max(margin[5] - margin[1], content[5] - content[1]);\n\n\t\t\t\t\t\tconst matched = await debuggers.sendCommand('CSS.getMatchedStylesForNode', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!matched) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get matched css.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst formatted = this.formatMatchedStyles(matched);\n\t\t\t\t\t\tconst { outerHTML } = await debuggers.sendCommand('DOM.getOuterHTML', { nodeId }, sessionId);\n\t\t\t\t\t\tif (!outerHTML) {\n\t\t\t\t\t\t\tthrow new Error('Failed to get outerHTML.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\touterHTML,\n\t\t\t\t\t\t\tcomputedStyle: formatted,\n\t\t\t\t\t\t\tbounds: { x, y, width, height }\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\t\tdebuggers.detach();\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\twindow.webContents.on('ipc-message', async (event, channel, closedCancellationId) => {\n\t\t\t\tif (channel === `vscode:cancelElementSelection${cancellationId}`) {\n\t\t\t\t\tif (cancellationId !== closedCancellationId) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdebuggers.off('message', onMessage);\n\t\t\t\t\tawait this.finishOverlay(debuggers, sessionId);\n\t\t\t\t\twindow.webContents.removeAllListeners('ipc-message');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdebuggers.on('message', onMessage);\n\t\t});\n\t}\n\n\tformatMatchedStyles(matched: any): string {\n\t\tconst lines: string[] = [];\n\n\t\t// inline\n\t\tif (matched.inlineStyle?.cssProperties?.length) {\n\t\t\tlines.push('/* Inline style */');\n\t\t\tlines.push('element {');\n\t\t\tfor (const prop of matched.inlineStyle.cssProperties) {\n\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlines.push('}\\n');\n\t\t}\n\n\t\t// matched\n\t\tif (matched.matchedCSSRules?.length) {\n\t\t\tfor (const ruleEntry of matched.matchedCSSRules) {\n\t\t\t\tconst rule = ruleEntry.rule;\n\t\t\t\tconst selectors = rule.selectorList.selectors.map((s: any) => s.text).join(', ');\n\t\t\t\tlines.push(`/* Matched Rule from ${rule.origin} */`);\n\t\t\t\tlines.push(`${selectors} {`);\n\t\t\t\tfor (const prop of rule.style.cssProperties) {\n\t\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlines.push('}\\n');\n\t\t\t}\n\t\t}\n\n\t\t// inherited rules\n\t\tif (matched.inherited?.length) {\n\t\t\tlet level = 1;\n\t\t\tfor (const inherited of matched.inherited) {\n\t\t\t\tconst rules = inherited.matchedCSSRules || [];\n\t\t\t\tfor (const ruleEntry of rules) {\n\t\t\t\t\tconst rule = ruleEntry.rule;\n\t\t\t\t\tconst selectors = rule.selectorList.selectors.map((s: any) => s.text).join(', ');\n\t\t\t\t\tlines.push(`/* Inherited from ancestor level ${level} (${rule.origin}) */`);\n\t\t\t\t\tlines.push(`${selectors} {`);\n\t\t\t\t\tfor (const prop of rule.style.cssProperties) {\n\t\t\t\t\t\tif (prop.name && prop.value) {\n\t\t\t\t\t\t\tlines.push(`  ${prop.name}: ${prop.value};`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlines.push('}\\n');\n\t\t\t\t}\n\t\t\t\tlevel++;\n\t\t\t}\n\t\t}\n\n\t\treturn '\\n' + lines.join('\\n');\n\t}\n\n\tprivate windowById(windowId: number | undefined, fallbackCodeWindowId?: number): ICodeWindow | IAuxiliaryWindow | undefined {\n\t\treturn this.codeWindowById(windowId) ?? this.auxiliaryWindowById(windowId) ?? this.codeWindowById(fallbackCodeWindowId);\n\t}\n\n\tprivate codeWindowById(windowId: number | undefined): ICodeWindow | undefined {\n\t\tif (typeof windowId !== 'number') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.windowsMainService.getWindowById(windowId);\n\t}\n\n\tprivate auxiliaryWindowById(windowId: number | undefined): IAuxiliaryWindow | undefined {\n\t\tif (typeof windowId !== 'number') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst contents = webContents.fromId(windowId);\n\t\tif (!contents) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.auxiliaryWindowsMainService.getWindowByWebContents(contents);\n\t}\n}\n"]}