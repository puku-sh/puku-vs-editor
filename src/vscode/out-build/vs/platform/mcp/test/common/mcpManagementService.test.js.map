{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/mcp/test/common/mcpManagementService.test.ts","vs/platform/mcp/test/common/mcpManagementService.test.ts"],"names":[],"mappings":"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","file":"mcpManagementService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { AbstractCommonMcpManagementService } from '../../common/mcpManagementService.js';\nimport { IGalleryMcpServer, IGalleryMcpServerConfiguration, IInstallableMcpServer, ILocalMcpServer, InstallOptions, RegistryType, TransportType, UninstallOptions } from '../../common/mcpManagement.js';\nimport { McpServerType, McpServerVariableType, IMcpServerVariable } from '../../common/mcpPlatformTypes.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { NullLogService } from '../../../log/common/log.js';\n\nclass TestMcpManagementService extends AbstractCommonMcpManagementService {\n\n\toverride onInstallMcpServer = Event.None;\n\toverride onDidInstallMcpServers = Event.None;\n\toverride onDidUpdateMcpServers = Event.None;\n\toverride onUninstallMcpServer = Event.None;\n\toverride onDidUninstallMcpServer = Event.None;\n\n\toverride getInstalled(mcpResource?: URI): Promise<ILocalMcpServer[]> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride install(server: IInstallableMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride installFromGallery(server: IGalleryMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride updateMetadata(local: ILocalMcpServer, server: IGalleryMcpServer, profileLocation?: URI): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride uninstall(server: ILocalMcpServer, options?: UninstallOptions): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\toverride canInstall(server: IGalleryMcpServer | IInstallableMcpServer): true | IMarkdownString {\n\t\tthrow new Error('Not supported');\n\t}\n}\n\nsuite('McpManagementService - getMcpServerConfigurationFromManifest', () => {\n\tlet service: TestMcpManagementService;\n\n\tsetup(() => {\n\t\tservice = new TestMcpManagementService(new NullLogService());\n\t});\n\n\tteardown(() => {\n\t\tservice.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('NPM Package Tests', () => {\n\t\ttest('basic NPM package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tregistryBaseUrl: 'https://registry.npmjs.org',\n\t\t\t\t\tidentifier: '@modelcontextprotocol/server-brave-search',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'BRAVE_API_KEY',\n\t\t\t\t\t\tvalue: 'test-key'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['@modelcontextprotocol/server-brave-search@1.0.2']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'BRAVE_API_KEY': 'test-key' });\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs, undefined);\n\t\t});\n\n\t\ttest('NPM package without version', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tregistryBaseUrl: 'https://registry.npmjs.org',\n\t\t\t\t\tidentifier: '@modelcontextprotocol/everything',\n\t\t\t\t\tversion: '',\n\t\t\t\t\ttransport: { type: TransportType.STDIO }\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['@modelcontextprotocol/everything']);\n\t\t\t}\n\t\t});\n\n\t\ttest('NPM package with environment variables containing variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'API_KEY',\n\t\t\t\t\t\tvalue: 'key-{api_token}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_token: {\n\t\t\t\t\t\t\t\tdescription: 'Your API token',\n\t\t\t\t\t\t\t\tisSecret: true,\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'API_KEY': 'key-${input:api_token}' });\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_token');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Your API token');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t});\n\n\t\ttest('environment variable with empty value should create input variable (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: '@modelcontextprotocol/server-brave-search',\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'BRAVE_API_KEY',\n\t\t\t\t\t\tvalue: '', // Empty value should create input variable\n\t\t\t\t\t\tdescription: 'Brave Search API Key',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently this creates env with empty string instead of input variable\n\t\t\t// Should create an input variable since no meaningful value is provided\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'BRAVE_API_KEY');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Brave Search API Key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\n\t\t\t// Environment should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'BRAVE_API_KEY': '${input:BRAVE_API_KEY}' });\n\t\t\t}\n\t\t});\n\n\t\ttest('environment variable with choices but empty value should create pick input (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'SSL_MODE',\n\t\t\t\t\t\tvalue: '', // Empty value should create input variable\n\t\t\t\t\t\tdescription: 'SSL connection mode',\n\t\t\t\t\t\tdefault: 'prefer',\n\t\t\t\t\t\tchoices: ['disable', 'prefer', 'require']\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently this creates env with empty string instead of input variable\n\t\t\t// Should create a pick input variable since choices are provided\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'SSL_MODE');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'SSL connection mode');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].default, 'prefer');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['disable', 'prefer', 'require']);\n\n\t\t\t// Environment should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'SSL_MODE': '${input:SSL_MODE}' });\n\t\t\t}\n\t\t});\n\n\t\ttest('NPM package with package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'snyk',\n\t\t\t\t\tversion: '1.1298.0',\n\t\t\t\t\tpackageArguments: [\n\t\t\t\t\t\t{ type: 'positional', value: 'mcp', valueHint: 'command', isRepeated: false },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\t\tname: '-t',\n\t\t\t\t\t\t\tvalue: 'stdio',\n\t\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['snyk@1.1298.0', 'mcp', '-t', 'stdio']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Python Package Tests', () => {\n\t\ttest('basic Python package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://pypi.org',\n\t\t\t\t\tidentifier: 'weather-mcp-server',\n\t\t\t\t\tversion: '0.5.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'WEATHER_API_KEY',\n\t\t\t\t\t\tvalue: 'test-key'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'WEATHER_UNITS',\n\t\t\t\t\t\tvalue: 'celsius'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.PYTHON);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'uvx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['weather-mcp-server==0.5.0']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, {\n\t\t\t\t\t'WEATHER_API_KEY': 'test-key',\n\t\t\t\t\t'WEATHER_UNITS': 'celsius'\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\ttest('Python package without version', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'weather-mcp-server',\n\t\t\t\t\tversion: ''\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.PYTHON);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['weather-mcp-server']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Docker Package Tests', () => {\n\t\ttest('basic Docker package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://docker.io',\n\t\t\t\t\tidentifier: 'mcp/filesystem',\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--mount',\n\t\t\t\t\t\tvalue: 'type=bind,src=/host/path,dst=/container/path',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}],\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'LOG_LEVEL',\n\t\t\t\t\t\tvalue: 'info'\n\t\t\t\t\t}],\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: '/project',\n\t\t\t\t\t\tvalueHint: 'directory',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'docker');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'--mount', 'type=bind,src=/host/path,dst=/container/path',\n\t\t\t\t\t'-e', 'LOG_LEVEL',\n\t\t\t\t\t'mcp/filesystem:1.0.2',\n\t\t\t\t\t'/project'\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'LOG_LEVEL': 'info' });\n\t\t\t}\n\t\t});\n\n\t\ttest('Docker package with variables in runtime arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'example/database-manager-mcp',\n\t\t\t\t\tversion: '3.1.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '-e',\n\t\t\t\t\t\tvalue: 'DB_TYPE={db_type}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdb_type: {\n\t\t\t\t\t\t\t\tdescription: 'Type of database',\n\t\t\t\t\t\t\t\tchoices: ['postgres', 'mysql', 'mongodb', 'redis'],\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'-e', 'DB_TYPE=${input:db_type}',\n\t\t\t\t\t'example/database-manager-mcp:3.1.0'\n\t\t\t\t]);\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'db_type');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['postgres', 'mysql', 'mongodb', 'redis']);\n\t\t});\n\n\t\ttest('Docker package arguments without values should create input variables (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'example/database-manager-mcp',\n\t\t\t\t\tversion: '3.1.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--host',\n\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\tdefault: 'localhost',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'database_name',\n\t\t\t\t\t\tdescription: 'Name of the database to connect to',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\t// BUG: Currently named args without value are ignored, positional uses value_hint as literal\n\t\t\t// Should create input variables for both arguments\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\n\t\t\tconst hostInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'host');\n\t\t\tassert.strictEqual(hostInput?.description, 'Database host');\n\t\t\tassert.strictEqual(hostInput?.default, 'localhost');\n\t\t\tassert.strictEqual(hostInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst dbNameInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'database_name');\n\t\t\tassert.strictEqual(dbNameInput?.description, 'Name of the database to connect to');\n\t\t\tassert.strictEqual(dbNameInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\t// Args should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'example/database-manager-mcp:3.1.0',\n\t\t\t\t\t'--host', '${input:host}',\n\t\t\t\t\t'${input:database_name}'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\n\t\ttest('Docker Hub backward compatibility', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\tidentifier: 'example/test-image',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'docker');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'example/test-image:1.0.0'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('NuGet Package Tests', () => {\n\t\ttest('basic NuGet package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NUGET,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://api.nuget.org',\n\t\t\t\t\tidentifier: 'Knapcode.SampleMcpServer',\n\t\t\t\t\tversion: '0.5.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'WEATHER_CHOICES',\n\t\t\t\t\t\tvalue: 'sunny,cloudy,rainy'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NUGET);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'dnx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['Knapcode.SampleMcpServer@0.5.0', '--yes']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'WEATHER_CHOICES': 'sunny,cloudy,rainy' });\n\t\t\t}\n\t\t});\n\n\t\ttest('NuGet package with package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NUGET,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'Knapcode.SampleMcpServer',\n\t\t\t\t\tversion: '0.4.0-beta',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: 'mcp',\n\t\t\t\t\t\tvalueHint: 'command',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: 'start',\n\t\t\t\t\t\tvalueHint: 'action',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NUGET);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'Knapcode.SampleMcpServer@0.4.0-beta',\n\t\t\t\t\t'--yes',\n\t\t\t\t\t'--',\n\t\t\t\t\t'mcp',\n\t\t\t\t\t'start'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Remote Server Tests', () => {\n\t\ttest('SSE remote server configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'http://mcp-fs.anonymous.modelcontextprotocol.io/sse'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'http://mcp-fs.anonymous.modelcontextprotocol.io/sse');\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.headers, undefined);\n\t\t\t}\n\t\t});\n\n\t\ttest('SSE remote server with headers and variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'https://mcp.anonymous.modelcontextprotocol.io/sse',\n\t\t\t\t\theaders: [{\n\t\t\t\t\t\tname: 'X-API-Key',\n\t\t\t\t\t\tvalue: '{api_key}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_key: {\n\t\t\t\t\t\t\t\tdescription: 'API key for authentication',\n\t\t\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'X-Region',\n\t\t\t\t\t\tvalue: 'us-east-1'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.headers, {\n\t\t\t\t\t'X-API-Key': '${input:api_key}',\n\t\t\t\t\t'X-Region': 'us-east-1'\n\t\t\t\t});\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t});\n\n\t\ttest('streamable HTTP remote server', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.STREAMABLE_HTTP,\n\t\t\t\t\turl: 'https://mcp.anonymous.modelcontextprotocol.io/http'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'https://mcp.anonymous.modelcontextprotocol.io/http');\n\t\t\t}\n\t\t});\n\n\t\ttest('remote headers without values should create input variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'https://api.example.com/mcp',\n\t\t\t\t\theaders: [{\n\t\t\t\t\t\tname: 'Authorization',\n\t\t\t\t\t\tdescription: 'API token for authentication',\n\t\t\t\t\t\tisSecret: true,\n\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'X-Custom-Header',\n\t\t\t\t\t\tdescription: 'Custom header value',\n\t\t\t\t\t\tdefault: 'default-value',\n\t\t\t\t\t\tchoices: ['option1', 'option2', 'option3']\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable with choices\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'https://api.example.com/mcp');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.headers, {\n\t\t\t\t\t'Authorization': '${input:Authorization}',\n\t\t\t\t\t'X-Custom-Header': '${input:X-Custom-Header}'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Should create input variables for headers without values\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\n\t\t\tconst authInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'Authorization');\n\t\t\tassert.strictEqual(authInput?.description, 'API token for authentication');\n\t\t\tassert.strictEqual(authInput?.password, true);\n\t\t\tassert.strictEqual(authInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst customInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'X-Custom-Header');\n\t\t\tassert.strictEqual(customInput?.description, 'Custom header value');\n\t\t\tassert.strictEqual(customInput?.default, 'default-value');\n\t\t\tassert.strictEqual(customInput?.type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(customInput?.options, ['option1', 'option2', 'option3']);\n\t\t});\n\t});\n\n\tsuite('Variable Interpolation Tests', () => {\n\t\ttest('multiple variables in single value', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'CONNECTION_STRING',\n\t\t\t\t\t\tvalue: 'server={host};port={port};database={db_name}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\thost: {\n\t\t\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\t\t\tdefault: 'localhost'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tport: {\n\t\t\t\t\t\t\t\tdescription: 'Database port',\n\t\t\t\t\t\t\t\tformat: 'number',\n\t\t\t\t\t\t\t\tdefault: '5432'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdb_name: {\n\t\t\t\t\t\t\t\tdescription: 'Database name',\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, {\n\t\t\t\t\t'CONNECTION_STRING': 'server=${input:host};port=${input:port};database=${input:db_name}'\n\t\t\t\t});\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 3);\n\n\t\t\tconst hostInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'host');\n\t\t\tassert.strictEqual(hostInput?.default, 'localhost');\n\t\t\tassert.strictEqual(hostInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst portInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'port');\n\t\t\tassert.strictEqual(portInput?.default, '5432');\n\n\t\t\tconst dbNameInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'db_name');\n\t\t\tassert.strictEqual(dbNameInput?.description, 'Database name');\n\t\t});\n\n\t\ttest('variable with choices creates pick input', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--log-level',\n\t\t\t\t\t\tvalue: '{level}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tlevel: {\n\t\t\t\t\t\t\t\tdescription: 'Log level',\n\t\t\t\t\t\t\t\tchoices: ['debug', 'info', 'warn', 'error'],\n\t\t\t\t\t\t\t\tdefault: 'info'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['debug', 'info', 'warn', 'error']);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].default, 'info');\n\t\t});\n\n\t\ttest('variables in package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\tidentifier: 'test-image',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--host',\n\t\t\t\t\t\tvalue: '{db_host}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdb_host: {\n\t\t\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\t\t\tdefault: 'localhost'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: '{database_name}',\n\t\t\t\t\t\tvalueHint: 'database_name',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdatabase_name: {\n\t\t\t\t\t\t\t\tdescription: 'Name of the database to connect to',\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'test-image:1.0.0',\n\t\t\t\t\t'--host', '${input:db_host}',\n\t\t\t\t\t'${input:database_name}'\n\t\t\t\t]);\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\t\t});\n\n\t\ttest('positional arguments with value_hint should create input variables (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: '@example/math-tool',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '2.0.1',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'calculation_type',\n\t\t\t\t\t\tdescription: 'Type of calculation to enable',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field, only value_hint - should create input variable\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently value_hint is used as literal value instead of creating input variable\n\t\t\t// Should create input variable instead\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'calculation_type');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Type of calculation to enable');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\n\t\t\t// Args should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'@example/math-tool@2.0.1',\n\t\t\t\t\t'${input:calculation_type}'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Edge Cases and Error Handling', () => {\n\t\ttest('empty manifest should throw error', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {};\n\n\t\t\tassert.throws(() => {\n\t\t\t\tservice.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\t\t\t}, /No server package found/);\n\t\t});\n\n\t\ttest('manifest with no matching package type should use first package', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'python-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'uvx'); // Python command since that's the package type\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['python-server==1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('manifest with matching package type should use that package', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'python-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}, {\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'node-server',\n\t\t\t\t\tversion: '2.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['node-server@2.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('undefined environment variables should be omitted', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.env, undefined);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument without value should only add name', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--verbose',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['--verbose', 'test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('positional argument with undefined value should use value_hint', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'target_directory',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0', 'target_directory']);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument with no name should generate notice', () => {\n\t\t\tconst manifest = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tvalue: 'some-value',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest as IGalleryMcpServerConfiguration, RegistryType.NODE);\n\n\t\t\t// Should generate a notice about the missing name\n\t\t\tassert.strictEqual(result.notices.length, 1);\n\t\t\tassert.ok(result.notices[0].includes('Named argument is missing a name'));\n\t\t\tassert.ok(result.notices[0].includes('some-value')); // Should include the argument details in JSON format\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument with empty name should generate notice', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tvalue: 'some-value',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// Should generate a notice about the missing name\n\t\t\tassert.strictEqual(result.notices.length, 1);\n\t\t\tassert.ok(result.notices[0].includes('Named argument is missing a name'));\n\t\t\tassert.ok(result.notices[0].includes('some-value')); // Should include the argument details in JSON format\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Variable Processing Order', () => {\n\t\ttest('should use explicit variables instead of auto-generating when both are possible', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'API_KEY',\n\t\t\t\t\t\tvalue: 'Bearer {api_key}',\n\t\t\t\t\t\tdescription: 'Should not be used', // This should be ignored since we have explicit variables\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_key: {\n\t\t\t\t\t\t\t\tdescription: 'Your API key',\n\t\t\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Your API key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.env?.['API_KEY'], 'Bearer ${input:api_key}');\n\t\t\t}\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { AbstractCommonMcpManagementService } from '../../common/mcpManagementService.js';\nimport { IGalleryMcpServer, IGalleryMcpServerConfiguration, IInstallableMcpServer, ILocalMcpServer, InstallOptions, RegistryType, TransportType, UninstallOptions } from '../../common/mcpManagement.js';\nimport { McpServerType, McpServerVariableType, IMcpServerVariable } from '../../common/mcpPlatformTypes.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { NullLogService } from '../../../log/common/log.js';\n\nclass TestMcpManagementService extends AbstractCommonMcpManagementService {\n\n\toverride onInstallMcpServer = Event.None;\n\toverride onDidInstallMcpServers = Event.None;\n\toverride onDidUpdateMcpServers = Event.None;\n\toverride onUninstallMcpServer = Event.None;\n\toverride onDidUninstallMcpServer = Event.None;\n\n\toverride getInstalled(mcpResource?: URI): Promise<ILocalMcpServer[]> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride install(server: IInstallableMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride installFromGallery(server: IGalleryMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride updateMetadata(local: ILocalMcpServer, server: IGalleryMcpServer, profileLocation?: URI): Promise<ILocalMcpServer> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\toverride uninstall(server: ILocalMcpServer, options?: UninstallOptions): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\toverride canInstall(server: IGalleryMcpServer | IInstallableMcpServer): true | IMarkdownString {\n\t\tthrow new Error('Not supported');\n\t}\n}\n\nsuite('McpManagementService - getMcpServerConfigurationFromManifest', () => {\n\tlet service: TestMcpManagementService;\n\n\tsetup(() => {\n\t\tservice = new TestMcpManagementService(new NullLogService());\n\t});\n\n\tteardown(() => {\n\t\tservice.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('NPM Package Tests', () => {\n\t\ttest('basic NPM package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tregistryBaseUrl: 'https://registry.npmjs.org',\n\t\t\t\t\tidentifier: '@modelcontextprotocol/server-brave-search',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'BRAVE_API_KEY',\n\t\t\t\t\t\tvalue: 'test-key'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['@modelcontextprotocol/server-brave-search@1.0.2']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'BRAVE_API_KEY': 'test-key' });\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs, undefined);\n\t\t});\n\n\t\ttest('NPM package without version', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tregistryBaseUrl: 'https://registry.npmjs.org',\n\t\t\t\t\tidentifier: '@modelcontextprotocol/everything',\n\t\t\t\t\tversion: '',\n\t\t\t\t\ttransport: { type: TransportType.STDIO }\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['@modelcontextprotocol/everything']);\n\t\t\t}\n\t\t});\n\n\t\ttest('NPM package with environment variables containing variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'API_KEY',\n\t\t\t\t\t\tvalue: 'key-{api_token}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_token: {\n\t\t\t\t\t\t\t\tdescription: 'Your API token',\n\t\t\t\t\t\t\t\tisSecret: true,\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'API_KEY': 'key-${input:api_token}' });\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_token');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Your API token');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t});\n\n\t\ttest('environment variable with empty value should create input variable (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: '@modelcontextprotocol/server-brave-search',\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'BRAVE_API_KEY',\n\t\t\t\t\t\tvalue: '', // Empty value should create input variable\n\t\t\t\t\t\tdescription: 'Brave Search API Key',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently this creates env with empty string instead of input variable\n\t\t\t// Should create an input variable since no meaningful value is provided\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'BRAVE_API_KEY');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Brave Search API Key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\n\t\t\t// Environment should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'BRAVE_API_KEY': '${input:BRAVE_API_KEY}' });\n\t\t\t}\n\t\t});\n\n\t\ttest('environment variable with choices but empty value should create pick input (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'SSL_MODE',\n\t\t\t\t\t\tvalue: '', // Empty value should create input variable\n\t\t\t\t\t\tdescription: 'SSL connection mode',\n\t\t\t\t\t\tdefault: 'prefer',\n\t\t\t\t\t\tchoices: ['disable', 'prefer', 'require']\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently this creates env with empty string instead of input variable\n\t\t\t// Should create a pick input variable since choices are provided\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'SSL_MODE');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'SSL connection mode');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].default, 'prefer');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['disable', 'prefer', 'require']);\n\n\t\t\t// Environment should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'SSL_MODE': '${input:SSL_MODE}' });\n\t\t\t}\n\t\t});\n\n\t\ttest('NPM package with package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'snyk',\n\t\t\t\t\tversion: '1.1298.0',\n\t\t\t\t\tpackageArguments: [\n\t\t\t\t\t\t{ type: 'positional', value: 'mcp', valueHint: 'command', isRepeated: false },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\t\tname: '-t',\n\t\t\t\t\t\t\tvalue: 'stdio',\n\t\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['snyk@1.1298.0', 'mcp', '-t', 'stdio']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Python Package Tests', () => {\n\t\ttest('basic Python package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://pypi.org',\n\t\t\t\t\tidentifier: 'weather-mcp-server',\n\t\t\t\t\tversion: '0.5.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'WEATHER_API_KEY',\n\t\t\t\t\t\tvalue: 'test-key'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'WEATHER_UNITS',\n\t\t\t\t\t\tvalue: 'celsius'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.PYTHON);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'uvx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['weather-mcp-server==0.5.0']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, {\n\t\t\t\t\t'WEATHER_API_KEY': 'test-key',\n\t\t\t\t\t'WEATHER_UNITS': 'celsius'\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\ttest('Python package without version', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'weather-mcp-server',\n\t\t\t\t\tversion: ''\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.PYTHON);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['weather-mcp-server']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Docker Package Tests', () => {\n\t\ttest('basic Docker package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://docker.io',\n\t\t\t\t\tidentifier: 'mcp/filesystem',\n\t\t\t\t\tversion: '1.0.2',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--mount',\n\t\t\t\t\t\tvalue: 'type=bind,src=/host/path,dst=/container/path',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}],\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'LOG_LEVEL',\n\t\t\t\t\t\tvalue: 'info'\n\t\t\t\t\t}],\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: '/project',\n\t\t\t\t\t\tvalueHint: 'directory',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'docker');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'--mount', 'type=bind,src=/host/path,dst=/container/path',\n\t\t\t\t\t'-e', 'LOG_LEVEL',\n\t\t\t\t\t'mcp/filesystem:1.0.2',\n\t\t\t\t\t'/project'\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'LOG_LEVEL': 'info' });\n\t\t\t}\n\t\t});\n\n\t\ttest('Docker package with variables in runtime arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'example/database-manager-mcp',\n\t\t\t\t\tversion: '3.1.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '-e',\n\t\t\t\t\t\tvalue: 'DB_TYPE={db_type}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdb_type: {\n\t\t\t\t\t\t\t\tdescription: 'Type of database',\n\t\t\t\t\t\t\t\tchoices: ['postgres', 'mysql', 'mongodb', 'redis'],\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'-e', 'DB_TYPE=${input:db_type}',\n\t\t\t\t\t'example/database-manager-mcp:3.1.0'\n\t\t\t\t]);\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'db_type');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['postgres', 'mysql', 'mongodb', 'redis']);\n\t\t});\n\n\t\ttest('Docker package arguments without values should create input variables (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'example/database-manager-mcp',\n\t\t\t\t\tversion: '3.1.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--host',\n\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\tdefault: 'localhost',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'database_name',\n\t\t\t\t\t\tdescription: 'Name of the database to connect to',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\t// BUG: Currently named args without value are ignored, positional uses value_hint as literal\n\t\t\t// Should create input variables for both arguments\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\n\t\t\tconst hostInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'host');\n\t\t\tassert.strictEqual(hostInput?.description, 'Database host');\n\t\t\tassert.strictEqual(hostInput?.default, 'localhost');\n\t\t\tassert.strictEqual(hostInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst dbNameInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'database_name');\n\t\t\tassert.strictEqual(dbNameInput?.description, 'Name of the database to connect to');\n\t\t\tassert.strictEqual(dbNameInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\t// Args should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'example/database-manager-mcp:3.1.0',\n\t\t\t\t\t'--host', '${input:host}',\n\t\t\t\t\t'${input:database_name}'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\n\t\ttest('Docker Hub backward compatibility', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\tidentifier: 'example/test-image',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'docker');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'example/test-image:1.0.0'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('NuGet Package Tests', () => {\n\t\ttest('basic NuGet package configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NUGET,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tregistryBaseUrl: 'https://api.nuget.org',\n\t\t\t\t\tidentifier: 'Knapcode.SampleMcpServer',\n\t\t\t\t\tversion: '0.5.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'WEATHER_CHOICES',\n\t\t\t\t\t\tvalue: 'sunny,cloudy,rainy'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NUGET);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'dnx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['Knapcode.SampleMcpServer@0.5.0', '--yes']);\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, { 'WEATHER_CHOICES': 'sunny,cloudy,rainy' });\n\t\t\t}\n\t\t});\n\n\t\ttest('NuGet package with package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NUGET,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'Knapcode.SampleMcpServer',\n\t\t\t\t\tversion: '0.4.0-beta',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: 'mcp',\n\t\t\t\t\t\tvalueHint: 'command',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: 'start',\n\t\t\t\t\t\tvalueHint: 'action',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NUGET);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'Knapcode.SampleMcpServer@0.4.0-beta',\n\t\t\t\t\t'--yes',\n\t\t\t\t\t'--',\n\t\t\t\t\t'mcp',\n\t\t\t\t\t'start'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Remote Server Tests', () => {\n\t\ttest('SSE remote server configuration', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'http://mcp-fs.anonymous.modelcontextprotocol.io/sse'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'http://mcp-fs.anonymous.modelcontextprotocol.io/sse');\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.headers, undefined);\n\t\t\t}\n\t\t});\n\n\t\ttest('SSE remote server with headers and variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'https://mcp.anonymous.modelcontextprotocol.io/sse',\n\t\t\t\t\theaders: [{\n\t\t\t\t\t\tname: 'X-API-Key',\n\t\t\t\t\t\tvalue: '{api_key}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_key: {\n\t\t\t\t\t\t\t\tdescription: 'API key for authentication',\n\t\t\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'X-Region',\n\t\t\t\t\t\tvalue: 'us-east-1'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.headers, {\n\t\t\t\t\t'X-API-Key': '${input:api_key}',\n\t\t\t\t\t'X-Region': 'us-east-1'\n\t\t\t\t});\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\t\t});\n\n\t\ttest('streamable HTTP remote server', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.STREAMABLE_HTTP,\n\t\t\t\t\turl: 'https://mcp.anonymous.modelcontextprotocol.io/http'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'https://mcp.anonymous.modelcontextprotocol.io/http');\n\t\t\t}\n\t\t});\n\n\t\ttest('remote headers without values should create input variables', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tremotes: [{\n\t\t\t\t\ttype: TransportType.SSE,\n\t\t\t\t\turl: 'https://api.example.com/mcp',\n\t\t\t\t\theaders: [{\n\t\t\t\t\t\tname: 'Authorization',\n\t\t\t\t\t\tdescription: 'API token for authentication',\n\t\t\t\t\t\tisSecret: true,\n\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable\n\t\t\t\t\t}, {\n\t\t\t\t\t\tname: 'X-Custom-Header',\n\t\t\t\t\t\tdescription: 'Custom header value',\n\t\t\t\t\t\tdefault: 'default-value',\n\t\t\t\t\t\tchoices: ['option1', 'option2', 'option3']\n\t\t\t\t\t\t// Note: No 'value' field - should create input variable with choices\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.REMOTE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.REMOTE);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.REMOTE) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.url, 'https://api.example.com/mcp');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.headers, {\n\t\t\t\t\t'Authorization': '${input:Authorization}',\n\t\t\t\t\t'X-Custom-Header': '${input:X-Custom-Header}'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Should create input variables for headers without values\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\n\t\t\tconst authInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'Authorization');\n\t\t\tassert.strictEqual(authInput?.description, 'API token for authentication');\n\t\t\tassert.strictEqual(authInput?.password, true);\n\t\t\tassert.strictEqual(authInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst customInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'X-Custom-Header');\n\t\t\tassert.strictEqual(customInput?.description, 'Custom header value');\n\t\t\tassert.strictEqual(customInput?.default, 'default-value');\n\t\t\tassert.strictEqual(customInput?.type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(customInput?.options, ['option1', 'option2', 'option3']);\n\t\t});\n\t});\n\n\tsuite('Variable Interpolation Tests', () => {\n\t\ttest('multiple variables in single value', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'CONNECTION_STRING',\n\t\t\t\t\t\tvalue: 'server={host};port={port};database={db_name}',\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\thost: {\n\t\t\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\t\t\tdefault: 'localhost'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tport: {\n\t\t\t\t\t\t\t\tdescription: 'Database port',\n\t\t\t\t\t\t\t\tformat: 'number',\n\t\t\t\t\t\t\t\tdefault: '5432'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdb_name: {\n\t\t\t\t\t\t\t\tdescription: 'Database name',\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.env, {\n\t\t\t\t\t'CONNECTION_STRING': 'server=${input:host};port=${input:port};database=${input:db_name}'\n\t\t\t\t});\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 3);\n\n\t\t\tconst hostInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'host');\n\t\t\tassert.strictEqual(hostInput?.default, 'localhost');\n\t\t\tassert.strictEqual(hostInput?.type, McpServerVariableType.PROMPT);\n\n\t\t\tconst portInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'port');\n\t\t\tassert.strictEqual(portInput?.default, '5432');\n\n\t\t\tconst dbNameInput = result.mcpServerConfiguration.inputs?.find((i: IMcpServerVariable) => i.id === 'db_name');\n\t\t\tassert.strictEqual(dbNameInput?.description, 'Database name');\n\t\t});\n\n\t\ttest('variable with choices creates pick input', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--log-level',\n\t\t\t\t\t\tvalue: '{level}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tlevel: {\n\t\t\t\t\t\t\t\tdescription: 'Log level',\n\t\t\t\t\t\t\t\tchoices: ['debug', 'info', 'warn', 'error'],\n\t\t\t\t\t\t\t\tdefault: 'info'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PICK);\n\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.inputs?.[0].options, ['debug', 'info', 'warn', 'error']);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].default, 'info');\n\t\t});\n\n\t\ttest('variables in package arguments', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.DOCKER,\n\t\t\t\t\tidentifier: 'test-image',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--host',\n\t\t\t\t\t\tvalue: '{db_host}',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdb_host: {\n\t\t\t\t\t\t\t\tdescription: 'Database host',\n\t\t\t\t\t\t\t\tdefault: 'localhost'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalue: '{database_name}',\n\t\t\t\t\t\tvalueHint: 'database_name',\n\t\t\t\t\t\tisRepeated: false,\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tdatabase_name: {\n\t\t\t\t\t\t\t\tdescription: 'Name of the database to connect to',\n\t\t\t\t\t\t\t\tisRequired: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.DOCKER);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'run', '-i', '--rm',\n\t\t\t\t\t'test-image:1.0.0',\n\t\t\t\t\t'--host', '${input:db_host}',\n\t\t\t\t\t'${input:database_name}'\n\t\t\t\t]);\n\t\t\t}\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 2);\n\t\t});\n\n\t\ttest('positional arguments with value_hint should create input variables (GitHub issue #266106)', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: '@example/math-tool',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '2.0.1',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'calculation_type',\n\t\t\t\t\t\tdescription: 'Type of calculation to enable',\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t\t// Note: No 'value' field, only value_hint - should create input variable\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// BUG: Currently value_hint is used as literal value instead of creating input variable\n\t\t\t// Should create input variable instead\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'calculation_type');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Type of calculation to enable');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].type, McpServerVariableType.PROMPT);\n\n\t\t\t// Args should use input variable interpolation\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, [\n\t\t\t\t\t'@example/math-tool@2.0.1',\n\t\t\t\t\t'${input:calculation_type}'\n\t\t\t\t]);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Edge Cases and Error Handling', () => {\n\t\ttest('empty manifest should throw error', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {};\n\n\t\t\tassert.throws(() => {\n\t\t\t\tservice.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\t\t\t}, /No server package found/);\n\t\t});\n\n\t\ttest('manifest with no matching package type should use first package', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'python-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.type, McpServerType.LOCAL);\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'uvx'); // Python command since that's the package type\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['python-server==1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('manifest with matching package type should use that package', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.PYTHON,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'python-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}, {\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'node-server',\n\t\t\t\t\tversion: '2.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.command, 'npx');\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['node-server@2.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('undefined environment variables should be omitted', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0'\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.env, undefined);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument without value should only add name', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '--verbose',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['--verbose', 'test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('positional argument with undefined value should use value_hint', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tpackageArguments: [{\n\t\t\t\t\t\ttype: 'positional',\n\t\t\t\t\t\tvalueHint: 'target_directory',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0', 'target_directory']);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument with no name should generate notice', () => {\n\t\t\tconst manifest = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tvalue: 'some-value',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest as IGalleryMcpServerConfiguration, RegistryType.NODE);\n\n\t\t\t// Should generate a notice about the missing name\n\t\t\tassert.strictEqual(result.notices.length, 1);\n\t\t\tassert.ok(result.notices[0].includes('Named argument is missing a name'));\n\t\t\tassert.ok(result.notices[0].includes('some-value')); // Should include the argument details in JSON format\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\n\t\ttest('named argument with empty name should generate notice', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\truntimeArguments: [{\n\t\t\t\t\t\ttype: 'named',\n\t\t\t\t\t\tname: '',\n\t\t\t\t\t\tvalue: 'some-value',\n\t\t\t\t\t\tisRepeated: false\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\t// Should generate a notice about the missing name\n\t\t\tassert.strictEqual(result.notices.length, 1);\n\t\t\tassert.ok(result.notices[0].includes('Named argument is missing a name'));\n\t\t\tassert.ok(result.notices[0].includes('some-value')); // Should include the argument details in JSON format\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.deepStrictEqual(result.mcpServerConfiguration.config.args, ['test-server@1.0.0']);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('Variable Processing Order', () => {\n\t\ttest('should use explicit variables instead of auto-generating when both are possible', () => {\n\t\t\tconst manifest: IGalleryMcpServerConfiguration = {\n\t\t\t\tpackages: [{\n\t\t\t\t\tregistryType: RegistryType.NODE,\n\t\t\t\t\tidentifier: 'test-server',\n\t\t\t\t\ttransport: { type: TransportType.STDIO },\n\t\t\t\t\tversion: '1.0.0',\n\t\t\t\t\tenvironmentVariables: [{\n\t\t\t\t\t\tname: 'API_KEY',\n\t\t\t\t\t\tvalue: 'Bearer {api_key}',\n\t\t\t\t\t\tdescription: 'Should not be used', // This should be ignored since we have explicit variables\n\t\t\t\t\t\tvariables: {\n\t\t\t\t\t\t\tapi_key: {\n\t\t\t\t\t\t\t\tdescription: 'Your API key',\n\t\t\t\t\t\t\t\tisSecret: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t};\n\n\t\t\tconst result = service.getMcpServerConfigurationFromManifest(manifest, RegistryType.NODE);\n\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.length, 1);\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].id, 'api_key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].description, 'Your API key');\n\t\t\tassert.strictEqual(result.mcpServerConfiguration.inputs?.[0].password, true);\n\n\t\t\tif (result.mcpServerConfiguration.config.type === McpServerType.LOCAL) {\n\t\t\t\tassert.strictEqual(result.mcpServerConfiguration.config.env?.['API_KEY'], 'Bearer ${input:api_key}');\n\t\t\t}\n\t\t});\n\t});\n});\n"]}