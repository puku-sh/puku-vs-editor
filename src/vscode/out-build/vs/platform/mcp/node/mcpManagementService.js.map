{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/mcp/node/mcpManagementService.ts","vs/platform/mcp/node/mcpManagementService.ts"],"names":[],"mappings":"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","file":"mcpManagementService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../base/common/uri.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IUriIdentityService } from '../../uriIdentity/common/uriIdentity.js';\nimport { IGalleryMcpServer, IMcpGalleryService, IMcpManagementService, InstallOptions, ILocalMcpServer, RegistryType, IInstallableMcpServer } from '../common/mcpManagement.js';\nimport { McpUserResourceManagementService as CommonMcpUserResourceManagementService, McpManagementService as CommonMcpManagementService } from '../common/mcpManagementService.js';\nimport { IMcpResourceScannerService } from '../common/mcpResourceScannerService.js';\n\nexport class McpUserResourceManagementService extends CommonMcpUserResourceManagementService {\n\tconstructor(\n\t\tmcpResource: URI,\n\t\t@IMcpGalleryService mcpGalleryService: IMcpGalleryService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@ILogService logService: ILogService,\n\t\t@IMcpResourceScannerService mcpResourceScannerService: IMcpResourceScannerService,\n\t\t@IEnvironmentService environmentService: IEnvironmentService,\n\t) {\n\t\tsuper(mcpResource, mcpGalleryService, fileService, uriIdentityService, logService, mcpResourceScannerService, environmentService);\n\t}\n\n\toverride async installFromGallery(server: IGalleryMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthis.logService.trace('MCP Management Service: installGallery', server.name, server.galleryUrl);\n\n\t\tthis._onInstallMcpServer.fire({ name: server.name, mcpResource: this.mcpResource });\n\n\t\ttry {\n\t\t\tconst manifest = await this.updateMetadataFromGallery(server);\n\t\t\tconst packageType = options?.packageType ?? manifest.packages?.[0]?.registryType ?? RegistryType.REMOTE;\n\n\t\t\tconst { mcpServerConfiguration, notices } = this.getMcpServerConfigurationFromManifest(manifest, packageType);\n\n\t\t\tif (notices.length > 0) {\n\t\t\t\tthis.logService.warn(`MCP Management Service: Warnings while installing ${server.name}`, notices);\n\t\t\t}\n\n\t\t\tconst installable: IInstallableMcpServer = {\n\t\t\t\tname: server.name,\n\t\t\t\tconfig: {\n\t\t\t\t\t...mcpServerConfiguration.config,\n\t\t\t\t\tgallery: server.galleryUrl ?? true,\n\t\t\t\t\tversion: server.version\n\t\t\t\t},\n\t\t\t\tinputs: mcpServerConfiguration.inputs\n\t\t\t};\n\n\t\t\tawait this.mcpResourceScannerService.addMcpServers([installable], this.mcpResource, this.target);\n\n\t\t\tawait this.updateLocal();\n\t\t\tconst local = (await this.getInstalled()).find(s => s.name === server.name);\n\t\t\tif (!local) {\n\t\t\t\tthrow new Error(`Failed to install MCP server: ${server.name}`);\n\t\t\t}\n\t\t\treturn local;\n\t\t} catch (e) {\n\t\t\tthis._onDidInstallMcpServers.fire([{ name: server.name, source: server, error: e, mcpResource: this.mcpResource }]);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n}\n\nexport class McpManagementService extends CommonMcpManagementService implements IMcpManagementService {\n\tprotected override createMcpResourceManagementService(mcpResource: URI): McpUserResourceManagementService {\n\t\treturn this.instantiationService.createInstance(McpUserResourceManagementService, mcpResource);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../base/common/uri.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { IFileService } from '../../files/common/files.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IUriIdentityService } from '../../uriIdentity/common/uriIdentity.js';\nimport { IGalleryMcpServer, IMcpGalleryService, IMcpManagementService, InstallOptions, ILocalMcpServer, RegistryType, IInstallableMcpServer } from '../common/mcpManagement.js';\nimport { McpUserResourceManagementService as CommonMcpUserResourceManagementService, McpManagementService as CommonMcpManagementService } from '../common/mcpManagementService.js';\nimport { IMcpResourceScannerService } from '../common/mcpResourceScannerService.js';\n\nexport class McpUserResourceManagementService extends CommonMcpUserResourceManagementService {\n\tconstructor(\n\t\tmcpResource: URI,\n\t\t@IMcpGalleryService mcpGalleryService: IMcpGalleryService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@ILogService logService: ILogService,\n\t\t@IMcpResourceScannerService mcpResourceScannerService: IMcpResourceScannerService,\n\t\t@IEnvironmentService environmentService: IEnvironmentService,\n\t) {\n\t\tsuper(mcpResource, mcpGalleryService, fileService, uriIdentityService, logService, mcpResourceScannerService, environmentService);\n\t}\n\n\toverride async installFromGallery(server: IGalleryMcpServer, options?: InstallOptions): Promise<ILocalMcpServer> {\n\t\tthis.logService.trace('MCP Management Service: installGallery', server.name, server.galleryUrl);\n\n\t\tthis._onInstallMcpServer.fire({ name: server.name, mcpResource: this.mcpResource });\n\n\t\ttry {\n\t\t\tconst manifest = await this.updateMetadataFromGallery(server);\n\t\t\tconst packageType = options?.packageType ?? manifest.packages?.[0]?.registryType ?? RegistryType.REMOTE;\n\n\t\t\tconst { mcpServerConfiguration, notices } = this.getMcpServerConfigurationFromManifest(manifest, packageType);\n\n\t\t\tif (notices.length > 0) {\n\t\t\t\tthis.logService.warn(`MCP Management Service: Warnings while installing ${server.name}`, notices);\n\t\t\t}\n\n\t\t\tconst installable: IInstallableMcpServer = {\n\t\t\t\tname: server.name,\n\t\t\t\tconfig: {\n\t\t\t\t\t...mcpServerConfiguration.config,\n\t\t\t\t\tgallery: server.galleryUrl ?? true,\n\t\t\t\t\tversion: server.version\n\t\t\t\t},\n\t\t\t\tinputs: mcpServerConfiguration.inputs\n\t\t\t};\n\n\t\t\tawait this.mcpResourceScannerService.addMcpServers([installable], this.mcpResource, this.target);\n\n\t\t\tawait this.updateLocal();\n\t\t\tconst local = (await this.getInstalled()).find(s => s.name === server.name);\n\t\t\tif (!local) {\n\t\t\t\tthrow new Error(`Failed to install MCP server: ${server.name}`);\n\t\t\t}\n\t\t\treturn local;\n\t\t} catch (e) {\n\t\t\tthis._onDidInstallMcpServers.fire([{ name: server.name, source: server, error: e, mcpResource: this.mcpResource }]);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n}\n\nexport class McpManagementService extends CommonMcpManagementService implements IMcpManagementService {\n\tprotected override createMcpResourceManagementService(mcpResource: URI): McpUserResourceManagementService {\n\t\treturn this.instantiationService.createInstance(McpUserResourceManagementService, mcpResource);\n\t}\n}\n"]}