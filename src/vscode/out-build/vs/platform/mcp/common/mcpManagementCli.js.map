{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/mcp/common/mcpManagementCli.ts","vs/platform/mcp/common/mcpManagementCli.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAIhG,OAAO,EAAE,qBAAqB,EAAE,MAAM,oBAAoB,CAAC;AAIpD,IAAM,gBAAgB,GAAtB,MAAM,gBAAgB;IAC5B,YACkB,OAAgB,EACO,qBAA4C;QADnE,YAAO,GAAP,OAAO,CAAS;QACO,0BAAqB,GAArB,qBAAqB,CAAuB;IACjF,CAAC;IAEL,KAAK,CAAC,iBAAiB,CACtB,WAAqB;QAErB,MAAM,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC;QAChF,MAAM,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QACxC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,sBAAsB,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAChF,CAAC;IAEO,KAAK,CAAC,mBAAmB,CAAC,OAA0B;QAC3D,MAAM,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;IAC5H,CAAC;IAEO,qBAAqB,CAAC,MAAc;QAC3C,IAAI,MAAiF,CAAC;QACtF,IAAI,CAAC;YACJ,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAC7B,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,MAAM,IAAI,wBAAwB,CAAC,iBAAiB,MAAM,MAAM,CAAC,EAAE,CAAC,CAAC;QACtE,CAAC;QAED,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YAClB,MAAM,IAAI,wBAAwB,CAAC,4BAA4B,MAAM,EAAE,CAAC,CAAC;QAC1E,CAAC;QAED,IAAI,CAAC,CAAC,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,IAAI,MAAM,CAAC,EAAE,CAAC;YAClD,MAAM,IAAI,wBAAwB,CAAC,sCAAsC,MAAM,EAAE,CAAC,CAAC;QACpF,CAAC;QAED,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAI,EAAE,GAAG,MAAM,CAAC;QACzC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,IAA+B,EAAE,CAAC;IAClE,CAAC;CACD,CAAA;AArCY,gBAAgB;IAG1B,WAAA,qBAAqB,CAAA;GAHX,gBAAgB,CAqC5B;;AAED,MAAM,wBAAyB,SAAQ,KAAK;IAC3C,YAAY,OAAe;QAC1B,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC;IACtB,CAAC;CACD","file":"mcpManagementCli.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ILogger } from '../../log/common/log.js';\nimport { IMcpServerConfiguration, IMcpServerVariable } from './mcpPlatformTypes.js';\nimport { IMcpManagementService } from './mcpManagement.js';\n\ntype ValidatedConfig = { name: string; config: IMcpServerConfiguration; inputs?: IMcpServerVariable[] };\n\nexport class McpManagementCli {\n\tconstructor(\n\t\tprivate readonly _logger: ILogger,\n\t\t@IMcpManagementService private readonly _mcpManagementService: IMcpManagementService,\n\t) { }\n\n\tasync addMcpDefinitions(\n\t\tdefinitions: string[],\n\t) {\n\t\tconst configs = definitions.map((config) => this.validateConfiguration(config));\n\t\tawait this.updateMcpInResource(configs);\n\t\tthis._logger.info(`Added MCP servers: ${configs.map(c => c.name).join(', ')}`);\n\t}\n\n\tprivate async updateMcpInResource(configs: ValidatedConfig[]) {\n\t\tawait Promise.all(configs.map(({ name, config, inputs }) => this._mcpManagementService.install({ name, config, inputs })));\n\t}\n\n\tprivate validateConfiguration(config: string): ValidatedConfig {\n\t\tlet parsed: IMcpServerConfiguration & { name: string; inputs?: IMcpServerVariable[] };\n\t\ttry {\n\t\t\tparsed = JSON.parse(config);\n\t\t} catch (e) {\n\t\t\tthrow new InvalidMcpOperationError(`Invalid JSON '${config}': ${e}`);\n\t\t}\n\n\t\tif (!parsed.name) {\n\t\t\tthrow new InvalidMcpOperationError(`Missing name property in ${config}`);\n\t\t}\n\n\t\tif (!('command' in parsed) && !('url' in parsed)) {\n\t\t\tthrow new InvalidMcpOperationError(`Missing command or URL property in ${config}`);\n\t\t}\n\n\t\tconst { name, inputs, ...rest } = parsed;\n\t\treturn { name, inputs, config: rest as IMcpServerConfiguration };\n\t}\n}\n\nclass InvalidMcpOperationError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.stack = message;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ILogger } from '../../log/common/log.js';\nimport { IMcpServerConfiguration, IMcpServerVariable } from './mcpPlatformTypes.js';\nimport { IMcpManagementService } from './mcpManagement.js';\n\ntype ValidatedConfig = { name: string; config: IMcpServerConfiguration; inputs?: IMcpServerVariable[] };\n\nexport class McpManagementCli {\n\tconstructor(\n\t\tprivate readonly _logger: ILogger,\n\t\t@IMcpManagementService private readonly _mcpManagementService: IMcpManagementService,\n\t) { }\n\n\tasync addMcpDefinitions(\n\t\tdefinitions: string[],\n\t) {\n\t\tconst configs = definitions.map((config) => this.validateConfiguration(config));\n\t\tawait this.updateMcpInResource(configs);\n\t\tthis._logger.info(`Added MCP servers: ${configs.map(c => c.name).join(', ')}`);\n\t}\n\n\tprivate async updateMcpInResource(configs: ValidatedConfig[]) {\n\t\tawait Promise.all(configs.map(({ name, config, inputs }) => this._mcpManagementService.install({ name, config, inputs })));\n\t}\n\n\tprivate validateConfiguration(config: string): ValidatedConfig {\n\t\tlet parsed: IMcpServerConfiguration & { name: string; inputs?: IMcpServerVariable[] };\n\t\ttry {\n\t\t\tparsed = JSON.parse(config);\n\t\t} catch (e) {\n\t\t\tthrow new InvalidMcpOperationError(`Invalid JSON '${config}': ${e}`);\n\t\t}\n\n\t\tif (!parsed.name) {\n\t\t\tthrow new InvalidMcpOperationError(`Missing name property in ${config}`);\n\t\t}\n\n\t\tif (!('command' in parsed) && !('url' in parsed)) {\n\t\t\tthrow new InvalidMcpOperationError(`Missing command or URL property in ${config}`);\n\t\t}\n\n\t\tconst { name, inputs, ...rest } = parsed;\n\t\treturn { name, inputs, config: rest as IMcpServerConfiguration };\n\t}\n}\n\nclass InvalidMcpOperationError extends Error {\n\tconstructor(message: string) {\n\t\tsuper(message);\n\t\tthis.stack = message;\n\t}\n}\n"]}