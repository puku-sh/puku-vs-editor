{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/userDataProfile/test/electron-main/userDataProfileMainService.test.ts","vs/platform/userDataProfile/test/electron-main/userDataProfileMainService.test.ts"],"names":[],"mappings":"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","file":"userDataProfileMainService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { InMemoryFileSystemProvider } from '../../../files/common/inMemoryFilesystemProvider.js';\nimport { AbstractNativeEnvironmentService } from '../../../environment/common/environmentService.js';\nimport product from '../../../product/common/product.js';\nimport { UserDataProfilesMainService } from '../../electron-main/userDataProfile.js';\nimport { SaveStrategy, StateService } from '../../../state/node/stateService.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nconst ROOT = URI.file('tests').with({ scheme: 'vscode-tests' });\n\nclass TestEnvironmentService extends AbstractNativeEnvironmentService {\n\tconstructor(private readonly _appSettingsHome: URI) {\n\t\tsuper(Object.create(null), Object.create(null), { _serviceBrand: undefined, ...product });\n\t}\n\toverride get userRoamingDataHome() { return this._appSettingsHome.with({ scheme: Schemas.vscodeUserData }); }\n\toverride get extensionsPath() { return joinPath(this.userRoamingDataHome, 'extensions.json').path; }\n\toverride get stateResource() { return joinPath(this.userRoamingDataHome, 'state.json'); }\n\toverride get cacheHome() { return joinPath(this.userRoamingDataHome, 'cache'); }\n}\n\nsuite('UserDataProfileMainService', () => {\n\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\tlet testObject: UserDataProfilesMainService;\n\tlet environmentService: TestEnvironmentService, stateService: StateService;\n\n\tsetup(async () => {\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = disposables.add(new FileService(logService));\n\t\tconst fileSystemProvider = disposables.add(new InMemoryFileSystemProvider());\n\t\tdisposables.add(fileService.registerProvider(Schemas.vscodeUserData, fileSystemProvider));\n\n\t\tenvironmentService = new TestEnvironmentService(joinPath(ROOT, 'User'));\n\t\tstateService = disposables.add(new StateService(SaveStrategy.DELAYED, environmentService, logService, fileService));\n\n\t\ttestObject = disposables.add(new UserDataProfilesMainService(stateService, disposables.add(new UriIdentityService(fileService)), environmentService, fileService, logService));\n\t\tawait stateService.init();\n\t});\n\n\ttest('default profile', () => {\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('profiles always include default profile', () => {\n\t\tassert.deepStrictEqual(testObject.profiles.length, 1);\n\t\tassert.deepStrictEqual(testObject.profiles[0].isDefault, true);\n\t});\n\n\ttest('default profile when there are profiles', async () => {\n\t\tawait testObject.createNamedProfile('test');\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('default profile when profiles are removed', async () => {\n\t\tconst profile = await testObject.createNamedProfile('test');\n\t\tawait testObject.removeProfile(profile);\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('when no profile is set', async () => {\n\t\tawait testObject.createNamedProfile('profile1');\n\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id' }), undefined);\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id', configPath: environmentService.userRoamingDataHome }), undefined);\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id', uri: environmentService.userRoamingDataHome }), undefined);\n\t});\n\n\ttest('set profile to a workspace', async () => {\n\t\tconst workspace = { id: 'id', configPath: environmentService.userRoamingDataHome };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n\ttest('set profile to a folder', async () => {\n\t\tconst workspace = { id: 'id', uri: environmentService.userRoamingDataHome };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n\ttest('set profile to a window', async () => {\n\t\tconst workspace = { id: 'id' };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { FileService } from '../../../files/common/fileService.js';\nimport { NullLogService } from '../../../log/common/log.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { InMemoryFileSystemProvider } from '../../../files/common/inMemoryFilesystemProvider.js';\nimport { AbstractNativeEnvironmentService } from '../../../environment/common/environmentService.js';\nimport product from '../../../product/common/product.js';\nimport { UserDataProfilesMainService } from '../../electron-main/userDataProfile.js';\nimport { SaveStrategy, StateService } from '../../../state/node/stateService.js';\nimport { UriIdentityService } from '../../../uriIdentity/common/uriIdentityService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nconst ROOT = URI.file('tests').with({ scheme: 'vscode-tests' });\n\nclass TestEnvironmentService extends AbstractNativeEnvironmentService {\n\tconstructor(private readonly _appSettingsHome: URI) {\n\t\tsuper(Object.create(null), Object.create(null), { _serviceBrand: undefined, ...product });\n\t}\n\toverride get userRoamingDataHome() { return this._appSettingsHome.with({ scheme: Schemas.vscodeUserData }); }\n\toverride get extensionsPath() { return joinPath(this.userRoamingDataHome, 'extensions.json').path; }\n\toverride get stateResource() { return joinPath(this.userRoamingDataHome, 'state.json'); }\n\toverride get cacheHome() { return joinPath(this.userRoamingDataHome, 'cache'); }\n}\n\nsuite('UserDataProfileMainService', () => {\n\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\tlet testObject: UserDataProfilesMainService;\n\tlet environmentService: TestEnvironmentService, stateService: StateService;\n\n\tsetup(async () => {\n\t\tconst logService = new NullLogService();\n\t\tconst fileService = disposables.add(new FileService(logService));\n\t\tconst fileSystemProvider = disposables.add(new InMemoryFileSystemProvider());\n\t\tdisposables.add(fileService.registerProvider(Schemas.vscodeUserData, fileSystemProvider));\n\n\t\tenvironmentService = new TestEnvironmentService(joinPath(ROOT, 'User'));\n\t\tstateService = disposables.add(new StateService(SaveStrategy.DELAYED, environmentService, logService, fileService));\n\n\t\ttestObject = disposables.add(new UserDataProfilesMainService(stateService, disposables.add(new UriIdentityService(fileService)), environmentService, fileService, logService));\n\t\tawait stateService.init();\n\t});\n\n\ttest('default profile', () => {\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('profiles always include default profile', () => {\n\t\tassert.deepStrictEqual(testObject.profiles.length, 1);\n\t\tassert.deepStrictEqual(testObject.profiles[0].isDefault, true);\n\t});\n\n\ttest('default profile when there are profiles', async () => {\n\t\tawait testObject.createNamedProfile('test');\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('default profile when profiles are removed', async () => {\n\t\tconst profile = await testObject.createNamedProfile('test');\n\t\tawait testObject.removeProfile(profile);\n\t\tassert.strictEqual(testObject.defaultProfile.isDefault, true);\n\t});\n\n\ttest('when no profile is set', async () => {\n\t\tawait testObject.createNamedProfile('profile1');\n\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id' }), undefined);\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id', configPath: environmentService.userRoamingDataHome }), undefined);\n\t\tassert.equal(testObject.getProfileForWorkspace({ id: 'id', uri: environmentService.userRoamingDataHome }), undefined);\n\t});\n\n\ttest('set profile to a workspace', async () => {\n\t\tconst workspace = { id: 'id', configPath: environmentService.userRoamingDataHome };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n\ttest('set profile to a folder', async () => {\n\t\tconst workspace = { id: 'id', uri: environmentService.userRoamingDataHome };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n\ttest('set profile to a window', async () => {\n\t\tconst workspace = { id: 'id' };\n\t\tconst profile = await testObject.createNamedProfile('profile1');\n\n\t\ttestObject.setProfileForWorkspace(workspace, profile);\n\n\t\tassert.strictEqual(testObject.getProfileForWorkspace(workspace)?.id, profile.id);\n\t});\n\n});\n"]}