{"version":3,"sources":["vs/platform/userDataProfile/common/userDataProfile.ts"],"names":[],"mappings":"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","file":"userDataProfile.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { hash } from '../../../base/common/hash.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { basename, joinPath } from '../../../base/common/resources.js';\nimport { URI, UriDto } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { IEnvironmentService } from '../../environment/common/environment.js';\nimport { FileOperationResult, IFileService, toFileOperationResult } from '../../files/common/files.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IAnyWorkspaceIdentifier, isSingleFolderWorkspaceIdentifier, isWorkspaceIdentifier } from '../../workspace/common/workspace.js';\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { IUriIdentityService } from '../../uriIdentity/common/uriIdentity.js';\nimport { Promises } from '../../../base/common/async.js';\nimport { generateUuid } from '../../../base/common/uuid.js';\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\nimport { isString, Mutable } from '../../../base/common/types.js';\n\nexport const enum ProfileResourceType {\n\tSettings = 'settings',\n\tKeybindings = 'keybindings',\n\tSnippets = 'snippets',\n\tPrompts = 'prompts',\n\tTasks = 'tasks',\n\tExtensions = 'extensions',\n\tGlobalState = 'globalState',\n\tMcp = 'mcp',\n}\n\n/**\n * Flags to indicate whether to use the default profile or not.\n */\nexport type UseDefaultProfileFlags = { [key in ProfileResourceType]?: boolean };\nexport type ProfileResourceTypeFlags = UseDefaultProfileFlags;\n\nexport interface IUserDataProfile {\n\treadonly id: string;\n\treadonly isDefault: boolean;\n\treadonly name: string;\n\treadonly icon?: string;\n\treadonly location: URI;\n\treadonly globalStorageHome: URI;\n\treadonly settingsResource: URI;\n\treadonly keybindingsResource: URI;\n\treadonly tasksResource: URI;\n\treadonly snippetsHome: URI;\n\treadonly promptsHome: URI;\n\treadonly extensionsResource: URI;\n\treadonly mcpResource: URI;\n\treadonly cacheHome: URI;\n\treadonly useDefaultFlags?: UseDefaultProfileFlags;\n\treadonly isTransient?: boolean;\n\treadonly workspaces?: readonly URI[];\n}\n\nexport function isUserDataProfile(thing: unknown): thing is IUserDataProfile {\n\tconst candidate = thing as IUserDataProfile | undefined;\n\n\treturn !!(candidate && typeof candidate === 'object'\n\t\t&& typeof candidate.id === 'string'\n\t\t&& typeof candidate.isDefault === 'boolean'\n\t\t&& typeof candidate.name === 'string'\n\t\t&& URI.isUri(candidate.location)\n\t\t&& URI.isUri(candidate.globalStorageHome)\n\t\t&& URI.isUri(candidate.settingsResource)\n\t\t&& URI.isUri(candidate.keybindingsResource)\n\t\t&& URI.isUri(candidate.tasksResource)\n\t\t&& URI.isUri(candidate.snippetsHome)\n\t\t&& URI.isUri(candidate.promptsHome)\n\t\t&& URI.isUri(candidate.extensionsResource)\n\t\t&& URI.isUri(candidate.mcpResource)\n\t);\n}\n\nexport type DidChangeProfilesEvent = { readonly added: readonly IUserDataProfile[]; readonly removed: readonly IUserDataProfile[]; readonly updated: readonly IUserDataProfile[]; readonly all: readonly IUserDataProfile[] };\n\nexport type WillCreateProfileEvent = {\n\tprofile: IUserDataProfile;\n\tjoin(promise: Promise<void>): void;\n};\n\nexport type WillRemoveProfileEvent = {\n\tprofile: IUserDataProfile;\n\tjoin(promise: Promise<void>): void;\n};\n\nexport interface IUserDataProfileOptions {\n\treadonly icon?: string;\n\treadonly useDefaultFlags?: UseDefaultProfileFlags;\n\treadonly transient?: boolean;\n\treadonly workspaces?: readonly URI[];\n}\n\nexport interface IUserDataProfileUpdateOptions extends Omit<IUserDataProfileOptions, 'icon'> {\n\treadonly name?: string;\n\treadonly icon?: string | null;\n}\n\nexport const IUserDataProfilesService = createDecorator<IUserDataProfilesService>('IUserDataProfilesService');\nexport interface IUserDataProfilesService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly profilesHome: URI;\n\treadonly defaultProfile: IUserDataProfile;\n\n\treadonly onDidChangeProfiles: Event<DidChangeProfilesEvent>;\n\treadonly profiles: readonly IUserDataProfile[];\n\n\treadonly onDidResetWorkspaces: Event<void>;\n\n\tcreateNamedProfile(name: string, options?: IUserDataProfileOptions, workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile>;\n\tcreateTransientProfile(workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile>;\n\tcreateProfile(id: string, name: string, options?: IUserDataProfileOptions, workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile>;\n\tupdateProfile(profile: IUserDataProfile, options?: IUserDataProfileUpdateOptions,): Promise<IUserDataProfile>;\n\tremoveProfile(profile: IUserDataProfile): Promise<void>;\n\n\tsetProfileForWorkspace(workspaceIdentifier: IAnyWorkspaceIdentifier, profile: IUserDataProfile): Promise<void>;\n\tresetWorkspaces(): Promise<void>;\n\n\tcleanUp(): Promise<void>;\n\tcleanUpTransientProfiles(): Promise<void>;\n}\n\nexport function reviveProfile(profile: UriDto<IUserDataProfile>, scheme: string): IUserDataProfile {\n\treturn {\n\t\tid: profile.id,\n\t\tisDefault: profile.isDefault,\n\t\tname: profile.name,\n\t\ticon: profile.icon,\n\t\tlocation: URI.revive(profile.location).with({ scheme }),\n\t\tglobalStorageHome: URI.revive(profile.globalStorageHome).with({ scheme }),\n\t\tsettingsResource: URI.revive(profile.settingsResource).with({ scheme }),\n\t\tkeybindingsResource: URI.revive(profile.keybindingsResource).with({ scheme }),\n\t\ttasksResource: URI.revive(profile.tasksResource).with({ scheme }),\n\t\tsnippetsHome: URI.revive(profile.snippetsHome).with({ scheme }),\n\t\tpromptsHome: URI.revive(profile.promptsHome).with({ scheme }),\n\t\textensionsResource: URI.revive(profile.extensionsResource).with({ scheme }),\n\t\tmcpResource: URI.revive(profile.mcpResource).with({ scheme }),\n\t\tcacheHome: URI.revive(profile.cacheHome).with({ scheme }),\n\t\tuseDefaultFlags: profile.useDefaultFlags,\n\t\tisTransient: profile.isTransient,\n\t\tworkspaces: profile.workspaces?.map(w => URI.revive(w)),\n\t};\n}\n\nexport function toUserDataProfile(id: string, name: string, location: URI, profilesCacheHome: URI, options?: IUserDataProfileOptions, defaultProfile?: IUserDataProfile): IUserDataProfile {\n\treturn {\n\t\tid,\n\t\tname,\n\t\tlocation,\n\t\tisDefault: false,\n\t\ticon: options?.icon,\n\t\tglobalStorageHome: defaultProfile && options?.useDefaultFlags?.globalState ? defaultProfile.globalStorageHome : joinPath(location, 'globalStorage'),\n\t\tsettingsResource: defaultProfile && options?.useDefaultFlags?.settings ? defaultProfile.settingsResource : joinPath(location, 'settings.json'),\n\t\tkeybindingsResource: defaultProfile && options?.useDefaultFlags?.keybindings ? defaultProfile.keybindingsResource : joinPath(location, 'keybindings.json'),\n\t\ttasksResource: defaultProfile && options?.useDefaultFlags?.tasks ? defaultProfile.tasksResource : joinPath(location, 'tasks.json'),\n\t\tsnippetsHome: defaultProfile && options?.useDefaultFlags?.snippets ? defaultProfile.snippetsHome : joinPath(location, 'snippets'),\n\t\tpromptsHome: defaultProfile && options?.useDefaultFlags?.prompts ? defaultProfile.promptsHome : joinPath(location, 'prompts'),\n\t\textensionsResource: defaultProfile && options?.useDefaultFlags?.extensions ? defaultProfile.extensionsResource : joinPath(location, 'extensions.json'),\n\t\tmcpResource: defaultProfile && options?.useDefaultFlags?.mcp ? defaultProfile.mcpResource : joinPath(location, 'mcp.json'),\n\t\tcacheHome: joinPath(profilesCacheHome, id),\n\t\tuseDefaultFlags: options?.useDefaultFlags,\n\t\tisTransient: options?.transient,\n\t\tworkspaces: options?.workspaces,\n\t};\n}\n\nexport type UserDataProfilesObject = {\n\tprofiles: IUserDataProfile[];\n\temptyWindows: Map<string, IUserDataProfile>;\n};\n\nexport type StoredUserDataProfile = {\n\tname: string;\n\tlocation: URI;\n\ticon?: string;\n\tuseDefaultFlags?: UseDefaultProfileFlags;\n};\n\nexport type StoredProfileAssociations = {\n\tworkspaces?: IStringDictionary<string>;\n\temptyWindows?: IStringDictionary<string>;\n};\n\nexport class UserDataProfilesService extends Disposable implements IUserDataProfilesService {\n\n\tprotected static readonly PROFILES_KEY = 'userDataProfiles';\n\tprotected static readonly PROFILE_ASSOCIATIONS_KEY = 'profileAssociations';\n\n\treadonly _serviceBrand: undefined;\n\n\treadonly profilesHome: URI;\n\tprivate readonly profilesCacheHome: URI;\n\n\tget defaultProfile(): IUserDataProfile { return this.profiles[0]; }\n\tget profiles(): IUserDataProfile[] { return [...this.profilesObject.profiles, ...this.transientProfilesObject.profiles]; }\n\n\tprotected readonly _onDidChangeProfiles = this._register(new Emitter<DidChangeProfilesEvent>());\n\treadonly onDidChangeProfiles = this._onDidChangeProfiles.event;\n\n\tprotected readonly _onWillCreateProfile = this._register(new Emitter<WillCreateProfileEvent>());\n\treadonly onWillCreateProfile = this._onWillCreateProfile.event;\n\n\tprotected readonly _onWillRemoveProfile = this._register(new Emitter<WillRemoveProfileEvent>());\n\treadonly onWillRemoveProfile = this._onWillRemoveProfile.event;\n\n\tprivate readonly _onDidResetWorkspaces = this._register(new Emitter<void>());\n\treadonly onDidResetWorkspaces = this._onDidResetWorkspaces.event;\n\n\tprivate profileCreationPromises = new Map<string, Promise<IUserDataProfile>>();\n\n\tprotected readonly transientProfilesObject: UserDataProfilesObject = {\n\t\tprofiles: [],\n\t\temptyWindows: new Map()\n\t};\n\n\tconstructor(\n\t\t@IEnvironmentService protected readonly environmentService: IEnvironmentService,\n\t\t@IFileService protected readonly fileService: IFileService,\n\t\t@IUriIdentityService protected readonly uriIdentityService: IUriIdentityService,\n\t\t@ILogService protected readonly logService: ILogService\n\t) {\n\t\tsuper();\n\t\tthis.profilesHome = joinPath(this.environmentService.userRoamingDataHome, 'profiles');\n\t\tthis.profilesCacheHome = joinPath(this.environmentService.cacheHome, 'CachedProfilesData');\n\t}\n\n\tinit(): void {\n\t\tthis._profilesObject = undefined;\n\t}\n\n\tprotected _profilesObject: UserDataProfilesObject | undefined;\n\tprotected get profilesObject(): UserDataProfilesObject {\n\t\tif (!this._profilesObject) {\n\t\t\tconst defaultProfile = this.createDefaultProfile();\n\t\t\tconst profiles: Array<Mutable<IUserDataProfile>> = [defaultProfile];\n\t\t\ttry {\n\t\t\t\tfor (const storedProfile of this.getStoredProfiles()) {\n\t\t\t\t\tif (!storedProfile.name || !isString(storedProfile.name) || !storedProfile.location) {\n\t\t\t\t\t\tthis.logService.warn('Skipping the invalid stored profile', storedProfile.location || storedProfile.name);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tprofiles.push(toUserDataProfile(basename(storedProfile.location), storedProfile.name, storedProfile.location, this.profilesCacheHome, { icon: storedProfile.icon, useDefaultFlags: storedProfile.useDefaultFlags }, defaultProfile));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t\tconst emptyWindows = new Map<string, IUserDataProfile>();\n\t\t\tif (profiles.length) {\n\t\t\t\ttry {\n\t\t\t\t\tconst profileAssociaitions = this.getStoredProfileAssociations();\n\t\t\t\t\tif (profileAssociaitions.workspaces) {\n\t\t\t\t\t\tfor (const [workspacePath, profileId] of Object.entries(profileAssociaitions.workspaces)) {\n\t\t\t\t\t\t\tconst workspace = URI.parse(workspacePath);\n\t\t\t\t\t\t\tconst profile = profiles.find(p => p.id === profileId);\n\t\t\t\t\t\t\tif (profile) {\n\t\t\t\t\t\t\t\tconst workspaces = profile.workspaces ? profile.workspaces.slice(0) : [];\n\t\t\t\t\t\t\t\tworkspaces.push(workspace);\n\t\t\t\t\t\t\t\tprofile.workspaces = workspaces;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (profileAssociaitions.emptyWindows) {\n\t\t\t\t\t\tfor (const [windowId, profileId] of Object.entries(profileAssociaitions.emptyWindows)) {\n\t\t\t\t\t\t\tconst profile = profiles.find(p => p.id === profileId);\n\t\t\t\t\t\t\tif (profile) {\n\t\t\t\t\t\t\t\temptyWindows.set(windowId, profile);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.logService.error(error);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._profilesObject = { profiles, emptyWindows };\n\t\t}\n\t\treturn this._profilesObject;\n\t}\n\n\tprivate createDefaultProfile() {\n\t\tconst defaultProfile = toUserDataProfile('__default__profile__', localize('defaultProfile', \"Default\"), this.environmentService.userRoamingDataHome, this.profilesCacheHome);\n\t\treturn { ...defaultProfile, extensionsResource: this.getDefaultProfileExtensionsLocation() ?? defaultProfile.extensionsResource, isDefault: true };\n\t}\n\n\tasync createTransientProfile(workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile> {\n\t\tconst namePrefix = `Temp`;\n\t\tconst nameRegEx = new RegExp(`${escapeRegExpCharacters(namePrefix)}\\\\s(\\\\d+)`);\n\t\tlet nameIndex = 0;\n\t\tfor (const profile of this.profiles) {\n\t\t\tconst matches = nameRegEx.exec(profile.name);\n\t\t\tconst index = matches ? parseInt(matches[1]) : 0;\n\t\t\tnameIndex = index > nameIndex ? index : nameIndex;\n\t\t}\n\t\tconst name = `${namePrefix} ${nameIndex + 1}`;\n\t\treturn this.createProfile(hash(generateUuid()).toString(16), name, { transient: true }, workspaceIdentifier);\n\t}\n\n\tasync createNamedProfile(name: string, options?: IUserDataProfileOptions, workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile> {\n\t\treturn this.createProfile(hash(generateUuid()).toString(16), name, options, workspaceIdentifier);\n\t}\n\n\tasync createProfile(id: string, name: string, options?: IUserDataProfileOptions, workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile> {\n\t\tconst profile = await this.doCreateProfile(id, name, options, workspaceIdentifier);\n\n\t\treturn profile;\n\t}\n\n\tprivate async doCreateProfile(id: string, name: string, options?: IUserDataProfileOptions, workspaceIdentifier?: IAnyWorkspaceIdentifier): Promise<IUserDataProfile> {\n\t\tif (!isString(name) || !name) {\n\t\t\tthrow new Error('Name of the profile is mandatory and must be of type `string`');\n\t\t}\n\n\t\tlet profileCreationPromise = this.profileCreationPromises.get(name);\n\t\tif (!profileCreationPromise) {\n\t\t\tprofileCreationPromise = (async () => {\n\t\t\t\ttry {\n\t\t\t\t\tconst existing = this.profiles.find(p => p.id === id || (!p.isTransient && !options?.transient && p.name === name));\n\t\t\t\t\tif (existing) {\n\t\t\t\t\t\tthrow new Error(`Profile with ${name} name already exists`);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst workspace = workspaceIdentifier ? this.getWorkspace(workspaceIdentifier) : undefined;\n\t\t\t\t\tif (URI.isUri(workspace)) {\n\t\t\t\t\t\toptions = { ...options, workspaces: [workspace] };\n\t\t\t\t\t}\n\t\t\t\t\tconst profile = toUserDataProfile(id, name, joinPath(this.profilesHome, id), this.profilesCacheHome, options, this.defaultProfile);\n\t\t\t\t\tawait this.fileService.createFolder(profile.location);\n\n\t\t\t\t\tconst joiners: Promise<void>[] = [];\n\t\t\t\t\tthis._onWillCreateProfile.fire({\n\t\t\t\t\t\tprofile,\n\t\t\t\t\t\tjoin(promise) {\n\t\t\t\t\t\t\tjoiners.push(promise);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tawait Promises.settled(joiners);\n\n\t\t\t\t\tif (workspace && !URI.isUri(workspace)) {\n\t\t\t\t\t\tthis.updateEmptyWindowAssociation(workspace, profile, !!profile.isTransient);\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateProfiles([profile], [], []);\n\t\t\t\t\treturn profile;\n\t\t\t\t} finally {\n\t\t\t\t\tthis.profileCreationPromises.delete(name);\n\t\t\t\t}\n\t\t\t})();\n\t\t\tthis.profileCreationPromises.set(name, profileCreationPromise);\n\t\t}\n\t\treturn profileCreationPromise;\n\t}\n\n\tasync updateProfile(profile: IUserDataProfile, options: IUserDataProfileUpdateOptions): Promise<IUserDataProfile> {\n\t\tconst profilesToUpdate: IUserDataProfile[] = [];\n\t\tfor (const existing of this.profiles) {\n\t\t\tlet profileToUpdate: Mutable<IUserDataProfile> | undefined;\n\n\t\t\tif (profile.id === existing.id) {\n\t\t\t\tif (!existing.isDefault) {\n\t\t\t\t\tprofileToUpdate = toUserDataProfile(existing.id, options.name ?? existing.name, existing.location, this.profilesCacheHome, {\n\t\t\t\t\t\ticon: options.icon === null ? undefined : options.icon ?? existing.icon,\n\t\t\t\t\t\ttransient: options.transient ?? existing.isTransient,\n\t\t\t\t\t\tuseDefaultFlags: options.useDefaultFlags ?? existing.useDefaultFlags,\n\t\t\t\t\t\tworkspaces: options.workspaces ?? existing.workspaces,\n\t\t\t\t\t}, this.defaultProfile);\n\t\t\t\t} else if (options.workspaces) {\n\t\t\t\t\tprofileToUpdate = existing;\n\t\t\t\t\tprofileToUpdate.workspaces = options.workspaces;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if (options.workspaces) {\n\t\t\t\tconst workspaces = existing.workspaces?.filter(w1 => !options.workspaces?.some(w2 => this.uriIdentityService.extUri.isEqual(w1, w2)));\n\t\t\t\tif (existing.workspaces?.length !== workspaces?.length) {\n\t\t\t\t\tprofileToUpdate = existing;\n\t\t\t\t\tprofileToUpdate.workspaces = workspaces;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (profileToUpdate) {\n\t\t\t\tprofilesToUpdate.push(profileToUpdate);\n\t\t\t}\n\t\t}\n\n\t\tif (!profilesToUpdate.length) {\n\t\t\tif (profile.isDefault) {\n\t\t\t\tthrow new Error('Cannot update default profile');\n\t\t\t}\n\t\t\tthrow new Error(`Profile '${profile.name}' does not exist`);\n\t\t}\n\n\t\tthis.updateProfiles([], [], profilesToUpdate);\n\n\t\tconst updatedProfile = this.profiles.find(p => p.id === profile.id);\n\t\tif (!updatedProfile) {\n\t\t\tthrow new Error(`Profile '${profile.name}' was not updated`);\n\t\t}\n\n\t\treturn updatedProfile;\n\t}\n\n\tasync removeProfile(profileToRemove: IUserDataProfile): Promise<void> {\n\t\tif (profileToRemove.isDefault) {\n\t\t\tthrow new Error('Cannot remove default profile');\n\t\t}\n\t\tconst profile = this.profiles.find(p => p.id === profileToRemove.id);\n\t\tif (!profile) {\n\t\t\tthrow new Error(`Profile '${profileToRemove.name}' does not exist`);\n\t\t}\n\n\t\tconst joiners: Promise<void>[] = [];\n\t\tthis._onWillRemoveProfile.fire({\n\t\t\tprofile,\n\t\t\tjoin(promise) {\n\t\t\t\tjoiners.push(promise);\n\t\t\t}\n\t\t});\n\n\t\ttry {\n\t\t\tawait Promise.allSettled(joiners);\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t}\n\n\t\tthis.updateProfiles([], [profile], []);\n\n\t\ttry {\n\t\t\tawait this.fileService.del(profile.cacheHome, { recursive: true });\n\t\t} catch (error) {\n\t\t\tif (toFileOperationResult(error) !== FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync setProfileForWorkspace(workspaceIdentifier: IAnyWorkspaceIdentifier, profileToSet: IUserDataProfile): Promise<void> {\n\t\tconst profile = this.profiles.find(p => p.id === profileToSet.id);\n\t\tif (!profile) {\n\t\t\tthrow new Error(`Profile '${profileToSet.name}' does not exist`);\n\t\t}\n\n\t\tconst workspace = this.getWorkspace(workspaceIdentifier);\n\t\tif (URI.isUri(workspace)) {\n\t\t\tconst workspaces = profile.workspaces ? [...profile.workspaces] : [];\n\t\t\tif (!workspaces.some(w => this.uriIdentityService.extUri.isEqual(w, workspace))) {\n\t\t\t\tworkspaces.push(workspace);\n\t\t\t\tawait this.updateProfile(profile, { workspaces });\n\t\t\t}\n\t\t} else {\n\t\t\tthis.updateEmptyWindowAssociation(workspace, profile, false);\n\t\t\tthis.updateStoredProfiles(this.profiles);\n\t\t}\n\t}\n\n\tunsetWorkspace(workspaceIdentifier: IAnyWorkspaceIdentifier, transient: boolean = false): void {\n\t\tconst workspace = this.getWorkspace(workspaceIdentifier);\n\t\tif (URI.isUri(workspace)) {\n\t\t\tconst currentlyAssociatedProfile = this.getProfileForWorkspace(workspaceIdentifier);\n\t\t\tif (currentlyAssociatedProfile) {\n\t\t\t\tthis.updateProfile(currentlyAssociatedProfile, { workspaces: currentlyAssociatedProfile.workspaces?.filter(w => !this.uriIdentityService.extUri.isEqual(w, workspace)) });\n\t\t\t}\n\t\t} else {\n\t\t\tthis.updateEmptyWindowAssociation(workspace, undefined, transient);\n\t\t\tthis.updateStoredProfiles(this.profiles);\n\t\t}\n\t}\n\n\tasync resetWorkspaces(): Promise<void> {\n\t\tthis.transientProfilesObject.emptyWindows.clear();\n\t\tthis.profilesObject.emptyWindows.clear();\n\t\tfor (const profile of this.profiles) {\n\t\t\t(<Mutable<IUserDataProfile>>profile).workspaces = undefined;\n\t\t}\n\t\tthis.updateProfiles([], [], this.profiles);\n\t\tthis._onDidResetWorkspaces.fire();\n\t}\n\n\tasync cleanUp(): Promise<void> {\n\t\tif (await this.fileService.exists(this.profilesHome)) {\n\t\t\tconst stat = await this.fileService.resolve(this.profilesHome);\n\t\t\tawait Promise.all((stat.children || [])\n\t\t\t\t.filter(child => child.isDirectory && this.profiles.every(p => !this.uriIdentityService.extUri.isEqual(p.location, child.resource)))\n\t\t\t\t.map(child => this.fileService.del(child.resource, { recursive: true })));\n\t\t}\n\t}\n\n\tasync cleanUpTransientProfiles(): Promise<void> {\n\t\tconst unAssociatedTransientProfiles = this.transientProfilesObject.profiles.filter(p => !this.isProfileAssociatedToWorkspace(p));\n\t\tawait Promise.allSettled(unAssociatedTransientProfiles.map(p => this.removeProfile(p)));\n\t}\n\n\tgetProfileForWorkspace(workspaceIdentifier: IAnyWorkspaceIdentifier): IUserDataProfile | undefined {\n\t\tconst workspace = this.getWorkspace(workspaceIdentifier);\n\t\treturn URI.isUri(workspace)\n\t\t\t? this.profiles.find(p => p.workspaces?.some(w => this.uriIdentityService.extUri.isEqual(w, workspace)))\n\t\t\t: (this.profilesObject.emptyWindows.get(workspace) ?? this.transientProfilesObject.emptyWindows.get(workspace));\n\t}\n\n\tprotected getWorkspace(workspaceIdentifier: IAnyWorkspaceIdentifier): URI | string {\n\t\tif (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n\t\t\treturn workspaceIdentifier.uri;\n\t\t}\n\t\tif (isWorkspaceIdentifier(workspaceIdentifier)) {\n\t\t\treturn workspaceIdentifier.configPath;\n\t\t}\n\t\treturn workspaceIdentifier.id;\n\t}\n\n\tprivate isProfileAssociatedToWorkspace(profile: IUserDataProfile): boolean {\n\t\tif (profile.workspaces?.length) {\n\t\t\treturn true;\n\t\t}\n\t\tif ([...this.profilesObject.emptyWindows.values()].some(windowProfile => this.uriIdentityService.extUri.isEqual(windowProfile.location, profile.location))) {\n\t\t\treturn true;\n\t\t}\n\t\tif ([...this.transientProfilesObject.emptyWindows.values()].some(windowProfile => this.uriIdentityService.extUri.isEqual(windowProfile.location, profile.location))) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate updateProfiles(added: IUserDataProfile[], removed: IUserDataProfile[], updated: IUserDataProfile[]): void {\n\t\tconst allProfiles: Mutable<IUserDataProfile>[] = [...this.profiles, ...added];\n\n\t\tconst transientProfiles = this.transientProfilesObject.profiles;\n\t\tthis.transientProfilesObject.profiles = [];\n\n\t\tconst profiles: IUserDataProfile[] = [];\n\n\t\tfor (let profile of allProfiles) {\n\t\t\t// removed\n\t\t\tif (removed.some(p => profile.id === p.id)) {\n\t\t\t\tfor (const windowId of [...this.profilesObject.emptyWindows.keys()]) {\n\t\t\t\t\tif (profile.id === this.profilesObject.emptyWindows.get(windowId)?.id) {\n\t\t\t\t\t\tthis.profilesObject.emptyWindows.delete(windowId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!profile.isDefault) {\n\t\t\t\tprofile = updated.find(p => profile.id === p.id) ?? profile;\n\t\t\t\tconst transientProfile = transientProfiles.find(p => profile.id === p.id);\n\t\t\t\tif (profile.isTransient) {\n\t\t\t\t\tthis.transientProfilesObject.profiles.push(profile);\n\t\t\t\t} else {\n\t\t\t\t\tif (transientProfile) {\n\t\t\t\t\t\t// Move the empty window associations from the transient profile to the persisted profile\n\t\t\t\t\t\tfor (const [windowId, p] of this.transientProfilesObject.emptyWindows.entries()) {\n\t\t\t\t\t\t\tif (profile.id === p.id) {\n\t\t\t\t\t\t\t\tthis.transientProfilesObject.emptyWindows.delete(windowId);\n\t\t\t\t\t\t\t\tthis.profilesObject.emptyWindows.set(windowId, profile);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (profile.workspaces?.length === 0) {\n\t\t\t\tprofile.workspaces = undefined;\n\t\t\t}\n\n\t\t\tprofiles.push(profile);\n\t\t}\n\n\t\tthis.updateStoredProfiles(profiles);\n\t\tthis.triggerProfilesChanges(added, removed, updated);\n\t}\n\n\tprotected triggerProfilesChanges(added: IUserDataProfile[], removed: IUserDataProfile[], updated: IUserDataProfile[]) {\n\t\tthis._onDidChangeProfiles.fire({ added, removed, updated, all: this.profiles });\n\t}\n\n\tprivate updateEmptyWindowAssociation(windowId: string, newProfile: IUserDataProfile | undefined, transient: boolean): void {\n\t\t// Force transient if the new profile to associate is transient\n\t\ttransient = newProfile?.isTransient ? true : transient;\n\n\t\tif (transient) {\n\t\t\tif (newProfile) {\n\t\t\t\tthis.transientProfilesObject.emptyWindows.set(windowId, newProfile);\n\t\t\t} else {\n\t\t\t\tthis.transientProfilesObject.emptyWindows.delete(windowId);\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\t// Unset the transiet association if any\n\t\t\tthis.transientProfilesObject.emptyWindows.delete(windowId);\n\t\t\tif (newProfile) {\n\t\t\t\tthis.profilesObject.emptyWindows.set(windowId, newProfile);\n\t\t\t} else {\n\t\t\t\tthis.profilesObject.emptyWindows.delete(windowId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateStoredProfiles(profiles: IUserDataProfile[]): void {\n\t\tconst storedProfiles: StoredUserDataProfile[] = [];\n\t\tconst workspaces: IStringDictionary<string> = {};\n\t\tconst emptyWindows: IStringDictionary<string> = {};\n\n\t\tfor (const profile of profiles) {\n\t\t\tif (profile.isTransient) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!profile.isDefault) {\n\t\t\t\tstoredProfiles.push({ location: profile.location, name: profile.name, icon: profile.icon, useDefaultFlags: profile.useDefaultFlags });\n\t\t\t}\n\t\t\tif (profile.workspaces) {\n\t\t\t\tfor (const workspace of profile.workspaces) {\n\t\t\t\t\tworkspaces[workspace.toString()] = profile.id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const [windowId, profile] of this.profilesObject.emptyWindows.entries()) {\n\t\t\temptyWindows[windowId.toString()] = profile.id;\n\t\t}\n\n\t\tthis.saveStoredProfileAssociations({ workspaces, emptyWindows });\n\t\tthis.saveStoredProfiles(storedProfiles);\n\t\tthis._profilesObject = undefined;\n\t}\n\n\tprotected getStoredProfiles(): StoredUserDataProfile[] { return []; }\n\tprotected saveStoredProfiles(storedProfiles: StoredUserDataProfile[]): void { throw new Error('not implemented'); }\n\n\tprotected getStoredProfileAssociations(): StoredProfileAssociations { return {}; }\n\tprotected saveStoredProfileAssociations(storedProfileAssociations: StoredProfileAssociations): void { throw new Error('not implemented'); }\n\tprotected getDefaultProfileExtensionsLocation(): URI | undefined { return undefined; }\n}\n\nexport class InMemoryUserDataProfilesService extends UserDataProfilesService {\n\tprivate storedProfiles: StoredUserDataProfile[] = [];\n\tprotected override getStoredProfiles(): StoredUserDataProfile[] { return this.storedProfiles; }\n\tprotected override saveStoredProfiles(storedProfiles: StoredUserDataProfile[]): void { this.storedProfiles = storedProfiles; }\n\n\tprivate storedProfileAssociations: StoredProfileAssociations = {};\n\tprotected override getStoredProfileAssociations(): StoredProfileAssociations { return this.storedProfileAssociations; }\n\tprotected override saveStoredProfileAssociations(storedProfileAssociations: StoredProfileAssociations): void { this.storedProfileAssociations = storedProfileAssociations; }\n}\n"]}