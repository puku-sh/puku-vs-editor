{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/terminal/node/childProcessMonitor.ts","vs/platform/terminal/node/childProcessMonitor.ts"],"names":[],"mappings":"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","file":"childProcessMonitor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { parse } from '../../../base/common/path.js';\nimport { debounce, throttle } from '../../../base/common/decorators.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ProcessItem } from '../../../base/common/processes.js';\nimport { listProcesses } from '../../../base/node/ps.js';\nimport { ILogService } from '../../log/common/log.js';\n\nconst enum Constants {\n\t/**\n\t * The amount of time to throttle checks when the process receives output.\n\t */\n\tInactiveThrottleDuration = 5000,\n\t/**\n\t * The amount of time to debounce check when the process receives input.\n\t */\n\tActiveDebounceDuration = 1000,\n}\n\nexport const ignoreProcessNames: string[] = [];\n\n/**\n * Monitors a process for child processes, checking at differing times depending on input and output\n * calls into the monitor.\n */\nexport class ChildProcessMonitor extends Disposable {\n\tprivate _hasChildProcesses: boolean = false;\n\tprivate set hasChildProcesses(value: boolean) {\n\t\tif (this._hasChildProcesses !== value) {\n\t\t\tthis._hasChildProcesses = value;\n\t\t\tthis._logService.debug('ChildProcessMonitor: Has child processes changed', value);\n\t\t\tthis._onDidChangeHasChildProcesses.fire(value);\n\t\t}\n\t}\n\t/**\n\t * Whether the process has child processes.\n\t */\n\tget hasChildProcesses(): boolean { return this._hasChildProcesses; }\n\n\tprivate readonly _onDidChangeHasChildProcesses = this._register(new Emitter<boolean>());\n\t/**\n\t * An event that fires when whether the process has child processes changes.\n\t */\n\treadonly onDidChangeHasChildProcesses = this._onDidChangeHasChildProcesses.event;\n\n\tconstructor(\n\t\tprivate readonly _pid: number,\n\t\t@ILogService private readonly _logService: ILogService\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * Input was triggered on the process.\n\t */\n\thandleInput() {\n\t\tthis._refreshActive();\n\t}\n\n\t/**\n\t * Output was triggered on the process.\n\t */\n\thandleOutput() {\n\t\tthis._refreshInactive();\n\t}\n\n\t@debounce(Constants.ActiveDebounceDuration)\n\tprivate async _refreshActive(): Promise<void> {\n\t\tif (this._store.isDisposed) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst processItem = await listProcesses(this._pid);\n\t\t\tthis.hasChildProcesses = this._processContainsChildren(processItem);\n\t\t} catch (e) {\n\t\t\tthis._logService.debug('ChildProcessMonitor: Fetching process tree failed', e);\n\t\t}\n\t}\n\n\t@throttle(Constants.InactiveThrottleDuration)\n\tprivate _refreshInactive(): void {\n\t\tthis._refreshActive();\n\t}\n\n\tprivate _processContainsChildren(processItem: ProcessItem): boolean {\n\t\t// No child processes\n\t\tif (!processItem.children) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// A single child process, handle special cases\n\t\tif (processItem.children.length === 1) {\n\t\t\tconst item = processItem.children[0];\n\t\t\tlet cmd: string;\n\t\t\tif (item.cmd.startsWith(`\"`)) {\n\t\t\t\tcmd = item.cmd.substring(1, item.cmd.indexOf(`\"`, 1));\n\t\t\t} else {\n\t\t\t\tconst spaceIndex = item.cmd.indexOf(` `);\n\t\t\t\tif (spaceIndex === -1) {\n\t\t\t\t\tcmd = item.cmd;\n\t\t\t\t} else {\n\t\t\t\t\tcmd = item.cmd.substring(0, spaceIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ignoreProcessNames.indexOf(parse(cmd).name) === -1;\n\t\t}\n\n\t\t// Fallback, count child processes\n\t\treturn processItem.children.length > 0;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { parse } from '../../../base/common/path.js';\nimport { debounce, throttle } from '../../../base/common/decorators.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { ProcessItem } from '../../../base/common/processes.js';\nimport { listProcesses } from '../../../base/node/ps.js';\nimport { ILogService } from '../../log/common/log.js';\n\nconst enum Constants {\n\t/**\n\t * The amount of time to throttle checks when the process receives output.\n\t */\n\tInactiveThrottleDuration = 5000,\n\t/**\n\t * The amount of time to debounce check when the process receives input.\n\t */\n\tActiveDebounceDuration = 1000,\n}\n\nexport const ignoreProcessNames: string[] = [];\n\n/**\n * Monitors a process for child processes, checking at differing times depending on input and output\n * calls into the monitor.\n */\nexport class ChildProcessMonitor extends Disposable {\n\tprivate _hasChildProcesses: boolean = false;\n\tprivate set hasChildProcesses(value: boolean) {\n\t\tif (this._hasChildProcesses !== value) {\n\t\t\tthis._hasChildProcesses = value;\n\t\t\tthis._logService.debug('ChildProcessMonitor: Has child processes changed', value);\n\t\t\tthis._onDidChangeHasChildProcesses.fire(value);\n\t\t}\n\t}\n\t/**\n\t * Whether the process has child processes.\n\t */\n\tget hasChildProcesses(): boolean { return this._hasChildProcesses; }\n\n\tprivate readonly _onDidChangeHasChildProcesses = this._register(new Emitter<boolean>());\n\t/**\n\t * An event that fires when whether the process has child processes changes.\n\t */\n\treadonly onDidChangeHasChildProcesses = this._onDidChangeHasChildProcesses.event;\n\n\tconstructor(\n\t\tprivate readonly _pid: number,\n\t\t@ILogService private readonly _logService: ILogService\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * Input was triggered on the process.\n\t */\n\thandleInput() {\n\t\tthis._refreshActive();\n\t}\n\n\t/**\n\t * Output was triggered on the process.\n\t */\n\thandleOutput() {\n\t\tthis._refreshInactive();\n\t}\n\n\t@debounce(Constants.ActiveDebounceDuration)\n\tprivate async _refreshActive(): Promise<void> {\n\t\tif (this._store.isDisposed) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst processItem = await listProcesses(this._pid);\n\t\t\tthis.hasChildProcesses = this._processContainsChildren(processItem);\n\t\t} catch (e) {\n\t\t\tthis._logService.debug('ChildProcessMonitor: Fetching process tree failed', e);\n\t\t}\n\t}\n\n\t@throttle(Constants.InactiveThrottleDuration)\n\tprivate _refreshInactive(): void {\n\t\tthis._refreshActive();\n\t}\n\n\tprivate _processContainsChildren(processItem: ProcessItem): boolean {\n\t\t// No child processes\n\t\tif (!processItem.children) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// A single child process, handle special cases\n\t\tif (processItem.children.length === 1) {\n\t\t\tconst item = processItem.children[0];\n\t\t\tlet cmd: string;\n\t\t\tif (item.cmd.startsWith(`\"`)) {\n\t\t\t\tcmd = item.cmd.substring(1, item.cmd.indexOf(`\"`, 1));\n\t\t\t} else {\n\t\t\t\tconst spaceIndex = item.cmd.indexOf(` `);\n\t\t\t\tif (spaceIndex === -1) {\n\t\t\t\t\tcmd = item.cmd;\n\t\t\t\t} else {\n\t\t\t\t\tcmd = item.cmd.substring(0, spaceIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ignoreProcessNames.indexOf(parse(cmd).name) === -1;\n\t\t}\n\n\t\t// Fallback, count child processes\n\t\treturn processItem.children.length > 0;\n\t}\n}\n"]}