{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/terminal/node/terminalContrib/autoReplies/terminalAutoResponder.ts","vs/platform/terminal/node/terminalContrib/autoReplies/terminalAutoResponder.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,OAAO,EAAE,MAAM,qCAAqC,CAAC;AAC9D,OAAO,EAAE,UAAU,EAAE,MAAM,yCAAyC,CAAC;AACrE,OAAO,EAAE,QAAQ,EAAE,MAAM,qCAAqC,CAAC;AAC/D,OAAO,EAAE,SAAS,EAAE,MAAM,wCAAwC,CAAC;AAInE;;;;GAIG;AACH,MAAM,OAAO,qBAAsB,SAAQ,UAAU;IAUpD,YACC,IAA2B,EAC3B,SAAiB,EACjB,QAAgB,EAChB,UAAuB;QAEvB,KAAK,EAAE,CAAC;QAfD,aAAQ,GAAG,CAAC,CAAC;QACb,YAAO,GAAG,KAAK,CAAC;QAExB;;;WAGG;QACK,eAAU,GAAG,KAAK,CAAC;QAU1B,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;YACrC,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;gBACrC,OAAO;YACR,CAAC;YACD,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBACtC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;oBAC1C,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACjB,CAAC;qBAAM,CAAC;oBACP,IAAI,CAAC,MAAM,EAAE,CAAC;gBACf,CAAC;gBACD,uBAAuB;gBACvB,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,CAAC,MAAM,EAAE,CAAC;oBACxC,UAAU,CAAC,KAAK,CAAC,sBAAsB,SAAS,iBAAiB,QAAQ,GAAG,CAAC,CAAC;oBAC9E,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;oBACrB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,CAAC;oBAClD,IAAI,CAAC,MAAM,EAAE,CAAC;gBACf,CAAC;YACF,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,MAAM;QACb,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;IACnB,CAAC;IAED;;;OAGG;IACH,YAAY;QACX,IAAI,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACrB,CAAC;IACF,CAAC;IAED,WAAW;QACV,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IACtB,CAAC;CACD","file":"terminalAutoResponder.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { timeout } from '../../../../../base/common/async.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { isString } from '../../../../../base/common/types.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { ILogService } from '../../../../log/common/log.js';\nimport { ITerminalChildProcess } from '../../../common/terminal.js';\n\n/**\n * Tracks a terminal process's data stream and responds immediately when a matching string is\n * received. This is done in a low overhead way and is ideally run on the same process as the\n * where the process is handled to minimize latency.\n */\nexport class TerminalAutoResponder extends Disposable {\n\tprivate _pointer = 0;\n\tprivate _paused = false;\n\n\t/**\n\t * Each reply is throttled by a second to avoid resource starvation and responding to screen\n\t * reprints on Winodws.\n\t */\n\tprivate _throttled = false;\n\n\tconstructor(\n\t\tproc: ITerminalChildProcess,\n\t\tmatchWord: string,\n\t\tresponse: string,\n\t\tlogService: ILogService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(proc.onProcessData(e => {\n\t\t\tif (this._paused || this._throttled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst data = isString(e) ? e : e.data;\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tif (data[i] === matchWord[this._pointer]) {\n\t\t\t\t\tthis._pointer++;\n\t\t\t\t} else {\n\t\t\t\t\tthis._reset();\n\t\t\t\t}\n\t\t\t\t// Auto reply and reset\n\t\t\t\tif (this._pointer === matchWord.length) {\n\t\t\t\t\tlogService.debug(`Auto reply match: \"${matchWord}\", response: \"${response}\"`);\n\t\t\t\t\tproc.input(response);\n\t\t\t\t\tthis._throttled = true;\n\t\t\t\t\ttimeout(1000).then(() => this._throttled = false);\n\t\t\t\t\tthis._reset();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _reset() {\n\t\tthis._pointer = 0;\n\t}\n\n\t/**\n\t * No auto response will happen after a resize on Windows in case the resize is a result of\n\t * reprinting the screen.\n\t */\n\thandleResize() {\n\t\tif (isWindows) {\n\t\t\tthis._paused = true;\n\t\t}\n\t}\n\n\thandleInput() {\n\t\tthis._paused = false;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { timeout } from '../../../../../base/common/async.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { isString } from '../../../../../base/common/types.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { ILogService } from '../../../../log/common/log.js';\nimport { ITerminalChildProcess } from '../../../common/terminal.js';\n\n/**\n * Tracks a terminal process's data stream and responds immediately when a matching string is\n * received. This is done in a low overhead way and is ideally run on the same process as the\n * where the process is handled to minimize latency.\n */\nexport class TerminalAutoResponder extends Disposable {\n\tprivate _pointer = 0;\n\tprivate _paused = false;\n\n\t/**\n\t * Each reply is throttled by a second to avoid resource starvation and responding to screen\n\t * reprints on Winodws.\n\t */\n\tprivate _throttled = false;\n\n\tconstructor(\n\t\tproc: ITerminalChildProcess,\n\t\tmatchWord: string,\n\t\tresponse: string,\n\t\tlogService: ILogService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(proc.onProcessData(e => {\n\t\t\tif (this._paused || this._throttled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst data = isString(e) ? e : e.data;\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tif (data[i] === matchWord[this._pointer]) {\n\t\t\t\t\tthis._pointer++;\n\t\t\t\t} else {\n\t\t\t\t\tthis._reset();\n\t\t\t\t}\n\t\t\t\t// Auto reply and reset\n\t\t\t\tif (this._pointer === matchWord.length) {\n\t\t\t\t\tlogService.debug(`Auto reply match: \"${matchWord}\", response: \"${response}\"`);\n\t\t\t\t\tproc.input(response);\n\t\t\t\t\tthis._throttled = true;\n\t\t\t\t\ttimeout(1000).then(() => this._throttled = false);\n\t\t\t\t\tthis._reset();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _reset() {\n\t\tthis._pointer = 0;\n\t}\n\n\t/**\n\t * No auto response will happen after a resize on Windows in case the resize is a result of\n\t * reprinting the screen.\n\t */\n\thandleResize() {\n\t\tif (isWindows) {\n\t\t\tthis._paused = true;\n\t\t}\n\t}\n\n\thandleInput() {\n\t\tthis._paused = false;\n\t}\n}\n"]}