{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/platform/environment/node/stdin.ts","vs/platform/environment/node/stdin.ts"],"names":[],"mappings":"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","file":"stdin.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\nimport { tmpdir } from 'os';\nimport { Queue } from '../../../base/common/async.js';\nimport { randomPath } from '../../../base/common/extpath.js';\nimport { resolveTerminalEncoding } from '../../../base/node/terminalEncoding.js';\n\nexport function hasStdinWithoutTty() {\n\ttry {\n\t\treturn !process.stdin.isTTY; // Via https://twitter.com/MylesBorins/status/782009479382626304\n\t} catch {\n\t\t// Windows workaround for https://github.com/nodejs/node/issues/11656\n\t}\n\treturn false;\n}\n\nexport function stdinDataListener(durationinMs: number): Promise<boolean> {\n\treturn new Promise(resolve => {\n\t\tconst dataListener = () => resolve(true);\n\n\t\t// wait for 1s maximum...\n\t\tsetTimeout(() => {\n\t\t\tprocess.stdin.removeListener('data', dataListener);\n\n\t\t\tresolve(false);\n\t\t}, durationinMs);\n\n\t\t// ...but finish early if we detect data\n\t\tprocess.stdin.once('data', dataListener);\n\t});\n}\n\nexport function getStdinFilePath(): string {\n\treturn randomPath(tmpdir(), 'code-stdin', 3);\n}\n\nasync function createStdInFile(targetPath: string) {\n\tawait fs.promises.appendFile(targetPath, '');\n\tawait fs.promises.chmod(targetPath, 0o600); // Ensure the file is only read/writable by the user: https://github.com/microsoft/vscode-remote-release/issues/9048\n}\n\nexport async function readFromStdin(targetPath: string, verbose: boolean, onEnd?: Function): Promise<void> {\n\n\tlet [encoding, iconv] = await Promise.all([\n\t\tresolveTerminalEncoding(verbose),\t\t// respect terminal encoding when piping into file\n\t\timport('@vscode/iconv-lite-umd'),\t\t// lazy load encoding module for usage\n\t\tcreateStdInFile(targetPath) \t\t\t// make sure file exists right away (https://github.com/microsoft/vscode/issues/155341)\n\t]);\n\n\tif (!iconv.default.encodingExists(encoding)) {\n\t\tconsole.log(`Unsupported terminal encoding: ${encoding}, falling back to UTF-8.`);\n\t\tencoding = 'utf8';\n\t}\n\n\t// Use a `Queue` to be able to use `appendFile`\n\t// which helps file watchers to be aware of the\n\t// changes because each append closes the underlying\n\t// file descriptor.\n\t// (https://github.com/microsoft/vscode/issues/148952)\n\n\tconst appendFileQueue = new Queue();\n\n\tconst decoder = iconv.default.getDecoder(encoding);\n\n\tprocess.stdin.on('data', chunk => {\n\t\tconst chunkStr = decoder.write(chunk);\n\t\tappendFileQueue.queue(() => fs.promises.appendFile(targetPath, chunkStr));\n\t});\n\n\tprocess.stdin.on('end', () => {\n\t\tconst end = decoder.end();\n\n\t\tappendFileQueue.queue(async () => {\n\t\t\ttry {\n\t\t\t\tif (typeof end === 'string') {\n\t\t\t\t\tawait fs.promises.appendFile(targetPath, end);\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tonEnd?.();\n\t\t\t}\n\t\t});\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as fs from 'fs';\nimport { tmpdir } from 'os';\nimport { Queue } from '../../../base/common/async.js';\nimport { randomPath } from '../../../base/common/extpath.js';\nimport { resolveTerminalEncoding } from '../../../base/node/terminalEncoding.js';\n\nexport function hasStdinWithoutTty() {\n\ttry {\n\t\treturn !process.stdin.isTTY; // Via https://twitter.com/MylesBorins/status/782009479382626304\n\t} catch {\n\t\t// Windows workaround for https://github.com/nodejs/node/issues/11656\n\t}\n\treturn false;\n}\n\nexport function stdinDataListener(durationinMs: number): Promise<boolean> {\n\treturn new Promise(resolve => {\n\t\tconst dataListener = () => resolve(true);\n\n\t\t// wait for 1s maximum...\n\t\tsetTimeout(() => {\n\t\t\tprocess.stdin.removeListener('data', dataListener);\n\n\t\t\tresolve(false);\n\t\t}, durationinMs);\n\n\t\t// ...but finish early if we detect data\n\t\tprocess.stdin.once('data', dataListener);\n\t});\n}\n\nexport function getStdinFilePath(): string {\n\treturn randomPath(tmpdir(), 'code-stdin', 3);\n}\n\nasync function createStdInFile(targetPath: string) {\n\tawait fs.promises.appendFile(targetPath, '');\n\tawait fs.promises.chmod(targetPath, 0o600); // Ensure the file is only read/writable by the user: https://github.com/microsoft/vscode-remote-release/issues/9048\n}\n\nexport async function readFromStdin(targetPath: string, verbose: boolean, onEnd?: Function): Promise<void> {\n\n\tlet [encoding, iconv] = await Promise.all([\n\t\tresolveTerminalEncoding(verbose),\t\t// respect terminal encoding when piping into file\n\t\timport('@vscode/iconv-lite-umd'),\t\t// lazy load encoding module for usage\n\t\tcreateStdInFile(targetPath) \t\t\t// make sure file exists right away (https://github.com/microsoft/vscode/issues/155341)\n\t]);\n\n\tif (!iconv.default.encodingExists(encoding)) {\n\t\tconsole.log(`Unsupported terminal encoding: ${encoding}, falling back to UTF-8.`);\n\t\tencoding = 'utf8';\n\t}\n\n\t// Use a `Queue` to be able to use `appendFile`\n\t// which helps file watchers to be aware of the\n\t// changes because each append closes the underlying\n\t// file descriptor.\n\t// (https://github.com/microsoft/vscode/issues/148952)\n\n\tconst appendFileQueue = new Queue();\n\n\tconst decoder = iconv.default.getDecoder(encoding);\n\n\tprocess.stdin.on('data', chunk => {\n\t\tconst chunkStr = decoder.write(chunk);\n\t\tappendFileQueue.queue(() => fs.promises.appendFile(targetPath, chunkStr));\n\t});\n\n\tprocess.stdin.on('end', () => {\n\t\tconst end = decoder.end();\n\n\t\tappendFileQueue.queue(async () => {\n\t\t\ttry {\n\t\t\t\tif (typeof end === 'string') {\n\t\t\t\t\tawait fs.promises.appendFile(targetPath, end);\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tonEnd?.();\n\t\t\t}\n\t\t});\n\t});\n}\n"]}