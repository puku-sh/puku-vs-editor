{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/code/node/cli.ts","vs/code/node/cli.ts"],"names":[],"mappings":"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","file":"cli.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ChildProcess, spawn, SpawnOptions, StdioOptions } from 'child_process';\nimport { chmodSync, existsSync, readFileSync, statSync, truncateSync, unlinkSync } from 'fs';\nimport { homedir, release, tmpdir } from 'os';\nimport type { ProfilingSession, Target } from 'v8-inspect-profiler';\nimport { Event } from '../../base/common/event.js';\nimport { isAbsolute, resolve, join, dirname } from '../../base/common/path.js';\nimport { IProcessEnvironment, isMacintosh, isWindows } from '../../base/common/platform.js';\nimport { randomPort } from '../../base/common/ports.js';\nimport { whenDeleted, writeFileSync } from '../../base/node/pfs.js';\nimport { findFreePort } from '../../base/node/ports.js';\nimport { watchFileContents } from '../../platform/files/node/watcher/nodejs/nodejsWatcherLib.js';\nimport { NativeParsedArgs } from '../../platform/environment/common/argv.js';\nimport { buildHelpMessage, buildStdinMessage, buildVersionMessage, NATIVE_CLI_COMMANDS, OPTIONS } from '../../platform/environment/node/argv.js';\nimport { addArg, parseCLIProcessArgv } from '../../platform/environment/node/argvHelper.js';\nimport { getStdinFilePath, hasStdinWithoutTty, readFromStdin, stdinDataListener } from '../../platform/environment/node/stdin.js';\nimport { createWaitMarkerFileSync } from '../../platform/environment/node/wait.js';\nimport product from '../../platform/product/common/product.js';\nimport { CancellationTokenSource } from '../../base/common/cancellation.js';\nimport { isUNC, randomPath } from '../../base/common/extpath.js';\nimport { Utils } from '../../platform/profiling/common/profiling.js';\nimport { FileAccess } from '../../base/common/network.js';\nimport { cwd } from '../../base/common/process.js';\nimport { addUNCHostToAllowlist } from '../../base/node/unc.js';\nimport { URI } from '../../base/common/uri.js';\nimport { DeferredPromise } from '../../base/common/async.js';\n\nfunction shouldSpawnCliProcess(argv: NativeParsedArgs): boolean {\n\treturn !!argv['install-source']\n\t\t|| !!argv['list-extensions']\n\t\t|| !!argv['install-extension']\n\t\t|| !!argv['uninstall-extension']\n\t\t|| !!argv['update-extensions']\n\t\t|| !!argv['locate-extension']\n\t\t|| !!argv['add-mcp']\n\t\t|| !!argv['telemetry'];\n}\n\nexport async function main(argv: string[]): Promise<void> {\n\tlet args: NativeParsedArgs;\n\n\ttry {\n\t\targs = parseCLIProcessArgv(argv);\n\t} catch (err) {\n\t\tconsole.error(err.message);\n\t\treturn;\n\t}\n\n\tfor (const subcommand of NATIVE_CLI_COMMANDS) {\n\t\tif (args[subcommand]) {\n\t\t\tif (!product.tunnelApplicationName) {\n\t\t\t\tconsole.error(`'${subcommand}' command not supported in ${product.applicationName}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst env: IProcessEnvironment = {\n\t\t\t\t...process.env\n\t\t\t};\n\t\t\t// bootstrap-esm.js determines the electron environment based\n\t\t\t// on the following variable. For the server we need to unset\n\t\t\t// it to prevent importing any electron specific modules.\n\t\t\t// Refs https://github.com/microsoft/vscode/issues/221883\n\t\t\tdelete env['ELECTRON_RUN_AS_NODE'];\n\n\t\t\tconst tunnelArgs = argv.slice(argv.indexOf(subcommand) + 1); // all arguments behind `tunnel`\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tlet tunnelProcess: ChildProcess;\n\t\t\t\tconst stdio: StdioOptions = ['ignore', 'pipe', 'pipe'];\n\t\t\t\tif (process.env['VSCODE_DEV']) {\n\t\t\t\t\ttunnelProcess = spawn('cargo', ['run', '--', subcommand, ...tunnelArgs], { cwd: join(getAppRoot(), 'cli'), stdio, env });\n\t\t\t\t} else {\n\t\t\t\t\tconst appPath = process.platform === 'darwin'\n\t\t\t\t\t\t// ./Contents/MacOS/Electron => ./Contents/Resources/app/bin/code-tunnel-insiders\n\t\t\t\t\t\t? join(dirname(dirname(process.execPath)), 'Resources', 'app')\n\t\t\t\t\t\t: dirname(process.execPath);\n\t\t\t\t\tconst tunnelCommand = join(appPath, 'bin', `${product.tunnelApplicationName}${isWindows ? '.exe' : ''}`);\n\t\t\t\t\ttunnelProcess = spawn(tunnelCommand, [subcommand, ...tunnelArgs], { cwd: cwd(), stdio, env });\n\t\t\t\t}\n\n\t\t\t\ttunnelProcess.stdout!.pipe(process.stdout);\n\t\t\t\ttunnelProcess.stderr!.pipe(process.stderr);\n\t\t\t\ttunnelProcess.on('exit', resolve);\n\t\t\t\ttunnelProcess.on('error', reject);\n\t\t\t});\n\t\t}\n\t}\n\n\t// Help (general)\n\tif (args.help) {\n\t\tconst executable = `${product.applicationName}${isWindows ? '.exe' : ''}`;\n\t\tconsole.log(buildHelpMessage(product.nameLong, executable, product.version, OPTIONS));\n\t}\n\n\t// Help (chat)\n\telse if (args.chat?.help) {\n\t\tconst executable = `${product.applicationName}${isWindows ? '.exe' : ''}`;\n\t\tconsole.log(buildHelpMessage(product.nameLong, executable, product.version, OPTIONS.chat.options, { isChat: true }));\n\t}\n\n\t// Version Info\n\telse if (args.version) {\n\t\tconsole.log(buildVersionMessage(product.version, product.commit));\n\t}\n\n\t// Shell integration\n\telse if (args['locate-shell-integration-path']) {\n\t\tlet file: string;\n\t\tswitch (args['locate-shell-integration-path']) {\n\t\t\t// Usage: `[[ \"$TERM_PROGRAM\" == \"vscode\" ]] && . \"$(code --locate-shell-integration-path bash)\"`\n\t\t\tcase 'bash': file = 'shellIntegration-bash.sh'; break;\n\t\t\t// Usage: `if ($env:TERM_PROGRAM -eq \"vscode\") { . \"$(code --locate-shell-integration-path pwsh)\" }`\n\t\t\tcase 'pwsh': file = 'shellIntegration.ps1'; break;\n\t\t\t// Usage: `[[ \"$TERM_PROGRAM\" == \"vscode\" ]] && . \"$(code --locate-shell-integration-path zsh)\"`\n\t\t\tcase 'zsh': file = 'shellIntegration-rc.zsh'; break;\n\t\t\t// Usage: `string match -q \"$TERM_PROGRAM\" \"vscode\"; and . (code --locate-shell-integration-path fish)`\n\t\t\tcase 'fish': file = 'shellIntegration.fish'; break;\n\t\t\tdefault: throw new Error('Error using --locate-shell-integration-path: Invalid shell type');\n\t\t}\n\t\tconsole.log(join(getAppRoot(), 'out', 'vs', 'workbench', 'contrib', 'terminal', 'common', 'scripts', file));\n\t}\n\n\t// Extensions Management\n\telse if (shouldSpawnCliProcess(args)) {\n\n\t\t// We do not bundle `cliProcessMain.js` into this file because\n\t\t// it is rather large and only needed for very few CLI operations.\n\t\t// This has the downside that we need to know if we run OSS or\n\t\t// built, because our location on disk is different if built.\n\n\t\tlet cliProcessMain: string;\n\t\tif (process.env['VSCODE_DEV']) {\n\t\t\tcliProcessMain = './cliProcessMain.js';\n\t\t} else {\n\t\t\tcliProcessMain = './vs/code/node/cliProcessMain.js';\n\t\t}\n\n\t\tconst cli = await import(cliProcessMain);\n\t\tawait cli.main(args);\n\n\t\treturn;\n\t}\n\n\t// Write File\n\telse if (args['file-write']) {\n\t\tconst argsFile = args._[0];\n\t\tif (!argsFile || !isAbsolute(argsFile) || !existsSync(argsFile) || !statSync(argsFile).isFile()) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\tlet source: string | undefined;\n\t\tlet target: string | undefined;\n\t\ttry {\n\t\t\tconst argsContents: { source: string; target: string } = JSON.parse(readFileSync(argsFile, 'utf8'));\n\t\t\tsource = argsContents.source;\n\t\t\ttarget = argsContents.target;\n\t\t} catch (error) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\t// Windows: set the paths as allowed UNC paths given\n\t\t// they are explicitly provided by the user as arguments\n\t\tif (isWindows) {\n\t\t\tfor (const path of [source, target]) {\n\t\t\t\tif (typeof path === 'string' && isUNC(path)) {\n\t\t\t\t\taddUNCHostToAllowlist(URI.file(path).authority);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Validate\n\t\tif (\n\t\t\t!source || !target || source === target ||\t\t\t\t// make sure source and target are provided and are not the same\n\t\t\t!isAbsolute(source) || !isAbsolute(target) ||\t\t\t// make sure both source and target are absolute paths\n\t\t\t!existsSync(source) || !statSync(source).isFile() ||\t// make sure source exists as file\n\t\t\t!existsSync(target) || !statSync(target).isFile()\t\t// make sure target exists as file\n\t\t) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\ttry {\n\n\t\t\t// Check for readonly status and chmod if so if we are told so\n\t\t\tlet targetMode = 0;\n\t\t\tlet restoreMode = false;\n\t\t\tif (args['file-chmod']) {\n\t\t\t\ttargetMode = statSync(target).mode;\n\t\t\t\tif (!(targetMode & 0o200 /* File mode indicating writable by owner */)) {\n\t\t\t\t\tchmodSync(target, targetMode | 0o200);\n\t\t\t\t\trestoreMode = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Write source to target\n\t\t\tconst data = readFileSync(source);\n\t\t\tif (isWindows) {\n\t\t\t\t// On Windows we use a different strategy of saving the file\n\t\t\t\t// by first truncating the file and then writing with r+ mode.\n\t\t\t\t// This helps to save hidden files on Windows\n\t\t\t\t// (see https://github.com/microsoft/vscode/issues/931) and\n\t\t\t\t// prevent removing alternate data streams\n\t\t\t\t// (see https://github.com/microsoft/vscode/issues/6363)\n\t\t\t\ttruncateSync(target, 0);\n\t\t\t\twriteFileSync(target, data, { flag: 'r+' });\n\t\t\t} else {\n\t\t\t\twriteFileSync(target, data);\n\t\t\t}\n\n\t\t\t// Restore previous mode as needed\n\t\t\tif (restoreMode) {\n\t\t\t\tchmodSync(target, targetMode);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\terror.message = `Error using --file-write: ${error.message}`;\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t// Just Code\n\telse {\n\t\tconst env: IProcessEnvironment = {\n\t\t\t...process.env,\n\t\t\t'ELECTRON_NO_ATTACH_CONSOLE': '1'\n\t\t};\n\n\t\tdelete env['ELECTRON_RUN_AS_NODE'];\n\n\t\tconst processCallbacks: ((child: ChildProcess) => Promise<void>)[] = [];\n\n\t\tif (args.verbose) {\n\t\t\tenv['ELECTRON_ENABLE_LOGGING'] = '1';\n\t\t}\n\n\t\tif (args.verbose || args.status) {\n\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\tchild.stdout?.on('data', (data: Buffer) => console.log(data.toString('utf8').trim()));\n\t\t\t\tchild.stderr?.on('data', (data: Buffer) => console.log(data.toString('utf8').trim()));\n\n\t\t\t\tawait Event.toPromise(Event.fromNodeEventEmitter(child, 'exit'));\n\t\t\t});\n\t\t}\n\n\t\t// Handle --transient option\n\t\tif (args['transient']) {\n\t\t\tconst tempParentDir = randomPath(tmpdir(), 'vscode');\n\t\t\tconst tempUserDataDir = join(tempParentDir, 'data');\n\t\t\tconst tempExtensionsDir = join(tempParentDir, 'extensions');\n\n\t\t\taddArg(argv, '--user-data-dir', tempUserDataDir);\n\t\t\taddArg(argv, '--extensions-dir', tempExtensionsDir);\n\n\t\t\tconsole.log(`State is temporarily stored. Relaunch this state with: ${product.applicationName} --user-data-dir \"${tempUserDataDir}\" --extensions-dir \"${tempExtensionsDir}\"`);\n\t\t}\n\n\t\tconst hasReadStdinArg = args._.some(arg => arg === '-') || args.chat?._.some(arg => arg === '-');\n\t\tif (hasReadStdinArg) {\n\t\t\t// remove the \"-\" argument when we read from stdin\n\t\t\targs._ = args._.filter(a => a !== '-');\n\t\t\targv = argv.filter(a => a !== '-');\n\t\t}\n\n\t\tlet stdinFilePath: string | undefined;\n\t\tif (hasStdinWithoutTty()) {\n\n\t\t\t// Read from stdin: we require a single \"-\" argument to be passed in order to start reading from\n\t\t\t// stdin. We do this because there is no reliable way to find out if data is piped to stdin. Just\n\t\t\t// checking for stdin being connected to a TTY is not enough (https://github.com/microsoft/vscode/issues/40351)\n\n\t\t\tif (hasReadStdinArg) {\n\t\t\t\tstdinFilePath = getStdinFilePath();\n\n\t\t\t\ttry {\n\t\t\t\t\tconst readFromStdinDone = new DeferredPromise<void>();\n\t\t\t\t\tawait readFromStdin(stdinFilePath, !!args.verbose, () => readFromStdinDone.complete());\n\t\t\t\t\tif (!args.wait) {\n\n\t\t\t\t\t\t// if `--wait` is not provided, we keep this process alive\n\t\t\t\t\t\t// for at least as long as the stdin stream is open to\n\t\t\t\t\t\t// ensure that we read all the data.\n\t\t\t\t\t\t// the downside is that the Code CLI process will then not\n\t\t\t\t\t\t// terminate until stdin is closed, but users can always\n\t\t\t\t\t\t// pass `--wait` to prevent that from happening (this is\n\t\t\t\t\t\t// actually what we enforced until v1.85.x but then was\n\t\t\t\t\t\t// changed to not enforce it anymore).\n\t\t\t\t\t\t// a solution in the future would possibly be to exit, when\n\t\t\t\t\t\t// the Code process exits. this would require some careful\n\t\t\t\t\t\t// solution though in case Code is already running and this\n\t\t\t\t\t\t// is a second instance telling the first instance what to\n\t\t\t\t\t\t// open.\n\n\t\t\t\t\t\tprocessCallbacks.push(() => readFromStdinDone.p);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.chat) {\n\t\t\t\t\t\t// Make sure to add tmp file as context to chat\n\t\t\t\t\t\taddArg(argv, '--add-file', stdinFilePath);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Make sure to open tmp file as editor but ignore\n\t\t\t\t\t\t// it in the \"recently open\" list\n\t\t\t\t\t\taddArg(argv, stdinFilePath);\n\t\t\t\t\t\taddArg(argv, '--skip-add-to-recently-opened');\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.log(`Reading from stdin via: ${stdinFilePath}`);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(`Failed to create file to read via stdin: ${e.toString()}`);\n\t\t\t\t\tstdinFilePath = undefined;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\t// If the user pipes data via stdin but forgot to add the \"-\" argument, help by printing a message\n\t\t\t\t// if we detect that data flows into via stdin after a certain timeout.\n\t\t\t\tprocessCallbacks.push(_ => stdinDataListener(1000).then(dataReceived => {\n\t\t\t\t\tif (dataReceived) {\n\t\t\t\t\t\tconsole.log(buildStdinMessage(product.applicationName, !!args.chat));\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tconst isMacOSBigSurOrNewer = isMacintosh && release() > '20.0.0';\n\n\t\t// If we are started with --wait create a random temporary file\n\t\t// and pass it over to the starting instance. We can use this file\n\t\t// to wait for it to be deleted to monitor that the edited file\n\t\t// is closed and then exit the waiting process.\n\t\tlet waitMarkerFilePath: string | undefined;\n\t\tif (args.wait) {\n\t\t\twaitMarkerFilePath = createWaitMarkerFileSync(args.verbose);\n\t\t\tif (waitMarkerFilePath) {\n\t\t\t\taddArg(argv, '--waitMarkerFilePath', waitMarkerFilePath);\n\t\t\t}\n\n\t\t\t// When running with --wait, we want to continue running CLI process\n\t\t\t// until either:\n\t\t\t// - the wait marker file has been deleted (e.g. when closing the editor)\n\t\t\t// - the launched process terminates (e.g. due to a crash)\n\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\tlet childExitPromise;\n\t\t\t\tif (isMacOSBigSurOrNewer) {\n\t\t\t\t\t// On Big Sur, we resolve the following promise only when the child,\n\t\t\t\t\t// i.e. the open command, exited with a signal or error. Otherwise, we\n\t\t\t\t\t// wait for the marker file to be deleted or for the child to error.\n\t\t\t\t\tchildExitPromise = new Promise<void>(resolve => {\n\t\t\t\t\t\t// Only resolve this promise if the child (i.e. open) exited with an error\n\t\t\t\t\t\tchild.on('exit', (code, signal) => {\n\t\t\t\t\t\t\tif (code !== 0 || signal) {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// On other platforms, we listen for exit in case the child exits before the\n\t\t\t\t\t// marker file is deleted.\n\t\t\t\t\tchildExitPromise = Event.toPromise(Event.fromNodeEventEmitter(child, 'exit'));\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tawait Promise.race([\n\t\t\t\t\t\twhenDeleted(waitMarkerFilePath!),\n\t\t\t\t\t\tEvent.toPromise(Event.fromNodeEventEmitter(child, 'error')),\n\t\t\t\t\t\tchildExitPromise\n\t\t\t\t\t]);\n\t\t\t\t} finally {\n\t\t\t\t\tif (stdinFilePath) {\n\t\t\t\t\t\tunlinkSync(stdinFilePath); // Make sure to delete the tmp stdin file if we have any\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// If we have been started with `--prof-startup` we need to find free ports to profile\n\t\t// the main process, the renderer, and the extension host. We also disable v8 cached data\n\t\t// to get better profile traces. Last, we listen on stdout for a signal that tells us to\n\t\t// stop profiling.\n\t\tif (args['prof-startup']) {\n\t\t\tconst profileHost = '127.0.0.1';\n\t\t\tconst portMain = await findFreePort(randomPort(), 10, 3000);\n\t\t\tconst portRenderer = await findFreePort(portMain + 1, 10, 3000);\n\t\t\tconst portExthost = await findFreePort(portRenderer + 1, 10, 3000);\n\n\t\t\t// fail the operation when one of the ports couldn't be acquired.\n\t\t\tif (portMain * portRenderer * portExthost === 0) {\n\t\t\t\tthrow new Error('Failed to find free ports for profiler. Make sure to shutdown all instances of the editor first.');\n\t\t\t}\n\n\t\t\tconst filenamePrefix = randomPath(homedir(), 'prof');\n\n\t\t\taddArg(argv, `--inspect-brk=${profileHost}:${portMain}`);\n\t\t\taddArg(argv, `--remote-debugging-port=${profileHost}:${portRenderer}`);\n\t\t\taddArg(argv, `--inspect-brk-extensions=${profileHost}:${portExthost}`);\n\t\t\taddArg(argv, `--prof-startup-prefix`, filenamePrefix);\n\t\t\taddArg(argv, `--no-cached-data`);\n\n\t\t\twriteFileSync(filenamePrefix, argv.slice(-6).join('|'));\n\n\t\t\tprocessCallbacks.push(async _child => {\n\n\t\t\t\tclass Profiler {\n\t\t\t\t\tstatic async start(name: string, filenamePrefix: string, opts: { port: number; tries?: number; target?: (targets: Target[]) => Target }) {\n\t\t\t\t\t\tconst profiler = await import('v8-inspect-profiler');\n\n\t\t\t\t\t\tlet session: ProfilingSession;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tsession = await profiler.startProfiling({ ...opts, host: profileHost });\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tconsole.error(`FAILED to start profiling for '${name}' on port '${opts.port}'`);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tasync stop() {\n\t\t\t\t\t\t\t\tif (!session) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet suffix = '';\n\t\t\t\t\t\t\t\tconst result = await session.stop();\n\t\t\t\t\t\t\t\tif (!process.env['VSCODE_DEV']) {\n\t\t\t\t\t\t\t\t\t// when running from a not-development-build we remove\n\t\t\t\t\t\t\t\t\t// absolute filenames because we don't want to reveal anything\n\t\t\t\t\t\t\t\t\t// about users. We also append the `.txt` suffix to make it\n\t\t\t\t\t\t\t\t\t// easier to attach these files to GH issues\n\t\t\t\t\t\t\t\t\tresult.profile = Utils.rewriteAbsolutePaths(result.profile, 'piiRemoved');\n\t\t\t\t\t\t\t\t\tsuffix = '.txt';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twriteFileSync(`${filenamePrefix}.${name}.cpuprofile${suffix}`, JSON.stringify(result.profile, undefined, 4));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// load and start profiler\n\t\t\t\t\tconst mainProfileRequest = Profiler.start('main', filenamePrefix, { port: portMain });\n\t\t\t\t\tconst extHostProfileRequest = Profiler.start('extHost', filenamePrefix, { port: portExthost, tries: 300 });\n\t\t\t\t\tconst rendererProfileRequest = Profiler.start('renderer', filenamePrefix, {\n\t\t\t\t\t\tport: portRenderer,\n\t\t\t\t\t\ttries: 200,\n\t\t\t\t\t\ttarget: function (targets) {\n\t\t\t\t\t\t\treturn targets.filter(target => {\n\t\t\t\t\t\t\t\tif (!target.webSocketDebuggerUrl) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (target.type === 'page') {\n\t\t\t\t\t\t\t\t\treturn target.url.indexOf('workbench/workbench.html') > 0 || target.url.indexOf('workbench/workbench-dev.html') > 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst main = await mainProfileRequest;\n\t\t\t\t\tconst extHost = await extHostProfileRequest;\n\t\t\t\t\tconst renderer = await rendererProfileRequest;\n\n\t\t\t\t\t// wait for the renderer to delete the marker file\n\t\t\t\t\tawait whenDeleted(filenamePrefix);\n\n\t\t\t\t\t// stop profiling\n\t\t\t\t\tawait main.stop();\n\t\t\t\t\tawait renderer.stop();\n\t\t\t\t\tawait extHost.stop();\n\n\t\t\t\t\t// re-create the marker file to signal that profiling is done\n\t\t\t\t\twriteFileSync(filenamePrefix, '');\n\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Failed to profile startup. Make sure to quit Code first.');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst options: SpawnOptions = {\n\t\t\tdetached: true,\n\t\t\tenv\n\t\t};\n\n\t\tif (!args.verbose) {\n\t\t\toptions['stdio'] = 'ignore';\n\t\t}\n\n\t\tlet child: ChildProcess;\n\t\tif (!isMacOSBigSurOrNewer) {\n\t\t\tif (!args.verbose && args.status) {\n\t\t\t\toptions['stdio'] = ['ignore', 'pipe', 'ignore']; // restore ability to see output when --status is used\n\t\t\t}\n\n\t\t\t// We spawn process.execPath directly\n\t\t\tchild = spawn(process.execPath, argv.slice(2), options);\n\t\t} else {\n\t\t\t// On Big Sur, we spawn using the open command to obtain behavior\n\t\t\t// similar to if the app was launched from the dock\n\t\t\t// https://github.com/microsoft/vscode/issues/102975\n\n\t\t\t// The following args are for the open command itself, rather than for VS Code:\n\t\t\t// -n creates a new instance.\n\t\t\t//    Without -n, the open command re-opens the existing instance as-is.\n\t\t\t// -g starts the new instance in the background.\n\t\t\t//    Later, Electron brings the instance to the foreground.\n\t\t\t//    This way, Mac does not automatically try to foreground the new instance, which causes\n\t\t\t//    focusing issues when the new instance only sends data to a previous instance and then closes.\n\t\t\tconst spawnArgs = ['-n', '-g'];\n\t\t\t// -a opens the given application.\n\t\t\tspawnArgs.push('-a', process.execPath); // -a: opens a specific application\n\n\t\t\tif (args.verbose || args.status) {\n\t\t\t\tspawnArgs.push('--wait-apps'); // `open --wait-apps`: blocks until the launched app is closed (even if they were already running)\n\n\t\t\t\t// The open command only allows for redirecting stderr and stdout to files,\n\t\t\t\t// so we make it redirect those to temp files, and then use a logger to\n\t\t\t\t// redirect the file output to the console\n\t\t\t\tfor (const outputType of args.verbose ? ['stdout', 'stderr'] : ['stdout']) {\n\n\t\t\t\t\t// Tmp file to target output to\n\t\t\t\t\tconst tmpName = randomPath(tmpdir(), `code-${outputType}`);\n\t\t\t\t\twriteFileSync(tmpName, '');\n\t\t\t\t\tspawnArgs.push(`--${outputType}`, tmpName);\n\n\t\t\t\t\t// Listener to redirect content to stdout/stderr\n\t\t\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst stream = outputType === 'stdout' ? process.stdout : process.stderr;\n\n\t\t\t\t\t\t\tconst cts = new CancellationTokenSource();\n\t\t\t\t\t\t\tchild.on('close', () => {\n\t\t\t\t\t\t\t\t// We must dispose the token to stop watching,\n\t\t\t\t\t\t\t\t// but the watcher might still be reading data.\n\t\t\t\t\t\t\t\tsetTimeout(() => cts.dispose(true), 200);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tawait watchFileContents(tmpName, chunk => stream.write(chunk), () => { /* ignore */ }, cts.token);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tunlinkSync(tmpName);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const e in env) {\n\t\t\t\t// Ignore the _ env var, because the open command\n\t\t\t\t// ignores it anyway.\n\t\t\t\t// Pass the rest of the env vars in to fix\n\t\t\t\t// https://github.com/microsoft/vscode/issues/134696.\n\t\t\t\tif (e !== '_') {\n\t\t\t\t\tspawnArgs.push('--env');\n\t\t\t\t\tspawnArgs.push(`${e}=${env[e]}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tspawnArgs.push('--args', ...argv.slice(2)); // pass on our arguments\n\n\t\t\tif (env['VSCODE_DEV']) {\n\t\t\t\t// If we're in development mode, replace the . arg with the\n\t\t\t\t// vscode source arg. Because the OSS app isn't bundled,\n\t\t\t\t// it needs the full vscode source arg to launch properly.\n\t\t\t\tconst curdir = '.';\n\t\t\t\tconst launchDirIndex = spawnArgs.indexOf(curdir);\n\t\t\t\tif (launchDirIndex !== -1) {\n\t\t\t\t\tspawnArgs[launchDirIndex] = resolve(curdir);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We already passed over the env variables\n\t\t\t// using the --env flags, so we can leave them out here.\n\t\t\t// Also, we don't need to pass env._, which is different from argv._\n\t\t\tchild = spawn('open', spawnArgs, { ...options, env: {} });\n\t\t}\n\n\t\tawait Promise.all(processCallbacks.map(callback => callback(child)));\n\t}\n}\n\nfunction getAppRoot() {\n\treturn dirname(FileAccess.asFileUri('').fsPath);\n}\n\nfunction eventuallyExit(code: number): void {\n\tsetTimeout(() => process.exit(code), 0);\n}\n\nmain(process.argv)\n\t.then(() => eventuallyExit(0))\n\t.then(null, err => {\n\t\tconsole.error(err.message || err.stack || err);\n\t\teventuallyExit(1);\n\t});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ChildProcess, spawn, SpawnOptions, StdioOptions } from 'child_process';\nimport { chmodSync, existsSync, readFileSync, statSync, truncateSync, unlinkSync } from 'fs';\nimport { homedir, release, tmpdir } from 'os';\nimport type { ProfilingSession, Target } from 'v8-inspect-profiler';\nimport { Event } from '../../base/common/event.js';\nimport { isAbsolute, resolve, join, dirname } from '../../base/common/path.js';\nimport { IProcessEnvironment, isMacintosh, isWindows } from '../../base/common/platform.js';\nimport { randomPort } from '../../base/common/ports.js';\nimport { whenDeleted, writeFileSync } from '../../base/node/pfs.js';\nimport { findFreePort } from '../../base/node/ports.js';\nimport { watchFileContents } from '../../platform/files/node/watcher/nodejs/nodejsWatcherLib.js';\nimport { NativeParsedArgs } from '../../platform/environment/common/argv.js';\nimport { buildHelpMessage, buildStdinMessage, buildVersionMessage, NATIVE_CLI_COMMANDS, OPTIONS } from '../../platform/environment/node/argv.js';\nimport { addArg, parseCLIProcessArgv } from '../../platform/environment/node/argvHelper.js';\nimport { getStdinFilePath, hasStdinWithoutTty, readFromStdin, stdinDataListener } from '../../platform/environment/node/stdin.js';\nimport { createWaitMarkerFileSync } from '../../platform/environment/node/wait.js';\nimport product from '../../platform/product/common/product.js';\nimport { CancellationTokenSource } from '../../base/common/cancellation.js';\nimport { isUNC, randomPath } from '../../base/common/extpath.js';\nimport { Utils } from '../../platform/profiling/common/profiling.js';\nimport { FileAccess } from '../../base/common/network.js';\nimport { cwd } from '../../base/common/process.js';\nimport { addUNCHostToAllowlist } from '../../base/node/unc.js';\nimport { URI } from '../../base/common/uri.js';\nimport { DeferredPromise } from '../../base/common/async.js';\n\nfunction shouldSpawnCliProcess(argv: NativeParsedArgs): boolean {\n\treturn !!argv['install-source']\n\t\t|| !!argv['list-extensions']\n\t\t|| !!argv['install-extension']\n\t\t|| !!argv['uninstall-extension']\n\t\t|| !!argv['update-extensions']\n\t\t|| !!argv['locate-extension']\n\t\t|| !!argv['add-mcp']\n\t\t|| !!argv['telemetry'];\n}\n\nexport async function main(argv: string[]): Promise<void> {\n\tlet args: NativeParsedArgs;\n\n\ttry {\n\t\targs = parseCLIProcessArgv(argv);\n\t} catch (err) {\n\t\tconsole.error(err.message);\n\t\treturn;\n\t}\n\n\tfor (const subcommand of NATIVE_CLI_COMMANDS) {\n\t\tif (args[subcommand]) {\n\t\t\tif (!product.tunnelApplicationName) {\n\t\t\t\tconsole.error(`'${subcommand}' command not supported in ${product.applicationName}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst env: IProcessEnvironment = {\n\t\t\t\t...process.env\n\t\t\t};\n\t\t\t// bootstrap-esm.js determines the electron environment based\n\t\t\t// on the following variable. For the server we need to unset\n\t\t\t// it to prevent importing any electron specific modules.\n\t\t\t// Refs https://github.com/microsoft/vscode/issues/221883\n\t\t\tdelete env['ELECTRON_RUN_AS_NODE'];\n\n\t\t\tconst tunnelArgs = argv.slice(argv.indexOf(subcommand) + 1); // all arguments behind `tunnel`\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tlet tunnelProcess: ChildProcess;\n\t\t\t\tconst stdio: StdioOptions = ['ignore', 'pipe', 'pipe'];\n\t\t\t\tif (process.env['VSCODE_DEV']) {\n\t\t\t\t\ttunnelProcess = spawn('cargo', ['run', '--', subcommand, ...tunnelArgs], { cwd: join(getAppRoot(), 'cli'), stdio, env });\n\t\t\t\t} else {\n\t\t\t\t\tconst appPath = process.platform === 'darwin'\n\t\t\t\t\t\t// ./Contents/MacOS/Electron => ./Contents/Resources/app/bin/code-tunnel-insiders\n\t\t\t\t\t\t? join(dirname(dirname(process.execPath)), 'Resources', 'app')\n\t\t\t\t\t\t: dirname(process.execPath);\n\t\t\t\t\tconst tunnelCommand = join(appPath, 'bin', `${product.tunnelApplicationName}${isWindows ? '.exe' : ''}`);\n\t\t\t\t\ttunnelProcess = spawn(tunnelCommand, [subcommand, ...tunnelArgs], { cwd: cwd(), stdio, env });\n\t\t\t\t}\n\n\t\t\t\ttunnelProcess.stdout!.pipe(process.stdout);\n\t\t\t\ttunnelProcess.stderr!.pipe(process.stderr);\n\t\t\t\ttunnelProcess.on('exit', resolve);\n\t\t\t\ttunnelProcess.on('error', reject);\n\t\t\t});\n\t\t}\n\t}\n\n\t// Help (general)\n\tif (args.help) {\n\t\tconst executable = `${product.applicationName}${isWindows ? '.exe' : ''}`;\n\t\tconsole.log(buildHelpMessage(product.nameLong, executable, product.version, OPTIONS));\n\t}\n\n\t// Help (chat)\n\telse if (args.chat?.help) {\n\t\tconst executable = `${product.applicationName}${isWindows ? '.exe' : ''}`;\n\t\tconsole.log(buildHelpMessage(product.nameLong, executable, product.version, OPTIONS.chat.options, { isChat: true }));\n\t}\n\n\t// Version Info\n\telse if (args.version) {\n\t\tconsole.log(buildVersionMessage(product.version, product.commit));\n\t}\n\n\t// Shell integration\n\telse if (args['locate-shell-integration-path']) {\n\t\tlet file: string;\n\t\tswitch (args['locate-shell-integration-path']) {\n\t\t\t// Usage: `[[ \"$TERM_PROGRAM\" == \"vscode\" ]] && . \"$(code --locate-shell-integration-path bash)\"`\n\t\t\tcase 'bash': file = 'shellIntegration-bash.sh'; break;\n\t\t\t// Usage: `if ($env:TERM_PROGRAM -eq \"vscode\") { . \"$(code --locate-shell-integration-path pwsh)\" }`\n\t\t\tcase 'pwsh': file = 'shellIntegration.ps1'; break;\n\t\t\t// Usage: `[[ \"$TERM_PROGRAM\" == \"vscode\" ]] && . \"$(code --locate-shell-integration-path zsh)\"`\n\t\t\tcase 'zsh': file = 'shellIntegration-rc.zsh'; break;\n\t\t\t// Usage: `string match -q \"$TERM_PROGRAM\" \"vscode\"; and . (code --locate-shell-integration-path fish)`\n\t\t\tcase 'fish': file = 'shellIntegration.fish'; break;\n\t\t\tdefault: throw new Error('Error using --locate-shell-integration-path: Invalid shell type');\n\t\t}\n\t\tconsole.log(join(getAppRoot(), 'out', 'vs', 'workbench', 'contrib', 'terminal', 'common', 'scripts', file));\n\t}\n\n\t// Extensions Management\n\telse if (shouldSpawnCliProcess(args)) {\n\n\t\t// We do not bundle `cliProcessMain.js` into this file because\n\t\t// it is rather large and only needed for very few CLI operations.\n\t\t// This has the downside that we need to know if we run OSS or\n\t\t// built, because our location on disk is different if built.\n\n\t\tlet cliProcessMain: string;\n\t\tif (process.env['VSCODE_DEV']) {\n\t\t\tcliProcessMain = './cliProcessMain.js';\n\t\t} else {\n\t\t\tcliProcessMain = './vs/code/node/cliProcessMain.js';\n\t\t}\n\n\t\tconst cli = await import(cliProcessMain);\n\t\tawait cli.main(args);\n\n\t\treturn;\n\t}\n\n\t// Write File\n\telse if (args['file-write']) {\n\t\tconst argsFile = args._[0];\n\t\tif (!argsFile || !isAbsolute(argsFile) || !existsSync(argsFile) || !statSync(argsFile).isFile()) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\tlet source: string | undefined;\n\t\tlet target: string | undefined;\n\t\ttry {\n\t\t\tconst argsContents: { source: string; target: string } = JSON.parse(readFileSync(argsFile, 'utf8'));\n\t\t\tsource = argsContents.source;\n\t\t\ttarget = argsContents.target;\n\t\t} catch (error) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\t// Windows: set the paths as allowed UNC paths given\n\t\t// they are explicitly provided by the user as arguments\n\t\tif (isWindows) {\n\t\t\tfor (const path of [source, target]) {\n\t\t\t\tif (typeof path === 'string' && isUNC(path)) {\n\t\t\t\t\taddUNCHostToAllowlist(URI.file(path).authority);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Validate\n\t\tif (\n\t\t\t!source || !target || source === target ||\t\t\t\t// make sure source and target are provided and are not the same\n\t\t\t!isAbsolute(source) || !isAbsolute(target) ||\t\t\t// make sure both source and target are absolute paths\n\t\t\t!existsSync(source) || !statSync(source).isFile() ||\t// make sure source exists as file\n\t\t\t!existsSync(target) || !statSync(target).isFile()\t\t// make sure target exists as file\n\t\t) {\n\t\t\tthrow new Error('Using --file-write with invalid arguments.');\n\t\t}\n\n\t\ttry {\n\n\t\t\t// Check for readonly status and chmod if so if we are told so\n\t\t\tlet targetMode = 0;\n\t\t\tlet restoreMode = false;\n\t\t\tif (args['file-chmod']) {\n\t\t\t\ttargetMode = statSync(target).mode;\n\t\t\t\tif (!(targetMode & 0o200 /* File mode indicating writable by owner */)) {\n\t\t\t\t\tchmodSync(target, targetMode | 0o200);\n\t\t\t\t\trestoreMode = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Write source to target\n\t\t\tconst data = readFileSync(source);\n\t\t\tif (isWindows) {\n\t\t\t\t// On Windows we use a different strategy of saving the file\n\t\t\t\t// by first truncating the file and then writing with r+ mode.\n\t\t\t\t// This helps to save hidden files on Windows\n\t\t\t\t// (see https://github.com/microsoft/vscode/issues/931) and\n\t\t\t\t// prevent removing alternate data streams\n\t\t\t\t// (see https://github.com/microsoft/vscode/issues/6363)\n\t\t\t\ttruncateSync(target, 0);\n\t\t\t\twriteFileSync(target, data, { flag: 'r+' });\n\t\t\t} else {\n\t\t\t\twriteFileSync(target, data);\n\t\t\t}\n\n\t\t\t// Restore previous mode as needed\n\t\t\tif (restoreMode) {\n\t\t\t\tchmodSync(target, targetMode);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\terror.message = `Error using --file-write: ${error.message}`;\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t// Just Code\n\telse {\n\t\tconst env: IProcessEnvironment = {\n\t\t\t...process.env,\n\t\t\t'ELECTRON_NO_ATTACH_CONSOLE': '1'\n\t\t};\n\n\t\tdelete env['ELECTRON_RUN_AS_NODE'];\n\n\t\tconst processCallbacks: ((child: ChildProcess) => Promise<void>)[] = [];\n\n\t\tif (args.verbose) {\n\t\t\tenv['ELECTRON_ENABLE_LOGGING'] = '1';\n\t\t}\n\n\t\tif (args.verbose || args.status) {\n\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\tchild.stdout?.on('data', (data: Buffer) => console.log(data.toString('utf8').trim()));\n\t\t\t\tchild.stderr?.on('data', (data: Buffer) => console.log(data.toString('utf8').trim()));\n\n\t\t\t\tawait Event.toPromise(Event.fromNodeEventEmitter(child, 'exit'));\n\t\t\t});\n\t\t}\n\n\t\t// Handle --transient option\n\t\tif (args['transient']) {\n\t\t\tconst tempParentDir = randomPath(tmpdir(), 'vscode');\n\t\t\tconst tempUserDataDir = join(tempParentDir, 'data');\n\t\t\tconst tempExtensionsDir = join(tempParentDir, 'extensions');\n\n\t\t\taddArg(argv, '--user-data-dir', tempUserDataDir);\n\t\t\taddArg(argv, '--extensions-dir', tempExtensionsDir);\n\n\t\t\tconsole.log(`State is temporarily stored. Relaunch this state with: ${product.applicationName} --user-data-dir \"${tempUserDataDir}\" --extensions-dir \"${tempExtensionsDir}\"`);\n\t\t}\n\n\t\tconst hasReadStdinArg = args._.some(arg => arg === '-') || args.chat?._.some(arg => arg === '-');\n\t\tif (hasReadStdinArg) {\n\t\t\t// remove the \"-\" argument when we read from stdin\n\t\t\targs._ = args._.filter(a => a !== '-');\n\t\t\targv = argv.filter(a => a !== '-');\n\t\t}\n\n\t\tlet stdinFilePath: string | undefined;\n\t\tif (hasStdinWithoutTty()) {\n\n\t\t\t// Read from stdin: we require a single \"-\" argument to be passed in order to start reading from\n\t\t\t// stdin. We do this because there is no reliable way to find out if data is piped to stdin. Just\n\t\t\t// checking for stdin being connected to a TTY is not enough (https://github.com/microsoft/vscode/issues/40351)\n\n\t\t\tif (hasReadStdinArg) {\n\t\t\t\tstdinFilePath = getStdinFilePath();\n\n\t\t\t\ttry {\n\t\t\t\t\tconst readFromStdinDone = new DeferredPromise<void>();\n\t\t\t\t\tawait readFromStdin(stdinFilePath, !!args.verbose, () => readFromStdinDone.complete());\n\t\t\t\t\tif (!args.wait) {\n\n\t\t\t\t\t\t// if `--wait` is not provided, we keep this process alive\n\t\t\t\t\t\t// for at least as long as the stdin stream is open to\n\t\t\t\t\t\t// ensure that we read all the data.\n\t\t\t\t\t\t// the downside is that the Code CLI process will then not\n\t\t\t\t\t\t// terminate until stdin is closed, but users can always\n\t\t\t\t\t\t// pass `--wait` to prevent that from happening (this is\n\t\t\t\t\t\t// actually what we enforced until v1.85.x but then was\n\t\t\t\t\t\t// changed to not enforce it anymore).\n\t\t\t\t\t\t// a solution in the future would possibly be to exit, when\n\t\t\t\t\t\t// the Code process exits. this would require some careful\n\t\t\t\t\t\t// solution though in case Code is already running and this\n\t\t\t\t\t\t// is a second instance telling the first instance what to\n\t\t\t\t\t\t// open.\n\n\t\t\t\t\t\tprocessCallbacks.push(() => readFromStdinDone.p);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (args.chat) {\n\t\t\t\t\t\t// Make sure to add tmp file as context to chat\n\t\t\t\t\t\taddArg(argv, '--add-file', stdinFilePath);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Make sure to open tmp file as editor but ignore\n\t\t\t\t\t\t// it in the \"recently open\" list\n\t\t\t\t\t\taddArg(argv, stdinFilePath);\n\t\t\t\t\t\taddArg(argv, '--skip-add-to-recently-opened');\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.log(`Reading from stdin via: ${stdinFilePath}`);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(`Failed to create file to read via stdin: ${e.toString()}`);\n\t\t\t\t\tstdinFilePath = undefined;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\t// If the user pipes data via stdin but forgot to add the \"-\" argument, help by printing a message\n\t\t\t\t// if we detect that data flows into via stdin after a certain timeout.\n\t\t\t\tprocessCallbacks.push(_ => stdinDataListener(1000).then(dataReceived => {\n\t\t\t\t\tif (dataReceived) {\n\t\t\t\t\t\tconsole.log(buildStdinMessage(product.applicationName, !!args.chat));\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tconst isMacOSBigSurOrNewer = isMacintosh && release() > '20.0.0';\n\n\t\t// If we are started with --wait create a random temporary file\n\t\t// and pass it over to the starting instance. We can use this file\n\t\t// to wait for it to be deleted to monitor that the edited file\n\t\t// is closed and then exit the waiting process.\n\t\tlet waitMarkerFilePath: string | undefined;\n\t\tif (args.wait) {\n\t\t\twaitMarkerFilePath = createWaitMarkerFileSync(args.verbose);\n\t\t\tif (waitMarkerFilePath) {\n\t\t\t\taddArg(argv, '--waitMarkerFilePath', waitMarkerFilePath);\n\t\t\t}\n\n\t\t\t// When running with --wait, we want to continue running CLI process\n\t\t\t// until either:\n\t\t\t// - the wait marker file has been deleted (e.g. when closing the editor)\n\t\t\t// - the launched process terminates (e.g. due to a crash)\n\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\tlet childExitPromise;\n\t\t\t\tif (isMacOSBigSurOrNewer) {\n\t\t\t\t\t// On Big Sur, we resolve the following promise only when the child,\n\t\t\t\t\t// i.e. the open command, exited with a signal or error. Otherwise, we\n\t\t\t\t\t// wait for the marker file to be deleted or for the child to error.\n\t\t\t\t\tchildExitPromise = new Promise<void>(resolve => {\n\t\t\t\t\t\t// Only resolve this promise if the child (i.e. open) exited with an error\n\t\t\t\t\t\tchild.on('exit', (code, signal) => {\n\t\t\t\t\t\t\tif (code !== 0 || signal) {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// On other platforms, we listen for exit in case the child exits before the\n\t\t\t\t\t// marker file is deleted.\n\t\t\t\t\tchildExitPromise = Event.toPromise(Event.fromNodeEventEmitter(child, 'exit'));\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tawait Promise.race([\n\t\t\t\t\t\twhenDeleted(waitMarkerFilePath!),\n\t\t\t\t\t\tEvent.toPromise(Event.fromNodeEventEmitter(child, 'error')),\n\t\t\t\t\t\tchildExitPromise\n\t\t\t\t\t]);\n\t\t\t\t} finally {\n\t\t\t\t\tif (stdinFilePath) {\n\t\t\t\t\t\tunlinkSync(stdinFilePath); // Make sure to delete the tmp stdin file if we have any\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// If we have been started with `--prof-startup` we need to find free ports to profile\n\t\t// the main process, the renderer, and the extension host. We also disable v8 cached data\n\t\t// to get better profile traces. Last, we listen on stdout for a signal that tells us to\n\t\t// stop profiling.\n\t\tif (args['prof-startup']) {\n\t\t\tconst profileHost = '127.0.0.1';\n\t\t\tconst portMain = await findFreePort(randomPort(), 10, 3000);\n\t\t\tconst portRenderer = await findFreePort(portMain + 1, 10, 3000);\n\t\t\tconst portExthost = await findFreePort(portRenderer + 1, 10, 3000);\n\n\t\t\t// fail the operation when one of the ports couldn't be acquired.\n\t\t\tif (portMain * portRenderer * portExthost === 0) {\n\t\t\t\tthrow new Error('Failed to find free ports for profiler. Make sure to shutdown all instances of the editor first.');\n\t\t\t}\n\n\t\t\tconst filenamePrefix = randomPath(homedir(), 'prof');\n\n\t\t\taddArg(argv, `--inspect-brk=${profileHost}:${portMain}`);\n\t\t\taddArg(argv, `--remote-debugging-port=${profileHost}:${portRenderer}`);\n\t\t\taddArg(argv, `--inspect-brk-extensions=${profileHost}:${portExthost}`);\n\t\t\taddArg(argv, `--prof-startup-prefix`, filenamePrefix);\n\t\t\taddArg(argv, `--no-cached-data`);\n\n\t\t\twriteFileSync(filenamePrefix, argv.slice(-6).join('|'));\n\n\t\t\tprocessCallbacks.push(async _child => {\n\n\t\t\t\tclass Profiler {\n\t\t\t\t\tstatic async start(name: string, filenamePrefix: string, opts: { port: number; tries?: number; target?: (targets: Target[]) => Target }) {\n\t\t\t\t\t\tconst profiler = await import('v8-inspect-profiler');\n\n\t\t\t\t\t\tlet session: ProfilingSession;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tsession = await profiler.startProfiling({ ...opts, host: profileHost });\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tconsole.error(`FAILED to start profiling for '${name}' on port '${opts.port}'`);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tasync stop() {\n\t\t\t\t\t\t\t\tif (!session) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet suffix = '';\n\t\t\t\t\t\t\t\tconst result = await session.stop();\n\t\t\t\t\t\t\t\tif (!process.env['VSCODE_DEV']) {\n\t\t\t\t\t\t\t\t\t// when running from a not-development-build we remove\n\t\t\t\t\t\t\t\t\t// absolute filenames because we don't want to reveal anything\n\t\t\t\t\t\t\t\t\t// about users. We also append the `.txt` suffix to make it\n\t\t\t\t\t\t\t\t\t// easier to attach these files to GH issues\n\t\t\t\t\t\t\t\t\tresult.profile = Utils.rewriteAbsolutePaths(result.profile, 'piiRemoved');\n\t\t\t\t\t\t\t\t\tsuffix = '.txt';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twriteFileSync(`${filenamePrefix}.${name}.cpuprofile${suffix}`, JSON.stringify(result.profile, undefined, 4));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// load and start profiler\n\t\t\t\t\tconst mainProfileRequest = Profiler.start('main', filenamePrefix, { port: portMain });\n\t\t\t\t\tconst extHostProfileRequest = Profiler.start('extHost', filenamePrefix, { port: portExthost, tries: 300 });\n\t\t\t\t\tconst rendererProfileRequest = Profiler.start('renderer', filenamePrefix, {\n\t\t\t\t\t\tport: portRenderer,\n\t\t\t\t\t\ttries: 200,\n\t\t\t\t\t\ttarget: function (targets) {\n\t\t\t\t\t\t\treturn targets.filter(target => {\n\t\t\t\t\t\t\t\tif (!target.webSocketDebuggerUrl) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (target.type === 'page') {\n\t\t\t\t\t\t\t\t\treturn target.url.indexOf('workbench/workbench.html') > 0 || target.url.indexOf('workbench/workbench-dev.html') > 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst main = await mainProfileRequest;\n\t\t\t\t\tconst extHost = await extHostProfileRequest;\n\t\t\t\t\tconst renderer = await rendererProfileRequest;\n\n\t\t\t\t\t// wait for the renderer to delete the marker file\n\t\t\t\t\tawait whenDeleted(filenamePrefix);\n\n\t\t\t\t\t// stop profiling\n\t\t\t\t\tawait main.stop();\n\t\t\t\t\tawait renderer.stop();\n\t\t\t\t\tawait extHost.stop();\n\n\t\t\t\t\t// re-create the marker file to signal that profiling is done\n\t\t\t\t\twriteFileSync(filenamePrefix, '');\n\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Failed to profile startup. Make sure to quit Code first.');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst options: SpawnOptions = {\n\t\t\tdetached: true,\n\t\t\tenv\n\t\t};\n\n\t\tif (!args.verbose) {\n\t\t\toptions['stdio'] = 'ignore';\n\t\t}\n\n\t\tlet child: ChildProcess;\n\t\tif (!isMacOSBigSurOrNewer) {\n\t\t\tif (!args.verbose && args.status) {\n\t\t\t\toptions['stdio'] = ['ignore', 'pipe', 'ignore']; // restore ability to see output when --status is used\n\t\t\t}\n\n\t\t\t// We spawn process.execPath directly\n\t\t\tchild = spawn(process.execPath, argv.slice(2), options);\n\t\t} else {\n\t\t\t// On Big Sur, we spawn using the open command to obtain behavior\n\t\t\t// similar to if the app was launched from the dock\n\t\t\t// https://github.com/microsoft/vscode/issues/102975\n\n\t\t\t// The following args are for the open command itself, rather than for VS Code:\n\t\t\t// -n creates a new instance.\n\t\t\t//    Without -n, the open command re-opens the existing instance as-is.\n\t\t\t// -g starts the new instance in the background.\n\t\t\t//    Later, Electron brings the instance to the foreground.\n\t\t\t//    This way, Mac does not automatically try to foreground the new instance, which causes\n\t\t\t//    focusing issues when the new instance only sends data to a previous instance and then closes.\n\t\t\tconst spawnArgs = ['-n', '-g'];\n\t\t\t// -a opens the given application.\n\t\t\tspawnArgs.push('-a', process.execPath); // -a: opens a specific application\n\n\t\t\tif (args.verbose || args.status) {\n\t\t\t\tspawnArgs.push('--wait-apps'); // `open --wait-apps`: blocks until the launched app is closed (even if they were already running)\n\n\t\t\t\t// The open command only allows for redirecting stderr and stdout to files,\n\t\t\t\t// so we make it redirect those to temp files, and then use a logger to\n\t\t\t\t// redirect the file output to the console\n\t\t\t\tfor (const outputType of args.verbose ? ['stdout', 'stderr'] : ['stdout']) {\n\n\t\t\t\t\t// Tmp file to target output to\n\t\t\t\t\tconst tmpName = randomPath(tmpdir(), `code-${outputType}`);\n\t\t\t\t\twriteFileSync(tmpName, '');\n\t\t\t\t\tspawnArgs.push(`--${outputType}`, tmpName);\n\n\t\t\t\t\t// Listener to redirect content to stdout/stderr\n\t\t\t\t\tprocessCallbacks.push(async child => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst stream = outputType === 'stdout' ? process.stdout : process.stderr;\n\n\t\t\t\t\t\t\tconst cts = new CancellationTokenSource();\n\t\t\t\t\t\t\tchild.on('close', () => {\n\t\t\t\t\t\t\t\t// We must dispose the token to stop watching,\n\t\t\t\t\t\t\t\t// but the watcher might still be reading data.\n\t\t\t\t\t\t\t\tsetTimeout(() => cts.dispose(true), 200);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tawait watchFileContents(tmpName, chunk => stream.write(chunk), () => { /* ignore */ }, cts.token);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tunlinkSync(tmpName);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const e in env) {\n\t\t\t\t// Ignore the _ env var, because the open command\n\t\t\t\t// ignores it anyway.\n\t\t\t\t// Pass the rest of the env vars in to fix\n\t\t\t\t// https://github.com/microsoft/vscode/issues/134696.\n\t\t\t\tif (e !== '_') {\n\t\t\t\t\tspawnArgs.push('--env');\n\t\t\t\t\tspawnArgs.push(`${e}=${env[e]}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tspawnArgs.push('--args', ...argv.slice(2)); // pass on our arguments\n\n\t\t\tif (env['VSCODE_DEV']) {\n\t\t\t\t// If we're in development mode, replace the . arg with the\n\t\t\t\t// vscode source arg. Because the OSS app isn't bundled,\n\t\t\t\t// it needs the full vscode source arg to launch properly.\n\t\t\t\tconst curdir = '.';\n\t\t\t\tconst launchDirIndex = spawnArgs.indexOf(curdir);\n\t\t\t\tif (launchDirIndex !== -1) {\n\t\t\t\t\tspawnArgs[launchDirIndex] = resolve(curdir);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// We already passed over the env variables\n\t\t\t// using the --env flags, so we can leave them out here.\n\t\t\t// Also, we don't need to pass env._, which is different from argv._\n\t\t\tchild = spawn('open', spawnArgs, { ...options, env: {} });\n\t\t}\n\n\t\tawait Promise.all(processCallbacks.map(callback => callback(child)));\n\t}\n}\n\nfunction getAppRoot() {\n\treturn dirname(FileAccess.asFileUri('').fsPath);\n}\n\nfunction eventuallyExit(code: number): void {\n\tsetTimeout(() => process.exit(code), 0);\n}\n\nmain(process.argv)\n\t.then(() => eventuallyExit(0))\n\t.then(null, err => {\n\t\tconsole.error(err.message || err.stack || err);\n\t\teventuallyExit(1);\n\t});\n"]}