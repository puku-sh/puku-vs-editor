{"version":3,"sources":["vs/code/electron-main/main.ts"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport '../../platform/update/common/update.config.contribution.js';\n\nimport { app, dialog } from 'electron';\nimport { unlinkSync, promises } from 'fs';\nimport { URI } from '../../base/common/uri.js';\nimport { coalesce, distinct } from '../../base/common/arrays.js';\nimport { Promises } from '../../base/common/async.js';\nimport { toErrorMessage } from '../../base/common/errorMessage.js';\nimport { ExpectedError, setUnexpectedErrorHandler } from '../../base/common/errors.js';\nimport { IPathWithLineAndColumn, isValidBasename, parseLineAndColumnAware, sanitizeFilePath } from '../../base/common/extpath.js';\nimport { Event } from '../../base/common/event.js';\nimport { getPathLabel } from '../../base/common/labels.js';\nimport { Schemas } from '../../base/common/network.js';\nimport { basename, resolve } from '../../base/common/path.js';\nimport { mark } from '../../base/common/performance.js';\nimport { IProcessEnvironment, isLinux, isMacintosh, isWindows, OS } from '../../base/common/platform.js';\nimport { cwd } from '../../base/common/process.js';\nimport { rtrim, trim } from '../../base/common/strings.js';\nimport { Promises as FSPromises } from '../../base/node/pfs.js';\nimport { ProxyChannel } from '../../base/parts/ipc/common/ipc.js';\nimport { Client as NodeIPCClient } from '../../base/parts/ipc/common/ipc.net.js';\nimport { connect as nodeIPCConnect, serve as nodeIPCServe, Server as NodeIPCServer, XDG_RUNTIME_DIR } from '../../base/parts/ipc/node/ipc.net.js';\nimport { CodeApplication } from './app.js';\nimport { localize } from '../../nls.js';\nimport { IConfigurationService } from '../../platform/configuration/common/configuration.js';\nimport { ConfigurationService } from '../../platform/configuration/common/configurationService.js';\nimport { IDiagnosticsMainService } from '../../platform/diagnostics/electron-main/diagnosticsMainService.js';\nimport { DiagnosticsService } from '../../platform/diagnostics/node/diagnosticsService.js';\nimport { NativeParsedArgs } from '../../platform/environment/common/argv.js';\nimport { EnvironmentMainService, IEnvironmentMainService } from '../../platform/environment/electron-main/environmentMainService.js';\nimport { addArg, parseMainProcessArgv } from '../../platform/environment/node/argvHelper.js';\nimport { createWaitMarkerFileSync } from '../../platform/environment/node/wait.js';\nimport { IFileService } from '../../platform/files/common/files.js';\nimport { FileService } from '../../platform/files/common/fileService.js';\nimport { DiskFileSystemProvider } from '../../platform/files/node/diskFileSystemProvider.js';\nimport { SyncDescriptor } from '../../platform/instantiation/common/descriptors.js';\nimport { IInstantiationService, ServicesAccessor } from '../../platform/instantiation/common/instantiation.js';\nimport { InstantiationService } from '../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../platform/instantiation/common/serviceCollection.js';\nimport { ILaunchMainService } from '../../platform/launch/electron-main/launchMainService.js';\nimport { ILifecycleMainService, LifecycleMainService } from '../../platform/lifecycle/electron-main/lifecycleMainService.js';\nimport { BufferLogger } from '../../platform/log/common/bufferLog.js';\nimport { ConsoleMainLogger, getLogLevel, ILoggerService, ILogService } from '../../platform/log/common/log.js';\nimport product from '../../platform/product/common/product.js';\nimport { IProductService } from '../../platform/product/common/productService.js';\nimport { IProtocolMainService } from '../../platform/protocol/electron-main/protocol.js';\nimport { ProtocolMainService } from '../../platform/protocol/electron-main/protocolMainService.js';\nimport { ITunnelService } from '../../platform/tunnel/common/tunnel.js';\nimport { TunnelService } from '../../platform/tunnel/node/tunnelService.js';\nimport { IRequestService } from '../../platform/request/common/request.js';\nimport { RequestService } from '../../platform/request/electron-utility/requestService.js';\nimport { ISignService } from '../../platform/sign/common/sign.js';\nimport { SignService } from '../../platform/sign/node/signService.js';\nimport { IStateReadService, IStateService } from '../../platform/state/node/state.js';\nimport { NullTelemetryService } from '../../platform/telemetry/common/telemetryUtils.js';\nimport { IThemeMainService } from '../../platform/theme/electron-main/themeMainService.js';\nimport { IUserDataProfilesMainService, UserDataProfilesMainService } from '../../platform/userDataProfile/electron-main/userDataProfile.js';\nimport { IPolicyService, NullPolicyService } from '../../platform/policy/common/policy.js';\nimport { NativePolicyService } from '../../platform/policy/node/nativePolicyService.js';\nimport { FilePolicyService } from '../../platform/policy/common/filePolicyService.js';\nimport { DisposableStore } from '../../base/common/lifecycle.js';\nimport { IUriIdentityService } from '../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../platform/uriIdentity/common/uriIdentityService.js';\nimport { ILoggerMainService, LoggerMainService } from '../../platform/log/electron-main/loggerService.js';\nimport { LogService } from '../../platform/log/common/logService.js';\nimport { massageMessageBoxOptions } from '../../platform/dialogs/common/dialogs.js';\nimport { SaveStrategy, StateService } from '../../platform/state/node/stateService.js';\nimport { FileUserDataProvider } from '../../platform/userData/common/fileUserDataProvider.js';\nimport { addUNCHostToAllowlist, getUNCHost } from '../../base/node/unc.js';\nimport { ThemeMainService } from '../../platform/theme/electron-main/themeMainServiceImpl.js';\nimport { LINUX_SYSTEM_POLICY_FILE_PATH } from '../../base/common/policy.js';\n\n/**\n * The main VS Code entry point.\n *\n * Note: This class can exist more than once for example when VS Code is already\n * running and a second instance is started from the command line. It will always\n * try to communicate with an existing instance to prevent that 2 VS Code instances\n * are running at the same time.\n */\nclass CodeMain {\n\n\tmain(): void {\n\t\ttry {\n\t\t\tthis.startup();\n\t\t} catch (error) {\n\t\t\tconsole.error(error.message);\n\t\t\tapp.exit(1);\n\t\t}\n\t}\n\n\tprivate async startup(): Promise<void> {\n\n\t\t// Set the error handler early enough so that we are not getting the\n\t\t// default electron error dialog popping up\n\t\tsetUnexpectedErrorHandler(err => console.error(err));\n\n\t\t// Create services\n\t\tconst [instantiationService, instanceEnvironment, environmentMainService, configurationService, stateMainService, bufferLogger, productService, userDataProfilesMainService] = this.createServices();\n\n\t\ttry {\n\n\t\t\t// Init services\n\t\t\ttry {\n\t\t\t\tawait this.initServices(environmentMainService, userDataProfilesMainService, configurationService, stateMainService, productService);\n\t\t\t} catch (error) {\n\n\t\t\t\t// Show a dialog for errors that can be resolved by the user\n\t\t\t\tthis.handleStartupDataDirError(environmentMainService, productService, error);\n\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\t// Startup\n\t\t\tawait instantiationService.invokeFunction(async accessor => {\n\t\t\t\tconst logService = accessor.get(ILogService);\n\t\t\t\tconst lifecycleMainService = accessor.get(ILifecycleMainService);\n\t\t\t\tconst fileService = accessor.get(IFileService);\n\t\t\t\tconst loggerService = accessor.get(ILoggerService);\n\n\t\t\t\t// Create the main IPC server by trying to be the server\n\t\t\t\t// If this throws an error it means we are not the first\n\t\t\t\t// instance of VS Code running and so we would quit.\n\t\t\t\tconst mainProcessNodeIpcServer = await this.claimInstance(logService, environmentMainService, lifecycleMainService, instantiationService, productService, true);\n\n\t\t\t\t// Write a lockfile to indicate an instance is running\n\t\t\t\t// (https://github.com/microsoft/vscode/issues/127861#issuecomment-877417451)\n\t\t\t\tFSPromises.writeFile(environmentMainService.mainLockfile, String(process.pid)).catch(err => {\n\t\t\t\t\tlogService.warn(`app#startup(): Error writing main lockfile: ${err.stack}`);\n\t\t\t\t});\n\n\t\t\t\t// Delay creation of spdlog for perf reasons (https://github.com/microsoft/vscode/issues/72906)\n\t\t\t\tbufferLogger.logger = loggerService.createLogger('main', { name: localize('mainLog', \"Main\") });\n\n\t\t\t\t// Lifecycle\n\t\t\t\tEvent.once(lifecycleMainService.onWillShutdown)(evt => {\n\t\t\t\t\tfileService.dispose();\n\t\t\t\t\tconfigurationService.dispose();\n\t\t\t\t\tevt.join('instanceLockfile', promises.unlink(environmentMainService.mainLockfile).catch(() => { /* ignored */ }));\n\t\t\t\t});\n\n\t\t\t\treturn instantiationService.createInstance(CodeApplication, mainProcessNodeIpcServer, instanceEnvironment).startup();\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tinstantiationService.invokeFunction(this.quit, error);\n\t\t}\n\t}\n\n\tprivate createServices(): [IInstantiationService, IProcessEnvironment, IEnvironmentMainService, ConfigurationService, StateService, BufferLogger, IProductService, UserDataProfilesMainService] {\n\t\tconst services = new ServiceCollection();\n\t\tconst disposables = new DisposableStore();\n\t\tprocess.once('exit', () => disposables.dispose());\n\n\t\t// Product\n\t\tconst productService = { _serviceBrand: undefined, ...product };\n\t\tservices.set(IProductService, productService);\n\n\t\t// Environment\n\t\tconst environmentMainService = new EnvironmentMainService(this.resolveArgs(), productService);\n\t\tconst instanceEnvironment = this.patchEnvironment(environmentMainService); // Patch `process.env` with the instance's environment\n\t\tservices.set(IEnvironmentMainService, environmentMainService);\n\n\t\t// Logger\n\t\tconst loggerService = new LoggerMainService(getLogLevel(environmentMainService), environmentMainService.logsHome);\n\t\tservices.set(ILoggerMainService, loggerService);\n\n\t\t// Log: We need to buffer the spdlog logs until we are sure\n\t\t// we are the only instance running, otherwise we'll have concurrent\n\t\t// log file access on Windows (https://github.com/microsoft/vscode/issues/41218)\n\t\tconst bufferLogger = new BufferLogger(loggerService.getLogLevel());\n\t\tconst logService = disposables.add(new LogService(bufferLogger, [new ConsoleMainLogger(loggerService.getLogLevel())]));\n\t\tservices.set(ILogService, logService);\n\n\t\t// Files\n\t\tconst fileService = new FileService(logService);\n\t\tservices.set(IFileService, fileService);\n\t\tconst diskFileSystemProvider = new DiskFileSystemProvider(logService);\n\t\tfileService.registerProvider(Schemas.file, diskFileSystemProvider);\n\n\t\t// URI Identity\n\t\tconst uriIdentityService = new UriIdentityService(fileService);\n\t\tservices.set(IUriIdentityService, uriIdentityService);\n\n\t\t// State\n\t\tconst stateService = new StateService(SaveStrategy.DELAYED, environmentMainService, logService, fileService);\n\t\tservices.set(IStateReadService, stateService);\n\t\tservices.set(IStateService, stateService);\n\n\t\t// User Data Profiles\n\t\tconst userDataProfilesMainService = new UserDataProfilesMainService(stateService, uriIdentityService, environmentMainService, fileService, logService);\n\t\tservices.set(IUserDataProfilesMainService, userDataProfilesMainService);\n\n\t\t// Use FileUserDataProvider for user data to\n\t\t// enable atomic read / write operations.\n\t\tfileService.registerProvider(Schemas.vscodeUserData, new FileUserDataProvider(Schemas.file, diskFileSystemProvider, Schemas.vscodeUserData, userDataProfilesMainService, uriIdentityService, logService));\n\n\t\t// Policy\n\t\tlet policyService: IPolicyService | undefined;\n\t\tif (isWindows && productService.win32RegValueName) {\n\t\t\tpolicyService = disposables.add(new NativePolicyService(logService, productService.win32RegValueName));\n\t\t} else if (isMacintosh && productService.darwinBundleIdentifier) {\n\t\t\tpolicyService = disposables.add(new NativePolicyService(logService, productService.darwinBundleIdentifier));\n\t\t} else if (isLinux) {\n\t\t\tpolicyService = disposables.add(new FilePolicyService(URI.file(LINUX_SYSTEM_POLICY_FILE_PATH), fileService, logService));\n\t\t} else if (environmentMainService.policyFile) {\n\t\t\tpolicyService = disposables.add(new FilePolicyService(environmentMainService.policyFile, fileService, logService));\n\t\t} else {\n\t\t\tpolicyService = new NullPolicyService();\n\t\t}\n\t\tservices.set(IPolicyService, policyService);\n\n\t\t// Configuration\n\t\tconst configurationService = new ConfigurationService(userDataProfilesMainService.defaultProfile.settingsResource, fileService, policyService, logService);\n\t\tservices.set(IConfigurationService, configurationService);\n\n\t\t// Lifecycle\n\t\tservices.set(ILifecycleMainService, new SyncDescriptor(LifecycleMainService, undefined, false));\n\n\t\t// Request\n\t\tservices.set(IRequestService, new SyncDescriptor(RequestService, undefined, true));\n\n\t\t// Themes\n\t\tservices.set(IThemeMainService, new SyncDescriptor(ThemeMainService));\n\n\t\t// Signing\n\t\tservices.set(ISignService, new SyncDescriptor(SignService, undefined, false /* proxied to other processes */));\n\n\t\t// Tunnel\n\t\tservices.set(ITunnelService, new SyncDescriptor(TunnelService));\n\n\t\t// Protocol (instantiated early and not using sync descriptor for security reasons)\n\t\tservices.set(IProtocolMainService, new ProtocolMainService(environmentMainService, userDataProfilesMainService, logService));\n\n\t\treturn [new InstantiationService(services, true), instanceEnvironment, environmentMainService, configurationService, stateService, bufferLogger, productService, userDataProfilesMainService];\n\t}\n\n\tprivate patchEnvironment(environmentMainService: IEnvironmentMainService): IProcessEnvironment {\n\t\tconst instanceEnvironment: IProcessEnvironment = {\n\t\t\tVSCODE_IPC_HOOK: environmentMainService.mainIPCHandle\n\t\t};\n\n\t\t['VSCODE_NLS_CONFIG', 'VSCODE_PORTABLE'].forEach(key => {\n\t\t\tconst value = process.env[key];\n\t\t\tif (typeof value === 'string') {\n\t\t\t\tinstanceEnvironment[key] = value;\n\t\t\t}\n\t\t});\n\n\t\tObject.assign(process.env, instanceEnvironment);\n\n\t\treturn instanceEnvironment;\n\t}\n\n\tprivate async initServices(environmentMainService: IEnvironmentMainService, userDataProfilesMainService: UserDataProfilesMainService, configurationService: ConfigurationService, stateService: StateService, productService: IProductService): Promise<void> {\n\t\tawait Promises.settled<unknown>([\n\n\t\t\t// Environment service (paths)\n\t\t\tPromise.all<string | undefined>([\n\t\t\t\tthis.allowWindowsUNCPath(environmentMainService.extensionsPath), // enable extension paths on UNC drives...\n\t\t\t\tenvironmentMainService.codeCachePath,\t\t\t\t\t\t\t // ...other user-data-derived paths should already be enlisted from `main.js`\n\t\t\t\tenvironmentMainService.logsHome.with({ scheme: Schemas.file }).fsPath,\n\t\t\t\tuserDataProfilesMainService.defaultProfile.globalStorageHome.with({ scheme: Schemas.file }).fsPath,\n\t\t\t\tenvironmentMainService.workspaceStorageHome.with({ scheme: Schemas.file }).fsPath,\n\t\t\t\tenvironmentMainService.localHistoryHome.with({ scheme: Schemas.file }).fsPath,\n\t\t\t\tenvironmentMainService.backupHome\n\t\t\t].map(path => path ? promises.mkdir(path, { recursive: true }) : undefined)),\n\n\t\t\t// State service\n\t\t\tstateService.init(),\n\n\t\t\t// Configuration service\n\t\t\tconfigurationService.initialize()\n\t\t]);\n\n\t\t// Initialize user data profiles after initializing the state\n\t\tuserDataProfilesMainService.init();\n\t}\n\n\tprivate allowWindowsUNCPath(path: string): string {\n\t\tif (isWindows) {\n\t\t\tconst host = getUNCHost(path);\n\t\t\tif (host) {\n\t\t\t\taddUNCHostToAllowlist(host);\n\t\t\t}\n\t\t}\n\n\t\treturn path;\n\t}\n\n\tprivate async claimInstance(logService: ILogService, environmentMainService: IEnvironmentMainService, lifecycleMainService: ILifecycleMainService, instantiationService: IInstantiationService, productService: IProductService, retry: boolean): Promise<NodeIPCServer> {\n\n\t\t// Try to setup a server for running. If that succeeds it means\n\t\t// we are the first instance to startup. Otherwise it is likely\n\t\t// that another instance is already running.\n\t\tlet mainProcessNodeIpcServer: NodeIPCServer;\n\t\ttry {\n\t\t\tmark('code/willStartMainServer');\n\t\t\tmainProcessNodeIpcServer = await nodeIPCServe(environmentMainService.mainIPCHandle);\n\t\t\tmark('code/didStartMainServer');\n\t\t\tEvent.once(lifecycleMainService.onWillShutdown)(() => mainProcessNodeIpcServer.dispose());\n\t\t} catch (error) {\n\n\t\t\t// Handle unexpected errors (the only expected error is EADDRINUSE that\n\t\t\t// indicates another instance of VS Code is running)\n\t\t\tif (error.code !== 'EADDRINUSE') {\n\n\t\t\t\t// Show a dialog for errors that can be resolved by the user\n\t\t\t\tthis.handleStartupDataDirError(environmentMainService, productService, error);\n\n\t\t\t\t// Any other runtime error is just printed to the console\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\t// there's a running instance, let's connect to it\n\t\t\tlet client: NodeIPCClient<string>;\n\t\t\ttry {\n\t\t\t\tclient = await nodeIPCConnect(environmentMainService.mainIPCHandle, 'main');\n\t\t\t} catch (error) {\n\n\t\t\t\t// Handle unexpected connection errors by showing a dialog to the user\n\t\t\t\tif (!retry || isWindows || error.code !== 'ECONNREFUSED') {\n\t\t\t\t\tif (error.code === 'EPERM') {\n\t\t\t\t\t\tthis.showStartupWarningDialog(\n\t\t\t\t\t\t\tlocalize('secondInstanceAdmin', \"Another instance of {0} is already running as administrator.\", productService.nameShort),\n\t\t\t\t\t\t\tlocalize('secondInstanceAdminDetail', \"Please close the other instance and try again.\"),\n\t\t\t\t\t\t\tproductService\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\n\t\t\t\t// it happens on Linux and OS X that the pipe is left behind\n\t\t\t\t// let's delete it, since we can't connect to it and then\n\t\t\t\t// retry the whole thing\n\t\t\t\ttry {\n\t\t\t\t\tunlinkSync(environmentMainService.mainIPCHandle);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlogService.warn('Could not delete obsolete instance handle', error);\n\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\n\t\t\t\treturn this.claimInstance(logService, environmentMainService, lifecycleMainService, instantiationService, productService, false);\n\t\t\t}\n\n\t\t\t// Tests from CLI require to be the only instance currently\n\t\t\tif (environmentMainService.extensionTestsLocationURI && !environmentMainService.debugExtensionHost.break) {\n\t\t\t\tconst msg = `Running extension tests from the command line is currently only supported if no other instance of ${productService.nameShort} is running.`;\n\t\t\t\tlogService.error(msg);\n\t\t\t\tclient.dispose();\n\n\t\t\t\tthrow new Error(msg);\n\t\t\t}\n\n\t\t\t// Show a warning dialog after some timeout if it takes long to talk to the other instance\n\t\t\t// Skip this if we are running with --wait where it is expected that we wait for a while.\n\t\t\t// Also skip when gathering diagnostics (--status) which can take a longer time.\n\t\t\tlet startupWarningDialogHandle: Timeout | undefined = undefined;\n\t\t\tif (!environmentMainService.args.wait && !environmentMainService.args.status) {\n\t\t\t\tstartupWarningDialogHandle = setTimeout(() => {\n\t\t\t\t\tthis.showStartupWarningDialog(\n\t\t\t\t\t\tlocalize('secondInstanceNoResponse', \"Another instance of {0} is running but not responding\", productService.nameShort),\n\t\t\t\t\t\tlocalize('secondInstanceNoResponseDetail', \"Please close all other instances and try again.\"),\n\t\t\t\t\t\tproductService\n\t\t\t\t\t);\n\t\t\t\t}, 10000);\n\t\t\t}\n\n\t\t\tconst otherInstanceLaunchMainService = ProxyChannel.toService<ILaunchMainService>(client.getChannel('launch'), { disableMarshalling: true });\n\t\t\tconst otherInstanceDiagnosticsMainService = ProxyChannel.toService<IDiagnosticsMainService>(client.getChannel('diagnostics'), { disableMarshalling: true });\n\n\t\t\t// Process Info\n\t\t\tif (environmentMainService.args.status) {\n\t\t\t\treturn instantiationService.invokeFunction(async () => {\n\t\t\t\t\tconst diagnosticsService = new DiagnosticsService(NullTelemetryService, productService);\n\t\t\t\t\tconst mainDiagnostics = await otherInstanceDiagnosticsMainService.getMainDiagnostics();\n\t\t\t\t\tconst remoteDiagnostics = await otherInstanceDiagnosticsMainService.getRemoteDiagnostics({ includeProcesses: true, includeWorkspaceMetadata: true });\n\t\t\t\t\tconst diagnostics = await diagnosticsService.getDiagnostics(mainDiagnostics, remoteDiagnostics);\n\t\t\t\t\tconsole.log(diagnostics);\n\n\t\t\t\t\tthrow new ExpectedError();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Windows: allow to set foreground\n\t\t\tif (isWindows) {\n\t\t\t\tawait this.windowsAllowSetForegroundWindow(otherInstanceLaunchMainService, logService);\n\t\t\t}\n\n\t\t\t// Send environment over...\n\t\t\tlogService.trace('Sending env to running instance...');\n\t\t\tawait otherInstanceLaunchMainService.start(environmentMainService.args, process.env as IProcessEnvironment);\n\n\t\t\t// Cleanup\n\t\t\tclient.dispose();\n\n\t\t\t// Now that we started, make sure the warning dialog is prevented\n\t\t\tif (startupWarningDialogHandle) {\n\t\t\t\tclearTimeout(startupWarningDialogHandle);\n\t\t\t}\n\n\t\t\tthrow new ExpectedError('Sent env to running instance. Terminating...');\n\t\t}\n\n\t\t// Print --status usage info\n\t\tif (environmentMainService.args.status) {\n\t\t\tconsole.log(localize('statusWarning', \"Warning: The --status argument can only be used if {0} is already running. Please run it again after {0} has started.\", productService.nameShort));\n\n\t\t\tthrow new ExpectedError('Terminating...');\n\t\t}\n\n\t\t// Set the VSCODE_PID variable here when we are sure we are the first\n\t\t// instance to startup. Otherwise we would wrongly overwrite the PID\n\t\tprocess.env['VSCODE_PID'] = String(process.pid);\n\n\t\treturn mainProcessNodeIpcServer;\n\t}\n\n\tprivate handleStartupDataDirError(environmentMainService: IEnvironmentMainService, productService: IProductService, error: NodeJS.ErrnoException): void {\n\t\tif (error.code === 'EACCES' || error.code === 'EPERM') {\n\t\t\tconst directories = coalesce([environmentMainService.userDataPath, environmentMainService.extensionsPath, XDG_RUNTIME_DIR]).map(folder => getPathLabel(URI.file(folder), { os: OS, tildify: environmentMainService }));\n\n\t\t\tthis.showStartupWarningDialog(\n\t\t\t\tlocalize('startupDataDirError', \"Unable to write program user data.\"),\n\t\t\t\tlocalize('startupUserDataAndExtensionsDirErrorDetail', \"{0}\\n\\nPlease make sure the following directories are writeable:\\n\\n{1}\", toErrorMessage(error), directories.join('\\n')),\n\t\t\t\tproductService\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate showStartupWarningDialog(message: string, detail: string, productService: IProductService): void {\n\n\t\t// use sync variant here because we likely exit after this method\n\t\t// due to startup issues and otherwise the dialog seems to disappear\n\t\t// https://github.com/microsoft/vscode/issues/104493\n\n\t\tdialog.showMessageBoxSync(massageMessageBoxOptions({\n\t\t\ttype: 'warning',\n\t\t\tbuttons: [localize({ key: 'close', comment: ['&& denotes a mnemonic'] }, \"&&Close\")],\n\t\t\tmessage,\n\t\t\tdetail\n\t\t}, productService).options);\n\t}\n\n\tprivate async windowsAllowSetForegroundWindow(launchMainService: ILaunchMainService, logService: ILogService): Promise<void> {\n\t\tif (isWindows) {\n\t\t\tconst processId = await launchMainService.getMainProcessId();\n\n\t\t\tlogService.trace('Sending some foreground love to the running instance:', processId);\n\n\t\t\ttry {\n\t\t\t\t(await import('windows-foreground-love')).allowSetForegroundWindow(processId);\n\t\t\t} catch (error) {\n\t\t\t\tlogService.error(error);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate quit(accessor: ServicesAccessor, reason?: ExpectedError | Error): void {\n\t\tconst logService = accessor.get(ILogService);\n\t\tconst lifecycleMainService = accessor.get(ILifecycleMainService);\n\n\t\tlet exitCode = 0;\n\n\t\tif (reason) {\n\t\t\tif ((reason as ExpectedError).isExpected) {\n\t\t\t\tif (reason.message) {\n\t\t\t\t\tlogService.trace(reason.message);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\texitCode = 1; // signal error to the outside\n\n\t\t\t\tif (reason.stack) {\n\t\t\t\t\tlogService.error(reason.stack);\n\t\t\t\t} else {\n\t\t\t\t\tlogService.error(`Startup error: ${reason.toString()}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlifecycleMainService.kill(exitCode);\n\t}\n\n\t//#region Command line arguments utilities\n\n\tprivate resolveArgs(): NativeParsedArgs {\n\n\t\t// Parse arguments\n\t\tconst args = this.validatePaths(parseMainProcessArgv(process.argv));\n\n\t\tif (args.wait && !args.waitMarkerFilePath) {\n\t\t\t// If we are started with --wait create a random temporary file\n\t\t\t// and pass it over to the starting instance. We can use this file\n\t\t\t// to wait for it to be deleted to monitor that the edited file\n\t\t\t// is closed and then exit the waiting process.\n\t\t\t//\n\t\t\t// Note: we are not doing this if the wait marker has been already\n\t\t\t// added as argument. This can happen if VS Code was started from CLI.\n\t\t\tconst waitMarkerFilePath = createWaitMarkerFileSync(args.verbose);\n\t\t\tif (waitMarkerFilePath) {\n\t\t\t\taddArg(process.argv, '--waitMarkerFilePath', waitMarkerFilePath);\n\t\t\t\targs.waitMarkerFilePath = waitMarkerFilePath;\n\t\t\t}\n\t\t}\n\n\t\tif (args.chat) {\n\t\t\tif (args.chat['new-window']) {\n\t\t\t\t// Apply `--new-window` flag to the main arguments\n\t\t\t\targs['new-window'] = true;\n\t\t\t} else if (args.chat['reuse-window']) {\n\t\t\t\t// Apply `--reuse-window` flag to the main arguments\n\t\t\t\targs['reuse-window'] = true;\n\t\t\t} else if (args.chat['profile']) {\n\t\t\t\t// Apply `--profile` flag to the main arguments\n\t\t\t\targs['profile'] = args.chat['profile'];\n\t\t\t} else {\n\t\t\t\t// Unless we are started with specific instructions about\n\t\t\t\t// new windows or reusing existing ones, always take the\n\t\t\t\t// current working directory as workspace to open.\n\t\t\t\targs._ = [cwd()];\n\t\t\t}\n\t\t}\n\n\t\treturn args;\n\t}\n\n\tprivate validatePaths(args: NativeParsedArgs): NativeParsedArgs {\n\n\t\t// Track URLs if they're going to be used\n\t\tif (args['open-url']) {\n\t\t\targs._urls = args._;\n\t\t\targs._ = [];\n\t\t}\n\n\t\t// Normalize paths and watch out for goto line mode\n\t\tif (!args['remote']) {\n\t\t\tconst paths = this.doValidatePaths(args._, args.goto);\n\t\t\targs._ = paths;\n\t\t}\n\n\t\treturn args;\n\t}\n\n\tprivate doValidatePaths(args: string[], gotoLineMode?: boolean): string[] {\n\t\tconst currentWorkingDir = cwd();\n\t\tconst result = args.map(arg => {\n\t\t\tlet pathCandidate = String(arg);\n\n\t\t\tlet parsedPath: IPathWithLineAndColumn | undefined = undefined;\n\t\t\tif (gotoLineMode) {\n\t\t\t\tparsedPath = parseLineAndColumnAware(pathCandidate);\n\t\t\t\tpathCandidate = parsedPath.path;\n\t\t\t}\n\n\t\t\tif (pathCandidate) {\n\t\t\t\tpathCandidate = this.preparePath(currentWorkingDir, pathCandidate);\n\t\t\t}\n\n\t\t\tconst sanitizedFilePath = sanitizeFilePath(pathCandidate, currentWorkingDir);\n\n\t\t\tconst filePathBasename = basename(sanitizedFilePath);\n\t\t\tif (filePathBasename /* can be empty if code is opened on root */ && !isValidBasename(filePathBasename)) {\n\t\t\t\treturn null; // do not allow invalid file names\n\t\t\t}\n\n\t\t\tif (gotoLineMode && parsedPath) {\n\t\t\t\tparsedPath.path = sanitizedFilePath;\n\n\t\t\t\treturn this.toPath(parsedPath);\n\t\t\t}\n\n\t\t\treturn sanitizedFilePath;\n\t\t});\n\n\t\tconst caseInsensitive = isWindows || isMacintosh;\n\t\tconst distinctPaths = distinct(result, path => path && caseInsensitive ? path.toLowerCase() : (path || ''));\n\n\t\treturn coalesce(distinctPaths);\n\t}\n\n\tprivate preparePath(cwd: string, path: string): string {\n\n\t\t// Trim trailing quotes\n\t\tif (isWindows) {\n\t\t\tpath = rtrim(path, '\"'); // https://github.com/microsoft/vscode/issues/1498\n\t\t}\n\n\t\t// Trim whitespaces\n\t\tpath = trim(trim(path, ' '), '\\t');\n\n\t\tif (isWindows) {\n\n\t\t\t// Resolve the path against cwd if it is relative\n\t\t\tpath = resolve(cwd, path);\n\n\t\t\t// Trim trailing '.' chars on Windows to prevent invalid file names\n\t\t\tpath = rtrim(path, '.');\n\t\t}\n\n\t\treturn path;\n\t}\n\n\tprivate toPath(pathWithLineAndCol: IPathWithLineAndColumn): string {\n\t\tconst segments = [pathWithLineAndCol.path];\n\n\t\tif (typeof pathWithLineAndCol.line === 'number') {\n\t\t\tsegments.push(String(pathWithLineAndCol.line));\n\t\t}\n\n\t\tif (typeof pathWithLineAndCol.column === 'number') {\n\t\t\tsegments.push(String(pathWithLineAndCol.column));\n\t\t}\n\n\t\treturn segments.join(':');\n\t}\n\n\t//#endregion\n}\n\n// Main Startup\nconst code = new CodeMain();\ncode.main();\n"]}