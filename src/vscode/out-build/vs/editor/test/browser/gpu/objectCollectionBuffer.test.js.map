{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/browser/gpu/objectCollectionBuffer.test.ts","vs/editor/test/browser/gpu/objectCollectionBuffer.test.ts"],"names":[],"mappings":"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","file":"objectCollectionBuffer.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, strictEqual } from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { createObjectCollectionBuffer, type IObjectCollectionBuffer } from '../../../browser/gpu/objectCollectionBuffer.js';\n\nsuite('ObjectCollectionBuffer', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertUsedData(buffer: IObjectCollectionBuffer<any>, expected: number[]) {\n\t\tdeepStrictEqual(Array.from(buffer.view.subarray(0, buffer.viewUsedSize)), expected);\n\t}\n\n\ttest('createEntry', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 5));\n\t\tassertUsedData(buffer, []);\n\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tstore.add(buffer.createEntry({ a: 3, b: 4 }));\n\t\tstore.add(buffer.createEntry({ a: 5, b: 6 }));\n\t\tstore.add(buffer.createEntry({ a: 7, b: 8 }));\n\t\tstore.add(buffer.createEntry({ a: 9, b: 10 }));\n\t\tassertUsedData(buffer, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);\n\t});\n\n\ttest('createEntry beyond capacity', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 1));\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.buffer.byteLength, 8);\n\t\tbuffer.createEntry({ a: 3, b: 4 });\n\t\tstrictEqual(buffer.entryCount, 2);\n\t\tstrictEqual(buffer.buffer.byteLength, 16);\n\t});\n\n\ttest('dispose entry', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 5));\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tconst entry1 = buffer.createEntry({ a: 3, b: 4 });\n\t\tstore.add(buffer.createEntry({ a: 5, b: 6 }));\n\t\tconst entry2 = buffer.createEntry({ a: 7, b: 8 });\n\t\tstore.add(buffer.createEntry({ a: 9, b: 10 }));\n\t\tentry1.dispose();\n\t\tentry2.dispose();\n\t\t// Data from disposed entries is stale and doesn't need to be validated\n\t\tassertUsedData(buffer, [1, 2, 5, 6, 9, 10]);\n\t});\n\n\ttest('entryCount, viewUsedSize, bufferUsedSize', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tstrictEqual(buffer.entryCount, 0);\n\t\tstrictEqual(buffer.bufferUsedSize, 0);\n\t\tstrictEqual(buffer.viewUsedSize, 0);\n\t\tbuffer.createEntry({ foo: 1, bar: 2 });\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.viewUsedSize, 2);\n\t\tstrictEqual(buffer.bufferUsedSize, 8);\n\t\tconst entry = buffer.createEntry({ foo: 3, bar: 4 });\n\t\tstrictEqual(buffer.entryCount, 2);\n\t\tstrictEqual(buffer.viewUsedSize, 4);\n\t\tstrictEqual(buffer.bufferUsedSize, 16);\n\t\tentry.dispose();\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.viewUsedSize, 2);\n\t\tstrictEqual(buffer.bufferUsedSize, 8);\n\t});\n\n\ttest('entry.get', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tconst entry = store.add(buffer.createEntry({ foo: 1, bar: 2 }));\n\t\tstrictEqual(entry.get('foo'), 1);\n\t\tstrictEqual(entry.get('bar'), 2);\n\t});\n\n\ttest('entry.set', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tconst entry = store.add(buffer.createEntry({ foo: 1, bar: 2 }));\n\t\tlet changeCount = 0;\n\t\tstore.add(buffer.onDidChange(() => changeCount++));\n\t\tentry.set('foo', 3);\n\t\tstrictEqual(changeCount, 1);\n\t\tstrictEqual(entry.get('foo'), 3);\n\t\tentry.set('bar', 4);\n\t\tstrictEqual(changeCount, 2);\n\t\tstrictEqual(entry.get('bar'), 4);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, strictEqual } from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { createObjectCollectionBuffer, type IObjectCollectionBuffer } from '../../../browser/gpu/objectCollectionBuffer.js';\n\nsuite('ObjectCollectionBuffer', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertUsedData(buffer: IObjectCollectionBuffer<any>, expected: number[]) {\n\t\tdeepStrictEqual(Array.from(buffer.view.subarray(0, buffer.viewUsedSize)), expected);\n\t}\n\n\ttest('createEntry', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 5));\n\t\tassertUsedData(buffer, []);\n\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tstore.add(buffer.createEntry({ a: 3, b: 4 }));\n\t\tstore.add(buffer.createEntry({ a: 5, b: 6 }));\n\t\tstore.add(buffer.createEntry({ a: 7, b: 8 }));\n\t\tstore.add(buffer.createEntry({ a: 9, b: 10 }));\n\t\tassertUsedData(buffer, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);\n\t});\n\n\ttest('createEntry beyond capacity', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 1));\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.buffer.byteLength, 8);\n\t\tbuffer.createEntry({ a: 3, b: 4 });\n\t\tstrictEqual(buffer.entryCount, 2);\n\t\tstrictEqual(buffer.buffer.byteLength, 16);\n\t});\n\n\ttest('dispose entry', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'a' },\n\t\t\t{ name: 'b' },\n\t\t] as const, 5));\n\t\tstore.add(buffer.createEntry({ a: 1, b: 2 }));\n\t\tconst entry1 = buffer.createEntry({ a: 3, b: 4 });\n\t\tstore.add(buffer.createEntry({ a: 5, b: 6 }));\n\t\tconst entry2 = buffer.createEntry({ a: 7, b: 8 });\n\t\tstore.add(buffer.createEntry({ a: 9, b: 10 }));\n\t\tentry1.dispose();\n\t\tentry2.dispose();\n\t\t// Data from disposed entries is stale and doesn't need to be validated\n\t\tassertUsedData(buffer, [1, 2, 5, 6, 9, 10]);\n\t});\n\n\ttest('entryCount, viewUsedSize, bufferUsedSize', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tstrictEqual(buffer.entryCount, 0);\n\t\tstrictEqual(buffer.bufferUsedSize, 0);\n\t\tstrictEqual(buffer.viewUsedSize, 0);\n\t\tbuffer.createEntry({ foo: 1, bar: 2 });\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.viewUsedSize, 2);\n\t\tstrictEqual(buffer.bufferUsedSize, 8);\n\t\tconst entry = buffer.createEntry({ foo: 3, bar: 4 });\n\t\tstrictEqual(buffer.entryCount, 2);\n\t\tstrictEqual(buffer.viewUsedSize, 4);\n\t\tstrictEqual(buffer.bufferUsedSize, 16);\n\t\tentry.dispose();\n\t\tstrictEqual(buffer.entryCount, 1);\n\t\tstrictEqual(buffer.viewUsedSize, 2);\n\t\tstrictEqual(buffer.bufferUsedSize, 8);\n\t});\n\n\ttest('entry.get', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tconst entry = store.add(buffer.createEntry({ foo: 1, bar: 2 }));\n\t\tstrictEqual(entry.get('foo'), 1);\n\t\tstrictEqual(entry.get('bar'), 2);\n\t});\n\n\ttest('entry.set', () => {\n\t\tconst buffer = store.add(createObjectCollectionBuffer([\n\t\t\t{ name: 'foo' },\n\t\t\t{ name: 'bar' },\n\t\t] as const, 5));\n\t\tconst entry = store.add(buffer.createEntry({ foo: 1, bar: 2 }));\n\t\tlet changeCount = 0;\n\t\tstore.add(buffer.onDidChange(() => changeCount++));\n\t\tentry.set('foo', 3);\n\t\tstrictEqual(changeCount, 1);\n\t\tstrictEqual(entry.get('foo'), 3);\n\t\tentry.set('bar', 4);\n\t\tstrictEqual(changeCount, 2);\n\t\tstrictEqual(entry.get('bar'), 4);\n\t});\n});\n"]}