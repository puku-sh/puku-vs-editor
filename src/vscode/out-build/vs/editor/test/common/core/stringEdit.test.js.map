{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/core/stringEdit.test.ts","vs/editor/test/common/core/stringEdit.test.ts"],"names":[],"mappings":"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","file":"stringEdit.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { Random } from './random.js';\nimport { StringEdit, StringReplacement } from '../../../common/core/edits/stringEdit.js';\nimport { OffsetRange } from '../../../common/core/ranges/offsetRange.js';\nimport { ArrayEdit, ArrayReplacement } from '../../../common/core/edits/arrayEdit.js';\n\nsuite('Edit', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('StringEdit', () => {\n\t\ttest('basic', () => {\n\t\t\tconst arr = '0123456789';\n\t\t\tconst edit = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst result = edit.apply(arr);\n\t\t\tassert.deepStrictEqual(result, '0123xyz6789');\n\t\t});\n\n\t\ttest('inverse', () => {\n\t\t\tfor (let i = 0; i < 1000; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttest.skip('fuzz', () => {\n\t\t\t\tfor (let i = 0; i < 1_000_000; i++) {\n\t\t\t\t\trunTest(i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst e = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst eInv = e.inverse(s0);\n\n\t\t\t\tassert.strictEqual(eInv.apply(e.apply(s0)), s0);\n\t\t\t}\n\t\t});\n\n\t\tsuite('compose', () => {\n\t\t\tfor (let i = 0; i < 1000; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttest.skip('fuzz', () => {\n\t\t\t\tfor (let i = 0; i < 1_000_000; i++) {\n\t\t\t\t\trunTest(i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst edits1 = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s1 = edits1.apply(s0);\n\n\t\t\t\tconst edits2 = getRandomEdit(s1, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s2 = edits2.apply(s1);\n\n\t\t\t\tconst combinedEdits = edits1.compose(edits2);\n\t\t\t\tconst s2C = combinedEdits.apply(s0);\n\n\t\t\t\tassert.strictEqual(s2C, s2);\n\t\t\t}\n\t\t});\n\n\t\ttest('equals', () => {\n\t\t\tconst edit1 = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst edit2 = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst edit3 = StringEdit.replace(new OffsetRange(5, 6), 'xyz');\n\t\t\tconst edit4 = StringEdit.replace(new OffsetRange(4, 6), 'xy');\n\n\t\t\tassert.ok(edit1.equals(edit1));\n\t\t\tassert.ok(edit1.equals(edit2));\n\t\t\tassert.ok(edit2.equals(edit1));\n\n\t\t\tassert.ok(!edit1.equals(edit3));\n\t\t\tassert.ok(!edit1.equals(edit4));\n\t\t});\n\n\t\ttest('getNewRanges', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst ranges = edit.getNewRanges();\n\t\t\tassert.deepStrictEqual(ranges, [\n\t\t\t\tnew OffsetRange(4, 9),\n\t\t\t\tnew OffsetRange(10, 11),\n\t\t\t]);\n\t\t});\n\n\t\ttest('getJoinedReplaceRange', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst range = edit.getJoinedReplaceRange();\n\t\t\tassert.deepStrictEqual(range, new OffsetRange(4, 9));\n\t\t});\n\n\t\ttest('getLengthDelta', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst delta = edit.getLengthDelta();\n\t\t\tassert.strictEqual(delta, 2);\n\t\t\tassert.strictEqual(edit.replacements[0].getLengthDelta(), 3);\n\t\t\tassert.strictEqual(edit.replacements[1].getLengthDelta(), -1);\n\t\t});\n\t});\n\n\tsuite('ArrayEdit', () => {\n\t\ttest('basic', () => {\n\t\t\tconst arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];\n\t\t\tconst edit = ArrayEdit.replace(new OffsetRange(4, 6), ['x', 'y', 'z']);\n\t\t\tconst result = edit.apply(arr);\n\t\t\tassert.deepStrictEqual(result, ['0', '1', '2', '3', 'x', 'y', 'z', '6', '7', '8', '9']);\n\t\t});\n\n\t\tsuite('compose', () => {\n\t\t\tfor (let i = 0; i < 100; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst e1 = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s1 = e1.apply(s0);\n\n\t\t\t\tconst e2 = getRandomEdit(s1, rng.nextIntRange(1, 4), rng);\n\n\t\t\t\tconst ae1 = ArrayEdit.create(e1.replacements.map(r => new ArrayReplacement(r.replaceRange, [...r.newText])));\n\t\t\t\tconst ae2 = ArrayEdit.create(e2.replacements.map(r => new ArrayReplacement(r.replaceRange, [...r.newText])));\n\t\t\t\tconst as0 = [...s0];\n\t\t\t\tconst as1 = ae1.apply(as0);\n\t\t\t\tconst as2 = ae2.apply(as1);\n\t\t\t\tconst aCombinedEdits = ae1.compose(ae2);\n\n\t\t\t\tconst as2C = aCombinedEdits.apply(as0);\n\t\t\t\tassert.deepStrictEqual(as2, as2C);\n\t\t\t}\n\t\t});\n\t});\n\n\n\tfunction getRandomEdit(str: string, count: number, rng: Random): StringEdit {\n\t\tconst edits: StringReplacement[] = [];\n\t\tlet i = 0;\n\t\tfor (let j = 0; j < count; j++) {\n\t\t\tif (i >= str.length) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tedits.push(getRandomSingleEdit(str, i, rng));\n\t\t\ti = edits[j].replaceRange.endExclusive + 1;\n\t\t}\n\t\treturn StringEdit.create(edits);\n\t}\n\n\tfunction getRandomSingleEdit(str: string, rangeOffsetStart: number, rng: Random): StringReplacement {\n\t\tconst offsetStart = rng.nextIntRange(rangeOffsetStart, str.length);\n\t\tconst offsetEnd = rng.nextIntRange(offsetStart, str.length);\n\n\t\tconst textStart = rng.nextIntRange(0, str.length);\n\t\tconst textLen = rng.nextIntRange(0, Math.min(7, str.length - textStart));\n\n\t\treturn new StringReplacement(\n\t\t\tnew OffsetRange(offsetStart, offsetEnd),\n\t\t\tstr.substring(textStart, textStart + textLen)\n\t\t);\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { Random } from './random.js';\nimport { StringEdit, StringReplacement } from '../../../common/core/edits/stringEdit.js';\nimport { OffsetRange } from '../../../common/core/ranges/offsetRange.js';\nimport { ArrayEdit, ArrayReplacement } from '../../../common/core/edits/arrayEdit.js';\n\nsuite('Edit', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('StringEdit', () => {\n\t\ttest('basic', () => {\n\t\t\tconst arr = '0123456789';\n\t\t\tconst edit = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst result = edit.apply(arr);\n\t\t\tassert.deepStrictEqual(result, '0123xyz6789');\n\t\t});\n\n\t\ttest('inverse', () => {\n\t\t\tfor (let i = 0; i < 1000; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttest.skip('fuzz', () => {\n\t\t\t\tfor (let i = 0; i < 1_000_000; i++) {\n\t\t\t\t\trunTest(i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst e = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst eInv = e.inverse(s0);\n\n\t\t\t\tassert.strictEqual(eInv.apply(e.apply(s0)), s0);\n\t\t\t}\n\t\t});\n\n\t\tsuite('compose', () => {\n\t\t\tfor (let i = 0; i < 1000; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttest.skip('fuzz', () => {\n\t\t\t\tfor (let i = 0; i < 1_000_000; i++) {\n\t\t\t\t\trunTest(i);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst edits1 = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s1 = edits1.apply(s0);\n\n\t\t\t\tconst edits2 = getRandomEdit(s1, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s2 = edits2.apply(s1);\n\n\t\t\t\tconst combinedEdits = edits1.compose(edits2);\n\t\t\t\tconst s2C = combinedEdits.apply(s0);\n\n\t\t\t\tassert.strictEqual(s2C, s2);\n\t\t\t}\n\t\t});\n\n\t\ttest('equals', () => {\n\t\t\tconst edit1 = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst edit2 = StringEdit.replace(new OffsetRange(4, 6), 'xyz');\n\t\t\tconst edit3 = StringEdit.replace(new OffsetRange(5, 6), 'xyz');\n\t\t\tconst edit4 = StringEdit.replace(new OffsetRange(4, 6), 'xy');\n\n\t\t\tassert.ok(edit1.equals(edit1));\n\t\t\tassert.ok(edit1.equals(edit2));\n\t\t\tassert.ok(edit2.equals(edit1));\n\n\t\t\tassert.ok(!edit1.equals(edit3));\n\t\t\tassert.ok(!edit1.equals(edit4));\n\t\t});\n\n\t\ttest('getNewRanges', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst ranges = edit.getNewRanges();\n\t\t\tassert.deepStrictEqual(ranges, [\n\t\t\t\tnew OffsetRange(4, 9),\n\t\t\t\tnew OffsetRange(10, 11),\n\t\t\t]);\n\t\t});\n\n\t\ttest('getJoinedReplaceRange', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst range = edit.getJoinedReplaceRange();\n\t\t\tassert.deepStrictEqual(range, new OffsetRange(4, 9));\n\t\t});\n\n\t\ttest('getLengthDelta', () => {\n\t\t\tconst edit = StringEdit.create([\n\t\t\t\tnew StringReplacement(new OffsetRange(4, 6), 'abcde'),\n\t\t\t\tnew StringReplacement(new OffsetRange(7, 9), 'a'),\n\t\t\t]);\n\t\t\tconst delta = edit.getLengthDelta();\n\t\t\tassert.strictEqual(delta, 2);\n\t\t\tassert.strictEqual(edit.replacements[0].getLengthDelta(), 3);\n\t\t\tassert.strictEqual(edit.replacements[1].getLengthDelta(), -1);\n\t\t});\n\t});\n\n\tsuite('ArrayEdit', () => {\n\t\ttest('basic', () => {\n\t\t\tconst arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];\n\t\t\tconst edit = ArrayEdit.replace(new OffsetRange(4, 6), ['x', 'y', 'z']);\n\t\t\tconst result = edit.apply(arr);\n\t\t\tassert.deepStrictEqual(result, ['0', '1', '2', '3', 'x', 'y', 'z', '6', '7', '8', '9']);\n\t\t});\n\n\t\tsuite('compose', () => {\n\t\t\tfor (let i = 0; i < 100; i++) {\n\t\t\t\ttest('case' + i, () => {\n\t\t\t\t\trunTest(i);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction runTest(seed: number) {\n\t\t\t\tconst rng = Random.create(seed);\n\n\t\t\t\tconst s0 = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\n\t\t\t\tconst e1 = getRandomEdit(s0, rng.nextIntRange(1, 4), rng);\n\t\t\t\tconst s1 = e1.apply(s0);\n\n\t\t\t\tconst e2 = getRandomEdit(s1, rng.nextIntRange(1, 4), rng);\n\n\t\t\t\tconst ae1 = ArrayEdit.create(e1.replacements.map(r => new ArrayReplacement(r.replaceRange, [...r.newText])));\n\t\t\t\tconst ae2 = ArrayEdit.create(e2.replacements.map(r => new ArrayReplacement(r.replaceRange, [...r.newText])));\n\t\t\t\tconst as0 = [...s0];\n\t\t\t\tconst as1 = ae1.apply(as0);\n\t\t\t\tconst as2 = ae2.apply(as1);\n\t\t\t\tconst aCombinedEdits = ae1.compose(ae2);\n\n\t\t\t\tconst as2C = aCombinedEdits.apply(as0);\n\t\t\t\tassert.deepStrictEqual(as2, as2C);\n\t\t\t}\n\t\t});\n\t});\n\n\n\tfunction getRandomEdit(str: string, count: number, rng: Random): StringEdit {\n\t\tconst edits: StringReplacement[] = [];\n\t\tlet i = 0;\n\t\tfor (let j = 0; j < count; j++) {\n\t\t\tif (i >= str.length) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tedits.push(getRandomSingleEdit(str, i, rng));\n\t\t\ti = edits[j].replaceRange.endExclusive + 1;\n\t\t}\n\t\treturn StringEdit.create(edits);\n\t}\n\n\tfunction getRandomSingleEdit(str: string, rangeOffsetStart: number, rng: Random): StringReplacement {\n\t\tconst offsetStart = rng.nextIntRange(rangeOffsetStart, str.length);\n\t\tconst offsetEnd = rng.nextIntRange(offsetStart, str.length);\n\n\t\tconst textStart = rng.nextIntRange(0, str.length);\n\t\tconst textLen = rng.nextIntRange(0, Math.min(7, str.length - textStart));\n\n\t\treturn new StringReplacement(\n\t\t\tnew OffsetRange(offsetStart, offsetEnd),\n\t\t\tstr.substring(textStart, textStart + textLen)\n\t\t);\n\t}\n});\n"]}