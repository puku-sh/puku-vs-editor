{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts","vs/editor/test/common/viewModel/monospaceLineBreaksComputer.test.ts"],"names":[],"mappings":"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","file":"monospaceLineBreaksComputer.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { EditorOptions, WrappingIndent } from '../../../common/config/editorOptions.js';\nimport { FontInfo } from '../../../common/config/fontInfo.js';\nimport { ILineBreaksComputerFactory, ModelLineProjectionData } from '../../../common/modelLineProjectionData.js';\nimport { MonospaceLineBreaksComputerFactory } from '../../../common/viewModel/monospaceLineBreaksComputer.js';\n\nfunction parseAnnotatedText(annotatedText: string): { text: string; indices: number[] } {\n\tlet text = '';\n\tlet currentLineIndex = 0;\n\tconst indices: number[] = [];\n\tfor (let i = 0, len = annotatedText.length; i < len; i++) {\n\t\tif (annotatedText.charAt(i) === '|') {\n\t\t\tcurrentLineIndex++;\n\t\t} else {\n\t\t\ttext += annotatedText.charAt(i);\n\t\t\tindices[text.length - 1] = currentLineIndex;\n\t\t}\n\t}\n\treturn { text: text, indices: indices };\n}\n\nfunction toAnnotatedText(text: string, lineBreakData: ModelLineProjectionData | null): string {\n\t// Insert line break markers again, according to algorithm\n\tlet actualAnnotatedText = '';\n\tif (lineBreakData) {\n\t\tlet previousLineIndex = 0;\n\t\tfor (let i = 0, len = text.length; i < len; i++) {\n\t\t\tconst r = lineBreakData.translateToOutputPosition(i);\n\t\t\tif (previousLineIndex !== r.outputLineIndex) {\n\t\t\t\tpreviousLineIndex = r.outputLineIndex;\n\t\t\t\tactualAnnotatedText += '|';\n\t\t\t}\n\t\t\tactualAnnotatedText += text.charAt(i);\n\t\t}\n\t} else {\n\t\t// No wrapping\n\t\tactualAnnotatedText = text;\n\t}\n\treturn actualAnnotatedText;\n}\n\nfunction getLineBreakData(factory: ILineBreaksComputerFactory, tabSize: number, breakAfter: number, columnsForFullWidthChar: number, wrappingIndent: WrappingIndent, wordBreak: 'normal' | 'keepAll', wrapOnEscapedLineFeeds: boolean, text: string, previousLineBreakData: ModelLineProjectionData | null): ModelLineProjectionData | null {\n\tconst fontInfo = new FontInfo({\n\t\tpixelRatio: 1,\n\t\tfontFamily: 'testFontFamily',\n\t\tfontWeight: 'normal',\n\t\tfontSize: 14,\n\t\tfontFeatureSettings: '',\n\t\tfontVariationSettings: '',\n\t\tlineHeight: 19,\n\t\tletterSpacing: 0,\n\t\tisMonospace: true,\n\t\ttypicalHalfwidthCharacterWidth: 7,\n\t\ttypicalFullwidthCharacterWidth: 7 * columnsForFullWidthChar,\n\t\tcanUseHalfwidthRightwardsArrow: true,\n\t\tspaceWidth: 7,\n\t\tmiddotWidth: 7,\n\t\twsmiddotWidth: 7,\n\t\tmaxDigitWidth: 7\n\t}, false);\n\tconst lineBreaksComputer = factory.createLineBreaksComputer(fontInfo, tabSize, breakAfter, wrappingIndent, wordBreak, wrapOnEscapedLineFeeds);\n\tconst previousLineBreakDataClone = previousLineBreakData ? new ModelLineProjectionData(null, null, previousLineBreakData.breakOffsets.slice(0), previousLineBreakData.breakOffsetsVisibleColumn.slice(0), previousLineBreakData.wrappedTextIndentLength) : null;\n\tlineBreaksComputer.addRequest(text, null, previousLineBreakDataClone);\n\treturn lineBreaksComputer.finalize()[0];\n}\n\nfunction assertLineBreaks(factory: ILineBreaksComputerFactory, tabSize: number, breakAfter: number, annotatedText: string, wrappingIndent = WrappingIndent.None, wordBreak: 'normal' | 'keepAll' = 'normal'): ModelLineProjectionData | null {\n\t// Create version of `annotatedText` with line break markers removed\n\tconst text = parseAnnotatedText(annotatedText).text;\n\tconst lineBreakData = getLineBreakData(factory, tabSize, breakAfter, 2, wrappingIndent, wordBreak, false, text, null);\n\tconst actualAnnotatedText = toAnnotatedText(text, lineBreakData);\n\n\tassert.strictEqual(actualAnnotatedText, annotatedText);\n\n\treturn lineBreakData;\n}\n\nsuite('Editor ViewModel - MonospaceLineBreaksComputer', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('MonospaceLineBreaksComputer', () => {\n\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('(', '\\t).');\n\n\t\t// Empty string\n\t\tassertLineBreaks(factory, 4, 5, '');\n\n\t\t// No wrapping if not necessary\n\t\tassertLineBreaks(factory, 4, 5, 'aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa');\n\t\tassertLineBreaks(factory, 4, -1, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');\n\n\t\t// Acts like hard wrapping if no char found\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a');\n\n\t\t// Honors wrapping character\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|.');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a.|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a..|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a...|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a....|aaa.|aa');\n\n\t\t// Honors tabs when computing wrapping position\n\t\tassertLineBreaks(factory, 4, 5, '\\t');\n\t\tassertLineBreaks(factory, 4, 5, '\\t|aaa');\n\t\tassertLineBreaks(factory, 4, 5, '\\t|a\\t|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa\\ta');\n\t\tassertLineBreaks(factory, 4, 5, 'aa\\t|aa');\n\n\t\t// Honors wrapping before characters (& gives it priority)\n\t\tassertLineBreaks(factory, 4, 5, 'aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa(.|aa');\n\n\t\t// Honors wrapping after characters (& gives it priority)\n\t\tassertLineBreaks(factory, 4, 5, 'aaa))|).aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa))|).|aaaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa)|().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa|(().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa.|(().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa.|(.).|aaa');\n\t});\n\n\tfunction assertLineBreakDataEqual(a: ModelLineProjectionData | null, b: ModelLineProjectionData | null): void {\n\t\tif (!a || !b) {\n\t\t\tassert.deepStrictEqual(a, b);\n\t\t\treturn;\n\t\t}\n\t\tassert.deepStrictEqual(a.breakOffsets, b.breakOffsets);\n\t\tassert.deepStrictEqual(a.wrappedTextIndentLength, b.wrappedTextIndentLength);\n\t\tfor (let i = 0; i < a.breakOffsetsVisibleColumn.length; i++) {\n\t\t\tconst diff = a.breakOffsetsVisibleColumn[i] - b.breakOffsetsVisibleColumn[i];\n\t\t\tassert.ok(diff < 0.001);\n\t\t}\n\t}\n\n\tfunction assertIncrementalLineBreaks(factory: ILineBreaksComputerFactory, text: string, tabSize: number, breakAfter1: number, annotatedText1: string, breakAfter2: number, annotatedText2: string, wrappingIndent = WrappingIndent.None, columnsForFullWidthChar: number = 2): void {\n\t\t// sanity check the test\n\t\tassert.strictEqual(text, parseAnnotatedText(annotatedText1).text);\n\t\tassert.strictEqual(text, parseAnnotatedText(annotatedText2).text);\n\n\t\t// check that the direct mapping is ok for 1\n\t\tconst directLineBreakData1 = getLineBreakData(factory, tabSize, breakAfter1, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, null);\n\t\tassert.strictEqual(toAnnotatedText(text, directLineBreakData1), annotatedText1);\n\n\t\t// check that the direct mapping is ok for 2\n\t\tconst directLineBreakData2 = getLineBreakData(factory, tabSize, breakAfter2, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, null);\n\t\tassert.strictEqual(toAnnotatedText(text, directLineBreakData2), annotatedText2);\n\n\t\t// check that going from 1 to 2 is ok\n\t\tconst lineBreakData2from1 = getLineBreakData(factory, tabSize, breakAfter2, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, directLineBreakData1);\n\t\tassert.strictEqual(toAnnotatedText(text, lineBreakData2from1), annotatedText2);\n\t\tassertLineBreakDataEqual(lineBreakData2from1, directLineBreakData2);\n\n\t\t// check that going from 2 to 1 is ok\n\t\tconst lineBreakData1from2 = getLineBreakData(factory, tabSize, breakAfter1, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, directLineBreakData2);\n\t\tassert.strictEqual(toAnnotatedText(text, lineBreakData1from2), annotatedText1);\n\t\tassertLineBreakDataEqual(lineBreakData1from2, directLineBreakData1);\n\t}\n\n\ttest('MonospaceLineBreaksComputer incremental 1', () => {\n\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'just some text and more', 4,\n\t\t\t10, 'just some |text and |more',\n\t\t\t15, 'just some text |and more'\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'Cu scripserit suscipiantur eos, in affert pericula contentiones sed, cetero sanctus et pro. Ius vidit magna regione te, sit ei elaboraret liberavisse. Mundi verear eu mea, eam vero scriptorem in, vix in menandri assueverit. Natum definiebas cu vim. Vim doming vocibus efficiantur id. In indoctum deseruisse voluptatum vim, ad debitis verterem sed.', 4,\n\t\t\t47, 'Cu scripserit suscipiantur eos, in affert |pericula contentiones sed, cetero sanctus et |pro. Ius vidit magna regione te, sit ei |elaboraret liberavisse. Mundi verear eu mea, |eam vero scriptorem in, vix in menandri |assueverit. Natum definiebas cu vim. Vim |doming vocibus efficiantur id. In indoctum |deseruisse voluptatum vim, ad debitis verterem |sed.',\n\t\t\t142, 'Cu scripserit suscipiantur eos, in affert pericula contentiones sed, cetero sanctus et pro. Ius vidit magna regione te, sit ei elaboraret |liberavisse. Mundi verear eu mea, eam vero scriptorem in, vix in menandri assueverit. Natum definiebas cu vim. Vim doming vocibus efficiantur |id. In indoctum deseruisse voluptatum vim, ad debitis verterem sed.',\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'An his legere persecuti, oblique delicata efficiantur ex vix, vel at graecis officiis maluisset. Et per impedit voluptua, usu discere maiorum at. Ut assum ornatus temporibus vis, an sea melius pericula. Ea dicunt oblique phaedrum nam, eu duo movet nobis. His melius facilis eu, vim malorum temporibus ne. Nec no sale regione, meliore civibus placerat id eam. Mea alii fabulas definitionem te, agam volutpat ad vis, et per bonorum nonumes repudiandae.', 4,\n\t\t\t57, 'An his legere persecuti, oblique delicata efficiantur ex |vix, vel at graecis officiis maluisset. Et per impedit |voluptua, usu discere maiorum at. Ut assum ornatus |temporibus vis, an sea melius pericula. Ea dicunt |oblique phaedrum nam, eu duo movet nobis. His melius |facilis eu, vim malorum temporibus ne. Nec no sale |regione, meliore civibus placerat id eam. Mea alii |fabulas definitionem te, agam volutpat ad vis, et per |bonorum nonumes repudiandae.',\n\t\t\t58, 'An his legere persecuti, oblique delicata efficiantur ex |vix, vel at graecis officiis maluisset. Et per impedit |voluptua, usu discere maiorum at. Ut assum ornatus |temporibus vis, an sea melius pericula. Ea dicunt oblique |phaedrum nam, eu duo movet nobis. His melius facilis eu, |vim malorum temporibus ne. Nec no sale regione, meliore |civibus placerat id eam. Mea alii fabulas definitionem |te, agam volutpat ad vis, et per bonorum nonumes |repudiandae.'\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, '\\t\\t\"owner\": \"vscode\",', 4,\n\t\t\t14, '\\t\\t\"owner|\": |\"vscod|e\",',\n\t\t\t16, '\\t\\t\"owner\":| |\"vscode\"|,',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬', 4,\n\t\t\t51, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬',\n\t\t\t50, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'ðŸ‡ðŸ‘¬&ðŸŒžðŸŒ–', 4,\n\t\t\t5, 'ðŸ‡ðŸ‘¬&|ðŸŒžðŸŒ–',\n\t\t\t4, 'ðŸ‡ðŸ‘¬|&|ðŸŒžðŸŒ–',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, '\\t\\tfunc(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬\\', WrappingIndent.Same);', 4,\n\t\t\t26, '\\t\\tfunc|(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|ðŸ‘¬\\', |WrappingIndent.|Same);',\n\t\t\t27, '\\t\\tfunc|(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|ðŸ‘¬\\', |WrappingIndent.|Same);',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'factory, \"xtxtfunc(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬x\"', 4,\n\t\t\t16, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼|ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"',\n\t\t\t17, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡|&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"',\n\t\t\tWrappingIndent.Same\n\t\t);\n\t});\n\n\ttest('issue #95686: CRITICAL: loop forever on the monospaceLineBreaksComputer', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory,\n\t\t\t'\t\t\t\t\t\t<tr dmx-class:table-danger=\"(alt <= 50)\" dmx-class:table-warning=\"(alt <= 200)\" dmx-class:table-primary=\"(alt <= 400)\" dmx-class:table-info=\"(alt <= 800)\" dmx-class:table-success=\"(alt >= 400)\">',\n\t\t\t4,\n\t\t\t179, '\t\t\t\t\t\t<tr dmx-class:table-danger=\"(alt <= 50)\" dmx-class:table-warning=\"(alt <= 200)\" dmx-class:table-primary=\"(alt <= 400)\" dmx-class:table-info=\"(alt <= 800)\" |dmx-class:table-success=\"(alt >= 400)\">',\n\t\t\t1, '\t|\t|\t|\t|\t|\t|<|t|r| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|d|a|n|g|e|r|=|\"|(|a|l|t| |<|=| |5|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|w|a|r|n|i|n|g|=|\"|(|a|l|t| |<|=| |2|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|p|r|i|m|a|r|y|=|\"|(|a|l|t| |<|=| |4|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|i|n|f|o|=|\"|(|a|l|t| |<|=| |8|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|s|u|c|c|e|s|s|=|\"|(|a|l|t| |>|=| |4|0|0|)|\"|>',\n\t\t\tWrappingIndent.Same\n\t\t);\n\t});\n\n\ttest('issue #110392: Occasional crash when resize with panel on the right', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory,\n\t\t\t'ä½ å¥½ **hello** **hello** **hello-world** hey there!',\n\t\t\t4,\n\t\t\t15, 'ä½ å¥½ **hello** |**hello** |**hello-world**| hey there!',\n\t\t\t1, 'ä½ |å¥½| |*|*|h|e|l|l|o|*|*| |*|*|h|e|l|l|o|*|*| |*|*|h|e|l|l|o|-|w|o|r|l|d|*|*| |h|e|y| |t|h|e|r|e|!',\n\t\t\tWrappingIndent.Same,\n\t\t\t1.6605405405405405\n\t\t);\n\t});\n\n\ttest('MonospaceLineBreaksComputer - CJK and Kinsoku Shori', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('(', '\\t)');\n\t\tassertLineBreaks(factory, 4, 5, 'aa \\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, '\\u3042 \\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, '\\u3042\\u3042|\\u5b89\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa |\\u5b89)\\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa \\u3042|\\u5b89\\u3042)|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa |(\\u5b89aa|\\u5b89');\n\t});\n\n\ttest('MonospaceLineBreaksComputer - WrappingIndent.Same', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tassertLineBreaks(factory, 4, 38, ' *123456789012345678901234567890123456|7890', WrappingIndent.Same);\n\t});\n\n\ttest('issue #16332: Scroll bar overlaying on top of text', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tassertLineBreaks(factory, 4, 24, 'a/ very/long/line/of/tex|t/that/expands/beyon|d/your/typical/line/|of/code/', WrappingIndent.Indent);\n\t});\n\n\ttest('issue #35162: wrappingIndent not consistently working', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tconst mapper = assertLineBreaks(factory, 4, 24, '                t h i s |i s |a l |o n |g l |i n |e', WrappingIndent.Indent);\n\t\tassert.strictEqual(mapper!.wrappedTextIndentLength, '                    '.length);\n\t});\n\n\ttest('issue #75494: surrogate pairs', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('\\t', ' ');\n\t\tassertLineBreaks(factory, 4, 49, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬', WrappingIndent.Same);\n\t});\n\n\ttest('issue #75494: surrogate pairs overrun 1', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 4, 'ðŸ‡ðŸ‘¬|&|ðŸŒžðŸŒ–', WrappingIndent.Same);\n\t});\n\n\ttest('issue #75494: surrogate pairs overrun 2', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 17, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡|&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"', WrappingIndent.Same);\n\t});\n\n\ttest('MonospaceLineBreaksComputer - WrappingIndent.DeepIndent', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tconst mapper = assertLineBreaks(factory, 4, 26, '        W e A r e T e s t |i n g D e |e p I n d |e n t a t |i o n', WrappingIndent.DeepIndent);\n\t\tassert.strictEqual(mapper!.wrappedTextIndentLength, '                '.length);\n\t});\n\n\ttest('issue #33366: Word wrap algorithm behaves differently around punctuation', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 23, 'this is a line of |text, text that sits |on a line', WrappingIndent.Same);\n\t});\n\n\ttest('issue #152773: Word wrap algorithm behaves differently with bracket followed by comma', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 24, 'this is a line of |(text), text that sits |on a line', WrappingIndent.Same);\n\t});\n\n\ttest('issue #112382: Word wrap doesn\\'t work well with control characters', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 6, '\\x06\\x06\\x06|\\x06\\x06\\x06', WrappingIndent.Same);\n\t});\n\n\ttest('Word break work well with Chinese/Japanese/Korean (CJK) text when setting normal', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 5, 'ä½ å¥½|1111', WrappingIndent.Same, 'normal');\n\t});\n\n\ttest('Word break work well with Chinese/Japanese/Korean (CJK) text when setting keepAll', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 8, 'ä½ å¥½1111', WrappingIndent.Same, 'keepAll');\n\t});\n\n\ttest('issue #258022: wrapOnEscapedLineFeeds: should work correctly after editor resize', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\n\t\t// Test text with escaped line feeds - simulates a JSON string with \\n\n\t\t// The \\n should trigger a soft wrap when wrapOnEscapedLineFeeds is enabled\n\t\tconst text = '\"Short text with\\\\nescaped newline and an escaped\\\\\\\\nbackslash\"';\n\n\t\t// First, compute line breaks with wrapOnEscapedLineFeeds enabled at initial width\n\t\tconst initialBreakData = getLineBreakData(factory, 4, 30, 2, WrappingIndent.None, 'normal', true, text, null);\n\t\tconst initialAnnotatedText = toAnnotatedText(text, initialBreakData);\n\n\t\t// Verify the escaped \\n triggers a wrap in the initial case\n\t\tassert.ok(initialAnnotatedText.includes('with\\\\n'), 'Initial case should wrap at escaped line feeds');\n\n\t\t// Now simulate editor resize by computing line breaks with different width using previous data\n\t\t// This triggers createLineBreaksFromPreviousLineBreaks which has the bug\n\t\tconst resizedBreakData = getLineBreakData(factory, 4, 35, 2, WrappingIndent.None, 'normal', true, text, initialBreakData);\n\t\tconst resizedAnnotatedText = toAnnotatedText(text, resizedBreakData);\n\n\t\t// Compute fresh line breaks at the new width (without using previous data)\n\t\t// This uses createLineBreaks which correctly handles wrapOnEscapedLineFeeds\n\t\tconst freshBreakData = getLineBreakData(factory, 4, 35, 2, WrappingIndent.None, 'normal', true, text, null);\n\t\tconst freshAnnotatedText = toAnnotatedText(text, freshBreakData);\n\n\t\t// Fresh computation should still wrap at escaped line feeds\n\t\tassert.ok(freshAnnotatedText.includes('with\\\\n'), 'Fresh computation should wrap at escaped line feeds');\n\n\t\t// BUG DEMONSTRATION: Incremental computation after resize doesn't handle escaped line feeds\n\t\t// The two results should be identical, but they're not due to the bug\n\t\tassert.strictEqual(\n\t\t\tresizedAnnotatedText,\n\t\t\tfreshAnnotatedText,\n\t\t\t`Bug: Incremental and fresh computations differ for escaped line feeds.\\n` +\n\t\t\t`Incremental (resize): ${resizedAnnotatedText}\\n` +\n\t\t\t`Fresh computation:   ${freshAnnotatedText}\\n` +\n\t\t\t`The incremental path (createLineBreaksFromPreviousLineBreaks) doesn't handle wrapOnEscapedLineFeeds`\n\t\t);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { EditorOptions, WrappingIndent } from '../../../common/config/editorOptions.js';\nimport { FontInfo } from '../../../common/config/fontInfo.js';\nimport { ILineBreaksComputerFactory, ModelLineProjectionData } from '../../../common/modelLineProjectionData.js';\nimport { MonospaceLineBreaksComputerFactory } from '../../../common/viewModel/monospaceLineBreaksComputer.js';\n\nfunction parseAnnotatedText(annotatedText: string): { text: string; indices: number[] } {\n\tlet text = '';\n\tlet currentLineIndex = 0;\n\tconst indices: number[] = [];\n\tfor (let i = 0, len = annotatedText.length; i < len; i++) {\n\t\tif (annotatedText.charAt(i) === '|') {\n\t\t\tcurrentLineIndex++;\n\t\t} else {\n\t\t\ttext += annotatedText.charAt(i);\n\t\t\tindices[text.length - 1] = currentLineIndex;\n\t\t}\n\t}\n\treturn { text: text, indices: indices };\n}\n\nfunction toAnnotatedText(text: string, lineBreakData: ModelLineProjectionData | null): string {\n\t// Insert line break markers again, according to algorithm\n\tlet actualAnnotatedText = '';\n\tif (lineBreakData) {\n\t\tlet previousLineIndex = 0;\n\t\tfor (let i = 0, len = text.length; i < len; i++) {\n\t\t\tconst r = lineBreakData.translateToOutputPosition(i);\n\t\t\tif (previousLineIndex !== r.outputLineIndex) {\n\t\t\t\tpreviousLineIndex = r.outputLineIndex;\n\t\t\t\tactualAnnotatedText += '|';\n\t\t\t}\n\t\t\tactualAnnotatedText += text.charAt(i);\n\t\t}\n\t} else {\n\t\t// No wrapping\n\t\tactualAnnotatedText = text;\n\t}\n\treturn actualAnnotatedText;\n}\n\nfunction getLineBreakData(factory: ILineBreaksComputerFactory, tabSize: number, breakAfter: number, columnsForFullWidthChar: number, wrappingIndent: WrappingIndent, wordBreak: 'normal' | 'keepAll', wrapOnEscapedLineFeeds: boolean, text: string, previousLineBreakData: ModelLineProjectionData | null): ModelLineProjectionData | null {\n\tconst fontInfo = new FontInfo({\n\t\tpixelRatio: 1,\n\t\tfontFamily: 'testFontFamily',\n\t\tfontWeight: 'normal',\n\t\tfontSize: 14,\n\t\tfontFeatureSettings: '',\n\t\tfontVariationSettings: '',\n\t\tlineHeight: 19,\n\t\tletterSpacing: 0,\n\t\tisMonospace: true,\n\t\ttypicalHalfwidthCharacterWidth: 7,\n\t\ttypicalFullwidthCharacterWidth: 7 * columnsForFullWidthChar,\n\t\tcanUseHalfwidthRightwardsArrow: true,\n\t\tspaceWidth: 7,\n\t\tmiddotWidth: 7,\n\t\twsmiddotWidth: 7,\n\t\tmaxDigitWidth: 7\n\t}, false);\n\tconst lineBreaksComputer = factory.createLineBreaksComputer(fontInfo, tabSize, breakAfter, wrappingIndent, wordBreak, wrapOnEscapedLineFeeds);\n\tconst previousLineBreakDataClone = previousLineBreakData ? new ModelLineProjectionData(null, null, previousLineBreakData.breakOffsets.slice(0), previousLineBreakData.breakOffsetsVisibleColumn.slice(0), previousLineBreakData.wrappedTextIndentLength) : null;\n\tlineBreaksComputer.addRequest(text, null, previousLineBreakDataClone);\n\treturn lineBreaksComputer.finalize()[0];\n}\n\nfunction assertLineBreaks(factory: ILineBreaksComputerFactory, tabSize: number, breakAfter: number, annotatedText: string, wrappingIndent = WrappingIndent.None, wordBreak: 'normal' | 'keepAll' = 'normal'): ModelLineProjectionData | null {\n\t// Create version of `annotatedText` with line break markers removed\n\tconst text = parseAnnotatedText(annotatedText).text;\n\tconst lineBreakData = getLineBreakData(factory, tabSize, breakAfter, 2, wrappingIndent, wordBreak, false, text, null);\n\tconst actualAnnotatedText = toAnnotatedText(text, lineBreakData);\n\n\tassert.strictEqual(actualAnnotatedText, annotatedText);\n\n\treturn lineBreakData;\n}\n\nsuite('Editor ViewModel - MonospaceLineBreaksComputer', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('MonospaceLineBreaksComputer', () => {\n\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('(', '\\t).');\n\n\t\t// Empty string\n\t\tassertLineBreaks(factory, 4, 5, '');\n\n\t\t// No wrapping if not necessary\n\t\tassertLineBreaks(factory, 4, 5, 'aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa');\n\t\tassertLineBreaks(factory, 4, -1, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');\n\n\t\t// Acts like hard wrapping if no char found\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a');\n\n\t\t// Honors wrapping character\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|.');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a.|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a..|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a...|aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaaaa|a....|aaa.|aa');\n\n\t\t// Honors tabs when computing wrapping position\n\t\tassertLineBreaks(factory, 4, 5, '\\t');\n\t\tassertLineBreaks(factory, 4, 5, '\\t|aaa');\n\t\tassertLineBreaks(factory, 4, 5, '\\t|a\\t|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa\\ta');\n\t\tassertLineBreaks(factory, 4, 5, 'aa\\t|aa');\n\n\t\t// Honors wrapping before characters (& gives it priority)\n\t\tassertLineBreaks(factory, 4, 5, 'aaa.|aa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa(.|aa');\n\n\t\t// Honors wrapping after characters (& gives it priority)\n\t\tassertLineBreaks(factory, 4, 5, 'aaa))|).aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa))|).|aaaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa)|().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aaa|(().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa.|(().|aaa');\n\t\tassertLineBreaks(factory, 4, 5, 'aa.|(.).|aaa');\n\t});\n\n\tfunction assertLineBreakDataEqual(a: ModelLineProjectionData | null, b: ModelLineProjectionData | null): void {\n\t\tif (!a || !b) {\n\t\t\tassert.deepStrictEqual(a, b);\n\t\t\treturn;\n\t\t}\n\t\tassert.deepStrictEqual(a.breakOffsets, b.breakOffsets);\n\t\tassert.deepStrictEqual(a.wrappedTextIndentLength, b.wrappedTextIndentLength);\n\t\tfor (let i = 0; i < a.breakOffsetsVisibleColumn.length; i++) {\n\t\t\tconst diff = a.breakOffsetsVisibleColumn[i] - b.breakOffsetsVisibleColumn[i];\n\t\t\tassert.ok(diff < 0.001);\n\t\t}\n\t}\n\n\tfunction assertIncrementalLineBreaks(factory: ILineBreaksComputerFactory, text: string, tabSize: number, breakAfter1: number, annotatedText1: string, breakAfter2: number, annotatedText2: string, wrappingIndent = WrappingIndent.None, columnsForFullWidthChar: number = 2): void {\n\t\t// sanity check the test\n\t\tassert.strictEqual(text, parseAnnotatedText(annotatedText1).text);\n\t\tassert.strictEqual(text, parseAnnotatedText(annotatedText2).text);\n\n\t\t// check that the direct mapping is ok for 1\n\t\tconst directLineBreakData1 = getLineBreakData(factory, tabSize, breakAfter1, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, null);\n\t\tassert.strictEqual(toAnnotatedText(text, directLineBreakData1), annotatedText1);\n\n\t\t// check that the direct mapping is ok for 2\n\t\tconst directLineBreakData2 = getLineBreakData(factory, tabSize, breakAfter2, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, null);\n\t\tassert.strictEqual(toAnnotatedText(text, directLineBreakData2), annotatedText2);\n\n\t\t// check that going from 1 to 2 is ok\n\t\tconst lineBreakData2from1 = getLineBreakData(factory, tabSize, breakAfter2, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, directLineBreakData1);\n\t\tassert.strictEqual(toAnnotatedText(text, lineBreakData2from1), annotatedText2);\n\t\tassertLineBreakDataEqual(lineBreakData2from1, directLineBreakData2);\n\n\t\t// check that going from 2 to 1 is ok\n\t\tconst lineBreakData1from2 = getLineBreakData(factory, tabSize, breakAfter1, columnsForFullWidthChar, wrappingIndent, 'normal', false, text, directLineBreakData2);\n\t\tassert.strictEqual(toAnnotatedText(text, lineBreakData1from2), annotatedText1);\n\t\tassertLineBreakDataEqual(lineBreakData1from2, directLineBreakData1);\n\t}\n\n\ttest('MonospaceLineBreaksComputer incremental 1', () => {\n\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'just some text and more', 4,\n\t\t\t10, 'just some |text and |more',\n\t\t\t15, 'just some text |and more'\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'Cu scripserit suscipiantur eos, in affert pericula contentiones sed, cetero sanctus et pro. Ius vidit magna regione te, sit ei elaboraret liberavisse. Mundi verear eu mea, eam vero scriptorem in, vix in menandri assueverit. Natum definiebas cu vim. Vim doming vocibus efficiantur id. In indoctum deseruisse voluptatum vim, ad debitis verterem sed.', 4,\n\t\t\t47, 'Cu scripserit suscipiantur eos, in affert |pericula contentiones sed, cetero sanctus et |pro. Ius vidit magna regione te, sit ei |elaboraret liberavisse. Mundi verear eu mea, |eam vero scriptorem in, vix in menandri |assueverit. Natum definiebas cu vim. Vim |doming vocibus efficiantur id. In indoctum |deseruisse voluptatum vim, ad debitis verterem |sed.',\n\t\t\t142, 'Cu scripserit suscipiantur eos, in affert pericula contentiones sed, cetero sanctus et pro. Ius vidit magna regione te, sit ei elaboraret |liberavisse. Mundi verear eu mea, eam vero scriptorem in, vix in menandri assueverit. Natum definiebas cu vim. Vim doming vocibus efficiantur |id. In indoctum deseruisse voluptatum vim, ad debitis verterem sed.',\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'An his legere persecuti, oblique delicata efficiantur ex vix, vel at graecis officiis maluisset. Et per impedit voluptua, usu discere maiorum at. Ut assum ornatus temporibus vis, an sea melius pericula. Ea dicunt oblique phaedrum nam, eu duo movet nobis. His melius facilis eu, vim malorum temporibus ne. Nec no sale regione, meliore civibus placerat id eam. Mea alii fabulas definitionem te, agam volutpat ad vis, et per bonorum nonumes repudiandae.', 4,\n\t\t\t57, 'An his legere persecuti, oblique delicata efficiantur ex |vix, vel at graecis officiis maluisset. Et per impedit |voluptua, usu discere maiorum at. Ut assum ornatus |temporibus vis, an sea melius pericula. Ea dicunt |oblique phaedrum nam, eu duo movet nobis. His melius |facilis eu, vim malorum temporibus ne. Nec no sale |regione, meliore civibus placerat id eam. Mea alii |fabulas definitionem te, agam volutpat ad vis, et per |bonorum nonumes repudiandae.',\n\t\t\t58, 'An his legere persecuti, oblique delicata efficiantur ex |vix, vel at graecis officiis maluisset. Et per impedit |voluptua, usu discere maiorum at. Ut assum ornatus |temporibus vis, an sea melius pericula. Ea dicunt oblique |phaedrum nam, eu duo movet nobis. His melius facilis eu, |vim malorum temporibus ne. Nec no sale regione, meliore |civibus placerat id eam. Mea alii fabulas definitionem |te, agam volutpat ad vis, et per bonorum nonumes |repudiandae.'\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, '\\t\\t\"owner\": \"vscode\",', 4,\n\t\t\t14, '\\t\\t\"owner|\": |\"vscod|e\",',\n\t\t\t16, '\\t\\t\"owner\":| |\"vscode\"|,',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬', 4,\n\t\t\t51, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬',\n\t\t\t50, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'ðŸ‡ðŸ‘¬&ðŸŒžðŸŒ–', 4,\n\t\t\t5, 'ðŸ‡ðŸ‘¬&|ðŸŒžðŸŒ–',\n\t\t\t4, 'ðŸ‡ðŸ‘¬|&|ðŸŒžðŸŒ–',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, '\\t\\tfunc(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬\\', WrappingIndent.Same);', 4,\n\t\t\t26, '\\t\\tfunc|(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|ðŸ‘¬\\', |WrappingIndent.|Same);',\n\t\t\t27, '\\t\\tfunc|(\\'ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡|ðŸ‘¬\\', |WrappingIndent.|Same);',\n\t\t\tWrappingIndent.Same\n\t\t);\n\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory, 'factory, \"xtxtfunc(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬x\"', 4,\n\t\t\t16, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼|ðŸ‡&|ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"',\n\t\t\t17, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡|&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"',\n\t\t\tWrappingIndent.Same\n\t\t);\n\t});\n\n\ttest('issue #95686: CRITICAL: loop forever on the monospaceLineBreaksComputer', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory,\n\t\t\t'\t\t\t\t\t\t<tr dmx-class:table-danger=\"(alt <= 50)\" dmx-class:table-warning=\"(alt <= 200)\" dmx-class:table-primary=\"(alt <= 400)\" dmx-class:table-info=\"(alt <= 800)\" dmx-class:table-success=\"(alt >= 400)\">',\n\t\t\t4,\n\t\t\t179, '\t\t\t\t\t\t<tr dmx-class:table-danger=\"(alt <= 50)\" dmx-class:table-warning=\"(alt <= 200)\" dmx-class:table-primary=\"(alt <= 400)\" dmx-class:table-info=\"(alt <= 800)\" |dmx-class:table-success=\"(alt >= 400)\">',\n\t\t\t1, '\t|\t|\t|\t|\t|\t|<|t|r| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|d|a|n|g|e|r|=|\"|(|a|l|t| |<|=| |5|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|w|a|r|n|i|n|g|=|\"|(|a|l|t| |<|=| |2|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|p|r|i|m|a|r|y|=|\"|(|a|l|t| |<|=| |4|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|i|n|f|o|=|\"|(|a|l|t| |<|=| |8|0|0|)|\"| |d|m|x|-|c|l|a|s|s|:|t|a|b|l|e|-|s|u|c|c|e|s|s|=|\"|(|a|l|t| |>|=| |4|0|0|)|\"|>',\n\t\t\tWrappingIndent.Same\n\t\t);\n\t});\n\n\ttest('issue #110392: Occasional crash when resize with panel on the right', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertIncrementalLineBreaks(\n\t\t\tfactory,\n\t\t\t'ä½ å¥½ **hello** **hello** **hello-world** hey there!',\n\t\t\t4,\n\t\t\t15, 'ä½ å¥½ **hello** |**hello** |**hello-world**| hey there!',\n\t\t\t1, 'ä½ |å¥½| |*|*|h|e|l|l|o|*|*| |*|*|h|e|l|l|o|*|*| |*|*|h|e|l|l|o|-|w|o|r|l|d|*|*| |h|e|y| |t|h|e|r|e|!',\n\t\t\tWrappingIndent.Same,\n\t\t\t1.6605405405405405\n\t\t);\n\t});\n\n\ttest('MonospaceLineBreaksComputer - CJK and Kinsoku Shori', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('(', '\\t)');\n\t\tassertLineBreaks(factory, 4, 5, 'aa \\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, '\\u3042 \\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, '\\u3042\\u3042|\\u5b89\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa |\\u5b89)\\u5b89|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa \\u3042|\\u5b89\\u3042)|\\u5b89');\n\t\tassertLineBreaks(factory, 4, 5, 'aa |(\\u5b89aa|\\u5b89');\n\t});\n\n\ttest('MonospaceLineBreaksComputer - WrappingIndent.Same', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tassertLineBreaks(factory, 4, 38, ' *123456789012345678901234567890123456|7890', WrappingIndent.Same);\n\t});\n\n\ttest('issue #16332: Scroll bar overlaying on top of text', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tassertLineBreaks(factory, 4, 24, 'a/ very/long/line/of/tex|t/that/expands/beyon|d/your/typical/line/|of/code/', WrappingIndent.Indent);\n\t});\n\n\ttest('issue #35162: wrappingIndent not consistently working', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tconst mapper = assertLineBreaks(factory, 4, 24, '                t h i s |i s |a l |o n |g l |i n |e', WrappingIndent.Indent);\n\t\tassert.strictEqual(mapper!.wrappedTextIndentLength, '                    '.length);\n\t});\n\n\ttest('issue #75494: surrogate pairs', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('\\t', ' ');\n\t\tassertLineBreaks(factory, 4, 49, 'ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼ðŸ‡ðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬', WrappingIndent.Same);\n\t});\n\n\ttest('issue #75494: surrogate pairs overrun 1', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 4, 'ðŸ‡ðŸ‘¬|&|ðŸŒžðŸŒ–', WrappingIndent.Same);\n\t});\n\n\ttest('issue #75494: surrogate pairs overrun 2', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 17, 'factory, |\"xtxtfunc|(x\"ðŸŒžðŸ‡ðŸ¼ðŸŒžðŸ‡ðŸ¼ðŸ‡|&ðŸ‘¬ðŸŒ–ðŸŒžðŸ‘¬ðŸŒ–ðŸŒžðŸ‡ðŸ¼|ðŸ‡ðŸ‘¬x\"', WrappingIndent.Same);\n\t});\n\n\ttest('MonospaceLineBreaksComputer - WrappingIndent.DeepIndent', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory('', '\\t ');\n\t\tconst mapper = assertLineBreaks(factory, 4, 26, '        W e A r e T e s t |i n g D e |e p I n d |e n t a t |i o n', WrappingIndent.DeepIndent);\n\t\tassert.strictEqual(mapper!.wrappedTextIndentLength, '                '.length);\n\t});\n\n\ttest('issue #33366: Word wrap algorithm behaves differently around punctuation', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 23, 'this is a line of |text, text that sits |on a line', WrappingIndent.Same);\n\t});\n\n\ttest('issue #152773: Word wrap algorithm behaves differently with bracket followed by comma', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 24, 'this is a line of |(text), text that sits |on a line', WrappingIndent.Same);\n\t});\n\n\ttest('issue #112382: Word wrap doesn\\'t work well with control characters', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 6, '\\x06\\x06\\x06|\\x06\\x06\\x06', WrappingIndent.Same);\n\t});\n\n\ttest('Word break work well with Chinese/Japanese/Korean (CJK) text when setting normal', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 5, 'ä½ å¥½|1111', WrappingIndent.Same, 'normal');\n\t});\n\n\ttest('Word break work well with Chinese/Japanese/Korean (CJK) text when setting keepAll', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\t\tassertLineBreaks(factory, 4, 8, 'ä½ å¥½1111', WrappingIndent.Same, 'keepAll');\n\t});\n\n\ttest('issue #258022: wrapOnEscapedLineFeeds: should work correctly after editor resize', () => {\n\t\tconst factory = new MonospaceLineBreaksComputerFactory(EditorOptions.wordWrapBreakBeforeCharacters.defaultValue, EditorOptions.wordWrapBreakAfterCharacters.defaultValue);\n\n\t\t// Test text with escaped line feeds - simulates a JSON string with \\n\n\t\t// The \\n should trigger a soft wrap when wrapOnEscapedLineFeeds is enabled\n\t\tconst text = '\"Short text with\\\\nescaped newline and an escaped\\\\\\\\nbackslash\"';\n\n\t\t// First, compute line breaks with wrapOnEscapedLineFeeds enabled at initial width\n\t\tconst initialBreakData = getLineBreakData(factory, 4, 30, 2, WrappingIndent.None, 'normal', true, text, null);\n\t\tconst initialAnnotatedText = toAnnotatedText(text, initialBreakData);\n\n\t\t// Verify the escaped \\n triggers a wrap in the initial case\n\t\tassert.ok(initialAnnotatedText.includes('with\\\\n'), 'Initial case should wrap at escaped line feeds');\n\n\t\t// Now simulate editor resize by computing line breaks with different width using previous data\n\t\t// This triggers createLineBreaksFromPreviousLineBreaks which has the bug\n\t\tconst resizedBreakData = getLineBreakData(factory, 4, 35, 2, WrappingIndent.None, 'normal', true, text, initialBreakData);\n\t\tconst resizedAnnotatedText = toAnnotatedText(text, resizedBreakData);\n\n\t\t// Compute fresh line breaks at the new width (without using previous data)\n\t\t// This uses createLineBreaks which correctly handles wrapOnEscapedLineFeeds\n\t\tconst freshBreakData = getLineBreakData(factory, 4, 35, 2, WrappingIndent.None, 'normal', true, text, null);\n\t\tconst freshAnnotatedText = toAnnotatedText(text, freshBreakData);\n\n\t\t// Fresh computation should still wrap at escaped line feeds\n\t\tassert.ok(freshAnnotatedText.includes('with\\\\n'), 'Fresh computation should wrap at escaped line feeds');\n\n\t\t// BUG DEMONSTRATION: Incremental computation after resize doesn't handle escaped line feeds\n\t\t// The two results should be identical, but they're not due to the bug\n\t\tassert.strictEqual(\n\t\t\tresizedAnnotatedText,\n\t\t\tfreshAnnotatedText,\n\t\t\t`Bug: Incremental and fresh computations differ for escaped line feeds.\\n` +\n\t\t\t`Incremental (resize): ${resizedAnnotatedText}\\n` +\n\t\t\t`Fresh computation:   ${freshAnnotatedText}\\n` +\n\t\t\t`The incremental path (createLineBreaksFromPreviousLineBreaks) doesn't handle wrapOnEscapedLineFeeds`\n\t\t);\n\t});\n});\n"]}