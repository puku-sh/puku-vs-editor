{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/model/bracketPairColorizer/beforeEditPositionMapper.test.ts","vs/editor/test/common/model/bracketPairColorizer/beforeEditPositionMapper.test.ts"],"names":[],"mappings":"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","file":"beforeEditPositionMapper.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { splitLines } from '../../../../../base/common/strings.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { IRange, Range } from '../../../../common/core/range.js';\nimport { BeforeEditPositionMapper, TextEditInfo } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper.js';\nimport { Length, lengthOfString, lengthToObj, lengthToPosition, toLength } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/length.js';\n\nsuite('Bracket Pair Colorizer - BeforeEditPositionMapper', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Single-Line 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'0123456789',\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 4), toLength(0, 7), 'xy')\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  3  x  y  7  8  9  ', // The line\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  ', // the old line numbers\n\t\t\t\t'0  1  2  3  4  5  7  8  9  10 ', // the old columns\n\n\t\t\t\t'0  0  0  0  0  0  ∞  ∞  ∞  ∞  ', // line count until next change\n\t\t\t\t'4  3  2  1  0  0  ∞  ∞  ∞  ∞  ', // column count until next change\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Single-Line 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'0123456789',\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 2), toLength(0, 4), 'xxxx'),\n\t\t\t\t\tnew TextEdit(toLength(0, 6), toLength(0, 6), 'yy')\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  x  x  x  x  4  5  y  y  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  4  5  6  7  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'2  1  0  0  0  0  2  1  0  0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'0123456789',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 3), 'xy'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  x  y  3  4  5  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  3  4  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 0), 'ab'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 7), 'c'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  b  0  1  2  3  4  c  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  3  4  0  1  2  3  4  5  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  5  4  3  2  1  0  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 3', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 0), 'ab'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 7), 'c'),\n\t\t\t\t\tnew TextEdit(toLength(1, 8), toLength(2, 4), 'd'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  b  0  1  2  3  4  c  7  d  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  0  1  2  3  4  5  7  8  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  5  4  3  2  1  0  1  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Insert 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'012345678',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(0, 5), 'a\\nb'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  a  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  5  6  7  8  ',\n\n\t\t\t\t'1  0  0  0  0  0  ',\n\t\t\t\t'0  5  6  7  8  9  ',\n\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Insert 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'012345678',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(0, 5), 'a\\nb'),\n\t\t\t\t\tnew TextEdit(toLength(0, 7), toLength(0, 8), 'x\\ny'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  a  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  5  6  x  ',\n\n\t\t\t\t'1  0  0  0  0  ',\n\t\t\t\t'0  5  6  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'y  8  ',\n\n\t\t\t\t'1  0  0  ',\n\t\t\t\t'0  8  9  ',\n\n\t\t\t\t'0  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace/Insert 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 1), 'aaa\\nbbb'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  a  a  ',\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  b  b  1  2  3  4  5  6  7  8  ',\n\n\t\t\t\t'1  1  1  1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  1  2  3  4  5  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace/Insert 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 1), 'aaa\\nbbb'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 5), 'x\\ny'),\n\t\t\t\t\tnew TextEdit(toLength(1, 7), toLength(2, 4), 'k\\nl'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  a  a  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  b  b  1  2  3  4  x  ',\n\n\t\t\t\t'1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  ',\n\t\t\t\t'0  0  0  4  3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'y  5  6  k  ',\n\n\t\t\t\t'2  1  1  1  1  ',\n\t\t\t\t'0  5  6  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'l  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n});\n\n/** @pure */\nfunction compute(inputArr: string[], edits: TextEdit[]): string[] {\n\tconst newLines = splitLines(applyLineColumnEdits(inputArr.join('\\n'), edits.map(e => ({\n\t\ttext: e.newText,\n\t\trange: Range.fromPositions(lengthToPosition(e.startOffset), lengthToPosition(e.endOffset))\n\t}))));\n\n\tconst mapper = new BeforeEditPositionMapper(edits);\n\n\tconst result = new Array<string>();\n\n\tlet lineIdx = 0;\n\tfor (const line of newLines) {\n\t\tlet lineLine = '';\n\t\tlet colLine = '';\n\t\tlet lineStr = '';\n\n\t\tlet colDist = '';\n\t\tlet lineDist = '';\n\n\t\tfor (let colIdx = 0; colIdx <= line.length; colIdx++) {\n\t\t\tconst before = mapper.getOffsetBeforeChange(toLength(lineIdx, colIdx));\n\t\t\tconst beforeObj = lengthToObj(before);\n\t\t\tif (colIdx < line.length) {\n\t\t\t\tlineStr += rightPad(line[colIdx], 3);\n\t\t\t}\n\t\t\tlineLine += rightPad('' + beforeObj.lineCount, 3);\n\t\t\tcolLine += rightPad('' + beforeObj.columnCount, 3);\n\n\t\t\tconst distLen = mapper.getDistanceToNextChange(toLength(lineIdx, colIdx));\n\t\t\tif (distLen === null) {\n\t\t\t\tlineDist += '∞  ';\n\t\t\t\tcolDist += '∞  ';\n\t\t\t} else {\n\t\t\t\tconst dist = lengthToObj(distLen);\n\t\t\t\tlineDist += rightPad('' + dist.lineCount, 3);\n\t\t\t\tcolDist += rightPad('' + dist.columnCount, 3);\n\t\t\t}\n\t\t}\n\t\tresult.push(lineStr);\n\n\t\tresult.push(lineLine);\n\t\tresult.push(colLine);\n\n\t\tresult.push(lineDist);\n\t\tresult.push(colDist);\n\n\t\tlineIdx++;\n\t}\n\n\treturn result;\n}\n\nexport class TextEdit extends TextEditInfo {\n\tconstructor(\n\t\tstartOffset: Length,\n\t\tendOffset: Length,\n\t\tpublic readonly newText: string\n\t) {\n\t\tsuper(\n\t\t\tstartOffset,\n\t\t\tendOffset,\n\t\t\tlengthOfString(newText)\n\t\t);\n\t}\n}\n\nclass PositionOffsetTransformer {\n\tprivate readonly lineStartOffsetByLineIdx: number[];\n\n\tconstructor(text: string) {\n\t\tthis.lineStartOffsetByLineIdx = [];\n\t\tthis.lineStartOffsetByLineIdx.push(0);\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tif (text.charAt(i) === '\\n') {\n\t\t\t\tthis.lineStartOffsetByLineIdx.push(i + 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset(position: Position): number {\n\t\treturn this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n\t}\n}\n\nfunction applyLineColumnEdits(text: string, edits: { range: IRange; text: string }[]): string {\n\tconst transformer = new PositionOffsetTransformer(text);\n\tconst offsetEdits = edits.map(e => {\n\t\tconst range = Range.lift(e.range);\n\t\treturn ({\n\t\t\tstartOffset: transformer.getOffset(range.getStartPosition()),\n\t\t\tendOffset: transformer.getOffset(range.getEndPosition()),\n\t\t\ttext: e.text\n\t\t});\n\t});\n\n\toffsetEdits.sort((a, b) => b.startOffset - a.startOffset);\n\n\tfor (const edit of offsetEdits) {\n\t\ttext = text.substring(0, edit.startOffset) + edit.text + text.substring(edit.endOffset);\n\t}\n\n\treturn text;\n}\n\nfunction rightPad(str: string, len: number): string {\n\twhile (str.length < len) {\n\t\tstr += ' ';\n\t}\n\treturn str;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { splitLines } from '../../../../../base/common/strings.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { IRange, Range } from '../../../../common/core/range.js';\nimport { BeforeEditPositionMapper, TextEditInfo } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper.js';\nimport { Length, lengthOfString, lengthToObj, lengthToPosition, toLength } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/length.js';\n\nsuite('Bracket Pair Colorizer - BeforeEditPositionMapper', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Single-Line 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'0123456789',\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 4), toLength(0, 7), 'xy')\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  3  x  y  7  8  9  ', // The line\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  ', // the old line numbers\n\t\t\t\t'0  1  2  3  4  5  7  8  9  10 ', // the old columns\n\n\t\t\t\t'0  0  0  0  0  0  ∞  ∞  ∞  ∞  ', // line count until next change\n\t\t\t\t'4  3  2  1  0  0  ∞  ∞  ∞  ∞  ', // column count until next change\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Single-Line 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'0123456789',\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 2), toLength(0, 4), 'xxxx'),\n\t\t\t\t\tnew TextEdit(toLength(0, 6), toLength(0, 6), 'yy')\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  x  x  x  x  4  5  y  y  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  4  5  6  7  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'2  1  0  0  0  0  2  1  0  0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'0123456789',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 3), 'xy'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  x  y  3  4  5  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  3  4  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 0), 'ab'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 7), 'c'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  b  0  1  2  3  4  c  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  3  4  0  1  2  3  4  5  7  8  9  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  5  4  3  2  1  0  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace 3', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 0), 'ab'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 7), 'c'),\n\t\t\t\t\tnew TextEdit(toLength(1, 8), toLength(2, 4), 'd'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  b  0  1  2  3  4  c  7  d  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'0  0  0  0  0  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  0  1  2  3  4  5  7  8  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  0  0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'3  2  1  0  0  5  4  3  2  1  0  1  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Insert 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'012345678',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(0, 5), 'a\\nb'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  a  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  5  6  7  8  ',\n\n\t\t\t\t'1  0  0  0  0  0  ',\n\t\t\t\t'0  5  6  7  8  9  ',\n\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Insert 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'012345678',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(0, 5), 'a\\nb'),\n\t\t\t\t\tnew TextEdit(toLength(0, 7), toLength(0, 8), 'x\\ny'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'0  1  2  a  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  5  6  x  ',\n\n\t\t\t\t'1  0  0  0  0  ',\n\t\t\t\t'0  5  6  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'y  8  ',\n\n\t\t\t\t'1  0  0  ',\n\t\t\t\t'0  8  9  ',\n\n\t\t\t\t'0  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace/Insert 1', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 1), 'aaa\\nbbb'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  a  a  ',\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  b  b  1  2  3  4  5  6  7  8  ',\n\n\t\t\t\t'1  1  1  1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  1  2  3  4  5  6  7  8  9  ',\n\n\t\t\t\t'0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  0  0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t// ------------------\n\t\t\t\t'⁰  ¹  ²  ³  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  1  2  3  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n\n\ttest('Multi-Line Replace/Insert 2', () => {\n\t\tassert.deepStrictEqual(\n\t\t\tcompute(\n\t\t\t\t[\n\t\t\t\t\t'₀₁₂₃₄₅₆₇₈₉',\n\t\t\t\t\t'012345678',\n\t\t\t\t\t'⁰¹²³⁴⁵⁶⁷⁸⁹',\n\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\tnew TextEdit(toLength(0, 3), toLength(1, 1), 'aaa\\nbbb'),\n\t\t\t\t\tnew TextEdit(toLength(1, 5), toLength(1, 5), 'x\\ny'),\n\t\t\t\t\tnew TextEdit(toLength(1, 7), toLength(2, 4), 'k\\nl'),\n\t\t\t\t]\n\t\t\t),\n\t\t\t[\n\t\t\t\t'₀  ₁  ₂  a  a  a  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'0  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  ',\n\t\t\t\t'3  2  1  0  0  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'b  b  b  1  2  3  4  x  ',\n\n\t\t\t\t'1  1  1  1  1  1  1  1  1  ',\n\t\t\t\t'0  1  2  1  2  3  4  5  6  ',\n\n\t\t\t\t'0  0  0  0  0  0  0  0  0  ',\n\t\t\t\t'0  0  0  4  3  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'y  5  6  k  ',\n\n\t\t\t\t'2  1  1  1  1  ',\n\t\t\t\t'0  5  6  7  8  ',\n\n\t\t\t\t'0  0  0  0  0  ',\n\t\t\t\t'0  2  1  0  0  ',\n\t\t\t\t// ------------------\n\t\t\t\t'l  ⁴  ⁵  ⁶  ⁷  ⁸  ⁹  ',\n\n\t\t\t\t'2  2  2  2  2  2  2  2  ',\n\t\t\t\t'0  4  5  6  7  8  9  10 ',\n\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t\t'0  ∞  ∞  ∞  ∞  ∞  ∞  ∞  ',\n\t\t\t]\n\t\t);\n\t});\n});\n\n/** @pure */\nfunction compute(inputArr: string[], edits: TextEdit[]): string[] {\n\tconst newLines = splitLines(applyLineColumnEdits(inputArr.join('\\n'), edits.map(e => ({\n\t\ttext: e.newText,\n\t\trange: Range.fromPositions(lengthToPosition(e.startOffset), lengthToPosition(e.endOffset))\n\t}))));\n\n\tconst mapper = new BeforeEditPositionMapper(edits);\n\n\tconst result = new Array<string>();\n\n\tlet lineIdx = 0;\n\tfor (const line of newLines) {\n\t\tlet lineLine = '';\n\t\tlet colLine = '';\n\t\tlet lineStr = '';\n\n\t\tlet colDist = '';\n\t\tlet lineDist = '';\n\n\t\tfor (let colIdx = 0; colIdx <= line.length; colIdx++) {\n\t\t\tconst before = mapper.getOffsetBeforeChange(toLength(lineIdx, colIdx));\n\t\t\tconst beforeObj = lengthToObj(before);\n\t\t\tif (colIdx < line.length) {\n\t\t\t\tlineStr += rightPad(line[colIdx], 3);\n\t\t\t}\n\t\t\tlineLine += rightPad('' + beforeObj.lineCount, 3);\n\t\t\tcolLine += rightPad('' + beforeObj.columnCount, 3);\n\n\t\t\tconst distLen = mapper.getDistanceToNextChange(toLength(lineIdx, colIdx));\n\t\t\tif (distLen === null) {\n\t\t\t\tlineDist += '∞  ';\n\t\t\t\tcolDist += '∞  ';\n\t\t\t} else {\n\t\t\t\tconst dist = lengthToObj(distLen);\n\t\t\t\tlineDist += rightPad('' + dist.lineCount, 3);\n\t\t\t\tcolDist += rightPad('' + dist.columnCount, 3);\n\t\t\t}\n\t\t}\n\t\tresult.push(lineStr);\n\n\t\tresult.push(lineLine);\n\t\tresult.push(colLine);\n\n\t\tresult.push(lineDist);\n\t\tresult.push(colDist);\n\n\t\tlineIdx++;\n\t}\n\n\treturn result;\n}\n\nexport class TextEdit extends TextEditInfo {\n\tconstructor(\n\t\tstartOffset: Length,\n\t\tendOffset: Length,\n\t\tpublic readonly newText: string\n\t) {\n\t\tsuper(\n\t\t\tstartOffset,\n\t\t\tendOffset,\n\t\t\tlengthOfString(newText)\n\t\t);\n\t}\n}\n\nclass PositionOffsetTransformer {\n\tprivate readonly lineStartOffsetByLineIdx: number[];\n\n\tconstructor(text: string) {\n\t\tthis.lineStartOffsetByLineIdx = [];\n\t\tthis.lineStartOffsetByLineIdx.push(0);\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tif (text.charAt(i) === '\\n') {\n\t\t\t\tthis.lineStartOffsetByLineIdx.push(i + 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset(position: Position): number {\n\t\treturn this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n\t}\n}\n\nfunction applyLineColumnEdits(text: string, edits: { range: IRange; text: string }[]): string {\n\tconst transformer = new PositionOffsetTransformer(text);\n\tconst offsetEdits = edits.map(e => {\n\t\tconst range = Range.lift(e.range);\n\t\treturn ({\n\t\t\tstartOffset: transformer.getOffset(range.getStartPosition()),\n\t\t\tendOffset: transformer.getOffset(range.getEndPosition()),\n\t\t\ttext: e.text\n\t\t});\n\t});\n\n\toffsetEdits.sort((a, b) => b.startOffset - a.startOffset);\n\n\tfor (const edit of offsetEdits) {\n\t\ttext = text.substring(0, edit.startOffset) + edit.text + text.substring(edit.endOffset);\n\t}\n\n\treturn text;\n}\n\nfunction rightPad(str: string, len: number): string {\n\twhile (str.length < len) {\n\t\tstr += ' ';\n\t}\n\treturn str;\n}\n"]}