{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/model/editableTextModelTestUtils.ts","vs/editor/test/common/model/editableTextModelTestUtils.ts"],"names":[],"mappings":"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","file":"editableTextModelTestUtils.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ISingleEditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EndOfLinePreference, EndOfLineSequence } from '../../../common/model.js';\nimport { MirrorTextModel } from '../../../common/model/mirrorTextModel.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { IModelContentChangedEvent } from '../../../common/textModelEvents.js';\nimport { createTextModel } from '../testTextModel.js';\n\nexport function testApplyEditsWithSyncedModels(original: string[], edits: ISingleEditOperation[], expected: string[], inputEditsAreInvalid: boolean = false): void {\n\tconst originalStr = original.join('\\n');\n\tconst expectedStr = expected.join('\\n');\n\n\tassertSyncedModels(originalStr, (model, assertMirrorModels) => {\n\t\t// Apply edits & collect inverse edits\n\t\tconst inverseEdits = model.applyEdits(edits, true);\n\n\t\t// Assert edits produced expected result\n\t\tassert.deepStrictEqual(model.getValue(EndOfLinePreference.LF), expectedStr);\n\n\t\tassertMirrorModels();\n\n\t\t// Apply the inverse edits\n\t\tconst inverseInverseEdits = model.applyEdits(inverseEdits, true);\n\n\t\t// Assert the inverse edits brought back model to original state\n\t\tassert.deepStrictEqual(model.getValue(EndOfLinePreference.LF), originalStr);\n\n\t\tif (!inputEditsAreInvalid) {\n\t\t\tconst simplifyEdit = (edit: ISingleEditOperation) => {\n\t\t\t\treturn {\n\t\t\t\t\trange: edit.range,\n\t\t\t\t\ttext: edit.text,\n\t\t\t\t\tforceMoveMarkers: edit.forceMoveMarkers || false\n\t\t\t\t};\n\t\t\t};\n\t\t\t// Assert the inverse of the inverse edits are the original edits\n\t\t\tassert.deepStrictEqual(inverseInverseEdits.map(simplifyEdit), edits.map(simplifyEdit));\n\t\t}\n\n\t\tassertMirrorModels();\n\t});\n}\n\nconst enum AssertDocumentLineMappingDirection {\n\tOffsetToPosition,\n\tPositionToOffset\n}\n\nfunction assertOneDirectionLineMapping(model: TextModel, direction: AssertDocumentLineMappingDirection, msg: string): void {\n\tconst allText = model.getValue();\n\n\tlet line = 1, column = 1, previousIsCarriageReturn = false;\n\tfor (let offset = 0; offset <= allText.length; offset++) {\n\t\t// The position coordinate system cannot express the position between \\r and \\n\n\t\tconst position: Position = new Position(line, column + (previousIsCarriageReturn ? -1 : 0));\n\n\t\tif (direction === AssertDocumentLineMappingDirection.OffsetToPosition) {\n\t\t\tconst actualPosition = model.getPositionAt(offset);\n\t\t\tassert.strictEqual(actualPosition.toString(), position.toString(), msg + ' - getPositionAt mismatch for offset ' + offset);\n\t\t} else {\n\t\t\t// The position coordinate system cannot express the position between \\r and \\n\n\t\t\tconst expectedOffset: number = offset + (previousIsCarriageReturn ? -1 : 0);\n\t\t\tconst actualOffset = model.getOffsetAt(position);\n\t\t\tassert.strictEqual(actualOffset, expectedOffset, msg + ' - getOffsetAt mismatch for position ' + position.toString());\n\t\t}\n\n\t\tif (allText.charAt(offset) === '\\n') {\n\t\t\tline++;\n\t\t\tcolumn = 1;\n\t\t} else {\n\t\t\tcolumn++;\n\t\t}\n\n\t\tpreviousIsCarriageReturn = (allText.charAt(offset) === '\\r');\n\t}\n}\n\nfunction assertLineMapping(model: TextModel, msg: string): void {\n\tassertOneDirectionLineMapping(model, AssertDocumentLineMappingDirection.PositionToOffset, msg);\n\tassertOneDirectionLineMapping(model, AssertDocumentLineMappingDirection.OffsetToPosition, msg);\n}\n\n\nexport function assertSyncedModels(text: string, callback: (model: TextModel, assertMirrorModels: () => void) => void, setup: ((model: TextModel) => void) | null = null): void {\n\tconst model = createTextModel(text);\n\tmodel.setEOL(EndOfLineSequence.LF);\n\tassertLineMapping(model, 'model');\n\n\tif (setup) {\n\t\tsetup(model);\n\t\tassertLineMapping(model, 'model');\n\t}\n\n\tconst mirrorModel2 = new MirrorTextModel(null!, model.getLinesContent(), model.getEOL(), model.getVersionId());\n\tlet mirrorModel2PrevVersionId = model.getVersionId();\n\n\tconst disposable = model.onDidChangeContent((e: IModelContentChangedEvent) => {\n\t\tconst versionId = e.versionId;\n\t\tif (versionId < mirrorModel2PrevVersionId) {\n\t\t\tconsole.warn('Model version id did not advance between edits (2)');\n\t\t}\n\t\tmirrorModel2PrevVersionId = versionId;\n\t\tmirrorModel2.onEvents(e);\n\t});\n\n\tconst assertMirrorModels = () => {\n\t\tassertLineMapping(model, 'model');\n\t\tassert.strictEqual(mirrorModel2.getText(), model.getValue(), 'mirror model 2 text OK');\n\t\tassert.strictEqual(mirrorModel2.version, model.getVersionId(), 'mirror model 2 version OK');\n\t};\n\n\tcallback(model, assertMirrorModels);\n\n\tdisposable.dispose();\n\tmodel.dispose();\n\tmirrorModel2.dispose();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ISingleEditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EndOfLinePreference, EndOfLineSequence } from '../../../common/model.js';\nimport { MirrorTextModel } from '../../../common/model/mirrorTextModel.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { IModelContentChangedEvent } from '../../../common/textModelEvents.js';\nimport { createTextModel } from '../testTextModel.js';\n\nexport function testApplyEditsWithSyncedModels(original: string[], edits: ISingleEditOperation[], expected: string[], inputEditsAreInvalid: boolean = false): void {\n\tconst originalStr = original.join('\\n');\n\tconst expectedStr = expected.join('\\n');\n\n\tassertSyncedModels(originalStr, (model, assertMirrorModels) => {\n\t\t// Apply edits & collect inverse edits\n\t\tconst inverseEdits = model.applyEdits(edits, true);\n\n\t\t// Assert edits produced expected result\n\t\tassert.deepStrictEqual(model.getValue(EndOfLinePreference.LF), expectedStr);\n\n\t\tassertMirrorModels();\n\n\t\t// Apply the inverse edits\n\t\tconst inverseInverseEdits = model.applyEdits(inverseEdits, true);\n\n\t\t// Assert the inverse edits brought back model to original state\n\t\tassert.deepStrictEqual(model.getValue(EndOfLinePreference.LF), originalStr);\n\n\t\tif (!inputEditsAreInvalid) {\n\t\t\tconst simplifyEdit = (edit: ISingleEditOperation) => {\n\t\t\t\treturn {\n\t\t\t\t\trange: edit.range,\n\t\t\t\t\ttext: edit.text,\n\t\t\t\t\tforceMoveMarkers: edit.forceMoveMarkers || false\n\t\t\t\t};\n\t\t\t};\n\t\t\t// Assert the inverse of the inverse edits are the original edits\n\t\t\tassert.deepStrictEqual(inverseInverseEdits.map(simplifyEdit), edits.map(simplifyEdit));\n\t\t}\n\n\t\tassertMirrorModels();\n\t});\n}\n\nconst enum AssertDocumentLineMappingDirection {\n\tOffsetToPosition,\n\tPositionToOffset\n}\n\nfunction assertOneDirectionLineMapping(model: TextModel, direction: AssertDocumentLineMappingDirection, msg: string): void {\n\tconst allText = model.getValue();\n\n\tlet line = 1, column = 1, previousIsCarriageReturn = false;\n\tfor (let offset = 0; offset <= allText.length; offset++) {\n\t\t// The position coordinate system cannot express the position between \\r and \\n\n\t\tconst position: Position = new Position(line, column + (previousIsCarriageReturn ? -1 : 0));\n\n\t\tif (direction === AssertDocumentLineMappingDirection.OffsetToPosition) {\n\t\t\tconst actualPosition = model.getPositionAt(offset);\n\t\t\tassert.strictEqual(actualPosition.toString(), position.toString(), msg + ' - getPositionAt mismatch for offset ' + offset);\n\t\t} else {\n\t\t\t// The position coordinate system cannot express the position between \\r and \\n\n\t\t\tconst expectedOffset: number = offset + (previousIsCarriageReturn ? -1 : 0);\n\t\t\tconst actualOffset = model.getOffsetAt(position);\n\t\t\tassert.strictEqual(actualOffset, expectedOffset, msg + ' - getOffsetAt mismatch for position ' + position.toString());\n\t\t}\n\n\t\tif (allText.charAt(offset) === '\\n') {\n\t\t\tline++;\n\t\t\tcolumn = 1;\n\t\t} else {\n\t\t\tcolumn++;\n\t\t}\n\n\t\tpreviousIsCarriageReturn = (allText.charAt(offset) === '\\r');\n\t}\n}\n\nfunction assertLineMapping(model: TextModel, msg: string): void {\n\tassertOneDirectionLineMapping(model, AssertDocumentLineMappingDirection.PositionToOffset, msg);\n\tassertOneDirectionLineMapping(model, AssertDocumentLineMappingDirection.OffsetToPosition, msg);\n}\n\n\nexport function assertSyncedModels(text: string, callback: (model: TextModel, assertMirrorModels: () => void) => void, setup: ((model: TextModel) => void) | null = null): void {\n\tconst model = createTextModel(text);\n\tmodel.setEOL(EndOfLineSequence.LF);\n\tassertLineMapping(model, 'model');\n\n\tif (setup) {\n\t\tsetup(model);\n\t\tassertLineMapping(model, 'model');\n\t}\n\n\tconst mirrorModel2 = new MirrorTextModel(null!, model.getLinesContent(), model.getEOL(), model.getVersionId());\n\tlet mirrorModel2PrevVersionId = model.getVersionId();\n\n\tconst disposable = model.onDidChangeContent((e: IModelContentChangedEvent) => {\n\t\tconst versionId = e.versionId;\n\t\tif (versionId < mirrorModel2PrevVersionId) {\n\t\t\tconsole.warn('Model version id did not advance between edits (2)');\n\t\t}\n\t\tmirrorModel2PrevVersionId = versionId;\n\t\tmirrorModel2.onEvents(e);\n\t});\n\n\tconst assertMirrorModels = () => {\n\t\tassertLineMapping(model, 'model');\n\t\tassert.strictEqual(mirrorModel2.getText(), model.getValue(), 'mirror model 2 text OK');\n\t\tassert.strictEqual(mirrorModel2.version, model.getVersionId(), 'mirror model 2 version OK');\n\t};\n\n\tcallback(model, assertMirrorModels);\n\n\tdisposable.dispose();\n\tmodel.dispose();\n\tmirrorModel2.dispose();\n}\n"]}