{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/model/textModelWithTokens.test.ts","vs/editor/test/common/model/textModelWithTokens.test.ts"],"names":[],"mappings":"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AAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAE3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,eAAe,CAAC,KAAK,EAAE,IAAI,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,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","file":"textModelWithTokens.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IFoundBracket } from '../../../common/textModelBracketPairs.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { ITokenizationSupport, TokenizationRegistry, EncodedTokenizationResult } from '../../../common/languages.js';\nimport { StandardTokenType, MetadataConsts } from '../../../common/encodedTokenAttributes.js';\nimport { CharacterPair } from '../../../common/languages/languageConfiguration.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { NullState } from '../../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { TestLineToken } from '../core/testLineToken.js';\nimport { createModelServices, createTextModel, instantiateTextModel } from '../testTextModel.js';\nimport { TestInstantiationService } from '../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nfunction createTextModelWithBrackets(disposables: DisposableStore, text: string, brackets: CharacterPair[]): TextModel {\n\tconst languageId = 'bracketMode2';\n\tconst instantiationService = createModelServices(disposables);\n\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\tconst languageService = instantiationService.get(ILanguageService);\n\n\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\tdisposables.add(languageConfigurationService.register(languageId, { brackets }));\n\n\treturn disposables.add(instantiateTextModel(instantiationService, text, languageId));\n}\n\nsuite('TextModelWithTokens', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction testBrackets(contents: string[], brackets: CharacterPair[]): void {\n\t\tconst languageId = 'testMode';\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: brackets\n\t\t}));\n\n\n\t\tfunction toRelaxedFoundBracket(a: IFoundBracket | null) {\n\t\t\tif (!a) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trange: a.range.toString(),\n\t\t\t\tinfo: a.bracketInfo,\n\t\t\t};\n\t\t}\n\n\t\tconst charIsBracket: { [char: string]: boolean } = {};\n\t\tconst charIsOpenBracket: { [char: string]: boolean } = {};\n\t\tconst openForChar: { [char: string]: string } = {};\n\t\tconst closeForChar: { [char: string]: string } = {};\n\t\tbrackets.forEach((b) => {\n\t\t\tcharIsBracket[b[0]] = true;\n\t\t\tcharIsBracket[b[1]] = true;\n\n\t\t\tcharIsOpenBracket[b[0]] = true;\n\t\t\tcharIsOpenBracket[b[1]] = false;\n\n\t\t\topenForChar[b[0]] = b[0];\n\t\t\tcloseForChar[b[0]] = b[1];\n\n\t\t\topenForChar[b[1]] = b[0];\n\t\t\tcloseForChar[b[1]] = b[1];\n\t\t});\n\n\t\tconst expectedBrackets: IFoundBracket[] = [];\n\t\tfor (let lineIndex = 0; lineIndex < contents.length; lineIndex++) {\n\t\t\tconst lineText = contents[lineIndex];\n\n\t\t\tfor (let charIndex = 0; charIndex < lineText.length; charIndex++) {\n\t\t\t\tconst ch = lineText.charAt(charIndex);\n\t\t\t\tif (charIsBracket[ch]) {\n\t\t\t\t\texpectedBrackets.push({\n\t\t\t\t\t\tbracketInfo: languageConfigurationService.getLanguageConfiguration(languageId).bracketsNew.getBracketInfo(ch)!,\n\t\t\t\t\t\trange: new Range(lineIndex + 1, charIndex + 1, lineIndex + 1, charIndex + 2)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, contents.join('\\n'), languageId));\n\n\t\t// findPrevBracket\n\t\t{\n\t\t\tlet expectedBracketIndex = expectedBrackets.length - 1;\n\t\t\tlet currentExpectedBracket = expectedBracketIndex >= 0 ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\tfor (let lineNumber = contents.length; lineNumber >= 1; lineNumber--) {\n\t\t\t\tconst lineText = contents[lineNumber - 1];\n\n\t\t\t\tfor (let column = lineText.length + 1; column >= 1; column--) {\n\n\t\t\t\t\tif (currentExpectedBracket) {\n\t\t\t\t\t\tif (lineNumber === currentExpectedBracket.range.startLineNumber && column < currentExpectedBracket.range.endColumn) {\n\t\t\t\t\t\t\texpectedBracketIndex--;\n\t\t\t\t\t\t\tcurrentExpectedBracket = expectedBracketIndex >= 0 ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst actual = model.bracketPairs.findPrevBracket({\n\t\t\t\t\t\tlineNumber: lineNumber,\n\t\t\t\t\t\tcolumn: column\n\t\t\t\t\t});\n\n\t\t\t\t\tassert.deepStrictEqual(toRelaxedFoundBracket(actual), toRelaxedFoundBracket(currentExpectedBracket), 'findPrevBracket of ' + lineNumber + ', ' + column);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// findNextBracket\n\t\t{\n\t\t\tlet expectedBracketIndex = 0;\n\t\t\tlet currentExpectedBracket = expectedBracketIndex < expectedBrackets.length ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\tfor (let lineNumber = 1; lineNumber <= contents.length; lineNumber++) {\n\t\t\t\tconst lineText = contents[lineNumber - 1];\n\n\t\t\t\tfor (let column = 1; column <= lineText.length + 1; column++) {\n\n\t\t\t\t\tif (currentExpectedBracket) {\n\t\t\t\t\t\tif (lineNumber === currentExpectedBracket.range.startLineNumber && column > currentExpectedBracket.range.startColumn) {\n\t\t\t\t\t\t\texpectedBracketIndex++;\n\t\t\t\t\t\t\tcurrentExpectedBracket = expectedBracketIndex < expectedBrackets.length ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst actual = model.bracketPairs.findNextBracket({\n\t\t\t\t\t\tlineNumber: lineNumber,\n\t\t\t\t\t\tcolumn: column\n\t\t\t\t\t});\n\n\t\t\t\t\tassert.deepStrictEqual(toRelaxedFoundBracket(actual), toRelaxedFoundBracket(currentExpectedBracket), 'findNextBracket of ' + lineNumber + ', ' + column);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdisposables.dispose();\n\t}\n\n\ttest('brackets1', () => {\n\t\ttestBrackets([\n\t\t\t'if (a == 3) { return (7 * (a + 5)); }'\n\t\t], [\n\t\t\t['{', '}'],\n\t\t\t['[', ']'],\n\t\t\t['(', ')']\n\t\t]);\n\t});\n});\n\nfunction assertIsNotBracket(model: TextModel, lineNumber: number, column: number) {\n\tconst match = model.bracketPairs.matchBracket(new Position(lineNumber, column));\n\tassert.strictEqual(match, null, 'is not matching brackets at ' + lineNumber + ', ' + column);\n}\n\nfunction assertIsBracket(model: TextModel, testPosition: Position, expected: [Range, Range]): void {\n\texpected.sort(Range.compareRangesUsingStarts);\n\tconst actual = model.bracketPairs.matchBracket(testPosition);\n\tactual?.sort(Range.compareRangesUsingStarts);\n\tassert.deepStrictEqual(actual, expected, 'matches brackets at ' + testPosition);\n}\n\nsuite('TextModelWithTokens - bracket matching', () => {\n\n\tconst languageId = 'bracketMode1';\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageConfigurationService: ILanguageConfigurationService;\n\tlet languageService: ILanguageService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = createModelServices(disposables);\n\t\tlanguageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('bracket matching 1', () => {\n\t\tconst text =\n\t\t\t')]}{[(' + '\\n' +\n\t\t\t')]}{[(';\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\n\t\tassertIsNotBracket(model, 1, 1);\n\t\tassertIsNotBracket(model, 1, 2);\n\t\tassertIsNotBracket(model, 1, 3);\n\t\tassertIsBracket(model, new Position(1, 4), [new Range(1, 4, 1, 5), new Range(2, 3, 2, 4)]);\n\t\tassertIsBracket(model, new Position(1, 5), [new Range(1, 5, 1, 6), new Range(2, 2, 2, 3)]);\n\t\tassertIsBracket(model, new Position(1, 6), [new Range(1, 6, 1, 7), new Range(2, 1, 2, 2)]);\n\t\tassertIsBracket(model, new Position(1, 7), [new Range(1, 6, 1, 7), new Range(2, 1, 2, 2)]);\n\n\t\tassertIsBracket(model, new Position(2, 1), [new Range(2, 1, 2, 2), new Range(1, 6, 1, 7)]);\n\t\tassertIsBracket(model, new Position(2, 2), [new Range(2, 2, 2, 3), new Range(1, 5, 1, 6)]);\n\t\tassertIsBracket(model, new Position(2, 3), [new Range(2, 3, 2, 4), new Range(1, 4, 1, 5)]);\n\t\tassertIsBracket(model, new Position(2, 4), [new Range(2, 3, 2, 4), new Range(1, 4, 1, 5)]);\n\t\tassertIsNotBracket(model, 2, 5);\n\t\tassertIsNotBracket(model, 2, 6);\n\t\tassertIsNotBracket(model, 2, 7);\n\t});\n\n\ttest('bracket matching 2', () => {\n\t\tconst text =\n\t\t\t'var bar = {' + '\\n' +\n\t\t\t'foo: {' + '\\n' +\n\t\t\t'}, bar: {hallo: [{' + '\\n' +\n\t\t\t'}, {' + '\\n' +\n\t\t\t'}]}}';\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\n\t\tconst brackets: [Position, Range, Range][] = [\n\t\t\t[new Position(1, 11), new Range(1, 11, 1, 12), new Range(5, 4, 5, 5)],\n\t\t\t[new Position(1, 12), new Range(1, 11, 1, 12), new Range(5, 4, 5, 5)],\n\n\t\t\t[new Position(2, 6), new Range(2, 6, 2, 7), new Range(3, 1, 3, 2)],\n\t\t\t[new Position(2, 7), new Range(2, 6, 2, 7), new Range(3, 1, 3, 2)],\n\n\t\t\t[new Position(3, 1), new Range(3, 1, 3, 2), new Range(2, 6, 2, 7)],\n\t\t\t[new Position(3, 2), new Range(3, 1, 3, 2), new Range(2, 6, 2, 7)],\n\t\t\t[new Position(3, 9), new Range(3, 9, 3, 10), new Range(5, 3, 5, 4)],\n\t\t\t[new Position(3, 10), new Range(3, 9, 3, 10), new Range(5, 3, 5, 4)],\n\t\t\t[new Position(3, 17), new Range(3, 17, 3, 18), new Range(5, 2, 5, 3)],\n\t\t\t[new Position(3, 18), new Range(3, 18, 3, 19), new Range(4, 1, 4, 2)],\n\t\t\t[new Position(3, 19), new Range(3, 18, 3, 19), new Range(4, 1, 4, 2)],\n\n\t\t\t[new Position(4, 1), new Range(4, 1, 4, 2), new Range(3, 18, 3, 19)],\n\t\t\t[new Position(4, 2), new Range(4, 1, 4, 2), new Range(3, 18, 3, 19)],\n\t\t\t[new Position(4, 4), new Range(4, 4, 4, 5), new Range(5, 1, 5, 2)],\n\t\t\t[new Position(4, 5), new Range(4, 4, 4, 5), new Range(5, 1, 5, 2)],\n\n\t\t\t[new Position(5, 1), new Range(5, 1, 5, 2), new Range(4, 4, 4, 5)],\n\t\t\t[new Position(5, 2), new Range(5, 2, 5, 3), new Range(3, 17, 3, 18)],\n\t\t\t[new Position(5, 3), new Range(5, 3, 5, 4), new Range(3, 9, 3, 10)],\n\t\t\t[new Position(5, 4), new Range(5, 4, 5, 5), new Range(1, 11, 1, 12)],\n\t\t\t[new Position(5, 5), new Range(5, 4, 5, 5), new Range(1, 11, 1, 12)],\n\t\t];\n\n\t\tconst isABracket: { [lineNumber: number]: { [col: number]: boolean } } = { 1: {}, 2: {}, 3: {}, 4: {}, 5: {} };\n\t\tfor (let i = 0, len = brackets.length; i < len; i++) {\n\t\t\tconst [testPos, b1, b2] = brackets[i];\n\t\t\tassertIsBracket(model, testPos, [b1, b2]);\n\t\t\tisABracket[testPos.lineNumber][testPos.column] = true;\n\t\t}\n\n\t\tfor (let i = 1, len = model.getLineCount(); i <= len; i++) {\n\t\t\tconst line = model.getLineContent(i);\n\t\t\tfor (let j = 1, lenJ = line.length + 1; j <= lenJ; j++) {\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tif (!isABracket[i].hasOwnProperty(<any>j)) {\n\t\t\t\t\tassertIsNotBracket(model, i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n});\n\nsuite('TextModelWithTokens 2', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('bracket matching 3', () => {\n\t\tconst text = [\n\t\t\t'begin',\n\t\t\t'    loop',\n\t\t\t'        if then',\n\t\t\t'        end if;',\n\t\t\t'    end loop;',\n\t\t\t'end;',\n\t\t\t'',\n\t\t\t'begin',\n\t\t\t'    loop',\n\t\t\t'        if then',\n\t\t\t'        end ifa;',\n\t\t\t'    end loop;',\n\t\t\t'end;',\n\t\t].join('\\n');\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(disposables, text, [\n\t\t\t['if', 'end if'],\n\t\t\t['loop', 'end loop'],\n\t\t\t['begin', 'end']\n\t\t]);\n\n\t\t// <if> ... <end ifa> is not matched\n\t\tassertIsNotBracket(model, 10, 9);\n\n\t\t// <if> ... <end if> is matched\n\t\tassertIsBracket(model, new Position(3, 9), [new Range(3, 9, 3, 11), new Range(4, 9, 4, 15)]);\n\t\tassertIsBracket(model, new Position(4, 9), [new Range(4, 9, 4, 15), new Range(3, 9, 3, 11)]);\n\n\t\t// <loop> ... <end loop> is matched\n\t\tassertIsBracket(model, new Position(2, 5), [new Range(2, 5, 2, 9), new Range(5, 5, 5, 13)]);\n\t\tassertIsBracket(model, new Position(5, 5), [new Range(5, 5, 5, 13), new Range(2, 5, 2, 9)]);\n\n\t\t// <begin> ... <end> is matched\n\t\tassertIsBracket(model, new Position(1, 1), [new Range(1, 1, 1, 6), new Range(6, 1, 6, 4)]);\n\t\tassertIsBracket(model, new Position(6, 1), [new Range(6, 1, 6, 4), new Range(1, 1, 1, 6)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('bracket matching 4', () => {\n\t\tconst text = [\n\t\t\t'recordbegin',\n\t\t\t'  simplerecordbegin',\n\t\t\t'  endrecord',\n\t\t\t'endrecord',\n\t\t].join('\\n');\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(disposables, text, [\n\t\t\t['recordbegin', 'endrecord'],\n\t\t\t['simplerecordbegin', 'endrecord'],\n\t\t]);\n\n\t\t// <recordbegin> ... <endrecord> is matched\n\t\tassertIsBracket(model, new Position(1, 1), [new Range(1, 1, 1, 12), new Range(4, 1, 4, 10)]);\n\t\tassertIsBracket(model, new Position(4, 1), [new Range(4, 1, 4, 10), new Range(1, 1, 1, 12)]);\n\n\t\t// <simplerecordbegin> ... <endrecord> is matched\n\t\tassertIsBracket(model, new Position(2, 3), [new Range(2, 3, 2, 20), new Range(3, 3, 3, 12)]);\n\t\tassertIsBracket(model, new Position(3, 3), [new Range(3, 3, 3, 12), new Range(2, 3, 2, 20)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #95843: Highlighting of closing braces is indicating wrong brace when cursor is behind opening brace', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tconst mode1 = 'testMode1';\n\t\tconst mode2 = 'testMode2';\n\n\t\tconst languageIdCodec = languageService.languageIdCodec;\n\n\t\tdisposables.add(languageService.registerLanguage({ id: mode1 }));\n\t\tdisposables.add(languageService.registerLanguage({ id: mode2 }));\n\t\tconst encodedMode1 = languageIdCodec.encodeLanguageId(mode1);\n\t\tconst encodedMode2 = languageIdCodec.encodeLanguageId(mode2);\n\n\t\tconst otherMetadata1 = (\n\t\t\t(encodedMode1 << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t\t| (MetadataConsts.BALANCED_BRACKETS_MASK)\n\t\t) >>> 0;\n\t\tconst otherMetadata2 = (\n\t\t\t(encodedMode2 << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t\t| (MetadataConsts.BALANCED_BRACKETS_MASK)\n\t\t) >>> 0;\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tswitch (line) {\n\t\t\t\t\tcase 'function f() {': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1,\n\t\t\t\t\t\t\t8, otherMetadata1,\n\t\t\t\t\t\t\t9, otherMetadata1,\n\t\t\t\t\t\t\t10, otherMetadata1,\n\t\t\t\t\t\t\t11, otherMetadata1,\n\t\t\t\t\t\t\t12, otherMetadata1,\n\t\t\t\t\t\t\t13, otherMetadata1,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '  return <p>{true}</p>;': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1,\n\t\t\t\t\t\t\t2, otherMetadata1,\n\t\t\t\t\t\t\t8, otherMetadata1,\n\t\t\t\t\t\t\t9, otherMetadata2,\n\t\t\t\t\t\t\t10, otherMetadata2,\n\t\t\t\t\t\t\t11, otherMetadata2,\n\t\t\t\t\t\t\t12, otherMetadata2,\n\t\t\t\t\t\t\t13, otherMetadata1,\n\t\t\t\t\t\t\t17, otherMetadata2,\n\t\t\t\t\t\t\t18, otherMetadata2,\n\t\t\t\t\t\t\t20, otherMetadata2,\n\t\t\t\t\t\t\t21, otherMetadata2,\n\t\t\t\t\t\t\t22, otherMetadata2,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '}': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error(`Unexpected`);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(mode1, tokenizationSupport));\n\t\tdisposables.add(languageConfigurationService.register(mode1, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\t\tdisposables.add(languageConfigurationService.register(mode2, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(\n\t\t\tinstantiationService,\n\t\t\t[\n\t\t\t\t'function f() {',\n\t\t\t\t'  return <p>{true}</p>;',\n\t\t\t\t'}',\n\t\t\t].join('\\n'),\n\t\t\tmode1\n\t\t));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tmodel.tokenization.forceTokenization(2);\n\t\tmodel.tokenization.forceTokenization(3);\n\n\t\tassert.deepStrictEqual(\n\t\t\tmodel.bracketPairs.matchBracket(new Position(2, 14)),\n\t\t\t[new Range(2, 13, 2, 14), new Range(2, 18, 2, 19)]\n\t\t);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #88075: TypeScript brace matching is incorrect in `${}` strings', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst mode = 'testMode';\n\n\t\tconst languageIdCodec = instantiationService.get(ILanguageService).languageIdCodec;\n\n\t\tconst encodedMode = languageIdCodec.encodeLanguageId(mode);\n\n\t\tconst otherMetadata = (\n\t\t\t(encodedMode << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t) >>> 0;\n\t\tconst stringMetadata = (\n\t\t\t(encodedMode << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.String << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t) >>> 0;\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tswitch (line) {\n\t\t\t\t\tcase 'function hello() {': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '    console.log(`${100}`);': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata,\n\t\t\t\t\t\t\t16, stringMetadata,\n\t\t\t\t\t\t\t19, otherMetadata,\n\t\t\t\t\t\t\t22, stringMetadata,\n\t\t\t\t\t\t\t24, otherMetadata,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '}': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error(`Unexpected`);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(mode, tokenizationSupport));\n\t\tdisposables.add(languageConfigurationService.register(mode, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(\n\t\t\tinstantiationService,\n\t\t\t[\n\t\t\t\t'function hello() {',\n\t\t\t\t'    console.log(`${100}`);',\n\t\t\t\t'}'\n\t\t\t].join('\\n'),\n\t\t\tmode\n\t\t));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tmodel.tokenization.forceTokenization(2);\n\t\tmodel.tokenization.forceTokenization(3);\n\n\t\tassert.deepStrictEqual(model.bracketPairs.matchBracket(new Position(2, 23)), null);\n\t\tassert.deepStrictEqual(model.bracketPairs.matchBracket(new Position(2, 20)), null);\n\n\t\tdisposables.dispose();\n\t});\n});\n\n\nsuite('TextModelWithTokens regression tests', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('microsoft/monaco-editor#122: Unhandled Exception: TypeError: Unable to get property \\'replace\\' of undefined or null reference', () => {\n\t\tfunction assertViewLineTokens(model: TextModel, lineNumber: number, forceTokenization: boolean, expected: TestLineToken[]): void {\n\t\t\tif (forceTokenization) {\n\t\t\t\tmodel.tokenization.forceTokenization(lineNumber);\n\t\t\t}\n\t\t\tconst _actual = model.tokenization.getLineTokens(lineNumber).inflate();\n\t\t\tinterface ISimpleViewToken {\n\t\t\t\tendIndex: number;\n\t\t\t\tforeground: number;\n\t\t\t}\n\t\t\tconst actual: ISimpleViewToken[] = [];\n\t\t\tfor (let i = 0, len = _actual.getCount(); i < len; i++) {\n\t\t\t\tactual[i] = {\n\t\t\t\t\tendIndex: _actual.getEndOffset(i),\n\t\t\t\t\tforeground: _actual.getForeground(i)\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst decode = (token: TestLineToken) => {\n\t\t\t\treturn {\n\t\t\t\t\tendIndex: token.endIndex,\n\t\t\t\t\tforeground: token.getForeground()\n\t\t\t\t};\n\t\t\t};\n\t\t\tassert.deepStrictEqual(actual, expected.map(decode));\n\t\t}\n\n\t\tlet _tokenId = 10;\n\t\tconst LANG_ID1 = 'indicisiveMode1';\n\t\tconst LANG_ID2 = 'indicisiveMode2';\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tconst myId = ++_tokenId;\n\t\t\t\tconst tokens = new Uint32Array(2);\n\t\t\t\ttokens[0] = 0;\n\t\t\t\ttokens[1] = (\n\t\t\t\t\tmyId << MetadataConsts.FOREGROUND_OFFSET\n\t\t\t\t) >>> 0;\n\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t}\n\t\t};\n\n\t\tconst registration1 = TokenizationRegistry.register(LANG_ID1, tokenizationSupport);\n\t\tconst registration2 = TokenizationRegistry.register(LANG_ID2, tokenizationSupport);\n\n\t\tconst model = createTextModel('A model with\\ntwo lines');\n\n\t\tassertViewLineTokens(model, 1, true, [createViewLineToken(12, 1)]);\n\t\tassertViewLineTokens(model, 2, true, [createViewLineToken(9, 1)]);\n\n\t\tmodel.setLanguage(LANG_ID1);\n\n\t\tassertViewLineTokens(model, 1, true, [createViewLineToken(12, 11)]);\n\t\tassertViewLineTokens(model, 2, true, [createViewLineToken(9, 12)]);\n\n\t\tmodel.setLanguage(LANG_ID2);\n\n\t\tassertViewLineTokens(model, 1, false, [createViewLineToken(12, 1)]);\n\t\tassertViewLineTokens(model, 2, false, [createViewLineToken(9, 1)]);\n\n\t\tmodel.dispose();\n\t\tregistration1.dispose();\n\t\tregistration2.dispose();\n\n\t\tfunction createViewLineToken(endIndex: number, foreground: number): TestLineToken {\n\t\t\tconst metadata = (\n\t\t\t\t(foreground << MetadataConsts.FOREGROUND_OFFSET)\n\t\t\t) >>> 0;\n\t\t\treturn new TestLineToken(endIndex, metadata);\n\t\t}\n\t});\n\n\n\ttest('microsoft/monaco-editor#133: Error: Cannot read property \\'modeId\\' of undefined', () => {\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(\n\t\t\tdisposables,\n\t\t\t[\n\t\t\t\t'Imports System',\n\t\t\t\t'Imports System.Collections.Generic',\n\t\t\t\t'',\n\t\t\t\t'Module m1',\n\t\t\t\t'',\n\t\t\t\t'\\tSub Main()',\n\t\t\t\t'\\tEnd Sub',\n\t\t\t\t'',\n\t\t\t\t'End Module',\n\t\t\t].join('\\n'),\n\t\t\t[\n\t\t\t\t['module', 'end module'],\n\t\t\t\t['sub', 'end sub']\n\t\t\t]\n\t\t);\n\n\t\tconst actual = model.bracketPairs.matchBracket(new Position(4, 1));\n\t\tassert.deepStrictEqual(actual, [new Range(4, 1, 4, 7), new Range(9, 1, 9, 11)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #11856: Bracket matching does not work as expected if the opening brace symbol is contained in the closing brace symbol', () => {\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(\n\t\t\tdisposables,\n\t\t\t[\n\t\t\t\t'sequence \"outer\"',\n\t\t\t\t'     sequence \"inner\"',\n\t\t\t\t'     endsequence',\n\t\t\t\t'endsequence',\n\t\t\t].join('\\n'),\n\t\t\t[\n\t\t\t\t['sequence', 'endsequence'],\n\t\t\t\t['feature', 'endfeature']\n\t\t\t]\n\t\t);\n\n\t\tconst actual = model.bracketPairs.matchBracket(new Position(3, 9));\n\t\tassert.deepStrictEqual(actual, [new Range(2, 6, 2, 14), new Range(3, 6, 3, 17)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #63822: Wrong embedded language detected for empty lines', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\n\t\tconst outerMode = 'outerMode';\n\t\tconst innerMode = 'innerMode';\n\n\t\tdisposables.add(languageService.registerLanguage({ id: outerMode }));\n\t\tdisposables.add(languageService.registerLanguage({ id: innerMode }));\n\n\t\tconst languageIdCodec = instantiationService.get(ILanguageService).languageIdCodec;\n\t\tconst encodedInnerMode = languageIdCodec.encodeLanguageId(innerMode);\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tconst tokens = new Uint32Array(2);\n\t\t\t\ttokens[0] = 0;\n\t\t\t\ttokens[1] = (\n\t\t\t\t\tencodedInnerMode << MetadataConsts.LANGUAGEID_OFFSET\n\t\t\t\t) >>> 0;\n\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(outerMode, tokenizationSupport));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'A model with one line', outerMode));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tassert.strictEqual(model.getLanguageIdAtPosition(1, 1), innerMode);\n\n\t\tdisposables.dispose();\n\t});\n});\n\nsuite('TextModel.getLineIndentGuide', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertIndentGuides(lines: [number, number, number, number, string][], indentSize: number): void {\n\t\tconst languageId = 'testLang';\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\n\t\tconst text = lines.map(l => l[4]).join('\\n');\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\t\tmodel.updateOptions({ indentSize: indentSize });\n\n\t\tconst actualIndents = model.guides.getLinesIndentGuides(1, model.getLineCount());\n\n\t\tconst actual: [number, number, number, number, string][] = [];\n\t\tfor (let line = 1; line <= model.getLineCount(); line++) {\n\t\t\tconst activeIndentGuide = model.guides.getActiveIndentGuide(line, 1, model.getLineCount());\n\t\t\tactual[line - 1] = [actualIndents[line - 1], activeIndentGuide.startLineNumber, activeIndentGuide.endLineNumber, activeIndentGuide.indent, model.getLineContent(line)];\n\t\t}\n\n\t\tassert.deepStrictEqual(actual, lines);\n\n\t\tdisposables.dispose();\n\t}\n\n\ttest('getLineIndentGuide one level 2', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide two levels', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 5, 1, 'A'],\n\t\t\t[1, 2, 5, 1, '  A'],\n\t\t\t[1, 4, 5, 2, '  A'],\n\t\t\t[2, 4, 5, 2, '    A'],\n\t\t\t[2, 4, 5, 2, '    A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide three levels', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 3, 4, 2, '  A'],\n\t\t\t[2, 4, 4, 3, '    A'],\n\t\t\t[3, 4, 4, 3, '      A'],\n\t\t\t[0, 5, 5, 0, 'A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide decreasing indent', () => {\n\t\tassertIndentGuides([\n\t\t\t[2, 1, 1, 2, '    A'],\n\t\t\t[1, 1, 1, 2, '  A'],\n\t\t\t[0, 1, 2, 1, 'A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Java', () => {\n\t\tassertIndentGuides([\n\t\t\t/* 1*/[0, 2, 9, 1, 'class A {'],\n\t\t\t/* 2*/[1, 3, 4, 2, '  void foo() {'],\n\t\t\t/* 3*/[2, 3, 4, 2, '    console.log(1);'],\n\t\t\t/* 4*/[2, 3, 4, 2, '    console.log(2);'],\n\t\t\t/* 5*/[1, 3, 4, 2, '  }'],\n\t\t\t/* 6*/[1, 2, 9, 1, ''],\n\t\t\t/* 7*/[1, 8, 8, 2, '  void bar() {'],\n\t\t\t/* 8*/[2, 8, 8, 2, '    console.log(3);'],\n\t\t\t/* 9*/[1, 8, 8, 2, '  }'],\n\t\t\t/*10*/[0, 2, 9, 1, '}'],\n\t\t\t/*11*/[0, 12, 12, 1, 'interface B {'],\n\t\t\t/*12*/[1, 12, 12, 1, '  void bar();'],\n\t\t\t/*13*/[0, 12, 12, 1, '}'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Javadoc', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 3, 1, '/**'],\n\t\t\t[1, 2, 3, 1, ' * Comment'],\n\t\t\t[1, 2, 3, 1, ' */'],\n\t\t\t[0, 5, 6, 1, 'class A {'],\n\t\t\t[1, 5, 6, 1, '  void foo() {'],\n\t\t\t[1, 5, 6, 1, '  }'],\n\t\t\t[0, 5, 6, 1, '}'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Whitespace', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'class A {'],\n\t\t\t[1, 2, 7, 1, ''],\n\t\t\t[1, 4, 5, 2, '  void foo() {'],\n\t\t\t[2, 4, 5, 2, '    '],\n\t\t\t[2, 4, 5, 2, '    return 1;'],\n\t\t\t[1, 4, 5, 2, '  }'],\n\t\t\t[1, 2, 7, 1, '      '],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Tabs', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'class A {'],\n\t\t\t[1, 2, 7, 1, '\\t\\t'],\n\t\t\t[1, 4, 5, 2, '\\tvoid foo() {'],\n\t\t\t[2, 4, 5, 2, '\\t \\t//hello'],\n\t\t\t[2, 4, 5, 2, '\\t    return 2;'],\n\t\t\t[1, 4, 5, 2, '  \\t}'],\n\t\t\t[1, 2, 7, 1, '      '],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('getLineIndentGuide checker.ts', () => {\n\t\tassertIndentGuides([\n\t\t\t/* 1*/[0, 1, 1, 0, '/// <reference path=\"binder.ts\"/>'],\n\t\t\t/* 2*/[0, 2, 2, 0, ''],\n\t\t\t/* 3*/[0, 3, 3, 0, '/* @internal */'],\n\t\t\t/* 4*/[0, 5, 16, 1, 'namespace ts {'],\n\t\t\t/* 5*/[1, 5, 16, 1, '    let nextSymbolId = 1;'],\n\t\t\t/* 6*/[1, 5, 16, 1, '    let nextNodeId = 1;'],\n\t\t\t/* 7*/[1, 5, 16, 1, '    let nextMergeId = 1;'],\n\t\t\t/* 8*/[1, 5, 16, 1, '    let nextFlowId = 1;'],\n\t\t\t/* 9*/[1, 5, 16, 1, ''],\n\t\t\t/*10*/[1, 11, 15, 2, '    export function getNodeId(node: Node): number {'],\n\t\t\t/*11*/[2, 12, 13, 3, '        if (!node.id) {'],\n\t\t\t/*12*/[3, 12, 13, 3, '            node.id = nextNodeId;'],\n\t\t\t/*13*/[3, 12, 13, 3, '            nextNodeId++;'],\n\t\t\t/*14*/[2, 12, 13, 3, '        }'],\n\t\t\t/*15*/[2, 11, 15, 2, '        return node.id;'],\n\t\t\t/*16*/[1, 11, 15, 2, '    }'],\n\t\t\t/*17*/[0, 5, 16, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('issue #8425 - Missing indentation lines for first level indentation', () => {\n\t\tassertIndentGuides([\n\t\t\t[1, 2, 3, 2, '\\tindent1'],\n\t\t\t[2, 2, 3, 2, '\\t\\tindent2'],\n\t\t\t[2, 2, 3, 2, '\\t\\tindent2'],\n\t\t\t[1, 2, 3, 2, '\\tindent1']\n\t\t], 4);\n\t});\n\n\ttest('issue #8952 - Indentation guide lines going through text on .yml file', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 5, 1, 'properties:'],\n\t\t\t[1, 3, 5, 2, '    emailAddress:'],\n\t\t\t[2, 3, 5, 2, '        - bla'],\n\t\t\t[2, 5, 5, 3, '        - length:'],\n\t\t\t[3, 5, 5, 3, '            max: 255'],\n\t\t\t[0, 6, 6, 0, 'getters:']\n\t\t], 4);\n\t});\n\n\ttest('issue #11892 - Indent guides look funny', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'function test(base) {'],\n\t\t\t[1, 3, 6, 2, '\\tswitch (base) {'],\n\t\t\t[2, 4, 4, 3, '\\t\\tcase 1:'],\n\t\t\t[3, 4, 4, 3, '\\t\\t\\treturn 1;'],\n\t\t\t[2, 6, 6, 3, '\\t\\tcase 2:'],\n\t\t\t[3, 6, 6, 3, '\\t\\t\\treturn 2;'],\n\t\t\t[1, 2, 7, 1, '\\t}'],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('issue #12398 - Problem in indent guidelines', () => {\n\t\tassertIndentGuides([\n\t\t\t[2, 2, 2, 3, '\\t\\t.bla'],\n\t\t\t[3, 2, 2, 3, '\\t\\t\\tlabel(for)'],\n\t\t\t[0, 3, 3, 0, 'include script']\n\t\t], 4);\n\t});\n\n\ttest('issue #49173', () => {\n\t\tconst model = createTextModel([\n\t\t\t'class A {',\n\t\t\t'\tpublic m1(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m2(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m3(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m4(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m5(): void {',\n\t\t\t'\t}',\n\t\t\t'}',\n\t\t].join('\\n'));\n\n\t\tconst actual = model.guides.getActiveIndentGuide(2, 4, 9);\n\t\tassert.deepStrictEqual(actual, { startLineNumber: 2, endLineNumber: 9, indent: 1 });\n\t\tmodel.dispose();\n\t});\n\n\ttest('tweaks - no active', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 1, 1, 0, 'A'],\n\t\t\t[0, 2, 2, 0, 'A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - inside scope', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 2, 1, 'A'],\n\t\t\t[1, 2, 2, 1, '  A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - scope start', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 2, 1, 'A'],\n\t\t\t[1, 2, 2, 1, '  A'],\n\t\t\t[0, 2, 2, 1, 'A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - empty line', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, ''],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[0, 2, 4, 1, 'A']\n\t\t], 2);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IFoundBracket } from '../../../common/textModelBracketPairs.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { ITokenizationSupport, TokenizationRegistry, EncodedTokenizationResult } from '../../../common/languages.js';\nimport { StandardTokenType, MetadataConsts } from '../../../common/encodedTokenAttributes.js';\nimport { CharacterPair } from '../../../common/languages/languageConfiguration.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { NullState } from '../../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { TestLineToken } from '../core/testLineToken.js';\nimport { createModelServices, createTextModel, instantiateTextModel } from '../testTextModel.js';\nimport { TestInstantiationService } from '../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nfunction createTextModelWithBrackets(disposables: DisposableStore, text: string, brackets: CharacterPair[]): TextModel {\n\tconst languageId = 'bracketMode2';\n\tconst instantiationService = createModelServices(disposables);\n\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\tconst languageService = instantiationService.get(ILanguageService);\n\n\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\tdisposables.add(languageConfigurationService.register(languageId, { brackets }));\n\n\treturn disposables.add(instantiateTextModel(instantiationService, text, languageId));\n}\n\nsuite('TextModelWithTokens', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction testBrackets(contents: string[], brackets: CharacterPair[]): void {\n\t\tconst languageId = 'testMode';\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: brackets\n\t\t}));\n\n\n\t\tfunction toRelaxedFoundBracket(a: IFoundBracket | null) {\n\t\t\tif (!a) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trange: a.range.toString(),\n\t\t\t\tinfo: a.bracketInfo,\n\t\t\t};\n\t\t}\n\n\t\tconst charIsBracket: { [char: string]: boolean } = {};\n\t\tconst charIsOpenBracket: { [char: string]: boolean } = {};\n\t\tconst openForChar: { [char: string]: string } = {};\n\t\tconst closeForChar: { [char: string]: string } = {};\n\t\tbrackets.forEach((b) => {\n\t\t\tcharIsBracket[b[0]] = true;\n\t\t\tcharIsBracket[b[1]] = true;\n\n\t\t\tcharIsOpenBracket[b[0]] = true;\n\t\t\tcharIsOpenBracket[b[1]] = false;\n\n\t\t\topenForChar[b[0]] = b[0];\n\t\t\tcloseForChar[b[0]] = b[1];\n\n\t\t\topenForChar[b[1]] = b[0];\n\t\t\tcloseForChar[b[1]] = b[1];\n\t\t});\n\n\t\tconst expectedBrackets: IFoundBracket[] = [];\n\t\tfor (let lineIndex = 0; lineIndex < contents.length; lineIndex++) {\n\t\t\tconst lineText = contents[lineIndex];\n\n\t\t\tfor (let charIndex = 0; charIndex < lineText.length; charIndex++) {\n\t\t\t\tconst ch = lineText.charAt(charIndex);\n\t\t\t\tif (charIsBracket[ch]) {\n\t\t\t\t\texpectedBrackets.push({\n\t\t\t\t\t\tbracketInfo: languageConfigurationService.getLanguageConfiguration(languageId).bracketsNew.getBracketInfo(ch)!,\n\t\t\t\t\t\trange: new Range(lineIndex + 1, charIndex + 1, lineIndex + 1, charIndex + 2)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, contents.join('\\n'), languageId));\n\n\t\t// findPrevBracket\n\t\t{\n\t\t\tlet expectedBracketIndex = expectedBrackets.length - 1;\n\t\t\tlet currentExpectedBracket = expectedBracketIndex >= 0 ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\tfor (let lineNumber = contents.length; lineNumber >= 1; lineNumber--) {\n\t\t\t\tconst lineText = contents[lineNumber - 1];\n\n\t\t\t\tfor (let column = lineText.length + 1; column >= 1; column--) {\n\n\t\t\t\t\tif (currentExpectedBracket) {\n\t\t\t\t\t\tif (lineNumber === currentExpectedBracket.range.startLineNumber && column < currentExpectedBracket.range.endColumn) {\n\t\t\t\t\t\t\texpectedBracketIndex--;\n\t\t\t\t\t\t\tcurrentExpectedBracket = expectedBracketIndex >= 0 ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst actual = model.bracketPairs.findPrevBracket({\n\t\t\t\t\t\tlineNumber: lineNumber,\n\t\t\t\t\t\tcolumn: column\n\t\t\t\t\t});\n\n\t\t\t\t\tassert.deepStrictEqual(toRelaxedFoundBracket(actual), toRelaxedFoundBracket(currentExpectedBracket), 'findPrevBracket of ' + lineNumber + ', ' + column);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// findNextBracket\n\t\t{\n\t\t\tlet expectedBracketIndex = 0;\n\t\t\tlet currentExpectedBracket = expectedBracketIndex < expectedBrackets.length ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\tfor (let lineNumber = 1; lineNumber <= contents.length; lineNumber++) {\n\t\t\t\tconst lineText = contents[lineNumber - 1];\n\n\t\t\t\tfor (let column = 1; column <= lineText.length + 1; column++) {\n\n\t\t\t\t\tif (currentExpectedBracket) {\n\t\t\t\t\t\tif (lineNumber === currentExpectedBracket.range.startLineNumber && column > currentExpectedBracket.range.startColumn) {\n\t\t\t\t\t\t\texpectedBracketIndex++;\n\t\t\t\t\t\t\tcurrentExpectedBracket = expectedBracketIndex < expectedBrackets.length ? expectedBrackets[expectedBracketIndex] : null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst actual = model.bracketPairs.findNextBracket({\n\t\t\t\t\t\tlineNumber: lineNumber,\n\t\t\t\t\t\tcolumn: column\n\t\t\t\t\t});\n\n\t\t\t\t\tassert.deepStrictEqual(toRelaxedFoundBracket(actual), toRelaxedFoundBracket(currentExpectedBracket), 'findNextBracket of ' + lineNumber + ', ' + column);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdisposables.dispose();\n\t}\n\n\ttest('brackets1', () => {\n\t\ttestBrackets([\n\t\t\t'if (a == 3) { return (7 * (a + 5)); }'\n\t\t], [\n\t\t\t['{', '}'],\n\t\t\t['[', ']'],\n\t\t\t['(', ')']\n\t\t]);\n\t});\n});\n\nfunction assertIsNotBracket(model: TextModel, lineNumber: number, column: number) {\n\tconst match = model.bracketPairs.matchBracket(new Position(lineNumber, column));\n\tassert.strictEqual(match, null, 'is not matching brackets at ' + lineNumber + ', ' + column);\n}\n\nfunction assertIsBracket(model: TextModel, testPosition: Position, expected: [Range, Range]): void {\n\texpected.sort(Range.compareRangesUsingStarts);\n\tconst actual = model.bracketPairs.matchBracket(testPosition);\n\tactual?.sort(Range.compareRangesUsingStarts);\n\tassert.deepStrictEqual(actual, expected, 'matches brackets at ' + testPosition);\n}\n\nsuite('TextModelWithTokens - bracket matching', () => {\n\n\tconst languageId = 'bracketMode1';\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageConfigurationService: ILanguageConfigurationService;\n\tlet languageService: ILanguageService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = createModelServices(disposables);\n\t\tlanguageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('bracket matching 1', () => {\n\t\tconst text =\n\t\t\t')]}{[(' + '\\n' +\n\t\t\t')]}{[(';\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\n\t\tassertIsNotBracket(model, 1, 1);\n\t\tassertIsNotBracket(model, 1, 2);\n\t\tassertIsNotBracket(model, 1, 3);\n\t\tassertIsBracket(model, new Position(1, 4), [new Range(1, 4, 1, 5), new Range(2, 3, 2, 4)]);\n\t\tassertIsBracket(model, new Position(1, 5), [new Range(1, 5, 1, 6), new Range(2, 2, 2, 3)]);\n\t\tassertIsBracket(model, new Position(1, 6), [new Range(1, 6, 1, 7), new Range(2, 1, 2, 2)]);\n\t\tassertIsBracket(model, new Position(1, 7), [new Range(1, 6, 1, 7), new Range(2, 1, 2, 2)]);\n\n\t\tassertIsBracket(model, new Position(2, 1), [new Range(2, 1, 2, 2), new Range(1, 6, 1, 7)]);\n\t\tassertIsBracket(model, new Position(2, 2), [new Range(2, 2, 2, 3), new Range(1, 5, 1, 6)]);\n\t\tassertIsBracket(model, new Position(2, 3), [new Range(2, 3, 2, 4), new Range(1, 4, 1, 5)]);\n\t\tassertIsBracket(model, new Position(2, 4), [new Range(2, 3, 2, 4), new Range(1, 4, 1, 5)]);\n\t\tassertIsNotBracket(model, 2, 5);\n\t\tassertIsNotBracket(model, 2, 6);\n\t\tassertIsNotBracket(model, 2, 7);\n\t});\n\n\ttest('bracket matching 2', () => {\n\t\tconst text =\n\t\t\t'var bar = {' + '\\n' +\n\t\t\t'foo: {' + '\\n' +\n\t\t\t'}, bar: {hallo: [{' + '\\n' +\n\t\t\t'}, {' + '\\n' +\n\t\t\t'}]}}';\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\n\t\tconst brackets: [Position, Range, Range][] = [\n\t\t\t[new Position(1, 11), new Range(1, 11, 1, 12), new Range(5, 4, 5, 5)],\n\t\t\t[new Position(1, 12), new Range(1, 11, 1, 12), new Range(5, 4, 5, 5)],\n\n\t\t\t[new Position(2, 6), new Range(2, 6, 2, 7), new Range(3, 1, 3, 2)],\n\t\t\t[new Position(2, 7), new Range(2, 6, 2, 7), new Range(3, 1, 3, 2)],\n\n\t\t\t[new Position(3, 1), new Range(3, 1, 3, 2), new Range(2, 6, 2, 7)],\n\t\t\t[new Position(3, 2), new Range(3, 1, 3, 2), new Range(2, 6, 2, 7)],\n\t\t\t[new Position(3, 9), new Range(3, 9, 3, 10), new Range(5, 3, 5, 4)],\n\t\t\t[new Position(3, 10), new Range(3, 9, 3, 10), new Range(5, 3, 5, 4)],\n\t\t\t[new Position(3, 17), new Range(3, 17, 3, 18), new Range(5, 2, 5, 3)],\n\t\t\t[new Position(3, 18), new Range(3, 18, 3, 19), new Range(4, 1, 4, 2)],\n\t\t\t[new Position(3, 19), new Range(3, 18, 3, 19), new Range(4, 1, 4, 2)],\n\n\t\t\t[new Position(4, 1), new Range(4, 1, 4, 2), new Range(3, 18, 3, 19)],\n\t\t\t[new Position(4, 2), new Range(4, 1, 4, 2), new Range(3, 18, 3, 19)],\n\t\t\t[new Position(4, 4), new Range(4, 4, 4, 5), new Range(5, 1, 5, 2)],\n\t\t\t[new Position(4, 5), new Range(4, 4, 4, 5), new Range(5, 1, 5, 2)],\n\n\t\t\t[new Position(5, 1), new Range(5, 1, 5, 2), new Range(4, 4, 4, 5)],\n\t\t\t[new Position(5, 2), new Range(5, 2, 5, 3), new Range(3, 17, 3, 18)],\n\t\t\t[new Position(5, 3), new Range(5, 3, 5, 4), new Range(3, 9, 3, 10)],\n\t\t\t[new Position(5, 4), new Range(5, 4, 5, 5), new Range(1, 11, 1, 12)],\n\t\t\t[new Position(5, 5), new Range(5, 4, 5, 5), new Range(1, 11, 1, 12)],\n\t\t];\n\n\t\tconst isABracket: { [lineNumber: number]: { [col: number]: boolean } } = { 1: {}, 2: {}, 3: {}, 4: {}, 5: {} };\n\t\tfor (let i = 0, len = brackets.length; i < len; i++) {\n\t\t\tconst [testPos, b1, b2] = brackets[i];\n\t\t\tassertIsBracket(model, testPos, [b1, b2]);\n\t\t\tisABracket[testPos.lineNumber][testPos.column] = true;\n\t\t}\n\n\t\tfor (let i = 1, len = model.getLineCount(); i <= len; i++) {\n\t\t\tconst line = model.getLineContent(i);\n\t\t\tfor (let j = 1, lenJ = line.length + 1; j <= lenJ; j++) {\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tif (!isABracket[i].hasOwnProperty(<any>j)) {\n\t\t\t\t\tassertIsNotBracket(model, i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n});\n\nsuite('TextModelWithTokens 2', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('bracket matching 3', () => {\n\t\tconst text = [\n\t\t\t'begin',\n\t\t\t'    loop',\n\t\t\t'        if then',\n\t\t\t'        end if;',\n\t\t\t'    end loop;',\n\t\t\t'end;',\n\t\t\t'',\n\t\t\t'begin',\n\t\t\t'    loop',\n\t\t\t'        if then',\n\t\t\t'        end ifa;',\n\t\t\t'    end loop;',\n\t\t\t'end;',\n\t\t].join('\\n');\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(disposables, text, [\n\t\t\t['if', 'end if'],\n\t\t\t['loop', 'end loop'],\n\t\t\t['begin', 'end']\n\t\t]);\n\n\t\t// <if> ... <end ifa> is not matched\n\t\tassertIsNotBracket(model, 10, 9);\n\n\t\t// <if> ... <end if> is matched\n\t\tassertIsBracket(model, new Position(3, 9), [new Range(3, 9, 3, 11), new Range(4, 9, 4, 15)]);\n\t\tassertIsBracket(model, new Position(4, 9), [new Range(4, 9, 4, 15), new Range(3, 9, 3, 11)]);\n\n\t\t// <loop> ... <end loop> is matched\n\t\tassertIsBracket(model, new Position(2, 5), [new Range(2, 5, 2, 9), new Range(5, 5, 5, 13)]);\n\t\tassertIsBracket(model, new Position(5, 5), [new Range(5, 5, 5, 13), new Range(2, 5, 2, 9)]);\n\n\t\t// <begin> ... <end> is matched\n\t\tassertIsBracket(model, new Position(1, 1), [new Range(1, 1, 1, 6), new Range(6, 1, 6, 4)]);\n\t\tassertIsBracket(model, new Position(6, 1), [new Range(6, 1, 6, 4), new Range(1, 1, 1, 6)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('bracket matching 4', () => {\n\t\tconst text = [\n\t\t\t'recordbegin',\n\t\t\t'  simplerecordbegin',\n\t\t\t'  endrecord',\n\t\t\t'endrecord',\n\t\t].join('\\n');\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(disposables, text, [\n\t\t\t['recordbegin', 'endrecord'],\n\t\t\t['simplerecordbegin', 'endrecord'],\n\t\t]);\n\n\t\t// <recordbegin> ... <endrecord> is matched\n\t\tassertIsBracket(model, new Position(1, 1), [new Range(1, 1, 1, 12), new Range(4, 1, 4, 10)]);\n\t\tassertIsBracket(model, new Position(4, 1), [new Range(4, 1, 4, 10), new Range(1, 1, 1, 12)]);\n\n\t\t// <simplerecordbegin> ... <endrecord> is matched\n\t\tassertIsBracket(model, new Position(2, 3), [new Range(2, 3, 2, 20), new Range(3, 3, 3, 12)]);\n\t\tassertIsBracket(model, new Position(3, 3), [new Range(3, 3, 3, 12), new Range(2, 3, 2, 20)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #95843: Highlighting of closing braces is indicating wrong brace when cursor is behind opening brace', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tconst mode1 = 'testMode1';\n\t\tconst mode2 = 'testMode2';\n\n\t\tconst languageIdCodec = languageService.languageIdCodec;\n\n\t\tdisposables.add(languageService.registerLanguage({ id: mode1 }));\n\t\tdisposables.add(languageService.registerLanguage({ id: mode2 }));\n\t\tconst encodedMode1 = languageIdCodec.encodeLanguageId(mode1);\n\t\tconst encodedMode2 = languageIdCodec.encodeLanguageId(mode2);\n\n\t\tconst otherMetadata1 = (\n\t\t\t(encodedMode1 << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t\t| (MetadataConsts.BALANCED_BRACKETS_MASK)\n\t\t) >>> 0;\n\t\tconst otherMetadata2 = (\n\t\t\t(encodedMode2 << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t\t| (MetadataConsts.BALANCED_BRACKETS_MASK)\n\t\t) >>> 0;\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tswitch (line) {\n\t\t\t\t\tcase 'function f() {': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1,\n\t\t\t\t\t\t\t8, otherMetadata1,\n\t\t\t\t\t\t\t9, otherMetadata1,\n\t\t\t\t\t\t\t10, otherMetadata1,\n\t\t\t\t\t\t\t11, otherMetadata1,\n\t\t\t\t\t\t\t12, otherMetadata1,\n\t\t\t\t\t\t\t13, otherMetadata1,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '  return <p>{true}</p>;': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1,\n\t\t\t\t\t\t\t2, otherMetadata1,\n\t\t\t\t\t\t\t8, otherMetadata1,\n\t\t\t\t\t\t\t9, otherMetadata2,\n\t\t\t\t\t\t\t10, otherMetadata2,\n\t\t\t\t\t\t\t11, otherMetadata2,\n\t\t\t\t\t\t\t12, otherMetadata2,\n\t\t\t\t\t\t\t13, otherMetadata1,\n\t\t\t\t\t\t\t17, otherMetadata2,\n\t\t\t\t\t\t\t18, otherMetadata2,\n\t\t\t\t\t\t\t20, otherMetadata2,\n\t\t\t\t\t\t\t21, otherMetadata2,\n\t\t\t\t\t\t\t22, otherMetadata2,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '}': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata1\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error(`Unexpected`);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(mode1, tokenizationSupport));\n\t\tdisposables.add(languageConfigurationService.register(mode1, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\t\tdisposables.add(languageConfigurationService.register(mode2, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(\n\t\t\tinstantiationService,\n\t\t\t[\n\t\t\t\t'function f() {',\n\t\t\t\t'  return <p>{true}</p>;',\n\t\t\t\t'}',\n\t\t\t].join('\\n'),\n\t\t\tmode1\n\t\t));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tmodel.tokenization.forceTokenization(2);\n\t\tmodel.tokenization.forceTokenization(3);\n\n\t\tassert.deepStrictEqual(\n\t\t\tmodel.bracketPairs.matchBracket(new Position(2, 14)),\n\t\t\t[new Range(2, 13, 2, 14), new Range(2, 18, 2, 19)]\n\t\t);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #88075: TypeScript brace matching is incorrect in `${}` strings', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst mode = 'testMode';\n\n\t\tconst languageIdCodec = instantiationService.get(ILanguageService).languageIdCodec;\n\n\t\tconst encodedMode = languageIdCodec.encodeLanguageId(mode);\n\n\t\tconst otherMetadata = (\n\t\t\t(encodedMode << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.Other << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t) >>> 0;\n\t\tconst stringMetadata = (\n\t\t\t(encodedMode << MetadataConsts.LANGUAGEID_OFFSET)\n\t\t\t| (StandardTokenType.String << MetadataConsts.TOKEN_TYPE_OFFSET)\n\t\t) >>> 0;\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tswitch (line) {\n\t\t\t\t\tcase 'function hello() {': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '    console.log(`${100}`);': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata,\n\t\t\t\t\t\t\t16, stringMetadata,\n\t\t\t\t\t\t\t19, otherMetadata,\n\t\t\t\t\t\t\t22, stringMetadata,\n\t\t\t\t\t\t\t24, otherMetadata,\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t\tcase '}': {\n\t\t\t\t\t\tconst tokens = new Uint32Array([\n\t\t\t\t\t\t\t0, otherMetadata\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error(`Unexpected`);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(mode, tokenizationSupport));\n\t\tdisposables.add(languageConfigurationService.register(mode, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')']\n\t\t\t],\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(\n\t\t\tinstantiationService,\n\t\t\t[\n\t\t\t\t'function hello() {',\n\t\t\t\t'    console.log(`${100}`);',\n\t\t\t\t'}'\n\t\t\t].join('\\n'),\n\t\t\tmode\n\t\t));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tmodel.tokenization.forceTokenization(2);\n\t\tmodel.tokenization.forceTokenization(3);\n\n\t\tassert.deepStrictEqual(model.bracketPairs.matchBracket(new Position(2, 23)), null);\n\t\tassert.deepStrictEqual(model.bracketPairs.matchBracket(new Position(2, 20)), null);\n\n\t\tdisposables.dispose();\n\t});\n});\n\n\nsuite('TextModelWithTokens regression tests', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('microsoft/monaco-editor#122: Unhandled Exception: TypeError: Unable to get property \\'replace\\' of undefined or null reference', () => {\n\t\tfunction assertViewLineTokens(model: TextModel, lineNumber: number, forceTokenization: boolean, expected: TestLineToken[]): void {\n\t\t\tif (forceTokenization) {\n\t\t\t\tmodel.tokenization.forceTokenization(lineNumber);\n\t\t\t}\n\t\t\tconst _actual = model.tokenization.getLineTokens(lineNumber).inflate();\n\t\t\tinterface ISimpleViewToken {\n\t\t\t\tendIndex: number;\n\t\t\t\tforeground: number;\n\t\t\t}\n\t\t\tconst actual: ISimpleViewToken[] = [];\n\t\t\tfor (let i = 0, len = _actual.getCount(); i < len; i++) {\n\t\t\t\tactual[i] = {\n\t\t\t\t\tendIndex: _actual.getEndOffset(i),\n\t\t\t\t\tforeground: _actual.getForeground(i)\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst decode = (token: TestLineToken) => {\n\t\t\t\treturn {\n\t\t\t\t\tendIndex: token.endIndex,\n\t\t\t\t\tforeground: token.getForeground()\n\t\t\t\t};\n\t\t\t};\n\t\t\tassert.deepStrictEqual(actual, expected.map(decode));\n\t\t}\n\n\t\tlet _tokenId = 10;\n\t\tconst LANG_ID1 = 'indicisiveMode1';\n\t\tconst LANG_ID2 = 'indicisiveMode2';\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tconst myId = ++_tokenId;\n\t\t\t\tconst tokens = new Uint32Array(2);\n\t\t\t\ttokens[0] = 0;\n\t\t\t\ttokens[1] = (\n\t\t\t\t\tmyId << MetadataConsts.FOREGROUND_OFFSET\n\t\t\t\t) >>> 0;\n\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t}\n\t\t};\n\n\t\tconst registration1 = TokenizationRegistry.register(LANG_ID1, tokenizationSupport);\n\t\tconst registration2 = TokenizationRegistry.register(LANG_ID2, tokenizationSupport);\n\n\t\tconst model = createTextModel('A model with\\ntwo lines');\n\n\t\tassertViewLineTokens(model, 1, true, [createViewLineToken(12, 1)]);\n\t\tassertViewLineTokens(model, 2, true, [createViewLineToken(9, 1)]);\n\n\t\tmodel.setLanguage(LANG_ID1);\n\n\t\tassertViewLineTokens(model, 1, true, [createViewLineToken(12, 11)]);\n\t\tassertViewLineTokens(model, 2, true, [createViewLineToken(9, 12)]);\n\n\t\tmodel.setLanguage(LANG_ID2);\n\n\t\tassertViewLineTokens(model, 1, false, [createViewLineToken(12, 1)]);\n\t\tassertViewLineTokens(model, 2, false, [createViewLineToken(9, 1)]);\n\n\t\tmodel.dispose();\n\t\tregistration1.dispose();\n\t\tregistration2.dispose();\n\n\t\tfunction createViewLineToken(endIndex: number, foreground: number): TestLineToken {\n\t\t\tconst metadata = (\n\t\t\t\t(foreground << MetadataConsts.FOREGROUND_OFFSET)\n\t\t\t) >>> 0;\n\t\t\treturn new TestLineToken(endIndex, metadata);\n\t\t}\n\t});\n\n\n\ttest('microsoft/monaco-editor#133: Error: Cannot read property \\'modeId\\' of undefined', () => {\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(\n\t\t\tdisposables,\n\t\t\t[\n\t\t\t\t'Imports System',\n\t\t\t\t'Imports System.Collections.Generic',\n\t\t\t\t'',\n\t\t\t\t'Module m1',\n\t\t\t\t'',\n\t\t\t\t'\\tSub Main()',\n\t\t\t\t'\\tEnd Sub',\n\t\t\t\t'',\n\t\t\t\t'End Module',\n\t\t\t].join('\\n'),\n\t\t\t[\n\t\t\t\t['module', 'end module'],\n\t\t\t\t['sub', 'end sub']\n\t\t\t]\n\t\t);\n\n\t\tconst actual = model.bracketPairs.matchBracket(new Position(4, 1));\n\t\tassert.deepStrictEqual(actual, [new Range(4, 1, 4, 7), new Range(9, 1, 9, 11)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #11856: Bracket matching does not work as expected if the opening brace symbol is contained in the closing brace symbol', () => {\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst model = createTextModelWithBrackets(\n\t\t\tdisposables,\n\t\t\t[\n\t\t\t\t'sequence \"outer\"',\n\t\t\t\t'     sequence \"inner\"',\n\t\t\t\t'     endsequence',\n\t\t\t\t'endsequence',\n\t\t\t].join('\\n'),\n\t\t\t[\n\t\t\t\t['sequence', 'endsequence'],\n\t\t\t\t['feature', 'endfeature']\n\t\t\t]\n\t\t);\n\n\t\tconst actual = model.bracketPairs.matchBracket(new Position(3, 9));\n\t\tassert.deepStrictEqual(actual, [new Range(2, 6, 2, 14), new Range(3, 6, 3, 17)]);\n\n\t\tdisposables.dispose();\n\t});\n\n\ttest('issue #63822: Wrong embedded language detected for empty lines', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\n\t\tconst outerMode = 'outerMode';\n\t\tconst innerMode = 'innerMode';\n\n\t\tdisposables.add(languageService.registerLanguage({ id: outerMode }));\n\t\tdisposables.add(languageService.registerLanguage({ id: innerMode }));\n\n\t\tconst languageIdCodec = instantiationService.get(ILanguageService).languageIdCodec;\n\t\tconst encodedInnerMode = languageIdCodec.encodeLanguageId(innerMode);\n\n\t\tconst tokenizationSupport: ITokenizationSupport = {\n\t\t\tgetInitialState: () => NullState,\n\t\t\ttokenize: undefined!,\n\t\t\ttokenizeEncoded: (line, hasEOL, state) => {\n\t\t\t\tconst tokens = new Uint32Array(2);\n\t\t\t\ttokens[0] = 0;\n\t\t\t\ttokens[1] = (\n\t\t\t\t\tencodedInnerMode << MetadataConsts.LANGUAGEID_OFFSET\n\t\t\t\t) >>> 0;\n\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(TokenizationRegistry.register(outerMode, tokenizationSupport));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'A model with one line', outerMode));\n\n\t\tmodel.tokenization.forceTokenization(1);\n\t\tassert.strictEqual(model.getLanguageIdAtPosition(1, 1), innerMode);\n\n\t\tdisposables.dispose();\n\t});\n});\n\nsuite('TextModel.getLineIndentGuide', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertIndentGuides(lines: [number, number, number, number, string][], indentSize: number): void {\n\t\tconst languageId = 'testLang';\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\n\t\tconst text = lines.map(l => l[4]).join('\\n');\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, text, languageId));\n\t\tmodel.updateOptions({ indentSize: indentSize });\n\n\t\tconst actualIndents = model.guides.getLinesIndentGuides(1, model.getLineCount());\n\n\t\tconst actual: [number, number, number, number, string][] = [];\n\t\tfor (let line = 1; line <= model.getLineCount(); line++) {\n\t\t\tconst activeIndentGuide = model.guides.getActiveIndentGuide(line, 1, model.getLineCount());\n\t\t\tactual[line - 1] = [actualIndents[line - 1], activeIndentGuide.startLineNumber, activeIndentGuide.endLineNumber, activeIndentGuide.indent, model.getLineContent(line)];\n\t\t}\n\n\t\tassert.deepStrictEqual(actual, lines);\n\n\t\tdisposables.dispose();\n\t}\n\n\ttest('getLineIndentGuide one level 2', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide two levels', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 5, 1, 'A'],\n\t\t\t[1, 2, 5, 1, '  A'],\n\t\t\t[1, 4, 5, 2, '  A'],\n\t\t\t[2, 4, 5, 2, '    A'],\n\t\t\t[2, 4, 5, 2, '    A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide three levels', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 3, 4, 2, '  A'],\n\t\t\t[2, 4, 4, 3, '    A'],\n\t\t\t[3, 4, 4, 3, '      A'],\n\t\t\t[0, 5, 5, 0, 'A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide decreasing indent', () => {\n\t\tassertIndentGuides([\n\t\t\t[2, 1, 1, 2, '    A'],\n\t\t\t[1, 1, 1, 2, '  A'],\n\t\t\t[0, 1, 2, 1, 'A'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Java', () => {\n\t\tassertIndentGuides([\n\t\t\t/* 1*/[0, 2, 9, 1, 'class A {'],\n\t\t\t/* 2*/[1, 3, 4, 2, '  void foo() {'],\n\t\t\t/* 3*/[2, 3, 4, 2, '    console.log(1);'],\n\t\t\t/* 4*/[2, 3, 4, 2, '    console.log(2);'],\n\t\t\t/* 5*/[1, 3, 4, 2, '  }'],\n\t\t\t/* 6*/[1, 2, 9, 1, ''],\n\t\t\t/* 7*/[1, 8, 8, 2, '  void bar() {'],\n\t\t\t/* 8*/[2, 8, 8, 2, '    console.log(3);'],\n\t\t\t/* 9*/[1, 8, 8, 2, '  }'],\n\t\t\t/*10*/[0, 2, 9, 1, '}'],\n\t\t\t/*11*/[0, 12, 12, 1, 'interface B {'],\n\t\t\t/*12*/[1, 12, 12, 1, '  void bar();'],\n\t\t\t/*13*/[0, 12, 12, 1, '}'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Javadoc', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 3, 1, '/**'],\n\t\t\t[1, 2, 3, 1, ' * Comment'],\n\t\t\t[1, 2, 3, 1, ' */'],\n\t\t\t[0, 5, 6, 1, 'class A {'],\n\t\t\t[1, 5, 6, 1, '  void foo() {'],\n\t\t\t[1, 5, 6, 1, '  }'],\n\t\t\t[0, 5, 6, 1, '}'],\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Whitespace', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'class A {'],\n\t\t\t[1, 2, 7, 1, ''],\n\t\t\t[1, 4, 5, 2, '  void foo() {'],\n\t\t\t[2, 4, 5, 2, '    '],\n\t\t\t[2, 4, 5, 2, '    return 1;'],\n\t\t\t[1, 4, 5, 2, '  }'],\n\t\t\t[1, 2, 7, 1, '      '],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 2);\n\t});\n\n\ttest('getLineIndentGuide Tabs', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'class A {'],\n\t\t\t[1, 2, 7, 1, '\\t\\t'],\n\t\t\t[1, 4, 5, 2, '\\tvoid foo() {'],\n\t\t\t[2, 4, 5, 2, '\\t \\t//hello'],\n\t\t\t[2, 4, 5, 2, '\\t    return 2;'],\n\t\t\t[1, 4, 5, 2, '  \\t}'],\n\t\t\t[1, 2, 7, 1, '      '],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('getLineIndentGuide checker.ts', () => {\n\t\tassertIndentGuides([\n\t\t\t/* 1*/[0, 1, 1, 0, '/// <reference path=\"binder.ts\"/>'],\n\t\t\t/* 2*/[0, 2, 2, 0, ''],\n\t\t\t/* 3*/[0, 3, 3, 0, '/* @internal */'],\n\t\t\t/* 4*/[0, 5, 16, 1, 'namespace ts {'],\n\t\t\t/* 5*/[1, 5, 16, 1, '    let nextSymbolId = 1;'],\n\t\t\t/* 6*/[1, 5, 16, 1, '    let nextNodeId = 1;'],\n\t\t\t/* 7*/[1, 5, 16, 1, '    let nextMergeId = 1;'],\n\t\t\t/* 8*/[1, 5, 16, 1, '    let nextFlowId = 1;'],\n\t\t\t/* 9*/[1, 5, 16, 1, ''],\n\t\t\t/*10*/[1, 11, 15, 2, '    export function getNodeId(node: Node): number {'],\n\t\t\t/*11*/[2, 12, 13, 3, '        if (!node.id) {'],\n\t\t\t/*12*/[3, 12, 13, 3, '            node.id = nextNodeId;'],\n\t\t\t/*13*/[3, 12, 13, 3, '            nextNodeId++;'],\n\t\t\t/*14*/[2, 12, 13, 3, '        }'],\n\t\t\t/*15*/[2, 11, 15, 2, '        return node.id;'],\n\t\t\t/*16*/[1, 11, 15, 2, '    }'],\n\t\t\t/*17*/[0, 5, 16, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('issue #8425 - Missing indentation lines for first level indentation', () => {\n\t\tassertIndentGuides([\n\t\t\t[1, 2, 3, 2, '\\tindent1'],\n\t\t\t[2, 2, 3, 2, '\\t\\tindent2'],\n\t\t\t[2, 2, 3, 2, '\\t\\tindent2'],\n\t\t\t[1, 2, 3, 2, '\\tindent1']\n\t\t], 4);\n\t});\n\n\ttest('issue #8952 - Indentation guide lines going through text on .yml file', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 5, 1, 'properties:'],\n\t\t\t[1, 3, 5, 2, '    emailAddress:'],\n\t\t\t[2, 3, 5, 2, '        - bla'],\n\t\t\t[2, 5, 5, 3, '        - length:'],\n\t\t\t[3, 5, 5, 3, '            max: 255'],\n\t\t\t[0, 6, 6, 0, 'getters:']\n\t\t], 4);\n\t});\n\n\ttest('issue #11892 - Indent guides look funny', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 7, 1, 'function test(base) {'],\n\t\t\t[1, 3, 6, 2, '\\tswitch (base) {'],\n\t\t\t[2, 4, 4, 3, '\\t\\tcase 1:'],\n\t\t\t[3, 4, 4, 3, '\\t\\t\\treturn 1;'],\n\t\t\t[2, 6, 6, 3, '\\t\\tcase 2:'],\n\t\t\t[3, 6, 6, 3, '\\t\\t\\treturn 2;'],\n\t\t\t[1, 2, 7, 1, '\\t}'],\n\t\t\t[0, 2, 7, 1, '}']\n\t\t], 4);\n\t});\n\n\ttest('issue #12398 - Problem in indent guidelines', () => {\n\t\tassertIndentGuides([\n\t\t\t[2, 2, 2, 3, '\\t\\t.bla'],\n\t\t\t[3, 2, 2, 3, '\\t\\t\\tlabel(for)'],\n\t\t\t[0, 3, 3, 0, 'include script']\n\t\t], 4);\n\t});\n\n\ttest('issue #49173', () => {\n\t\tconst model = createTextModel([\n\t\t\t'class A {',\n\t\t\t'\tpublic m1(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m2(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m3(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m4(): void {',\n\t\t\t'\t}',\n\t\t\t'\tpublic m5(): void {',\n\t\t\t'\t}',\n\t\t\t'}',\n\t\t].join('\\n'));\n\n\t\tconst actual = model.guides.getActiveIndentGuide(2, 4, 9);\n\t\tassert.deepStrictEqual(actual, { startLineNumber: 2, endLineNumber: 9, indent: 1 });\n\t\tmodel.dispose();\n\t});\n\n\ttest('tweaks - no active', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 1, 1, 0, 'A'],\n\t\t\t[0, 2, 2, 0, 'A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - inside scope', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 2, 1, 'A'],\n\t\t\t[1, 2, 2, 1, '  A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - scope start', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 2, 1, 'A'],\n\t\t\t[1, 2, 2, 1, '  A'],\n\t\t\t[0, 2, 2, 1, 'A']\n\t\t], 2);\n\t});\n\n\ttest('tweaks - empty line', () => {\n\t\tassertIndentGuides([\n\t\t\t[0, 2, 4, 1, 'A'],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[1, 2, 4, 1, ''],\n\t\t\t[1, 2, 4, 1, '  A'],\n\t\t\t[0, 2, 4, 1, 'A']\n\t\t], 2);\n\t});\n});\n"]}