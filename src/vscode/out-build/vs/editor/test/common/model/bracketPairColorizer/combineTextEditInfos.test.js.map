{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/model/bracketPairColorizer/combineTextEditInfos.test.ts","vs/editor/test/common/model/bracketPairColorizer/combineTextEditInfos.test.ts"],"names":[],"mappings":"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","file":"combineTextEditInfos.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { TextReplacement } from '../../../../common/core/edits/textEdit.js';\nimport { TextEditInfo } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper.js';\nimport { combineTextEditInfos } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/combineTextEditInfos.js';\nimport { lengthAdd, lengthToObj, lengthToPosition, positionToLength, toLength } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/length.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { Random } from '../../core/random.js';\nimport { createTextModel } from '../../testTextModel.js';\n\nsuite('combineTextEditInfos', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfor (let seed = 0; seed < 50; seed++) {\n\t\ttest('test' + seed, () => {\n\t\t\trunTest(seed);\n\t\t});\n\t}\n});\n\nfunction runTest(seed: number) {\n\tconst rng = Random.create(seed);\n\n\tconst str = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\tconst textModelS0 = createTextModel(str);\n\n\tconst edits1 = getRandomEditInfos(textModelS0, rng.nextIntRange(1, 4), rng);\n\tconst textModelS1 = createTextModel(textModelS0.getValue());\n\ttextModelS1.applyEdits(edits1.map(e => toEdit(e)));\n\n\tconst edits2 = getRandomEditInfos(textModelS1, rng.nextIntRange(1, 4), rng);\n\tconst textModelS2 = createTextModel(textModelS1.getValue());\n\ttextModelS2.applyEdits(edits2.map(e => toEdit(e)));\n\n\tconst combinedEdits = combineTextEditInfos(edits1, edits2);\n\tfor (const edit of combinedEdits) {\n\t\tconst range = Range.fromPositions(lengthToPosition(edit.startOffset), lengthToPosition(lengthAdd(edit.startOffset, edit.newLength)));\n\t\tconst value = textModelS2.getValueInRange(range);\n\t\tif (!value.match(/^(L|C|\\n)*$/)) {\n\t\t\tthrow new Error('Invalid edit: ' + value);\n\t\t}\n\t\ttextModelS2.applyEdits([{\n\t\t\trange,\n\t\t\ttext: textModelS0.getValueInRange(Range.fromPositions(lengthToPosition(edit.startOffset), lengthToPosition(edit.endOffset))),\n\t\t}]);\n\t}\n\n\tassert.deepStrictEqual(textModelS2.getValue(), textModelS0.getValue());\n\n\ttextModelS0.dispose();\n\ttextModelS1.dispose();\n\ttextModelS2.dispose();\n}\n\nexport function getRandomEditInfos(textModel: TextModel, count: number, rng: Random, disjoint: boolean = false): TextEditInfo[] {\n\tconst edits: TextEditInfo[] = [];\n\tlet i = 0;\n\tfor (let j = 0; j < count; j++) {\n\t\tedits.push(getRandomEdit(textModel, i, rng));\n\t\ti = textModel.getOffsetAt(lengthToPosition(edits[j].endOffset)) + (disjoint ? 1 : 0);\n\t}\n\treturn edits;\n}\n\nfunction getRandomEdit(textModel: TextModel, rangeOffsetStart: number, rng: Random): TextEditInfo {\n\tconst textModelLength = textModel.getValueLength();\n\tconst offsetStart = rng.nextIntRange(rangeOffsetStart, textModelLength);\n\tconst offsetEnd = rng.nextIntRange(offsetStart, textModelLength);\n\n\tconst lineCount = rng.nextIntRange(0, 3);\n\tconst columnCount = rng.nextIntRange(0, 5);\n\n\treturn new TextEditInfo(positionToLength(textModel.getPositionAt(offsetStart)), positionToLength(textModel.getPositionAt(offsetEnd)), toLength(lineCount, columnCount));\n}\n\nfunction toEdit(editInfo: TextEditInfo): TextReplacement {\n\tconst l = lengthToObj(editInfo.newLength);\n\tlet text = '';\n\n\tfor (let i = 0; i < l.lineCount; i++) {\n\t\ttext += 'LLL\\n';\n\t}\n\tfor (let i = 0; i < l.columnCount; i++) {\n\t\ttext += 'C';\n\t}\n\n\treturn new TextReplacement(\n\t\tRange.fromPositions(\n\t\t\tlengthToPosition(editInfo.startOffset),\n\t\t\tlengthToPosition(editInfo.endOffset)\n\t\t),\n\t\ttext\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { TextReplacement } from '../../../../common/core/edits/textEdit.js';\nimport { TextEditInfo } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper.js';\nimport { combineTextEditInfos } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/combineTextEditInfos.js';\nimport { lengthAdd, lengthToObj, lengthToPosition, positionToLength, toLength } from '../../../../common/model/bracketPairsTextModelPart/bracketPairsTree/length.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { Random } from '../../core/random.js';\nimport { createTextModel } from '../../testTextModel.js';\n\nsuite('combineTextEditInfos', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfor (let seed = 0; seed < 50; seed++) {\n\t\ttest('test' + seed, () => {\n\t\t\trunTest(seed);\n\t\t});\n\t}\n});\n\nfunction runTest(seed: number) {\n\tconst rng = Random.create(seed);\n\n\tconst str = 'abcde\\nfghij\\nklmno\\npqrst\\n';\n\tconst textModelS0 = createTextModel(str);\n\n\tconst edits1 = getRandomEditInfos(textModelS0, rng.nextIntRange(1, 4), rng);\n\tconst textModelS1 = createTextModel(textModelS0.getValue());\n\ttextModelS1.applyEdits(edits1.map(e => toEdit(e)));\n\n\tconst edits2 = getRandomEditInfos(textModelS1, rng.nextIntRange(1, 4), rng);\n\tconst textModelS2 = createTextModel(textModelS1.getValue());\n\ttextModelS2.applyEdits(edits2.map(e => toEdit(e)));\n\n\tconst combinedEdits = combineTextEditInfos(edits1, edits2);\n\tfor (const edit of combinedEdits) {\n\t\tconst range = Range.fromPositions(lengthToPosition(edit.startOffset), lengthToPosition(lengthAdd(edit.startOffset, edit.newLength)));\n\t\tconst value = textModelS2.getValueInRange(range);\n\t\tif (!value.match(/^(L|C|\\n)*$/)) {\n\t\t\tthrow new Error('Invalid edit: ' + value);\n\t\t}\n\t\ttextModelS2.applyEdits([{\n\t\t\trange,\n\t\t\ttext: textModelS0.getValueInRange(Range.fromPositions(lengthToPosition(edit.startOffset), lengthToPosition(edit.endOffset))),\n\t\t}]);\n\t}\n\n\tassert.deepStrictEqual(textModelS2.getValue(), textModelS0.getValue());\n\n\ttextModelS0.dispose();\n\ttextModelS1.dispose();\n\ttextModelS2.dispose();\n}\n\nexport function getRandomEditInfos(textModel: TextModel, count: number, rng: Random, disjoint: boolean = false): TextEditInfo[] {\n\tconst edits: TextEditInfo[] = [];\n\tlet i = 0;\n\tfor (let j = 0; j < count; j++) {\n\t\tedits.push(getRandomEdit(textModel, i, rng));\n\t\ti = textModel.getOffsetAt(lengthToPosition(edits[j].endOffset)) + (disjoint ? 1 : 0);\n\t}\n\treturn edits;\n}\n\nfunction getRandomEdit(textModel: TextModel, rangeOffsetStart: number, rng: Random): TextEditInfo {\n\tconst textModelLength = textModel.getValueLength();\n\tconst offsetStart = rng.nextIntRange(rangeOffsetStart, textModelLength);\n\tconst offsetEnd = rng.nextIntRange(offsetStart, textModelLength);\n\n\tconst lineCount = rng.nextIntRange(0, 3);\n\tconst columnCount = rng.nextIntRange(0, 5);\n\n\treturn new TextEditInfo(positionToLength(textModel.getPositionAt(offsetStart)), positionToLength(textModel.getPositionAt(offsetEnd)), toLength(lineCount, columnCount));\n}\n\nfunction toEdit(editInfo: TextEditInfo): TextReplacement {\n\tconst l = lengthToObj(editInfo.newLength);\n\tlet text = '';\n\n\tfor (let i = 0; i < l.lineCount; i++) {\n\t\ttext += 'LLL\\n';\n\t}\n\tfor (let i = 0; i < l.columnCount; i++) {\n\t\ttext += 'C';\n\t}\n\n\treturn new TextReplacement(\n\t\tRange.fromPositions(\n\t\t\tlengthToPosition(editInfo.startOffset),\n\t\t\tlengthToPosition(editInfo.endOffset)\n\t\t),\n\t\ttext\n\t);\n}\n"]}