{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/test/common/model/bracketPairColorizer/getBracketPairsInRange.test.ts","vs/editor/test/common/model/bracketPairColorizer/getBracketPairsInRange.test.ts"],"names":[],"mappings":"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","file":"getBracketPairsInRange.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { DisposableStore, disposeOnReturn } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { StandardTokenType } from '../../../../common/encodedTokenAttributes.js';\nimport { TokenizationRegistry } from '../../../../common/languages.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { BracketPairInfo } from '../../../../common/textModelBracketPairs.js';\nimport { TokenInfo, TokenizedDocument } from './tokenizer.test.js';\nimport { createModelServices, instantiateTextModel } from '../../testTextModel.js';\n\nsuite('Bracket Pair Colorizer - getBracketPairsInRange', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction createTextModelWithColorizedBracketPairs(store: DisposableStore, text: string): TextModel {\n\t\tconst languageId = 'testLanguage';\n\t\tconst instantiationService = createModelServices(store);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tstore.add(languageService.registerLanguage({\n\t\t\tid: languageId,\n\t\t}));\n\n\t\tconst encodedMode1 = languageService.languageIdCodec.encodeLanguageId(languageId);\n\t\tconst document = new TokenizedDocument([\n\t\t\tnew TokenInfo(text, encodedMode1, StandardTokenType.Other, true)\n\t\t]);\n\t\tstore.add(TokenizationRegistry.register(languageId, document.getTokenizationSupport()));\n\n\t\tstore.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['<', '>']\n\t\t\t],\n\t\t\tcolorizedBracketPairs: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\t\tconst textModel = store.add(instantiateTextModel(instantiationService, text, languageId));\n\t\treturn textModel;\n\t}\n\n\ttest('Basic 1', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ) [ ² { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tmodel.tokenization.getLineTokens(1).getLanguageId(0);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic 2', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ²) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic Empty', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ ² { ( [] ) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic All', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { ( [] ) [  { } ] () } [] ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t\topenRange: '[1,2 -> 1,3]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]',\n\t\t\t\t\t\topenRange: '[1,4 -> 1,5]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]',\n\t\t\t\t\t\topenRange: '[1,6 -> 1,7]',\n\t\t\t\t\t\tcloseRange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,14 -> 1,15]',\n\t\t\t\t\t\topenRange: '[1,14 -> 1,15]',\n\t\t\t\t\t\tcloseRange: '[1,16 -> 1,17]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,20 -> 1,21]',\n\t\t\t\t\t\topenRange: '[1,20 -> 1,21]',\n\t\t\t\t\t\tcloseRange: '[1,21 -> 1,22]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,25 -> 1,26]',\n\t\t\t\t\t\topenRange: '[1,25 -> 1,26]',\n\t\t\t\t\t\tcloseRange: '[1,26 -> 1,27]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('getBracketsInRange', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { [ ( [ [ (  ) ] ] ) ] } { } ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,12 -> 1,13]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: '[1,17 -> 1,18]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,19 -> 1,20]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,21 -> 1,22]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,23 -> 1,24]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,25 -> 1,26]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,27 -> 1,28]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,29 -> 1,30]'\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Test Error Brackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { () ] ² `);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, range: b.range.toString(), isInvalid: b.isInvalid }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\n\ttest('colorizedBracketsVSBrackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ {} [<()>] <{>} ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), true)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,13 -> 1,14]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), false)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,12 -> 1,13]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,13 -> 1,14]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,14 -> 1,15]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n});\n\nfunction bracketPairToJSON(pair: BracketPairInfo): unknown {\n\treturn {\n\t\tlevel: pair.nestingLevel,\n\t\trange: pair.openingBracketRange.toString(),\n\t\topenRange: pair.openingBracketRange.toString(),\n\t\tcloseRange: pair.closingBracketRange?.toString() || null,\n\t};\n}\n\nclass PositionOffsetTransformer {\n\tprivate readonly lineStartOffsetByLineIdx: number[];\n\n\tconstructor(text: string) {\n\t\tthis.lineStartOffsetByLineIdx = [];\n\t\tthis.lineStartOffsetByLineIdx.push(0);\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tif (text.charAt(i) === '\\n') {\n\t\t\t\tthis.lineStartOffsetByLineIdx.push(i + 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset(position: Position): number {\n\t\treturn this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n\t}\n\n\tgetPosition(offset: number): Position {\n\t\tconst lineNumber = this.lineStartOffsetByLineIdx.findIndex(lineStartOffset => lineStartOffset <= offset);\n\t\treturn new Position(lineNumber + 1, offset - this.lineStartOffsetByLineIdx[lineNumber] + 1);\n\t}\n}\n\nclass AnnotatedDocument {\n\tpublic readonly text: string;\n\tprivate readonly positions: ReadonlyMap<number, Position>;\n\n\tconstructor(src: string) {\n\t\tconst numbers = ['⁰', '¹', '²', '³', '⁴', '⁵', '⁶', '⁷', '⁸', '⁹'];\n\n\t\tlet text = '';\n\t\tconst offsetPositions = new Map<number, number>();\n\n\t\tlet offset = 0;\n\t\tfor (let i = 0; i < src.length; i++) {\n\t\t\tconst idx = numbers.indexOf(src[i]);\n\t\t\tif (idx >= 0) {\n\t\t\t\toffsetPositions.set(idx, offset);\n\t\t\t} else {\n\t\t\t\ttext += src[i];\n\t\t\t\toffset++;\n\t\t\t}\n\t\t}\n\n\t\tthis.text = text;\n\n\t\tconst mapper = new PositionOffsetTransformer(this.text);\n\t\tconst positions = new Map<number, Position>();\n\t\tfor (const [idx, offset] of offsetPositions.entries()) {\n\t\t\tpositions.set(idx, mapper.getPosition(offset));\n\t\t}\n\t\tthis.positions = positions;\n\t}\n\n\trange(start: number, end: number): Range {\n\t\treturn Range.fromPositions(this.positions.get(start)!, this.positions.get(end)!);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { DisposableStore, disposeOnReturn } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { StandardTokenType } from '../../../../common/encodedTokenAttributes.js';\nimport { TokenizationRegistry } from '../../../../common/languages.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { BracketPairInfo } from '../../../../common/textModelBracketPairs.js';\nimport { TokenInfo, TokenizedDocument } from './tokenizer.test.js';\nimport { createModelServices, instantiateTextModel } from '../../testTextModel.js';\n\nsuite('Bracket Pair Colorizer - getBracketPairsInRange', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction createTextModelWithColorizedBracketPairs(store: DisposableStore, text: string): TextModel {\n\t\tconst languageId = 'testLanguage';\n\t\tconst instantiationService = createModelServices(store);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tstore.add(languageService.registerLanguage({\n\t\t\tid: languageId,\n\t\t}));\n\n\t\tconst encodedMode1 = languageService.languageIdCodec.encodeLanguageId(languageId);\n\t\tconst document = new TokenizedDocument([\n\t\t\tnew TokenInfo(text, encodedMode1, StandardTokenType.Other, true)\n\t\t]);\n\t\tstore.add(TokenizationRegistry.register(languageId, document.getTokenizationSupport()));\n\n\t\tstore.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['<', '>']\n\t\t\t],\n\t\t\tcolorizedBracketPairs: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\t\tconst textModel = store.add(instantiateTextModel(instantiationService, text, languageId));\n\t\treturn textModel;\n\t}\n\n\ttest('Basic 1', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ) [ ² { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tmodel.tokenization.getLineTokens(1).getLanguageId(0);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic 2', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ²) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic Empty', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ ² { ( [] ) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic All', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { ( [] ) [  { } ] () } [] ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t\topenRange: '[1,2 -> 1,3]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]',\n\t\t\t\t\t\topenRange: '[1,4 -> 1,5]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]',\n\t\t\t\t\t\topenRange: '[1,6 -> 1,7]',\n\t\t\t\t\t\tcloseRange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,14 -> 1,15]',\n\t\t\t\t\t\topenRange: '[1,14 -> 1,15]',\n\t\t\t\t\t\tcloseRange: '[1,16 -> 1,17]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,20 -> 1,21]',\n\t\t\t\t\t\topenRange: '[1,20 -> 1,21]',\n\t\t\t\t\t\tcloseRange: '[1,21 -> 1,22]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,25 -> 1,26]',\n\t\t\t\t\t\topenRange: '[1,25 -> 1,26]',\n\t\t\t\t\t\tcloseRange: '[1,26 -> 1,27]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('getBracketsInRange', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { [ ( [ [ (  ) ] ] ) ] } { } ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,12 -> 1,13]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: '[1,17 -> 1,18]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: '[1,19 -> 1,20]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,21 -> 1,22]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,23 -> 1,24]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,25 -> 1,26]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,27 -> 1,28]'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,29 -> 1,30]'\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Test Error Brackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { () ] ² `);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, range: b.range.toString(), isInvalid: b.isInvalid }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\n\ttest('colorizedBracketsVSBrackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ {} [<()>] <{>} ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), true)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,13 -> 1,14]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), false)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,5 -> 1,6]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,8 -> 1,9]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,10 -> 1,11]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,12 -> 1,13]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,13 -> 1,14]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,14 -> 1,15]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: '[1,15 -> 1,16]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n});\n\nfunction bracketPairToJSON(pair: BracketPairInfo): unknown {\n\treturn {\n\t\tlevel: pair.nestingLevel,\n\t\trange: pair.openingBracketRange.toString(),\n\t\topenRange: pair.openingBracketRange.toString(),\n\t\tcloseRange: pair.closingBracketRange?.toString() || null,\n\t};\n}\n\nclass PositionOffsetTransformer {\n\tprivate readonly lineStartOffsetByLineIdx: number[];\n\n\tconstructor(text: string) {\n\t\tthis.lineStartOffsetByLineIdx = [];\n\t\tthis.lineStartOffsetByLineIdx.push(0);\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tif (text.charAt(i) === '\\n') {\n\t\t\t\tthis.lineStartOffsetByLineIdx.push(i + 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset(position: Position): number {\n\t\treturn this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n\t}\n\n\tgetPosition(offset: number): Position {\n\t\tconst lineNumber = this.lineStartOffsetByLineIdx.findIndex(lineStartOffset => lineStartOffset <= offset);\n\t\treturn new Position(lineNumber + 1, offset - this.lineStartOffsetByLineIdx[lineNumber] + 1);\n\t}\n}\n\nclass AnnotatedDocument {\n\tpublic readonly text: string;\n\tprivate readonly positions: ReadonlyMap<number, Position>;\n\n\tconstructor(src: string) {\n\t\tconst numbers = ['⁰', '¹', '²', '³', '⁴', '⁵', '⁶', '⁷', '⁸', '⁹'];\n\n\t\tlet text = '';\n\t\tconst offsetPositions = new Map<number, number>();\n\n\t\tlet offset = 0;\n\t\tfor (let i = 0; i < src.length; i++) {\n\t\t\tconst idx = numbers.indexOf(src[i]);\n\t\t\tif (idx >= 0) {\n\t\t\t\toffsetPositions.set(idx, offset);\n\t\t\t} else {\n\t\t\t\ttext += src[i];\n\t\t\t\toffset++;\n\t\t\t}\n\t\t}\n\n\t\tthis.text = text;\n\n\t\tconst mapper = new PositionOffsetTransformer(this.text);\n\t\tconst positions = new Map<number, Position>();\n\t\tfor (const [idx, offset] of offsetPositions.entries()) {\n\t\t\tpositions.set(idx, mapper.getPosition(offset));\n\t\t}\n\t\tthis.positions = positions;\n\t}\n\n\trange(start: number, end: number): Range {\n\t\treturn Range.fromPositions(this.positions.get(start)!, this.positions.get(end)!);\n\t}\n}\n"]}