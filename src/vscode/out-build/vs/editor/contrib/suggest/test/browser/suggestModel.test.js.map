{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/suggest/test/browser/suggestModel.test.ts","vs/editor/contrib/suggest/test/browser/suggestModel.test.ts"],"names":[],"mappings":"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","file":"suggestModel.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { EditOperation } from '../../../../common/core/editOperation.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { Handler } from '../../../../common/editorCommon.js';\nimport { ITextModel } from '../../../../common/model.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { CompletionItemKind, CompletionItemProvider, CompletionList, CompletionTriggerKind, EncodedTokenizationResult, IState, TokenizationRegistry } from '../../../../common/languages.js';\nimport { MetadataConsts } from '../../../../common/encodedTokenAttributes.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { NullState } from '../../../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { SnippetController2 } from '../../../snippet/browser/snippetController2.js';\nimport { SuggestController } from '../../browser/suggestController.js';\nimport { ISuggestMemoryService } from '../../browser/suggestMemory.js';\nimport { LineContext, SuggestModel } from '../../browser/suggestModel.js';\nimport { ISelectedSuggestion } from '../../browser/suggestWidget.js';\nimport { createTestCodeEditor, ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { createModelServices, createTextModel, instantiateTextModel } from '../../../../test/common/testTextModel.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { MockKeybindingService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { InMemoryStorageService, IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { NullTelemetryService } from '../../../../../platform/telemetry/common/telemetryUtils.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { LanguageFeaturesService } from '../../../../common/services/languageFeaturesService.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { getSnippetSuggestSupport, setSnippetSuggestSupport } from '../../browser/suggest.js';\nimport { IEnvironmentService } from '../../../../../platform/environment/common/environment.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\n\nfunction createMockEditor(model: TextModel, languageFeaturesService: ILanguageFeaturesService): ITestCodeEditor {\n\n\tconst storeService = new InMemoryStorageService();\n\tconst editor = createTestCodeEditor(model, {\n\t\tserviceCollection: new ServiceCollection(\n\t\t\t[ILanguageFeaturesService, languageFeaturesService],\n\t\t\t[ITelemetryService, NullTelemetryService],\n\t\t\t[IStorageService, storeService],\n\t\t\t[IKeybindingService, new MockKeybindingService()],\n\t\t\t[ISuggestMemoryService, new class implements ISuggestMemoryService {\n\t\t\t\tdeclare readonly _serviceBrand: undefined;\n\t\t\t\tmemorize(): void {\n\t\t\t\t}\n\t\t\t\tselect(): number {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t}],\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() { }],\n\t\t\t[IEnvironmentService, new class extends mock<IEnvironmentService>() {\n\t\t\t\toverride isBuilt: boolean = true;\n\t\t\t\toverride isExtensionDevelopment: boolean = false;\n\t\t\t}],\n\t\t),\n\t});\n\tconst ctrl = editor.registerAndInstantiateContribution(SnippetController2.ID, SnippetController2);\n\teditor.hasWidgetFocus = () => true;\n\n\teditor.registerDisposable(ctrl);\n\teditor.registerDisposable(storeService);\n\treturn editor;\n}\n\nsuite('SuggestModel - Context', function () {\n\tconst OUTER_LANGUAGE_ID = 'outerMode';\n\tconst INNER_LANGUAGE_ID = 'innerMode';\n\n\tclass OuterMode extends Disposable {\n\t\tpublic readonly languageId = OUTER_LANGUAGE_ID;\n\t\tconstructor(\n\t\t\t@ILanguageService languageService: ILanguageService,\n\t\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService,\n\t\t) {\n\t\t\tsuper();\n\t\t\tthis._register(languageService.registerLanguage({ id: this.languageId }));\n\t\t\tthis._register(languageConfigurationService.register(this.languageId, {}));\n\n\t\t\tthis._register(TokenizationRegistry.register(this.languageId, {\n\t\t\t\tgetInitialState: (): IState => NullState,\n\t\t\t\ttokenize: undefined!,\n\t\t\t\ttokenizeEncoded: (line: string, hasEOL: boolean, state: IState): EncodedTokenizationResult => {\n\t\t\t\t\tconst tokensArr: number[] = [];\n\t\t\t\t\tlet prevLanguageId: string | undefined = undefined;\n\t\t\t\t\tfor (let i = 0; i < line.length; i++) {\n\t\t\t\t\t\tconst languageId = (line.charAt(i) === 'x' ? INNER_LANGUAGE_ID : OUTER_LANGUAGE_ID);\n\t\t\t\t\t\tconst encodedLanguageId = languageService.languageIdCodec.encodeLanguageId(languageId);\n\t\t\t\t\t\tif (prevLanguageId !== languageId) {\n\t\t\t\t\t\t\ttokensArr.push(i);\n\t\t\t\t\t\t\ttokensArr.push((encodedLanguageId << MetadataConsts.LANGUAGEID_OFFSET));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprevLanguageId = languageId;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tokens = new Uint32Array(tokensArr.length);\n\t\t\t\t\tfor (let i = 0; i < tokens.length; i++) {\n\t\t\t\t\t\ttokens[i] = tokensArr[i];\n\t\t\t\t\t}\n\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tclass InnerMode extends Disposable {\n\t\tpublic readonly languageId = INNER_LANGUAGE_ID;\n\t\tconstructor(\n\t\t\t@ILanguageService languageService: ILanguageService,\n\t\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService\n\t\t) {\n\t\t\tsuper();\n\t\t\tthis._register(languageService.registerLanguage({ id: this.languageId }));\n\t\t\tthis._register(languageConfigurationService.register(this.languageId, {}));\n\t\t}\n\t}\n\n\tconst assertAutoTrigger = (model: TextModel, offset: number, expected: boolean, message?: string): void => {\n\t\tconst pos = model.getPositionAt(offset);\n\t\tconst editor = createMockEditor(model, new LanguageFeaturesService());\n\t\teditor.setPosition(pos);\n\t\tassert.strictEqual(LineContext.shouldAutoTrigger(editor), expected, message);\n\t\teditor.dispose();\n\t};\n\n\tlet disposables: DisposableStore;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t});\n\n\tteardown(function () {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Context - shouldAutoTrigger', function () {\n\t\tconst model = createTextModel('Das Pferd frisst keinen Gurkensalat - Philipp Reis 1861.\\nWer hat\\'s erfunden?');\n\t\tdisposables.add(model);\n\n\t\tassertAutoTrigger(model, 3, true, 'end of word, Das|');\n\t\tassertAutoTrigger(model, 4, false, 'no word Das |');\n\t\tassertAutoTrigger(model, 1, true, 'typing a single character before a word: D|as');\n\t\tassertAutoTrigger(model, 55, false, 'number, 1861|');\n\t\tmodel.dispose();\n\t});\n\n\ttest('shouldAutoTrigger at embedded language boundaries', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst outerMode = disposables.add(instantiationService.createInstance(OuterMode));\n\t\tdisposables.add(instantiationService.createInstance(InnerMode));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'a<xx>a<x>', outerMode.languageId));\n\n\t\tassertAutoTrigger(model, 1, true, 'a|<x  should trigger at end of word');\n\t\tassertAutoTrigger(model, 2, false, 'a<|x  should NOT trigger at start of word');\n\t\tassertAutoTrigger(model, 3, true, 'a<x|x   should trigger after typing a single character before a word');\n\t\tassertAutoTrigger(model, 4, true, 'a<xx|>  should trigger at boundary between languages');\n\t\tassertAutoTrigger(model, 5, false, 'a<xx>|a  should NOT trigger at start of word');\n\t\tassertAutoTrigger(model, 6, true, 'a<xx>a|<  should trigger at end of word');\n\t\tassertAutoTrigger(model, 8, true, 'a<xx>a<x|>  should trigger at end of word at boundary');\n\n\t\tdisposables.dispose();\n\t});\n});\n\nsuite('SuggestModel - TriggerAndCancelOracle', function () {\n\n\n\tfunction getDefaultSuggestRange(model: ITextModel, position: Position) {\n\t\tconst wordUntil = model.getWordUntilPosition(position);\n\t\treturn new Range(position.lineNumber, wordUntil.startColumn, position.lineNumber, wordUntil.endColumn);\n\t}\n\n\tconst alwaysEmptySupport: CompletionItemProvider = {\n\t\t_debugDisplayName: 'test',\n\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\treturn {\n\t\t\t\tincomplete: false,\n\t\t\t\tsuggestions: []\n\t\t\t};\n\t\t}\n\t};\n\n\tconst alwaysSomethingSupport: CompletionItemProvider = {\n\t\t_debugDisplayName: 'test',\n\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\treturn {\n\t\t\t\tincomplete: false,\n\t\t\t\tsuggestions: [{\n\t\t\t\t\tlabel: doc.getWordUntilPosition(pos).word,\n\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\tinsertText: 'foofoo',\n\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t}]\n\t\t\t};\n\t\t}\n\t};\n\n\tlet disposables: DisposableStore;\n\tlet model: TextModel;\n\tconst languageFeaturesService = new LanguageFeaturesService();\n\tconst registry = languageFeaturesService.completionProvider;\n\n\tsetup(function () {\n\t\tdisposables = new DisposableStore();\n\t\tmodel = createTextModel('abc def', undefined, undefined, URI.parse('test:somefile.ttt'));\n\t\tdisposables.add(model);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction withOracle(callback: (model: SuggestModel, editor: ITestCodeEditor) => any): Promise<any> {\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst editor = createMockEditor(model, languageFeaturesService);\n\t\t\tconst oracle = editor.invokeWithinContext(accessor => accessor.get(IInstantiationService).createInstance(SuggestModel, editor));\n\t\t\tdisposables.add(oracle);\n\t\t\tdisposables.add(editor);\n\n\t\t\ttry {\n\t\t\t\tresolve(callback(oracle, editor));\n\t\t\t} catch (err) {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction assertEvent<E>(event: Event<E>, action: () => any, assert: (e: E) => any) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst sub = event(e => {\n\t\t\t\tsub.dispose();\n\t\t\t\ttry {\n\t\t\t\t\tresolve(assert(e));\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttry {\n\t\t\t\taction();\n\t\t\t} catch (err) {\n\t\t\t\tsub.dispose();\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\ttest('events - cancel/trigger', function () {\n\t\treturn withOracle(model => {\n\n\t\t\treturn Promise.all([\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, true);\n\n\t\t\t\t\treturn assertEvent(model.onDidCancel, function () {\n\t\t\t\t\t\tmodel.cancel();\n\t\t\t\t\t}, function (event) {\n\t\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t\t});\n\t\t\t\t}),\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, true);\n\t\t\t\t}),\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, false);\n\t\t\t\t})\n\t\t\t]);\n\t\t});\n\t});\n\n\n\ttest('events - suggest/empty', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysEmptySupport));\n\n\t\treturn withOracle(model => {\n\t\t\treturn Promise.all([\n\t\t\t\tassertEvent(model.onDidCancel, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t}),\n\t\t\t\tassertEvent(model.onDidSuggest, function () {\n\t\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 0);\n\t\t\t\t})\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('trigger - on type', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'd' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('#17400: Keep filtering suggestModel.ts after space', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'My Table',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'My Table',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// make sure completionModel starts here!\n\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t}, event => {\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'My' });\n\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\t\tassert.strictEqual(first.completion.label, 'My Table');\n\n\t\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\t\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' ' });\n\n\t\t\t\t\t}, event => {\n\t\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\t\t\tassert.strictEqual(first.completion.label, 'My Table');\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('#21484: Trigger character always force a new completion session', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo.bar',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo.bar',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'boom',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'boom',\n\t\t\t\t\t\trange: Range.fromPositions(\n\t\t\t\t\t\t\tpos.delta(0, doc.getLineContent(pos.lineNumber)[pos.column - 2] === '.' ? 0 : -1),\n\t\t\t\t\t\t\tpos\n\t\t\t\t\t\t)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'foo' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\t// SYNC\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// nothing -> triggered by the trigger character typing (see above)\n\n\t\t\t}, event => {\n\t\t\t\t// ASYNC\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tconst [first, second] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\t\t\t\tassert.strictEqual(second.completion.label, 'boom');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Intellisense Completion doesn\\'t respect space after equal sign (.html file), #29353 [1/2]', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('fo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '+' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Intellisense Completion doesn\\'t respect space after equal sign (.html file), #29353 [2/2]', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('fo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' ' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Incomplete suggestion results cause re-triggering when typing w/o further context, #28400 (1/2)', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('foo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ';' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Incomplete suggestion results cause re-triggering when typing w/o further context, #28400 (2/2)', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo;',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('foo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\t// while we cancel incrementally enriching the set of\n\t\t\t\t\t// completions we still filter against those that we have\n\t\t\t\t\t// until now\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ';' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Trigger character is provided in suggest context', function () {\n\t\tlet triggerCharacter = '';\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, context): CompletionList {\n\t\t\t\tassert.strictEqual(context.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\ttriggerCharacter = context.triggerCharacter!;\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'foo.bar',\n\t\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\t\tinsertText: 'foo.bar',\n\t\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'foo.' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(triggerCharacter, '.');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Mac press and hold accent character insertion does not update suggestions, #35269', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'abc',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'abc',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'bc',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'bc',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'a' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].completion.label, 'abc');\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\teditor.executeEdits('test', [EditOperation.replace(new Range(1, 1, 1, 2), '')]);\n\n\t\t\t\t}, event => {\n\t\t\t\t\t// suggest model changed to bc\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items[0].completion.label, 'bc');\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Backspace should not always cancel code completion, #36491', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle(async (model, editor) => {\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'd' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.runCommand(CoreEditingCommands.DeleteLeft, null);\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Text changes for completion CodeAction are affected by the completion #39893', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'bar',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'bar',\n\t\t\t\t\t\trange: Range.fromPositions(pos.delta(0, -2), pos),\n\t\t\t\t\t\tadditionalTextEdits: [{\n\t\t\t\t\t\t\ttext: ', bar',\n\t\t\t\t\t\t\trange: { startLineNumber: 1, endLineNumber: 1, startColumn: 17, endColumn: 17 }\n\t\t\t\t\t\t}]\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('ba; import { foo } from \"./b\"');\n\n\t\treturn withOracle(async (sugget, editor) => {\n\t\t\tclass TestCtrl extends SuggestController {\n\t\t\t\t_insertSuggestion_publicForTest(item: ISelectedSuggestion, flags: number = 0) {\n\t\t\t\t\tsuper._insertSuggestion(item, flags);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst ctrl = <TestCtrl>editor.registerAndInstantiateContribution(TestCtrl.ID, TestCtrl);\n\t\t\teditor.registerAndInstantiateContribution(SnippetController2.ID, SnippetController2);\n\n\t\t\tawait assertEvent(sugget.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\t\t\t\tsugget.trigger({ auto: false });\n\t\t\t}, event => {\n\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'bar');\n\n\t\t\t\tctrl._insertSuggestion_publicForTest({ item: first, index: 0, model: event.completionModel });\n\t\t\t});\n\n\t\t\tassert.strictEqual(\n\t\t\t\tmodel.getValue(),\n\t\t\t\t'bar; import { foo, bar } from \"./b\"'\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Completion unexpectedly triggers on second keypress of an edit group in a snippet #43523', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('d');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 2));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'e' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\n\ttest('Fails to render completion details #47988', function () {\n\n\t\tlet disposeA = 0;\n\t\tlet disposeB = 0;\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'CompleteNot',\n\t\t\t\t\t\tinsertText: 'Incomplete',\n\t\t\t\t\t\tsortText: 'a',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tdispose() { disposeA += 1; }\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'Complete',\n\t\t\t\t\t\tinsertText: 'Complete',\n\t\t\t\t\t\tsortText: 'z',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tdispose() { disposeB += 1; }\n\t\t\t\t};\n\t\t\t},\n\t\t\tresolveCompletionItem(item) {\n\t\t\t\treturn item;\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'c' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(disposeA, 0);\n\t\t\t\tassert.strictEqual(disposeB, 0);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\n\t\t\t\t// clean up\n\t\t\t\tmodel.clear();\n\t\t\t\tassert.strictEqual(disposeA, 2); // provide got called two times!\n\t\t\t\tassert.strictEqual(disposeB, 1);\n\t\t\t});\n\n\t\t});\n\t});\n\n\n\ttest('Trigger (full) completions when (incomplete) completions are already active #99504', function () {\n\n\t\tlet countA = 0;\n\t\tlet countB = 0;\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tcountA += 1;\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false, // doesn't matter if incomplete or not\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'Z aaa',\n\t\t\t\t\t\tinsertText: 'Z aaa',\n\t\t\t\t\t\trange: new Range(1, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tcountB += 1;\n\t\t\t\tif (!doc.getWordUntilPosition(pos).word.startsWith('a')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'aaa',\n\t\t\t\t\t\tinsertText: 'aaa',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'Z' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'Z aaa');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// started another word: Z a|\n\t\t\t\t// item should be: Z aaa, aaa\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' a' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'Z aaa');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'aaa');\n\n\t\t\t\tassert.strictEqual(countA, 1); // should we keep the suggestions from the \"active\" provider?, Yes! See: #106573\n\t\t\t\tassert.strictEqual(countB, 2);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('registerCompletionItemProvider with letters as trigger characters block other completion items to show up #127815', async function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'AAAA',\n\t\t\t\t\t\tinsertText: 'WordTriggerA',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['a', '.'],\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'AAAA',\n\t\t\t\t\t\tinsertText: 'AutoTriggerA',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\n\t\t\teditor.getModel().setValue('');\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'a' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Unexpected suggest scoring #167242', async function () {\n\t\tdisposables.add(registry.register('*', {\n\t\t\t// word-based\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tconst word = doc.getWordUntilPosition(pos);\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'pull',\n\t\t\t\t\t\tinsertText: 'pull',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t// JSON-based\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'git.pull',\n\t\t\t\t\t\tinsertText: 'git.pull',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('gi');\n\t\t\t\teditor.setSelection(new Selection(1, 3, 1, 3));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 't' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'git.pull');\n\t\t\t});\n\n\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'p' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'git.pull');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Completion list closes unexpectedly when typing a digit after a word separator #169390', function () {\n\n\t\tconst requestCounts = [0, 0];\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\trequestCounts[0] += 1;\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'foo-20',\n\t\t\t\t\t\tinsertText: 'foo-20',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'foo-hello',\n\t\t\t\t\t\tinsertText: 'foo-hello',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['2'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\trequestCounts[1] += 1;\n\t\t\t\tif (ctx.triggerKind !== CompletionTriggerKind.TriggerCharacter) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'foo-210',\n\t\t\t\t\t\tinsertText: 'foo-210',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('foo');\n\t\t\t\teditor.setSelection(new Selection(1, 4, 1, 4));\n\t\t\t\tmodel.trigger({ auto: false });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'foo-20');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'foo-hello');\n\t\t\t});\n\n\t\t\teditor.trigger('keyboard', Handler.Type, { text: '-' });\n\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '2' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'foo-20');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'foo-210');\n\t\t\t\tassert.deepStrictEqual(requestCounts, [1, 2]);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Set refilter-flag, keep triggerKind', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: doc.getWordUntilPosition(pos).word || 'hello',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foofoo',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('foo');\n\t\t\t\teditor.setSelection(new Selection(1, 4, 1, 4));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, undefined);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.refilter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, '.');\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'h' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.refilter, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, '.');\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Snippets gone from IntelliSense #173244', function () {\n\n\t\tconst snippetProvider: CompletionItemProvider = {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'log',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'log',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tconst old = setSnippetSuggestSupport(snippetProvider);\n\n\t\tdisposables.add(toDisposable(() => {\n\t\t\tif (getSnippetSuggestSupport() === snippetProvider) {\n\t\t\t\tsetSnippetSuggestSupport(old);\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'locals',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'locals',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tincomplete: true\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'l' });\n\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, undefined);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'locals');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'log');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerForIncompleteCompletions);\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'locals');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'log');\n\t\t\t});\n\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { EditOperation } from '../../../../common/core/editOperation.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { Handler } from '../../../../common/editorCommon.js';\nimport { ITextModel } from '../../../../common/model.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { CompletionItemKind, CompletionItemProvider, CompletionList, CompletionTriggerKind, EncodedTokenizationResult, IState, TokenizationRegistry } from '../../../../common/languages.js';\nimport { MetadataConsts } from '../../../../common/encodedTokenAttributes.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { NullState } from '../../../../common/languages/nullTokenize.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { SnippetController2 } from '../../../snippet/browser/snippetController2.js';\nimport { SuggestController } from '../../browser/suggestController.js';\nimport { ISuggestMemoryService } from '../../browser/suggestMemory.js';\nimport { LineContext, SuggestModel } from '../../browser/suggestModel.js';\nimport { ISelectedSuggestion } from '../../browser/suggestWidget.js';\nimport { createTestCodeEditor, ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { createModelServices, createTextModel, instantiateTextModel } from '../../../../test/common/testTextModel.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { MockKeybindingService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { InMemoryStorageService, IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { NullTelemetryService } from '../../../../../platform/telemetry/common/telemetryUtils.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { LanguageFeaturesService } from '../../../../common/services/languageFeaturesService.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { getSnippetSuggestSupport, setSnippetSuggestSupport } from '../../browser/suggest.js';\nimport { IEnvironmentService } from '../../../../../platform/environment/common/environment.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\n\nfunction createMockEditor(model: TextModel, languageFeaturesService: ILanguageFeaturesService): ITestCodeEditor {\n\n\tconst storeService = new InMemoryStorageService();\n\tconst editor = createTestCodeEditor(model, {\n\t\tserviceCollection: new ServiceCollection(\n\t\t\t[ILanguageFeaturesService, languageFeaturesService],\n\t\t\t[ITelemetryService, NullTelemetryService],\n\t\t\t[IStorageService, storeService],\n\t\t\t[IKeybindingService, new MockKeybindingService()],\n\t\t\t[ISuggestMemoryService, new class implements ISuggestMemoryService {\n\t\t\t\tdeclare readonly _serviceBrand: undefined;\n\t\t\t\tmemorize(): void {\n\t\t\t\t}\n\t\t\t\tselect(): number {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t}],\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() { }],\n\t\t\t[IEnvironmentService, new class extends mock<IEnvironmentService>() {\n\t\t\t\toverride isBuilt: boolean = true;\n\t\t\t\toverride isExtensionDevelopment: boolean = false;\n\t\t\t}],\n\t\t),\n\t});\n\tconst ctrl = editor.registerAndInstantiateContribution(SnippetController2.ID, SnippetController2);\n\teditor.hasWidgetFocus = () => true;\n\n\teditor.registerDisposable(ctrl);\n\teditor.registerDisposable(storeService);\n\treturn editor;\n}\n\nsuite('SuggestModel - Context', function () {\n\tconst OUTER_LANGUAGE_ID = 'outerMode';\n\tconst INNER_LANGUAGE_ID = 'innerMode';\n\n\tclass OuterMode extends Disposable {\n\t\tpublic readonly languageId = OUTER_LANGUAGE_ID;\n\t\tconstructor(\n\t\t\t@ILanguageService languageService: ILanguageService,\n\t\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService,\n\t\t) {\n\t\t\tsuper();\n\t\t\tthis._register(languageService.registerLanguage({ id: this.languageId }));\n\t\t\tthis._register(languageConfigurationService.register(this.languageId, {}));\n\n\t\t\tthis._register(TokenizationRegistry.register(this.languageId, {\n\t\t\t\tgetInitialState: (): IState => NullState,\n\t\t\t\ttokenize: undefined!,\n\t\t\t\ttokenizeEncoded: (line: string, hasEOL: boolean, state: IState): EncodedTokenizationResult => {\n\t\t\t\t\tconst tokensArr: number[] = [];\n\t\t\t\t\tlet prevLanguageId: string | undefined = undefined;\n\t\t\t\t\tfor (let i = 0; i < line.length; i++) {\n\t\t\t\t\t\tconst languageId = (line.charAt(i) === 'x' ? INNER_LANGUAGE_ID : OUTER_LANGUAGE_ID);\n\t\t\t\t\t\tconst encodedLanguageId = languageService.languageIdCodec.encodeLanguageId(languageId);\n\t\t\t\t\t\tif (prevLanguageId !== languageId) {\n\t\t\t\t\t\t\ttokensArr.push(i);\n\t\t\t\t\t\t\ttokensArr.push((encodedLanguageId << MetadataConsts.LANGUAGEID_OFFSET));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprevLanguageId = languageId;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tokens = new Uint32Array(tokensArr.length);\n\t\t\t\t\tfor (let i = 0; i < tokens.length; i++) {\n\t\t\t\t\t\ttokens[i] = tokensArr[i];\n\t\t\t\t\t}\n\t\t\t\t\treturn new EncodedTokenizationResult(tokens, state);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tclass InnerMode extends Disposable {\n\t\tpublic readonly languageId = INNER_LANGUAGE_ID;\n\t\tconstructor(\n\t\t\t@ILanguageService languageService: ILanguageService,\n\t\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService\n\t\t) {\n\t\t\tsuper();\n\t\t\tthis._register(languageService.registerLanguage({ id: this.languageId }));\n\t\t\tthis._register(languageConfigurationService.register(this.languageId, {}));\n\t\t}\n\t}\n\n\tconst assertAutoTrigger = (model: TextModel, offset: number, expected: boolean, message?: string): void => {\n\t\tconst pos = model.getPositionAt(offset);\n\t\tconst editor = createMockEditor(model, new LanguageFeaturesService());\n\t\teditor.setPosition(pos);\n\t\tassert.strictEqual(LineContext.shouldAutoTrigger(editor), expected, message);\n\t\teditor.dispose();\n\t};\n\n\tlet disposables: DisposableStore;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t});\n\n\tteardown(function () {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Context - shouldAutoTrigger', function () {\n\t\tconst model = createTextModel('Das Pferd frisst keinen Gurkensalat - Philipp Reis 1861.\\nWer hat\\'s erfunden?');\n\t\tdisposables.add(model);\n\n\t\tassertAutoTrigger(model, 3, true, 'end of word, Das|');\n\t\tassertAutoTrigger(model, 4, false, 'no word Das |');\n\t\tassertAutoTrigger(model, 1, true, 'typing a single character before a word: D|as');\n\t\tassertAutoTrigger(model, 55, false, 'number, 1861|');\n\t\tmodel.dispose();\n\t});\n\n\ttest('shouldAutoTrigger at embedded language boundaries', () => {\n\t\tconst disposables = new DisposableStore();\n\t\tconst instantiationService = createModelServices(disposables);\n\t\tconst outerMode = disposables.add(instantiationService.createInstance(OuterMode));\n\t\tdisposables.add(instantiationService.createInstance(InnerMode));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'a<xx>a<x>', outerMode.languageId));\n\n\t\tassertAutoTrigger(model, 1, true, 'a|<x  should trigger at end of word');\n\t\tassertAutoTrigger(model, 2, false, 'a<|x  should NOT trigger at start of word');\n\t\tassertAutoTrigger(model, 3, true, 'a<x|x   should trigger after typing a single character before a word');\n\t\tassertAutoTrigger(model, 4, true, 'a<xx|>  should trigger at boundary between languages');\n\t\tassertAutoTrigger(model, 5, false, 'a<xx>|a  should NOT trigger at start of word');\n\t\tassertAutoTrigger(model, 6, true, 'a<xx>a|<  should trigger at end of word');\n\t\tassertAutoTrigger(model, 8, true, 'a<xx>a<x|>  should trigger at end of word at boundary');\n\n\t\tdisposables.dispose();\n\t});\n});\n\nsuite('SuggestModel - TriggerAndCancelOracle', function () {\n\n\n\tfunction getDefaultSuggestRange(model: ITextModel, position: Position) {\n\t\tconst wordUntil = model.getWordUntilPosition(position);\n\t\treturn new Range(position.lineNumber, wordUntil.startColumn, position.lineNumber, wordUntil.endColumn);\n\t}\n\n\tconst alwaysEmptySupport: CompletionItemProvider = {\n\t\t_debugDisplayName: 'test',\n\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\treturn {\n\t\t\t\tincomplete: false,\n\t\t\t\tsuggestions: []\n\t\t\t};\n\t\t}\n\t};\n\n\tconst alwaysSomethingSupport: CompletionItemProvider = {\n\t\t_debugDisplayName: 'test',\n\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\treturn {\n\t\t\t\tincomplete: false,\n\t\t\t\tsuggestions: [{\n\t\t\t\t\tlabel: doc.getWordUntilPosition(pos).word,\n\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\tinsertText: 'foofoo',\n\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t}]\n\t\t\t};\n\t\t}\n\t};\n\n\tlet disposables: DisposableStore;\n\tlet model: TextModel;\n\tconst languageFeaturesService = new LanguageFeaturesService();\n\tconst registry = languageFeaturesService.completionProvider;\n\n\tsetup(function () {\n\t\tdisposables = new DisposableStore();\n\t\tmodel = createTextModel('abc def', undefined, undefined, URI.parse('test:somefile.ttt'));\n\t\tdisposables.add(model);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction withOracle(callback: (model: SuggestModel, editor: ITestCodeEditor) => any): Promise<any> {\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst editor = createMockEditor(model, languageFeaturesService);\n\t\t\tconst oracle = editor.invokeWithinContext(accessor => accessor.get(IInstantiationService).createInstance(SuggestModel, editor));\n\t\t\tdisposables.add(oracle);\n\t\t\tdisposables.add(editor);\n\n\t\t\ttry {\n\t\t\t\tresolve(callback(oracle, editor));\n\t\t\t} catch (err) {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction assertEvent<E>(event: Event<E>, action: () => any, assert: (e: E) => any) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst sub = event(e => {\n\t\t\t\tsub.dispose();\n\t\t\t\ttry {\n\t\t\t\t\tresolve(assert(e));\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t\ttry {\n\t\t\t\taction();\n\t\t\t} catch (err) {\n\t\t\t\tsub.dispose();\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\ttest('events - cancel/trigger', function () {\n\t\treturn withOracle(model => {\n\n\t\t\treturn Promise.all([\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, true);\n\n\t\t\t\t\treturn assertEvent(model.onDidCancel, function () {\n\t\t\t\t\t\tmodel.cancel();\n\t\t\t\t\t}, function (event) {\n\t\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t\t});\n\t\t\t\t}),\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, true);\n\t\t\t\t}),\n\n\t\t\t\tassertEvent(model.onDidTrigger, function () {\n\t\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.auto, false);\n\t\t\t\t})\n\t\t\t]);\n\t\t});\n\t});\n\n\n\ttest('events - suggest/empty', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysEmptySupport));\n\n\t\treturn withOracle(model => {\n\t\t\treturn Promise.all([\n\t\t\t\tassertEvent(model.onDidCancel, function () {\n\t\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t}),\n\t\t\t\tassertEvent(model.onDidSuggest, function () {\n\t\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t\t}, function (event) {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 0);\n\t\t\t\t})\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('trigger - on type', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'd' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('#17400: Keep filtering suggestModel.ts after space', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'My Table',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'My Table',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// make sure completionModel starts here!\n\t\t\t\tmodel.trigger({ auto: true });\n\t\t\t}, event => {\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'My' });\n\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\t\tassert.strictEqual(first.completion.label, 'My Table');\n\n\t\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\t\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' ' });\n\n\t\t\t\t\t}, event => {\n\t\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\t\t\tassert.strictEqual(first.completion.label, 'My Table');\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('#21484: Trigger character always force a new completion session', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo.bar',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo.bar',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'boom',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'boom',\n\t\t\t\t\t\trange: Range.fromPositions(\n\t\t\t\t\t\t\tpos.delta(0, doc.getLineContent(pos.lineNumber)[pos.column - 2] === '.' ? 0 : -1),\n\t\t\t\t\t\t\tpos\n\t\t\t\t\t\t)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'foo' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\t// SYNC\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// nothing -> triggered by the trigger character typing (see above)\n\n\t\t\t}, event => {\n\t\t\t\t// ASYNC\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tconst [first, second] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'foo.bar');\n\t\t\t\tassert.strictEqual(second.completion.label, 'boom');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Intellisense Completion doesn\\'t respect space after equal sign (.html file), #29353 [1/2]', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('fo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '+' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Intellisense Completion doesn\\'t respect space after equal sign (.html file), #29353 [2/2]', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('fo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.isFrozen, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' ' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Incomplete suggestion results cause re-triggering when typing w/o further context, #28400 (1/2)', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('foo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidCancel, () => {\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ';' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.retrigger, false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Incomplete suggestion results cause re-triggering when typing w/o further context, #28400 (2/2)', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'foo;',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foo',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\teditor.getModel()!.setValue('foo');\n\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\tmodel.trigger({ auto: false });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\t// while we cancel incrementally enriching the set of\n\t\t\t\t\t// completions we still filter against those that we have\n\t\t\t\t\t// until now\n\t\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ';' });\n\t\t\t\t}, event => {\n\t\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\t\tassert.strictEqual(event.completionModel.getIncompleteProvider().size, 1);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Trigger character is provided in suggest context', function () {\n\t\tlet triggerCharacter = '';\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, context): CompletionList {\n\t\t\t\tassert.strictEqual(context.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\ttriggerCharacter = context.triggerCharacter!;\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'foo.bar',\n\t\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\t\tinsertText: 'foo.bar',\n\t\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'foo.' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(triggerCharacter, '.');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Mac press and hold accent character insertion does not update suggestions, #35269', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'abc',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'abc',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'bc',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'bc',\n\t\t\t\t\t\trange: Range.fromPositions(pos.with(undefined, 1), pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('');\n\t\treturn withOracle((model, editor) => {\n\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 1 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'a' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].completion.label, 'abc');\n\n\t\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\t\teditor.executeEdits('test', [EditOperation.replace(new Range(1, 1, 1, 2), '')]);\n\n\t\t\t\t}, event => {\n\t\t\t\t\t// suggest model changed to bc\n\t\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\t\tassert.strictEqual(event.completionModel.items[0].completion.label, 'bc');\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Backspace should not always cancel code completion, #36491', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle(async (model, editor) => {\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 4 });\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'd' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.runCommand(CoreEditingCommands.DeleteLeft, null);\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Text changes for completion CodeAction are affected by the completion #39893', function () {\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos): CompletionList {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'bar',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'bar',\n\t\t\t\t\t\trange: Range.fromPositions(pos.delta(0, -2), pos),\n\t\t\t\t\t\tadditionalTextEdits: [{\n\t\t\t\t\t\t\ttext: ', bar',\n\t\t\t\t\t\t\trange: { startLineNumber: 1, endLineNumber: 1, startColumn: 17, endColumn: 17 }\n\t\t\t\t\t\t}]\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tmodel.setValue('ba; import { foo } from \"./b\"');\n\n\t\treturn withOracle(async (sugget, editor) => {\n\t\t\tclass TestCtrl extends SuggestController {\n\t\t\t\t_insertSuggestion_publicForTest(item: ISelectedSuggestion, flags: number = 0) {\n\t\t\t\t\tsuper._insertSuggestion(item, flags);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst ctrl = <TestCtrl>editor.registerAndInstantiateContribution(TestCtrl.ID, TestCtrl);\n\t\t\teditor.registerAndInstantiateContribution(SnippetController2.ID, SnippetController2);\n\n\t\t\tawait assertEvent(sugget.onDidSuggest, () => {\n\t\t\t\teditor.setPosition({ lineNumber: 1, column: 3 });\n\t\t\t\tsugget.trigger({ auto: false });\n\t\t\t}, event => {\n\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\t\t\t\tassert.strictEqual(first.completion.label, 'bar');\n\n\t\t\t\tctrl._insertSuggestion_publicForTest({ item: first, index: 0, model: event.completionModel });\n\t\t\t});\n\n\t\t\tassert.strictEqual(\n\t\t\t\tmodel.getValue(),\n\t\t\t\t'bar; import { foo, bar } from \"./b\"'\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Completion unexpectedly triggers on second keypress of an edit group in a snippet #43523', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, alwaysSomethingSupport));\n\n\t\treturn withOracle((model, editor) => {\n\t\t\treturn assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('d');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 2));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'e' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tconst [first] = event.completionModel.items;\n\n\t\t\t\tassert.strictEqual(first.provider, alwaysSomethingSupport);\n\t\t\t});\n\t\t});\n\t});\n\n\n\ttest('Fails to render completion details #47988', function () {\n\n\t\tlet disposeA = 0;\n\t\tlet disposeB = 0;\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: true,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'CompleteNot',\n\t\t\t\t\t\tinsertText: 'Incomplete',\n\t\t\t\t\t\tsortText: 'a',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tdispose() { disposeA += 1; }\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'Complete',\n\t\t\t\t\t\tinsertText: 'Complete',\n\t\t\t\t\t\tsortText: 'z',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tdispose() { disposeB += 1; }\n\t\t\t\t};\n\t\t\t},\n\t\t\tresolveCompletionItem(item) {\n\t\t\t\treturn item;\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'c' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(disposeA, 0);\n\t\t\t\tassert.strictEqual(disposeB, 0);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\n\t\t\t\t// clean up\n\t\t\t\tmodel.clear();\n\t\t\t\tassert.strictEqual(disposeA, 2); // provide got called two times!\n\t\t\t\tassert.strictEqual(disposeB, 1);\n\t\t\t});\n\n\t\t});\n\t});\n\n\n\ttest('Trigger (full) completions when (incomplete) completions are already active #99504', function () {\n\n\t\tlet countA = 0;\n\t\tlet countB = 0;\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tcountA += 1;\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false, // doesn't matter if incomplete or not\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'Z aaa',\n\t\t\t\t\t\tinsertText: 'Z aaa',\n\t\t\t\t\t\trange: new Range(1, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tcountB += 1;\n\t\t\t\tif (!doc.getWordUntilPosition(pos).word.startsWith('a')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Folder,\n\t\t\t\t\t\tlabel: 'aaa',\n\t\t\t\t\t\tinsertText: 'aaa',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'Z' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'Z aaa');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\t// started another word: Z a|\n\t\t\t\t// item should be: Z aaa, aaa\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: ' a' });\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'Z aaa');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'aaa');\n\n\t\t\t\tassert.strictEqual(countA, 1); // should we keep the suggestions from the \"active\" provider?, Yes! See: #106573\n\t\t\t\tassert.strictEqual(countB, 2);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('registerCompletionItemProvider with letters as trigger characters block other completion items to show up #127815', async function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'AAAA',\n\t\t\t\t\t\tinsertText: 'WordTriggerA',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['a', '.'],\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'AAAA',\n\t\t\t\t\t\tinsertText: 'AutoTriggerA',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, pos.column, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async (model, editor) => {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\n\t\t\teditor.getModel().setValue('');\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'a' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Unexpected suggest scoring #167242', async function () {\n\t\tdisposables.add(registry.register('*', {\n\t\t\t// word-based\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\tconst word = doc.getWordUntilPosition(pos);\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'pull',\n\t\t\t\t\t\tinsertText: 'pull',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t// JSON-based\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'git.pull',\n\t\t\t\t\t\tinsertText: 'git.pull',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('gi');\n\t\t\t\teditor.setSelection(new Selection(1, 3, 1, 3));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 't' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'git.pull');\n\t\t\t});\n\n\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'p' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'git.pull');\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Completion list closes unexpectedly when typing a digit after a word separator #169390', function () {\n\n\t\tconst requestCounts = [0, 0];\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\n\t\t\tprovideCompletionItems(doc, pos) {\n\t\t\t\trequestCounts[0] += 1;\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'foo-20',\n\t\t\t\t\t\tinsertText: 'foo-20',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tkind: CompletionItemKind.Text,\n\t\t\t\t\t\tlabel: 'foo-hello',\n\t\t\t\t\t\tinsertText: 'foo-hello',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['2'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\trequestCounts[1] += 1;\n\t\t\t\tif (ctx.triggerKind !== CompletionTriggerKind.TriggerCharacter) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tlabel: 'foo-210',\n\t\t\t\t\t\tinsertText: 'foo-210',\n\t\t\t\t\t\trange: new Range(pos.lineNumber, 1, pos.lineNumber, pos.column)\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('foo');\n\t\t\t\teditor.setSelection(new Selection(1, 4, 1, 4));\n\t\t\t\tmodel.trigger({ auto: false });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, false);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'foo-20');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'foo-hello');\n\t\t\t});\n\n\t\t\teditor.trigger('keyboard', Handler.Type, { text: '-' });\n\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '2' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'foo-20');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'foo-210');\n\t\t\t\tassert.deepStrictEqual(requestCounts, [1, 2]);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Set refilter-flag, keep triggerKind', function () {\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: doc.getWordUntilPosition(pos).word || 'hello',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'foofoo',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('foo');\n\t\t\t\teditor.setSelection(new Selection(1, 4, 1, 4));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, undefined);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: '.' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.refilter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, '.');\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'h' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.refilter, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, '.');\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerCharacter);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 1);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('Snippets gone from IntelliSense #173244', function () {\n\n\t\tconst snippetProvider: CompletionItemProvider = {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'log',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'log',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tconst old = setSnippetSuggestSupport(snippetProvider);\n\n\t\tdisposables.add(toDisposable(() => {\n\t\t\tif (getSnippetSuggestSupport() === snippetProvider) {\n\t\t\t\tsetSnippetSuggestSupport(old);\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(registry.register({ scheme: 'test' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\ttriggerCharacters: ['.'],\n\t\t\tprovideCompletionItems(doc, pos, ctx) {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'locals',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'locals',\n\t\t\t\t\t\trange: getDefaultSuggestRange(doc, pos)\n\t\t\t\t\t}],\n\t\t\t\t\tincomplete: true\n\t\t\t\t};\n\t\t\t},\n\t\t}));\n\n\t\treturn withOracle(async function (model, editor) {\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.setValue('');\n\t\t\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'l' });\n\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerCharacter, undefined);\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, undefined);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'locals');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'log');\n\t\t\t});\n\n\t\t\tawait assertEvent(model.onDidSuggest, () => {\n\t\t\t\teditor.trigger('keyboard', Handler.Type, { text: 'o' });\n\n\t\t\t}, event => {\n\t\t\t\tassert.strictEqual(event.triggerOptions.triggerKind, CompletionTriggerKind.TriggerForIncompleteCompletions);\n\t\t\t\tassert.strictEqual(event.triggerOptions.auto, true);\n\t\t\t\tassert.strictEqual(event.completionModel.items.length, 2);\n\t\t\t\tassert.strictEqual(event.completionModel.items[0].textLabel, 'locals');\n\t\t\t\tassert.strictEqual(event.completionModel.items[1].textLabel, 'log');\n\t\t\t});\n\n\t\t});\n\t});\n});\n"]}