{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/suggest/test/browser/suggestMemory.test.ts","vs/editor/contrib/suggest/test/browser/suggestMemory.test.ts"],"names":[],"mappings":"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","file":"suggestMemory.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IPosition } from '../../../../common/core/position.js';\nimport { ITextModel } from '../../../../common/model.js';\nimport { CompletionItem } from '../../browser/suggest.js';\nimport { LRUMemory, Memory, NoMemory, PrefixMemory } from '../../browser/suggestMemory.js';\nimport { createSuggestItem } from './completionModel.test.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\n\nsuite('SuggestMemories', function () {\n\n\tlet pos: IPosition;\n\tlet buffer: ITextModel;\n\tlet items: CompletionItem[];\n\n\tsetup(function () {\n\t\tpos = { lineNumber: 1, column: 1 };\n\t\tbuffer = createTextModel('This is some text.\\nthis.\\nfoo: ,');\n\t\titems = [\n\t\t\tcreateSuggestItem('foo', 0),\n\t\t\tcreateSuggestItem('bar', 0)\n\t\t];\n\t});\n\n\tteardown(() => {\n\t\tbuffer.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('AbstractMemory, select', function () {\n\n\t\tconst mem = new class extends Memory {\n\t\t\tconstructor() {\n\t\t\t\tsuper('first');\n\t\t\t}\n\t\t\tmemorize(model: ITextModel, pos: IPosition, item: CompletionItem): void {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t} toJSON(): object {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t}\n\t\t\tfromJSON(data: object): void {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t}\n\t\t};\n\n\t\tconst item1 = createSuggestItem('fazz', 0);\n\t\tconst item2 = createSuggestItem('bazz', 0);\n\t\tconst item3 = createSuggestItem('bazz', 0);\n\t\tconst item4 = createSuggestItem('bazz', 0);\n\t\titem1.completion.preselect = false;\n\t\titem2.completion.preselect = true;\n\t\titem3.completion.preselect = true;\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [item1, item2, item3, item4]), 1);\n\t});\n\n\ttest('[No|Prefix|LRU]Memory honor selection boost', function () {\n\t\tconst item1 = createSuggestItem('fazz', 0);\n\t\tconst item2 = createSuggestItem('bazz', 0);\n\t\tconst item3 = createSuggestItem('bazz', 0);\n\t\tconst item4 = createSuggestItem('bazz', 0);\n\t\titem1.completion.preselect = false;\n\t\titem2.completion.preselect = true;\n\t\titem3.completion.preselect = true;\n\t\tconst items = [item1, item2, item3, item4];\n\n\n\t\tassert.strictEqual(new NoMemory().select(buffer, pos, items), 1);\n\t\tassert.strictEqual(new LRUMemory().select(buffer, pos, items), 1);\n\t\tassert.strictEqual(new PrefixMemory().select(buffer, pos, items), 1);\n\t});\n\n\ttest('NoMemory', () => {\n\n\t\tconst mem = new NoMemory();\n\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, pos, []), 0);\n\n\t\tmem.memorize(buffer, pos, items[0]);\n\t\tmem.memorize(buffer, pos, null!);\n\t});\n\n\ttest('LRUMemory', () => {\n\n\t\tpos = { lineNumber: 2, column: 6 };\n\n\t\tconst mem = new LRUMemory();\n\t\tmem.memorize(buffer, pos, items[1]);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 1);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 3 }, items), 0);\n\n\t\tmem.memorize(buffer, pos, items[0]);\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 0);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [\n\t\t\tcreateSuggestItem('new', 0),\n\t\t\tcreateSuggestItem('bar', 0)\n\t\t]), 1);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [\n\t\t\tcreateSuggestItem('new1', 0),\n\t\t\tcreateSuggestItem('new2', 0)\n\t\t]), 0);\n\t});\n\n\ttest('`\"editor.suggestSelection\": \"recentlyUsed\"` should be a little more sticky #78571', function () {\n\n\t\tconst item1 = createSuggestItem('gamma', 0);\n\t\tconst item2 = createSuggestItem('game', 0);\n\t\titems = [item1, item2];\n\n\t\tconst mem = new LRUMemory();\n\t\tbuffer.setValue('    foo.');\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 1 }, item2);\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 2 }, items), 0); // leading whitespace -> ignore recent items\n\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 9 }, item2);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 9 }, items), 1); // foo.\n\n\t\tbuffer.setValue('    foo.g');\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 10 }, items), 1); // foo.g, 'gamma' and 'game' have the same score\n\n\t\titem1.score = [10, 0, 0];\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 10 }, items), 0); // foo.g, 'gamma' has higher score\n\n\t});\n\n\ttest('intellisense is not showing top options first #43429', function () {\n\t\t// ensure we don't memorize for whitespace prefixes\n\n\t\tpos = { lineNumber: 2, column: 6 };\n\t\tconst mem = new LRUMemory();\n\n\t\tmem.memorize(buffer, pos, items[1]);\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 1);\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 3, column: 5 }, items), 0); // foo: |,\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 3, column: 6 }, items), 1); // foo: ,|\n\t});\n\n\ttest('PrefixMemory', () => {\n\n\t\tconst mem = new PrefixMemory();\n\t\tbuffer.setValue('constructor');\n\t\tconst item0 = createSuggestItem('console', 0);\n\t\tconst item1 = createSuggestItem('const', 0);\n\t\tconst item2 = createSuggestItem('constructor', 0);\n\t\tconst item3 = createSuggestItem('constant', 0);\n\t\tconst items = [item0, item1, item2, item3];\n\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 2 }, item1); // c -> const\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 3 }, item0); // co -> console\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 4 }, item2); // con -> constructor\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 1 }, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 2 }, items), 1);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 3 }, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 4 }, items), 2);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 7 }, items), 2); // find substr\n\t});\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IPosition } from '../../../../common/core/position.js';\nimport { ITextModel } from '../../../../common/model.js';\nimport { CompletionItem } from '../../browser/suggest.js';\nimport { LRUMemory, Memory, NoMemory, PrefixMemory } from '../../browser/suggestMemory.js';\nimport { createSuggestItem } from './completionModel.test.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\n\nsuite('SuggestMemories', function () {\n\n\tlet pos: IPosition;\n\tlet buffer: ITextModel;\n\tlet items: CompletionItem[];\n\n\tsetup(function () {\n\t\tpos = { lineNumber: 1, column: 1 };\n\t\tbuffer = createTextModel('This is some text.\\nthis.\\nfoo: ,');\n\t\titems = [\n\t\t\tcreateSuggestItem('foo', 0),\n\t\t\tcreateSuggestItem('bar', 0)\n\t\t];\n\t});\n\n\tteardown(() => {\n\t\tbuffer.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('AbstractMemory, select', function () {\n\n\t\tconst mem = new class extends Memory {\n\t\t\tconstructor() {\n\t\t\t\tsuper('first');\n\t\t\t}\n\t\t\tmemorize(model: ITextModel, pos: IPosition, item: CompletionItem): void {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t} toJSON(): object {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t}\n\t\t\tfromJSON(data: object): void {\n\t\t\t\tthrow new Error('Method not implemented.');\n\t\t\t}\n\t\t};\n\n\t\tconst item1 = createSuggestItem('fazz', 0);\n\t\tconst item2 = createSuggestItem('bazz', 0);\n\t\tconst item3 = createSuggestItem('bazz', 0);\n\t\tconst item4 = createSuggestItem('bazz', 0);\n\t\titem1.completion.preselect = false;\n\t\titem2.completion.preselect = true;\n\t\titem3.completion.preselect = true;\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [item1, item2, item3, item4]), 1);\n\t});\n\n\ttest('[No|Prefix|LRU]Memory honor selection boost', function () {\n\t\tconst item1 = createSuggestItem('fazz', 0);\n\t\tconst item2 = createSuggestItem('bazz', 0);\n\t\tconst item3 = createSuggestItem('bazz', 0);\n\t\tconst item4 = createSuggestItem('bazz', 0);\n\t\titem1.completion.preselect = false;\n\t\titem2.completion.preselect = true;\n\t\titem3.completion.preselect = true;\n\t\tconst items = [item1, item2, item3, item4];\n\n\n\t\tassert.strictEqual(new NoMemory().select(buffer, pos, items), 1);\n\t\tassert.strictEqual(new LRUMemory().select(buffer, pos, items), 1);\n\t\tassert.strictEqual(new PrefixMemory().select(buffer, pos, items), 1);\n\t});\n\n\ttest('NoMemory', () => {\n\n\t\tconst mem = new NoMemory();\n\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, pos, []), 0);\n\n\t\tmem.memorize(buffer, pos, items[0]);\n\t\tmem.memorize(buffer, pos, null!);\n\t});\n\n\ttest('LRUMemory', () => {\n\n\t\tpos = { lineNumber: 2, column: 6 };\n\n\t\tconst mem = new LRUMemory();\n\t\tmem.memorize(buffer, pos, items[1]);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 1);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 3 }, items), 0);\n\n\t\tmem.memorize(buffer, pos, items[0]);\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 0);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [\n\t\t\tcreateSuggestItem('new', 0),\n\t\t\tcreateSuggestItem('bar', 0)\n\t\t]), 1);\n\n\t\tassert.strictEqual(mem.select(buffer, pos, [\n\t\t\tcreateSuggestItem('new1', 0),\n\t\t\tcreateSuggestItem('new2', 0)\n\t\t]), 0);\n\t});\n\n\ttest('`\"editor.suggestSelection\": \"recentlyUsed\"` should be a little more sticky #78571', function () {\n\n\t\tconst item1 = createSuggestItem('gamma', 0);\n\t\tconst item2 = createSuggestItem('game', 0);\n\t\titems = [item1, item2];\n\n\t\tconst mem = new LRUMemory();\n\t\tbuffer.setValue('    foo.');\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 1 }, item2);\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 2 }, items), 0); // leading whitespace -> ignore recent items\n\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 9 }, item2);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 9 }, items), 1); // foo.\n\n\t\tbuffer.setValue('    foo.g');\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 10 }, items), 1); // foo.g, 'gamma' and 'game' have the same score\n\n\t\titem1.score = [10, 0, 0];\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 10 }, items), 0); // foo.g, 'gamma' has higher score\n\n\t});\n\n\ttest('intellisense is not showing top options first #43429', function () {\n\t\t// ensure we don't memorize for whitespace prefixes\n\n\t\tpos = { lineNumber: 2, column: 6 };\n\t\tconst mem = new LRUMemory();\n\n\t\tmem.memorize(buffer, pos, items[1]);\n\t\tassert.strictEqual(mem.select(buffer, pos, items), 1);\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 3, column: 5 }, items), 0); // foo: |,\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 3, column: 6 }, items), 1); // foo: ,|\n\t});\n\n\ttest('PrefixMemory', () => {\n\n\t\tconst mem = new PrefixMemory();\n\t\tbuffer.setValue('constructor');\n\t\tconst item0 = createSuggestItem('console', 0);\n\t\tconst item1 = createSuggestItem('const', 0);\n\t\tconst item2 = createSuggestItem('constructor', 0);\n\t\tconst item3 = createSuggestItem('constant', 0);\n\t\tconst items = [item0, item1, item2, item3];\n\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 2 }, item1); // c -> const\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 3 }, item0); // co -> console\n\t\tmem.memorize(buffer, { lineNumber: 1, column: 4 }, item2); // con -> constructor\n\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 1 }, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 2 }, items), 1);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 3 }, items), 0);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 4 }, items), 2);\n\t\tassert.strictEqual(mem.select(buffer, { lineNumber: 1, column: 7 }, items), 2); // find substr\n\t});\n\n});\n"]}