{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/suggest/test/browser/wordDistance.test.ts","vs/editor/contrib/suggest/test/browser/wordDistance.test.ts"],"names":[],"mappings":"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","file":"wordDistance.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { IPosition } from '../../../../common/core/position.js';\nimport { IRange } from '../../../../common/core/range.js';\nimport { DEFAULT_WORD_REGEXP } from '../../../../common/core/wordHelper.js';\nimport * as languages from '../../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { EditorWorker } from '../../../../common/services/editorWebWorker.js';\nimport { EditorWorkerService } from '../../../../browser/services/editorWorkerService.js';\nimport { IModelService } from '../../../../common/services/model.js';\nimport { ITextResourceConfigurationService } from '../../../../common/services/textResourceConfiguration.js';\nimport { CompletionItem } from '../../browser/suggest.js';\nimport { WordDistance } from '../../browser/wordDistance.js';\nimport { createCodeEditorServices, instantiateTestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { instantiateTextModel } from '../../../../test/common/testTextModel.js';\nimport { TestLanguageConfigurationService } from '../../../../test/common/modes/testLanguageConfigurationService.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { LanguageFeaturesService } from '../../../../common/services/languageFeaturesService.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\nsuite('suggest, word distance', function () {\n\n\tlet distance: WordDistance;\n\tconst disposables = new DisposableStore();\n\n\tsetup(async function () {\n\t\tconst languageId = 'bracketMode';\n\n\t\tdisposables.clear();\n\t\tconst instantiationService = createCodeEditorServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'function abc(aa, ab){\\na\\n}', languageId, undefined, URI.parse('test:///some.path')));\n\t\tconst editor = disposables.add(instantiateTestCodeEditor(instantiationService, model));\n\t\teditor.updateOptions({ suggest: { localityBonus: true } });\n\t\teditor.setPosition({ lineNumber: 2, column: 2 });\n\n\t\tconst modelService = new class extends mock<IModelService>() {\n\t\t\toverride onModelRemoved = Event.None;\n\t\t\toverride getModel(uri: URI) {\n\t\t\t\treturn uri.toString() === model.uri.toString() ? model : null;\n\t\t\t}\n\t\t};\n\n\t\tconst service = new class extends EditorWorkerService {\n\n\t\t\tprivate _worker = new EditorWorker();\n\n\t\t\tconstructor() {\n\t\t\t\tsuper(modelService, new class extends mock<ITextResourceConfigurationService>() { }, new NullLogService(), new TestLanguageConfigurationService(), new LanguageFeaturesService(), null!);\n\t\t\t\tthis._worker.$acceptNewModel({\n\t\t\t\t\turl: model.uri.toString(),\n\t\t\t\t\tlines: model.getLinesContent(),\n\t\t\t\t\tEOL: model.getEOL(),\n\t\t\t\t\tversionId: model.getVersionId()\n\t\t\t\t});\n\t\t\t\tmodel.onDidChangeContent(e => this._worker.$acceptModelChanged(model.uri.toString(), e));\n\t\t\t}\n\t\t\toverride computeWordRanges(resource: URI, range: IRange): Promise<{ [word: string]: IRange[] } | null> {\n\t\t\t\treturn this._worker.$computeWordRanges(resource.toString(), range, DEFAULT_WORD_REGEXP.source, DEFAULT_WORD_REGEXP.flags);\n\t\t\t}\n\t\t};\n\n\t\tdistance = await WordDistance.create(service, editor);\n\n\t\tdisposables.add(service);\n\t});\n\n\tteardown(function () {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction createSuggestItem(label: string, overwriteBefore: number, position: IPosition): CompletionItem {\n\t\tconst suggestion: languages.CompletionItem = {\n\t\t\tlabel,\n\t\t\trange: { startLineNumber: position.lineNumber, startColumn: position.column - overwriteBefore, endLineNumber: position.lineNumber, endColumn: position.column },\n\t\t\tinsertText: label,\n\t\t\tkind: 0\n\t\t};\n\t\tconst container: languages.CompletionList = {\n\t\t\tsuggestions: [suggestion]\n\t\t};\n\t\tconst provider: languages.CompletionItemProvider = {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(): any {\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\t\treturn new CompletionItem(position, suggestion, container, provider);\n\t}\n\n\ttest('Suggest locality bonus can boost current word #90515', function () {\n\t\tconst pos = { lineNumber: 2, column: 2 };\n\t\tconst d1 = distance.distance(pos, createSuggestItem('a', 1, pos).completion);\n\t\tconst d2 = distance.distance(pos, createSuggestItem('aa', 1, pos).completion);\n\t\tconst d3 = distance.distance(pos, createSuggestItem('ab', 1, pos).completion);\n\n\t\tassert.ok(d1 > d2);\n\t\tassert.ok(d2 === d3);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { IPosition } from '../../../../common/core/position.js';\nimport { IRange } from '../../../../common/core/range.js';\nimport { DEFAULT_WORD_REGEXP } from '../../../../common/core/wordHelper.js';\nimport * as languages from '../../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { EditorWorker } from '../../../../common/services/editorWebWorker.js';\nimport { EditorWorkerService } from '../../../../browser/services/editorWorkerService.js';\nimport { IModelService } from '../../../../common/services/model.js';\nimport { ITextResourceConfigurationService } from '../../../../common/services/textResourceConfiguration.js';\nimport { CompletionItem } from '../../browser/suggest.js';\nimport { WordDistance } from '../../browser/wordDistance.js';\nimport { createCodeEditorServices, instantiateTestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { instantiateTextModel } from '../../../../test/common/testTextModel.js';\nimport { TestLanguageConfigurationService } from '../../../../test/common/modes/testLanguageConfigurationService.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { LanguageFeaturesService } from '../../../../common/services/languageFeaturesService.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\nsuite('suggest, word distance', function () {\n\n\tlet distance: WordDistance;\n\tconst disposables = new DisposableStore();\n\n\tsetup(async function () {\n\t\tconst languageId = 'bracketMode';\n\n\t\tdisposables.clear();\n\t\tconst instantiationService = createCodeEditorServices(disposables);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tdisposables.add(languageService.registerLanguage({ id: languageId }));\n\t\tdisposables.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\n\t\tconst model = disposables.add(instantiateTextModel(instantiationService, 'function abc(aa, ab){\\na\\n}', languageId, undefined, URI.parse('test:///some.path')));\n\t\tconst editor = disposables.add(instantiateTestCodeEditor(instantiationService, model));\n\t\teditor.updateOptions({ suggest: { localityBonus: true } });\n\t\teditor.setPosition({ lineNumber: 2, column: 2 });\n\n\t\tconst modelService = new class extends mock<IModelService>() {\n\t\t\toverride onModelRemoved = Event.None;\n\t\t\toverride getModel(uri: URI) {\n\t\t\t\treturn uri.toString() === model.uri.toString() ? model : null;\n\t\t\t}\n\t\t};\n\n\t\tconst service = new class extends EditorWorkerService {\n\n\t\t\tprivate _worker = new EditorWorker();\n\n\t\t\tconstructor() {\n\t\t\t\tsuper(modelService, new class extends mock<ITextResourceConfigurationService>() { }, new NullLogService(), new TestLanguageConfigurationService(), new LanguageFeaturesService(), null!);\n\t\t\t\tthis._worker.$acceptNewModel({\n\t\t\t\t\turl: model.uri.toString(),\n\t\t\t\t\tlines: model.getLinesContent(),\n\t\t\t\t\tEOL: model.getEOL(),\n\t\t\t\t\tversionId: model.getVersionId()\n\t\t\t\t});\n\t\t\t\tmodel.onDidChangeContent(e => this._worker.$acceptModelChanged(model.uri.toString(), e));\n\t\t\t}\n\t\t\toverride computeWordRanges(resource: URI, range: IRange): Promise<{ [word: string]: IRange[] } | null> {\n\t\t\t\treturn this._worker.$computeWordRanges(resource.toString(), range, DEFAULT_WORD_REGEXP.source, DEFAULT_WORD_REGEXP.flags);\n\t\t\t}\n\t\t};\n\n\t\tdistance = await WordDistance.create(service, editor);\n\n\t\tdisposables.add(service);\n\t});\n\n\tteardown(function () {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction createSuggestItem(label: string, overwriteBefore: number, position: IPosition): CompletionItem {\n\t\tconst suggestion: languages.CompletionItem = {\n\t\t\tlabel,\n\t\t\trange: { startLineNumber: position.lineNumber, startColumn: position.column - overwriteBefore, endLineNumber: position.lineNumber, endColumn: position.column },\n\t\t\tinsertText: label,\n\t\t\tkind: 0\n\t\t};\n\t\tconst container: languages.CompletionList = {\n\t\t\tsuggestions: [suggestion]\n\t\t};\n\t\tconst provider: languages.CompletionItemProvider = {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(): any {\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\t\treturn new CompletionItem(position, suggestion, container, provider);\n\t}\n\n\ttest('Suggest locality bonus can boost current word #90515', function () {\n\t\tconst pos = { lineNumber: 2, column: 2 };\n\t\tconst d1 = distance.distance(pos, createSuggestItem('a', 1, pos).completion);\n\t\tconst d2 = distance.distance(pos, createSuggestItem('aa', 1, pos).completion);\n\t\tconst d3 = distance.distance(pos, createSuggestItem('ab', 1, pos).completion);\n\n\t\tassert.ok(d1 > d2);\n\t\tassert.ok(d2 === d3);\n\t});\n});\n"]}