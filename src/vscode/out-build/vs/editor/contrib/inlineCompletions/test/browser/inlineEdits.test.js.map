{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/inlineCompletions/test/browser/inlineEdits.test.ts","vs/editor/contrib/inlineCompletions/test/browser/inlineEdits.test.ts"],"names":[],"mappings":"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","file":"inlineEdits.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { AnnotatedText, InlineEditContext, IWithAsyncTestCodeEditorAndInlineCompletionsModel, MockSearchReplaceCompletionsProvider, withAsyncTestCodeEditorAndInlineCompletionsModel } from './utils.js';\n\nsuite('Inline Edits', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst val = new AnnotatedText(`\nclass Point {\n\tconstructor(public x: number, public y: number) {}\n\n\tgetLength2D(): number {\n\t\treturn↓ Math.sqrt(this.x * this.x + this.y * this.y↓);\n\t}\n}\n`);\n\n\tasync function runTest(cb: (ctx: IWithAsyncTestCodeEditorAndInlineCompletionsModel, provider: MockSearchReplaceCompletionsProvider, view: InlineEditContext) => Promise<void>): Promise<void> {\n\t\tconst provider = new MockSearchReplaceCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel(val.value,\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync (ctx) => {\n\t\t\t\tconst view = new InlineEditContext(ctx.model, ctx.editor);\n\t\t\t\tctx.store.add(view);\n\t\t\t\tawait cb(ctx, provider, view);\n\t\t\t}\n\t\t);\n\t}\n\n\ttest('Can Accept Inline Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\tmodel.accept();\n\n\t\t\tassert.deepStrictEqual(editor.getValue(), `\nclass Point {\n\tconstructor(public x: number, public y: number) {}\n\n\tgetLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}\n}\n`);\n\t\t});\n\t});\n\n\ttest('Can Type Inline Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditor.setPosition(val.getMarkerPosition(1));\n\t\t\teditorViewModel.type(' + t');\n\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...this.y + t❰his.z...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditorViewModel.type('his.z * this.z');\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...'\n\t\t\t]));\n\t\t});\n\t});\n\n\ttest('Inline Edit Stays On Unrelated Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditor.setPosition(val.getMarkerPosition(0));\n\t\t\teditorViewModel.type('/* */');\n\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined\n\t\t\t]));\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { AnnotatedText, InlineEditContext, IWithAsyncTestCodeEditorAndInlineCompletionsModel, MockSearchReplaceCompletionsProvider, withAsyncTestCodeEditorAndInlineCompletionsModel } from './utils.js';\n\nsuite('Inline Edits', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst val = new AnnotatedText(`\nclass Point {\n\tconstructor(public x: number, public y: number) {}\n\n\tgetLength2D(): number {\n\t\treturn↓ Math.sqrt(this.x * this.x + this.y * this.y↓);\n\t}\n}\n`);\n\n\tasync function runTest(cb: (ctx: IWithAsyncTestCodeEditorAndInlineCompletionsModel, provider: MockSearchReplaceCompletionsProvider, view: InlineEditContext) => Promise<void>): Promise<void> {\n\t\tconst provider = new MockSearchReplaceCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel(val.value,\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync (ctx) => {\n\t\t\t\tconst view = new InlineEditContext(ctx.model, ctx.editor);\n\t\t\t\tctx.store.add(view);\n\t\t\t\tawait cb(ctx, provider, view);\n\t\t\t}\n\t\t);\n\t}\n\n\ttest('Can Accept Inline Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\tmodel.accept();\n\n\t\t\tassert.deepStrictEqual(editor.getValue(), `\nclass Point {\n\tconstructor(public x: number, public y: number) {}\n\n\tgetLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}\n}\n`);\n\t\t});\n\t});\n\n\ttest('Can Type Inline Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditor.setPosition(val.getMarkerPosition(1));\n\t\t\teditorViewModel.type(' + t');\n\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...this.y + t❰his.z...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditorViewModel.type('his.z * this.z');\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...'\n\t\t\t]));\n\t\t});\n\t});\n\n\ttest('Inline Edit Stays On Unrelated Edit', async function () {\n\t\tawait runTest(async ({ context, model, editor, editorViewModel }, provider, view) => {\n\t\t\tprovider.add(`getLength2D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}`, `getLength3D(): number {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t}`);\n\t\t\tawait model.trigger();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined,\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\teditor.setPosition(val.getMarkerPosition(0));\n\t\t\teditorViewModel.type('/* */');\n\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\t'\\n\\tget❰Length2↦Length3❱D(): numbe...\\n...y * this.y❰ + th...his.z❱);\\n'\n\t\t\t]));\n\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(view.getAndClearViewStates(), ([\n\t\t\t\tundefined\n\t\t\t]));\n\t\t});\n\t});\n});\n"]}