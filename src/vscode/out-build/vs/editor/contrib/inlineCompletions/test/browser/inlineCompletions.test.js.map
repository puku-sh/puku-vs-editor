{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/inlineCompletions/test/browser/inlineCompletions.test.ts","vs/editor/contrib/inlineCompletions/test/browser/inlineCompletions.test.ts"],"names":[],"mappings":"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","file":"inlineCompletions.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { InlineCompletionsModel } from '../../browser/model/inlineCompletionsModel.js';\nimport { IWithAsyncTestCodeEditorAndInlineCompletionsModel, MockInlineCompletionsProvider, withAsyncTestCodeEditorAndInlineCompletionsModel } from './utils.js';\nimport { ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { Selection } from '../../../../common/core/selection.js';\n\nsuite('Inline Completions', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Does not trigger automatically if disabled', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: false } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\t// Provider is not called, no ghost text is shown.\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is shown after trigger', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is shown automatically when configured', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is updated automatically', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobizz', range: new Range(1, 1, 1, 6) });\n\t\t\t\tcontext.keyboardType('b');\n\t\t\t\tcontext.keyboardType('i');\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, },\n\t\t\t\t\t{ position: '(1,6)', text: 'foobi', triggerKind: 0, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tcontext.getAndClearViewStates(),\n\t\t\t\t\t['', 'foo[bar]', 'foob[ar]', 'foobi', 'foobi[zz]']\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Unindent whitespace', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('  ');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 2, 1, 3) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', '  [foo]']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,3)', text: '  ', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [' foo']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Unindent tab', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('\\t\\t');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 2, 1, 3) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', '\\t\\t[foo]']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,3)', text: '\\t\\t', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['\\tfoo']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('No unindent after indentation', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('buzz  ');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 6, 1, 7) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,7)', text: 'buzz  ', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Next/previous', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar1', range: new Range(1, 1, 1, 4) });\n\t\t\t\tmodel.trigger();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tcontext.getAndClearViewStates(),\n\t\t\t\t\t['', 'foo[bar1]']\n\t\t\t\t);\n\n\t\t\t\tprovider.setReturnValues([\n\t\t\t\t\t{ insertText: 'foobar1', range: new Range(1, 1, 1, 4) },\n\t\t\t\t\t{ insertText: 'foobizz2', range: new Range(1, 1, 1, 4) },\n\t\t\t\t\t{ insertText: 'foobuzz3', range: new Range(1, 1, 1, 4) }\n\t\t\t\t]);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bizz2]']);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[buzz3]']);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bar1]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[buzz3]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bizz2]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bar1]']);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, },\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, },\n\t\t\t\t]);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Calling the provider is debounced', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tmodel.trigger();\n\n\t\t\t\tcontext.keyboardType('f');\n\t\t\t\tawait timeout(40);\n\t\t\t\tcontext.keyboardType('o');\n\t\t\t\tawait timeout(40);\n\t\t\t\tcontext.keyboardType('o');\n\t\t\t\tawait timeout(40);\n\n\t\t\t\t// The provider is not called\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\n\t\t\t\tawait timeout(400);\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t]);\n\n\t\t\t\tprovider.assertNotCalledTwiceWithin50ms();\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Backspace is debounced', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tfor (let j = 0; j < 2; j++) {\n\t\t\t\t\tfor (let i = 0; i < 3; i++) {\n\t\t\t\t\t\tcontext.leftDelete();\n\t\t\t\t\t\tawait timeout(5);\n\t\t\t\t\t}\n\n\t\t\t\t\tcontext.keyboardType('bar');\n\t\t\t\t}\n\n\t\t\t\tawait timeout(400);\n\n\t\t\t\tprovider.assertNotCalledTwiceWithin50ms();\n\t\t\t}\n\t\t);\n\t});\n\n\n\tsuite('Forward Stability', () => {\n\t\ttest('Typing agrees', async function () {\n\t\t\t// The user types the text as suggested and the provider is forward-stable\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', });\n\t\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\t\tmodel.trigger();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\n\t\t\t\t\tcontext.keyboardType('b');\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['foob[ar]']));\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,5)', text: 'foob', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\n\t\t\t\t\tcontext.keyboardType('a');\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['fooba[r]']));\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,6)', text: 'fooba', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\tasync function setupScenario({ editor, editorViewModel, model, context, store }: IWithAsyncTestCodeEditorAndInlineCompletionsModel, provider: MockInlineCompletionsProvider): Promise<void> {\n\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\t\t\tprovider.setReturnValue({ insertText: 'foo bar' });\n\t\t\tcontext.keyboardType('f');\n\t\t\tmodel.triggerExplicitly();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,2)', triggerKind: 1, text: 'f' }]));\n\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['f[oo bar]']));\n\n\t\t\tprovider.setReturnValue({ insertText: 'foo baz' });\n\t\t\tawait timeout(10000);\n\t\t}\n\n\t\ttest('Support forward instability', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tctx.context.keyboardType('o');\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ['fo[o bar]']);\n\t\t\t\t\tawait timeout(10000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,3)', text: 'fo', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ['fo[o baz]']);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\n\t\ttest('when accepting word by word', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\t\t\t// Even when triggering explicitly, we want to keep the suggestion.\n\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tawait ctx.model.acceptNextWord();\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\n\t\t\t\t\tawait ctx.model.triggerExplicitly(); // reset to provider truth\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('when accepting undo', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tawait ctx.model.acceptNextWord();\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\n\t\t\t\t\tawait ctx.editor.getModel().undo();\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['f[oo bar]']));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,2)', triggerKind: 0, text: 'f' }]));\n\n\t\t\t\t\tawait ctx.editor.getModel().redo();\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('Support backward instability', async function () {\n\t\t\t// The user deletes text and the suggestion changes\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tcontext.keyboardType('fooba');\n\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 6) });\n\n\t\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,6)', text: 'fooba', triggerKind: 1, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'fooba[r]']);\n\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobaz', range: new Range(1, 1, 1, 5) });\n\t\t\t\t\tcontext.leftDelete();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,5)', text: 'foob', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t\t'foob[ar]',\n\t\t\t\t\t\t'foob[az]'\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('Push item to preserve to front', async function () {\n\t\t\tconst provider = new MockInlineCompletionsProvider(true);\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\t\tawait timeout(1000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tposition: '(1,4)',\n\t\t\t\t\t\t\ttriggerKind: 0,\n\t\t\t\t\t\t\ttext: 'foo'\n\t\t\t\t\t\t}\n\t\t\t\t\t]));\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(),\n\t\t\t\t\t\t([\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\t'foo[bar]'\n\t\t\t\t\t\t])\n\t\t\t\t\t);\n\n\t\t\t\t\tprovider.setReturnValues([{ insertText: 'foobar1', range: new Range(1, 1, 1, 4) }, { insertText: 'foobar', range: new Range(1, 1, 1, 4) }]);\n\n\t\t\t\t\tawait model.triggerExplicitly();\n\t\t\t\t\tawait timeout(1000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tposition: '(1,4)',\n\t\t\t\t\t\t\ttriggerKind: 1,\n\t\t\t\t\t\t\ttext: 'foo'\n\t\t\t\t\t\t}\n\t\t\t\t\t]));\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(),\n\t\t\t\t\t\t([])\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('No race conditions', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('h');\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 2) }, 1000);\n\n\t\t\t\tmodel.triggerExplicitly();\n\n\t\t\t\tawait timeout(1030);\n\t\t\t\tcontext.keyboardType('ello');\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 6) }, 1000);\n\n\t\t\t\t// after 20ms: Inline completion provider answers back\n\t\t\t\t// after 50ms: Debounce is triggered\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'hello[world]',\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('Do not reuse cache from previous session (#132516)', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('hello\\n');\n\t\t\t\tcontext.cursorLeft();\n\t\t\t\tcontext.keyboardType('x');\n\t\t\t\tcontext.leftDelete();\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 6) }, 1000);\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{\n\t\t\t\t\t\tposition: '(1,6)',\n\t\t\t\t\t\ttext: 'hello\\n',\n\t\t\t\t\t\ttriggerKind: 0,\n\t\t\t\t\t}\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(2, 1, 2, 6) }, 1000);\n\n\t\t\t\tcontext.cursorDown();\n\t\t\t\tcontext.keyboardType('hello');\n\t\t\t\tawait timeout(40);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\n\t\t\t\t// Update ghost text\n\t\t\t\tcontext.keyboardType('w');\n\t\t\t\tcontext.leftDelete();\n\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(2,6)', triggerKind: 0, text: 'hello\\nhello' },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'hello[world]\\n',\n\t\t\t\t\t'hello\\n',\n\t\t\t\t\t'hello\\nhello[world]',\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('Additional Text Edits', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('buzz\\nbaz');\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'bazz',\n\t\t\t\t\trange: new Range(2, 1, 2, 4),\n\t\t\t\t\tadditionalTextEdits: [{\n\t\t\t\t\t\trange: new Range(1, 1, 1, 5),\n\t\t\t\t\t\ttext: 'bla'\n\t\t\t\t\t}],\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(2,4)', triggerKind: 1, text: 'buzz\\nbaz' }]));\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'buzz\\nbaz[z]',\n\t\t\t\t\t'bla\\nbazz',\n\t\t\t\t]);\n\t\t\t}\n\t\t);\n\t});\n});\n\nsuite('Multi Cursor Support', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Basic', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console\\nconsole\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 1000, 1, 1000),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Multi Part', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console.log()\\nconsole.log\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.log`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Multi Part and Different Cursor Columns', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console.log()\\nconsole.warn\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 14, 2, 14),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.warn`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\tasync function acceptNextWord(model: InlineCompletionsModel, editor: ITestCodeEditor, timesToAccept: number = 1): Promise<void> {\n\t\tfor (let i = 0; i < timesToAccept; i++) {\n\t\t\tmodel.triggerExplicitly();\n\t\t\tawait timeout(1000);\n\t\t\tawait model.acceptNextWord();\n\t\t}\n\t}\n\n\ttest('Basic Partial Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('let\\nlet\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 1000, 1, 1000),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `let a = 'some word'; `,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tawait acceptNextWord(model, editor, 2);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`let a`,\n\t\t\t\t\t\t`let a`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Partial Multi-Part Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('for ()\\nfor \\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 5, 1, 5),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `for (let i = 0; i < 10; i++) {`,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tawait acceptNextWord(model, editor, 3);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`for (let i)`,\n\t\t\t\t\t\t`for `,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Partial Mutli-Part and Different Cursor Columns Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType(`console.log()\\nconsole.warnnnn\\n`);\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 16, 2, 16),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `console.log(\"hello\" + \" \" + \"world\");`,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tawait acceptNextWord(model, editor, 4);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\" + )`,\n\t\t\t\t\t\t`console.warnnnn`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { InlineCompletionsModel } from '../../browser/model/inlineCompletionsModel.js';\nimport { IWithAsyncTestCodeEditorAndInlineCompletionsModel, MockInlineCompletionsProvider, withAsyncTestCodeEditorAndInlineCompletionsModel } from './utils.js';\nimport { ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { Selection } from '../../../../common/core/selection.js';\n\nsuite('Inline Completions', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Does not trigger automatically if disabled', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: false } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\t// Provider is not called, no ghost text is shown.\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is shown after trigger', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is shown automatically when configured', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Ghost text is updated automatically', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobizz', range: new Range(1, 1, 1, 6) });\n\t\t\t\tcontext.keyboardType('b');\n\t\t\t\tcontext.keyboardType('i');\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, },\n\t\t\t\t\t{ position: '(1,6)', text: 'foobi', triggerKind: 0, }\n\t\t\t\t]);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tcontext.getAndClearViewStates(),\n\t\t\t\t\t['', 'foo[bar]', 'foob[ar]', 'foobi', 'foobi[zz]']\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Unindent whitespace', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('  ');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 2, 1, 3) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', '  [foo]']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,3)', text: '  ', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [' foo']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Unindent tab', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('\\t\\t');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 2, 1, 3) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', '\\t\\t[foo]']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,3)', text: '\\t\\t', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['\\tfoo']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('No unindent after indentation', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('buzz  ');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foo', range: new Range(1, 6, 1, 7) });\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,7)', text: 'buzz  ', triggerKind: 1, },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Next/previous', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar1', range: new Range(1, 1, 1, 4) });\n\t\t\t\tmodel.trigger();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tcontext.getAndClearViewStates(),\n\t\t\t\t\t['', 'foo[bar1]']\n\t\t\t\t);\n\n\t\t\t\tprovider.setReturnValues([\n\t\t\t\t\t{ insertText: 'foobar1', range: new Range(1, 1, 1, 4) },\n\t\t\t\t\t{ insertText: 'foobizz2', range: new Range(1, 1, 1, 4) },\n\t\t\t\t\t{ insertText: 'foobuzz3', range: new Range(1, 1, 1, 4) }\n\t\t\t\t]);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bizz2]']);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[buzz3]']);\n\n\t\t\t\tmodel.next();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bar1]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[buzz3]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bizz2]']);\n\n\t\t\t\tmodel.previous();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['foo[bar1]']);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, },\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 1, },\n\t\t\t\t]);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Calling the provider is debounced', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tmodel.trigger();\n\n\t\t\t\tcontext.keyboardType('f');\n\t\t\t\tawait timeout(40);\n\t\t\t\tcontext.keyboardType('o');\n\t\t\t\tawait timeout(40);\n\t\t\t\tcontext.keyboardType('o');\n\t\t\t\tawait timeout(40);\n\n\t\t\t\t// The provider is not called\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\n\t\t\t\tawait timeout(400);\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t]);\n\n\t\t\t\tprovider.assertNotCalledTwiceWithin50ms();\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Backspace is debounced', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('foo');\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tfor (let j = 0; j < 2; j++) {\n\t\t\t\t\tfor (let i = 0; i < 3; i++) {\n\t\t\t\t\t\tcontext.leftDelete();\n\t\t\t\t\t\tawait timeout(5);\n\t\t\t\t\t}\n\n\t\t\t\t\tcontext.keyboardType('bar');\n\t\t\t\t}\n\n\t\t\t\tawait timeout(400);\n\n\t\t\t\tprovider.assertNotCalledTwiceWithin50ms();\n\t\t\t}\n\t\t);\n\t});\n\n\n\tsuite('Forward Stability', () => {\n\t\ttest('Typing agrees', async function () {\n\t\t\t// The user types the text as suggested and the provider is forward-stable\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', });\n\t\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\t\tmodel.trigger();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,4)', text: 'foo', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'foo[bar]']);\n\n\t\t\t\t\tcontext.keyboardType('b');\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['foob[ar]']));\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,5)', text: 'foob', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\n\t\t\t\t\tcontext.keyboardType('a');\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['fooba[r]']));\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,6)', text: 'fooba', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), []);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\tasync function setupScenario({ editor, editorViewModel, model, context, store }: IWithAsyncTestCodeEditorAndInlineCompletionsModel, provider: MockInlineCompletionsProvider): Promise<void> {\n\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['']);\n\t\t\tprovider.setReturnValue({ insertText: 'foo bar' });\n\t\t\tcontext.keyboardType('f');\n\t\t\tmodel.triggerExplicitly();\n\t\t\tawait timeout(10000);\n\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,2)', triggerKind: 1, text: 'f' }]));\n\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), (['f[oo bar]']));\n\n\t\t\tprovider.setReturnValue({ insertText: 'foo baz' });\n\t\t\tawait timeout(10000);\n\t\t}\n\n\t\ttest('Support forward instability', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tctx.context.keyboardType('o');\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ['fo[o bar]']);\n\t\t\t\t\tawait timeout(10000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,3)', text: 'fo', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ['fo[o baz]']);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\n\t\ttest('when accepting word by word', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\t\t\t// Even when triggering explicitly, we want to keep the suggestion.\n\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tawait ctx.model.acceptNextWord();\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\n\t\t\t\t\tawait ctx.model.triggerExplicitly(); // reset to provider truth\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('when accepting undo', async function () {\n\t\t\t// The user types the text as suggested and the provider reports a different suggestion.\n\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync (ctx) => {\n\t\t\t\t\tawait setupScenario(ctx, provider);\n\n\t\t\t\t\tawait ctx.model.acceptNextWord();\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), ([]));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\n\t\t\t\t\tawait ctx.editor.getModel().undo();\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['f[oo bar]']));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,2)', triggerKind: 0, text: 'f' }]));\n\n\t\t\t\t\tawait ctx.editor.getModel().redo();\n\t\t\t\t\tawait timeout(10000);\n\t\t\t\t\tassert.deepStrictEqual(ctx.context.getAndClearViewStates(), (['foo[ bar]']));\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(1,4)', triggerKind: 0, text: 'foo' }]));\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('Support backward instability', async function () {\n\t\t\t// The user deletes text and the suggestion changes\n\t\t\tconst provider = new MockInlineCompletionsProvider();\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tcontext.keyboardType('fooba');\n\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 6) });\n\n\t\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,6)', text: 'fooba', triggerKind: 1, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), ['', 'fooba[r]']);\n\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobaz', range: new Range(1, 1, 1, 5) });\n\t\t\t\t\tcontext.leftDelete();\n\t\t\t\t\tawait timeout(1000);\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t\t{ position: '(1,5)', text: 'foob', triggerKind: 0, }\n\t\t\t\t\t]);\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t\t'foob[ar]',\n\t\t\t\t\t\t'foob[az]'\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\ttest('Push item to preserve to front', async function () {\n\t\t\tconst provider = new MockInlineCompletionsProvider(true);\n\t\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t\t{ fakeClock: true, provider },\n\t\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\t\tprovider.setReturnValue({ insertText: 'foobar', range: new Range(1, 1, 1, 4) });\n\t\t\t\t\tcontext.keyboardType('foo');\n\t\t\t\t\tawait timeout(1000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tposition: '(1,4)',\n\t\t\t\t\t\t\ttriggerKind: 0,\n\t\t\t\t\t\t\ttext: 'foo'\n\t\t\t\t\t\t}\n\t\t\t\t\t]));\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(),\n\t\t\t\t\t\t([\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\t'foo[bar]'\n\t\t\t\t\t\t])\n\t\t\t\t\t);\n\n\t\t\t\t\tprovider.setReturnValues([{ insertText: 'foobar1', range: new Range(1, 1, 1, 4) }, { insertText: 'foobar', range: new Range(1, 1, 1, 4) }]);\n\n\t\t\t\t\tawait model.triggerExplicitly();\n\t\t\t\t\tawait timeout(1000);\n\n\t\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tposition: '(1,4)',\n\t\t\t\t\t\t\ttriggerKind: 1,\n\t\t\t\t\t\t\ttext: 'foo'\n\t\t\t\t\t\t}\n\t\t\t\t\t]));\n\t\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(),\n\t\t\t\t\t\t([])\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('No race conditions', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('h');\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 2) }, 1000);\n\n\t\t\t\tmodel.triggerExplicitly();\n\n\t\t\t\tawait timeout(1030);\n\t\t\t\tcontext.keyboardType('ello');\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 6) }, 1000);\n\n\t\t\t\t// after 20ms: Inline completion provider answers back\n\t\t\t\t// after 50ms: Debounce is triggered\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'hello[world]',\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('Do not reuse cache from previous session (#132516)', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider, inlineSuggest: { enabled: true } },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('hello\\n');\n\t\t\t\tcontext.cursorLeft();\n\t\t\t\tcontext.keyboardType('x');\n\t\t\t\tcontext.leftDelete();\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(1, 1, 1, 6) }, 1000);\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{\n\t\t\t\t\t\tposition: '(1,6)',\n\t\t\t\t\t\ttext: 'hello\\n',\n\t\t\t\t\t\ttriggerKind: 0,\n\t\t\t\t\t}\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({ insertText: 'helloworld', range: new Range(2, 1, 2, 6) }, 1000);\n\n\t\t\t\tcontext.cursorDown();\n\t\t\t\tcontext.keyboardType('hello');\n\t\t\t\tawait timeout(40);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), []);\n\n\t\t\t\t// Update ghost text\n\t\t\t\tcontext.keyboardType('w');\n\t\t\t\tcontext.leftDelete();\n\n\t\t\t\tawait timeout(2000);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), [\n\t\t\t\t\t{ position: '(2,6)', triggerKind: 0, text: 'hello\\nhello' },\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'hello[world]\\n',\n\t\t\t\t\t'hello\\n',\n\t\t\t\t\t'hello\\nhello[world]',\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('Additional Text Edits', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('buzz\\nbaz');\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'bazz',\n\t\t\t\t\trange: new Range(2, 1, 2, 4),\n\t\t\t\t\tadditionalTextEdits: [{\n\t\t\t\t\t\trange: new Range(1, 1, 1, 5),\n\t\t\t\t\t\ttext: 'bla'\n\t\t\t\t\t}],\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tmodel.accept(editor);\n\n\t\t\t\tassert.deepStrictEqual(provider.getAndClearCallHistory(), ([{ position: '(2,4)', triggerKind: 1, text: 'buzz\\nbaz' }]));\n\n\t\t\t\tassert.deepStrictEqual(context.getAndClearViewStates(), [\n\t\t\t\t\t'',\n\t\t\t\t\t'buzz\\nbaz[z]',\n\t\t\t\t\t'bla\\nbazz',\n\t\t\t\t]);\n\t\t\t}\n\t\t);\n\t});\n});\n\nsuite('Multi Cursor Support', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Basic', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console\\nconsole\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 1000, 1, 1000),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Multi Part', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console.log()\\nconsole.log\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.log`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Multi Part and Different Cursor Columns', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('console.log()\\nconsole.warn\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 14, 2, 14),\n\t\t\t\t]);\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: 'console.log(\"hello\");',\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\t\t\t\tmodel.accept(editor);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\");`,\n\t\t\t\t\t\t`console.warn`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\tasync function acceptNextWord(model: InlineCompletionsModel, editor: ITestCodeEditor, timesToAccept: number = 1): Promise<void> {\n\t\tfor (let i = 0; i < timesToAccept; i++) {\n\t\t\tmodel.triggerExplicitly();\n\t\t\tawait timeout(1000);\n\t\t\tawait model.acceptNextWord();\n\t\t}\n\t}\n\n\ttest('Basic Partial Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('let\\nlet\\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 1000, 1, 1000),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `let a = 'some word'; `,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tawait acceptNextWord(model, editor, 2);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`let a`,\n\t\t\t\t\t\t`let a`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Partial Multi-Part Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType('for ()\\nfor \\n');\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 5, 1, 5),\n\t\t\t\t\tnew Selection(2, 1000, 2, 1000),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `for (let i = 0; i < 10; i++) {`,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tawait acceptNextWord(model, editor, 3);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`for (let i)`,\n\t\t\t\t\t\t`for `,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('Partial Mutli-Part and Different Cursor Columns Completion', async function () {\n\t\tconst provider = new MockInlineCompletionsProvider();\n\t\tawait withAsyncTestCodeEditorAndInlineCompletionsModel('',\n\t\t\t{ fakeClock: true, provider },\n\t\t\tasync ({ editor, editorViewModel, model, context }) => {\n\t\t\t\tcontext.keyboardType(`console.log()\\nconsole.warnnnn\\n`);\n\t\t\t\teditor.setSelections([\n\t\t\t\t\tnew Selection(1, 12, 1, 12),\n\t\t\t\t\tnew Selection(2, 16, 2, 16),\n\t\t\t\t]);\n\n\t\t\t\tprovider.setReturnValue({\n\t\t\t\t\tinsertText: `console.log(\"hello\" + \" \" + \"world\");`,\n\t\t\t\t\trange: new Range(1, 1, 1, 1000),\n\t\t\t\t});\n\n\t\t\t\tmodel.triggerExplicitly();\n\t\t\t\tawait timeout(1000);\n\n\t\t\t\tawait acceptNextWord(model, editor, 4);\n\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\teditor.getValue(),\n\t\t\t\t\t[\n\t\t\t\t\t\t`console.log(\"hello\" + )`,\n\t\t\t\t\t\t`console.warnnnn`,\n\t\t\t\t\t\t``\n\t\t\t\t\t].join('\\n')\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n});\n"]}