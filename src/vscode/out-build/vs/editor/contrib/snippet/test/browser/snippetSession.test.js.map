{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/snippet/test/browser/snippetSession.test.ts","vs/editor/contrib/snippet/test/browser/snippetSession.test.ts"],"names":[],"mappings":"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","file":"snippetSession.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IActiveCodeEditor } from '../../../../browser/editorBrowser.js';\nimport { IPosition, Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { SnippetParser } from '../../browser/snippetParser.js';\nimport { SnippetSession } from '../../browser/snippetSession.js';\nimport { createTestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { TestLanguageConfigurationService } from '../../../../test/common/modes/testLanguageConfigurationService.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\n\nsuite('SnippetSession', function () {\n\n\tlet languageConfigurationService: ILanguageConfigurationService;\n\tlet editor: IActiveCodeEditor;\n\tlet model: TextModel;\n\n\tfunction assertSelections(editor: IActiveCodeEditor, ...s: Selection[]) {\n\t\tfor (const selection of editor.getSelections()) {\n\t\t\tconst actual = s.shift()!;\n\t\t\tassert.ok(selection.equalsSelection(actual), `actual=${selection.toString()} <> expected=${actual.toString()}`);\n\t\t}\n\t\tassert.strictEqual(s.length, 0);\n\t}\n\n\tsetup(function () {\n\t\tmodel = createTextModel('function foo() {\\n    console.log(a);\\n}');\n\t\tlanguageConfigurationService = new TestLanguageConfigurationService();\n\t\tconst serviceCollection = new ServiceCollection(\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[ILanguageConfigurationService, languageConfigurationService],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() {\n\t\t\t\toverride getWorkspace() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: 'workspace-id',\n\t\t\t\t\t\tfolders: [],\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}],\n\t\t);\n\t\teditor = createTestCodeEditor(model, { serviceCollection }) as IActiveCodeEditor;\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5)]);\n\t\tassert.strictEqual(model.getEOL(), '\\n');\n\t});\n\n\tteardown(function () {\n\t\tmodel.dispose();\n\t\teditor.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('normalize whitespace', function () {\n\n\t\tfunction assertNormalized(position: IPosition, input: string, expected: string): void {\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tSnippetSession.adjustWhitespace(model, position, true, snippet);\n\t\t\tassert.strictEqual(snippet.toTextmateString(), expected);\n\t\t}\n\n\t\tassertNormalized(new Position(1, 1), 'foo', 'foo');\n\t\tassertNormalized(new Position(1, 1), 'foo\\rbar', 'foo\\nbar');\n\t\tassertNormalized(new Position(1, 1), 'foo\\rbar', 'foo\\nbar');\n\t\tassertNormalized(new Position(2, 5), 'foo\\r\\tbar', 'foo\\n        bar');\n\t\tassertNormalized(new Position(2, 3), 'foo\\r\\tbar', 'foo\\n    bar');\n\t\tassertNormalized(new Position(2, 5), 'foo\\r\\tbar\\nfoo', 'foo\\n        bar\\n    foo');\n\n\t\t//Indentation issue with choice elements that span multiple lines #46266\n\t\tassertNormalized(new Position(2, 5), 'a\\nb${1|foo,\\nbar|}', 'a\\n    b${1|foo,\\nbar|}');\n\t});\n\n\ttest('adjust selection (overwrite[Before|After])', function () {\n\n\t\tlet range = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 1, 0);\n\t\tassert.ok(range.equalsRange(new Range(1, 1, 1, 2)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 1111, 0);\n\t\tassert.ok(range.equalsRange(new Range(1, 1, 1, 2)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 0, 10);\n\t\tassert.ok(range.equalsRange(new Range(1, 2, 1, 12)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 0, 10111);\n\t\tassert.ok(range.equalsRange(new Range(1, 2, 1, 17)));\n\n\t});\n\n\ttest('text edits & selection', function () {\n\t\tconst session = new SnippetSession(editor, 'foo${1:bar}foo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'foobarfoofunction foo() {\\n    foobarfooconsole.log(a);\\n}');\n\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('text edit with reversed selection', function () {\n\n\t\tconst session = new SnippetSession(editor, '${1:bar}$0', undefined, languageConfigurationService);\n\t\teditor.setSelections([new Selection(2, 5, 2, 5), new Selection(1, 1, 1, 1)]);\n\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'barfunction foo() {\\n    barconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(2, 5, 2, 8), new Selection(1, 1, 1, 4));\n\t});\n\n\ttest('snippets, repeated tabstops', function () {\n\t\tconst session = new SnippetSession(editor, '${1:abc}foo${1:abc}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor,\n\t\t\tnew Selection(1, 1, 1, 4), new Selection(1, 7, 1, 10),\n\t\t\tnew Selection(2, 5, 2, 8), new Selection(2, 11, 2, 14),\n\t\t);\n\t\tsession.next();\n\t\tassertSelections(editor,\n\t\t\tnew Selection(1, 10, 1, 10),\n\t\t\tnew Selection(2, 14, 2, 14),\n\t\t);\n\t});\n\n\ttest('snippets, just text', function () {\n\t\tconst session = new SnippetSession(editor, 'foobar', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobarfunction foo() {\\n    foobarconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t});\n\n\ttest('snippets, selections and new text with newlines', () => {\n\n\t\tconst session = new SnippetSession(editor, 'foo\\n\\t${1:bar}\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'foo\\n    bar\\nfunction foo() {\\n    foo\\n        bar\\n    console.log(a);\\n}');\n\n\t\tassertSelections(editor, new Selection(2, 5, 2, 8), new Selection(5, 9, 5, 12));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(3, 1, 3, 1), new Selection(6, 5, 6, 5));\n\t});\n\n\ttest('snippets, newline NO whitespace adjust', () => {\n\n\t\teditor.setSelection(new Selection(2, 5, 2, 5));\n\t\tconst session = new SnippetSession(editor, 'abc\\n    foo\\n        bar\\n$0', { overwriteBefore: 0, overwriteAfter: 0, adjustWhitespace: false, clipboardText: undefined, overtypingCapturer: undefined }, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'function foo() {\\n    abc\\n    foo\\n        bar\\nconsole.log(a);\\n}');\n\t});\n\n\ttest('snippets, selections -> next/prev', () => {\n\n\t\tconst session = new SnippetSession(editor, 'f$1oo${2:bar}foo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\t// @ $2\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(2, 6, 2, 6));\n\t\t// @ $1\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\t// @ $2\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(2, 6, 2, 6));\n\t\t// @ $1\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\t// @ $0\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('snippets, selections & typing', function () {\n\t\tconst session = new SnippetSession(editor, 'f${1:oo}_$2_$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.trigger('test', 'type', { text: 'X' });\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: 'bar' });\n\n\t\t// go back to ${2:oo} which is now just 'X'\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 3), new Selection(2, 6, 2, 7));\n\n\t\t// go forward to $1 which is now 'bar'\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// go to final tabstop\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), 'fX_bar_function foo() {\\n    fX_bar_console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 8, 1, 8), new Selection(2, 12, 2, 12));\n\t});\n\n\ttest('snippets, insert shorter snippet into non-empty selection', function () {\n\t\tmodel.setValue('foo_bar_foo');\n\t\teditor.setSelections([new Selection(1, 1, 1, 4), new Selection(1, 9, 1, 12)]);\n\n\t\tnew SnippetSession(editor, 'x$0', undefined, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'x_bar_x');\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(1, 8, 1, 8));\n\t});\n\n\ttest('snippets, insert longer snippet into non-empty selection', function () {\n\t\tmodel.setValue('foo_bar_foo');\n\t\teditor.setSelections([new Selection(1, 1, 1, 4), new Selection(1, 9, 1, 12)]);\n\n\t\tnew SnippetSession(editor, 'LONGER$0', undefined, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'LONGER_bar_LONGER');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(1, 18, 1, 18));\n\t});\n\n\ttest('snippets, don\\'t grow final tabstop', function () {\n\t\tmodel.setValue('foo_zzz_foo');\n\t\teditor.setSelection(new Selection(1, 5, 1, 8));\n\t\tconst session = new SnippetSession(editor, '$1bar$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 5, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'foo-' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), 'foo_foo-bar_foo');\n\t\tassertSelections(editor, new Selection(1, 12, 1, 12));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getValue(), 'foo_foo-barXXX_foo');\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 5, 1, 9));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 15, 1, 15));\n\t});\n\n\ttest('snippets, don\\'t merge touching tabstops 1/2', function () {\n\n\t\tconst session = new SnippetSession(editor, '$1$2$3$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.prev();\n\t\tsession.prev();\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\t\teditor.trigger('test', 'type', { text: '111' });\n\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: '222' });\n\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: '333' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), '111222333function foo() {\\n    111222333console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 10), new Selection(2, 11, 2, 14));\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\t});\n\ttest('snippets, don\\'t merge touching tabstops 2/2', function () {\n\n\t\tconst session = new SnippetSession(editor, '$1$2$3$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\teditor.trigger('test', 'type', { text: '111' });\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\teditor.trigger('test', 'type', { text: '222' });\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\teditor.trigger('test', 'type', { text: '333' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t});\n\n\ttest('snippets, gracefully move over final tabstop', function () {\n\t\tconst session = new SnippetSession(editor, '${1}bar$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t});\n\n\ttest('snippets, overwriting nested placeholder', function () {\n\t\tconst session = new SnippetSession(editor, 'log(${1:\"$2\"});$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 5, 1, 7), new Selection(2, 9, 2, 11));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getValue(), 'log(XXX);function foo() {\\n    log(XXX);console.log(a);\\n}');\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\t\t// assertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('snippets, selections and snippet ranges', function () {\n\t\tconst session = new SnippetSession(editor, '${1:foo}farboo${2:bar}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'foofarboobarfunction foo() {\\n    foofarboobarconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\n\t\teditor.setSelections([new Selection(1, 1, 1, 1)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false); // in snippet, outside placeholder\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10), new Selection(1, 1, 1, 1)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false); // in snippet, outside placeholder\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10), new Selection(2, 20, 2, 21)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\t// reset selection to placeholder\n\t\tsession.next();\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 13), new Selection(2, 14, 2, 17));\n\n\t\t// reset selection to placeholder\n\t\tsession.next();\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 13, 1, 13), new Selection(2, 17, 2, 17));\n\t});\n\n\ttest('snippets, nested sessions', function () {\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tconst first = new SnippetSession(editor, 'foo${2:bar}foo$0', undefined, languageConfigurationService);\n\t\tfirst.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobarfoo');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7));\n\n\t\tconst second = new SnippetSession(editor, 'ba${1:zzzz}$0', undefined, languageConfigurationService);\n\t\tsecond.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobazzzzfoo');\n\t\tassertSelections(editor, new Selection(1, 6, 1, 10));\n\n\t\tsecond.next();\n\t\tassert.strictEqual(second.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10));\n\n\t\tfirst.next();\n\t\tassert.strictEqual(first.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 13, 1, 13));\n\t});\n\n\ttest('snippets, typing at final tabstop', function () {\n\n\t\tconst session = new SnippetSession(editor, 'farboo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\t});\n\n\ttest('snippets, typing at beginning', function () {\n\n\t\teditor.setSelection(new Selection(1, 2, 1, 2));\n\t\tconst session = new SnippetSession(editor, 'farboo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.setSelection(new Selection(1, 2, 1, 2));\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getLineContent(1), 'fXXXfarboounction foo() {');\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 11, 1, 11));\n\t});\n\n\ttest('snippets, typing with nested placeholder', function () {\n\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'This ${1:is ${2:nested}}.$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 15));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 15));\n\n\t\teditor.trigger('test', 'cut', {});\n\t\tassertSelections(editor, new Selection(1, 9, 1, 9));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 12));\n\t});\n\n\ttest('snippets, snippet with variables', function () {\n\t\tconst session = new SnippetSession(editor, '@line=$TM_LINE_NUMBER$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(model.getValue(), '@line=1function foo() {\\n    @line=2console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 8, 1, 8), new Selection(2, 12, 2, 12));\n\t});\n\n\ttest('snippets, merge', function () {\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'This ${1:is ${2:nested}}.$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 15));\n\n\t\tsession.merge('really ${1:nested}$0');\n\t\tassertSelections(editor, new Selection(1, 16, 1, 22));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 22, 1, 22));\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 23, 1, 23));\n\n\t\tsession.prev();\n\t\teditor.trigger('test', 'type', { text: 'AAA' });\n\n\t\t// back to `really ${1:nested}`\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 16, 1, 22));\n\n\t\t// back to `${1:is ...}` which now grew\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 25));\n\t});\n\n\ttest('snippets, transform', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1/foo/bar/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1));\n\n\t\teditor.trigger('test', 'type', { text: 'foo' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'bar');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4));\n\t});\n\n\ttest('snippets, multi placeholder same index one transform', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '$1 baz ${1/foo/bar/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(1, 6, 1, 6));\n\n\t\teditor.trigger('test', 'type', { text: 'foo' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'foo baz bar');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 12, 1, 12));\n\t});\n\n\ttest('snippets, transform example', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'clk' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 7, 1, 11));\n\t\teditor.trigger('test', 'type', { text: 'std_logic' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 16, 1, 16));\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'clk : std_logic;\\n');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1));\n\t});\n\n\ttest('snippets, transform with indent', function () {\n\t\tconst snippet = [\n\t\t\t'private readonly ${1} = new Emitter<$2>();',\n\t\t\t'readonly ${1/^_(.*)/$1/}: Event<$2> = this.$1.event;',\n\t\t\t'$0'\n\t\t].join('\\n');\n\t\tconst expected = [\n\t\t\t'{',\n\t\t\t'\\tprivate readonly _prop = new Emitter<string>();',\n\t\t\t'\\treadonly prop: Event<string> = this._prop.event;',\n\t\t\t'\\t',\n\t\t\t'}'\n\t\t].join('\\n');\n\t\tconst base = [\n\t\t\t'{',\n\t\t\t'\\t',\n\t\t\t'}'\n\t\t].join('\\n');\n\n\t\teditor.getModel()!.setValue(base);\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 2, 2));\n\n\t\tconst session = new SnippetSession(editor, snippet, undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(2, 19, 2, 19), new Selection(3, 11, 3, 11), new Selection(3, 28, 3, 28));\n\t\teditor.trigger('test', 'type', { text: '_prop' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(2, 39, 2, 39), new Selection(3, 23, 3, 23));\n\t\teditor.trigger('test', 'type', { text: 'string' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), expected);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(4, 2, 4, 2));\n\n\t});\n\n\ttest('snippets, transform example hit if', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'clk' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 7, 1, 11));\n\t\teditor.trigger('test', 'type', { text: 'std_logic' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 16, 1, 16));\n\t\teditor.trigger('test', 'type', { text: ' := \\'1\\'' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'clk : std_logic := \\'1\\';\\n');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1));\n\t});\n\n\ttest('Snippet tab stop selection issue #96545, snippets, transform adjacent to previous placeholder', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:{}${2:fff}${1/{/}/}', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 2), new Selection(1, 5, 1, 6));\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), '{fff}');\n\t\tassertSelections(editor, new Selection(1, 2, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'ggg' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), '{ggg}');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 6, 1, 6));\n\t});\n\n\ttest('Snippet tab stop selection issue #96545', function () {\n\t\teditor.getModel().setValue('');\n\t\tconst session = new SnippetSession(editor, '${1:{}${2:fff}${1/[\\\\{]/}/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel().getValue(), '{fff{');\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 2), new Selection(1, 5, 1, 6));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 5));\n\t});\n\n\ttest('Snippet placeholder index incorrect after using 2+ snippets in a row that each end with a placeholder, #30769', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'test ${1:replaceme}', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.trigger('test', 'type', { text: '1' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '2' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '3' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\ntest 3\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '4' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\ntest 3\\ntest 4\\n');\n\t});\n\n\ttest('Snippet variable text isn\\'t whitespace normalised, #31124', function () {\n\t\teditor.getModel()!.setValue([\n\t\t\t'start',\n\t\t\t'\\t\\t-one',\n\t\t\t'\\t\\t-two',\n\t\t\t'end'\n\t\t].join('\\n'));\n\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 3, 7));\n\n\t\tnew SnippetSession(editor, '<div>\\n\\t$TM_SELECTED_TEXT\\n</div>$0', undefined, languageConfigurationService).insert();\n\n\t\tlet expected = [\n\t\t\t'start',\n\t\t\t'\\t<div>',\n\t\t\t'\\t\\t\\t-one',\n\t\t\t'\\t\\t\\t-two',\n\t\t\t'\\t</div>',\n\t\t\t'end'\n\t\t].join('\\n');\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), expected);\n\n\t\teditor.getModel()!.setValue([\n\t\t\t'start',\n\t\t\t'\\t\\t-one',\n\t\t\t'\\t-two',\n\t\t\t'end'\n\t\t].join('\\n'));\n\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 3, 7));\n\n\t\tnew SnippetSession(editor, '<div>\\n\\t$TM_SELECTED_TEXT\\n</div>$0', undefined, languageConfigurationService).insert();\n\n\t\texpected = [\n\t\t\t'start',\n\t\t\t'\\t<div>',\n\t\t\t'\\t\\t\\t-one',\n\t\t\t'\\t\\t-two',\n\t\t\t'\\t</div>',\n\t\t\t'end'\n\t\t].join('\\n');\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), expected);\n\t});\n\n\ttest('Selecting text from left to right, and choosing item messes up code, #31199', function () {\n\t\tconst model = editor.getModel()!;\n\t\tmodel.setValue('console.log');\n\n\t\tlet actual = SnippetSession.adjustSelection(model, new Selection(1, 12, 1, 9), 3, 0);\n\t\tassert.ok(actual.equalsSelection(new Selection(1, 9, 1, 6)));\n\n\t\tactual = SnippetSession.adjustSelection(model, new Selection(1, 9, 1, 12), 3, 0);\n\t\tassert.ok(actual.equalsSelection(new Selection(1, 9, 1, 12)));\n\n\t\teditor.setSelections([new Selection(1, 9, 1, 12)]);\n\t\tnew SnippetSession(editor, 'far', { overwriteBefore: 3, overwriteAfter: 0, adjustWhitespace: true, clipboardText: undefined, overtypingCapturer: undefined }, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'console.far');\n\t});\n\n\ttest('Tabs don\\'t get replaced with spaces in snippet transformations #103818', function () {\n\t\tconst model = editor.getModel()!;\n\t\tmodel.setValue('\\n{\\n  \\n}');\n\t\tmodel.updateOptions({ insertSpaces: true, indentSize: 2 });\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(3, 6, 3, 6)]);\n\t\tconst session = new SnippetSession(editor, [\n\t\t\t'function animate () {',\n\t\t\t'\\tvar ${1:a} = 12;',\n\t\t\t'\\tconsole.log(${1/(.*)/\\n\\t\\t$1\\n\\t/})',\n\t\t\t'}'\n\t\t].join('\\n'), undefined, languageConfigurationService);\n\n\t\tsession.insert();\n\n\t\tassert.strictEqual(model.getValue(), [\n\t\t\t'function animate () {',\n\t\t\t'  var a = 12;',\n\t\t\t'  console.log(a)',\n\t\t\t'}',\n\t\t\t'{',\n\t\t\t'  function animate () {',\n\t\t\t'    var a = 12;',\n\t\t\t'    console.log(a)',\n\t\t\t'  }',\n\t\t\t'}',\n\t\t].join('\\n'));\n\n\t\teditor.trigger('test', 'type', { text: 'bbb' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), [\n\t\t\t'function animate () {',\n\t\t\t'  var bbb = 12;',\n\t\t\t'  console.log(',\n\t\t\t'    bbb',\n\t\t\t'  )',\n\t\t\t'}',\n\t\t\t'{',\n\t\t\t'  function animate () {',\n\t\t\t'    var bbb = 12;',\n\t\t\t'    console.log(',\n\t\t\t'      bbb',\n\t\t\t'    )',\n\t\t\t'  }',\n\t\t\t'}',\n\t\t].join('\\n'));\n\t});\n\n\n\tsuite('createEditsAndSnippetsFromEdits', function () {\n\n\t\ttest('empty', function () {\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(editor, [], true, true, undefined, undefined, languageConfigurationService);\n\n\t\t\tassert.deepStrictEqual(result.edits, []);\n\t\t\tassert.deepStrictEqual(result.snippets, []);\n\t\t});\n\n\t\ttest('basic', function () {\n\n\t\t\teditor.getModel().setValue('foo(\"bar\")');\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(\n\t\t\t\teditor,\n\t\t\t\t[{ range: new Range(1, 5, 1, 9), template: '$1' }, { range: new Range(1, 1, 1, 1), template: 'const ${1:new_const} = \"bar\"' }],\n\t\t\t\ttrue, true, undefined, undefined, languageConfigurationService\n\t\t\t);\n\n\t\t\tassert.strictEqual(result.edits.length, 2);\n\t\t\tassert.deepStrictEqual(result.edits[0].range, new Range(1, 1, 1, 1));\n\t\t\tassert.deepStrictEqual(result.edits[0].text, 'const new_const = \"bar\"');\n\t\t\tassert.deepStrictEqual(result.edits[1].range, new Range(1, 5, 1, 9));\n\t\t\tassert.deepStrictEqual(result.edits[1].text, 'new_const');\n\n\t\t\tassert.strictEqual(result.snippets.length, 1);\n\t\t\tassert.strictEqual(result.snippets[0].isTrivialSnippet, false);\n\t\t});\n\n\t\ttest('with $SELECTION variable', function () {\n\t\t\teditor.getModel().setValue('Some text and a selection');\n\t\t\teditor.setSelections([new Selection(1, 17, 1, 26)]);\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(\n\t\t\t\teditor,\n\t\t\t\t[{ range: new Range(1, 17, 1, 26), template: 'wrapped <$SELECTION>' }],\n\t\t\t\ttrue, true, undefined, undefined, languageConfigurationService\n\t\t\t);\n\n\t\t\tassert.strictEqual(result.edits.length, 1);\n\t\t\tassert.deepStrictEqual(result.edits[0].range, new Range(1, 17, 1, 26));\n\t\t\tassert.deepStrictEqual(result.edits[0].text, 'wrapped <selection>');\n\n\t\t\tassert.strictEqual(result.snippets.length, 1);\n\t\t\tassert.strictEqual(result.snippets[0].isTrivialSnippet, true);\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IActiveCodeEditor } from '../../../../browser/editorBrowser.js';\nimport { IPosition, Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { SnippetParser } from '../../browser/snippetParser.js';\nimport { SnippetSession } from '../../browser/snippetSession.js';\nimport { createTestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { TestLanguageConfigurationService } from '../../../../test/common/modes/testLanguageConfigurationService.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\n\nsuite('SnippetSession', function () {\n\n\tlet languageConfigurationService: ILanguageConfigurationService;\n\tlet editor: IActiveCodeEditor;\n\tlet model: TextModel;\n\n\tfunction assertSelections(editor: IActiveCodeEditor, ...s: Selection[]) {\n\t\tfor (const selection of editor.getSelections()) {\n\t\t\tconst actual = s.shift()!;\n\t\t\tassert.ok(selection.equalsSelection(actual), `actual=${selection.toString()} <> expected=${actual.toString()}`);\n\t\t}\n\t\tassert.strictEqual(s.length, 0);\n\t}\n\n\tsetup(function () {\n\t\tmodel = createTextModel('function foo() {\\n    console.log(a);\\n}');\n\t\tlanguageConfigurationService = new TestLanguageConfigurationService();\n\t\tconst serviceCollection = new ServiceCollection(\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[ILanguageConfigurationService, languageConfigurationService],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() {\n\t\t\t\toverride getWorkspace() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: 'workspace-id',\n\t\t\t\t\t\tfolders: [],\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}],\n\t\t);\n\t\teditor = createTestCodeEditor(model, { serviceCollection }) as IActiveCodeEditor;\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5)]);\n\t\tassert.strictEqual(model.getEOL(), '\\n');\n\t});\n\n\tteardown(function () {\n\t\tmodel.dispose();\n\t\teditor.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('normalize whitespace', function () {\n\n\t\tfunction assertNormalized(position: IPosition, input: string, expected: string): void {\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tSnippetSession.adjustWhitespace(model, position, true, snippet);\n\t\t\tassert.strictEqual(snippet.toTextmateString(), expected);\n\t\t}\n\n\t\tassertNormalized(new Position(1, 1), 'foo', 'foo');\n\t\tassertNormalized(new Position(1, 1), 'foo\\rbar', 'foo\\nbar');\n\t\tassertNormalized(new Position(1, 1), 'foo\\rbar', 'foo\\nbar');\n\t\tassertNormalized(new Position(2, 5), 'foo\\r\\tbar', 'foo\\n        bar');\n\t\tassertNormalized(new Position(2, 3), 'foo\\r\\tbar', 'foo\\n    bar');\n\t\tassertNormalized(new Position(2, 5), 'foo\\r\\tbar\\nfoo', 'foo\\n        bar\\n    foo');\n\n\t\t//Indentation issue with choice elements that span multiple lines #46266\n\t\tassertNormalized(new Position(2, 5), 'a\\nb${1|foo,\\nbar|}', 'a\\n    b${1|foo,\\nbar|}');\n\t});\n\n\ttest('adjust selection (overwrite[Before|After])', function () {\n\n\t\tlet range = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 1, 0);\n\t\tassert.ok(range.equalsRange(new Range(1, 1, 1, 2)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 1111, 0);\n\t\tassert.ok(range.equalsRange(new Range(1, 1, 1, 2)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 0, 10);\n\t\tassert.ok(range.equalsRange(new Range(1, 2, 1, 12)));\n\t\trange = SnippetSession.adjustSelection(model, new Selection(1, 2, 1, 2), 0, 10111);\n\t\tassert.ok(range.equalsRange(new Range(1, 2, 1, 17)));\n\n\t});\n\n\ttest('text edits & selection', function () {\n\t\tconst session = new SnippetSession(editor, 'foo${1:bar}foo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'foobarfoofunction foo() {\\n    foobarfooconsole.log(a);\\n}');\n\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('text edit with reversed selection', function () {\n\n\t\tconst session = new SnippetSession(editor, '${1:bar}$0', undefined, languageConfigurationService);\n\t\teditor.setSelections([new Selection(2, 5, 2, 5), new Selection(1, 1, 1, 1)]);\n\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'barfunction foo() {\\n    barconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(2, 5, 2, 8), new Selection(1, 1, 1, 4));\n\t});\n\n\ttest('snippets, repeated tabstops', function () {\n\t\tconst session = new SnippetSession(editor, '${1:abc}foo${1:abc}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor,\n\t\t\tnew Selection(1, 1, 1, 4), new Selection(1, 7, 1, 10),\n\t\t\tnew Selection(2, 5, 2, 8), new Selection(2, 11, 2, 14),\n\t\t);\n\t\tsession.next();\n\t\tassertSelections(editor,\n\t\t\tnew Selection(1, 10, 1, 10),\n\t\t\tnew Selection(2, 14, 2, 14),\n\t\t);\n\t});\n\n\ttest('snippets, just text', function () {\n\t\tconst session = new SnippetSession(editor, 'foobar', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobarfunction foo() {\\n    foobarconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t});\n\n\ttest('snippets, selections and new text with newlines', () => {\n\n\t\tconst session = new SnippetSession(editor, 'foo\\n\\t${1:bar}\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'foo\\n    bar\\nfunction foo() {\\n    foo\\n        bar\\n    console.log(a);\\n}');\n\n\t\tassertSelections(editor, new Selection(2, 5, 2, 8), new Selection(5, 9, 5, 12));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(3, 1, 3, 1), new Selection(6, 5, 6, 5));\n\t});\n\n\ttest('snippets, newline NO whitespace adjust', () => {\n\n\t\teditor.setSelection(new Selection(2, 5, 2, 5));\n\t\tconst session = new SnippetSession(editor, 'abc\\n    foo\\n        bar\\n$0', { overwriteBefore: 0, overwriteAfter: 0, adjustWhitespace: false, clipboardText: undefined, overtypingCapturer: undefined }, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'function foo() {\\n    abc\\n    foo\\n        bar\\nconsole.log(a);\\n}');\n\t});\n\n\ttest('snippets, selections -> next/prev', () => {\n\n\t\tconst session = new SnippetSession(editor, 'f$1oo${2:bar}foo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\t// @ $2\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(2, 6, 2, 6));\n\t\t// @ $1\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\t// @ $2\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(2, 6, 2, 6));\n\t\t// @ $1\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\t// @ $0\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('snippets, selections & typing', function () {\n\t\tconst session = new SnippetSession(editor, 'f${1:oo}_$2_$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.trigger('test', 'type', { text: 'X' });\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: 'bar' });\n\n\t\t// go back to ${2:oo} which is now just 'X'\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 3), new Selection(2, 6, 2, 7));\n\n\t\t// go forward to $1 which is now 'bar'\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// go to final tabstop\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), 'fX_bar_function foo() {\\n    fX_bar_console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 8, 1, 8), new Selection(2, 12, 2, 12));\n\t});\n\n\ttest('snippets, insert shorter snippet into non-empty selection', function () {\n\t\tmodel.setValue('foo_bar_foo');\n\t\teditor.setSelections([new Selection(1, 1, 1, 4), new Selection(1, 9, 1, 12)]);\n\n\t\tnew SnippetSession(editor, 'x$0', undefined, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'x_bar_x');\n\t\tassertSelections(editor, new Selection(1, 2, 1, 2), new Selection(1, 8, 1, 8));\n\t});\n\n\ttest('snippets, insert longer snippet into non-empty selection', function () {\n\t\tmodel.setValue('foo_bar_foo');\n\t\teditor.setSelections([new Selection(1, 1, 1, 4), new Selection(1, 9, 1, 12)]);\n\n\t\tnew SnippetSession(editor, 'LONGER$0', undefined, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'LONGER_bar_LONGER');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(1, 18, 1, 18));\n\t});\n\n\ttest('snippets, don\\'t grow final tabstop', function () {\n\t\tmodel.setValue('foo_zzz_foo');\n\t\teditor.setSelection(new Selection(1, 5, 1, 8));\n\t\tconst session = new SnippetSession(editor, '$1bar$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 5, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'foo-' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), 'foo_foo-bar_foo');\n\t\tassertSelections(editor, new Selection(1, 12, 1, 12));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getValue(), 'foo_foo-barXXX_foo');\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 5, 1, 9));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 15, 1, 15));\n\t});\n\n\ttest('snippets, don\\'t merge touching tabstops 1/2', function () {\n\n\t\tconst session = new SnippetSession(editor, '$1$2$3$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.prev();\n\t\tsession.prev();\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\t\teditor.trigger('test', 'type', { text: '111' });\n\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: '222' });\n\n\t\tsession.next();\n\t\teditor.trigger('test', 'type', { text: '333' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(model.getValue(), '111222333function foo() {\\n    111222333console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 10), new Selection(2, 11, 2, 14));\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\t});\n\ttest('snippets, don\\'t merge touching tabstops 2/2', function () {\n\n\t\tconst session = new SnippetSession(editor, '$1$2$3$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\teditor.trigger('test', 'type', { text: '111' });\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\teditor.trigger('test', 'type', { text: '222' });\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\teditor.trigger('test', 'type', { text: '333' });\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t});\n\n\ttest('snippets, gracefully move over final tabstop', function () {\n\t\tconst session = new SnippetSession(editor, '${1}bar$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t});\n\n\ttest('snippets, overwriting nested placeholder', function () {\n\t\tconst session = new SnippetSession(editor, 'log(${1:\"$2\"});$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 5, 1, 7), new Selection(2, 9, 2, 11));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getValue(), 'log(XXX);function foo() {\\n    log(XXX);console.log(a);\\n}');\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\t\t// assertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10), new Selection(2, 14, 2, 14));\n\t});\n\n\ttest('snippets, selections and snippet ranges', function () {\n\t\tconst session = new SnippetSession(editor, '${1:foo}farboo${2:bar}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(model.getValue(), 'foofarboobarfunction foo() {\\n    foofarboobarconsole.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\n\t\teditor.setSelections([new Selection(1, 1, 1, 1)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false); // in snippet, outside placeholder\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10), new Selection(1, 1, 1, 1)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false); // in snippet, outside placeholder\n\n\t\teditor.setSelections([new Selection(1, 6, 1, 6), new Selection(2, 10, 2, 10), new Selection(2, 20, 2, 21)]);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\t// reset selection to placeholder\n\t\tsession.next();\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 13), new Selection(2, 14, 2, 17));\n\n\t\t// reset selection to placeholder\n\t\tsession.next();\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), true);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 13, 1, 13), new Selection(2, 17, 2, 17));\n\t});\n\n\ttest('snippets, nested sessions', function () {\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tconst first = new SnippetSession(editor, 'foo${2:bar}foo$0', undefined, languageConfigurationService);\n\t\tfirst.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobarfoo');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7));\n\n\t\tconst second = new SnippetSession(editor, 'ba${1:zzzz}$0', undefined, languageConfigurationService);\n\t\tsecond.insert();\n\t\tassert.strictEqual(model.getValue(), 'foobazzzzfoo');\n\t\tassertSelections(editor, new Selection(1, 6, 1, 10));\n\n\t\tsecond.next();\n\t\tassert.strictEqual(second.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 10));\n\n\t\tfirst.next();\n\t\tassert.strictEqual(first.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 13, 1, 13));\n\t});\n\n\ttest('snippets, typing at final tabstop', function () {\n\n\t\tconst session = new SnippetSession(editor, 'farboo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\t});\n\n\ttest('snippets, typing at beginning', function () {\n\n\t\teditor.setSelection(new Selection(1, 2, 1, 2));\n\t\tconst session = new SnippetSession(editor, 'farboo$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.setSelection(new Selection(1, 2, 1, 2));\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tassert.strictEqual(model.getLineContent(1), 'fXXXfarboounction foo() {');\n\t\tassert.strictEqual(session.isSelectionWithinPlaceholders(), false);\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 11, 1, 11));\n\t});\n\n\ttest('snippets, typing with nested placeholder', function () {\n\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'This ${1:is ${2:nested}}.$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 15));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 15));\n\n\t\teditor.trigger('test', 'cut', {});\n\t\tassertSelections(editor, new Selection(1, 9, 1, 9));\n\n\t\teditor.trigger('test', 'type', { text: 'XXX' });\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 12));\n\t});\n\n\ttest('snippets, snippet with variables', function () {\n\t\tconst session = new SnippetSession(editor, '@line=$TM_LINE_NUMBER$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassert.strictEqual(model.getValue(), '@line=1function foo() {\\n    @line=2console.log(a);\\n}');\n\t\tassertSelections(editor, new Selection(1, 8, 1, 8), new Selection(2, 12, 2, 12));\n\t});\n\n\ttest('snippets, merge', function () {\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'This ${1:is ${2:nested}}.$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 15));\n\n\t\tsession.merge('really ${1:nested}$0');\n\t\tassertSelections(editor, new Selection(1, 16, 1, 22));\n\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 22, 1, 22));\n\t\tassert.strictEqual(session.isAtLastPlaceholder, false);\n\n\t\tsession.next();\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 23, 1, 23));\n\n\t\tsession.prev();\n\t\teditor.trigger('test', 'type', { text: 'AAA' });\n\n\t\t// back to `really ${1:nested}`\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 16, 1, 22));\n\n\t\t// back to `${1:is ...}` which now grew\n\t\tsession.prev();\n\t\tassertSelections(editor, new Selection(1, 6, 1, 25));\n\t});\n\n\ttest('snippets, transform', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1/foo/bar/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1));\n\n\t\teditor.trigger('test', 'type', { text: 'foo' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'bar');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4));\n\t});\n\n\ttest('snippets, multi placeholder same index one transform', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '$1 baz ${1/foo/bar/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(1, 6, 1, 6));\n\n\t\teditor.trigger('test', 'type', { text: 'foo' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'foo baz bar');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 12, 1, 12));\n\t});\n\n\ttest('snippets, transform example', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'clk' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 7, 1, 11));\n\t\teditor.trigger('test', 'type', { text: 'std_logic' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 16, 1, 16));\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'clk : std_logic;\\n');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1));\n\t});\n\n\ttest('snippets, transform with indent', function () {\n\t\tconst snippet = [\n\t\t\t'private readonly ${1} = new Emitter<$2>();',\n\t\t\t'readonly ${1/^_(.*)/$1/}: Event<$2> = this.$1.event;',\n\t\t\t'$0'\n\t\t].join('\\n');\n\t\tconst expected = [\n\t\t\t'{',\n\t\t\t'\\tprivate readonly _prop = new Emitter<string>();',\n\t\t\t'\\treadonly prop: Event<string> = this._prop.event;',\n\t\t\t'\\t',\n\t\t\t'}'\n\t\t].join('\\n');\n\t\tconst base = [\n\t\t\t'{',\n\t\t\t'\\t',\n\t\t\t'}'\n\t\t].join('\\n');\n\n\t\teditor.getModel()!.setValue(base);\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 2, 2));\n\n\t\tconst session = new SnippetSession(editor, snippet, undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(2, 19, 2, 19), new Selection(3, 11, 3, 11), new Selection(3, 28, 3, 28));\n\t\teditor.trigger('test', 'type', { text: '_prop' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(2, 39, 2, 39), new Selection(3, 23, 3, 23));\n\t\teditor.trigger('test', 'type', { text: 'string' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), expected);\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(4, 2, 4, 2));\n\n\t});\n\n\ttest('snippets, transform example hit if', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'clk' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 7, 1, 11));\n\t\teditor.trigger('test', 'type', { text: 'std_logic' });\n\t\tsession.next();\n\n\t\tassertSelections(editor, new Selection(1, 16, 1, 16));\n\t\teditor.trigger('test', 'type', { text: ' := \\'1\\'' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), 'clk : std_logic := \\'1\\';\\n');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1));\n\t});\n\n\ttest('Snippet tab stop selection issue #96545, snippets, transform adjacent to previous placeholder', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, '${1:{}${2:fff}${1/{/}/}', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 2), new Selection(1, 5, 1, 6));\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), '{fff}');\n\t\tassertSelections(editor, new Selection(1, 2, 1, 5));\n\t\teditor.trigger('test', 'type', { text: 'ggg' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), '{ggg}');\n\t\tassert.strictEqual(session.isAtLastPlaceholder, true);\n\t\tassertSelections(editor, new Selection(1, 6, 1, 6));\n\t});\n\n\ttest('Snippet tab stop selection issue #96545', function () {\n\t\teditor.getModel().setValue('');\n\t\tconst session = new SnippetSession(editor, '${1:{}${2:fff}${1/[\\\\{]/}/}$0', undefined, languageConfigurationService);\n\t\tsession.insert();\n\t\tassert.strictEqual(editor.getModel().getValue(), '{fff{');\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 2), new Selection(1, 5, 1, 6));\n\t\tsession.next();\n\t\tassertSelections(editor, new Selection(1, 2, 1, 5));\n\t});\n\n\ttest('Snippet placeholder index incorrect after using 2+ snippets in a row that each end with a placeholder, #30769', function () {\n\t\teditor.getModel()!.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tconst session = new SnippetSession(editor, 'test ${1:replaceme}', undefined, languageConfigurationService);\n\t\tsession.insert();\n\n\t\teditor.trigger('test', 'type', { text: '1' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '2' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '3' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\ntest 3\\n');\n\n\t\tsession.merge('test ${1:replaceme}');\n\t\teditor.trigger('test', 'type', { text: '4' });\n\t\teditor.trigger('test', 'type', { text: '\\n' });\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), 'test 1\\ntest 2\\ntest 3\\ntest 4\\n');\n\t});\n\n\ttest('Snippet variable text isn\\'t whitespace normalised, #31124', function () {\n\t\teditor.getModel()!.setValue([\n\t\t\t'start',\n\t\t\t'\\t\\t-one',\n\t\t\t'\\t\\t-two',\n\t\t\t'end'\n\t\t].join('\\n'));\n\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 3, 7));\n\n\t\tnew SnippetSession(editor, '<div>\\n\\t$TM_SELECTED_TEXT\\n</div>$0', undefined, languageConfigurationService).insert();\n\n\t\tlet expected = [\n\t\t\t'start',\n\t\t\t'\\t<div>',\n\t\t\t'\\t\\t\\t-one',\n\t\t\t'\\t\\t\\t-two',\n\t\t\t'\\t</div>',\n\t\t\t'end'\n\t\t].join('\\n');\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), expected);\n\n\t\teditor.getModel()!.setValue([\n\t\t\t'start',\n\t\t\t'\\t\\t-one',\n\t\t\t'\\t-two',\n\t\t\t'end'\n\t\t].join('\\n'));\n\n\t\teditor.getModel()!.updateOptions({ insertSpaces: false });\n\t\teditor.setSelection(new Selection(2, 2, 3, 7));\n\n\t\tnew SnippetSession(editor, '<div>\\n\\t$TM_SELECTED_TEXT\\n</div>$0', undefined, languageConfigurationService).insert();\n\n\t\texpected = [\n\t\t\t'start',\n\t\t\t'\\t<div>',\n\t\t\t'\\t\\t\\t-one',\n\t\t\t'\\t\\t-two',\n\t\t\t'\\t</div>',\n\t\t\t'end'\n\t\t].join('\\n');\n\n\t\tassert.strictEqual(editor.getModel()!.getValue(), expected);\n\t});\n\n\ttest('Selecting text from left to right, and choosing item messes up code, #31199', function () {\n\t\tconst model = editor.getModel()!;\n\t\tmodel.setValue('console.log');\n\n\t\tlet actual = SnippetSession.adjustSelection(model, new Selection(1, 12, 1, 9), 3, 0);\n\t\tassert.ok(actual.equalsSelection(new Selection(1, 9, 1, 6)));\n\n\t\tactual = SnippetSession.adjustSelection(model, new Selection(1, 9, 1, 12), 3, 0);\n\t\tassert.ok(actual.equalsSelection(new Selection(1, 9, 1, 12)));\n\n\t\teditor.setSelections([new Selection(1, 9, 1, 12)]);\n\t\tnew SnippetSession(editor, 'far', { overwriteBefore: 3, overwriteAfter: 0, adjustWhitespace: true, clipboardText: undefined, overtypingCapturer: undefined }, languageConfigurationService).insert();\n\t\tassert.strictEqual(model.getValue(), 'console.far');\n\t});\n\n\ttest('Tabs don\\'t get replaced with spaces in snippet transformations #103818', function () {\n\t\tconst model = editor.getModel()!;\n\t\tmodel.setValue('\\n{\\n  \\n}');\n\t\tmodel.updateOptions({ insertSpaces: true, indentSize: 2 });\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(3, 6, 3, 6)]);\n\t\tconst session = new SnippetSession(editor, [\n\t\t\t'function animate () {',\n\t\t\t'\\tvar ${1:a} = 12;',\n\t\t\t'\\tconsole.log(${1/(.*)/\\n\\t\\t$1\\n\\t/})',\n\t\t\t'}'\n\t\t].join('\\n'), undefined, languageConfigurationService);\n\n\t\tsession.insert();\n\n\t\tassert.strictEqual(model.getValue(), [\n\t\t\t'function animate () {',\n\t\t\t'  var a = 12;',\n\t\t\t'  console.log(a)',\n\t\t\t'}',\n\t\t\t'{',\n\t\t\t'  function animate () {',\n\t\t\t'    var a = 12;',\n\t\t\t'    console.log(a)',\n\t\t\t'  }',\n\t\t\t'}',\n\t\t].join('\\n'));\n\n\t\teditor.trigger('test', 'type', { text: 'bbb' });\n\t\tsession.next();\n\n\t\tassert.strictEqual(model.getValue(), [\n\t\t\t'function animate () {',\n\t\t\t'  var bbb = 12;',\n\t\t\t'  console.log(',\n\t\t\t'    bbb',\n\t\t\t'  )',\n\t\t\t'}',\n\t\t\t'{',\n\t\t\t'  function animate () {',\n\t\t\t'    var bbb = 12;',\n\t\t\t'    console.log(',\n\t\t\t'      bbb',\n\t\t\t'    )',\n\t\t\t'  }',\n\t\t\t'}',\n\t\t].join('\\n'));\n\t});\n\n\n\tsuite('createEditsAndSnippetsFromEdits', function () {\n\n\t\ttest('empty', function () {\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(editor, [], true, true, undefined, undefined, languageConfigurationService);\n\n\t\t\tassert.deepStrictEqual(result.edits, []);\n\t\t\tassert.deepStrictEqual(result.snippets, []);\n\t\t});\n\n\t\ttest('basic', function () {\n\n\t\t\teditor.getModel().setValue('foo(\"bar\")');\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(\n\t\t\t\teditor,\n\t\t\t\t[{ range: new Range(1, 5, 1, 9), template: '$1' }, { range: new Range(1, 1, 1, 1), template: 'const ${1:new_const} = \"bar\"' }],\n\t\t\t\ttrue, true, undefined, undefined, languageConfigurationService\n\t\t\t);\n\n\t\t\tassert.strictEqual(result.edits.length, 2);\n\t\t\tassert.deepStrictEqual(result.edits[0].range, new Range(1, 1, 1, 1));\n\t\t\tassert.deepStrictEqual(result.edits[0].text, 'const new_const = \"bar\"');\n\t\t\tassert.deepStrictEqual(result.edits[1].range, new Range(1, 5, 1, 9));\n\t\t\tassert.deepStrictEqual(result.edits[1].text, 'new_const');\n\n\t\t\tassert.strictEqual(result.snippets.length, 1);\n\t\t\tassert.strictEqual(result.snippets[0].isTrivialSnippet, false);\n\t\t});\n\n\t\ttest('with $SELECTION variable', function () {\n\t\t\teditor.getModel().setValue('Some text and a selection');\n\t\t\teditor.setSelections([new Selection(1, 17, 1, 26)]);\n\n\t\t\tconst result = SnippetSession.createEditsAndSnippetsFromEdits(\n\t\t\t\teditor,\n\t\t\t\t[{ range: new Range(1, 17, 1, 26), template: 'wrapped <$SELECTION>' }],\n\t\t\t\ttrue, true, undefined, undefined, languageConfigurationService\n\t\t\t);\n\n\t\t\tassert.strictEqual(result.edits.length, 1);\n\t\t\tassert.deepStrictEqual(result.edits[0].range, new Range(1, 17, 1, 26));\n\t\t\tassert.deepStrictEqual(result.edits[0].text, 'wrapped <selection>');\n\n\t\t\tassert.strictEqual(result.snippets.length, 1);\n\t\t\tassert.strictEqual(result.snippets[0].isTrivialSnippet, true);\n\t\t});\n\t});\n});\n"]}