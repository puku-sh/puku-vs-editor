{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/snippet/test/browser/snippetParser.test.ts","vs/editor/contrib/snippet/test/browser/snippetParser.test.ts"],"names":[],"mappings":"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","file":"snippetParser.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Choice, FormatString, Marker, Placeholder, Scanner, SnippetParser, Text, TextmateSnippet, TokenType, Transform, Variable } from '../../browser/snippetParser.js';\n\nsuite('SnippetParser', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Scanner', () => {\n\n\t\tconst scanner = new Scanner();\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('{{abc}}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc() ');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Format);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc 123');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Format);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Int);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo_bar');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo-bar');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('${foo}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('${1223:foo}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Int);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Colon);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('\\\\${}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Backslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\n\t\tscanner.text('${foo/regex/format/option}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\t});\n\n\tfunction assertText(value: string, expected: string) {\n\t\tconst actual = SnippetParser.asInsertText(value);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\tfunction assertMarker(input: TextmateSnippet | Marker[] | string, ...ctors: Function[]) {\n\t\tlet marker: Marker[];\n\t\tif (input instanceof TextmateSnippet) {\n\t\t\tmarker = [...input.children];\n\t\t} else if (typeof input === 'string') {\n\t\t\tconst p = new SnippetParser();\n\t\t\tmarker = p.parse(input).children;\n\t\t} else {\n\t\t\tmarker = [...input];\n\t\t}\n\t\twhile (marker.length > 0) {\n\t\t\tconst m = marker.pop();\n\t\t\tconst ctor = ctors.pop()!;\n\t\t\tassert.ok(m instanceof ctor);\n\t\t}\n\t\tassert.strictEqual(marker.length, ctors.length);\n\t\tassert.strictEqual(marker.length, 0);\n\t}\n\n\tfunction assertTextAndMarker(value: string, escaped: string, ...ctors: Function[]) {\n\t\tassertText(value, escaped);\n\t\tassertMarker(value, ...ctors);\n\t}\n\n\tfunction assertEscaped(value: string, expected: string) {\n\t\tconst actual = SnippetParser.escape(value);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\ttest('Parser, escaped', function () {\n\t\tassertEscaped('foo$0', 'foo\\\\$0');\n\t\tassertEscaped('foo\\\\$0', 'foo\\\\\\\\\\\\$0');\n\t\tassertEscaped('f$1oo$0', 'f\\\\$1oo\\\\$0');\n\t\tassertEscaped('${1:foo}$0', '\\\\${1:foo\\\\}\\\\$0');\n\t\tassertEscaped('$', '\\\\$');\n\t});\n\n\ttest('Parser, text', () => {\n\t\tassertText('$', '$');\n\t\tassertText('\\\\\\\\$', '\\\\$');\n\t\tassertText('{', '{');\n\t\tassertText('\\\\}', '}');\n\t\tassertText('\\\\abc', '\\\\abc');\n\t\tassertText('foo${f:\\\\}}bar', 'foo}bar');\n\t\tassertText('\\\\{', '\\\\{');\n\t\tassertText('I need \\\\\\\\\\\\$', 'I need \\\\$');\n\t\tassertText('\\\\', '\\\\');\n\t\tassertText('\\\\{{', '\\\\{{');\n\t\tassertText('{{', '{{');\n\t\tassertText('{{dd', '{{dd');\n\t\tassertText('}}', '}}');\n\t\tassertText('ff}}', 'ff}}');\n\n\t\tassertText('farboo', 'farboo');\n\t\tassertText('far{{}}boo', 'far{{}}boo');\n\t\tassertText('far{{123}}boo', 'far{{123}}boo');\n\t\tassertText('far\\\\{{123}}boo', 'far\\\\{{123}}boo');\n\t\tassertText('far{{id:bern}}boo', 'far{{id:bern}}boo');\n\t\tassertText('far{{id:bern {{basel}}}}boo', 'far{{id:bern {{basel}}}}boo');\n\t\tassertText('far{{id:bern {{id:basel}}}}boo', 'far{{id:bern {{id:basel}}}}boo');\n\t\tassertText('far{{id:bern {{id2:basel}}}}boo', 'far{{id:bern {{id2:basel}}}}boo');\n\t});\n\n\n\ttest('Parser, TM text', () => {\n\t\tassertTextAndMarker('foo${1:bar}}', 'foobar}', Text, Placeholder, Text);\n\t\tassertTextAndMarker('foo${1:bar}${2:foo}}', 'foobarfoo}', Text, Placeholder, Placeholder, Text);\n\n\t\tassertTextAndMarker('foo${1:bar\\\\}${2:foo}}', 'foobar}foo', Text, Placeholder);\n\n\t\tconst [, placeholder] = new SnippetParser().parse('foo${1:bar\\\\}${2:foo}}').children;\n\t\tconst { children } = (<Placeholder>placeholder);\n\n\t\tassert.strictEqual((<Placeholder>placeholder).index, 1);\n\t\tassert.ok(children[0] instanceof Text);\n\t\tassert.strictEqual(children[0].toString(), 'bar}');\n\t\tassert.ok(children[1] instanceof Placeholder);\n\t\tassert.strictEqual(children[1].toString(), 'foo');\n\t});\n\n\ttest('Parser, placeholder', () => {\n\t\tassertTextAndMarker('farboo', 'farboo', Text);\n\t\tassertTextAndMarker('far{{}}boo', 'far{{}}boo', Text);\n\t\tassertTextAndMarker('far{{123}}boo', 'far{{123}}boo', Text);\n\t\tassertTextAndMarker('far\\\\{{123}}boo', 'far\\\\{{123}}boo', Text);\n\t});\n\n\ttest('Parser, literal code', () => {\n\t\tassertTextAndMarker('far`123`boo', 'far`123`boo', Text);\n\t\tassertTextAndMarker('far\\\\`123\\\\`boo', 'far\\\\`123\\\\`boo', Text);\n\t});\n\n\ttest('Parser, variables/tabstop', () => {\n\t\tassertTextAndMarker('$far-boo', '-boo', Variable, Text);\n\t\tassertTextAndMarker('\\\\$far-boo', '$far-boo', Text);\n\t\tassertTextAndMarker('far$farboo', 'far', Text, Variable);\n\t\tassertTextAndMarker('far${farboo}', 'far', Text, Variable);\n\t\tassertTextAndMarker('$123', '', Placeholder);\n\t\tassertTextAndMarker('$farboo', '', Variable);\n\t\tassertTextAndMarker('$far12boo', '', Variable);\n\t\tassertTextAndMarker('000_${far}_000', '000__000', Text, Variable, Text);\n\t\tassertTextAndMarker('FFF_${TM_SELECTED_TEXT}_FFF$0', 'FFF__FFF', Text, Variable, Text, Placeholder);\n\t});\n\n\ttest('Parser, variables/placeholder with defaults', () => {\n\t\tassertTextAndMarker('${name:value}', 'value', Variable);\n\t\tassertTextAndMarker('${1:value}', 'value', Placeholder);\n\t\tassertTextAndMarker('${1:bar${2:foo}bar}', 'barfoobar', Placeholder);\n\n\t\tassertTextAndMarker('${name:value', '${name:value', Text);\n\t\tassertTextAndMarker('${1:bar${2:foobar}', '${1:barfoobar', Text, Placeholder);\n\t});\n\n\ttest('Parser, variable transforms', function () {\n\t\tassertTextAndMarker('${foo///}', '', Variable);\n\t\tassertTextAndMarker('${foo/regex/format/gmi}', '', Variable);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/}', '', Variable);\n\n\t\t// invalid regex\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/GMI}', '${foo/([A-Z][a-z])/format/GMI}', Text);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/funky}', '${foo/([A-Z][a-z])/format/funky}', Text);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z]/format/}', '${foo/([A-Z][a-z]/format/}', Text);\n\n\t\t// tricky regex\n\t\tassertTextAndMarker('${foo/m\\\\/atch/$1/i}', '', Variable);\n\t\tassertMarker('${foo/regex\\/format/options}', Text);\n\n\t\t// incomplete\n\t\tassertTextAndMarker('${foo///', '${foo///', Text);\n\t\tassertTextAndMarker('${foo/regex/format/options', '${foo/regex/format/options', Text);\n\n\t\t// format string\n\t\tassertMarker('${foo/.*/${0:fooo}/i}', Variable);\n\t\tassertMarker('${foo/.*/${1}/i}', Variable);\n\t\tassertMarker('${foo/.*/$1/i}', Variable);\n\t\tassertMarker('${foo/.*/This-$1-encloses/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:-else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:+if}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:?if:else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:/upcase}/i}', Variable);\n\n\t});\n\n\ttest('Parser, placeholder transforms', function () {\n\t\tassertTextAndMarker('${1///}', '', Placeholder);\n\t\tassertTextAndMarker('${1/regex/format/gmi}', '', Placeholder);\n\t\tassertTextAndMarker('${1/([A-Z][a-z])/format/}', '', Placeholder);\n\n\t\t// tricky regex\n\t\tassertTextAndMarker('${1/m\\\\/atch/$1/i}', '', Placeholder);\n\t\tassertMarker('${1/regex\\/format/options}', Text);\n\n\t\t// incomplete\n\t\tassertTextAndMarker('${1///', '${1///', Text);\n\t\tassertTextAndMarker('${1/regex/format/options', '${1/regex/format/options', Text);\n\t});\n\n\ttest('No way to escape forward slash in snippet regex #36715', function () {\n\t\tassertMarker('${TM_DIRECTORY/src\\\\//$1/}', Variable);\n\t});\n\n\ttest('No way to escape forward slash in snippet format section #37562', function () {\n\t\tassertMarker('${TM_SELECTED_TEXT/a/\\\\/$1/g}', Variable);\n\t\tassertMarker('${TM_SELECTED_TEXT/a/in\\\\/$1ner/g}', Variable);\n\t\tassertMarker('${TM_SELECTED_TEXT/a/end\\\\//g}', Variable);\n\t});\n\n\ttest('Parser, placeholder with choice', () => {\n\n\t\tassertTextAndMarker('${1|one,two,three|}', 'one', Placeholder);\n\t\tassertTextAndMarker('${1|one|}', 'one', Placeholder);\n\t\tassertTextAndMarker('${1|one1,two2|}', 'one1', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\,two2|}', 'one1,two2', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\|two2|}', 'one1|two2', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\atwo2|}', 'one1\\\\atwo2', Placeholder);\n\t\tassertTextAndMarker('${1|one,two,three,|}', '${1|one,two,three,|}', Text);\n\t\tassertTextAndMarker('${1|one,', '${1|one,', Text);\n\n\t\tconst snippet = new SnippetParser().parse('${1|one,two,three|}');\n\t\tconst expected: ((m: Marker) => boolean)[] = [\n\t\t\tm => m instanceof Placeholder,\n\t\t\tm => m instanceof Choice && m.options.length === 3 && m.options.every(x => x instanceof Text),\n\t\t];\n\t\tsnippet.walk(marker => {\n\t\t\tassert.ok(expected.shift()!(marker));\n\t\t\treturn true;\n\t\t});\n\t});\n\n\ttest('Snippet choices: unable to escape comma and pipe, #31521', function () {\n\t\tassertTextAndMarker('console.log(${1|not\\\\, not, five, 5, 1   23|});', 'console.log(not, not);', Text, Placeholder, Text);\n\t});\n\n\ttest('Marker, toTextmateString()', function () {\n\n\t\tfunction assertTextsnippetString(input: string, expected: string): void {\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tconst actual = snippet.toTextmateString();\n\t\t\tassert.strictEqual(actual, expected);\n\t\t}\n\n\t\tassertTextsnippetString('$1', '$1');\n\t\tassertTextsnippetString('\\\\$1', '\\\\$1');\n\t\tassertTextsnippetString('console.log(${1|not\\\\, not, five, 5, 1   23|});', 'console.log(${1|not\\\\, not, five, 5, 1   23|});');\n\t\tassertTextsnippetString('console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});', 'console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});');\n\t\tassertTextsnippetString('${1|cho\\\\,ices,wi\\\\|th,esc\\\\\\\\aping,chall\\\\\\\\\\\\,enges|}', '${1|cho\\\\,ices,wi\\\\|th,esc\\\\\\\\aping,chall\\\\\\\\\\\\,enges|}');\n\t\tassertTextsnippetString('this is text', 'this is text');\n\t\tassertTextsnippetString('this ${1:is ${2:nested with $var}}', 'this ${1:is ${2:nested with ${var}}}');\n\t\tassertTextsnippetString('this ${1:is ${2:nested with $var}}}', 'this ${1:is ${2:nested with ${var}}}\\\\}');\n\t});\n\n\ttest('Marker, toTextmateString() <-> identity', function () {\n\n\t\tfunction assertIdent(input: string): void {\n\t\t\t// full loop: (1) parse input, (2) generate textmate string, (3) parse, (4) ensure both trees are equal\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tconst input2 = snippet.toTextmateString();\n\t\t\tconst snippet2 = new SnippetParser().parse(input2);\n\n\t\t\tfunction checkCheckChildren(marker1: Marker, marker2: Marker) {\n\t\t\t\tassert.ok(marker1 instanceof Object.getPrototypeOf(marker2).constructor);\n\t\t\t\tassert.ok(marker2 instanceof Object.getPrototypeOf(marker1).constructor);\n\n\t\t\t\tassert.strictEqual(marker1.children.length, marker2.children.length);\n\t\t\t\tassert.strictEqual(marker1.toString(), marker2.toString());\n\n\t\t\t\tfor (let i = 0; i < marker1.children.length; i++) {\n\t\t\t\t\tcheckCheckChildren(marker1.children[i], marker2.children[i]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcheckCheckChildren(snippet, snippet2);\n\t\t}\n\n\t\tassertIdent('$1');\n\t\tassertIdent('\\\\$1');\n\t\tassertIdent('console.log(${1|not\\\\, not, five, 5, 1   23|});');\n\t\tassertIdent('console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});');\n\t\tassertIdent('this is text');\n\t\tassertIdent('this ${1:is ${2:nested with $var}}');\n\t\tassertIdent('this ${1:is ${2:nested with $var}}}');\n\t\tassertIdent('this ${1:is ${2:nested with $var}} and repeating $1');\n\t});\n\n\ttest('Parser, choise marker', () => {\n\t\tconst { placeholders } = new SnippetParser().parse('${1|one,two,three|}');\n\n\t\tassert.strictEqual(placeholders.length, 1);\n\t\tassert.ok(placeholders[0].choice instanceof Choice);\n\t\tassert.ok(placeholders[0].children[0] instanceof Choice);\n\t\tassert.strictEqual((<Choice>placeholders[0].children[0]).options.length, 3);\n\n\t\tassertText('${1|one,two,three|}', 'one');\n\t\tassertText('\\\\${1|one,two,three|}', '${1|one,two,three|}');\n\t\tassertText('${1\\\\|one,two,three|}', '${1\\\\|one,two,three|}');\n\t\tassertText('${1||}', '${1||}');\n\t});\n\n\ttest('Backslash character escape in choice tabstop doesn\\'t work #58494', function () {\n\n\t\tconst { placeholders } = new SnippetParser().parse('${1|\\\\,,},$,\\\\|,\\\\\\\\|}');\n\t\tassert.strictEqual(placeholders.length, 1);\n\t\tassert.ok(placeholders[0].choice instanceof Choice);\n\t});\n\n\ttest('Parser, only textmate', () => {\n\t\tconst p = new SnippetParser();\n\t\tassertMarker(p.parse('far{{}}boo'), Text);\n\t\tassertMarker(p.parse('far{{123}}boo'), Text);\n\t\tassertMarker(p.parse('far\\\\{{123}}boo'), Text);\n\n\t\tassertMarker(p.parse('far$0boo'), Text, Placeholder, Text);\n\t\tassertMarker(p.parse('far${123}boo'), Text, Placeholder, Text);\n\t\tassertMarker(p.parse('far\\\\${123}boo'), Text);\n\t});\n\n\ttest('Parser, real world', () => {\n\t\tlet marker = new SnippetParser().parse('console.warn(${1: $TM_SELECTED_TEXT })').children;\n\n\t\tassert.strictEqual(marker[0].toString(), 'console.warn(');\n\t\tassert.ok(marker[1] instanceof Placeholder);\n\t\tassert.strictEqual(marker[2].toString(), ')');\n\n\t\tconst placeholder = <Placeholder>marker[1];\n\t\tassert.strictEqual(placeholder.index, 1);\n\t\tassert.strictEqual(placeholder.children.length, 3);\n\t\tassert.ok(placeholder.children[0] instanceof Text);\n\t\tassert.ok(placeholder.children[1] instanceof Variable);\n\t\tassert.ok(placeholder.children[2] instanceof Text);\n\t\tassert.strictEqual(placeholder.children[0].toString(), ' ');\n\t\tassert.strictEqual(placeholder.children[1].toString(), '');\n\t\tassert.strictEqual(placeholder.children[2].toString(), ' ');\n\n\t\tconst nestedVariable = <Variable>placeholder.children[1];\n\t\tassert.strictEqual(nestedVariable.name, 'TM_SELECTED_TEXT');\n\t\tassert.strictEqual(nestedVariable.children.length, 0);\n\n\t\tmarker = new SnippetParser().parse('$TM_SELECTED_TEXT').children;\n\t\tassert.strictEqual(marker.length, 1);\n\t\tassert.ok(marker[0] instanceof Variable);\n\t});\n\n\ttest('Parser, transform example', () => {\n\t\tconst { children } = new SnippetParser().parse('${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0');\n\n\t\t//${1:name}\n\t\tassert.ok(children[0] instanceof Placeholder);\n\t\tassert.strictEqual(children[0].children.length, 1);\n\t\tassert.strictEqual(children[0].children[0].toString(), 'name');\n\t\tassert.strictEqual((<Placeholder>children[0]).transform, undefined);\n\n\t\t// :\n\t\tassert.ok(children[1] instanceof Text);\n\t\tassert.strictEqual(children[1].toString(), ' : ');\n\n\t\t//${2:type}\n\t\tassert.ok(children[2] instanceof Placeholder);\n\t\tassert.strictEqual(children[2].children.length, 1);\n\t\tassert.strictEqual(children[2].children[0].toString(), 'type');\n\n\t\t//${3/\\\\s:=(.*)/${1:+ :=}${1}/}\n\t\tassert.ok(children[3] instanceof Placeholder);\n\t\tassert.strictEqual(children[3].children.length, 0);\n\t\tassert.notStrictEqual((<Placeholder>children[3]).transform, undefined);\n\t\tconst transform = (<Placeholder>children[3]).transform!;\n\t\tassert.deepStrictEqual(transform.regexp, /\\s:=(.*)/);\n\t\tassert.strictEqual(transform.children.length, 2);\n\t\tassert.ok(transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>transform.children[0]).index, 1);\n\t\tassert.strictEqual((<FormatString>transform.children[0]).ifValue, ' :=');\n\t\tassert.ok(transform.children[1] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>transform.children[1]).index, 1);\n\t\tassert.ok(children[4] instanceof Text);\n\t\tassert.strictEqual(children[4].toString(), ';\\n');\n\n\t});\n\n\t// TODO @jrieken making this strictEqul causes circular json conversion errors\n\ttest('Parser, default placeholder values', () => {\n\n\t\tassertMarker('errorContext: `${1:err}`, error: $1', Text, Placeholder, Text, Placeholder);\n\n\t\tconst [, p1, , p2] = new SnippetParser().parse('errorContext: `${1:err}`, error:$1').children;\n\n\t\tassert.strictEqual((<Placeholder>p1).index, 1);\n\t\tassert.strictEqual((<Placeholder>p1).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p1).children[0]).toString(), 'err');\n\n\t\tassert.strictEqual((<Placeholder>p2).index, 1);\n\t\tassert.strictEqual((<Placeholder>p2).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p2).children[0]).toString(), 'err');\n\t});\n\n\t// TODO @jrieken making this strictEqul causes circular json conversion errors\n\ttest('Parser, default placeholder values and one transform', () => {\n\n\t\tassertMarker('errorContext: `${1:err}`, error: ${1/err/ok/}', Text, Placeholder, Text, Placeholder);\n\n\t\tconst [, p3, , p4] = new SnippetParser().parse('errorContext: `${1:err}`, error:${1/err/ok/}').children;\n\n\t\tassert.strictEqual((<Placeholder>p3).index, 1);\n\t\tassert.strictEqual((<Placeholder>p3).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p3).children[0]).toString(), 'err');\n\t\tassert.strictEqual((<Placeholder>p3).transform, undefined);\n\n\t\tassert.strictEqual((<Placeholder>p4).index, 1);\n\t\tassert.strictEqual((<Placeholder>p4).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p4).children[0]).toString(), 'err');\n\t\tassert.notStrictEqual((<Placeholder>p4).transform, undefined);\n\t});\n\n\ttest('Repeated snippet placeholder should always inherit, #31040', function () {\n\t\tassertText('${1:foo}-abc-$1', 'foo-abc-foo');\n\t\tassertText('${1:foo}-abc-${1}', 'foo-abc-foo');\n\t\tassertText('${1:foo}-abc-${1:bar}', 'foo-abc-foo');\n\t\tassertText('${1}-abc-${1:foo}', 'foo-abc-foo');\n\t});\n\n\ttest('backspace esapce in TM only, #16212', () => {\n\t\tconst actual = SnippetParser.asInsertText('Foo \\\\\\\\${abc}bar');\n\t\tassert.strictEqual(actual, 'Foo \\\\bar');\n\t});\n\n\ttest('colon as variable/placeholder value, #16717', () => {\n\t\tlet actual = SnippetParser.asInsertText('${TM_SELECTED_TEXT:foo:bar}');\n\t\tassert.strictEqual(actual, 'foo:bar');\n\n\t\tactual = SnippetParser.asInsertText('${1:foo:bar}');\n\t\tassert.strictEqual(actual, 'foo:bar');\n\t});\n\n\ttest('incomplete placeholder', () => {\n\t\tassertTextAndMarker('${1:}', '', Placeholder);\n\t});\n\n\ttest('marker#len', () => {\n\n\t\tfunction assertLen(template: string, ...lengths: number[]): void {\n\t\t\tconst snippet = new SnippetParser().parse(template, true);\n\t\t\tsnippet.walk(m => {\n\t\t\t\tconst expected = lengths.shift();\n\t\t\t\tassert.strictEqual(m.len(), expected);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tassert.strictEqual(lengths.length, 0);\n\t\t}\n\n\t\tassertLen('text$0', 4, 0);\n\t\tassertLen('$1text$0', 0, 4, 0);\n\t\tassertLen('te$1xt$0', 2, 0, 2, 0);\n\t\tassertLen('errorContext: `${1:err}`, error: $0', 15, 0, 3, 10, 0);\n\t\tassertLen('errorContext: `${1:err}`, error: $1$0', 15, 0, 3, 10, 0, 3, 0);\n\t\tassertLen('$TM_SELECTED_TEXT$0', 0, 0);\n\t\tassertLen('${TM_SELECTED_TEXT:def}$0', 0, 3, 0);\n\t});\n\n\ttest('parser, parent node', function () {\n\t\tlet snippet = new SnippetParser().parse('This ${1:is ${2:nested}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tlet [first, second] = snippet.placeholders;\n\t\tassert.strictEqual(first.index, 1);\n\t\tassert.strictEqual(second.index, 2);\n\t\tassert.ok(second.parent === first);\n\t\tassert.ok(first.parent === snippet);\n\n\t\tsnippet = new SnippetParser().parse('${VAR:default${1:value}}$0', true);\n\t\tassert.strictEqual(snippet.placeholders.length, 2);\n\t\t[first] = snippet.placeholders;\n\t\tassert.strictEqual(first.index, 1);\n\n\t\tassert.ok(snippet.children[0] instanceof Variable);\n\t\tassert.ok(first.parent === snippet.children[0]);\n\t});\n\n\ttest('TextmateSnippet#enclosingPlaceholders', () => {\n\t\tconst snippet = new SnippetParser().parse('This ${1:is ${2:nested}}$0', true);\n\t\tconst [first, second] = snippet.placeholders;\n\n\t\tassert.deepStrictEqual(snippet.enclosingPlaceholders(first), []);\n\t\tassert.deepStrictEqual(snippet.enclosingPlaceholders(second), [first]);\n\t});\n\n\ttest('TextmateSnippet#offset', () => {\n\t\tlet snippet = new SnippetParser().parse('te$1xt', true);\n\t\tassert.strictEqual(snippet.offset(snippet.children[0]), 0);\n\t\tassert.strictEqual(snippet.offset(snippet.children[1]), 2);\n\t\tassert.strictEqual(snippet.offset(snippet.children[2]), 2);\n\n\t\tsnippet = new SnippetParser().parse('${TM_SELECTED_TEXT:def}', true);\n\t\tassert.strictEqual(snippet.offset(snippet.children[0]), 0);\n\t\tassert.strictEqual(snippet.offset((<Variable>snippet.children[0]).children[0]), 0);\n\n\t\t// forgein marker\n\t\tassert.strictEqual(snippet.offset(new Text('foo')), -1);\n\t});\n\n\ttest('TextmateSnippet#placeholder', () => {\n\t\tlet snippet = new SnippetParser().parse('te$1xt$0', true);\n\t\tlet placeholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 2);\n\n\t\tsnippet = new SnippetParser().parse('te$1xt$1$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\n\n\t\tsnippet = new SnippetParser().parse('te$1xt$2$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\n\t\tsnippet = new SnippetParser().parse('${1:bar${2:foo}bar}$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\t});\n\n\ttest('TextmateSnippet#replace 1/2', function () {\n\t\tconst snippet = new SnippetParser().parse('aaa${1:bbb${2:ccc}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tconst [, second] = snippet.placeholders;\n\t\tassert.strictEqual(second.index, 2);\n\n\t\tconst enclosing = snippet.enclosingPlaceholders(second);\n\t\tassert.strictEqual(enclosing.length, 1);\n\t\tassert.strictEqual(enclosing[0].index, 1);\n\n\t\tconst nested = new SnippetParser().parse('ddd$1eee$0', true);\n\t\tsnippet.replace(second, nested.children);\n\n\t\tassert.strictEqual(snippet.toString(), 'aaabbbdddeee');\n\t\tassert.strictEqual(snippet.placeholders.length, 4);\n\t\tassert.strictEqual(snippet.placeholders[0].index, 1);\n\t\tassert.strictEqual(snippet.placeholders[1].index, 1);\n\t\tassert.strictEqual(snippet.placeholders[2].index, 0);\n\t\tassert.strictEqual(snippet.placeholders[3].index, 0);\n\n\t\tconst newEnclosing = snippet.enclosingPlaceholders(snippet.placeholders[1]);\n\t\tassert.ok(newEnclosing[0] === snippet.placeholders[0]);\n\t\tassert.strictEqual(newEnclosing.length, 1);\n\t\tassert.strictEqual(newEnclosing[0].index, 1);\n\t});\n\n\ttest('TextmateSnippet#replace 2/2', function () {\n\t\tconst snippet = new SnippetParser().parse('aaa${1:bbb${2:ccc}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tconst [, second] = snippet.placeholders;\n\t\tassert.strictEqual(second.index, 2);\n\n\t\tconst nested = new SnippetParser().parse('dddeee$0', true);\n\t\tsnippet.replace(second, nested.children);\n\n\t\tassert.strictEqual(snippet.toString(), 'aaabbbdddeee');\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t});\n\n\ttest('Snippet order for placeholders, #28185', function () {\n\n\t\tconst _10 = new Placeholder(10);\n\t\tconst _2 = new Placeholder(2);\n\n\t\tassert.strictEqual(Placeholder.compareByIndex(_10, _2), 1);\n\t});\n\n\ttest('Maximum call stack size exceeded, #28983', function () {\n\t\tnew SnippetParser().parse('${1:${foo:${1}}}');\n\t});\n\n\ttest('Snippet can freeze the editor, #30407', function () {\n\n\t\tconst seen = new Set<Marker>();\n\n\t\tseen.clear();\n\t\tnew SnippetParser().parse('class ${1:${TM_FILENAME/(?:\\\\A|_)([A-Za-z0-9]+)(?:\\\\.rb)?/(?2::\\\\u$1)/g}} < ${2:Application}Controller\\n  $3\\nend').walk(marker => {\n\t\t\tassert.ok(!seen.has(marker));\n\t\t\tseen.add(marker);\n\t\t\treturn true;\n\t\t});\n\n\t\tseen.clear();\n\t\tnew SnippetParser().parse('${1:${FOO:abc$1def}}').walk(marker => {\n\t\t\tassert.ok(!seen.has(marker));\n\t\t\tseen.add(marker);\n\t\t\treturn true;\n\t\t});\n\t});\n\n\ttest('Snippets: make parser ignore `${0|choice|}`, #31599', function () {\n\t\tassertTextAndMarker('${0|foo,bar|}', '${0|foo,bar|}', Text);\n\t\tassertTextAndMarker('${1|foo,bar|}', 'foo', Placeholder);\n\t});\n\n\n\ttest('Transform -> FormatString#resolve', function () {\n\n\t\t// shorthand functions\n\t\tassert.strictEqual(new FormatString(1, 'upcase').resolve('foo'), 'FOO');\n\t\tassert.strictEqual(new FormatString(1, 'downcase').resolve('FOO'), 'foo');\n\t\tassert.strictEqual(new FormatString(1, 'capitalize').resolve('bar'), 'Bar');\n\t\tassert.strictEqual(new FormatString(1, 'capitalize').resolve('bar no repeat'), 'Bar no repeat');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('bar-foo'), 'BarFoo');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('bar-42-foo'), 'Bar42Foo');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('snake_AndPascalCase'), 'SnakeAndPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('kebab-AndPascalCase'), 'KebabAndPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('_justPascalCase'), 'JustPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('bar-foo'), 'barFoo');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('bar-42-foo'), 'bar42Foo');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('snake_AndCamelCase'), 'snakeAndCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('kebab-AndCamelCase'), 'kebabAndCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('_JustCamelCase'), 'justCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'notKnown').resolve('input'), 'input');\n\n\t\t// if\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve(undefined), '');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve(''), '');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve('bar'), 'foo');\n\n\t\t// else\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve(undefined), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve(''), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve('bar'), 'bar');\n\n\t\t// if-else\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve(undefined), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve(''), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve('baz'), 'bar');\n\t});\n\n\ttest('Snippet variable transformation doesn\\'t work if regex is complicated and snippet body contains \\'$$\\' #55627', function () {\n\t\tconst snippet = new SnippetParser().parse('const fileName = \"${TM_FILENAME/(.*)\\\\..+$/$1/}\"');\n\t\tassert.strictEqual(snippet.toTextmateString(), 'const fileName = \"${TM_FILENAME/(.*)\\\\..+$/${1}/}\"');\n\t});\n\n\ttest('[BUG] HTML attribute suggestions: Snippet session does not have end-position set, #33147', function () {\n\n\t\tconst { placeholders } = new SnippetParser().parse('src=\"$1\"', true);\n\t\tconst [first, second] = placeholders;\n\n\t\tassert.strictEqual(placeholders.length, 2);\n\t\tassert.strictEqual(first.index, 1);\n\t\tassert.strictEqual(second.index, 0);\n\n\t});\n\n\ttest('Snippet optional transforms are not applied correctly when reusing the same variable, #37702', function () {\n\n\t\tconst transform = new Transform();\n\t\ttransform.appendChild(new FormatString(1, 'upcase'));\n\t\ttransform.appendChild(new FormatString(2, 'upcase'));\n\t\ttransform.regexp = /^(.)|-(.)/g;\n\n\t\tassert.strictEqual(transform.resolve('my-file-name'), 'MyFileName');\n\n\t\tconst clone = transform.clone();\n\t\tassert.strictEqual(clone.resolve('my-file-name'), 'MyFileName');\n\t});\n\n\ttest('problem with snippets regex #40570', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${TM_DIRECTORY/.*src[\\\\/](.*)/$1/}');\n\t\tassertMarker(snippet, Variable);\n\t});\n\n\ttest('Variable transformation doesn\\'t work if undefined variables are used in the same snippet #51769', function () {\n\t\tconst transform = new Transform();\n\t\ttransform.appendChild(new Text('bar'));\n\t\ttransform.regexp = new RegExp('foo', 'gi');\n\t\tassert.strictEqual(transform.toTextmateString(), '/foo/bar/ig');\n\t});\n\n\ttest('Snippet parser freeze #53144', function () {\n\t\tconst snippet = new SnippetParser().parse('${1/(void$)|(.+)/${1:?-\\treturn nil;}/}');\n\t\tassertMarker(snippet, Placeholder);\n\t});\n\n\ttest('snippets variable not resolved in JSON proposal #52931', function () {\n\t\tassertTextAndMarker('FOO${1:/bin/bash}', 'FOO/bin/bash', Text, Placeholder);\n\t});\n\n\ttest('Mirroring sequence of nested placeholders not selected properly on backjumping #58736', function () {\n\t\tconst snippet = new SnippetParser().parse('${3:nest1 ${1:nest2 ${2:nest3}}} $3');\n\t\tassert.strictEqual(snippet.children.length, 3);\n\t\tassert.ok(snippet.children[0] instanceof Placeholder);\n\t\tassert.ok(snippet.children[1] instanceof Text);\n\t\tassert.ok(snippet.children[2] instanceof Placeholder);\n\n\t\tfunction assertParent(marker: Marker) {\n\t\t\tmarker.children.forEach(assertParent);\n\t\t\tif (!(marker instanceof Placeholder)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet found = false;\n\t\t\tlet m: Marker = marker;\n\t\t\twhile (m && !found) {\n\t\t\t\tif (m.parent === snippet) {\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t\tm = m.parent;\n\t\t\t}\n\t\t\tassert.ok(found);\n\t\t}\n\t\tconst [, , clone] = snippet.children;\n\t\tassertParent(clone);\n\t});\n\n\ttest('Backspace can\\'t be escaped in snippet variable transforms #65412', function () {\n\n\t\tconst snippet = new SnippetParser().parse('namespace ${TM_DIRECTORY/[\\\\/]/\\\\\\\\/g};');\n\t\tassertMarker(snippet, Text, Variable, Text);\n\t});\n\n\ttest('Snippet cannot escape closing bracket inside conditional insertion variable replacement #78883', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${TM_DIRECTORY/(.+)/${1:+import { hello \\\\} from world}/}');\n\t\tconst variable = <Variable>snippet.children[0];\n\t\tassert.strictEqual(snippet.children.length, 1);\n\t\tassert.ok(variable instanceof Variable);\n\t\tassert.ok(variable.transform);\n\t\tassert.strictEqual(variable.transform.children.length, 1);\n\t\tassert.ok(variable.transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).ifValue, 'import { hello } from world');\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).elseValue, undefined);\n\t});\n\n\ttest('Snippet escape backslashes inside conditional insertion variable replacement #80394', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${CURRENT_YEAR/(.+)/${1:+\\\\\\\\}/}');\n\t\tconst variable = <Variable>snippet.children[0];\n\t\tassert.strictEqual(snippet.children.length, 1);\n\t\tassert.ok(variable instanceof Variable);\n\t\tassert.ok(variable.transform);\n\t\tassert.strictEqual(variable.transform.children.length, 1);\n\t\tassert.ok(variable.transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).ifValue, '\\\\');\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).elseValue, undefined);\n\t});\n\n\ttest('Snippet placeholder empty right after expansion #152553', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${1:prog}: ${2:$1.cc} - $2');\n\t\tconst actual = snippet.toString();\n\t\tassert.strictEqual(actual, 'prog: prog.cc - prog.cc');\n\n\t\tconst snippet2 = new SnippetParser().parse('${1:prog}: ${3:${2:$1.cc}.33} - $2 $3');\n\t\tconst actual2 = snippet2.toString();\n\t\tassert.strictEqual(actual2, 'prog: prog.cc.33 - prog.cc prog.cc.33');\n\n\t\t// cyclic references of placeholders\n\t\tconst snippet3 = new SnippetParser().parse('${1:$2.one} <> ${2:$1.two}');\n\t\tconst actual3 = snippet3.toString();\n\t\tassert.strictEqual(actual3, '.two.one.two.one <> .one.two.one.two');\n\t});\n\n\ttest('Snippet choices are incorrectly escaped/applied #180132', function () {\n\t\tassertTextAndMarker('${1|aaa$aaa|}bbb\\\\$bbb', 'aaa$aaabbb$bbb', Placeholder, Text);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Choice, FormatString, Marker, Placeholder, Scanner, SnippetParser, Text, TextmateSnippet, TokenType, Transform, Variable } from '../../browser/snippetParser.js';\n\nsuite('SnippetParser', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Scanner', () => {\n\n\t\tconst scanner = new Scanner();\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('{{abc}}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc() ');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Format);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('abc 123');\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Format);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Int);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo_bar');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('$foo-bar');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('${foo}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('${1223:foo}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Int);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Colon);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\n\t\tscanner.text('\\\\${}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Backslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\n\t\tscanner.text('${foo/regex/format/option}');\n\t\tassert.strictEqual(scanner.next().type, TokenType.Dollar);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyOpen);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.Forwardslash);\n\t\tassert.strictEqual(scanner.next().type, TokenType.VariableName);\n\t\tassert.strictEqual(scanner.next().type, TokenType.CurlyClose);\n\t\tassert.strictEqual(scanner.next().type, TokenType.EOF);\n\t});\n\n\tfunction assertText(value: string, expected: string) {\n\t\tconst actual = SnippetParser.asInsertText(value);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\tfunction assertMarker(input: TextmateSnippet | Marker[] | string, ...ctors: Function[]) {\n\t\tlet marker: Marker[];\n\t\tif (input instanceof TextmateSnippet) {\n\t\t\tmarker = [...input.children];\n\t\t} else if (typeof input === 'string') {\n\t\t\tconst p = new SnippetParser();\n\t\t\tmarker = p.parse(input).children;\n\t\t} else {\n\t\t\tmarker = [...input];\n\t\t}\n\t\twhile (marker.length > 0) {\n\t\t\tconst m = marker.pop();\n\t\t\tconst ctor = ctors.pop()!;\n\t\t\tassert.ok(m instanceof ctor);\n\t\t}\n\t\tassert.strictEqual(marker.length, ctors.length);\n\t\tassert.strictEqual(marker.length, 0);\n\t}\n\n\tfunction assertTextAndMarker(value: string, escaped: string, ...ctors: Function[]) {\n\t\tassertText(value, escaped);\n\t\tassertMarker(value, ...ctors);\n\t}\n\n\tfunction assertEscaped(value: string, expected: string) {\n\t\tconst actual = SnippetParser.escape(value);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\ttest('Parser, escaped', function () {\n\t\tassertEscaped('foo$0', 'foo\\\\$0');\n\t\tassertEscaped('foo\\\\$0', 'foo\\\\\\\\\\\\$0');\n\t\tassertEscaped('f$1oo$0', 'f\\\\$1oo\\\\$0');\n\t\tassertEscaped('${1:foo}$0', '\\\\${1:foo\\\\}\\\\$0');\n\t\tassertEscaped('$', '\\\\$');\n\t});\n\n\ttest('Parser, text', () => {\n\t\tassertText('$', '$');\n\t\tassertText('\\\\\\\\$', '\\\\$');\n\t\tassertText('{', '{');\n\t\tassertText('\\\\}', '}');\n\t\tassertText('\\\\abc', '\\\\abc');\n\t\tassertText('foo${f:\\\\}}bar', 'foo}bar');\n\t\tassertText('\\\\{', '\\\\{');\n\t\tassertText('I need \\\\\\\\\\\\$', 'I need \\\\$');\n\t\tassertText('\\\\', '\\\\');\n\t\tassertText('\\\\{{', '\\\\{{');\n\t\tassertText('{{', '{{');\n\t\tassertText('{{dd', '{{dd');\n\t\tassertText('}}', '}}');\n\t\tassertText('ff}}', 'ff}}');\n\n\t\tassertText('farboo', 'farboo');\n\t\tassertText('far{{}}boo', 'far{{}}boo');\n\t\tassertText('far{{123}}boo', 'far{{123}}boo');\n\t\tassertText('far\\\\{{123}}boo', 'far\\\\{{123}}boo');\n\t\tassertText('far{{id:bern}}boo', 'far{{id:bern}}boo');\n\t\tassertText('far{{id:bern {{basel}}}}boo', 'far{{id:bern {{basel}}}}boo');\n\t\tassertText('far{{id:bern {{id:basel}}}}boo', 'far{{id:bern {{id:basel}}}}boo');\n\t\tassertText('far{{id:bern {{id2:basel}}}}boo', 'far{{id:bern {{id2:basel}}}}boo');\n\t});\n\n\n\ttest('Parser, TM text', () => {\n\t\tassertTextAndMarker('foo${1:bar}}', 'foobar}', Text, Placeholder, Text);\n\t\tassertTextAndMarker('foo${1:bar}${2:foo}}', 'foobarfoo}', Text, Placeholder, Placeholder, Text);\n\n\t\tassertTextAndMarker('foo${1:bar\\\\}${2:foo}}', 'foobar}foo', Text, Placeholder);\n\n\t\tconst [, placeholder] = new SnippetParser().parse('foo${1:bar\\\\}${2:foo}}').children;\n\t\tconst { children } = (<Placeholder>placeholder);\n\n\t\tassert.strictEqual((<Placeholder>placeholder).index, 1);\n\t\tassert.ok(children[0] instanceof Text);\n\t\tassert.strictEqual(children[0].toString(), 'bar}');\n\t\tassert.ok(children[1] instanceof Placeholder);\n\t\tassert.strictEqual(children[1].toString(), 'foo');\n\t});\n\n\ttest('Parser, placeholder', () => {\n\t\tassertTextAndMarker('farboo', 'farboo', Text);\n\t\tassertTextAndMarker('far{{}}boo', 'far{{}}boo', Text);\n\t\tassertTextAndMarker('far{{123}}boo', 'far{{123}}boo', Text);\n\t\tassertTextAndMarker('far\\\\{{123}}boo', 'far\\\\{{123}}boo', Text);\n\t});\n\n\ttest('Parser, literal code', () => {\n\t\tassertTextAndMarker('far`123`boo', 'far`123`boo', Text);\n\t\tassertTextAndMarker('far\\\\`123\\\\`boo', 'far\\\\`123\\\\`boo', Text);\n\t});\n\n\ttest('Parser, variables/tabstop', () => {\n\t\tassertTextAndMarker('$far-boo', '-boo', Variable, Text);\n\t\tassertTextAndMarker('\\\\$far-boo', '$far-boo', Text);\n\t\tassertTextAndMarker('far$farboo', 'far', Text, Variable);\n\t\tassertTextAndMarker('far${farboo}', 'far', Text, Variable);\n\t\tassertTextAndMarker('$123', '', Placeholder);\n\t\tassertTextAndMarker('$farboo', '', Variable);\n\t\tassertTextAndMarker('$far12boo', '', Variable);\n\t\tassertTextAndMarker('000_${far}_000', '000__000', Text, Variable, Text);\n\t\tassertTextAndMarker('FFF_${TM_SELECTED_TEXT}_FFF$0', 'FFF__FFF', Text, Variable, Text, Placeholder);\n\t});\n\n\ttest('Parser, variables/placeholder with defaults', () => {\n\t\tassertTextAndMarker('${name:value}', 'value', Variable);\n\t\tassertTextAndMarker('${1:value}', 'value', Placeholder);\n\t\tassertTextAndMarker('${1:bar${2:foo}bar}', 'barfoobar', Placeholder);\n\n\t\tassertTextAndMarker('${name:value', '${name:value', Text);\n\t\tassertTextAndMarker('${1:bar${2:foobar}', '${1:barfoobar', Text, Placeholder);\n\t});\n\n\ttest('Parser, variable transforms', function () {\n\t\tassertTextAndMarker('${foo///}', '', Variable);\n\t\tassertTextAndMarker('${foo/regex/format/gmi}', '', Variable);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/}', '', Variable);\n\n\t\t// invalid regex\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/GMI}', '${foo/([A-Z][a-z])/format/GMI}', Text);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z])/format/funky}', '${foo/([A-Z][a-z])/format/funky}', Text);\n\t\tassertTextAndMarker('${foo/([A-Z][a-z]/format/}', '${foo/([A-Z][a-z]/format/}', Text);\n\n\t\t// tricky regex\n\t\tassertTextAndMarker('${foo/m\\\\/atch/$1/i}', '', Variable);\n\t\tassertMarker('${foo/regex\\/format/options}', Text);\n\n\t\t// incomplete\n\t\tassertTextAndMarker('${foo///', '${foo///', Text);\n\t\tassertTextAndMarker('${foo/regex/format/options', '${foo/regex/format/options', Text);\n\n\t\t// format string\n\t\tassertMarker('${foo/.*/${0:fooo}/i}', Variable);\n\t\tassertMarker('${foo/.*/${1}/i}', Variable);\n\t\tassertMarker('${foo/.*/$1/i}', Variable);\n\t\tassertMarker('${foo/.*/This-$1-encloses/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:-else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:+if}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:?if:else}/i}', Variable);\n\t\tassertMarker('${foo/.*/complex${1:/upcase}/i}', Variable);\n\n\t});\n\n\ttest('Parser, placeholder transforms', function () {\n\t\tassertTextAndMarker('${1///}', '', Placeholder);\n\t\tassertTextAndMarker('${1/regex/format/gmi}', '', Placeholder);\n\t\tassertTextAndMarker('${1/([A-Z][a-z])/format/}', '', Placeholder);\n\n\t\t// tricky regex\n\t\tassertTextAndMarker('${1/m\\\\/atch/$1/i}', '', Placeholder);\n\t\tassertMarker('${1/regex\\/format/options}', Text);\n\n\t\t// incomplete\n\t\tassertTextAndMarker('${1///', '${1///', Text);\n\t\tassertTextAndMarker('${1/regex/format/options', '${1/regex/format/options', Text);\n\t});\n\n\ttest('No way to escape forward slash in snippet regex #36715', function () {\n\t\tassertMarker('${TM_DIRECTORY/src\\\\//$1/}', Variable);\n\t});\n\n\ttest('No way to escape forward slash in snippet format section #37562', function () {\n\t\tassertMarker('${TM_SELECTED_TEXT/a/\\\\/$1/g}', Variable);\n\t\tassertMarker('${TM_SELECTED_TEXT/a/in\\\\/$1ner/g}', Variable);\n\t\tassertMarker('${TM_SELECTED_TEXT/a/end\\\\//g}', Variable);\n\t});\n\n\ttest('Parser, placeholder with choice', () => {\n\n\t\tassertTextAndMarker('${1|one,two,three|}', 'one', Placeholder);\n\t\tassertTextAndMarker('${1|one|}', 'one', Placeholder);\n\t\tassertTextAndMarker('${1|one1,two2|}', 'one1', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\,two2|}', 'one1,two2', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\|two2|}', 'one1|two2', Placeholder);\n\t\tassertTextAndMarker('${1|one1\\\\atwo2|}', 'one1\\\\atwo2', Placeholder);\n\t\tassertTextAndMarker('${1|one,two,three,|}', '${1|one,two,three,|}', Text);\n\t\tassertTextAndMarker('${1|one,', '${1|one,', Text);\n\n\t\tconst snippet = new SnippetParser().parse('${1|one,two,three|}');\n\t\tconst expected: ((m: Marker) => boolean)[] = [\n\t\t\tm => m instanceof Placeholder,\n\t\t\tm => m instanceof Choice && m.options.length === 3 && m.options.every(x => x instanceof Text),\n\t\t];\n\t\tsnippet.walk(marker => {\n\t\t\tassert.ok(expected.shift()!(marker));\n\t\t\treturn true;\n\t\t});\n\t});\n\n\ttest('Snippet choices: unable to escape comma and pipe, #31521', function () {\n\t\tassertTextAndMarker('console.log(${1|not\\\\, not, five, 5, 1   23|});', 'console.log(not, not);', Text, Placeholder, Text);\n\t});\n\n\ttest('Marker, toTextmateString()', function () {\n\n\t\tfunction assertTextsnippetString(input: string, expected: string): void {\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tconst actual = snippet.toTextmateString();\n\t\t\tassert.strictEqual(actual, expected);\n\t\t}\n\n\t\tassertTextsnippetString('$1', '$1');\n\t\tassertTextsnippetString('\\\\$1', '\\\\$1');\n\t\tassertTextsnippetString('console.log(${1|not\\\\, not, five, 5, 1   23|});', 'console.log(${1|not\\\\, not, five, 5, 1   23|});');\n\t\tassertTextsnippetString('console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});', 'console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});');\n\t\tassertTextsnippetString('${1|cho\\\\,ices,wi\\\\|th,esc\\\\\\\\aping,chall\\\\\\\\\\\\,enges|}', '${1|cho\\\\,ices,wi\\\\|th,esc\\\\\\\\aping,chall\\\\\\\\\\\\,enges|}');\n\t\tassertTextsnippetString('this is text', 'this is text');\n\t\tassertTextsnippetString('this ${1:is ${2:nested with $var}}', 'this ${1:is ${2:nested with ${var}}}');\n\t\tassertTextsnippetString('this ${1:is ${2:nested with $var}}}', 'this ${1:is ${2:nested with ${var}}}\\\\}');\n\t});\n\n\ttest('Marker, toTextmateString() <-> identity', function () {\n\n\t\tfunction assertIdent(input: string): void {\n\t\t\t// full loop: (1) parse input, (2) generate textmate string, (3) parse, (4) ensure both trees are equal\n\t\t\tconst snippet = new SnippetParser().parse(input);\n\t\t\tconst input2 = snippet.toTextmateString();\n\t\t\tconst snippet2 = new SnippetParser().parse(input2);\n\n\t\t\tfunction checkCheckChildren(marker1: Marker, marker2: Marker) {\n\t\t\t\tassert.ok(marker1 instanceof Object.getPrototypeOf(marker2).constructor);\n\t\t\t\tassert.ok(marker2 instanceof Object.getPrototypeOf(marker1).constructor);\n\n\t\t\t\tassert.strictEqual(marker1.children.length, marker2.children.length);\n\t\t\t\tassert.strictEqual(marker1.toString(), marker2.toString());\n\n\t\t\t\tfor (let i = 0; i < marker1.children.length; i++) {\n\t\t\t\t\tcheckCheckChildren(marker1.children[i], marker2.children[i]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcheckCheckChildren(snippet, snippet2);\n\t\t}\n\n\t\tassertIdent('$1');\n\t\tassertIdent('\\\\$1');\n\t\tassertIdent('console.log(${1|not\\\\, not, five, 5, 1   23|});');\n\t\tassertIdent('console.log(${1|not\\\\, not, \\\\| five, 5, 1   23|});');\n\t\tassertIdent('this is text');\n\t\tassertIdent('this ${1:is ${2:nested with $var}}');\n\t\tassertIdent('this ${1:is ${2:nested with $var}}}');\n\t\tassertIdent('this ${1:is ${2:nested with $var}} and repeating $1');\n\t});\n\n\ttest('Parser, choise marker', () => {\n\t\tconst { placeholders } = new SnippetParser().parse('${1|one,two,three|}');\n\n\t\tassert.strictEqual(placeholders.length, 1);\n\t\tassert.ok(placeholders[0].choice instanceof Choice);\n\t\tassert.ok(placeholders[0].children[0] instanceof Choice);\n\t\tassert.strictEqual((<Choice>placeholders[0].children[0]).options.length, 3);\n\n\t\tassertText('${1|one,two,three|}', 'one');\n\t\tassertText('\\\\${1|one,two,three|}', '${1|one,two,three|}');\n\t\tassertText('${1\\\\|one,two,three|}', '${1\\\\|one,two,three|}');\n\t\tassertText('${1||}', '${1||}');\n\t});\n\n\ttest('Backslash character escape in choice tabstop doesn\\'t work #58494', function () {\n\n\t\tconst { placeholders } = new SnippetParser().parse('${1|\\\\,,},$,\\\\|,\\\\\\\\|}');\n\t\tassert.strictEqual(placeholders.length, 1);\n\t\tassert.ok(placeholders[0].choice instanceof Choice);\n\t});\n\n\ttest('Parser, only textmate', () => {\n\t\tconst p = new SnippetParser();\n\t\tassertMarker(p.parse('far{{}}boo'), Text);\n\t\tassertMarker(p.parse('far{{123}}boo'), Text);\n\t\tassertMarker(p.parse('far\\\\{{123}}boo'), Text);\n\n\t\tassertMarker(p.parse('far$0boo'), Text, Placeholder, Text);\n\t\tassertMarker(p.parse('far${123}boo'), Text, Placeholder, Text);\n\t\tassertMarker(p.parse('far\\\\${123}boo'), Text);\n\t});\n\n\ttest('Parser, real world', () => {\n\t\tlet marker = new SnippetParser().parse('console.warn(${1: $TM_SELECTED_TEXT })').children;\n\n\t\tassert.strictEqual(marker[0].toString(), 'console.warn(');\n\t\tassert.ok(marker[1] instanceof Placeholder);\n\t\tassert.strictEqual(marker[2].toString(), ')');\n\n\t\tconst placeholder = <Placeholder>marker[1];\n\t\tassert.strictEqual(placeholder.index, 1);\n\t\tassert.strictEqual(placeholder.children.length, 3);\n\t\tassert.ok(placeholder.children[0] instanceof Text);\n\t\tassert.ok(placeholder.children[1] instanceof Variable);\n\t\tassert.ok(placeholder.children[2] instanceof Text);\n\t\tassert.strictEqual(placeholder.children[0].toString(), ' ');\n\t\tassert.strictEqual(placeholder.children[1].toString(), '');\n\t\tassert.strictEqual(placeholder.children[2].toString(), ' ');\n\n\t\tconst nestedVariable = <Variable>placeholder.children[1];\n\t\tassert.strictEqual(nestedVariable.name, 'TM_SELECTED_TEXT');\n\t\tassert.strictEqual(nestedVariable.children.length, 0);\n\n\t\tmarker = new SnippetParser().parse('$TM_SELECTED_TEXT').children;\n\t\tassert.strictEqual(marker.length, 1);\n\t\tassert.ok(marker[0] instanceof Variable);\n\t});\n\n\ttest('Parser, transform example', () => {\n\t\tconst { children } = new SnippetParser().parse('${1:name} : ${2:type}${3/\\\\s:=(.*)/${1:+ :=}${1}/};\\n$0');\n\n\t\t//${1:name}\n\t\tassert.ok(children[0] instanceof Placeholder);\n\t\tassert.strictEqual(children[0].children.length, 1);\n\t\tassert.strictEqual(children[0].children[0].toString(), 'name');\n\t\tassert.strictEqual((<Placeholder>children[0]).transform, undefined);\n\n\t\t// :\n\t\tassert.ok(children[1] instanceof Text);\n\t\tassert.strictEqual(children[1].toString(), ' : ');\n\n\t\t//${2:type}\n\t\tassert.ok(children[2] instanceof Placeholder);\n\t\tassert.strictEqual(children[2].children.length, 1);\n\t\tassert.strictEqual(children[2].children[0].toString(), 'type');\n\n\t\t//${3/\\\\s:=(.*)/${1:+ :=}${1}/}\n\t\tassert.ok(children[3] instanceof Placeholder);\n\t\tassert.strictEqual(children[3].children.length, 0);\n\t\tassert.notStrictEqual((<Placeholder>children[3]).transform, undefined);\n\t\tconst transform = (<Placeholder>children[3]).transform!;\n\t\tassert.deepStrictEqual(transform.regexp, /\\s:=(.*)/);\n\t\tassert.strictEqual(transform.children.length, 2);\n\t\tassert.ok(transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>transform.children[0]).index, 1);\n\t\tassert.strictEqual((<FormatString>transform.children[0]).ifValue, ' :=');\n\t\tassert.ok(transform.children[1] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>transform.children[1]).index, 1);\n\t\tassert.ok(children[4] instanceof Text);\n\t\tassert.strictEqual(children[4].toString(), ';\\n');\n\n\t});\n\n\t// TODO @jrieken making this strictEqul causes circular json conversion errors\n\ttest('Parser, default placeholder values', () => {\n\n\t\tassertMarker('errorContext: `${1:err}`, error: $1', Text, Placeholder, Text, Placeholder);\n\n\t\tconst [, p1, , p2] = new SnippetParser().parse('errorContext: `${1:err}`, error:$1').children;\n\n\t\tassert.strictEqual((<Placeholder>p1).index, 1);\n\t\tassert.strictEqual((<Placeholder>p1).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p1).children[0]).toString(), 'err');\n\n\t\tassert.strictEqual((<Placeholder>p2).index, 1);\n\t\tassert.strictEqual((<Placeholder>p2).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p2).children[0]).toString(), 'err');\n\t});\n\n\t// TODO @jrieken making this strictEqul causes circular json conversion errors\n\ttest('Parser, default placeholder values and one transform', () => {\n\n\t\tassertMarker('errorContext: `${1:err}`, error: ${1/err/ok/}', Text, Placeholder, Text, Placeholder);\n\n\t\tconst [, p3, , p4] = new SnippetParser().parse('errorContext: `${1:err}`, error:${1/err/ok/}').children;\n\n\t\tassert.strictEqual((<Placeholder>p3).index, 1);\n\t\tassert.strictEqual((<Placeholder>p3).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p3).children[0]).toString(), 'err');\n\t\tassert.strictEqual((<Placeholder>p3).transform, undefined);\n\n\t\tassert.strictEqual((<Placeholder>p4).index, 1);\n\t\tassert.strictEqual((<Placeholder>p4).children.length, 1);\n\t\tassert.strictEqual((<Text>(<Placeholder>p4).children[0]).toString(), 'err');\n\t\tassert.notStrictEqual((<Placeholder>p4).transform, undefined);\n\t});\n\n\ttest('Repeated snippet placeholder should always inherit, #31040', function () {\n\t\tassertText('${1:foo}-abc-$1', 'foo-abc-foo');\n\t\tassertText('${1:foo}-abc-${1}', 'foo-abc-foo');\n\t\tassertText('${1:foo}-abc-${1:bar}', 'foo-abc-foo');\n\t\tassertText('${1}-abc-${1:foo}', 'foo-abc-foo');\n\t});\n\n\ttest('backspace esapce in TM only, #16212', () => {\n\t\tconst actual = SnippetParser.asInsertText('Foo \\\\\\\\${abc}bar');\n\t\tassert.strictEqual(actual, 'Foo \\\\bar');\n\t});\n\n\ttest('colon as variable/placeholder value, #16717', () => {\n\t\tlet actual = SnippetParser.asInsertText('${TM_SELECTED_TEXT:foo:bar}');\n\t\tassert.strictEqual(actual, 'foo:bar');\n\n\t\tactual = SnippetParser.asInsertText('${1:foo:bar}');\n\t\tassert.strictEqual(actual, 'foo:bar');\n\t});\n\n\ttest('incomplete placeholder', () => {\n\t\tassertTextAndMarker('${1:}', '', Placeholder);\n\t});\n\n\ttest('marker#len', () => {\n\n\t\tfunction assertLen(template: string, ...lengths: number[]): void {\n\t\t\tconst snippet = new SnippetParser().parse(template, true);\n\t\t\tsnippet.walk(m => {\n\t\t\t\tconst expected = lengths.shift();\n\t\t\t\tassert.strictEqual(m.len(), expected);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tassert.strictEqual(lengths.length, 0);\n\t\t}\n\n\t\tassertLen('text$0', 4, 0);\n\t\tassertLen('$1text$0', 0, 4, 0);\n\t\tassertLen('te$1xt$0', 2, 0, 2, 0);\n\t\tassertLen('errorContext: `${1:err}`, error: $0', 15, 0, 3, 10, 0);\n\t\tassertLen('errorContext: `${1:err}`, error: $1$0', 15, 0, 3, 10, 0, 3, 0);\n\t\tassertLen('$TM_SELECTED_TEXT$0', 0, 0);\n\t\tassertLen('${TM_SELECTED_TEXT:def}$0', 0, 3, 0);\n\t});\n\n\ttest('parser, parent node', function () {\n\t\tlet snippet = new SnippetParser().parse('This ${1:is ${2:nested}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tlet [first, second] = snippet.placeholders;\n\t\tassert.strictEqual(first.index, 1);\n\t\tassert.strictEqual(second.index, 2);\n\t\tassert.ok(second.parent === first);\n\t\tassert.ok(first.parent === snippet);\n\n\t\tsnippet = new SnippetParser().parse('${VAR:default${1:value}}$0', true);\n\t\tassert.strictEqual(snippet.placeholders.length, 2);\n\t\t[first] = snippet.placeholders;\n\t\tassert.strictEqual(first.index, 1);\n\n\t\tassert.ok(snippet.children[0] instanceof Variable);\n\t\tassert.ok(first.parent === snippet.children[0]);\n\t});\n\n\ttest('TextmateSnippet#enclosingPlaceholders', () => {\n\t\tconst snippet = new SnippetParser().parse('This ${1:is ${2:nested}}$0', true);\n\t\tconst [first, second] = snippet.placeholders;\n\n\t\tassert.deepStrictEqual(snippet.enclosingPlaceholders(first), []);\n\t\tassert.deepStrictEqual(snippet.enclosingPlaceholders(second), [first]);\n\t});\n\n\ttest('TextmateSnippet#offset', () => {\n\t\tlet snippet = new SnippetParser().parse('te$1xt', true);\n\t\tassert.strictEqual(snippet.offset(snippet.children[0]), 0);\n\t\tassert.strictEqual(snippet.offset(snippet.children[1]), 2);\n\t\tassert.strictEqual(snippet.offset(snippet.children[2]), 2);\n\n\t\tsnippet = new SnippetParser().parse('${TM_SELECTED_TEXT:def}', true);\n\t\tassert.strictEqual(snippet.offset(snippet.children[0]), 0);\n\t\tassert.strictEqual(snippet.offset((<Variable>snippet.children[0]).children[0]), 0);\n\n\t\t// forgein marker\n\t\tassert.strictEqual(snippet.offset(new Text('foo')), -1);\n\t});\n\n\ttest('TextmateSnippet#placeholder', () => {\n\t\tlet snippet = new SnippetParser().parse('te$1xt$0', true);\n\t\tlet placeholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 2);\n\n\t\tsnippet = new SnippetParser().parse('te$1xt$1$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\n\n\t\tsnippet = new SnippetParser().parse('te$1xt$2$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\n\t\tsnippet = new SnippetParser().parse('${1:bar${2:foo}bar}$0', true);\n\t\tplaceholders = snippet.placeholders;\n\t\tassert.strictEqual(placeholders.length, 3);\n\t});\n\n\ttest('TextmateSnippet#replace 1/2', function () {\n\t\tconst snippet = new SnippetParser().parse('aaa${1:bbb${2:ccc}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tconst [, second] = snippet.placeholders;\n\t\tassert.strictEqual(second.index, 2);\n\n\t\tconst enclosing = snippet.enclosingPlaceholders(second);\n\t\tassert.strictEqual(enclosing.length, 1);\n\t\tassert.strictEqual(enclosing[0].index, 1);\n\n\t\tconst nested = new SnippetParser().parse('ddd$1eee$0', true);\n\t\tsnippet.replace(second, nested.children);\n\n\t\tassert.strictEqual(snippet.toString(), 'aaabbbdddeee');\n\t\tassert.strictEqual(snippet.placeholders.length, 4);\n\t\tassert.strictEqual(snippet.placeholders[0].index, 1);\n\t\tassert.strictEqual(snippet.placeholders[1].index, 1);\n\t\tassert.strictEqual(snippet.placeholders[2].index, 0);\n\t\tassert.strictEqual(snippet.placeholders[3].index, 0);\n\n\t\tconst newEnclosing = snippet.enclosingPlaceholders(snippet.placeholders[1]);\n\t\tassert.ok(newEnclosing[0] === snippet.placeholders[0]);\n\t\tassert.strictEqual(newEnclosing.length, 1);\n\t\tassert.strictEqual(newEnclosing[0].index, 1);\n\t});\n\n\ttest('TextmateSnippet#replace 2/2', function () {\n\t\tconst snippet = new SnippetParser().parse('aaa${1:bbb${2:ccc}}$0', true);\n\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t\tconst [, second] = snippet.placeholders;\n\t\tassert.strictEqual(second.index, 2);\n\n\t\tconst nested = new SnippetParser().parse('dddeee$0', true);\n\t\tsnippet.replace(second, nested.children);\n\n\t\tassert.strictEqual(snippet.toString(), 'aaabbbdddeee');\n\t\tassert.strictEqual(snippet.placeholders.length, 3);\n\t});\n\n\ttest('Snippet order for placeholders, #28185', function () {\n\n\t\tconst _10 = new Placeholder(10);\n\t\tconst _2 = new Placeholder(2);\n\n\t\tassert.strictEqual(Placeholder.compareByIndex(_10, _2), 1);\n\t});\n\n\ttest('Maximum call stack size exceeded, #28983', function () {\n\t\tnew SnippetParser().parse('${1:${foo:${1}}}');\n\t});\n\n\ttest('Snippet can freeze the editor, #30407', function () {\n\n\t\tconst seen = new Set<Marker>();\n\n\t\tseen.clear();\n\t\tnew SnippetParser().parse('class ${1:${TM_FILENAME/(?:\\\\A|_)([A-Za-z0-9]+)(?:\\\\.rb)?/(?2::\\\\u$1)/g}} < ${2:Application}Controller\\n  $3\\nend').walk(marker => {\n\t\t\tassert.ok(!seen.has(marker));\n\t\t\tseen.add(marker);\n\t\t\treturn true;\n\t\t});\n\n\t\tseen.clear();\n\t\tnew SnippetParser().parse('${1:${FOO:abc$1def}}').walk(marker => {\n\t\t\tassert.ok(!seen.has(marker));\n\t\t\tseen.add(marker);\n\t\t\treturn true;\n\t\t});\n\t});\n\n\ttest('Snippets: make parser ignore `${0|choice|}`, #31599', function () {\n\t\tassertTextAndMarker('${0|foo,bar|}', '${0|foo,bar|}', Text);\n\t\tassertTextAndMarker('${1|foo,bar|}', 'foo', Placeholder);\n\t});\n\n\n\ttest('Transform -> FormatString#resolve', function () {\n\n\t\t// shorthand functions\n\t\tassert.strictEqual(new FormatString(1, 'upcase').resolve('foo'), 'FOO');\n\t\tassert.strictEqual(new FormatString(1, 'downcase').resolve('FOO'), 'foo');\n\t\tassert.strictEqual(new FormatString(1, 'capitalize').resolve('bar'), 'Bar');\n\t\tassert.strictEqual(new FormatString(1, 'capitalize').resolve('bar no repeat'), 'Bar no repeat');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('bar-foo'), 'BarFoo');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('bar-42-foo'), 'Bar42Foo');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('snake_AndPascalCase'), 'SnakeAndPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('kebab-AndPascalCase'), 'KebabAndPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'pascalcase').resolve('_justPascalCase'), 'JustPascalCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('bar-foo'), 'barFoo');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('bar-42-foo'), 'bar42Foo');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('snake_AndCamelCase'), 'snakeAndCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('kebab-AndCamelCase'), 'kebabAndCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'camelcase').resolve('_JustCamelCase'), 'justCamelCase');\n\t\tassert.strictEqual(new FormatString(1, 'notKnown').resolve('input'), 'input');\n\n\t\t// if\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve(undefined), '');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve(''), '');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'foo', undefined).resolve('bar'), 'foo');\n\n\t\t// else\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve(undefined), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve(''), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, undefined, 'foo').resolve('bar'), 'bar');\n\n\t\t// if-else\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve(undefined), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve(''), 'foo');\n\t\tassert.strictEqual(new FormatString(1, undefined, 'bar', 'foo').resolve('baz'), 'bar');\n\t});\n\n\ttest('Snippet variable transformation doesn\\'t work if regex is complicated and snippet body contains \\'$$\\' #55627', function () {\n\t\tconst snippet = new SnippetParser().parse('const fileName = \"${TM_FILENAME/(.*)\\\\..+$/$1/}\"');\n\t\tassert.strictEqual(snippet.toTextmateString(), 'const fileName = \"${TM_FILENAME/(.*)\\\\..+$/${1}/}\"');\n\t});\n\n\ttest('[BUG] HTML attribute suggestions: Snippet session does not have end-position set, #33147', function () {\n\n\t\tconst { placeholders } = new SnippetParser().parse('src=\"$1\"', true);\n\t\tconst [first, second] = placeholders;\n\n\t\tassert.strictEqual(placeholders.length, 2);\n\t\tassert.strictEqual(first.index, 1);\n\t\tassert.strictEqual(second.index, 0);\n\n\t});\n\n\ttest('Snippet optional transforms are not applied correctly when reusing the same variable, #37702', function () {\n\n\t\tconst transform = new Transform();\n\t\ttransform.appendChild(new FormatString(1, 'upcase'));\n\t\ttransform.appendChild(new FormatString(2, 'upcase'));\n\t\ttransform.regexp = /^(.)|-(.)/g;\n\n\t\tassert.strictEqual(transform.resolve('my-file-name'), 'MyFileName');\n\n\t\tconst clone = transform.clone();\n\t\tassert.strictEqual(clone.resolve('my-file-name'), 'MyFileName');\n\t});\n\n\ttest('problem with snippets regex #40570', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${TM_DIRECTORY/.*src[\\\\/](.*)/$1/}');\n\t\tassertMarker(snippet, Variable);\n\t});\n\n\ttest('Variable transformation doesn\\'t work if undefined variables are used in the same snippet #51769', function () {\n\t\tconst transform = new Transform();\n\t\ttransform.appendChild(new Text('bar'));\n\t\ttransform.regexp = new RegExp('foo', 'gi');\n\t\tassert.strictEqual(transform.toTextmateString(), '/foo/bar/ig');\n\t});\n\n\ttest('Snippet parser freeze #53144', function () {\n\t\tconst snippet = new SnippetParser().parse('${1/(void$)|(.+)/${1:?-\\treturn nil;}/}');\n\t\tassertMarker(snippet, Placeholder);\n\t});\n\n\ttest('snippets variable not resolved in JSON proposal #52931', function () {\n\t\tassertTextAndMarker('FOO${1:/bin/bash}', 'FOO/bin/bash', Text, Placeholder);\n\t});\n\n\ttest('Mirroring sequence of nested placeholders not selected properly on backjumping #58736', function () {\n\t\tconst snippet = new SnippetParser().parse('${3:nest1 ${1:nest2 ${2:nest3}}} $3');\n\t\tassert.strictEqual(snippet.children.length, 3);\n\t\tassert.ok(snippet.children[0] instanceof Placeholder);\n\t\tassert.ok(snippet.children[1] instanceof Text);\n\t\tassert.ok(snippet.children[2] instanceof Placeholder);\n\n\t\tfunction assertParent(marker: Marker) {\n\t\t\tmarker.children.forEach(assertParent);\n\t\t\tif (!(marker instanceof Placeholder)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet found = false;\n\t\t\tlet m: Marker = marker;\n\t\t\twhile (m && !found) {\n\t\t\t\tif (m.parent === snippet) {\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t\tm = m.parent;\n\t\t\t}\n\t\t\tassert.ok(found);\n\t\t}\n\t\tconst [, , clone] = snippet.children;\n\t\tassertParent(clone);\n\t});\n\n\ttest('Backspace can\\'t be escaped in snippet variable transforms #65412', function () {\n\n\t\tconst snippet = new SnippetParser().parse('namespace ${TM_DIRECTORY/[\\\\/]/\\\\\\\\/g};');\n\t\tassertMarker(snippet, Text, Variable, Text);\n\t});\n\n\ttest('Snippet cannot escape closing bracket inside conditional insertion variable replacement #78883', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${TM_DIRECTORY/(.+)/${1:+import { hello \\\\} from world}/}');\n\t\tconst variable = <Variable>snippet.children[0];\n\t\tassert.strictEqual(snippet.children.length, 1);\n\t\tassert.ok(variable instanceof Variable);\n\t\tassert.ok(variable.transform);\n\t\tassert.strictEqual(variable.transform.children.length, 1);\n\t\tassert.ok(variable.transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).ifValue, 'import { hello } from world');\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).elseValue, undefined);\n\t});\n\n\ttest('Snippet escape backslashes inside conditional insertion variable replacement #80394', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${CURRENT_YEAR/(.+)/${1:+\\\\\\\\}/}');\n\t\tconst variable = <Variable>snippet.children[0];\n\t\tassert.strictEqual(snippet.children.length, 1);\n\t\tassert.ok(variable instanceof Variable);\n\t\tassert.ok(variable.transform);\n\t\tassert.strictEqual(variable.transform.children.length, 1);\n\t\tassert.ok(variable.transform.children[0] instanceof FormatString);\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).ifValue, '\\\\');\n\t\tassert.strictEqual((<FormatString>variable.transform.children[0]).elseValue, undefined);\n\t});\n\n\ttest('Snippet placeholder empty right after expansion #152553', function () {\n\n\t\tconst snippet = new SnippetParser().parse('${1:prog}: ${2:$1.cc} - $2');\n\t\tconst actual = snippet.toString();\n\t\tassert.strictEqual(actual, 'prog: prog.cc - prog.cc');\n\n\t\tconst snippet2 = new SnippetParser().parse('${1:prog}: ${3:${2:$1.cc}.33} - $2 $3');\n\t\tconst actual2 = snippet2.toString();\n\t\tassert.strictEqual(actual2, 'prog: prog.cc.33 - prog.cc prog.cc.33');\n\n\t\t// cyclic references of placeholders\n\t\tconst snippet3 = new SnippetParser().parse('${1:$2.one} <> ${2:$1.two}');\n\t\tconst actual3 = snippet3.toString();\n\t\tassert.strictEqual(actual3, '.two.one.two.one <> .one.two.one.two');\n\t});\n\n\ttest('Snippet choices are incorrectly escaped/applied #180132', function () {\n\t\tassertTextAndMarker('${1|aaa$aaa|}bbb\\\\$bbb', 'aaa$aaabbb$bbb', Placeholder, Text);\n\t});\n});\n"]}