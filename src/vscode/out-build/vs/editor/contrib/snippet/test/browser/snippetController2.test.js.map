{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/contrib/snippet/test/browser/snippetController2.test.ts","vs/editor/contrib/snippet/test/browser/snippetController2.test.ts"],"names":[],"mappings":"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","file":"snippetController2.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { ICodeEditor } from '../../../../browser/editorBrowser.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Handler } from '../../../../common/editorCommon.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { SnippetController2 } from '../../browser/snippetController2.js';\nimport { createTestCodeEditor, ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationService } from '../../../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { EndOfLineSequence } from '../../../../common/model.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\nsuite('SnippetController2', function () {\n\n\t/** @deprecated */\n\tfunction assertSelections(editor: ICodeEditor, ...s: Selection[]) {\n\t\tfor (const selection of editor.getSelections()!) {\n\t\t\tconst actual = s.shift()!;\n\t\t\tassert.ok(selection.equalsSelection(actual), `actual=${selection.toString()} <> expected=${actual.toString()}`);\n\t\t}\n\t\tassert.strictEqual(s.length, 0);\n\t}\n\n\tfunction assertContextKeys(service: MockContextKeyService, inSnippet: boolean, hasPrev: boolean, hasNext: boolean): void {\n\t\tconst state = getContextState(service);\n\t\tassert.strictEqual(state.inSnippet, inSnippet, `inSnippetMode`);\n\t\tassert.strictEqual(state.hasPrev, hasPrev, `HasPrevTabstop`);\n\t\tassert.strictEqual(state.hasNext, hasNext, `HasNextTabstop`);\n\t}\n\n\tfunction getContextState(service: MockContextKeyService = contextKeys) {\n\t\treturn {\n\t\t\tinSnippet: SnippetController2.InSnippetMode.getValue(service),\n\t\t\thasPrev: SnippetController2.HasPrevTabstop.getValue(service),\n\t\t\thasNext: SnippetController2.HasNextTabstop.getValue(service),\n\t\t};\n\t}\n\n\tlet ctrl: SnippetController2;\n\tlet editor: ITestCodeEditor;\n\tlet model: TextModel;\n\tlet contextKeys: MockContextKeyService;\n\tlet instaService: IInstantiationService;\n\n\tsetup(function () {\n\t\tcontextKeys = new MockContextKeyService();\n\t\tmodel = createTextModel('if\\n    $state\\nfi');\n\t\tconst serviceCollection = new ServiceCollection(\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() {\n\t\t\t\toverride getWorkspace() {\n\t\t\t\t\treturn { id: 'foo', folders: [] };\n\t\t\t\t}\n\t\t\t}],\n\t\t\t[ILogService, new NullLogService()],\n\t\t\t[IContextKeyService, contextKeys],\n\t\t);\n\t\tinstaService = new InstantiationService(serviceCollection);\n\t\teditor = createTestCodeEditor(model, { serviceCollection });\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5)]);\n\t\tassert.strictEqual(model.getEOL(), '\\n');\n\t});\n\n\tteardown(function () {\n\t\tmodel.dispose();\n\t\tctrl.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('creation', () => {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> abort', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\tctrl.cancel();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t});\n\n\ttest('insert, insert -> tab, tab, done', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('${1:one}${2:two}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\teditor.trigger('test', 'type', { text: '\\t' });\n\t\tassert.strictEqual(SnippetController2.InSnippetMode.getValue(contextKeys), false);\n\t\tassert.strictEqual(SnippetController2.HasNextTabstop.getValue(contextKeys), false);\n\t\tassert.strictEqual(SnippetController2.HasPrevTabstop.getValue(contextKeys), false);\n\t});\n\n\ttest('insert, insert -> cursor moves out (left/right)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(1, 12, 1, 12), new Selection(2, 16, 2, 16)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> cursor moves out (up/down)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(2, 4, 2, 7), new Selection(3, 8, 3, 11)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> cursors collapse', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassert.strictEqual(SnippetController2.InSnippetMode.getValue(contextKeys), true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(1, 4, 1, 7)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert plain text -> no snippet mode', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foobar');\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t});\n\n\ttest('insert, delete snippet text', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\teditor.trigger('test', 'cut', {});\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\teditor.trigger('test', 'type', { text: 'abc' });\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\teditor.trigger('test', 'tab', {});\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\t// editor.trigger('test', 'type', { text: 'abc' });\n\t\t// assertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested trivial snippet', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foo}bar$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\n\t\tctrl.insert('FOO$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested snippet', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\tctrl.insert('far$1boo$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested plain text', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\tctrl.insert('farboo');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Nested snippets without final placeholder jumps to next outer placeholder, #27898', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('for(const ${1:element} of ${2:array}) {$0}');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 11, 1, 18), new Selection(2, 15, 2, 22));\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t\tassertSelections(editor, new Selection(1, 22, 1, 27), new Selection(2, 26, 2, 31));\n\n\t\tctrl.insert('document');\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t\tassertSelections(editor, new Selection(1, 30, 1, 30), new Selection(2, 34, 2, 34));\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Inconsistent tab stop behaviour with recursive snippets and tab / shift tab, #27543', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('1_calize(${1:nl}, \\'${2:value}\\')$0');\n\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 12), new Selection(2, 14, 2, 16));\n\n\t\tctrl.insert('2_calize(${1:nl}, \\'${2:value}\\')$0');\n\n\t\tassertSelections(editor, new Selection(1, 19, 1, 21), new Selection(2, 23, 2, 25));\n\n\t\tctrl.next(); // inner `value`\n\t\tassertSelections(editor, new Selection(1, 24, 1, 29), new Selection(2, 28, 2, 33));\n\n\t\tctrl.next(); // inner `$0`\n\t\tassertSelections(editor, new Selection(1, 31, 1, 31), new Selection(2, 35, 2, 35));\n\n\t\tctrl.next(); // outer `value`\n\t\tassertSelections(editor, new Selection(1, 34, 1, 39), new Selection(2, 38, 2, 43));\n\n\t\tctrl.prev(); // inner `$0`\n\t\tassertSelections(editor, new Selection(1, 31, 1, 31), new Selection(2, 35, 2, 35));\n\t});\n\n\ttest('Snippet tabstop selecting content of previously entered variable only works when separated by space, #23728', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('import ${2:${1:module}} from \\'${1:module}\\'$0');\n\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 8, 1, 14), new Selection(1, 21, 1, 27));\n\n\t\tctrl.insert('foo');\n\t\tassertSelections(editor, new Selection(1, 11, 1, 11), new Selection(1, 21, 1, 21));\n\n\t\tctrl.next(); // ${2:...}\n\t\tassertSelections(editor, new Selection(1, 8, 1, 11));\n\t});\n\n\ttest('HTML Snippets Combine, #32211', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: false, tabSize: 4, trimAutoWhitespace: false });\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert(`\n\t\t\t<!DOCTYPE html>\n\t\t\t<html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"UTF-8\">\n\t\t\t\t<meta name=\"viewport\" content=\"width=\\${2:device-width}, initial-scale=\\${3:1.0}\">\n\t\t\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"\\${5:ie=edge}\">\n\t\t\t\t<title>\\${7:Document}</title>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t\\${8}\n\t\t\t</body>\n\t\t\t</html>\n\t\t`);\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(11, 5, 11, 5));\n\n\t\tctrl.insert('<input type=\"${2:text}\">');\n\t\tassertSelections(editor, new Selection(11, 18, 11, 22));\n\t});\n\n\ttest('Problems with nested snippet insertion #39594', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('$1 = ConvertTo-Json $1');\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(1, 19, 1, 19));\n\n\t\teditor.setSelection(new Selection(1, 19, 1, 19));\n\n\t\t// snippet mode should stop because $1 has two occurrences\n\t\t// and we only have one selection left\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Problems with nested snippet insertion #39594 (part2)', function () {\n\t\t// ensure selection-change-to-cancel logic isn't too aggressive\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('a-\\naaa-');\n\t\teditor.setSelections([new Selection(2, 5, 2, 5), new Selection(1, 3, 1, 3)]);\n\n\t\tctrl.insert('log($1);$0');\n\t\tassertSelections(editor, new Selection(2, 9, 2, 9), new Selection(1, 7, 1, 7));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t});\n\n\ttest('“Nested” snippets terminating abruptly in VSCode 1.19.2. #42012', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('var ${2:${1:name}} = ${1:name} + 1;${0}');\n\n\t\tassertSelections(editor, new Selection(1, 5, 1, 9), new Selection(1, 12, 1, 16));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t});\n\n\ttest('Placeholders order #58267', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('\\\\pth{$1}$0');\n\n\t\tassertSelections(editor, new Selection(1, 6, 1, 6));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.insert('\\\\itv{${1:left}}{${2:right}}{${3:left_value}}{${4:right_value}}$0');\n\t\tassertSelections(editor, new Selection(1, 11, 1, 15));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 17, 1, 22));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 24, 1, 34));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 36, 1, 47));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 48, 1, 48));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 49, 1, 49));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Must tab through deleted tab stops in snippets #31619', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('foo${1:a${2:bar}baz}end$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 11));\n\n\t\teditor.trigger('test', Handler.Cut, null);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Cancelling snippet mode should discard added cursors #68512 (soft cancel)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('.REGION ${2:FUNCTION_NAME}\\nCREATE.FUNCTION ${1:VOID} ${2:FUNCTION_NAME}(${3:})\\n\\t${4:}\\nEND\\n.ENDREGION$0');\n\t\tassertSelections(editor, new Selection(2, 17, 2, 21));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 22), new Selection(2, 22, 2, 35));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(1, 22, 1, 22), new Selection(2, 35, 2, 35)]);\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(2, 1, 2, 1), new Selection(2, 36, 2, 36)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1), new Selection(2, 36, 2, 36));\n\t});\n\n\ttest('Cancelling snippet mode should discard added cursors #68512 (hard cancel)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('.REGION ${2:FUNCTION_NAME}\\nCREATE.FUNCTION ${1:VOID} ${2:FUNCTION_NAME}(${3:})\\n\\t${4:}\\nEND\\n.ENDREGION$0');\n\t\tassertSelections(editor, new Selection(2, 17, 2, 21));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 22), new Selection(2, 22, 2, 35));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(1, 22, 1, 22), new Selection(2, 35, 2, 35)]);\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.cancel(true);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 22, 1, 22));\n\t});\n\n\ttest('User defined snippet tab stops ignored #72862', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('export default $1');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t});\n\n\ttest('Optional tabstop in snippets #72358', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('${1:prop: {$2\\\\},}\\nmore$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 10));\n\t\teditor.trigger('test', Handler.Cut, {});\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(2, 5, 2, 5));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('issue #90135: confusing trim whitespace edits', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\nfoo');\n\t\tassertSelections(editor, new Selection(2, 8, 2, 8));\n\t});\n\n\ttest('issue #145727: insertSnippet can put snippet selections in wrong positions (1 of 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\naProperty: aClass<${2:boolean}> = new aClass<${2:boolean}>();\\n', { adjustWhitespace: false });\n\t\tassertSelections(editor, new Selection(2, 19, 2, 26), new Selection(2, 41, 2, 48));\n\t});\n\n\ttest('issue #145727: insertSnippet can put snippet selections in wrong positions (2 of 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\naProperty: aClass<${2:boolean}> = new aClass<${2:boolean}>();\\n');\n\t\t// This will insert \\n    aProperty....\n\t\tassertSelections(editor, new Selection(2, 23, 2, 30), new Selection(2, 45, 2, 52));\n\t});\n\n\ttest('leading TAB by snippets won\\'t replace by spaces #101870', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('\\tHello World\\n\\tNew Line');\n\t\tassert.strictEqual(model.getValue(), '    Hello World\\n    New Line');\n\t});\n\n\ttest('leading TAB by snippets won\\'t replace by spaces #101870 (part 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('\\tHello World\\n\\tNew Line\\n${1:\\tmore}');\n\t\tassert.strictEqual(model.getValue(), '    Hello World\\n    New Line\\n    more');\n\t});\n\n\ttest.skip('Snippet transformation does not work after inserting variable using intellisense, #112362', function () {\n\n\t\t{\n\t\t\t// HAPPY - no nested snippet\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('');\n\t\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\t\tctrl.insert('$1\\n\\n${1/([A-Za-z0-9]+): ([A-Za-z]+).*/$1: \\'$2\\',/gm}');\n\n\t\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(3, 1, 3, 1));\n\t\t\teditor.trigger('test', 'type', { text: 'foo: number;' });\n\t\t\tctrl.next();\n\t\t\tassert.strictEqual(model.getValue(), `foo: number;\\n\\nfoo: 'number',`);\n\t\t}\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('$1\\n\\n${1/([A-Za-z0-9]+): ([A-Za-z]+).*/$1: \\'$2\\',/gm}');\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(3, 1, 3, 1));\n\t\teditor.trigger('test', 'type', { text: 'foo: ' });\n\t\tctrl.insert('number;');\n\t\tctrl.next();\n\t\tassert.strictEqual(model.getValue(), `foo: number;\\n\\nfoo: 'number',`);\n\t\t// editor.trigger('test', 'type', { text: ';' });\n\t});\n\n\tsuite('createEditsAndSnippetsFromEdits', function () {\n\n\t\ttest('apply, tab, done', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\t\tmodel.setValue('foo(\"bar\")');\n\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 5, 1, 10), template: '$1' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: 'const ${1:new_const} = \"bar\";\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'const new_const = \"bar\";\\nfoo(new_const)');\n\t\t\tassertContextKeys(contextKeys, true, false, true);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 16), new Selection(2, 5, 2, 14)]);\n\n\t\t\tctrl.next();\n\t\t\tassertContextKeys(contextKeys, false, false, false);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(2, 14, 2, 14)]);\n\t\t});\n\n\t\ttest('apply, tab, done with special final tabstop', function () {\n\n\t\t\tmodel.setValue('foo(\"bar\")');\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 5, 1, 10), template: '$1' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: 'const ${1:new_const}$0 = \"bar\";\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'const new_const = \"bar\";\\nfoo(new_const)');\n\t\t\tassertContextKeys(contextKeys, true, false, true);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 16), new Selection(2, 5, 2, 14)]);\n\n\t\t\tctrl.next();\n\t\t\tassertContextKeys(contextKeys, false, false, false);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 16, 1, 16)]);\n\t\t});\n\n\t\ttest('apply, tab, tab, done', function () {\n\n\t\t\tmodel.setValue('foo\\nbar');\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 4, 1, 4), template: '${3}' },\n\t\t\t\t{ range: new Range(2, 4, 2, 4), template: '$3' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: '### ${2:Header}\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), '### Header\\nfoo\\nbar');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 5, 1, 11)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: true, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(2, 4, 2, 4), new Selection(3, 4, 3, 4)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(3, 4, 3, 4)]);\n\t\t});\n\n\t\ttest('nested into apply works', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('onetwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.apply([{\n\t\t\t\trange: new Range(1, 7, 1, 7),\n\t\t\t\ttemplate: '$0${1:three}'\n\t\t\t}]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'onetwothree');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 12)]);\n\n\t\t\tctrl.insert('foo$1bar$1');\n\t\t\tassert.strictEqual(model.getValue(), 'onetwofoobar');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 10, 1, 10), new Selection(1, 13, 1, 13)]);\n\t\t\tassert.deepStrictEqual(getContextState(), ({ inSnippet: true, hasPrev: false, hasNext: true }));\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), ({ inSnippet: true, hasPrev: true, hasNext: true }));\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 13, 1, 13)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 7)]);\n\n\t\t});\n\n\t\ttest('nested into insert abort \"outer\" snippet', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('one\\ntwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.insert('foo${1:bar}bazz${1:bang}');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 7), new Selection(1, 11, 1, 14), new Selection(2, 4, 2, 7), new Selection(2, 11, 2, 14)]);\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\n\t\t\tctrl.apply([{\n\t\t\t\trange: new Range(1, 4, 1, 7),\n\t\t\t\ttemplate: '$0A'\n\t\t\t}]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'fooAbazzbarone\\nfoobarbazzbartwo');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 4)]);\n\t\t});\n\n\t\ttest('nested into \"insert\" abort \"outer\" snippet (2)', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('one\\ntwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.insert('foo${1:bar}bazz${1:bang}');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 7), new Selection(1, 11, 1, 14), new Selection(2, 4, 2, 7), new Selection(2, 11, 2, 14)]);\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\n\t\t\tconst edits = [{\n\t\t\t\trange: new Range(1, 4, 1, 7),\n\t\t\t\ttemplate: 'A'\n\t\t\t}, {\n\t\t\t\trange: new Range(1, 11, 1, 14),\n\t\t\t\ttemplate: 'B'\n\t\t\t}, {\n\t\t\t\trange: new Range(2, 4, 2, 7),\n\t\t\t\ttemplate: 'C'\n\t\t\t}, {\n\t\t\t\trange: new Range(2, 11, 2, 14),\n\t\t\t\ttemplate: 'D'\n\t\t\t}];\n\t\t\tctrl.apply(edits);\n\n\t\t\tassert.strictEqual(model.getValue(), 'fooAbazzBone\\nfooCbazzDtwo');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 5, 1, 5), new Selection(1, 10, 1, 10), new Selection(2, 5, 2, 5), new Selection(2, 10, 2, 10)]);\n\t\t});\n\t});\n\n\ttest('Bug: cursor position $0 with user snippets #163808', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\n\t\tctrl.insert('<Element1 Attr1=\"foo\" $1>\\n  <Element2 Attr1=\"$2\"/>\\n$0\"\\n</Element1>');\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 23, 1, 23)]);\n\n\t\tctrl.insert('Qualifier=\"$0\"');\n\t\tassert.strictEqual(model.getValue(), '<Element1 Attr1=\"foo\" Qualifier=\"\">\\n  <Element2 Attr1=\"\"/>\\n\"\\n</Element1>');\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 34, 1, 34)]);\n\n\t});\n\n\ttest('EOL-Sequence (CRLF) shifts tab stop in isFileTemplate snippets #167386', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.setEOL(EndOfLineSequence.CRLF);\n\n\t\tctrl.apply([{\n\t\t\trange: model.getFullModelRange(),\n\t\t\ttemplate: 'line 54321${1:FOO}\\nline 54321${1:FOO}\\n(no tab stop)\\nline 54321${1:FOO}\\nline 54321'\n\t\t}]);\n\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 11, 1, 14), new Selection(2, 11, 2, 14), new Selection(4, 11, 4, 14)]);\n\n\t});\n\n\ttest('\"Surround With\" code action snippets use incorrect indentation levels and styles #169319', function () {\n\t\tmodel.setValue('function foo(f, x, condition) {\\n    f();\\n    return x;\\n}');\n\t\tconst sel = new Range(2, 5, 3, 14);\n\t\teditor.setSelection(sel);\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.apply([{\n\t\t\trange: sel,\n\t\t\ttemplate: 'if (${1:condition}) {\\n\\t$TM_SELECTED_TEXT$0\\n}'\n\t\t}]);\n\n\t\tassert.strictEqual(model.getValue(), `function foo(f, x, condition) {\\n    if (condition) {\\n        f();\\n        return x;\\n    }\\n}`);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { ICodeEditor } from '../../../../browser/editorBrowser.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Handler } from '../../../../common/editorCommon.js';\nimport { TextModel } from '../../../../common/model/textModel.js';\nimport { SnippetController2 } from '../../browser/snippetController2.js';\nimport { createTestCodeEditor, ITestCodeEditor } from '../../../../test/browser/testCodeEditor.js';\nimport { createTextModel } from '../../../../test/common/testTextModel.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationService } from '../../../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { EndOfLineSequence } from '../../../../common/model.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\nsuite('SnippetController2', function () {\n\n\t/** @deprecated */\n\tfunction assertSelections(editor: ICodeEditor, ...s: Selection[]) {\n\t\tfor (const selection of editor.getSelections()!) {\n\t\t\tconst actual = s.shift()!;\n\t\t\tassert.ok(selection.equalsSelection(actual), `actual=${selection.toString()} <> expected=${actual.toString()}`);\n\t\t}\n\t\tassert.strictEqual(s.length, 0);\n\t}\n\n\tfunction assertContextKeys(service: MockContextKeyService, inSnippet: boolean, hasPrev: boolean, hasNext: boolean): void {\n\t\tconst state = getContextState(service);\n\t\tassert.strictEqual(state.inSnippet, inSnippet, `inSnippetMode`);\n\t\tassert.strictEqual(state.hasPrev, hasPrev, `HasPrevTabstop`);\n\t\tassert.strictEqual(state.hasNext, hasNext, `HasNextTabstop`);\n\t}\n\n\tfunction getContextState(service: MockContextKeyService = contextKeys) {\n\t\treturn {\n\t\t\tinSnippet: SnippetController2.InSnippetMode.getValue(service),\n\t\t\thasPrev: SnippetController2.HasPrevTabstop.getValue(service),\n\t\t\thasNext: SnippetController2.HasNextTabstop.getValue(service),\n\t\t};\n\t}\n\n\tlet ctrl: SnippetController2;\n\tlet editor: ITestCodeEditor;\n\tlet model: TextModel;\n\tlet contextKeys: MockContextKeyService;\n\tlet instaService: IInstantiationService;\n\n\tsetup(function () {\n\t\tcontextKeys = new MockContextKeyService();\n\t\tmodel = createTextModel('if\\n    $state\\nfi');\n\t\tconst serviceCollection = new ServiceCollection(\n\t\t\t[ILabelService, new class extends mock<ILabelService>() { }],\n\t\t\t[IWorkspaceContextService, new class extends mock<IWorkspaceContextService>() {\n\t\t\t\toverride getWorkspace() {\n\t\t\t\t\treturn { id: 'foo', folders: [] };\n\t\t\t\t}\n\t\t\t}],\n\t\t\t[ILogService, new NullLogService()],\n\t\t\t[IContextKeyService, contextKeys],\n\t\t);\n\t\tinstaService = new InstantiationService(serviceCollection);\n\t\teditor = createTestCodeEditor(model, { serviceCollection });\n\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5)]);\n\t\tassert.strictEqual(model.getEOL(), '\\n');\n\t});\n\n\tteardown(function () {\n\t\tmodel.dispose();\n\t\tctrl.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('creation', () => {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> abort', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\tctrl.cancel();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\t});\n\n\ttest('insert, insert -> tab, tab, done', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('${1:one}${2:two}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\teditor.trigger('test', 'type', { text: '\\t' });\n\t\tassert.strictEqual(SnippetController2.InSnippetMode.getValue(contextKeys), false);\n\t\tassert.strictEqual(SnippetController2.HasNextTabstop.getValue(contextKeys), false);\n\t\tassert.strictEqual(SnippetController2.HasPrevTabstop.getValue(contextKeys), false);\n\t});\n\n\ttest('insert, insert -> cursor moves out (left/right)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(1, 12, 1, 12), new Selection(2, 16, 2, 16)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> cursor moves out (up/down)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(2, 4, 2, 7), new Selection(3, 8, 3, 11)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert -> cursors collapse', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foo${1:bar}foo$0');\n\t\tassert.strictEqual(SnippetController2.InSnippetMode.getValue(contextKeys), true);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 7), new Selection(2, 8, 2, 11));\n\n\t\t// bad selection change\n\t\teditor.setSelections([new Selection(1, 4, 1, 7)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, insert plain text -> no snippet mode', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('foobar');\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t});\n\n\ttest('insert, delete snippet text', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\teditor.trigger('test', 'cut', {});\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(2, 5, 2, 5));\n\n\t\teditor.trigger('test', 'type', { text: 'abc' });\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\teditor.trigger('test', 'tab', {});\n\t\tassertContextKeys(contextKeys, false, false, false);\n\n\t\t// editor.trigger('test', 'type', { text: 'abc' });\n\t\t// assertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested trivial snippet', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foo}bar$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 4), new Selection(2, 5, 2, 8));\n\n\t\tctrl.insert('FOO$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested snippet', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\tctrl.insert('far$1boo$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4), new Selection(2, 8, 2, 8));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('insert, nested plain text', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('${1:foobar}$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 1, 1, 7), new Selection(2, 5, 2, 11));\n\n\t\tctrl.insert('farboo');\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7), new Selection(2, 11, 2, 11));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Nested snippets without final placeholder jumps to next outer placeholder, #27898', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tctrl.insert('for(const ${1:element} of ${2:array}) {$0}');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 11, 1, 18), new Selection(2, 15, 2, 22));\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t\tassertSelections(editor, new Selection(1, 22, 1, 27), new Selection(2, 26, 2, 31));\n\n\t\tctrl.insert('document');\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t\tassertSelections(editor, new Selection(1, 30, 1, 30), new Selection(2, 34, 2, 34));\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Inconsistent tab stop behaviour with recursive snippets and tab / shift tab, #27543', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.insert('1_calize(${1:nl}, \\'${2:value}\\')$0');\n\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 10, 1, 12), new Selection(2, 14, 2, 16));\n\n\t\tctrl.insert('2_calize(${1:nl}, \\'${2:value}\\')$0');\n\n\t\tassertSelections(editor, new Selection(1, 19, 1, 21), new Selection(2, 23, 2, 25));\n\n\t\tctrl.next(); // inner `value`\n\t\tassertSelections(editor, new Selection(1, 24, 1, 29), new Selection(2, 28, 2, 33));\n\n\t\tctrl.next(); // inner `$0`\n\t\tassertSelections(editor, new Selection(1, 31, 1, 31), new Selection(2, 35, 2, 35));\n\n\t\tctrl.next(); // outer `value`\n\t\tassertSelections(editor, new Selection(1, 34, 1, 39), new Selection(2, 38, 2, 43));\n\n\t\tctrl.prev(); // inner `$0`\n\t\tassertSelections(editor, new Selection(1, 31, 1, 31), new Selection(2, 35, 2, 35));\n\t});\n\n\ttest('Snippet tabstop selecting content of previously entered variable only works when separated by space, #23728', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('import ${2:${1:module}} from \\'${1:module}\\'$0');\n\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t\tassertSelections(editor, new Selection(1, 8, 1, 14), new Selection(1, 21, 1, 27));\n\n\t\tctrl.insert('foo');\n\t\tassertSelections(editor, new Selection(1, 11, 1, 11), new Selection(1, 21, 1, 21));\n\n\t\tctrl.next(); // ${2:...}\n\t\tassertSelections(editor, new Selection(1, 8, 1, 11));\n\t});\n\n\ttest('HTML Snippets Combine, #32211', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: false, tabSize: 4, trimAutoWhitespace: false });\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert(`\n\t\t\t<!DOCTYPE html>\n\t\t\t<html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"UTF-8\">\n\t\t\t\t<meta name=\"viewport\" content=\"width=\\${2:device-width}, initial-scale=\\${3:1.0}\">\n\t\t\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"\\${5:ie=edge}\">\n\t\t\t\t<title>\\${7:Document}</title>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t\\${8}\n\t\t\t</body>\n\t\t\t</html>\n\t\t`);\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(11, 5, 11, 5));\n\n\t\tctrl.insert('<input type=\"${2:text}\">');\n\t\tassertSelections(editor, new Selection(11, 18, 11, 22));\n\t});\n\n\ttest('Problems with nested snippet insertion #39594', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('$1 = ConvertTo-Json $1');\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(1, 19, 1, 19));\n\n\t\teditor.setSelection(new Selection(1, 19, 1, 19));\n\n\t\t// snippet mode should stop because $1 has two occurrences\n\t\t// and we only have one selection left\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Problems with nested snippet insertion #39594 (part2)', function () {\n\t\t// ensure selection-change-to-cancel logic isn't too aggressive\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\tmodel.setValue('a-\\naaa-');\n\t\teditor.setSelections([new Selection(2, 5, 2, 5), new Selection(1, 3, 1, 3)]);\n\n\t\tctrl.insert('log($1);$0');\n\t\tassertSelections(editor, new Selection(2, 9, 2, 9), new Selection(1, 7, 1, 7));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t});\n\n\ttest('“Nested” snippets terminating abruptly in VSCode 1.19.2. #42012', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('var ${2:${1:name}} = ${1:name} + 1;${0}');\n\n\t\tassertSelections(editor, new Selection(1, 5, 1, 9), new Selection(1, 12, 1, 16));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.next();\n\t\tassertContextKeys(contextKeys, true, true, true);\n\t});\n\n\ttest('Placeholders order #58267', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('\\\\pth{$1}$0');\n\n\t\tassertSelections(editor, new Selection(1, 6, 1, 6));\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tctrl.insert('\\\\itv{${1:left}}{${2:right}}{${3:left_value}}{${4:right_value}}$0');\n\t\tassertSelections(editor, new Selection(1, 11, 1, 15));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 17, 1, 22));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 24, 1, 34));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 36, 1, 47));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 48, 1, 48));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 49, 1, 49));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Must tab through deleted tab stops in snippets #31619', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\t\tctrl.insert('foo${1:a${2:bar}baz}end$0');\n\t\tassertSelections(editor, new Selection(1, 4, 1, 11));\n\n\t\teditor.trigger('test', Handler.Cut, null);\n\t\tassertSelections(editor, new Selection(1, 4, 1, 4));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 7, 1, 7));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('Cancelling snippet mode should discard added cursors #68512 (soft cancel)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('.REGION ${2:FUNCTION_NAME}\\nCREATE.FUNCTION ${1:VOID} ${2:FUNCTION_NAME}(${3:})\\n\\t${4:}\\nEND\\n.ENDREGION$0');\n\t\tassertSelections(editor, new Selection(2, 17, 2, 21));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 22), new Selection(2, 22, 2, 35));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(1, 22, 1, 22), new Selection(2, 35, 2, 35)]);\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(2, 1, 2, 1), new Selection(2, 36, 2, 36)]);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(2, 1, 2, 1), new Selection(2, 36, 2, 36));\n\t});\n\n\ttest('Cancelling snippet mode should discard added cursors #68512 (hard cancel)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('.REGION ${2:FUNCTION_NAME}\\nCREATE.FUNCTION ${1:VOID} ${2:FUNCTION_NAME}(${3:})\\n\\t${4:}\\nEND\\n.ENDREGION$0');\n\t\tassertSelections(editor, new Selection(2, 17, 2, 21));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(1, 9, 1, 22), new Selection(2, 22, 2, 35));\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\teditor.setSelections([new Selection(1, 22, 1, 22), new Selection(2, 35, 2, 35)]);\n\t\tassertContextKeys(contextKeys, true, true, true);\n\n\t\tctrl.cancel(true);\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t\tassertSelections(editor, new Selection(1, 22, 1, 22));\n\t});\n\n\ttest('User defined snippet tab stops ignored #72862', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('export default $1');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\t});\n\n\ttest('Optional tabstop in snippets #72358', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.setSelection(new Selection(1, 1, 1, 1));\n\n\t\tctrl.insert('${1:prop: {$2\\\\},}\\nmore$0');\n\t\tassertContextKeys(contextKeys, true, false, true);\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 10));\n\t\teditor.trigger('test', Handler.Cut, {});\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1));\n\n\t\tctrl.next();\n\t\tassertSelections(editor, new Selection(2, 5, 2, 5));\n\t\tassertContextKeys(contextKeys, false, false, false);\n\t});\n\n\ttest('issue #90135: confusing trim whitespace edits', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\nfoo');\n\t\tassertSelections(editor, new Selection(2, 8, 2, 8));\n\t});\n\n\ttest('issue #145727: insertSnippet can put snippet selections in wrong positions (1 of 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\naProperty: aClass<${2:boolean}> = new aClass<${2:boolean}>();\\n', { adjustWhitespace: false });\n\t\tassertSelections(editor, new Selection(2, 19, 2, 26), new Selection(2, 41, 2, 48));\n\t});\n\n\ttest('issue #145727: insertSnippet can put snippet selections in wrong positions (2 of 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\teditor.runCommand(CoreEditingCommands.Tab, null);\n\n\t\tctrl.insert('\\naProperty: aClass<${2:boolean}> = new aClass<${2:boolean}>();\\n');\n\t\t// This will insert \\n    aProperty....\n\t\tassertSelections(editor, new Selection(2, 23, 2, 30), new Selection(2, 45, 2, 52));\n\t});\n\n\ttest('leading TAB by snippets won\\'t replace by spaces #101870', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('\\tHello World\\n\\tNew Line');\n\t\tassert.strictEqual(model.getValue(), '    Hello World\\n    New Line');\n\t});\n\n\ttest('leading TAB by snippets won\\'t replace by spaces #101870 (part 2)', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('\\tHello World\\n\\tNew Line\\n${1:\\tmore}');\n\t\tassert.strictEqual(model.getValue(), '    Hello World\\n    New Line\\n    more');\n\t});\n\n\ttest.skip('Snippet transformation does not work after inserting variable using intellisense, #112362', function () {\n\n\t\t{\n\t\t\t// HAPPY - no nested snippet\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('');\n\t\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\t\tctrl.insert('$1\\n\\n${1/([A-Za-z0-9]+): ([A-Za-z]+).*/$1: \\'$2\\',/gm}');\n\n\t\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(3, 1, 3, 1));\n\t\t\teditor.trigger('test', 'type', { text: 'foo: number;' });\n\t\t\tctrl.next();\n\t\t\tassert.strictEqual(model.getValue(), `foo: number;\\n\\nfoo: 'number',`);\n\t\t}\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.updateOptions({ insertSpaces: true, tabSize: 4 });\n\t\tctrl.insert('$1\\n\\n${1/([A-Za-z0-9]+): ([A-Za-z]+).*/$1: \\'$2\\',/gm}');\n\n\t\tassertSelections(editor, new Selection(1, 1, 1, 1), new Selection(3, 1, 3, 1));\n\t\teditor.trigger('test', 'type', { text: 'foo: ' });\n\t\tctrl.insert('number;');\n\t\tctrl.next();\n\t\tassert.strictEqual(model.getValue(), `foo: number;\\n\\nfoo: 'number',`);\n\t\t// editor.trigger('test', 'type', { text: ';' });\n\t});\n\n\tsuite('createEditsAndSnippetsFromEdits', function () {\n\n\t\ttest('apply, tab, done', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\n\t\t\tmodel.setValue('foo(\"bar\")');\n\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 5, 1, 10), template: '$1' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: 'const ${1:new_const} = \"bar\";\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'const new_const = \"bar\";\\nfoo(new_const)');\n\t\t\tassertContextKeys(contextKeys, true, false, true);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 16), new Selection(2, 5, 2, 14)]);\n\n\t\t\tctrl.next();\n\t\t\tassertContextKeys(contextKeys, false, false, false);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(2, 14, 2, 14)]);\n\t\t});\n\n\t\ttest('apply, tab, done with special final tabstop', function () {\n\n\t\t\tmodel.setValue('foo(\"bar\")');\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 5, 1, 10), template: '$1' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: 'const ${1:new_const}$0 = \"bar\";\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'const new_const = \"bar\";\\nfoo(new_const)');\n\t\t\tassertContextKeys(contextKeys, true, false, true);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 16), new Selection(2, 5, 2, 14)]);\n\n\t\t\tctrl.next();\n\t\t\tassertContextKeys(contextKeys, false, false, false);\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 16, 1, 16)]);\n\t\t});\n\n\t\ttest('apply, tab, tab, done', function () {\n\n\t\t\tmodel.setValue('foo\\nbar');\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tctrl.apply([\n\t\t\t\t{ range: new Range(1, 4, 1, 4), template: '${3}' },\n\t\t\t\t{ range: new Range(2, 4, 2, 4), template: '$3' },\n\t\t\t\t{ range: new Range(1, 1, 1, 1), template: '### ${2:Header}\\n' }\n\t\t\t]);\n\n\t\t\tassert.strictEqual(model.getValue(), '### Header\\nfoo\\nbar');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 5, 1, 11)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: true, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(2, 4, 2, 4), new Selection(3, 4, 3, 4)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(3, 4, 3, 4)]);\n\t\t});\n\n\t\ttest('nested into apply works', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('onetwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.apply([{\n\t\t\t\trange: new Range(1, 7, 1, 7),\n\t\t\t\ttemplate: '$0${1:three}'\n\t\t\t}]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'onetwothree');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 12)]);\n\n\t\t\tctrl.insert('foo$1bar$1');\n\t\t\tassert.strictEqual(model.getValue(), 'onetwofoobar');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 10, 1, 10), new Selection(1, 13, 1, 13)]);\n\t\t\tassert.deepStrictEqual(getContextState(), ({ inSnippet: true, hasPrev: false, hasNext: true }));\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), ({ inSnippet: true, hasPrev: true, hasNext: true }));\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 13, 1, 13)]);\n\n\t\t\tctrl.next();\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 7, 1, 7)]);\n\n\t\t});\n\n\t\ttest('nested into insert abort \"outer\" snippet', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('one\\ntwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.insert('foo${1:bar}bazz${1:bang}');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 7), new Selection(1, 11, 1, 14), new Selection(2, 4, 2, 7), new Selection(2, 11, 2, 14)]);\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\n\t\t\tctrl.apply([{\n\t\t\t\trange: new Range(1, 4, 1, 7),\n\t\t\t\ttemplate: '$0A'\n\t\t\t}]);\n\n\t\t\tassert.strictEqual(model.getValue(), 'fooAbazzbarone\\nfoobarbazzbartwo');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 4)]);\n\t\t});\n\n\t\ttest('nested into \"insert\" abort \"outer\" snippet (2)', function () {\n\n\t\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\t\tmodel.setValue('one\\ntwo');\n\n\t\t\teditor.setSelections([new Selection(1, 1, 1, 1), new Selection(2, 1, 2, 1)]);\n\n\t\t\tctrl.insert('foo${1:bar}bazz${1:bang}');\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 4, 1, 7), new Selection(1, 11, 1, 14), new Selection(2, 4, 2, 7), new Selection(2, 11, 2, 14)]);\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: true, hasPrev: false, hasNext: true });\n\n\t\t\tconst edits = [{\n\t\t\t\trange: new Range(1, 4, 1, 7),\n\t\t\t\ttemplate: 'A'\n\t\t\t}, {\n\t\t\t\trange: new Range(1, 11, 1, 14),\n\t\t\t\ttemplate: 'B'\n\t\t\t}, {\n\t\t\t\trange: new Range(2, 4, 2, 7),\n\t\t\t\ttemplate: 'C'\n\t\t\t}, {\n\t\t\t\trange: new Range(2, 11, 2, 14),\n\t\t\t\ttemplate: 'D'\n\t\t\t}];\n\t\t\tctrl.apply(edits);\n\n\t\t\tassert.strictEqual(model.getValue(), 'fooAbazzBone\\nfooCbazzDtwo');\n\t\t\tassert.deepStrictEqual(getContextState(), { inSnippet: false, hasPrev: false, hasNext: false });\n\t\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 5, 1, 5), new Selection(1, 10, 1, 10), new Selection(2, 5, 2, 5), new Selection(2, 10, 2, 10)]);\n\t\t});\n\t});\n\n\ttest('Bug: cursor position $0 with user snippets #163808', function () {\n\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\n\t\tctrl.insert('<Element1 Attr1=\"foo\" $1>\\n  <Element2 Attr1=\"$2\"/>\\n$0\"\\n</Element1>');\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 23, 1, 23)]);\n\n\t\tctrl.insert('Qualifier=\"$0\"');\n\t\tassert.strictEqual(model.getValue(), '<Element1 Attr1=\"foo\" Qualifier=\"\">\\n  <Element2 Attr1=\"\"/>\\n\"\\n</Element1>');\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 34, 1, 34)]);\n\n\t});\n\n\ttest('EOL-Sequence (CRLF) shifts tab stop in isFileTemplate snippets #167386', function () {\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tmodel.setValue('');\n\t\tmodel.setEOL(EndOfLineSequence.CRLF);\n\n\t\tctrl.apply([{\n\t\t\trange: model.getFullModelRange(),\n\t\t\ttemplate: 'line 54321${1:FOO}\\nline 54321${1:FOO}\\n(no tab stop)\\nline 54321${1:FOO}\\nline 54321'\n\t\t}]);\n\n\t\tassert.deepStrictEqual(editor.getSelections(), [new Selection(1, 11, 1, 14), new Selection(2, 11, 2, 14), new Selection(4, 11, 4, 14)]);\n\n\t});\n\n\ttest('\"Surround With\" code action snippets use incorrect indentation levels and styles #169319', function () {\n\t\tmodel.setValue('function foo(f, x, condition) {\\n    f();\\n    return x;\\n}');\n\t\tconst sel = new Range(2, 5, 3, 14);\n\t\teditor.setSelection(sel);\n\t\tctrl = instaService.createInstance(SnippetController2, editor);\n\t\tctrl.apply([{\n\t\t\trange: sel,\n\t\t\ttemplate: 'if (${1:condition}) {\\n\\t$TM_SELECTED_TEXT$0\\n}'\n\t\t}]);\n\n\t\tassert.strictEqual(model.getValue(), `function foo(f, x, condition) {\\n    if (condition) {\\n        f();\\n        return x;\\n    }\\n}`);\n\t});\n});\n"]}