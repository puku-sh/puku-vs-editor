{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/editor/common/services/textResourceConfigurationService.ts","vs/editor/common/services/textResourceConfigurationService.ts"],"names":[],"mappings":"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","file":"textResourceConfigurationService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IPosition, Position } from '../core/position.js';\nimport { ILanguageService } from '../languages/language.js';\nimport { IModelService } from './model.js';\nimport { ITextResourceConfigurationService, ITextResourceConfigurationChangeEvent } from './textResourceConfiguration.js';\nimport { IConfigurationService, ConfigurationTarget, IConfigurationValue, IConfigurationChangeEvent } from '../../../platform/configuration/common/configuration.js';\n\nexport class TextResourceConfigurationService extends Disposable implements ITextResourceConfigurationService {\n\n\tpublic _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<ITextResourceConfigurationChangeEvent> = this._register(new Emitter<ITextResourceConfigurationChangeEvent>());\n\tpublic readonly onDidChangeConfiguration: Event<ITextResourceConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(e))));\n\t}\n\n\tgetValue<T>(resource: URI | undefined, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, at?: IPosition, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, arg2?: unknown, arg3?: unknown): T {\n\t\tif (typeof arg3 === 'string') {\n\t\t\treturn this._getValue(resource, Position.isIPosition(arg2) ? arg2 : null, arg3);\n\t\t}\n\t\treturn this._getValue(resource, null, typeof arg2 === 'string' ? arg2 : undefined);\n\t}\n\n\tupdateValue(resource: URI | undefined, key: string, value: unknown, configurationTarget?: ConfigurationTarget): Promise<void> {\n\t\tconst language = resource ? this.getLanguage(resource, null) : null;\n\t\tconst configurationValue = this.configurationService.inspect(key, { resource, overrideIdentifier: language });\n\t\tif (configurationTarget === undefined) {\n\t\t\tconfigurationTarget = this.deriveConfigurationTarget(configurationValue, language);\n\t\t}\n\t\tconst overrideIdentifier = language && configurationValue.overrideIdentifiers?.includes(language) ? language : undefined;\n\t\treturn this.configurationService.updateValue(key, value, { resource, overrideIdentifier }, configurationTarget);\n\t}\n\n\tprivate deriveConfigurationTarget(configurationValue: IConfigurationValue<unknown>, language: string | null): ConfigurationTarget {\n\t\tif (language) {\n\t\t\tif (configurationValue.memory?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t\t}\n\t\t\tif (configurationValue.workspaceFolder?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t\tif (configurationValue.workspace?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t\t}\n\t\t\tif (configurationValue.userRemote?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t\t}\n\t\t\tif (configurationValue.userLocal?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_LOCAL;\n\t\t\t}\n\t\t}\n\t\tif (configurationValue.memory?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t}\n\t\tif (configurationValue.workspaceFolder?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t}\n\t\tif (configurationValue.workspace?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t}\n\t\tif (configurationValue.userRemote?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t}\n\t\treturn ConfigurationTarget.USER_LOCAL;\n\t}\n\n\tprivate _getValue<T>(resource: URI | undefined, position: IPosition | null, section: string | undefined): T {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\tif (typeof section === 'undefined') {\n\t\t\treturn this.configurationService.getValue<T>({ resource, overrideIdentifier: language });\n\t\t}\n\t\treturn this.configurationService.getValue<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tinspect<T>(resource: URI | undefined, position: IPosition | null, section: string): IConfigurationValue<Readonly<T>> {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\treturn this.configurationService.inspect<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tprivate getLanguage(resource: URI, position: IPosition | null): string | null {\n\t\tconst model = this.modelService.getModel(resource);\n\t\tif (model) {\n\t\t\treturn position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n\t\t}\n\t\treturn this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\t}\n\n\tprivate toResourceConfigurationChangeEvent(configurationChangeEvent: IConfigurationChangeEvent): ITextResourceConfigurationChangeEvent {\n\t\treturn {\n\t\t\taffectedKeys: configurationChangeEvent.affectedKeys,\n\t\t\taffectsConfiguration: (resource: URI | undefined, configuration: string) => {\n\t\t\t\tconst overrideIdentifier = resource ? this.getLanguage(resource, null) : undefined;\n\t\t\t\tif (configurationChangeEvent.affectsConfiguration(configuration, { resource, overrideIdentifier })) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (overrideIdentifier) {\n\t\t\t\t\t//TODO@sandy081 workaround for https://github.com/microsoft/vscode/issues/240410\n\t\t\t\t\treturn configurationChangeEvent.affectedKeys.has(`[${overrideIdentifier}]`);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IPosition, Position } from '../core/position.js';\nimport { ILanguageService } from '../languages/language.js';\nimport { IModelService } from './model.js';\nimport { ITextResourceConfigurationService, ITextResourceConfigurationChangeEvent } from './textResourceConfiguration.js';\nimport { IConfigurationService, ConfigurationTarget, IConfigurationValue, IConfigurationChangeEvent } from '../../../platform/configuration/common/configuration.js';\n\nexport class TextResourceConfigurationService extends Disposable implements ITextResourceConfigurationService {\n\n\tpublic _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<ITextResourceConfigurationChangeEvent> = this._register(new Emitter<ITextResourceConfigurationChangeEvent>());\n\tpublic readonly onDidChangeConfiguration: Event<ITextResourceConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(e))));\n\t}\n\n\tgetValue<T>(resource: URI | undefined, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, at?: IPosition, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, arg2?: unknown, arg3?: unknown): T {\n\t\tif (typeof arg3 === 'string') {\n\t\t\treturn this._getValue(resource, Position.isIPosition(arg2) ? arg2 : null, arg3);\n\t\t}\n\t\treturn this._getValue(resource, null, typeof arg2 === 'string' ? arg2 : undefined);\n\t}\n\n\tupdateValue(resource: URI | undefined, key: string, value: unknown, configurationTarget?: ConfigurationTarget): Promise<void> {\n\t\tconst language = resource ? this.getLanguage(resource, null) : null;\n\t\tconst configurationValue = this.configurationService.inspect(key, { resource, overrideIdentifier: language });\n\t\tif (configurationTarget === undefined) {\n\t\t\tconfigurationTarget = this.deriveConfigurationTarget(configurationValue, language);\n\t\t}\n\t\tconst overrideIdentifier = language && configurationValue.overrideIdentifiers?.includes(language) ? language : undefined;\n\t\treturn this.configurationService.updateValue(key, value, { resource, overrideIdentifier }, configurationTarget);\n\t}\n\n\tprivate deriveConfigurationTarget(configurationValue: IConfigurationValue<unknown>, language: string | null): ConfigurationTarget {\n\t\tif (language) {\n\t\t\tif (configurationValue.memory?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t\t}\n\t\t\tif (configurationValue.workspaceFolder?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t\tif (configurationValue.workspace?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t\t}\n\t\t\tif (configurationValue.userRemote?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t\t}\n\t\t\tif (configurationValue.userLocal?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_LOCAL;\n\t\t\t}\n\t\t}\n\t\tif (configurationValue.memory?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t}\n\t\tif (configurationValue.workspaceFolder?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t}\n\t\tif (configurationValue.workspace?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t}\n\t\tif (configurationValue.userRemote?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t}\n\t\treturn ConfigurationTarget.USER_LOCAL;\n\t}\n\n\tprivate _getValue<T>(resource: URI | undefined, position: IPosition | null, section: string | undefined): T {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\tif (typeof section === 'undefined') {\n\t\t\treturn this.configurationService.getValue<T>({ resource, overrideIdentifier: language });\n\t\t}\n\t\treturn this.configurationService.getValue<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tinspect<T>(resource: URI | undefined, position: IPosition | null, section: string): IConfigurationValue<Readonly<T>> {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\treturn this.configurationService.inspect<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tprivate getLanguage(resource: URI, position: IPosition | null): string | null {\n\t\tconst model = this.modelService.getModel(resource);\n\t\tif (model) {\n\t\t\treturn position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n\t\t}\n\t\treturn this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\t}\n\n\tprivate toResourceConfigurationChangeEvent(configurationChangeEvent: IConfigurationChangeEvent): ITextResourceConfigurationChangeEvent {\n\t\treturn {\n\t\t\taffectedKeys: configurationChangeEvent.affectedKeys,\n\t\t\taffectsConfiguration: (resource: URI | undefined, configuration: string) => {\n\t\t\t\tconst overrideIdentifier = resource ? this.getLanguage(resource, null) : undefined;\n\t\t\t\tif (configurationChangeEvent.affectsConfiguration(configuration, { resource, overrideIdentifier })) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (overrideIdentifier) {\n\t\t\t\t\t//TODO@sandy081 workaround for https://github.com/microsoft/vscode/issues/240410\n\t\t\t\t\treturn configurationChangeEvent.affectedKeys.has(`[${overrideIdentifier}]`);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n}\n"]}