{"version":3,"sources":["vs/base/browser/ui/menu/menubar.ts"],"names":[],"mappings":"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","file":"menubar.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from '../../browser.js';\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { EventType, Gesture, GestureEvent } from '../../touch.js';\nimport { cleanMnemonic, HorizontalDirection, IMenuDirection, IMenuOptions, IMenuStyles, Menu, MENU_ESCAPED_MNEMONIC_REGEX, MENU_MNEMONIC_REGEX, VerticalDirection } from './menu.js';\nimport { ActionRunner, IAction, IActionRunner, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { asArray } from '../../../common/arrays.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { ThemeIcon } from '../../../common/themables.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { KeyCode, KeyMod, ScanCode, ScanCodeUtils } from '../../../common/keyCodes.js';\nimport { ResolvedKeybinding } from '../../../common/keybindings.js';\nimport { Disposable, DisposableStore, dispose, IDisposable } from '../../../common/lifecycle.js';\nimport { isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nimport './menubar.css';\nimport * as nls from '../../../../nls.js';\nimport { mainWindow } from '../../window.js';\n\nconst $ = DOM.$;\n\nexport interface IMenuBarOptions {\n\tenableMnemonics?: boolean;\n\tdisableAltFocus?: boolean;\n\tvisibility?: string;\n\tgetKeybinding?: (action: IAction) => ResolvedKeybinding | undefined;\n\talwaysOnMnemonics?: boolean;\n\tcompactMode?: IMenuDirection;\n\tactionRunner?: IActionRunner;\n\tgetCompactMenuActions?: () => IAction[];\n}\n\nexport interface MenuBarMenu {\n\tactions: IAction[];\n\tlabel: string;\n}\n\ninterface MenuBarMenuWithElements extends MenuBarMenu {\n\ttitleElement?: HTMLElement;\n\tbuttonElement?: HTMLElement;\n}\n\nenum MenubarState {\n\tHIDDEN,\n\tVISIBLE,\n\tFOCUSED,\n\tOPEN\n}\n\nexport class MenuBar extends Disposable {\n\n\tstatic readonly OVERFLOW_INDEX: number = -1;\n\n\tprivate menus: MenuBarMenuWithElements[];\n\n\tprivate overflowMenu!: MenuBarMenuWithElements & { titleElement: HTMLElement; buttonElement: HTMLElement };\n\n\tprivate focusedMenu: {\n\t\tindex: number;\n\t\tholder?: HTMLElement;\n\t\twidget?: Menu;\n\t} | undefined;\n\n\tprivate focusToReturn: HTMLElement | undefined;\n\tprivate menuUpdater: RunOnceScheduler;\n\n\t// Input-related\n\tprivate _mnemonicsInUse: boolean = false;\n\tprivate openedViaKeyboard: boolean = false;\n\tprivate awaitingAltRelease: boolean = false;\n\tprivate ignoreNextMouseUp: boolean = false;\n\tprivate mnemonics: Map<string, number>;\n\n\tprivate updatePending: boolean = false;\n\tprivate _focusState: MenubarState;\n\tprivate actionRunner: IActionRunner;\n\n\tprivate readonly _onVisibilityChange: Emitter<boolean>;\n\tprivate readonly _onFocusStateChange: Emitter<boolean>;\n\n\tprivate numMenusShown: number = 0;\n\tprivate overflowLayoutScheduled: IDisposable | undefined = undefined;\n\n\tprivate readonly menuDisposables = this._register(new DisposableStore());\n\n\tconstructor(private container: HTMLElement, private options: IMenuBarOptions, private menuStyle: IMenuStyles) {\n\t\tsuper();\n\n\t\tthis.container.setAttribute('role', 'menubar');\n\t\tif (this.isCompact) {\n\t\t\tthis.container.classList.add('compact');\n\t\t}\n\n\t\tthis.menus = [];\n\t\tthis.mnemonics = new Map<string, number>();\n\n\t\tthis._focusState = MenubarState.VISIBLE;\n\n\t\tthis._onVisibilityChange = this._register(new Emitter<boolean>());\n\t\tthis._onFocusStateChange = this._register(new Emitter<boolean>());\n\n\t\tthis.createOverflowMenu();\n\n\t\tthis.menuUpdater = this._register(new RunOnceScheduler(() => this.update(), 200));\n\n\t\tthis.actionRunner = this.options.actionRunner ?? this._register(new ActionRunner());\n\t\tthis._register(this.actionRunner.onWillRun(() => {\n\t\t\tthis.setUnfocusedState();\n\t\t}));\n\n\t\tthis._register(DOM.ModifierKeyEmitter.getInstance().event(this.onModifierKeyToggled, this));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.KEY_DOWN, (e) => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tlet eventHandled = true;\n\t\t\tconst key = !!e.key ? e.key.toLocaleLowerCase() : '';\n\n\t\t\tconst tabNav = isMacintosh && !this.isCompact;\n\n\t\t\tif (event.equals(KeyCode.LeftArrow) || (tabNav && event.equals(KeyCode.Tab | KeyMod.Shift))) {\n\t\t\t\tthis.focusPrevious();\n\t\t\t} else if (event.equals(KeyCode.RightArrow) || (tabNav && event.equals(KeyCode.Tab))) {\n\t\t\t\tthis.focusNext();\n\t\t\t} else if (event.equals(KeyCode.Escape) && this.isFocused && !this.isOpen) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t} else if (!this.isOpen && !event.ctrlKey && this.options.enableMnemonics && this.mnemonicsInUse && this.mnemonics.has(key)) {\n\t\t\t\tconst menuIndex = this.mnemonics.get(key)!;\n\t\t\t\tthis.onMenuTriggered(menuIndex, false);\n\t\t\t} else {\n\t\t\t\teventHandled = false;\n\t\t\t}\n\n\t\t\t// Never allow default tab behavior when not compact\n\t\t\tif (!this.isCompact && (event.equals(KeyCode.Tab | KeyMod.Shift) || event.equals(KeyCode.Tab))) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\tif (eventHandled) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}));\n\n\t\tconst window = DOM.getWindow(this.container);\n\t\tthis._register(DOM.addDisposableListener(window, DOM.EventType.MOUSE_DOWN, () => {\n\t\t\t// This mouse event is outside the menubar so it counts as a focus out\n\t\t\tif (this.isFocused) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.FOCUS_IN, (e) => {\n\t\t\tconst event = e;\n\n\t\t\tif (event.relatedTarget) {\n\t\t\t\tif (!this.container.contains(event.relatedTarget as HTMLElement)) {\n\t\t\t\t\tthis.focusToReturn = event.relatedTarget as HTMLElement;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.FOCUS_OUT, (e) => {\n\t\t\tconst event = e;\n\n\t\t\t// We are losing focus and there is no related target, e.g. webview case\n\t\t\tif (!event.relatedTarget) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t\t// We are losing focus and there is a target, reset focusToReturn value as not to redirect\n\t\t\telse if (event.relatedTarget && !this.container.contains(event.relatedTarget as HTMLElement)) {\n\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(window, DOM.EventType.KEY_DOWN, (e: KeyboardEvent) => {\n\t\t\tif (!this.options.enableMnemonics || !e.altKey || e.ctrlKey || e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst key = e.key.toLocaleLowerCase();\n\t\t\tif (!this.mnemonics.has(key)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.mnemonicsInUse = true;\n\t\t\tthis.updateMnemonicVisibility(true);\n\n\t\t\tconst menuIndex = this.mnemonics.get(key)!;\n\t\t\tthis.onMenuTriggered(menuIndex, false);\n\t\t}));\n\n\t\tthis.setUnfocusedState();\n\t}\n\n\tpush(arg: MenuBarMenu | MenuBarMenu[]): void {\n\t\tconst menus: MenuBarMenu[] = asArray(arg);\n\n\t\tmenus.forEach((menuBarMenu) => {\n\t\t\tconst menuIndex = this.menus.length;\n\t\t\tconst cleanMenuLabel = cleanMnemonic(menuBarMenu.label);\n\n\t\t\tconst mnemonicMatches = MENU_MNEMONIC_REGEX.exec(menuBarMenu.label);\n\n\t\t\t// Register mnemonics\n\t\t\tif (mnemonicMatches) {\n\t\t\t\tconst mnemonic = !!mnemonicMatches[1] ? mnemonicMatches[1] : mnemonicMatches[3];\n\n\t\t\t\tthis.registerMnemonic(this.menus.length, mnemonic);\n\t\t\t}\n\n\t\t\tif (this.isCompact) {\n\t\t\t\tthis.menus.push(menuBarMenu);\n\t\t\t} else {\n\t\t\t\tconst buttonElement = $('div.menubar-menu-button', { 'role': 'menuitem', 'tabindex': -1, 'aria-label': cleanMenuLabel, 'aria-haspopup': true });\n\t\t\t\tconst titleElement = $('div.menubar-menu-title', { 'role': 'none', 'aria-hidden': true });\n\n\t\t\t\tbuttonElement.appendChild(titleElement);\n\t\t\t\tthis.container.insertBefore(buttonElement, this.overflowMenu.buttonElement);\n\n\t\t\t\tthis.updateLabels(titleElement, buttonElement, menuBarMenu.label);\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.KEY_UP, (e) => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t\t\tlet eventHandled = true;\n\n\t\t\t\t\tif ((event.equals(KeyCode.DownArrow) || event.equals(KeyCode.Enter)) && !this.isOpen) {\n\t\t\t\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\t\t\t\tthis.openedViaKeyboard = true;\n\t\t\t\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventHandled = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (eventHandled) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._register(Gesture.addTarget(buttonElement));\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, EventType.Tap, (e: GestureEvent) => {\n\t\t\t\t\t// Ignore this touch if the menu is touched\n\t\t\t\t\tif (this.isOpen && this.focusedMenu && this.focusedMenu.holder && DOM.isAncestor(e.initialTarget as HTMLElement, this.focusedMenu.holder)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_DOWN, (e: MouseEvent) => {\n\t\t\t\t\t// Ignore non-left-click\n\t\t\t\t\tconst mouseEvent = new StandardMouseEvent(DOM.getWindow(buttonElement), e);\n\t\t\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.isOpen) {\n\t\t\t\t\t\t// Open the menu with mouse down and ignore the following mouse up event\n\t\t\t\t\t\tthis.ignoreNextMouseUp = true;\n\t\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\t}\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_UP, (e) => {\n\t\t\t\t\tif (e.defaultPrevented) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.ignoreNextMouseUp) {\n\t\t\t\t\t\tif (this.isFocused) {\n\t\t\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_ENTER, () => {\n\t\t\t\t\tif (this.isOpen && !this.isCurrentMenu(menuIndex)) {\n\t\t\t\t\t\tbuttonElement.focus();\n\t\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t\t\tthis.showCustomMenu(menuIndex, false);\n\t\t\t\t\t} else if (this.isFocused && !this.isOpen) {\n\t\t\t\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\t\t\t\tbuttonElement.focus();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.menus.push({\n\t\t\t\t\tlabel: menuBarMenu.label,\n\t\t\t\t\tactions: menuBarMenu.actions,\n\t\t\t\t\tbuttonElement: buttonElement,\n\t\t\t\t\ttitleElement: titleElement\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateOverflowMenu(): void {\n\t\tconst label = this.isCompact ? nls.localize('mAppMenu', 'Application Menu') : nls.localize('mMore', 'More');\n\t\tconst buttonElement = $('div.menubar-menu-button', { 'role': 'menuitem', 'tabindex': this.isCompact ? 0 : -1, 'aria-label': label, 'aria-haspopup': true });\n\t\tconst titleElement = $('div.menubar-menu-title.toolbar-toggle-more' + ThemeIcon.asCSSSelector(Codicon.menuBarMore), { 'role': 'none', 'aria-hidden': true });\n\n\t\tbuttonElement.appendChild(titleElement);\n\t\tthis.container.appendChild(buttonElement);\n\t\tbuttonElement.style.visibility = 'hidden';\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.KEY_UP, (e) => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tlet eventHandled = true;\n\n\t\t\tconst triggerKeys = [KeyCode.Enter];\n\t\t\tif (!this.isCompact) {\n\t\t\t\ttriggerKeys.push(KeyCode.DownArrow);\n\t\t\t} else {\n\t\t\t\ttriggerKeys.push(KeyCode.Space);\n\n\t\t\t\tif (this.options.compactMode?.horizontal === HorizontalDirection.Right) {\n\t\t\t\t\ttriggerKeys.push(KeyCode.RightArrow);\n\t\t\t\t} else if (this.options.compactMode?.horizontal === HorizontalDirection.Left) {\n\t\t\t\t\ttriggerKeys.push(KeyCode.LeftArrow);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((triggerKeys.some(k => event.equals(k)) && !this.isOpen)) {\n\t\t\t\tthis.focusedMenu = { index: MenuBar.OVERFLOW_INDEX };\n\t\t\t\tthis.openedViaKeyboard = true;\n\t\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t\t} else {\n\t\t\t\teventHandled = false;\n\t\t\t}\n\n\t\t\tif (eventHandled) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(Gesture.addTarget(buttonElement));\n\t\tthis._register(DOM.addDisposableListener(buttonElement, EventType.Tap, (e: GestureEvent) => {\n\t\t\t// Ignore this touch if the menu is touched\n\t\t\tif (this.isOpen && this.focusedMenu && this.focusedMenu.holder && DOM.isAncestor(e.initialTarget as HTMLElement, this.focusedMenu.holder)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_DOWN, (e) => {\n\t\t\t// Ignore non-left-click\n\t\t\tconst mouseEvent = new StandardMouseEvent(DOM.getWindow(buttonElement), e);\n\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isOpen) {\n\t\t\t\t// Open the menu with mouse down and ignore the following mouse up event\n\t\t\t\tthis.ignoreNextMouseUp = true;\n\t\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\t\t\t} else {\n\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_UP, (e) => {\n\t\t\tif (e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.ignoreNextMouseUp) {\n\t\t\t\tif (this.isFocused) {\n\t\t\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_ENTER, () => {\n\t\t\tif (this.isOpen && !this.isCurrentMenu(MenuBar.OVERFLOW_INDEX)) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\tthis.showCustomMenu(MenuBar.OVERFLOW_INDEX, false);\n\t\t\t} else if (this.isFocused && !this.isOpen) {\n\t\t\t\tthis.focusedMenu = { index: MenuBar.OVERFLOW_INDEX };\n\t\t\t\tbuttonElement.focus();\n\t\t\t}\n\t\t}));\n\n\t\tthis.overflowMenu = {\n\t\t\tbuttonElement: buttonElement,\n\t\t\ttitleElement: titleElement,\n\t\t\tlabel: 'More',\n\t\t\tactions: []\n\t\t};\n\t}\n\n\tupdateMenu(menu: MenuBarMenu): void {\n\t\tconst menuToUpdate = this.menus.filter(menuBarMenu => menuBarMenu.label === menu.label);\n\t\tif (menuToUpdate && menuToUpdate.length) {\n\t\t\tmenuToUpdate[0].actions = menu.actions;\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\tmenuBarMenu.titleElement?.remove();\n\t\t\tmenuBarMenu.buttonElement?.remove();\n\t\t});\n\n\t\tthis.overflowMenu.titleElement.remove();\n\t\tthis.overflowMenu.buttonElement.remove();\n\n\t\tdispose(this.overflowLayoutScheduled);\n\t\tthis.overflowLayoutScheduled = undefined;\n\t}\n\n\tblur(): void {\n\t\tthis.setUnfocusedState();\n\t}\n\n\tgetWidth(): number {\n\t\tif (!this.isCompact && this.menus) {\n\t\t\tconst left = this.menus[0].buttonElement!.getBoundingClientRect().left;\n\t\t\tconst right = this.hasOverflow ? this.overflowMenu.buttonElement.getBoundingClientRect().right : this.menus[this.menus.length - 1].buttonElement!.getBoundingClientRect().right;\n\t\t\treturn right - left;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tgetHeight(): number {\n\t\treturn this.container.clientHeight;\n\t}\n\n\ttoggleFocus(): void {\n\t\tif (!this.isFocused && this.options.visibility !== 'hidden') {\n\t\t\tthis.mnemonicsInUse = true;\n\t\t\tthis.focusedMenu = { index: this.numMenusShown > 0 ? 0 : MenuBar.OVERFLOW_INDEX };\n\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t} else if (!this.isOpen) {\n\t\t\tthis.setUnfocusedState();\n\t\t}\n\t}\n\n\tprivate updateOverflowAction(): void {\n\t\tif (!this.menus || !this.menus.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst overflowMenuOnlyClass = 'overflow-menu-only';\n\n\t\t// Remove overflow only restriction to allow the most space\n\t\tthis.container.classList.toggle(overflowMenuOnlyClass, false);\n\n\t\tconst sizeAvailable = this.container.offsetWidth;\n\t\tlet currentSize = 0;\n\t\tlet full = this.isCompact;\n\t\tconst prevNumMenusShown = this.numMenusShown;\n\t\tthis.numMenusShown = 0;\n\n\t\tconst showableMenus = this.menus.filter(menu => menu.buttonElement !== undefined && menu.titleElement !== undefined) as (MenuBarMenuWithElements & { titleElement: HTMLElement; buttonElement: HTMLElement })[];\n\t\tfor (const menuBarMenu of showableMenus) {\n\t\t\tif (!full) {\n\t\t\t\tconst size = menuBarMenu.buttonElement.offsetWidth;\n\t\t\t\tif (currentSize + size > sizeAvailable) {\n\t\t\t\t\tfull = true;\n\t\t\t\t} else {\n\t\t\t\t\tcurrentSize += size;\n\t\t\t\t\tthis.numMenusShown++;\n\t\t\t\t\tif (this.numMenusShown > prevNumMenusShown) {\n\t\t\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'visible';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (full) {\n\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'hidden';\n\t\t\t}\n\t\t}\n\n\n\t\t// If below minimium menu threshold, show the overflow menu only as hamburger menu\n\t\tif (this.numMenusShown - 1 <= showableMenus.length / 4) {\n\t\t\tfor (const menuBarMenu of showableMenus) {\n\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'hidden';\n\t\t\t}\n\n\t\t\tfull = true;\n\t\t\tthis.numMenusShown = 0;\n\t\t\tcurrentSize = 0;\n\t\t}\n\n\t\t// Overflow\n\t\tif (this.isCompact) {\n\t\t\tthis.overflowMenu.actions = [];\n\t\t\tfor (let idx = this.numMenusShown; idx < this.menus.length; idx++) {\n\t\t\t\tthis.overflowMenu.actions.push(new SubmenuAction(`menubar.submenu.${this.menus[idx].label}`, this.menus[idx].label, this.menus[idx].actions || []));\n\t\t\t}\n\n\t\t\tconst compactMenuActions = this.options.getCompactMenuActions?.();\n\t\t\tif (compactMenuActions && compactMenuActions.length) {\n\t\t\t\tthis.overflowMenu.actions.push(new Separator());\n\t\t\t\tthis.overflowMenu.actions.push(...compactMenuActions);\n\t\t\t}\n\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'visible';\n\t\t} else if (full) {\n\t\t\t// Can't fit the more button, need to remove more menus\n\t\t\twhile (currentSize + this.overflowMenu.buttonElement.offsetWidth > sizeAvailable && this.numMenusShown > 0) {\n\t\t\t\tthis.numMenusShown--;\n\t\t\t\tconst size = showableMenus[this.numMenusShown].buttonElement.offsetWidth;\n\t\t\t\tshowableMenus[this.numMenusShown].buttonElement.style.visibility = 'hidden';\n\t\t\t\tcurrentSize -= size;\n\t\t\t}\n\n\t\t\tthis.overflowMenu.actions = [];\n\t\t\tfor (let idx = this.numMenusShown; idx < showableMenus.length; idx++) {\n\t\t\t\tthis.overflowMenu.actions.push(new SubmenuAction(`menubar.submenu.${showableMenus[idx].label}`, showableMenus[idx].label, showableMenus[idx].actions || []));\n\t\t\t}\n\n\t\t\tif (this.overflowMenu.buttonElement.nextElementSibling !== showableMenus[this.numMenusShown].buttonElement) {\n\t\t\t\tthis.overflowMenu.buttonElement.remove();\n\t\t\t\tthis.container.insertBefore(this.overflowMenu.buttonElement, showableMenus[this.numMenusShown].buttonElement);\n\t\t\t}\n\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'visible';\n\t\t} else {\n\t\t\tthis.overflowMenu.buttonElement.remove();\n\t\t\tthis.container.appendChild(this.overflowMenu.buttonElement);\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'hidden';\n\t\t}\n\n\t\t// If we are only showing the overflow, add this class to avoid taking up space\n\t\tthis.container.classList.toggle(overflowMenuOnlyClass, this.numMenusShown === 0);\n\t}\n\n\tprivate updateLabels(titleElement: HTMLElement, buttonElement: HTMLElement, label: string): void {\n\t\tconst cleanMenuLabel = cleanMnemonic(label);\n\n\t\t// Update the button label to reflect mnemonics\n\n\t\tif (this.options.enableMnemonics) {\n\t\t\tconst cleanLabel = strings.escape(label);\n\n\t\t\t// This is global so reset it\n\t\t\tMENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n\t\t\tlet escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(cleanLabel);\n\n\t\t\t// We can't use negative lookbehind so we match our negative and skip\n\t\t\twhile (escMatch && escMatch[1]) {\n\t\t\t\tescMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(cleanLabel);\n\t\t\t}\n\n\t\t\tconst replaceDoubleEscapes = (str: string) => str.replace(/&amp;&amp;/g, '&amp;');\n\n\t\t\tif (escMatch) {\n\t\t\t\ttitleElement.textContent = '';\n\t\t\t\ttitleElement.append(\n\t\t\t\t\tstrings.ltrim(replaceDoubleEscapes(cleanLabel.substr(0, escMatch.index)), ' '),\n\t\t\t\t\t$('mnemonic', { 'aria-hidden': 'true' }, escMatch[3]),\n\t\t\t\t\tstrings.rtrim(replaceDoubleEscapes(cleanLabel.substr(escMatch.index + escMatch[0].length)), ' ')\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttitleElement.textContent = replaceDoubleEscapes(cleanLabel).trim();\n\t\t\t}\n\t\t} else {\n\t\t\ttitleElement.textContent = cleanMenuLabel.replace(/&&/g, '&');\n\t\t}\n\n\t\tconst mnemonicMatches = MENU_MNEMONIC_REGEX.exec(label);\n\n\t\t// Register mnemonics\n\t\tif (mnemonicMatches) {\n\t\t\tconst mnemonic = !!mnemonicMatches[1] ? mnemonicMatches[1] : mnemonicMatches[3];\n\n\t\t\tif (this.options.enableMnemonics) {\n\t\t\t\tbuttonElement.setAttribute('aria-keyshortcuts', 'Alt+' + mnemonic.toLocaleLowerCase());\n\t\t\t} else {\n\t\t\t\tbuttonElement.removeAttribute('aria-keyshortcuts');\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate(options?: IMenuBarOptions): void {\n\t\tif (options) {\n\t\t\tthis.options = options;\n\t\t}\n\n\t\t// Don't update while using the menu\n\t\tif (this.isFocused) {\n\t\t\tthis.updatePending = true;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\tif (!menuBarMenu.buttonElement || !menuBarMenu.titleElement) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateLabels(menuBarMenu.titleElement, menuBarMenu.buttonElement, menuBarMenu.label);\n\t\t});\n\n\t\tif (!this.overflowLayoutScheduled) {\n\t\t\tthis.overflowLayoutScheduled = DOM.scheduleAtNextAnimationFrame(DOM.getWindow(this.container), () => {\n\t\t\t\tthis.updateOverflowAction();\n\t\t\t\tthis.overflowLayoutScheduled = undefined;\n\t\t\t});\n\t\t}\n\n\t\tthis.setUnfocusedState();\n\t}\n\n\tprivate registerMnemonic(menuIndex: number, mnemonic: string): void {\n\t\tthis.mnemonics.set(mnemonic.toLocaleLowerCase(), menuIndex);\n\t}\n\n\tprivate hideMenubar(): void {\n\t\tif (this.container.style.display !== 'none') {\n\t\t\tthis.container.style.display = 'none';\n\t\t\tthis._onVisibilityChange.fire(false);\n\t\t}\n\t}\n\n\tprivate showMenubar(): void {\n\t\tif (this.container.style.display !== 'flex') {\n\t\t\tthis.container.style.display = 'flex';\n\t\t\tthis._onVisibilityChange.fire(true);\n\n\t\t\tthis.updateOverflowAction();\n\t\t}\n\t}\n\n\tprivate get focusState(): MenubarState {\n\t\treturn this._focusState;\n\t}\n\n\tprivate set focusState(value: MenubarState) {\n\t\tif (this._focusState >= MenubarState.FOCUSED && value < MenubarState.FOCUSED) {\n\t\t\t// Losing focus, update the menu if needed\n\n\t\t\tif (this.updatePending) {\n\t\t\t\tthis.menuUpdater.schedule();\n\t\t\t\tthis.updatePending = false;\n\t\t\t}\n\t\t}\n\n\t\tif (value === this._focusState) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isVisible = this.isVisible;\n\t\tconst isOpen = this.isOpen;\n\t\tconst isFocused = this.isFocused;\n\n\t\tthis._focusState = value;\n\n\t\tswitch (value) {\n\t\t\tcase MenubarState.HIDDEN:\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tthis.hideMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (isFocused) {\n\t\t\t\t\tthis.focusedMenu = undefined;\n\n\t\t\t\t\tif (this.focusToReturn) {\n\t\t\t\t\t\tthis.focusToReturn.focus();\n\t\t\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.VISIBLE:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (isFocused) {\n\t\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\t\t\t\tthis.overflowMenu.buttonElement.blur();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.blur();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusedMenu = undefined;\n\n\t\t\t\t\tif (this.focusToReturn) {\n\t\t\t\t\t\tthis.focusToReturn.focus();\n\t\t\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.FOCUSED:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\t// When the menu is toggled on, it may be in compact state and trying to\n\t\t\t\t\t// focus the first menu. In this case we should focus the overflow instead.\n\t\t\t\t\tif (this.focusedMenu.index === 0 && this.numMenusShown === 0) {\n\t\t\t\t\t\tthis.focusedMenu.index = MenuBar.OVERFLOW_INDEX;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.OPEN:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t\tthis.showCustomMenu(this.focusedMenu.index, this.openedViaKeyboard);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._focusState = value;\n\t\tthis._onFocusStateChange.fire(this.focusState >= MenubarState.FOCUSED);\n\t}\n\n\tget isVisible(): boolean {\n\t\treturn this.focusState >= MenubarState.VISIBLE;\n\t}\n\n\tprivate get isFocused(): boolean {\n\t\treturn this.focusState >= MenubarState.FOCUSED;\n\t}\n\n\tprivate get isOpen(): boolean {\n\t\treturn this.focusState >= MenubarState.OPEN;\n\t}\n\n\tprivate get hasOverflow(): boolean {\n\t\treturn this.isCompact || this.numMenusShown < this.menus.length;\n\t}\n\n\tprivate get isCompact(): boolean {\n\t\treturn this.options.compactMode !== undefined;\n\t}\n\n\tprivate setUnfocusedState(): void {\n\t\tif (this.options.visibility === 'toggle' || this.options.visibility === 'hidden') {\n\t\t\tthis.focusState = MenubarState.HIDDEN;\n\t\t} else if (this.options.visibility === 'classic' && browser.isFullscreen(mainWindow)) {\n\t\t\tthis.focusState = MenubarState.HIDDEN;\n\t\t} else {\n\t\t\tthis.focusState = MenubarState.VISIBLE;\n\t\t}\n\n\t\tthis.ignoreNextMouseUp = false;\n\t\tthis.mnemonicsInUse = false;\n\t\tthis.updateMnemonicVisibility(false);\n\t}\n\n\tprivate focusPrevious(): void {\n\n\t\tif (!this.focusedMenu || this.numMenusShown === 0) {\n\t\t\treturn;\n\t\t}\n\n\n\t\tlet newFocusedIndex = (this.focusedMenu.index - 1 + this.numMenusShown) % this.numMenusShown;\n\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\tnewFocusedIndex = this.numMenusShown - 1;\n\t\t} else if (this.focusedMenu.index === 0 && this.hasOverflow) {\n\t\t\tnewFocusedIndex = MenuBar.OVERFLOW_INDEX;\n\t\t}\n\n\t\tif (newFocusedIndex === this.focusedMenu.index) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isOpen) {\n\t\t\tthis.cleanupCustomMenu();\n\t\t\tthis.showCustomMenu(newFocusedIndex);\n\t\t} else if (this.isFocused) {\n\t\t\tthis.focusedMenu.index = newFocusedIndex;\n\t\t\tif (newFocusedIndex === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[newFocusedIndex].buttonElement?.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate focusNext(): void {\n\t\tif (!this.focusedMenu || this.numMenusShown === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet newFocusedIndex = (this.focusedMenu.index + 1) % this.numMenusShown;\n\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\tnewFocusedIndex = 0;\n\t\t} else if (this.focusedMenu.index === this.numMenusShown - 1) {\n\t\t\tnewFocusedIndex = MenuBar.OVERFLOW_INDEX;\n\t\t}\n\n\t\tif (newFocusedIndex === this.focusedMenu.index) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isOpen) {\n\t\t\tthis.cleanupCustomMenu();\n\t\t\tthis.showCustomMenu(newFocusedIndex);\n\t\t} else if (this.isFocused) {\n\t\t\tthis.focusedMenu.index = newFocusedIndex;\n\t\t\tif (newFocusedIndex === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[newFocusedIndex].buttonElement?.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateMnemonicVisibility(visible: boolean): void {\n\t\tif (this.menus) {\n\t\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\t\tif (menuBarMenu.titleElement && menuBarMenu.titleElement.children.length) {\n\t\t\t\t\tconst child = menuBarMenu.titleElement.children.item(0) as HTMLElement;\n\t\t\t\t\tif (child) {\n\t\t\t\t\t\tchild.style.textDecoration = (this.options.alwaysOnMnemonics || visible) ? 'underline' : '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate get mnemonicsInUse(): boolean {\n\t\treturn this._mnemonicsInUse;\n\t}\n\n\tprivate set mnemonicsInUse(value: boolean) {\n\t\tthis._mnemonicsInUse = value;\n\t}\n\n\tprivate get shouldAltKeyFocus(): boolean {\n\t\tif (isMacintosh) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.options.disableAltFocus) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.options.visibility === 'toggle') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic get onVisibilityChange(): Event<boolean> {\n\t\treturn this._onVisibilityChange.event;\n\t}\n\n\tpublic get onFocusStateChange(): Event<boolean> {\n\t\treturn this._onFocusStateChange.event;\n\t}\n\n\tprivate onMenuTriggered(menuIndex: number, clicked: boolean) {\n\t\tif (this.isOpen) {\n\t\t\tif (this.isCurrentMenu(menuIndex)) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t} else {\n\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\tthis.showCustomMenu(menuIndex, this.openedViaKeyboard);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\tthis.openedViaKeyboard = !clicked;\n\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t}\n\t}\n\n\tprivate onModifierKeyToggled(modifierKeyStatus: DOM.IModifierKeyStatus): void {\n\t\tconst allModifiersReleased = !modifierKeyStatus.altKey && !modifierKeyStatus.ctrlKey && !modifierKeyStatus.shiftKey && !modifierKeyStatus.metaKey;\n\n\t\tif (this.options.visibility === 'hidden') {\n\t\t\treturn;\n\t\t}\n\n\t\t// Prevent alt-key default if the menu is not hidden and we use alt to focus\n\t\tif (modifierKeyStatus.event && this.shouldAltKeyFocus) {\n\t\t\tif (ScanCodeUtils.toEnum(modifierKeyStatus.event.code) === ScanCode.AltLeft) {\n\t\t\t\tmodifierKeyStatus.event.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\t// Alt key pressed while menu is focused. This should return focus away from the menubar\n\t\tif (this.isFocused && modifierKeyStatus.lastKeyPressed === 'alt' && modifierKeyStatus.altKey) {\n\t\t\tthis.setUnfocusedState();\n\t\t\tthis.mnemonicsInUse = false;\n\t\t\tthis.awaitingAltRelease = true;\n\t\t}\n\n\t\t// Clean alt key press and release\n\t\tif (allModifiersReleased && modifierKeyStatus.lastKeyPressed === 'alt' && modifierKeyStatus.lastKeyReleased === 'alt') {\n\t\t\tif (!this.awaitingAltRelease) {\n\t\t\t\tif (!this.isFocused && this.shouldAltKeyFocus) {\n\t\t\t\t\tthis.mnemonicsInUse = true;\n\t\t\t\t\tthis.focusedMenu = { index: this.numMenusShown > 0 ? 0 : MenuBar.OVERFLOW_INDEX };\n\t\t\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t\t\t} else if (!this.isOpen) {\n\t\t\t\t\tthis.setUnfocusedState();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Alt key released\n\t\tif (!modifierKeyStatus.altKey && modifierKeyStatus.lastKeyReleased === 'alt') {\n\t\t\tthis.awaitingAltRelease = false;\n\t\t}\n\n\t\tif (this.options.enableMnemonics && this.menus && !this.isOpen) {\n\t\t\tthis.updateMnemonicVisibility((!this.awaitingAltRelease && modifierKeyStatus.altKey) || this.mnemonicsInUse);\n\t\t}\n\t}\n\n\tprivate isCurrentMenu(menuIndex: number): boolean {\n\t\tif (!this.focusedMenu) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.focusedMenu.index === menuIndex;\n\t}\n\n\tprivate cleanupCustomMenu(): void {\n\t\tif (this.focusedMenu) {\n\t\t\t// Remove focus from the menus first\n\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.focus();\n\t\t\t}\n\n\t\t\tif (this.focusedMenu.holder) {\n\t\t\t\tthis.focusedMenu.holder.parentElement?.classList.remove('open');\n\n\t\t\t\tthis.focusedMenu.holder.remove();\n\t\t\t}\n\n\t\t\tthis.focusedMenu.widget?.dispose();\n\n\t\t\tthis.focusedMenu = { index: this.focusedMenu.index };\n\t\t}\n\t\tthis.menuDisposables.clear();\n\t}\n\n\tprivate showCustomMenu(menuIndex: number, selectFirst = true): void {\n\t\tconst actualMenuIndex = menuIndex >= this.numMenusShown ? MenuBar.OVERFLOW_INDEX : menuIndex;\n\t\tconst customMenu = actualMenuIndex === MenuBar.OVERFLOW_INDEX ? this.overflowMenu : this.menus[actualMenuIndex];\n\n\t\tif (!customMenu.actions || !customMenu.buttonElement || !customMenu.titleElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuHolder = $('div.menubar-menu-items-holder', { 'title': '' });\n\n\t\tcustomMenu.buttonElement.classList.add('open');\n\n\t\tconst titleBoundingRect = customMenu.titleElement.getBoundingClientRect();\n\t\tconst titleBoundingRectZoom = DOM.getDomNodeZoomLevel(customMenu.titleElement);\n\n\t\tif (this.options.compactMode?.horizontal === HorizontalDirection.Right) {\n\t\t\tmenuHolder.style.left = `${titleBoundingRect.left + this.container.clientWidth}px`;\n\t\t} else if (this.options.compactMode?.horizontal === HorizontalDirection.Left) {\n\t\t\tconst windowWidth = DOM.getWindow(this.container).innerWidth;\n\t\t\tmenuHolder.style.right = `${windowWidth - titleBoundingRect.left}px`;\n\t\t\tmenuHolder.style.left = 'auto';\n\t\t} else {\n\t\t\tmenuHolder.style.left = `${titleBoundingRect.left * titleBoundingRectZoom}px`;\n\t\t}\n\n\t\tif (this.options.compactMode?.vertical === VerticalDirection.Above) {\n\t\t\t// TODO@benibenj Do not hardcode the height of the menu holder\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.top - this.menus.length * 30 + this.container.clientHeight}px`;\n\t\t} else if (this.options.compactMode?.vertical === VerticalDirection.Below) {\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.top}px`;\n\t\t} else {\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.bottom * titleBoundingRectZoom}px`;\n\t\t}\n\n\t\tcustomMenu.buttonElement.appendChild(menuHolder);\n\n\t\tconst menuOptions: IMenuOptions = {\n\t\t\tgetKeyBinding: this.options.getKeybinding,\n\t\t\tactionRunner: this.actionRunner,\n\t\t\tenableMnemonics: this.options.alwaysOnMnemonics || (this.mnemonicsInUse && this.options.enableMnemonics),\n\t\t\tariaLabel: customMenu.buttonElement.getAttribute('aria-label') ?? undefined,\n\t\t\texpandDirection: this.isCompact ? this.options.compactMode : { horizontal: HorizontalDirection.Right, vertical: VerticalDirection.Below },\n\t\t\tuseEventAsContext: true\n\t\t};\n\n\t\tconst menuWidget = this.menuDisposables.add(new Menu(menuHolder, customMenu.actions, menuOptions, this.menuStyle));\n\t\tthis.menuDisposables.add(menuWidget.onDidCancel(() => {\n\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t}));\n\n\t\tif (actualMenuIndex !== menuIndex) {\n\t\t\tmenuWidget.trigger(menuIndex - this.numMenusShown);\n\t\t} else {\n\t\t\tmenuWidget.focus(selectFirst);\n\t\t}\n\n\t\tthis.focusedMenu = {\n\t\t\tindex: actualMenuIndex,\n\t\t\tholder: menuHolder,\n\t\t\twidget: menuWidget\n\t\t};\n\t}\n}\n"]}