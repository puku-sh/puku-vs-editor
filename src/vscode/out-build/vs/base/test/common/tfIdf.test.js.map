{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/base/test/common/tfIdf.test.ts","vs/base/test/common/tfIdf.test.ts"],"names":[],"mappings":"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","file":"tfIdf.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../common/cancellation.js';\nimport { TfIdfCalculator, TfIdfDocument, TfIdfScore } from '../../common/tfIdf.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from './utils.js';\n\n/**\n * Generates all permutations of an array.\n *\n * This is useful for testing to make sure order does not effect the result.\n */\nfunction permutate<T>(arr: T[]): T[][] {\n\tif (arr.length === 0) {\n\t\treturn [[]];\n\t}\n\n\tconst result: T[][] = [];\n\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst rest = [...arr.slice(0, i), ...arr.slice(i + 1)];\n\t\tconst permutationsRest = permutate(rest);\n\t\tfor (let j = 0; j < permutationsRest.length; j++) {\n\t\t\tresult.push([arr[i], ...permutationsRest[j]]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction assertScoreOrdersEqual(actualScores: TfIdfScore[], expectedScoreKeys: string[]): void {\n\tactualScores.sort((a, b) => (b.score - a.score) || a.key.localeCompare(b.key));\n\tassert.strictEqual(actualScores.length, expectedScoreKeys.length);\n\tfor (let i = 0; i < expectedScoreKeys.length; i++) {\n\t\tassert.strictEqual(actualScores[i].key, expectedScoreKeys[i]);\n\t}\n}\n\nsuite('TF-IDF Calculator', function () {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\ttest('Should return no scores when no documents are given', () => {\n\t\tconst tfidf = new TfIdfCalculator();\n\t\tconst scores = tfidf.calculateScores('something', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n\n\ttest('Should return no scores for term not in document', () => {\n\t\tconst tfidf = new TfIdfCalculator().updateDocuments([\n\t\t\tmakeDocument('A', 'cat dog fish'),\n\t\t]);\n\t\tconst scores = tfidf.calculateScores('elepant', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n\n\ttest('Should return scores for document with exact match', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('A', 'cat dog cat'),\n\t\t\tmakeDocument('B', 'cat fish'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['A']);\n\t\t}\n\t});\n\n\ttest('Should return document with more matches first', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat'),\n\t\t\tmakeDocument('/B', 'cat fish'),\n\t\t\tmakeDocument('/C', 'frog'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should return document with more matches first when term appears in all documents', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat cat'),\n\t\t\tmakeDocument('/B', 'cat fish'),\n\t\t\tmakeDocument('/C', 'frog cat cat'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/C', '/B']);\n\t\t}\n\t});\n\n\ttest('Should weigh less common term higher', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat'),\n\t\t\tmakeDocument('/B', 'fish'),\n\t\t\tmakeDocument('/C', 'cat cat cat cat'),\n\t\t\tmakeDocument('/D', 'cat fish')\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat the dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/C', '/D']);\n\t\t}\n\t});\n\n\ttest('Should weigh chunks with less common terms higher', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/B', '/A']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B', '/B']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat the dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/B', '/A', '/B']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('lake fish', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A']);\n\t\t}\n\t});\n\n\ttest('Should ignore case and punctuation', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'Cat doG.cat'),\n\t\t\tmakeDocument('/B', 'cAt fiSH'),\n\t\t\tmakeDocument('/C', 'frOg'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('. ,CaT!  ', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should match on camelCase words', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'catDog cat'),\n\t\t\tmakeDocument('/B', 'fishCatFish'),\n\t\t\tmakeDocument('/C', 'frogcat'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('catDOG', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should not match document after delete', () => {\n\t\tconst docA = makeDocument('/A', 'cat dog cat');\n\t\tconst docB = makeDocument('/B', 'cat fish');\n\t\tconst docC = makeDocument('/C', 'frog');\n\n\t\tconst tfidf = new TfIdfCalculator().updateDocuments([docA, docB, docC]);\n\t\tlet scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\n\t\ttfidf.deleteDocument(docA.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/B']);\n\n\t\ttfidf.deleteDocument(docC.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/B']);\n\n\t\ttfidf.deleteDocument(docB.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n});\n\nfunction makeDocument(key: string, content: string | string[]): TfIdfDocument {\n\treturn {\n\t\tkey,\n\t\ttextChunks: Array.isArray(content) ? content : [content],\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../common/cancellation.js';\nimport { TfIdfCalculator, TfIdfDocument, TfIdfScore } from '../../common/tfIdf.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from './utils.js';\n\n/**\n * Generates all permutations of an array.\n *\n * This is useful for testing to make sure order does not effect the result.\n */\nfunction permutate<T>(arr: T[]): T[][] {\n\tif (arr.length === 0) {\n\t\treturn [[]];\n\t}\n\n\tconst result: T[][] = [];\n\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst rest = [...arr.slice(0, i), ...arr.slice(i + 1)];\n\t\tconst permutationsRest = permutate(rest);\n\t\tfor (let j = 0; j < permutationsRest.length; j++) {\n\t\t\tresult.push([arr[i], ...permutationsRest[j]]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction assertScoreOrdersEqual(actualScores: TfIdfScore[], expectedScoreKeys: string[]): void {\n\tactualScores.sort((a, b) => (b.score - a.score) || a.key.localeCompare(b.key));\n\tassert.strictEqual(actualScores.length, expectedScoreKeys.length);\n\tfor (let i = 0; i < expectedScoreKeys.length; i++) {\n\t\tassert.strictEqual(actualScores[i].key, expectedScoreKeys[i]);\n\t}\n}\n\nsuite('TF-IDF Calculator', function () {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\ttest('Should return no scores when no documents are given', () => {\n\t\tconst tfidf = new TfIdfCalculator();\n\t\tconst scores = tfidf.calculateScores('something', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n\n\ttest('Should return no scores for term not in document', () => {\n\t\tconst tfidf = new TfIdfCalculator().updateDocuments([\n\t\t\tmakeDocument('A', 'cat dog fish'),\n\t\t]);\n\t\tconst scores = tfidf.calculateScores('elepant', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n\n\ttest('Should return scores for document with exact match', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('A', 'cat dog cat'),\n\t\t\tmakeDocument('B', 'cat fish'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['A']);\n\t\t}\n\t});\n\n\ttest('Should return document with more matches first', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat'),\n\t\t\tmakeDocument('/B', 'cat fish'),\n\t\t\tmakeDocument('/C', 'frog'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should return document with more matches first when term appears in all documents', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat cat'),\n\t\t\tmakeDocument('/B', 'cat fish'),\n\t\t\tmakeDocument('/C', 'frog cat cat'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/C', '/B']);\n\t\t}\n\t});\n\n\ttest('Should weigh less common term higher', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'cat dog cat'),\n\t\t\tmakeDocument('/B', 'fish'),\n\t\t\tmakeDocument('/C', 'cat cat cat cat'),\n\t\t\tmakeDocument('/D', 'cat fish')\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat the dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/C', '/D']);\n\t\t}\n\t});\n\n\ttest('Should weigh chunks with less common terms higher', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/B', '/A']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B', '/B']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('cat the dog', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/B', '/A', '/B']);\n\t\t}\n\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', ['cat dog cat', 'fish']),\n\t\t\tmakeDocument('/B', ['cat cat cat cat dog', 'dog'])\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('lake fish', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A']);\n\t\t}\n\t});\n\n\ttest('Should ignore case and punctuation', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'Cat doG.cat'),\n\t\t\tmakeDocument('/B', 'cAt fiSH'),\n\t\t\tmakeDocument('/C', 'frOg'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('. ,CaT!  ', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should match on camelCase words', () => {\n\t\tfor (const docs of permutate([\n\t\t\tmakeDocument('/A', 'catDog cat'),\n\t\t\tmakeDocument('/B', 'fishCatFish'),\n\t\t\tmakeDocument('/C', 'frogcat'),\n\t\t])) {\n\t\t\tconst tfidf = new TfIdfCalculator().updateDocuments(docs);\n\t\t\tconst scores = tfidf.calculateScores('catDOG', CancellationToken.None);\n\t\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\t\t}\n\t});\n\n\ttest('Should not match document after delete', () => {\n\t\tconst docA = makeDocument('/A', 'cat dog cat');\n\t\tconst docB = makeDocument('/B', 'cat fish');\n\t\tconst docC = makeDocument('/C', 'frog');\n\n\t\tconst tfidf = new TfIdfCalculator().updateDocuments([docA, docB, docC]);\n\t\tlet scores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/A', '/B']);\n\n\t\ttfidf.deleteDocument(docA.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/B']);\n\n\t\ttfidf.deleteDocument(docC.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, ['/B']);\n\n\t\ttfidf.deleteDocument(docB.key);\n\t\tscores = tfidf.calculateScores('cat', CancellationToken.None);\n\t\tassertScoreOrdersEqual(scores, []);\n\t});\n});\n\nfunction makeDocument(key: string, content: string | string[]): TfIdfDocument {\n\treturn {\n\t\tkey,\n\t\ttextChunks: Array.isArray(content) ? content : [content],\n\t};\n}\n"]}