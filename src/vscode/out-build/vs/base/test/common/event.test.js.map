{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/base/test/common/event.test.ts","vs/base/test/common/event.test.ts"],"names":[],"mappings":"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","file":"event.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { stub } from 'sinon';\nimport { timeout } from '../../common/async.js';\nimport { CancellationToken } from '../../common/cancellation.js';\nimport { errorHandler, setUnexpectedErrorHandler } from '../../common/errors.js';\nimport { AsyncEmitter, DebounceEmitter, DynamicListEventMultiplexer, Emitter, Event, EventBufferer, EventMultiplexer, IWaitUntil, ListenerLeakError, ListenerRefusalError, MicrotaskEmitter, PauseableEmitter, Relay, createEventDeliveryQueue } from '../../common/event.js';\nimport { DisposableStore, IDisposable, isDisposable, setDisposableTracker, DisposableTracker } from '../../common/lifecycle.js';\nimport { observableValue, transaction } from '../../common/observable.js';\nimport { MicrotaskDelay } from '../../common/symbols.js';\nimport { runWithFakedTimers } from './timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from './utils.js';\nimport { tail } from '../../common/arrays.js';\n\nnamespace Samples {\n\n\texport class EventCounter {\n\n\t\tcount = 0;\n\n\t\treset() {\n\t\t\tthis.count = 0;\n\t\t}\n\n\t\tonEvent() {\n\t\t\tthis.count += 1;\n\t\t}\n\t}\n\n\texport class Document3 {\n\n\t\tprivate readonly _onDidChange = new Emitter<string>();\n\n\t\treadonly onDidChange: Event<string> = this._onDidChange.event;\n\n\t\tsetText(value: string) {\n\t\t\t//...\n\t\t\tthis._onDidChange.fire(value);\n\t\t}\n\n\t\tdispose() {\n\t\t\tthis._onDidChange.dispose();\n\t\t}\n\n\t}\n}\n\nsuite('Event utils dispose', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet tracker = new DisposableTracker();\n\n\tfunction assertDisposablesCount(expected: number | Array<IDisposable>) {\n\t\tif (Array.isArray(expected)) {\n\t\t\tconst instances = new Set(expected);\n\t\t\tconst actualInstances = tracker.getTrackedDisposables();\n\t\t\tassert.strictEqual(actualInstances.length, expected.length);\n\n\t\t\tfor (const item of actualInstances) {\n\t\t\t\tassert.ok(instances.has(item));\n\t\t\t}\n\n\t\t} else {\n\t\t\tassert.strictEqual(tracker.getTrackedDisposables().length, expected);\n\t\t}\n\n\t}\n\n\tsetup(() => {\n\t\ttracker = new DisposableTracker();\n\t\tsetDisposableTracker(tracker);\n\t});\n\n\tteardown(function () {\n\t\tsetDisposableTracker(null);\n\t});\n\n\ttest('no leak with snapshot-utils', function () {\n\n\t\tconst store = new DisposableStore();\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst evens = Event.filter(emitter.event, n => n % 2 === 0, store);\n\t\tassertDisposablesCount(1); // snaphot only listen when `evens` is being listened on\n\n\t\tlet all = 0;\n\t\tconst leaked = evens(n => all += n);\n\t\tassert.ok(isDisposable(leaked));\n\t\tassertDisposablesCount(3);\n\n\t\temitter.dispose();\n\t\tstore.dispose();\n\t\tassertDisposablesCount([leaked]); // leaked is still there\n\t});\n\n\ttest('no leak with debounce-util', function () {\n\t\tconst store = new DisposableStore();\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst debounced = Event.debounce(emitter.event, (l) => 0, undefined, undefined, undefined, undefined, store);\n\t\tassertDisposablesCount(1); // debounce only listens when `debounce` is being listened on\n\n\t\tlet all = 0;\n\t\tconst leaked = debounced(n => all += n);\n\t\tassert.ok(isDisposable(leaked));\n\t\tassertDisposablesCount(3);\n\n\t\temitter.dispose();\n\t\tstore.dispose();\n\n\t\tassertDisposablesCount([leaked]); // leaked is still there\n\t});\n});\n\nsuite('Event', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst counter = new Samples.EventCounter();\n\n\tsetup(() => counter.reset());\n\n\ttest('Emitter plain', function () {\n\n\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\tsubscription.dispose();\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('Emitter duplicate functions', () => {\n\t\tconst calls: string[] = [];\n\t\tconst a = (v: string) => calls.push(`a${v}`);\n\t\tconst b = (v: string) => calls.push(`b${v}`);\n\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(a));\n\t\tds.add(emitter.event(b));\n\t\tconst s2 = emitter.event(a);\n\n\t\temitter.fire('1');\n\t\tassert.deepStrictEqual(calls, ['a1', 'b1', 'a1']);\n\n\t\ts2.dispose();\n\t\tcalls.length = 0;\n\t\temitter.fire('2');\n\t\tassert.deepStrictEqual(calls, ['a2', 'b2']);\n\t});\n\n\ttest('Emitter, dispose listener during emission', () => {\n\t\tfor (let keepFirstMod = 1; keepFirstMod < 4; keepFirstMod++) {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst calls: number[] = [];\n\t\t\tconst disposables = Array.from({ length: 25 }, (_, n) => ds.add(emitter.event(() => {\n\t\t\t\tif (n % keepFirstMod === 0) {\n\t\t\t\t\tdisposables[n].dispose();\n\t\t\t\t}\n\t\t\t\tcalls.push(n);\n\t\t\t})));\n\n\t\t\temitter.fire();\n\t\t\tassert.deepStrictEqual(calls, Array.from({ length: 25 }, (_, n) => n));\n\t\t}\n\t});\n\n\ttest('Emitter, dispose emitter during emission', () => {\n\t\tconst emitter = ds.add(new Emitter<void>());\n\t\tconst calls: number[] = [];\n\t\tconst disposables = Array.from({ length: 25 }, (_, n) => ds.add(emitter.event(() => {\n\t\t\tif (n === 10) {\n\t\t\t\temitter.dispose();\n\t\t\t}\n\t\t\tcalls.push(n);\n\t\t})));\n\n\t\temitter.fire();\n\t\tdisposables.forEach(d => d.dispose());\n\t\tassert.deepStrictEqual(calls, Array.from({ length: 11 }, (_, n) => n));\n\t});\n\n\ttest('Emitter, shared delivery queue', () => {\n\t\tconst deliveryQueue = createEventDeliveryQueue();\n\t\tconst emitter1 = ds.add(new Emitter<number>({ deliveryQueue }));\n\t\tconst emitter2 = ds.add(new Emitter<number>({ deliveryQueue }));\n\n\t\tconst calls: string[] = [];\n\t\tds.add(emitter1.event(d => { calls.push(`${d}a`); if (d === 1) { emitter2.fire(2); } }));\n\t\tds.add(emitter1.event(d => { calls.push(`${d}b`); }));\n\n\t\tds.add(emitter2.event(d => { calls.push(`${d}c`); emitter1.dispose(); }));\n\t\tds.add(emitter2.event(d => { calls.push(`${d}d`); }));\n\n\t\temitter1.fire(1);\n\n\t\t// 1. Check that 2 is not delivered before 1 finishes\n\t\t// 2. Check that 2 finishes getting delivered even if one emitter is disposed\n\t\tassert.deepStrictEqual(calls, ['1a', '1b', '2c', '2d']);\n\t});\n\n\ttest('Emitter, handles removal during 3', () => {\n\t\tconst fn1 = stub();\n\t\tconst fn2 = stub();\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(fn1));\n\t\tconst h = emitter.event(() => {\n\t\t\th.dispose();\n\t\t});\n\t\tds.add(emitter.event(fn2));\n\t\temitter.fire('foo');\n\n\t\tassert.deepStrictEqual(fn2.args, [['foo']]);\n\t\tassert.deepStrictEqual(fn1.args, [['foo']]);\n\t});\n\n\ttest('Emitter, handles removal during 2', () => {\n\t\tconst fn1 = stub();\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(fn1));\n\t\tconst h = emitter.event(() => {\n\t\t\th.dispose();\n\t\t});\n\t\temitter.fire('foo');\n\n\t\tassert.deepStrictEqual(fn1.args, [['foo']]);\n\t});\n\n\ttest('Emitter, bucket', function () {\n\n\t\tconst bucket: IDisposable[] = [];\n\t\tconst doc = ds.add(new Samples.Document3());\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter, bucket);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\twhile (bucket.length) {\n\t\t\tbucket.pop()!.dispose();\n\t\t}\n\t\tdoc.setText('boo');\n\n\t\t// noop\n\t\tsubscription.dispose();\n\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('Emitter, store', function () {\n\n\t\tconst bucket = ds.add(new DisposableStore());\n\t\tconst doc = ds.add(new Samples.Document3());\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter, bucket);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\tbucket.clear();\n\t\tdoc.setText('boo');\n\n\t\t// noop\n\t\tsubscription.dispose();\n\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('onFirstAdd|onLastRemove', () => {\n\n\t\tlet firstCount = 0;\n\t\tlet lastCount = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonWillAddFirstListener() { firstCount += 1; },\n\t\t\tonDidRemoveLastListener() { lastCount += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(firstCount, 0);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tlet subscription1 = ds.add(a.event(function () { }));\n\t\tconst subscription2 = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tsubscription1.dispose();\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tsubscription2.dispose();\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 1);\n\n\t\tsubscription1 = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(firstCount, 2);\n\t\tassert.strictEqual(lastCount, 1);\n\t});\n\n\ttest('onDidAddListener', () => {\n\t\tlet count = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonDidAddListener() { count += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\tlet subscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 2);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 2);\n\t});\n\n\ttest('onWillRemoveListener', () => {\n\t\tlet count = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonWillRemoveListener() { count += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\tlet subscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 0);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 1);\n\t});\n\n\ttest('throwingListener', () => {\n\t\tconst origErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => null);\n\n\t\ttry {\n\t\t\tconst a = ds.add(new Emitter<undefined>());\n\t\t\tlet hit = false;\n\t\t\tds.add(a.event(function () {\n\t\t\t\t// eslint-disable-next-line no-throw-literal\n\t\t\t\tthrow 9;\n\t\t\t}));\n\t\t\tds.add(a.event(function () {\n\t\t\t\thit = true;\n\t\t\t}));\n\t\t\ta.fire(undefined);\n\t\t\tassert.strictEqual(hit, true);\n\n\t\t} finally {\n\t\t\tsetUnexpectedErrorHandler(origErrorHandler);\n\t\t}\n\t});\n\n\ttest('throwingListener (custom handler)', () => {\n\n\t\tconst allError: any[] = [];\n\n\t\tconst a = ds.add(new Emitter<undefined>({\n\t\t\tonListenerError(e) { allError.push(e); }\n\t\t}));\n\t\tlet hit = false;\n\t\tds.add(a.event(function () {\n\t\t\t// eslint-disable-next-line no-throw-literal\n\t\t\tthrow 9;\n\t\t}));\n\t\tds.add(a.event(function () {\n\t\t\thit = true;\n\t\t}));\n\t\ta.fire(undefined);\n\t\tassert.strictEqual(hit, true);\n\t\tassert.deepStrictEqual(allError, [9]);\n\n\t});\n\n\ttest('throw ListenerLeakError', () => {\n\n\t\tconst store = new DisposableStore();\n\t\tconst allError: any[] = [];\n\n\t\tconst a = ds.add(new Emitter<undefined>({\n\t\t\tonListenerError(e) { allError.push(e); },\n\t\t\tleakWarningThreshold: 3,\n\t\t}));\n\n\t\tfor (let i = 0; i < 11; i++) {\n\t\t\ta.event(() => { }, undefined, store);\n\t\t}\n\n\t\tassert.deepStrictEqual(allError.length, 5);\n\t\tconst [start, rest] = tail(allError);\n\t\tassert.ok(rest instanceof ListenerRefusalError);\n\n\t\tfor (const item of start) {\n\t\t\tassert.ok(item instanceof ListenerLeakError);\n\t\t}\n\n\t\tstore.dispose();\n\t});\n\n\ttest('reusing event function and context', function () {\n\t\tlet counter = 0;\n\t\tfunction listener() {\n\t\t\tcounter += 1;\n\t\t}\n\t\tconst context = {};\n\n\t\tconst emitter = ds.add(new Emitter<undefined>());\n\t\tconst reg1 = emitter.event(listener, context);\n\t\tconst reg2 = emitter.event(listener, context);\n\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 2);\n\n\t\treg1.dispose();\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 3);\n\n\t\treg2.dispose();\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 3);\n\t});\n\n\ttest('DebounceEmitter', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tlet callCount = 0;\n\t\t\tlet sum = 0;\n\t\t\tconst emitter = new DebounceEmitter<number>({\n\t\t\t\tmerge: arr => {\n\t\t\t\t\tcallCount += 1;\n\t\t\t\t\treturn arr.reduce((p, c) => p + c);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tds.add(emitter.event(e => { sum = e; }));\n\n\t\t\tconst p = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\n\t\t\tawait p;\n\n\t\t\tassert.strictEqual(callCount, 1);\n\t\t\tassert.strictEqual(sum, 3);\n\t\t});\n\t});\n\n\tsuite('Event.toPromise', () => {\n\t\tclass DisposableStoreWithSize extends DisposableStore {\n\t\t\tpublic size = 0;\n\t\t\tpublic override add<T extends IDisposable>(o: T): T {\n\t\t\t\tthis.size++;\n\t\t\t\treturn super.add(o);\n\t\t\t}\n\n\t\t\tpublic override delete<T extends IDisposable>(o: T): void {\n\t\t\t\tthis.size--;\n\t\t\t\treturn super.delete(o);\n\t\t\t}\n\t\t}\n\t\ttest('resolves on first event', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(42);\n\t\t\tconst result = await promise;\n\n\t\t\tassert.strictEqual(result, 42);\n\t\t});\n\n\t\ttest('disposes listener after resolution', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(1);\n\t\t\tawait promise;\n\n\t\t\t// Listener should be disposed, firing again should not affect anything\n\t\t\temitter.fire(2);\n\t\t\tassert.ok(true); // No errors\n\t\t});\n\n\t\ttest('adds to DisposableStore', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst store = ds.add(new DisposableStoreWithSize());\n\t\t\tconst promise = Event.toPromise(emitter.event, store);\n\n\t\t\tassert.strictEqual(store.size, 1);\n\n\t\t\temitter.fire(42);\n\t\t\tawait promise;\n\n\t\t\t// Should be removed from store after resolution\n\t\t\tassert.strictEqual(store.size, 0);\n\t\t});\n\n\t\ttest('adds to disposables array', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst disposables: IDisposable[] = [];\n\t\t\tconst promise = Event.toPromise(emitter.event, disposables);\n\n\t\t\tassert.strictEqual(disposables.length, 1);\n\n\t\t\temitter.fire(42);\n\t\t\tawait promise;\n\n\t\t\t// Should be removed from array after resolution\n\t\t\tassert.strictEqual(disposables.length, 0);\n\t\t});\n\n\t\ttest('cancel removes from DisposableStore', () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst store = ds.add(new DisposableStoreWithSize());\n\t\t\tconst promise = Event.toPromise(emitter.event, store);\n\n\t\t\tassert.strictEqual(store.size, 1);\n\n\t\t\tpromise.cancel();\n\n\t\t\t// Should be removed from store after cancellation\n\t\t\tassert.strictEqual(store.size, 0);\n\t\t});\n\n\t\ttest('cancel removes from disposables array', () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst disposables: IDisposable[] = [];\n\t\t\tconst promise = Event.toPromise(emitter.event, disposables);\n\n\t\t\tassert.strictEqual(disposables.length, 1);\n\n\t\t\tpromise.cancel();\n\n\t\t\t// Should be removed from array after cancellation\n\t\t\tassert.strictEqual(disposables.length, 0);\n\t\t});\n\n\t\ttest('cancel does not resolve promise', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\tpromise.cancel();\n\t\t\temitter.fire(42);\n\n\t\t\t// Promise should not resolve after cancellation\n\t\t\tlet resolved = false;\n\t\t\tpromise.then(() => resolved = true);\n\n\t\t\tawait timeout(10);\n\t\t\tassert.strictEqual(resolved, false);\n\t\t});\n\t});\n\n\ttest('Microtask Emitter', (done) => {\n\t\tlet count = 0;\n\t\tassert.strictEqual(count, 0);\n\t\tconst emitter = new MicrotaskEmitter<void>();\n\t\tconst listener = emitter.event(() => {\n\t\t\tcount++;\n\t\t});\n\t\temitter.fire();\n\t\tassert.strictEqual(count, 0);\n\t\temitter.fire();\n\t\tassert.strictEqual(count, 0);\n\t\t// Should wait until the event loop ends and therefore be the last thing called\n\t\tsetTimeout(() => {\n\t\t\tassert.strictEqual(count, 3);\n\t\t\tdone();\n\t\t}, 0);\n\t\tqueueMicrotask(() => {\n\t\t\tassert.strictEqual(count, 2);\n\t\t\tcount++;\n\t\t\tlistener.dispose();\n\t\t});\n\t});\n\n\ttest('Emitter - In Order Delivery', function () {\n\t\tconst a = ds.add(new Emitter<string>());\n\t\tconst listener2Events: string[] = [];\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e1') {\n\t\t\t\ta.fire('e2');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener2(event) {\n\t\t\tlistener2Events.push(event);\n\t\t}));\n\t\ta.fire('e1');\n\n\t\t// assert that all events are delivered in order\n\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2']);\n\t});\n\n\ttest('Emitter, - In Order Delivery 3x', function () {\n\t\tconst a = ds.add(new Emitter<string>());\n\t\tconst listener2Events: string[] = [];\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e2') {\n\t\t\t\ta.fire('e3');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e1') {\n\t\t\t\ta.fire('e2');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener2(event) {\n\t\t\tlistener2Events.push(event);\n\t\t}));\n\t\ta.fire('e1');\n\n\t\t// assert that all events are delivered in order\n\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t});\n});\n\nsuite('AsyncEmitter', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('event has waitUntil-function', async function () {\n\n\t\tinterface E extends IWaitUntil {\n\t\t\tfoo: boolean;\n\t\t\tbar: number;\n\t\t}\n\n\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\tds.add(emitter.event(e => {\n\t\t\tassert.strictEqual(e.foo, true);\n\t\t\tassert.strictEqual(e.bar, 1);\n\t\t\tassert.strictEqual(typeof e.waitUntil, 'function');\n\t\t}));\n\n\t\temitter.fireAsync({ foo: true, bar: 1, }, CancellationToken.None);\n\t\temitter.dispose();\n\t});\n\n\ttest('sequential delivery', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tinterface E extends IWaitUntil {\n\t\t\t\tfoo: boolean;\n\t\t\t}\n\n\t\t\tlet globalState = 0;\n\t\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(10).then(_ => {\n\t\t\t\t\tassert.strictEqual(globalState, 0);\n\t\t\t\t\tglobalState += 1;\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(1).then(_ => {\n\t\t\t\t\tassert.strictEqual(globalState, 1);\n\t\t\t\t\tglobalState += 1;\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\tawait emitter.fireAsync({ foo: true }, CancellationToken.None);\n\t\t\tassert.strictEqual(globalState, 2);\n\t\t});\n\t});\n\n\ttest('sequential, in-order delivery', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tinterface E extends IWaitUntil {\n\t\t\t\tfoo: number;\n\t\t\t}\n\t\t\tconst events: number[] = [];\n\t\t\tlet done = false;\n\t\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\t\t// e1\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(10).then(async _ => {\n\t\t\t\t\tif (e.foo === 1) {\n\t\t\t\t\t\tawait emitter.fireAsync({ foo: 2 }, CancellationToken.None);\n\t\t\t\t\t\tassert.deepStrictEqual(events, [1, 2]);\n\t\t\t\t\t\tdone = true;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\t// e2\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\tevents.push(e.foo);\n\t\t\t\te.waitUntil(timeout(7));\n\t\t\t}));\n\n\t\t\tawait emitter.fireAsync({ foo: 1 }, CancellationToken.None);\n\t\t\tassert.ok(done);\n\t\t});\n\t});\n\n\ttest('catch errors', async function () {\n\t\tconst origErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => null);\n\n\t\tinterface E extends IWaitUntil {\n\t\t\tfoo: boolean;\n\t\t}\n\n\t\tlet globalState = 0;\n\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\tds.add(emitter.event(e => {\n\t\t\tglobalState += 1;\n\t\t\te.waitUntil(new Promise((_r, reject) => reject(new Error())));\n\t\t}));\n\n\t\tds.add(emitter.event(e => {\n\t\t\tglobalState += 1;\n\t\t\te.waitUntil(timeout(10));\n\t\t\te.waitUntil(timeout(20).then(() => globalState++)); // multiple `waitUntil` are supported and awaited on\n\t\t}));\n\n\t\tawait emitter.fireAsync({ foo: true }, CancellationToken.None).then(() => {\n\t\t\tassert.strictEqual(globalState, 3);\n\t\t}).catch(e => {\n\t\t\tconsole.log(e);\n\t\t\tassert.ok(false);\n\t\t});\n\n\t\tsetUnexpectedErrorHandler(origErrorHandler);\n\t});\n});\n\nsuite('PausableEmitter', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('basic', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\t});\n\n\ttest('pause/resume - no merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\t\temitter.fire(5);\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4, 5]);\n\t});\n\n\ttest('pause/resume - merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>({ merge: (a) => a.reduce((p, c) => p + c, 0) }));\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 7]);\n\n\t\temitter.fire(5);\n\t\tassert.deepStrictEqual(data, [1, 2, 7, 5]);\n\t});\n\n\ttest('double pause/resume', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\t});\n\n\ttest('resume, no pause', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(data, [1, 2, 3]);\n\t});\n\n\ttest('nested pause', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tlet once = true;\n\t\tds.add(emitter.event(e => {\n\t\t\tdata.push(e);\n\n\t\t\tif (once) {\n\t\t\t\temitter.pause();\n\t\t\t\tonce = false;\n\t\t\t}\n\t\t}));\n\t\tds.add(emitter.event(e => {\n\t\t\tdata.push(e);\n\t\t}));\n\n\t\temitter.pause();\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, []);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 1]); // paused after first event\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 1, 2, 2]); // remaing event delivered\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(data, [1, 1, 2, 2, 3, 3]);\n\n\t});\n\n\ttest('empty pause with merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>({ merge: a => a[0] }));\n\t\tds.add(emitter.event(e => data.push(1)));\n\n\t\temitter.pause();\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, []);\n\t});\n\n});\n\nsuite('Event utils - ensureNoDisposablesAreLeakedInTestSuite', function () {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('fromObservable', function () {\n\n\t\tconst obs = observableValue('test', 12);\n\t\tconst event = Event.fromObservable(obs);\n\n\t\tconst values: number[] = [];\n\t\tconst d = event(n => { values.push(n); });\n\n\t\tobs.set(3, undefined);\n\t\tobs.set(13, undefined);\n\t\tobs.set(3, undefined);\n\t\tobs.set(33, undefined);\n\t\tobs.set(1, undefined);\n\n\t\ttransaction(tx => {\n\t\t\tobs.set(334, tx);\n\t\t\tobs.set(99, tx);\n\t\t});\n\n\t\tassert.deepStrictEqual(values, ([3, 13, 3, 33, 1, 99]));\n\t\td.dispose();\n\t});\n});\n\nsuite('Event utils', () => {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('EventBufferer', () => {\n\n\t\ttest('should not buffer when not wrapped', () => {\n\t\t\tconst bufferer = new EventBufferer();\n\t\t\tconst counter = new Samples.EventCounter();\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst event = bufferer.wrapEvent(emitter.event);\n\t\t\tconst listener = event(counter.onEvent, counter);\n\n\t\t\tassert.strictEqual(counter.count, 0);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 2);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 3);\n\n\t\t\tlistener.dispose();\n\t\t});\n\n\t\ttest('should buffer when wrapped', () => {\n\t\t\tconst bufferer = new EventBufferer();\n\t\t\tconst counter = new Samples.EventCounter();\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst event = bufferer.wrapEvent(emitter.event);\n\t\t\tconst listener = event(counter.onEvent, counter);\n\n\t\t\tassert.strictEqual(counter.count, 0);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 1);\n\n\t\t\tbufferer.bufferEvents(() => {\n\t\t\t\temitter.fire();\n\t\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\t\temitter.fire();\n\t\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\t});\n\n\t\t\tassert.strictEqual(counter.count, 3);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 4);\n\n\t\t\tlistener.dispose();\n\t\t});\n\n\t\ttest('once', () => {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\n\t\t\tlet counter1 = 0, counter2 = 0, counter3 = 0;\n\n\t\t\tconst listener1 = emitter.event(() => counter1++);\n\t\t\tconst listener2 = Event.once(emitter.event)(() => counter2++);\n\t\t\tconst listener3 = Event.once(emitter.event)(() => counter3++);\n\n\t\t\tassert.strictEqual(counter1, 0);\n\t\t\tassert.strictEqual(counter2, 0);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\tlistener3.dispose();\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter1, 1);\n\t\t\tassert.strictEqual(counter2, 1);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter1, 2);\n\t\t\tassert.strictEqual(counter2, 1);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\tlistener1.dispose();\n\t\t\tlistener2.dispose();\n\t\t});\n\t});\n\n\tsuite('buffer', () => {\n\n\t\ttest('should buffer events', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tconst listener = bufferedEvent(num => result.push(num));\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\temitter.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\n\t\t\tlistener.dispose();\n\t\t\temitter.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t});\n\n\t\ttest('should buffer events on next tick', async () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event, true);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tconst listener = bufferedEvent(num => result.push(num));\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\tawait timeout(10);\n\t\t\temitter.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t\tlistener.dispose();\n\t\t\temitter.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t});\n\n\t\ttest('should fire initial buffer events', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event, false, [-2, -1, 0]);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tds.add(bufferedEvent(num => result.push(num)));\n\t\t\tassert.deepStrictEqual(result, [-2, -1, 0, 1, 2, 3]);\n\t\t});\n\t});\n\n\tsuite('EventMultiplexer', () => {\n\n\t\ttest('works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('multiplexer dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\tm.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('event dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('mutliplexer event dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst l1 = m.add(e1.event);\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\tl1.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('hot start works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('cold start works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('late add works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\t\t\te3.fire(3);\n\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('add dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tconst l3 = m.add(e3.event);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\tl3.dispose();\n\t\t\te3.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\te2.fire(4);\n\t\t\te1.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4, 5]);\n\t\t});\n\t});\n\n\tsuite('DynamicListEventMultiplexer', () => {\n\t\tlet addEmitter: Emitter<TestItem>;\n\t\tlet removeEmitter: Emitter<TestItem>;\n\t\tconst recordedEvents: number[] = [];\n\t\tclass TestItem {\n\t\t\treadonly onTestEventEmitter = ds.add(new Emitter<number>());\n\t\t\treadonly onTestEvent = this.onTestEventEmitter.event;\n\t\t}\n\t\tlet items: TestItem[];\n\t\tlet m: DynamicListEventMultiplexer<TestItem, number>;\n\t\tsetup(() => {\n\t\t\taddEmitter = ds.add(new Emitter<TestItem>());\n\t\t\tremoveEmitter = ds.add(new Emitter<TestItem>());\n\t\t\titems = [new TestItem(), new TestItem()];\n\t\t\tfor (const [i, item] of items.entries()) {\n\t\t\t\tds.add(item.onTestEvent(e => `${i}:${e}`));\n\t\t\t}\n\t\t\tm = new DynamicListEventMultiplexer(items, addEmitter.event, removeEmitter.event, e => e.onTestEvent);\n\t\t\tds.add(m.event(e => recordedEvents.push(e)));\n\t\t\trecordedEvents.length = 0;\n\t\t});\n\t\tteardown(() => m.dispose());\n\t\ttest('should fire events for initial items', () => {\n\t\t\titems[0].onTestEventEmitter.fire(1);\n\t\t\titems[1].onTestEventEmitter.fire(2);\n\t\t\titems[0].onTestEventEmitter.fire(3);\n\t\t\titems[1].onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [1, 2, 3, 4]);\n\t\t});\n\t\ttest('should fire events for added items', () => {\n\t\t\tconst addedItem = new TestItem();\n\t\t\taddEmitter.fire(addedItem);\n\t\t\taddedItem.onTestEventEmitter.fire(1);\n\t\t\titems[0].onTestEventEmitter.fire(2);\n\t\t\titems[1].onTestEventEmitter.fire(3);\n\t\t\taddedItem.onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [1, 2, 3, 4]);\n\t\t});\n\t\ttest('should not fire events for removed items', () => {\n\t\t\tremoveEmitter.fire(items[0]);\n\t\t\titems[0].onTestEventEmitter.fire(1);\n\t\t\titems[1].onTestEventEmitter.fire(2);\n\t\t\titems[0].onTestEventEmitter.fire(3);\n\t\t\titems[1].onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [2, 4]);\n\t\t});\n\t});\n\n\ttest('latch', () => {\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst event = Event.latch(emitter.event);\n\n\t\tconst result: number[] = [];\n\t\tconst listener = ds.add(event(num => result.push(num)));\n\n\t\tassert.deepStrictEqual(result, []);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1]);\n\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(result, [1, 2]);\n\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(result, [1, 2]);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1, 2, 1]);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1, 2, 1]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\tlistener.dispose();\n\t});\n\n\ttest('dispose is reentrant', () => {\n\t\tconst emitter = ds.add(new Emitter<number>({\n\t\t\tonDidRemoveLastListener: () => {\n\t\t\t\temitter.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tconst listener = emitter.event(() => undefined);\n\t\tlistener.dispose(); // should not crash\n\t});\n\n\tsuite('Relay', () => {\n\t\ttest('should input work', () => {\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tconst relay = new Relay<number>();\n\n\t\t\tconst result: number[] = [];\n\t\t\tconst listener = (num: number) => result.push(num);\n\t\t\tconst subscription = relay.event(listener);\n\n\t\t\te1.fire(1);\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\trelay.input = e1.event;\n\t\t\te1.fire(2);\n\t\t\tassert.deepStrictEqual(result, [2]);\n\n\t\t\trelay.input = e2.event;\n\t\t\te1.fire(3);\n\t\t\te2.fire(4);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\n\t\t\tsubscription.dispose();\n\t\t\te1.fire(5);\n\t\t\te2.fire(6);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\t\t});\n\n\t\ttest('should Relay dispose work', () => {\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tconst relay = new Relay<number>();\n\n\t\t\tconst result: number[] = [];\n\t\t\tconst listener = (num: number) => result.push(num);\n\t\t\tds.add(relay.event(listener));\n\n\t\t\te1.fire(1);\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\trelay.input = e1.event;\n\t\t\te1.fire(2);\n\t\t\tassert.deepStrictEqual(result, [2]);\n\n\t\t\trelay.input = e2.event;\n\t\t\te1.fire(3);\n\t\t\te2.fire(4);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\n\t\t\trelay.dispose();\n\t\t\te1.fire(5);\n\t\t\te2.fire(6);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\t\t});\n\t});\n\n\tsuite('accumulate', () => {\n\t\ttest('should not fire after a listener is disposed with undefined or []', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst calls1: number[][] = [];\n\t\t\tconst calls2: number[][] = [];\n\t\t\tconst listener1 = ds.add(accumulated((e) => calls1.push(e)));\n\t\t\tds.add(accumulated((e) => calls2.push(e)));\n\n\t\t\teventEmitter.fire(1);\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls1, [[1]]);\n\t\t\tassert.deepStrictEqual(calls2, [[1]]);\n\n\t\t\tlistener1.dispose();\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls1, [[1]]);\n\t\t\tassert.deepStrictEqual(calls2, [[1]], 'should not fire after a listener is disposed with undefined or []');\n\t\t});\n\t\ttest('should accumulate a single event', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst results1 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(1);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results1, [1]);\n\n\t\t\tconst results2 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(2);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results2, [2]);\n\t\t});\n\t\ttest('should accumulate multiple events', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst results1 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(1);\n\t\t\t\teventEmitter.fire(2);\n\t\t\t\teventEmitter.fire(3);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results1, [1, 2, 3]);\n\n\t\t\tconst results2 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(4);\n\t\t\t\teventEmitter.fire(5);\n\t\t\t\teventEmitter.fire(6);\n\t\t\t\teventEmitter.fire(7);\n\t\t\t\teventEmitter.fire(8);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results2, [4, 5, 6, 7, 8]);\n\t\t});\n\t});\n\n\tsuite('debounce', () => {\n\t\ttest('simple', function (done: () => void) {\n\t\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\t\tconst onDocDidChange = Event.debounce(doc.onDidChange, (prev: string[] | undefined, cur) => {\n\t\t\t\tif (!prev) {\n\t\t\t\t\tprev = [cur];\n\t\t\t\t} else if (prev.indexOf(cur) < 0) {\n\t\t\t\t\tprev.push(cur);\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, 10);\n\n\t\t\tlet count = 0;\n\n\t\t\tds.add(onDocDidChange(keys => {\n\t\t\t\tcount++;\n\t\t\t\tassert.ok(keys, 'was not expecting keys.');\n\t\t\t\tif (count === 1) {\n\t\t\t\t\tdoc.setText('4');\n\t\t\t\t\tassert.deepStrictEqual(keys, ['1', '2', '3']);\n\t\t\t\t} else if (count === 2) {\n\t\t\t\t\tassert.deepStrictEqual(keys, ['4']);\n\t\t\t\t\tdone();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tdoc.setText('1');\n\t\t\tdoc.setText('2');\n\t\t\tdoc.setText('3');\n\t\t});\n\n\n\t\ttest('microtask', function (done: () => void) {\n\t\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\t\tconst onDocDidChange = Event.debounce(doc.onDidChange, (prev: string[] | undefined, cur) => {\n\t\t\t\tif (!prev) {\n\t\t\t\t\tprev = [cur];\n\t\t\t\t} else if (prev.indexOf(cur) < 0) {\n\t\t\t\t\tprev.push(cur);\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, MicrotaskDelay);\n\n\t\t\tlet count = 0;\n\n\t\t\tds.add(onDocDidChange(keys => {\n\t\t\t\tcount++;\n\t\t\t\tassert.ok(keys, 'was not expecting keys.');\n\t\t\t\tif (count === 1) {\n\t\t\t\t\tdoc.setText('4');\n\t\t\t\t\tassert.deepStrictEqual(keys, ['1', '2', '3']);\n\t\t\t\t} else if (count === 2) {\n\t\t\t\t\tassert.deepStrictEqual(keys, ['4']);\n\t\t\t\t\tdone();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tdoc.setText('1');\n\t\t\tdoc.setText('2');\n\t\t\tdoc.setText('3');\n\t\t});\n\n\n\t\ttest('leading', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => e, 0, /*leading=*/true);\n\n\t\t\tlet calls = 0;\n\t\t\tds.add(debounced(() => {\n\t\t\t\tcalls++;\n\t\t\t}));\n\n\t\t\t// If the source event is fired once, the debounced (on the leading edge) event should be fired only once\n\t\t\temitter.fire();\n\n\t\t\tawait timeout(1);\n\t\t\tassert.strictEqual(calls, 1);\n\t\t});\n\n\t\ttest('leading (2)', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => e, 0, /*leading=*/true);\n\n\t\t\tlet calls = 0;\n\t\t\tds.add(debounced(() => {\n\t\t\t\tcalls++;\n\t\t\t}));\n\n\t\t\t// If the source event is fired multiple times, the debounced (on the leading edge) event should be fired twice\n\t\t\temitter.fire();\n\t\t\temitter.fire();\n\t\t\temitter.fire();\n\t\t\tawait timeout(1);\n\t\t\tassert.strictEqual(calls, 2);\n\t\t});\n\n\t\ttest('leading reset', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0, /*leading=*/true);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1, 1]);\n\t\t});\n\n\t\ttest('should not flush events when a listener is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tconst listener = ds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\tlistener.dispose();\n\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, []);\n\t\t});\n\n\t\ttest('flushOnListenerRemove - should flush events when a listener is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0, undefined, true);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tconst listener = ds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\tlistener.dispose();\n\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1], 'should fire with the first event, not the second (after listener dispose)');\n\t\t});\n\n\t\ttest('should flush events when the emitter is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\temitter.dispose();\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1]);\n\t\t});\n\t});\n\n\ttest('issue #230401', () => {\n\t\tlet count = 0;\n\t\tconst emitter = ds.add(new Emitter<void>());\n\t\tconst disposables = ds.add(new DisposableStore());\n\t\tds.add(emitter.event(() => {\n\t\t\tcount++;\n\t\t\tdisposables.add(emitter.event(() => {\n\t\t\t\tcount++;\n\t\t\t}));\n\t\t\tdisposables.add(emitter.event(() => {\n\t\t\t\tcount++;\n\t\t\t}));\n\t\t\tdisposables.clear();\n\t\t}));\n\t\tds.add(emitter.event(() => {\n\t\t\tcount++;\n\t\t}));\n\t\temitter.fire();\n\t\tassert.deepStrictEqual(count, 2);\n\t});\n\n\tsuite('chain2', () => {\n\t\tlet em: Emitter<number>;\n\t\tlet calls: number[];\n\n\t\tsetup(() => {\n\t\t\tem = ds.add(new Emitter<number>());\n\t\t\tcalls = [];\n\t\t});\n\n\t\ttest('maps', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.map(v => v * 2));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tassert.deepStrictEqual(calls, [2, 4, 6]);\n\t\t});\n\n\t\ttest('filters', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.filter(v => v % 2 === 0));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tassert.deepStrictEqual(calls, [2, 4]);\n\t\t});\n\n\t\ttest('reduces', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.reduce((acc, v) => acc + v, 0));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tassert.deepStrictEqual(calls, [1, 3, 6, 10]);\n\t\t});\n\n\t\ttest('latches', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.latch());\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(3);\n\t\t\tem.fire(1);\n\t\t\tassert.deepStrictEqual(calls, [1, 2, 3, 1]);\n\t\t});\n\n\t\ttest('does everything', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $\n\t\t\t\t.filter(v => v % 2 === 0)\n\t\t\t\t.map(v => v * 2)\n\t\t\t\t.reduce((acc, v) => acc + v, 0)\n\t\t\t\t.latch()\n\t\t\t);\n\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tem.fire(0);\n\t\t\tassert.deepStrictEqual(calls, [4, 12]);\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { stub } from 'sinon';\nimport { timeout } from '../../common/async.js';\nimport { CancellationToken } from '../../common/cancellation.js';\nimport { errorHandler, setUnexpectedErrorHandler } from '../../common/errors.js';\nimport { AsyncEmitter, DebounceEmitter, DynamicListEventMultiplexer, Emitter, Event, EventBufferer, EventMultiplexer, IWaitUntil, ListenerLeakError, ListenerRefusalError, MicrotaskEmitter, PauseableEmitter, Relay, createEventDeliveryQueue } from '../../common/event.js';\nimport { DisposableStore, IDisposable, isDisposable, setDisposableTracker, DisposableTracker } from '../../common/lifecycle.js';\nimport { observableValue, transaction } from '../../common/observable.js';\nimport { MicrotaskDelay } from '../../common/symbols.js';\nimport { runWithFakedTimers } from './timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from './utils.js';\nimport { tail } from '../../common/arrays.js';\n\nnamespace Samples {\n\n\texport class EventCounter {\n\n\t\tcount = 0;\n\n\t\treset() {\n\t\t\tthis.count = 0;\n\t\t}\n\n\t\tonEvent() {\n\t\t\tthis.count += 1;\n\t\t}\n\t}\n\n\texport class Document3 {\n\n\t\tprivate readonly _onDidChange = new Emitter<string>();\n\n\t\treadonly onDidChange: Event<string> = this._onDidChange.event;\n\n\t\tsetText(value: string) {\n\t\t\t//...\n\t\t\tthis._onDidChange.fire(value);\n\t\t}\n\n\t\tdispose() {\n\t\t\tthis._onDidChange.dispose();\n\t\t}\n\n\t}\n}\n\nsuite('Event utils dispose', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet tracker = new DisposableTracker();\n\n\tfunction assertDisposablesCount(expected: number | Array<IDisposable>) {\n\t\tif (Array.isArray(expected)) {\n\t\t\tconst instances = new Set(expected);\n\t\t\tconst actualInstances = tracker.getTrackedDisposables();\n\t\t\tassert.strictEqual(actualInstances.length, expected.length);\n\n\t\t\tfor (const item of actualInstances) {\n\t\t\t\tassert.ok(instances.has(item));\n\t\t\t}\n\n\t\t} else {\n\t\t\tassert.strictEqual(tracker.getTrackedDisposables().length, expected);\n\t\t}\n\n\t}\n\n\tsetup(() => {\n\t\ttracker = new DisposableTracker();\n\t\tsetDisposableTracker(tracker);\n\t});\n\n\tteardown(function () {\n\t\tsetDisposableTracker(null);\n\t});\n\n\ttest('no leak with snapshot-utils', function () {\n\n\t\tconst store = new DisposableStore();\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst evens = Event.filter(emitter.event, n => n % 2 === 0, store);\n\t\tassertDisposablesCount(1); // snaphot only listen when `evens` is being listened on\n\n\t\tlet all = 0;\n\t\tconst leaked = evens(n => all += n);\n\t\tassert.ok(isDisposable(leaked));\n\t\tassertDisposablesCount(3);\n\n\t\temitter.dispose();\n\t\tstore.dispose();\n\t\tassertDisposablesCount([leaked]); // leaked is still there\n\t});\n\n\ttest('no leak with debounce-util', function () {\n\t\tconst store = new DisposableStore();\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst debounced = Event.debounce(emitter.event, (l) => 0, undefined, undefined, undefined, undefined, store);\n\t\tassertDisposablesCount(1); // debounce only listens when `debounce` is being listened on\n\n\t\tlet all = 0;\n\t\tconst leaked = debounced(n => all += n);\n\t\tassert.ok(isDisposable(leaked));\n\t\tassertDisposablesCount(3);\n\n\t\temitter.dispose();\n\t\tstore.dispose();\n\n\t\tassertDisposablesCount([leaked]); // leaked is still there\n\t});\n});\n\nsuite('Event', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tconst counter = new Samples.EventCounter();\n\n\tsetup(() => counter.reset());\n\n\ttest('Emitter plain', function () {\n\n\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\tsubscription.dispose();\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('Emitter duplicate functions', () => {\n\t\tconst calls: string[] = [];\n\t\tconst a = (v: string) => calls.push(`a${v}`);\n\t\tconst b = (v: string) => calls.push(`b${v}`);\n\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(a));\n\t\tds.add(emitter.event(b));\n\t\tconst s2 = emitter.event(a);\n\n\t\temitter.fire('1');\n\t\tassert.deepStrictEqual(calls, ['a1', 'b1', 'a1']);\n\n\t\ts2.dispose();\n\t\tcalls.length = 0;\n\t\temitter.fire('2');\n\t\tassert.deepStrictEqual(calls, ['a2', 'b2']);\n\t});\n\n\ttest('Emitter, dispose listener during emission', () => {\n\t\tfor (let keepFirstMod = 1; keepFirstMod < 4; keepFirstMod++) {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst calls: number[] = [];\n\t\t\tconst disposables = Array.from({ length: 25 }, (_, n) => ds.add(emitter.event(() => {\n\t\t\t\tif (n % keepFirstMod === 0) {\n\t\t\t\t\tdisposables[n].dispose();\n\t\t\t\t}\n\t\t\t\tcalls.push(n);\n\t\t\t})));\n\n\t\t\temitter.fire();\n\t\t\tassert.deepStrictEqual(calls, Array.from({ length: 25 }, (_, n) => n));\n\t\t}\n\t});\n\n\ttest('Emitter, dispose emitter during emission', () => {\n\t\tconst emitter = ds.add(new Emitter<void>());\n\t\tconst calls: number[] = [];\n\t\tconst disposables = Array.from({ length: 25 }, (_, n) => ds.add(emitter.event(() => {\n\t\t\tif (n === 10) {\n\t\t\t\temitter.dispose();\n\t\t\t}\n\t\t\tcalls.push(n);\n\t\t})));\n\n\t\temitter.fire();\n\t\tdisposables.forEach(d => d.dispose());\n\t\tassert.deepStrictEqual(calls, Array.from({ length: 11 }, (_, n) => n));\n\t});\n\n\ttest('Emitter, shared delivery queue', () => {\n\t\tconst deliveryQueue = createEventDeliveryQueue();\n\t\tconst emitter1 = ds.add(new Emitter<number>({ deliveryQueue }));\n\t\tconst emitter2 = ds.add(new Emitter<number>({ deliveryQueue }));\n\n\t\tconst calls: string[] = [];\n\t\tds.add(emitter1.event(d => { calls.push(`${d}a`); if (d === 1) { emitter2.fire(2); } }));\n\t\tds.add(emitter1.event(d => { calls.push(`${d}b`); }));\n\n\t\tds.add(emitter2.event(d => { calls.push(`${d}c`); emitter1.dispose(); }));\n\t\tds.add(emitter2.event(d => { calls.push(`${d}d`); }));\n\n\t\temitter1.fire(1);\n\n\t\t// 1. Check that 2 is not delivered before 1 finishes\n\t\t// 2. Check that 2 finishes getting delivered even if one emitter is disposed\n\t\tassert.deepStrictEqual(calls, ['1a', '1b', '2c', '2d']);\n\t});\n\n\ttest('Emitter, handles removal during 3', () => {\n\t\tconst fn1 = stub();\n\t\tconst fn2 = stub();\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(fn1));\n\t\tconst h = emitter.event(() => {\n\t\t\th.dispose();\n\t\t});\n\t\tds.add(emitter.event(fn2));\n\t\temitter.fire('foo');\n\n\t\tassert.deepStrictEqual(fn2.args, [['foo']]);\n\t\tassert.deepStrictEqual(fn1.args, [['foo']]);\n\t});\n\n\ttest('Emitter, handles removal during 2', () => {\n\t\tconst fn1 = stub();\n\t\tconst emitter = ds.add(new Emitter<string>());\n\n\t\tds.add(emitter.event(fn1));\n\t\tconst h = emitter.event(() => {\n\t\t\th.dispose();\n\t\t});\n\t\temitter.fire('foo');\n\n\t\tassert.deepStrictEqual(fn1.args, [['foo']]);\n\t});\n\n\ttest('Emitter, bucket', function () {\n\n\t\tconst bucket: IDisposable[] = [];\n\t\tconst doc = ds.add(new Samples.Document3());\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter, bucket);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\twhile (bucket.length) {\n\t\t\tbucket.pop()!.dispose();\n\t\t}\n\t\tdoc.setText('boo');\n\n\t\t// noop\n\t\tsubscription.dispose();\n\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('Emitter, store', function () {\n\n\t\tconst bucket = ds.add(new DisposableStore());\n\t\tconst doc = ds.add(new Samples.Document3());\n\t\tconst subscription = doc.onDidChange(counter.onEvent, counter, bucket);\n\n\t\tdoc.setText('far');\n\t\tdoc.setText('boo');\n\n\t\t// unhook listener\n\t\tbucket.clear();\n\t\tdoc.setText('boo');\n\n\t\t// noop\n\t\tsubscription.dispose();\n\n\t\tdoc.setText('boo');\n\t\tassert.strictEqual(counter.count, 2);\n\t});\n\n\ttest('onFirstAdd|onLastRemove', () => {\n\n\t\tlet firstCount = 0;\n\t\tlet lastCount = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonWillAddFirstListener() { firstCount += 1; },\n\t\t\tonDidRemoveLastListener() { lastCount += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(firstCount, 0);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tlet subscription1 = ds.add(a.event(function () { }));\n\t\tconst subscription2 = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tsubscription1.dispose();\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 0);\n\n\t\tsubscription2.dispose();\n\t\tassert.strictEqual(firstCount, 1);\n\t\tassert.strictEqual(lastCount, 1);\n\n\t\tsubscription1 = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(firstCount, 2);\n\t\tassert.strictEqual(lastCount, 1);\n\t});\n\n\ttest('onDidAddListener', () => {\n\t\tlet count = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonDidAddListener() { count += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\tlet subscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 2);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 2);\n\t});\n\n\ttest('onWillRemoveListener', () => {\n\t\tlet count = 0;\n\t\tconst a = ds.add(new Emitter({\n\t\t\tonWillRemoveListener() { count += 1; }\n\t\t}));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\tlet subscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 0);\n\n\t\tsubscription.dispose();\n\t\tassert.strictEqual(count, 1);\n\n\t\tsubscription = ds.add(a.event(function () { }));\n\t\tassert.strictEqual(count, 1);\n\t});\n\n\ttest('throwingListener', () => {\n\t\tconst origErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => null);\n\n\t\ttry {\n\t\t\tconst a = ds.add(new Emitter<undefined>());\n\t\t\tlet hit = false;\n\t\t\tds.add(a.event(function () {\n\t\t\t\t// eslint-disable-next-line no-throw-literal\n\t\t\t\tthrow 9;\n\t\t\t}));\n\t\t\tds.add(a.event(function () {\n\t\t\t\thit = true;\n\t\t\t}));\n\t\t\ta.fire(undefined);\n\t\t\tassert.strictEqual(hit, true);\n\n\t\t} finally {\n\t\t\tsetUnexpectedErrorHandler(origErrorHandler);\n\t\t}\n\t});\n\n\ttest('throwingListener (custom handler)', () => {\n\n\t\tconst allError: any[] = [];\n\n\t\tconst a = ds.add(new Emitter<undefined>({\n\t\t\tonListenerError(e) { allError.push(e); }\n\t\t}));\n\t\tlet hit = false;\n\t\tds.add(a.event(function () {\n\t\t\t// eslint-disable-next-line no-throw-literal\n\t\t\tthrow 9;\n\t\t}));\n\t\tds.add(a.event(function () {\n\t\t\thit = true;\n\t\t}));\n\t\ta.fire(undefined);\n\t\tassert.strictEqual(hit, true);\n\t\tassert.deepStrictEqual(allError, [9]);\n\n\t});\n\n\ttest('throw ListenerLeakError', () => {\n\n\t\tconst store = new DisposableStore();\n\t\tconst allError: any[] = [];\n\n\t\tconst a = ds.add(new Emitter<undefined>({\n\t\t\tonListenerError(e) { allError.push(e); },\n\t\t\tleakWarningThreshold: 3,\n\t\t}));\n\n\t\tfor (let i = 0; i < 11; i++) {\n\t\t\ta.event(() => { }, undefined, store);\n\t\t}\n\n\t\tassert.deepStrictEqual(allError.length, 5);\n\t\tconst [start, rest] = tail(allError);\n\t\tassert.ok(rest instanceof ListenerRefusalError);\n\n\t\tfor (const item of start) {\n\t\t\tassert.ok(item instanceof ListenerLeakError);\n\t\t}\n\n\t\tstore.dispose();\n\t});\n\n\ttest('reusing event function and context', function () {\n\t\tlet counter = 0;\n\t\tfunction listener() {\n\t\t\tcounter += 1;\n\t\t}\n\t\tconst context = {};\n\n\t\tconst emitter = ds.add(new Emitter<undefined>());\n\t\tconst reg1 = emitter.event(listener, context);\n\t\tconst reg2 = emitter.event(listener, context);\n\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 2);\n\n\t\treg1.dispose();\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 3);\n\n\t\treg2.dispose();\n\t\temitter.fire(undefined);\n\t\tassert.strictEqual(counter, 3);\n\t});\n\n\ttest('DebounceEmitter', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tlet callCount = 0;\n\t\t\tlet sum = 0;\n\t\t\tconst emitter = new DebounceEmitter<number>({\n\t\t\t\tmerge: arr => {\n\t\t\t\t\tcallCount += 1;\n\t\t\t\t\treturn arr.reduce((p, c) => p + c);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tds.add(emitter.event(e => { sum = e; }));\n\n\t\t\tconst p = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\n\t\t\tawait p;\n\n\t\t\tassert.strictEqual(callCount, 1);\n\t\t\tassert.strictEqual(sum, 3);\n\t\t});\n\t});\n\n\tsuite('Event.toPromise', () => {\n\t\tclass DisposableStoreWithSize extends DisposableStore {\n\t\t\tpublic size = 0;\n\t\t\tpublic override add<T extends IDisposable>(o: T): T {\n\t\t\t\tthis.size++;\n\t\t\t\treturn super.add(o);\n\t\t\t}\n\n\t\t\tpublic override delete<T extends IDisposable>(o: T): void {\n\t\t\t\tthis.size--;\n\t\t\t\treturn super.delete(o);\n\t\t\t}\n\t\t}\n\t\ttest('resolves on first event', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(42);\n\t\t\tconst result = await promise;\n\n\t\t\tassert.strictEqual(result, 42);\n\t\t});\n\n\t\ttest('disposes listener after resolution', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\temitter.fire(1);\n\t\t\tawait promise;\n\n\t\t\t// Listener should be disposed, firing again should not affect anything\n\t\t\temitter.fire(2);\n\t\t\tassert.ok(true); // No errors\n\t\t});\n\n\t\ttest('adds to DisposableStore', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst store = ds.add(new DisposableStoreWithSize());\n\t\t\tconst promise = Event.toPromise(emitter.event, store);\n\n\t\t\tassert.strictEqual(store.size, 1);\n\n\t\t\temitter.fire(42);\n\t\t\tawait promise;\n\n\t\t\t// Should be removed from store after resolution\n\t\t\tassert.strictEqual(store.size, 0);\n\t\t});\n\n\t\ttest('adds to disposables array', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst disposables: IDisposable[] = [];\n\t\t\tconst promise = Event.toPromise(emitter.event, disposables);\n\n\t\t\tassert.strictEqual(disposables.length, 1);\n\n\t\t\temitter.fire(42);\n\t\t\tawait promise;\n\n\t\t\t// Should be removed from array after resolution\n\t\t\tassert.strictEqual(disposables.length, 0);\n\t\t});\n\n\t\ttest('cancel removes from DisposableStore', () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst store = ds.add(new DisposableStoreWithSize());\n\t\t\tconst promise = Event.toPromise(emitter.event, store);\n\n\t\t\tassert.strictEqual(store.size, 1);\n\n\t\t\tpromise.cancel();\n\n\t\t\t// Should be removed from store after cancellation\n\t\t\tassert.strictEqual(store.size, 0);\n\t\t});\n\n\t\ttest('cancel removes from disposables array', () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst disposables: IDisposable[] = [];\n\t\t\tconst promise = Event.toPromise(emitter.event, disposables);\n\n\t\t\tassert.strictEqual(disposables.length, 1);\n\n\t\t\tpromise.cancel();\n\n\t\t\t// Should be removed from array after cancellation\n\t\t\tassert.strictEqual(disposables.length, 0);\n\t\t});\n\n\t\ttest('cancel does not resolve promise', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst promise = Event.toPromise(emitter.event);\n\n\t\t\tpromise.cancel();\n\t\t\temitter.fire(42);\n\n\t\t\t// Promise should not resolve after cancellation\n\t\t\tlet resolved = false;\n\t\t\tpromise.then(() => resolved = true);\n\n\t\t\tawait timeout(10);\n\t\t\tassert.strictEqual(resolved, false);\n\t\t});\n\t});\n\n\ttest('Microtask Emitter', (done) => {\n\t\tlet count = 0;\n\t\tassert.strictEqual(count, 0);\n\t\tconst emitter = new MicrotaskEmitter<void>();\n\t\tconst listener = emitter.event(() => {\n\t\t\tcount++;\n\t\t});\n\t\temitter.fire();\n\t\tassert.strictEqual(count, 0);\n\t\temitter.fire();\n\t\tassert.strictEqual(count, 0);\n\t\t// Should wait until the event loop ends and therefore be the last thing called\n\t\tsetTimeout(() => {\n\t\t\tassert.strictEqual(count, 3);\n\t\t\tdone();\n\t\t}, 0);\n\t\tqueueMicrotask(() => {\n\t\t\tassert.strictEqual(count, 2);\n\t\t\tcount++;\n\t\t\tlistener.dispose();\n\t\t});\n\t});\n\n\ttest('Emitter - In Order Delivery', function () {\n\t\tconst a = ds.add(new Emitter<string>());\n\t\tconst listener2Events: string[] = [];\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e1') {\n\t\t\t\ta.fire('e2');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener2(event) {\n\t\t\tlistener2Events.push(event);\n\t\t}));\n\t\ta.fire('e1');\n\n\t\t// assert that all events are delivered in order\n\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2']);\n\t});\n\n\ttest('Emitter, - In Order Delivery 3x', function () {\n\t\tconst a = ds.add(new Emitter<string>());\n\t\tconst listener2Events: string[] = [];\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e2') {\n\t\t\t\ta.fire('e3');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener1(event) {\n\t\t\tif (event === 'e1') {\n\t\t\t\ta.fire('e2');\n\t\t\t\t// assert that all events are delivered at this point\n\t\t\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t\t\t}\n\t\t}));\n\t\tds.add(a.event(function listener2(event) {\n\t\t\tlistener2Events.push(event);\n\t\t}));\n\t\ta.fire('e1');\n\n\t\t// assert that all events are delivered in order\n\t\tassert.deepStrictEqual(listener2Events, ['e1', 'e2', 'e3']);\n\t});\n});\n\nsuite('AsyncEmitter', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('event has waitUntil-function', async function () {\n\n\t\tinterface E extends IWaitUntil {\n\t\t\tfoo: boolean;\n\t\t\tbar: number;\n\t\t}\n\n\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\tds.add(emitter.event(e => {\n\t\t\tassert.strictEqual(e.foo, true);\n\t\t\tassert.strictEqual(e.bar, 1);\n\t\t\tassert.strictEqual(typeof e.waitUntil, 'function');\n\t\t}));\n\n\t\temitter.fireAsync({ foo: true, bar: 1, }, CancellationToken.None);\n\t\temitter.dispose();\n\t});\n\n\ttest('sequential delivery', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tinterface E extends IWaitUntil {\n\t\t\t\tfoo: boolean;\n\t\t\t}\n\n\t\t\tlet globalState = 0;\n\t\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(10).then(_ => {\n\t\t\t\t\tassert.strictEqual(globalState, 0);\n\t\t\t\t\tglobalState += 1;\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(1).then(_ => {\n\t\t\t\t\tassert.strictEqual(globalState, 1);\n\t\t\t\t\tglobalState += 1;\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\tawait emitter.fireAsync({ foo: true }, CancellationToken.None);\n\t\t\tassert.strictEqual(globalState, 2);\n\t\t});\n\t});\n\n\ttest('sequential, in-order delivery', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tinterface E extends IWaitUntil {\n\t\t\t\tfoo: number;\n\t\t\t}\n\t\t\tconst events: number[] = [];\n\t\t\tlet done = false;\n\t\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\t\t// e1\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\te.waitUntil(timeout(10).then(async _ => {\n\t\t\t\t\tif (e.foo === 1) {\n\t\t\t\t\t\tawait emitter.fireAsync({ foo: 2 }, CancellationToken.None);\n\t\t\t\t\t\tassert.deepStrictEqual(events, [1, 2]);\n\t\t\t\t\t\tdone = true;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}));\n\n\t\t\t// e2\n\t\t\tds.add(emitter.event(e => {\n\t\t\t\tevents.push(e.foo);\n\t\t\t\te.waitUntil(timeout(7));\n\t\t\t}));\n\n\t\t\tawait emitter.fireAsync({ foo: 1 }, CancellationToken.None);\n\t\t\tassert.ok(done);\n\t\t});\n\t});\n\n\ttest('catch errors', async function () {\n\t\tconst origErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => null);\n\n\t\tinterface E extends IWaitUntil {\n\t\t\tfoo: boolean;\n\t\t}\n\n\t\tlet globalState = 0;\n\t\tconst emitter = new AsyncEmitter<E>();\n\n\t\tds.add(emitter.event(e => {\n\t\t\tglobalState += 1;\n\t\t\te.waitUntil(new Promise((_r, reject) => reject(new Error())));\n\t\t}));\n\n\t\tds.add(emitter.event(e => {\n\t\t\tglobalState += 1;\n\t\t\te.waitUntil(timeout(10));\n\t\t\te.waitUntil(timeout(20).then(() => globalState++)); // multiple `waitUntil` are supported and awaited on\n\t\t}));\n\n\t\tawait emitter.fireAsync({ foo: true }, CancellationToken.None).then(() => {\n\t\t\tassert.strictEqual(globalState, 3);\n\t\t}).catch(e => {\n\t\t\tconsole.log(e);\n\t\t\tassert.ok(false);\n\t\t});\n\n\t\tsetUnexpectedErrorHandler(origErrorHandler);\n\t});\n});\n\nsuite('PausableEmitter', function () {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('basic', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\t});\n\n\ttest('pause/resume - no merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\t\temitter.fire(5);\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4, 5]);\n\t});\n\n\ttest('pause/resume - merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>({ merge: (a) => a.reduce((p, c) => p + c, 0) }));\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 7]);\n\n\t\temitter.fire(5);\n\t\tassert.deepStrictEqual(data, [1, 2, 7, 5]);\n\t});\n\n\ttest('double pause/resume', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.pause();\n\t\temitter.pause();\n\t\temitter.fire(3);\n\t\temitter.fire(4);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 2, 3, 4]);\n\t});\n\n\ttest('resume, no pause', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tds.add(emitter.event(e => data.push(e)));\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, [1, 2]);\n\n\t\temitter.resume();\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(data, [1, 2, 3]);\n\t});\n\n\ttest('nested pause', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>());\n\n\t\tlet once = true;\n\t\tds.add(emitter.event(e => {\n\t\t\tdata.push(e);\n\n\t\t\tif (once) {\n\t\t\t\temitter.pause();\n\t\t\t\tonce = false;\n\t\t\t}\n\t\t}));\n\t\tds.add(emitter.event(e => {\n\t\t\tdata.push(e);\n\t\t}));\n\n\t\temitter.pause();\n\t\temitter.fire(1);\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(data, []);\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 1]); // paused after first event\n\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, [1, 1, 2, 2]); // remaing event delivered\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(data, [1, 1, 2, 2, 3, 3]);\n\n\t});\n\n\ttest('empty pause with merge', function () {\n\t\tconst data: number[] = [];\n\t\tconst emitter = ds.add(new PauseableEmitter<number>({ merge: a => a[0] }));\n\t\tds.add(emitter.event(e => data.push(1)));\n\n\t\temitter.pause();\n\t\temitter.resume();\n\t\tassert.deepStrictEqual(data, []);\n\t});\n\n});\n\nsuite('Event utils - ensureNoDisposablesAreLeakedInTestSuite', function () {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('fromObservable', function () {\n\n\t\tconst obs = observableValue('test', 12);\n\t\tconst event = Event.fromObservable(obs);\n\n\t\tconst values: number[] = [];\n\t\tconst d = event(n => { values.push(n); });\n\n\t\tobs.set(3, undefined);\n\t\tobs.set(13, undefined);\n\t\tobs.set(3, undefined);\n\t\tobs.set(33, undefined);\n\t\tobs.set(1, undefined);\n\n\t\ttransaction(tx => {\n\t\t\tobs.set(334, tx);\n\t\t\tobs.set(99, tx);\n\t\t});\n\n\t\tassert.deepStrictEqual(values, ([3, 13, 3, 33, 1, 99]));\n\t\td.dispose();\n\t});\n});\n\nsuite('Event utils', () => {\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('EventBufferer', () => {\n\n\t\ttest('should not buffer when not wrapped', () => {\n\t\t\tconst bufferer = new EventBufferer();\n\t\t\tconst counter = new Samples.EventCounter();\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst event = bufferer.wrapEvent(emitter.event);\n\t\t\tconst listener = event(counter.onEvent, counter);\n\n\t\t\tassert.strictEqual(counter.count, 0);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 2);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 3);\n\n\t\t\tlistener.dispose();\n\t\t});\n\n\t\ttest('should buffer when wrapped', () => {\n\t\t\tconst bufferer = new EventBufferer();\n\t\t\tconst counter = new Samples.EventCounter();\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst event = bufferer.wrapEvent(emitter.event);\n\t\t\tconst listener = event(counter.onEvent, counter);\n\n\t\t\tassert.strictEqual(counter.count, 0);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 1);\n\n\t\t\tbufferer.bufferEvents(() => {\n\t\t\t\temitter.fire();\n\t\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\t\temitter.fire();\n\t\t\t\tassert.strictEqual(counter.count, 1);\n\t\t\t});\n\n\t\t\tassert.strictEqual(counter.count, 3);\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter.count, 4);\n\n\t\t\tlistener.dispose();\n\t\t});\n\n\t\ttest('once', () => {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\n\t\t\tlet counter1 = 0, counter2 = 0, counter3 = 0;\n\n\t\t\tconst listener1 = emitter.event(() => counter1++);\n\t\t\tconst listener2 = Event.once(emitter.event)(() => counter2++);\n\t\t\tconst listener3 = Event.once(emitter.event)(() => counter3++);\n\n\t\t\tassert.strictEqual(counter1, 0);\n\t\t\tassert.strictEqual(counter2, 0);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\tlistener3.dispose();\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter1, 1);\n\t\t\tassert.strictEqual(counter2, 1);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\temitter.fire();\n\t\t\tassert.strictEqual(counter1, 2);\n\t\t\tassert.strictEqual(counter2, 1);\n\t\t\tassert.strictEqual(counter3, 0);\n\n\t\t\tlistener1.dispose();\n\t\t\tlistener2.dispose();\n\t\t});\n\t});\n\n\tsuite('buffer', () => {\n\n\t\ttest('should buffer events', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tconst listener = bufferedEvent(num => result.push(num));\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\temitter.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\n\t\t\tlistener.dispose();\n\t\t\temitter.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t});\n\n\t\ttest('should buffer events on next tick', async () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event, true);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tconst listener = bufferedEvent(num => result.push(num));\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\tawait timeout(10);\n\t\t\temitter.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t\tlistener.dispose();\n\t\t\temitter.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4]);\n\t\t});\n\n\t\ttest('should fire initial buffer events', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst event = emitter.event;\n\t\t\tconst bufferedEvent = Event.buffer(event, false, [-2, -1, 0]);\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(2);\n\t\t\temitter.fire(3);\n\t\t\tassert.deepStrictEqual(result, [] as number[]);\n\n\t\t\tds.add(bufferedEvent(num => result.push(num)));\n\t\t\tassert.deepStrictEqual(result, [-2, -1, 0, 1, 2, 3]);\n\t\t});\n\t});\n\n\tsuite('EventMultiplexer', () => {\n\n\t\ttest('works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('multiplexer dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\tm.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('event dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('mutliplexer event dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst l1 = m.add(e1.event);\n\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\tl1.dispose();\n\t\t\tassert.deepStrictEqual(result, [0]);\n\n\t\t\te1.fire(0);\n\t\t\tassert.deepStrictEqual(result, [0]);\n\t\t});\n\n\t\ttest('hot start works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('cold start works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('late add works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e3.event));\n\t\t\te3.fire(3);\n\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\t\t});\n\n\t\ttest('add dispose works', () => {\n\t\t\tconst result: number[] = [];\n\t\t\tconst m = new EventMultiplexer<number>();\n\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e1.event));\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tds.add(m.add(e2.event));\n\n\t\t\tds.add(m.event(r => result.push(r)));\n\n\t\t\te1.fire(1);\n\t\t\te2.fire(2);\n\n\t\t\tconst e3 = ds.add(new Emitter<number>());\n\t\t\tconst l3 = m.add(e3.event);\n\t\t\te3.fire(3);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\tl3.dispose();\n\t\t\te3.fire(4);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3]);\n\n\t\t\te2.fire(4);\n\t\t\te1.fire(5);\n\t\t\tassert.deepStrictEqual(result, [1, 2, 3, 4, 5]);\n\t\t});\n\t});\n\n\tsuite('DynamicListEventMultiplexer', () => {\n\t\tlet addEmitter: Emitter<TestItem>;\n\t\tlet removeEmitter: Emitter<TestItem>;\n\t\tconst recordedEvents: number[] = [];\n\t\tclass TestItem {\n\t\t\treadonly onTestEventEmitter = ds.add(new Emitter<number>());\n\t\t\treadonly onTestEvent = this.onTestEventEmitter.event;\n\t\t}\n\t\tlet items: TestItem[];\n\t\tlet m: DynamicListEventMultiplexer<TestItem, number>;\n\t\tsetup(() => {\n\t\t\taddEmitter = ds.add(new Emitter<TestItem>());\n\t\t\tremoveEmitter = ds.add(new Emitter<TestItem>());\n\t\t\titems = [new TestItem(), new TestItem()];\n\t\t\tfor (const [i, item] of items.entries()) {\n\t\t\t\tds.add(item.onTestEvent(e => `${i}:${e}`));\n\t\t\t}\n\t\t\tm = new DynamicListEventMultiplexer(items, addEmitter.event, removeEmitter.event, e => e.onTestEvent);\n\t\t\tds.add(m.event(e => recordedEvents.push(e)));\n\t\t\trecordedEvents.length = 0;\n\t\t});\n\t\tteardown(() => m.dispose());\n\t\ttest('should fire events for initial items', () => {\n\t\t\titems[0].onTestEventEmitter.fire(1);\n\t\t\titems[1].onTestEventEmitter.fire(2);\n\t\t\titems[0].onTestEventEmitter.fire(3);\n\t\t\titems[1].onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [1, 2, 3, 4]);\n\t\t});\n\t\ttest('should fire events for added items', () => {\n\t\t\tconst addedItem = new TestItem();\n\t\t\taddEmitter.fire(addedItem);\n\t\t\taddedItem.onTestEventEmitter.fire(1);\n\t\t\titems[0].onTestEventEmitter.fire(2);\n\t\t\titems[1].onTestEventEmitter.fire(3);\n\t\t\taddedItem.onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [1, 2, 3, 4]);\n\t\t});\n\t\ttest('should not fire events for removed items', () => {\n\t\t\tremoveEmitter.fire(items[0]);\n\t\t\titems[0].onTestEventEmitter.fire(1);\n\t\t\titems[1].onTestEventEmitter.fire(2);\n\t\t\titems[0].onTestEventEmitter.fire(3);\n\t\t\titems[1].onTestEventEmitter.fire(4);\n\t\t\tassert.deepStrictEqual(recordedEvents, [2, 4]);\n\t\t});\n\t});\n\n\ttest('latch', () => {\n\t\tconst emitter = ds.add(new Emitter<number>());\n\t\tconst event = Event.latch(emitter.event);\n\n\t\tconst result: number[] = [];\n\t\tconst listener = ds.add(event(num => result.push(num)));\n\n\t\tassert.deepStrictEqual(result, []);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1]);\n\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(result, [1, 2]);\n\n\t\temitter.fire(2);\n\t\tassert.deepStrictEqual(result, [1, 2]);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1, 2, 1]);\n\n\t\temitter.fire(1);\n\t\tassert.deepStrictEqual(result, [1, 2, 1]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\temitter.fire(3);\n\t\tassert.deepStrictEqual(result, [1, 2, 1, 3]);\n\n\t\tlistener.dispose();\n\t});\n\n\ttest('dispose is reentrant', () => {\n\t\tconst emitter = ds.add(new Emitter<number>({\n\t\t\tonDidRemoveLastListener: () => {\n\t\t\t\temitter.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tconst listener = emitter.event(() => undefined);\n\t\tlistener.dispose(); // should not crash\n\t});\n\n\tsuite('Relay', () => {\n\t\ttest('should input work', () => {\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tconst relay = new Relay<number>();\n\n\t\t\tconst result: number[] = [];\n\t\t\tconst listener = (num: number) => result.push(num);\n\t\t\tconst subscription = relay.event(listener);\n\n\t\t\te1.fire(1);\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\trelay.input = e1.event;\n\t\t\te1.fire(2);\n\t\t\tassert.deepStrictEqual(result, [2]);\n\n\t\t\trelay.input = e2.event;\n\t\t\te1.fire(3);\n\t\t\te2.fire(4);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\n\t\t\tsubscription.dispose();\n\t\t\te1.fire(5);\n\t\t\te2.fire(6);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\t\t});\n\n\t\ttest('should Relay dispose work', () => {\n\t\t\tconst e1 = ds.add(new Emitter<number>());\n\t\t\tconst e2 = ds.add(new Emitter<number>());\n\t\t\tconst relay = new Relay<number>();\n\n\t\t\tconst result: number[] = [];\n\t\t\tconst listener = (num: number) => result.push(num);\n\t\t\tds.add(relay.event(listener));\n\n\t\t\te1.fire(1);\n\t\t\tassert.deepStrictEqual(result, []);\n\n\t\t\trelay.input = e1.event;\n\t\t\te1.fire(2);\n\t\t\tassert.deepStrictEqual(result, [2]);\n\n\t\t\trelay.input = e2.event;\n\t\t\te1.fire(3);\n\t\t\te2.fire(4);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\n\t\t\trelay.dispose();\n\t\t\te1.fire(5);\n\t\t\te2.fire(6);\n\t\t\tassert.deepStrictEqual(result, [2, 4]);\n\t\t});\n\t});\n\n\tsuite('accumulate', () => {\n\t\ttest('should not fire after a listener is disposed with undefined or []', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst calls1: number[][] = [];\n\t\t\tconst calls2: number[][] = [];\n\t\t\tconst listener1 = ds.add(accumulated((e) => calls1.push(e)));\n\t\t\tds.add(accumulated((e) => calls2.push(e)));\n\n\t\t\teventEmitter.fire(1);\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls1, [[1]]);\n\t\t\tassert.deepStrictEqual(calls2, [[1]]);\n\n\t\t\tlistener1.dispose();\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls1, [[1]]);\n\t\t\tassert.deepStrictEqual(calls2, [[1]], 'should not fire after a listener is disposed with undefined or []');\n\t\t});\n\t\ttest('should accumulate a single event', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst results1 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(1);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results1, [1]);\n\n\t\t\tconst results2 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(2);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results2, [2]);\n\t\t});\n\t\ttest('should accumulate multiple events', async () => {\n\t\t\tconst eventEmitter = ds.add(new Emitter<number>());\n\t\t\tconst event = eventEmitter.event;\n\t\t\tconst accumulated = Event.accumulate(event, 0);\n\n\t\t\tconst results1 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(1);\n\t\t\t\teventEmitter.fire(2);\n\t\t\t\teventEmitter.fire(3);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results1, [1, 2, 3]);\n\n\t\t\tconst results2 = await new Promise<number[]>(r => {\n\t\t\t\tds.add(accumulated(r));\n\t\t\t\teventEmitter.fire(4);\n\t\t\t\teventEmitter.fire(5);\n\t\t\t\teventEmitter.fire(6);\n\t\t\t\teventEmitter.fire(7);\n\t\t\t\teventEmitter.fire(8);\n\t\t\t});\n\t\t\tassert.deepStrictEqual(results2, [4, 5, 6, 7, 8]);\n\t\t});\n\t});\n\n\tsuite('debounce', () => {\n\t\ttest('simple', function (done: () => void) {\n\t\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\t\tconst onDocDidChange = Event.debounce(doc.onDidChange, (prev: string[] | undefined, cur) => {\n\t\t\t\tif (!prev) {\n\t\t\t\t\tprev = [cur];\n\t\t\t\t} else if (prev.indexOf(cur) < 0) {\n\t\t\t\t\tprev.push(cur);\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, 10);\n\n\t\t\tlet count = 0;\n\n\t\t\tds.add(onDocDidChange(keys => {\n\t\t\t\tcount++;\n\t\t\t\tassert.ok(keys, 'was not expecting keys.');\n\t\t\t\tif (count === 1) {\n\t\t\t\t\tdoc.setText('4');\n\t\t\t\t\tassert.deepStrictEqual(keys, ['1', '2', '3']);\n\t\t\t\t} else if (count === 2) {\n\t\t\t\t\tassert.deepStrictEqual(keys, ['4']);\n\t\t\t\t\tdone();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tdoc.setText('1');\n\t\t\tdoc.setText('2');\n\t\t\tdoc.setText('3');\n\t\t});\n\n\n\t\ttest('microtask', function (done: () => void) {\n\t\t\tconst doc = ds.add(new Samples.Document3());\n\n\t\t\tconst onDocDidChange = Event.debounce(doc.onDidChange, (prev: string[] | undefined, cur) => {\n\t\t\t\tif (!prev) {\n\t\t\t\t\tprev = [cur];\n\t\t\t\t} else if (prev.indexOf(cur) < 0) {\n\t\t\t\t\tprev.push(cur);\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, MicrotaskDelay);\n\n\t\t\tlet count = 0;\n\n\t\t\tds.add(onDocDidChange(keys => {\n\t\t\t\tcount++;\n\t\t\t\tassert.ok(keys, 'was not expecting keys.');\n\t\t\t\tif (count === 1) {\n\t\t\t\t\tdoc.setText('4');\n\t\t\t\t\tassert.deepStrictEqual(keys, ['1', '2', '3']);\n\t\t\t\t} else if (count === 2) {\n\t\t\t\t\tassert.deepStrictEqual(keys, ['4']);\n\t\t\t\t\tdone();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tdoc.setText('1');\n\t\t\tdoc.setText('2');\n\t\t\tdoc.setText('3');\n\t\t});\n\n\n\t\ttest('leading', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => e, 0, /*leading=*/true);\n\n\t\t\tlet calls = 0;\n\t\t\tds.add(debounced(() => {\n\t\t\t\tcalls++;\n\t\t\t}));\n\n\t\t\t// If the source event is fired once, the debounced (on the leading edge) event should be fired only once\n\t\t\temitter.fire();\n\n\t\t\tawait timeout(1);\n\t\t\tassert.strictEqual(calls, 1);\n\t\t});\n\n\t\ttest('leading (2)', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<void>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => e, 0, /*leading=*/true);\n\n\t\t\tlet calls = 0;\n\t\t\tds.add(debounced(() => {\n\t\t\t\tcalls++;\n\t\t\t}));\n\n\t\t\t// If the source event is fired multiple times, the debounced (on the leading edge) event should be fired twice\n\t\t\temitter.fire();\n\t\t\temitter.fire();\n\t\t\temitter.fire();\n\t\t\tawait timeout(1);\n\t\t\tassert.strictEqual(calls, 2);\n\t\t});\n\n\t\ttest('leading reset', async function () {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0, /*leading=*/true);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1, 1]);\n\t\t});\n\n\t\ttest('should not flush events when a listener is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tconst listener = ds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\tlistener.dispose();\n\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, []);\n\t\t});\n\n\t\ttest('flushOnListenerRemove - should flush events when a listener is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0, undefined, true);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tconst listener = ds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\tlistener.dispose();\n\n\t\t\temitter.fire(1);\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1], 'should fire with the first event, not the second (after listener dispose)');\n\t\t});\n\n\t\ttest('should flush events when the emitter is disposed', async () => {\n\t\t\tconst emitter = ds.add(new Emitter<number>());\n\t\t\tconst debounced = Event.debounce(emitter.event, (l, e) => l ? l + 1 : 1, 0);\n\n\t\t\tconst calls: number[] = [];\n\t\t\tds.add(debounced((e) => calls.push(e)));\n\n\t\t\temitter.fire(1);\n\t\t\temitter.dispose();\n\n\t\t\tawait timeout(1);\n\t\t\tassert.deepStrictEqual(calls, [1]);\n\t\t});\n\t});\n\n\ttest('issue #230401', () => {\n\t\tlet count = 0;\n\t\tconst emitter = ds.add(new Emitter<void>());\n\t\tconst disposables = ds.add(new DisposableStore());\n\t\tds.add(emitter.event(() => {\n\t\t\tcount++;\n\t\t\tdisposables.add(emitter.event(() => {\n\t\t\t\tcount++;\n\t\t\t}));\n\t\t\tdisposables.add(emitter.event(() => {\n\t\t\t\tcount++;\n\t\t\t}));\n\t\t\tdisposables.clear();\n\t\t}));\n\t\tds.add(emitter.event(() => {\n\t\t\tcount++;\n\t\t}));\n\t\temitter.fire();\n\t\tassert.deepStrictEqual(count, 2);\n\t});\n\n\tsuite('chain2', () => {\n\t\tlet em: Emitter<number>;\n\t\tlet calls: number[];\n\n\t\tsetup(() => {\n\t\t\tem = ds.add(new Emitter<number>());\n\t\t\tcalls = [];\n\t\t});\n\n\t\ttest('maps', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.map(v => v * 2));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tassert.deepStrictEqual(calls, [2, 4, 6]);\n\t\t});\n\n\t\ttest('filters', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.filter(v => v % 2 === 0));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tassert.deepStrictEqual(calls, [2, 4]);\n\t\t});\n\n\t\ttest('reduces', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.reduce((acc, v) => acc + v, 0));\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tassert.deepStrictEqual(calls, [1, 3, 6, 10]);\n\t\t});\n\n\t\ttest('latches', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $.latch());\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(3);\n\t\t\tem.fire(1);\n\t\t\tassert.deepStrictEqual(calls, [1, 2, 3, 1]);\n\t\t});\n\n\t\ttest('does everything', () => {\n\t\t\tconst ev = Event.chain(em.event, $ => $\n\t\t\t\t.filter(v => v % 2 === 0)\n\t\t\t\t.map(v => v * 2)\n\t\t\t\t.reduce((acc, v) => acc + v, 0)\n\t\t\t\t.latch()\n\t\t\t);\n\n\t\t\tds.add(ev(v => calls.push(v)));\n\t\t\tem.fire(1);\n\t\t\tem.fire(2);\n\t\t\tem.fire(3);\n\t\t\tem.fire(4);\n\t\t\tem.fire(0);\n\t\t\tassert.deepStrictEqual(calls, [4, 12]);\n\t\t});\n\t});\n});\n"]}