{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/base/test/browser/indexedDB.test.ts","vs/base/test/browser/indexedDB.test.ts"],"names":[],"mappings":"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","file":"indexedDB.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { IndexedDB } from '../../browser/indexedDB.js';\nimport { flakySuite } from '../common/testUtils.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../common/utils.js';\n\nflakySuite('IndexedDB', () => {\n\n\tlet indexedDB: IndexedDB;\n\n\tsetup(async () => {\n\t\tindexedDB = await IndexedDB.create('vscode-indexeddb-test', 1, ['test-store']);\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => store.clear());\n\t});\n\n\tteardown(() => {\n\t\tindexedDB?.close();\n\t});\n\n\ttest('runInTransaction', async () => {\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello1', 'key1'));\n\t\tconst value = await indexedDB.runInTransaction('test-store', 'readonly', store => store.get('key1'));\n\t\tassert.deepStrictEqual(value, 'hello1');\n\t});\n\n\ttest('getKeyValues', async () => {\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => {\n\t\t\tconst requests: IDBRequest[] = [];\n\t\t\trequests.push(store.add('hello1', 'key1'));\n\t\t\trequests.push(store.add('hello2', 'key2'));\n\t\t\trequests.push(store.add(true, 'key3'));\n\n\t\t\treturn requests;\n\t\t});\n\t\tfunction isValid(value: unknown): value is string {\n\t\t\treturn typeof value === 'string';\n\t\t}\n\t\tconst keyValues = await indexedDB.getKeyValues('test-store', isValid);\n\t\tassert.strictEqual(keyValues.size, 2);\n\t\tassert.strictEqual(keyValues.get('key1'), 'hello1');\n\t\tassert.strictEqual(keyValues.get('key2'), 'hello2');\n\t});\n\n\ttest('hasPendingTransactions', async () => {\n\t\tconst promise = indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello2', 'key2'));\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), true);\n\t\tawait promise;\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), false);\n\t});\n\n\ttest('close', async () => {\n\t\tconst promise = indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello3', 'key3'));\n\t\tindexedDB.close();\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), false);\n\t\ttry {\n\t\t\tawait promise;\n\t\t\tassert.fail('Transaction should be aborted');\n\t\t} catch (error) { }\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { IndexedDB } from '../../browser/indexedDB.js';\nimport { flakySuite } from '../common/testUtils.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../common/utils.js';\n\nflakySuite('IndexedDB', () => {\n\n\tlet indexedDB: IndexedDB;\n\n\tsetup(async () => {\n\t\tindexedDB = await IndexedDB.create('vscode-indexeddb-test', 1, ['test-store']);\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => store.clear());\n\t});\n\n\tteardown(() => {\n\t\tindexedDB?.close();\n\t});\n\n\ttest('runInTransaction', async () => {\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello1', 'key1'));\n\t\tconst value = await indexedDB.runInTransaction('test-store', 'readonly', store => store.get('key1'));\n\t\tassert.deepStrictEqual(value, 'hello1');\n\t});\n\n\ttest('getKeyValues', async () => {\n\t\tawait indexedDB.runInTransaction('test-store', 'readwrite', store => {\n\t\t\tconst requests: IDBRequest[] = [];\n\t\t\trequests.push(store.add('hello1', 'key1'));\n\t\t\trequests.push(store.add('hello2', 'key2'));\n\t\t\trequests.push(store.add(true, 'key3'));\n\n\t\t\treturn requests;\n\t\t});\n\t\tfunction isValid(value: unknown): value is string {\n\t\t\treturn typeof value === 'string';\n\t\t}\n\t\tconst keyValues = await indexedDB.getKeyValues('test-store', isValid);\n\t\tassert.strictEqual(keyValues.size, 2);\n\t\tassert.strictEqual(keyValues.get('key1'), 'hello1');\n\t\tassert.strictEqual(keyValues.get('key2'), 'hello2');\n\t});\n\n\ttest('hasPendingTransactions', async () => {\n\t\tconst promise = indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello2', 'key2'));\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), true);\n\t\tawait promise;\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), false);\n\t});\n\n\ttest('close', async () => {\n\t\tconst promise = indexedDB.runInTransaction('test-store', 'readwrite', store => store.add('hello3', 'key3'));\n\t\tindexedDB.close();\n\t\tassert.deepStrictEqual(indexedDB.hasPendingTransactions(), false);\n\t\ttry {\n\t\t\tawait promise;\n\t\t\tassert.fail('Transaction should be aborted');\n\t\t} catch (error) { }\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}