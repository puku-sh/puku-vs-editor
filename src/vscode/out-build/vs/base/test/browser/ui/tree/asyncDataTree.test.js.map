{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/base/test/browser/ui/tree/asyncDataTree.test.ts","vs/base/test/browser/ui/tree/asyncDataTree.test.ts"],"names":[],"mappings":"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","file":"asyncDataTree.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable no-restricted-syntax */\n\nimport assert from 'assert';\nimport { IIdentityProvider, IListVirtualDelegate } from '../../../../browser/ui/list/list.js';\nimport { AsyncDataTree, CompressibleAsyncDataTree, ITreeCompressionDelegate } from '../../../../browser/ui/tree/asyncDataTree.js';\nimport { ICompressedTreeNode } from '../../../../browser/ui/tree/compressedObjectTreeModel.js';\nimport { ICompressibleTreeRenderer } from '../../../../browser/ui/tree/objectTree.js';\nimport { IAsyncDataSource, ITreeNode } from '../../../../browser/ui/tree/tree.js';\nimport { timeout } from '../../../../common/async.js';\nimport { Iterable } from '../../../../common/iterator.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../common/utils.js';\nimport { runWithFakedTimers } from '../../../common/timeTravelScheduler.js';\n\ninterface Element {\n\tid: string;\n\tsuffix?: string;\n\tchildren?: Element[];\n}\n\nfunction find(element: Element, id: string): Element | undefined {\n\tif (element.id === id) {\n\t\treturn element;\n\t}\n\n\tif (!element.children) {\n\t\treturn undefined;\n\t}\n\n\tfor (const child of element.children) {\n\t\tconst result = find(child, id);\n\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nclass Renderer implements ICompressibleTreeRenderer<Element, void, HTMLElement> {\n\treadonly templateId = 'default';\n\trenderTemplate(container: HTMLElement): HTMLElement {\n\t\treturn container;\n\t}\n\trenderElement(element: ITreeNode<Element, void>, index: number, templateData: HTMLElement): void {\n\t\ttemplateData.textContent = element.element.id + (element.element.suffix || '');\n\t}\n\tdisposeTemplate(templateData: HTMLElement): void {\n\t\t// noop\n\t}\n\trenderCompressedElements(node: ITreeNode<ICompressedTreeNode<Element>, void>, index: number, templateData: HTMLElement): void {\n\t\tconst result: string[] = [];\n\n\t\tfor (const element of node.element.elements) {\n\t\t\tresult.push(element.id + (element.suffix || ''));\n\t\t}\n\n\t\ttemplateData.textContent = result.join('/');\n\t}\n}\n\nclass IdentityProvider implements IIdentityProvider<Element> {\n\tgetId(element: Element) {\n\t\treturn element.id;\n\t}\n}\n\nclass VirtualDelegate implements IListVirtualDelegate<Element> {\n\tgetHeight() { return 20; }\n\tgetTemplateId(element: Element): string { return 'default'; }\n}\n\nclass DataSource implements IAsyncDataSource<Element, Element> {\n\thasChildren(element: Element): boolean {\n\t\treturn !!element.children && element.children.length > 0;\n\t}\n\tgetChildren(element: Element): Promise<Element[]> {\n\t\treturn Promise.resolve(element.children || []);\n\t}\n}\n\nclass Model {\n\n\tconstructor(readonly root: Element) { }\n\n\tget(id: string): Element {\n\t\tconst result = find(this.root, id);\n\n\t\tif (!result) {\n\t\t\tthrow new Error('element not found');\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nsuite('AsyncDataTree', function () {\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Collapse state should be preserved across refresh calls', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 0);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\tconst twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [\n\t\t\t{ id: 'aa' },\n\t\t\t{ id: 'ab' },\n\t\t\t{ id: 'ac' }\n\t\t];\n\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 4);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t});\n\n\ttest('issue #68648', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\t});\n\n\ttest('issue #67722 - once resolved, refreshed collapsed nodes should only get children when expanded', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\ttree.collapse(model.get('a'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\tawait tree.updateChildren();\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a', 'root'], 'a should not be refreshed, since it\\' collapsed');\n\t});\n\n\ttest('resolved collapsed nodes which lose children should lose twistie as well', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\n\t\ttree.collapse(model.get('a'));\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t});\n\n\ttest('issue #192422 - resolved collapsed nodes with changed children don\\'t show old children', async () => {\n\t\tconst container = document.createElement('div');\n\t\tlet hasGottenAChildren = false;\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element): Promise<Element[]> {\n\t\t\t\tif (element.id === 'a') {\n\t\t\t\t\tif (!hasGottenAChildren) {\n\t\t\t\t\t\thasGottenAChildren = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [{ id: 'c' }];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn element.children || [];\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'b' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tconst a = model.get('a');\n\t\tconst aNode = tree.getNode(a);\n\t\tassert(aNode.collapsed);\n\t\tawait tree.expand(a);\n\t\tassert(!aNode.collapsed);\n\t\tassert.equal(aNode.children.length, 1);\n\t\tassert.equal(aNode.children[0].element.id, 'b');\n\t\tconst bChild = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(bChild?.textContent, 'b');\n\t\ttree.collapse(a);\n\t\tassert(aNode.collapsed);\n\n\t\tawait tree.updateChildren(a);\n\t\tconst aUpdated1 = model.get('a');\n\t\tconst aNodeUpdated1 = tree.getNode(a);\n\t\tassert(aNodeUpdated1.collapsed);\n\t\tassert.equal(aNodeUpdated1.children.length, 0);\n\t\tlet didCheckNoChildren = false;\n\t\tconst event = tree.onDidChangeCollapseState(e => {\n\t\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\t\tassert.equal(child, null);\n\t\t\tdidCheckNoChildren = true;\n\t\t});\n\t\tawait tree.expand(aUpdated1);\n\t\tevent.dispose();\n\t\tassert(didCheckNoChildren);\n\n\t\tconst aNodeUpdated2 = tree.getNode(a);\n\t\tassert(!aNodeUpdated2.collapsed);\n\t\tassert.equal(aNodeUpdated2.children.length, 1);\n\t\tassert.equal(aNodeUpdated2.children[0].element.id, 'c');\n\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(child?.textContent, 'c');\n\t});\n\n\ttest('issue #192422 - resolved collapsed nodes with unchanged children immediately show children', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn element.children || [];\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'b' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tconst a = model.get('a');\n\t\tconst aNode = tree.getNode(a);\n\t\tassert(aNode.collapsed);\n\t\tawait tree.expand(a);\n\t\tassert(!aNode.collapsed);\n\t\tassert.equal(aNode.children.length, 1);\n\t\tassert.equal(aNode.children[0].element.id, 'b');\n\t\tconst bChild = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(bChild?.textContent, 'b');\n\t\ttree.collapse(a);\n\t\tassert(aNode.collapsed);\n\n\t\tconst aUpdated1 = model.get('a');\n\t\tconst aNodeUpdated1 = tree.getNode(a);\n\t\tassert(aNodeUpdated1.collapsed);\n\t\tassert.equal(aNodeUpdated1.children.length, 1);\n\t\tlet didCheckSameChildren = false;\n\t\tconst event = tree.onDidChangeCollapseState(e => {\n\t\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\t\tassert.equal(child?.textContent, 'b');\n\t\t\tdidCheckSameChildren = true;\n\t\t});\n\t\tawait tree.expand(aUpdated1);\n\t\tevent.dispose();\n\t\tassert(didCheckSameChildren);\n\n\t\tconst aNodeUpdated2 = tree.getNode(a);\n\t\tassert(!aNodeUpdated2.collapsed);\n\t\tassert.equal(aNodeUpdated2.children.length, 1);\n\t\tassert.equal(aNodeUpdated2.children[0].element.id, 'b');\n\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(child?.textContent, 'b');\n\t});\n\n\ttest('support default collapse state per element', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, {\n\t\t\tcollapseByDefault: el => el.id !== 'a'\n\t\t}));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\t});\n\n\ttest('issue #80098 - concurrent refresh and expand', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Function[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tconst pSetInput = tree.setInput(model.root);\n\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\tawait pSetInput;\n\n\t\tconst pUpdateChildrenA = tree.updateChildren(model.get('a'));\n\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\tassert.strictEqual(calls.length, 1, 'expand(a) still hasn\\'t called getChildren(a)');\n\n\t\tcalls.pop()!();\n\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\tawait pUpdateChildrenA;\n\t\tassert.strictEqual(calls.length, 0, 'expand(a) should not have forced a second refresh');\n\n\t\tconst result = await pExpandA;\n\t\tassert.strictEqual(result, true, 'expand(a) should be done');\n\t});\n\n\ttest('issue #80098 - first expand should call getChildren', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst container = document.createElement('div');\n\n\t\t\tconst calls: Function[] = [];\n\t\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\t\thasChildren(element: Element): boolean {\n\t\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t\t}\n\t\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst model = new Model({\n\t\t\t\tid: 'root',\n\t\t\t\tchildren: [{\n\t\t\t\t\tid: 'a', children: [{\n\t\t\t\t\t\tid: 'aa'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t});\n\n\t\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\t\ttree.layout(200);\n\n\t\t\tconst pSetInput = tree.setInput(model.root);\n\t\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\t\tawait pSetInput;\n\n\t\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\t\tassert.strictEqual(calls.length, 1, 'expand(a) should\\'ve called getChildren(a)');\n\n\t\t\tlet race = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\t\tassert.strictEqual(race, 'timeout', 'expand(a) should not be yet done');\n\n\t\t\tcalls.pop()!();\n\t\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\t\trace = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\t\tassert.strictEqual(race, 'expand', 'expand(a) should now be done');\n\t\t});\n\t});\n\n\ttest('issue #78388 - tree should react to hasChildren toggles', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [{ id: 'aa' }];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t});\n\n\ttest('issues #84569, #82629 - rerender', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a',\n\t\t\t\tchildren: [{\n\t\t\t\t\tid: 'b',\n\t\t\t\t\tsuffix: '1'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b1']);\n\n\t\tconst a = model.get('a');\n\t\tconst b = model.get('b');\n\t\ta.children?.splice(0, 1, { id: 'b', suffix: '2' });\n\n\t\tawait Promise.all([\n\t\t\ttree.updateChildren(a, true, true),\n\t\t\ttree.updateChildren(b, true, true)\n\t\t]);\n\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b2']);\n\t});\n\n\ttest('issue #199264 - dispose during render', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model1 = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\t\tconst model2 = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model1.root);\n\t\tconst input = tree.setInput(model2.root);\n\t\ttree.dispose();\n\t\tawait input;\n\t\tassert.strictEqual(container.innerHTML, '');\n\t});\n\n\ttest('issue #121567', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Element[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\tcalls.push(element);\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\t\tconst a = model.get('a');\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(calls.length, 1, 'There should be a single getChildren call for the root');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should be no changes to the calls list, since a was collapsed');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tconst children = a.children;\n\t\ta.children = [];\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should still be no changes to the calls list, since a was collapsed');\n\t\tassert(!tree.isCollapsible(a), 'a is no longer collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\ta.children = children;\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should still be no changes to the calls list, since a was collapsed');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible again');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tawait tree.expand(a);\n\t\tassert.strictEqual(calls.length, 2, 'Finally, there should be a getChildren call for a');\n\t\tassert(tree.isCollapsible(a), 'a is still collapsible');\n\t\tassert(!tree.isCollapsed(a), 'a is expanded');\n\t});\n\n\ttest('issue #199441', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst compressionDelegate = new class implements ITreeCompressionDelegate<Element> {\n\t\t\tisIncompressible(element: Element): boolean {\n\t\t\t\treturn !dataSource.hasChildren(element);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'b',\n\t\t\t\t\tchildren: [{ id: 'b.txt' }]\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst collapseByDefault = (element: Element) => false;\n\n\t\tconst tree = store.add(new CompressibleAsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), compressionDelegate, [new Renderer()], dataSource, { identityProvider: new IdentityProvider(), collapseByDefault }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a/b', 'b.txt']);\n\n\t\tmodel.get('a').children!.push({\n\t\t\tid: 'c',\n\t\t\tchildren: [{ id: 'c.txt' }]\n\t\t});\n\n\t\tawait tree.updateChildren(model.root, true);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'b.txt', 'c', 'c.txt']);\n\t});\n\n\ttest('Tree Navigation: AsyncDataTree', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa', children: [{ id: 'aa.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'ab', children: [{ id: 'ab.txt' }]\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\tid: 'b', children: [{\n\t\t\t\t\tid: 'ba', children: [{ id: 'ba.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'bb', children: [{ id: 'bb.txt' }]\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\tid: 'c', children: [{\n\t\t\t\t\tid: 'ca', children: [{ id: 'ca.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'cb', children: [{ id: 'cb.txt' }]\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'c']);\n\n\t\tassert.strictEqual(tree.navigate().current(), null);\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'c');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\n\t\tawait tree.expand(model.get('a'));\n\t\tawait tree.expand(model.get('aa'));\n\t\tawait tree.expand(model.get('ab'));\n\n\t\tawait tree.expand(model.get('b'));\n\t\tawait tree.expand(model.get('ba'));\n\t\tawait tree.expand(model.get('bb'));\n\n\t\tawait tree.expand(model.get('c'));\n\t\tawait tree.expand(model.get('ca'));\n\t\tawait tree.expand(model.get('cb'));\n\n\t\t// Only the first 10 elements are rendered (total height is 200px, each element is 20px)\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'aa', 'aa.txt', 'ab', 'ab.txt', 'b', 'ba', 'ba.txt', 'bb', 'bb.txt']);\n\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'cb.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'ab.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'ba');\n\n\t\tassert.strictEqual(tree.navigate(model.get('ab.txt')).previous()?.id, 'ab');\n\t\tassert.strictEqual(tree.navigate(model.get('ab.txt')).next()?.id, 'b');\n\n\t\tassert.strictEqual(tree.navigate(model.get('bb.txt')).next()?.id, 'c');\n\n\t\ttree.collapse(model.get('b'), false);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'aa', 'aa.txt', 'ab', 'ab.txt', 'b', 'c', 'ca', 'ca.txt', 'cb']);\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\t});\n\n\ttest('Test Navigation: CompressibleAsyncDataTree', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst compressionDelegate = new class implements ITreeCompressionDelegate<Element> {\n\t\t\tisIncompressible(element: Element): boolean {\n\t\t\t\treturn !dataSource.hasChildren(element);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: 'a', children: [{ id: 'aa', children: [{ id: 'aa.txt' }] }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'b', children: [{ id: 'ba', children: [{ id: 'ba.txt' }] }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'c', children: [{\n\t\t\t\t\t\tid: 'ca', children: [{ id: 'ca.txt' }]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tid: 'cb', children: [{ id: 'cb.txt' }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tconst tree = store.add(new CompressibleAsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), compressionDelegate, [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'c']);\n\n\t\tassert.strictEqual(tree.navigate().current(), null);\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'c');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\n\t\tawait tree.expand(model.get('a'));\n\t\tawait tree.expand(model.get('aa'));\n\n\t\tawait tree.expand(model.get('b'));\n\t\tawait tree.expand(model.get('ba'));\n\n\t\tawait tree.expand(model.get('c'));\n\t\tawait tree.expand(model.get('ca'));\n\t\tawait tree.expand(model.get('cb'));\n\n\t\t// Only the first 10 elements are rendered (total height is 200px, each element is 20px)\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a/aa', 'aa.txt', 'b/ba', 'ba.txt', 'c', 'ca', 'ca.txt', 'cb', 'cb.txt']);\n\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'aa');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'cb.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'aa.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('ba')).previous()?.id, 'aa.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'ba.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('ba')).next()?.id, 'ba.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('aa.txt')).previous()?.id, 'aa');\n\t\tassert.strictEqual(tree.navigate(model.get('aa.txt')).next()?.id, 'ba');\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable no-restricted-syntax */\n\nimport assert from 'assert';\nimport { IIdentityProvider, IListVirtualDelegate } from '../../../../browser/ui/list/list.js';\nimport { AsyncDataTree, CompressibleAsyncDataTree, ITreeCompressionDelegate } from '../../../../browser/ui/tree/asyncDataTree.js';\nimport { ICompressedTreeNode } from '../../../../browser/ui/tree/compressedObjectTreeModel.js';\nimport { ICompressibleTreeRenderer } from '../../../../browser/ui/tree/objectTree.js';\nimport { IAsyncDataSource, ITreeNode } from '../../../../browser/ui/tree/tree.js';\nimport { timeout } from '../../../../common/async.js';\nimport { Iterable } from '../../../../common/iterator.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../common/utils.js';\nimport { runWithFakedTimers } from '../../../common/timeTravelScheduler.js';\n\ninterface Element {\n\tid: string;\n\tsuffix?: string;\n\tchildren?: Element[];\n}\n\nfunction find(element: Element, id: string): Element | undefined {\n\tif (element.id === id) {\n\t\treturn element;\n\t}\n\n\tif (!element.children) {\n\t\treturn undefined;\n\t}\n\n\tfor (const child of element.children) {\n\t\tconst result = find(child, id);\n\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nclass Renderer implements ICompressibleTreeRenderer<Element, void, HTMLElement> {\n\treadonly templateId = 'default';\n\trenderTemplate(container: HTMLElement): HTMLElement {\n\t\treturn container;\n\t}\n\trenderElement(element: ITreeNode<Element, void>, index: number, templateData: HTMLElement): void {\n\t\ttemplateData.textContent = element.element.id + (element.element.suffix || '');\n\t}\n\tdisposeTemplate(templateData: HTMLElement): void {\n\t\t// noop\n\t}\n\trenderCompressedElements(node: ITreeNode<ICompressedTreeNode<Element>, void>, index: number, templateData: HTMLElement): void {\n\t\tconst result: string[] = [];\n\n\t\tfor (const element of node.element.elements) {\n\t\t\tresult.push(element.id + (element.suffix || ''));\n\t\t}\n\n\t\ttemplateData.textContent = result.join('/');\n\t}\n}\n\nclass IdentityProvider implements IIdentityProvider<Element> {\n\tgetId(element: Element) {\n\t\treturn element.id;\n\t}\n}\n\nclass VirtualDelegate implements IListVirtualDelegate<Element> {\n\tgetHeight() { return 20; }\n\tgetTemplateId(element: Element): string { return 'default'; }\n}\n\nclass DataSource implements IAsyncDataSource<Element, Element> {\n\thasChildren(element: Element): boolean {\n\t\treturn !!element.children && element.children.length > 0;\n\t}\n\tgetChildren(element: Element): Promise<Element[]> {\n\t\treturn Promise.resolve(element.children || []);\n\t}\n}\n\nclass Model {\n\n\tconstructor(readonly root: Element) { }\n\n\tget(id: string): Element {\n\t\tconst result = find(this.root, id);\n\n\t\tif (!result) {\n\t\t\tthrow new Error('element not found');\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nsuite('AsyncDataTree', function () {\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Collapse state should be preserved across refresh calls', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 0);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\tconst twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [\n\t\t\t{ id: 'aa' },\n\t\t\t{ id: 'ab' },\n\t\t\t{ id: 'ac' }\n\t\t];\n\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 4);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t});\n\n\ttest('issue #68648', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\t});\n\n\ttest('issue #67722 - once resolved, refreshed collapsed nodes should only get children when expanded', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\ttree.collapse(model.get('a'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\tawait tree.updateChildren();\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a', 'root'], 'a should not be refreshed, since it\\' collapsed');\n\t});\n\n\ttest('resolved collapsed nodes which lose children should lose twistie as well', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\n\t\ttree.collapse(model.get('a'));\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t});\n\n\ttest('issue #192422 - resolved collapsed nodes with changed children don\\'t show old children', async () => {\n\t\tconst container = document.createElement('div');\n\t\tlet hasGottenAChildren = false;\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element): Promise<Element[]> {\n\t\t\t\tif (element.id === 'a') {\n\t\t\t\t\tif (!hasGottenAChildren) {\n\t\t\t\t\t\thasGottenAChildren = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [{ id: 'c' }];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn element.children || [];\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'b' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tconst a = model.get('a');\n\t\tconst aNode = tree.getNode(a);\n\t\tassert(aNode.collapsed);\n\t\tawait tree.expand(a);\n\t\tassert(!aNode.collapsed);\n\t\tassert.equal(aNode.children.length, 1);\n\t\tassert.equal(aNode.children[0].element.id, 'b');\n\t\tconst bChild = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(bChild?.textContent, 'b');\n\t\ttree.collapse(a);\n\t\tassert(aNode.collapsed);\n\n\t\tawait tree.updateChildren(a);\n\t\tconst aUpdated1 = model.get('a');\n\t\tconst aNodeUpdated1 = tree.getNode(a);\n\t\tassert(aNodeUpdated1.collapsed);\n\t\tassert.equal(aNodeUpdated1.children.length, 0);\n\t\tlet didCheckNoChildren = false;\n\t\tconst event = tree.onDidChangeCollapseState(e => {\n\t\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\t\tassert.equal(child, null);\n\t\t\tdidCheckNoChildren = true;\n\t\t});\n\t\tawait tree.expand(aUpdated1);\n\t\tevent.dispose();\n\t\tassert(didCheckNoChildren);\n\n\t\tconst aNodeUpdated2 = tree.getNode(a);\n\t\tassert(!aNodeUpdated2.collapsed);\n\t\tassert.equal(aNodeUpdated2.children.length, 1);\n\t\tassert.equal(aNodeUpdated2.children[0].element.id, 'c');\n\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(child?.textContent, 'c');\n\t});\n\n\ttest('issue #192422 - resolved collapsed nodes with unchanged children immediately show children', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn element.children || [];\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'b' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tconst a = model.get('a');\n\t\tconst aNode = tree.getNode(a);\n\t\tassert(aNode.collapsed);\n\t\tawait tree.expand(a);\n\t\tassert(!aNode.collapsed);\n\t\tassert.equal(aNode.children.length, 1);\n\t\tassert.equal(aNode.children[0].element.id, 'b');\n\t\tconst bChild = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(bChild?.textContent, 'b');\n\t\ttree.collapse(a);\n\t\tassert(aNode.collapsed);\n\n\t\tconst aUpdated1 = model.get('a');\n\t\tconst aNodeUpdated1 = tree.getNode(a);\n\t\tassert(aNodeUpdated1.collapsed);\n\t\tassert.equal(aNodeUpdated1.children.length, 1);\n\t\tlet didCheckSameChildren = false;\n\t\tconst event = tree.onDidChangeCollapseState(e => {\n\t\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\t\tassert.equal(child?.textContent, 'b');\n\t\t\tdidCheckSameChildren = true;\n\t\t});\n\t\tawait tree.expand(aUpdated1);\n\t\tevent.dispose();\n\t\tassert(didCheckSameChildren);\n\n\t\tconst aNodeUpdated2 = tree.getNode(a);\n\t\tassert(!aNodeUpdated2.collapsed);\n\t\tassert.equal(aNodeUpdated2.children.length, 1);\n\t\tassert.equal(aNodeUpdated2.children[0].element.id, 'b');\n\t\tconst child = container.querySelector('.monaco-list-row:nth-child(2)');\n\t\tassert.equal(child?.textContent, 'b');\n\t});\n\n\ttest('support default collapse state per element', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, {\n\t\t\tcollapseByDefault: el => el.id !== 'a'\n\t\t}));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\t});\n\n\ttest('issue #80098 - concurrent refresh and expand', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Function[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tconst pSetInput = tree.setInput(model.root);\n\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\tawait pSetInput;\n\n\t\tconst pUpdateChildrenA = tree.updateChildren(model.get('a'));\n\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\tassert.strictEqual(calls.length, 1, 'expand(a) still hasn\\'t called getChildren(a)');\n\n\t\tcalls.pop()!();\n\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\tawait pUpdateChildrenA;\n\t\tassert.strictEqual(calls.length, 0, 'expand(a) should not have forced a second refresh');\n\n\t\tconst result = await pExpandA;\n\t\tassert.strictEqual(result, true, 'expand(a) should be done');\n\t});\n\n\ttest('issue #80098 - first expand should call getChildren', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tconst container = document.createElement('div');\n\n\t\t\tconst calls: Function[] = [];\n\t\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\t\thasChildren(element: Element): boolean {\n\t\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t\t}\n\t\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst model = new Model({\n\t\t\t\tid: 'root',\n\t\t\t\tchildren: [{\n\t\t\t\t\tid: 'a', children: [{\n\t\t\t\t\t\tid: 'aa'\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t});\n\n\t\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\t\ttree.layout(200);\n\n\t\t\tconst pSetInput = tree.setInput(model.root);\n\t\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\t\tawait pSetInput;\n\n\t\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\t\tassert.strictEqual(calls.length, 1, 'expand(a) should\\'ve called getChildren(a)');\n\n\t\t\tlet race = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\t\tassert.strictEqual(race, 'timeout', 'expand(a) should not be yet done');\n\n\t\t\tcalls.pop()!();\n\t\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\t\trace = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\t\tassert.strictEqual(race, 'expand', 'expand(a) should now be done');\n\t\t});\n\t});\n\n\ttest('issue #78388 - tree should react to hasChildren toggles', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [{ id: 'aa' }];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t});\n\n\ttest('issues #84569, #82629 - rerender', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a',\n\t\t\t\tchildren: [{\n\t\t\t\t\tid: 'b',\n\t\t\t\t\tsuffix: '1'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b1']);\n\n\t\tconst a = model.get('a');\n\t\tconst b = model.get('b');\n\t\ta.children?.splice(0, 1, { id: 'b', suffix: '2' });\n\n\t\tawait Promise.all([\n\t\t\ttree.updateChildren(a, true, true),\n\t\t\ttree.updateChildren(b, true, true)\n\t\t]);\n\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b2']);\n\t});\n\n\ttest('issue #199264 - dispose during render', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model1 = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\t\tconst model2 = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model1.root);\n\t\tconst input = tree.setInput(model2.root);\n\t\ttree.dispose();\n\t\tawait input;\n\t\tassert.strictEqual(container.innerHTML, '');\n\t});\n\n\ttest('issue #121567', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Element[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\tcalls.push(element);\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\t\tconst a = model.get('a');\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(calls.length, 1, 'There should be a single getChildren call for the root');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should be no changes to the calls list, since a was collapsed');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tconst children = a.children;\n\t\ta.children = [];\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should still be no changes to the calls list, since a was collapsed');\n\t\tassert(!tree.isCollapsible(a), 'a is no longer collapsible');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\ta.children = children;\n\t\tawait tree.updateChildren(a, false);\n\t\tassert.strictEqual(calls.length, 1, 'There should still be no changes to the calls list, since a was collapsed');\n\t\tassert(tree.isCollapsible(a), 'a is collapsible again');\n\t\tassert(tree.isCollapsed(a), 'a is collapsed');\n\n\t\tawait tree.expand(a);\n\t\tassert.strictEqual(calls.length, 2, 'Finally, there should be a getChildren call for a');\n\t\tassert(tree.isCollapsible(a), 'a is still collapsible');\n\t\tassert(!tree.isCollapsed(a), 'a is expanded');\n\t});\n\n\ttest('issue #199441', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst compressionDelegate = new class implements ITreeCompressionDelegate<Element> {\n\t\t\tisIncompressible(element: Element): boolean {\n\t\t\t\treturn !dataSource.hasChildren(element);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'b',\n\t\t\t\t\tchildren: [{ id: 'b.txt' }]\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst collapseByDefault = (element: Element) => false;\n\n\t\tconst tree = store.add(new CompressibleAsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), compressionDelegate, [new Renderer()], dataSource, { identityProvider: new IdentityProvider(), collapseByDefault }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a/b', 'b.txt']);\n\n\t\tmodel.get('a').children!.push({\n\t\t\tid: 'c',\n\t\t\tchildren: [{ id: 'c.txt' }]\n\t\t});\n\n\t\tawait tree.updateChildren(model.root, true);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'b.txt', 'c', 'c.txt']);\n\t});\n\n\ttest('Tree Navigation: AsyncDataTree', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa', children: [{ id: 'aa.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'ab', children: [{ id: 'ab.txt' }]\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\tid: 'b', children: [{\n\t\t\t\t\tid: 'ba', children: [{ id: 'ba.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'bb', children: [{ id: 'bb.txt' }]\n\t\t\t\t}]\n\t\t\t}, {\n\t\t\t\tid: 'c', children: [{\n\t\t\t\t\tid: 'ca', children: [{ id: 'ca.txt' }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'cb', children: [{ id: 'cb.txt' }]\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = store.add(new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'c']);\n\n\t\tassert.strictEqual(tree.navigate().current(), null);\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'c');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\n\t\tawait tree.expand(model.get('a'));\n\t\tawait tree.expand(model.get('aa'));\n\t\tawait tree.expand(model.get('ab'));\n\n\t\tawait tree.expand(model.get('b'));\n\t\tawait tree.expand(model.get('ba'));\n\t\tawait tree.expand(model.get('bb'));\n\n\t\tawait tree.expand(model.get('c'));\n\t\tawait tree.expand(model.get('ca'));\n\t\tawait tree.expand(model.get('cb'));\n\n\t\t// Only the first 10 elements are rendered (total height is 200px, each element is 20px)\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'aa', 'aa.txt', 'ab', 'ab.txt', 'b', 'ba', 'ba.txt', 'bb', 'bb.txt']);\n\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'cb.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'ab.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'ba');\n\n\t\tassert.strictEqual(tree.navigate(model.get('ab.txt')).previous()?.id, 'ab');\n\t\tassert.strictEqual(tree.navigate(model.get('ab.txt')).next()?.id, 'b');\n\n\t\tassert.strictEqual(tree.navigate(model.get('bb.txt')).next()?.id, 'c');\n\n\t\ttree.collapse(model.get('b'), false);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'aa', 'aa.txt', 'ab', 'ab.txt', 'b', 'c', 'ca', 'ca.txt', 'cb']);\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\t});\n\n\ttest('Test Navigation: CompressibleAsyncDataTree', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tasync getChildren(element: Element) {\n\t\t\t\treturn element.children ?? Iterable.empty();\n\t\t\t}\n\t\t};\n\n\t\tconst compressionDelegate = new class implements ITreeCompressionDelegate<Element> {\n\t\t\tisIncompressible(element: Element): boolean {\n\t\t\t\treturn !dataSource.hasChildren(element);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: 'a', children: [{ id: 'aa', children: [{ id: 'aa.txt' }] }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'b', children: [{ id: 'ba', children: [{ id: 'ba.txt' }] }]\n\t\t\t\t}, {\n\t\t\t\t\tid: 'c', children: [{\n\t\t\t\t\t\tid: 'ca', children: [{ id: 'ca.txt' }]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tid: 'cb', children: [{ id: 'cb.txt' }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\n\t\tconst tree = store.add(new CompressibleAsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), compressionDelegate, [new Renderer()], dataSource, { identityProvider: new IdentityProvider() }));\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b', 'c']);\n\n\t\tassert.strictEqual(tree.navigate().current(), null);\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'c');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'a');\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'c');\n\n\t\tawait tree.expand(model.get('a'));\n\t\tawait tree.expand(model.get('aa'));\n\n\t\tawait tree.expand(model.get('b'));\n\t\tawait tree.expand(model.get('ba'));\n\n\t\tawait tree.expand(model.get('c'));\n\t\tawait tree.expand(model.get('ca'));\n\t\tawait tree.expand(model.get('cb'));\n\n\t\t// Only the first 10 elements are rendered (total height is 200px, each element is 20px)\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a/aa', 'aa.txt', 'b/ba', 'ba.txt', 'c', 'ca', 'ca.txt', 'cb', 'cb.txt']);\n\n\t\tassert.strictEqual(tree.navigate().first()?.id, 'aa');\n\t\tassert.strictEqual(tree.navigate().last()?.id, 'cb.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).previous()?.id, 'aa.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('ba')).previous()?.id, 'aa.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('b')).next()?.id, 'ba.txt');\n\t\tassert.strictEqual(tree.navigate(model.get('ba')).next()?.id, 'ba.txt');\n\n\t\tassert.strictEqual(tree.navigate(model.get('aa.txt')).previous()?.id, 'aa');\n\t\tassert.strictEqual(tree.navigate(model.get('aa.txt')).next()?.id, 'ba');\n\t});\n});\n"]}