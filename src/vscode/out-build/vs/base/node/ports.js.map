{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/base/node/ports.ts","vs/base/node/ports.ts"],"names":[],"mappings":"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","file":"ports.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as net from 'net';\n\n/**\n * Given a start point and a max number of retries, will find a port that\n * is openable. Will return 0 in case no free port can be found.\n */\nexport function findFreePort(startPort: number, giveUpAfter: number, timeout: number, stride = 1): Promise<number> {\n\tlet done = false;\n\n\treturn new Promise(resolve => {\n\t\tconst timeoutHandle = setTimeout(() => {\n\t\t\tif (!done) {\n\t\t\t\tdone = true;\n\t\t\t\treturn resolve(0);\n\t\t\t}\n\t\t}, timeout);\n\n\t\tdoFindFreePort(startPort, giveUpAfter, stride, (port) => {\n\t\t\tif (!done) {\n\t\t\t\tdone = true;\n\t\t\t\tclearTimeout(timeoutHandle);\n\t\t\t\treturn resolve(port);\n\t\t\t}\n\t\t});\n\t});\n}\n\nfunction doFindFreePort(startPort: number, giveUpAfter: number, stride: number, clb: (port: number) => void): void {\n\tif (giveUpAfter === 0) {\n\t\treturn clb(0);\n\t}\n\n\tconst client = new net.Socket();\n\n\t// If we can connect to the port it means the port is already taken so we continue searching\n\tclient.once('connect', () => {\n\t\tdispose(client);\n\n\t\treturn doFindFreePort(startPort + stride, giveUpAfter - 1, stride, clb);\n\t});\n\n\tclient.once('data', () => {\n\t\t// this listener is required since node.js 8.x\n\t});\n\n\tclient.once('error', (err: Error & { code?: string }) => {\n\t\tdispose(client);\n\n\t\t// If we receive any non ECONNREFUSED error, it means the port is used but we cannot connect\n\t\tif (err.code !== 'ECONNREFUSED') {\n\t\t\treturn doFindFreePort(startPort + stride, giveUpAfter - 1, stride, clb);\n\t\t}\n\n\t\t// Otherwise it means the port is free to use!\n\t\treturn clb(startPort);\n\t});\n\n\tclient.connect(startPort, '127.0.0.1');\n}\n\n// Reference: https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/net/base/port_util.cc#56\nexport const BROWSER_RESTRICTED_PORTS: Record<number, boolean> = {\n\t1: true,      // tcpmux\n\t7: true,      // echo\n\t9: true,      // discard\n\t11: true,     // systat\n\t13: true,     // daytime\n\t15: true,     // netstat\n\t17: true,     // qotd\n\t19: true,     // chargen\n\t20: true,     // ftp data\n\t21: true,     // ftp access\n\t22: true,     // ssh\n\t23: true,     // telnet\n\t25: true,     // smtp\n\t37: true,     // time\n\t42: true,     // name\n\t43: true,     // nicname\n\t53: true,     // domain\n\t69: true,     // tftp\n\t77: true,     // priv-rjs\n\t79: true,     // finger\n\t87: true,     // ttylink\n\t95: true,     // supdup\n\t101: true,    // hostriame\n\t102: true,    // iso-tsap\n\t103: true,    // gppitnp\n\t104: true,    // acr-nema\n\t109: true,    // pop2\n\t110: true,    // pop3\n\t111: true,    // sunrpc\n\t113: true,    // auth\n\t115: true,    // sftp\n\t117: true,    // uucp-path\n\t119: true,    // nntp\n\t123: true,    // NTP\n\t135: true,    // loc-srv /epmap\n\t137: true,    // netbios\n\t139: true,    // netbios\n\t143: true,    // imap2\n\t161: true,    // snmp\n\t179: true,    // BGP\n\t389: true,    // ldap\n\t427: true,    // SLP (Also used by Apple Filing Protocol)\n\t465: true,    // smtp+ssl\n\t512: true,    // print / exec\n\t513: true,    // login\n\t514: true,    // shell\n\t515: true,    // printer\n\t526: true,    // tempo\n\t530: true,    // courier\n\t531: true,    // chat\n\t532: true,    // netnews\n\t540: true,    // uucp\n\t548: true,    // AFP (Apple Filing Protocol)\n\t554: true,    // rtsp\n\t556: true,    // remotefs\n\t563: true,    // nntp+ssl\n\t587: true,    // smtp (rfc6409)\n\t601: true,    // syslog-conn (rfc3195)\n\t636: true,    // ldap+ssl\n\t989: true,    // ftps-data\n\t990: true,    // ftps\n\t993: true,    // ldap+ssl\n\t995: true,    // pop3+ssl\n\t1719: true,   // h323gatestat\n\t1720: true,   // h323hostcall\n\t1723: true,   // pptp\n\t2049: true,   // nfs\n\t3659: true,   // apple-sasl / PasswordServer\n\t4045: true,   // lockd\n\t5060: true,   // sip\n\t5061: true,   // sips\n\t6000: true,   // X11\n\t6566: true,   // sane-port\n\t6665: true,   // Alternate IRC [Apple addition]\n\t6666: true,   // Alternate IRC [Apple addition]\n\t6667: true,   // Standard IRC [Apple addition]\n\t6668: true,   // Alternate IRC [Apple addition]\n\t6669: true,   // Alternate IRC [Apple addition]\n\t6697: true,   // IRC + TLS\n\t10080: true   // Amanda\n};\n\nexport function isPortFree(port: number, timeout: number): Promise<boolean> {\n\treturn findFreePortFaster(port, 0, timeout).then(port => port !== 0);\n}\n\ninterface ServerError {\n\tcode?: string;\n}\n\n/**\n * Uses listen instead of connect. Is faster, but if there is another listener on 0.0.0.0 then this will take 127.0.0.1 from that listener.\n */\nexport function findFreePortFaster(startPort: number, giveUpAfter: number, timeout: number, hostname: string = '127.0.0.1'): Promise<number> {\n\tlet resolved: boolean = false;\n\tlet timeoutHandle: Timeout | undefined = undefined;\n\tlet countTried: number = 1;\n\tconst server = net.createServer({ pauseOnConnect: true });\n\tfunction doResolve(port: number, resolve: (port: number) => void) {\n\t\tif (!resolved) {\n\t\t\tresolved = true;\n\t\t\tserver.removeAllListeners();\n\t\t\tserver.close();\n\t\t\tif (timeoutHandle) {\n\t\t\t\tclearTimeout(timeoutHandle);\n\t\t\t}\n\t\t\tresolve(port);\n\t\t}\n\t}\n\treturn new Promise<number>(resolve => {\n\t\ttimeoutHandle = setTimeout(() => {\n\t\t\tdoResolve(0, resolve);\n\t\t}, timeout);\n\n\t\tserver.on('listening', () => {\n\t\t\tdoResolve(startPort, resolve);\n\t\t});\n\t\tserver.on('error', (err: ServerError) => {\n\t\t\tif (err && (err.code === 'EADDRINUSE' || err.code === 'EACCES') && (countTried < giveUpAfter)) {\n\t\t\t\tstartPort++;\n\t\t\t\tcountTried++;\n\t\t\t\tserver.listen(startPort, hostname);\n\t\t\t} else {\n\t\t\t\tdoResolve(0, resolve);\n\t\t\t}\n\t\t});\n\t\tserver.on('close', () => {\n\t\t\tdoResolve(0, resolve);\n\t\t});\n\t\tserver.listen(startPort, hostname);\n\t});\n}\n\nfunction dispose(socket: net.Socket): void {\n\ttry {\n\t\tsocket.removeAllListeners('connect');\n\t\tsocket.removeAllListeners('error');\n\t\tsocket.end();\n\t\tsocket.destroy();\n\t\tsocket.unref();\n\t} catch (error) {\n\t\tconsole.error(error); // otherwise this error would get lost in the callback chain\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as net from 'net';\n\n/**\n * Given a start point and a max number of retries, will find a port that\n * is openable. Will return 0 in case no free port can be found.\n */\nexport function findFreePort(startPort: number, giveUpAfter: number, timeout: number, stride = 1): Promise<number> {\n\tlet done = false;\n\n\treturn new Promise(resolve => {\n\t\tconst timeoutHandle = setTimeout(() => {\n\t\t\tif (!done) {\n\t\t\t\tdone = true;\n\t\t\t\treturn resolve(0);\n\t\t\t}\n\t\t}, timeout);\n\n\t\tdoFindFreePort(startPort, giveUpAfter, stride, (port) => {\n\t\t\tif (!done) {\n\t\t\t\tdone = true;\n\t\t\t\tclearTimeout(timeoutHandle);\n\t\t\t\treturn resolve(port);\n\t\t\t}\n\t\t});\n\t});\n}\n\nfunction doFindFreePort(startPort: number, giveUpAfter: number, stride: number, clb: (port: number) => void): void {\n\tif (giveUpAfter === 0) {\n\t\treturn clb(0);\n\t}\n\n\tconst client = new net.Socket();\n\n\t// If we can connect to the port it means the port is already taken so we continue searching\n\tclient.once('connect', () => {\n\t\tdispose(client);\n\n\t\treturn doFindFreePort(startPort + stride, giveUpAfter - 1, stride, clb);\n\t});\n\n\tclient.once('data', () => {\n\t\t// this listener is required since node.js 8.x\n\t});\n\n\tclient.once('error', (err: Error & { code?: string }) => {\n\t\tdispose(client);\n\n\t\t// If we receive any non ECONNREFUSED error, it means the port is used but we cannot connect\n\t\tif (err.code !== 'ECONNREFUSED') {\n\t\t\treturn doFindFreePort(startPort + stride, giveUpAfter - 1, stride, clb);\n\t\t}\n\n\t\t// Otherwise it means the port is free to use!\n\t\treturn clb(startPort);\n\t});\n\n\tclient.connect(startPort, '127.0.0.1');\n}\n\n// Reference: https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/net/base/port_util.cc#56\nexport const BROWSER_RESTRICTED_PORTS: Record<number, boolean> = {\n\t1: true,      // tcpmux\n\t7: true,      // echo\n\t9: true,      // discard\n\t11: true,     // systat\n\t13: true,     // daytime\n\t15: true,     // netstat\n\t17: true,     // qotd\n\t19: true,     // chargen\n\t20: true,     // ftp data\n\t21: true,     // ftp access\n\t22: true,     // ssh\n\t23: true,     // telnet\n\t25: true,     // smtp\n\t37: true,     // time\n\t42: true,     // name\n\t43: true,     // nicname\n\t53: true,     // domain\n\t69: true,     // tftp\n\t77: true,     // priv-rjs\n\t79: true,     // finger\n\t87: true,     // ttylink\n\t95: true,     // supdup\n\t101: true,    // hostriame\n\t102: true,    // iso-tsap\n\t103: true,    // gppitnp\n\t104: true,    // acr-nema\n\t109: true,    // pop2\n\t110: true,    // pop3\n\t111: true,    // sunrpc\n\t113: true,    // auth\n\t115: true,    // sftp\n\t117: true,    // uucp-path\n\t119: true,    // nntp\n\t123: true,    // NTP\n\t135: true,    // loc-srv /epmap\n\t137: true,    // netbios\n\t139: true,    // netbios\n\t143: true,    // imap2\n\t161: true,    // snmp\n\t179: true,    // BGP\n\t389: true,    // ldap\n\t427: true,    // SLP (Also used by Apple Filing Protocol)\n\t465: true,    // smtp+ssl\n\t512: true,    // print / exec\n\t513: true,    // login\n\t514: true,    // shell\n\t515: true,    // printer\n\t526: true,    // tempo\n\t530: true,    // courier\n\t531: true,    // chat\n\t532: true,    // netnews\n\t540: true,    // uucp\n\t548: true,    // AFP (Apple Filing Protocol)\n\t554: true,    // rtsp\n\t556: true,    // remotefs\n\t563: true,    // nntp+ssl\n\t587: true,    // smtp (rfc6409)\n\t601: true,    // syslog-conn (rfc3195)\n\t636: true,    // ldap+ssl\n\t989: true,    // ftps-data\n\t990: true,    // ftps\n\t993: true,    // ldap+ssl\n\t995: true,    // pop3+ssl\n\t1719: true,   // h323gatestat\n\t1720: true,   // h323hostcall\n\t1723: true,   // pptp\n\t2049: true,   // nfs\n\t3659: true,   // apple-sasl / PasswordServer\n\t4045: true,   // lockd\n\t5060: true,   // sip\n\t5061: true,   // sips\n\t6000: true,   // X11\n\t6566: true,   // sane-port\n\t6665: true,   // Alternate IRC [Apple addition]\n\t6666: true,   // Alternate IRC [Apple addition]\n\t6667: true,   // Standard IRC [Apple addition]\n\t6668: true,   // Alternate IRC [Apple addition]\n\t6669: true,   // Alternate IRC [Apple addition]\n\t6697: true,   // IRC + TLS\n\t10080: true   // Amanda\n};\n\nexport function isPortFree(port: number, timeout: number): Promise<boolean> {\n\treturn findFreePortFaster(port, 0, timeout).then(port => port !== 0);\n}\n\ninterface ServerError {\n\tcode?: string;\n}\n\n/**\n * Uses listen instead of connect. Is faster, but if there is another listener on 0.0.0.0 then this will take 127.0.0.1 from that listener.\n */\nexport function findFreePortFaster(startPort: number, giveUpAfter: number, timeout: number, hostname: string = '127.0.0.1'): Promise<number> {\n\tlet resolved: boolean = false;\n\tlet timeoutHandle: Timeout | undefined = undefined;\n\tlet countTried: number = 1;\n\tconst server = net.createServer({ pauseOnConnect: true });\n\tfunction doResolve(port: number, resolve: (port: number) => void) {\n\t\tif (!resolved) {\n\t\t\tresolved = true;\n\t\t\tserver.removeAllListeners();\n\t\t\tserver.close();\n\t\t\tif (timeoutHandle) {\n\t\t\t\tclearTimeout(timeoutHandle);\n\t\t\t}\n\t\t\tresolve(port);\n\t\t}\n\t}\n\treturn new Promise<number>(resolve => {\n\t\ttimeoutHandle = setTimeout(() => {\n\t\t\tdoResolve(0, resolve);\n\t\t}, timeout);\n\n\t\tserver.on('listening', () => {\n\t\t\tdoResolve(startPort, resolve);\n\t\t});\n\t\tserver.on('error', (err: ServerError) => {\n\t\t\tif (err && (err.code === 'EADDRINUSE' || err.code === 'EACCES') && (countTried < giveUpAfter)) {\n\t\t\t\tstartPort++;\n\t\t\t\tcountTried++;\n\t\t\t\tserver.listen(startPort, hostname);\n\t\t\t} else {\n\t\t\t\tdoResolve(0, resolve);\n\t\t\t}\n\t\t});\n\t\tserver.on('close', () => {\n\t\t\tdoResolve(0, resolve);\n\t\t});\n\t\tserver.listen(startPort, hostname);\n\t});\n}\n\nfunction dispose(socket: net.Socket): void {\n\ttry {\n\t\tsocket.removeAllListeners('connect');\n\t\tsocket.removeAllListeners('error');\n\t\tsocket.end();\n\t\tsocket.destroy();\n\t\tsocket.unref();\n\t} catch (error) {\n\t\tconsole.error(error); // otherwise this error would get lost in the callback chain\n\t}\n}\n"]}