{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/node/extHostConsoleForwarder.ts","vs/workbench/api/node/extHostConsoleForwarder.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,+BAA+B,EAAE,MAAM,sCAAsC,CAAC;AACvF,OAAO,EAAE,uBAAuB,EAAE,MAAM,qCAAqC,CAAC;AAC9E,OAAO,EAAE,kBAAkB,EAAE,MAAM,gCAAgC,CAAC;AAGpE,MAAM,wBAAwB,GAAG,IAAI,GAAG,IAAI,CAAC;AAEtC,IAAM,uBAAuB,GAA7B,MAAM,uBAAwB,SAAQ,+BAA+B;IAI3E,YACqB,UAA8B,EACzB,QAAiC;QAE1D,KAAK,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QANrB,yBAAoB,GAAY,KAAK,CAAC;QAQ7C,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACpC,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;IACnC,CAAC;IAEkB,wBAAwB,CAAC,MAAmD,EAAE,QAAkC,EAAE,IAAgB;QACpJ,MAAM,MAAM,GAAG,MAAM,KAAK,OAAO,IAAI,MAAM,KAAK,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;QACzF,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QACjC,MAAM,CAAC,KAAK,CAAC,KAAK,+CAAsB,IAAI,CAAC,CAAC;QAC9C,mDAAmD;QACnD,QAAQ,CAAC,KAAK,CAAC,OAAO,EAAE,IAAW,CAAC,CAAC;QACrC,MAAM,CAAC,KAAK,CAAC,KAAK,2CAAoB,IAAI,CAAC,CAAC;QAC5C,IAAI,CAAC,oBAAoB,GAAG,KAAK,CAAC;IACnC,CAAC;IAED;;;;;OAKG;IACK,WAAW,CAAC,UAA+B,EAAE,QAAkC;QACtF,MAAM,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;QACnC,MAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC;QAE9B,IAAI,GAAG,GAAG,EAAE,CAAC;QAEb,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,OAAO,EAAE;YACtC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YACd,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,KAA0B,EAAE,QAAyB,EAAE,QAAuC,EAAE,EAAE;gBAC7G,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC;oBAChC,mDAAmD;oBACnD,GAAG,IAAK,KAAa,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;oBACzC,MAAM,GAAG,GAAG,GAAG,CAAC,MAAM,GAAG,wBAAwB,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;oBACvF,IAAI,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC;wBAChB,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;wBACrC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;oBAC1B,CAAC;gBACF,CAAC;gBAED,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YAClD,CAAC;SACD,CAAC,CAAC;IACJ,CAAC;CACD,CAAA;AArDY,uBAAuB;IAKjC,WAAA,kBAAkB,CAAA;IAClB,WAAA,uBAAuB,CAAA;GANb,uBAAuB,CAqDnC","file":"extHostConsoleForwarder.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AbstractExtHostConsoleForwarder } from '../common/extHostConsoleForwarder.js';\nimport { IExtHostInitDataService } from '../common/extHostInitDataService.js';\nimport { IExtHostRpcService } from '../common/extHostRpcService.js';\nimport { NativeLogMarkers } from '../../services/extensions/common/extensionHostProtocol.js';\n\nconst MAX_STREAM_BUFFER_LENGTH = 1024 * 1024;\n\nexport class ExtHostConsoleForwarder extends AbstractExtHostConsoleForwarder {\n\n\tprivate _isMakingConsoleCall: boolean = false;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tsuper(extHostRpc, initData);\n\n\t\tthis._wrapStream('stderr', 'error');\n\t\tthis._wrapStream('stdout', 'log');\n\t}\n\n\tprotected override _nativeConsoleLogMessage(method: 'log' | 'info' | 'warn' | 'error' | 'debug', original: (...args: any[]) => void, args: IArguments) {\n\t\tconst stream = method === 'error' || method === 'warn' ? process.stderr : process.stdout;\n\t\tthis._isMakingConsoleCall = true;\n\t\tstream.write(`\\n${NativeLogMarkers.Start}\\n`);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\toriginal.apply(console, args as any);\n\t\tstream.write(`\\n${NativeLogMarkers.End}\\n`);\n\t\tthis._isMakingConsoleCall = false;\n\t}\n\n\t/**\n\t * Wraps process.stderr/stdout.write() so that it is transmitted to the\n\t * renderer or CLI. It both calls through to the original method as well\n\t * as to console.log with complete lines so that they're made available\n\t * to the debugger/CLI.\n\t */\n\tprivate _wrapStream(streamName: 'stdout' | 'stderr', severity: 'log' | 'warn' | 'error') {\n\t\tconst stream = process[streamName];\n\t\tconst original = stream.write;\n\n\t\tlet buf = '';\n\n\t\tObject.defineProperty(stream, 'write', {\n\t\t\tset: () => { },\n\t\t\tget: () => (chunk: Uint8Array | string, encoding?: BufferEncoding, callback?: (err?: Error | null) => void) => {\n\t\t\t\tif (!this._isMakingConsoleCall) {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\tbuf += (chunk as any).toString(encoding);\n\t\t\t\t\tconst eol = buf.length > MAX_STREAM_BUFFER_LENGTH ? buf.length : buf.lastIndexOf('\\n');\n\t\t\t\t\tif (eol !== -1) {\n\t\t\t\t\t\tconsole[severity](buf.slice(0, eol));\n\t\t\t\t\t\tbuf = buf.slice(eol + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toriginal.call(stream, chunk, encoding, callback);\n\t\t\t},\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AbstractExtHostConsoleForwarder } from '../common/extHostConsoleForwarder.js';\nimport { IExtHostInitDataService } from '../common/extHostInitDataService.js';\nimport { IExtHostRpcService } from '../common/extHostRpcService.js';\nimport { NativeLogMarkers } from '../../services/extensions/common/extensionHostProtocol.js';\n\nconst MAX_STREAM_BUFFER_LENGTH = 1024 * 1024;\n\nexport class ExtHostConsoleForwarder extends AbstractExtHostConsoleForwarder {\n\n\tprivate _isMakingConsoleCall: boolean = false;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tsuper(extHostRpc, initData);\n\n\t\tthis._wrapStream('stderr', 'error');\n\t\tthis._wrapStream('stdout', 'log');\n\t}\n\n\tprotected override _nativeConsoleLogMessage(method: 'log' | 'info' | 'warn' | 'error' | 'debug', original: (...args: any[]) => void, args: IArguments) {\n\t\tconst stream = method === 'error' || method === 'warn' ? process.stderr : process.stdout;\n\t\tthis._isMakingConsoleCall = true;\n\t\tstream.write(`\\n${NativeLogMarkers.Start}\\n`);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\toriginal.apply(console, args as any);\n\t\tstream.write(`\\n${NativeLogMarkers.End}\\n`);\n\t\tthis._isMakingConsoleCall = false;\n\t}\n\n\t/**\n\t * Wraps process.stderr/stdout.write() so that it is transmitted to the\n\t * renderer or CLI. It both calls through to the original method as well\n\t * as to console.log with complete lines so that they're made available\n\t * to the debugger/CLI.\n\t */\n\tprivate _wrapStream(streamName: 'stdout' | 'stderr', severity: 'log' | 'warn' | 'error') {\n\t\tconst stream = process[streamName];\n\t\tconst original = stream.write;\n\n\t\tlet buf = '';\n\n\t\tObject.defineProperty(stream, 'write', {\n\t\t\tset: () => { },\n\t\t\tget: () => (chunk: Uint8Array | string, encoding?: BufferEncoding, callback?: (err?: Error | null) => void) => {\n\t\t\t\tif (!this._isMakingConsoleCall) {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\tbuf += (chunk as any).toString(encoding);\n\t\t\t\t\tconst eol = buf.length > MAX_STREAM_BUFFER_LENGTH ? buf.length : buf.lastIndexOf('\\n');\n\t\t\t\t\tif (eol !== -1) {\n\t\t\t\t\t\tconsole[severity](buf.slice(0, eol));\n\t\t\t\t\t\tbuf = buf.slice(eol + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toriginal.call(stream, chunk, encoding, callback);\n\t\t\t},\n\t\t});\n\t}\n}\n"]}