{"version":3,"sources":["vs/workbench/api/browser/mainThreadMessageService.ts"],"names":[],"mappings":"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","file":"mainThreadMessageService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../nls.js';\nimport Severity from '../../../base/common/severity.js';\nimport { IAction, toAction } from '../../../base/common/actions.js';\nimport { MainThreadMessageServiceShape, MainContext, MainThreadMessageOptions } from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { IDialogService, IPromptButton } from '../../../platform/dialogs/common/dialogs.js';\nimport { INotificationService, INotificationSource, NotificationPriority } from '../../../platform/notification/common/notification.js';\nimport { Event } from '../../../base/common/event.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IExtensionService } from '../../services/extensions/common/extensions.js';\nimport { IDisposable } from '../../../base/common/lifecycle.js';\n\n@extHostNamedCustomer(MainContext.MainThreadMessageService)\nexport class MainThreadMessageService implements MainThreadMessageServiceShape {\n\n\tprivate extensionsListener: IDisposable;\n\n\tprivate static readonly URGENT_NOTIFICATION_SOURCES = [\n\t\t'vscode.github-authentication',\n\t\t'vscode.microsoft-authentication'\n\t];\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IDialogService private readonly _dialogService: IDialogService,\n\t\t@IExtensionService extensionService: IExtensionService\n\t) {\n\t\tthis.extensionsListener = extensionService.onDidChangeExtensions(e => {\n\t\t\tfor (const extension of e.removed) {\n\t\t\t\tthis._notificationService.removeFilter(extension.identifier.value);\n\t\t\t}\n\t\t});\n\t}\n\n\tdispose(): void {\n\t\tthis.extensionsListener.dispose();\n\t}\n\n\t$showMessage(severity: Severity, message: string, options: MainThreadMessageOptions, commands: { title: string; isCloseAffordance: boolean; handle: number }[]): Promise<number | undefined> {\n\t\tif (options.modal) {\n\t\t\treturn this._showModalMessage(severity, message, options.detail, commands, options.useCustom);\n\t\t} else {\n\t\t\treturn this._showMessage(severity, message, commands, options);\n\t\t}\n\t}\n\n\tprivate _showMessage(severity: Severity, message: string, commands: { title: string; isCloseAffordance: boolean; handle: number }[], options: MainThreadMessageOptions): Promise<number | undefined> {\n\n\t\treturn new Promise<number | undefined>(resolve => {\n\n\t\t\tconst primaryActions: IAction[] = commands.map(command => toAction({\n\t\t\t\tid: `_extension_message_handle_${command.handle}`,\n\t\t\t\tlabel: command.title,\n\t\t\t\tenabled: true,\n\t\t\t\trun: () => {\n\t\t\t\t\tresolve(command.handle);\n\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tlet source: string | INotificationSource | undefined;\n\t\t\tlet sourceIsUrgent = false;\n\t\t\tif (options.source) {\n\t\t\t\tsource = {\n\t\t\t\t\tlabel: options.source.label,\n\t\t\t\t\tid: options.source.identifier.value\n\t\t\t\t};\n\t\t\t\tsourceIsUrgent = MainThreadMessageService.URGENT_NOTIFICATION_SOURCES.includes(source.id);\n\t\t\t}\n\n\t\t\tif (!source) {\n\t\t\t\tsource = nls.localize('defaultSource', \"Extension\");\n\t\t\t}\n\n\t\t\tconst secondaryActions: IAction[] = [];\n\t\t\tif (options.source) {\n\t\t\t\tsecondaryActions.push(toAction({\n\t\t\t\t\tid: options.source.identifier.value,\n\t\t\t\t\tlabel: nls.localize('manageExtension', \"Manage Extension\"),\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\treturn this._commandService.executeCommand('_extensions.manage', options.source!.identifier.value);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tconst messageHandle = this._notificationService.notify({\n\t\t\t\tseverity,\n\t\t\t\tmessage,\n\t\t\t\tactions: { primary: primaryActions, secondary: secondaryActions },\n\t\t\t\tsource,\n\t\t\t\tpriority: sourceIsUrgent ? NotificationPriority.URGENT : NotificationPriority.DEFAULT,\n\t\t\t\tsticky: sourceIsUrgent\n\t\t\t});\n\n\t\t\t// if promise has not been resolved yet, now is the time to ensure a return value\n\t\t\t// otherwise if already resolved it means the user clicked one of the buttons\n\t\t\tEvent.once(messageHandle.onDidClose)(() => {\n\t\t\t\tresolve(undefined);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async _showModalMessage(severity: Severity, message: string, detail: string | undefined, commands: { title: string; isCloseAffordance: boolean; handle: number }[], useCustom?: boolean): Promise<number | undefined> {\n\t\tconst buttons: IPromptButton<number>[] = [];\n\t\tlet cancelButton: IPromptButton<number | undefined> | undefined = undefined;\n\n\t\tfor (const command of commands) {\n\t\t\tconst button: IPromptButton<number> = {\n\t\t\t\tlabel: command.title,\n\t\t\t\trun: () => command.handle\n\t\t\t};\n\n\t\t\tif (command.isCloseAffordance) {\n\t\t\t\tcancelButton = button;\n\t\t\t} else {\n\t\t\t\tbuttons.push(button);\n\t\t\t}\n\t\t}\n\n\t\tif (!cancelButton) {\n\t\t\tif (buttons.length > 0) {\n\t\t\t\tcancelButton = {\n\t\t\t\t\tlabel: nls.localize('cancel', \"Cancel\"),\n\t\t\t\t\trun: () => undefined\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tcancelButton = {\n\t\t\t\t\tlabel: nls.localize({ key: 'ok', comment: ['&& denotes a mnemonic'] }, \"&&OK\"),\n\t\t\t\t\trun: () => undefined\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst { result } = await this._dialogService.prompt({\n\t\t\ttype: severity,\n\t\t\tmessage,\n\t\t\tdetail,\n\t\t\tbuttons,\n\t\t\tcancelButton,\n\t\t\tcustom: useCustom\n\t\t});\n\n\t\treturn result;\n\t}\n}\n"]}