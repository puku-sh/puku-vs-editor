{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadSCM.ts","vs/workbench/api/browser/mainThreadSCM.ts"],"names":[],"mappings":"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","file":"mainThreadSCM.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Barrier } from '../../../base/common/async.js';\nimport { isUriComponents, URI, UriComponents } from '../../../base/common/uri.js';\nimport { Event, Emitter } from '../../../base/common/event.js';\nimport { IObservable, observableValue, observableValueOpts, transaction } from '../../../base/common/observable.js';\nimport { IDisposable, DisposableStore, combinedDisposable, dispose, Disposable } from '../../../base/common/lifecycle.js';\nimport { ISCMService, ISCMRepository, ISCMProvider, ISCMResource, ISCMResourceGroup, ISCMResourceDecorations, IInputValidation, ISCMViewService, InputValidationType, ISCMActionButtonDescriptor } from '../../contrib/scm/common/scm.js';\nimport { ExtHostContext, MainThreadSCMShape, ExtHostSCMShape, SCMProviderFeatures, SCMRawResourceSplices, SCMGroupFeatures, MainContext, SCMHistoryItemDto, SCMHistoryItemRefsChangeEventDto, SCMHistoryItemRefDto } from '../common/extHost.protocol.js';\nimport { Command } from '../../../editor/common/languages.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { MarshalledId } from '../../../base/common/marshallingIds.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport { IMarkdownString } from '../../../base/common/htmlContent.js';\nimport { IQuickDiffService } from '../../contrib/scm/common/quickDiff.js';\nimport { ISCMHistoryItem, ISCMHistoryItemChange, ISCMHistoryItemRef, ISCMHistoryItemRefsChangeEvent, ISCMHistoryOptions, ISCMHistoryProvider } from '../../contrib/scm/common/history.js';\nimport { ResourceTree } from '../../../base/common/resourceTree.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { ILanguageService } from '../../../editor/common/languages/language.js';\nimport { IModelService } from '../../../editor/common/services/model.js';\nimport { ITextModelContentProvider, ITextModelService } from '../../../editor/common/services/resolverService.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { ITextModel } from '../../../editor/common/model.js';\nimport { structuralEquals } from '../../../base/common/equals.js';\nimport { historyItemBaseRefColor, historyItemRefColor, historyItemRemoteRefColor } from '../../contrib/scm/browser/scmHistory.js';\nimport { ColorIdentifier } from '../../../platform/theme/common/colorUtils.js';\nimport { ISCMArtifact, ISCMArtifactGroup, ISCMArtifactProvider } from '../../contrib/scm/common/artifact.js';\n\nfunction getIconFromIconDto(iconDto?: UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon): URI | { light: URI; dark: URI } | ThemeIcon | undefined {\n\tif (iconDto === undefined) {\n\t\treturn undefined;\n\t} else if (ThemeIcon.isThemeIcon(iconDto)) {\n\t\treturn iconDto;\n\t} else if (isUriComponents(iconDto)) {\n\t\treturn URI.revive(iconDto);\n\t} else {\n\t\tconst icon = iconDto as { light: UriComponents; dark: UriComponents };\n\t\treturn { light: URI.revive(icon.light), dark: URI.revive(icon.dark) };\n\t}\n}\n\nfunction toISCMHistoryItem(historyItemDto: SCMHistoryItemDto): ISCMHistoryItem {\n\tconst authorIcon = getIconFromIconDto(historyItemDto.authorIcon);\n\n\tconst references = historyItemDto.references?.map(r => ({\n\t\t...r, icon: getIconFromIconDto(r.icon)\n\t}));\n\n\treturn { ...historyItemDto, authorIcon, references };\n}\n\nfunction toISCMHistoryItemRef(historyItemRefDto?: SCMHistoryItemRefDto, color?: ColorIdentifier): ISCMHistoryItemRef | undefined {\n\treturn historyItemRefDto ? { ...historyItemRefDto, icon: getIconFromIconDto(historyItemRefDto.icon), color: color } : undefined;\n}\n\nclass SCMInputBoxContentProvider extends Disposable implements ITextModelContentProvider {\n\tconstructor(\n\t\ttextModelService: ITextModelService,\n\t\tprivate readonly modelService: IModelService,\n\t\tprivate readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(Schemas.vscodeSourceControl, this));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this.modelService.getModel(resource);\n\t\tif (existing) {\n\t\t\treturn existing;\n\t\t}\n\t\treturn this.modelService.createModel('', this.languageService.createById('scminput'), resource);\n\t}\n}\n\nclass MainThreadSCMResourceGroup implements ISCMResourceGroup {\n\n\treadonly resources: ISCMResource[] = [];\n\n\tprivate _resourceTree: ResourceTree<ISCMResource, ISCMResourceGroup> | undefined;\n\tget resourceTree(): ResourceTree<ISCMResource, ISCMResourceGroup> {\n\t\tif (!this._resourceTree) {\n\t\t\tconst rootUri = this.provider.rootUri ?? URI.file('/');\n\t\t\tthis._resourceTree = new ResourceTree<ISCMResource, ISCMResourceGroup>(this, rootUri, this._uriIdentService.extUri);\n\t\t\tfor (const resource of this.resources) {\n\t\t\t\tthis._resourceTree.add(resource.sourceUri, resource);\n\t\t\t}\n\t\t}\n\n\t\treturn this._resourceTree;\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<void>();\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tprivate readonly _onDidChangeResources = new Emitter<void>();\n\treadonly onDidChangeResources = this._onDidChangeResources.event;\n\n\tget hideWhenEmpty(): boolean { return !!this.features.hideWhenEmpty; }\n\n\tget contextValue(): string | undefined { return this.features.contextValue; }\n\n\tconstructor(\n\t\tprivate readonly sourceControlHandle: number,\n\t\tprivate readonly handle: number,\n\t\tpublic provider: ISCMProvider,\n\t\tpublic features: SCMGroupFeatures,\n\t\tpublic label: string,\n\t\tpublic id: string,\n\t\tpublic readonly multiDiffEditorEnableViewChanges: boolean,\n\t\tprivate readonly _uriIdentService: IUriIdentityService\n\t) { }\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmResourceGroup,\n\t\t\tsourceControlHandle: this.sourceControlHandle,\n\t\t\tgroupHandle: this.handle\n\t\t};\n\t}\n\n\tsplice(start: number, deleteCount: number, toInsert: ISCMResource[]) {\n\t\tthis.resources.splice(start, deleteCount, ...toInsert);\n\t\tthis._resourceTree = undefined;\n\n\t\tthis._onDidChangeResources.fire();\n\t}\n\n\t$updateGroup(features: SCMGroupFeatures): void {\n\t\tthis.features = { ...this.features, ...features };\n\t\tthis._onDidChange.fire();\n\t}\n\n\t$updateGroupLabel(label: string): void {\n\t\tthis.label = label;\n\t\tthis._onDidChange.fire();\n\t}\n}\n\nclass MainThreadSCMResource implements ISCMResource {\n\n\tconstructor(\n\t\tprivate readonly proxy: ExtHostSCMShape,\n\t\tprivate readonly sourceControlHandle: number,\n\t\tprivate readonly groupHandle: number,\n\t\tprivate readonly handle: number,\n\t\treadonly sourceUri: URI,\n\t\treadonly resourceGroup: ISCMResourceGroup,\n\t\treadonly decorations: ISCMResourceDecorations,\n\t\treadonly contextValue: string | undefined,\n\t\treadonly command: Command | undefined,\n\t\treadonly multiDiffEditorOriginalUri: URI | undefined,\n\t\treadonly multiDiffEditorModifiedUri: URI | undefined,\n\t) { }\n\n\topen(preserveFocus: boolean): Promise<void> {\n\t\treturn this.proxy.$executeResourceCommand(this.sourceControlHandle, this.groupHandle, this.handle, preserveFocus);\n\t}\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmResource,\n\t\t\tsourceControlHandle: this.sourceControlHandle,\n\t\t\tgroupHandle: this.groupHandle,\n\t\t\thandle: this.handle\n\t\t};\n\t}\n}\n\nclass MainThreadSCMArtifactProvider implements ISCMArtifactProvider {\n\tprivate readonly _onDidChangeArtifacts = new Emitter<string[]>();\n\treadonly onDidChangeArtifacts = this._onDidChangeArtifacts.event;\n\n\tprivate readonly _disposables = new DisposableStore();\n\n\tconstructor(private readonly proxy: ExtHostSCMShape, private readonly handle: number) {\n\t\tthis._disposables.add(this._onDidChangeArtifacts);\n\t}\n\n\tasync provideArtifactGroups(token?: CancellationToken): Promise<ISCMArtifactGroup[] | undefined> {\n\t\tconst artifactGroups = await this.proxy.$provideArtifactGroups(this.handle, token ?? CancellationToken.None);\n\t\treturn artifactGroups?.map(group => ({ ...group, icon: getIconFromIconDto(group.icon) }));\n\t}\n\n\tasync provideArtifacts(group: string, token?: CancellationToken): Promise<ISCMArtifact[] | undefined> {\n\t\tconst artifacts = await this.proxy.$provideArtifacts(this.handle, group, token ?? CancellationToken.None);\n\t\treturn artifacts?.map(artifact => ({ ...artifact, icon: getIconFromIconDto(artifact.icon) }));\n\t}\n\n\t$onDidChangeArtifacts(groups: string[]): void {\n\t\tthis._onDidChangeArtifacts.fire(groups);\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n}\n\nclass MainThreadSCMHistoryProvider implements ISCMHistoryProvider {\n\tprivate readonly _historyItemRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemRef; }\n\n\tprivate readonly _historyItemRemoteRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemRemoteRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemRemoteRef; }\n\n\tprivate readonly _historyItemBaseRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemBaseRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemBaseRef; }\n\n\tprivate readonly _historyItemRefChanges = observableValue<ISCMHistoryItemRefsChangeEvent>(this, { added: [], modified: [], removed: [], silent: false });\n\tget historyItemRefChanges(): IObservable<ISCMHistoryItemRefsChangeEvent> { return this._historyItemRefChanges; }\n\n\tconstructor(private readonly proxy: ExtHostSCMShape, private readonly handle: number) { }\n\n\tasync resolveHistoryItem(historyItemId: string, token?: CancellationToken): Promise<ISCMHistoryItem | undefined> {\n\t\tconst historyItem = await this.proxy.$resolveHistoryItem(this.handle, historyItemId, token ?? CancellationToken.None);\n\t\treturn historyItem ? toISCMHistoryItem(historyItem) : undefined;\n\t}\n\n\tasync resolveHistoryItemChatContext(historyItemId: string, token?: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemChatContext(this.handle, historyItemId, token ?? CancellationToken.None);\n\t}\n\n\tasync resolveHistoryItemChangeRangeChatContext(historyItemId: string, historyItemParentId: string, path: string, token?: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemChangeRangeChatContext(this.handle, historyItemId, historyItemParentId, path, token ?? CancellationToken.None);\n\t}\n\n\tasync resolveHistoryItemRefsCommonAncestor(historyItemRefs: string[], token: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemRefsCommonAncestor(this.handle, historyItemRefs, token ?? CancellationToken.None);\n\t}\n\n\tasync provideHistoryItemRefs(historyItemsRefs?: string[], token?: CancellationToken): Promise<ISCMHistoryItemRef[] | undefined> {\n\t\tconst historyItemRefs = await this.proxy.$provideHistoryItemRefs(this.handle, historyItemsRefs, token ?? CancellationToken.None);\n\t\treturn historyItemRefs?.map(ref => ({ ...ref, icon: getIconFromIconDto(ref.icon) }));\n\t}\n\n\tasync provideHistoryItems(options: ISCMHistoryOptions, token?: CancellationToken): Promise<ISCMHistoryItem[] | undefined> {\n\t\tconst historyItems = await this.proxy.$provideHistoryItems(this.handle, options, token ?? CancellationToken.None);\n\t\treturn historyItems?.map(historyItem => toISCMHistoryItem(historyItem));\n\t}\n\n\tasync provideHistoryItemChanges(historyItemId: string, historyItemParentId: string | undefined, token?: CancellationToken): Promise<ISCMHistoryItemChange[] | undefined> {\n\t\tconst changes = await this.proxy.$provideHistoryItemChanges(this.handle, historyItemId, historyItemParentId, token ?? CancellationToken.None);\n\t\treturn changes?.map(change => ({\n\t\t\turi: URI.revive(change.uri),\n\t\t\toriginalUri: change.originalUri && URI.revive(change.originalUri),\n\t\t\tmodifiedUri: change.modifiedUri && URI.revive(change.modifiedUri)\n\t\t}));\n\t}\n\n\t$onDidChangeCurrentHistoryItemRefs(historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): void {\n\t\ttransaction(tx => {\n\t\t\tthis._historyItemRef.set(toISCMHistoryItemRef(historyItemRef, historyItemRefColor), tx);\n\t\t\tthis._historyItemRemoteRef.set(toISCMHistoryItemRef(historyItemRemoteRef, historyItemRemoteRefColor), tx);\n\t\t\tthis._historyItemBaseRef.set(toISCMHistoryItemRef(historyItemBaseRef, historyItemBaseRefColor), tx);\n\t\t});\n\t}\n\n\t$onDidChangeHistoryItemRefs(historyItemRefs: SCMHistoryItemRefsChangeEventDto): void {\n\t\tconst added = historyItemRefs.added.map(ref => toISCMHistoryItemRef(ref)!);\n\t\tconst modified = historyItemRefs.modified.map(ref => toISCMHistoryItemRef(ref)!);\n\t\tconst removed = historyItemRefs.removed.map(ref => toISCMHistoryItemRef(ref)!);\n\n\t\tthis._historyItemRefChanges.set({ added, modified, removed, silent: historyItemRefs.silent }, undefined);\n\t}\n}\n\nclass MainThreadSCMProvider implements ISCMProvider {\n\n\tget id(): string { return `scm${this._handle}`; }\n\tget parentId(): string | undefined {\n\t\treturn this._parentHandle !== undefined\n\t\t\t? `scm${this._parentHandle}`\n\t\t\t: undefined;\n\t}\n\tget providerId(): string { return this._providerId; }\n\n\treadonly groups: MainThreadSCMResourceGroup[] = [];\n\tprivate readonly _onDidChangeResourceGroups = new Emitter<void>();\n\treadonly onDidChangeResourceGroups = this._onDidChangeResourceGroups.event;\n\n\tprivate readonly _onDidChangeResources = new Emitter<void>();\n\treadonly onDidChangeResources = this._onDidChangeResources.event;\n\n\tprivate readonly _groupsByHandle: { [handle: number]: MainThreadSCMResourceGroup } = Object.create(null);\n\n\t// get groups(): ISequence<ISCMResourceGroup> {\n\t// \treturn {\n\t// \t\telements: this._groups,\n\t// \t\tonDidSplice: this._onDidSplice.event\n\t// \t};\n\n\t// \t// return this._groups\n\t// \t// \t.filter(g => g.resources.elements.length > 0 || !g.features.hideWhenEmpty);\n\t// }\n\n\n\tprivate features: SCMProviderFeatures = {};\n\n\tget handle(): number { return this._handle; }\n\tget label(): string { return this._label; }\n\tget rootUri(): URI | undefined { return this._rootUri; }\n\tget iconPath(): URI | { light: URI; dark: URI } | ThemeIcon | undefined { return this._iconPath; }\n\tget inputBoxTextModel(): ITextModel { return this._inputBoxTextModel; }\n\n\tprivate readonly _contextValue = observableValue<string | undefined>(this, undefined);\n\tget contextValue(): IObservable<string | undefined> { return this._contextValue; }\n\n\tget acceptInputCommand(): Command | undefined { return this.features.acceptInputCommand; }\n\n\tprivate readonly _count = observableValue<number | undefined>(this, undefined);\n\tget count() { return this._count; }\n\n\tprivate readonly _statusBarCommands = observableValue<readonly Command[] | undefined>(this, undefined);\n\tget statusBarCommands() { return this._statusBarCommands; }\n\n\tprivate readonly _name: string | undefined;\n\tget name(): string { return this._name ?? this._label; }\n\n\tprivate readonly _commitTemplate = observableValue<string>(this, '');\n\tget commitTemplate() { return this._commitTemplate; }\n\n\tprivate readonly _actionButton = observableValue<ISCMActionButtonDescriptor | undefined>(this, undefined);\n\tget actionButton(): IObservable<ISCMActionButtonDescriptor | undefined> { return this._actionButton; }\n\n\tprivate _quickDiff: IDisposable | undefined;\n\tprivate _stagedQuickDiff: IDisposable | undefined;\n\n\tprivate readonly _artifactProvider = observableValue<MainThreadSCMArtifactProvider | undefined>(this, undefined);\n\tget artifactProvider() { return this._artifactProvider; }\n\n\tprivate readonly _historyProvider = observableValue<MainThreadSCMHistoryProvider | undefined>(this, undefined);\n\tget historyProvider() { return this._historyProvider; }\n\n\tconstructor(\n\t\tprivate readonly proxy: ExtHostSCMShape,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _parentHandle: number | undefined,\n\t\tprivate readonly _providerId: string,\n\t\tprivate readonly _label: string,\n\t\tprivate readonly _rootUri: URI | undefined,\n\t\tprivate readonly _iconPath: URI | { light: URI; dark: URI } | ThemeIcon | undefined,\n\t\tprivate readonly _inputBoxTextModel: ITextModel,\n\t\tprivate readonly _quickDiffService: IQuickDiffService,\n\t\tprivate readonly _uriIdentService: IUriIdentityService,\n\t\tprivate readonly _workspaceContextService: IWorkspaceContextService\n\t) {\n\t\tif (_rootUri) {\n\t\t\tconst folder = this._workspaceContextService.getWorkspaceFolder(_rootUri);\n\t\t\tif (folder?.uri.toString() === _rootUri.toString()) {\n\t\t\t\tthis._name = folder.name;\n\t\t\t} else if (_rootUri.path !== '/') {\n\t\t\t\tthis._name = basename(_rootUri);\n\t\t\t}\n\t\t}\n\t}\n\n\t$updateSourceControl(features: SCMProviderFeatures): void {\n\t\tthis.features = { ...this.features, ...features };\n\n\t\tif (typeof features.commitTemplate !== 'undefined') {\n\t\t\tthis._commitTemplate.set(features.commitTemplate, undefined);\n\t\t}\n\n\t\tif (typeof features.actionButton !== 'undefined') {\n\t\t\tthis._actionButton.set(features.actionButton ?? undefined, undefined);\n\t\t}\n\n\t\tif (typeof features.contextValue !== 'undefined') {\n\t\t\tthis._contextValue.set(features.contextValue, undefined);\n\t\t}\n\n\t\tif (typeof features.count !== 'undefined') {\n\t\t\tthis._count.set(features.count, undefined);\n\t\t}\n\n\t\tif (typeof features.statusBarCommands !== 'undefined') {\n\t\t\tthis._statusBarCommands.set(features.statusBarCommands, undefined);\n\t\t}\n\n\t\tif (features.hasQuickDiffProvider && !this._quickDiff) {\n\t\t\tthis._quickDiff = this._quickDiffService.addQuickDiffProvider({\n\t\t\t\tid: `${this._providerId}.quickDiffProvider`,\n\t\t\t\tlabel: features.quickDiffLabel ?? this.label,\n\t\t\t\trootUri: this.rootUri,\n\t\t\t\tkind: 'primary',\n\t\t\t\tgetOriginalResource: async (uri: URI) => {\n\t\t\t\t\tif (!this.features.hasQuickDiffProvider) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = await this.proxy.$provideOriginalResource(this.handle, uri, CancellationToken.None);\n\t\t\t\t\treturn result && URI.revive(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (features.hasQuickDiffProvider === false && this._quickDiff) {\n\t\t\tthis._quickDiff.dispose();\n\t\t\tthis._quickDiff = undefined;\n\t\t}\n\n\t\tif (features.hasSecondaryQuickDiffProvider && !this._stagedQuickDiff) {\n\t\t\tthis._stagedQuickDiff = this._quickDiffService.addQuickDiffProvider({\n\t\t\t\tid: `${this._providerId}.secondaryQuickDiffProvider`,\n\t\t\t\tlabel: features.secondaryQuickDiffLabel ?? this.label,\n\t\t\t\trootUri: this.rootUri,\n\t\t\t\tkind: 'secondary',\n\t\t\t\tgetOriginalResource: async (uri: URI) => {\n\t\t\t\t\tif (!this.features.hasSecondaryQuickDiffProvider) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = await this.proxy.$provideSecondaryOriginalResource(this.handle, uri, CancellationToken.None);\n\t\t\t\t\treturn result && URI.revive(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (features.hasSecondaryQuickDiffProvider === false && this._stagedQuickDiff) {\n\t\t\tthis._stagedQuickDiff.dispose();\n\t\t\tthis._stagedQuickDiff = undefined;\n\t\t}\n\n\t\tif (features.hasArtifactProvider && !this.artifactProvider.get()) {\n\t\t\tconst artifactProvider = new MainThreadSCMArtifactProvider(this.proxy, this.handle);\n\t\t\tthis._artifactProvider.set(artifactProvider, undefined);\n\t\t} else if (features.hasArtifactProvider === false && this.artifactProvider.get()) {\n\t\t\tthis._artifactProvider.set(undefined, undefined);\n\t\t}\n\n\t\tif (features.hasHistoryProvider && !this.historyProvider.get()) {\n\t\t\tconst historyProvider = new MainThreadSCMHistoryProvider(this.proxy, this.handle);\n\t\t\tthis._historyProvider.set(historyProvider, undefined);\n\t\t} else if (features.hasHistoryProvider === false && this.historyProvider.get()) {\n\t\t\tthis._historyProvider.set(undefined, undefined);\n\t\t}\n\t}\n\n\t$registerGroups(_groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /* multiDiffEditorEnableViewChanges */ boolean][]): void {\n\t\tconst groups = _groups.map(([handle, id, label, features, multiDiffEditorEnableViewChanges]) => {\n\t\t\tconst group = new MainThreadSCMResourceGroup(\n\t\t\t\tthis.handle,\n\t\t\t\thandle,\n\t\t\t\tthis,\n\t\t\t\tfeatures,\n\t\t\t\tlabel,\n\t\t\t\tid,\n\t\t\t\tmultiDiffEditorEnableViewChanges,\n\t\t\t\tthis._uriIdentService\n\t\t\t);\n\n\t\t\tthis._groupsByHandle[handle] = group;\n\t\t\treturn group;\n\t\t});\n\n\t\tthis.groups.splice(this.groups.length, 0, ...groups);\n\t\tthis._onDidChangeResourceGroups.fire();\n\t}\n\n\t$updateGroup(handle: number, features: SCMGroupFeatures): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tgroup.$updateGroup(features);\n\t}\n\n\t$updateGroupLabel(handle: number, label: string): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tgroup.$updateGroupLabel(label);\n\t}\n\n\t$spliceGroupResourceStates(splices: SCMRawResourceSplices[]): void {\n\t\tfor (const [groupHandle, groupSlices] of splices) {\n\t\t\tconst group = this._groupsByHandle[groupHandle];\n\n\t\t\tif (!group) {\n\t\t\t\tconsole.warn(`SCM group ${groupHandle} not found in provider ${this.label}`);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// reverse the splices sequence in order to apply them correctly\n\t\t\tgroupSlices.reverse();\n\n\t\t\tfor (const [start, deleteCount, rawResources] of groupSlices) {\n\t\t\t\tconst resources = rawResources.map(rawResource => {\n\t\t\t\t\tconst [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command, multiDiffEditorOriginalUri, multiDiffEditorModifiedUri] = rawResource;\n\n\t\t\t\t\tconst [light, dark] = icons;\n\t\t\t\t\tconst icon = ThemeIcon.isThemeIcon(light) ? light : URI.revive(light);\n\t\t\t\t\tconst iconDark = (ThemeIcon.isThemeIcon(dark) ? dark : URI.revive(dark)) || icon;\n\n\t\t\t\t\tconst decorations = {\n\t\t\t\t\t\ticon: icon,\n\t\t\t\t\t\ticonDark: iconDark,\n\t\t\t\t\t\ttooltip,\n\t\t\t\t\t\tstrikeThrough,\n\t\t\t\t\t\tfaded\n\t\t\t\t\t};\n\n\t\t\t\t\treturn new MainThreadSCMResource(\n\t\t\t\t\t\tthis.proxy,\n\t\t\t\t\t\tthis.handle,\n\t\t\t\t\t\tgroupHandle,\n\t\t\t\t\t\thandle,\n\t\t\t\t\t\tURI.revive(sourceUri),\n\t\t\t\t\t\tgroup,\n\t\t\t\t\t\tdecorations,\n\t\t\t\t\t\tcontextValue || undefined,\n\t\t\t\t\t\tcommand,\n\t\t\t\t\t\tURI.revive(multiDiffEditorOriginalUri),\n\t\t\t\t\t\tURI.revive(multiDiffEditorModifiedUri),\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\tgroup.splice(start, deleteCount, resources);\n\t\t\t}\n\t\t}\n\n\t\tthis._onDidChangeResources.fire();\n\t}\n\n\t$unregisterGroup(handle: number): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tdelete this._groupsByHandle[handle];\n\t\tthis.groups.splice(this.groups.indexOf(group), 1);\n\t\tthis._onDidChangeResourceGroups.fire();\n\t}\n\n\tasync getOriginalResource(uri: URI): Promise<URI | null> {\n\t\tif (!this.features.hasQuickDiffProvider) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst result = await this.proxy.$provideOriginalResource(this.handle, uri, CancellationToken.None);\n\t\treturn result && URI.revive(result);\n\t}\n\n\t$onDidChangeHistoryProviderCurrentHistoryItemRefs(historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): void {\n\t\tconst provider = this.historyProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeCurrentHistoryItemRefs(historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t}\n\n\t$onDidChangeHistoryProviderHistoryItemRefs(historyItemRefs: SCMHistoryItemRefsChangeEventDto): void {\n\t\tconst provider = this.historyProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeHistoryItemRefs(historyItemRefs);\n\t}\n\n\t$onDidChangeArtifacts(groups: string[]): void {\n\t\tconst provider = this.artifactProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeArtifacts(groups);\n\t}\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmProvider,\n\t\t\thandle: this.handle\n\t\t};\n\t}\n\n\tdispose(): void {\n\t\tthis._stagedQuickDiff?.dispose();\n\t\tthis._quickDiff?.dispose();\n\t}\n}\n\n@extHostNamedCustomer(MainContext.MainThreadSCM)\nexport class MainThreadSCM implements MainThreadSCMShape {\n\n\tprivate readonly _proxy: ExtHostSCMShape;\n\tprivate _repositories = new Map<number, ISCMRepository>();\n\tprivate _repositoryBarriers = new Map<number, Barrier>();\n\tprivate _repositoryDisposables = new Map<number, IDisposable>();\n\tprivate readonly _disposables = new DisposableStore();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@ISCMService private readonly scmService: ISCMService,\n\t\t@ISCMViewService private readonly scmViewService: ISCMViewService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t\t@IQuickDiffService private readonly quickDiffService: IQuickDiffService,\n\t\t@IUriIdentityService private readonly _uriIdentService: IUriIdentityService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostSCM);\n\n\t\tthis._disposables.add(new SCMInputBoxContentProvider(this.textModelService, this.modelService, this.languageService));\n\t}\n\n\tdispose(): void {\n\t\tdispose(this._repositories.values());\n\t\tthis._repositories.clear();\n\n\t\tdispose(this._repositoryDisposables.values());\n\t\tthis._repositoryDisposables.clear();\n\n\t\tthis._disposables.dispose();\n\t}\n\n\tasync $registerSourceControl(handle: number, parentHandle: number | undefined, id: string, label: string, rootUri: UriComponents | undefined, iconPath: UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon | undefined, inputBoxDocumentUri: UriComponents): Promise<void> {\n\t\tthis._repositoryBarriers.set(handle, new Barrier());\n\n\t\tconst inputBoxTextModelRef = await this.textModelService.createModelReference(URI.revive(inputBoxDocumentUri));\n\t\tconst provider = new MainThreadSCMProvider(this._proxy, handle, parentHandle, id, label, rootUri ? URI.revive(rootUri) : undefined, getIconFromIconDto(iconPath), inputBoxTextModelRef.object.textEditorModel, this.quickDiffService, this._uriIdentService, this.workspaceContextService);\n\t\tconst repository = this.scmService.registerSCMProvider(provider);\n\t\tthis._repositories.set(handle, repository);\n\n\t\tconst disposable = combinedDisposable(\n\t\t\tinputBoxTextModelRef,\n\t\t\tEvent.filter(this.scmViewService.onDidFocusRepository, r => r === repository)(_ => this._proxy.$setSelectedSourceControl(handle)),\n\t\t\trepository.input.onDidChange(({ value }) => this._proxy.$onInputBoxValueChange(handle, value))\n\t\t);\n\t\tthis._repositoryDisposables.set(handle, disposable);\n\n\t\tif (this.scmViewService.focusedRepository === repository) {\n\t\t\tsetTimeout(() => this._proxy.$setSelectedSourceControl(handle), 0);\n\t\t}\n\n\t\tif (repository.input.value) {\n\t\t\tsetTimeout(() => this._proxy.$onInputBoxValueChange(handle, repository.input.value), 0);\n\t\t}\n\n\t\tthis._repositoryBarriers.get(handle)?.open();\n\t}\n\n\tasync $updateSourceControl(handle: number, features: SCMProviderFeatures): Promise<void> {\n\t\tawait this._repositoryBarriers.get(handle)?.wait();\n\t\tconst repository = this._repositories.get(handle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateSourceControl(features);\n\t}\n\n\tasync $unregisterSourceControl(handle: number): Promise<void> {\n\t\tawait this._repositoryBarriers.get(handle)?.wait();\n\t\tconst repository = this._repositories.get(handle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._repositoryDisposables.get(handle)!.dispose();\n\t\tthis._repositoryDisposables.delete(handle);\n\n\t\trepository.dispose();\n\t\tthis._repositories.delete(handle);\n\t}\n\n\tasync $registerGroups(sourceControlHandle: number, groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /* multiDiffEditorEnableViewChanges */ boolean][], splices: SCMRawResourceSplices[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$registerGroups(groups);\n\t\tprovider.$spliceGroupResourceStates(splices);\n\t}\n\n\tasync $updateGroup(sourceControlHandle: number, groupHandle: number, features: SCMGroupFeatures): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateGroup(groupHandle, features);\n\t}\n\n\tasync $updateGroupLabel(sourceControlHandle: number, groupHandle: number, label: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateGroupLabel(groupHandle, label);\n\t}\n\n\tasync $spliceResourceStates(sourceControlHandle: number, splices: SCMRawResourceSplices[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$spliceGroupResourceStates(splices);\n\t}\n\n\tasync $unregisterGroup(sourceControlHandle: number, handle: number): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$unregisterGroup(handle);\n\t}\n\n\tasync $setInputBoxValue(sourceControlHandle: number, value: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.setValue(value, false);\n\t}\n\n\tasync $setInputBoxPlaceholder(sourceControlHandle: number, placeholder: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.placeholder = placeholder;\n\t}\n\n\tasync $setInputBoxEnablement(sourceControlHandle: number, enabled: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.enabled = enabled;\n\t}\n\n\tasync $setInputBoxVisibility(sourceControlHandle: number, visible: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.visible = visible;\n\t}\n\n\tasync $showValidationMessage(sourceControlHandle: number, message: string | IMarkdownString, type: InputValidationType): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.showValidationMessage(message, type);\n\t}\n\n\tasync $setValidationProviderIsEnabled(sourceControlHandle: number, enabled: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (enabled) {\n\t\t\trepository.input.validateInput = async (value, pos): Promise<IInputValidation | undefined> => {\n\t\t\t\tconst result = await this._proxy.$validateInput(sourceControlHandle, value, pos);\n\t\t\t\treturn result && { message: result[0], type: result[1] };\n\t\t\t};\n\t\t} else {\n\t\t\trepository.input.validateInput = async () => undefined;\n\t\t}\n\t}\n\n\tasync $onDidChangeHistoryProviderCurrentHistoryItemRefs(sourceControlHandle: number, historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeHistoryProviderCurrentHistoryItemRefs(historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t}\n\n\tasync $onDidChangeHistoryProviderHistoryItemRefs(sourceControlHandle: number, historyItemRefs: SCMHistoryItemRefsChangeEventDto): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeHistoryProviderHistoryItemRefs(historyItemRefs);\n\t}\n\n\tasync $onDidChangeArtifacts(sourceControlHandle: number, groups: string[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeArtifacts(groups);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Barrier } from '../../../base/common/async.js';\nimport { isUriComponents, URI, UriComponents } from '../../../base/common/uri.js';\nimport { Event, Emitter } from '../../../base/common/event.js';\nimport { IObservable, observableValue, observableValueOpts, transaction } from '../../../base/common/observable.js';\nimport { IDisposable, DisposableStore, combinedDisposable, dispose, Disposable } from '../../../base/common/lifecycle.js';\nimport { ISCMService, ISCMRepository, ISCMProvider, ISCMResource, ISCMResourceGroup, ISCMResourceDecorations, IInputValidation, ISCMViewService, InputValidationType, ISCMActionButtonDescriptor } from '../../contrib/scm/common/scm.js';\nimport { ExtHostContext, MainThreadSCMShape, ExtHostSCMShape, SCMProviderFeatures, SCMRawResourceSplices, SCMGroupFeatures, MainContext, SCMHistoryItemDto, SCMHistoryItemRefsChangeEventDto, SCMHistoryItemRefDto } from '../common/extHost.protocol.js';\nimport { Command } from '../../../editor/common/languages.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { MarshalledId } from '../../../base/common/marshallingIds.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport { IMarkdownString } from '../../../base/common/htmlContent.js';\nimport { IQuickDiffService } from '../../contrib/scm/common/quickDiff.js';\nimport { ISCMHistoryItem, ISCMHistoryItemChange, ISCMHistoryItemRef, ISCMHistoryItemRefsChangeEvent, ISCMHistoryOptions, ISCMHistoryProvider } from '../../contrib/scm/common/history.js';\nimport { ResourceTree } from '../../../base/common/resourceTree.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { ILanguageService } from '../../../editor/common/languages/language.js';\nimport { IModelService } from '../../../editor/common/services/model.js';\nimport { ITextModelContentProvider, ITextModelService } from '../../../editor/common/services/resolverService.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { ITextModel } from '../../../editor/common/model.js';\nimport { structuralEquals } from '../../../base/common/equals.js';\nimport { historyItemBaseRefColor, historyItemRefColor, historyItemRemoteRefColor } from '../../contrib/scm/browser/scmHistory.js';\nimport { ColorIdentifier } from '../../../platform/theme/common/colorUtils.js';\nimport { ISCMArtifact, ISCMArtifactGroup, ISCMArtifactProvider } from '../../contrib/scm/common/artifact.js';\n\nfunction getIconFromIconDto(iconDto?: UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon): URI | { light: URI; dark: URI } | ThemeIcon | undefined {\n\tif (iconDto === undefined) {\n\t\treturn undefined;\n\t} else if (ThemeIcon.isThemeIcon(iconDto)) {\n\t\treturn iconDto;\n\t} else if (isUriComponents(iconDto)) {\n\t\treturn URI.revive(iconDto);\n\t} else {\n\t\tconst icon = iconDto as { light: UriComponents; dark: UriComponents };\n\t\treturn { light: URI.revive(icon.light), dark: URI.revive(icon.dark) };\n\t}\n}\n\nfunction toISCMHistoryItem(historyItemDto: SCMHistoryItemDto): ISCMHistoryItem {\n\tconst authorIcon = getIconFromIconDto(historyItemDto.authorIcon);\n\n\tconst references = historyItemDto.references?.map(r => ({\n\t\t...r, icon: getIconFromIconDto(r.icon)\n\t}));\n\n\treturn { ...historyItemDto, authorIcon, references };\n}\n\nfunction toISCMHistoryItemRef(historyItemRefDto?: SCMHistoryItemRefDto, color?: ColorIdentifier): ISCMHistoryItemRef | undefined {\n\treturn historyItemRefDto ? { ...historyItemRefDto, icon: getIconFromIconDto(historyItemRefDto.icon), color: color } : undefined;\n}\n\nclass SCMInputBoxContentProvider extends Disposable implements ITextModelContentProvider {\n\tconstructor(\n\t\ttextModelService: ITextModelService,\n\t\tprivate readonly modelService: IModelService,\n\t\tprivate readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(Schemas.vscodeSourceControl, this));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this.modelService.getModel(resource);\n\t\tif (existing) {\n\t\t\treturn existing;\n\t\t}\n\t\treturn this.modelService.createModel('', this.languageService.createById('scminput'), resource);\n\t}\n}\n\nclass MainThreadSCMResourceGroup implements ISCMResourceGroup {\n\n\treadonly resources: ISCMResource[] = [];\n\n\tprivate _resourceTree: ResourceTree<ISCMResource, ISCMResourceGroup> | undefined;\n\tget resourceTree(): ResourceTree<ISCMResource, ISCMResourceGroup> {\n\t\tif (!this._resourceTree) {\n\t\t\tconst rootUri = this.provider.rootUri ?? URI.file('/');\n\t\t\tthis._resourceTree = new ResourceTree<ISCMResource, ISCMResourceGroup>(this, rootUri, this._uriIdentService.extUri);\n\t\t\tfor (const resource of this.resources) {\n\t\t\t\tthis._resourceTree.add(resource.sourceUri, resource);\n\t\t\t}\n\t\t}\n\n\t\treturn this._resourceTree;\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<void>();\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tprivate readonly _onDidChangeResources = new Emitter<void>();\n\treadonly onDidChangeResources = this._onDidChangeResources.event;\n\n\tget hideWhenEmpty(): boolean { return !!this.features.hideWhenEmpty; }\n\n\tget contextValue(): string | undefined { return this.features.contextValue; }\n\n\tconstructor(\n\t\tprivate readonly sourceControlHandle: number,\n\t\tprivate readonly handle: number,\n\t\tpublic provider: ISCMProvider,\n\t\tpublic features: SCMGroupFeatures,\n\t\tpublic label: string,\n\t\tpublic id: string,\n\t\tpublic readonly multiDiffEditorEnableViewChanges: boolean,\n\t\tprivate readonly _uriIdentService: IUriIdentityService\n\t) { }\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmResourceGroup,\n\t\t\tsourceControlHandle: this.sourceControlHandle,\n\t\t\tgroupHandle: this.handle\n\t\t};\n\t}\n\n\tsplice(start: number, deleteCount: number, toInsert: ISCMResource[]) {\n\t\tthis.resources.splice(start, deleteCount, ...toInsert);\n\t\tthis._resourceTree = undefined;\n\n\t\tthis._onDidChangeResources.fire();\n\t}\n\n\t$updateGroup(features: SCMGroupFeatures): void {\n\t\tthis.features = { ...this.features, ...features };\n\t\tthis._onDidChange.fire();\n\t}\n\n\t$updateGroupLabel(label: string): void {\n\t\tthis.label = label;\n\t\tthis._onDidChange.fire();\n\t}\n}\n\nclass MainThreadSCMResource implements ISCMResource {\n\n\tconstructor(\n\t\tprivate readonly proxy: ExtHostSCMShape,\n\t\tprivate readonly sourceControlHandle: number,\n\t\tprivate readonly groupHandle: number,\n\t\tprivate readonly handle: number,\n\t\treadonly sourceUri: URI,\n\t\treadonly resourceGroup: ISCMResourceGroup,\n\t\treadonly decorations: ISCMResourceDecorations,\n\t\treadonly contextValue: string | undefined,\n\t\treadonly command: Command | undefined,\n\t\treadonly multiDiffEditorOriginalUri: URI | undefined,\n\t\treadonly multiDiffEditorModifiedUri: URI | undefined,\n\t) { }\n\n\topen(preserveFocus: boolean): Promise<void> {\n\t\treturn this.proxy.$executeResourceCommand(this.sourceControlHandle, this.groupHandle, this.handle, preserveFocus);\n\t}\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmResource,\n\t\t\tsourceControlHandle: this.sourceControlHandle,\n\t\t\tgroupHandle: this.groupHandle,\n\t\t\thandle: this.handle\n\t\t};\n\t}\n}\n\nclass MainThreadSCMArtifactProvider implements ISCMArtifactProvider {\n\tprivate readonly _onDidChangeArtifacts = new Emitter<string[]>();\n\treadonly onDidChangeArtifacts = this._onDidChangeArtifacts.event;\n\n\tprivate readonly _disposables = new DisposableStore();\n\n\tconstructor(private readonly proxy: ExtHostSCMShape, private readonly handle: number) {\n\t\tthis._disposables.add(this._onDidChangeArtifacts);\n\t}\n\n\tasync provideArtifactGroups(token?: CancellationToken): Promise<ISCMArtifactGroup[] | undefined> {\n\t\tconst artifactGroups = await this.proxy.$provideArtifactGroups(this.handle, token ?? CancellationToken.None);\n\t\treturn artifactGroups?.map(group => ({ ...group, icon: getIconFromIconDto(group.icon) }));\n\t}\n\n\tasync provideArtifacts(group: string, token?: CancellationToken): Promise<ISCMArtifact[] | undefined> {\n\t\tconst artifacts = await this.proxy.$provideArtifacts(this.handle, group, token ?? CancellationToken.None);\n\t\treturn artifacts?.map(artifact => ({ ...artifact, icon: getIconFromIconDto(artifact.icon) }));\n\t}\n\n\t$onDidChangeArtifacts(groups: string[]): void {\n\t\tthis._onDidChangeArtifacts.fire(groups);\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n}\n\nclass MainThreadSCMHistoryProvider implements ISCMHistoryProvider {\n\tprivate readonly _historyItemRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemRef; }\n\n\tprivate readonly _historyItemRemoteRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemRemoteRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemRemoteRef; }\n\n\tprivate readonly _historyItemBaseRef = observableValueOpts<ISCMHistoryItemRef | undefined>({\n\t\towner: this,\n\t\tequalsFn: structuralEquals\n\t}, undefined);\n\tget historyItemBaseRef(): IObservable<ISCMHistoryItemRef | undefined> { return this._historyItemBaseRef; }\n\n\tprivate readonly _historyItemRefChanges = observableValue<ISCMHistoryItemRefsChangeEvent>(this, { added: [], modified: [], removed: [], silent: false });\n\tget historyItemRefChanges(): IObservable<ISCMHistoryItemRefsChangeEvent> { return this._historyItemRefChanges; }\n\n\tconstructor(private readonly proxy: ExtHostSCMShape, private readonly handle: number) { }\n\n\tasync resolveHistoryItem(historyItemId: string, token?: CancellationToken): Promise<ISCMHistoryItem | undefined> {\n\t\tconst historyItem = await this.proxy.$resolveHistoryItem(this.handle, historyItemId, token ?? CancellationToken.None);\n\t\treturn historyItem ? toISCMHistoryItem(historyItem) : undefined;\n\t}\n\n\tasync resolveHistoryItemChatContext(historyItemId: string, token?: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemChatContext(this.handle, historyItemId, token ?? CancellationToken.None);\n\t}\n\n\tasync resolveHistoryItemChangeRangeChatContext(historyItemId: string, historyItemParentId: string, path: string, token?: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemChangeRangeChatContext(this.handle, historyItemId, historyItemParentId, path, token ?? CancellationToken.None);\n\t}\n\n\tasync resolveHistoryItemRefsCommonAncestor(historyItemRefs: string[], token: CancellationToken): Promise<string | undefined> {\n\t\treturn this.proxy.$resolveHistoryItemRefsCommonAncestor(this.handle, historyItemRefs, token ?? CancellationToken.None);\n\t}\n\n\tasync provideHistoryItemRefs(historyItemsRefs?: string[], token?: CancellationToken): Promise<ISCMHistoryItemRef[] | undefined> {\n\t\tconst historyItemRefs = await this.proxy.$provideHistoryItemRefs(this.handle, historyItemsRefs, token ?? CancellationToken.None);\n\t\treturn historyItemRefs?.map(ref => ({ ...ref, icon: getIconFromIconDto(ref.icon) }));\n\t}\n\n\tasync provideHistoryItems(options: ISCMHistoryOptions, token?: CancellationToken): Promise<ISCMHistoryItem[] | undefined> {\n\t\tconst historyItems = await this.proxy.$provideHistoryItems(this.handle, options, token ?? CancellationToken.None);\n\t\treturn historyItems?.map(historyItem => toISCMHistoryItem(historyItem));\n\t}\n\n\tasync provideHistoryItemChanges(historyItemId: string, historyItemParentId: string | undefined, token?: CancellationToken): Promise<ISCMHistoryItemChange[] | undefined> {\n\t\tconst changes = await this.proxy.$provideHistoryItemChanges(this.handle, historyItemId, historyItemParentId, token ?? CancellationToken.None);\n\t\treturn changes?.map(change => ({\n\t\t\turi: URI.revive(change.uri),\n\t\t\toriginalUri: change.originalUri && URI.revive(change.originalUri),\n\t\t\tmodifiedUri: change.modifiedUri && URI.revive(change.modifiedUri)\n\t\t}));\n\t}\n\n\t$onDidChangeCurrentHistoryItemRefs(historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): void {\n\t\ttransaction(tx => {\n\t\t\tthis._historyItemRef.set(toISCMHistoryItemRef(historyItemRef, historyItemRefColor), tx);\n\t\t\tthis._historyItemRemoteRef.set(toISCMHistoryItemRef(historyItemRemoteRef, historyItemRemoteRefColor), tx);\n\t\t\tthis._historyItemBaseRef.set(toISCMHistoryItemRef(historyItemBaseRef, historyItemBaseRefColor), tx);\n\t\t});\n\t}\n\n\t$onDidChangeHistoryItemRefs(historyItemRefs: SCMHistoryItemRefsChangeEventDto): void {\n\t\tconst added = historyItemRefs.added.map(ref => toISCMHistoryItemRef(ref)!);\n\t\tconst modified = historyItemRefs.modified.map(ref => toISCMHistoryItemRef(ref)!);\n\t\tconst removed = historyItemRefs.removed.map(ref => toISCMHistoryItemRef(ref)!);\n\n\t\tthis._historyItemRefChanges.set({ added, modified, removed, silent: historyItemRefs.silent }, undefined);\n\t}\n}\n\nclass MainThreadSCMProvider implements ISCMProvider {\n\n\tget id(): string { return `scm${this._handle}`; }\n\tget parentId(): string | undefined {\n\t\treturn this._parentHandle !== undefined\n\t\t\t? `scm${this._parentHandle}`\n\t\t\t: undefined;\n\t}\n\tget providerId(): string { return this._providerId; }\n\n\treadonly groups: MainThreadSCMResourceGroup[] = [];\n\tprivate readonly _onDidChangeResourceGroups = new Emitter<void>();\n\treadonly onDidChangeResourceGroups = this._onDidChangeResourceGroups.event;\n\n\tprivate readonly _onDidChangeResources = new Emitter<void>();\n\treadonly onDidChangeResources = this._onDidChangeResources.event;\n\n\tprivate readonly _groupsByHandle: { [handle: number]: MainThreadSCMResourceGroup } = Object.create(null);\n\n\t// get groups(): ISequence<ISCMResourceGroup> {\n\t// \treturn {\n\t// \t\telements: this._groups,\n\t// \t\tonDidSplice: this._onDidSplice.event\n\t// \t};\n\n\t// \t// return this._groups\n\t// \t// \t.filter(g => g.resources.elements.length > 0 || !g.features.hideWhenEmpty);\n\t// }\n\n\n\tprivate features: SCMProviderFeatures = {};\n\n\tget handle(): number { return this._handle; }\n\tget label(): string { return this._label; }\n\tget rootUri(): URI | undefined { return this._rootUri; }\n\tget iconPath(): URI | { light: URI; dark: URI } | ThemeIcon | undefined { return this._iconPath; }\n\tget inputBoxTextModel(): ITextModel { return this._inputBoxTextModel; }\n\n\tprivate readonly _contextValue = observableValue<string | undefined>(this, undefined);\n\tget contextValue(): IObservable<string | undefined> { return this._contextValue; }\n\n\tget acceptInputCommand(): Command | undefined { return this.features.acceptInputCommand; }\n\n\tprivate readonly _count = observableValue<number | undefined>(this, undefined);\n\tget count() { return this._count; }\n\n\tprivate readonly _statusBarCommands = observableValue<readonly Command[] | undefined>(this, undefined);\n\tget statusBarCommands() { return this._statusBarCommands; }\n\n\tprivate readonly _name: string | undefined;\n\tget name(): string { return this._name ?? this._label; }\n\n\tprivate readonly _commitTemplate = observableValue<string>(this, '');\n\tget commitTemplate() { return this._commitTemplate; }\n\n\tprivate readonly _actionButton = observableValue<ISCMActionButtonDescriptor | undefined>(this, undefined);\n\tget actionButton(): IObservable<ISCMActionButtonDescriptor | undefined> { return this._actionButton; }\n\n\tprivate _quickDiff: IDisposable | undefined;\n\tprivate _stagedQuickDiff: IDisposable | undefined;\n\n\tprivate readonly _artifactProvider = observableValue<MainThreadSCMArtifactProvider | undefined>(this, undefined);\n\tget artifactProvider() { return this._artifactProvider; }\n\n\tprivate readonly _historyProvider = observableValue<MainThreadSCMHistoryProvider | undefined>(this, undefined);\n\tget historyProvider() { return this._historyProvider; }\n\n\tconstructor(\n\t\tprivate readonly proxy: ExtHostSCMShape,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _parentHandle: number | undefined,\n\t\tprivate readonly _providerId: string,\n\t\tprivate readonly _label: string,\n\t\tprivate readonly _rootUri: URI | undefined,\n\t\tprivate readonly _iconPath: URI | { light: URI; dark: URI } | ThemeIcon | undefined,\n\t\tprivate readonly _inputBoxTextModel: ITextModel,\n\t\tprivate readonly _quickDiffService: IQuickDiffService,\n\t\tprivate readonly _uriIdentService: IUriIdentityService,\n\t\tprivate readonly _workspaceContextService: IWorkspaceContextService\n\t) {\n\t\tif (_rootUri) {\n\t\t\tconst folder = this._workspaceContextService.getWorkspaceFolder(_rootUri);\n\t\t\tif (folder?.uri.toString() === _rootUri.toString()) {\n\t\t\t\tthis._name = folder.name;\n\t\t\t} else if (_rootUri.path !== '/') {\n\t\t\t\tthis._name = basename(_rootUri);\n\t\t\t}\n\t\t}\n\t}\n\n\t$updateSourceControl(features: SCMProviderFeatures): void {\n\t\tthis.features = { ...this.features, ...features };\n\n\t\tif (typeof features.commitTemplate !== 'undefined') {\n\t\t\tthis._commitTemplate.set(features.commitTemplate, undefined);\n\t\t}\n\n\t\tif (typeof features.actionButton !== 'undefined') {\n\t\t\tthis._actionButton.set(features.actionButton ?? undefined, undefined);\n\t\t}\n\n\t\tif (typeof features.contextValue !== 'undefined') {\n\t\t\tthis._contextValue.set(features.contextValue, undefined);\n\t\t}\n\n\t\tif (typeof features.count !== 'undefined') {\n\t\t\tthis._count.set(features.count, undefined);\n\t\t}\n\n\t\tif (typeof features.statusBarCommands !== 'undefined') {\n\t\t\tthis._statusBarCommands.set(features.statusBarCommands, undefined);\n\t\t}\n\n\t\tif (features.hasQuickDiffProvider && !this._quickDiff) {\n\t\t\tthis._quickDiff = this._quickDiffService.addQuickDiffProvider({\n\t\t\t\tid: `${this._providerId}.quickDiffProvider`,\n\t\t\t\tlabel: features.quickDiffLabel ?? this.label,\n\t\t\t\trootUri: this.rootUri,\n\t\t\t\tkind: 'primary',\n\t\t\t\tgetOriginalResource: async (uri: URI) => {\n\t\t\t\t\tif (!this.features.hasQuickDiffProvider) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = await this.proxy.$provideOriginalResource(this.handle, uri, CancellationToken.None);\n\t\t\t\t\treturn result && URI.revive(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (features.hasQuickDiffProvider === false && this._quickDiff) {\n\t\t\tthis._quickDiff.dispose();\n\t\t\tthis._quickDiff = undefined;\n\t\t}\n\n\t\tif (features.hasSecondaryQuickDiffProvider && !this._stagedQuickDiff) {\n\t\t\tthis._stagedQuickDiff = this._quickDiffService.addQuickDiffProvider({\n\t\t\t\tid: `${this._providerId}.secondaryQuickDiffProvider`,\n\t\t\t\tlabel: features.secondaryQuickDiffLabel ?? this.label,\n\t\t\t\trootUri: this.rootUri,\n\t\t\t\tkind: 'secondary',\n\t\t\t\tgetOriginalResource: async (uri: URI) => {\n\t\t\t\t\tif (!this.features.hasSecondaryQuickDiffProvider) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = await this.proxy.$provideSecondaryOriginalResource(this.handle, uri, CancellationToken.None);\n\t\t\t\t\treturn result && URI.revive(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (features.hasSecondaryQuickDiffProvider === false && this._stagedQuickDiff) {\n\t\t\tthis._stagedQuickDiff.dispose();\n\t\t\tthis._stagedQuickDiff = undefined;\n\t\t}\n\n\t\tif (features.hasArtifactProvider && !this.artifactProvider.get()) {\n\t\t\tconst artifactProvider = new MainThreadSCMArtifactProvider(this.proxy, this.handle);\n\t\t\tthis._artifactProvider.set(artifactProvider, undefined);\n\t\t} else if (features.hasArtifactProvider === false && this.artifactProvider.get()) {\n\t\t\tthis._artifactProvider.set(undefined, undefined);\n\t\t}\n\n\t\tif (features.hasHistoryProvider && !this.historyProvider.get()) {\n\t\t\tconst historyProvider = new MainThreadSCMHistoryProvider(this.proxy, this.handle);\n\t\t\tthis._historyProvider.set(historyProvider, undefined);\n\t\t} else if (features.hasHistoryProvider === false && this.historyProvider.get()) {\n\t\t\tthis._historyProvider.set(undefined, undefined);\n\t\t}\n\t}\n\n\t$registerGroups(_groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /* multiDiffEditorEnableViewChanges */ boolean][]): void {\n\t\tconst groups = _groups.map(([handle, id, label, features, multiDiffEditorEnableViewChanges]) => {\n\t\t\tconst group = new MainThreadSCMResourceGroup(\n\t\t\t\tthis.handle,\n\t\t\t\thandle,\n\t\t\t\tthis,\n\t\t\t\tfeatures,\n\t\t\t\tlabel,\n\t\t\t\tid,\n\t\t\t\tmultiDiffEditorEnableViewChanges,\n\t\t\t\tthis._uriIdentService\n\t\t\t);\n\n\t\t\tthis._groupsByHandle[handle] = group;\n\t\t\treturn group;\n\t\t});\n\n\t\tthis.groups.splice(this.groups.length, 0, ...groups);\n\t\tthis._onDidChangeResourceGroups.fire();\n\t}\n\n\t$updateGroup(handle: number, features: SCMGroupFeatures): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tgroup.$updateGroup(features);\n\t}\n\n\t$updateGroupLabel(handle: number, label: string): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tgroup.$updateGroupLabel(label);\n\t}\n\n\t$spliceGroupResourceStates(splices: SCMRawResourceSplices[]): void {\n\t\tfor (const [groupHandle, groupSlices] of splices) {\n\t\t\tconst group = this._groupsByHandle[groupHandle];\n\n\t\t\tif (!group) {\n\t\t\t\tconsole.warn(`SCM group ${groupHandle} not found in provider ${this.label}`);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// reverse the splices sequence in order to apply them correctly\n\t\t\tgroupSlices.reverse();\n\n\t\t\tfor (const [start, deleteCount, rawResources] of groupSlices) {\n\t\t\t\tconst resources = rawResources.map(rawResource => {\n\t\t\t\t\tconst [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command, multiDiffEditorOriginalUri, multiDiffEditorModifiedUri] = rawResource;\n\n\t\t\t\t\tconst [light, dark] = icons;\n\t\t\t\t\tconst icon = ThemeIcon.isThemeIcon(light) ? light : URI.revive(light);\n\t\t\t\t\tconst iconDark = (ThemeIcon.isThemeIcon(dark) ? dark : URI.revive(dark)) || icon;\n\n\t\t\t\t\tconst decorations = {\n\t\t\t\t\t\ticon: icon,\n\t\t\t\t\t\ticonDark: iconDark,\n\t\t\t\t\t\ttooltip,\n\t\t\t\t\t\tstrikeThrough,\n\t\t\t\t\t\tfaded\n\t\t\t\t\t};\n\n\t\t\t\t\treturn new MainThreadSCMResource(\n\t\t\t\t\t\tthis.proxy,\n\t\t\t\t\t\tthis.handle,\n\t\t\t\t\t\tgroupHandle,\n\t\t\t\t\t\thandle,\n\t\t\t\t\t\tURI.revive(sourceUri),\n\t\t\t\t\t\tgroup,\n\t\t\t\t\t\tdecorations,\n\t\t\t\t\t\tcontextValue || undefined,\n\t\t\t\t\t\tcommand,\n\t\t\t\t\t\tURI.revive(multiDiffEditorOriginalUri),\n\t\t\t\t\t\tURI.revive(multiDiffEditorModifiedUri),\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\tgroup.splice(start, deleteCount, resources);\n\t\t\t}\n\t\t}\n\n\t\tthis._onDidChangeResources.fire();\n\t}\n\n\t$unregisterGroup(handle: number): void {\n\t\tconst group = this._groupsByHandle[handle];\n\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\n\t\tdelete this._groupsByHandle[handle];\n\t\tthis.groups.splice(this.groups.indexOf(group), 1);\n\t\tthis._onDidChangeResourceGroups.fire();\n\t}\n\n\tasync getOriginalResource(uri: URI): Promise<URI | null> {\n\t\tif (!this.features.hasQuickDiffProvider) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst result = await this.proxy.$provideOriginalResource(this.handle, uri, CancellationToken.None);\n\t\treturn result && URI.revive(result);\n\t}\n\n\t$onDidChangeHistoryProviderCurrentHistoryItemRefs(historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): void {\n\t\tconst provider = this.historyProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeCurrentHistoryItemRefs(historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t}\n\n\t$onDidChangeHistoryProviderHistoryItemRefs(historyItemRefs: SCMHistoryItemRefsChangeEventDto): void {\n\t\tconst provider = this.historyProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeHistoryItemRefs(historyItemRefs);\n\t}\n\n\t$onDidChangeArtifacts(groups: string[]): void {\n\t\tconst provider = this.artifactProvider.get();\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.$onDidChangeArtifacts(groups);\n\t}\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.ScmProvider,\n\t\t\thandle: this.handle\n\t\t};\n\t}\n\n\tdispose(): void {\n\t\tthis._stagedQuickDiff?.dispose();\n\t\tthis._quickDiff?.dispose();\n\t}\n}\n\n@extHostNamedCustomer(MainContext.MainThreadSCM)\nexport class MainThreadSCM implements MainThreadSCMShape {\n\n\tprivate readonly _proxy: ExtHostSCMShape;\n\tprivate _repositories = new Map<number, ISCMRepository>();\n\tprivate _repositoryBarriers = new Map<number, Barrier>();\n\tprivate _repositoryDisposables = new Map<number, IDisposable>();\n\tprivate readonly _disposables = new DisposableStore();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@ISCMService private readonly scmService: ISCMService,\n\t\t@ISCMViewService private readonly scmViewService: ISCMViewService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t\t@IQuickDiffService private readonly quickDiffService: IQuickDiffService,\n\t\t@IUriIdentityService private readonly _uriIdentService: IUriIdentityService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostSCM);\n\n\t\tthis._disposables.add(new SCMInputBoxContentProvider(this.textModelService, this.modelService, this.languageService));\n\t}\n\n\tdispose(): void {\n\t\tdispose(this._repositories.values());\n\t\tthis._repositories.clear();\n\n\t\tdispose(this._repositoryDisposables.values());\n\t\tthis._repositoryDisposables.clear();\n\n\t\tthis._disposables.dispose();\n\t}\n\n\tasync $registerSourceControl(handle: number, parentHandle: number | undefined, id: string, label: string, rootUri: UriComponents | undefined, iconPath: UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon | undefined, inputBoxDocumentUri: UriComponents): Promise<void> {\n\t\tthis._repositoryBarriers.set(handle, new Barrier());\n\n\t\tconst inputBoxTextModelRef = await this.textModelService.createModelReference(URI.revive(inputBoxDocumentUri));\n\t\tconst provider = new MainThreadSCMProvider(this._proxy, handle, parentHandle, id, label, rootUri ? URI.revive(rootUri) : undefined, getIconFromIconDto(iconPath), inputBoxTextModelRef.object.textEditorModel, this.quickDiffService, this._uriIdentService, this.workspaceContextService);\n\t\tconst repository = this.scmService.registerSCMProvider(provider);\n\t\tthis._repositories.set(handle, repository);\n\n\t\tconst disposable = combinedDisposable(\n\t\t\tinputBoxTextModelRef,\n\t\t\tEvent.filter(this.scmViewService.onDidFocusRepository, r => r === repository)(_ => this._proxy.$setSelectedSourceControl(handle)),\n\t\t\trepository.input.onDidChange(({ value }) => this._proxy.$onInputBoxValueChange(handle, value))\n\t\t);\n\t\tthis._repositoryDisposables.set(handle, disposable);\n\n\t\tif (this.scmViewService.focusedRepository === repository) {\n\t\t\tsetTimeout(() => this._proxy.$setSelectedSourceControl(handle), 0);\n\t\t}\n\n\t\tif (repository.input.value) {\n\t\t\tsetTimeout(() => this._proxy.$onInputBoxValueChange(handle, repository.input.value), 0);\n\t\t}\n\n\t\tthis._repositoryBarriers.get(handle)?.open();\n\t}\n\n\tasync $updateSourceControl(handle: number, features: SCMProviderFeatures): Promise<void> {\n\t\tawait this._repositoryBarriers.get(handle)?.wait();\n\t\tconst repository = this._repositories.get(handle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateSourceControl(features);\n\t}\n\n\tasync $unregisterSourceControl(handle: number): Promise<void> {\n\t\tawait this._repositoryBarriers.get(handle)?.wait();\n\t\tconst repository = this._repositories.get(handle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._repositoryDisposables.get(handle)!.dispose();\n\t\tthis._repositoryDisposables.delete(handle);\n\n\t\trepository.dispose();\n\t\tthis._repositories.delete(handle);\n\t}\n\n\tasync $registerGroups(sourceControlHandle: number, groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /* multiDiffEditorEnableViewChanges */ boolean][], splices: SCMRawResourceSplices[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$registerGroups(groups);\n\t\tprovider.$spliceGroupResourceStates(splices);\n\t}\n\n\tasync $updateGroup(sourceControlHandle: number, groupHandle: number, features: SCMGroupFeatures): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateGroup(groupHandle, features);\n\t}\n\n\tasync $updateGroupLabel(sourceControlHandle: number, groupHandle: number, label: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$updateGroupLabel(groupHandle, label);\n\t}\n\n\tasync $spliceResourceStates(sourceControlHandle: number, splices: SCMRawResourceSplices[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$spliceGroupResourceStates(splices);\n\t}\n\n\tasync $unregisterGroup(sourceControlHandle: number, handle: number): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$unregisterGroup(handle);\n\t}\n\n\tasync $setInputBoxValue(sourceControlHandle: number, value: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.setValue(value, false);\n\t}\n\n\tasync $setInputBoxPlaceholder(sourceControlHandle: number, placeholder: string): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.placeholder = placeholder;\n\t}\n\n\tasync $setInputBoxEnablement(sourceControlHandle: number, enabled: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.enabled = enabled;\n\t}\n\n\tasync $setInputBoxVisibility(sourceControlHandle: number, visible: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.visible = visible;\n\t}\n\n\tasync $showValidationMessage(sourceControlHandle: number, message: string | IMarkdownString, type: InputValidationType): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\trepository.input.showValidationMessage(message, type);\n\t}\n\n\tasync $setValidationProviderIsEnabled(sourceControlHandle: number, enabled: boolean): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (enabled) {\n\t\t\trepository.input.validateInput = async (value, pos): Promise<IInputValidation | undefined> => {\n\t\t\t\tconst result = await this._proxy.$validateInput(sourceControlHandle, value, pos);\n\t\t\t\treturn result && { message: result[0], type: result[1] };\n\t\t\t};\n\t\t} else {\n\t\t\trepository.input.validateInput = async () => undefined;\n\t\t}\n\t}\n\n\tasync $onDidChangeHistoryProviderCurrentHistoryItemRefs(sourceControlHandle: number, historyItemRef?: SCMHistoryItemRefDto, historyItemRemoteRef?: SCMHistoryItemRefDto, historyItemBaseRef?: SCMHistoryItemRefDto): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeHistoryProviderCurrentHistoryItemRefs(historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t}\n\n\tasync $onDidChangeHistoryProviderHistoryItemRefs(sourceControlHandle: number, historyItemRefs: SCMHistoryItemRefsChangeEventDto): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeHistoryProviderHistoryItemRefs(historyItemRefs);\n\t}\n\n\tasync $onDidChangeArtifacts(sourceControlHandle: number, groups: string[]): Promise<void> {\n\t\tawait this._repositoryBarriers.get(sourceControlHandle)?.wait();\n\t\tconst repository = this._repositories.get(sourceControlHandle);\n\n\t\tif (!repository) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = repository.provider as MainThreadSCMProvider;\n\t\tprovider.$onDidChangeArtifacts(groups);\n\t}\n}\n"]}