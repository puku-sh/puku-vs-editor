{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadEmbeddings.ts","vs/workbench/api/browser/mainThreadEmbeddings.ts"],"names":[],"mappings":"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","file":"mainThreadEmbeddings.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { DisposableMap, DisposableStore, IDisposable } from '../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { ExtHostContext, ExtHostEmbeddingsShape, MainContext, MainThreadEmbeddingsShape } from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\n\n\ninterface IEmbeddingsProvider {\n\tprovideEmbeddings(input: string[], token: CancellationToken): Promise<{ values: number[] }[]>;\n}\n\nconst IEmbeddingsService = createDecorator<IEmbeddingsService>('embeddingsService');\n\ninterface IEmbeddingsService {\n\n\t_serviceBrand: undefined;\n\n\treadonly onDidChange: Event<void>;\n\n\tallProviders: Iterable<string>;\n\n\tregisterProvider(id: string, provider: IEmbeddingsProvider): IDisposable;\n\n\tcomputeEmbeddings(id: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]>;\n}\n\nclass EmbeddingsService implements IEmbeddingsService {\n\t_serviceBrand: undefined;\n\n\tprivate providers: Map<string, IEmbeddingsProvider>;\n\n\tprivate readonly _onDidChange = new Emitter<void>();\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tconstructor() {\n\t\tthis.providers = new Map<string, IEmbeddingsProvider>();\n\t}\n\n\tget allProviders(): Iterable<string> {\n\t\treturn this.providers.keys();\n\t}\n\n\tregisterProvider(id: string, provider: IEmbeddingsProvider): IDisposable {\n\t\tthis.providers.set(id, provider);\n\t\tthis._onDidChange.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis.providers.delete(id);\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}\n\t\t};\n\t}\n\n\tcomputeEmbeddings(id: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]> {\n\t\tconst provider = this.providers.get(id);\n\t\tif (provider) {\n\t\t\treturn provider.provideEmbeddings(input, token);\n\t\t} else {\n\t\t\treturn Promise.reject(new Error(`No embeddings provider registered with id: ${id}`));\n\t\t}\n\t}\n}\n\n\nregisterSingleton(IEmbeddingsService, EmbeddingsService, InstantiationType.Delayed);\n\n@extHostNamedCustomer(MainContext.MainThreadEmbeddings)\nexport class MainThreadEmbeddings implements MainThreadEmbeddingsShape {\n\n\tprivate readonly _store = new DisposableStore();\n\tprivate readonly _providers = this._store.add(new DisposableMap<number>);\n\tprivate readonly _proxy: ExtHostEmbeddingsShape;\n\n\tconstructor(\n\t\tcontext: IExtHostContext,\n\t\t@IEmbeddingsService private readonly embeddingsService: IEmbeddingsService\n\t) {\n\t\tthis._proxy = context.getProxy(ExtHostContext.ExtHostEmbeddings);\n\n\t\tthis._store.add(embeddingsService.onDidChange((() => {\n\t\t\tthis._proxy.$acceptEmbeddingModels(Array.from(embeddingsService.allProviders));\n\t\t})));\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n\n\t$registerEmbeddingProvider(handle: number, identifier: string): void {\n\t\tconst registration = this.embeddingsService.registerProvider(identifier, {\n\t\t\tprovideEmbeddings: (input: string[], token: CancellationToken): Promise<{ values: number[] }[]> => {\n\t\t\t\treturn this._proxy.$provideEmbeddings(handle, input, token);\n\t\t\t}\n\t\t});\n\t\tthis._providers.set(handle, registration);\n\t}\n\n\t$unregisterEmbeddingProvider(handle: number): void {\n\t\tthis._providers.deleteAndDispose(handle);\n\t}\n\n\t$computeEmbeddings(embeddingsModel: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]> {\n\t\treturn this.embeddingsService.computeEmbeddings(embeddingsModel, input, token);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { DisposableMap, DisposableStore, IDisposable } from '../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { ExtHostContext, ExtHostEmbeddingsShape, MainContext, MainThreadEmbeddingsShape } from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\n\n\ninterface IEmbeddingsProvider {\n\tprovideEmbeddings(input: string[], token: CancellationToken): Promise<{ values: number[] }[]>;\n}\n\nconst IEmbeddingsService = createDecorator<IEmbeddingsService>('embeddingsService');\n\ninterface IEmbeddingsService {\n\n\t_serviceBrand: undefined;\n\n\treadonly onDidChange: Event<void>;\n\n\tallProviders: Iterable<string>;\n\n\tregisterProvider(id: string, provider: IEmbeddingsProvider): IDisposable;\n\n\tcomputeEmbeddings(id: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]>;\n}\n\nclass EmbeddingsService implements IEmbeddingsService {\n\t_serviceBrand: undefined;\n\n\tprivate providers: Map<string, IEmbeddingsProvider>;\n\n\tprivate readonly _onDidChange = new Emitter<void>();\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tconstructor() {\n\t\tthis.providers = new Map<string, IEmbeddingsProvider>();\n\t}\n\n\tget allProviders(): Iterable<string> {\n\t\treturn this.providers.keys();\n\t}\n\n\tregisterProvider(id: string, provider: IEmbeddingsProvider): IDisposable {\n\t\tthis.providers.set(id, provider);\n\t\tthis._onDidChange.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis.providers.delete(id);\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}\n\t\t};\n\t}\n\n\tcomputeEmbeddings(id: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]> {\n\t\tconst provider = this.providers.get(id);\n\t\tif (provider) {\n\t\t\treturn provider.provideEmbeddings(input, token);\n\t\t} else {\n\t\t\treturn Promise.reject(new Error(`No embeddings provider registered with id: ${id}`));\n\t\t}\n\t}\n}\n\n\nregisterSingleton(IEmbeddingsService, EmbeddingsService, InstantiationType.Delayed);\n\n@extHostNamedCustomer(MainContext.MainThreadEmbeddings)\nexport class MainThreadEmbeddings implements MainThreadEmbeddingsShape {\n\n\tprivate readonly _store = new DisposableStore();\n\tprivate readonly _providers = this._store.add(new DisposableMap<number>);\n\tprivate readonly _proxy: ExtHostEmbeddingsShape;\n\n\tconstructor(\n\t\tcontext: IExtHostContext,\n\t\t@IEmbeddingsService private readonly embeddingsService: IEmbeddingsService\n\t) {\n\t\tthis._proxy = context.getProxy(ExtHostContext.ExtHostEmbeddings);\n\n\t\tthis._store.add(embeddingsService.onDidChange((() => {\n\t\t\tthis._proxy.$acceptEmbeddingModels(Array.from(embeddingsService.allProviders));\n\t\t})));\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n\n\t$registerEmbeddingProvider(handle: number, identifier: string): void {\n\t\tconst registration = this.embeddingsService.registerProvider(identifier, {\n\t\t\tprovideEmbeddings: (input: string[], token: CancellationToken): Promise<{ values: number[] }[]> => {\n\t\t\t\treturn this._proxy.$provideEmbeddings(handle, input, token);\n\t\t\t}\n\t\t});\n\t\tthis._providers.set(handle, registration);\n\t}\n\n\t$unregisterEmbeddingProvider(handle: number): void {\n\t\tthis._providers.deleteAndDispose(handle);\n\t}\n\n\t$computeEmbeddings(embeddingsModel: string, input: string[], token: CancellationToken): Promise<{ values: number[] }[]> {\n\t\treturn this.embeddingsService.computeEmbeddings(embeddingsModel, input, token);\n\t}\n}\n"]}