{"version":3,"sources":["vs/workbench/api/browser/mainThreadProgress.ts"],"names":[],"mappings":"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","file":"mainThreadProgress.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IProgress, IProgressService, IProgressStep, ProgressLocation, IProgressOptions, IProgressNotificationOptions } from '../../../platform/progress/common/progress.js';\nimport { MainThreadProgressShape, MainContext, ExtHostProgressShape, ExtHostContext } from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { localize } from '../../../nls.js';\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\nimport { toAction } from '../../../base/common/actions.js';\nimport { NotificationPriority } from '../../../platform/notification/common/notification.js';\n\n@extHostNamedCustomer(MainContext.MainThreadProgress)\nexport class MainThreadProgress implements MainThreadProgressShape {\n\n\tprivate static readonly URGENT_PROGRESS_SOURCES = [\n\t\t'vscode.github-authentication',\n\t\t'vscode.microsoft-authentication'\n\t];\n\n\tprivate readonly _progressService: IProgressService;\n\tprivate _progress = new Map<number, { resolve: () => void; progress: IProgress<IProgressStep> }>();\n\tprivate readonly _proxy: ExtHostProgressShape;\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IProgressService progressService: IProgressService,\n\t\t@ICommandService private readonly _commandService: ICommandService\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostProgress);\n\t\tthis._progressService = progressService;\n\t}\n\n\tdispose(): void {\n\t\tthis._progress.forEach(handle => handle.resolve());\n\t\tthis._progress.clear();\n\t}\n\n\tasync $startProgress(handle: number, options: IProgressOptions, extensionId?: string): Promise<void> {\n\t\tconst task = this._createTask(handle);\n\n\t\tif (options.location === ProgressLocation.Notification && extensionId) {\n\t\t\tconst sourceIsUrgent = MainThreadProgress.URGENT_PROGRESS_SOURCES.includes(extensionId);\n\t\t\tconst notificationOptions: IProgressNotificationOptions = {\n\t\t\t\t...options,\n\t\t\t\tpriority: sourceIsUrgent ? NotificationPriority.URGENT : NotificationPriority.DEFAULT,\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\tsecondaryActions: [toAction({\n\t\t\t\t\tid: extensionId,\n\t\t\t\t\tlabel: localize('manageExtension', \"Manage Extension\"),\n\t\t\t\t\trun: () => this._commandService.executeCommand('_extensions.manage', extensionId)\n\t\t\t\t})]\n\t\t\t};\n\n\t\t\toptions = notificationOptions;\n\t\t}\n\n\t\ttry {\n\t\t\tthis._progressService.withProgress(options, task, () => this._proxy.$acceptProgressCanceled(handle));\n\t\t} catch (err) {\n\t\t\t// the withProgress-method will throw synchronously when invoked with bad options\n\t\t\t// which is then an enternal/extension error\n\t\t\tonUnexpectedExternalError(err);\n\t\t}\n\t}\n\n\t$progressReport(handle: number, message: IProgressStep): void {\n\t\tconst entry = this._progress.get(handle);\n\t\tentry?.progress.report(message);\n\t}\n\n\t$progressEnd(handle: number): void {\n\t\tconst entry = this._progress.get(handle);\n\t\tif (entry) {\n\t\t\tentry.resolve();\n\t\t\tthis._progress.delete(handle);\n\t\t}\n\t}\n\n\tprivate _createTask(handle: number) {\n\t\treturn (progress: IProgress<IProgressStep>) => {\n\t\t\treturn new Promise<void>(resolve => {\n\t\t\t\tthis._progress.set(handle, { resolve, progress });\n\t\t\t});\n\t\t};\n\t}\n}\n"]}