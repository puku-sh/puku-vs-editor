{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadEditors.ts","vs/workbench/api/browser/mainThreadEditors.ts"],"names":[],"mappings":"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","file":"mainThreadEditors.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { illegalArgument } from '../../../base/common/errors.js';\nimport { IDisposable, dispose, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { equals as objectEquals } from '../../../base/common/objects.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from '../../../editor/browser/services/codeEditorService.js';\nimport { IRange } from '../../../editor/common/core/range.js';\nimport { ISelection } from '../../../editor/common/core/selection.js';\nimport { IDecorationOptions, IDecorationRenderOptions } from '../../../editor/common/editorCommon.js';\nimport { ISingleEditOperation } from '../../../editor/common/core/editOperation.js';\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\nimport { ITextEditorOptions, IResourceEditorInput, EditorActivation, EditorResolution, ITextEditorDiffInformation, isTextEditorDiffInformationEqual, ITextEditorChange } from '../../../platform/editor/common/editor.js';\nimport { ServicesAccessor } from '../../../platform/instantiation/common/instantiation.js';\nimport { MainThreadTextEditor } from './mainThreadEditor.js';\nimport { ExtHostContext, ExtHostEditorsShape, IApplyEditsOptions, ITextDocumentShowOptions, ITextEditorConfigurationUpdate, ITextEditorPositionData, IUndoStopOptions, MainThreadTextEditorsShape, TextEditorRevealType } from '../common/extHost.protocol.js';\nimport { editorGroupToColumn, columnToEditorGroup, EditorGroupColumn } from '../../services/editor/common/editorGroupColumn.js';\nimport { IEditorService } from '../../services/editor/common/editorService.js';\nimport { IEditorGroupsService } from '../../services/editor/common/editorGroupsService.js';\nimport { IEnvironmentService } from '../../../platform/environment/common/environment.js';\nimport { IWorkingCopyService } from '../../services/workingCopy/common/workingCopyService.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { IChange } from '../../../editor/common/diff/legacyLinesDiffComputer.js';\nimport { IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { IEditorControl } from '../../common/editor.js';\nimport { getCodeEditor, ICodeEditor } from '../../../editor/browser/editorBrowser.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { IQuickDiffModelService } from '../../contrib/scm/browser/quickDiffModel.js';\nimport { autorun, constObservable, derived, derivedOpts, IObservable, observableFromEvent } from '../../../base/common/observable.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { isITextModel } from '../../../editor/common/model.js';\nimport { LineRangeMapping } from '../../../editor/common/diff/rangeMapping.js';\nimport { equals } from '../../../base/common/arrays.js';\nimport { Event } from '../../../base/common/event.js';\nimport { DiffAlgorithmName } from '../../../editor/common/services/editorWorker.js';\n\nexport interface IMainThreadEditorLocator {\n\tgetEditor(id: string): MainThreadTextEditor | undefined;\n\tfindTextEditorIdFor(editorControl: IEditorControl): string | undefined;\n\tgetIdOfCodeEditor(codeEditor: ICodeEditor): string | undefined;\n}\n\nexport class MainThreadTextEditors implements MainThreadTextEditorsShape {\n\n\tprivate static INSTANCE_COUNT: number = 0;\n\n\tprivate readonly _instanceId: string;\n\tprivate readonly _proxy: ExtHostEditorsShape;\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate _textEditorsListenersMap: { [editorId: string]: IDisposable[] };\n\tprivate _editorPositionData: ITextEditorPositionData | null;\n\tprivate _registeredDecorationTypes: { [decorationType: string]: boolean };\n\n\tconstructor(\n\t\tprivate readonly _editorLocator: IMainThreadEditorLocator,\n\t\textHostContext: IExtHostContext,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly _editorGroupService: IEditorGroupsService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IQuickDiffModelService private readonly _quickDiffModelService: IQuickDiffModelService,\n\t\t@IUriIdentityService private readonly _uriIdentityService: IUriIdentityService\n\t) {\n\t\tthis._instanceId = String(++MainThreadTextEditors.INSTANCE_COUNT);\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostEditors);\n\n\t\tthis._textEditorsListenersMap = Object.create(null);\n\t\tthis._editorPositionData = null;\n\n\t\tthis._toDispose.add(this._editorService.onDidVisibleEditorsChange(() => this._updateActiveAndVisibleTextEditors()));\n\t\tthis._toDispose.add(this._editorGroupService.onDidRemoveGroup(() => this._updateActiveAndVisibleTextEditors()));\n\t\tthis._toDispose.add(this._editorGroupService.onDidMoveGroup(() => this._updateActiveAndVisibleTextEditors()));\n\n\t\tthis._registeredDecorationTypes = Object.create(null);\n\t}\n\n\tdispose(): void {\n\t\tObject.keys(this._textEditorsListenersMap).forEach((editorId) => {\n\t\t\tdispose(this._textEditorsListenersMap[editorId]);\n\t\t});\n\t\tthis._textEditorsListenersMap = Object.create(null);\n\t\tthis._toDispose.dispose();\n\t\tfor (const decorationType in this._registeredDecorationTypes) {\n\t\t\tthis._codeEditorService.removeDecorationType(decorationType);\n\t\t}\n\t\tthis._registeredDecorationTypes = Object.create(null);\n\t}\n\n\thandleTextEditorAdded(textEditor: MainThreadTextEditor): void {\n\t\tconst id = textEditor.getId();\n\t\tconst toDispose: IDisposable[] = [];\n\t\ttoDispose.push(textEditor.onPropertiesChanged((data) => {\n\t\t\tthis._proxy.$acceptEditorPropertiesChanged(id, data);\n\t\t}));\n\n\t\tconst diffInformationObs = this._getTextEditorDiffInformation(textEditor, toDispose);\n\t\ttoDispose.push(autorun(reader => {\n\t\t\tconst diffInformation = diffInformationObs.read(reader);\n\t\t\tthis._proxy.$acceptEditorDiffInformation(id, diffInformation);\n\t\t}));\n\n\t\tthis._textEditorsListenersMap[id] = toDispose;\n\t}\n\n\thandleTextEditorRemoved(id: string): void {\n\t\tdispose(this._textEditorsListenersMap[id]);\n\t\tdelete this._textEditorsListenersMap[id];\n\t}\n\n\tprivate _updateActiveAndVisibleTextEditors(): void {\n\n\t\t// editor columns\n\t\tconst editorPositionData = this._getTextEditorPositionData();\n\t\tif (!objectEquals(this._editorPositionData, editorPositionData)) {\n\t\t\tthis._editorPositionData = editorPositionData;\n\t\t\tthis._proxy.$acceptEditorPositionData(this._editorPositionData);\n\t\t}\n\t}\n\n\tprivate _getTextEditorPositionData(): ITextEditorPositionData {\n\t\tconst result: ITextEditorPositionData = Object.create(null);\n\t\tfor (const editorPane of this._editorService.visibleEditorPanes) {\n\t\t\tconst id = this._editorLocator.findTextEditorIdFor(editorPane);\n\t\t\tif (id) {\n\t\t\t\tresult[id] = editorGroupToColumn(this._editorGroupService, editorPane.group);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTextEditorDiffInformation(textEditor: MainThreadTextEditor, toDispose: IDisposable[]): IObservable<ITextEditorDiffInformation[] | undefined> {\n\t\tconst codeEditor = textEditor.getCodeEditor();\n\t\tif (!codeEditor) {\n\t\t\treturn constObservable(undefined);\n\t\t}\n\n\t\t// Check if the TextModel belongs to a DiffEditor\n\t\tconst [diffEditor] = this._codeEditorService.listDiffEditors()\n\t\t\t.filter(d =>\n\t\t\t\td.getOriginalEditor().getId() === codeEditor.getId() ||\n\t\t\t\td.getModifiedEditor().getId() === codeEditor.getId());\n\n\t\tconst editorModelObs = diffEditor\n\t\t\t? observableFromEvent(this, diffEditor.onDidChangeModel, () => diffEditor.getModel())\n\t\t\t: observableFromEvent(this, codeEditor.onDidChangeModel, () => codeEditor.getModel());\n\n\t\tconst editorChangesObs = derived<IObservable<{ original: URI; modified: URI; changes: readonly LineRangeMapping[] }[] | undefined>>(reader => {\n\t\t\tconst editorModel = editorModelObs.read(reader);\n\t\t\tif (!editorModel) {\n\t\t\t\treturn constObservable(undefined);\n\t\t\t}\n\n\t\t\tconst editorModelUri = isITextModel(editorModel)\n\t\t\t\t? editorModel.uri\n\t\t\t\t: editorModel.modified.uri;\n\n\t\t\t// TextEditor\n\t\t\tif (isITextModel(editorModel)) {\n\t\t\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(editorModelUri);\n\t\t\t\tif (!quickDiffModelRef) {\n\t\t\t\t\treturn constObservable(undefined);\n\t\t\t\t}\n\n\t\t\t\ttoDispose.push(quickDiffModelRef);\n\t\t\t\treturn observableFromEvent(this, quickDiffModelRef.object.onDidChange, () => {\n\t\t\t\t\treturn quickDiffModelRef.object.getQuickDiffResults()\n\t\t\t\t\t\t.map(result => ({\n\t\t\t\t\t\t\toriginal: result.original,\n\t\t\t\t\t\t\tmodified: result.modified,\n\t\t\t\t\t\t\tchanges: result.changes2\n\t\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// DirtyDiffModel - we create a dirty diff model for diff editor so that\n\t\t\t// we can provide multiple \"original resources\" to diff with the modified\n\t\t\t// resource.\n\t\t\tconst diffAlgorithm = this._configurationService.getValue<DiffAlgorithmName>('diffEditor.diffAlgorithm');\n\t\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(editorModelUri, { algorithm: diffAlgorithm });\n\t\t\tif (!quickDiffModelRef) {\n\t\t\t\treturn constObservable(undefined);\n\t\t\t}\n\n\t\t\ttoDispose.push(quickDiffModelRef);\n\t\t\treturn observableFromEvent(Event.any(quickDiffModelRef.object.onDidChange, diffEditor.onDidUpdateDiff), () => {\n\t\t\t\tconst quickDiffInformation = quickDiffModelRef.object.getQuickDiffResults()\n\t\t\t\t\t.map(result => ({\n\t\t\t\t\t\toriginal: result.original,\n\t\t\t\t\t\tmodified: result.modified,\n\t\t\t\t\t\tchanges: result.changes2\n\t\t\t\t\t}));\n\n\t\t\t\tconst diffChanges = diffEditor.getDiffComputationResult()?.changes2 ?? [];\n\t\t\t\tconst diffInformation = [{\n\t\t\t\t\toriginal: editorModel.original.uri,\n\t\t\t\t\tmodified: editorModel.modified.uri,\n\t\t\t\t\tchanges: diffChanges.map(change => change as LineRangeMapping)\n\t\t\t\t}];\n\n\t\t\t\treturn [...quickDiffInformation, ...diffInformation];\n\t\t\t});\n\t\t});\n\n\t\treturn derivedOpts({\n\t\t\towner: this,\n\t\t\tequalsFn: (diff1, diff2) => equals(diff1, diff2, (a, b) => isTextEditorDiffInformationEqual(this._uriIdentityService, a, b))\n\t\t}, reader => {\n\t\t\tconst editorModel = editorModelObs.read(reader);\n\t\t\tconst editorChanges = editorChangesObs.read(reader).read(reader);\n\t\t\tif (!editorModel || !editorChanges) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst documentVersion = isITextModel(editorModel)\n\t\t\t\t? editorModel.getVersionId()\n\t\t\t\t: editorModel.modified.getVersionId();\n\n\t\t\treturn editorChanges.map(change => {\n\t\t\t\tconst changes: ITextEditorChange[] = change.changes\n\t\t\t\t\t.map(change => [\n\t\t\t\t\t\tchange.original.startLineNumber,\n\t\t\t\t\t\tchange.original.endLineNumberExclusive,\n\t\t\t\t\t\tchange.modified.startLineNumber,\n\t\t\t\t\t\tchange.modified.endLineNumberExclusive\n\t\t\t\t\t]);\n\n\t\t\t\treturn {\n\t\t\t\t\tdocumentVersion,\n\t\t\t\t\toriginal: change.original,\n\t\t\t\t\tmodified: change.modified,\n\t\t\t\t\tchanges\n\t\t\t\t};\n\t\t\t});\n\t\t});\n\t}\n\n\t// --- from extension host process\n\n\tasync $tryShowTextDocument(resource: UriComponents, options: ITextDocumentShowOptions): Promise<string | undefined> {\n\t\tconst uri = URI.revive(resource);\n\n\t\tconst editorOptions: ITextEditorOptions = {\n\t\t\tpreserveFocus: options.preserveFocus,\n\t\t\tpinned: options.pinned,\n\t\t\tselection: options.selection,\n\t\t\t// preserve pre 1.38 behaviour to not make group active when preserveFocus: true\n\t\t\t// but make sure to restore the editor to fix https://github.com/microsoft/vscode/issues/79633\n\t\t\tactivation: options.preserveFocus ? EditorActivation.RESTORE : undefined,\n\t\t\toverride: EditorResolution.EXCLUSIVE_ONLY\n\t\t};\n\n\t\tconst input: IResourceEditorInput = {\n\t\t\tresource: uri,\n\t\t\toptions: editorOptions\n\t\t};\n\n\t\tconst editor = await this._editorService.openEditor(input, columnToEditorGroup(this._editorGroupService, this._configurationService, options.position));\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\t\t// Composite editors are made up of many editors so we return the active one at the time of opening\n\t\tconst editorControl = editor.getControl();\n\t\tconst codeEditor = getCodeEditor(editorControl);\n\t\treturn codeEditor ? this._editorLocator.getIdOfCodeEditor(codeEditor) : undefined;\n\t}\n\n\tasync $tryShowEditor(id: string, position?: EditorGroupColumn): Promise<void> {\n\t\tconst mainThreadEditor = this._editorLocator.getEditor(id);\n\t\tif (mainThreadEditor) {\n\t\t\tconst model = mainThreadEditor.getModel();\n\t\t\tawait this._editorService.openEditor({\n\t\t\t\tresource: model.uri,\n\t\t\t\toptions: { preserveFocus: false }\n\t\t\t}, columnToEditorGroup(this._editorGroupService, this._configurationService, position));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tasync $tryHideEditor(id: string): Promise<void> {\n\t\tconst mainThreadEditor = this._editorLocator.getEditor(id);\n\t\tif (mainThreadEditor) {\n\t\t\tconst editorPanes = this._editorService.visibleEditorPanes;\n\t\t\tfor (const editorPane of editorPanes) {\n\t\t\t\tif (mainThreadEditor.matches(editorPane)) {\n\t\t\t\t\tawait editorPane.group.closeEditor(editorPane.input);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t$trySetSelections(id: string, selections: ISelection[]): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setSelections(selections);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$trySetDecorations(id: string, key: string, ranges: IDecorationOptions[]): Promise<void> {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setDecorations(key, ranges);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$trySetDecorationsFast(id: string, key: string, ranges: number[]): Promise<void> {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setDecorationsFast(key, ranges);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$tryRevealRange(id: string, range: IRange, revealType: TextEditorRevealType): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.revealRange(range, revealType);\n\t\treturn Promise.resolve();\n\t}\n\n\t$trySetOptions(id: string, options: ITextEditorConfigurationUpdate): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setConfiguration(options);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$tryApplyEdits(id: string, modelVersionId: number, edits: ISingleEditOperation[], opts: IApplyEditsOptions): Promise<boolean> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\treturn Promise.resolve(editor.applyEdits(modelVersionId, edits, opts));\n\t}\n\n\t$tryInsertSnippet(id: string, modelVersionId: number, template: string, ranges: readonly IRange[], opts: IUndoStopOptions): Promise<boolean> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\treturn Promise.resolve(editor.insertSnippet(modelVersionId, template, ranges, opts));\n\t}\n\n\t$registerTextEditorDecorationType(extensionId: ExtensionIdentifier, key: string, options: IDecorationRenderOptions): void {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tthis._registeredDecorationTypes[key] = true;\n\t\tthis._codeEditorService.registerDecorationType(`exthost-api-${extensionId}`, key, options);\n\t}\n\n\t$removeTextEditorDecorationType(key: string): void {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tdelete this._registeredDecorationTypes[key];\n\t\tthis._codeEditorService.removeDecorationType(key);\n\t}\n\n\t$getDiffInformation(id: string): Promise<IChange[]> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(new Error('No such TextEditor'));\n\t\t}\n\n\t\tconst codeEditor = editor.getCodeEditor();\n\t\tif (!codeEditor) {\n\t\t\treturn Promise.reject(new Error('No such CodeEditor'));\n\t\t}\n\n\t\tconst codeEditorId = codeEditor.getId();\n\t\tconst diffEditors = this._codeEditorService.listDiffEditors();\n\t\tconst [diffEditor] = diffEditors.filter(d => d.getOriginalEditor().getId() === codeEditorId || d.getModifiedEditor().getId() === codeEditorId);\n\n\t\tif (diffEditor) {\n\t\t\treturn Promise.resolve(diffEditor.getLineChanges() || []);\n\t\t}\n\n\t\tif (!codeEditor.hasModel()) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(codeEditor.getModel().uri);\n\t\tif (!quickDiffModelRef) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\ttry {\n\t\t\tconst primaryQuickDiff = quickDiffModelRef.object.quickDiffs.find(quickDiff => quickDiff.kind === 'primary');\n\t\t\tconst primaryQuickDiffChanges = quickDiffModelRef.object.changes.filter(change => change.providerId === primaryQuickDiff?.id);\n\n\t\t\treturn Promise.resolve(primaryQuickDiffChanges.map(change => change.change) ?? []);\n\t\t} finally {\n\t\t\tquickDiffModelRef.dispose();\n\t\t}\n\t}\n}\n\n// --- commands\n\nCommandsRegistry.registerCommand('_workbench.revertAllDirty', async function (accessor: ServicesAccessor) {\n\tconst environmentService = accessor.get(IEnvironmentService);\n\tif (!environmentService.extensionTestsLocationURI) {\n\t\tthrow new Error('Command is only available when running extension tests.');\n\t}\n\n\tconst workingCopyService = accessor.get(IWorkingCopyService);\n\tfor (const workingCopy of workingCopyService.dirtyWorkingCopies) {\n\t\tawait workingCopy.revert({ soft: true });\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { illegalArgument } from '../../../base/common/errors.js';\nimport { IDisposable, dispose, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { equals as objectEquals } from '../../../base/common/objects.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from '../../../editor/browser/services/codeEditorService.js';\nimport { IRange } from '../../../editor/common/core/range.js';\nimport { ISelection } from '../../../editor/common/core/selection.js';\nimport { IDecorationOptions, IDecorationRenderOptions } from '../../../editor/common/editorCommon.js';\nimport { ISingleEditOperation } from '../../../editor/common/core/editOperation.js';\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\nimport { ITextEditorOptions, IResourceEditorInput, EditorActivation, EditorResolution, ITextEditorDiffInformation, isTextEditorDiffInformationEqual, ITextEditorChange } from '../../../platform/editor/common/editor.js';\nimport { ServicesAccessor } from '../../../platform/instantiation/common/instantiation.js';\nimport { MainThreadTextEditor } from './mainThreadEditor.js';\nimport { ExtHostContext, ExtHostEditorsShape, IApplyEditsOptions, ITextDocumentShowOptions, ITextEditorConfigurationUpdate, ITextEditorPositionData, IUndoStopOptions, MainThreadTextEditorsShape, TextEditorRevealType } from '../common/extHost.protocol.js';\nimport { editorGroupToColumn, columnToEditorGroup, EditorGroupColumn } from '../../services/editor/common/editorGroupColumn.js';\nimport { IEditorService } from '../../services/editor/common/editorService.js';\nimport { IEditorGroupsService } from '../../services/editor/common/editorGroupsService.js';\nimport { IEnvironmentService } from '../../../platform/environment/common/environment.js';\nimport { IWorkingCopyService } from '../../services/workingCopy/common/workingCopyService.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { IChange } from '../../../editor/common/diff/legacyLinesDiffComputer.js';\nimport { IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { IEditorControl } from '../../common/editor.js';\nimport { getCodeEditor, ICodeEditor } from '../../../editor/browser/editorBrowser.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { IQuickDiffModelService } from '../../contrib/scm/browser/quickDiffModel.js';\nimport { autorun, constObservable, derived, derivedOpts, IObservable, observableFromEvent } from '../../../base/common/observable.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { isITextModel } from '../../../editor/common/model.js';\nimport { LineRangeMapping } from '../../../editor/common/diff/rangeMapping.js';\nimport { equals } from '../../../base/common/arrays.js';\nimport { Event } from '../../../base/common/event.js';\nimport { DiffAlgorithmName } from '../../../editor/common/services/editorWorker.js';\n\nexport interface IMainThreadEditorLocator {\n\tgetEditor(id: string): MainThreadTextEditor | undefined;\n\tfindTextEditorIdFor(editorControl: IEditorControl): string | undefined;\n\tgetIdOfCodeEditor(codeEditor: ICodeEditor): string | undefined;\n}\n\nexport class MainThreadTextEditors implements MainThreadTextEditorsShape {\n\n\tprivate static INSTANCE_COUNT: number = 0;\n\n\tprivate readonly _instanceId: string;\n\tprivate readonly _proxy: ExtHostEditorsShape;\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate _textEditorsListenersMap: { [editorId: string]: IDisposable[] };\n\tprivate _editorPositionData: ITextEditorPositionData | null;\n\tprivate _registeredDecorationTypes: { [decorationType: string]: boolean };\n\n\tconstructor(\n\t\tprivate readonly _editorLocator: IMainThreadEditorLocator,\n\t\textHostContext: IExtHostContext,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly _editorGroupService: IEditorGroupsService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IQuickDiffModelService private readonly _quickDiffModelService: IQuickDiffModelService,\n\t\t@IUriIdentityService private readonly _uriIdentityService: IUriIdentityService\n\t) {\n\t\tthis._instanceId = String(++MainThreadTextEditors.INSTANCE_COUNT);\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostEditors);\n\n\t\tthis._textEditorsListenersMap = Object.create(null);\n\t\tthis._editorPositionData = null;\n\n\t\tthis._toDispose.add(this._editorService.onDidVisibleEditorsChange(() => this._updateActiveAndVisibleTextEditors()));\n\t\tthis._toDispose.add(this._editorGroupService.onDidRemoveGroup(() => this._updateActiveAndVisibleTextEditors()));\n\t\tthis._toDispose.add(this._editorGroupService.onDidMoveGroup(() => this._updateActiveAndVisibleTextEditors()));\n\n\t\tthis._registeredDecorationTypes = Object.create(null);\n\t}\n\n\tdispose(): void {\n\t\tObject.keys(this._textEditorsListenersMap).forEach((editorId) => {\n\t\t\tdispose(this._textEditorsListenersMap[editorId]);\n\t\t});\n\t\tthis._textEditorsListenersMap = Object.create(null);\n\t\tthis._toDispose.dispose();\n\t\tfor (const decorationType in this._registeredDecorationTypes) {\n\t\t\tthis._codeEditorService.removeDecorationType(decorationType);\n\t\t}\n\t\tthis._registeredDecorationTypes = Object.create(null);\n\t}\n\n\thandleTextEditorAdded(textEditor: MainThreadTextEditor): void {\n\t\tconst id = textEditor.getId();\n\t\tconst toDispose: IDisposable[] = [];\n\t\ttoDispose.push(textEditor.onPropertiesChanged((data) => {\n\t\t\tthis._proxy.$acceptEditorPropertiesChanged(id, data);\n\t\t}));\n\n\t\tconst diffInformationObs = this._getTextEditorDiffInformation(textEditor, toDispose);\n\t\ttoDispose.push(autorun(reader => {\n\t\t\tconst diffInformation = diffInformationObs.read(reader);\n\t\t\tthis._proxy.$acceptEditorDiffInformation(id, diffInformation);\n\t\t}));\n\n\t\tthis._textEditorsListenersMap[id] = toDispose;\n\t}\n\n\thandleTextEditorRemoved(id: string): void {\n\t\tdispose(this._textEditorsListenersMap[id]);\n\t\tdelete this._textEditorsListenersMap[id];\n\t}\n\n\tprivate _updateActiveAndVisibleTextEditors(): void {\n\n\t\t// editor columns\n\t\tconst editorPositionData = this._getTextEditorPositionData();\n\t\tif (!objectEquals(this._editorPositionData, editorPositionData)) {\n\t\t\tthis._editorPositionData = editorPositionData;\n\t\t\tthis._proxy.$acceptEditorPositionData(this._editorPositionData);\n\t\t}\n\t}\n\n\tprivate _getTextEditorPositionData(): ITextEditorPositionData {\n\t\tconst result: ITextEditorPositionData = Object.create(null);\n\t\tfor (const editorPane of this._editorService.visibleEditorPanes) {\n\t\t\tconst id = this._editorLocator.findTextEditorIdFor(editorPane);\n\t\t\tif (id) {\n\t\t\t\tresult[id] = editorGroupToColumn(this._editorGroupService, editorPane.group);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTextEditorDiffInformation(textEditor: MainThreadTextEditor, toDispose: IDisposable[]): IObservable<ITextEditorDiffInformation[] | undefined> {\n\t\tconst codeEditor = textEditor.getCodeEditor();\n\t\tif (!codeEditor) {\n\t\t\treturn constObservable(undefined);\n\t\t}\n\n\t\t// Check if the TextModel belongs to a DiffEditor\n\t\tconst [diffEditor] = this._codeEditorService.listDiffEditors()\n\t\t\t.filter(d =>\n\t\t\t\td.getOriginalEditor().getId() === codeEditor.getId() ||\n\t\t\t\td.getModifiedEditor().getId() === codeEditor.getId());\n\n\t\tconst editorModelObs = diffEditor\n\t\t\t? observableFromEvent(this, diffEditor.onDidChangeModel, () => diffEditor.getModel())\n\t\t\t: observableFromEvent(this, codeEditor.onDidChangeModel, () => codeEditor.getModel());\n\n\t\tconst editorChangesObs = derived<IObservable<{ original: URI; modified: URI; changes: readonly LineRangeMapping[] }[] | undefined>>(reader => {\n\t\t\tconst editorModel = editorModelObs.read(reader);\n\t\t\tif (!editorModel) {\n\t\t\t\treturn constObservable(undefined);\n\t\t\t}\n\n\t\t\tconst editorModelUri = isITextModel(editorModel)\n\t\t\t\t? editorModel.uri\n\t\t\t\t: editorModel.modified.uri;\n\n\t\t\t// TextEditor\n\t\t\tif (isITextModel(editorModel)) {\n\t\t\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(editorModelUri);\n\t\t\t\tif (!quickDiffModelRef) {\n\t\t\t\t\treturn constObservable(undefined);\n\t\t\t\t}\n\n\t\t\t\ttoDispose.push(quickDiffModelRef);\n\t\t\t\treturn observableFromEvent(this, quickDiffModelRef.object.onDidChange, () => {\n\t\t\t\t\treturn quickDiffModelRef.object.getQuickDiffResults()\n\t\t\t\t\t\t.map(result => ({\n\t\t\t\t\t\t\toriginal: result.original,\n\t\t\t\t\t\t\tmodified: result.modified,\n\t\t\t\t\t\t\tchanges: result.changes2\n\t\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// DirtyDiffModel - we create a dirty diff model for diff editor so that\n\t\t\t// we can provide multiple \"original resources\" to diff with the modified\n\t\t\t// resource.\n\t\t\tconst diffAlgorithm = this._configurationService.getValue<DiffAlgorithmName>('diffEditor.diffAlgorithm');\n\t\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(editorModelUri, { algorithm: diffAlgorithm });\n\t\t\tif (!quickDiffModelRef) {\n\t\t\t\treturn constObservable(undefined);\n\t\t\t}\n\n\t\t\ttoDispose.push(quickDiffModelRef);\n\t\t\treturn observableFromEvent(Event.any(quickDiffModelRef.object.onDidChange, diffEditor.onDidUpdateDiff), () => {\n\t\t\t\tconst quickDiffInformation = quickDiffModelRef.object.getQuickDiffResults()\n\t\t\t\t\t.map(result => ({\n\t\t\t\t\t\toriginal: result.original,\n\t\t\t\t\t\tmodified: result.modified,\n\t\t\t\t\t\tchanges: result.changes2\n\t\t\t\t\t}));\n\n\t\t\t\tconst diffChanges = diffEditor.getDiffComputationResult()?.changes2 ?? [];\n\t\t\t\tconst diffInformation = [{\n\t\t\t\t\toriginal: editorModel.original.uri,\n\t\t\t\t\tmodified: editorModel.modified.uri,\n\t\t\t\t\tchanges: diffChanges.map(change => change as LineRangeMapping)\n\t\t\t\t}];\n\n\t\t\t\treturn [...quickDiffInformation, ...diffInformation];\n\t\t\t});\n\t\t});\n\n\t\treturn derivedOpts({\n\t\t\towner: this,\n\t\t\tequalsFn: (diff1, diff2) => equals(diff1, diff2, (a, b) => isTextEditorDiffInformationEqual(this._uriIdentityService, a, b))\n\t\t}, reader => {\n\t\t\tconst editorModel = editorModelObs.read(reader);\n\t\t\tconst editorChanges = editorChangesObs.read(reader).read(reader);\n\t\t\tif (!editorModel || !editorChanges) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst documentVersion = isITextModel(editorModel)\n\t\t\t\t? editorModel.getVersionId()\n\t\t\t\t: editorModel.modified.getVersionId();\n\n\t\t\treturn editorChanges.map(change => {\n\t\t\t\tconst changes: ITextEditorChange[] = change.changes\n\t\t\t\t\t.map(change => [\n\t\t\t\t\t\tchange.original.startLineNumber,\n\t\t\t\t\t\tchange.original.endLineNumberExclusive,\n\t\t\t\t\t\tchange.modified.startLineNumber,\n\t\t\t\t\t\tchange.modified.endLineNumberExclusive\n\t\t\t\t\t]);\n\n\t\t\t\treturn {\n\t\t\t\t\tdocumentVersion,\n\t\t\t\t\toriginal: change.original,\n\t\t\t\t\tmodified: change.modified,\n\t\t\t\t\tchanges\n\t\t\t\t};\n\t\t\t});\n\t\t});\n\t}\n\n\t// --- from extension host process\n\n\tasync $tryShowTextDocument(resource: UriComponents, options: ITextDocumentShowOptions): Promise<string | undefined> {\n\t\tconst uri = URI.revive(resource);\n\n\t\tconst editorOptions: ITextEditorOptions = {\n\t\t\tpreserveFocus: options.preserveFocus,\n\t\t\tpinned: options.pinned,\n\t\t\tselection: options.selection,\n\t\t\t// preserve pre 1.38 behaviour to not make group active when preserveFocus: true\n\t\t\t// but make sure to restore the editor to fix https://github.com/microsoft/vscode/issues/79633\n\t\t\tactivation: options.preserveFocus ? EditorActivation.RESTORE : undefined,\n\t\t\toverride: EditorResolution.EXCLUSIVE_ONLY\n\t\t};\n\n\t\tconst input: IResourceEditorInput = {\n\t\t\tresource: uri,\n\t\t\toptions: editorOptions\n\t\t};\n\n\t\tconst editor = await this._editorService.openEditor(input, columnToEditorGroup(this._editorGroupService, this._configurationService, options.position));\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\t\t// Composite editors are made up of many editors so we return the active one at the time of opening\n\t\tconst editorControl = editor.getControl();\n\t\tconst codeEditor = getCodeEditor(editorControl);\n\t\treturn codeEditor ? this._editorLocator.getIdOfCodeEditor(codeEditor) : undefined;\n\t}\n\n\tasync $tryShowEditor(id: string, position?: EditorGroupColumn): Promise<void> {\n\t\tconst mainThreadEditor = this._editorLocator.getEditor(id);\n\t\tif (mainThreadEditor) {\n\t\t\tconst model = mainThreadEditor.getModel();\n\t\t\tawait this._editorService.openEditor({\n\t\t\t\tresource: model.uri,\n\t\t\t\toptions: { preserveFocus: false }\n\t\t\t}, columnToEditorGroup(this._editorGroupService, this._configurationService, position));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tasync $tryHideEditor(id: string): Promise<void> {\n\t\tconst mainThreadEditor = this._editorLocator.getEditor(id);\n\t\tif (mainThreadEditor) {\n\t\t\tconst editorPanes = this._editorService.visibleEditorPanes;\n\t\t\tfor (const editorPane of editorPanes) {\n\t\t\t\tif (mainThreadEditor.matches(editorPane)) {\n\t\t\t\t\tawait editorPane.group.closeEditor(editorPane.input);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t$trySetSelections(id: string, selections: ISelection[]): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setSelections(selections);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$trySetDecorations(id: string, key: string, ranges: IDecorationOptions[]): Promise<void> {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setDecorations(key, ranges);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$trySetDecorationsFast(id: string, key: string, ranges: number[]): Promise<void> {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setDecorationsFast(key, ranges);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$tryRevealRange(id: string, range: IRange, revealType: TextEditorRevealType): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.revealRange(range, revealType);\n\t\treturn Promise.resolve();\n\t}\n\n\t$trySetOptions(id: string, options: ITextEditorConfigurationUpdate): Promise<void> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\teditor.setConfiguration(options);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$tryApplyEdits(id: string, modelVersionId: number, edits: ISingleEditOperation[], opts: IApplyEditsOptions): Promise<boolean> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\treturn Promise.resolve(editor.applyEdits(modelVersionId, edits, opts));\n\t}\n\n\t$tryInsertSnippet(id: string, modelVersionId: number, template: string, ranges: readonly IRange[], opts: IUndoStopOptions): Promise<boolean> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(illegalArgument(`TextEditor(${id})`));\n\t\t}\n\t\treturn Promise.resolve(editor.insertSnippet(modelVersionId, template, ranges, opts));\n\t}\n\n\t$registerTextEditorDecorationType(extensionId: ExtensionIdentifier, key: string, options: IDecorationRenderOptions): void {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tthis._registeredDecorationTypes[key] = true;\n\t\tthis._codeEditorService.registerDecorationType(`exthost-api-${extensionId}`, key, options);\n\t}\n\n\t$removeTextEditorDecorationType(key: string): void {\n\t\tkey = `${this._instanceId}-${key}`;\n\t\tdelete this._registeredDecorationTypes[key];\n\t\tthis._codeEditorService.removeDecorationType(key);\n\t}\n\n\t$getDiffInformation(id: string): Promise<IChange[]> {\n\t\tconst editor = this._editorLocator.getEditor(id);\n\n\t\tif (!editor) {\n\t\t\treturn Promise.reject(new Error('No such TextEditor'));\n\t\t}\n\n\t\tconst codeEditor = editor.getCodeEditor();\n\t\tif (!codeEditor) {\n\t\t\treturn Promise.reject(new Error('No such CodeEditor'));\n\t\t}\n\n\t\tconst codeEditorId = codeEditor.getId();\n\t\tconst diffEditors = this._codeEditorService.listDiffEditors();\n\t\tconst [diffEditor] = diffEditors.filter(d => d.getOriginalEditor().getId() === codeEditorId || d.getModifiedEditor().getId() === codeEditorId);\n\n\t\tif (diffEditor) {\n\t\t\treturn Promise.resolve(diffEditor.getLineChanges() || []);\n\t\t}\n\n\t\tif (!codeEditor.hasModel()) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tconst quickDiffModelRef = this._quickDiffModelService.createQuickDiffModelReference(codeEditor.getModel().uri);\n\t\tif (!quickDiffModelRef) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\ttry {\n\t\t\tconst primaryQuickDiff = quickDiffModelRef.object.quickDiffs.find(quickDiff => quickDiff.kind === 'primary');\n\t\t\tconst primaryQuickDiffChanges = quickDiffModelRef.object.changes.filter(change => change.providerId === primaryQuickDiff?.id);\n\n\t\t\treturn Promise.resolve(primaryQuickDiffChanges.map(change => change.change) ?? []);\n\t\t} finally {\n\t\t\tquickDiffModelRef.dispose();\n\t\t}\n\t}\n}\n\n// --- commands\n\nCommandsRegistry.registerCommand('_workbench.revertAllDirty', async function (accessor: ServicesAccessor) {\n\tconst environmentService = accessor.get(IEnvironmentService);\n\tif (!environmentService.extensionTestsLocationURI) {\n\t\tthrow new Error('Command is only available when running extension tests.');\n\t}\n\n\tconst workingCopyService = accessor.get(IWorkingCopyService);\n\tfor (const workingCopy of workingCopyService.dirtyWorkingCopies) {\n\t\tawait workingCopy.revert({ soft: true });\n\t}\n});\n"]}