{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadDebugService.ts","vs/workbench/api/browser/mainThreadDebugService.ts"],"names":[],"mappings":"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","file":"mainThreadDebugService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableMap, DisposableStore, IDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { URI as uri, UriComponents } from '../../../base/common/uri.js';\nimport { IDebugService, IConfig, IDebugConfigurationProvider, IBreakpoint, IFunctionBreakpoint, IBreakpointData, IDebugAdapter, IDebugAdapterDescriptorFactory, IDebugSession, IDebugAdapterFactory, IDataBreakpoint, IDebugSessionOptions, IInstructionBreakpoint, DebugConfigurationProviderTriggerKind, IDebugVisualization, DataBreakpointSetType } from '../../contrib/debug/common/debug.js';\nimport {\n\tExtHostContext, ExtHostDebugServiceShape, MainThreadDebugServiceShape, DebugSessionUUID, MainContext,\n\tIBreakpointsDeltaDto, ISourceMultiBreakpointDto, ISourceBreakpointDto, IFunctionBreakpointDto, IDebugSessionDto, IDataBreakpointDto, IStartDebuggingOptions, IDebugConfiguration, IThreadFocusDto, IStackFrameFocusDto\n} from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport severity from '../../../base/common/severity.js';\nimport { AbstractDebugAdapter } from '../../contrib/debug/common/abstractDebugAdapter.js';\nimport { IWorkspaceFolder } from '../../../platform/workspace/common/workspace.js';\nimport { convertToVSCPaths, convertToDAPaths, isSessionAttach } from '../../contrib/debug/common/debugUtils.js';\nimport { ErrorNoTelemetry } from '../../../base/common/errors.js';\nimport { IDebugVisualizerService } from '../../contrib/debug/common/debugVisualizers.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { Event } from '../../../base/common/event.js';\nimport { isDefined } from '../../../base/common/types.js';\n\n@extHostNamedCustomer(MainContext.MainThreadDebugService)\nexport class MainThreadDebugService implements MainThreadDebugServiceShape, IDebugAdapterFactory {\n\n\tprivate readonly _proxy: ExtHostDebugServiceShape;\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate readonly _debugAdapters: Map<number, ExtensionHostDebugAdapter>;\n\tprivate _debugAdaptersHandleCounter = 1;\n\tprivate readonly _debugConfigurationProviders: Map<number, IDebugConfigurationProvider>;\n\tprivate readonly _debugAdapterDescriptorFactories: Map<number, IDebugAdapterDescriptorFactory>;\n\tprivate readonly _extHostKnownSessions: Set<DebugSessionUUID>;\n\tprivate readonly _visualizerHandles = new Map<string, IDisposable>();\n\tprivate readonly _visualizerTreeHandles = new Map<string, IDisposable>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IDebugService private readonly debugService: IDebugService,\n\t\t@IDebugVisualizerService private readonly visualizerService: IDebugVisualizerService,\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostDebugService);\n\n\t\tconst sessionListeners = new DisposableMap<IDebugSession, DisposableStore>();\n\t\tthis._toDispose.add(sessionListeners);\n\t\tthis._toDispose.add(debugService.onDidNewSession(session => {\n\t\t\tthis._proxy.$acceptDebugSessionStarted(this.getSessionDto(session));\n\t\t\tconst store = sessionListeners.get(session);\n\t\t\tstore?.add(session.onDidChangeName(name => {\n\t\t\t\tthis._proxy.$acceptDebugSessionNameChanged(this.getSessionDto(session), name);\n\t\t\t}));\n\t\t}));\n\t\t// Need to start listening early to new session events because a custom event can come while a session is initialising\n\t\tthis._toDispose.add(debugService.onWillNewSession(session => {\n\t\t\tlet store = sessionListeners.get(session);\n\t\t\tif (!store) {\n\t\t\t\tstore = new DisposableStore();\n\t\t\t\tsessionListeners.set(session, store);\n\t\t\t}\n\t\t\tstore.add(session.onDidCustomEvent(event => this._proxy.$acceptDebugSessionCustomEvent(this.getSessionDto(session), event)));\n\t\t}));\n\t\tthis._toDispose.add(debugService.onDidEndSession(({ session, restart }) => {\n\t\t\tthis._proxy.$acceptDebugSessionTerminated(this.getSessionDto(session));\n\t\t\tthis._extHostKnownSessions.delete(session.getId());\n\n\t\t\t// keep the session listeners around since we still will get events after they restart\n\t\t\tif (!restart) {\n\t\t\t\tsessionListeners.deleteAndDispose(session);\n\t\t\t}\n\n\t\t\t// any restarted session will create a new DA, so always throw the old one away.\n\t\t\tfor (const [handle, value] of this._debugAdapters) {\n\t\t\t\tif (value.session === session) {\n\t\t\t\t\tthis._debugAdapters.delete(handle);\n\t\t\t\t\t// break;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._toDispose.add(debugService.getViewModel().onDidFocusSession(session => {\n\t\t\tthis._proxy.$acceptDebugSessionActiveChanged(this.getSessionDto(session));\n\t\t}));\n\t\tthis._toDispose.add(toDisposable(() => {\n\t\t\tfor (const [handle, da] of this._debugAdapters) {\n\t\t\t\tda.fireError(handle, new Error('Extension host shut down'));\n\t\t\t}\n\t\t}));\n\n\t\tthis._debugAdapters = new Map();\n\t\tthis._debugConfigurationProviders = new Map();\n\t\tthis._debugAdapterDescriptorFactories = new Map();\n\t\tthis._extHostKnownSessions = new Set();\n\n\t\tconst viewModel = this.debugService.getViewModel();\n\t\tthis._toDispose.add(Event.any(viewModel.onDidFocusStackFrame, viewModel.onDidFocusThread)(() => {\n\t\t\tconst stackFrame = viewModel.focusedStackFrame;\n\t\t\tconst thread = viewModel.focusedThread;\n\t\t\tif (stackFrame) {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus({\n\t\t\t\t\tkind: 'stackFrame',\n\t\t\t\t\tthreadId: stackFrame.thread.threadId,\n\t\t\t\t\tframeId: stackFrame.frameId,\n\t\t\t\t\tsessionId: stackFrame.thread.session.getId(),\n\t\t\t\t} satisfies IStackFrameFocusDto);\n\t\t\t} else if (thread) {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus({\n\t\t\t\t\tkind: 'thread',\n\t\t\t\t\tthreadId: thread.threadId,\n\t\t\t\t\tsessionId: thread.session.getId(),\n\t\t\t\t} satisfies IThreadFocusDto);\n\t\t\t} else {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus(undefined);\n\t\t\t}\n\t\t}));\n\n\t\tthis.sendBreakpointsAndListen();\n\t}\n\n\t$registerDebugVisualizerTree(treeId: string, canEdit: boolean): void {\n\t\tthis._visualizerTreeHandles.set(treeId, this.visualizerService.registerTree(treeId, {\n\t\t\tdisposeItem: id => this._proxy.$disposeVisualizedTree(id),\n\t\t\tgetChildren: e => this._proxy.$getVisualizerTreeItemChildren(treeId, e),\n\t\t\tgetTreeItem: e => this._proxy.$getVisualizerTreeItem(treeId, e),\n\t\t\teditItem: canEdit ? ((e, v) => this._proxy.$editVisualizerTreeItem(e, v)) : undefined\n\t\t}));\n\t}\n\n\t$unregisterDebugVisualizerTree(treeId: string): void {\n\t\tthis._visualizerTreeHandles.get(treeId)?.dispose();\n\t\tthis._visualizerTreeHandles.delete(treeId);\n\t}\n\n\t$registerDebugVisualizer(extensionId: string, id: string): void {\n\t\tconst handle = this.visualizerService.register({\n\t\t\textensionId: new ExtensionIdentifier(extensionId),\n\t\t\tid,\n\t\t\tdisposeDebugVisualizers: ids => this._proxy.$disposeDebugVisualizers(ids),\n\t\t\texecuteDebugVisualizerCommand: id => this._proxy.$executeDebugVisualizerCommand(id),\n\t\t\tprovideDebugVisualizers: (context, token) => this._proxy.$provideDebugVisualizers(extensionId, id, context, token).then(r => r.map(IDebugVisualization.deserialize)),\n\t\t\tresolveDebugVisualizer: (viz, token) => this._proxy.$resolveDebugVisualizer(viz.id, token),\n\t\t});\n\t\tthis._visualizerHandles.set(`${extensionId}/${id}`, handle);\n\t}\n\n\t$unregisterDebugVisualizer(extensionId: string, id: string): void {\n\t\tconst key = `${extensionId}/${id}`;\n\t\tthis._visualizerHandles.get(key)?.dispose();\n\t\tthis._visualizerHandles.delete(key);\n\t}\n\n\tprivate sendBreakpointsAndListen(): void {\n\t\t// set up a handler to send more\n\t\tthis._toDispose.add(this.debugService.getModel().onDidChangeBreakpoints(e => {\n\t\t\t// Ignore session only breakpoint events since they should only reflect in the UI\n\t\t\tif (e && !e.sessionOnly) {\n\t\t\t\tconst delta: IBreakpointsDeltaDto = {};\n\t\t\t\tif (e.added) {\n\t\t\t\t\tdelta.added = this.convertToDto(e.added);\n\t\t\t\t}\n\t\t\t\tif (e.removed) {\n\t\t\t\t\tdelta.removed = e.removed.map(x => x.getId());\n\t\t\t\t}\n\t\t\t\tif (e.changed) {\n\t\t\t\t\tdelta.changed = this.convertToDto(e.changed);\n\t\t\t\t}\n\n\t\t\t\tif (delta.added || delta.removed || delta.changed) {\n\t\t\t\t\tthis._proxy.$acceptBreakpointsDelta(delta);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\t// send all breakpoints\n\t\tconst bps = this.debugService.getModel().getBreakpoints();\n\t\tconst fbps = this.debugService.getModel().getFunctionBreakpoints();\n\t\tconst dbps = this.debugService.getModel().getDataBreakpoints();\n\t\tif (bps.length > 0 || fbps.length > 0) {\n\t\t\tthis._proxy.$acceptBreakpointsDelta({\n\t\t\t\tadded: this.convertToDto(bps).concat(this.convertToDto(fbps)).concat(this.convertToDto(dbps))\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._toDispose.dispose();\n\t}\n\n\t// interface IDebugAdapterProvider\n\n\tcreateDebugAdapter(session: IDebugSession): IDebugAdapter {\n\t\tconst handle = this._debugAdaptersHandleCounter++;\n\t\tconst da = new ExtensionHostDebugAdapter(this, handle, this._proxy, session);\n\t\tthis._debugAdapters.set(handle, da);\n\t\treturn da;\n\t}\n\n\tsubstituteVariables(folder: IWorkspaceFolder | undefined, config: IConfig): Promise<IConfig> {\n\t\treturn Promise.resolve(this._proxy.$substituteVariables(folder ? folder.uri : undefined, config));\n\t}\n\n\trunInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined> {\n\t\treturn this._proxy.$runInTerminal(args, sessionId);\n\t}\n\n\t// RPC methods (MainThreadDebugServiceShape)\n\n\tpublic $registerDebugTypes(debugTypes: string[]) {\n\t\tthis._toDispose.add(this.debugService.getAdapterManager().registerDebugAdapterFactory(debugTypes, this));\n\t}\n\n\tpublic $registerBreakpoints(DTOs: Array<ISourceMultiBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto>): Promise<void> {\n\n\t\tfor (const dto of DTOs) {\n\t\t\tif (dto.type === 'sourceMulti') {\n\t\t\t\tconst rawbps = dto.lines.map((l): IBreakpointData => ({\n\t\t\t\t\tid: l.id,\n\t\t\t\t\tenabled: l.enabled,\n\t\t\t\t\tlineNumber: l.line + 1,\n\t\t\t\t\tcolumn: l.character > 0 ? l.character + 1 : undefined, // a column value of 0 results in an omitted column attribute; see #46784\n\t\t\t\t\tcondition: l.condition,\n\t\t\t\t\thitCondition: l.hitCondition,\n\t\t\t\t\tlogMessage: l.logMessage,\n\t\t\t\t\tmode: l.mode,\n\t\t\t\t}));\n\t\t\t\tthis.debugService.addBreakpoints(uri.revive(dto.uri), rawbps);\n\t\t\t} else if (dto.type === 'function') {\n\t\t\t\tthis.debugService.addFunctionBreakpoint({\n\t\t\t\t\tname: dto.functionName,\n\t\t\t\t\tmode: dto.mode,\n\t\t\t\t\tcondition: dto.condition,\n\t\t\t\t\thitCondition: dto.hitCondition,\n\t\t\t\t\tenabled: dto.enabled,\n\t\t\t\t\tlogMessage: dto.logMessage\n\t\t\t\t}, dto.id);\n\t\t\t} else if (dto.type === 'data') {\n\t\t\t\tthis.debugService.addDataBreakpoint({\n\t\t\t\t\tdescription: dto.label,\n\t\t\t\t\tsrc: { type: DataBreakpointSetType.Variable, dataId: dto.dataId },\n\t\t\t\t\tcanPersist: dto.canPersist,\n\t\t\t\t\taccessTypes: dto.accessTypes,\n\t\t\t\t\taccessType: dto.accessType,\n\t\t\t\t\tmode: dto.mode\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tpublic $unregisterBreakpoints(breakpointIds: string[], functionBreakpointIds: string[], dataBreakpointIds: string[]): Promise<void> {\n\t\tbreakpointIds.forEach(id => this.debugService.removeBreakpoints(id));\n\t\tfunctionBreakpointIds.forEach(id => this.debugService.removeFunctionBreakpoints(id));\n\t\tdataBreakpointIds.forEach(id => this.debugService.removeDataBreakpoints(id));\n\t\treturn Promise.resolve();\n\t}\n\n\tpublic $registerDebugConfigurationProvider(debugType: string, providerTriggerKind: DebugConfigurationProviderTriggerKind, hasProvide: boolean, hasResolve: boolean, hasResolve2: boolean, handle: number): Promise<void> {\n\n\t\tconst provider: IDebugConfigurationProvider = {\n\t\t\ttype: debugType,\n\t\t\ttriggerKind: providerTriggerKind\n\t\t};\n\t\tif (hasProvide) {\n\t\t\tprovider.provideDebugConfigurations = (folder, token) => {\n\t\t\t\treturn this._proxy.$provideDebugConfigurations(handle, folder, token);\n\t\t\t};\n\t\t}\n\t\tif (hasResolve) {\n\t\t\tprovider.resolveDebugConfiguration = (folder, config, token) => {\n\t\t\t\treturn this._proxy.$resolveDebugConfiguration(handle, folder, config, token);\n\t\t\t};\n\t\t}\n\t\tif (hasResolve2) {\n\t\t\tprovider.resolveDebugConfigurationWithSubstitutedVariables = (folder, config, token) => {\n\t\t\t\treturn this._proxy.$resolveDebugConfigurationWithSubstitutedVariables(handle, folder, config, token);\n\t\t\t};\n\t\t}\n\t\tthis._debugConfigurationProviders.set(handle, provider);\n\t\tthis._toDispose.add(this.debugService.getConfigurationManager().registerDebugConfigurationProvider(provider));\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic $unregisterDebugConfigurationProvider(handle: number): void {\n\t\tconst provider = this._debugConfigurationProviders.get(handle);\n\t\tif (provider) {\n\t\t\tthis._debugConfigurationProviders.delete(handle);\n\t\t\tthis.debugService.getConfigurationManager().unregisterDebugConfigurationProvider(provider);\n\t\t}\n\t}\n\n\tpublic $registerDebugAdapterDescriptorFactory(debugType: string, handle: number): Promise<void> {\n\n\t\tconst provider: IDebugAdapterDescriptorFactory = {\n\t\t\ttype: debugType,\n\t\t\tcreateDebugAdapterDescriptor: session => {\n\t\t\t\treturn Promise.resolve(this._proxy.$provideDebugAdapter(handle, this.getSessionDto(session)));\n\t\t\t}\n\t\t};\n\t\tthis._debugAdapterDescriptorFactories.set(handle, provider);\n\t\tthis._toDispose.add(this.debugService.getAdapterManager().registerDebugAdapterDescriptorFactory(provider));\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic $unregisterDebugAdapterDescriptorFactory(handle: number): void {\n\t\tconst provider = this._debugAdapterDescriptorFactories.get(handle);\n\t\tif (provider) {\n\t\t\tthis._debugAdapterDescriptorFactories.delete(handle);\n\t\t\tthis.debugService.getAdapterManager().unregisterDebugAdapterDescriptorFactory(provider);\n\t\t}\n\t}\n\n\tprivate getSession(sessionId: DebugSessionUUID | undefined): IDebugSession | undefined {\n\t\tif (sessionId) {\n\t\t\treturn this.debugService.getModel().getSession(sessionId, true);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic async $startDebugging(folder: UriComponents | undefined, nameOrConfig: string | IDebugConfiguration, options: IStartDebuggingOptions): Promise<boolean> {\n\t\tconst folderUri = folder ? uri.revive(folder) : undefined;\n\t\tconst launch = this.debugService.getConfigurationManager().getLaunch(folderUri);\n\t\tconst parentSession = this.getSession(options.parentSessionID);\n\t\tconst saveBeforeStart = typeof options.suppressSaveBeforeStart === 'boolean' ? !options.suppressSaveBeforeStart : undefined;\n\t\tconst debugOptions: IDebugSessionOptions = {\n\t\t\tnoDebug: options.noDebug,\n\t\t\tparentSession,\n\t\t\tlifecycleManagedByParent: options.lifecycleManagedByParent,\n\t\t\trepl: options.repl,\n\t\t\tcompact: options.compact,\n\t\t\tcompoundRoot: parentSession?.compoundRoot,\n\t\t\tsaveBeforeRestart: saveBeforeStart,\n\t\t\ttestRun: options.testRun,\n\n\t\t\tsuppressDebugStatusbar: options.suppressDebugStatusbar,\n\t\t\tsuppressDebugToolbar: options.suppressDebugToolbar,\n\t\t\tsuppressDebugView: options.suppressDebugView,\n\t\t};\n\t\ttry {\n\t\t\treturn this.debugService.startDebugging(launch, nameOrConfig, debugOptions, saveBeforeStart);\n\t\t} catch (err) {\n\t\t\tthrow new ErrorNoTelemetry(err && err.message ? err.message : 'cannot start debugging');\n\t\t}\n\t}\n\n\tpublic $setDebugSessionName(sessionId: DebugSessionUUID, name: string): void {\n\t\tconst session = this.debugService.getModel().getSession(sessionId);\n\t\tsession?.setName(name);\n\t}\n\n\tpublic $customDebugAdapterRequest(sessionId: DebugSessionUUID, request: string, args: unknown): Promise<unknown> {\n\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\tif (session) {\n\t\t\treturn session.customRequest(request, args).then(response => {\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\treturn response.body;\n\t\t\t\t} else {\n\t\t\t\t\treturn Promise.reject(new ErrorNoTelemetry(response ? response.message : 'custom request failed'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $getDebugProtocolBreakpoint(sessionId: DebugSessionUUID, breakpoinId: string): Promise<DebugProtocol.Breakpoint | undefined> {\n\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\tif (session) {\n\t\t\treturn Promise.resolve(session.getDebugProtocolBreakpoint(breakpoinId));\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $stopDebugging(sessionId: DebugSessionUUID | undefined): Promise<void> {\n\t\tif (sessionId) {\n\t\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\t\tif (session) {\n\t\t\t\treturn this.debugService.stopSession(session, isSessionAttach(session));\n\t\t\t}\n\t\t} else {\t// stop all\n\t\t\treturn this.debugService.stopSession(undefined);\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $appendDebugConsole(value: string): void {\n\t\t// Use warning as severity to get the orange color for messages coming from the debug extension\n\t\tconst session = this.debugService.getViewModel().focusedSession;\n\t\tsession?.appendToRepl({ output: value, sev: severity.Warning });\n\t}\n\n\tpublic $acceptDAMessage(handle: number, message: DebugProtocol.ProtocolMessage) {\n\t\tthis.getDebugAdapter(handle).acceptMessage(convertToVSCPaths(message, false));\n\t}\n\n\tpublic $acceptDAError(handle: number, name: string, message: string, stack: string) {\n\t\t// don't use getDebugAdapter since an error can be expected on a post-close\n\t\tthis._debugAdapters.get(handle)?.fireError(handle, new Error(`${name}: ${message}\\n${stack}`));\n\t}\n\n\tpublic $acceptDAExit(handle: number, code: number, signal: string) {\n\t\t// don't use getDebugAdapter since an error can be expected on a post-close\n\t\tthis._debugAdapters.get(handle)?.fireExit(handle, code, signal);\n\t}\n\n\tprivate getDebugAdapter(handle: number): ExtensionHostDebugAdapter {\n\t\tconst adapter = this._debugAdapters.get(handle);\n\t\tif (!adapter) {\n\t\t\tthrow new Error('Invalid debug adapter');\n\t\t}\n\t\treturn adapter;\n\t}\n\n\t// dto helpers\n\n\tpublic $sessionCached(sessionID: string) {\n\t\t// remember that the EH has cached the session and we do not have to send it again\n\t\tthis._extHostKnownSessions.add(sessionID);\n\t}\n\n\n\tgetSessionDto(session: undefined): undefined;\n\tgetSessionDto(session: IDebugSession): IDebugSessionDto;\n\tgetSessionDto(session: IDebugSession | undefined): IDebugSessionDto | undefined;\n\tgetSessionDto(session: IDebugSession | undefined): IDebugSessionDto | undefined {\n\t\tif (session) {\n\t\t\tconst sessionID = session.getId();\n\t\t\tif (this._extHostKnownSessions.has(sessionID)) {\n\t\t\t\treturn sessionID;\n\t\t\t} else {\n\t\t\t\t// this._sessions.add(sessionID); \t// #69534: see $sessionCached above\n\t\t\t\treturn {\n\t\t\t\t\tid: sessionID,\n\t\t\t\t\ttype: session.configuration.type,\n\t\t\t\t\tname: session.name,\n\t\t\t\t\tfolderUri: session.root ? session.root.uri : undefined,\n\t\t\t\t\tconfiguration: session.configuration,\n\t\t\t\t\tparent: session.parentSession?.getId(),\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate convertToDto(bps: (ReadonlyArray<IBreakpoint | IFunctionBreakpoint | IDataBreakpoint | IInstructionBreakpoint>)): Array<ISourceBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto> {\n\t\treturn bps.map(bp => {\n\t\t\tif ('name' in bp) {\n\t\t\t\tconst fbp: IFunctionBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'function',\n\t\t\t\t\tid: fbp.getId(),\n\t\t\t\t\tenabled: fbp.enabled,\n\t\t\t\t\tcondition: fbp.condition,\n\t\t\t\t\thitCondition: fbp.hitCondition,\n\t\t\t\t\tlogMessage: fbp.logMessage,\n\t\t\t\t\tfunctionName: fbp.name\n\t\t\t\t} satisfies IFunctionBreakpointDto;\n\t\t\t} else if ('src' in bp) {\n\t\t\t\tconst dbp: IDataBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'data',\n\t\t\t\t\tid: dbp.getId(),\n\t\t\t\t\tdataId: dbp.src.type === DataBreakpointSetType.Variable ? dbp.src.dataId : dbp.src.address,\n\t\t\t\t\tenabled: dbp.enabled,\n\t\t\t\t\tcondition: dbp.condition,\n\t\t\t\t\thitCondition: dbp.hitCondition,\n\t\t\t\t\tlogMessage: dbp.logMessage,\n\t\t\t\t\taccessType: dbp.accessType,\n\t\t\t\t\tlabel: dbp.description,\n\t\t\t\t\tcanPersist: dbp.canPersist\n\t\t\t\t} satisfies IDataBreakpointDto;\n\t\t\t} else if ('uri' in bp) {\n\t\t\t\tconst sbp: IBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'source',\n\t\t\t\t\tid: sbp.getId(),\n\t\t\t\t\tenabled: sbp.enabled,\n\t\t\t\t\tcondition: sbp.condition,\n\t\t\t\t\thitCondition: sbp.hitCondition,\n\t\t\t\t\tlogMessage: sbp.logMessage,\n\t\t\t\t\turi: sbp.uri,\n\t\t\t\t\tline: sbp.lineNumber > 0 ? sbp.lineNumber - 1 : 0,\n\t\t\t\t\tcharacter: (typeof sbp.column === 'number' && sbp.column > 0) ? sbp.column - 1 : 0,\n\t\t\t\t} satisfies ISourceBreakpointDto;\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}).filter(isDefined);\n\t}\n}\n\n/**\n * DebugAdapter that communicates via extension protocol with another debug adapter.\n */\nclass ExtensionHostDebugAdapter extends AbstractDebugAdapter {\n\n\tconstructor(private readonly _ds: MainThreadDebugService, private _handle: number, private _proxy: ExtHostDebugServiceShape, readonly session: IDebugSession) {\n\t\tsuper();\n\t}\n\n\tfireError(handle: number, err: Error) {\n\t\tthis._onError.fire(err);\n\t}\n\n\tfireExit(handle: number, code: number, signal: string) {\n\t\tthis._onExit.fire(code);\n\t}\n\n\tstartSession(): Promise<void> {\n\t\treturn Promise.resolve(this._proxy.$startDASession(this._handle, this._ds.getSessionDto(this.session)));\n\t}\n\n\tsendMessage(message: DebugProtocol.ProtocolMessage): void {\n\t\tthis._proxy.$sendDAMessage(this._handle, convertToDAPaths(message, true));\n\t}\n\n\tasync stopSession(): Promise<void> {\n\t\tawait this.cancelPendingRequests();\n\t\treturn Promise.resolve(this._proxy.$stopDASession(this._handle));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableMap, DisposableStore, IDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { URI as uri, UriComponents } from '../../../base/common/uri.js';\nimport { IDebugService, IConfig, IDebugConfigurationProvider, IBreakpoint, IFunctionBreakpoint, IBreakpointData, IDebugAdapter, IDebugAdapterDescriptorFactory, IDebugSession, IDebugAdapterFactory, IDataBreakpoint, IDebugSessionOptions, IInstructionBreakpoint, DebugConfigurationProviderTriggerKind, IDebugVisualization, DataBreakpointSetType } from '../../contrib/debug/common/debug.js';\nimport {\n\tExtHostContext, ExtHostDebugServiceShape, MainThreadDebugServiceShape, DebugSessionUUID, MainContext,\n\tIBreakpointsDeltaDto, ISourceMultiBreakpointDto, ISourceBreakpointDto, IFunctionBreakpointDto, IDebugSessionDto, IDataBreakpointDto, IStartDebuggingOptions, IDebugConfiguration, IThreadFocusDto, IStackFrameFocusDto\n} from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport severity from '../../../base/common/severity.js';\nimport { AbstractDebugAdapter } from '../../contrib/debug/common/abstractDebugAdapter.js';\nimport { IWorkspaceFolder } from '../../../platform/workspace/common/workspace.js';\nimport { convertToVSCPaths, convertToDAPaths, isSessionAttach } from '../../contrib/debug/common/debugUtils.js';\nimport { ErrorNoTelemetry } from '../../../base/common/errors.js';\nimport { IDebugVisualizerService } from '../../contrib/debug/common/debugVisualizers.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { Event } from '../../../base/common/event.js';\nimport { isDefined } from '../../../base/common/types.js';\n\n@extHostNamedCustomer(MainContext.MainThreadDebugService)\nexport class MainThreadDebugService implements MainThreadDebugServiceShape, IDebugAdapterFactory {\n\n\tprivate readonly _proxy: ExtHostDebugServiceShape;\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate readonly _debugAdapters: Map<number, ExtensionHostDebugAdapter>;\n\tprivate _debugAdaptersHandleCounter = 1;\n\tprivate readonly _debugConfigurationProviders: Map<number, IDebugConfigurationProvider>;\n\tprivate readonly _debugAdapterDescriptorFactories: Map<number, IDebugAdapterDescriptorFactory>;\n\tprivate readonly _extHostKnownSessions: Set<DebugSessionUUID>;\n\tprivate readonly _visualizerHandles = new Map<string, IDisposable>();\n\tprivate readonly _visualizerTreeHandles = new Map<string, IDisposable>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IDebugService private readonly debugService: IDebugService,\n\t\t@IDebugVisualizerService private readonly visualizerService: IDebugVisualizerService,\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostDebugService);\n\n\t\tconst sessionListeners = new DisposableMap<IDebugSession, DisposableStore>();\n\t\tthis._toDispose.add(sessionListeners);\n\t\tthis._toDispose.add(debugService.onDidNewSession(session => {\n\t\t\tthis._proxy.$acceptDebugSessionStarted(this.getSessionDto(session));\n\t\t\tconst store = sessionListeners.get(session);\n\t\t\tstore?.add(session.onDidChangeName(name => {\n\t\t\t\tthis._proxy.$acceptDebugSessionNameChanged(this.getSessionDto(session), name);\n\t\t\t}));\n\t\t}));\n\t\t// Need to start listening early to new session events because a custom event can come while a session is initialising\n\t\tthis._toDispose.add(debugService.onWillNewSession(session => {\n\t\t\tlet store = sessionListeners.get(session);\n\t\t\tif (!store) {\n\t\t\t\tstore = new DisposableStore();\n\t\t\t\tsessionListeners.set(session, store);\n\t\t\t}\n\t\t\tstore.add(session.onDidCustomEvent(event => this._proxy.$acceptDebugSessionCustomEvent(this.getSessionDto(session), event)));\n\t\t}));\n\t\tthis._toDispose.add(debugService.onDidEndSession(({ session, restart }) => {\n\t\t\tthis._proxy.$acceptDebugSessionTerminated(this.getSessionDto(session));\n\t\t\tthis._extHostKnownSessions.delete(session.getId());\n\n\t\t\t// keep the session listeners around since we still will get events after they restart\n\t\t\tif (!restart) {\n\t\t\t\tsessionListeners.deleteAndDispose(session);\n\t\t\t}\n\n\t\t\t// any restarted session will create a new DA, so always throw the old one away.\n\t\t\tfor (const [handle, value] of this._debugAdapters) {\n\t\t\t\tif (value.session === session) {\n\t\t\t\t\tthis._debugAdapters.delete(handle);\n\t\t\t\t\t// break;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._toDispose.add(debugService.getViewModel().onDidFocusSession(session => {\n\t\t\tthis._proxy.$acceptDebugSessionActiveChanged(this.getSessionDto(session));\n\t\t}));\n\t\tthis._toDispose.add(toDisposable(() => {\n\t\t\tfor (const [handle, da] of this._debugAdapters) {\n\t\t\t\tda.fireError(handle, new Error('Extension host shut down'));\n\t\t\t}\n\t\t}));\n\n\t\tthis._debugAdapters = new Map();\n\t\tthis._debugConfigurationProviders = new Map();\n\t\tthis._debugAdapterDescriptorFactories = new Map();\n\t\tthis._extHostKnownSessions = new Set();\n\n\t\tconst viewModel = this.debugService.getViewModel();\n\t\tthis._toDispose.add(Event.any(viewModel.onDidFocusStackFrame, viewModel.onDidFocusThread)(() => {\n\t\t\tconst stackFrame = viewModel.focusedStackFrame;\n\t\t\tconst thread = viewModel.focusedThread;\n\t\t\tif (stackFrame) {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus({\n\t\t\t\t\tkind: 'stackFrame',\n\t\t\t\t\tthreadId: stackFrame.thread.threadId,\n\t\t\t\t\tframeId: stackFrame.frameId,\n\t\t\t\t\tsessionId: stackFrame.thread.session.getId(),\n\t\t\t\t} satisfies IStackFrameFocusDto);\n\t\t\t} else if (thread) {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus({\n\t\t\t\t\tkind: 'thread',\n\t\t\t\t\tthreadId: thread.threadId,\n\t\t\t\t\tsessionId: thread.session.getId(),\n\t\t\t\t} satisfies IThreadFocusDto);\n\t\t\t} else {\n\t\t\t\tthis._proxy.$acceptStackFrameFocus(undefined);\n\t\t\t}\n\t\t}));\n\n\t\tthis.sendBreakpointsAndListen();\n\t}\n\n\t$registerDebugVisualizerTree(treeId: string, canEdit: boolean): void {\n\t\tthis._visualizerTreeHandles.set(treeId, this.visualizerService.registerTree(treeId, {\n\t\t\tdisposeItem: id => this._proxy.$disposeVisualizedTree(id),\n\t\t\tgetChildren: e => this._proxy.$getVisualizerTreeItemChildren(treeId, e),\n\t\t\tgetTreeItem: e => this._proxy.$getVisualizerTreeItem(treeId, e),\n\t\t\teditItem: canEdit ? ((e, v) => this._proxy.$editVisualizerTreeItem(e, v)) : undefined\n\t\t}));\n\t}\n\n\t$unregisterDebugVisualizerTree(treeId: string): void {\n\t\tthis._visualizerTreeHandles.get(treeId)?.dispose();\n\t\tthis._visualizerTreeHandles.delete(treeId);\n\t}\n\n\t$registerDebugVisualizer(extensionId: string, id: string): void {\n\t\tconst handle = this.visualizerService.register({\n\t\t\textensionId: new ExtensionIdentifier(extensionId),\n\t\t\tid,\n\t\t\tdisposeDebugVisualizers: ids => this._proxy.$disposeDebugVisualizers(ids),\n\t\t\texecuteDebugVisualizerCommand: id => this._proxy.$executeDebugVisualizerCommand(id),\n\t\t\tprovideDebugVisualizers: (context, token) => this._proxy.$provideDebugVisualizers(extensionId, id, context, token).then(r => r.map(IDebugVisualization.deserialize)),\n\t\t\tresolveDebugVisualizer: (viz, token) => this._proxy.$resolveDebugVisualizer(viz.id, token),\n\t\t});\n\t\tthis._visualizerHandles.set(`${extensionId}/${id}`, handle);\n\t}\n\n\t$unregisterDebugVisualizer(extensionId: string, id: string): void {\n\t\tconst key = `${extensionId}/${id}`;\n\t\tthis._visualizerHandles.get(key)?.dispose();\n\t\tthis._visualizerHandles.delete(key);\n\t}\n\n\tprivate sendBreakpointsAndListen(): void {\n\t\t// set up a handler to send more\n\t\tthis._toDispose.add(this.debugService.getModel().onDidChangeBreakpoints(e => {\n\t\t\t// Ignore session only breakpoint events since they should only reflect in the UI\n\t\t\tif (e && !e.sessionOnly) {\n\t\t\t\tconst delta: IBreakpointsDeltaDto = {};\n\t\t\t\tif (e.added) {\n\t\t\t\t\tdelta.added = this.convertToDto(e.added);\n\t\t\t\t}\n\t\t\t\tif (e.removed) {\n\t\t\t\t\tdelta.removed = e.removed.map(x => x.getId());\n\t\t\t\t}\n\t\t\t\tif (e.changed) {\n\t\t\t\t\tdelta.changed = this.convertToDto(e.changed);\n\t\t\t\t}\n\n\t\t\t\tif (delta.added || delta.removed || delta.changed) {\n\t\t\t\t\tthis._proxy.$acceptBreakpointsDelta(delta);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\t// send all breakpoints\n\t\tconst bps = this.debugService.getModel().getBreakpoints();\n\t\tconst fbps = this.debugService.getModel().getFunctionBreakpoints();\n\t\tconst dbps = this.debugService.getModel().getDataBreakpoints();\n\t\tif (bps.length > 0 || fbps.length > 0) {\n\t\t\tthis._proxy.$acceptBreakpointsDelta({\n\t\t\t\tadded: this.convertToDto(bps).concat(this.convertToDto(fbps)).concat(this.convertToDto(dbps))\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._toDispose.dispose();\n\t}\n\n\t// interface IDebugAdapterProvider\n\n\tcreateDebugAdapter(session: IDebugSession): IDebugAdapter {\n\t\tconst handle = this._debugAdaptersHandleCounter++;\n\t\tconst da = new ExtensionHostDebugAdapter(this, handle, this._proxy, session);\n\t\tthis._debugAdapters.set(handle, da);\n\t\treturn da;\n\t}\n\n\tsubstituteVariables(folder: IWorkspaceFolder | undefined, config: IConfig): Promise<IConfig> {\n\t\treturn Promise.resolve(this._proxy.$substituteVariables(folder ? folder.uri : undefined, config));\n\t}\n\n\trunInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined> {\n\t\treturn this._proxy.$runInTerminal(args, sessionId);\n\t}\n\n\t// RPC methods (MainThreadDebugServiceShape)\n\n\tpublic $registerDebugTypes(debugTypes: string[]) {\n\t\tthis._toDispose.add(this.debugService.getAdapterManager().registerDebugAdapterFactory(debugTypes, this));\n\t}\n\n\tpublic $registerBreakpoints(DTOs: Array<ISourceMultiBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto>): Promise<void> {\n\n\t\tfor (const dto of DTOs) {\n\t\t\tif (dto.type === 'sourceMulti') {\n\t\t\t\tconst rawbps = dto.lines.map((l): IBreakpointData => ({\n\t\t\t\t\tid: l.id,\n\t\t\t\t\tenabled: l.enabled,\n\t\t\t\t\tlineNumber: l.line + 1,\n\t\t\t\t\tcolumn: l.character > 0 ? l.character + 1 : undefined, // a column value of 0 results in an omitted column attribute; see #46784\n\t\t\t\t\tcondition: l.condition,\n\t\t\t\t\thitCondition: l.hitCondition,\n\t\t\t\t\tlogMessage: l.logMessage,\n\t\t\t\t\tmode: l.mode,\n\t\t\t\t}));\n\t\t\t\tthis.debugService.addBreakpoints(uri.revive(dto.uri), rawbps);\n\t\t\t} else if (dto.type === 'function') {\n\t\t\t\tthis.debugService.addFunctionBreakpoint({\n\t\t\t\t\tname: dto.functionName,\n\t\t\t\t\tmode: dto.mode,\n\t\t\t\t\tcondition: dto.condition,\n\t\t\t\t\thitCondition: dto.hitCondition,\n\t\t\t\t\tenabled: dto.enabled,\n\t\t\t\t\tlogMessage: dto.logMessage\n\t\t\t\t}, dto.id);\n\t\t\t} else if (dto.type === 'data') {\n\t\t\t\tthis.debugService.addDataBreakpoint({\n\t\t\t\t\tdescription: dto.label,\n\t\t\t\t\tsrc: { type: DataBreakpointSetType.Variable, dataId: dto.dataId },\n\t\t\t\t\tcanPersist: dto.canPersist,\n\t\t\t\t\taccessTypes: dto.accessTypes,\n\t\t\t\t\taccessType: dto.accessType,\n\t\t\t\t\tmode: dto.mode\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tpublic $unregisterBreakpoints(breakpointIds: string[], functionBreakpointIds: string[], dataBreakpointIds: string[]): Promise<void> {\n\t\tbreakpointIds.forEach(id => this.debugService.removeBreakpoints(id));\n\t\tfunctionBreakpointIds.forEach(id => this.debugService.removeFunctionBreakpoints(id));\n\t\tdataBreakpointIds.forEach(id => this.debugService.removeDataBreakpoints(id));\n\t\treturn Promise.resolve();\n\t}\n\n\tpublic $registerDebugConfigurationProvider(debugType: string, providerTriggerKind: DebugConfigurationProviderTriggerKind, hasProvide: boolean, hasResolve: boolean, hasResolve2: boolean, handle: number): Promise<void> {\n\n\t\tconst provider: IDebugConfigurationProvider = {\n\t\t\ttype: debugType,\n\t\t\ttriggerKind: providerTriggerKind\n\t\t};\n\t\tif (hasProvide) {\n\t\t\tprovider.provideDebugConfigurations = (folder, token) => {\n\t\t\t\treturn this._proxy.$provideDebugConfigurations(handle, folder, token);\n\t\t\t};\n\t\t}\n\t\tif (hasResolve) {\n\t\t\tprovider.resolveDebugConfiguration = (folder, config, token) => {\n\t\t\t\treturn this._proxy.$resolveDebugConfiguration(handle, folder, config, token);\n\t\t\t};\n\t\t}\n\t\tif (hasResolve2) {\n\t\t\tprovider.resolveDebugConfigurationWithSubstitutedVariables = (folder, config, token) => {\n\t\t\t\treturn this._proxy.$resolveDebugConfigurationWithSubstitutedVariables(handle, folder, config, token);\n\t\t\t};\n\t\t}\n\t\tthis._debugConfigurationProviders.set(handle, provider);\n\t\tthis._toDispose.add(this.debugService.getConfigurationManager().registerDebugConfigurationProvider(provider));\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic $unregisterDebugConfigurationProvider(handle: number): void {\n\t\tconst provider = this._debugConfigurationProviders.get(handle);\n\t\tif (provider) {\n\t\t\tthis._debugConfigurationProviders.delete(handle);\n\t\t\tthis.debugService.getConfigurationManager().unregisterDebugConfigurationProvider(provider);\n\t\t}\n\t}\n\n\tpublic $registerDebugAdapterDescriptorFactory(debugType: string, handle: number): Promise<void> {\n\n\t\tconst provider: IDebugAdapterDescriptorFactory = {\n\t\t\ttype: debugType,\n\t\t\tcreateDebugAdapterDescriptor: session => {\n\t\t\t\treturn Promise.resolve(this._proxy.$provideDebugAdapter(handle, this.getSessionDto(session)));\n\t\t\t}\n\t\t};\n\t\tthis._debugAdapterDescriptorFactories.set(handle, provider);\n\t\tthis._toDispose.add(this.debugService.getAdapterManager().registerDebugAdapterDescriptorFactory(provider));\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic $unregisterDebugAdapterDescriptorFactory(handle: number): void {\n\t\tconst provider = this._debugAdapterDescriptorFactories.get(handle);\n\t\tif (provider) {\n\t\t\tthis._debugAdapterDescriptorFactories.delete(handle);\n\t\t\tthis.debugService.getAdapterManager().unregisterDebugAdapterDescriptorFactory(provider);\n\t\t}\n\t}\n\n\tprivate getSession(sessionId: DebugSessionUUID | undefined): IDebugSession | undefined {\n\t\tif (sessionId) {\n\t\t\treturn this.debugService.getModel().getSession(sessionId, true);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic async $startDebugging(folder: UriComponents | undefined, nameOrConfig: string | IDebugConfiguration, options: IStartDebuggingOptions): Promise<boolean> {\n\t\tconst folderUri = folder ? uri.revive(folder) : undefined;\n\t\tconst launch = this.debugService.getConfigurationManager().getLaunch(folderUri);\n\t\tconst parentSession = this.getSession(options.parentSessionID);\n\t\tconst saveBeforeStart = typeof options.suppressSaveBeforeStart === 'boolean' ? !options.suppressSaveBeforeStart : undefined;\n\t\tconst debugOptions: IDebugSessionOptions = {\n\t\t\tnoDebug: options.noDebug,\n\t\t\tparentSession,\n\t\t\tlifecycleManagedByParent: options.lifecycleManagedByParent,\n\t\t\trepl: options.repl,\n\t\t\tcompact: options.compact,\n\t\t\tcompoundRoot: parentSession?.compoundRoot,\n\t\t\tsaveBeforeRestart: saveBeforeStart,\n\t\t\ttestRun: options.testRun,\n\n\t\t\tsuppressDebugStatusbar: options.suppressDebugStatusbar,\n\t\t\tsuppressDebugToolbar: options.suppressDebugToolbar,\n\t\t\tsuppressDebugView: options.suppressDebugView,\n\t\t};\n\t\ttry {\n\t\t\treturn this.debugService.startDebugging(launch, nameOrConfig, debugOptions, saveBeforeStart);\n\t\t} catch (err) {\n\t\t\tthrow new ErrorNoTelemetry(err && err.message ? err.message : 'cannot start debugging');\n\t\t}\n\t}\n\n\tpublic $setDebugSessionName(sessionId: DebugSessionUUID, name: string): void {\n\t\tconst session = this.debugService.getModel().getSession(sessionId);\n\t\tsession?.setName(name);\n\t}\n\n\tpublic $customDebugAdapterRequest(sessionId: DebugSessionUUID, request: string, args: unknown): Promise<unknown> {\n\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\tif (session) {\n\t\t\treturn session.customRequest(request, args).then(response => {\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\treturn response.body;\n\t\t\t\t} else {\n\t\t\t\t\treturn Promise.reject(new ErrorNoTelemetry(response ? response.message : 'custom request failed'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $getDebugProtocolBreakpoint(sessionId: DebugSessionUUID, breakpoinId: string): Promise<DebugProtocol.Breakpoint | undefined> {\n\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\tif (session) {\n\t\t\treturn Promise.resolve(session.getDebugProtocolBreakpoint(breakpoinId));\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $stopDebugging(sessionId: DebugSessionUUID | undefined): Promise<void> {\n\t\tif (sessionId) {\n\t\t\tconst session = this.debugService.getModel().getSession(sessionId, true);\n\t\t\tif (session) {\n\t\t\t\treturn this.debugService.stopSession(session, isSessionAttach(session));\n\t\t\t}\n\t\t} else {\t// stop all\n\t\t\treturn this.debugService.stopSession(undefined);\n\t\t}\n\t\treturn Promise.reject(new ErrorNoTelemetry('debug session not found'));\n\t}\n\n\tpublic $appendDebugConsole(value: string): void {\n\t\t// Use warning as severity to get the orange color for messages coming from the debug extension\n\t\tconst session = this.debugService.getViewModel().focusedSession;\n\t\tsession?.appendToRepl({ output: value, sev: severity.Warning });\n\t}\n\n\tpublic $acceptDAMessage(handle: number, message: DebugProtocol.ProtocolMessage) {\n\t\tthis.getDebugAdapter(handle).acceptMessage(convertToVSCPaths(message, false));\n\t}\n\n\tpublic $acceptDAError(handle: number, name: string, message: string, stack: string) {\n\t\t// don't use getDebugAdapter since an error can be expected on a post-close\n\t\tthis._debugAdapters.get(handle)?.fireError(handle, new Error(`${name}: ${message}\\n${stack}`));\n\t}\n\n\tpublic $acceptDAExit(handle: number, code: number, signal: string) {\n\t\t// don't use getDebugAdapter since an error can be expected on a post-close\n\t\tthis._debugAdapters.get(handle)?.fireExit(handle, code, signal);\n\t}\n\n\tprivate getDebugAdapter(handle: number): ExtensionHostDebugAdapter {\n\t\tconst adapter = this._debugAdapters.get(handle);\n\t\tif (!adapter) {\n\t\t\tthrow new Error('Invalid debug adapter');\n\t\t}\n\t\treturn adapter;\n\t}\n\n\t// dto helpers\n\n\tpublic $sessionCached(sessionID: string) {\n\t\t// remember that the EH has cached the session and we do not have to send it again\n\t\tthis._extHostKnownSessions.add(sessionID);\n\t}\n\n\n\tgetSessionDto(session: undefined): undefined;\n\tgetSessionDto(session: IDebugSession): IDebugSessionDto;\n\tgetSessionDto(session: IDebugSession | undefined): IDebugSessionDto | undefined;\n\tgetSessionDto(session: IDebugSession | undefined): IDebugSessionDto | undefined {\n\t\tif (session) {\n\t\t\tconst sessionID = session.getId();\n\t\t\tif (this._extHostKnownSessions.has(sessionID)) {\n\t\t\t\treturn sessionID;\n\t\t\t} else {\n\t\t\t\t// this._sessions.add(sessionID); \t// #69534: see $sessionCached above\n\t\t\t\treturn {\n\t\t\t\t\tid: sessionID,\n\t\t\t\t\ttype: session.configuration.type,\n\t\t\t\t\tname: session.name,\n\t\t\t\t\tfolderUri: session.root ? session.root.uri : undefined,\n\t\t\t\t\tconfiguration: session.configuration,\n\t\t\t\t\tparent: session.parentSession?.getId(),\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate convertToDto(bps: (ReadonlyArray<IBreakpoint | IFunctionBreakpoint | IDataBreakpoint | IInstructionBreakpoint>)): Array<ISourceBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto> {\n\t\treturn bps.map(bp => {\n\t\t\tif ('name' in bp) {\n\t\t\t\tconst fbp: IFunctionBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'function',\n\t\t\t\t\tid: fbp.getId(),\n\t\t\t\t\tenabled: fbp.enabled,\n\t\t\t\t\tcondition: fbp.condition,\n\t\t\t\t\thitCondition: fbp.hitCondition,\n\t\t\t\t\tlogMessage: fbp.logMessage,\n\t\t\t\t\tfunctionName: fbp.name\n\t\t\t\t} satisfies IFunctionBreakpointDto;\n\t\t\t} else if ('src' in bp) {\n\t\t\t\tconst dbp: IDataBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'data',\n\t\t\t\t\tid: dbp.getId(),\n\t\t\t\t\tdataId: dbp.src.type === DataBreakpointSetType.Variable ? dbp.src.dataId : dbp.src.address,\n\t\t\t\t\tenabled: dbp.enabled,\n\t\t\t\t\tcondition: dbp.condition,\n\t\t\t\t\thitCondition: dbp.hitCondition,\n\t\t\t\t\tlogMessage: dbp.logMessage,\n\t\t\t\t\taccessType: dbp.accessType,\n\t\t\t\t\tlabel: dbp.description,\n\t\t\t\t\tcanPersist: dbp.canPersist\n\t\t\t\t} satisfies IDataBreakpointDto;\n\t\t\t} else if ('uri' in bp) {\n\t\t\t\tconst sbp: IBreakpoint = bp;\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'source',\n\t\t\t\t\tid: sbp.getId(),\n\t\t\t\t\tenabled: sbp.enabled,\n\t\t\t\t\tcondition: sbp.condition,\n\t\t\t\t\thitCondition: sbp.hitCondition,\n\t\t\t\t\tlogMessage: sbp.logMessage,\n\t\t\t\t\turi: sbp.uri,\n\t\t\t\t\tline: sbp.lineNumber > 0 ? sbp.lineNumber - 1 : 0,\n\t\t\t\t\tcharacter: (typeof sbp.column === 'number' && sbp.column > 0) ? sbp.column - 1 : 0,\n\t\t\t\t} satisfies ISourceBreakpointDto;\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}).filter(isDefined);\n\t}\n}\n\n/**\n * DebugAdapter that communicates via extension protocol with another debug adapter.\n */\nclass ExtensionHostDebugAdapter extends AbstractDebugAdapter {\n\n\tconstructor(private readonly _ds: MainThreadDebugService, private _handle: number, private _proxy: ExtHostDebugServiceShape, readonly session: IDebugSession) {\n\t\tsuper();\n\t}\n\n\tfireError(handle: number, err: Error) {\n\t\tthis._onError.fire(err);\n\t}\n\n\tfireExit(handle: number, code: number, signal: string) {\n\t\tthis._onExit.fire(code);\n\t}\n\n\tstartSession(): Promise<void> {\n\t\treturn Promise.resolve(this._proxy.$startDASession(this._handle, this._ds.getSessionDto(this.session)));\n\t}\n\n\tsendMessage(message: DebugProtocol.ProtocolMessage): void {\n\t\tthis._proxy.$sendDAMessage(this._handle, convertToDAPaths(message, true));\n\t}\n\n\tasync stopSession(): Promise<void> {\n\t\tawait this.cancelPendingRequests();\n\t\treturn Promise.resolve(this._proxy.$stopDASession(this._handle));\n\t}\n}\n"]}