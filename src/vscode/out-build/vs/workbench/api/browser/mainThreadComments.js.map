{"version":3,"sources":["vs/workbench/api/browser/mainThreadComments.ts"],"names":[],"mappings":"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","file":"mainThreadComments.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { Disposable, DisposableMap, DisposableStore, IDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { IRange, Range } from '../../../editor/common/core/range.js';\nimport * as languages from '../../../editor/common/languages.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { Registry } from '../../../platform/registry/common/platform.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { ICommentController, ICommentService } from '../../contrib/comments/browser/commentService.js';\nimport { CommentsPanel } from '../../contrib/comments/browser/commentsView.js';\nimport { CommentProviderFeatures, ExtHostCommentsShape, ExtHostContext, MainContext, MainThreadCommentsShape, CommentThreadChanges } from '../common/extHost.protocol.js';\nimport { COMMENTS_VIEW_ID, COMMENTS_VIEW_STORAGE_ID, COMMENTS_VIEW_TITLE } from '../../contrib/comments/browser/commentsTreeViewer.js';\nimport { ViewContainer, IViewContainersRegistry, Extensions as ViewExtensions, ViewContainerLocation, IViewsRegistry, IViewDescriptorService } from '../../common/views.js';\nimport { SyncDescriptor } from '../../../platform/instantiation/common/descriptors.js';\nimport { ViewPaneContainer } from '../../browser/parts/views/viewPaneContainer.js';\nimport { Codicon } from '../../../base/common/codicons.js';\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\nimport { localize } from '../../../nls.js';\nimport { MarshalledId } from '../../../base/common/marshallingIds.js';\nimport { ICellRange } from '../../contrib/notebook/common/notebookRange.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { IViewsService } from '../../services/views/common/viewsService.js';\nimport { MarshalledCommentThread } from '../../common/comments.js';\nimport { revealCommentThread } from '../../contrib/comments/browser/commentsController.js';\nimport { IEditorService } from '../../services/editor/common/editorService.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\n\nexport class MainThreadCommentThread<T> implements languages.CommentThread<T> {\n\tprivate _input?: languages.CommentInput;\n\tget input(): languages.CommentInput | undefined {\n\t\treturn this._input;\n\t}\n\n\tset input(value: languages.CommentInput | undefined) {\n\t\tthis._input = value;\n\t\tthis._onDidChangeInput.fire(value);\n\t}\n\n\tprivate readonly _onDidChangeInput = new Emitter<languages.CommentInput | undefined>();\n\tget onDidChangeInput(): Event<languages.CommentInput | undefined> { return this._onDidChangeInput.event; }\n\n\tprivate _label: string | undefined;\n\n\tget label(): string | undefined {\n\t\treturn this._label;\n\t}\n\n\tset label(label: string | undefined) {\n\t\tthis._label = label;\n\t\tthis._onDidChangeLabel.fire(this._label);\n\t}\n\n\tprivate _contextValue: string | undefined;\n\n\tget contextValue(): string | undefined {\n\t\treturn this._contextValue;\n\t}\n\n\tset contextValue(context: string | undefined) {\n\t\tthis._contextValue = context;\n\t}\n\n\tprivate readonly _onDidChangeLabel = new Emitter<string | undefined>();\n\treadonly onDidChangeLabel: Event<string | undefined> = this._onDidChangeLabel.event;\n\n\tprivate _comments: ReadonlyArray<languages.Comment> | undefined;\n\n\tpublic get comments(): ReadonlyArray<languages.Comment> | undefined {\n\t\treturn this._comments;\n\t}\n\n\tpublic set comments(newComments: ReadonlyArray<languages.Comment> | undefined) {\n\t\tthis._comments = newComments;\n\t\tthis._onDidChangeComments.fire(this._comments);\n\t}\n\n\tprivate readonly _onDidChangeComments = new Emitter<readonly languages.Comment[] | undefined>();\n\tget onDidChangeComments(): Event<readonly languages.Comment[] | undefined> { return this._onDidChangeComments.event; }\n\n\tset range(range: T | undefined) {\n\t\tthis._range = range;\n\t}\n\n\tget range(): T | undefined {\n\t\treturn this._range;\n\t}\n\n\tprivate readonly _onDidChangeCanReply = new Emitter<boolean>();\n\tget onDidChangeCanReply(): Event<boolean> { return this._onDidChangeCanReply.event; }\n\tset canReply(state: boolean | languages.CommentAuthorInformation) {\n\t\tthis._canReply = state;\n\t\tthis._onDidChangeCanReply.fire(!!this._canReply);\n\t}\n\n\tget canReply() {\n\t\treturn this._canReply;\n\t}\n\n\tprivate _collapsibleState: languages.CommentThreadCollapsibleState | undefined = languages.CommentThreadCollapsibleState.Collapsed;\n\tget collapsibleState() {\n\t\treturn this._collapsibleState;\n\t}\n\n\tset collapsibleState(newState: languages.CommentThreadCollapsibleState | undefined) {\n\t\tif (this.initialCollapsibleState === undefined) {\n\t\t\tthis.initialCollapsibleState = newState;\n\t\t}\n\n\t\tif (newState !== this._collapsibleState) {\n\t\t\tthis._collapsibleState = newState;\n\t\t\tthis._onDidChangeCollapsibleState.fire(this._collapsibleState);\n\t\t}\n\t}\n\n\tprivate _initialCollapsibleState: languages.CommentThreadCollapsibleState | undefined;\n\tget initialCollapsibleState() {\n\t\treturn this._initialCollapsibleState;\n\t}\n\n\tprivate set initialCollapsibleState(initialCollapsibleState: languages.CommentThreadCollapsibleState | undefined) {\n\t\tthis._initialCollapsibleState = initialCollapsibleState;\n\t\tthis._onDidChangeInitialCollapsibleState.fire(initialCollapsibleState);\n\t}\n\n\tprivate readonly _onDidChangeCollapsibleState = new Emitter<languages.CommentThreadCollapsibleState | undefined>();\n\tpublic onDidChangeCollapsibleState = this._onDidChangeCollapsibleState.event;\n\tprivate readonly _onDidChangeInitialCollapsibleState = new Emitter<languages.CommentThreadCollapsibleState | undefined>();\n\tpublic onDidChangeInitialCollapsibleState = this._onDidChangeInitialCollapsibleState.event;\n\n\tprivate _isDisposed: boolean;\n\n\tget isDisposed(): boolean {\n\t\treturn this._isDisposed;\n\t}\n\n\tisDocumentCommentThread(): this is languages.CommentThread<IRange> {\n\t\treturn this._range === undefined || Range.isIRange(this._range);\n\t}\n\n\tprivate _state: languages.CommentThreadState | undefined;\n\tget state() {\n\t\treturn this._state;\n\t}\n\n\tset state(newState: languages.CommentThreadState | undefined) {\n\t\tthis._state = newState;\n\t\tthis._onDidChangeState.fire(this._state);\n\t}\n\n\tprivate _applicability: languages.CommentThreadApplicability | undefined;\n\n\tget applicability(): languages.CommentThreadApplicability | undefined {\n\t\treturn this._applicability;\n\t}\n\n\tset applicability(value: languages.CommentThreadApplicability | undefined) {\n\t\tthis._applicability = value;\n\t\tthis._onDidChangeApplicability.fire(value);\n\t}\n\n\tprivate readonly _onDidChangeApplicability = new Emitter<languages.CommentThreadApplicability | undefined>();\n\treadonly onDidChangeApplicability: Event<languages.CommentThreadApplicability | undefined> = this._onDidChangeApplicability.event;\n\n\tpublic get isTemplate(): boolean {\n\t\treturn this._isTemplate;\n\t}\n\n\tprivate readonly _onDidChangeState = new Emitter<languages.CommentThreadState | undefined>();\n\tpublic onDidChangeState = this._onDidChangeState.event;\n\n\tconstructor(\n\t\tpublic commentThreadHandle: number,\n\t\tpublic controllerHandle: number,\n\t\tpublic extensionId: string,\n\t\tpublic threadId: string,\n\t\tpublic resource: string,\n\t\tprivate _range: T | undefined,\n\t\tcomments: languages.Comment[] | undefined,\n\t\tprivate _canReply: boolean | languages.CommentAuthorInformation,\n\t\tprivate _isTemplate: boolean,\n\t\tpublic editorId?: string\n\t) {\n\t\tthis._isDisposed = false;\n\t\tif (_isTemplate) {\n\t\t\tthis.comments = [];\n\t\t} else if (comments) {\n\t\t\tthis._comments = comments;\n\t\t}\n\t}\n\n\tbatchUpdate(changes: CommentThreadChanges<T>) {\n\t\tconst modified = (value: keyof CommentThreadChanges): boolean =>\n\t\t\tObject.prototype.hasOwnProperty.call(changes, value);\n\n\t\tif (modified('range')) { this._range = changes.range!; }\n\t\tif (modified('label')) { this._label = changes.label; }\n\t\tif (modified('contextValue')) { this._contextValue = changes.contextValue === null ? undefined : changes.contextValue; }\n\t\tif (modified('comments')) { this.comments = changes.comments; }\n\t\tif (modified('collapseState')) { this.collapsibleState = changes.collapseState; }\n\t\tif (modified('canReply')) { this.canReply = changes.canReply!; }\n\t\tif (modified('state')) { this.state = changes.state!; }\n\t\tif (modified('applicability')) { this.applicability = changes.applicability!; }\n\t\tif (modified('isTemplate')) { this._isTemplate = changes.isTemplate!; }\n\t}\n\n\thasComments(): boolean {\n\t\treturn !!this.comments && this.comments.length > 0;\n\t}\n\n\tdispose() {\n\t\tthis._isDisposed = true;\n\t\tthis._onDidChangeCollapsibleState.dispose();\n\t\tthis._onDidChangeComments.dispose();\n\t\tthis._onDidChangeInput.dispose();\n\t\tthis._onDidChangeLabel.dispose();\n\t\tthis._onDidChangeState.dispose();\n\t}\n\n\ttoJSON(): MarshalledCommentThread {\n\t\treturn {\n\t\t\t$mid: MarshalledId.CommentThread,\n\t\t\tcommentControlHandle: this.controllerHandle,\n\t\t\tcommentThreadHandle: this.commentThreadHandle,\n\t\t};\n\t}\n}\n\nclass CommentThreadWithDisposable {\n\tpublic readonly disposableStore: DisposableStore = new DisposableStore();\n\tconstructor(public readonly thread: MainThreadCommentThread<IRange | ICellRange>) { }\n\tdispose() {\n\t\tthis.disposableStore.dispose();\n\t}\n}\n\nexport class MainThreadCommentController extends Disposable implements ICommentController {\n\tget handle(): number {\n\t\treturn this._handle;\n\t}\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget contextValue(): string {\n\t\treturn this._id;\n\t}\n\n\tget proxy(): ExtHostCommentsShape {\n\t\treturn this._proxy;\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tprivate _reactions: languages.CommentReaction[] | undefined;\n\n\tget reactions() {\n\t\treturn this._reactions;\n\t}\n\n\tset reactions(reactions: languages.CommentReaction[] | undefined) {\n\t\tthis._reactions = reactions;\n\t}\n\n\tget options() {\n\t\treturn this._features.options;\n\t}\n\n\tprivate readonly _threads: DisposableMap<number, CommentThreadWithDisposable> = this._register(new DisposableMap<number, CommentThreadWithDisposable>());\n\tpublic activeEditingCommentThread?: MainThreadCommentThread<IRange | ICellRange>;\n\n\tget features(): CommentProviderFeatures {\n\t\treturn this._features;\n\t}\n\n\tget owner() {\n\t\treturn this._id;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _proxy: ExtHostCommentsShape,\n\t\tprivate readonly _commentService: ICommentService,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _uniqueId: string,\n\t\tprivate readonly _id: string,\n\t\tprivate readonly _label: string,\n\t\tprivate _features: CommentProviderFeatures\n\t) {\n\t\tsuper();\n\t}\n\n\tget activeComment() {\n\t\treturn this._activeComment;\n\t}\n\n\tprivate _activeComment: { thread: languages.CommentThread; comment?: languages.Comment } | undefined;\n\tasync setActiveCommentAndThread(commentInfo: { thread: languages.CommentThread; comment?: languages.Comment } | undefined) {\n\t\tthis._activeComment = commentInfo;\n\t\treturn this._proxy.$setActiveComment(this._handle, commentInfo ? { commentThreadHandle: commentInfo.thread.commentThreadHandle, uniqueIdInThread: commentInfo.comment?.uniqueIdInThread } : undefined);\n\t}\n\n\tupdateFeatures(features: CommentProviderFeatures) {\n\t\tthis._features = features;\n\t}\n\n\tcreateCommentThread(extensionId: string,\n\t\tcommentThreadHandle: number,\n\t\tthreadId: string,\n\t\tresource: UriComponents,\n\t\trange: IRange | ICellRange | undefined,\n\t\tcomments: languages.Comment[],\n\t\tisTemplate: boolean,\n\t\teditorId?: string\n\t): languages.CommentThread<IRange | ICellRange> {\n\t\tconst thread = new MainThreadCommentThread(\n\t\t\tcommentThreadHandle,\n\t\t\tthis.handle,\n\t\t\textensionId,\n\t\t\tthreadId,\n\t\t\tURI.revive(resource).toString(),\n\t\t\trange,\n\t\t\tcomments,\n\t\t\ttrue,\n\t\t\tisTemplate,\n\t\t\teditorId\n\t\t);\n\n\t\tconst threadWithDisposable = new CommentThreadWithDisposable(thread);\n\t\tthis._threads.set(commentThreadHandle, threadWithDisposable);\n\t\tthreadWithDisposable.disposableStore.add(thread.onDidChangeCollapsibleState(() => {\n\t\t\tthis.proxy.$updateCommentThread(this.handle, thread.commentThreadHandle, { collapseState: thread.collapsibleState });\n\t\t}));\n\n\n\t\tif (thread.isDocumentCommentThread()) {\n\t\t\tthis._commentService.updateComments(this._uniqueId, {\n\t\t\t\tadded: [thread],\n\t\t\t\tremoved: [],\n\t\t\t\tchanged: [],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t} else {\n\t\t\tthis._commentService.updateNotebookComments(this._uniqueId, {\n\t\t\t\tadded: [thread as MainThreadCommentThread<ICellRange>],\n\t\t\t\tremoved: [],\n\t\t\t\tchanged: [],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t}\n\n\t\treturn thread;\n\t}\n\n\tupdateCommentThread(commentThreadHandle: number,\n\t\tthreadId: string,\n\t\tresource: UriComponents,\n\t\tchanges: CommentThreadChanges): void {\n\t\tconst thread = this.getKnownThread(commentThreadHandle);\n\t\tthread.batchUpdate(changes);\n\n\t\tif (thread.isDocumentCommentThread()) {\n\t\t\tthis._commentService.updateComments(this._uniqueId, {\n\t\t\t\tadded: [],\n\t\t\t\tremoved: [],\n\t\t\t\tchanged: [thread],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t} else {\n\t\t\tthis._commentService.updateNotebookComments(this._uniqueId, {\n\t\t\t\tadded: [],\n\t\t\t\tremoved: [],\n\t\t\t\tchanged: [thread as MainThreadCommentThread<ICellRange>],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t}\n\n\t}\n\n\tdeleteCommentThread(commentThreadHandle: number) {\n\t\tconst thread = this.getKnownThread(commentThreadHandle);\n\t\tthis._threads.deleteAndDispose(commentThreadHandle);\n\t\tthread.dispose();\n\n\t\tif (thread.isDocumentCommentThread()) {\n\t\t\tthis._commentService.updateComments(this._uniqueId, {\n\t\t\t\tadded: [],\n\t\t\t\tremoved: [thread],\n\t\t\t\tchanged: [],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t} else {\n\t\t\tthis._commentService.updateNotebookComments(this._uniqueId, {\n\t\t\t\tadded: [],\n\t\t\t\tremoved: [thread as MainThreadCommentThread<ICellRange>],\n\t\t\t\tchanged: [],\n\t\t\t\tpending: []\n\t\t\t});\n\t\t}\n\t}\n\n\tdeleteCommentThreadMain(commentThreadId: string) {\n\t\tfor (const { thread } of this._threads.values()) {\n\t\t\tif (thread.threadId === commentThreadId) {\n\t\t\t\tthis._proxy.$deleteCommentThread(this._handle, thread.commentThreadHandle);\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateInput(input: string) {\n\t\tconst thread = this.activeEditingCommentThread;\n\n\t\tif (thread && thread.input) {\n\t\t\tconst commentInput = thread.input;\n\t\t\tcommentInput.value = input;\n\t\t\tthread.input = commentInput;\n\t\t}\n\t}\n\n\tupdateCommentingRanges(resourceHints?: languages.CommentingRangeResourceHint) {\n\t\tthis._commentService.updateCommentingRanges(this._uniqueId, resourceHints);\n\t}\n\n\tprivate getKnownThread(commentThreadHandle: number): MainThreadCommentThread<IRange | ICellRange> {\n\t\tconst thread = this._threads.get(commentThreadHandle);\n\t\tif (!thread) {\n\t\t\tthrow new Error('unknown thread');\n\t\t}\n\t\treturn thread.thread;\n\t}\n\n\tasync getDocumentComments(resource: URI, token: CancellationToken) {\n\t\tif (resource.scheme === Schemas.vscodeNotebookCell) {\n\t\t\treturn {\n\t\t\t\tuniqueOwner: this._uniqueId,\n\t\t\t\tlabel: this.label,\n\t\t\t\tthreads: [],\n\t\t\t\tcommentingRanges: {\n\t\t\t\t\tresource: resource,\n\t\t\t\t\tranges: [],\n\t\t\t\t\tfileComments: false\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst ret: languages.CommentThread<IRange>[] = [];\n\t\tfor (const thread of [...this._threads.keys()]) {\n\t\t\tconst commentThread = this._threads.get(thread)!;\n\t\t\tif (commentThread.thread.resource === resource.toString()) {\n\t\t\t\tif (commentThread.thread.isDocumentCommentThread()) {\n\t\t\t\t\tret.push(commentThread.thread);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst commentingRanges = await this._proxy.$provideCommentingRanges(this.handle, resource, token);\n\n\t\treturn {\n\t\t\tuniqueOwner: this._uniqueId,\n\t\t\tlabel: this.label,\n\t\t\tthreads: ret,\n\t\t\tcommentingRanges: {\n\t\t\t\tresource: resource,\n\t\t\t\tranges: commentingRanges?.ranges || [],\n\t\t\t\tfileComments: !!commentingRanges?.fileComments\n\t\t\t}\n\t\t};\n\t}\n\n\tasync getNotebookComments(resource: URI, token: CancellationToken) {\n\t\tif (resource.scheme !== Schemas.vscodeNotebookCell) {\n\t\t\treturn {\n\t\t\t\tuniqueOwner: this._uniqueId,\n\t\t\t\tlabel: this.label,\n\t\t\t\tthreads: []\n\t\t\t};\n\t\t}\n\n\t\tconst ret: languages.CommentThread<ICellRange>[] = [];\n\t\tfor (const thread of [...this._threads.keys()]) {\n\t\t\tconst commentThread = this._threads.get(thread)!;\n\t\t\tif (commentThread.thread.resource === resource.toString()) {\n\t\t\t\tif (!commentThread.thread.isDocumentCommentThread()) {\n\t\t\t\t\tret.push(commentThread.thread as languages.CommentThread<ICellRange>);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tuniqueOwner: this._uniqueId,\n\t\t\tlabel: this.label,\n\t\t\tthreads: ret\n\t\t};\n\t}\n\n\tasync toggleReaction(uri: URI, thread: languages.CommentThread, comment: languages.Comment, reaction: languages.CommentReaction, token: CancellationToken): Promise<void> {\n\t\treturn this._proxy.$toggleReaction(this._handle, thread.commentThreadHandle, uri, comment, reaction);\n\t}\n\n\tgetAllComments(): MainThreadCommentThread<IRange | ICellRange>[] {\n\t\tconst ret: MainThreadCommentThread<IRange | ICellRange>[] = [];\n\t\tfor (const thread of [...this._threads.keys()]) {\n\t\t\tret.push(this._threads.get(thread)!.thread);\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\tcreateCommentThreadTemplate(resource: UriComponents, range: IRange | undefined, editorId?: string): Promise<void> {\n\t\treturn this._proxy.$createCommentThreadTemplate(this.handle, resource, range, editorId);\n\t}\n\n\tasync updateCommentThreadTemplate(threadHandle: number, range: IRange) {\n\t\tawait this._proxy.$updateCommentThreadTemplate(this.handle, threadHandle, range);\n\t}\n\n\ttoJSON() {\n\t\treturn {\n\t\t\t$mid: MarshalledId.CommentController,\n\t\t\thandle: this.handle\n\t\t};\n\t}\n}\n\n\nconst commentsViewIcon = registerIcon('comments-view-icon', Codicon.commentDiscussion, localize('commentsViewIcon', 'View icon of the comments view.'));\n\n@extHostNamedCustomer(MainContext.MainThreadComments)\nexport class MainThreadComments extends Disposable implements MainThreadCommentsShape {\n\tprivate readonly _proxy: ExtHostCommentsShape;\n\n\tprivate _handlers = new Map<number, string>();\n\tprivate _commentControllers = new Map<number, MainThreadCommentController>();\n\n\tprivate _activeEditingCommentThread?: MainThreadCommentThread<IRange | ICellRange>;\n\tprivate readonly _activeEditingCommentThreadDisposables = this._register(new DisposableStore());\n\n\tprivate readonly _openViewListener: MutableDisposable<IDisposable> = this._register(new MutableDisposable());\n\tprivate readonly _onChangeContainerListener: MutableDisposable<IDisposable> = this._register(new MutableDisposable());\n\tprivate readonly _onChangeContainerLocationListener: MutableDisposable<IDisposable> = this._register(new MutableDisposable());\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@ICommentService private readonly _commentService: ICommentService,\n\t\t@IViewsService private readonly _viewsService: IViewsService,\n\t\t@IViewDescriptorService private readonly _viewDescriptorService: IViewDescriptorService,\n\t\t@IUriIdentityService private readonly _uriIdentityService: IUriIdentityService,\n\t\t@IEditorService private readonly _editorService: IEditorService\n\t) {\n\t\tsuper();\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostComments);\n\t\tthis._commentService.unregisterCommentController();\n\n\t\tthis._register(this._commentService.onDidChangeActiveEditingCommentThread(async thread => {\n\t\t\tconst handle = (thread as MainThreadCommentThread<IRange | ICellRange>).controllerHandle;\n\t\t\tconst controller = this._commentControllers.get(handle);\n\n\t\t\tif (!controller) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._activeEditingCommentThreadDisposables.clear();\n\t\t\tthis._activeEditingCommentThread = thread as MainThreadCommentThread<IRange | ICellRange>;\n\t\t\tcontroller.activeEditingCommentThread = this._activeEditingCommentThread;\n\t\t}));\n\t}\n\n\t$registerCommentController(handle: number, id: string, label: string, extensionId: string): void {\n\t\tconst providerId = `${id}-${extensionId}`;\n\t\tthis._handlers.set(handle, providerId);\n\n\t\tconst provider = new MainThreadCommentController(this._proxy, this._commentService, handle, providerId, id, label, {});\n\t\tthis._commentService.registerCommentController(providerId, provider);\n\t\tthis._commentControllers.set(handle, provider);\n\n\t\tthis._register(this._commentService.onResourceHasCommentingRanges(e => {\n\t\t\tthis.registerView();\n\t\t}));\n\n\t\tthis._register(this._commentService.onDidUpdateCommentThreads(e => {\n\t\t\tthis.registerView();\n\t\t}));\n\n\t\tthis._commentService.setWorkspaceComments(String(handle), []);\n\t}\n\n\t$unregisterCommentController(handle: number): void {\n\t\tconst providerId = this._handlers.get(handle);\n\t\tthis._handlers.delete(handle);\n\t\tthis._commentControllers.get(handle)?.dispose();\n\t\tthis._commentControllers.delete(handle);\n\n\t\tif (typeof providerId !== 'string') {\n\t\t\treturn;\n\t\t\t// throw new Error('unknown handler');\n\t\t} else {\n\t\t\tthis._commentService.unregisterCommentController(providerId);\n\t\t}\n\t}\n\n\t$updateCommentControllerFeatures(handle: number, features: CommentProviderFeatures): void {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tprovider.updateFeatures(features);\n\t}\n\n\t$createCommentThread(handle: number,\n\t\tcommentThreadHandle: number,\n\t\tthreadId: string,\n\t\tresource: UriComponents,\n\t\trange: IRange | ICellRange | undefined,\n\t\tcomments: languages.Comment[],\n\t\textensionId: ExtensionIdentifier,\n\t\tisTemplate: boolean,\n\t\teditorId?: string\n\t): languages.CommentThread<IRange | ICellRange> | undefined {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn provider.createCommentThread(extensionId.value, commentThreadHandle, threadId, resource, range, comments, isTemplate, editorId);\n\t}\n\n\t$updateCommentThread(handle: number,\n\t\tcommentThreadHandle: number,\n\t\tthreadId: string,\n\t\tresource: UriComponents,\n\t\tchanges: CommentThreadChanges): void {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn provider.updateCommentThread(commentThreadHandle, threadId, resource, changes);\n\t}\n\n\t$deleteCommentThread(handle: number, commentThreadHandle: number) {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn provider.deleteCommentThread(commentThreadHandle);\n\t}\n\n\t$updateCommentingRanges(handle: number, resourceHints?: languages.CommentingRangeResourceHint) {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tprovider.updateCommentingRanges(resourceHints);\n\t}\n\n\tasync $revealCommentThread(handle: number, commentThreadHandle: number, commentUniqueIdInThread: number, options: languages.CommentThreadRevealOptions): Promise<void> {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst thread = provider.getAllComments().find(thread => thread.commentThreadHandle === commentThreadHandle);\n\t\tif (!thread || !thread.isDocumentCommentThread()) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst comment = thread.comments?.find(comment => comment.uniqueIdInThread === commentUniqueIdInThread);\n\n\t\trevealCommentThread(this._commentService, this._editorService, this._uriIdentityService, thread, comment, options.focusReply, undefined, options.preserveFocus);\n\t}\n\n\tasync $hideCommentThread(handle: number, commentThreadHandle: number): Promise<void> {\n\t\tconst provider = this._commentControllers.get(handle);\n\n\t\tif (!provider) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst thread = provider.getAllComments().find(thread => thread.commentThreadHandle === commentThreadHandle);\n\t\tif (!thread || !thread.isDocumentCommentThread()) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthread.collapsibleState = languages.CommentThreadCollapsibleState.Collapsed;\n\t}\n\n\tprivate registerView() {\n\t\tconst commentsPanelAlreadyConstructed = !!this._viewDescriptorService.getViewDescriptorById(COMMENTS_VIEW_ID);\n\t\tif (!commentsPanelAlreadyConstructed) {\n\t\t\tconst VIEW_CONTAINER: ViewContainer = Registry.as<IViewContainersRegistry>(ViewExtensions.ViewContainersRegistry).registerViewContainer({\n\t\t\t\tid: COMMENTS_VIEW_ID,\n\t\t\t\ttitle: COMMENTS_VIEW_TITLE,\n\t\t\t\tctorDescriptor: new SyncDescriptor(ViewPaneContainer, [COMMENTS_VIEW_ID, { mergeViewWithContainerWhenSingleView: true }]),\n\t\t\t\tstorageId: COMMENTS_VIEW_STORAGE_ID,\n\t\t\t\thideIfEmpty: true,\n\t\t\t\ticon: commentsViewIcon,\n\t\t\t\torder: 10,\n\t\t\t}, ViewContainerLocation.Panel);\n\n\t\t\tRegistry.as<IViewsRegistry>(ViewExtensions.ViewsRegistry).registerViews([{\n\t\t\t\tid: COMMENTS_VIEW_ID,\n\t\t\t\tname: COMMENTS_VIEW_TITLE,\n\t\t\t\tcanToggleVisibility: false,\n\t\t\t\tctorDescriptor: new SyncDescriptor(CommentsPanel),\n\t\t\t\tcanMoveView: true,\n\t\t\t\tcontainerIcon: commentsViewIcon,\n\t\t\t\tfocusCommand: {\n\t\t\t\t\tid: 'workbench.action.focusCommentsPanel'\n\t\t\t\t}\n\t\t\t}], VIEW_CONTAINER);\n\t\t}\n\t\tthis.registerViewListeners(commentsPanelAlreadyConstructed);\n\t}\n\n\tprivate setComments() {\n\t\t[...this._commentControllers.keys()].forEach(handle => {\n\t\t\tconst threads = this._commentControllers.get(handle)!.getAllComments();\n\n\t\t\tif (threads.length) {\n\t\t\t\tconst providerId = this.getHandler(handle);\n\t\t\t\tthis._commentService.setWorkspaceComments(providerId, threads);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate registerViewOpenedListener() {\n\t\tif (!this._openViewListener.value) {\n\t\t\tthis._openViewListener.value = this._viewsService.onDidChangeViewVisibility(e => {\n\t\t\t\tif (e.id === COMMENTS_VIEW_ID && e.visible) {\n\t\t\t\t\tthis.setComments();\n\t\t\t\t\tif (this._openViewListener) {\n\t\t\t\t\t\tthis._openViewListener.dispose();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * If the comments view has never been opened, the constructor for it has not yet run so it has\n\t * no listeners for comment threads being set or updated. Listen for the view opening for the\n\t * first time and send it comments then.\n\t */\n\tprivate registerViewListeners(commentsPanelAlreadyConstructed: boolean) {\n\t\tif (!commentsPanelAlreadyConstructed) {\n\t\t\tthis.registerViewOpenedListener();\n\t\t}\n\n\t\tif (!this._onChangeContainerListener.value) {\n\t\t\tthis._onChangeContainerListener.value = this._viewDescriptorService.onDidChangeContainer(e => {\n\t\t\t\tif (e.views.find(view => view.id === COMMENTS_VIEW_ID)) {\n\t\t\t\t\tthis.setComments();\n\t\t\t\t\tthis.registerViewOpenedListener();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!this._onChangeContainerLocationListener.value) {\n\t\t\tthis._onChangeContainerLocationListener.value = this._viewDescriptorService.onDidChangeContainerLocation(e => {\n\t\t\t\tconst commentsContainer = this._viewDescriptorService.getViewContainerByViewId(COMMENTS_VIEW_ID);\n\t\t\t\tif (e.viewContainer.id === commentsContainer?.id) {\n\t\t\t\t\tthis.setComments();\n\t\t\t\t\tthis.registerViewOpenedListener();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate getHandler(handle: number) {\n\t\tif (!this._handlers.has(handle)) {\n\t\t\tthrow new Error('Unknown handler');\n\t\t}\n\t\treturn this._handlers.get(handle)!;\n\t}\n}\n"]}