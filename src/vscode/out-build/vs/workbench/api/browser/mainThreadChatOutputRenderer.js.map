{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadChatOutputRenderer.ts","vs/workbench/api/browser/mainThreadChatOutputRenderer.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,QAAQ,EAAE,MAAM,gCAAgC,CAAC;AAC1D,OAAO,EAAE,UAAU,EAAe,MAAM,mCAAmC,CAAC;AAC5E,OAAO,EAAE,GAAG,EAAiB,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,0BAA0B,EAAE,MAAM,sDAAsD,CAAC;AAElG,OAAO,EAAkC,cAAc,EAAqC,MAAM,+BAA+B,CAAC;AAG3H,IAAM,4BAA4B,GAAlC,MAAM,4BAA6B,SAAQ,UAAU;IAQ3D,YACC,cAA+B,EACd,kBAAsC,EAC3B,gBAA6D;QAEzF,KAAK,EAAE,CAAC;QAHS,uBAAkB,GAAlB,kBAAkB,CAAoB;QACV,qBAAgB,GAAhB,gBAAgB,CAA4B;QAPlF,uBAAkB,GAAG,CAAC,CAAC;QAEd,wBAAmB,GAAG,IAAI,GAAG,EAAsC,CAAC;QAQpF,IAAI,CAAC,MAAM,GAAG,cAAc,CAAC,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC;IACjF,CAAC;IAEQ,OAAO;QACf,KAAK,CAAC,OAAO,EAAE,CAAC;QAEhB,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;QACrE,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,CAAC;IAClC,CAAC;IAED,2BAA2B,CAAC,QAAgB,EAAE,WAAgC,EAAE,iBAAgC;QAC/G,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,QAAQ,EAAE;YAChD,gBAAgB,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE;gBACtD,MAAM,aAAa,GAAG,eAAe,EAAE,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAEjE,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,aAAa,EAAE,OAAO,EAAE;oBAC1D,8BAA8B,EAAE,IAAI;iBACpC,CAAC,CAAC;gBAEH,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,QAAQ,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;YAC1F,CAAC;SACD,EAAE;YACF,SAAS,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE,QAAQ,EAAE,GAAG,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAE;SACvE,CAAC,CAAC;IACJ,CAAC;IAED,6BAA6B,CAAC,QAAgB;QAC7C,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,OAAO,EAAE,CAAC;IACnD,CAAC;CACD,CAAA;AA3CY,4BAA4B;IAWtC,WAAA,0BAA0B,CAAA;GAXhB,4BAA4B,CA2CxC","file":"mainThreadChatOutputRenderer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Disposable, IDisposable } from '../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { IChatOutputRendererService } from '../../contrib/chat/browser/chatOutputItemRenderer.js';\nimport { IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { ExtHostChatOutputRendererShape, ExtHostContext, MainThreadChatOutputRendererShape } from '../common/extHost.protocol.js';\nimport { MainThreadWebviews } from './mainThreadWebviews.js';\n\nexport class MainThreadChatOutputRenderer extends Disposable implements MainThreadChatOutputRendererShape {\n\n\tprivate readonly _proxy: ExtHostChatOutputRendererShape;\n\n\tprivate _webviewHandlePool = 0;\n\n\tprivate readonly registeredRenderers = new Map</* viewType */ string, IDisposable>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\tprivate readonly _mainThreadWebview: MainThreadWebviews,\n\t\t@IChatOutputRendererService private readonly _rendererService: IChatOutputRendererService,\n\t) {\n\t\tsuper();\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostChatOutputRenderer);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.registeredRenderers.forEach(disposable => disposable.dispose());\n\t\tthis.registeredRenderers.clear();\n\t}\n\n\t$registerChatOutputRenderer(viewType: string, extensionId: ExtensionIdentifier, extensionLocation: UriComponents): void {\n\t\tthis._rendererService.registerRenderer(viewType, {\n\t\t\trenderOutputPart: async (mime, data, webview, token) => {\n\t\t\t\tconst webviewHandle = `chat-output-${++this._webviewHandlePool}`;\n\n\t\t\t\tthis._mainThreadWebview.addWebview(webviewHandle, webview, {\n\t\t\t\t\tserializeBuffersForPostMessage: true,\n\t\t\t\t});\n\n\t\t\t\tthis._proxy.$renderChatOutput(viewType, mime, VSBuffer.wrap(data), webviewHandle, token);\n\t\t\t},\n\t\t}, {\n\t\t\textension: { id: extensionId, location: URI.revive(extensionLocation) }\n\t\t});\n\t}\n\n\t$unregisterChatOutputRenderer(viewType: string): void {\n\t\tthis.registeredRenderers.get(viewType)?.dispose();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../base/common/buffer.js';\nimport { Disposable, IDisposable } from '../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\nimport { IChatOutputRendererService } from '../../contrib/chat/browser/chatOutputItemRenderer.js';\nimport { IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { ExtHostChatOutputRendererShape, ExtHostContext, MainThreadChatOutputRendererShape } from '../common/extHost.protocol.js';\nimport { MainThreadWebviews } from './mainThreadWebviews.js';\n\nexport class MainThreadChatOutputRenderer extends Disposable implements MainThreadChatOutputRendererShape {\n\n\tprivate readonly _proxy: ExtHostChatOutputRendererShape;\n\n\tprivate _webviewHandlePool = 0;\n\n\tprivate readonly registeredRenderers = new Map</* viewType */ string, IDisposable>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\tprivate readonly _mainThreadWebview: MainThreadWebviews,\n\t\t@IChatOutputRendererService private readonly _rendererService: IChatOutputRendererService,\n\t) {\n\t\tsuper();\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostChatOutputRenderer);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.registeredRenderers.forEach(disposable => disposable.dispose());\n\t\tthis.registeredRenderers.clear();\n\t}\n\n\t$registerChatOutputRenderer(viewType: string, extensionId: ExtensionIdentifier, extensionLocation: UriComponents): void {\n\t\tthis._rendererService.registerRenderer(viewType, {\n\t\t\trenderOutputPart: async (mime, data, webview, token) => {\n\t\t\t\tconst webviewHandle = `chat-output-${++this._webviewHandlePool}`;\n\n\t\t\t\tthis._mainThreadWebview.addWebview(webviewHandle, webview, {\n\t\t\t\t\tserializeBuffersForPostMessage: true,\n\t\t\t\t});\n\n\t\t\t\tthis._proxy.$renderChatOutput(viewType, mime, VSBuffer.wrap(data), webviewHandle, token);\n\t\t\t},\n\t\t}, {\n\t\t\textension: { id: extensionId, location: URI.revive(extensionLocation) }\n\t\t});\n\t}\n\n\t$unregisterChatOutputRenderer(viewType: string): void {\n\t\tthis.registeredRenderers.get(viewType)?.dispose();\n\t}\n}\n"]}