{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/browser/mainThreadBulkEdits.ts","vs/workbench/api/browser/mainThreadBulkEdits.ts"],"names":[],"mappings":"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","file":"mainThreadBulkEdits.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer, decodeBase64 } from '../../../base/common/buffer.js';\nimport { revive } from '../../../base/common/marshalling.js';\nimport { IBulkEditService, ResourceFileEdit, ResourceTextEdit } from '../../../editor/browser/services/bulkEditService.js';\nimport { WorkspaceEdit } from '../../../editor/common/languages.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceCellEditDto, IWorkspaceEditDto, IWorkspaceFileEditDto, MainContext, MainThreadBulkEditsShape } from '../common/extHost.protocol.js';\nimport { ResourceNotebookCellEdit } from '../../contrib/bulkEdit/browser/bulkCellEdits.js';\nimport { CellEditType } from '../../contrib/notebook/common/notebookCommon.js';\nimport { IExtHostContext, extHostNamedCustomer } from '../../services/extensions/common/extHostCustomers.js';\nimport { SerializableObjectWithBuffers } from '../../services/extensions/common/proxyIdentifier.js';\n\n\n@extHostNamedCustomer(MainContext.MainThreadBulkEdits)\nexport class MainThreadBulkEdits implements MainThreadBulkEditsShape {\n\n\tconstructor(\n\t\t_extHostContext: IExtHostContext,\n\t\t@IBulkEditService private readonly _bulkEditService: IBulkEditService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IUriIdentityService private readonly _uriIdentService: IUriIdentityService\n\t) { }\n\n\tdispose(): void { }\n\n\t$tryApplyWorkspaceEdit(dto: SerializableObjectWithBuffers<IWorkspaceEditDto>, undoRedoGroupId?: number, isRefactoring?: boolean): Promise<boolean> {\n\t\tconst edits = reviveWorkspaceEditDto(dto.value, this._uriIdentService);\n\t\treturn this._bulkEditService.apply(edits, { undoRedoGroupId, respectAutoSaveConfig: isRefactoring }).then((res) => res.isApplied, err => {\n\t\t\tthis._logService.warn(`IGNORING workspace edit: ${err}`);\n\t\t\treturn false;\n\t\t});\n\t}\n}\n\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit;\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto | undefined, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit | undefined;\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto | undefined, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit | undefined {\n\tif (!data || !data.edits) {\n\t\treturn <WorkspaceEdit>data;\n\t}\n\tconst result = revive<WorkspaceEdit>(data);\n\tfor (const edit of result.edits) {\n\t\tif (ResourceTextEdit.is(edit)) {\n\t\t\tedit.resource = uriIdentityService.asCanonicalUri(edit.resource);\n\t\t}\n\t\tif (ResourceFileEdit.is(edit)) {\n\t\t\tif (edit.options) {\n\t\t\t\tconst inContents = (edit as IWorkspaceFileEditDto).options?.contents;\n\t\t\t\tif (inContents) {\n\t\t\t\t\tif (inContents.type === 'base64') {\n\t\t\t\t\t\tedit.options.contents = Promise.resolve(decodeBase64(inContents.value));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (resolveDataTransferFile) {\n\t\t\t\t\t\t\tedit.options.contents = resolveDataTransferFile(inContents.id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error('Could not revive data transfer file');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tedit.newResource = edit.newResource && uriIdentityService.asCanonicalUri(edit.newResource);\n\t\t\tedit.oldResource = edit.oldResource && uriIdentityService.asCanonicalUri(edit.oldResource);\n\t\t}\n\t\tif (ResourceNotebookCellEdit.is(edit)) {\n\t\t\tedit.resource = uriIdentityService.asCanonicalUri(edit.resource);\n\t\t\tconst cellEdit = (edit as IWorkspaceCellEditDto).cellEdit;\n\t\t\tif (cellEdit.editType === CellEditType.Replace) {\n\t\t\t\tedit.cellEdit = {\n\t\t\t\t\t...cellEdit,\n\t\t\t\t\tcells: cellEdit.cells.map(cell => ({\n\t\t\t\t\t\t...cell,\n\t\t\t\t\t\toutputs: cell.outputs.map(output => ({\n\t\t\t\t\t\t\t...output,\n\t\t\t\t\t\t\toutputs: output.items.map(item => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tmime: item.mime,\n\t\t\t\t\t\t\t\t\tdata: item.valueBytes\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}))\n\t\t\t\t\t}))\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\treturn <WorkspaceEdit>data;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer, decodeBase64 } from '../../../base/common/buffer.js';\nimport { revive } from '../../../base/common/marshalling.js';\nimport { IBulkEditService, ResourceFileEdit, ResourceTextEdit } from '../../../editor/browser/services/bulkEditService.js';\nimport { WorkspaceEdit } from '../../../editor/common/languages.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceCellEditDto, IWorkspaceEditDto, IWorkspaceFileEditDto, MainContext, MainThreadBulkEditsShape } from '../common/extHost.protocol.js';\nimport { ResourceNotebookCellEdit } from '../../contrib/bulkEdit/browser/bulkCellEdits.js';\nimport { CellEditType } from '../../contrib/notebook/common/notebookCommon.js';\nimport { IExtHostContext, extHostNamedCustomer } from '../../services/extensions/common/extHostCustomers.js';\nimport { SerializableObjectWithBuffers } from '../../services/extensions/common/proxyIdentifier.js';\n\n\n@extHostNamedCustomer(MainContext.MainThreadBulkEdits)\nexport class MainThreadBulkEdits implements MainThreadBulkEditsShape {\n\n\tconstructor(\n\t\t_extHostContext: IExtHostContext,\n\t\t@IBulkEditService private readonly _bulkEditService: IBulkEditService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IUriIdentityService private readonly _uriIdentService: IUriIdentityService\n\t) { }\n\n\tdispose(): void { }\n\n\t$tryApplyWorkspaceEdit(dto: SerializableObjectWithBuffers<IWorkspaceEditDto>, undoRedoGroupId?: number, isRefactoring?: boolean): Promise<boolean> {\n\t\tconst edits = reviveWorkspaceEditDto(dto.value, this._uriIdentService);\n\t\treturn this._bulkEditService.apply(edits, { undoRedoGroupId, respectAutoSaveConfig: isRefactoring }).then((res) => res.isApplied, err => {\n\t\t\tthis._logService.warn(`IGNORING workspace edit: ${err}`);\n\t\t\treturn false;\n\t\t});\n\t}\n}\n\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit;\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto | undefined, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit | undefined;\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto | undefined, uriIdentityService: IUriIdentityService, resolveDataTransferFile?: (id: string) => Promise<VSBuffer>): WorkspaceEdit | undefined {\n\tif (!data || !data.edits) {\n\t\treturn <WorkspaceEdit>data;\n\t}\n\tconst result = revive<WorkspaceEdit>(data);\n\tfor (const edit of result.edits) {\n\t\tif (ResourceTextEdit.is(edit)) {\n\t\t\tedit.resource = uriIdentityService.asCanonicalUri(edit.resource);\n\t\t}\n\t\tif (ResourceFileEdit.is(edit)) {\n\t\t\tif (edit.options) {\n\t\t\t\tconst inContents = (edit as IWorkspaceFileEditDto).options?.contents;\n\t\t\t\tif (inContents) {\n\t\t\t\t\tif (inContents.type === 'base64') {\n\t\t\t\t\t\tedit.options.contents = Promise.resolve(decodeBase64(inContents.value));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (resolveDataTransferFile) {\n\t\t\t\t\t\t\tedit.options.contents = resolveDataTransferFile(inContents.id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error('Could not revive data transfer file');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tedit.newResource = edit.newResource && uriIdentityService.asCanonicalUri(edit.newResource);\n\t\t\tedit.oldResource = edit.oldResource && uriIdentityService.asCanonicalUri(edit.oldResource);\n\t\t}\n\t\tif (ResourceNotebookCellEdit.is(edit)) {\n\t\t\tedit.resource = uriIdentityService.asCanonicalUri(edit.resource);\n\t\t\tconst cellEdit = (edit as IWorkspaceCellEditDto).cellEdit;\n\t\t\tif (cellEdit.editType === CellEditType.Replace) {\n\t\t\t\tedit.cellEdit = {\n\t\t\t\t\t...cellEdit,\n\t\t\t\t\tcells: cellEdit.cells.map(cell => ({\n\t\t\t\t\t\t...cell,\n\t\t\t\t\t\toutputs: cell.outputs.map(output => ({\n\t\t\t\t\t\t\t...output,\n\t\t\t\t\t\t\toutputs: output.items.map(item => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tmime: item.mime,\n\t\t\t\t\t\t\t\t\tdata: item.valueBytes\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}))\n\t\t\t\t\t}))\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\treturn <WorkspaceEdit>data;\n}\n"]}