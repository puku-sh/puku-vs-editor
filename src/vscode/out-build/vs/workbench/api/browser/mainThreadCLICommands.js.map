{"version":3,"sources":["vs/workbench/api/browser/mainThreadCLICommands.ts"],"names":[],"mappings":"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","file":"mainThreadCLICommands.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../base/common/network.js';\nimport { isWeb } from '../../../base/common/platform.js';\nimport { isString } from '../../../base/common/types.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IExtensionGalleryService, IExtensionManagementService } from '../../../platform/extensionManagement/common/extensionManagement.js';\nimport { ExtensionManagementCLI } from '../../../platform/extensionManagement/common/extensionManagementCLI.js';\nimport { getExtensionId } from '../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { IExtensionManifest } from '../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { AbstractMessageLogger, ILogger, LogLevel } from '../../../platform/log/common/log.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\nimport { IOpenWindowOptions, IWindowOpenable } from '../../../platform/window/common/window.js';\nimport { IWorkbenchEnvironmentService } from '../../services/environment/common/environmentService.js';\nimport { IExtensionManagementServerService } from '../../services/extensionManagement/common/extensionManagement.js';\nimport { IExtensionManifestPropertiesService } from '../../services/extensions/common/extensionManifestPropertiesService.js';\n\n\n// this class contains the commands that the CLI server is reying on\n\nCommandsRegistry.registerCommand('_remoteCLI.openExternal', function (accessor: ServicesAccessor, uri: UriComponents | string): Promise<boolean> {\n\tconst openerService = accessor.get(IOpenerService);\n\treturn openerService.open(isString(uri) ? uri : URI.revive(uri), { openExternal: true, allowTunneling: true });\n});\n\nCommandsRegistry.registerCommand('_remoteCLI.windowOpen', function (accessor: ServicesAccessor, toOpen: IWindowOpenable[], options: IOpenWindowOptions) {\n\tconst commandService = accessor.get(ICommandService);\n\tif (!toOpen.length) {\n\t\treturn commandService.executeCommand('_files.newWindow', options);\n\t}\n\treturn commandService.executeCommand('_files.windowOpen', toOpen, options);\n});\n\nCommandsRegistry.registerCommand('_remoteCLI.getSystemStatus', function (accessor: ServicesAccessor): Promise<string | undefined> {\n\tconst commandService = accessor.get(ICommandService);\n\treturn commandService.executeCommand<string>('_issues.getSystemStatus');\n});\n\ninterface ManageExtensionsArgs {\n\tlist?: { showVersions?: boolean; category?: string };\n\tinstall?: (string | URI)[];\n\tuninstall?: string[];\n\tforce?: boolean;\n}\n\nCommandsRegistry.registerCommand('_remoteCLI.manageExtensions', async function (accessor: ServicesAccessor, args: ManageExtensionsArgs): Promise<string | undefined> {\n\tconst instantiationService = accessor.get(IInstantiationService);\n\tconst extensionManagementServerService = accessor.get(IExtensionManagementServerService);\n\tconst remoteExtensionManagementService = extensionManagementServerService.remoteExtensionManagementServer?.extensionManagementService;\n\tif (!remoteExtensionManagementService) {\n\t\treturn;\n\t}\n\n\tconst lines: string[] = [];\n\tconst logger = new class extends AbstractMessageLogger {\n\t\tprotected override log(level: LogLevel, message: string): void {\n\t\t\tlines.push(message);\n\t\t}\n\t}();\n\tconst childInstantiationService = instantiationService.createChild(new ServiceCollection([IExtensionManagementService, remoteExtensionManagementService]));\n\ttry {\n\t\tconst cliService = childInstantiationService.createInstance(RemoteExtensionManagementCLI, logger);\n\n\t\tif (args.list) {\n\t\t\tawait cliService.listExtensions(!!args.list.showVersions, args.list.category, undefined);\n\t\t} else {\n\t\t\tconst revive = (inputs: (string | UriComponents)[]) => inputs.map(input => isString(input) ? input : URI.revive(input));\n\t\t\tif (Array.isArray(args.install) && args.install.length) {\n\t\t\t\ttry {\n\t\t\t\t\tawait cliService.installExtensions(revive(args.install), [], { isMachineScoped: true }, !!args.force);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlines.push(e.message);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Array.isArray(args.uninstall) && args.uninstall.length) {\n\t\t\t\ttry {\n\t\t\t\t\tawait cliService.uninstallExtensions(revive(args.uninstall), !!args.force, undefined);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlines.push(e.message);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn lines.join('\\n');\n\t} finally {\n\t\tchildInstantiationService.dispose();\n\t}\n\n});\n\nclass RemoteExtensionManagementCLI extends ExtensionManagementCLI {\n\n\tprivate _location: string | undefined;\n\n\tconstructor(\n\t\tlogger: ILogger,\n\t\t@IExtensionManagementService extensionManagementService: IExtensionManagementService,\n\t\t@IExtensionGalleryService extensionGalleryService: IExtensionGalleryService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IWorkbenchEnvironmentService envService: IWorkbenchEnvironmentService,\n\t\t@IExtensionManifestPropertiesService private readonly _extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t) {\n\t\tsuper(logger, extensionManagementService, extensionGalleryService);\n\n\t\tconst remoteAuthority = envService.remoteAuthority;\n\t\tthis._location = remoteAuthority ? labelService.getHostLabel(Schemas.vscodeRemote, remoteAuthority) : undefined;\n\t}\n\n\tprotected override get location(): string | undefined {\n\t\treturn this._location;\n\t}\n\n\tprotected override validateExtensionKind(manifest: IExtensionManifest): boolean {\n\t\tif (!this._extensionManifestPropertiesService.canExecuteOnWorkspace(manifest)\n\t\t\t// Web extensions installed on remote can be run in web worker extension host\n\t\t\t&& !(isWeb && this._extensionManifestPropertiesService.canExecuteOnWeb(manifest))) {\n\t\t\tthis.logger.info(localize('cannot be installed', \"Cannot install the '{0}' extension because it is declared to not run in this setup.\", getExtensionId(manifest.publisher, manifest.name)));\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n"]}