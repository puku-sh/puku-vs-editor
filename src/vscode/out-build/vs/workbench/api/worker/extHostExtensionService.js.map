{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/worker/extHostExtensionService.ts","vs/workbench/api/worker/extHostExtensionService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,iCAAiC,EAAE,MAAM,+BAA+B,CAAC;AAElF,OAAO,EAAE,+BAA+B,EAAE,MAAM,sCAAsC,CAAC;AACvF,OAAO,EAAE,GAAG,EAAE,MAAM,6BAA6B,CAAC;AAClD,OAAO,EAAE,kBAAkB,EAAE,MAAM,wCAAwC,CAAC;AAE5E,OAAO,EAAE,gBAAgB,EAAE,MAAM,2BAA2B,CAAC;AAC7D,OAAO,EAAE,OAAO,EAAE,MAAM,+BAA+B,CAAC;AACxD,OAAO,EAAE,uBAAuB,EAAE,MAAM,8BAA8B,CAAC;AACvE,OAAO,EAAE,OAAO,EAAE,MAAM,8BAA8B,CAAC;AAEvD,MAAM,wBAAyB,SAAQ,kBAAkB;IAE9C,mBAAmB,KAAK,CAAC;IAEnC,SAAS,CAAC,OAAe,EAAE,MAAW;QACrC,KAAK,MAAM,qBAAqB,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;YACxD,MAAM,WAAW,GAAG,qBAAqB,CAAC,OAAO,CAAC,CAAC;YACnD,IAAI,WAAW,EAAE,CAAC;gBACjB,OAAO,GAAG,WAAW,CAAC;gBACtB,MAAM;YACP,CAAC;QACF,CAAC;QAED,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC;YAClC,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,CAAE,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzH,CAAC;QACD,OAAO,SAAS,CAAC;IAClB,CAAC;CACD;AAED,MAAM,OAAO,uBAAwB,SAAQ,+BAA+B;IAA5E;;QACU,qBAAgB,GAAG,gBAAgB,CAAC,SAAS,CAAC;IA8GxD,CAAC;IA1GU,KAAK,CAAC,iCAAiC;QAChD,oDAAoD;QACpD,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAC;QAE3D,qCAAqC;QACrC,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,iCAAiC,CAAC,CAAC;QACxF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,wBAAwB,EAAE,UAAU,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE,GAAG,EAAE,IAAI,CAAC,eAAe,EAAE,CAAC,CAAC;QACnJ,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC;QAClC,WAAW,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;QAE5C,MAAM,IAAI,CAAC,0BAA0B,EAAE,CAAC;IACzC,CAAC;IAES,cAAc,CAAC,oBAA2C;QACnE,OAAO,oBAAoB,CAAC,OAAO,CAAC;IACrC,CAAC;IAES,KAAK,CAAC,mBAAmB,CAA+B,SAAuC,EAAE,MAAW,EAAE,sBAAuD;QAC9K,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC;QACjE,MAAM,WAAW,GAAG,SAAS,EAAE,UAAU,CAAC,KAAK,CAAC;QAChD,IAAI,WAAW,EAAE,CAAC;YACjB,WAAW,CAAC,IAAI,CAAC,uCAAuC,WAAW,EAAE,CAAC,CAAC;QACxE,CAAC;QAED,qFAAqF;QACrF,oGAAoG;QACpG,6CAA6C;QAC7C,MAAM,UAAU,GAAG,GAAG,CAAC,MAAM,CAAC,MAAM,IAAI,CAAC,0BAA0B,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;QAC3F,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QACxD,IAAI,WAAW,EAAE,CAAC;YACjB,WAAW,CAAC,IAAI,CAAC,sCAAsC,WAAW,EAAE,CAAC,CAAC;QACvE,CAAC;QAED,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE,CAAC;YAC7B,MAAM,IAAI,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACtC,CAAC;QAED,+DAA+D;QAC/D,MAAM,MAAM,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrC,+EAA+E;QAC/E,mDAAmD;QACnD,MAAM,SAAS,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,mBAAmB,CAAC;QAC9D,MAAM,UAAU,GAAG,GAAG,MAAM,mBAAmB,SAAS,EAAE,CAAC;QAC3D,IAAI,MAAgB,CAAC;QACrB,IAAI,CAAC;YACJ,MAAM,GAAG,IAAI,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,CAAC,CAAC,CAAC,6EAA6E;QACjJ,CAAC;QAAC,OAAO,GAAG,EAAE,CAAC;YACd,IAAI,WAAW,EAAE,CAAC;gBACjB,OAAO,CAAC,KAAK,CAAC,8BAA8B,WAAW,YAAY,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;YACnF,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,KAAK,CAAC,wBAAwB,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;YACtD,CAAC;YACD,OAAO,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,OAAO,GAAG,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,GAAG,OAAO,GAAG,CAAC,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,WAAW,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;YACpK,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACnB,MAAM,GAAG,CAAC;QACX,CAAC;QAED,IAAI,SAAS,EAAE,CAAC;YACf,MAAM,IAAI,CAAC,2BAA2B,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;QAC/E,CAAC;QAED,8DAA8D;QAC9D,MAAM,QAAQ,GAAG,EAAE,CAAC;QACpB,MAAM,OAAO,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC;QACtC,MAAM,QAAQ,GAAG,CAAC,OAAe,EAAE,EAAE;YACpC,MAAM,MAAM,GAAG,IAAI,CAAC,YAAa,CAAC,SAAS,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YAC7D,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;gBAC1B,MAAM,IAAI,KAAK,CAAC,uBAAuB,OAAO,GAAG,CAAC,CAAC;YACpD,CAAC;YACD,OAAO,MAAM,CAAC;QACf,CAAC,CAAC;QAEF,IAAI,CAAC;YACJ,sBAAsB,CAAC,gBAAgB,EAAE,CAAC;YAC1C,IAAI,WAAW,EAAE,CAAC;gBACjB,WAAW,CAAC,IAAI,CAAC,sCAAsC,WAAW,EAAE,CAAC,CAAC;YACvE,CAAC;YACD,MAAM,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YACpC,OAAU,CAAC,OAAO,CAAC,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;QACvE,CAAC;gBAAS,CAAC;YACV,IAAI,WAAW,EAAE,CAAC;gBACjB,WAAW,CAAC,IAAI,CAAC,qCAAqC,WAAW,EAAE,CAAC,CAAC;YACtE,CAAC;YACD,sBAAsB,CAAC,eAAe,EAAE,CAAC;QAC1C,CAAC;IACF,CAAC;IAEkB,cAAc,CAAI,SAAuC,EAAE,MAAW,EAAE,sBAAuD;QACjJ,MAAM,IAAI,KAAK,CAAC,gEAAgE,CAAC,CAAC;IACnF,CAAC;IAED,KAAK,CAAC,qBAAqB,CAAC,IAAsC;QACjE,OAAO;IACR,CAAC;IAEO,KAAK,CAAC,0BAA0B,CAAC,WAAW,GAAG,IAAI;QAC1D,mEAAmE;QACnE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,2BAA2B,EAAE,CAAC;YAC7D,OAAO;QACR,CAAC;QAED,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,WAAW,CAAC;QAC1C,OAAO,IAAI,CAAC,GAAG,EAAE,GAAG,QAAQ,IAAI,CAAC,CAAC,kBAAkB,IAAI,UAAU,CAAC,EAAE,CAAC;YACrE,MAAM,OAAO,CAAC,EAAE,CAAC,CAAC;QACnB,CAAC;IACF,CAAC;CACD;AAED,SAAS,YAAY,CAAC,IAAY,EAAE,MAAc;IACjD,MAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;IAC9B,OAAO,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,MAAM,CAAC;AACvC,CAAC","file":"extHostExtensionService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createApiFactoryAndRegisterActors } from '../common/extHost.api.impl.js';\nimport { ExtensionActivationTimesBuilder } from '../common/extHostExtensionActivator.js';\nimport { AbstractExtHostExtensionService } from '../common/extHostExtensionService.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { RequireInterceptor } from '../common/extHostRequireInterceptor.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtensionRuntime } from '../common/extHostTypes.js';\nimport { timeout } from '../../../base/common/async.js';\nimport { ExtHostConsoleForwarder } from './extHostConsoleForwarder.js';\nimport { extname } from '../../../base/common/path.js';\n\nclass WorkerRequireInterceptor extends RequireInterceptor {\n\n\tprotected _installInterceptor() { }\n\n\tgetModule(request: string, parent: URI): undefined | any {\n\t\tfor (const alternativeModuleName of this._alternatives) {\n\t\t\tconst alternative = alternativeModuleName(request);\n\t\t\tif (alternative) {\n\t\t\t\trequest = alternative;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._factories.has(request)) {\n\t\t\treturn this._factories.get(request)!.load(request, parent, () => { throw new Error('CANNOT LOAD MODULE from here.'); });\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport class ExtHostExtensionService extends AbstractExtHostExtensionService {\n\treadonly extensionRuntime = ExtensionRuntime.Webworker;\n\n\tprivate _fakeModules?: WorkerRequireInterceptor;\n\n\tprotected async _beforeAlmostReadyToRunExtensions(): Promise<void> {\n\t\t// make sure console.log calls make it to the render\n\t\tthis._instaService.createInstance(ExtHostConsoleForwarder);\n\n\t\t// initialize API and register actors\n\t\tconst apiFactory = this._instaService.invokeFunction(createApiFactoryAndRegisterActors);\n\t\tthis._fakeModules = this._instaService.createInstance(WorkerRequireInterceptor, apiFactory, { mine: this._myRegistry, all: this._globalRegistry });\n\t\tawait this._fakeModules.install();\n\t\tperformance.mark('code/extHost/didInitAPI');\n\n\t\tawait this._waitForDebuggerAttachment();\n\t}\n\n\tprotected _getEntryPoint(extensionDescription: IExtensionDescription): string | undefined {\n\t\treturn extensionDescription.browser;\n\t}\n\n\tprotected async _loadCommonJSModule<T extends object | undefined>(extension: IExtensionDescription | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T> {\n\t\tmodule = module.with({ path: ensureSuffix(module.path, '.js') });\n\t\tconst extensionId = extension?.identifier.value;\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/willFetchExtensionCode/${extensionId}`);\n\t\t}\n\n\t\t// First resolve the extension entry point URI to something we can load using `fetch`\n\t\t// This needs to be done on the main thread due to a potential `resourceUriProvider` (workbench api)\n\t\t// which is only available in the main thread\n\t\tconst browserUri = URI.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(module));\n\t\tconst response = await fetch(browserUri.toString(true));\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/didFetchExtensionCode/${extensionId}`);\n\t\t}\n\n\t\tif (response.status !== 200) {\n\t\t\tthrow new Error(response.statusText);\n\t\t}\n\n\t\t// fetch JS sources as text and create a new function around it\n\t\tconst source = await response.text();\n\t\t// Here we append #vscode-extension to serve as a marker, such that source maps\n\t\t// can be adjusted for the extra wrapping function.\n\t\tconst sourceURL = `${module.toString(true)}#vscode-extension`;\n\t\tconst fullSource = `${source}\\n//# sourceURL=${sourceURL}`;\n\t\tlet initFn: Function;\n\t\ttry {\n\t\t\tinitFn = new Function('module', 'exports', 'require', fullSource); // CodeQL [SM01632] js/eval-call there is no alternative until we move to ESM\n\t\t} catch (err) {\n\t\t\tif (extensionId) {\n\t\t\t\tconsole.error(`Loading code for extension ${extensionId} failed: ${err.message}`);\n\t\t\t} else {\n\t\t\t\tconsole.error(`Loading code failed: ${err.message}`);\n\t\t\t}\n\t\t\tconsole.error(`${module.toString(true)}${typeof err.line === 'number' ? ` line ${err.line}` : ''}${typeof err.column === 'number' ? ` column ${err.column}` : ''}`);\n\t\t\tconsole.error(err);\n\t\t\tthrow err;\n\t\t}\n\n\t\tif (extension) {\n\t\t\tawait this._extHostLocalizationService.initializeLocalizedMessages(extension);\n\t\t}\n\n\t\t// define commonjs globals: `module`, `exports`, and `require`\n\t\tconst _exports = {};\n\t\tconst _module = { exports: _exports };\n\t\tconst _require = (request: string) => {\n\t\t\tconst result = this._fakeModules!.getModule(request, module);\n\t\t\tif (result === undefined) {\n\t\t\t\tthrow new Error(`Cannot load module '${request}'`);\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\n\t\ttry {\n\t\t\tactivationTimesBuilder.codeLoadingStart();\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/willLoadExtensionCode/${extensionId}`);\n\t\t\t}\n\t\t\tinitFn(_module, _exports, _require);\n\t\t\treturn <T>(_module.exports !== _exports ? _module.exports : _exports);\n\t\t} finally {\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/didLoadExtensionCode/${extensionId}`);\n\t\t\t}\n\t\t\tactivationTimesBuilder.codeLoadingStop();\n\t\t}\n\t}\n\n\tprotected override _loadESMModule<T>(extension: IExtensionDescription | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T> {\n\t\tthrow new Error('ESM modules are not supported in the web worker extension host');\n\t}\n\n\tasync $setRemoteEnvironment(_env: { [key: string]: string | null }): Promise<void> {\n\t\treturn;\n\t}\n\n\tprivate async _waitForDebuggerAttachment(waitTimeout = 5000) {\n\t\t// debugger attaches async, waiting for it fixes #106698 and #99222\n\t\tif (!this._initData.environment.isExtensionDevelopmentDebug) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deadline = Date.now() + waitTimeout;\n\t\twhile (Date.now() < deadline && !('__jsDebugIsReady' in globalThis)) {\n\t\t\tawait timeout(10);\n\t\t}\n\t}\n}\n\nfunction ensureSuffix(path: string, suffix: string): string {\n\tconst extName = extname(path);\n\treturn extName ? path : path + suffix;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createApiFactoryAndRegisterActors } from '../common/extHost.api.impl.js';\nimport { ExtensionActivationTimesBuilder } from '../common/extHostExtensionActivator.js';\nimport { AbstractExtHostExtensionService } from '../common/extHostExtensionService.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { RequireInterceptor } from '../common/extHostRequireInterceptor.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtensionRuntime } from '../common/extHostTypes.js';\nimport { timeout } from '../../../base/common/async.js';\nimport { ExtHostConsoleForwarder } from './extHostConsoleForwarder.js';\nimport { extname } from '../../../base/common/path.js';\n\nclass WorkerRequireInterceptor extends RequireInterceptor {\n\n\tprotected _installInterceptor() { }\n\n\tgetModule(request: string, parent: URI): undefined | any {\n\t\tfor (const alternativeModuleName of this._alternatives) {\n\t\t\tconst alternative = alternativeModuleName(request);\n\t\t\tif (alternative) {\n\t\t\t\trequest = alternative;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._factories.has(request)) {\n\t\t\treturn this._factories.get(request)!.load(request, parent, () => { throw new Error('CANNOT LOAD MODULE from here.'); });\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport class ExtHostExtensionService extends AbstractExtHostExtensionService {\n\treadonly extensionRuntime = ExtensionRuntime.Webworker;\n\n\tprivate _fakeModules?: WorkerRequireInterceptor;\n\n\tprotected async _beforeAlmostReadyToRunExtensions(): Promise<void> {\n\t\t// make sure console.log calls make it to the render\n\t\tthis._instaService.createInstance(ExtHostConsoleForwarder);\n\n\t\t// initialize API and register actors\n\t\tconst apiFactory = this._instaService.invokeFunction(createApiFactoryAndRegisterActors);\n\t\tthis._fakeModules = this._instaService.createInstance(WorkerRequireInterceptor, apiFactory, { mine: this._myRegistry, all: this._globalRegistry });\n\t\tawait this._fakeModules.install();\n\t\tperformance.mark('code/extHost/didInitAPI');\n\n\t\tawait this._waitForDebuggerAttachment();\n\t}\n\n\tprotected _getEntryPoint(extensionDescription: IExtensionDescription): string | undefined {\n\t\treturn extensionDescription.browser;\n\t}\n\n\tprotected async _loadCommonJSModule<T extends object | undefined>(extension: IExtensionDescription | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T> {\n\t\tmodule = module.with({ path: ensureSuffix(module.path, '.js') });\n\t\tconst extensionId = extension?.identifier.value;\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/willFetchExtensionCode/${extensionId}`);\n\t\t}\n\n\t\t// First resolve the extension entry point URI to something we can load using `fetch`\n\t\t// This needs to be done on the main thread due to a potential `resourceUriProvider` (workbench api)\n\t\t// which is only available in the main thread\n\t\tconst browserUri = URI.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(module));\n\t\tconst response = await fetch(browserUri.toString(true));\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/didFetchExtensionCode/${extensionId}`);\n\t\t}\n\n\t\tif (response.status !== 200) {\n\t\t\tthrow new Error(response.statusText);\n\t\t}\n\n\t\t// fetch JS sources as text and create a new function around it\n\t\tconst source = await response.text();\n\t\t// Here we append #vscode-extension to serve as a marker, such that source maps\n\t\t// can be adjusted for the extra wrapping function.\n\t\tconst sourceURL = `${module.toString(true)}#vscode-extension`;\n\t\tconst fullSource = `${source}\\n//# sourceURL=${sourceURL}`;\n\t\tlet initFn: Function;\n\t\ttry {\n\t\t\tinitFn = new Function('module', 'exports', 'require', fullSource); // CodeQL [SM01632] js/eval-call there is no alternative until we move to ESM\n\t\t} catch (err) {\n\t\t\tif (extensionId) {\n\t\t\t\tconsole.error(`Loading code for extension ${extensionId} failed: ${err.message}`);\n\t\t\t} else {\n\t\t\t\tconsole.error(`Loading code failed: ${err.message}`);\n\t\t\t}\n\t\t\tconsole.error(`${module.toString(true)}${typeof err.line === 'number' ? ` line ${err.line}` : ''}${typeof err.column === 'number' ? ` column ${err.column}` : ''}`);\n\t\t\tconsole.error(err);\n\t\t\tthrow err;\n\t\t}\n\n\t\tif (extension) {\n\t\t\tawait this._extHostLocalizationService.initializeLocalizedMessages(extension);\n\t\t}\n\n\t\t// define commonjs globals: `module`, `exports`, and `require`\n\t\tconst _exports = {};\n\t\tconst _module = { exports: _exports };\n\t\tconst _require = (request: string) => {\n\t\t\tconst result = this._fakeModules!.getModule(request, module);\n\t\t\tif (result === undefined) {\n\t\t\t\tthrow new Error(`Cannot load module '${request}'`);\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\n\t\ttry {\n\t\t\tactivationTimesBuilder.codeLoadingStart();\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/willLoadExtensionCode/${extensionId}`);\n\t\t\t}\n\t\t\tinitFn(_module, _exports, _require);\n\t\t\treturn <T>(_module.exports !== _exports ? _module.exports : _exports);\n\t\t} finally {\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/didLoadExtensionCode/${extensionId}`);\n\t\t\t}\n\t\t\tactivationTimesBuilder.codeLoadingStop();\n\t\t}\n\t}\n\n\tprotected override _loadESMModule<T>(extension: IExtensionDescription | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T> {\n\t\tthrow new Error('ESM modules are not supported in the web worker extension host');\n\t}\n\n\tasync $setRemoteEnvironment(_env: { [key: string]: string | null }): Promise<void> {\n\t\treturn;\n\t}\n\n\tprivate async _waitForDebuggerAttachment(waitTimeout = 5000) {\n\t\t// debugger attaches async, waiting for it fixes #106698 and #99222\n\t\tif (!this._initData.environment.isExtensionDevelopmentDebug) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deadline = Date.now() + waitTimeout;\n\t\twhile (Date.now() < deadline && !('__jsDebugIsReady' in globalThis)) {\n\t\t\tawait timeout(10);\n\t\t}\n\t}\n}\n\nfunction ensureSuffix(path: string, suffix: string): string {\n\tconst extName = extname(path);\n\treturn extName ? path : path + suffix;\n}\n"]}