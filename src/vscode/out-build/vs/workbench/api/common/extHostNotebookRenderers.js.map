{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/common/extHostNotebookRenderers.ts","vs/workbench/api/common/extHostNotebookRenderers.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,OAAO,EAAE,MAAM,+BAA+B,CAAC;AAExD,OAAO,EAA+C,WAAW,EAAoC,MAAM,uBAAuB,CAAC;AAEnI,OAAO,EAAE,qBAAqB,EAAE,MAAM,4BAA4B,CAAC;AAInE,MAAM,OAAO,wBAAwB;IAIpC,YAAY,WAAyB,EAAmB,gBAA2C;QAA3C,qBAAgB,GAAhB,gBAAgB,CAA2B;QAHlF,6BAAwB,GAAG,IAAI,GAAG,EAAyF,CAAC;QAI5I,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,2BAA2B,CAAC,CAAC;IAC5E,CAAC;IAEM,oBAAoB,CAAC,QAAgB,EAAE,UAAkB,EAAE,OAAgB;QACjF,MAAM,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAC7D,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,EAAE,MAAM,EAAE,MAAM,CAAC,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC;IAC5F,CAAC;IAEM,uBAAuB,CAAC,QAA+B,EAAE,UAAkB;QACjF,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,gBAAgB,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,UAAU,CAAC,EAAE,CAAC;YAC7E,MAAM,IAAI,KAAK,CAAC,yFAAyF,UAAU,GAAG,CAAC,CAAC;QACzH,CAAC;QAED,MAAM,SAAS,GAAqC;YACnD,mBAAmB,EAAE,CAAC,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,EAAE;gBACvD,OAAO,IAAI,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,OAAO,EAAE,WAAW,CAAC,CAAC;YACrF,CAAC;YACD,WAAW,EAAE,CAAC,OAAO,EAAE,aAAa,EAAE,EAAE;gBACvC,IAAI,qBAAqB,CAAC,mBAAmB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,+BAA+B;oBAC5F,CAAC,OAAO,EAAE,aAAa,CAAC,GAAG,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;gBACrD,CAAC;gBAED,MAAM,aAAa,GAAG,aAAa,IAAI,qBAAqB,CAAC,mBAAmB,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBACpG,OAAO,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,aAAa,EAAE,EAAE,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC;YACxE,CAAC;SACD,CAAC;QAEF,OAAO,SAAS,CAAC;IAClB,CAAC;IAEO,qBAAqB,CAAC,UAAkB;QAC/C,IAAI,OAAO,GAAG,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QAC5D,IAAI,OAAO,EAAE,CAAC;YACb,OAAO,OAAO,CAAC;QAChB,CAAC;QAED,OAAO,GAAG,IAAI,OAAO,CAAC;YACrB,uBAAuB,EAAE,GAAG,EAAE;gBAC7B,OAAO,EAAE,OAAO,EAAE,CAAC;gBACnB,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;YAClD,CAAC;SACD,CAAC,CAAC;QAEH,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QAEvD,OAAO,OAAO,CAAC;IAChB,CAAC;CACD","file":"extHostNotebookRenderers.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../base/common/event.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtHostNotebookRenderersShape, IMainContext, MainContext, MainThreadNotebookRenderersShape } from './extHost.protocol.js';\nimport { ExtHostNotebookController } from './extHostNotebook.js';\nimport { ExtHostNotebookEditor } from './extHostNotebookEditor.js';\nimport * as vscode from 'vscode';\n\n\nexport class ExtHostNotebookRenderers implements ExtHostNotebookRenderersShape {\n\tprivate readonly _rendererMessageEmitters = new Map<string /* rendererId */, Emitter<{ editor: vscode.NotebookEditor; message: unknown }>>();\n\tprivate readonly proxy: MainThreadNotebookRenderersShape;\n\n\tconstructor(mainContext: IMainContext, private readonly _extHostNotebook: ExtHostNotebookController) {\n\t\tthis.proxy = mainContext.getProxy(MainContext.MainThreadNotebookRenderers);\n\t}\n\n\tpublic $postRendererMessage(editorId: string, rendererId: string, message: unknown): void {\n\t\tconst editor = this._extHostNotebook.getEditorById(editorId);\n\t\tthis._rendererMessageEmitters.get(rendererId)?.fire({ editor: editor.apiEditor, message });\n\t}\n\n\tpublic createRendererMessaging(manifest: IExtensionDescription, rendererId: string): vscode.NotebookRendererMessaging {\n\t\tif (!manifest.contributes?.notebookRenderer?.some(r => r.id === rendererId)) {\n\t\t\tthrow new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${rendererId})`);\n\t\t}\n\n\t\tconst messaging: vscode.NotebookRendererMessaging = {\n\t\t\tonDidReceiveMessage: (listener, thisArg, disposables) => {\n\t\t\t\treturn this.getOrCreateEmitterFor(rendererId).event(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tpostMessage: (message, editorOrAlias) => {\n\t\t\t\tif (ExtHostNotebookEditor.apiEditorsToExtHost.has(message)) { // back compat for swapped args\n\t\t\t\t\t[message, editorOrAlias] = [editorOrAlias, message];\n\t\t\t\t}\n\n\t\t\t\tconst extHostEditor = editorOrAlias && ExtHostNotebookEditor.apiEditorsToExtHost.get(editorOrAlias);\n\t\t\t\treturn this.proxy.$postMessage(extHostEditor?.id, rendererId, message);\n\t\t\t},\n\t\t};\n\n\t\treturn messaging;\n\t}\n\n\tprivate getOrCreateEmitterFor(rendererId: string) {\n\t\tlet emitter = this._rendererMessageEmitters.get(rendererId);\n\t\tif (emitter) {\n\t\t\treturn emitter;\n\t\t}\n\n\t\temitter = new Emitter({\n\t\t\tonDidRemoveLastListener: () => {\n\t\t\t\temitter?.dispose();\n\t\t\t\tthis._rendererMessageEmitters.delete(rendererId);\n\t\t\t}\n\t\t});\n\n\t\tthis._rendererMessageEmitters.set(rendererId, emitter);\n\n\t\treturn emitter;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../base/common/event.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtHostNotebookRenderersShape, IMainContext, MainContext, MainThreadNotebookRenderersShape } from './extHost.protocol.js';\nimport { ExtHostNotebookController } from './extHostNotebook.js';\nimport { ExtHostNotebookEditor } from './extHostNotebookEditor.js';\nimport * as vscode from 'vscode';\n\n\nexport class ExtHostNotebookRenderers implements ExtHostNotebookRenderersShape {\n\tprivate readonly _rendererMessageEmitters = new Map<string /* rendererId */, Emitter<{ editor: vscode.NotebookEditor; message: unknown }>>();\n\tprivate readonly proxy: MainThreadNotebookRenderersShape;\n\n\tconstructor(mainContext: IMainContext, private readonly _extHostNotebook: ExtHostNotebookController) {\n\t\tthis.proxy = mainContext.getProxy(MainContext.MainThreadNotebookRenderers);\n\t}\n\n\tpublic $postRendererMessage(editorId: string, rendererId: string, message: unknown): void {\n\t\tconst editor = this._extHostNotebook.getEditorById(editorId);\n\t\tthis._rendererMessageEmitters.get(rendererId)?.fire({ editor: editor.apiEditor, message });\n\t}\n\n\tpublic createRendererMessaging(manifest: IExtensionDescription, rendererId: string): vscode.NotebookRendererMessaging {\n\t\tif (!manifest.contributes?.notebookRenderer?.some(r => r.id === rendererId)) {\n\t\t\tthrow new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${rendererId})`);\n\t\t}\n\n\t\tconst messaging: vscode.NotebookRendererMessaging = {\n\t\t\tonDidReceiveMessage: (listener, thisArg, disposables) => {\n\t\t\t\treturn this.getOrCreateEmitterFor(rendererId).event(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tpostMessage: (message, editorOrAlias) => {\n\t\t\t\tif (ExtHostNotebookEditor.apiEditorsToExtHost.has(message)) { // back compat for swapped args\n\t\t\t\t\t[message, editorOrAlias] = [editorOrAlias, message];\n\t\t\t\t}\n\n\t\t\t\tconst extHostEditor = editorOrAlias && ExtHostNotebookEditor.apiEditorsToExtHost.get(editorOrAlias);\n\t\t\t\treturn this.proxy.$postMessage(extHostEditor?.id, rendererId, message);\n\t\t\t},\n\t\t};\n\n\t\treturn messaging;\n\t}\n\n\tprivate getOrCreateEmitterFor(rendererId: string) {\n\t\tlet emitter = this._rendererMessageEmitters.get(rendererId);\n\t\tif (emitter) {\n\t\t\treturn emitter;\n\t\t}\n\n\t\temitter = new Emitter({\n\t\t\tonDidRemoveLastListener: () => {\n\t\t\t\temitter?.dispose();\n\t\t\t\tthis._rendererMessageEmitters.delete(rendererId);\n\t\t\t}\n\t\t});\n\n\t\tthis._rendererMessageEmitters.set(rendererId, emitter);\n\n\t\treturn emitter;\n\t}\n}\n"]}