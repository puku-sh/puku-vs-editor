{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/common/extHostChatOutputRenderer.ts","vs/workbench/api/common/extHostChatOutputRenderer.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAIhG,OAAO,EAAgD,WAAW,EAAqC,MAAM,uBAAuB,CAAC;AACrI,OAAO,EAAE,UAAU,EAAE,MAAM,mBAAmB,CAAC;AAK/C,MAAM,OAAO,yBAAyB;IASrC,YACC,WAAyB,EACR,QAAyB;QAAzB,aAAQ,GAAR,QAAQ,CAAiB;QAP1B,eAAU,GAAG,IAAI,GAAG,EAGjC,CAAC;QAMJ,IAAI,CAAC,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,4BAA4B,CAAC,CAAC;IAC9E,CAAC;IAED,0BAA0B,CAAC,SAAgC,EAAE,QAAgB,EAAE,QAAmC;QACjH,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC;YACnC,MAAM,IAAI,KAAK,CAAC,gDAAgD,QAAQ,EAAE,CAAC,CAAC;QAC7E,CAAC;QAED,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAC,CAAC;QACvD,IAAI,CAAC,MAAM,CAAC,2BAA2B,CAAC,QAAQ,EAAE,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC,iBAAiB,CAAC,CAAC;QAErG,OAAO,IAAI,UAAU,CAAC,GAAG,EAAE;YAC1B,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACjC,IAAI,CAAC,MAAM,CAAC,6BAA6B,CAAC,QAAQ,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,QAAgB,EAAE,IAAY,EAAE,SAAmB,EAAE,aAAqB,EAAE,KAAwB;QAC3H,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,EAAE,CAAC;YACZ,MAAM,IAAI,KAAK,CAAC,2CAA2C,QAAQ,EAAE,CAAC,CAAC;QACxE,CAAC;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,EAAE,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;QACnF,OAAO,KAAK,CAAC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,KAAK,CAAC,CAAC;IAC9G,CAAC;CACD","file":"extHostChatOutputRenderer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ExtHostChatOutputRendererShape, IMainContext, MainContext, MainThreadChatOutputRendererShape } from './extHost.protocol.js';\nimport { Disposable } from './extHostTypes.js';\nimport { ExtHostWebviews } from './extHostWebview.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\n\nexport class ExtHostChatOutputRenderer implements ExtHostChatOutputRendererShape {\n\n\tprivate readonly _proxy: MainThreadChatOutputRendererShape;\n\n\tprivate readonly _renderers = new Map</*viewType*/ string, {\n\t\treadonly renderer: vscode.ChatOutputRenderer;\n\t\treadonly extension: IExtensionDescription;\n\t}>();\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly webviews: ExtHostWebviews,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadChatOutputRenderer);\n\t}\n\n\tregisterChatOutputRenderer(extension: IExtensionDescription, viewType: string, renderer: vscode.ChatOutputRenderer): vscode.Disposable {\n\t\tif (this._renderers.has(viewType)) {\n\t\t\tthrow new Error(`Chat output renderer already registered for: ${viewType}`);\n\t\t}\n\n\t\tthis._renderers.set(viewType, { extension, renderer });\n\t\tthis._proxy.$registerChatOutputRenderer(viewType, extension.identifier, extension.extensionLocation);\n\n\t\treturn new Disposable(() => {\n\t\t\tthis._renderers.delete(viewType);\n\t\t\tthis._proxy.$unregisterChatOutputRenderer(viewType);\n\t\t});\n\t}\n\n\tasync $renderChatOutput(viewType: string, mime: string, valueData: VSBuffer, webviewHandle: string, token: CancellationToken): Promise<void> {\n\t\tconst entry = this._renderers.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No chat output renderer registered for: ${viewType}`);\n\t\t}\n\n\t\tconst webview = this.webviews.createNewWebview(webviewHandle, {}, entry.extension);\n\t\treturn entry.renderer.renderChatOutput(Object.freeze({ mime, value: valueData.buffer }), webview, {}, token);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ExtHostChatOutputRendererShape, IMainContext, MainContext, MainThreadChatOutputRendererShape } from './extHost.protocol.js';\nimport { Disposable } from './extHostTypes.js';\nimport { ExtHostWebviews } from './extHostWebview.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { VSBuffer } from '../../../base/common/buffer.js';\n\nexport class ExtHostChatOutputRenderer implements ExtHostChatOutputRendererShape {\n\n\tprivate readonly _proxy: MainThreadChatOutputRendererShape;\n\n\tprivate readonly _renderers = new Map</*viewType*/ string, {\n\t\treadonly renderer: vscode.ChatOutputRenderer;\n\t\treadonly extension: IExtensionDescription;\n\t}>();\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly webviews: ExtHostWebviews,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadChatOutputRenderer);\n\t}\n\n\tregisterChatOutputRenderer(extension: IExtensionDescription, viewType: string, renderer: vscode.ChatOutputRenderer): vscode.Disposable {\n\t\tif (this._renderers.has(viewType)) {\n\t\t\tthrow new Error(`Chat output renderer already registered for: ${viewType}`);\n\t\t}\n\n\t\tthis._renderers.set(viewType, { extension, renderer });\n\t\tthis._proxy.$registerChatOutputRenderer(viewType, extension.identifier, extension.extensionLocation);\n\n\t\treturn new Disposable(() => {\n\t\t\tthis._renderers.delete(viewType);\n\t\t\tthis._proxy.$unregisterChatOutputRenderer(viewType);\n\t\t});\n\t}\n\n\tasync $renderChatOutput(viewType: string, mime: string, valueData: VSBuffer, webviewHandle: string, token: CancellationToken): Promise<void> {\n\t\tconst entry = this._renderers.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No chat output renderer registered for: ${viewType}`);\n\t\t}\n\n\t\tconst webview = this.webviews.createNewWebview(webviewHandle, {}, entry.extension);\n\t\treturn entry.renderer.renderChatOutput(Object.freeze({ mime, value: valueData.buffer }), webview, {}, token);\n\t}\n}\n"]}