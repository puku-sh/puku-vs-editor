{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/common/extHostTextEditor.ts","vs/workbench/api/common/extHostTextEditor.ts"],"names":[],"mappings":"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","file":"extHostTextEditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ok } from '../../../base/common/assert.js';\nimport { ReadonlyError, illegalArgument } from '../../../base/common/errors.js';\nimport { IdGenerator } from '../../../base/common/idGenerator.js';\nimport { TextEditorCursorStyle } from '../../../editor/common/config/editorOptions.js';\nimport { IRange } from '../../../editor/common/core/range.js';\nimport { ISingleEditOperation } from '../../../editor/common/core/editOperation.js';\nimport { IResolvedTextEditorConfiguration, ITextEditorConfigurationUpdate, MainThreadTextEditorsShape } from './extHost.protocol.js';\nimport * as TypeConverters from './extHostTypeConverters.js';\nimport { EndOfLine, Position, Range, Selection, SnippetString, TextEditorLineNumbersStyle, TextEditorRevealType } from './extHostTypes.js';\nimport type * as vscode from 'vscode';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { Lazy } from '../../../base/common/lazy.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\n\nexport class TextEditorDecorationType {\n\n\tprivate static readonly _Keys = new IdGenerator('TextEditorDecorationType');\n\n\treadonly value: vscode.TextEditorDecorationType;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, extension: IExtensionDescription, options: vscode.DecorationRenderOptions) {\n\t\tconst key = TextEditorDecorationType._Keys.nextId();\n\t\tproxy.$registerTextEditorDecorationType(extension.identifier, key, TypeConverters.DecorationRenderOptions.from(options));\n\t\tthis.value = Object.freeze({\n\t\t\tkey,\n\t\t\tdispose() {\n\t\t\t\tproxy.$removeTextEditorDecorationType(key);\n\t\t\t}\n\t\t});\n\t}\n\n}\n\nexport interface ITextEditOperation {\n\trange: vscode.Range;\n\ttext: string | null;\n\tforceMoveMarkers: boolean;\n}\n\nexport interface IEditData {\n\tdocumentVersionId: number;\n\tedits: ITextEditOperation[];\n\tsetEndOfLine: EndOfLine | undefined;\n\tundoStopBefore: boolean;\n\tundoStopAfter: boolean;\n}\n\nclass TextEditorEdit {\n\n\tprivate readonly _document: vscode.TextDocument;\n\tprivate readonly _documentVersionId: number;\n\tprivate readonly _undoStopBefore: boolean;\n\tprivate readonly _undoStopAfter: boolean;\n\tprivate _collectedEdits: ITextEditOperation[] = [];\n\tprivate _setEndOfLine: EndOfLine | undefined = undefined;\n\tprivate _finalized: boolean = false;\n\n\tconstructor(document: vscode.TextDocument, options: { undoStopBefore: boolean; undoStopAfter: boolean }) {\n\t\tthis._document = document;\n\t\tthis._documentVersionId = document.version;\n\t\tthis._undoStopBefore = options.undoStopBefore;\n\t\tthis._undoStopAfter = options.undoStopAfter;\n\t}\n\n\tfinalize(): IEditData {\n\t\tthis._finalized = true;\n\t\treturn {\n\t\t\tdocumentVersionId: this._documentVersionId,\n\t\t\tedits: this._collectedEdits,\n\t\t\tsetEndOfLine: this._setEndOfLine,\n\t\t\tundoStopBefore: this._undoStopBefore,\n\t\t\tundoStopAfter: this._undoStopAfter\n\t\t};\n\t}\n\n\tprivate _throwIfFinalized() {\n\t\tif (this._finalized) {\n\t\t\tthrow new Error('Edit is only valid while callback runs');\n\t\t}\n\t}\n\n\treplace(location: Position | Range | Selection, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Position) {\n\t\t\trange = new Range(location, location);\n\t\t} else if (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, value, false);\n\t}\n\n\tinsert(location: Position, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tthis._pushEdit(new Range(location, location), value, true);\n\t}\n\n\tdelete(location: Range | Selection): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, null, true);\n\t}\n\n\tprivate _pushEdit(range: Range, text: string | null, forceMoveMarkers: boolean): void {\n\t\tconst validRange = this._document.validateRange(range);\n\t\tthis._collectedEdits.push({\n\t\t\trange: validRange,\n\t\t\ttext: text,\n\t\t\tforceMoveMarkers: forceMoveMarkers\n\t\t});\n\t}\n\n\tsetEndOfLine(endOfLine: EndOfLine): void {\n\t\tthis._throwIfFinalized();\n\t\tif (endOfLine !== EndOfLine.LF && endOfLine !== EndOfLine.CRLF) {\n\t\t\tthrow illegalArgument('endOfLine');\n\t\t}\n\n\t\tthis._setEndOfLine = endOfLine;\n\t}\n}\n\nexport class ExtHostTextEditorOptions {\n\n\tprivate _proxy: MainThreadTextEditorsShape;\n\tprivate _id: string;\n\tprivate _logService: ILogService;\n\n\tprivate _tabSize!: number;\n\tprivate _indentSize!: number;\n\tprivate _originalIndentSize!: number | 'tabSize';\n\tprivate _insertSpaces!: boolean;\n\tprivate _cursorStyle!: TextEditorCursorStyle;\n\tprivate _lineNumbers!: TextEditorLineNumbersStyle;\n\n\treadonly value: vscode.TextEditorOptions;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, id: string, source: IResolvedTextEditorConfiguration, logService: ILogService) {\n\t\tthis._proxy = proxy;\n\t\tthis._id = id;\n\t\tthis._accept(source);\n\t\tthis._logService = logService;\n\n\t\tconst that = this;\n\n\t\tthis.value = {\n\t\t\tget tabSize(): number | string {\n\t\t\t\treturn that._tabSize;\n\t\t\t},\n\t\t\tset tabSize(value: number | string) {\n\t\t\t\tthat._setTabSize(value);\n\t\t\t},\n\t\t\tget indentSize(): number | string {\n\t\t\t\treturn that._indentSize;\n\t\t\t},\n\t\t\tset indentSize(value: number | string) {\n\t\t\t\tthat._setIndentSize(value);\n\t\t\t},\n\t\t\tget insertSpaces(): boolean | string {\n\t\t\t\treturn that._insertSpaces;\n\t\t\t},\n\t\t\tset insertSpaces(value: boolean | string) {\n\t\t\t\tthat._setInsertSpaces(value);\n\t\t\t},\n\t\t\tget cursorStyle(): TextEditorCursorStyle {\n\t\t\t\treturn that._cursorStyle;\n\t\t\t},\n\t\t\tset cursorStyle(value: TextEditorCursorStyle) {\n\t\t\t\tthat._setCursorStyle(value);\n\t\t\t},\n\t\t\tget lineNumbers(): TextEditorLineNumbersStyle {\n\t\t\t\treturn that._lineNumbers;\n\t\t\t},\n\t\t\tset lineNumbers(value: TextEditorLineNumbersStyle) {\n\t\t\t\tthat._setLineNumbers(value);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic _accept(source: IResolvedTextEditorConfiguration): void {\n\t\tthis._tabSize = source.tabSize;\n\t\tthis._indentSize = source.indentSize;\n\t\tthis._originalIndentSize = source.originalIndentSize;\n\t\tthis._insertSpaces = source.insertSpaces;\n\t\tthis._cursorStyle = source.cursorStyle;\n\t\tthis._lineNumbers = TypeConverters.TextEditorLineNumbersStyle.to(source.lineNumbers);\n\t}\n\n\t// --- internal: tabSize\n\n\tprivate _validateTabSize(value: number | string): number | 'auto' | null {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\tif (typeof value === 'number') {\n\t\t\tconst r = Math.floor(value);\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\tif (typeof value === 'string') {\n\t\t\tconst r = parseInt(value, 10);\n\t\t\tif (isNaN(r)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _setTabSize(value: number | string) {\n\t\tconst tabSize = this._validateTabSize(value);\n\t\tif (tabSize === null) {\n\t\t\t// ignore invalid call\n\t\t\treturn;\n\t\t}\n\t\tif (typeof tabSize === 'number') {\n\t\t\tif (this._tabSize === tabSize) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new tabSize value immediately\n\t\t\tthis._tabSize = tabSize;\n\t\t}\n\t\tthis._warnOnError('setTabSize', this._proxy.$trySetOptions(this._id, {\n\t\t\ttabSize: tabSize\n\t\t}));\n\t}\n\n\t// --- internal: indentSize\n\n\tprivate _validateIndentSize(value: number | string): number | 'tabSize' | null {\n\t\tif (value === 'tabSize') {\n\t\t\treturn 'tabSize';\n\t\t}\n\t\tif (typeof value === 'number') {\n\t\t\tconst r = Math.floor(value);\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\tif (typeof value === 'string') {\n\t\t\tconst r = parseInt(value, 10);\n\t\t\tif (isNaN(r)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _setIndentSize(value: number | string) {\n\t\tconst indentSize = this._validateIndentSize(value);\n\t\tif (indentSize === null) {\n\t\t\t// ignore invalid call\n\t\t\treturn;\n\t\t}\n\t\tif (typeof indentSize === 'number') {\n\t\t\tif (this._originalIndentSize === indentSize) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new indentSize value immediately\n\t\t\tthis._indentSize = indentSize;\n\t\t\tthis._originalIndentSize = indentSize;\n\t\t}\n\t\tthis._warnOnError('setIndentSize', this._proxy.$trySetOptions(this._id, {\n\t\t\tindentSize: indentSize\n\t\t}));\n\t}\n\n\t// --- internal: insert spaces\n\n\tprivate _validateInsertSpaces(value: boolean | string): boolean | 'auto' {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\treturn (value === 'false' ? false : Boolean(value));\n\t}\n\n\tprivate _setInsertSpaces(value: boolean | string) {\n\t\tconst insertSpaces = this._validateInsertSpaces(value);\n\t\tif (typeof insertSpaces === 'boolean') {\n\t\t\tif (this._insertSpaces === insertSpaces) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new insertSpaces value immediately\n\t\t\tthis._insertSpaces = insertSpaces;\n\t\t}\n\t\tthis._warnOnError('setInsertSpaces', this._proxy.$trySetOptions(this._id, {\n\t\t\tinsertSpaces: insertSpaces\n\t\t}));\n\t}\n\n\t// --- internal: cursor style\n\n\tprivate _setCursorStyle(value: TextEditorCursorStyle) {\n\t\tif (this._cursorStyle === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._cursorStyle = value;\n\t\tthis._warnOnError('setCursorStyle', this._proxy.$trySetOptions(this._id, {\n\t\t\tcursorStyle: value\n\t\t}));\n\t}\n\n\t// --- internal: line number\n\n\tprivate _setLineNumbers(value: TextEditorLineNumbersStyle) {\n\t\tif (this._lineNumbers === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._lineNumbers = value;\n\t\tthis._warnOnError('setLineNumbers', this._proxy.$trySetOptions(this._id, {\n\t\t\tlineNumbers: TypeConverters.TextEditorLineNumbersStyle.from(value)\n\t\t}));\n\t}\n\n\tpublic assign(newOptions: vscode.TextEditorOptions) {\n\t\tconst bulkConfigurationUpdate: ITextEditorConfigurationUpdate = {};\n\t\tlet hasUpdate = false;\n\n\t\tif (typeof newOptions.tabSize !== 'undefined') {\n\t\t\tconst tabSize = this._validateTabSize(newOptions.tabSize);\n\t\t\tif (tabSize === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t} else if (typeof tabSize === 'number' && this._tabSize !== tabSize) {\n\t\t\t\t// reflect the new tabSize value immediately\n\t\t\t\tthis._tabSize = tabSize;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.indentSize !== 'undefined') {\n\t\t\tconst indentSize = this._validateIndentSize(newOptions.indentSize);\n\t\t\tif (indentSize === 'tabSize') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t\t} else if (typeof indentSize === 'number' && this._originalIndentSize !== indentSize) {\n\t\t\t\t// reflect the new indentSize value immediately\n\t\t\t\tthis._indentSize = indentSize;\n\t\t\t\tthis._originalIndentSize = indentSize;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.insertSpaces !== 'undefined') {\n\t\t\tconst insertSpaces = this._validateInsertSpaces(newOptions.insertSpaces);\n\t\t\tif (insertSpaces === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t} else if (this._insertSpaces !== insertSpaces) {\n\t\t\t\t// reflect the new insertSpaces value immediately\n\t\t\t\tthis._insertSpaces = insertSpaces;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.cursorStyle !== 'undefined') {\n\t\t\tif (this._cursorStyle !== newOptions.cursorStyle) {\n\t\t\t\tthis._cursorStyle = newOptions.cursorStyle;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.cursorStyle = newOptions.cursorStyle;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.lineNumbers !== 'undefined') {\n\t\t\tif (this._lineNumbers !== newOptions.lineNumbers) {\n\t\t\t\tthis._lineNumbers = newOptions.lineNumbers;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.lineNumbers = TypeConverters.TextEditorLineNumbersStyle.from(newOptions.lineNumbers);\n\t\t\t}\n\t\t}\n\n\t\tif (hasUpdate) {\n\t\t\tthis._warnOnError('setOptions', this._proxy.$trySetOptions(this._id, bulkConfigurationUpdate));\n\t\t}\n\t}\n\n\tprivate _warnOnError(action: string, promise: Promise<any>): void {\n\t\tpromise.catch(err => {\n\t\t\tthis._logService.warn(`ExtHostTextEditorOptions '${action}' failed:'`);\n\t\t\tthis._logService.warn(err);\n\t\t});\n\t}\n}\n\nexport class ExtHostTextEditor {\n\n\tprivate _selections: Selection[];\n\tprivate _options: ExtHostTextEditorOptions;\n\tprivate _visibleRanges: Range[];\n\tprivate _viewColumn: vscode.ViewColumn | undefined;\n\tprivate _disposed: boolean = false;\n\tprivate _hasDecorationsForKey = new Set<string>();\n\tprivate _diffInformation: vscode.TextEditorDiffInformation[] | undefined;\n\n\treadonly value: vscode.TextEditor;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tprivate readonly _proxy: MainThreadTextEditorsShape,\n\t\tprivate readonly _logService: ILogService,\n\t\tdocument: Lazy<vscode.TextDocument>,\n\t\tselections: Selection[], options: IResolvedTextEditorConfiguration,\n\t\tvisibleRanges: Range[], viewColumn: vscode.ViewColumn | undefined\n\t) {\n\t\tthis._selections = selections;\n\t\tthis._options = new ExtHostTextEditorOptions(this._proxy, this.id, options, _logService);\n\t\tthis._visibleRanges = visibleRanges;\n\t\tthis._viewColumn = viewColumn;\n\n\t\tconst that = this;\n\n\t\tthis.value = Object.freeze({\n\t\t\tget document(): vscode.TextDocument {\n\t\t\t\treturn document.value;\n\t\t\t},\n\t\t\tset document(_value) {\n\t\t\t\tthrow new ReadonlyError('document');\n\t\t\t},\n\t\t\t// --- selection\n\t\t\tget selection(): Selection {\n\t\t\t\treturn that._selections && that._selections[0];\n\t\t\t},\n\t\t\tset selection(value: Selection) {\n\t\t\t\tif (!(value instanceof Selection)) {\n\t\t\t\t\tthrow illegalArgument('selection');\n\t\t\t\t}\n\t\t\t\tthat._selections = [value];\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\tget selections(): Selection[] {\n\t\t\t\treturn that._selections;\n\t\t\t},\n\t\t\tset selections(value: Selection[]) {\n\t\t\t\tif (!Array.isArray(value) || value.some(a => !(a instanceof Selection))) {\n\t\t\t\t\tthrow illegalArgument('selections');\n\t\t\t\t}\n\t\t\t\tif (value.length === 0) {\n\t\t\t\t\tvalue = [new Selection(0, 0, 0, 0)];\n\t\t\t\t}\n\t\t\t\tthat._selections = value;\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\t// --- visible ranges\n\t\t\tget visibleRanges(): Range[] {\n\t\t\t\treturn that._visibleRanges;\n\t\t\t},\n\t\t\tset visibleRanges(_value: Range[]) {\n\t\t\t\tthrow new ReadonlyError('visibleRanges');\n\t\t\t},\n\t\t\tget diffInformation() {\n\t\t\t\treturn that._diffInformation;\n\t\t\t},\n\t\t\t// --- options\n\t\t\tget options(): vscode.TextEditorOptions {\n\t\t\t\treturn that._options.value;\n\t\t\t},\n\t\t\tset options(value: vscode.TextEditorOptions) {\n\t\t\t\tif (!that._disposed) {\n\t\t\t\t\tthat._options.assign(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// --- view column\n\t\t\tget viewColumn(): vscode.ViewColumn | undefined {\n\t\t\t\treturn that._viewColumn;\n\t\t\t},\n\t\t\tset viewColumn(_value) {\n\t\t\t\tthrow new ReadonlyError('viewColumn');\n\t\t\t},\n\t\t\t// --- edit\n\t\t\tedit(callback: (edit: TextEditorEdit) => void, options: { undoStopBefore: boolean; undoStopAfter: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#edit not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tconst edit = new TextEditorEdit(document.value, options);\n\t\t\t\tcallback(edit);\n\t\t\t\treturn that._applyEdit(edit);\n\t\t\t},\n\t\t\t// --- snippet edit\n\t\t\tinsertSnippet(snippet: SnippetString, where?: Position | readonly Position[] | Range | readonly Range[], options: { undoStopBefore: boolean; undoStopAfter: boolean; keepWhitespace?: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#insertSnippet not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tlet ranges: IRange[];\n\n\t\t\t\tif (!where || (Array.isArray(where) && where.length === 0)) {\n\t\t\t\t\tranges = that._selections.map(range => TypeConverters.Range.from(range));\n\n\t\t\t\t} else if (where instanceof Position) {\n\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(where);\n\t\t\t\t\tranges = [{ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column }];\n\n\t\t\t\t} else if (where instanceof Range) {\n\t\t\t\t\tranges = [TypeConverters.Range.from(where)];\n\t\t\t\t} else {\n\t\t\t\t\tranges = [];\n\t\t\t\t\tfor (const posOrRange of where) {\n\t\t\t\t\t\tif (posOrRange instanceof Range) {\n\t\t\t\t\t\t\tranges.push(TypeConverters.Range.from(posOrRange));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(posOrRange);\n\t\t\t\t\t\t\tranges.push({ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (options.keepWhitespace === undefined) {\n\t\t\t\t\toptions.keepWhitespace = false;\n\t\t\t\t}\n\t\t\t\treturn _proxy.$tryInsertSnippet(id, document.value.version, snippet.value, ranges, options);\n\t\t\t},\n\t\t\tsetDecorations(decorationType: vscode.TextEditorDecorationType, ranges: Range[] | vscode.DecorationOptions[]): void {\n\t\t\t\tconst willBeEmpty = (ranges.length === 0);\n\t\t\t\tif (willBeEmpty && !that._hasDecorationsForKey.has(decorationType.key)) {\n\t\t\t\t\t// avoid no-op call to the renderer\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (willBeEmpty) {\n\t\t\t\t\tthat._hasDecorationsForKey.delete(decorationType.key);\n\t\t\t\t} else {\n\t\t\t\t\tthat._hasDecorationsForKey.add(decorationType.key);\n\t\t\t\t}\n\t\t\t\tthat._runOnProxy(() => {\n\t\t\t\t\tif (TypeConverters.isDecorationOptionsArr(ranges)) {\n\t\t\t\t\t\treturn _proxy.$trySetDecorations(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\tTypeConverters.fromRangeOrRangeWithMessage(ranges)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst _ranges: number[] = new Array<number>(4 * ranges.length);\n\t\t\t\t\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\t\t\t\t\tconst range = ranges[i];\n\t\t\t\t\t\t\t_ranges[4 * i] = range.start.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 1] = range.start.character + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 2] = range.end.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 3] = range.end.character + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn _proxy.$trySetDecorationsFast(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\t_ranges\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\trevealRange(range: Range, revealType: vscode.TextEditorRevealType): void {\n\t\t\t\tthat._runOnProxy(() => _proxy.$tryRevealRange(\n\t\t\t\t\tid,\n\t\t\t\t\tTypeConverters.Range.from(range),\n\t\t\t\t\t(revealType || TextEditorRevealType.Default)\n\t\t\t\t));\n\t\t\t},\n\t\t\tshow(column: vscode.ViewColumn) {\n\t\t\t\t_proxy.$tryShowEditor(id, TypeConverters.ViewColumn.from(column));\n\t\t\t},\n\t\t\thide() {\n\t\t\t\t_proxy.$tryHideEditor(id);\n\t\t\t},\n\t\t\t[Symbol.for('debug.description')]() {\n\t\t\t\treturn `TextEditor(${this.document.uri.toString()})`;\n\t\t\t}\n\t\t});\n\t}\n\n\tdispose() {\n\t\tok(!this._disposed);\n\t\tthis._disposed = true;\n\t}\n\n\t// --- incoming: extension host MUST accept what the renderer says\n\n\t_acceptOptions(options: IResolvedTextEditorConfiguration): void {\n\t\tok(!this._disposed);\n\t\tthis._options._accept(options);\n\t}\n\n\t_acceptVisibleRanges(value: Range[]): void {\n\t\tok(!this._disposed);\n\t\tthis._visibleRanges = value;\n\t}\n\n\t_acceptViewColumn(value: vscode.ViewColumn) {\n\t\tok(!this._disposed);\n\t\tthis._viewColumn = value;\n\t}\n\n\t_acceptSelections(selections: Selection[]): void {\n\t\tok(!this._disposed);\n\t\tthis._selections = selections;\n\t}\n\n\t_acceptDiffInformation(diffInformation: vscode.TextEditorDiffInformation[] | undefined): void {\n\t\tok(!this._disposed);\n\t\tthis._diffInformation = diffInformation;\n\t}\n\n\tprivate async _trySetSelection(): Promise<vscode.TextEditor | null | undefined> {\n\t\tconst selection = this._selections.map(TypeConverters.Selection.from);\n\t\tawait this._runOnProxy(() => this._proxy.$trySetSelections(this.id, selection));\n\t\treturn this.value;\n\t}\n\n\tprivate _applyEdit(editBuilder: TextEditorEdit): Promise<boolean> {\n\t\tconst editData = editBuilder.finalize();\n\n\t\t// return when there is nothing to do\n\t\tif (editData.edits.length === 0 && !editData.setEndOfLine) {\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\t// check that the edits are not overlapping (i.e. illegal)\n\t\tconst editRanges = editData.edits.map(edit => edit.range);\n\n\t\t// sort ascending (by end and then by start)\n\t\teditRanges.sort((a, b) => {\n\t\t\tif (a.end.line === b.end.line) {\n\t\t\t\tif (a.end.character === b.end.character) {\n\t\t\t\t\tif (a.start.line === b.start.line) {\n\t\t\t\t\t\treturn a.start.character - b.start.character;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.start.line - b.start.line;\n\t\t\t\t}\n\t\t\t\treturn a.end.character - b.end.character;\n\t\t\t}\n\t\t\treturn a.end.line - b.end.line;\n\t\t});\n\n\t\t// check that no edits are overlapping\n\t\tfor (let i = 0, count = editRanges.length - 1; i < count; i++) {\n\t\t\tconst rangeEnd = editRanges[i].end;\n\t\t\tconst nextRangeStart = editRanges[i + 1].start;\n\n\t\t\tif (nextRangeStart.isBefore(rangeEnd)) {\n\t\t\t\t// overlapping ranges\n\t\t\t\treturn Promise.reject(\n\t\t\t\t\tnew Error('Overlapping ranges are not allowed!')\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// prepare data for serialization\n\t\tconst edits = editData.edits.map((edit): ISingleEditOperation => {\n\t\t\treturn {\n\t\t\t\trange: TypeConverters.Range.from(edit.range),\n\t\t\t\ttext: edit.text,\n\t\t\t\tforceMoveMarkers: edit.forceMoveMarkers\n\t\t\t};\n\t\t});\n\n\t\treturn this._proxy.$tryApplyEdits(this.id, editData.documentVersionId, edits, {\n\t\t\tsetEndOfLine: typeof editData.setEndOfLine === 'number' ? TypeConverters.EndOfLine.from(editData.setEndOfLine) : undefined,\n\t\t\tundoStopBefore: editData.undoStopBefore,\n\t\t\tundoStopAfter: editData.undoStopAfter\n\t\t});\n\t}\n\tprivate _runOnProxy(callback: () => Promise<any>): Promise<ExtHostTextEditor | undefined | null> {\n\t\tif (this._disposed) {\n\t\t\tthis._logService.warn('TextEditor is closed/disposed');\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn callback().then(() => this, err => {\n\t\t\tif (!(err instanceof Error && err.name === 'DISPOSED')) {\n\t\t\t\tthis._logService.warn(err);\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ok } from '../../../base/common/assert.js';\nimport { ReadonlyError, illegalArgument } from '../../../base/common/errors.js';\nimport { IdGenerator } from '../../../base/common/idGenerator.js';\nimport { TextEditorCursorStyle } from '../../../editor/common/config/editorOptions.js';\nimport { IRange } from '../../../editor/common/core/range.js';\nimport { ISingleEditOperation } from '../../../editor/common/core/editOperation.js';\nimport { IResolvedTextEditorConfiguration, ITextEditorConfigurationUpdate, MainThreadTextEditorsShape } from './extHost.protocol.js';\nimport * as TypeConverters from './extHostTypeConverters.js';\nimport { EndOfLine, Position, Range, Selection, SnippetString, TextEditorLineNumbersStyle, TextEditorRevealType } from './extHostTypes.js';\nimport type * as vscode from 'vscode';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { Lazy } from '../../../base/common/lazy.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\n\nexport class TextEditorDecorationType {\n\n\tprivate static readonly _Keys = new IdGenerator('TextEditorDecorationType');\n\n\treadonly value: vscode.TextEditorDecorationType;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, extension: IExtensionDescription, options: vscode.DecorationRenderOptions) {\n\t\tconst key = TextEditorDecorationType._Keys.nextId();\n\t\tproxy.$registerTextEditorDecorationType(extension.identifier, key, TypeConverters.DecorationRenderOptions.from(options));\n\t\tthis.value = Object.freeze({\n\t\t\tkey,\n\t\t\tdispose() {\n\t\t\t\tproxy.$removeTextEditorDecorationType(key);\n\t\t\t}\n\t\t});\n\t}\n\n}\n\nexport interface ITextEditOperation {\n\trange: vscode.Range;\n\ttext: string | null;\n\tforceMoveMarkers: boolean;\n}\n\nexport interface IEditData {\n\tdocumentVersionId: number;\n\tedits: ITextEditOperation[];\n\tsetEndOfLine: EndOfLine | undefined;\n\tundoStopBefore: boolean;\n\tundoStopAfter: boolean;\n}\n\nclass TextEditorEdit {\n\n\tprivate readonly _document: vscode.TextDocument;\n\tprivate readonly _documentVersionId: number;\n\tprivate readonly _undoStopBefore: boolean;\n\tprivate readonly _undoStopAfter: boolean;\n\tprivate _collectedEdits: ITextEditOperation[] = [];\n\tprivate _setEndOfLine: EndOfLine | undefined = undefined;\n\tprivate _finalized: boolean = false;\n\n\tconstructor(document: vscode.TextDocument, options: { undoStopBefore: boolean; undoStopAfter: boolean }) {\n\t\tthis._document = document;\n\t\tthis._documentVersionId = document.version;\n\t\tthis._undoStopBefore = options.undoStopBefore;\n\t\tthis._undoStopAfter = options.undoStopAfter;\n\t}\n\n\tfinalize(): IEditData {\n\t\tthis._finalized = true;\n\t\treturn {\n\t\t\tdocumentVersionId: this._documentVersionId,\n\t\t\tedits: this._collectedEdits,\n\t\t\tsetEndOfLine: this._setEndOfLine,\n\t\t\tundoStopBefore: this._undoStopBefore,\n\t\t\tundoStopAfter: this._undoStopAfter\n\t\t};\n\t}\n\n\tprivate _throwIfFinalized() {\n\t\tif (this._finalized) {\n\t\t\tthrow new Error('Edit is only valid while callback runs');\n\t\t}\n\t}\n\n\treplace(location: Position | Range | Selection, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Position) {\n\t\t\trange = new Range(location, location);\n\t\t} else if (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, value, false);\n\t}\n\n\tinsert(location: Position, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tthis._pushEdit(new Range(location, location), value, true);\n\t}\n\n\tdelete(location: Range | Selection): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, null, true);\n\t}\n\n\tprivate _pushEdit(range: Range, text: string | null, forceMoveMarkers: boolean): void {\n\t\tconst validRange = this._document.validateRange(range);\n\t\tthis._collectedEdits.push({\n\t\t\trange: validRange,\n\t\t\ttext: text,\n\t\t\tforceMoveMarkers: forceMoveMarkers\n\t\t});\n\t}\n\n\tsetEndOfLine(endOfLine: EndOfLine): void {\n\t\tthis._throwIfFinalized();\n\t\tif (endOfLine !== EndOfLine.LF && endOfLine !== EndOfLine.CRLF) {\n\t\t\tthrow illegalArgument('endOfLine');\n\t\t}\n\n\t\tthis._setEndOfLine = endOfLine;\n\t}\n}\n\nexport class ExtHostTextEditorOptions {\n\n\tprivate _proxy: MainThreadTextEditorsShape;\n\tprivate _id: string;\n\tprivate _logService: ILogService;\n\n\tprivate _tabSize!: number;\n\tprivate _indentSize!: number;\n\tprivate _originalIndentSize!: number | 'tabSize';\n\tprivate _insertSpaces!: boolean;\n\tprivate _cursorStyle!: TextEditorCursorStyle;\n\tprivate _lineNumbers!: TextEditorLineNumbersStyle;\n\n\treadonly value: vscode.TextEditorOptions;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, id: string, source: IResolvedTextEditorConfiguration, logService: ILogService) {\n\t\tthis._proxy = proxy;\n\t\tthis._id = id;\n\t\tthis._accept(source);\n\t\tthis._logService = logService;\n\n\t\tconst that = this;\n\n\t\tthis.value = {\n\t\t\tget tabSize(): number | string {\n\t\t\t\treturn that._tabSize;\n\t\t\t},\n\t\t\tset tabSize(value: number | string) {\n\t\t\t\tthat._setTabSize(value);\n\t\t\t},\n\t\t\tget indentSize(): number | string {\n\t\t\t\treturn that._indentSize;\n\t\t\t},\n\t\t\tset indentSize(value: number | string) {\n\t\t\t\tthat._setIndentSize(value);\n\t\t\t},\n\t\t\tget insertSpaces(): boolean | string {\n\t\t\t\treturn that._insertSpaces;\n\t\t\t},\n\t\t\tset insertSpaces(value: boolean | string) {\n\t\t\t\tthat._setInsertSpaces(value);\n\t\t\t},\n\t\t\tget cursorStyle(): TextEditorCursorStyle {\n\t\t\t\treturn that._cursorStyle;\n\t\t\t},\n\t\t\tset cursorStyle(value: TextEditorCursorStyle) {\n\t\t\t\tthat._setCursorStyle(value);\n\t\t\t},\n\t\t\tget lineNumbers(): TextEditorLineNumbersStyle {\n\t\t\t\treturn that._lineNumbers;\n\t\t\t},\n\t\t\tset lineNumbers(value: TextEditorLineNumbersStyle) {\n\t\t\t\tthat._setLineNumbers(value);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic _accept(source: IResolvedTextEditorConfiguration): void {\n\t\tthis._tabSize = source.tabSize;\n\t\tthis._indentSize = source.indentSize;\n\t\tthis._originalIndentSize = source.originalIndentSize;\n\t\tthis._insertSpaces = source.insertSpaces;\n\t\tthis._cursorStyle = source.cursorStyle;\n\t\tthis._lineNumbers = TypeConverters.TextEditorLineNumbersStyle.to(source.lineNumbers);\n\t}\n\n\t// --- internal: tabSize\n\n\tprivate _validateTabSize(value: number | string): number | 'auto' | null {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\tif (typeof value === 'number') {\n\t\t\tconst r = Math.floor(value);\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\tif (typeof value === 'string') {\n\t\t\tconst r = parseInt(value, 10);\n\t\t\tif (isNaN(r)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _setTabSize(value: number | string) {\n\t\tconst tabSize = this._validateTabSize(value);\n\t\tif (tabSize === null) {\n\t\t\t// ignore invalid call\n\t\t\treturn;\n\t\t}\n\t\tif (typeof tabSize === 'number') {\n\t\t\tif (this._tabSize === tabSize) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new tabSize value immediately\n\t\t\tthis._tabSize = tabSize;\n\t\t}\n\t\tthis._warnOnError('setTabSize', this._proxy.$trySetOptions(this._id, {\n\t\t\ttabSize: tabSize\n\t\t}));\n\t}\n\n\t// --- internal: indentSize\n\n\tprivate _validateIndentSize(value: number | string): number | 'tabSize' | null {\n\t\tif (value === 'tabSize') {\n\t\t\treturn 'tabSize';\n\t\t}\n\t\tif (typeof value === 'number') {\n\t\t\tconst r = Math.floor(value);\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\tif (typeof value === 'string') {\n\t\t\tconst r = parseInt(value, 10);\n\t\t\tif (isNaN(r)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _setIndentSize(value: number | string) {\n\t\tconst indentSize = this._validateIndentSize(value);\n\t\tif (indentSize === null) {\n\t\t\t// ignore invalid call\n\t\t\treturn;\n\t\t}\n\t\tif (typeof indentSize === 'number') {\n\t\t\tif (this._originalIndentSize === indentSize) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new indentSize value immediately\n\t\t\tthis._indentSize = indentSize;\n\t\t\tthis._originalIndentSize = indentSize;\n\t\t}\n\t\tthis._warnOnError('setIndentSize', this._proxy.$trySetOptions(this._id, {\n\t\t\tindentSize: indentSize\n\t\t}));\n\t}\n\n\t// --- internal: insert spaces\n\n\tprivate _validateInsertSpaces(value: boolean | string): boolean | 'auto' {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\treturn (value === 'false' ? false : Boolean(value));\n\t}\n\n\tprivate _setInsertSpaces(value: boolean | string) {\n\t\tconst insertSpaces = this._validateInsertSpaces(value);\n\t\tif (typeof insertSpaces === 'boolean') {\n\t\t\tif (this._insertSpaces === insertSpaces) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new insertSpaces value immediately\n\t\t\tthis._insertSpaces = insertSpaces;\n\t\t}\n\t\tthis._warnOnError('setInsertSpaces', this._proxy.$trySetOptions(this._id, {\n\t\t\tinsertSpaces: insertSpaces\n\t\t}));\n\t}\n\n\t// --- internal: cursor style\n\n\tprivate _setCursorStyle(value: TextEditorCursorStyle) {\n\t\tif (this._cursorStyle === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._cursorStyle = value;\n\t\tthis._warnOnError('setCursorStyle', this._proxy.$trySetOptions(this._id, {\n\t\t\tcursorStyle: value\n\t\t}));\n\t}\n\n\t// --- internal: line number\n\n\tprivate _setLineNumbers(value: TextEditorLineNumbersStyle) {\n\t\tif (this._lineNumbers === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._lineNumbers = value;\n\t\tthis._warnOnError('setLineNumbers', this._proxy.$trySetOptions(this._id, {\n\t\t\tlineNumbers: TypeConverters.TextEditorLineNumbersStyle.from(value)\n\t\t}));\n\t}\n\n\tpublic assign(newOptions: vscode.TextEditorOptions) {\n\t\tconst bulkConfigurationUpdate: ITextEditorConfigurationUpdate = {};\n\t\tlet hasUpdate = false;\n\n\t\tif (typeof newOptions.tabSize !== 'undefined') {\n\t\t\tconst tabSize = this._validateTabSize(newOptions.tabSize);\n\t\t\tif (tabSize === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t} else if (typeof tabSize === 'number' && this._tabSize !== tabSize) {\n\t\t\t\t// reflect the new tabSize value immediately\n\t\t\t\tthis._tabSize = tabSize;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.indentSize !== 'undefined') {\n\t\t\tconst indentSize = this._validateIndentSize(newOptions.indentSize);\n\t\t\tif (indentSize === 'tabSize') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t\t} else if (typeof indentSize === 'number' && this._originalIndentSize !== indentSize) {\n\t\t\t\t// reflect the new indentSize value immediately\n\t\t\t\tthis._indentSize = indentSize;\n\t\t\t\tthis._originalIndentSize = indentSize;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.insertSpaces !== 'undefined') {\n\t\t\tconst insertSpaces = this._validateInsertSpaces(newOptions.insertSpaces);\n\t\t\tif (insertSpaces === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t} else if (this._insertSpaces !== insertSpaces) {\n\t\t\t\t// reflect the new insertSpaces value immediately\n\t\t\t\tthis._insertSpaces = insertSpaces;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.cursorStyle !== 'undefined') {\n\t\t\tif (this._cursorStyle !== newOptions.cursorStyle) {\n\t\t\t\tthis._cursorStyle = newOptions.cursorStyle;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.cursorStyle = newOptions.cursorStyle;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.lineNumbers !== 'undefined') {\n\t\t\tif (this._lineNumbers !== newOptions.lineNumbers) {\n\t\t\t\tthis._lineNumbers = newOptions.lineNumbers;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.lineNumbers = TypeConverters.TextEditorLineNumbersStyle.from(newOptions.lineNumbers);\n\t\t\t}\n\t\t}\n\n\t\tif (hasUpdate) {\n\t\t\tthis._warnOnError('setOptions', this._proxy.$trySetOptions(this._id, bulkConfigurationUpdate));\n\t\t}\n\t}\n\n\tprivate _warnOnError(action: string, promise: Promise<any>): void {\n\t\tpromise.catch(err => {\n\t\t\tthis._logService.warn(`ExtHostTextEditorOptions '${action}' failed:'`);\n\t\t\tthis._logService.warn(err);\n\t\t});\n\t}\n}\n\nexport class ExtHostTextEditor {\n\n\tprivate _selections: Selection[];\n\tprivate _options: ExtHostTextEditorOptions;\n\tprivate _visibleRanges: Range[];\n\tprivate _viewColumn: vscode.ViewColumn | undefined;\n\tprivate _disposed: boolean = false;\n\tprivate _hasDecorationsForKey = new Set<string>();\n\tprivate _diffInformation: vscode.TextEditorDiffInformation[] | undefined;\n\n\treadonly value: vscode.TextEditor;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tprivate readonly _proxy: MainThreadTextEditorsShape,\n\t\tprivate readonly _logService: ILogService,\n\t\tdocument: Lazy<vscode.TextDocument>,\n\t\tselections: Selection[], options: IResolvedTextEditorConfiguration,\n\t\tvisibleRanges: Range[], viewColumn: vscode.ViewColumn | undefined\n\t) {\n\t\tthis._selections = selections;\n\t\tthis._options = new ExtHostTextEditorOptions(this._proxy, this.id, options, _logService);\n\t\tthis._visibleRanges = visibleRanges;\n\t\tthis._viewColumn = viewColumn;\n\n\t\tconst that = this;\n\n\t\tthis.value = Object.freeze({\n\t\t\tget document(): vscode.TextDocument {\n\t\t\t\treturn document.value;\n\t\t\t},\n\t\t\tset document(_value) {\n\t\t\t\tthrow new ReadonlyError('document');\n\t\t\t},\n\t\t\t// --- selection\n\t\t\tget selection(): Selection {\n\t\t\t\treturn that._selections && that._selections[0];\n\t\t\t},\n\t\t\tset selection(value: Selection) {\n\t\t\t\tif (!(value instanceof Selection)) {\n\t\t\t\t\tthrow illegalArgument('selection');\n\t\t\t\t}\n\t\t\t\tthat._selections = [value];\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\tget selections(): Selection[] {\n\t\t\t\treturn that._selections;\n\t\t\t},\n\t\t\tset selections(value: Selection[]) {\n\t\t\t\tif (!Array.isArray(value) || value.some(a => !(a instanceof Selection))) {\n\t\t\t\t\tthrow illegalArgument('selections');\n\t\t\t\t}\n\t\t\t\tif (value.length === 0) {\n\t\t\t\t\tvalue = [new Selection(0, 0, 0, 0)];\n\t\t\t\t}\n\t\t\t\tthat._selections = value;\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\t// --- visible ranges\n\t\t\tget visibleRanges(): Range[] {\n\t\t\t\treturn that._visibleRanges;\n\t\t\t},\n\t\t\tset visibleRanges(_value: Range[]) {\n\t\t\t\tthrow new ReadonlyError('visibleRanges');\n\t\t\t},\n\t\t\tget diffInformation() {\n\t\t\t\treturn that._diffInformation;\n\t\t\t},\n\t\t\t// --- options\n\t\t\tget options(): vscode.TextEditorOptions {\n\t\t\t\treturn that._options.value;\n\t\t\t},\n\t\t\tset options(value: vscode.TextEditorOptions) {\n\t\t\t\tif (!that._disposed) {\n\t\t\t\t\tthat._options.assign(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// --- view column\n\t\t\tget viewColumn(): vscode.ViewColumn | undefined {\n\t\t\t\treturn that._viewColumn;\n\t\t\t},\n\t\t\tset viewColumn(_value) {\n\t\t\t\tthrow new ReadonlyError('viewColumn');\n\t\t\t},\n\t\t\t// --- edit\n\t\t\tedit(callback: (edit: TextEditorEdit) => void, options: { undoStopBefore: boolean; undoStopAfter: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#edit not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tconst edit = new TextEditorEdit(document.value, options);\n\t\t\t\tcallback(edit);\n\t\t\t\treturn that._applyEdit(edit);\n\t\t\t},\n\t\t\t// --- snippet edit\n\t\t\tinsertSnippet(snippet: SnippetString, where?: Position | readonly Position[] | Range | readonly Range[], options: { undoStopBefore: boolean; undoStopAfter: boolean; keepWhitespace?: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#insertSnippet not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tlet ranges: IRange[];\n\n\t\t\t\tif (!where || (Array.isArray(where) && where.length === 0)) {\n\t\t\t\t\tranges = that._selections.map(range => TypeConverters.Range.from(range));\n\n\t\t\t\t} else if (where instanceof Position) {\n\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(where);\n\t\t\t\t\tranges = [{ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column }];\n\n\t\t\t\t} else if (where instanceof Range) {\n\t\t\t\t\tranges = [TypeConverters.Range.from(where)];\n\t\t\t\t} else {\n\t\t\t\t\tranges = [];\n\t\t\t\t\tfor (const posOrRange of where) {\n\t\t\t\t\t\tif (posOrRange instanceof Range) {\n\t\t\t\t\t\t\tranges.push(TypeConverters.Range.from(posOrRange));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(posOrRange);\n\t\t\t\t\t\t\tranges.push({ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (options.keepWhitespace === undefined) {\n\t\t\t\t\toptions.keepWhitespace = false;\n\t\t\t\t}\n\t\t\t\treturn _proxy.$tryInsertSnippet(id, document.value.version, snippet.value, ranges, options);\n\t\t\t},\n\t\t\tsetDecorations(decorationType: vscode.TextEditorDecorationType, ranges: Range[] | vscode.DecorationOptions[]): void {\n\t\t\t\tconst willBeEmpty = (ranges.length === 0);\n\t\t\t\tif (willBeEmpty && !that._hasDecorationsForKey.has(decorationType.key)) {\n\t\t\t\t\t// avoid no-op call to the renderer\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (willBeEmpty) {\n\t\t\t\t\tthat._hasDecorationsForKey.delete(decorationType.key);\n\t\t\t\t} else {\n\t\t\t\t\tthat._hasDecorationsForKey.add(decorationType.key);\n\t\t\t\t}\n\t\t\t\tthat._runOnProxy(() => {\n\t\t\t\t\tif (TypeConverters.isDecorationOptionsArr(ranges)) {\n\t\t\t\t\t\treturn _proxy.$trySetDecorations(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\tTypeConverters.fromRangeOrRangeWithMessage(ranges)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst _ranges: number[] = new Array<number>(4 * ranges.length);\n\t\t\t\t\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\t\t\t\t\tconst range = ranges[i];\n\t\t\t\t\t\t\t_ranges[4 * i] = range.start.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 1] = range.start.character + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 2] = range.end.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 3] = range.end.character + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn _proxy.$trySetDecorationsFast(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\t_ranges\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\trevealRange(range: Range, revealType: vscode.TextEditorRevealType): void {\n\t\t\t\tthat._runOnProxy(() => _proxy.$tryRevealRange(\n\t\t\t\t\tid,\n\t\t\t\t\tTypeConverters.Range.from(range),\n\t\t\t\t\t(revealType || TextEditorRevealType.Default)\n\t\t\t\t));\n\t\t\t},\n\t\t\tshow(column: vscode.ViewColumn) {\n\t\t\t\t_proxy.$tryShowEditor(id, TypeConverters.ViewColumn.from(column));\n\t\t\t},\n\t\t\thide() {\n\t\t\t\t_proxy.$tryHideEditor(id);\n\t\t\t},\n\t\t\t[Symbol.for('debug.description')]() {\n\t\t\t\treturn `TextEditor(${this.document.uri.toString()})`;\n\t\t\t}\n\t\t});\n\t}\n\n\tdispose() {\n\t\tok(!this._disposed);\n\t\tthis._disposed = true;\n\t}\n\n\t// --- incoming: extension host MUST accept what the renderer says\n\n\t_acceptOptions(options: IResolvedTextEditorConfiguration): void {\n\t\tok(!this._disposed);\n\t\tthis._options._accept(options);\n\t}\n\n\t_acceptVisibleRanges(value: Range[]): void {\n\t\tok(!this._disposed);\n\t\tthis._visibleRanges = value;\n\t}\n\n\t_acceptViewColumn(value: vscode.ViewColumn) {\n\t\tok(!this._disposed);\n\t\tthis._viewColumn = value;\n\t}\n\n\t_acceptSelections(selections: Selection[]): void {\n\t\tok(!this._disposed);\n\t\tthis._selections = selections;\n\t}\n\n\t_acceptDiffInformation(diffInformation: vscode.TextEditorDiffInformation[] | undefined): void {\n\t\tok(!this._disposed);\n\t\tthis._diffInformation = diffInformation;\n\t}\n\n\tprivate async _trySetSelection(): Promise<vscode.TextEditor | null | undefined> {\n\t\tconst selection = this._selections.map(TypeConverters.Selection.from);\n\t\tawait this._runOnProxy(() => this._proxy.$trySetSelections(this.id, selection));\n\t\treturn this.value;\n\t}\n\n\tprivate _applyEdit(editBuilder: TextEditorEdit): Promise<boolean> {\n\t\tconst editData = editBuilder.finalize();\n\n\t\t// return when there is nothing to do\n\t\tif (editData.edits.length === 0 && !editData.setEndOfLine) {\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\t// check that the edits are not overlapping (i.e. illegal)\n\t\tconst editRanges = editData.edits.map(edit => edit.range);\n\n\t\t// sort ascending (by end and then by start)\n\t\teditRanges.sort((a, b) => {\n\t\t\tif (a.end.line === b.end.line) {\n\t\t\t\tif (a.end.character === b.end.character) {\n\t\t\t\t\tif (a.start.line === b.start.line) {\n\t\t\t\t\t\treturn a.start.character - b.start.character;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.start.line - b.start.line;\n\t\t\t\t}\n\t\t\t\treturn a.end.character - b.end.character;\n\t\t\t}\n\t\t\treturn a.end.line - b.end.line;\n\t\t});\n\n\t\t// check that no edits are overlapping\n\t\tfor (let i = 0, count = editRanges.length - 1; i < count; i++) {\n\t\t\tconst rangeEnd = editRanges[i].end;\n\t\t\tconst nextRangeStart = editRanges[i + 1].start;\n\n\t\t\tif (nextRangeStart.isBefore(rangeEnd)) {\n\t\t\t\t// overlapping ranges\n\t\t\t\treturn Promise.reject(\n\t\t\t\t\tnew Error('Overlapping ranges are not allowed!')\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// prepare data for serialization\n\t\tconst edits = editData.edits.map((edit): ISingleEditOperation => {\n\t\t\treturn {\n\t\t\t\trange: TypeConverters.Range.from(edit.range),\n\t\t\t\ttext: edit.text,\n\t\t\t\tforceMoveMarkers: edit.forceMoveMarkers\n\t\t\t};\n\t\t});\n\n\t\treturn this._proxy.$tryApplyEdits(this.id, editData.documentVersionId, edits, {\n\t\t\tsetEndOfLine: typeof editData.setEndOfLine === 'number' ? TypeConverters.EndOfLine.from(editData.setEndOfLine) : undefined,\n\t\t\tundoStopBefore: editData.undoStopBefore,\n\t\t\tundoStopAfter: editData.undoStopAfter\n\t\t});\n\t}\n\tprivate _runOnProxy(callback: () => Promise<any>): Promise<ExtHostTextEditor | undefined | null> {\n\t\tif (this._disposed) {\n\t\t\tthis._logService.warn('TextEditor is closed/disposed');\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn callback().then(() => this, err => {\n\t\t\tif (!(err instanceof Error && err.name === 'DISPOSED')) {\n\t\t\t\tthis._logService.warn(err);\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n}\n"]}