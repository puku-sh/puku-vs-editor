{"version":3,"sources":["vs/workbench/api/common/jsonValidationExtensionPoint.ts"],"names":[],"mappings":"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","file":"jsonValidationExtensionPoint.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../nls.js';\nimport { ExtensionsRegistry } from '../../services/extensions/common/extensionsRegistry.js';\nimport * as resources from '../../../base/common/resources.js';\nimport { isString } from '../../../base/common/types.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Extensions, IExtensionFeatureTableRenderer, IExtensionFeaturesRegistry, IRenderedData, IRowData, ITableData } from '../../services/extensionManagement/common/extensionFeatures.js';\nimport { IExtensionManifest } from '../../../platform/extensions/common/extensions.js';\nimport { Registry } from '../../../platform/registry/common/platform.js';\nimport { SyncDescriptor } from '../../../platform/instantiation/common/descriptors.js';\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\n\ninterface IJSONValidationExtensionPoint {\n\tfileMatch: string | string[];\n\turl: string;\n}\n\nconst configurationExtPoint = ExtensionsRegistry.registerExtensionPoint<IJSONValidationExtensionPoint[]>({\n\textensionPoint: 'jsonValidation',\n\tdefaultExtensionKind: ['workspace', 'web'],\n\tjsonSchema: {\n\t\tdescription: nls.localize('contributes.jsonValidation', 'Contributes json schema configuration.'),\n\t\ttype: 'array',\n\t\tdefaultSnippets: [{ body: [{ fileMatch: '${1:file.json}', url: '${2:url}' }] }],\n\t\titems: {\n\t\t\ttype: 'object',\n\t\t\tdefaultSnippets: [{ body: { fileMatch: '${1:file.json}', url: '${2:url}' } }],\n\t\t\tproperties: {\n\t\t\t\tfileMatch: {\n\t\t\t\t\ttype: ['string', 'array'],\n\t\t\t\t\tdescription: nls.localize('contributes.jsonValidation.fileMatch', 'The file pattern (or an array of patterns) to match, for example \"package.json\" or \"*.launch\". Exclusion patterns start with \\'!\\''),\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: ['string']\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\turl: {\n\t\t\t\t\tdescription: nls.localize('contributes.jsonValidation.url', 'A schema URL (\\'http:\\', \\'https:\\') or relative path to the extension folder (\\'./\\').'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nexport class JSONValidationExtensionPoint {\n\n\tconstructor() {\n\t\tconfigurationExtPoint.setHandler((extensions) => {\n\t\t\tfor (const extension of extensions) {\n\t\t\t\tconst extensionValue = <IJSONValidationExtensionPoint[]>extension.value;\n\t\t\t\tconst collector = extension.collector;\n\t\t\t\tconst extensionLocation = extension.description.extensionLocation;\n\n\t\t\t\tif (!extensionValue || !Array.isArray(extensionValue)) {\n\t\t\t\t\tcollector.error(nls.localize('invalid.jsonValidation', \"'configuration.jsonValidation' must be a array\"));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\textensionValue.forEach(extension => {\n\t\t\t\t\tif (!isString(extension.fileMatch) && !(Array.isArray(extension.fileMatch) && extension.fileMatch.every(isString))) {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.fileMatch', \"'configuration.jsonValidation.fileMatch' must be defined as a string or an array of strings.\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst uri = extension.url;\n\t\t\t\t\tif (!isString(uri)) {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.url', \"'configuration.jsonValidation.url' must be a URL or relative path\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (uri.startsWith('./')) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst colorThemeLocation = resources.joinPath(extensionLocation, uri);\n\t\t\t\t\t\t\tif (!resources.isEqualOrParent(colorThemeLocation, extensionLocation)) {\n\t\t\t\t\t\t\t\tcollector.warn(nls.localize('invalid.path.1', \"Expected `contributes.{0}.url` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.\", configurationExtPoint.name, colorThemeLocation.toString(), extensionLocation.path));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tcollector.error(nls.localize('invalid.url.fileschema', \"'configuration.jsonValidation.url' is an invalid relative URL: {0}\", e.message));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!/^[^:/?#]+:\\/\\//.test(uri)) {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.url.schema', \"'configuration.jsonValidation.url' must be an absolute URL or start with './'  to reference schemas located in the extension.\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n}\n\nclass JSONValidationDataRenderer extends Disposable implements IExtensionFeatureTableRenderer {\n\n\treadonly type = 'table';\n\n\tshouldRender(manifest: IExtensionManifest): boolean {\n\t\treturn !!manifest.contributes?.jsonValidation;\n\t}\n\n\trender(manifest: IExtensionManifest): IRenderedData<ITableData> {\n\t\tconst contrib = manifest.contributes?.jsonValidation || [];\n\t\tif (!contrib.length) {\n\t\t\treturn { data: { headers: [], rows: [] }, dispose: () => { } };\n\t\t}\n\n\t\tconst headers = [\n\t\t\tnls.localize('fileMatch', \"File Match\"),\n\t\t\tnls.localize('schema', \"Schema\"),\n\t\t];\n\n\t\tconst rows: IRowData[][] = contrib.map(v => {\n\t\t\treturn [\n\t\t\t\tnew MarkdownString().appendMarkdown(`\\`${Array.isArray(v.fileMatch) ? v.fileMatch.join(', ') : v.fileMatch}\\``),\n\t\t\t\tv.url,\n\t\t\t];\n\t\t});\n\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\theaders,\n\t\t\t\trows\n\t\t\t},\n\t\t\tdispose: () => { }\n\t\t};\n\t}\n}\n\nRegistry.as<IExtensionFeaturesRegistry>(Extensions.ExtensionFeaturesRegistry).registerExtensionFeature({\n\tid: 'jsonValidation',\n\tlabel: nls.localize('jsonValidation', \"JSON Validation\"),\n\taccess: {\n\t\tcanToggle: false\n\t},\n\trenderer: new SyncDescriptor(JSONValidationDataRenderer),\n});\n"]}