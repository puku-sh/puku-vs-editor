{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/common/extHostSCM.ts","vs/workbench/api/common/extHostSCM.ts"],"names":[],"mappings":"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","file":"extHostSCM.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable local/code-no-native-private */\n\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { Event, Emitter } from '../../../base/common/event.js';\nimport { debounce } from '../../../base/common/decorators.js';\nimport { DisposableStore, IDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { asPromise } from '../../../base/common/async.js';\nimport { ExtHostCommands } from './extHostCommands.js';\nimport { MainContext, MainThreadSCMShape, SCMRawResource, SCMRawResourceSplice, SCMRawResourceSplices, IMainContext, ExtHostSCMShape, ICommandDto, MainThreadTelemetryShape, SCMGroupFeatures, SCMHistoryItemDto, SCMHistoryItemChangeDto, SCMHistoryItemRefDto, SCMActionButtonDto, SCMArtifactGroupDto, SCMArtifactDto } from './extHost.protocol.js';\nimport { sortedDiff, equals } from '../../../base/common/arrays.js';\nimport { comparePaths } from '../../../base/common/comparers.js';\nimport type * as vscode from 'vscode';\nimport { ISplice } from '../../../base/common/sequence.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ExtensionIdentifierMap, IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { MarshalledId } from '../../../base/common/marshallingIds.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport { IMarkdownString } from '../../../base/common/htmlContent.js';\nimport { MarkdownString, SourceControlInputBoxValidationType } from './extHostTypeConverters.js';\nimport { checkProposedApiEnabled, isProposedApiEnabled } from '../../services/extensions/common/extensions.js';\nimport { ExtHostDocuments } from './extHostDocuments.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { isLinux } from '../../../base/common/platform.js';\nimport { structuralEquals } from '../../../base/common/equals.js';\nimport { Iterable } from '../../../base/common/iterator.js';\n\ntype ProviderHandle = number;\ntype GroupHandle = number;\ntype ResourceStateHandle = number;\n\nfunction isUri(thing: any): thing is vscode.Uri {\n\treturn thing instanceof URI;\n}\n\nfunction uriEquals(a: vscode.Uri, b: vscode.Uri): boolean {\n\tif (a.scheme === Schemas.file && b.scheme === Schemas.file && isLinux) {\n\t\treturn a.toString() === b.toString();\n\t}\n\n\treturn a.toString().toLowerCase() === b.toString().toLowerCase();\n}\n\nfunction getIconResource(decorations?: vscode.SourceControlResourceThemableDecorations): UriComponents | ThemeIcon | undefined {\n\tif (!decorations) {\n\t\treturn undefined;\n\t} else if (typeof decorations.iconPath === 'string') {\n\t\treturn URI.file(decorations.iconPath);\n\t} else if (URI.isUri(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else if (ThemeIcon.isThemeIcon(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else {\n\t\treturn undefined;\n\t}\n}\n\nfunction getHistoryItemIconDto(icon: vscode.Uri | { light: vscode.Uri; dark: vscode.Uri } | vscode.ThemeIcon | undefined): UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon | undefined {\n\tif (!icon) {\n\t\treturn undefined;\n\t} else if (URI.isUri(icon)) {\n\t\treturn icon;\n\t} else if (ThemeIcon.isThemeIcon(icon)) {\n\t\treturn icon;\n\t} else {\n\t\tconst iconDto = icon as { light: URI; dark: URI };\n\t\treturn { light: iconDto.light, dark: iconDto.dark };\n\t}\n}\n\nfunction toSCMHistoryItemDto(historyItem: vscode.SourceControlHistoryItem): SCMHistoryItemDto {\n\tconst authorIcon = getHistoryItemIconDto(historyItem.authorIcon);\n\tconst tooltip = MarkdownString.fromStrict(historyItem.tooltip);\n\n\tconst references = historyItem.references?.map(r => ({\n\t\t...r, icon: getHistoryItemIconDto(r.icon)\n\t}));\n\n\treturn { ...historyItem, authorIcon, references, tooltip };\n}\n\nfunction toSCMHistoryItemRefDto(historyItemRef?: vscode.SourceControlHistoryItemRef): SCMHistoryItemRefDto | undefined {\n\treturn historyItemRef ? { ...historyItemRef, icon: getHistoryItemIconDto(historyItemRef.icon) } : undefined;\n}\n\nfunction compareResourceThemableDecorations(a: vscode.SourceControlResourceThemableDecorations, b: vscode.SourceControlResourceThemableDecorations): number {\n\tif (!a.iconPath && !b.iconPath) {\n\t\treturn 0;\n\t} else if (!a.iconPath) {\n\t\treturn -1;\n\t} else if (!b.iconPath) {\n\t\treturn 1;\n\t}\n\n\tconst aPath = typeof a.iconPath === 'string' ? a.iconPath : URI.isUri(a.iconPath) ? a.iconPath.fsPath : (a.iconPath as vscode.ThemeIcon).id;\n\tconst bPath = typeof b.iconPath === 'string' ? b.iconPath : URI.isUri(b.iconPath) ? b.iconPath.fsPath : (b.iconPath as vscode.ThemeIcon).id;\n\treturn comparePaths(aPath, bPath);\n}\n\nfunction compareResourceStatesDecorations(a: vscode.SourceControlResourceDecorations, b: vscode.SourceControlResourceDecorations): number {\n\tlet result = 0;\n\n\tif (a.strikeThrough !== b.strikeThrough) {\n\t\treturn a.strikeThrough ? 1 : -1;\n\t}\n\n\tif (a.faded !== b.faded) {\n\t\treturn a.faded ? 1 : -1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\treturn (a.tooltip || '').localeCompare(b.tooltip || '');\n\t}\n\n\tresult = compareResourceThemableDecorations(a, b);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.light && b.light) {\n\t\tresult = compareResourceThemableDecorations(a.light, b.light);\n\t} else if (a.light) {\n\t\treturn 1;\n\t} else if (b.light) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.dark && b.dark) {\n\t\tresult = compareResourceThemableDecorations(a.dark, b.dark);\n\t} else if (a.dark) {\n\t\treturn 1;\n\t} else if (b.dark) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareCommands(a: vscode.Command, b: vscode.Command): number {\n\tif (a.command !== b.command) {\n\t\treturn a.command < b.command ? -1 : 1;\n\t}\n\n\tif (a.title !== b.title) {\n\t\treturn a.title < b.title ? -1 : 1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\tif (a.tooltip !== undefined && b.tooltip !== undefined) {\n\t\t\treturn a.tooltip < b.tooltip ? -1 : 1;\n\t\t} else if (a.tooltip !== undefined) {\n\t\t\treturn 1;\n\t\t} else if (b.tooltip !== undefined) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (a.arguments === b.arguments) {\n\t\treturn 0;\n\t} else if (!a.arguments) {\n\t\treturn -1;\n\t} else if (!b.arguments) {\n\t\treturn 1;\n\t} else if (a.arguments.length !== b.arguments.length) {\n\t\treturn a.arguments.length - b.arguments.length;\n\t}\n\n\tfor (let i = 0; i < a.arguments.length; i++) {\n\t\tconst aArg = a.arguments[i];\n\t\tconst bArg = b.arguments[i];\n\n\t\tif (aArg === bArg) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (isUri(aArg) && isUri(bArg) && uriEquals(aArg, bArg)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturn aArg < bArg ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\nfunction compareResourceStates(a: vscode.SourceControlResourceState, b: vscode.SourceControlResourceState): number {\n\tlet result = comparePaths(a.resourceUri.fsPath, b.resourceUri.fsPath, true);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.command && b.command) {\n\t\tresult = compareCommands(a.command, b.command);\n\t} else if (a.command) {\n\t\treturn 1;\n\t} else if (b.command) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.decorations && b.decorations) {\n\t\tresult = compareResourceStatesDecorations(a.decorations, b.decorations);\n\t} else if (a.decorations) {\n\t\treturn 1;\n\t} else if (b.decorations) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.multiFileDiffEditorModifiedUri && b.multiFileDiffEditorModifiedUri) {\n\t\tresult = comparePaths(a.multiFileDiffEditorModifiedUri.fsPath, b.multiFileDiffEditorModifiedUri.fsPath, true);\n\t} else if (a.multiFileDiffEditorModifiedUri) {\n\t\treturn 1;\n\t} else if (b.multiFileDiffEditorModifiedUri) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.multiDiffEditorOriginalUri && b.multiDiffEditorOriginalUri) {\n\t\tresult = comparePaths(a.multiDiffEditorOriginalUri.fsPath, b.multiDiffEditorOriginalUri.fsPath, true);\n\t} else if (a.multiDiffEditorOriginalUri) {\n\t\treturn 1;\n\t} else if (b.multiDiffEditorOriginalUri) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareArgs(a: any[], b: any[]): boolean {\n\tfor (let i = 0; i < a.length; i++) {\n\t\tif (a[i] !== b[i]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction commandEquals(a: vscode.Command, b: vscode.Command): boolean {\n\treturn a.command === b.command\n\t\t&& a.title === b.title\n\t\t&& a.tooltip === b.tooltip\n\t\t&& (a.arguments && b.arguments ? compareArgs(a.arguments, b.arguments) : a.arguments === b.arguments);\n}\n\nfunction commandListEquals(a: readonly vscode.Command[], b: readonly vscode.Command[]): boolean {\n\treturn equals(a, b, commandEquals);\n}\n\nexport interface IValidateInput {\n\t(value: string, cursorPosition: number): vscode.ProviderResult<vscode.SourceControlInputBoxValidation | undefined | null>;\n}\n\nexport class ExtHostSCMInputBox implements vscode.SourceControlInputBox {\n\n\t#proxy: MainThreadSCMShape;\n\t#extHostDocuments: ExtHostDocuments;\n\n\tprivate _value: string = '';\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value(value: string) {\n\t\tvalue = value ?? '';\n\t\tthis.#proxy.$setInputBoxValue(this._sourceControlHandle, value);\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<string>();\n\n\tget onDidChange(): Event<string> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _placeholder: string = '';\n\n\tget placeholder(): string {\n\t\treturn this._placeholder;\n\t}\n\n\tset placeholder(placeholder: string) {\n\t\tthis.#proxy.$setInputBoxPlaceholder(this._sourceControlHandle, placeholder);\n\t\tthis._placeholder = placeholder;\n\t}\n\n\tprivate _validateInput: IValidateInput | undefined;\n\n\tget validateInput(): IValidateInput | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\treturn this._validateInput;\n\t}\n\n\tset validateInput(fn: IValidateInput | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\tif (fn && typeof fn !== 'function') {\n\t\t\tthrow new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);\n\t\t}\n\n\t\tthis._validateInput = fn;\n\t\tthis.#proxy.$setValidationProviderIsEnabled(this._sourceControlHandle, !!fn);\n\t}\n\n\tprivate _enabled: boolean = true;\n\n\tget enabled(): boolean {\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(enabled: boolean) {\n\t\tenabled = !!enabled;\n\n\t\tif (this._enabled === enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enabled = enabled;\n\t\tthis.#proxy.$setInputBoxEnablement(this._sourceControlHandle, enabled);\n\t}\n\n\tprivate _visible: boolean = true;\n\n\tget visible(): boolean {\n\t\treturn this._visible;\n\t}\n\n\tset visible(visible: boolean) {\n\t\tvisible = !!visible;\n\n\t\tif (this._visible === visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visible = visible;\n\t\tthis.#proxy.$setInputBoxVisibility(this._sourceControlHandle, visible);\n\t}\n\n\tget document(): vscode.TextDocument {\n\t\tcheckProposedApiEnabled(this._extension, 'scmTextDocument');\n\n\t\treturn this.#extHostDocuments.getDocument(this._documentUri);\n\t}\n\n\tconstructor(private _extension: IExtensionDescription, _extHostDocuments: ExtHostDocuments, proxy: MainThreadSCMShape, private _sourceControlHandle: number, private _documentUri: URI) {\n\t\tthis.#extHostDocuments = _extHostDocuments;\n\t\tthis.#proxy = proxy;\n\t}\n\n\tshowValidationMessage(message: string | vscode.MarkdownString, type: vscode.SourceControlInputBoxValidationType) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\t\tthis.#proxy.$showValidationMessage(this._sourceControlHandle, message, SourceControlInputBoxValidationType.from(type));\n\t}\n\n\t$onInputBoxValueChange(value: string): void {\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate updateValue(value: string): void {\n\t\tthis._value = value;\n\t\tthis._onDidChange.fire(value);\n\t}\n}\n\nclass ExtHostSourceControlResourceGroup implements vscode.SourceControlResourceGroup {\n\n\tprivate static _handlePool: number = 0;\n\tprivate _resourceHandlePool: number = 0;\n\tprivate _resourceStates: vscode.SourceControlResourceState[] = [];\n\n\tprivate _resourceStatesMap = new Map<ResourceStateHandle, vscode.SourceControlResourceState>();\n\tprivate _resourceStatesCommandsMap = new Map<ResourceStateHandle, vscode.Command>();\n\tprivate _resourceStatesDisposablesMap = new Map<ResourceStateHandle, IDisposable>();\n\n\tprivate readonly _onDidUpdateResourceStates = new Emitter<void>();\n\treadonly onDidUpdateResourceStates = this._onDidUpdateResourceStates.event;\n\n\tprivate _disposed = false;\n\tget disposed(): boolean { return this._disposed; }\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\tprivate _handlesSnapshot: number[] = [];\n\tprivate _resourceSnapshot: vscode.SourceControlResourceState[] = [];\n\n\tget id(): string { return this._id; }\n\n\tget label(): string { return this._label; }\n\tset label(label: string) {\n\t\tthis._label = label;\n\t\tthis._proxy.$updateGroupLabel(this._sourceControlHandle, this.handle, label);\n\t}\n\n\tprivate _contextValue: string | undefined = undefined;\n\tget contextValue(): string | undefined {\n\t\treturn this._contextValue;\n\t}\n\tset contextValue(contextValue: string | undefined) {\n\t\tthis._contextValue = contextValue;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tprivate _hideWhenEmpty: boolean | undefined = undefined;\n\tget hideWhenEmpty(): boolean | undefined { return this._hideWhenEmpty; }\n\tset hideWhenEmpty(hideWhenEmpty: boolean | undefined) {\n\t\tthis._hideWhenEmpty = hideWhenEmpty;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tget features(): SCMGroupFeatures {\n\t\treturn {\n\t\t\tcontextValue: this.contextValue,\n\t\t\thideWhenEmpty: this.hideWhenEmpty\n\t\t};\n\t}\n\n\tget resourceStates(): vscode.SourceControlResourceState[] { return [...this._resourceStates]; }\n\tset resourceStates(resources: vscode.SourceControlResourceState[]) {\n\t\tthis._resourceStates = [...resources];\n\t\tthis._onDidUpdateResourceStates.fire();\n\t}\n\n\treadonly handle = ExtHostSourceControlResourceGroup._handlePool++;\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _sourceControlHandle: number,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tpublic readonly multiDiffEditorEnableViewChanges: boolean,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) { }\n\n\tgetResourceState(handle: number): vscode.SourceControlResourceState | undefined {\n\t\treturn this._resourceStatesMap.get(handle);\n\t}\n\n\t$executeResourceCommand(handle: number, preserveFocus: boolean): Promise<void> {\n\t\tconst command = this._resourceStatesCommandsMap.get(handle);\n\n\t\tif (!command) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => this._commands.executeCommand(command.command, ...(command.arguments || []), preserveFocus));\n\t}\n\n\t_takeResourceStateSnapshot(): SCMRawResourceSplice[] {\n\t\tconst snapshot = [...this._resourceStates].sort(compareResourceStates);\n\t\tconst diffs = sortedDiff(this._resourceSnapshot, snapshot, compareResourceStates);\n\n\t\tconst splices = diffs.map<ISplice<{ rawResource: SCMRawResource; handle: number }>>(diff => {\n\t\t\tconst toInsert = diff.toInsert.map(r => {\n\t\t\t\tconst handle = this._resourceHandlePool++;\n\t\t\t\tthis._resourceStatesMap.set(handle, r);\n\n\t\t\t\tconst sourceUri = r.resourceUri;\n\n\t\t\t\tlet command: ICommandDto | undefined;\n\t\t\t\tif (r.command) {\n\t\t\t\t\tif (r.command.command === 'vscode.open' || r.command.command === 'vscode.diff' || r.command.command === 'vscode.changes') {\n\t\t\t\t\t\tconst disposables = new DisposableStore();\n\t\t\t\t\t\tcommand = this._commands.converter.toInternal(r.command, disposables);\n\t\t\t\t\t\tthis._resourceStatesDisposablesMap.set(handle, disposables);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._resourceStatesCommandsMap.set(handle, r.command);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst hasScmMultiDiffEditorProposalEnabled = isProposedApiEnabled(this._extension, 'scmMultiDiffEditor');\n\t\t\t\tconst multiFileDiffEditorOriginalUri = hasScmMultiDiffEditorProposalEnabled ? r.multiDiffEditorOriginalUri : undefined;\n\t\t\t\tconst multiFileDiffEditorModifiedUri = hasScmMultiDiffEditorProposalEnabled ? r.multiFileDiffEditorModifiedUri : undefined;\n\n\t\t\t\tconst icon = getIconResource(r.decorations);\n\t\t\t\tconst lightIcon = r.decorations && getIconResource(r.decorations.light) || icon;\n\t\t\t\tconst darkIcon = r.decorations && getIconResource(r.decorations.dark) || icon;\n\t\t\t\tconst icons: SCMRawResource[2] = [lightIcon, darkIcon];\n\n\t\t\t\tconst tooltip = (r.decorations && r.decorations.tooltip) || '';\n\t\t\t\tconst strikeThrough = r.decorations && !!r.decorations.strikeThrough;\n\t\t\t\tconst faded = r.decorations && !!r.decorations.faded;\n\t\t\t\tconst contextValue = r.contextValue || '';\n\n\t\t\t\tconst rawResource = [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command, multiFileDiffEditorOriginalUri, multiFileDiffEditorModifiedUri] as SCMRawResource;\n\n\t\t\t\treturn { rawResource, handle };\n\t\t\t});\n\n\t\t\treturn { start: diff.start, deleteCount: diff.deleteCount, toInsert };\n\t\t});\n\n\t\tconst rawResourceSplices = splices\n\t\t\t.map(({ start, deleteCount, toInsert }) => [start, deleteCount, toInsert.map(i => i.rawResource)] as SCMRawResourceSplice);\n\n\t\tconst reverseSplices = splices.reverse();\n\n\t\tfor (const { start, deleteCount, toInsert } of reverseSplices) {\n\t\t\tconst handles = toInsert.map(i => i.handle);\n\t\t\tconst handlesToDelete = this._handlesSnapshot.splice(start, deleteCount, ...handles);\n\n\t\t\tfor (const handle of handlesToDelete) {\n\t\t\t\tthis._resourceStatesMap.delete(handle);\n\t\t\t\tthis._resourceStatesCommandsMap.delete(handle);\n\t\t\t\tthis._resourceStatesDisposablesMap.get(handle)?.dispose();\n\t\t\t\tthis._resourceStatesDisposablesMap.delete(handle);\n\t\t\t}\n\t\t}\n\n\t\tthis._resourceSnapshot = snapshot;\n\t\treturn rawResourceSplices;\n\t}\n\n\tdispose(): void {\n\t\tthis._disposed = true;\n\t\tthis._onDidDispose.fire();\n\t}\n}\n\nclass ExtHostSourceControl implements vscode.SourceControl {\n\n\tprivate static _handlePool: number = 0;\n\n\treadonly onDidDisposeParent: Event<void>;\n\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\n\t#proxy: MainThreadSCMShape;\n\n\tprivate _groups: Map<GroupHandle, ExtHostSourceControlResourceGroup> = new Map<GroupHandle, ExtHostSourceControlResourceGroup>();\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tget rootUri(): vscode.Uri | undefined {\n\t\treturn this._rootUri;\n\t}\n\n\tprivate _contextValue: string | undefined = undefined;\n\n\tget contextValue(): string | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmProviderOptions');\n\t\treturn this._contextValue;\n\t}\n\n\tset contextValue(contextValue: string | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmProviderOptions');\n\n\t\tif (this._contextValue === contextValue) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._contextValue = contextValue;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { contextValue });\n\t}\n\n\tprivate _inputBox: ExtHostSCMInputBox;\n\tget inputBox(): ExtHostSCMInputBox { return this._inputBox; }\n\n\tprivate _count: number | undefined = undefined;\n\n\tget count(): number | undefined {\n\t\treturn this._count;\n\t}\n\n\tset count(count: number | undefined) {\n\t\tif (this._count === count) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._count = count;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { count });\n\t}\n\n\tprivate _quickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget quickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\treturn this._quickDiffProvider;\n\t}\n\n\tset quickDiffProvider(quickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tthis._quickDiffProvider = quickDiffProvider;\n\t\tlet quickDiffLabel = undefined;\n\t\tif (isProposedApiEnabled(this._extension, 'quickDiffProvider')) {\n\t\t\tquickDiffLabel = quickDiffProvider?.label;\n\t\t}\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasQuickDiffProvider: !!quickDiffProvider, quickDiffLabel });\n\t}\n\n\tprivate _secondaryQuickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget secondaryQuickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'quickDiffProvider');\n\t\treturn this._secondaryQuickDiffProvider;\n\t}\n\n\tset secondaryQuickDiffProvider(secondaryQuickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'quickDiffProvider');\n\n\t\tthis._secondaryQuickDiffProvider = secondaryQuickDiffProvider;\n\t\tconst secondaryQuickDiffLabel = secondaryQuickDiffProvider?.label;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasSecondaryQuickDiffProvider: !!secondaryQuickDiffProvider, secondaryQuickDiffLabel });\n\t}\n\n\tprivate _historyProvider: vscode.SourceControlHistoryProvider | undefined;\n\tprivate readonly _historyProviderDisposable = new MutableDisposable<DisposableStore>();\n\n\tget historyProvider(): vscode.SourceControlHistoryProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmHistoryProvider');\n\t\treturn this._historyProvider;\n\t}\n\n\tset historyProvider(historyProvider: vscode.SourceControlHistoryProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmHistoryProvider');\n\n\t\tthis._historyProvider = historyProvider;\n\t\tthis._historyProviderDisposable.value = new DisposableStore();\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasHistoryProvider: !!historyProvider });\n\n\t\tif (historyProvider) {\n\t\t\tthis._historyProviderDisposable.value.add(historyProvider.onDidChangeCurrentHistoryItemRefs(() => {\n\t\t\t\tconst historyItemRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemRef);\n\t\t\t\tconst historyItemRemoteRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemRemoteRef);\n\t\t\t\tconst historyItemBaseRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemBaseRef);\n\n\t\t\t\tthis.#proxy.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle, historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t\t\t}));\n\t\t\tthis._historyProviderDisposable.value.add(historyProvider.onDidChangeHistoryItemRefs((e) => {\n\t\t\t\tif (e.added.length === 0 && e.modified.length === 0 && e.removed.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst added = e.added.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\t\t\t\tconst modified = e.modified.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\t\t\t\tconst removed = e.removed.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\n\t\t\t\tthis.#proxy.$onDidChangeHistoryProviderHistoryItemRefs(this.handle, { added, modified, removed, silent: e.silent });\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _artifactProvider: vscode.SourceControlArtifactProvider | undefined;\n\tprivate readonly _artifactProviderDisposable = new MutableDisposable<DisposableStore>();\n\n\tget artifactProvider(): vscode.SourceControlArtifactProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmArtifactProvider');\n\t\treturn this._artifactProvider;\n\t}\n\n\tset artifactProvider(artifactProvider: vscode.SourceControlArtifactProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmArtifactProvider');\n\n\t\tthis._artifactProvider = artifactProvider;\n\t\tthis._artifactProviderDisposable.value = new DisposableStore();\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasArtifactProvider: !!artifactProvider });\n\n\t\tif (artifactProvider) {\n\t\t\tthis._artifactProviderDisposable.value.add(artifactProvider.onDidChangeArtifacts((groups: string[]) => {\n\t\t\t\tif (groups.length !== 0) {\n\t\t\t\t\tthis.#proxy.$onDidChangeArtifacts(this.handle, groups);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _commitTemplate: string | undefined = undefined;\n\n\tget commitTemplate(): string | undefined {\n\t\treturn this._commitTemplate;\n\t}\n\n\tset commitTemplate(commitTemplate: string | undefined) {\n\t\tif (commitTemplate === this._commitTemplate) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._commitTemplate = commitTemplate;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { commitTemplate });\n\t}\n\n\tprivate readonly _acceptInputDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _acceptInputCommand: vscode.Command | undefined = undefined;\n\n\tget acceptInputCommand(): vscode.Command | undefined {\n\t\treturn this._acceptInputCommand;\n\t}\n\n\tset acceptInputCommand(acceptInputCommand: vscode.Command | undefined) {\n\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\n\t\tthis._acceptInputCommand = acceptInputCommand;\n\n\t\tconst internal = this._commands.converter.toInternal(acceptInputCommand, this._acceptInputDisposables.value);\n\t\tthis.#proxy.$updateSourceControl(this.handle, { acceptInputCommand: internal });\n\t}\n\n\t// We know what we're doing here:\n\t// eslint-disable-next-line local/code-no-potentially-unsafe-disposables\n\tprivate _actionButtonDisposables = new DisposableStore();\n\tprivate _actionButton: vscode.SourceControlActionButton | undefined;\n\tget actionButton(): vscode.SourceControlActionButton | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\t\treturn this._actionButton;\n\t}\n\n\tset actionButton(actionButton: vscode.SourceControlActionButton | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\n\t\t// We have to do this check before converting the command to it's internal\n\t\t// representation since that would always create a command with a unique\n\t\t// identifier\n\t\tif (structuralEquals(this._actionButton, actionButton)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// In order to prevent disposing the action button command that are still rendered in the UI\n\t\t// until the next UI update, we ensure to dispose them after the update has been completed.\n\t\tconst oldActionButtonDisposables = this._actionButtonDisposables;\n\t\tthis._actionButtonDisposables = new DisposableStore();\n\n\t\tthis._actionButton = actionButton;\n\n\t\tconst actionButtonDto = actionButton !== undefined ?\n\t\t\t{\n\t\t\t\tcommand: {\n\t\t\t\t\t...this._commands.converter.toInternal(actionButton.command, this._actionButtonDisposables),\n\t\t\t\t\tshortTitle: actionButton.command.shortTitle\n\t\t\t\t},\n\t\t\t\tsecondaryCommands: actionButton.secondaryCommands?.map(commandGroup => {\n\t\t\t\t\treturn commandGroup.map(command => this._commands.converter.toInternal(command, this._actionButtonDisposables));\n\t\t\t\t}),\n\t\t\t\tenabled: actionButton.enabled\n\t\t\t} satisfies SCMActionButtonDto : null;\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { actionButton: actionButtonDto })\n\t\t\t.finally(() => oldActionButtonDisposables.dispose());\n\t}\n\n\t// We know what we're doing here:\n\t// eslint-disable-next-line local/code-no-potentially-unsafe-disposables\n\tprivate _statusBarDisposables = new DisposableStore();\n\tprivate _statusBarCommands: vscode.Command[] | undefined = undefined;\n\n\tget statusBarCommands(): vscode.Command[] | undefined {\n\t\treturn this._statusBarCommands;\n\t}\n\n\tset statusBarCommands(statusBarCommands: vscode.Command[] | undefined) {\n\t\tif (this._statusBarCommands && statusBarCommands && commandListEquals(this._statusBarCommands, statusBarCommands)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// In order to prevent disposing status bar commands that are still rendered in the UI\n\t\t// until the next UI update, we ensure to dispose them after the update has been completed.\n\t\tconst oldStatusBarDisposables = this._statusBarDisposables;\n\t\tthis._statusBarDisposables = new DisposableStore();\n\n\t\tthis._statusBarCommands = statusBarCommands;\n\n\t\tconst internal = (statusBarCommands || []).map(c => this._commands.converter.toInternal(c, this._statusBarDisposables)) as ICommandDto[];\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { statusBarCommands: internal })\n\t\t\t.finally(() => oldStatusBarDisposables.dispose());\n\t}\n\n\tprivate _selected: boolean = false;\n\n\tget selected(): boolean {\n\t\treturn this._selected;\n\t}\n\n\tprivate readonly _onDidChangeSelection = new Emitter<boolean>();\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\treadonly handle: number = ExtHostSourceControl._handlePool++;\n\n\tconstructor(\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\t_extHostDocuments: ExtHostDocuments,\n\t\tproxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tprivate _rootUri?: vscode.Uri,\n\t\t_iconPath?: vscode.IconPath,\n\t\t_parent?: ExtHostSourceControl\n\t) {\n\t\tthis.#proxy = proxy;\n\n\t\tconst inputBoxDocumentUri = URI.from({\n\t\t\tscheme: Schemas.vscodeSourceControl,\n\t\t\tpath: `${_id}/scm${this.handle}/input`,\n\t\t\tquery: _rootUri ? `rootUri=${encodeURIComponent(_rootUri.toString())}` : undefined\n\t\t});\n\n\t\tthis._inputBox = new ExtHostSCMInputBox(_extension, _extHostDocuments, this.#proxy, this.handle, inputBoxDocumentUri);\n\t\tthis.#proxy.$registerSourceControl(this.handle, _parent?.handle, _id, _label, _rootUri, getHistoryItemIconDto(_iconPath), inputBoxDocumentUri);\n\n\t\tthis.onDidDisposeParent = _parent ? _parent.onDidDispose : Event.None;\n\t}\n\n\tprivate createdResourceGroups = new Map<ExtHostSourceControlResourceGroup, IDisposable>();\n\tprivate updatedResourceGroups = new Set<ExtHostSourceControlResourceGroup>();\n\n\tcreateResourceGroup(id: string, label: string, options?: { multiDiffEditorEnableViewChanges?: boolean }): ExtHostSourceControlResourceGroup {\n\t\tconst multiDiffEditorEnableViewChanges = isProposedApiEnabled(this._extension, 'scmMultiDiffEditor') && options?.multiDiffEditorEnableViewChanges === true;\n\t\tconst group = new ExtHostSourceControlResourceGroup(this.#proxy, this._commands, this.handle, id, label, multiDiffEditorEnableViewChanges, this._extension);\n\t\tconst disposable = Event.once(group.onDidDispose)(() => this.createdResourceGroups.delete(group));\n\t\tthis.createdResourceGroups.set(group, disposable);\n\t\tthis.eventuallyAddResourceGroups();\n\t\treturn group;\n\t}\n\n\t@debounce(100)\n\teventuallyAddResourceGroups(): void {\n\t\tconst groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /*multiDiffEditorEnableViewChanges*/ boolean][] = [];\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tfor (const [group, disposable] of this.createdResourceGroups) {\n\t\t\tdisposable.dispose();\n\n\t\t\tconst updateListener = group.onDidUpdateResourceStates(() => {\n\t\t\t\tthis.updatedResourceGroups.add(group);\n\t\t\t\tthis.eventuallyUpdateResourceStates();\n\t\t\t});\n\n\t\t\tEvent.once(group.onDidDispose)(() => {\n\t\t\t\tthis.updatedResourceGroups.delete(group);\n\t\t\t\tupdateListener.dispose();\n\t\t\t\tthis._groups.delete(group.handle);\n\t\t\t\tthis.#proxy.$unregisterGroup(this.handle, group.handle);\n\t\t\t});\n\n\t\t\tgroups.push([group.handle, group.id, group.label, group.features, group.multiDiffEditorEnableViewChanges]);\n\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length > 0) {\n\t\t\t\tsplices.push([group.handle, snapshot]);\n\t\t\t}\n\n\t\t\tthis._groups.set(group.handle, group);\n\t\t}\n\n\t\tthis.#proxy.$registerGroups(this.handle, groups, splices);\n\t\tthis.createdResourceGroups.clear();\n\t}\n\n\t@debounce(100)\n\teventuallyUpdateResourceStates(): void {\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tthis.updatedResourceGroups.forEach(group => {\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsplices.push([group.handle, snapshot]);\n\t\t});\n\n\t\tif (splices.length > 0) {\n\t\t\tthis.#proxy.$spliceResourceStates(this.handle, splices);\n\t\t}\n\n\t\tthis.updatedResourceGroups.clear();\n\t}\n\n\tgetResourceGroup(handle: GroupHandle): ExtHostSourceControlResourceGroup | undefined {\n\t\treturn this._groups.get(handle);\n\t}\n\n\tsetSelectionState(selected: boolean): void {\n\t\tthis._selected = selected;\n\t\tthis._onDidChangeSelection.fire(selected);\n\t}\n\n\tdispose(): void {\n\t\tthis._acceptInputDisposables.dispose();\n\t\tthis._actionButtonDisposables.dispose();\n\t\tthis._statusBarDisposables.dispose();\n\t\tthis._historyProviderDisposable.dispose();\n\t\tthis._artifactProviderDisposable.dispose();\n\n\t\tthis._groups.forEach(group => group.dispose());\n\t\tthis.#proxy.$unregisterSourceControl(this.handle);\n\n\t\tthis._onDidDispose.fire();\n\t\tthis._onDidDispose.dispose();\n\t}\n}\n\nexport class ExtHostSCM implements ExtHostSCMShape {\n\n\tprivate _proxy: MainThreadSCMShape;\n\tprivate readonly _telemetry: MainThreadTelemetryShape;\n\tprivate _sourceControls: Map<ProviderHandle, ExtHostSourceControl> = new Map<ProviderHandle, ExtHostSourceControl>();\n\tprivate _sourceControlsByExtension: ExtensionIdentifierMap<ExtHostSourceControl[]> = new ExtensionIdentifierMap<ExtHostSourceControl[]>();\n\n\tprivate readonly _onDidChangeActiveProvider = new Emitter<vscode.SourceControl>();\n\tget onDidChangeActiveProvider(): Event<vscode.SourceControl> { return this._onDidChangeActiveProvider.event; }\n\n\tprivate _selectedSourceControlHandle: number | undefined;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _extHostDocuments: ExtHostDocuments,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadSCM);\n\t\tthis._telemetry = mainContext.getProxy(MainContext.MainThreadTelemetry);\n\n\t\t_commands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (arg && arg.$mid === MarshalledId.ScmResource) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst group = sourceControl.getResourceGroup(arg.groupHandle);\n\n\t\t\t\t\tif (!group) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn group.getResourceState(arg.handle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmResourceGroup) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl.getResourceGroup(arg.groupHandle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmProvider) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.handle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl;\n\t\t\t\t}\n\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateSourceControl(extension: IExtensionDescription, id: string, label: string, rootUri: vscode.Uri | undefined, iconPath: vscode.IconPath | undefined, parent: vscode.SourceControl | undefined): vscode.SourceControl {\n\t\tthis.logService.trace('ExtHostSCM#createSourceControl', extension.identifier.value, id, label, rootUri);\n\n\t\ttype TEvent = { extensionId: string };\n\t\ttype TMeta = {\n\t\t\towner: 'joaomoreno';\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The ID of the extension contributing to the Source Control API.' };\n\t\t\tcomment: 'This is used to know what extensions contribute to the Source Control API.';\n\t\t};\n\t\tthis._telemetry.$publicLog2<TEvent, TMeta>('api/scm/createSourceControl', {\n\t\t\textensionId: extension.identifier.value,\n\t\t});\n\n\t\tconst parentSourceControl = parent ? Iterable.find(this._sourceControls.values(), s => s === parent) : undefined;\n\t\tconst sourceControl = new ExtHostSourceControl(extension, this._extHostDocuments, this._proxy, this._commands, id, label, rootUri, iconPath, parentSourceControl);\n\t\tthis._sourceControls.set(sourceControl.handle, sourceControl);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(extension.identifier) || [];\n\t\tsourceControls.push(sourceControl);\n\t\tthis._sourceControlsByExtension.set(extension.identifier, sourceControls);\n\n\t\treturn sourceControl;\n\t}\n\n\t// Deprecated\n\tgetLastInputBox(extension: IExtensionDescription): ExtHostSCMInputBox | undefined {\n\t\tthis.logService.trace('ExtHostSCM#getLastInputBox', extension.identifier.value);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(extension.identifier);\n\t\tconst sourceControl = sourceControls && sourceControls[sourceControls.length - 1];\n\t\treturn sourceControl && sourceControl.inputBox;\n\t}\n\n\t$provideOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.quickDiffProvider || !sourceControl.quickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.quickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$provideSecondaryOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideSecondaryOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.secondaryQuickDiffProvider || !sourceControl.secondaryQuickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.secondaryQuickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$onInputBoxValueChange(sourceControlHandle: number, value: string): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$onInputBoxValueChange', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tsourceControl.inputBox.$onInputBoxValueChange(value);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$executeResourceCommand(sourceControlHandle: number, groupHandle: number, handle: number, preserveFocus: boolean): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$executeResourceCommand', sourceControlHandle, groupHandle, handle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst group = sourceControl.getResourceGroup(groupHandle);\n\n\t\tif (!group) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn group.$executeResourceCommand(handle, preserveFocus);\n\t}\n\n\t$validateInput(sourceControlHandle: number, value: string, cursorPosition: number): Promise<[string | IMarkdownString, number] | undefined> {\n\t\tthis.logService.trace('ExtHostSCM#$validateInput', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tif (!sourceControl.inputBox.validateInput) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.inputBox.validateInput!(value, cursorPosition)).then(result => {\n\t\t\tif (!result) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\tconst message = MarkdownString.fromStrict(result.message);\n\t\t\tif (!message) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\treturn Promise.resolve<[string | IMarkdownString, number]>([message, result.type]);\n\t\t});\n\t}\n\n\t$setSelectedSourceControl(selectedSourceControlHandle: number | undefined): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$setSelectedSourceControl', selectedSourceControlHandle);\n\n\t\tif (selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(selectedSourceControlHandle)?.setSelectionState(true);\n\t\t}\n\n\t\tif (this._selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false);\n\t\t}\n\n\t\tthis._selectedSourceControlHandle = selectedSourceControlHandle;\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tasync $resolveHistoryItem(sourceControlHandle: number, historyItemId: string, token: CancellationToken): Promise<SCMHistoryItemDto | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst historyItem = await historyProvider?.resolveHistoryItem(historyItemId, token);\n\n\t\t\treturn historyItem ? toSCMHistoryItemDto(historyItem) : undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItem', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemChatContext(sourceControlHandle: number, historyItemId: string, token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst chatContext = await historyProvider?.resolveHistoryItemChatContext(historyItemId, token);\n\n\t\t\treturn chatContext ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemChatContext', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemChangeRangeChatContext(sourceControlHandle: number, historyItemId: string, historyItemParentId: string, path: string, token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst chatContext = await historyProvider?.resolveHistoryItemChangeRangeChatContext?.(historyItemId, historyItemParentId, path, token);\n\n\t\t\treturn chatContext ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemChangeRangeChatContext', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemRefsCommonAncestor(sourceControlHandle: number, historyItemRefs: string[], token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst ancestor = await historyProvider?.resolveHistoryItemRefsCommonAncestor(historyItemRefs, token);\n\n\t\t\treturn ancestor ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemRefsCommonAncestor', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItemRefs(sourceControlHandle: number, historyItemRefs: string[] | undefined, token: CancellationToken): Promise<SCMHistoryItemRefDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst refs = await historyProvider?.provideHistoryItemRefs(historyItemRefs, token);\n\n\t\t\treturn refs?.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) })) ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItemRefs', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItems(sourceControlHandle: number, options: vscode.SourceControlHistoryOptions, token: CancellationToken): Promise<SCMHistoryItemDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst historyItems = await historyProvider?.provideHistoryItems(options, token);\n\n\t\t\treturn historyItems?.map(item => toSCMHistoryItemDto(item)) ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItems', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItemChanges(sourceControlHandle: number, historyItemId: string, historyItemParentId: string | undefined, token: CancellationToken): Promise<SCMHistoryItemChangeDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst changes = await historyProvider?.provideHistoryItemChanges(historyItemId, historyItemParentId, token);\n\n\t\t\treturn changes ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItemChanges', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideArtifactGroups(sourceControlHandle: number, token: CancellationToken): Promise<SCMArtifactGroupDto[] | undefined> {\n\t\ttry {\n\t\t\tconst artifactProvider = this._sourceControls.get(sourceControlHandle)?.artifactProvider;\n\t\t\tconst groups = await artifactProvider?.provideArtifactGroups(token);\n\n\t\t\treturn groups?.map(group => ({\n\t\t\t\t...group,\n\t\t\t\ticon: getHistoryItemIconDto(group.icon)\n\t\t\t}));\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideArtifactGroups', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideArtifacts(sourceControlHandle: number, group: string, token: CancellationToken): Promise<SCMArtifactDto[] | undefined> {\n\t\ttry {\n\t\t\tconst artifactProvider = this._sourceControls.get(sourceControlHandle)?.artifactProvider;\n\t\t\tconst artifacts = await artifactProvider?.provideArtifacts(group, token);\n\n\t\t\treturn artifacts?.map(artifact => ({\n\t\t\t\t...artifact,\n\t\t\t\ticon: getHistoryItemIconDto(artifact.icon)\n\t\t\t}));\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideArtifacts', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable local/code-no-native-private */\n\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { Event, Emitter } from '../../../base/common/event.js';\nimport { debounce } from '../../../base/common/decorators.js';\nimport { DisposableStore, IDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { asPromise } from '../../../base/common/async.js';\nimport { ExtHostCommands } from './extHostCommands.js';\nimport { MainContext, MainThreadSCMShape, SCMRawResource, SCMRawResourceSplice, SCMRawResourceSplices, IMainContext, ExtHostSCMShape, ICommandDto, MainThreadTelemetryShape, SCMGroupFeatures, SCMHistoryItemDto, SCMHistoryItemChangeDto, SCMHistoryItemRefDto, SCMActionButtonDto, SCMArtifactGroupDto, SCMArtifactDto } from './extHost.protocol.js';\nimport { sortedDiff, equals } from '../../../base/common/arrays.js';\nimport { comparePaths } from '../../../base/common/comparers.js';\nimport type * as vscode from 'vscode';\nimport { ISplice } from '../../../base/common/sequence.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ExtensionIdentifierMap, IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { MarshalledId } from '../../../base/common/marshallingIds.js';\nimport { ThemeIcon } from '../../../base/common/themables.js';\nimport { IMarkdownString } from '../../../base/common/htmlContent.js';\nimport { MarkdownString, SourceControlInputBoxValidationType } from './extHostTypeConverters.js';\nimport { checkProposedApiEnabled, isProposedApiEnabled } from '../../services/extensions/common/extensions.js';\nimport { ExtHostDocuments } from './extHostDocuments.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { isLinux } from '../../../base/common/platform.js';\nimport { structuralEquals } from '../../../base/common/equals.js';\nimport { Iterable } from '../../../base/common/iterator.js';\n\ntype ProviderHandle = number;\ntype GroupHandle = number;\ntype ResourceStateHandle = number;\n\nfunction isUri(thing: any): thing is vscode.Uri {\n\treturn thing instanceof URI;\n}\n\nfunction uriEquals(a: vscode.Uri, b: vscode.Uri): boolean {\n\tif (a.scheme === Schemas.file && b.scheme === Schemas.file && isLinux) {\n\t\treturn a.toString() === b.toString();\n\t}\n\n\treturn a.toString().toLowerCase() === b.toString().toLowerCase();\n}\n\nfunction getIconResource(decorations?: vscode.SourceControlResourceThemableDecorations): UriComponents | ThemeIcon | undefined {\n\tif (!decorations) {\n\t\treturn undefined;\n\t} else if (typeof decorations.iconPath === 'string') {\n\t\treturn URI.file(decorations.iconPath);\n\t} else if (URI.isUri(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else if (ThemeIcon.isThemeIcon(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else {\n\t\treturn undefined;\n\t}\n}\n\nfunction getHistoryItemIconDto(icon: vscode.Uri | { light: vscode.Uri; dark: vscode.Uri } | vscode.ThemeIcon | undefined): UriComponents | { light: UriComponents; dark: UriComponents } | ThemeIcon | undefined {\n\tif (!icon) {\n\t\treturn undefined;\n\t} else if (URI.isUri(icon)) {\n\t\treturn icon;\n\t} else if (ThemeIcon.isThemeIcon(icon)) {\n\t\treturn icon;\n\t} else {\n\t\tconst iconDto = icon as { light: URI; dark: URI };\n\t\treturn { light: iconDto.light, dark: iconDto.dark };\n\t}\n}\n\nfunction toSCMHistoryItemDto(historyItem: vscode.SourceControlHistoryItem): SCMHistoryItemDto {\n\tconst authorIcon = getHistoryItemIconDto(historyItem.authorIcon);\n\tconst tooltip = MarkdownString.fromStrict(historyItem.tooltip);\n\n\tconst references = historyItem.references?.map(r => ({\n\t\t...r, icon: getHistoryItemIconDto(r.icon)\n\t}));\n\n\treturn { ...historyItem, authorIcon, references, tooltip };\n}\n\nfunction toSCMHistoryItemRefDto(historyItemRef?: vscode.SourceControlHistoryItemRef): SCMHistoryItemRefDto | undefined {\n\treturn historyItemRef ? { ...historyItemRef, icon: getHistoryItemIconDto(historyItemRef.icon) } : undefined;\n}\n\nfunction compareResourceThemableDecorations(a: vscode.SourceControlResourceThemableDecorations, b: vscode.SourceControlResourceThemableDecorations): number {\n\tif (!a.iconPath && !b.iconPath) {\n\t\treturn 0;\n\t} else if (!a.iconPath) {\n\t\treturn -1;\n\t} else if (!b.iconPath) {\n\t\treturn 1;\n\t}\n\n\tconst aPath = typeof a.iconPath === 'string' ? a.iconPath : URI.isUri(a.iconPath) ? a.iconPath.fsPath : (a.iconPath as vscode.ThemeIcon).id;\n\tconst bPath = typeof b.iconPath === 'string' ? b.iconPath : URI.isUri(b.iconPath) ? b.iconPath.fsPath : (b.iconPath as vscode.ThemeIcon).id;\n\treturn comparePaths(aPath, bPath);\n}\n\nfunction compareResourceStatesDecorations(a: vscode.SourceControlResourceDecorations, b: vscode.SourceControlResourceDecorations): number {\n\tlet result = 0;\n\n\tif (a.strikeThrough !== b.strikeThrough) {\n\t\treturn a.strikeThrough ? 1 : -1;\n\t}\n\n\tif (a.faded !== b.faded) {\n\t\treturn a.faded ? 1 : -1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\treturn (a.tooltip || '').localeCompare(b.tooltip || '');\n\t}\n\n\tresult = compareResourceThemableDecorations(a, b);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.light && b.light) {\n\t\tresult = compareResourceThemableDecorations(a.light, b.light);\n\t} else if (a.light) {\n\t\treturn 1;\n\t} else if (b.light) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.dark && b.dark) {\n\t\tresult = compareResourceThemableDecorations(a.dark, b.dark);\n\t} else if (a.dark) {\n\t\treturn 1;\n\t} else if (b.dark) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareCommands(a: vscode.Command, b: vscode.Command): number {\n\tif (a.command !== b.command) {\n\t\treturn a.command < b.command ? -1 : 1;\n\t}\n\n\tif (a.title !== b.title) {\n\t\treturn a.title < b.title ? -1 : 1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\tif (a.tooltip !== undefined && b.tooltip !== undefined) {\n\t\t\treturn a.tooltip < b.tooltip ? -1 : 1;\n\t\t} else if (a.tooltip !== undefined) {\n\t\t\treturn 1;\n\t\t} else if (b.tooltip !== undefined) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (a.arguments === b.arguments) {\n\t\treturn 0;\n\t} else if (!a.arguments) {\n\t\treturn -1;\n\t} else if (!b.arguments) {\n\t\treturn 1;\n\t} else if (a.arguments.length !== b.arguments.length) {\n\t\treturn a.arguments.length - b.arguments.length;\n\t}\n\n\tfor (let i = 0; i < a.arguments.length; i++) {\n\t\tconst aArg = a.arguments[i];\n\t\tconst bArg = b.arguments[i];\n\n\t\tif (aArg === bArg) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (isUri(aArg) && isUri(bArg) && uriEquals(aArg, bArg)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturn aArg < bArg ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\nfunction compareResourceStates(a: vscode.SourceControlResourceState, b: vscode.SourceControlResourceState): number {\n\tlet result = comparePaths(a.resourceUri.fsPath, b.resourceUri.fsPath, true);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.command && b.command) {\n\t\tresult = compareCommands(a.command, b.command);\n\t} else if (a.command) {\n\t\treturn 1;\n\t} else if (b.command) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.decorations && b.decorations) {\n\t\tresult = compareResourceStatesDecorations(a.decorations, b.decorations);\n\t} else if (a.decorations) {\n\t\treturn 1;\n\t} else if (b.decorations) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.multiFileDiffEditorModifiedUri && b.multiFileDiffEditorModifiedUri) {\n\t\tresult = comparePaths(a.multiFileDiffEditorModifiedUri.fsPath, b.multiFileDiffEditorModifiedUri.fsPath, true);\n\t} else if (a.multiFileDiffEditorModifiedUri) {\n\t\treturn 1;\n\t} else if (b.multiFileDiffEditorModifiedUri) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.multiDiffEditorOriginalUri && b.multiDiffEditorOriginalUri) {\n\t\tresult = comparePaths(a.multiDiffEditorOriginalUri.fsPath, b.multiDiffEditorOriginalUri.fsPath, true);\n\t} else if (a.multiDiffEditorOriginalUri) {\n\t\treturn 1;\n\t} else if (b.multiDiffEditorOriginalUri) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareArgs(a: any[], b: any[]): boolean {\n\tfor (let i = 0; i < a.length; i++) {\n\t\tif (a[i] !== b[i]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction commandEquals(a: vscode.Command, b: vscode.Command): boolean {\n\treturn a.command === b.command\n\t\t&& a.title === b.title\n\t\t&& a.tooltip === b.tooltip\n\t\t&& (a.arguments && b.arguments ? compareArgs(a.arguments, b.arguments) : a.arguments === b.arguments);\n}\n\nfunction commandListEquals(a: readonly vscode.Command[], b: readonly vscode.Command[]): boolean {\n\treturn equals(a, b, commandEquals);\n}\n\nexport interface IValidateInput {\n\t(value: string, cursorPosition: number): vscode.ProviderResult<vscode.SourceControlInputBoxValidation | undefined | null>;\n}\n\nexport class ExtHostSCMInputBox implements vscode.SourceControlInputBox {\n\n\t#proxy: MainThreadSCMShape;\n\t#extHostDocuments: ExtHostDocuments;\n\n\tprivate _value: string = '';\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value(value: string) {\n\t\tvalue = value ?? '';\n\t\tthis.#proxy.$setInputBoxValue(this._sourceControlHandle, value);\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<string>();\n\n\tget onDidChange(): Event<string> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _placeholder: string = '';\n\n\tget placeholder(): string {\n\t\treturn this._placeholder;\n\t}\n\n\tset placeholder(placeholder: string) {\n\t\tthis.#proxy.$setInputBoxPlaceholder(this._sourceControlHandle, placeholder);\n\t\tthis._placeholder = placeholder;\n\t}\n\n\tprivate _validateInput: IValidateInput | undefined;\n\n\tget validateInput(): IValidateInput | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\treturn this._validateInput;\n\t}\n\n\tset validateInput(fn: IValidateInput | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\tif (fn && typeof fn !== 'function') {\n\t\t\tthrow new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);\n\t\t}\n\n\t\tthis._validateInput = fn;\n\t\tthis.#proxy.$setValidationProviderIsEnabled(this._sourceControlHandle, !!fn);\n\t}\n\n\tprivate _enabled: boolean = true;\n\n\tget enabled(): boolean {\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(enabled: boolean) {\n\t\tenabled = !!enabled;\n\n\t\tif (this._enabled === enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enabled = enabled;\n\t\tthis.#proxy.$setInputBoxEnablement(this._sourceControlHandle, enabled);\n\t}\n\n\tprivate _visible: boolean = true;\n\n\tget visible(): boolean {\n\t\treturn this._visible;\n\t}\n\n\tset visible(visible: boolean) {\n\t\tvisible = !!visible;\n\n\t\tif (this._visible === visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visible = visible;\n\t\tthis.#proxy.$setInputBoxVisibility(this._sourceControlHandle, visible);\n\t}\n\n\tget document(): vscode.TextDocument {\n\t\tcheckProposedApiEnabled(this._extension, 'scmTextDocument');\n\n\t\treturn this.#extHostDocuments.getDocument(this._documentUri);\n\t}\n\n\tconstructor(private _extension: IExtensionDescription, _extHostDocuments: ExtHostDocuments, proxy: MainThreadSCMShape, private _sourceControlHandle: number, private _documentUri: URI) {\n\t\tthis.#extHostDocuments = _extHostDocuments;\n\t\tthis.#proxy = proxy;\n\t}\n\n\tshowValidationMessage(message: string | vscode.MarkdownString, type: vscode.SourceControlInputBoxValidationType) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\t\tthis.#proxy.$showValidationMessage(this._sourceControlHandle, message, SourceControlInputBoxValidationType.from(type));\n\t}\n\n\t$onInputBoxValueChange(value: string): void {\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate updateValue(value: string): void {\n\t\tthis._value = value;\n\t\tthis._onDidChange.fire(value);\n\t}\n}\n\nclass ExtHostSourceControlResourceGroup implements vscode.SourceControlResourceGroup {\n\n\tprivate static _handlePool: number = 0;\n\tprivate _resourceHandlePool: number = 0;\n\tprivate _resourceStates: vscode.SourceControlResourceState[] = [];\n\n\tprivate _resourceStatesMap = new Map<ResourceStateHandle, vscode.SourceControlResourceState>();\n\tprivate _resourceStatesCommandsMap = new Map<ResourceStateHandle, vscode.Command>();\n\tprivate _resourceStatesDisposablesMap = new Map<ResourceStateHandle, IDisposable>();\n\n\tprivate readonly _onDidUpdateResourceStates = new Emitter<void>();\n\treadonly onDidUpdateResourceStates = this._onDidUpdateResourceStates.event;\n\n\tprivate _disposed = false;\n\tget disposed(): boolean { return this._disposed; }\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\tprivate _handlesSnapshot: number[] = [];\n\tprivate _resourceSnapshot: vscode.SourceControlResourceState[] = [];\n\n\tget id(): string { return this._id; }\n\n\tget label(): string { return this._label; }\n\tset label(label: string) {\n\t\tthis._label = label;\n\t\tthis._proxy.$updateGroupLabel(this._sourceControlHandle, this.handle, label);\n\t}\n\n\tprivate _contextValue: string | undefined = undefined;\n\tget contextValue(): string | undefined {\n\t\treturn this._contextValue;\n\t}\n\tset contextValue(contextValue: string | undefined) {\n\t\tthis._contextValue = contextValue;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tprivate _hideWhenEmpty: boolean | undefined = undefined;\n\tget hideWhenEmpty(): boolean | undefined { return this._hideWhenEmpty; }\n\tset hideWhenEmpty(hideWhenEmpty: boolean | undefined) {\n\t\tthis._hideWhenEmpty = hideWhenEmpty;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tget features(): SCMGroupFeatures {\n\t\treturn {\n\t\t\tcontextValue: this.contextValue,\n\t\t\thideWhenEmpty: this.hideWhenEmpty\n\t\t};\n\t}\n\n\tget resourceStates(): vscode.SourceControlResourceState[] { return [...this._resourceStates]; }\n\tset resourceStates(resources: vscode.SourceControlResourceState[]) {\n\t\tthis._resourceStates = [...resources];\n\t\tthis._onDidUpdateResourceStates.fire();\n\t}\n\n\treadonly handle = ExtHostSourceControlResourceGroup._handlePool++;\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _sourceControlHandle: number,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tpublic readonly multiDiffEditorEnableViewChanges: boolean,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) { }\n\n\tgetResourceState(handle: number): vscode.SourceControlResourceState | undefined {\n\t\treturn this._resourceStatesMap.get(handle);\n\t}\n\n\t$executeResourceCommand(handle: number, preserveFocus: boolean): Promise<void> {\n\t\tconst command = this._resourceStatesCommandsMap.get(handle);\n\n\t\tif (!command) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => this._commands.executeCommand(command.command, ...(command.arguments || []), preserveFocus));\n\t}\n\n\t_takeResourceStateSnapshot(): SCMRawResourceSplice[] {\n\t\tconst snapshot = [...this._resourceStates].sort(compareResourceStates);\n\t\tconst diffs = sortedDiff(this._resourceSnapshot, snapshot, compareResourceStates);\n\n\t\tconst splices = diffs.map<ISplice<{ rawResource: SCMRawResource; handle: number }>>(diff => {\n\t\t\tconst toInsert = diff.toInsert.map(r => {\n\t\t\t\tconst handle = this._resourceHandlePool++;\n\t\t\t\tthis._resourceStatesMap.set(handle, r);\n\n\t\t\t\tconst sourceUri = r.resourceUri;\n\n\t\t\t\tlet command: ICommandDto | undefined;\n\t\t\t\tif (r.command) {\n\t\t\t\t\tif (r.command.command === 'vscode.open' || r.command.command === 'vscode.diff' || r.command.command === 'vscode.changes') {\n\t\t\t\t\t\tconst disposables = new DisposableStore();\n\t\t\t\t\t\tcommand = this._commands.converter.toInternal(r.command, disposables);\n\t\t\t\t\t\tthis._resourceStatesDisposablesMap.set(handle, disposables);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._resourceStatesCommandsMap.set(handle, r.command);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst hasScmMultiDiffEditorProposalEnabled = isProposedApiEnabled(this._extension, 'scmMultiDiffEditor');\n\t\t\t\tconst multiFileDiffEditorOriginalUri = hasScmMultiDiffEditorProposalEnabled ? r.multiDiffEditorOriginalUri : undefined;\n\t\t\t\tconst multiFileDiffEditorModifiedUri = hasScmMultiDiffEditorProposalEnabled ? r.multiFileDiffEditorModifiedUri : undefined;\n\n\t\t\t\tconst icon = getIconResource(r.decorations);\n\t\t\t\tconst lightIcon = r.decorations && getIconResource(r.decorations.light) || icon;\n\t\t\t\tconst darkIcon = r.decorations && getIconResource(r.decorations.dark) || icon;\n\t\t\t\tconst icons: SCMRawResource[2] = [lightIcon, darkIcon];\n\n\t\t\t\tconst tooltip = (r.decorations && r.decorations.tooltip) || '';\n\t\t\t\tconst strikeThrough = r.decorations && !!r.decorations.strikeThrough;\n\t\t\t\tconst faded = r.decorations && !!r.decorations.faded;\n\t\t\t\tconst contextValue = r.contextValue || '';\n\n\t\t\t\tconst rawResource = [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command, multiFileDiffEditorOriginalUri, multiFileDiffEditorModifiedUri] as SCMRawResource;\n\n\t\t\t\treturn { rawResource, handle };\n\t\t\t});\n\n\t\t\treturn { start: diff.start, deleteCount: diff.deleteCount, toInsert };\n\t\t});\n\n\t\tconst rawResourceSplices = splices\n\t\t\t.map(({ start, deleteCount, toInsert }) => [start, deleteCount, toInsert.map(i => i.rawResource)] as SCMRawResourceSplice);\n\n\t\tconst reverseSplices = splices.reverse();\n\n\t\tfor (const { start, deleteCount, toInsert } of reverseSplices) {\n\t\t\tconst handles = toInsert.map(i => i.handle);\n\t\t\tconst handlesToDelete = this._handlesSnapshot.splice(start, deleteCount, ...handles);\n\n\t\t\tfor (const handle of handlesToDelete) {\n\t\t\t\tthis._resourceStatesMap.delete(handle);\n\t\t\t\tthis._resourceStatesCommandsMap.delete(handle);\n\t\t\t\tthis._resourceStatesDisposablesMap.get(handle)?.dispose();\n\t\t\t\tthis._resourceStatesDisposablesMap.delete(handle);\n\t\t\t}\n\t\t}\n\n\t\tthis._resourceSnapshot = snapshot;\n\t\treturn rawResourceSplices;\n\t}\n\n\tdispose(): void {\n\t\tthis._disposed = true;\n\t\tthis._onDidDispose.fire();\n\t}\n}\n\nclass ExtHostSourceControl implements vscode.SourceControl {\n\n\tprivate static _handlePool: number = 0;\n\n\treadonly onDidDisposeParent: Event<void>;\n\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\n\t#proxy: MainThreadSCMShape;\n\n\tprivate _groups: Map<GroupHandle, ExtHostSourceControlResourceGroup> = new Map<GroupHandle, ExtHostSourceControlResourceGroup>();\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tget rootUri(): vscode.Uri | undefined {\n\t\treturn this._rootUri;\n\t}\n\n\tprivate _contextValue: string | undefined = undefined;\n\n\tget contextValue(): string | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmProviderOptions');\n\t\treturn this._contextValue;\n\t}\n\n\tset contextValue(contextValue: string | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmProviderOptions');\n\n\t\tif (this._contextValue === contextValue) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._contextValue = contextValue;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { contextValue });\n\t}\n\n\tprivate _inputBox: ExtHostSCMInputBox;\n\tget inputBox(): ExtHostSCMInputBox { return this._inputBox; }\n\n\tprivate _count: number | undefined = undefined;\n\n\tget count(): number | undefined {\n\t\treturn this._count;\n\t}\n\n\tset count(count: number | undefined) {\n\t\tif (this._count === count) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._count = count;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { count });\n\t}\n\n\tprivate _quickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget quickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\treturn this._quickDiffProvider;\n\t}\n\n\tset quickDiffProvider(quickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tthis._quickDiffProvider = quickDiffProvider;\n\t\tlet quickDiffLabel = undefined;\n\t\tif (isProposedApiEnabled(this._extension, 'quickDiffProvider')) {\n\t\t\tquickDiffLabel = quickDiffProvider?.label;\n\t\t}\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasQuickDiffProvider: !!quickDiffProvider, quickDiffLabel });\n\t}\n\n\tprivate _secondaryQuickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget secondaryQuickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'quickDiffProvider');\n\t\treturn this._secondaryQuickDiffProvider;\n\t}\n\n\tset secondaryQuickDiffProvider(secondaryQuickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'quickDiffProvider');\n\n\t\tthis._secondaryQuickDiffProvider = secondaryQuickDiffProvider;\n\t\tconst secondaryQuickDiffLabel = secondaryQuickDiffProvider?.label;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasSecondaryQuickDiffProvider: !!secondaryQuickDiffProvider, secondaryQuickDiffLabel });\n\t}\n\n\tprivate _historyProvider: vscode.SourceControlHistoryProvider | undefined;\n\tprivate readonly _historyProviderDisposable = new MutableDisposable<DisposableStore>();\n\n\tget historyProvider(): vscode.SourceControlHistoryProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmHistoryProvider');\n\t\treturn this._historyProvider;\n\t}\n\n\tset historyProvider(historyProvider: vscode.SourceControlHistoryProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmHistoryProvider');\n\n\t\tthis._historyProvider = historyProvider;\n\t\tthis._historyProviderDisposable.value = new DisposableStore();\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasHistoryProvider: !!historyProvider });\n\n\t\tif (historyProvider) {\n\t\t\tthis._historyProviderDisposable.value.add(historyProvider.onDidChangeCurrentHistoryItemRefs(() => {\n\t\t\t\tconst historyItemRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemRef);\n\t\t\t\tconst historyItemRemoteRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemRemoteRef);\n\t\t\t\tconst historyItemBaseRef = toSCMHistoryItemRefDto(historyProvider?.currentHistoryItemBaseRef);\n\n\t\t\t\tthis.#proxy.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle, historyItemRef, historyItemRemoteRef, historyItemBaseRef);\n\t\t\t}));\n\t\t\tthis._historyProviderDisposable.value.add(historyProvider.onDidChangeHistoryItemRefs((e) => {\n\t\t\t\tif (e.added.length === 0 && e.modified.length === 0 && e.removed.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst added = e.added.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\t\t\t\tconst modified = e.modified.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\t\t\t\tconst removed = e.removed.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) }));\n\n\t\t\t\tthis.#proxy.$onDidChangeHistoryProviderHistoryItemRefs(this.handle, { added, modified, removed, silent: e.silent });\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _artifactProvider: vscode.SourceControlArtifactProvider | undefined;\n\tprivate readonly _artifactProviderDisposable = new MutableDisposable<DisposableStore>();\n\n\tget artifactProvider(): vscode.SourceControlArtifactProvider | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmArtifactProvider');\n\t\treturn this._artifactProvider;\n\t}\n\n\tset artifactProvider(artifactProvider: vscode.SourceControlArtifactProvider | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmArtifactProvider');\n\n\t\tthis._artifactProvider = artifactProvider;\n\t\tthis._artifactProviderDisposable.value = new DisposableStore();\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasArtifactProvider: !!artifactProvider });\n\n\t\tif (artifactProvider) {\n\t\t\tthis._artifactProviderDisposable.value.add(artifactProvider.onDidChangeArtifacts((groups: string[]) => {\n\t\t\t\tif (groups.length !== 0) {\n\t\t\t\t\tthis.#proxy.$onDidChangeArtifacts(this.handle, groups);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _commitTemplate: string | undefined = undefined;\n\n\tget commitTemplate(): string | undefined {\n\t\treturn this._commitTemplate;\n\t}\n\n\tset commitTemplate(commitTemplate: string | undefined) {\n\t\tif (commitTemplate === this._commitTemplate) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._commitTemplate = commitTemplate;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { commitTemplate });\n\t}\n\n\tprivate readonly _acceptInputDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _acceptInputCommand: vscode.Command | undefined = undefined;\n\n\tget acceptInputCommand(): vscode.Command | undefined {\n\t\treturn this._acceptInputCommand;\n\t}\n\n\tset acceptInputCommand(acceptInputCommand: vscode.Command | undefined) {\n\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\n\t\tthis._acceptInputCommand = acceptInputCommand;\n\n\t\tconst internal = this._commands.converter.toInternal(acceptInputCommand, this._acceptInputDisposables.value);\n\t\tthis.#proxy.$updateSourceControl(this.handle, { acceptInputCommand: internal });\n\t}\n\n\t// We know what we're doing here:\n\t// eslint-disable-next-line local/code-no-potentially-unsafe-disposables\n\tprivate _actionButtonDisposables = new DisposableStore();\n\tprivate _actionButton: vscode.SourceControlActionButton | undefined;\n\tget actionButton(): vscode.SourceControlActionButton | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\t\treturn this._actionButton;\n\t}\n\n\tset actionButton(actionButton: vscode.SourceControlActionButton | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\n\t\t// We have to do this check before converting the command to it's internal\n\t\t// representation since that would always create a command with a unique\n\t\t// identifier\n\t\tif (structuralEquals(this._actionButton, actionButton)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// In order to prevent disposing the action button command that are still rendered in the UI\n\t\t// until the next UI update, we ensure to dispose them after the update has been completed.\n\t\tconst oldActionButtonDisposables = this._actionButtonDisposables;\n\t\tthis._actionButtonDisposables = new DisposableStore();\n\n\t\tthis._actionButton = actionButton;\n\n\t\tconst actionButtonDto = actionButton !== undefined ?\n\t\t\t{\n\t\t\t\tcommand: {\n\t\t\t\t\t...this._commands.converter.toInternal(actionButton.command, this._actionButtonDisposables),\n\t\t\t\t\tshortTitle: actionButton.command.shortTitle\n\t\t\t\t},\n\t\t\t\tsecondaryCommands: actionButton.secondaryCommands?.map(commandGroup => {\n\t\t\t\t\treturn commandGroup.map(command => this._commands.converter.toInternal(command, this._actionButtonDisposables));\n\t\t\t\t}),\n\t\t\t\tenabled: actionButton.enabled\n\t\t\t} satisfies SCMActionButtonDto : null;\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { actionButton: actionButtonDto })\n\t\t\t.finally(() => oldActionButtonDisposables.dispose());\n\t}\n\n\t// We know what we're doing here:\n\t// eslint-disable-next-line local/code-no-potentially-unsafe-disposables\n\tprivate _statusBarDisposables = new DisposableStore();\n\tprivate _statusBarCommands: vscode.Command[] | undefined = undefined;\n\n\tget statusBarCommands(): vscode.Command[] | undefined {\n\t\treturn this._statusBarCommands;\n\t}\n\n\tset statusBarCommands(statusBarCommands: vscode.Command[] | undefined) {\n\t\tif (this._statusBarCommands && statusBarCommands && commandListEquals(this._statusBarCommands, statusBarCommands)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// In order to prevent disposing status bar commands that are still rendered in the UI\n\t\t// until the next UI update, we ensure to dispose them after the update has been completed.\n\t\tconst oldStatusBarDisposables = this._statusBarDisposables;\n\t\tthis._statusBarDisposables = new DisposableStore();\n\n\t\tthis._statusBarCommands = statusBarCommands;\n\n\t\tconst internal = (statusBarCommands || []).map(c => this._commands.converter.toInternal(c, this._statusBarDisposables)) as ICommandDto[];\n\n\t\tthis.#proxy.$updateSourceControl(this.handle, { statusBarCommands: internal })\n\t\t\t.finally(() => oldStatusBarDisposables.dispose());\n\t}\n\n\tprivate _selected: boolean = false;\n\n\tget selected(): boolean {\n\t\treturn this._selected;\n\t}\n\n\tprivate readonly _onDidChangeSelection = new Emitter<boolean>();\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\treadonly handle: number = ExtHostSourceControl._handlePool++;\n\n\tconstructor(\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\t_extHostDocuments: ExtHostDocuments,\n\t\tproxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tprivate _rootUri?: vscode.Uri,\n\t\t_iconPath?: vscode.IconPath,\n\t\t_parent?: ExtHostSourceControl\n\t) {\n\t\tthis.#proxy = proxy;\n\n\t\tconst inputBoxDocumentUri = URI.from({\n\t\t\tscheme: Schemas.vscodeSourceControl,\n\t\t\tpath: `${_id}/scm${this.handle}/input`,\n\t\t\tquery: _rootUri ? `rootUri=${encodeURIComponent(_rootUri.toString())}` : undefined\n\t\t});\n\n\t\tthis._inputBox = new ExtHostSCMInputBox(_extension, _extHostDocuments, this.#proxy, this.handle, inputBoxDocumentUri);\n\t\tthis.#proxy.$registerSourceControl(this.handle, _parent?.handle, _id, _label, _rootUri, getHistoryItemIconDto(_iconPath), inputBoxDocumentUri);\n\n\t\tthis.onDidDisposeParent = _parent ? _parent.onDidDispose : Event.None;\n\t}\n\n\tprivate createdResourceGroups = new Map<ExtHostSourceControlResourceGroup, IDisposable>();\n\tprivate updatedResourceGroups = new Set<ExtHostSourceControlResourceGroup>();\n\n\tcreateResourceGroup(id: string, label: string, options?: { multiDiffEditorEnableViewChanges?: boolean }): ExtHostSourceControlResourceGroup {\n\t\tconst multiDiffEditorEnableViewChanges = isProposedApiEnabled(this._extension, 'scmMultiDiffEditor') && options?.multiDiffEditorEnableViewChanges === true;\n\t\tconst group = new ExtHostSourceControlResourceGroup(this.#proxy, this._commands, this.handle, id, label, multiDiffEditorEnableViewChanges, this._extension);\n\t\tconst disposable = Event.once(group.onDidDispose)(() => this.createdResourceGroups.delete(group));\n\t\tthis.createdResourceGroups.set(group, disposable);\n\t\tthis.eventuallyAddResourceGroups();\n\t\treturn group;\n\t}\n\n\t@debounce(100)\n\teventuallyAddResourceGroups(): void {\n\t\tconst groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures, /*multiDiffEditorEnableViewChanges*/ boolean][] = [];\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tfor (const [group, disposable] of this.createdResourceGroups) {\n\t\t\tdisposable.dispose();\n\n\t\t\tconst updateListener = group.onDidUpdateResourceStates(() => {\n\t\t\t\tthis.updatedResourceGroups.add(group);\n\t\t\t\tthis.eventuallyUpdateResourceStates();\n\t\t\t});\n\n\t\t\tEvent.once(group.onDidDispose)(() => {\n\t\t\t\tthis.updatedResourceGroups.delete(group);\n\t\t\t\tupdateListener.dispose();\n\t\t\t\tthis._groups.delete(group.handle);\n\t\t\t\tthis.#proxy.$unregisterGroup(this.handle, group.handle);\n\t\t\t});\n\n\t\t\tgroups.push([group.handle, group.id, group.label, group.features, group.multiDiffEditorEnableViewChanges]);\n\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length > 0) {\n\t\t\t\tsplices.push([group.handle, snapshot]);\n\t\t\t}\n\n\t\t\tthis._groups.set(group.handle, group);\n\t\t}\n\n\t\tthis.#proxy.$registerGroups(this.handle, groups, splices);\n\t\tthis.createdResourceGroups.clear();\n\t}\n\n\t@debounce(100)\n\teventuallyUpdateResourceStates(): void {\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tthis.updatedResourceGroups.forEach(group => {\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsplices.push([group.handle, snapshot]);\n\t\t});\n\n\t\tif (splices.length > 0) {\n\t\t\tthis.#proxy.$spliceResourceStates(this.handle, splices);\n\t\t}\n\n\t\tthis.updatedResourceGroups.clear();\n\t}\n\n\tgetResourceGroup(handle: GroupHandle): ExtHostSourceControlResourceGroup | undefined {\n\t\treturn this._groups.get(handle);\n\t}\n\n\tsetSelectionState(selected: boolean): void {\n\t\tthis._selected = selected;\n\t\tthis._onDidChangeSelection.fire(selected);\n\t}\n\n\tdispose(): void {\n\t\tthis._acceptInputDisposables.dispose();\n\t\tthis._actionButtonDisposables.dispose();\n\t\tthis._statusBarDisposables.dispose();\n\t\tthis._historyProviderDisposable.dispose();\n\t\tthis._artifactProviderDisposable.dispose();\n\n\t\tthis._groups.forEach(group => group.dispose());\n\t\tthis.#proxy.$unregisterSourceControl(this.handle);\n\n\t\tthis._onDidDispose.fire();\n\t\tthis._onDidDispose.dispose();\n\t}\n}\n\nexport class ExtHostSCM implements ExtHostSCMShape {\n\n\tprivate _proxy: MainThreadSCMShape;\n\tprivate readonly _telemetry: MainThreadTelemetryShape;\n\tprivate _sourceControls: Map<ProviderHandle, ExtHostSourceControl> = new Map<ProviderHandle, ExtHostSourceControl>();\n\tprivate _sourceControlsByExtension: ExtensionIdentifierMap<ExtHostSourceControl[]> = new ExtensionIdentifierMap<ExtHostSourceControl[]>();\n\n\tprivate readonly _onDidChangeActiveProvider = new Emitter<vscode.SourceControl>();\n\tget onDidChangeActiveProvider(): Event<vscode.SourceControl> { return this._onDidChangeActiveProvider.event; }\n\n\tprivate _selectedSourceControlHandle: number | undefined;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _extHostDocuments: ExtHostDocuments,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadSCM);\n\t\tthis._telemetry = mainContext.getProxy(MainContext.MainThreadTelemetry);\n\n\t\t_commands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (arg && arg.$mid === MarshalledId.ScmResource) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst group = sourceControl.getResourceGroup(arg.groupHandle);\n\n\t\t\t\t\tif (!group) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn group.getResourceState(arg.handle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmResourceGroup) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl.getResourceGroup(arg.groupHandle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmProvider) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.handle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl;\n\t\t\t\t}\n\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateSourceControl(extension: IExtensionDescription, id: string, label: string, rootUri: vscode.Uri | undefined, iconPath: vscode.IconPath | undefined, parent: vscode.SourceControl | undefined): vscode.SourceControl {\n\t\tthis.logService.trace('ExtHostSCM#createSourceControl', extension.identifier.value, id, label, rootUri);\n\n\t\ttype TEvent = { extensionId: string };\n\t\ttype TMeta = {\n\t\t\towner: 'joaomoreno';\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The ID of the extension contributing to the Source Control API.' };\n\t\t\tcomment: 'This is used to know what extensions contribute to the Source Control API.';\n\t\t};\n\t\tthis._telemetry.$publicLog2<TEvent, TMeta>('api/scm/createSourceControl', {\n\t\t\textensionId: extension.identifier.value,\n\t\t});\n\n\t\tconst parentSourceControl = parent ? Iterable.find(this._sourceControls.values(), s => s === parent) : undefined;\n\t\tconst sourceControl = new ExtHostSourceControl(extension, this._extHostDocuments, this._proxy, this._commands, id, label, rootUri, iconPath, parentSourceControl);\n\t\tthis._sourceControls.set(sourceControl.handle, sourceControl);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(extension.identifier) || [];\n\t\tsourceControls.push(sourceControl);\n\t\tthis._sourceControlsByExtension.set(extension.identifier, sourceControls);\n\n\t\treturn sourceControl;\n\t}\n\n\t// Deprecated\n\tgetLastInputBox(extension: IExtensionDescription): ExtHostSCMInputBox | undefined {\n\t\tthis.logService.trace('ExtHostSCM#getLastInputBox', extension.identifier.value);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(extension.identifier);\n\t\tconst sourceControl = sourceControls && sourceControls[sourceControls.length - 1];\n\t\treturn sourceControl && sourceControl.inputBox;\n\t}\n\n\t$provideOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.quickDiffProvider || !sourceControl.quickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.quickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$provideSecondaryOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideSecondaryOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.secondaryQuickDiffProvider || !sourceControl.secondaryQuickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.secondaryQuickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$onInputBoxValueChange(sourceControlHandle: number, value: string): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$onInputBoxValueChange', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tsourceControl.inputBox.$onInputBoxValueChange(value);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$executeResourceCommand(sourceControlHandle: number, groupHandle: number, handle: number, preserveFocus: boolean): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$executeResourceCommand', sourceControlHandle, groupHandle, handle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst group = sourceControl.getResourceGroup(groupHandle);\n\n\t\tif (!group) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn group.$executeResourceCommand(handle, preserveFocus);\n\t}\n\n\t$validateInput(sourceControlHandle: number, value: string, cursorPosition: number): Promise<[string | IMarkdownString, number] | undefined> {\n\t\tthis.logService.trace('ExtHostSCM#$validateInput', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tif (!sourceControl.inputBox.validateInput) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.inputBox.validateInput!(value, cursorPosition)).then(result => {\n\t\t\tif (!result) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\tconst message = MarkdownString.fromStrict(result.message);\n\t\t\tif (!message) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\treturn Promise.resolve<[string | IMarkdownString, number]>([message, result.type]);\n\t\t});\n\t}\n\n\t$setSelectedSourceControl(selectedSourceControlHandle: number | undefined): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$setSelectedSourceControl', selectedSourceControlHandle);\n\n\t\tif (selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(selectedSourceControlHandle)?.setSelectionState(true);\n\t\t}\n\n\t\tif (this._selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false);\n\t\t}\n\n\t\tthis._selectedSourceControlHandle = selectedSourceControlHandle;\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tasync $resolveHistoryItem(sourceControlHandle: number, historyItemId: string, token: CancellationToken): Promise<SCMHistoryItemDto | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst historyItem = await historyProvider?.resolveHistoryItem(historyItemId, token);\n\n\t\t\treturn historyItem ? toSCMHistoryItemDto(historyItem) : undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItem', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemChatContext(sourceControlHandle: number, historyItemId: string, token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst chatContext = await historyProvider?.resolveHistoryItemChatContext(historyItemId, token);\n\n\t\t\treturn chatContext ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemChatContext', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemChangeRangeChatContext(sourceControlHandle: number, historyItemId: string, historyItemParentId: string, path: string, token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst chatContext = await historyProvider?.resolveHistoryItemChangeRangeChatContext?.(historyItemId, historyItemParentId, path, token);\n\n\t\t\treturn chatContext ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemChangeRangeChatContext', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $resolveHistoryItemRefsCommonAncestor(sourceControlHandle: number, historyItemRefs: string[], token: CancellationToken): Promise<string | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst ancestor = await historyProvider?.resolveHistoryItemRefsCommonAncestor(historyItemRefs, token);\n\n\t\t\treturn ancestor ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$resolveHistoryItemRefsCommonAncestor', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItemRefs(sourceControlHandle: number, historyItemRefs: string[] | undefined, token: CancellationToken): Promise<SCMHistoryItemRefDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst refs = await historyProvider?.provideHistoryItemRefs(historyItemRefs, token);\n\n\t\t\treturn refs?.map(ref => ({ ...ref, icon: getHistoryItemIconDto(ref.icon) })) ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItemRefs', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItems(sourceControlHandle: number, options: vscode.SourceControlHistoryOptions, token: CancellationToken): Promise<SCMHistoryItemDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst historyItems = await historyProvider?.provideHistoryItems(options, token);\n\n\t\t\treturn historyItems?.map(item => toSCMHistoryItemDto(item)) ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItems', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideHistoryItemChanges(sourceControlHandle: number, historyItemId: string, historyItemParentId: string | undefined, token: CancellationToken): Promise<SCMHistoryItemChangeDto[] | undefined> {\n\t\ttry {\n\t\t\tconst historyProvider = this._sourceControls.get(sourceControlHandle)?.historyProvider;\n\t\t\tconst changes = await historyProvider?.provideHistoryItemChanges(historyItemId, historyItemParentId, token);\n\n\t\t\treturn changes ?? undefined;\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideHistoryItemChanges', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideArtifactGroups(sourceControlHandle: number, token: CancellationToken): Promise<SCMArtifactGroupDto[] | undefined> {\n\t\ttry {\n\t\t\tconst artifactProvider = this._sourceControls.get(sourceControlHandle)?.artifactProvider;\n\t\t\tconst groups = await artifactProvider?.provideArtifactGroups(token);\n\n\t\t\treturn groups?.map(group => ({\n\t\t\t\t...group,\n\t\t\t\ticon: getHistoryItemIconDto(group.icon)\n\t\t\t}));\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideArtifactGroups', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tasync $provideArtifacts(sourceControlHandle: number, group: string, token: CancellationToken): Promise<SCMArtifactDto[] | undefined> {\n\t\ttry {\n\t\t\tconst artifactProvider = this._sourceControls.get(sourceControlHandle)?.artifactProvider;\n\t\t\tconst artifacts = await artifactProvider?.provideArtifacts(group, token);\n\n\t\t\treturn artifacts?.map(artifact => ({\n\t\t\t\t...artifact,\n\t\t\t\ticon: getHistoryItemIconDto(artifact.icon)\n\t\t\t}));\n\t\t}\n\t\tcatch (err) {\n\t\t\tthis.logService.error('ExtHostSCM#$provideArtifacts', err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n"]}