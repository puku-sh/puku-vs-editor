{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/common/extHostFileSystemEventService.ts","vs/workbench/api/common/extHostFileSystemEventService.ts"],"names":[],"mappings":"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","file":"extHostFileSystemEventService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event, AsyncEmitter, IWaitUntil, IWaitUntilData } from '../../../base/common/event.js';\nimport { GLOBSTAR, GLOB_SPLIT, IRelativePattern, parse } from '../../../base/common/glob.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ExtHostDocumentsAndEditors } from './extHostDocumentsAndEditors.js';\nimport type * as vscode from 'vscode';\nimport { ExtHostFileSystemEventServiceShape, FileSystemEvents, IMainContext, SourceTargetPair, IWorkspaceEditDto, IWillRunFileOperationParticipation, MainContext, IRelativePatternDto } from './extHost.protocol.js';\nimport * as typeConverter from './extHostTypeConverters.js';\nimport { Disposable, WorkspaceEdit } from './extHostTypes.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { FileChangeFilter, FileOperation, IGlobPatterns } from '../../../platform/files/common/files.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { IExtHostWorkspace } from './extHostWorkspace.js';\nimport { Lazy } from '../../../base/common/lazy.js';\nimport { ExtHostConfigProvider } from './extHostConfiguration.js';\nimport { rtrim } from '../../../base/common/strings.js';\nimport { normalizeWatcherPattern } from '../../../platform/files/common/watcher.js';\n\nexport interface FileSystemWatcherCreateOptions {\n\treadonly ignoreCreateEvents?: boolean;\n\treadonly ignoreChangeEvents?: boolean;\n\treadonly ignoreDeleteEvents?: boolean;\n}\n\nclass FileSystemWatcher implements vscode.FileSystemWatcher {\n\n\tprivate readonly session = Math.random();\n\n\tprivate readonly _onDidCreate = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidChange = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidDelete = new Emitter<vscode.Uri>();\n\n\tprivate _disposable: Disposable;\n\tprivate _config: number;\n\n\tget ignoreCreateEvents(): boolean {\n\t\treturn Boolean(this._config & 0b001);\n\t}\n\n\tget ignoreChangeEvents(): boolean {\n\t\treturn Boolean(this._config & 0b010);\n\t}\n\n\tget ignoreDeleteEvents(): boolean {\n\t\treturn Boolean(this._config & 0b100);\n\t}\n\n\tconstructor(mainContext: IMainContext, configuration: ExtHostConfigProvider, workspace: IExtHostWorkspace, extension: IExtensionDescription, dispatcher: Event<FileSystemEvents>, globPattern: string | IRelativePatternDto, options: FileSystemWatcherCreateOptions) {\n\t\tthis._config = 0;\n\t\tif (options.ignoreCreateEvents) {\n\t\t\tthis._config += 0b001;\n\t\t}\n\t\tif (options.ignoreChangeEvents) {\n\t\t\tthis._config += 0b010;\n\t\t}\n\t\tif (options.ignoreDeleteEvents) {\n\t\t\tthis._config += 0b100;\n\t\t}\n\n\t\tconst parsedPattern = parse(globPattern);\n\n\t\t// 1.64.x behaviour change: given the new support to watch any folder\n\t\t// we start to ignore events outside the workspace when only a string\n\t\t// pattern is provided to avoid sending events to extensions that are\n\t\t// unexpected.\n\t\t// https://github.com/microsoft/vscode/issues/3025\n\t\tconst excludeOutOfWorkspaceEvents = typeof globPattern === 'string';\n\n\t\t// 1.84.x introduces new proposed API for a watcher to set exclude\n\t\t// rules. In these cases, we turn the file watcher into correlation\n\t\t// mode and ignore any event that does not match the correlation ID.\n\t\t//\n\t\t// Update (Feb 2025): proposal is discontinued, so the previous\n\t\t// `options.correlate` is always `false`.\n\t\tconst excludeUncorrelatedEvents = false;\n\n\t\tconst subscription = dispatcher(events => {\n\t\t\tif (typeof events.session === 'number' && events.session !== this.session) {\n\t\t\t\treturn; // ignore events from other file watchers that are in correlation mode\n\t\t\t}\n\n\t\t\tif (excludeUncorrelatedEvents && typeof events.session === 'undefined') {\n\t\t\t\treturn; // ignore events from other non-correlating file watcher when we are in correlation mode\n\t\t\t}\n\n\t\t\tif (!options.ignoreCreateEvents) {\n\t\t\t\tfor (const created of events.created) {\n\t\t\t\t\tconst uri = URI.revive(created);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidCreate.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!options.ignoreChangeEvents) {\n\t\t\t\tfor (const changed of events.changed) {\n\t\t\t\t\tconst uri = URI.revive(changed);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidChange.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!options.ignoreDeleteEvents) {\n\t\t\t\tfor (const deleted of events.deleted) {\n\t\t\t\t\tconst uri = URI.revive(deleted);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidDelete.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._disposable = Disposable.from(this.ensureWatching(mainContext, workspace, configuration, extension, globPattern, options, false), this._onDidCreate, this._onDidChange, this._onDidDelete, subscription);\n\t}\n\n\tprivate ensureWatching(mainContext: IMainContext, workspace: IExtHostWorkspace, configuration: ExtHostConfigProvider, extension: IExtensionDescription, globPattern: string | IRelativePatternDto, options: FileSystemWatcherCreateOptions, correlate: boolean | undefined): Disposable {\n\t\tconst disposable = Disposable.from();\n\n\t\tif (typeof globPattern === 'string') {\n\t\t\treturn disposable; // workspace is already watched by default, no need to watch again!\n\t\t}\n\n\t\tif (options.ignoreChangeEvents && options.ignoreCreateEvents && options.ignoreDeleteEvents) {\n\t\t\treturn disposable; // no need to watch if we ignore all events\n\t\t}\n\n\t\tconst proxy = mainContext.getProxy(MainContext.MainThreadFileSystemEventService);\n\n\t\tlet recursive = false;\n\t\tif (globPattern.pattern.includes(GLOBSTAR) || globPattern.pattern.includes(GLOB_SPLIT)) {\n\t\t\trecursive = true; // only watch recursively if pattern indicates the need for it\n\t\t}\n\n\t\tconst excludes = [];\n\t\tlet includes: Array<string | IRelativePattern> | undefined = undefined;\n\t\tlet filter: FileChangeFilter | undefined;\n\n\t\t// Correlated: adjust filter based on arguments\n\t\tif (correlate) {\n\t\t\tif (options.ignoreChangeEvents || options.ignoreCreateEvents || options.ignoreDeleteEvents) {\n\t\t\t\tfilter = FileChangeFilter.UPDATED | FileChangeFilter.ADDED | FileChangeFilter.DELETED;\n\n\t\t\t\tif (options.ignoreChangeEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.UPDATED;\n\t\t\t\t}\n\n\t\t\t\tif (options.ignoreCreateEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.ADDED;\n\t\t\t\t}\n\n\t\t\t\tif (options.ignoreDeleteEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.DELETED;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Uncorrelated: adjust includes and excludes based on settings\n\t\telse {\n\n\t\t\t// Automatically add `files.watcherExclude` patterns when watching\n\t\t\t// recursively to give users a chance to configure exclude rules\n\t\t\t// for reducing the overhead of watching recursively\n\t\t\tif (recursive && excludes.length === 0) {\n\t\t\t\tconst workspaceFolder = workspace.getWorkspaceFolder(URI.revive(globPattern.baseUri));\n\t\t\t\tconst watcherExcludes = configuration.getConfiguration('files', workspaceFolder).get<IGlobPatterns>('watcherExclude');\n\t\t\t\tif (watcherExcludes) {\n\t\t\t\t\tfor (const key in watcherExcludes) {\n\t\t\t\t\t\tif (key && watcherExcludes[key] === true) {\n\t\t\t\t\t\t\texcludes.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Non-recursive watching inside the workspace will overlap with\n\t\t\t// our standard workspace watchers. To prevent duplicate events,\n\t\t\t// we only want to include events for files that are otherwise\n\t\t\t// excluded via `files.watcherExclude`. As such, we configure\n\t\t\t// to include each configured exclude pattern so that only those\n\t\t\t// events are reported that are otherwise excluded.\n\t\t\t// However, we cannot just use the pattern as is, because a pattern\n\t\t\t// such as `bar` for a exclude, will work to exclude any of\n\t\t\t// `<workspace path>/bar` but will not work as include for files within\n\t\t\t// `bar` unless a suffix of `/**` if added.\n\t\t\t// (https://github.com/microsoft/vscode/issues/148245)\n\t\t\telse if (!recursive) {\n\t\t\t\tconst workspaceFolder = workspace.getWorkspaceFolder(URI.revive(globPattern.baseUri));\n\t\t\t\tif (workspaceFolder) {\n\t\t\t\t\tconst watcherExcludes = configuration.getConfiguration('files', workspaceFolder).get<IGlobPatterns>('watcherExclude');\n\t\t\t\t\tif (watcherExcludes) {\n\t\t\t\t\t\tfor (const key in watcherExcludes) {\n\t\t\t\t\t\t\tif (key && watcherExcludes[key] === true) {\n\t\t\t\t\t\t\t\tconst includePattern = `${rtrim(key, '/')}/${GLOBSTAR}`;\n\t\t\t\t\t\t\t\tif (!includes) {\n\t\t\t\t\t\t\t\t\tincludes = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tincludes.push(normalizeWatcherPattern(workspaceFolder.uri.fsPath, includePattern));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Still ignore watch request if there are actually no configured\n\t\t\t\t\t// exclude rules, because in that case our default recursive watcher\n\t\t\t\t\t// should be able to take care of all events.\n\t\t\t\t\tif (!includes || includes.length === 0) {\n\t\t\t\t\t\treturn disposable;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproxy.$watch(extension.identifier.value, this.session, globPattern.baseUri, { recursive, excludes, includes, filter }, Boolean(correlate));\n\n\t\treturn Disposable.from({ dispose: () => proxy.$unwatch(this.session) });\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tget onDidCreate(): Event<vscode.Uri> {\n\t\treturn this._onDidCreate.event;\n\t}\n\n\tget onDidChange(): Event<vscode.Uri> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tget onDidDelete(): Event<vscode.Uri> {\n\t\treturn this._onDidDelete.event;\n\t}\n}\n\ninterface IExtensionListener<E> {\n\textension: IExtensionDescription;\n\t(e: E): any;\n}\n\nclass LazyRevivedFileSystemEvents implements FileSystemEvents {\n\n\treadonly session: number | undefined;\n\n\tprivate _created = new Lazy(() => this._events.created.map(URI.revive) as URI[]);\n\tget created(): URI[] { return this._created.value; }\n\n\tprivate _changed = new Lazy(() => this._events.changed.map(URI.revive) as URI[]);\n\tget changed(): URI[] { return this._changed.value; }\n\n\tprivate _deleted = new Lazy(() => this._events.deleted.map(URI.revive) as URI[]);\n\tget deleted(): URI[] { return this._deleted.value; }\n\n\tconstructor(private readonly _events: FileSystemEvents) {\n\t\tthis.session = this._events.session;\n\t}\n}\n\nexport class ExtHostFileSystemEventService implements ExtHostFileSystemEventServiceShape {\n\n\tprivate readonly _onFileSystemEvent = new Emitter<FileSystemEvents>();\n\n\tprivate readonly _onDidRenameFile = new Emitter<vscode.FileRenameEvent>();\n\tprivate readonly _onDidCreateFile = new Emitter<vscode.FileCreateEvent>();\n\tprivate readonly _onDidDeleteFile = new Emitter<vscode.FileDeleteEvent>();\n\tprivate readonly _onWillRenameFile = new AsyncEmitter<vscode.FileWillRenameEvent>();\n\tprivate readonly _onWillCreateFile = new AsyncEmitter<vscode.FileWillCreateEvent>();\n\tprivate readonly _onWillDeleteFile = new AsyncEmitter<vscode.FileWillDeleteEvent>();\n\n\treadonly onDidRenameFile: Event<vscode.FileRenameEvent> = this._onDidRenameFile.event;\n\treadonly onDidCreateFile: Event<vscode.FileCreateEvent> = this._onDidCreateFile.event;\n\treadonly onDidDeleteFile: Event<vscode.FileDeleteEvent> = this._onDidDeleteFile.event;\n\n\tconstructor(\n\t\tprivate readonly _mainContext: IMainContext,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extHostDocumentsAndEditors: ExtHostDocumentsAndEditors\n\t) {\n\t\t//\n\t}\n\n\t//--- file events\n\n\tcreateFileSystemWatcher(workspace: IExtHostWorkspace, configProvider: ExtHostConfigProvider, extension: IExtensionDescription, globPattern: vscode.GlobPattern, options: FileSystemWatcherCreateOptions): vscode.FileSystemWatcher {\n\t\treturn new FileSystemWatcher(this._mainContext, configProvider, workspace, extension, this._onFileSystemEvent.event, typeConverter.GlobPattern.from(globPattern), options);\n\t}\n\n\t$onFileEvent(events: FileSystemEvents) {\n\t\tthis._onFileSystemEvent.fire(new LazyRevivedFileSystemEvents(events));\n\t}\n\n\t//--- file operations\n\n\t$onDidRunFileOperation(operation: FileOperation, files: SourceTargetPair[]): void {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\tthis._onDidRenameFile.fire(Object.freeze({ files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\tthis._onDidDeleteFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\tthis._onDidCreateFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t//ignore, dont send\n\t\t}\n\t}\n\n\n\tgetOnWillRenameFileEvent(extension: IExtensionDescription): Event<vscode.FileWillRenameEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillRenameFile);\n\t}\n\n\tgetOnWillCreateFileEvent(extension: IExtensionDescription): Event<vscode.FileWillCreateEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillCreateFile);\n\t}\n\n\tgetOnWillDeleteFileEvent(extension: IExtensionDescription): Event<vscode.FileWillDeleteEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillDeleteFile);\n\t}\n\n\tprivate _createWillExecuteEvent<E extends IWaitUntil>(extension: IExtensionDescription, emitter: AsyncEmitter<E>): Event<E> {\n\t\treturn (listener, thisArg, disposables) => {\n\t\t\tconst wrappedListener: IExtensionListener<E> = function wrapped(e: E) { listener.call(thisArg, e); };\n\t\t\twrappedListener.extension = extension;\n\t\t\treturn emitter.event(wrappedListener, undefined, disposables);\n\t\t};\n\t}\n\n\tasync $onWillRunFileOperation(operation: FileOperation, files: SourceTargetPair[], timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillRenameFile, { files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }, timeout, token);\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillDeleteFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\treturn await this._fireWillEvent(this._onWillCreateFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async _fireWillEvent<E extends IWaitUntil>(emitter: AsyncEmitter<E>, data: IWaitUntilData<E>, timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\n\t\tconst extensionNames = new Set<string>();\n\t\tconst edits: [IExtensionDescription, WorkspaceEdit][] = [];\n\n\t\tawait emitter.fireAsync(data, token, async (thenable: Promise<unknown>, listener) => {\n\t\t\t// ignore all results except for WorkspaceEdits. Those are stored in an array.\n\t\t\tconst now = Date.now();\n\t\t\tconst result = await Promise.resolve(thenable);\n\t\t\tif (result instanceof WorkspaceEdit) {\n\t\t\t\tedits.push([(<IExtensionListener<E>>listener).extension, result]);\n\t\t\t\textensionNames.add((<IExtensionListener<E>>listener).extension.displayName ?? (<IExtensionListener<E>>listener).extension.identifier.value);\n\t\t\t}\n\n\t\t\tif (Date.now() - now > timeout) {\n\t\t\t\tthis._logService.warn('SLOW file-participant', (<IExtensionListener<E>>listener).extension.identifier);\n\t\t\t}\n\t\t});\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (edits.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// concat all WorkspaceEdits collected via waitUntil-call and send them over to the renderer\n\t\tconst dto: IWorkspaceEditDto = { edits: [] };\n\t\tfor (const [, edit] of edits) {\n\t\t\tconst { edits } = typeConverter.WorkspaceEdit.from(edit, {\n\t\t\t\tgetTextDocumentVersion: uri => this._extHostDocumentsAndEditors.getDocument(uri)?.version,\n\t\t\t\tgetNotebookDocumentVersion: () => undefined,\n\t\t\t});\n\t\t\tdto.edits = dto.edits.concat(edits);\n\t\t}\n\t\treturn { edit: dto, extensionNames: Array.from(extensionNames) };\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event, AsyncEmitter, IWaitUntil, IWaitUntilData } from '../../../base/common/event.js';\nimport { GLOBSTAR, GLOB_SPLIT, IRelativePattern, parse } from '../../../base/common/glob.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ExtHostDocumentsAndEditors } from './extHostDocumentsAndEditors.js';\nimport type * as vscode from 'vscode';\nimport { ExtHostFileSystemEventServiceShape, FileSystemEvents, IMainContext, SourceTargetPair, IWorkspaceEditDto, IWillRunFileOperationParticipation, MainContext, IRelativePatternDto } from './extHost.protocol.js';\nimport * as typeConverter from './extHostTypeConverters.js';\nimport { Disposable, WorkspaceEdit } from './extHostTypes.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { FileChangeFilter, FileOperation, IGlobPatterns } from '../../../platform/files/common/files.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { IExtHostWorkspace } from './extHostWorkspace.js';\nimport { Lazy } from '../../../base/common/lazy.js';\nimport { ExtHostConfigProvider } from './extHostConfiguration.js';\nimport { rtrim } from '../../../base/common/strings.js';\nimport { normalizeWatcherPattern } from '../../../platform/files/common/watcher.js';\n\nexport interface FileSystemWatcherCreateOptions {\n\treadonly ignoreCreateEvents?: boolean;\n\treadonly ignoreChangeEvents?: boolean;\n\treadonly ignoreDeleteEvents?: boolean;\n}\n\nclass FileSystemWatcher implements vscode.FileSystemWatcher {\n\n\tprivate readonly session = Math.random();\n\n\tprivate readonly _onDidCreate = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidChange = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidDelete = new Emitter<vscode.Uri>();\n\n\tprivate _disposable: Disposable;\n\tprivate _config: number;\n\n\tget ignoreCreateEvents(): boolean {\n\t\treturn Boolean(this._config & 0b001);\n\t}\n\n\tget ignoreChangeEvents(): boolean {\n\t\treturn Boolean(this._config & 0b010);\n\t}\n\n\tget ignoreDeleteEvents(): boolean {\n\t\treturn Boolean(this._config & 0b100);\n\t}\n\n\tconstructor(mainContext: IMainContext, configuration: ExtHostConfigProvider, workspace: IExtHostWorkspace, extension: IExtensionDescription, dispatcher: Event<FileSystemEvents>, globPattern: string | IRelativePatternDto, options: FileSystemWatcherCreateOptions) {\n\t\tthis._config = 0;\n\t\tif (options.ignoreCreateEvents) {\n\t\t\tthis._config += 0b001;\n\t\t}\n\t\tif (options.ignoreChangeEvents) {\n\t\t\tthis._config += 0b010;\n\t\t}\n\t\tif (options.ignoreDeleteEvents) {\n\t\t\tthis._config += 0b100;\n\t\t}\n\n\t\tconst parsedPattern = parse(globPattern);\n\n\t\t// 1.64.x behaviour change: given the new support to watch any folder\n\t\t// we start to ignore events outside the workspace when only a string\n\t\t// pattern is provided to avoid sending events to extensions that are\n\t\t// unexpected.\n\t\t// https://github.com/microsoft/vscode/issues/3025\n\t\tconst excludeOutOfWorkspaceEvents = typeof globPattern === 'string';\n\n\t\t// 1.84.x introduces new proposed API for a watcher to set exclude\n\t\t// rules. In these cases, we turn the file watcher into correlation\n\t\t// mode and ignore any event that does not match the correlation ID.\n\t\t//\n\t\t// Update (Feb 2025): proposal is discontinued, so the previous\n\t\t// `options.correlate` is always `false`.\n\t\tconst excludeUncorrelatedEvents = false;\n\n\t\tconst subscription = dispatcher(events => {\n\t\t\tif (typeof events.session === 'number' && events.session !== this.session) {\n\t\t\t\treturn; // ignore events from other file watchers that are in correlation mode\n\t\t\t}\n\n\t\t\tif (excludeUncorrelatedEvents && typeof events.session === 'undefined') {\n\t\t\t\treturn; // ignore events from other non-correlating file watcher when we are in correlation mode\n\t\t\t}\n\n\t\t\tif (!options.ignoreCreateEvents) {\n\t\t\t\tfor (const created of events.created) {\n\t\t\t\t\tconst uri = URI.revive(created);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidCreate.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!options.ignoreChangeEvents) {\n\t\t\t\tfor (const changed of events.changed) {\n\t\t\t\t\tconst uri = URI.revive(changed);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidChange.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!options.ignoreDeleteEvents) {\n\t\t\t\tfor (const deleted of events.deleted) {\n\t\t\t\t\tconst uri = URI.revive(deleted);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidDelete.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._disposable = Disposable.from(this.ensureWatching(mainContext, workspace, configuration, extension, globPattern, options, false), this._onDidCreate, this._onDidChange, this._onDidDelete, subscription);\n\t}\n\n\tprivate ensureWatching(mainContext: IMainContext, workspace: IExtHostWorkspace, configuration: ExtHostConfigProvider, extension: IExtensionDescription, globPattern: string | IRelativePatternDto, options: FileSystemWatcherCreateOptions, correlate: boolean | undefined): Disposable {\n\t\tconst disposable = Disposable.from();\n\n\t\tif (typeof globPattern === 'string') {\n\t\t\treturn disposable; // workspace is already watched by default, no need to watch again!\n\t\t}\n\n\t\tif (options.ignoreChangeEvents && options.ignoreCreateEvents && options.ignoreDeleteEvents) {\n\t\t\treturn disposable; // no need to watch if we ignore all events\n\t\t}\n\n\t\tconst proxy = mainContext.getProxy(MainContext.MainThreadFileSystemEventService);\n\n\t\tlet recursive = false;\n\t\tif (globPattern.pattern.includes(GLOBSTAR) || globPattern.pattern.includes(GLOB_SPLIT)) {\n\t\t\trecursive = true; // only watch recursively if pattern indicates the need for it\n\t\t}\n\n\t\tconst excludes = [];\n\t\tlet includes: Array<string | IRelativePattern> | undefined = undefined;\n\t\tlet filter: FileChangeFilter | undefined;\n\n\t\t// Correlated: adjust filter based on arguments\n\t\tif (correlate) {\n\t\t\tif (options.ignoreChangeEvents || options.ignoreCreateEvents || options.ignoreDeleteEvents) {\n\t\t\t\tfilter = FileChangeFilter.UPDATED | FileChangeFilter.ADDED | FileChangeFilter.DELETED;\n\n\t\t\t\tif (options.ignoreChangeEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.UPDATED;\n\t\t\t\t}\n\n\t\t\t\tif (options.ignoreCreateEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.ADDED;\n\t\t\t\t}\n\n\t\t\t\tif (options.ignoreDeleteEvents) {\n\t\t\t\t\tfilter &= ~FileChangeFilter.DELETED;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Uncorrelated: adjust includes and excludes based on settings\n\t\telse {\n\n\t\t\t// Automatically add `files.watcherExclude` patterns when watching\n\t\t\t// recursively to give users a chance to configure exclude rules\n\t\t\t// for reducing the overhead of watching recursively\n\t\t\tif (recursive && excludes.length === 0) {\n\t\t\t\tconst workspaceFolder = workspace.getWorkspaceFolder(URI.revive(globPattern.baseUri));\n\t\t\t\tconst watcherExcludes = configuration.getConfiguration('files', workspaceFolder).get<IGlobPatterns>('watcherExclude');\n\t\t\t\tif (watcherExcludes) {\n\t\t\t\t\tfor (const key in watcherExcludes) {\n\t\t\t\t\t\tif (key && watcherExcludes[key] === true) {\n\t\t\t\t\t\t\texcludes.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Non-recursive watching inside the workspace will overlap with\n\t\t\t// our standard workspace watchers. To prevent duplicate events,\n\t\t\t// we only want to include events for files that are otherwise\n\t\t\t// excluded via `files.watcherExclude`. As such, we configure\n\t\t\t// to include each configured exclude pattern so that only those\n\t\t\t// events are reported that are otherwise excluded.\n\t\t\t// However, we cannot just use the pattern as is, because a pattern\n\t\t\t// such as `bar` for a exclude, will work to exclude any of\n\t\t\t// `<workspace path>/bar` but will not work as include for files within\n\t\t\t// `bar` unless a suffix of `/**` if added.\n\t\t\t// (https://github.com/microsoft/vscode/issues/148245)\n\t\t\telse if (!recursive) {\n\t\t\t\tconst workspaceFolder = workspace.getWorkspaceFolder(URI.revive(globPattern.baseUri));\n\t\t\t\tif (workspaceFolder) {\n\t\t\t\t\tconst watcherExcludes = configuration.getConfiguration('files', workspaceFolder).get<IGlobPatterns>('watcherExclude');\n\t\t\t\t\tif (watcherExcludes) {\n\t\t\t\t\t\tfor (const key in watcherExcludes) {\n\t\t\t\t\t\t\tif (key && watcherExcludes[key] === true) {\n\t\t\t\t\t\t\t\tconst includePattern = `${rtrim(key, '/')}/${GLOBSTAR}`;\n\t\t\t\t\t\t\t\tif (!includes) {\n\t\t\t\t\t\t\t\t\tincludes = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tincludes.push(normalizeWatcherPattern(workspaceFolder.uri.fsPath, includePattern));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Still ignore watch request if there are actually no configured\n\t\t\t\t\t// exclude rules, because in that case our default recursive watcher\n\t\t\t\t\t// should be able to take care of all events.\n\t\t\t\t\tif (!includes || includes.length === 0) {\n\t\t\t\t\t\treturn disposable;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproxy.$watch(extension.identifier.value, this.session, globPattern.baseUri, { recursive, excludes, includes, filter }, Boolean(correlate));\n\n\t\treturn Disposable.from({ dispose: () => proxy.$unwatch(this.session) });\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tget onDidCreate(): Event<vscode.Uri> {\n\t\treturn this._onDidCreate.event;\n\t}\n\n\tget onDidChange(): Event<vscode.Uri> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tget onDidDelete(): Event<vscode.Uri> {\n\t\treturn this._onDidDelete.event;\n\t}\n}\n\ninterface IExtensionListener<E> {\n\textension: IExtensionDescription;\n\t(e: E): any;\n}\n\nclass LazyRevivedFileSystemEvents implements FileSystemEvents {\n\n\treadonly session: number | undefined;\n\n\tprivate _created = new Lazy(() => this._events.created.map(URI.revive) as URI[]);\n\tget created(): URI[] { return this._created.value; }\n\n\tprivate _changed = new Lazy(() => this._events.changed.map(URI.revive) as URI[]);\n\tget changed(): URI[] { return this._changed.value; }\n\n\tprivate _deleted = new Lazy(() => this._events.deleted.map(URI.revive) as URI[]);\n\tget deleted(): URI[] { return this._deleted.value; }\n\n\tconstructor(private readonly _events: FileSystemEvents) {\n\t\tthis.session = this._events.session;\n\t}\n}\n\nexport class ExtHostFileSystemEventService implements ExtHostFileSystemEventServiceShape {\n\n\tprivate readonly _onFileSystemEvent = new Emitter<FileSystemEvents>();\n\n\tprivate readonly _onDidRenameFile = new Emitter<vscode.FileRenameEvent>();\n\tprivate readonly _onDidCreateFile = new Emitter<vscode.FileCreateEvent>();\n\tprivate readonly _onDidDeleteFile = new Emitter<vscode.FileDeleteEvent>();\n\tprivate readonly _onWillRenameFile = new AsyncEmitter<vscode.FileWillRenameEvent>();\n\tprivate readonly _onWillCreateFile = new AsyncEmitter<vscode.FileWillCreateEvent>();\n\tprivate readonly _onWillDeleteFile = new AsyncEmitter<vscode.FileWillDeleteEvent>();\n\n\treadonly onDidRenameFile: Event<vscode.FileRenameEvent> = this._onDidRenameFile.event;\n\treadonly onDidCreateFile: Event<vscode.FileCreateEvent> = this._onDidCreateFile.event;\n\treadonly onDidDeleteFile: Event<vscode.FileDeleteEvent> = this._onDidDeleteFile.event;\n\n\tconstructor(\n\t\tprivate readonly _mainContext: IMainContext,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extHostDocumentsAndEditors: ExtHostDocumentsAndEditors\n\t) {\n\t\t//\n\t}\n\n\t//--- file events\n\n\tcreateFileSystemWatcher(workspace: IExtHostWorkspace, configProvider: ExtHostConfigProvider, extension: IExtensionDescription, globPattern: vscode.GlobPattern, options: FileSystemWatcherCreateOptions): vscode.FileSystemWatcher {\n\t\treturn new FileSystemWatcher(this._mainContext, configProvider, workspace, extension, this._onFileSystemEvent.event, typeConverter.GlobPattern.from(globPattern), options);\n\t}\n\n\t$onFileEvent(events: FileSystemEvents) {\n\t\tthis._onFileSystemEvent.fire(new LazyRevivedFileSystemEvents(events));\n\t}\n\n\t//--- file operations\n\n\t$onDidRunFileOperation(operation: FileOperation, files: SourceTargetPair[]): void {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\tthis._onDidRenameFile.fire(Object.freeze({ files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\tthis._onDidDeleteFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\tthis._onDidCreateFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t//ignore, dont send\n\t\t}\n\t}\n\n\n\tgetOnWillRenameFileEvent(extension: IExtensionDescription): Event<vscode.FileWillRenameEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillRenameFile);\n\t}\n\n\tgetOnWillCreateFileEvent(extension: IExtensionDescription): Event<vscode.FileWillCreateEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillCreateFile);\n\t}\n\n\tgetOnWillDeleteFileEvent(extension: IExtensionDescription): Event<vscode.FileWillDeleteEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillDeleteFile);\n\t}\n\n\tprivate _createWillExecuteEvent<E extends IWaitUntil>(extension: IExtensionDescription, emitter: AsyncEmitter<E>): Event<E> {\n\t\treturn (listener, thisArg, disposables) => {\n\t\t\tconst wrappedListener: IExtensionListener<E> = function wrapped(e: E) { listener.call(thisArg, e); };\n\t\t\twrappedListener.extension = extension;\n\t\t\treturn emitter.event(wrappedListener, undefined, disposables);\n\t\t};\n\t}\n\n\tasync $onWillRunFileOperation(operation: FileOperation, files: SourceTargetPair[], timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillRenameFile, { files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }, timeout, token);\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillDeleteFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\treturn await this._fireWillEvent(this._onWillCreateFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async _fireWillEvent<E extends IWaitUntil>(emitter: AsyncEmitter<E>, data: IWaitUntilData<E>, timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\n\t\tconst extensionNames = new Set<string>();\n\t\tconst edits: [IExtensionDescription, WorkspaceEdit][] = [];\n\n\t\tawait emitter.fireAsync(data, token, async (thenable: Promise<unknown>, listener) => {\n\t\t\t// ignore all results except for WorkspaceEdits. Those are stored in an array.\n\t\t\tconst now = Date.now();\n\t\t\tconst result = await Promise.resolve(thenable);\n\t\t\tif (result instanceof WorkspaceEdit) {\n\t\t\t\tedits.push([(<IExtensionListener<E>>listener).extension, result]);\n\t\t\t\textensionNames.add((<IExtensionListener<E>>listener).extension.displayName ?? (<IExtensionListener<E>>listener).extension.identifier.value);\n\t\t\t}\n\n\t\t\tif (Date.now() - now > timeout) {\n\t\t\t\tthis._logService.warn('SLOW file-participant', (<IExtensionListener<E>>listener).extension.identifier);\n\t\t\t}\n\t\t});\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (edits.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// concat all WorkspaceEdits collected via waitUntil-call and send them over to the renderer\n\t\tconst dto: IWorkspaceEditDto = { edits: [] };\n\t\tfor (const [, edit] of edits) {\n\t\t\tconst { edits } = typeConverter.WorkspaceEdit.from(edit, {\n\t\t\t\tgetTextDocumentVersion: uri => this._extHostDocumentsAndEditors.getDocument(uri)?.version,\n\t\t\t\tgetNotebookDocumentVersion: () => undefined,\n\t\t\t});\n\t\t\tdto.edits = dto.edits.concat(edits);\n\t\t}\n\t\treturn { edit: dto, extensionNames: Array.from(extensionNames) };\n\t}\n}\n"]}