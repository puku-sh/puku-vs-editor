{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/common/extHostTerminalShellIntegration.test.ts","vs/workbench/api/test/common/extHostTerminalShellIntegration.test.ts"],"names":[],"mappings":"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","file":"extHostTerminalShellIntegration.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { type Terminal, type TerminalShellExecution, type TerminalShellExecutionCommandLine, type TerminalShellExecutionStartEvent } from 'vscode';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { InternalTerminalShellIntegration } from '../../common/extHostTerminalShellIntegration.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { TerminalShellExecutionCommandLineConfidence } from '../../common/extHostTypes.js';\nimport { deepStrictEqual, notStrictEqual, strictEqual } from 'assert';\nimport type { URI } from '../../../../base/common/uri.js';\nimport { DeferredPromise } from '../../../../base/common/async.js';\n\nfunction cmdLine(value: string): TerminalShellExecutionCommandLine {\n\treturn Object.freeze({\n\t\tconfidence: TerminalShellExecutionCommandLineConfidence.High,\n\t\tvalue,\n\t\tisTrusted: true,\n\t});\n}\nfunction asCmdLine(value: string | TerminalShellExecutionCommandLine): TerminalShellExecutionCommandLine {\n\tif (typeof value === 'string') {\n\t\treturn cmdLine(value);\n\t}\n\treturn value;\n}\nfunction vsc(data: string) {\n\treturn `\\x1b]633;${data}\\x07`;\n}\n\nconst testCommandLine = 'echo hello world';\nconst testCommandLine2 = 'echo goodbye world';\n\ninterface ITrackedEvent {\n\ttype: 'start' | 'data' | 'end';\n\tcommandLine: string;\n\tdata?: string;\n}\n\nsuite('InternalTerminalShellIntegration', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet si: InternalTerminalShellIntegration;\n\tlet terminal: Terminal;\n\tlet onDidStartTerminalShellExecution: Emitter<TerminalShellExecutionStartEvent>;\n\tlet trackedEvents: ITrackedEvent[];\n\tlet readIteratorsFlushed: Promise<void>[];\n\n\tasync function startExecutionAwaitObject(commandLine: string | TerminalShellExecutionCommandLine, cwd?: URI): Promise<TerminalShellExecution> {\n\t\treturn await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(onDidStartTerminalShellExecution.event(e => {\n\t\t\t\tr(e.execution);\n\t\t\t}));\n\t\t\tsi.startShellExecution(asCmdLine(commandLine), cwd);\n\t\t});\n\t}\n\n\tasync function endExecutionAwaitObject(commandLine: string | TerminalShellExecutionCommandLine): Promise<TerminalShellExecution> {\n\t\treturn await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(si.onDidRequestEndExecution(e => r(e.execution)));\n\t\t\tsi.endShellExecution(asCmdLine(commandLine), 0);\n\t\t});\n\t}\n\n\tasync function emitData(data: string): Promise<void> {\n\t\t// AsyncIterableObjects are initialized in a microtask, this doesn't matter in practice\n\t\t// since the events will always come through in different events.\n\t\tawait new Promise<void>(r => queueMicrotask(r));\n\t\tsi.emitData(data);\n\t}\n\n\tfunction assertTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents, expected);\n\t}\n\n\tfunction assertNonDataTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents.filter(e => e.type !== 'data'), expected);\n\t}\n\n\tfunction assertDataTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents.filter(e => e.type === 'data'), expected);\n\t}\n\n\tsetup(() => {\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tterminal = Symbol('testTerminal') as any;\n\t\tonDidStartTerminalShellExecution = store.add(new Emitter());\n\t\tsi = store.add(new InternalTerminalShellIntegration(terminal, true, onDidStartTerminalShellExecution));\n\n\t\ttrackedEvents = [];\n\t\treadIteratorsFlushed = [];\n\t\tstore.add(onDidStartTerminalShellExecution.event(async e => {\n\t\t\ttrackedEvents.push({\n\t\t\t\ttype: 'start',\n\t\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t\t});\n\t\t\tconst stream = e.execution.read();\n\t\t\tconst readIteratorsFlushedDeferred = new DeferredPromise<void>();\n\t\t\treadIteratorsFlushed.push(readIteratorsFlushedDeferred.p);\n\t\t\tfor await (const data of stream) {\n\t\t\t\ttrackedEvents.push({\n\t\t\t\t\ttype: 'data',\n\t\t\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t\t\t\tdata,\n\t\t\t\t});\n\t\t\t}\n\t\t\treadIteratorsFlushedDeferred.complete();\n\t\t}));\n\t\tstore.add(si.onDidRequestEndExecution(e => trackedEvents.push({\n\t\t\ttype: 'end',\n\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t})));\n\t});\n\n\ttest('simple execution', async () => {\n\t\tconst execution = await startExecutionAwaitObject(testCommandLine);\n\t\tdeepStrictEqual(execution.commandLine.value, testCommandLine);\n\t\tconst execution2 = await endExecutionAwaitObject(testCommandLine);\n\t\tstrictEqual(execution2, execution);\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t{ commandLine: testCommandLine, type: 'end' },\n\t\t]);\n\t});\n\n\ttest('different execution unexpectedly ended', async () => {\n\t\tconst execution1 = await startExecutionAwaitObject(testCommandLine);\n\t\tconst execution2 = await endExecutionAwaitObject(testCommandLine2);\n\t\tstrictEqual(execution1, execution2, 'when a different execution is ended, the one that started first should end');\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t// This looks weird, but it's the same execution behind the scenes, just the command\n\t\t\t// line was updated\n\t\t\t{ commandLine: testCommandLine2, type: 'end' },\n\t\t]);\n\t});\n\n\ttest('no end event', async () => {\n\t\tconst execution1 = await startExecutionAwaitObject(testCommandLine);\n\t\tconst endedExecution = await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(si.onDidRequestEndExecution(e => r(e.execution)));\n\t\t\tstartExecutionAwaitObject(testCommandLine2);\n\t\t});\n\t\tstrictEqual(execution1, endedExecution, 'when no end event is fired, the current execution should end');\n\n\t\t// Clean up disposables\n\t\tawait endExecutionAwaitObject(testCommandLine2);\n\t\tawait Promise.all(readIteratorsFlushed);\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t{ commandLine: testCommandLine, type: 'end' },\n\t\t\t{ commandLine: testCommandLine2, type: 'start' },\n\t\t\t{ commandLine: testCommandLine2, type: 'end' },\n\t\t]);\n\t});\n\n\tsuite('executeCommand', () => {\n\t\ttest('^C to clear previous command', async () => {\n\t\t\tconst commandLine = 'foo';\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst firstExecution = await startExecutionAwaitObject('^C');\n\t\t\tnotStrictEqual(firstExecution, apiRequestedExecution.value);\n\t\t\tsi.emitData('SIGINT');\n\t\t\tsi.endShellExecution(cmdLine('^C'), 0);\n\t\t\tsi.startShellExecution(cmdLine(commandLine), undefined);\n\t\t\tawait emitData('1');\n\t\t\tawait endExecutionAwaitObject(commandLine);\n\t\t\t// IMPORTANT: We cannot reliably assert the order of data events here because flushing\n\t\t\t// of the async iterator is asynchronous and could happen after the execution's end\n\t\t\t// event fires if an execution is started immediately afterwards.\n\t\t\tawait Promise.all(readIteratorsFlushed);\n\n\t\t\tassertNonDataTrackedEvents([\n\t\t\t\t{ commandLine: '^C', type: 'start' },\n\t\t\t\t{ commandLine: '^C', type: 'end' },\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t\tassertDataTrackedEvents([\n\t\t\t\t{ commandLine: '^C', type: 'data', data: 'SIGINT' },\n\t\t\t\t{ commandLine, type: 'data', data: '1' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command line', async () => {\n\t\t\tconst commandLine = 'foo\\nbar';\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject('foo');\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData('1');\n\t\t\tsi.emitData('2');\n\t\t\tsi.endShellExecution(cmdLine('foo'), 0);\n\t\t\tsi.startShellExecution(cmdLine('bar'), undefined);\n\t\t\tsi.emitData('3');\n\t\t\tsi.emitData('4');\n\t\t\tconst endedExecution = await endExecutionAwaitObject('bar');\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: '1' },\n\t\t\t\t{ commandLine, type: 'data', data: '2' },\n\t\t\t\t{ commandLine, type: 'data', data: '3' },\n\t\t\t\t{ commandLine, type: 'data', data: '4' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command with long second command', async () => {\n\t\t\tconst commandLine = 'echo foo\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine1 = 'echo foo';\n\t\t\tconst subCommandLine2 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine2);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command comment followed by long second command', async () => {\n\t\t\tconst commandLine = '# comment: foo\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine1 = '# comment: foo';\n\t\t\tconst subCommandLine2 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine2);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('4 multi-line commands with output', async () => {\n\t\t\tconst commandLine = 'echo \"\\nfoo\"\\ngit commit -m \"hello\\n\\nworld\"\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT\\n{\\necho \"foo\"\\n}';\n\t\t\tconst subCommandLine1 = 'echo \"\\nfoo\"';\n\t\t\tconst subCommandLine2 = 'git commit -m \"hello\\n\\nworld\"';\n\t\t\tconst subCommandLine3 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine4 = '{\\necho \"foo\"\\n}';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')} 2 files changed, 61 insertions(+), 2 deletions(-)`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine2), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine3), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine3), 0);\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine4), undefined);\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine4);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')} 2 files changed, 61 insertions(+), 2 deletions(-)` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { type Terminal, type TerminalShellExecution, type TerminalShellExecutionCommandLine, type TerminalShellExecutionStartEvent } from 'vscode';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { InternalTerminalShellIntegration } from '../../common/extHostTerminalShellIntegration.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { TerminalShellExecutionCommandLineConfidence } from '../../common/extHostTypes.js';\nimport { deepStrictEqual, notStrictEqual, strictEqual } from 'assert';\nimport type { URI } from '../../../../base/common/uri.js';\nimport { DeferredPromise } from '../../../../base/common/async.js';\n\nfunction cmdLine(value: string): TerminalShellExecutionCommandLine {\n\treturn Object.freeze({\n\t\tconfidence: TerminalShellExecutionCommandLineConfidence.High,\n\t\tvalue,\n\t\tisTrusted: true,\n\t});\n}\nfunction asCmdLine(value: string | TerminalShellExecutionCommandLine): TerminalShellExecutionCommandLine {\n\tif (typeof value === 'string') {\n\t\treturn cmdLine(value);\n\t}\n\treturn value;\n}\nfunction vsc(data: string) {\n\treturn `\\x1b]633;${data}\\x07`;\n}\n\nconst testCommandLine = 'echo hello world';\nconst testCommandLine2 = 'echo goodbye world';\n\ninterface ITrackedEvent {\n\ttype: 'start' | 'data' | 'end';\n\tcommandLine: string;\n\tdata?: string;\n}\n\nsuite('InternalTerminalShellIntegration', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet si: InternalTerminalShellIntegration;\n\tlet terminal: Terminal;\n\tlet onDidStartTerminalShellExecution: Emitter<TerminalShellExecutionStartEvent>;\n\tlet trackedEvents: ITrackedEvent[];\n\tlet readIteratorsFlushed: Promise<void>[];\n\n\tasync function startExecutionAwaitObject(commandLine: string | TerminalShellExecutionCommandLine, cwd?: URI): Promise<TerminalShellExecution> {\n\t\treturn await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(onDidStartTerminalShellExecution.event(e => {\n\t\t\t\tr(e.execution);\n\t\t\t}));\n\t\t\tsi.startShellExecution(asCmdLine(commandLine), cwd);\n\t\t});\n\t}\n\n\tasync function endExecutionAwaitObject(commandLine: string | TerminalShellExecutionCommandLine): Promise<TerminalShellExecution> {\n\t\treturn await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(si.onDidRequestEndExecution(e => r(e.execution)));\n\t\t\tsi.endShellExecution(asCmdLine(commandLine), 0);\n\t\t});\n\t}\n\n\tasync function emitData(data: string): Promise<void> {\n\t\t// AsyncIterableObjects are initialized in a microtask, this doesn't matter in practice\n\t\t// since the events will always come through in different events.\n\t\tawait new Promise<void>(r => queueMicrotask(r));\n\t\tsi.emitData(data);\n\t}\n\n\tfunction assertTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents, expected);\n\t}\n\n\tfunction assertNonDataTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents.filter(e => e.type !== 'data'), expected);\n\t}\n\n\tfunction assertDataTrackedEvents(expected: ITrackedEvent[]) {\n\t\tdeepStrictEqual(trackedEvents.filter(e => e.type === 'data'), expected);\n\t}\n\n\tsetup(() => {\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tterminal = Symbol('testTerminal') as any;\n\t\tonDidStartTerminalShellExecution = store.add(new Emitter());\n\t\tsi = store.add(new InternalTerminalShellIntegration(terminal, true, onDidStartTerminalShellExecution));\n\n\t\ttrackedEvents = [];\n\t\treadIteratorsFlushed = [];\n\t\tstore.add(onDidStartTerminalShellExecution.event(async e => {\n\t\t\ttrackedEvents.push({\n\t\t\t\ttype: 'start',\n\t\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t\t});\n\t\t\tconst stream = e.execution.read();\n\t\t\tconst readIteratorsFlushedDeferred = new DeferredPromise<void>();\n\t\t\treadIteratorsFlushed.push(readIteratorsFlushedDeferred.p);\n\t\t\tfor await (const data of stream) {\n\t\t\t\ttrackedEvents.push({\n\t\t\t\t\ttype: 'data',\n\t\t\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t\t\t\tdata,\n\t\t\t\t});\n\t\t\t}\n\t\t\treadIteratorsFlushedDeferred.complete();\n\t\t}));\n\t\tstore.add(si.onDidRequestEndExecution(e => trackedEvents.push({\n\t\t\ttype: 'end',\n\t\t\tcommandLine: e.execution.commandLine.value,\n\t\t})));\n\t});\n\n\ttest('simple execution', async () => {\n\t\tconst execution = await startExecutionAwaitObject(testCommandLine);\n\t\tdeepStrictEqual(execution.commandLine.value, testCommandLine);\n\t\tconst execution2 = await endExecutionAwaitObject(testCommandLine);\n\t\tstrictEqual(execution2, execution);\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t{ commandLine: testCommandLine, type: 'end' },\n\t\t]);\n\t});\n\n\ttest('different execution unexpectedly ended', async () => {\n\t\tconst execution1 = await startExecutionAwaitObject(testCommandLine);\n\t\tconst execution2 = await endExecutionAwaitObject(testCommandLine2);\n\t\tstrictEqual(execution1, execution2, 'when a different execution is ended, the one that started first should end');\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t// This looks weird, but it's the same execution behind the scenes, just the command\n\t\t\t// line was updated\n\t\t\t{ commandLine: testCommandLine2, type: 'end' },\n\t\t]);\n\t});\n\n\ttest('no end event', async () => {\n\t\tconst execution1 = await startExecutionAwaitObject(testCommandLine);\n\t\tconst endedExecution = await new Promise<TerminalShellExecution>(r => {\n\t\t\tstore.add(si.onDidRequestEndExecution(e => r(e.execution)));\n\t\t\tstartExecutionAwaitObject(testCommandLine2);\n\t\t});\n\t\tstrictEqual(execution1, endedExecution, 'when no end event is fired, the current execution should end');\n\n\t\t// Clean up disposables\n\t\tawait endExecutionAwaitObject(testCommandLine2);\n\t\tawait Promise.all(readIteratorsFlushed);\n\n\t\tassertTrackedEvents([\n\t\t\t{ commandLine: testCommandLine, type: 'start' },\n\t\t\t{ commandLine: testCommandLine, type: 'end' },\n\t\t\t{ commandLine: testCommandLine2, type: 'start' },\n\t\t\t{ commandLine: testCommandLine2, type: 'end' },\n\t\t]);\n\t});\n\n\tsuite('executeCommand', () => {\n\t\ttest('^C to clear previous command', async () => {\n\t\t\tconst commandLine = 'foo';\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst firstExecution = await startExecutionAwaitObject('^C');\n\t\t\tnotStrictEqual(firstExecution, apiRequestedExecution.value);\n\t\t\tsi.emitData('SIGINT');\n\t\t\tsi.endShellExecution(cmdLine('^C'), 0);\n\t\t\tsi.startShellExecution(cmdLine(commandLine), undefined);\n\t\t\tawait emitData('1');\n\t\t\tawait endExecutionAwaitObject(commandLine);\n\t\t\t// IMPORTANT: We cannot reliably assert the order of data events here because flushing\n\t\t\t// of the async iterator is asynchronous and could happen after the execution's end\n\t\t\t// event fires if an execution is started immediately afterwards.\n\t\t\tawait Promise.all(readIteratorsFlushed);\n\n\t\t\tassertNonDataTrackedEvents([\n\t\t\t\t{ commandLine: '^C', type: 'start' },\n\t\t\t\t{ commandLine: '^C', type: 'end' },\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t\tassertDataTrackedEvents([\n\t\t\t\t{ commandLine: '^C', type: 'data', data: 'SIGINT' },\n\t\t\t\t{ commandLine, type: 'data', data: '1' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command line', async () => {\n\t\t\tconst commandLine = 'foo\\nbar';\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject('foo');\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData('1');\n\t\t\tsi.emitData('2');\n\t\t\tsi.endShellExecution(cmdLine('foo'), 0);\n\t\t\tsi.startShellExecution(cmdLine('bar'), undefined);\n\t\t\tsi.emitData('3');\n\t\t\tsi.emitData('4');\n\t\t\tconst endedExecution = await endExecutionAwaitObject('bar');\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: '1' },\n\t\t\t\t{ commandLine, type: 'data', data: '2' },\n\t\t\t\t{ commandLine, type: 'data', data: '3' },\n\t\t\t\t{ commandLine, type: 'data', data: '4' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command with long second command', async () => {\n\t\t\tconst commandLine = 'echo foo\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine1 = 'echo foo';\n\t\t\tconst subCommandLine2 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine2);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('multi-line command comment followed by long second command', async () => {\n\t\t\tconst commandLine = '# comment: foo\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine1 = '# comment: foo';\n\t\t\tconst subCommandLine2 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine2);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\n\t\ttest('4 multi-line commands with output', async () => {\n\t\t\tconst commandLine = 'echo \"\\nfoo\"\\ngit commit -m \"hello\\n\\nworld\"\\ncat << EOT\\nline1\\nline2\\nline3\\nEOT\\n{\\necho \"foo\"\\n}';\n\t\t\tconst subCommandLine1 = 'echo \"\\nfoo\"';\n\t\t\tconst subCommandLine2 = 'git commit -m \"hello\\n\\nworld\"';\n\t\t\tconst subCommandLine3 = 'cat << EOT\\nline1\\nline2\\nline3\\nEOT';\n\t\t\tconst subCommandLine4 = '{\\necho \"foo\"\\n}';\n\n\t\t\tconst apiRequestedExecution = si.requestNewShellExecution(cmdLine(commandLine), undefined);\n\t\t\tconst startedExecution = await startExecutionAwaitObject(subCommandLine1);\n\t\t\tstrictEqual(startedExecution, apiRequestedExecution.value);\n\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine1), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine2), undefined);\n\t\t\tsi.emitData(`${vsc('C')} 2 files changed, 61 insertions(+), 2 deletions(-)`);\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine2), 0);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine3), undefined);\n\t\t\tsi.emitData(`${vsc('C')}line1`);\n\t\t\tsi.emitData('line2');\n\t\t\tsi.emitData('line3');\n\t\t\tsi.endShellExecution(cmdLine(subCommandLine3), 0);\n\t\t\tsi.emitData(`${vsc('C')}foo`);\n\t\t\tsi.startShellExecution(cmdLine(subCommandLine4), undefined);\n\t\t\tconst endedExecution = await endExecutionAwaitObject(subCommandLine4);\n\t\t\tstrictEqual(startedExecution, endedExecution);\n\n\t\t\tassertTrackedEvents([\n\t\t\t\t{ commandLine, type: 'start' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')} 2 files changed, 61 insertions(+), 2 deletions(-)` },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}line1` },\n\t\t\t\t{ commandLine, type: 'data', data: 'line2' },\n\t\t\t\t{ commandLine, type: 'data', data: 'line3' },\n\t\t\t\t{ commandLine, type: 'data', data: `${vsc('C')}foo` },\n\t\t\t\t{ commandLine, type: 'end' },\n\t\t\t]);\n\t\t});\n\t});\n});\n"]}