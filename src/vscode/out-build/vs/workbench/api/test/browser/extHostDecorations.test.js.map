{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/extHostDecorations.test.ts","vs/workbench/api/test/browser/extHostDecorations.test.ts"],"names":[],"mappings":"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","file":"extHostDecorations.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport { MainThreadDecorationsShape } from '../../common/extHost.protocol.js';\nimport { ExtHostDecorations } from '../../common/extHostDecorations.js';\nimport { IExtHostRpcService } from '../../common/extHostRpcService.js';\nimport { nullExtensionDescription } from '../../../services/extensions/common/extensions.js';\n\nsuite('ExtHostDecorations', function () {\n\n\tlet mainThreadShape: MainThreadDecorationsShape;\n\tlet extHostDecorations: ExtHostDecorations;\n\tconst providers = new Set<number>();\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(function () {\n\n\t\tproviders.clear();\n\n\t\tmainThreadShape = new class extends mock<MainThreadDecorationsShape>() {\n\t\t\toverride $registerDecorationProvider(handle: number) {\n\t\t\t\tproviders.add(handle);\n\t\t\t}\n\t\t};\n\n\t\textHostDecorations = new ExtHostDecorations(\n\t\t\tnew class extends mock<IExtHostRpcService>() {\n\t\t\t\toverride getProxy(): any {\n\t\t\t\t\treturn mainThreadShape;\n\t\t\t\t}\n\t\t\t},\n\t\t\tnew NullLogService()\n\t\t);\n\t});\n\n\ttest('SCM Decorations missing #100524', async function () {\n\n\t\tlet calledA = false;\n\t\tlet calledB = false;\n\n\t\t// never returns\n\t\textHostDecorations.registerFileDecorationProvider({\n\n\t\t\tprovideFileDecoration() {\n\t\t\t\tcalledA = true;\n\t\t\t\treturn new Promise(() => { });\n\t\t\t}\n\t\t}, nullExtensionDescription);\n\n\t\t// always returns\n\t\textHostDecorations.registerFileDecorationProvider({\n\n\t\t\tprovideFileDecoration() {\n\t\t\t\tcalledB = true;\n\t\t\t\treturn new Promise(resolve => resolve({ badge: 'H', tooltip: 'Hello' }));\n\t\t\t}\n\t\t}, nullExtensionDescription);\n\n\n\t\tconst requests = [...providers.values()].map((handle, idx) => {\n\t\t\treturn extHostDecorations.$provideDecorations(handle, [{ id: idx, uri: URI.parse('test:///file') }], CancellationToken.None);\n\t\t});\n\n\t\tassert.strictEqual(calledA, true);\n\t\tassert.strictEqual(calledB, true);\n\n\t\tassert.strictEqual(requests.length, 2);\n\t\tconst [first, second] = requests;\n\n\t\tconst firstResult = await Promise.race([first, timeout(30).then(() => false)]);\n\t\tassert.strictEqual(typeof firstResult, 'boolean'); // never finishes...\n\n\t\tconst secondResult = await Promise.race([second, timeout(30).then(() => false)]);\n\t\tassert.strictEqual(typeof secondResult, 'object');\n\n\n\t\tawait timeout(30);\n\t});\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { timeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport { MainThreadDecorationsShape } from '../../common/extHost.protocol.js';\nimport { ExtHostDecorations } from '../../common/extHostDecorations.js';\nimport { IExtHostRpcService } from '../../common/extHostRpcService.js';\nimport { nullExtensionDescription } from '../../../services/extensions/common/extensions.js';\n\nsuite('ExtHostDecorations', function () {\n\n\tlet mainThreadShape: MainThreadDecorationsShape;\n\tlet extHostDecorations: ExtHostDecorations;\n\tconst providers = new Set<number>();\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(function () {\n\n\t\tproviders.clear();\n\n\t\tmainThreadShape = new class extends mock<MainThreadDecorationsShape>() {\n\t\t\toverride $registerDecorationProvider(handle: number) {\n\t\t\t\tproviders.add(handle);\n\t\t\t}\n\t\t};\n\n\t\textHostDecorations = new ExtHostDecorations(\n\t\t\tnew class extends mock<IExtHostRpcService>() {\n\t\t\t\toverride getProxy(): any {\n\t\t\t\t\treturn mainThreadShape;\n\t\t\t\t}\n\t\t\t},\n\t\t\tnew NullLogService()\n\t\t);\n\t});\n\n\ttest('SCM Decorations missing #100524', async function () {\n\n\t\tlet calledA = false;\n\t\tlet calledB = false;\n\n\t\t// never returns\n\t\textHostDecorations.registerFileDecorationProvider({\n\n\t\t\tprovideFileDecoration() {\n\t\t\t\tcalledA = true;\n\t\t\t\treturn new Promise(() => { });\n\t\t\t}\n\t\t}, nullExtensionDescription);\n\n\t\t// always returns\n\t\textHostDecorations.registerFileDecorationProvider({\n\n\t\t\tprovideFileDecoration() {\n\t\t\t\tcalledB = true;\n\t\t\t\treturn new Promise(resolve => resolve({ badge: 'H', tooltip: 'Hello' }));\n\t\t\t}\n\t\t}, nullExtensionDescription);\n\n\n\t\tconst requests = [...providers.values()].map((handle, idx) => {\n\t\t\treturn extHostDecorations.$provideDecorations(handle, [{ id: idx, uri: URI.parse('test:///file') }], CancellationToken.None);\n\t\t});\n\n\t\tassert.strictEqual(calledA, true);\n\t\tassert.strictEqual(calledB, true);\n\n\t\tassert.strictEqual(requests.length, 2);\n\t\tconst [first, second] = requests;\n\n\t\tconst firstResult = await Promise.race([first, timeout(30).then(() => false)]);\n\t\tassert.strictEqual(typeof firstResult, 'boolean'); // never finishes...\n\n\t\tconst secondResult = await Promise.race([second, timeout(30).then(() => false)]);\n\t\tassert.strictEqual(typeof secondResult, 'object');\n\n\n\t\tawait timeout(30);\n\t});\n\n});\n"]}