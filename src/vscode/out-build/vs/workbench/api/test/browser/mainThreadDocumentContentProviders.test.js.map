{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/mainThreadDocumentContentProviders.test.ts","vs/workbench/api/test/browser/mainThreadDocumentContentProviders.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,GAAG,EAAE,MAAM,gCAAgC,CAAC;AACrD,OAAO,EAAE,kCAAkC,EAAE,MAAM,qDAAqD,CAAC;AACzG,OAAO,EAAE,eAAe,EAAE,MAAM,iDAAiD,CAAC;AAClF,OAAO,EAAE,IAAI,EAAE,MAAM,sCAAsC,CAAC;AAG5D,OAAO,EAAE,eAAe,EAAE,MAAM,8BAA8B,CAAC;AAE/D,OAAO,EAAE,uCAAuC,EAAE,MAAM,uCAAuC,CAAC;AAEhG,KAAK,CAAC,oCAAoC,EAAE;IAE3C,MAAM,KAAK,GAAG,uCAAuC,EAAE,CAAC;IAExD,IAAI,CAAC,+BAA+B,EAAE;QAErC,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAClC,MAAM,KAAK,GAAG,eAAe,CAAC,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QAE9D,MAAM,SAAS,GAAG,IAAI,kCAAkC,CAAC,IAAI,eAAe,EAAE,EAAE,IAAK,EAAE,IAAK,EAC3F,IAAI,KAAM,SAAQ,IAAI,EAAiB;YAC7B,QAAQ,CAAC,IAAS;gBAC1B,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACpD,OAAO,KAAK,CAAC;YACd,CAAC;SACD,EACD,IAAI,KAAM,SAAQ,IAAI,EAAwB;YACpC,uBAAuB,CAAC,IAAS,EAAE,IAA4B;gBACvE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAC;gBAC1C,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAC9B,CAAC;SACD,CACD,CAAC;QAEF,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACjB,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAErB,OAAO,IAAI,OAAO,CAAO,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YAC5C,IAAI,cAAc,GAAG,CAAC,CAAC;YACvB,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;gBACtC,cAAc,IAAI,CAAC,CAAC;gBACpB,IAAI,CAAC;oBACJ,MAAM,CAAC,EAAE,CAAC,cAAc,IAAI,CAAC,CAAC,CAAC;gBAChC,CAAC;gBAAC,OAAO,GAAG,EAAE,CAAC;oBACd,MAAM,CAAC,GAAG,CAAC,CAAC;gBACb,CAAC;gBACD,IAAI,KAAK,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE,CAAC;oBACpC,KAAK,CAAC,OAAO,EAAE,CAAC;oBAChB,OAAO,EAAE,CAAC;gBACX,CAAC;YACF,CAAC,CAAC,CAAC,CAAC;YACJ,SAAS,CAAC,wBAAwB,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAChD,SAAS,CAAC,wBAAwB,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"mainThreadDocumentContentProviders.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { URI } from '../../../../base/common/uri.js';\nimport { MainThreadDocumentContentProviders } from '../../browser/mainThreadDocumentContentProviders.js';\nimport { createTextModel } from '../../../../editor/test/common/testTextModel.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { TextEdit } from '../../../../editor/common/languages.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('MainThreadDocumentContentProviders', function () {\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('events are processed properly', function () {\n\n\t\tconst uri = URI.parse('test:uri');\n\t\tconst model = createTextModel('1', undefined, undefined, uri);\n\n\t\tconst providers = new MainThreadDocumentContentProviders(new TestRPCProtocol(), null!, null!,\n\t\t\tnew class extends mock<IModelService>() {\n\t\t\t\toverride getModel(_uri: URI) {\n\t\t\t\t\tassert.strictEqual(uri.toString(), _uri.toString());\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t},\n\t\t\tnew class extends mock<IEditorWorkerService>() {\n\t\t\t\toverride computeMoreMinimalEdits(_uri: URI, data: TextEdit[] | undefined) {\n\t\t\t\t\tassert.strictEqual(model.getValue(), '1');\n\t\t\t\t\treturn Promise.resolve(data);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\tstore.add(model);\n\t\tstore.add(providers);\n\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\tlet expectedEvents = 1;\n\t\t\tstore.add(model.onDidChangeContent(e => {\n\t\t\t\texpectedEvents -= 1;\n\t\t\t\ttry {\n\t\t\t\t\tassert.ok(expectedEvents >= 0);\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t\tif (model.getValue() === '1\\n2\\n3') {\n\t\t\t\t\tmodel.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tproviders.$onVirtualDocumentChange(uri, '1\\n2');\n\t\t\tproviders.$onVirtualDocumentChange(uri, '1\\n2\\n3');\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { URI } from '../../../../base/common/uri.js';\nimport { MainThreadDocumentContentProviders } from '../../browser/mainThreadDocumentContentProviders.js';\nimport { createTextModel } from '../../../../editor/test/common/testTextModel.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { TextEdit } from '../../../../editor/common/languages.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('MainThreadDocumentContentProviders', function () {\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('events are processed properly', function () {\n\n\t\tconst uri = URI.parse('test:uri');\n\t\tconst model = createTextModel('1', undefined, undefined, uri);\n\n\t\tconst providers = new MainThreadDocumentContentProviders(new TestRPCProtocol(), null!, null!,\n\t\t\tnew class extends mock<IModelService>() {\n\t\t\t\toverride getModel(_uri: URI) {\n\t\t\t\t\tassert.strictEqual(uri.toString(), _uri.toString());\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\t\t\t},\n\t\t\tnew class extends mock<IEditorWorkerService>() {\n\t\t\t\toverride computeMoreMinimalEdits(_uri: URI, data: TextEdit[] | undefined) {\n\t\t\t\t\tassert.strictEqual(model.getValue(), '1');\n\t\t\t\t\treturn Promise.resolve(data);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\tstore.add(model);\n\t\tstore.add(providers);\n\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\tlet expectedEvents = 1;\n\t\t\tstore.add(model.onDidChangeContent(e => {\n\t\t\t\texpectedEvents -= 1;\n\t\t\t\ttry {\n\t\t\t\t\tassert.ok(expectedEvents >= 0);\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t\tif (model.getValue() === '1\\n2\\n3') {\n\t\t\t\t\tmodel.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tproviders.$onVirtualDocumentChange(uri, '1\\n2');\n\t\t\tproviders.$onVirtualDocumentChange(uri, '1\\n2\\n3');\n\t\t});\n\t});\n});\n"]}