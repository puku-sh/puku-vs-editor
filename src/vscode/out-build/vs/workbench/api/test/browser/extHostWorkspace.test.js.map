{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/extHostWorkspace.test.ts","vs/workbench/api/test/browser/extHostWorkspace.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,iBAAiB,EAAE,MAAM,yCAAyC,CAAC;AAC5E,OAAO,EAAE,QAAQ,EAAE,MAAM,iCAAiC,CAAC;AAC3D,OAAO,EAAE,GAAG,EAAiB,MAAM,gCAAgC,CAAC;AACpE,OAAO,EAAE,mBAAmB,EAAE,MAAM,sDAAsD,CAAC;AAC3F,OAAO,EAAe,cAAc,EAAE,MAAM,wCAAwC,CAAC;AAGrF,OAAO,EAAgC,WAAW,EAAuB,MAAM,kCAAkC,CAAC;AAClH,OAAO,EAAE,eAAe,EAAE,MAAM,8BAA8B,CAAC;AAC/D,OAAO,EAAE,gBAAgB,EAAE,MAAM,kCAAkC,CAAC;AACpE,OAAO,EAAE,IAAI,EAAE,MAAM,sCAAsC,CAAC;AAC5D,OAAO,EAAE,eAAe,EAAE,MAAM,8BAA8B,CAAC;AAC/D,OAAO,EAAE,iBAAiB,EAAE,MAAM,mCAAmC,CAAC;AAItE,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,qCAAqC,CAAC;AAGzE,OAAO,EAAE,wBAAwB,IAAI,mBAAmB,EAAE,MAAM,mDAAmD,CAAC;AAEpH,OAAO,EAAE,uCAAuC,EAAE,MAAM,uCAAuC,CAAC;AAChG,OAAO,EAAE,qBAAqB,EAAE,MAAM,mDAAmD,CAAC;AAE1F,SAAS,sBAAsB,CAAC,WAAyB,EAAE,IAAoB,EAAE,UAAuB;IACvG,MAAM,MAAM,GAAG,IAAI,gBAAgB,CAClC,IAAI,iBAAiB,CAAC,WAAW,CAAC,EAClC,IAAI,KAAM,SAAQ,IAAI,EAA2B;QAA7C;;YAAyD,cAAS,GAAG,IAAI,CAAC;QAAC,CAAC;KAAA,EAChF,IAAI,KAAM,SAAQ,IAAI,EAA0B;QAAY,eAAe,KAAK,OAAO,OAAO,CAAC,CAAC,6DAAkD,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;KAAE,EAClK,UAAU,EACV,IAAI,KAAM,SAAQ,IAAI,EAA0B;KAAI,CACpD,CAAC;IACF,MAAM,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACxC,OAAO,MAAM,CAAC;AACf,CAAC;AAED,KAAK,CAAC,kBAAkB,EAAE;IAEzB,uCAAuC,EAAE,CAAC;IAE1C,SAAS,oBAAoB,CAAC,SAA2B,EAAE,KAAa,EAAE,QAAgB,EAAE,gBAA0B;QACrH,MAAM,MAAM,GAAG,SAAS,CAAC,eAAe,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;IACtC,CAAC;IAED,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAE3B,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,iCAAiC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAE7L,oBAAoB,CAAC,EAAE,EAAE,gDAAgD,EAAE,gBAAgB,CAAC,CAAC;QAC7F,oBAAoB,CAAC,EAAE,EAAE,2EAA2E,EACnG,2EAA2E,CAAC,CAAC;QAE9E,oBAAoB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACjC,oBAAoB,CAAC,EAAE,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;QACjD,oBAAoB,CAAC,EAAE,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAC9C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oCAAoC,EAAE;QAC1C,MAAM,IAAI,GAAG,yCAAyC,CAAC;QACvD,MAAM,KAAK,GAAG,yCAAyC,CAAC;QACxD,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEhK,oBAAoB,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,MAAM,GAAG,gDAAgD,CAAC;QAChE,oBAAoB,CAAC,EAAE,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;IAC5C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8BAA8B,EAAE;QACpC,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,IAAK,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QACtF,oBAAoB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QACjC,oBAAoB,CAAC,EAAE,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kCAAkC,EAAE;QACxC,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAC3N,oBAAoB,CAAC,EAAE,EAAE,sBAAsB,EAAE,cAAc,CAAC,CAAC;QACjE,oBAAoB,CAAC,EAAE,EAAE,2BAA2B,EAAE,mBAAmB,CAAC,CAAC;QAC3E,oBAAoB,CAAC,EAAE,EAAE,4BAA4B,EAAE,4BAA4B,CAAC,CAAC;IACtF,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kFAAkF,EAAE;QACxF,MAAM,IAAI,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAE7N,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,cAAc,CAAC,CAAC;QACnE,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;QACzE,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC;QACtE,oBAAoB,CAAC,IAAI,EAAE,2BAA2B,EAAE,mBAAmB,CAAC,CAAC;QAC7E,oBAAoB,CAAC,IAAI,EAAE,2BAA2B,EAAE,mBAAmB,EAAE,IAAI,CAAC,CAAC;QACnF,oBAAoB,CAAC,IAAI,EAAE,2BAA2B,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAChF,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,CAAC,CAAC;QACvF,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,IAAI,CAAC,CAAC;QAC7F,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,KAAK,CAAC,CAAC;QAE9F,MAAM,IAAI,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAC3K,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,UAAU,CAAC,CAAC;QAC/D,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC;QACtE,oBAAoB,CAAC,IAAI,EAAE,sBAAsB,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;QACzE,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,CAAC,CAAC;QACvF,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,IAAI,CAAC,CAAC;QAC7F,oBAAoB,CAAC,IAAI,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,KAAK,CAAC,CAAC;IAC/F,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,iBAAiB,EAAE;QACvB,IAAI,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QACvH,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,SAAS,CAAC,CAAC;QAE5C,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,IAAK,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,SAAS,CAAC,CAAC;QAE5C,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,SAAU,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QACrF,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,SAAS,CAAC,CAAC;QAE5C,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QACnN,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAG,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE,SAAS,CAAC,CAAC;QAEjE,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAC/J,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAG,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE,SAAS,CAAC,CAAC;IAClE,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oCAAoC,EAAE;QAC1C,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAE3N,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC;QAE7C,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QACpC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACjC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QACpC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IAClC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8BAA8B,EAAE,GAAG,EAAE;QACzC,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE;YACxD,EAAE,EAAE,KAAK;YACT,IAAI,EAAE,MAAM;YACZ,OAAO,EAAE;gBACR,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;gBAChD,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;gBAChD,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC;aACvD;SACD,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEzB,IAAI,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QAEtC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAE,CAAC;QACvE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAE,CAAC;QACvE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAE,CAAC;QAC9D,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAE,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAE1C,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAE,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAE1C,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,IAAI,CAAE,CAAC;QACtE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,CAAC,EAAE,IAAI,CAAE,CAAC;QACvE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAEvC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAE,CAAC;QAChE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAE1C,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAE,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAE1C,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,CAAE,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QAEtC,MAAM,GAAG,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,KAAK,CAAE,CAAC;QAChE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oDAAoD,EAAE,UAAU,IAAI;QACxE,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEzH,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,MAAM,MAAM,GAAG,CAAC,KAAW,EAAE,EAAE;YAC9B,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACf,QAAQ,GAAG,IAAI,CAAC;gBAChB,IAAI,CAAC,KAAK,CAAC,CAAC;YACb,CAAC;QACF,CAAC,CAAC;QAEF,IAAI,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACrC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;gBACpC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;YACvC,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC;QAClE,GAAG,CAAC,OAAO,EAAE,CAAC;QAEd,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;YAC1D,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAC/G,GAAG,CAAC,OAAO,EAAE,CAAC;QAEd,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,CAAC;YAC3D,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAC/J,GAAG,CAAC,OAAO,EAAE,CAAC;QAEd,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;gBAC3D,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,CAAC;gBAE5D,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,CAAC;YAC3D,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAChH,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,EAAE,CAAC;IACV,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,iDAAiD,EAAE;QACvD,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEtK,MAAM,WAAW,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QACjD,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;QAE1K,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;QAC9D,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;QAEhD,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAC/M,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;QAC9D,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAEzC,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAChH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAE/J,MAAM,CAAC,cAAc,CAAC,WAAW,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4CAA4C,EAAE;QAClD,IAAI,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEvH,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,IAAK,EAAE,IAAK,CAAC,CAAC,CAAC;QACxF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACjF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QAElF,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAEhK,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IACpI,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,0CAA0C,EAAE,UAAU,IAAI;QAC9D,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,MAAM,MAAM,GAAG,CAAC,KAAW,EAAE,EAAE;YAC9B,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACf,QAAQ,GAAG,IAAI,CAAC;gBAChB,IAAI,CAAC,KAAK,CAAC,CAAC;YACb,CAAC;QACF,CAAC,CAAC;QAEF,MAAM,QAAQ,GAAiB;YAC9B,QAAQ,EAAE,GAAG,EAAE,GAAG,OAAO,SAAU,CAAC,CAAC,CAAC;YACtC,GAAG,EAAE,GAAG,EAAE,GAAG,OAAO,SAAU,CAAC,CAAC,CAAC;YACjC,OAAO,EAAE,GAAG,EAAE,GAAG,CAAC;YAClB,gBAAgB,EAAE,GAAG,EAAE,GAAG,CAAC;YAC3B,KAAK,EAAE,GAAG,EAAE,GAAG,OAAO,SAAU,CAAC,CAAC,CAAC;SACnC,CAAC;QAEF,MAAM,EAAE,GAAG,sBAAsB,CAAC,QAAQ,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAE5G,EAAE;QACF,iBAAiB;QACjB,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QAClI,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE7F,MAAM,gBAAgB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QAEtD,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,IAAI,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACrC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;gBACzD,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;gBAChF,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QAC1J,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAElG,EAAE;QACF,uBAAuB;QACvB,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACvL,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE9F,MAAM,iBAAiB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QACvD,MAAM,gBAAgB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QAEtD,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,CAAC;gBAC1D,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,UAAU,CAAC,CAAC;gBAC1D,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC;gBAClD,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;gBACjD,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QAC1P,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QACnG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAElG,EAAE;QACF,oBAAoB;QACpB,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAC/E,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE9F,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;gBACpC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;gBACnD,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QAC1M,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QAEnG,EAAE;QACF,gBAAgB;QAChB,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,WAAW,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC;QAChN,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACnE,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAEnE,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;gBACpC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACxC,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QACpO,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QACnG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACnE,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAEnE,EAAE;QACF,yBAAyB;QACzB,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACvL,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE9F,MAAM,iBAAiB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QACvD,MAAM,gBAAgB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QAEtD,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC;gBAClD,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;gBACjD,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;gBACnD,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC;gBACpD,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QAC3M,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QACnG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAElG,EAAE;QACF,eAAe;QACf,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACvL,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QAEnG,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACxC,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,0CAA0C;QAC3M,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QACnG,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAE/C,EAAE;QACF,4FAA4F;QAC5F,EAAE;QAEF,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,sBAAsB,CAAC,mBAAmB,EAAE,CAAC,EAAE,CAAC,EAAE,2BAA2B,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QAEnI,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,SAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE9F,MAAM,gBAAgB,GAAG,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,CAAC;QAEtD,QAAQ,GAAG,KAAK,CAAC;QACjB,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACjC,IAAI,CAAC;gBACJ,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;gBACjD,QAAQ,GAAG,IAAI,CAAC;YACjB,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC;YACvB,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE;gBACjC,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;gBAC9C,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;gBAC9C,oBAAoB,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;aAC9C;SACD,CAAC,CAAC,CAAC,0CAA0C;QAC9C,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QACnC,GAAG,CAAC,OAAO,EAAE,CAAC;QAEd,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAClG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,iBAAiB,CAAC,CAAC,CAAC,8BAA8B;QACnG,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAG,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,8BAA8B;QAElG,MAAM,EAAE,CAAC;IACV,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qCAAqC,EAAE,UAAU,IAAI;QACzD,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,MAAM,MAAM,GAAG,CAAC,KAAW,EAAE,EAAE;YAC9B,IAAI,CAAC,QAAQ,EAAE,CAAC;gBACf,QAAQ,GAAG,IAAI,CAAC;gBAChB,IAAI,CAAC,KAAK,CAAC,CAAC;YACb,CAAC;QACF,CAAC,CAAC;QAEF,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QACzH,MAAM,GAAG,GAAG,EAAE,CAAC,oBAAoB,CAAC,CAAC,CAAC,EAAE;YACvC,IAAI,CAAC;gBACJ,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE;oBAClB,mDAAmD;oBAC7C,CAAE,CAAC,KAAK,GAAG,EAAE,CAAC;gBACrB,CAAC,CAAC,CAAC;gBACH,wBAAwB;gBACxB,6BAA6B;gBAC7B,MAAM;YACP,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;YACf,CAAC;QACF,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,oBAAoB,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC;QAClE,GAAG,CAAC,OAAO,EAAE,CAAC;QACd,MAAM,EAAE,CAAC;IACV,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qHAAqH,EAAE;QAC3H,IAAI,SAAS,EAAE,CAAC;YAEf,MAAM,EAAE,GAAG,sBAAsB,CAAC,IAAI,eAAe,EAAE,EAAE;gBACxD,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE;oBACjC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,kCAAkC,CAAC,EAAE,CAAC,CAAC;iBACrE;aACD,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YAEzB,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,uCAAuC,CAAC,CAAC,CAAC,CAAC;YACpF,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,uCAAuC,CAAC,CAAC,CAAC,CAAC;QACrF,CAAC;IACF,CAAC,CAAC,CAAC;IAEH,SAAS,oBAAoB,CAAC,GAAQ,EAAE,KAAa,EAAE,OAAe,EAAE;QACvE,OAAO;YACN,GAAG;YACH,KAAK;YACL,IAAI,EAAE,IAAI,IAAI,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC;SAChC,CAAC;IACH,CAAC;IAED,SAAS,2BAA2B,CAAC,GAAQ,EAAE,IAAa;QAC3D,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;IACtB,CAAC;IAED,KAAK,CAAC,aAAa,EAAE;QACpB,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE;YAC3B,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;oBAClD,MAAM,CAAC,WAAW,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;oBAC3C,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACpF,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,SAAS,oBAAoB,CAAC,OAAwB;YACrD,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;oBACtH,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,SAAS,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACtF,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC;QAED,IAAI,CAAC,kCAAkC,EAAE,GAAG,EAAE;YAC7C,OAAO,oBAAoB,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,CAAC;QAC9E,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,+BAA+B,EAAE,GAAG,EAAE;YAC1C,OAAO,oBAAoB,CAAC,IAAI,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC;QACxF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE;YACxB,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,cAAe,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;oBACrG,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAAC,CAAC;oBAC3D,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,SAAS,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACzH,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,EAAE,GAAG,EAAE;YACjC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YAEtJ,MAAM,KAAK,GAAG,iBAAiB,CAAC,SAAS,CAAC;YAC1C,OAAO,EAAE,CAAC,SAAS,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAChI,MAAM,CAAC,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,GAAG,EAAE;YACpC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC,oDAAoD;oBACtH,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,IAAI,eAAe,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC5G,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,cAAc,EAAE;QACrB,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE;YAC3B,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;oBAC/C,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;oBAC3C,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,EAAE,EAAE,UAAU,EAAE,EAAE,EAAE,kBAAkB,EAAE,qBAAqB,CAAC,YAAY,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACpJ,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,SAAS,qBAAqB,CAAC,OAA0B;YACxD,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;oBACnD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;oBACtH,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,UAAU,EAAE,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC5F,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC;QAED,IAAI,CAAC,kCAAkC,EAAE,GAAG,EAAE;YAC7C,OAAO,qBAAqB,CAAC,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;QACjF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,+BAA+B,EAAE,GAAG,EAAE;YAC1C,OAAO,qBAAqB,CAAC,CAAC,IAAI,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;QAC3F,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE;YACxB,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;oBACnD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,cAAe,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;oBACrG,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACtH,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE;YACpB,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBACvD,CAAC;aACD,CAAC,CAAC;YAEH,uFAAuF;YACvF,MAAM,OAAO,GAAG,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC1D,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YAEpH,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,EAAE,eAAe,CAAC,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;gBACxG,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;gBAC7C,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBAC7B,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC1E,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,EAAE,GAAG,EAAE;YACjC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YAEtJ,MAAM,KAAK,GAAG,iBAAiB,CAAC,SAAS,CAAC;YAC1C,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC7H,MAAM,CAAC,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,GAAG,EAAE;YACpC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC,oDAAoD;oBACtH,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,CAAC,IAAI,eAAe,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC1H,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE;YAC3B,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;oBAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAC;oBACxD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;oBAC9D,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;oBAC9D,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,cAAc,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBACtI,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,EAAE,GAAG,EAAE;YACzB,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,gBAAgB,CAAC,cAAoC,EAAE,OAAiC,EAAE,KAAwB;oBAC1H,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;oBAClD,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,OAAO,EAAE,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,cAAc,EAAE,IAAI,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC/F,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,0DAA0D;IAE3D,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,mBAAmB,EAAE;QAC1B,IAAI,CAAC,YAAY,EAAE,KAAK,IAAI,EAAE;YAC7B,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACjC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC;YAC7F,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gBAAgB,EAAE,KAAK,IAAI,EAAE;YACjC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACjC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;oBACvD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC;YAClH,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,MAAO,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;oBAC7F,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC;YACvJ,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,EAAE,KAAK,IAAI,EAAE;YACvC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,KAAK,GAAG,iBAAiB,CAAC,SAAS,CAAC;YAC1C,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC;YACpG,MAAM,CAAC,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACrC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC,+BAA+B;oBACjG,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,EAAE,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC;YACvJ,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,oBAAoB,EAAE;QAC3B,IAAI,CAAC,YAAY,EAAE,KAAK,IAAI,EAAE;YAC7B,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACjC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAC9F,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gBAAgB,EAAE,KAAK,IAAI,EAAE;YACjC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACjC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;oBACvD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YACrH,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,MAAO,CAAC,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;oBAC7F,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAC1J,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,EAAE,KAAK,IAAI,EAAE;YACvC,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,KAAK,GAAG,iBAAiB,CAAC,SAAS,CAAC;YAC1C,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC;YAC5G,MAAM,CAAC,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,IAAI,GAAG,cAAc,CAAC;YAC5B,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;YAE1C,IAAI,gBAAgB,GAAG,KAAK,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAuB;gBACpF,KAAK,CAAC,gBAAgB,CAAC,KAAmB,EAAE,MAA4B,EAAE,OAAiC,EAAE,SAAiB,EAAE,KAAwB;oBAChK,gBAAgB,GAAG,IAAI,CAAC;oBACxB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;oBACzC,MAAM,CAAC,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;oBACrC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;oBACtD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC,+BAA+B;oBACjG,OAAO,IAAI,CAAC;gBACb,CAAC;aACD,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,sBAAsB,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;YACtJ,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,IAAI,eAAe,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAC1J,MAAM,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,yCAAyC;IAC1C,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"extHostWorkspace.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { basename } from '../../../../base/common/path.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { ILogService, NullLogService } from '../../../../platform/log/common/log.js';\nimport { IWorkspaceFolderData } from '../../../../platform/workspace/common/workspace.js';\nimport { MainThreadWorkspace } from '../../browser/mainThreadWorkspace.js';\nimport { IMainContext, IWorkspaceData, MainContext, ITextSearchComplete } from '../../common/extHost.protocol.js';\nimport { RelativePattern } from '../../common/extHostTypes.js';\nimport { ExtHostWorkspace } from '../../common/extHostWorkspace.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { ExtHostRpcService } from '../../common/extHostRpcService.js';\nimport { IExtHostInitDataService } from '../../common/extHostInitDataService.js';\nimport { IFileQueryBuilderOptions, ITextQueryBuilderOptions } from '../../../services/search/common/queryBuilder.js';\nimport { IPatternInfo } from '../../../services/search/common/search.js';\nimport { isLinux, isWindows } from '../../../../base/common/platform.js';\nimport { IExtHostFileSystemInfo } from '../../common/extHostFileSystemInfo.js';\nimport { FileSystemProviderCapabilities } from '../../../../platform/files/common/files.js';\nimport { nullExtensionDescription as extensionDescriptor } from '../../../services/extensions/common/extensions.js';\nimport { IURITransformerService } from '../../common/extHostUriTransformerService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { ExcludeSettingOptions } from '../../../services/search/common/searchExtTypes.js';\n\nfunction createExtHostWorkspace(mainContext: IMainContext, data: IWorkspaceData, logService: ILogService): ExtHostWorkspace {\n\tconst result = new ExtHostWorkspace(\n\t\tnew ExtHostRpcService(mainContext),\n\t\tnew class extends mock<IExtHostInitDataService>() { override workspace = data; },\n\t\tnew class extends mock<IExtHostFileSystemInfo>() { override getCapabilities() { return isLinux ? FileSystemProviderCapabilities.PathCaseSensitive : undefined; } },\n\t\tlogService,\n\t\tnew class extends mock<IURITransformerService>() { }\n\t);\n\tresult.$initializeWorkspace(data, true);\n\treturn result;\n}\n\nsuite('ExtHostWorkspace', function () {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertAsRelativePath(workspace: ExtHostWorkspace, input: string, expected: string, includeWorkspace?: boolean) {\n\t\tconst actual = workspace.getRelativePath(input, includeWorkspace);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\ttest('asRelativePath', () => {\n\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/Applications/NewsWoWBot'), 0)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(ws, '/Coding/Applications/NewsWoWBot/bernd/das/brot', 'bernd/das/brot');\n\t\tassertAsRelativePath(ws, '/Apps/DartPubCache/hosted/pub.dartlang.org/convert-2.0.1/lib/src/hex.dart',\n\t\t\t'/Apps/DartPubCache/hosted/pub.dartlang.org/convert-2.0.1/lib/src/hex.dart');\n\n\t\tassertAsRelativePath(ws, '', '');\n\t\tassertAsRelativePath(ws, '/foo/bar', '/foo/bar');\n\t\tassertAsRelativePath(ws, 'in/out', 'in/out');\n\t});\n\n\ttest('asRelativePath, same paths, #11402', function () {\n\t\tconst root = '/home/aeschli/workspaces/samples/docker';\n\t\tconst input = '/home/aeschli/workspaces/samples/docker';\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(ws, input, input);\n\n\t\tconst input2 = '/home/aeschli/workspaces/samples/docker/a.file';\n\t\tassertAsRelativePath(ws, input2, 'a.file');\n\t});\n\n\ttest('asRelativePath, no workspace', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), null!, new NullLogService());\n\t\tassertAsRelativePath(ws, '', '');\n\t\tassertAsRelativePath(ws, '/foo/bar', '/foo/bar');\n\t});\n\n\ttest('asRelativePath, multiple folders', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\t\tassertAsRelativePath(ws, '/Coding/One/file.txt', 'One/file.txt');\n\t\tassertAsRelativePath(ws, '/Coding/Two/files/out.txt', 'Two/files/out.txt');\n\t\tassertAsRelativePath(ws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t});\n\n\ttest('slightly inconsistent behaviour of asRelativePath and getWorkspaceFolder, #31553', function () {\n\t\tconst mrws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'One/file.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'One/file.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'file.txt', false);\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'Two/files/out.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'Two/files/out.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'files/out.txt', false);\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', false);\n\n\t\tconst srws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0)], name: 'Test' }, new NullLogService());\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'file.txt');\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'file.txt', false);\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'One/file.txt', true);\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', true);\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', false);\n\t});\n\n\ttest('getPath, legacy', function () {\n\t\tlet ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), null!, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), undefined!, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.file('Folder'), 0), aWorkspaceFolderData(URI.file('Another/Folder'), 1)] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath()!.replace(/\\\\/g, '/'), '/Folder');\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.file('/Folder'), 0)] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath()!.replace(/\\\\/g, '/'), '/Folder');\n\t});\n\n\ttest('WorkspaceFolder has name and index', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\n\t\tconst [one, two] = ws.getWorkspaceFolders()!;\n\n\t\tassert.strictEqual(one.name, 'One');\n\t\tassert.strictEqual(one.index, 0);\n\t\tassert.strictEqual(two.name, 'Two');\n\t\tassert.strictEqual(two.index, 1);\n\t});\n\n\ttest('getContainingWorkspaceFolder', () => {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), {\n\t\t\tid: 'foo',\n\t\t\tname: 'Test',\n\t\t\tfolders: [\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/One'), 0),\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/Two'), 1),\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/Two/Nested'), 2)\n\t\t\t]\n\t\t}, new NullLogService());\n\n\t\tlet folder = ws.getWorkspaceFolder(URI.file('/foo/bar'));\n\t\tassert.strictEqual(folder, undefined);\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/One/file/path.txt'))!;\n\t\tassert.strictEqual(folder.name, 'One');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/file/path.txt'))!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nest'))!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/file'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/f'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested'), true)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/'), true)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two'), true)!;\n\t\tassert.strictEqual(folder, undefined);\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two'), false)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\t});\n\n\ttest('Multiroot change event should have a delta, #29641', function (done) {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tlet sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar2');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar2'), 1)] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.removed.length, 2);\n\t\t\t\tassert.strictEqual(e.removed[0].uri.toString(), 'foo:bar');\n\t\t\t\tassert.strictEqual(e.removed[1].uri.toString(), 'foo:bar2');\n\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar3');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0)] });\n\t\tsub.dispose();\n\t\tfinish();\n\t});\n\n\ttest('Multiroot change keeps existing workspaces live', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }, new NullLogService());\n\n\t\tconst firstFolder = ws.getWorkspaceFolders()![0];\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar2'), 0), aWorkspaceFolderData(URI.parse('foo:bar'), 1, 'renamed')] });\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], firstFolder);\n\t\tassert.strictEqual(firstFolder.index, 1);\n\t\tassert.strictEqual(firstFolder.name, 'renamed');\n\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar2'), 1), aWorkspaceFolderData(URI.parse('foo:bar'), 2)] });\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], firstFolder);\n\t\tassert.strictEqual(firstFolder.index, 2);\n\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0)] });\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar'), 1)] });\n\n\t\tassert.notStrictEqual(firstFolder, ws.workspace!.folders[0]);\n\t});\n\n\ttest('updateWorkspaceFolders - invalid arguments', function () {\n\t\tlet ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, null!, null!));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 1));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 1, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, -1, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, -1, -1));\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }, new NullLogService());\n\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 1, 1));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 1, asUpdateWorkspaceFolderData(URI.parse('foo:bar'))));\n\t});\n\n\ttest('updateWorkspaceFolders - valid arguments', function (done) {\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tconst protocol: IMainContext = {\n\t\t\tgetProxy: () => { return undefined!; },\n\t\t\tset: () => { return undefined!; },\n\t\t\tdispose: () => { },\n\t\t\tassertRegistered: () => { },\n\t\t\tdrain: () => { return undefined!; },\n\t\t};\n\n\t\tconst ws = createExtHostWorkspace(protocol, { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\t//\n\t\t// Add one folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar'))));\n\t\tassert.strictEqual(1, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\n\t\tconst firstAddedFolder = ws.getWorkspaceFolders()![0];\n\n\t\tlet gotEvent = false;\n\t\tlet sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar');\n\t\t\t\tassert.strictEqual(e.added[0], firstAddedFolder); // verify object is still live\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Add two more folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 1, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar1')), asUpdateWorkspaceFolderData(URI.parse('foo:bar2'))));\n\t\tassert.strictEqual(3, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[2].uri.toString(), URI.parse('foo:bar2').toString());\n\n\t\tconst secondAddedFolder = ws.getWorkspaceFolders()![1];\n\t\tconst thirdAddedFolder = ws.getWorkspaceFolders()![2];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 2);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar1');\n\t\t\t\tassert.strictEqual(e.added[1].uri.toString(), 'foo:bar2');\n\t\t\t\tassert.strictEqual(e.added[0], secondAddedFolder);\n\t\t\t\tassert.strictEqual(e.added[1], thirdAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar1'), 1), aWorkspaceFolderData(URI.parse('foo:bar2'), 2)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], thirdAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Remove one folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 2, 1));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.strictEqual(e.removed.length, 1);\n\t\t\t\tassert.strictEqual(e.removed[0], thirdAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar1'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Rename folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar'), 'renamed 1'), asUpdateWorkspaceFolderData(URI.parse('foo:bar1'), 'renamed 2')));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.workspace!.folders[1].name, 'renamed 2');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1].name, 'renamed 2');\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.strictEqual(e.removed.length, 0);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0, 'renamed 1'), aWorkspaceFolderData(URI.parse('foo:bar1'), 1, 'renamed 2')] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.workspace!.folders[0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.workspace!.folders[1].name, 'renamed 2');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1].name, 'renamed 2');\n\n\t\t//\n\t\t// Add and remove folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar3')), asUpdateWorkspaceFolderData(URI.parse('foo:bar4'))));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar3').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar4').toString());\n\n\t\tconst fourthAddedFolder = ws.getWorkspaceFolders()![0];\n\t\tconst fifthAddedFolder = ws.getWorkspaceFolders()![1];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 2);\n\t\t\t\tassert.strictEqual(e.added[0], fourthAddedFolder);\n\t\t\t\tassert.strictEqual(e.added[1], fifthAddedFolder);\n\t\t\t\tassert.strictEqual(e.removed.length, 2);\n\t\t\t\tassert.strictEqual(e.removed[0], firstAddedFolder);\n\t\t\t\tassert.strictEqual(e.removed[1], secondAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar4'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fifthAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Swap folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar4')), asUpdateWorkspaceFolderData(URI.parse('foo:bar3'))));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar4').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar3').toString());\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 0);\n\t\t\t\tassert.strictEqual(e.removed.length, 0);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar4'), 0), aWorkspaceFolderData(URI.parse('foo:bar3'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(fifthAddedFolder.index, 0);\n\t\tassert.strictEqual(fourthAddedFolder.index, 1);\n\n\t\t//\n\t\t// Add one folder after the other without waiting for confirmation (not supported currently)\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 2, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar5'))));\n\n\t\tassert.strictEqual(3, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar4').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar3').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[2].uri.toString(), URI.parse('foo:bar5').toString());\n\n\t\tconst sixthAddedFolder = ws.getWorkspaceFolders()![2];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0], sixthAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({\n\t\t\tid: 'foo', name: 'Test', folders: [\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar4'), 0),\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar3'), 1),\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar5'), 2)\n\t\t\t]\n\t\t}); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], sixthAddedFolder); // verify object is still live\n\n\t\tfinish();\n\t});\n\n\ttest('Multiroot change event is immutable', function (done) {\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\t\tconst sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t(<any>e).added = [];\n\t\t\t\t});\n\t\t\t\t// assert.throws(() => {\n\t\t\t\t// \t(<any>e.added)[0] = null;\n\t\t\t\t// });\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [] });\n\t\tsub.dispose();\n\t\tfinish();\n\t});\n\n\ttest('`vscode.workspace.getWorkspaceFolder(file)` don\\'t return workspace folder when file open from command line. #36221', function () {\n\t\tif (isWindows) {\n\n\t\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), {\n\t\t\t\tid: 'foo', name: 'Test', folders: [\n\t\t\t\t\taWorkspaceFolderData(URI.file('c:/Users/marek/Desktop/vsc_test/'), 0)\n\t\t\t\t]\n\t\t\t}, new NullLogService());\n\n\t\t\tassert.ok(ws.getWorkspaceFolder(URI.file('c:/Users/marek/Desktop/vsc_test/a.txt')));\n\t\t\tassert.ok(ws.getWorkspaceFolder(URI.file('C:/Users/marek/Desktop/vsc_test/b.txt')));\n\t\t}\n\t});\n\n\tfunction aWorkspaceFolderData(uri: URI, index: number, name: string = ''): IWorkspaceFolderData {\n\t\treturn {\n\t\t\turi,\n\t\t\tindex,\n\t\t\tname: name || basename(uri.path)\n\t\t};\n\t}\n\n\tfunction asUpdateWorkspaceFolderData(uri: URI, name?: string): { uri: URI; name?: string } {\n\t\treturn { uri, name };\n\t}\n\n\tsuite('findFiles -', function () {\n\t\ttest('string include', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'foo');\n\t\t\t\t\tassert.strictEqual(_includeFolder, null);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.maxResults, 10);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles('foo', undefined, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\tfunction testFindFilesInclude(pattern: RelativePattern) {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.deepStrictEqual(_includeFolder ? URI.from(_includeFolder).toJSON() : null, URI.file('/other/folder').toJSON());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles(pattern, undefined, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t}\n\n\t\ttest('RelativePattern include (string)', () => {\n\t\t\treturn testFindFilesInclude(new RelativePattern('/other/folder', 'glob/**'));\n\t\t});\n\n\t\ttest('RelativePattern include (URI)', () => {\n\t\t\treturn testFindFilesInclude(new RelativePattern(URI.file('/other/folder'), 'glob/**'));\n\t\t});\n\n\t\ttest('no excludes', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(_includeFolder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, true);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles(new RelativePattern('/other/folder', 'glob/**'), null, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('with cancelled token', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\treturn ws.findFiles(new RelativePattern('/other/folder', 'glob/**'), null, 10, new ExtensionIdentifier('test'), token).then(() => {\n\t\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('RelativePattern exclude', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // Note that the base portion is ignored, see #52651\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles('', new RelativePattern(root, 'glob/**'), 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\t});\n\n\tsuite('findFiles2 -', function () {\n\t\ttest('string include', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'foo');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(_includeFolder, null);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.maxResults, 10);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2(['foo'], { maxResults: 10, useExcludeSettings: ExcludeSettingOptions.FilesExclude }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\tfunction testFindFiles2Include(pattern: RelativePattern[]) {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.deepStrictEqual(_includeFolder ? URI.from(_includeFolder).toJSON() : null, URI.file('/other/folder').toJSON());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2(pattern, { maxResults: 10 }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t}\n\n\t\ttest('RelativePattern include (string)', () => {\n\t\t\treturn testFindFiles2Include([new RelativePattern('/other/folder', 'glob/**')]);\n\t\t});\n\n\t\ttest('RelativePattern include (URI)', () => {\n\t\t\treturn testFindFiles2Include([new RelativePattern(URI.file('/other/folder'), 'glob/**')]);\n\t\t});\n\n\t\ttest('no excludes', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(_includeFolder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([new RelativePattern('/other/folder', 'glob/**')], {}, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('no dups', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve([URI.file(root + '/main.py')]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Only add the root directory as a workspace folder - main.py will be a file within it\n\t\t\tconst folders = [aWorkspaceFolderData(URI.file(root), 0)];\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: folders, name: 'Test' }, new NullLogService());\n\n\t\t\treturn ws.findFiles2(['**/main.py', '**/main.py/**'], {}, new ExtensionIdentifier('test')).then((uris) => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t\tassert.equal(uris.length, 1);\n\t\t\t\tassert.equal(uris[0].toString(), URI.file(root + '/main.py').toString());\n\t\t\t});\n\t\t});\n\n\t\ttest('with cancelled token', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\treturn ws.findFiles2([new RelativePattern('/other/folder', 'glob/**')], {}, new ExtensionIdentifier('test'), token).then(() => {\n\t\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('RelativePattern exclude', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // Note that the base portion is ignored, see #52651\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { exclude: [new RelativePattern(root, 'glob/**')] }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\t\ttest('useIgnoreFiles', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.disregardIgnoreFiles, false);\n\t\t\t\t\tassert.strictEqual(options.disregardGlobalIgnoreFiles, false);\n\t\t\t\t\tassert.strictEqual(options.disregardParentIgnoreFiles, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { useIgnoreFiles: { local: true, parent: true, global: true } }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('use symlinks', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.ignoreSymlinks, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { followSymlinks: true }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\t// todo: add tests with multiple filePatterns and excludes\n\n\t});\n\n\tsuite('findTextInFiles -', function () {\n\t\ttest('no include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, {}, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('string include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, '**/files');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { include: '**/files' }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(folder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { include: new RelativePattern('/other/folder', 'glob/**') }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('with cancelled token', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, {}, () => { }, new ExtensionIdentifier('test'), token);\n\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern exclude', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // exclude folder is ignored...\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { exclude: new RelativePattern('/other/folder', 'glob/**') }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\t});\n\n\tsuite('findTextInFiles2 -', function () {\n\t\ttest('no include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, {}, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('string include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, '**/files');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { include: ['**/files'] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(folder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { include: [new RelativePattern('/other/folder', 'glob/**')] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('with cancelled token', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, undefined, new ExtensionIdentifier('test'), token)).complete;\n\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern exclude', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // exclude folder is ignored...\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { exclude: [new RelativePattern('/other/folder', 'glob/**')] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\t// TODO: test multiple includes/excludess\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { basename } from '../../../../base/common/path.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { ILogService, NullLogService } from '../../../../platform/log/common/log.js';\nimport { IWorkspaceFolderData } from '../../../../platform/workspace/common/workspace.js';\nimport { MainThreadWorkspace } from '../../browser/mainThreadWorkspace.js';\nimport { IMainContext, IWorkspaceData, MainContext, ITextSearchComplete } from '../../common/extHost.protocol.js';\nimport { RelativePattern } from '../../common/extHostTypes.js';\nimport { ExtHostWorkspace } from '../../common/extHostWorkspace.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { ExtHostRpcService } from '../../common/extHostRpcService.js';\nimport { IExtHostInitDataService } from '../../common/extHostInitDataService.js';\nimport { IFileQueryBuilderOptions, ITextQueryBuilderOptions } from '../../../services/search/common/queryBuilder.js';\nimport { IPatternInfo } from '../../../services/search/common/search.js';\nimport { isLinux, isWindows } from '../../../../base/common/platform.js';\nimport { IExtHostFileSystemInfo } from '../../common/extHostFileSystemInfo.js';\nimport { FileSystemProviderCapabilities } from '../../../../platform/files/common/files.js';\nimport { nullExtensionDescription as extensionDescriptor } from '../../../services/extensions/common/extensions.js';\nimport { IURITransformerService } from '../../common/extHostUriTransformerService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { ExcludeSettingOptions } from '../../../services/search/common/searchExtTypes.js';\n\nfunction createExtHostWorkspace(mainContext: IMainContext, data: IWorkspaceData, logService: ILogService): ExtHostWorkspace {\n\tconst result = new ExtHostWorkspace(\n\t\tnew ExtHostRpcService(mainContext),\n\t\tnew class extends mock<IExtHostInitDataService>() { override workspace = data; },\n\t\tnew class extends mock<IExtHostFileSystemInfo>() { override getCapabilities() { return isLinux ? FileSystemProviderCapabilities.PathCaseSensitive : undefined; } },\n\t\tlogService,\n\t\tnew class extends mock<IURITransformerService>() { }\n\t);\n\tresult.$initializeWorkspace(data, true);\n\treturn result;\n}\n\nsuite('ExtHostWorkspace', function () {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction assertAsRelativePath(workspace: ExtHostWorkspace, input: string, expected: string, includeWorkspace?: boolean) {\n\t\tconst actual = workspace.getRelativePath(input, includeWorkspace);\n\t\tassert.strictEqual(actual, expected);\n\t}\n\n\ttest('asRelativePath', () => {\n\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/Applications/NewsWoWBot'), 0)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(ws, '/Coding/Applications/NewsWoWBot/bernd/das/brot', 'bernd/das/brot');\n\t\tassertAsRelativePath(ws, '/Apps/DartPubCache/hosted/pub.dartlang.org/convert-2.0.1/lib/src/hex.dart',\n\t\t\t'/Apps/DartPubCache/hosted/pub.dartlang.org/convert-2.0.1/lib/src/hex.dart');\n\n\t\tassertAsRelativePath(ws, '', '');\n\t\tassertAsRelativePath(ws, '/foo/bar', '/foo/bar');\n\t\tassertAsRelativePath(ws, 'in/out', 'in/out');\n\t});\n\n\ttest('asRelativePath, same paths, #11402', function () {\n\t\tconst root = '/home/aeschli/workspaces/samples/docker';\n\t\tconst input = '/home/aeschli/workspaces/samples/docker';\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(ws, input, input);\n\n\t\tconst input2 = '/home/aeschli/workspaces/samples/docker/a.file';\n\t\tassertAsRelativePath(ws, input2, 'a.file');\n\t});\n\n\ttest('asRelativePath, no workspace', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), null!, new NullLogService());\n\t\tassertAsRelativePath(ws, '', '');\n\t\tassertAsRelativePath(ws, '/foo/bar', '/foo/bar');\n\t});\n\n\ttest('asRelativePath, multiple folders', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\t\tassertAsRelativePath(ws, '/Coding/One/file.txt', 'One/file.txt');\n\t\tassertAsRelativePath(ws, '/Coding/Two/files/out.txt', 'Two/files/out.txt');\n\t\tassertAsRelativePath(ws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t});\n\n\ttest('slightly inconsistent behaviour of asRelativePath and getWorkspaceFolder, #31553', function () {\n\t\tconst mrws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'One/file.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'One/file.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/One/file.txt', 'file.txt', false);\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'Two/files/out.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'Two/files/out.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/Two/files/out.txt', 'files/out.txt', false);\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', true);\n\t\tassertAsRelativePath(mrws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', false);\n\n\t\tconst srws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0)], name: 'Test' }, new NullLogService());\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'file.txt');\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'file.txt', false);\n\t\tassertAsRelativePath(srws, '/Coding/One/file.txt', 'One/file.txt', true);\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt');\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', true);\n\t\tassertAsRelativePath(srws, '/Coding/Two2/files/out.txt', '/Coding/Two2/files/out.txt', false);\n\t});\n\n\ttest('getPath, legacy', function () {\n\t\tlet ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), null!, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), undefined!, new NullLogService());\n\t\tassert.strictEqual(ws.getPath(), undefined);\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.file('Folder'), 0), aWorkspaceFolderData(URI.file('Another/Folder'), 1)] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath()!.replace(/\\\\/g, '/'), '/Folder');\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.file('/Folder'), 0)] }, new NullLogService());\n\t\tassert.strictEqual(ws.getPath()!.replace(/\\\\/g, '/'), '/Folder');\n\t});\n\n\ttest('WorkspaceFolder has name and index', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', folders: [aWorkspaceFolderData(URI.file('/Coding/One'), 0), aWorkspaceFolderData(URI.file('/Coding/Two'), 1)], name: 'Test' }, new NullLogService());\n\n\t\tconst [one, two] = ws.getWorkspaceFolders()!;\n\n\t\tassert.strictEqual(one.name, 'One');\n\t\tassert.strictEqual(one.index, 0);\n\t\tassert.strictEqual(two.name, 'Two');\n\t\tassert.strictEqual(two.index, 1);\n\t});\n\n\ttest('getContainingWorkspaceFolder', () => {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), {\n\t\t\tid: 'foo',\n\t\t\tname: 'Test',\n\t\t\tfolders: [\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/One'), 0),\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/Two'), 1),\n\t\t\t\taWorkspaceFolderData(URI.file('/Coding/Two/Nested'), 2)\n\t\t\t]\n\t\t}, new NullLogService());\n\n\t\tlet folder = ws.getWorkspaceFolder(URI.file('/foo/bar'));\n\t\tassert.strictEqual(folder, undefined);\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/One/file/path.txt'))!;\n\t\tassert.strictEqual(folder.name, 'One');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/file/path.txt'))!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nest'))!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/file'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/f'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested'), true)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/'), true)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two/Nested/'))!;\n\t\tassert.strictEqual(folder.name, 'Nested');\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two'), true)!;\n\t\tassert.strictEqual(folder, undefined);\n\n\t\tfolder = ws.getWorkspaceFolder(URI.file('/Coding/Two'), false)!;\n\t\tassert.strictEqual(folder.name, 'Two');\n\t});\n\n\ttest('Multiroot change event should have a delta, #29641', function (done) {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tlet sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar2');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar2'), 1)] });\n\t\tsub.dispose();\n\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.removed.length, 2);\n\t\t\t\tassert.strictEqual(e.removed[0].uri.toString(), 'foo:bar');\n\t\t\t\tassert.strictEqual(e.removed[1].uri.toString(), 'foo:bar2');\n\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar3');\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0)] });\n\t\tsub.dispose();\n\t\tfinish();\n\t});\n\n\ttest('Multiroot change keeps existing workspaces live', function () {\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }, new NullLogService());\n\n\t\tconst firstFolder = ws.getWorkspaceFolders()![0];\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar2'), 0), aWorkspaceFolderData(URI.parse('foo:bar'), 1, 'renamed')] });\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], firstFolder);\n\t\tassert.strictEqual(firstFolder.index, 1);\n\t\tassert.strictEqual(firstFolder.name, 'renamed');\n\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar2'), 1), aWorkspaceFolderData(URI.parse('foo:bar'), 2)] });\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], firstFolder);\n\t\tassert.strictEqual(firstFolder.index, 2);\n\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0)] });\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar'), 1)] });\n\n\t\tassert.notStrictEqual(firstFolder, ws.workspace!.folders[0]);\n\t});\n\n\ttest('updateWorkspaceFolders - invalid arguments', function () {\n\t\tlet ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, null!, null!));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 1));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 1, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, -1, 0));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, -1, -1));\n\n\t\tws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }, new NullLogService());\n\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 1, 1));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2));\n\t\tassert.strictEqual(false, ws.updateWorkspaceFolders(extensionDescriptor, 0, 1, asUpdateWorkspaceFolderData(URI.parse('foo:bar'))));\n\t});\n\n\ttest('updateWorkspaceFolders - valid arguments', function (done) {\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tconst protocol: IMainContext = {\n\t\t\tgetProxy: () => { return undefined!; },\n\t\t\tset: () => { return undefined!; },\n\t\t\tdispose: () => { },\n\t\t\tassertRegistered: () => { },\n\t\t\tdrain: () => { return undefined!; },\n\t\t};\n\n\t\tconst ws = createExtHostWorkspace(protocol, { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\n\t\t//\n\t\t// Add one folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar'))));\n\t\tassert.strictEqual(1, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\n\t\tconst firstAddedFolder = ws.getWorkspaceFolders()![0];\n\n\t\tlet gotEvent = false;\n\t\tlet sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar');\n\t\t\t\tassert.strictEqual(e.added[0], firstAddedFolder); // verify object is still live\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Add two more folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 1, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar1')), asUpdateWorkspaceFolderData(URI.parse('foo:bar2'))));\n\t\tassert.strictEqual(3, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[2].uri.toString(), URI.parse('foo:bar2').toString());\n\n\t\tconst secondAddedFolder = ws.getWorkspaceFolders()![1];\n\t\tconst thirdAddedFolder = ws.getWorkspaceFolders()![2];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.removed, []);\n\t\t\t\tassert.strictEqual(e.added.length, 2);\n\t\t\t\tassert.strictEqual(e.added[0].uri.toString(), 'foo:bar1');\n\t\t\t\tassert.strictEqual(e.added[1].uri.toString(), 'foo:bar2');\n\t\t\t\tassert.strictEqual(e.added[0], secondAddedFolder);\n\t\t\t\tassert.strictEqual(e.added[1], thirdAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar1'), 1), aWorkspaceFolderData(URI.parse('foo:bar2'), 2)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], thirdAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Remove one folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 2, 1));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.strictEqual(e.removed.length, 1);\n\t\t\t\tassert.strictEqual(e.removed[0], thirdAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0), aWorkspaceFolderData(URI.parse('foo:bar1'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Rename folder\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar'), 'renamed 1'), asUpdateWorkspaceFolderData(URI.parse('foo:bar1'), 'renamed 2')));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar1').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.workspace!.folders[1].name, 'renamed 2');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1].name, 'renamed 2');\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.deepStrictEqual(e.added, []);\n\t\t\t\tassert.strictEqual(e.removed.length, 0);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar'), 0, 'renamed 1'), aWorkspaceFolderData(URI.parse('foo:bar1'), 1, 'renamed 2')] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], firstAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], secondAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.workspace!.folders[0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.workspace!.folders[1].name, 'renamed 2');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0].name, 'renamed 1');\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1].name, 'renamed 2');\n\n\t\t//\n\t\t// Add and remove folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar3')), asUpdateWorkspaceFolderData(URI.parse('foo:bar4'))));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar3').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar4').toString());\n\n\t\tconst fourthAddedFolder = ws.getWorkspaceFolders()![0];\n\t\tconst fifthAddedFolder = ws.getWorkspaceFolders()![1];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 2);\n\t\t\t\tassert.strictEqual(e.added[0], fourthAddedFolder);\n\t\t\t\tassert.strictEqual(e.added[1], fifthAddedFolder);\n\t\t\t\tassert.strictEqual(e.removed.length, 2);\n\t\t\t\tassert.strictEqual(e.removed[0], firstAddedFolder);\n\t\t\t\tassert.strictEqual(e.removed[1], secondAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar3'), 0), aWorkspaceFolderData(URI.parse('foo:bar4'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fifthAddedFolder); // verify object is still live\n\n\t\t//\n\t\t// Swap folders\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 0, 2, asUpdateWorkspaceFolderData(URI.parse('foo:bar4')), asUpdateWorkspaceFolderData(URI.parse('foo:bar3'))));\n\t\tassert.strictEqual(2, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar4').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar3').toString());\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 0);\n\t\t\t\tassert.strictEqual(e.removed.length, 0);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [aWorkspaceFolderData(URI.parse('foo:bar4'), 0), aWorkspaceFolderData(URI.parse('foo:bar3'), 1)] }); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(fifthAddedFolder.index, 0);\n\t\tassert.strictEqual(fourthAddedFolder.index, 1);\n\n\t\t//\n\t\t// Add one folder after the other without waiting for confirmation (not supported currently)\n\t\t//\n\n\t\tassert.strictEqual(true, ws.updateWorkspaceFolders(extensionDescriptor, 2, 0, asUpdateWorkspaceFolderData(URI.parse('foo:bar5'))));\n\n\t\tassert.strictEqual(3, ws.workspace!.folders.length);\n\t\tassert.strictEqual(ws.workspace!.folders[0].uri.toString(), URI.parse('foo:bar4').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[1].uri.toString(), URI.parse('foo:bar3').toString());\n\t\tassert.strictEqual(ws.workspace!.folders[2].uri.toString(), URI.parse('foo:bar5').toString());\n\n\t\tconst sixthAddedFolder = ws.getWorkspaceFolders()![2];\n\n\t\tgotEvent = false;\n\t\tsub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.strictEqual(e.added.length, 1);\n\t\t\t\tassert.strictEqual(e.added[0], sixthAddedFolder);\n\t\t\t\tgotEvent = true;\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({\n\t\t\tid: 'foo', name: 'Test', folders: [\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar4'), 0),\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar3'), 1),\n\t\t\t\taWorkspaceFolderData(URI.parse('foo:bar5'), 2)\n\t\t\t]\n\t\t}); // simulate acknowledgement from main side\n\t\tassert.strictEqual(gotEvent, true);\n\t\tsub.dispose();\n\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![0], fifthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![1], fourthAddedFolder); // verify object is still live\n\t\tassert.strictEqual(ws.getWorkspaceFolders()![2], sixthAddedFolder); // verify object is still live\n\n\t\tfinish();\n\t});\n\n\ttest('Multiroot change event is immutable', function (done) {\n\t\tlet finished = false;\n\t\tconst finish = (error?: any) => {\n\t\t\tif (!finished) {\n\t\t\t\tfinished = true;\n\t\t\t\tdone(error);\n\t\t\t}\n\t\t};\n\n\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), { id: 'foo', name: 'Test', folders: [] }, new NullLogService());\n\t\tconst sub = ws.onDidChangeWorkspace(e => {\n\t\t\ttry {\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t(<any>e).added = [];\n\t\t\t\t});\n\t\t\t\t// assert.throws(() => {\n\t\t\t\t// \t(<any>e.added)[0] = null;\n\t\t\t\t// });\n\t\t\t} catch (error) {\n\t\t\t\tfinish(error);\n\t\t\t}\n\t\t});\n\t\tws.$acceptWorkspaceData({ id: 'foo', name: 'Test', folders: [] });\n\t\tsub.dispose();\n\t\tfinish();\n\t});\n\n\ttest('`vscode.workspace.getWorkspaceFolder(file)` don\\'t return workspace folder when file open from command line. #36221', function () {\n\t\tif (isWindows) {\n\n\t\t\tconst ws = createExtHostWorkspace(new TestRPCProtocol(), {\n\t\t\t\tid: 'foo', name: 'Test', folders: [\n\t\t\t\t\taWorkspaceFolderData(URI.file('c:/Users/marek/Desktop/vsc_test/'), 0)\n\t\t\t\t]\n\t\t\t}, new NullLogService());\n\n\t\t\tassert.ok(ws.getWorkspaceFolder(URI.file('c:/Users/marek/Desktop/vsc_test/a.txt')));\n\t\t\tassert.ok(ws.getWorkspaceFolder(URI.file('C:/Users/marek/Desktop/vsc_test/b.txt')));\n\t\t}\n\t});\n\n\tfunction aWorkspaceFolderData(uri: URI, index: number, name: string = ''): IWorkspaceFolderData {\n\t\treturn {\n\t\t\turi,\n\t\t\tindex,\n\t\t\tname: name || basename(uri.path)\n\t\t};\n\t}\n\n\tfunction asUpdateWorkspaceFolderData(uri: URI, name?: string): { uri: URI; name?: string } {\n\t\treturn { uri, name };\n\t}\n\n\tsuite('findFiles -', function () {\n\t\ttest('string include', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'foo');\n\t\t\t\t\tassert.strictEqual(_includeFolder, null);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.maxResults, 10);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles('foo', undefined, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\tfunction testFindFilesInclude(pattern: RelativePattern) {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.deepStrictEqual(_includeFolder ? URI.from(_includeFolder).toJSON() : null, URI.file('/other/folder').toJSON());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles(pattern, undefined, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t}\n\n\t\ttest('RelativePattern include (string)', () => {\n\t\t\treturn testFindFilesInclude(new RelativePattern('/other/folder', 'glob/**'));\n\t\t});\n\n\t\ttest('RelativePattern include (URI)', () => {\n\t\t\treturn testFindFilesInclude(new RelativePattern(URI.file('/other/folder'), 'glob/**'));\n\t\t});\n\n\t\ttest('no excludes', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(_includeFolder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, true);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles(new RelativePattern('/other/folder', 'glob/**'), null, 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('with cancelled token', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\treturn ws.findFiles(new RelativePattern('/other/folder', 'glob/**'), null, 10, new ExtensionIdentifier('test'), token).then(() => {\n\t\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('RelativePattern exclude', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // Note that the base portion is ignored, see #52651\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles('', new RelativePattern(root, 'glob/**'), 10, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\t});\n\n\tsuite('findFiles2 -', function () {\n\t\ttest('string include', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'foo');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(_includeFolder, null);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.maxResults, 10);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2(['foo'], { maxResults: 10, useExcludeSettings: ExcludeSettingOptions.FilesExclude }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\tfunction testFindFiles2Include(pattern: RelativePattern[]) {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.deepStrictEqual(_includeFolder ? URI.from(_includeFolder).toJSON() : null, URI.file('/other/folder').toJSON());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2(pattern, { maxResults: 10 }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t}\n\n\t\ttest('RelativePattern include (string)', () => {\n\t\t\treturn testFindFiles2Include([new RelativePattern('/other/folder', 'glob/**')]);\n\t\t});\n\n\t\ttest('RelativePattern include (URI)', () => {\n\t\t\treturn testFindFiles2Include([new RelativePattern(URI.file('/other/folder'), 'glob/**')]);\n\t\t});\n\n\t\ttest('no excludes', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.filePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(_includeFolder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([new RelativePattern('/other/folder', 'glob/**')], {}, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('no dups', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\treturn Promise.resolve([URI.file(root + '/main.py')]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Only add the root directory as a workspace folder - main.py will be a file within it\n\t\t\tconst folders = [aWorkspaceFolderData(URI.file(root), 0)];\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: folders, name: 'Test' }, new NullLogService());\n\n\t\t\treturn ws.findFiles2(['**/main.py', '**/main.py/**'], {}, new ExtensionIdentifier('test')).then((uris) => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t\tassert.equal(uris.length, 1);\n\t\t\t\tassert.equal(uris[0].toString(), URI.file(root + '/main.py').toString());\n\t\t\t});\n\t\t});\n\n\t\ttest('with cancelled token', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\treturn ws.findFiles2([new RelativePattern('/other/folder', 'glob/**')], {}, new ExtensionIdentifier('test'), token).then(() => {\n\t\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('RelativePattern exclude', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // Note that the base portion is ignored, see #52651\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { exclude: [new RelativePattern(root, 'glob/**')] }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\t\ttest('useIgnoreFiles', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.disregardExcludeSettings, false);\n\t\t\t\t\tassert.strictEqual(options.disregardIgnoreFiles, false);\n\t\t\t\t\tassert.strictEqual(options.disregardGlobalIgnoreFiles, false);\n\t\t\t\t\tassert.strictEqual(options.disregardParentIgnoreFiles, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { useIgnoreFiles: { local: true, parent: true, global: true } }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\ttest('use symlinks', () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride $startFileSearch(_includeFolder: UriComponents | null, options: IFileQueryBuilderOptions, token: CancellationToken): Promise<URI[] | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(options.ignoreSymlinks, false);\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\treturn ws.findFiles2([''], { followSymlinks: true }, new ExtensionIdentifier('test')).then(() => {\n\t\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t\t});\n\t\t});\n\n\t\t// todo: add tests with multiple filePatterns and excludes\n\n\t});\n\n\tsuite('findTextInFiles -', function () {\n\t\ttest('no include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, {}, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('string include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, '**/files');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { include: '**/files' }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(folder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { include: new RelativePattern('/other/folder', 'glob/**') }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('with cancelled token', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, {}, () => { }, new ExtensionIdentifier('test'), token);\n\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern exclude', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // exclude folder is ignored...\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait ws.findTextInFiles({ pattern: 'foo' }, { exclude: new RelativePattern('/other/folder', 'glob/**') }, () => { }, new ExtensionIdentifier('test'));\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\t});\n\n\tsuite('findTextInFiles2 -', function () {\n\t\ttest('no include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, {}, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('string include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.strictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, '**/files');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { include: ['**/files'] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern include', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(URI.revive(folder!).toString(), URI.file('/other/folder').toString());\n\t\t\t\t\tassert.strictEqual(options.includePattern, 'glob/**');\n\t\t\t\t\tassert.strictEqual(options.excludePattern, undefined);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { include: [new RelativePattern('/other/folder', 'glob/**')] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\ttest('with cancelled token', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tconst token = CancellationToken.Cancelled;\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, undefined, new ExtensionIdentifier('test'), token)).complete;\n\t\t\tassert(!mainThreadCalled, '!mainThreadCalled');\n\t\t});\n\n\t\ttest('RelativePattern exclude', async () => {\n\t\t\tconst root = '/project/foo';\n\t\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\t\tlet mainThreadCalled = false;\n\t\t\trpcProtocol.set(MainContext.MainThreadWorkspace, new class extends mock<MainThreadWorkspace>() {\n\t\t\t\toverride async $startTextSearch(query: IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null> {\n\t\t\t\t\tmainThreadCalled = true;\n\t\t\t\t\tassert.strictEqual(query.pattern, 'foo');\n\t\t\t\t\tassert.deepStrictEqual(folder, null);\n\t\t\t\t\tassert.strictEqual(options.includePattern, undefined);\n\t\t\t\t\tassert.strictEqual(options.excludePattern?.length, 1);\n\t\t\t\t\tassert.strictEqual(options.excludePattern[0].pattern, 'glob/**'); // exclude folder is ignored...\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst ws = createExtHostWorkspace(rpcProtocol, { id: 'foo', folders: [aWorkspaceFolderData(URI.file(root), 0)], name: 'Test' }, new NullLogService());\n\t\t\tawait (ws.findTextInFiles2({ pattern: 'foo' }, { exclude: [new RelativePattern('/other/folder', 'glob/**')] }, new ExtensionIdentifier('test'))).complete;\n\t\t\tassert(mainThreadCalled, 'mainThreadCalled');\n\t\t});\n\n\t\t// TODO: test multiple includes/excludess\n\t});\n});\n"]}