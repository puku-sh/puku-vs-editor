{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/extHostTreeViews.test.ts","vs/workbench/api/test/browser/extHostTreeViews.test.ts"],"names":[],"mappings":"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","file":"extHostTreeViews.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ExtHostTreeViews } from '../../common/extHostTreeViews.js';\nimport { ExtHostCommands } from '../../common/extHostCommands.js';\nimport { MainThreadTreeViewsShape, MainContext, MainThreadCommandsShape } from '../../common/extHost.protocol.js';\nimport { TreeDataProvider, TreeItem } from 'vscode';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { TreeItemCollapsibleState, ITreeItem, IRevealOptions } from '../../../common/views.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport type { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { nullExtensionDescription as extensionsDescription } from '../../../services/extensions/common/extensions.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\nimport { IExtHostTelemetry } from '../../common/extHostTelemetry.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nfunction unBatchChildren(result: (number | ITreeItem)[][] | undefined): ITreeItem[] | undefined {\n\tif (!result || result.length === 0) {\n\t\treturn undefined;\n\t}\n\tif (result.length > 1) {\n\t\tthrow new Error('Unexpected result length, all tests are unbatched.');\n\t}\n\treturn result[0].slice(1) as ITreeItem[];\n}\n\nsuite('ExtHostTreeView', function () {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tclass RecordingShape extends mock<MainThreadTreeViewsShape>() {\n\n\t\tonRefresh = new Emitter<{ [treeItemHandle: string]: ITreeItem }>();\n\n\t\toverride async $registerTreeViewDataProvider(treeViewId: string): Promise<void> {\n\t\t}\n\n\t\toverride $refresh(viewId: string, itemsToRefresh: { [treeItemHandle: string]: ITreeItem }): Promise<void> {\n\t\t\treturn Promise.resolve(null).then(() => {\n\t\t\t\tthis.onRefresh.fire(itemsToRefresh);\n\t\t\t});\n\t\t}\n\n\t\toverride $reveal(treeViewId: string, itemInfo: { item: ITreeItem; parentChain: ITreeItem[] } | undefined, options: IRevealOptions): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\toverride $disposeTree(treeViewId: string): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t}\n\n\tlet testObject: ExtHostTreeViews;\n\tlet target: RecordingShape;\n\tlet onDidChangeTreeNode: Emitter<{ key: string } | undefined>;\n\tlet onDidChangeTreeNodeWithId: Emitter<{ key: string }>;\n\tlet tree: { [key: string]: any };\n\tlet labels: { [key: string]: string };\n\tlet nodes: { [key: string]: { key: string } };\n\n\tsetup(() => {\n\t\ttree = {\n\t\t\t'a': {\n\t\t\t\t'aa': {},\n\t\t\t\t'ab': {}\n\t\t\t},\n\t\t\t'b': {\n\t\t\t\t'ba': {},\n\t\t\t\t'bb': {}\n\t\t\t}\n\t\t};\n\n\t\tlabels = {};\n\t\tnodes = {};\n\n\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\trpcProtocol.set(MainContext.MainThreadCommands, new class extends mock<MainThreadCommandsShape>() {\n\t\t\toverride $registerCommand() { }\n\t\t});\n\t\ttarget = new RecordingShape();\n\t\ttestObject = store.add(new ExtHostTreeViews(target, new ExtHostCommands(\n\t\t\trpcProtocol,\n\t\t\tnew NullLogService(),\n\t\t\tnew class extends mock<IExtHostTelemetry>() {\n\t\t\t\toverride onExtensionError(): boolean {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t), new NullLogService()));\n\t\tonDidChangeTreeNode = new Emitter<{ key: string } | undefined>();\n\t\tonDidChangeTreeNodeWithId = new Emitter<{ key: string }>();\n\t\ttestObject.createTreeView('testNodeTreeProvider', { treeDataProvider: aNodeTreeDataProvider() }, extensionsDescription);\n\t\ttestObject.createTreeView('testNodeWithIdTreeProvider', { treeDataProvider: aNodeWithIdTreeDataProvider() }, extensionsDescription);\n\t\ttestObject.createTreeView('testNodeWithHighlightsTreeProvider', { treeDataProvider: aNodeWithHighlightedLabelTreeDataProvider() }, extensionsDescription);\n\n\t\treturn loadCompleteTree('testNodeTreeProvider');\n\t});\n\n\ttest('construct node tree', () => {\n\t\treturn testObject.$getChildren('testNodeTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a', '0/0:b']);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a/0:aa', '0/0:a/0:ab']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a/0:aa']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a/0:ab']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:b/0:ba', '0/0:b/0:bb']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b/0:ba']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b/0:bb']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('construct id tree', () => {\n\t\treturn testObject.$getChildren('testNodeWithIdTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\tassert.deepStrictEqual(actuals, ['1/a', '1/b']);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/aa', '1/ab']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/aa']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/ab']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/ba', '1/bb']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/ba']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/bb']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('construct highlights tree', () => {\n\t\treturn testObject.$getChildren('testNodeWithHighlightsTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(elements)), [{\n\t\t\t\t\thandle: '1/a',\n\t\t\t\t\tlabel: { label: 'a', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t}, {\n\t\t\t\t\thandle: '1/b',\n\t\t\t\t\tlabel: { label: 'b', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t}]);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeWithHighlightsTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(children)), [{\n\t\t\t\t\t\t\t\thandle: '1/aa',\n\t\t\t\t\t\t\t\tparentHandle: '1/a',\n\t\t\t\t\t\t\t\tlabel: { label: 'aa', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\thandle: '1/ab',\n\t\t\t\t\t\t\t\tparentHandle: '1/a',\n\t\t\t\t\t\t\t\tlabel: { label: 'ab', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeWithHighlightsTreeProvider', ['1/b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(children)), [{\n\t\t\t\t\t\t\t\thandle: '1/ba',\n\t\t\t\t\t\t\t\tparentHandle: '1/b',\n\t\t\t\t\t\t\t\tlabel: { label: 'ba', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\thandle: '1/bb',\n\t\t\t\t\t\t\t\tparentHandle: '1/b',\n\t\t\t\t\t\t\t\tlabel: { label: 'bb', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('error is thrown if id is not unique', (done) => {\n\t\ttree['a'] = {\n\t\t\t'aa': {},\n\t\t};\n\t\ttree['b'] = {\n\t\t\t'aa': {},\n\t\t\t'ba': {}\n\t\t};\n\t\tlet caughtExpectedError = false;\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/a', '1/b']);\n\t\t\t\t\treturn testObject.$getChildren('testNodeWithIdTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(() => testObject.$getChildren('testNodeWithIdTreeProvider', ['1/b']))\n\t\t\t\t\t\t.then(() => assert.fail('Should fail with duplicate id'))\n\t\t\t\t\t\t.catch(() => caughtExpectedError = true)\n\t\t\t\t\t\t.finally(() => caughtExpectedError ? done() : assert.fail('Expected duplicate id error not thrown.'));\n\t\t\t\t});\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('refresh root', function (done) {\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('refresh a parent node', () => {\n\t\treturn new Promise((c, e) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:b'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tc(undefined);\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t});\n\t});\n\n\ttest('refresh a leaf node', function (done) {\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.deepStrictEqual(['0/0:b/0:bb'], Object.keys(actuals));\n\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b/0:bb']), {\n\t\t\t\thandle: '0/0:b/0:bb',\n\t\t\t\tparentHandle: '0/0:b',\n\t\t\t\tlabel: { label: 'bb' },\n\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t});\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t});\n\n\tasync function runWithEventMerging(action: (resolve: () => void) => void) {\n\t\tawait runWithFakedTimers({}, async () => {\n\t\t\tawait new Promise<void>((resolve) => {\n\t\t\t\tlet subscription: IDisposable | undefined = undefined;\n\t\t\t\tsubscription = target.onRefresh.event(() => {\n\t\t\t\t\tsubscription!.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\t});\n\t\t\tawait new Promise<void>(action);\n\t\t});\n\t}\n\n\ttest('refresh parent and child node trigger refresh only on parent - scenario 1', async () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:b', '0/0:a/0:aa'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a/0:aa']), {\n\t\t\t\t\thandle: '0/0:a/0:aa',\n\t\t\t\t\tparentHandle: '0/0:a',\n\t\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('aa'));\n\t\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t\t});\n\t});\n\n\ttest('refresh parent and child node trigger refresh only on parent - scenario 2', async () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a/0:aa', '0/0:b'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a/0:aa']), {\n\t\t\t\t\thandle: '0/0:a/0:aa',\n\t\t\t\t\tparentHandle: '0/0:a',\n\t\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t\t\tonDidChangeTreeNode.fire(getNode('aa'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t});\n\t});\n\n\ttest('refresh an element for label change', function (done) {\n\t\tlabels['a'] = 'aa';\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.deepStrictEqual(['0/0:a'], Object.keys(actuals));\n\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a']), {\n\t\t\t\thandle: '0/0:aa',\n\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t});\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t});\n\n\ttest('refresh calls are throttled on roots', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on elements', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a', '0/0:b'], Object.keys(actuals));\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on unknown elements', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a', '0/0:b'], Object.keys(actuals));\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('g'));\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on unknown elements and root', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('g'));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on elements and root', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('generate unique handles from labels by escaping them', (done) => {\n\t\ttree = {\n\t\t\t'a/0:b': {}\n\t\t};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:a//0:b']);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('tree with duplicate labels', (done) => {\n\n\t\tconst dupItems = {\n\t\t\t'adup1': 'c',\n\t\t\t'adup2': 'g',\n\t\t\t'bdup1': 'e',\n\t\t\t'hdup1': 'i',\n\t\t\t'hdup2': 'l',\n\t\t\t'jdup1': 'k'\n\t\t};\n\n\t\tlabels['c'] = 'a';\n\t\tlabels['e'] = 'b';\n\t\tlabels['g'] = 'a';\n\t\tlabels['i'] = 'h';\n\t\tlabels['l'] = 'h';\n\t\tlabels['k'] = 'j';\n\n\t\ttree[dupItems['adup1']] = {};\n\t\ttree['d'] = {};\n\n\t\tconst bdup1Tree: { [key: string]: any } = {};\n\t\tbdup1Tree['h'] = {};\n\t\tbdup1Tree[dupItems['hdup1']] = {};\n\t\tbdup1Tree['j'] = {};\n\t\tbdup1Tree[dupItems['jdup1']] = {};\n\t\tbdup1Tree[dupItems['hdup2']] = {};\n\n\t\ttree[dupItems['bdup1']] = bdup1Tree;\n\t\ttree['f'] = {};\n\t\ttree[dupItems['adup2']] = {};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a', '0/0:b', '0/1:a', '0/0:d', '0/1:b', '0/0:f', '0/2:a']);\n\t\t\t\t\treturn testObject.$getChildren('testNodeTreeProvider', ['0/1:b'])\n\t\t\t\t\t\t.then(elements => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/1:b/0:h', '0/1:b/1:h', '0/1:b/0:j', '0/1:b/1:j', '0/1:b/2:h']);\n\t\t\t\t\t\t\tdone();\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t}));\n\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('getChildren is not returned from cache if refreshed', (done) => {\n\t\ttree = {\n\t\t\t'c': {}\n\t\t};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:c']);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t}));\n\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('getChildren is returned from cache if not refreshed', () => {\n\t\ttree = {\n\t\t\t'c': {}\n\t\t};\n\n\t\treturn testObject.$getChildren('testNodeTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:a', '0/0:b']);\n\t\t\t});\n\t});\n\n\ttest('reveal will throw an error if getParent is not implemented', () => {\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aNodeTreeDataProvider() }, extensionsDescription);\n\t\treturn treeView.reveal({ key: 'a' })\n\t\t\t.then(() => assert.fail('Reveal should throw an error as getParent is not implemented'), () => null);\n\t});\n\n\ttest('reveal will return empty array for root element', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem:\n\t\t\t\t{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed },\n\t\t\tparentChain: []\n\t\t};\n\t\treturn treeView.reveal({ key: 'a' })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected, removeUnsetKeys(revealTarget.args[0][1]));\n\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal will return parents array for an element when hierarchy is not loaded', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:aa', label: { label: 'aa' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn treeView.reveal({ key: 'aa' })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal will return parents array for an element when hierarchy is loaded', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:aa', label: { label: 'aa' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn testObject.$getChildren('treeDataProvider')\n\t\t\t.then(() => testObject.$getChildren('treeDataProvider', ['0/0:a']))\n\t\t\t.then(() => treeView.reveal({ key: 'aa' })\n\t\t\t\t.then(() => {\n\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t}));\n\t});\n\n\ttest('reveal will return parents array for deeper element with no selection', () => {\n\t\ttree = {\n\t\t\t'b': {\n\t\t\t\t'ba': {\n\t\t\t\t\t'bac': {}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:b/0:ba/0:bac', label: { label: 'bac' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:b/0:ba' },\n\t\t\tparentChain: [\n\t\t\t\t{ handle: '0/0:b', label: { label: 'b' }, collapsibleState: TreeItemCollapsibleState.Collapsed },\n\t\t\t\t{ handle: '0/0:b/0:ba', label: { label: 'ba' }, collapsibleState: TreeItemCollapsibleState.Collapsed, parentHandle: '0/0:b' }\n\t\t\t]\n\t\t};\n\t\treturn treeView.reveal({ key: 'bac' }, { select: false, focus: false, expand: false })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\tassert.deepStrictEqual({ select: false, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal after first udpate', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:ac', label: { label: 'ac' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn loadCompleteTree('treeDataProvider')\n\t\t\t.then(() => {\n\t\t\t\ttree = {\n\t\t\t\t\t'a': {\n\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t},\n\t\t\t\t\t'b': {\n\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t'bb': {}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\n\t\t\t\treturn treeView.reveal({ key: 'ac' })\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t\t});\n\t\t\t});\n\t});\n\n\ttest('reveal after second udpate', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\treturn loadCompleteTree('treeDataProvider')\n\t\t\t.then(() => {\n\t\t\t\treturn runWithEventMerging((resolve) => {\n\t\t\t\t\ttree = {\n\t\t\t\t\t\t'a': {\n\t\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'b': {\n\t\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t\t'bb': {}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\t\t\ttree = {\n\t\t\t\t\t\t'a': {\n\t\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'b': {\n\t\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t\t'bc': {}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\t\t\tresolve();\n\t\t\t\t}).then(() => {\n\t\t\t\t\treturn treeView.reveal({ key: 'bc' })\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\t\t\tassert.deepStrictEqual({ handle: '0/0:b/0:bc', label: { label: 'bc' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:b' }, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\t\t\tassert.deepStrictEqual([{ handle: '0/0:b', label: { label: 'b' }, collapsibleState: TreeItemCollapsibleState.Collapsed }], (<Array<any>>revealTarget.args[0][1]!.parentChain).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t});\n\n\tfunction loadCompleteTree(treeId: string, element?: string): Promise<null> {\n\t\treturn testObject.$getChildren(treeId, element ? [element] : undefined)\n\t\t\t.then(elements => {\n\t\t\t\tif (!elements || elements?.length === 0) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn elements[0].slice(1).map(e => loadCompleteTree(treeId, (e as ITreeItem).handle));\n\t\t\t})\n\t\t\t.then(() => null);\n\t}\n\n\tfunction removeUnsetKeys(obj: any): any {\n\t\tif (Array.isArray(obj)) {\n\t\t\treturn obj.map(o => removeUnsetKeys(o));\n\t\t}\n\n\t\tif (typeof obj === 'object') {\n\t\t\tconst result: { [key: string]: any } = {};\n\t\t\tfor (const key of Object.keys(obj)) {\n\t\t\t\tif (obj[key] !== undefined) {\n\t\t\t\t\tresult[key] = removeUnsetKeys(obj[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn obj;\n\t}\n\n\tfunction aNodeTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\treturn getTreeItem(element.key);\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNode.event\n\t\t};\n\t}\n\n\tfunction aCompleteNodeTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\treturn getTreeItem(element.key);\n\t\t\t},\n\t\t\tgetParent: ({ key }: { key: string }): { key: string } | undefined => {\n\t\t\t\tconst parentKey = key.substring(0, key.length - 1);\n\t\t\t\treturn parentKey ? new Key(parentKey) : undefined;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNode.event\n\t\t};\n\t}\n\n\tfunction aNodeWithIdTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\tconst treeItem = getTreeItem(element.key);\n\t\t\t\ttreeItem.id = element.key;\n\t\t\t\treturn treeItem;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNodeWithId.event\n\t\t};\n\t}\n\n\tfunction aNodeWithHighlightedLabelTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\tconst treeItem = getTreeItem(element.key, [[0, 2], [3, 5]]);\n\t\t\t\ttreeItem.id = element.key;\n\t\t\t\treturn treeItem;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNodeWithId.event\n\t\t};\n\t}\n\n\tfunction getTreeElement(element: string): any {\n\t\tlet parent = tree;\n\t\tfor (let i = 0; i < element.length; i++) {\n\t\t\tparent = parent[element.substring(0, i + 1)];\n\t\t\tif (!parent) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn parent;\n\t}\n\n\tfunction getChildren(key: string | undefined): string[] {\n\t\tif (!key) {\n\t\t\treturn Object.keys(tree);\n\t\t}\n\t\tconst treeElement = getTreeElement(key);\n\t\tif (treeElement) {\n\t\t\treturn Object.keys(treeElement);\n\t\t}\n\t\treturn [];\n\t}\n\n\tfunction getTreeItem(key: string, highlights?: [number, number][]): TreeItem {\n\t\tconst treeElement = getTreeElement(key);\n\t\treturn {\n\t\t\tlabel: { label: labels[key] || key, highlights },\n\t\t\tcollapsibleState: treeElement && Object.keys(treeElement).length ? TreeItemCollapsibleState.Collapsed : TreeItemCollapsibleState.None\n\t\t};\n\t}\n\n\tfunction getNode(key: string): { key: string } {\n\t\tif (!nodes[key]) {\n\t\t\tnodes[key] = new Key(key);\n\t\t}\n\t\treturn nodes[key];\n\t}\n\n\tclass Key {\n\t\tconstructor(readonly key: string) { }\n\t}\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ExtHostTreeViews } from '../../common/extHostTreeViews.js';\nimport { ExtHostCommands } from '../../common/extHostCommands.js';\nimport { MainThreadTreeViewsShape, MainContext, MainThreadCommandsShape } from '../../common/extHost.protocol.js';\nimport { TreeDataProvider, TreeItem } from 'vscode';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { TreeItemCollapsibleState, ITreeItem, IRevealOptions } from '../../../common/views.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport type { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { nullExtensionDescription as extensionsDescription } from '../../../services/extensions/common/extensions.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\nimport { IExtHostTelemetry } from '../../common/extHostTelemetry.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nfunction unBatchChildren(result: (number | ITreeItem)[][] | undefined): ITreeItem[] | undefined {\n\tif (!result || result.length === 0) {\n\t\treturn undefined;\n\t}\n\tif (result.length > 1) {\n\t\tthrow new Error('Unexpected result length, all tests are unbatched.');\n\t}\n\treturn result[0].slice(1) as ITreeItem[];\n}\n\nsuite('ExtHostTreeView', function () {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tclass RecordingShape extends mock<MainThreadTreeViewsShape>() {\n\n\t\tonRefresh = new Emitter<{ [treeItemHandle: string]: ITreeItem }>();\n\n\t\toverride async $registerTreeViewDataProvider(treeViewId: string): Promise<void> {\n\t\t}\n\n\t\toverride $refresh(viewId: string, itemsToRefresh: { [treeItemHandle: string]: ITreeItem }): Promise<void> {\n\t\t\treturn Promise.resolve(null).then(() => {\n\t\t\t\tthis.onRefresh.fire(itemsToRefresh);\n\t\t\t});\n\t\t}\n\n\t\toverride $reveal(treeViewId: string, itemInfo: { item: ITreeItem; parentChain: ITreeItem[] } | undefined, options: IRevealOptions): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\toverride $disposeTree(treeViewId: string): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t}\n\n\tlet testObject: ExtHostTreeViews;\n\tlet target: RecordingShape;\n\tlet onDidChangeTreeNode: Emitter<{ key: string } | undefined>;\n\tlet onDidChangeTreeNodeWithId: Emitter<{ key: string }>;\n\tlet tree: { [key: string]: any };\n\tlet labels: { [key: string]: string };\n\tlet nodes: { [key: string]: { key: string } };\n\n\tsetup(() => {\n\t\ttree = {\n\t\t\t'a': {\n\t\t\t\t'aa': {},\n\t\t\t\t'ab': {}\n\t\t\t},\n\t\t\t'b': {\n\t\t\t\t'ba': {},\n\t\t\t\t'bb': {}\n\t\t\t}\n\t\t};\n\n\t\tlabels = {};\n\t\tnodes = {};\n\n\t\tconst rpcProtocol = new TestRPCProtocol();\n\n\t\trpcProtocol.set(MainContext.MainThreadCommands, new class extends mock<MainThreadCommandsShape>() {\n\t\t\toverride $registerCommand() { }\n\t\t});\n\t\ttarget = new RecordingShape();\n\t\ttestObject = store.add(new ExtHostTreeViews(target, new ExtHostCommands(\n\t\t\trpcProtocol,\n\t\t\tnew NullLogService(),\n\t\t\tnew class extends mock<IExtHostTelemetry>() {\n\t\t\t\toverride onExtensionError(): boolean {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t), new NullLogService()));\n\t\tonDidChangeTreeNode = new Emitter<{ key: string } | undefined>();\n\t\tonDidChangeTreeNodeWithId = new Emitter<{ key: string }>();\n\t\ttestObject.createTreeView('testNodeTreeProvider', { treeDataProvider: aNodeTreeDataProvider() }, extensionsDescription);\n\t\ttestObject.createTreeView('testNodeWithIdTreeProvider', { treeDataProvider: aNodeWithIdTreeDataProvider() }, extensionsDescription);\n\t\ttestObject.createTreeView('testNodeWithHighlightsTreeProvider', { treeDataProvider: aNodeWithHighlightedLabelTreeDataProvider() }, extensionsDescription);\n\n\t\treturn loadCompleteTree('testNodeTreeProvider');\n\t});\n\n\ttest('construct node tree', () => {\n\t\treturn testObject.$getChildren('testNodeTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a', '0/0:b']);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a/0:aa', '0/0:a/0:ab']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a/0:aa']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:a/0:ab']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:b/0:ba', '0/0:b/0:bb']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b/0:ba']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeTreeProvider', ['0/0:b/0:bb']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('construct id tree', () => {\n\t\treturn testObject.$getChildren('testNodeWithIdTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\tassert.deepStrictEqual(actuals, ['1/a', '1/b']);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/aa', '1/ab']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/aa']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/ab']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(children)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/ba', '1/bb']);\n\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/ba']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0)),\n\t\t\t\t\t\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider', ['1/bb']).then(children => assert.strictEqual(unBatchChildren(children)?.length, 0))\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('construct highlights tree', () => {\n\t\treturn testObject.$getChildren('testNodeWithHighlightsTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(elements)), [{\n\t\t\t\t\thandle: '1/a',\n\t\t\t\t\tlabel: { label: 'a', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t}, {\n\t\t\t\t\thandle: '1/b',\n\t\t\t\t\tlabel: { label: 'b', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t}]);\n\t\t\t\treturn Promise.all([\n\t\t\t\t\ttestObject.$getChildren('testNodeWithHighlightsTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(children)), [{\n\t\t\t\t\t\t\t\thandle: '1/aa',\n\t\t\t\t\t\t\t\tparentHandle: '1/a',\n\t\t\t\t\t\t\t\tlabel: { label: 'aa', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\thandle: '1/ab',\n\t\t\t\t\t\t\t\tparentHandle: '1/a',\n\t\t\t\t\t\t\t\tlabel: { label: 'ab', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t}),\n\t\t\t\t\ttestObject.$getChildren('testNodeWithHighlightsTreeProvider', ['1/b'])\n\t\t\t\t\t\t.then(children => {\n\t\t\t\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(unBatchChildren(children)), [{\n\t\t\t\t\t\t\t\thandle: '1/ba',\n\t\t\t\t\t\t\t\tparentHandle: '1/b',\n\t\t\t\t\t\t\t\tlabel: { label: 'ba', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\thandle: '1/bb',\n\t\t\t\t\t\t\t\tparentHandle: '1/b',\n\t\t\t\t\t\t\t\tlabel: { label: 'bb', highlights: [[0, 2], [3, 5]] },\n\t\t\t\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t})\n\t\t\t\t]);\n\t\t\t});\n\t});\n\n\ttest('error is thrown if id is not unique', (done) => {\n\t\ttree['a'] = {\n\t\t\t'aa': {},\n\t\t};\n\t\ttree['b'] = {\n\t\t\t'aa': {},\n\t\t\t'ba': {}\n\t\t};\n\t\tlet caughtExpectedError = false;\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeWithIdTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\tassert.deepStrictEqual(actuals, ['1/a', '1/b']);\n\t\t\t\t\treturn testObject.$getChildren('testNodeWithIdTreeProvider', ['1/a'])\n\t\t\t\t\t\t.then(() => testObject.$getChildren('testNodeWithIdTreeProvider', ['1/b']))\n\t\t\t\t\t\t.then(() => assert.fail('Should fail with duplicate id'))\n\t\t\t\t\t\t.catch(() => caughtExpectedError = true)\n\t\t\t\t\t\t.finally(() => caughtExpectedError ? done() : assert.fail('Expected duplicate id error not thrown.'));\n\t\t\t\t});\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('refresh root', function (done) {\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('refresh a parent node', () => {\n\t\treturn new Promise((c, e) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:b'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tc(undefined);\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t});\n\t});\n\n\ttest('refresh a leaf node', function (done) {\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.deepStrictEqual(['0/0:b/0:bb'], Object.keys(actuals));\n\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b/0:bb']), {\n\t\t\t\thandle: '0/0:b/0:bb',\n\t\t\t\tparentHandle: '0/0:b',\n\t\t\t\tlabel: { label: 'bb' },\n\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t});\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t});\n\n\tasync function runWithEventMerging(action: (resolve: () => void) => void) {\n\t\tawait runWithFakedTimers({}, async () => {\n\t\t\tawait new Promise<void>((resolve) => {\n\t\t\t\tlet subscription: IDisposable | undefined = undefined;\n\t\t\t\tsubscription = target.onRefresh.event(() => {\n\t\t\t\t\tsubscription!.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\t});\n\t\t\tawait new Promise<void>(action);\n\t\t});\n\t}\n\n\ttest('refresh parent and child node trigger refresh only on parent - scenario 1', async () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:b', '0/0:a/0:aa'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a/0:aa']), {\n\t\t\t\t\thandle: '0/0:a/0:aa',\n\t\t\t\t\tparentHandle: '0/0:a',\n\t\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('aa'));\n\t\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t\t});\n\t});\n\n\ttest('refresh parent and child node trigger refresh only on parent - scenario 2', async () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a/0:aa', '0/0:b'], Object.keys(actuals));\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:b']), {\n\t\t\t\t\thandle: '0/0:b',\n\t\t\t\t\tlabel: { label: 'b' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t\t});\n\t\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a/0:aa']), {\n\t\t\t\t\thandle: '0/0:a/0:aa',\n\t\t\t\t\tparentHandle: '0/0:a',\n\t\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\t\tcollapsibleState: TreeItemCollapsibleState.None\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(getNode('bb'));\n\t\t\tonDidChangeTreeNode.fire(getNode('aa'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t});\n\t});\n\n\ttest('refresh an element for label change', function (done) {\n\t\tlabels['a'] = 'aa';\n\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\tassert.deepStrictEqual(['0/0:a'], Object.keys(actuals));\n\t\t\tassert.deepStrictEqual(removeUnsetKeys(actuals['0/0:a']), {\n\t\t\t\thandle: '0/0:aa',\n\t\t\t\tlabel: { label: 'aa' },\n\t\t\t\tcollapsibleState: TreeItemCollapsibleState.Collapsed\n\t\t\t});\n\t\t\tdone();\n\t\t}));\n\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t});\n\n\ttest('refresh calls are throttled on roots', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on elements', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a', '0/0:b'], Object.keys(actuals));\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on unknown elements', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.deepStrictEqual(['0/0:a', '0/0:b'], Object.keys(actuals));\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('g'));\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on unknown elements and root', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(getNode('g'));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t});\n\t});\n\n\ttest('refresh calls are throttled on elements and root', () => {\n\t\treturn runWithEventMerging((resolve) => {\n\t\t\tstore.add(target.onRefresh.event(actuals => {\n\t\t\t\tassert.strictEqual(undefined, actuals);\n\t\t\t\tresolve();\n\t\t\t}));\n\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\tonDidChangeTreeNode.fire(undefined);\n\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t});\n\t});\n\n\ttest('generate unique handles from labels by escaping them', (done) => {\n\t\ttree = {\n\t\t\t'a/0:b': {}\n\t\t};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:a//0:b']);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t}));\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('tree with duplicate labels', (done) => {\n\n\t\tconst dupItems = {\n\t\t\t'adup1': 'c',\n\t\t\t'adup2': 'g',\n\t\t\t'bdup1': 'e',\n\t\t\t'hdup1': 'i',\n\t\t\t'hdup2': 'l',\n\t\t\t'jdup1': 'k'\n\t\t};\n\n\t\tlabels['c'] = 'a';\n\t\tlabels['e'] = 'b';\n\t\tlabels['g'] = 'a';\n\t\tlabels['i'] = 'h';\n\t\tlabels['l'] = 'h';\n\t\tlabels['k'] = 'j';\n\n\t\ttree[dupItems['adup1']] = {};\n\t\ttree['d'] = {};\n\n\t\tconst bdup1Tree: { [key: string]: any } = {};\n\t\tbdup1Tree['h'] = {};\n\t\tbdup1Tree[dupItems['hdup1']] = {};\n\t\tbdup1Tree['j'] = {};\n\t\tbdup1Tree[dupItems['jdup1']] = {};\n\t\tbdup1Tree[dupItems['hdup2']] = {};\n\n\t\ttree[dupItems['bdup1']] = bdup1Tree;\n\t\ttree['f'] = {};\n\t\ttree[dupItems['adup2']] = {};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/0:a', '0/0:b', '0/1:a', '0/0:d', '0/1:b', '0/0:f', '0/2:a']);\n\t\t\t\t\treturn testObject.$getChildren('testNodeTreeProvider', ['0/1:b'])\n\t\t\t\t\t\t.then(elements => {\n\t\t\t\t\t\t\tconst actuals = unBatchChildren(elements)?.map(e => e.handle);\n\t\t\t\t\t\t\tassert.deepStrictEqual(actuals, ['0/1:b/0:h', '0/1:b/1:h', '0/1:b/0:j', '0/1:b/1:j', '0/1:b/2:h']);\n\t\t\t\t\t\t\tdone();\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t}));\n\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('getChildren is not returned from cache if refreshed', (done) => {\n\t\ttree = {\n\t\t\t'c': {}\n\t\t};\n\n\t\tstore.add(target.onRefresh.event(() => {\n\t\t\ttestObject.$getChildren('testNodeTreeProvider')\n\t\t\t\t.then(elements => {\n\t\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:c']);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t}));\n\n\t\tonDidChangeTreeNode.fire(undefined);\n\t});\n\n\ttest('getChildren is returned from cache if not refreshed', () => {\n\t\ttree = {\n\t\t\t'c': {}\n\t\t};\n\n\t\treturn testObject.$getChildren('testNodeTreeProvider')\n\t\t\t.then(elements => {\n\t\t\t\tassert.deepStrictEqual(unBatchChildren(elements)?.map(e => e.handle), ['0/0:a', '0/0:b']);\n\t\t\t});\n\t});\n\n\ttest('reveal will throw an error if getParent is not implemented', () => {\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aNodeTreeDataProvider() }, extensionsDescription);\n\t\treturn treeView.reveal({ key: 'a' })\n\t\t\t.then(() => assert.fail('Reveal should throw an error as getParent is not implemented'), () => null);\n\t});\n\n\ttest('reveal will return empty array for root element', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem:\n\t\t\t\t{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed },\n\t\t\tparentChain: []\n\t\t};\n\t\treturn treeView.reveal({ key: 'a' })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected, removeUnsetKeys(revealTarget.args[0][1]));\n\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal will return parents array for an element when hierarchy is not loaded', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:aa', label: { label: 'aa' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn treeView.reveal({ key: 'aa' })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal will return parents array for an element when hierarchy is loaded', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:aa', label: { label: 'aa' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn testObject.$getChildren('treeDataProvider')\n\t\t\t.then(() => testObject.$getChildren('treeDataProvider', ['0/0:a']))\n\t\t\t.then(() => treeView.reveal({ key: 'aa' })\n\t\t\t\t.then(() => {\n\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t}));\n\t});\n\n\ttest('reveal will return parents array for deeper element with no selection', () => {\n\t\ttree = {\n\t\t\t'b': {\n\t\t\t\t'ba': {\n\t\t\t\t\t'bac': {}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:b/0:ba/0:bac', label: { label: 'bac' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:b/0:ba' },\n\t\t\tparentChain: [\n\t\t\t\t{ handle: '0/0:b', label: { label: 'b' }, collapsibleState: TreeItemCollapsibleState.Collapsed },\n\t\t\t\t{ handle: '0/0:b/0:ba', label: { label: 'ba' }, collapsibleState: TreeItemCollapsibleState.Collapsed, parentHandle: '0/0:b' }\n\t\t\t]\n\t\t};\n\t\treturn treeView.reveal({ key: 'bac' }, { select: false, focus: false, expand: false })\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\tassert.deepStrictEqual({ select: false, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t});\n\t});\n\n\ttest('reveal after first udpate', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\tconst expected = {\n\t\t\titem: { handle: '0/0:a/0:ac', label: { label: 'ac' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:a' },\n\t\t\tparentChain: [{ handle: '0/0:a', label: { label: 'a' }, collapsibleState: TreeItemCollapsibleState.Collapsed }]\n\t\t};\n\t\treturn loadCompleteTree('treeDataProvider')\n\t\t\t.then(() => {\n\t\t\t\ttree = {\n\t\t\t\t\t'a': {\n\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t},\n\t\t\t\t\t'b': {\n\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t'bb': {}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\n\t\t\t\treturn treeView.reveal({ key: 'ac' })\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\t\tassert.deepStrictEqual(expected.item, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\t\tassert.deepStrictEqual(expected.parentChain, (<Array<any>>(revealTarget.args[0][1]!.parentChain)).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t\t});\n\t\t\t});\n\t});\n\n\ttest('reveal after second udpate', () => {\n\t\tconst revealTarget = sinon.spy(target, '$reveal');\n\t\tconst treeView = testObject.createTreeView('treeDataProvider', { treeDataProvider: aCompleteNodeTreeDataProvider() }, extensionsDescription);\n\t\treturn loadCompleteTree('treeDataProvider')\n\t\t\t.then(() => {\n\t\t\t\treturn runWithEventMerging((resolve) => {\n\t\t\t\t\ttree = {\n\t\t\t\t\t\t'a': {\n\t\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'b': {\n\t\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t\t'bb': {}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tonDidChangeTreeNode.fire(getNode('a'));\n\t\t\t\t\ttree = {\n\t\t\t\t\t\t'a': {\n\t\t\t\t\t\t\t'aa': {},\n\t\t\t\t\t\t\t'ac': {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'b': {\n\t\t\t\t\t\t\t'ba': {},\n\t\t\t\t\t\t\t'bc': {}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tonDidChangeTreeNode.fire(getNode('b'));\n\t\t\t\t\tresolve();\n\t\t\t\t}).then(() => {\n\t\t\t\t\treturn treeView.reveal({ key: 'bc' })\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tassert.ok(revealTarget.calledOnce);\n\t\t\t\t\t\t\tassert.deepStrictEqual('treeDataProvider', revealTarget.args[0][0]);\n\t\t\t\t\t\t\tassert.deepStrictEqual({ handle: '0/0:b/0:bc', label: { label: 'bc' }, collapsibleState: TreeItemCollapsibleState.None, parentHandle: '0/0:b' }, removeUnsetKeys(revealTarget.args[0][1]!.item));\n\t\t\t\t\t\t\tassert.deepStrictEqual([{ handle: '0/0:b', label: { label: 'b' }, collapsibleState: TreeItemCollapsibleState.Collapsed }], (<Array<any>>revealTarget.args[0][1]!.parentChain).map(arg => removeUnsetKeys(arg)));\n\t\t\t\t\t\t\tassert.deepStrictEqual({ select: true, focus: false, expand: false }, revealTarget.args[0][2]);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t});\n\n\tfunction loadCompleteTree(treeId: string, element?: string): Promise<null> {\n\t\treturn testObject.$getChildren(treeId, element ? [element] : undefined)\n\t\t\t.then(elements => {\n\t\t\t\tif (!elements || elements?.length === 0) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn elements[0].slice(1).map(e => loadCompleteTree(treeId, (e as ITreeItem).handle));\n\t\t\t})\n\t\t\t.then(() => null);\n\t}\n\n\tfunction removeUnsetKeys(obj: any): any {\n\t\tif (Array.isArray(obj)) {\n\t\t\treturn obj.map(o => removeUnsetKeys(o));\n\t\t}\n\n\t\tif (typeof obj === 'object') {\n\t\t\tconst result: { [key: string]: any } = {};\n\t\t\tfor (const key of Object.keys(obj)) {\n\t\t\t\tif (obj[key] !== undefined) {\n\t\t\t\t\tresult[key] = removeUnsetKeys(obj[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn obj;\n\t}\n\n\tfunction aNodeTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\treturn getTreeItem(element.key);\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNode.event\n\t\t};\n\t}\n\n\tfunction aCompleteNodeTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\treturn getTreeItem(element.key);\n\t\t\t},\n\t\t\tgetParent: ({ key }: { key: string }): { key: string } | undefined => {\n\t\t\t\tconst parentKey = key.substring(0, key.length - 1);\n\t\t\t\treturn parentKey ? new Key(parentKey) : undefined;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNode.event\n\t\t};\n\t}\n\n\tfunction aNodeWithIdTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\tconst treeItem = getTreeItem(element.key);\n\t\t\t\ttreeItem.id = element.key;\n\t\t\t\treturn treeItem;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNodeWithId.event\n\t\t};\n\t}\n\n\tfunction aNodeWithHighlightedLabelTreeDataProvider(): TreeDataProvider<{ key: string }> {\n\t\treturn {\n\t\t\tgetChildren: (element: { key: string }): { key: string }[] => {\n\t\t\t\treturn getChildren(element ? element.key : undefined).map(key => getNode(key));\n\t\t\t},\n\t\t\tgetTreeItem: (element: { key: string }): TreeItem => {\n\t\t\t\tconst treeItem = getTreeItem(element.key, [[0, 2], [3, 5]]);\n\t\t\t\ttreeItem.id = element.key;\n\t\t\t\treturn treeItem;\n\t\t\t},\n\t\t\tonDidChangeTreeData: onDidChangeTreeNodeWithId.event\n\t\t};\n\t}\n\n\tfunction getTreeElement(element: string): any {\n\t\tlet parent = tree;\n\t\tfor (let i = 0; i < element.length; i++) {\n\t\t\tparent = parent[element.substring(0, i + 1)];\n\t\t\tif (!parent) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn parent;\n\t}\n\n\tfunction getChildren(key: string | undefined): string[] {\n\t\tif (!key) {\n\t\t\treturn Object.keys(tree);\n\t\t}\n\t\tconst treeElement = getTreeElement(key);\n\t\tif (treeElement) {\n\t\t\treturn Object.keys(treeElement);\n\t\t}\n\t\treturn [];\n\t}\n\n\tfunction getTreeItem(key: string, highlights?: [number, number][]): TreeItem {\n\t\tconst treeElement = getTreeElement(key);\n\t\treturn {\n\t\t\tlabel: { label: labels[key] || key, highlights },\n\t\t\tcollapsibleState: treeElement && Object.keys(treeElement).length ? TreeItemCollapsibleState.Collapsed : TreeItemCollapsibleState.None\n\t\t};\n\t}\n\n\tfunction getNode(key: string): { key: string } {\n\t\tif (!nodes[key]) {\n\t\t\tnodes[key] = new Key(key);\n\t\t}\n\t\treturn nodes[key];\n\t}\n\n\tclass Key {\n\t\tconstructor(readonly key: string) { }\n\t}\n\n});\n"]}