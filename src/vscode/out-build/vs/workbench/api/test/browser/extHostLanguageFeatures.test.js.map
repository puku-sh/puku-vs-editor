{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts","vs/workbench/api/test/browser/extHostLanguageFeatures.test.ts"],"names":[],"mappings":"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","file":"extHostLanguageFeatures.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { TestInstantiationService } from '../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { setUnexpectedErrorHandler, errorHandler } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as types from '../../common/extHostTypes.js';\nimport { createTextModel } from '../../../../editor/test/common/testTextModel.js';\nimport { Position as EditorPosition, Position } from '../../../../editor/common/core/position.js';\nimport { Range as EditorRange } from '../../../../editor/common/core/range.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { MarkerService } from '../../../../platform/markers/common/markerService.js';\nimport { ExtHostLanguageFeatures } from '../../common/extHostLanguageFeatures.js';\nimport { MainThreadLanguageFeatures } from '../../browser/mainThreadLanguageFeatures.js';\nimport { ExtHostCommands } from '../../common/extHostCommands.js';\nimport { MainThreadCommands } from '../../browser/mainThreadCommands.js';\nimport { ExtHostDocuments } from '../../common/extHostDocuments.js';\nimport { ExtHostDocumentsAndEditors } from '../../common/extHostDocumentsAndEditors.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { getCodeLensModel } from '../../../../editor/contrib/codelens/browser/codelens.js';\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from '../../../../editor/contrib/gotoSymbol/browser/goToSymbol.js';\nimport { getHoversPromise } from '../../../../editor/contrib/hover/browser/getHover.js';\nimport { getOccurrencesAtPosition } from '../../../../editor/contrib/wordHighlighter/browser/wordHighlighter.js';\nimport { getCodeActions } from '../../../../editor/contrib/codeAction/browser/codeAction.js';\nimport { getWorkspaceSymbols } from '../../../contrib/search/common/search.js';\nimport { rename } from '../../../../editor/contrib/rename/browser/rename.js';\nimport { provideSignatureHelp } from '../../../../editor/contrib/parameterHints/browser/provideSignatureHelp.js';\nimport { provideSuggestionItems, CompletionOptions } from '../../../../editor/contrib/suggest/browser/suggest.js';\nimport { getDocumentFormattingEditsUntilResult, getDocumentRangeFormattingEditsUntilResult, getOnTypeFormattingEdits } from '../../../../editor/contrib/format/browser/format.js';\nimport { getLinks } from '../../../../editor/contrib/links/browser/getLinks.js';\nimport { MainContext, ExtHostContext } from '../../common/extHost.protocol.js';\nimport { ExtHostDiagnostics } from '../../common/extHostDiagnostics.js';\nimport type * as vscode from 'vscode';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport { ITextModel, EndOfLineSequence } from '../../../../editor/common/model.js';\nimport { getColors } from '../../../../editor/contrib/colorPicker/browser/color.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { nullExtensionDescription as defaultExtension } from '../../../services/extensions/common/extensions.js';\nimport { provideSelectionRanges } from '../../../../editor/contrib/smartSelect/browser/smartSelect.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { NullApiDeprecationService } from '../../common/extHostApiDeprecationService.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { IExtHostFileSystemInfo } from '../../common/extHostFileSystemInfo.js';\nimport { URITransformerService } from '../../common/extHostUriTransformerService.js';\nimport { OutlineModel } from '../../../../editor/contrib/documentSymbols/browser/outlineModel.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { LanguageFeaturesService } from '../../../../editor/common/services/languageFeaturesService.js';\nimport { CodeActionTriggerSource } from '../../../../editor/contrib/codeAction/common/types.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IExtHostTelemetry } from '../../common/extHostTelemetry.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\n\nsuite('ExtHostLanguageFeatures', function () {\n\n\tconst defaultSelector = { scheme: 'far' };\n\tlet model: ITextModel;\n\tlet extHost: ExtHostLanguageFeatures;\n\tlet mainThread: MainThreadLanguageFeatures;\n\tconst disposables = new DisposableStore();\n\tlet rpcProtocol: TestRPCProtocol;\n\tlet languageFeaturesService: ILanguageFeaturesService;\n\tlet originalErrorHandler: (e: any) => any;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\n\t\tmodel = createTextModel(\n\t\t\t[\n\t\t\t\t'This is the first line',\n\t\t\t\t'This is the second line',\n\t\t\t\t'This is the third line',\n\t\t\t].join('\\n'),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tURI.parse('far://testing/file.a'));\n\n\t\trpcProtocol = new TestRPCProtocol();\n\n\t\tlanguageFeaturesService = new LanguageFeaturesService();\n\n\t\t// Use IInstantiationService to get typechecking when instantiating\n\t\tlet inst: IInstantiationService;\n\t\t{\n\t\t\tinstantiationService = new TestInstantiationService();\n\t\t\tinstantiationService.stub(IMarkerService, MarkerService);\n\t\t\tinstantiationService.set(ILanguageFeaturesService, languageFeaturesService);\n\t\t\tinstantiationService.set(IUriIdentityService, new class extends mock<IUriIdentityService>() {\n\t\t\t\toverride asCanonicalUri(uri: URI): URI {\n\t\t\t\t\treturn uri;\n\t\t\t\t}\n\t\t\t});\n\t\t\tinst = instantiationService;\n\t\t}\n\n\t\toriginalErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => { });\n\n\t\tconst extHostDocumentsAndEditors = new ExtHostDocumentsAndEditors(rpcProtocol, new NullLogService());\n\t\textHostDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({\n\t\t\taddedDocuments: [{\n\t\t\t\tisDirty: false,\n\t\t\t\tversionId: model.getVersionId(),\n\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\turi: model.uri,\n\t\t\t\tlines: model.getValue().split(model.getEOL()),\n\t\t\t\tEOL: model.getEOL(),\n\t\t\t\tencoding: 'utf8'\n\t\t\t}]\n\t\t});\n\t\tconst extHostDocuments = new ExtHostDocuments(rpcProtocol, extHostDocumentsAndEditors);\n\t\trpcProtocol.set(ExtHostContext.ExtHostDocuments, extHostDocuments);\n\n\t\tconst commands = new ExtHostCommands(rpcProtocol, new NullLogService(), new class extends mock<IExtHostTelemetry>() {\n\t\t\toverride onExtensionError(): boolean {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\trpcProtocol.set(ExtHostContext.ExtHostCommands, commands);\n\t\trpcProtocol.set(MainContext.MainThreadCommands, disposables.add(inst.createInstance(MainThreadCommands, rpcProtocol)));\n\n\t\tconst diagnostics = new ExtHostDiagnostics(rpcProtocol, new NullLogService(), new class extends mock<IExtHostFileSystemInfo>() { }, extHostDocumentsAndEditors);\n\t\trpcProtocol.set(ExtHostContext.ExtHostDiagnostics, diagnostics);\n\n\t\textHost = new ExtHostLanguageFeatures(rpcProtocol, new URITransformerService(null), extHostDocuments, commands, diagnostics, new NullLogService(), NullApiDeprecationService, new class extends mock<IExtHostTelemetry>() {\n\t\t\toverride onExtensionError(): boolean {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\trpcProtocol.set(ExtHostContext.ExtHostLanguageFeatures, extHost);\n\n\t\tmainThread = rpcProtocol.set(MainContext.MainThreadLanguageFeatures, disposables.add(inst.createInstance(MainThreadLanguageFeatures, rpcProtocol)));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\n\t\tsetUnexpectedErrorHandler(originalErrorHandler);\n\t\tmodel.dispose();\n\t\tmainThread.dispose();\n\t\tinstantiationService.dispose();\n\n\t\treturn rpcProtocol.sync();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\t// --- outline\n\n\ttest('DocumentSymbols, register/deregister', async () => {\n\t\tassert.strictEqual(languageFeaturesService.documentSymbolProvider.all(model).length, 0);\n\t\tconst d1 = extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols() {\n\t\t\t\treturn <vscode.SymbolInformation[]>[];\n\t\t\t}\n\t\t});\n\n\t\tawait rpcProtocol.sync();\n\t\tassert.strictEqual(languageFeaturesService.documentSymbolProvider.all(model).length, 1);\n\t\td1.dispose();\n\t\treturn rpcProtocol.sync();\n\n\t});\n\n\ttest('DocumentSymbols, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\tthrow new Error('evil document symbol provider');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('test', types.SymbolKind.Field, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\ttest('DocumentSymbols, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('test', types.SymbolKind.Field, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst entry = value[0];\n\t\tassert.strictEqual(entry.name, 'test');\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Quick Outline uses a not ideal sorting, #138502', async function () {\n\t\tconst symbols = [\n\t\t\t{ name: 'containers', range: { startLineNumber: 1, startColumn: 1, endLineNumber: 4, endColumn: 26 } },\n\t\t\t{ name: 'container 0', range: { startLineNumber: 2, startColumn: 5, endLineNumber: 5, endColumn: 1 } },\n\t\t\t{ name: 'name', range: { startLineNumber: 2, startColumn: 5, endLineNumber: 2, endColumn: 16 } },\n\t\t\t{ name: 'ports', range: { startLineNumber: 3, startColumn: 5, endLineNumber: 5, endColumn: 1 } },\n\t\t\t{ name: 'ports 0', range: { startLineNumber: 4, startColumn: 9, endLineNumber: 4, endColumn: 26 } },\n\t\t\t{ name: 'containerPort', range: { startLineNumber: 4, startColumn: 9, endLineNumber: 4, endColumn: 26 } }\n\t\t];\n\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, {\n\t\t\tprovideDocumentSymbols: (doc, token): any => {\n\t\t\t\treturn symbols.map(s => {\n\t\t\t\t\treturn new types.SymbolInformation(\n\t\t\t\t\t\ts.name,\n\t\t\t\t\t\ttypes.SymbolKind.Object,\n\t\t\t\t\t\tnew types.Range(s.range.startLineNumber - 1, s.range.startColumn - 1, s.range.endLineNumber - 1, s.range.endColumn - 1)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\n\t\tassert.strictEqual(value.length, 6);\n\t\tassert.deepStrictEqual(value.map(s => s.name), ['containers', 'container 0', 'name', 'ports', 'ports 0', 'containerPort']);\n\t});\n\n\t// --- code lens\n\n\ttest('CodeLens, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses() {\n\t\t\t\t\treturn [new types.CodeLens(new types.Range(0, 0, 0, 0))];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('CodeLens, do not resolve a resolved lens', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses(): any {\n\t\t\t\t\treturn [new types.CodeLens(\n\t\t\t\t\t\tnew types.Range(0, 0, 0, 0),\n\t\t\t\t\t\t{ command: 'id', title: 'Title' })];\n\t\t\t\t}\n\t\t\t\tresolveCodeLens(): any {\n\t\t\t\t\tassert.ok(false, 'do not resolve');\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tconst [data] = value.lenses;\n\t\t\tconst symbol = await Promise.resolve(data.provider.resolveCodeLens!(model, data.symbol, CancellationToken.None));\n\t\t\tassert.strictEqual(symbol!.command!.id, 'id');\n\t\t\tassert.strictEqual(symbol!.command!.title, 'Title');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('CodeLens, missing command', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses() {\n\t\t\t\t\treturn [new types.CodeLens(new types.Range(0, 0, 0, 0))];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tconst [data] = value.lenses;\n\t\t\tconst symbol = await Promise.resolve(data.provider.resolveCodeLens!(model, data.symbol, CancellationToken.None));\n\t\t\tassert.strictEqual(symbol, undefined);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\t// --- definition\n\n\ttest('Definition, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\ttest('Definition, one or many', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 1, 1, 1))];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(model.uri, new types.Range(2, 1, 1, 1));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t});\n\n\ttest('Definition, registration order', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://first'), new types.Range(2, 3, 4, 5))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(URI.parse('far://second'), new types.Range(1, 2, 3, 4));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\t// let [first, second] = value;\n\t\tassert.strictEqual(value[0].uri.authority, 'second');\n\t\tassert.strictEqual(value[1].uri.authority, 'first');\n\t});\n\n\ttest('Definition, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\tthrow new Error('evil provider');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(model.uri, new types.Range(1, 1, 1, 1));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\t// -- declaration\n\n\ttest('Declaration, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDeclarationProvider(defaultExtension, defaultSelector, new class implements vscode.DeclarationProvider {\n\t\t\tprovideDeclaration(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- implementation\n\n\ttest('Implementation, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerImplementationProvider(defaultExtension, defaultSelector, new class implements vscode.ImplementationProvider {\n\t\t\tprovideImplementation(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- type definition\n\n\ttest('Type Definition, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerTypeDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.TypeDefinitionProvider {\n\t\t\tprovideTypeDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- extra info\n\n\ttest('HoverProvider, word range at pos', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t\tconst [entry] = hovers;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t});\n\n\n\ttest('HoverProvider, given range', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello', new types.Range(3, 0, 8, 7));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t\tconst [entry] = hovers;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 4, startColumn: 1, endLineNumber: 9, endColumn: 8 });\n\t});\n\n\n\ttest('HoverProvider, registration order', async () => {\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('registered first');\n\t\t\t}\n\t\t}));\n\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('registered second');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.contents[0].value, 'registered second');\n\t\tassert.strictEqual(second.contents[0].value, 'registered first');\n\t});\n\n\n\ttest('HoverProvider, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t});\n\n\t// --- occurrences\n\n\ttest('Occurrences, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, order 1/2', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, '*', new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, order 2/2', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 2))];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, '*', new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 3 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None);\n\t\tassert.strictEqual(value!.size, 1);\n\t});\n\n\t// --- references\n\n\ttest('References, registration order', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://register/first'), new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://register/second'), new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.uri.path, '/second');\n\t\tassert.strictEqual(second.uri.path, '/first');\n\t});\n\n\ttest('References, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Position(0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [item] = value;\n\t\tassert.deepStrictEqual(item.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t\tassert.strictEqual(item.uri.toString(), model.uri.toString());\n\t});\n\n\ttest('References, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\t// --- quick fix\n\n\ttest('Quick Fix, command data conversion', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, {\n\t\t\t\tprovideCodeActions(): vscode.Command[] {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{ command: 'test1', title: 'Testing1' },\n\t\t\t\t\t\t{ command: 'test2', title: 'Testing2' }\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.QuickFix }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 2);\n\t\t\tconst [first, second] = actions;\n\t\t\tassert.strictEqual(first.action.title, 'Testing1');\n\t\t\tassert.strictEqual(first.action.command!.id, 'test1');\n\t\t\tassert.strictEqual(second.action.title, 'Testing2');\n\t\t\tassert.strictEqual(second.action.command!.id, 'test2');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('Quick Fix, code action data conversion', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, {\n\t\t\t\tprovideCodeActions(): vscode.CodeAction[] {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Testing1',\n\t\t\t\t\t\t\tcommand: { title: 'Testing1Command', command: 'test1' },\n\t\t\t\t\t\t\tkind: types.CodeActionKind.Empty.append('test.scope')\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.Default }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tconst [first] = actions;\n\t\t\tassert.strictEqual(first.action.title, 'Testing1');\n\t\t\tassert.strictEqual(first.action.command!.title, 'Testing1Command');\n\t\t\tassert.strictEqual(first.action.command!.id, 'test1');\n\t\t\tassert.strictEqual(first.action.kind, 'test.scope');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\n\ttest('Cannot read property \\'id\\' of undefined, #29469', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\treturn [\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t{ command: 'test', title: 'Testing' }\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.Default }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('Quick Fix, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\treturn [{ command: 'test', title: 'Testing' }];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.QuickFix }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\t// --- navigate types\n\n\ttest('Navigate types, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('testing', types.SymbolKind.Array, new types.Range(0, 0, 1, 1))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getWorkspaceSymbols('');\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.symbol.name, 'testing');\n\t});\n\n\ttest('Navigate types, de-duplicate results', async () => {\n\t\tconst uri = URI.from({ scheme: 'foo', path: '/some/path' });\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))]; // get de-duped\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, undefined!))]; // NO dedupe because of resolve\n\t\t\t}\n\t\t\tresolveWorkspaceSymbol(a: vscode.SymbolInformation) {\n\t\t\t\treturn a;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Struct, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))]; // NO dedupe because of kind\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getWorkspaceSymbols('');\n\t\tassert.strictEqual(value.length, 3);\n\t});\n\n\t// --- rename\n\n\ttest('Rename, evil provider 0/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow new class Foo { };\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\ttry {\n\t\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\t\tthrow Error();\n\t\t}\n\t\tcatch (err) {\n\t\t\t// expected\n\t\t}\n\t});\n\n\ttest('Rename, evil provider 1/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\tassert.strictEqual(value.rejectReason, 'evil');\n\t});\n\n\ttest('Rename, evil provider 2/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, '*', new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tconst edit = new types.WorkspaceEdit();\n\t\t\t\tedit.replace(model.uri, new types.Range(0, 0, 0, 0), 'testing');\n\t\t\t\treturn edit;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\tassert.strictEqual(value.edits.length, 1);\n\t});\n\n\ttest('Rename, ordering', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, '*', new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tconst edit = new types.WorkspaceEdit();\n\t\t\t\tedit.replace(model.uri, new types.Range(0, 0, 0, 0), 'testing');\n\t\t\t\tedit.replace(model.uri, new types.Range(1, 0, 1, 0), 'testing');\n\t\t\t\treturn edit;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\t// least relevant rename provider\n\t\tassert.strictEqual(value.edits.length, 2);\n\t});\n\n\ttest('Multiple RenameProviders don\\'t respect all possible PrepareRename handlers 1/2, #98352', async function () {\n\n\t\tconst called = [false, false, false, false];\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[0] = true;\n\t\t\t\tconst range = document.getWordRangeAtPosition(position);\n\t\t\t\treturn range;\n\t\t\t}\n\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[1] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[2] = true;\n\t\t\t\treturn Promise.reject('Cannot rename this symbol2.');\n\t\t\t}\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[3] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\n\t\tassert.deepStrictEqual(called, [true, true, true, false]);\n\t});\n\n\ttest('Multiple RenameProviders don\\'t respect all possible PrepareRename handlers 2/2, #98352', async function () {\n\n\t\tconst called = [false, false, false];\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[0] = true;\n\t\t\t\tconst range = document.getWordRangeAtPosition(position);\n\t\t\t\treturn range;\n\t\t\t}\n\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[1] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\n\t\t\tprovideRenameEdits(document: vscode.TextDocument, position: vscode.Position, newName: string,): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[2] = true;\n\t\t\t\treturn new types.WorkspaceEdit();\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\n\t\t// first provider has NO prepare which means it is taken by default\n\t\tassert.deepStrictEqual(called, [false, false, true]);\n\t});\n\n\t// --- parameter hints\n\n\ttest('Parameter Hints, order', async () => {\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}, []));\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): vscode.SignatureHelp {\n\t\t\t\treturn {\n\t\t\t\t\tsignatures: [],\n\t\t\t\t\tactiveParameter: 0,\n\t\t\t\t\tactiveSignature: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}, []));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, model, new EditorPosition(1, 1), { triggerKind: languages.SignatureHelpTriggerKind.Invoke, isRetrigger: false }, CancellationToken.None);\n\t\tassert.ok(value);\n\t});\n\n\ttest('Parameter Hints, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}, []));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, model, new EditorPosition(1, 1), { triggerKind: languages.SignatureHelpTriggerKind.Invoke, isRetrigger: false }, CancellationToken.None);\n\t\tassert.strictEqual(value, undefined);\n\t});\n\n\t// --- suggestions\n\n\ttest('Suggest, order 1/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, '*', new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing1')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing2')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 1);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'testing2');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, order 2/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, '*', new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('weak-selector')]; // weaker selector but result\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn []; // stronger selector but not a good result;\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 1);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'weak-selector');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, order 3/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('strong-1')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('strong-2')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 2);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'strong-1'); // sort by label\n\t\t\tassert.strictEqual(value.items[1].completion.insertText, 'strong-2');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items[0].container.incomplete, false);\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, CompletionList', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\treturn new types.CompletionList([<any>new types.CompletionItem('hello')], true);\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tawait provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet))).then(model => {\n\t\t\t\tassert.strictEqual(model.items[0].container.incomplete, true);\n\t\t\t\tmodel.disposable.dispose();\n\t\t\t});\n\t\t});\n\t});\n\n\t// --- format\n\n\tconst NullWorkerService = new class extends mock<IEditorWorkerService>() {\n\t\toverride computeMoreMinimalEdits(resource: URI, edits: languages.TextEdit[] | null | undefined): Promise<languages.TextEdit[] | undefined> {\n\t\t\treturn Promise.resolve(edits ?? undefined);\n\t\t}\n\t};\n\n\ttest('Format Doc, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing'), types.TextEdit.setEndOfLine(types.EndOfLine.LF)];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t\tassert.strictEqual(second.eol, EndOfLineSequence.LF);\n\t\tassert.strictEqual(second.text, '');\n\t\tassert.deepStrictEqual(second.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Doc, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\treturn getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None);\n\t});\n\n\ttest('Format Doc, order', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing')];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Range, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing')];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Range, + format_doc', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'range')];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(2, 3, 4, 5), 'range2')];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 1, 1), 'doc')];\n\t\t\t}\n\t\t}));\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'range2');\n\t\tassert.strictEqual(first.range.startLineNumber, 3);\n\t\tassert.strictEqual(first.range.startColumn, 4);\n\t\tassert.strictEqual(first.range.endLineNumber, 5);\n\t\tassert.strictEqual(first.range.endColumn, 6);\n\t});\n\n\ttest('Format Range, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\treturn getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None);\n\t});\n\n\ttest('Format on Type, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerOnTypeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.OnTypeFormattingEditProvider {\n\t\t\tprovideOnTypeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), arguments[2])];\n\t\t\t}\n\t\t}, [';']));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOnTypeFormattingEdits(NullWorkerService, languageFeaturesService, model, new EditorPosition(1, 1), ';', { insertSpaces: true, tabSize: 2 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, ';');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Links, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks() {\n\t\t\t\tconst link = new types.DocumentLink(new types.Range(0, 0, 1, 1), URI.parse('foo:bar#3'));\n\t\t\t\tlink.tooltip = 'tooltip';\n\t\t\t\treturn [link];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst { links } = disposables.add(await getLinks(languageFeaturesService.linkProvider, model, CancellationToken.None));\n\t\tassert.strictEqual(links.length, 1);\n\t\tconst [first] = links;\n\t\tassert.strictEqual(first.url?.toString(), 'foo:bar#3');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 2, endColumn: 2 });\n\t\tassert.strictEqual(first.tooltip, 'tooltip');\n\t});\n\n\ttest('Links, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks() {\n\t\t\t\treturn [new types.DocumentLink(new types.Range(0, 0, 1, 1), URI.parse('foo:bar#3'))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks(): any {\n\t\t\t\tthrow new Error();\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst { links } = disposables.add(await getLinks(languageFeaturesService.linkProvider, model, CancellationToken.None));\n\t\tassert.strictEqual(links.length, 1);\n\t\tconst [first] = links;\n\t\tassert.strictEqual(first.url?.toString(), 'foo:bar#3');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 2, endColumn: 2 });\n\t});\n\n\ttest('Document colors, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerColorProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentColorProvider {\n\t\t\tprovideDocumentColors(): vscode.ColorInformation[] {\n\t\t\t\treturn [new types.ColorInformation(new types.Range(0, 0, 0, 20), new types.Color(0.1, 0.2, 0.3, 0.4))];\n\t\t\t}\n\t\t\tprovideColorPresentations(color: vscode.Color, context: { range: vscode.Range; document: vscode.TextDocument }): vscode.ColorPresentation[] {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getColors(languageFeaturesService.colorProvider, model, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.deepStrictEqual(first.colorInfo.color, { red: 0.1, green: 0.2, blue: 0.3, alpha: 0.4 });\n\t\tassert.deepStrictEqual(first.colorInfo.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 21 });\n\t});\n\n\t// -- selection ranges\n\n\ttest('Selection Ranges, data conversion', async () => {\n\t\tdisposables.add(extHost.registerSelectionRangeProvider(defaultExtension, defaultSelector, new class implements vscode.SelectionRangeProvider {\n\t\t\tprovideSelectionRanges() {\n\t\t\t\treturn [\n\t\t\t\t\tnew types.SelectionRange(new types.Range(0, 10, 0, 18), new types.SelectionRange(new types.Range(0, 2, 0, 20))),\n\t\t\t\t];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\n\t\tprovideSelectionRanges(languageFeaturesService.selectionRangeProvider, model, [new Position(1, 17)], { selectLeadingAndTrailingWhitespace: true, selectSubwords: true }, CancellationToken.None).then(ranges => {\n\t\t\tassert.strictEqual(ranges.length, 1);\n\t\t\tassert.ok(ranges[0].length >= 2);\n\t\t});\n\t});\n\n\ttest('Selection Ranges, bad data', async () => {\n\n\t\ttry {\n\t\t\tconst _a = new types.SelectionRange(new types.Range(0, 10, 0, 18),\n\t\t\t\tnew types.SelectionRange(new types.Range(0, 11, 0, 18))\n\t\t\t);\n\t\t\tassert.ok(false, String(_a));\n\t\t} catch (err) {\n\t\t\tassert.ok(true);\n\t\t}\n\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { TestInstantiationService } from '../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { setUnexpectedErrorHandler, errorHandler } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as types from '../../common/extHostTypes.js';\nimport { createTextModel } from '../../../../editor/test/common/testTextModel.js';\nimport { Position as EditorPosition, Position } from '../../../../editor/common/core/position.js';\nimport { Range as EditorRange } from '../../../../editor/common/core/range.js';\nimport { TestRPCProtocol } from '../common/testRPCProtocol.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { MarkerService } from '../../../../platform/markers/common/markerService.js';\nimport { ExtHostLanguageFeatures } from '../../common/extHostLanguageFeatures.js';\nimport { MainThreadLanguageFeatures } from '../../browser/mainThreadLanguageFeatures.js';\nimport { ExtHostCommands } from '../../common/extHostCommands.js';\nimport { MainThreadCommands } from '../../browser/mainThreadCommands.js';\nimport { ExtHostDocuments } from '../../common/extHostDocuments.js';\nimport { ExtHostDocumentsAndEditors } from '../../common/extHostDocumentsAndEditors.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { getCodeLensModel } from '../../../../editor/contrib/codelens/browser/codelens.js';\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from '../../../../editor/contrib/gotoSymbol/browser/goToSymbol.js';\nimport { getHoversPromise } from '../../../../editor/contrib/hover/browser/getHover.js';\nimport { getOccurrencesAtPosition } from '../../../../editor/contrib/wordHighlighter/browser/wordHighlighter.js';\nimport { getCodeActions } from '../../../../editor/contrib/codeAction/browser/codeAction.js';\nimport { getWorkspaceSymbols } from '../../../contrib/search/common/search.js';\nimport { rename } from '../../../../editor/contrib/rename/browser/rename.js';\nimport { provideSignatureHelp } from '../../../../editor/contrib/parameterHints/browser/provideSignatureHelp.js';\nimport { provideSuggestionItems, CompletionOptions } from '../../../../editor/contrib/suggest/browser/suggest.js';\nimport { getDocumentFormattingEditsUntilResult, getDocumentRangeFormattingEditsUntilResult, getOnTypeFormattingEdits } from '../../../../editor/contrib/format/browser/format.js';\nimport { getLinks } from '../../../../editor/contrib/links/browser/getLinks.js';\nimport { MainContext, ExtHostContext } from '../../common/extHost.protocol.js';\nimport { ExtHostDiagnostics } from '../../common/extHostDiagnostics.js';\nimport type * as vscode from 'vscode';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport { ITextModel, EndOfLineSequence } from '../../../../editor/common/model.js';\nimport { getColors } from '../../../../editor/contrib/colorPicker/browser/color.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { nullExtensionDescription as defaultExtension } from '../../../services/extensions/common/extensions.js';\nimport { provideSelectionRanges } from '../../../../editor/contrib/smartSelect/browser/smartSelect.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { NullApiDeprecationService } from '../../common/extHostApiDeprecationService.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { IExtHostFileSystemInfo } from '../../common/extHostFileSystemInfo.js';\nimport { URITransformerService } from '../../common/extHostUriTransformerService.js';\nimport { OutlineModel } from '../../../../editor/contrib/documentSymbols/browser/outlineModel.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { LanguageFeaturesService } from '../../../../editor/common/services/languageFeaturesService.js';\nimport { CodeActionTriggerSource } from '../../../../editor/contrib/codeAction/common/types.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IExtHostTelemetry } from '../../common/extHostTelemetry.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { runWithFakedTimers } from '../../../../base/test/common/timeTravelScheduler.js';\n\nsuite('ExtHostLanguageFeatures', function () {\n\n\tconst defaultSelector = { scheme: 'far' };\n\tlet model: ITextModel;\n\tlet extHost: ExtHostLanguageFeatures;\n\tlet mainThread: MainThreadLanguageFeatures;\n\tconst disposables = new DisposableStore();\n\tlet rpcProtocol: TestRPCProtocol;\n\tlet languageFeaturesService: ILanguageFeaturesService;\n\tlet originalErrorHandler: (e: any) => any;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\n\t\tmodel = createTextModel(\n\t\t\t[\n\t\t\t\t'This is the first line',\n\t\t\t\t'This is the second line',\n\t\t\t\t'This is the third line',\n\t\t\t].join('\\n'),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tURI.parse('far://testing/file.a'));\n\n\t\trpcProtocol = new TestRPCProtocol();\n\n\t\tlanguageFeaturesService = new LanguageFeaturesService();\n\n\t\t// Use IInstantiationService to get typechecking when instantiating\n\t\tlet inst: IInstantiationService;\n\t\t{\n\t\t\tinstantiationService = new TestInstantiationService();\n\t\t\tinstantiationService.stub(IMarkerService, MarkerService);\n\t\t\tinstantiationService.set(ILanguageFeaturesService, languageFeaturesService);\n\t\t\tinstantiationService.set(IUriIdentityService, new class extends mock<IUriIdentityService>() {\n\t\t\t\toverride asCanonicalUri(uri: URI): URI {\n\t\t\t\t\treturn uri;\n\t\t\t\t}\n\t\t\t});\n\t\t\tinst = instantiationService;\n\t\t}\n\n\t\toriginalErrorHandler = errorHandler.getUnexpectedErrorHandler();\n\t\tsetUnexpectedErrorHandler(() => { });\n\n\t\tconst extHostDocumentsAndEditors = new ExtHostDocumentsAndEditors(rpcProtocol, new NullLogService());\n\t\textHostDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({\n\t\t\taddedDocuments: [{\n\t\t\t\tisDirty: false,\n\t\t\t\tversionId: model.getVersionId(),\n\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\turi: model.uri,\n\t\t\t\tlines: model.getValue().split(model.getEOL()),\n\t\t\t\tEOL: model.getEOL(),\n\t\t\t\tencoding: 'utf8'\n\t\t\t}]\n\t\t});\n\t\tconst extHostDocuments = new ExtHostDocuments(rpcProtocol, extHostDocumentsAndEditors);\n\t\trpcProtocol.set(ExtHostContext.ExtHostDocuments, extHostDocuments);\n\n\t\tconst commands = new ExtHostCommands(rpcProtocol, new NullLogService(), new class extends mock<IExtHostTelemetry>() {\n\t\t\toverride onExtensionError(): boolean {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\trpcProtocol.set(ExtHostContext.ExtHostCommands, commands);\n\t\trpcProtocol.set(MainContext.MainThreadCommands, disposables.add(inst.createInstance(MainThreadCommands, rpcProtocol)));\n\n\t\tconst diagnostics = new ExtHostDiagnostics(rpcProtocol, new NullLogService(), new class extends mock<IExtHostFileSystemInfo>() { }, extHostDocumentsAndEditors);\n\t\trpcProtocol.set(ExtHostContext.ExtHostDiagnostics, diagnostics);\n\n\t\textHost = new ExtHostLanguageFeatures(rpcProtocol, new URITransformerService(null), extHostDocuments, commands, diagnostics, new NullLogService(), NullApiDeprecationService, new class extends mock<IExtHostTelemetry>() {\n\t\t\toverride onExtensionError(): boolean {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\trpcProtocol.set(ExtHostContext.ExtHostLanguageFeatures, extHost);\n\n\t\tmainThread = rpcProtocol.set(MainContext.MainThreadLanguageFeatures, disposables.add(inst.createInstance(MainThreadLanguageFeatures, rpcProtocol)));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\n\t\tsetUnexpectedErrorHandler(originalErrorHandler);\n\t\tmodel.dispose();\n\t\tmainThread.dispose();\n\t\tinstantiationService.dispose();\n\n\t\treturn rpcProtocol.sync();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\t// --- outline\n\n\ttest('DocumentSymbols, register/deregister', async () => {\n\t\tassert.strictEqual(languageFeaturesService.documentSymbolProvider.all(model).length, 0);\n\t\tconst d1 = extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols() {\n\t\t\t\treturn <vscode.SymbolInformation[]>[];\n\t\t\t}\n\t\t});\n\n\t\tawait rpcProtocol.sync();\n\t\tassert.strictEqual(languageFeaturesService.documentSymbolProvider.all(model).length, 1);\n\t\td1.dispose();\n\t\treturn rpcProtocol.sync();\n\n\t});\n\n\ttest('DocumentSymbols, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\tthrow new Error('evil document symbol provider');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('test', types.SymbolKind.Field, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\ttest('DocumentSymbols, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentSymbolProvider {\n\t\t\tprovideDocumentSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('test', types.SymbolKind.Field, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst entry = value[0];\n\t\tassert.strictEqual(entry.name, 'test');\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Quick Outline uses a not ideal sorting, #138502', async function () {\n\t\tconst symbols = [\n\t\t\t{ name: 'containers', range: { startLineNumber: 1, startColumn: 1, endLineNumber: 4, endColumn: 26 } },\n\t\t\t{ name: 'container 0', range: { startLineNumber: 2, startColumn: 5, endLineNumber: 5, endColumn: 1 } },\n\t\t\t{ name: 'name', range: { startLineNumber: 2, startColumn: 5, endLineNumber: 2, endColumn: 16 } },\n\t\t\t{ name: 'ports', range: { startLineNumber: 3, startColumn: 5, endLineNumber: 5, endColumn: 1 } },\n\t\t\t{ name: 'ports 0', range: { startLineNumber: 4, startColumn: 9, endLineNumber: 4, endColumn: 26 } },\n\t\t\t{ name: 'containerPort', range: { startLineNumber: 4, startColumn: 9, endLineNumber: 4, endColumn: 26 } }\n\t\t];\n\n\t\tdisposables.add(extHost.registerDocumentSymbolProvider(defaultExtension, defaultSelector, {\n\t\t\tprovideDocumentSymbols: (doc, token): any => {\n\t\t\t\treturn symbols.map(s => {\n\t\t\t\t\treturn new types.SymbolInformation(\n\t\t\t\t\t\ts.name,\n\t\t\t\t\t\ttypes.SymbolKind.Object,\n\t\t\t\t\t\tnew types.Range(s.range.startLineNumber - 1, s.range.startColumn - 1, s.range.endLineNumber - 1, s.range.endColumn - 1)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\n\t\tconst value = (await OutlineModel.create(languageFeaturesService.documentSymbolProvider, model, CancellationToken.None)).asListOfDocumentSymbols();\n\n\t\tassert.strictEqual(value.length, 6);\n\t\tassert.deepStrictEqual(value.map(s => s.name), ['containers', 'container 0', 'name', 'ports', 'ports 0', 'containerPort']);\n\t});\n\n\t// --- code lens\n\n\ttest('CodeLens, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses() {\n\t\t\t\t\treturn [new types.CodeLens(new types.Range(0, 0, 0, 0))];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('CodeLens, do not resolve a resolved lens', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses(): any {\n\t\t\t\t\treturn [new types.CodeLens(\n\t\t\t\t\t\tnew types.Range(0, 0, 0, 0),\n\t\t\t\t\t\t{ command: 'id', title: 'Title' })];\n\t\t\t\t}\n\t\t\t\tresolveCodeLens(): any {\n\t\t\t\t\tassert.ok(false, 'do not resolve');\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tconst [data] = value.lenses;\n\t\t\tconst symbol = await Promise.resolve(data.provider.resolveCodeLens!(model, data.symbol, CancellationToken.None));\n\t\t\tassert.strictEqual(symbol!.command!.id, 'id');\n\t\t\tassert.strictEqual(symbol!.command!.title, 'Title');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('CodeLens, missing command', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeLensProvider(defaultExtension, defaultSelector, new class implements vscode.CodeLensProvider {\n\t\t\t\tprovideCodeLenses() {\n\t\t\t\t\treturn [new types.CodeLens(new types.Range(0, 0, 0, 0))];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeLensModel(languageFeaturesService.codeLensProvider, model, CancellationToken.None);\n\t\t\tassert.strictEqual(value.lenses.length, 1);\n\t\t\tconst [data] = value.lenses;\n\t\t\tconst symbol = await Promise.resolve(data.provider.resolveCodeLens!(model, data.symbol, CancellationToken.None));\n\t\t\tassert.strictEqual(symbol, undefined);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\t// --- definition\n\n\ttest('Definition, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\ttest('Definition, one or many', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 1, 1, 1))];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(model.uri, new types.Range(2, 1, 1, 1));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t});\n\n\ttest('Definition, registration order', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://first'), new types.Range(2, 3, 4, 5))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(URI.parse('far://second'), new types.Range(1, 2, 3, 4));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\t// let [first, second] = value;\n\t\tassert.strictEqual(value[0].uri.authority, 'second');\n\t\tassert.strictEqual(value[1].uri.authority, 'first');\n\t});\n\n\ttest('Definition, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\tthrow new Error('evil provider');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.DefinitionProvider {\n\t\t\tprovideDefinition(): any {\n\t\t\t\treturn new types.Location(model.uri, new types.Range(1, 1, 1, 1));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\t// -- declaration\n\n\ttest('Declaration, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDeclarationProvider(defaultExtension, defaultSelector, new class implements vscode.DeclarationProvider {\n\t\t\tprovideDeclaration(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- implementation\n\n\ttest('Implementation, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerImplementationProvider(defaultExtension, defaultSelector, new class implements vscode.ImplementationProvider {\n\t\t\tprovideImplementation(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- type definition\n\n\ttest('Type Definition, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerTypeDefinitionProvider(defaultExtension, defaultSelector, new class implements vscode.TypeDefinitionProvider {\n\t\t\tprovideTypeDefinition(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(1, 2, 3, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, new EditorPosition(1, 1), false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [entry] = value;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 2, startColumn: 3, endLineNumber: 4, endColumn: 5 });\n\t\tassert.strictEqual(entry.uri.toString(), model.uri.toString());\n\t});\n\n\t// --- extra info\n\n\ttest('HoverProvider, word range at pos', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t\tconst [entry] = hovers;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t});\n\n\n\ttest('HoverProvider, given range', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello', new types.Range(3, 0, 8, 7));\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t\tconst [entry] = hovers;\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 4, startColumn: 1, endLineNumber: 9, endColumn: 8 });\n\t});\n\n\n\ttest('HoverProvider, registration order', async () => {\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('registered first');\n\t\t\t}\n\t\t}));\n\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('registered second');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.contents[0].value, 'registered second');\n\t\tassert.strictEqual(second.contents[0].value, 'registered first');\n\t});\n\n\n\ttest('HoverProvider, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerHoverProvider(defaultExtension, defaultSelector, new class implements vscode.HoverProvider {\n\t\t\tprovideHover(): any {\n\t\t\t\treturn new types.Hover('Hello');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst hovers = await getHoversPromise(languageFeaturesService.hoverProvider, model, new EditorPosition(1, 1), CancellationToken.None);\n\t\tassert.strictEqual(hovers.length, 1);\n\t});\n\n\t// --- occurrences\n\n\ttest('Occurrences, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, order 1/2', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, '*', new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 5 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, order 2/2', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 2))];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, '*', new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None))!;\n\t\tassert.strictEqual(value.size, 1);\n\t\tconst [entry] = Array.from(value.values())[0];\n\t\tassert.deepStrictEqual(entry.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 3 });\n\t\tassert.strictEqual(entry.kind, languages.DocumentHighlightKind.Text);\n\t});\n\n\ttest('Occurrences, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentHighlightProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentHighlightProvider {\n\t\t\tprovideDocumentHighlights(): any {\n\t\t\t\treturn [new types.DocumentHighlight(new types.Range(0, 0, 0, 4))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, new EditorPosition(1, 2), CancellationToken.None);\n\t\tassert.strictEqual(value!.size, 1);\n\t});\n\n\t// --- references\n\n\ttest('References, registration order', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://register/first'), new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(URI.parse('far://register/second'), new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.uri.path, '/second');\n\t\tassert.strictEqual(second.uri.path, '/first');\n\t});\n\n\ttest('References, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Position(0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [item] = value;\n\t\tassert.deepStrictEqual(item.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t\tassert.strictEqual(item.uri.toString(), model.uri.toString());\n\t});\n\n\ttest('References, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerReferenceProvider(defaultExtension, defaultSelector, new class implements vscode.ReferenceProvider {\n\t\t\tprovideReferences(): any {\n\t\t\t\treturn [new types.Location(model.uri, new types.Range(0, 0, 0, 0))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, new EditorPosition(1, 2), false, false, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t});\n\n\t// --- quick fix\n\n\ttest('Quick Fix, command data conversion', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, {\n\t\t\t\tprovideCodeActions(): vscode.Command[] {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{ command: 'test1', title: 'Testing1' },\n\t\t\t\t\t\t{ command: 'test2', title: 'Testing2' }\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.QuickFix }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 2);\n\t\t\tconst [first, second] = actions;\n\t\t\tassert.strictEqual(first.action.title, 'Testing1');\n\t\t\tassert.strictEqual(first.action.command!.id, 'test1');\n\t\t\tassert.strictEqual(second.action.title, 'Testing2');\n\t\t\tassert.strictEqual(second.action.command!.id, 'test2');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('Quick Fix, code action data conversion', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, {\n\t\t\t\tprovideCodeActions(): vscode.CodeAction[] {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Testing1',\n\t\t\t\t\t\t\tcommand: { title: 'Testing1Command', command: 'test1' },\n\t\t\t\t\t\t\tkind: types.CodeActionKind.Empty.append('test.scope')\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.Default }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tconst [first] = actions;\n\t\t\tassert.strictEqual(first.action.title, 'Testing1');\n\t\t\tassert.strictEqual(first.action.command!.title, 'Testing1Command');\n\t\t\tassert.strictEqual(first.action.command!.id, 'test1');\n\t\t\tassert.strictEqual(first.action.kind, 'test.scope');\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\n\ttest('Cannot read property \\'id\\' of undefined, #29469', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\treturn [\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t{ command: 'test', title: 'Testing' }\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.Default }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\ttest('Quick Fix, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(extHost.registerCodeActionProvider(defaultExtension, defaultSelector, new class implements vscode.CodeActionProvider {\n\t\t\t\tprovideCodeActions(): any {\n\t\t\t\t\treturn [{ command: 'test', title: 'Testing' }];\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await getCodeActions(languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.QuickFix }, Progress.None, CancellationToken.None);\n\t\t\tconst { validActions: actions } = value;\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tvalue.dispose();\n\t\t});\n\t});\n\n\t// --- navigate types\n\n\ttest('Navigate types, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('testing', types.SymbolKind.Array, new types.Range(0, 0, 1, 1))];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getWorkspaceSymbols('');\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.symbol.name, 'testing');\n\t});\n\n\ttest('Navigate types, de-duplicate results', async () => {\n\t\tconst uri = URI.from({ scheme: 'foo', path: '/some/path' });\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))]; // get de-duped\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Array, undefined, new types.Location(uri, undefined!))]; // NO dedupe because of resolve\n\t\t\t}\n\t\t\tresolveWorkspaceSymbol(a: vscode.SymbolInformation) {\n\t\t\t\treturn a;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerWorkspaceSymbolProvider(defaultExtension, new class implements vscode.WorkspaceSymbolProvider {\n\t\t\tprovideWorkspaceSymbols(): any {\n\t\t\t\treturn [new types.SymbolInformation('ONE', types.SymbolKind.Struct, undefined, new types.Location(uri, new types.Range(0, 0, 1, 1)))]; // NO dedupe because of kind\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getWorkspaceSymbols('');\n\t\tassert.strictEqual(value.length, 3);\n\t});\n\n\t// --- rename\n\n\ttest('Rename, evil provider 0/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow new class Foo { };\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\ttry {\n\t\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\t\tthrow Error();\n\t\t}\n\t\tcatch (err) {\n\t\t\t// expected\n\t\t}\n\t});\n\n\ttest('Rename, evil provider 1/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\tassert.strictEqual(value.rejectReason, 'evil');\n\t});\n\n\ttest('Rename, evil provider 2/2', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, '*', new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tthrow Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tconst edit = new types.WorkspaceEdit();\n\t\t\t\tedit.replace(model.uri, new types.Range(0, 0, 0, 0), 'testing');\n\t\t\t\treturn edit;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\tassert.strictEqual(value.edits.length, 1);\n\t});\n\n\ttest('Rename, ordering', async () => {\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, '*', new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\tconst edit = new types.WorkspaceEdit();\n\t\t\t\tedit.replace(model.uri, new types.Range(0, 0, 0, 0), 'testing');\n\t\t\t\tedit.replace(model.uri, new types.Range(1, 0, 1, 0), 'testing');\n\t\t\t\treturn edit;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprovideRenameEdits(): any {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\t\t// least relevant rename provider\n\t\tassert.strictEqual(value.edits.length, 2);\n\t});\n\n\ttest('Multiple RenameProviders don\\'t respect all possible PrepareRename handlers 1/2, #98352', async function () {\n\n\t\tconst called = [false, false, false, false];\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[0] = true;\n\t\t\t\tconst range = document.getWordRangeAtPosition(position);\n\t\t\t\treturn range;\n\t\t\t}\n\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[1] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[2] = true;\n\t\t\t\treturn Promise.reject('Cannot rename this symbol2.');\n\t\t\t}\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[3] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\n\t\tassert.deepStrictEqual(called, [true, true, true, false]);\n\t});\n\n\ttest('Multiple RenameProviders don\\'t respect all possible PrepareRename handlers 2/2, #98352', async function () {\n\n\t\tconst called = [false, false, false];\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\t\t\tprepareRename(document: vscode.TextDocument, position: vscode.Position,): vscode.ProviderResult<vscode.Range> {\n\t\t\t\tcalled[0] = true;\n\t\t\t\tconst range = document.getWordRangeAtPosition(position);\n\t\t\t\treturn range;\n\t\t\t}\n\n\t\t\tprovideRenameEdits(): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[1] = true;\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerRenameProvider(defaultExtension, defaultSelector, new class implements vscode.RenameProvider {\n\n\t\t\tprovideRenameEdits(document: vscode.TextDocument, position: vscode.Position, newName: string,): vscode.ProviderResult<vscode.WorkspaceEdit> {\n\t\t\t\tcalled[2] = true;\n\t\t\t\treturn new types.WorkspaceEdit();\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tawait rename(languageFeaturesService.renameProvider, model, new EditorPosition(1, 1), 'newName');\n\n\t\t// first provider has NO prepare which means it is taken by default\n\t\tassert.deepStrictEqual(called, [false, false, true]);\n\t});\n\n\t// --- parameter hints\n\n\ttest('Parameter Hints, order', async () => {\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}, []));\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): vscode.SignatureHelp {\n\t\t\t\treturn {\n\t\t\t\t\tsignatures: [],\n\t\t\t\t\tactiveParameter: 0,\n\t\t\t\t\tactiveSignature: 0\n\t\t\t\t};\n\t\t\t}\n\t\t}, []));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, model, new EditorPosition(1, 1), { triggerKind: languages.SignatureHelpTriggerKind.Invoke, isRetrigger: false }, CancellationToken.None);\n\t\tassert.ok(value);\n\t});\n\n\ttest('Parameter Hints, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerSignatureHelpProvider(defaultExtension, defaultSelector, new class implements vscode.SignatureHelpProvider {\n\t\t\tprovideSignatureHelp(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}, []));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, model, new EditorPosition(1, 1), { triggerKind: languages.SignatureHelpTriggerKind.Invoke, isRetrigger: false }, CancellationToken.None);\n\t\tassert.strictEqual(value, undefined);\n\t});\n\n\t// --- suggestions\n\n\ttest('Suggest, order 1/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, '*', new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing1')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing2')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 1);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'testing2');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, order 2/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, '*', new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('weak-selector')]; // weaker selector but result\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn []; // stronger selector but not a good result;\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 1);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'weak-selector');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, order 3/3', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('strong-1')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('strong-2')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items.length, 2);\n\t\t\tassert.strictEqual(value.items[0].completion.insertText, 'strong-1'); // sort by label\n\t\t\tassert.strictEqual(value.items[1].completion.insertText, 'strong-2');\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, evil provider', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\tthrow new Error('evil');\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\treturn [new types.CompletionItem('testing')];\n\t\t\t\t}\n\t\t\t}, []));\n\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tconst value = await provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet)));\n\t\t\tassert.strictEqual(value.items[0].container.incomplete, false);\n\t\t\tvalue.disposable.dispose();\n\t\t});\n\t});\n\n\ttest('Suggest, CompletionList', async () => {\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tdisposables.add(extHost.registerCompletionItemProvider(defaultExtension, defaultSelector, new class implements vscode.CompletionItemProvider {\n\t\t\t\tprovideCompletionItems(): any {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\treturn new types.CompletionList([<any>new types.CompletionItem('hello')], true);\n\t\t\t\t}\n\t\t\t}, []));\n\n\t\t\tawait rpcProtocol.sync();\n\t\t\tawait provideSuggestionItems(languageFeaturesService.completionProvider, model, new EditorPosition(1, 1), new CompletionOptions(undefined, new Set<languages.CompletionItemKind>().add(languages.CompletionItemKind.Snippet))).then(model => {\n\t\t\t\tassert.strictEqual(model.items[0].container.incomplete, true);\n\t\t\t\tmodel.disposable.dispose();\n\t\t\t});\n\t\t});\n\t});\n\n\t// --- format\n\n\tconst NullWorkerService = new class extends mock<IEditorWorkerService>() {\n\t\toverride computeMoreMinimalEdits(resource: URI, edits: languages.TextEdit[] | null | undefined): Promise<languages.TextEdit[] | undefined> {\n\t\t\treturn Promise.resolve(edits ?? undefined);\n\t\t}\n\t};\n\n\ttest('Format Doc, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing'), types.TextEdit.setEndOfLine(types.EndOfLine.LF)];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 2);\n\t\tconst [first, second] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t\tassert.strictEqual(second.eol, EndOfLineSequence.LF);\n\t\tassert.strictEqual(second.text, '');\n\t\tassert.deepStrictEqual(second.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Doc, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\treturn getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None);\n\t});\n\n\ttest('Format Doc, order', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing')];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Range, data conversion', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'testing')];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'testing');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Format Range, + format_doc', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), 'range')];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(2, 3, 4, 5), 'range2')];\n\t\t\t}\n\t\t}));\n\t\tdisposables.add(extHost.registerDocumentFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentFormattingEditProvider {\n\t\t\tprovideDocumentFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 1, 1), 'doc')];\n\t\t\t}\n\t\t}));\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, 'range2');\n\t\tassert.strictEqual(first.range.startLineNumber, 3);\n\t\tassert.strictEqual(first.range.startColumn, 4);\n\t\tassert.strictEqual(first.range.endLineNumber, 5);\n\t\tassert.strictEqual(first.range.endColumn, 6);\n\t});\n\n\ttest('Format Range, evil provider', async () => {\n\t\tdisposables.add(extHost.registerDocumentRangeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentRangeFormattingEditProvider {\n\t\t\tprovideDocumentRangeFormattingEdits(): any {\n\t\t\t\tthrow new Error('evil');\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\treturn getDocumentRangeFormattingEditsUntilResult(NullWorkerService, languageFeaturesService, model, new EditorRange(1, 1, 1, 1), { insertSpaces: true, tabSize: 4 }, CancellationToken.None);\n\t});\n\n\ttest('Format on Type, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerOnTypeFormattingEditProvider(defaultExtension, defaultSelector, new class implements vscode.OnTypeFormattingEditProvider {\n\t\t\tprovideOnTypeFormattingEdits(): any {\n\t\t\t\treturn [new types.TextEdit(new types.Range(0, 0, 0, 0), arguments[2])];\n\t\t\t}\n\t\t}, [';']));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = (await getOnTypeFormattingEdits(NullWorkerService, languageFeaturesService, model, new EditorPosition(1, 1), ';', { insertSpaces: true, tabSize: 2 }, CancellationToken.None))!;\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.strictEqual(first.text, ';');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 });\n\t});\n\n\ttest('Links, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks() {\n\t\t\t\tconst link = new types.DocumentLink(new types.Range(0, 0, 1, 1), URI.parse('foo:bar#3'));\n\t\t\t\tlink.tooltip = 'tooltip';\n\t\t\t\treturn [link];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst { links } = disposables.add(await getLinks(languageFeaturesService.linkProvider, model, CancellationToken.None));\n\t\tassert.strictEqual(links.length, 1);\n\t\tconst [first] = links;\n\t\tassert.strictEqual(first.url?.toString(), 'foo:bar#3');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 2, endColumn: 2 });\n\t\tassert.strictEqual(first.tooltip, 'tooltip');\n\t});\n\n\ttest('Links, evil provider', async () => {\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks() {\n\t\t\t\treturn [new types.DocumentLink(new types.Range(0, 0, 1, 1), URI.parse('foo:bar#3'))];\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(extHost.registerDocumentLinkProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentLinkProvider {\n\t\t\tprovideDocumentLinks(): any {\n\t\t\t\tthrow new Error();\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst { links } = disposables.add(await getLinks(languageFeaturesService.linkProvider, model, CancellationToken.None));\n\t\tassert.strictEqual(links.length, 1);\n\t\tconst [first] = links;\n\t\tassert.strictEqual(first.url?.toString(), 'foo:bar#3');\n\t\tassert.deepStrictEqual(first.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 2, endColumn: 2 });\n\t});\n\n\ttest('Document colors, data conversion', async () => {\n\n\t\tdisposables.add(extHost.registerColorProvider(defaultExtension, defaultSelector, new class implements vscode.DocumentColorProvider {\n\t\t\tprovideDocumentColors(): vscode.ColorInformation[] {\n\t\t\t\treturn [new types.ColorInformation(new types.Range(0, 0, 0, 20), new types.Color(0.1, 0.2, 0.3, 0.4))];\n\t\t\t}\n\t\t\tprovideColorPresentations(color: vscode.Color, context: { range: vscode.Range; document: vscode.TextDocument }): vscode.ColorPresentation[] {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\t\tconst value = await getColors(languageFeaturesService.colorProvider, model, CancellationToken.None);\n\t\tassert.strictEqual(value.length, 1);\n\t\tconst [first] = value;\n\t\tassert.deepStrictEqual(first.colorInfo.color, { red: 0.1, green: 0.2, blue: 0.3, alpha: 0.4 });\n\t\tassert.deepStrictEqual(first.colorInfo.range, { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 21 });\n\t});\n\n\t// -- selection ranges\n\n\ttest('Selection Ranges, data conversion', async () => {\n\t\tdisposables.add(extHost.registerSelectionRangeProvider(defaultExtension, defaultSelector, new class implements vscode.SelectionRangeProvider {\n\t\t\tprovideSelectionRanges() {\n\t\t\t\treturn [\n\t\t\t\t\tnew types.SelectionRange(new types.Range(0, 10, 0, 18), new types.SelectionRange(new types.Range(0, 2, 0, 20))),\n\t\t\t\t];\n\t\t\t}\n\t\t}));\n\n\t\tawait rpcProtocol.sync();\n\n\t\tprovideSelectionRanges(languageFeaturesService.selectionRangeProvider, model, [new Position(1, 17)], { selectLeadingAndTrailingWhitespace: true, selectSubwords: true }, CancellationToken.None).then(ranges => {\n\t\t\tassert.strictEqual(ranges.length, 1);\n\t\t\tassert.ok(ranges[0].length >= 2);\n\t\t});\n\t});\n\n\ttest('Selection Ranges, bad data', async () => {\n\n\t\ttry {\n\t\t\tconst _a = new types.SelectionRange(new types.Range(0, 10, 0, 18),\n\t\t\t\tnew types.SelectionRange(new types.Range(0, 11, 0, 18))\n\t\t\t);\n\t\t\tassert.ok(false, String(_a));\n\t\t} catch (err) {\n\t\t\tassert.ok(true);\n\t\t}\n\n\t});\n});\n"]}