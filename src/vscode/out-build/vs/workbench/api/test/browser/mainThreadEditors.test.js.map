{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/mainThreadEditors.test.ts","vs/workbench/api/test/browser/mainThreadEditors.test.ts"],"names":[],"mappings":"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","file":"mainThreadEditors.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../base/common/event.js';\nimport { DisposableStore, IReference, ImmortalReference } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IBulkEditService } from '../../../../editor/browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { EditOperation, ISingleEditOperation } from '../../../../editor/common/core/editOperation.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { EndOfLineSequence, ITextSnapshot } from '../../../../editor/common/model.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { LanguageService } from '../../../../editor/common/services/languageService.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { ModelService } from '../../../../editor/common/services/modelService.js';\nimport { IResolvedTextEditorModel, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { ITreeSitterLibraryService } from '../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { TestCodeEditorService } from '../../../../editor/test/browser/editorTestServices.js';\nimport { TestLanguageConfigurationService } from '../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { TestTreeSitterLibraryService } from '../../../../editor/test/common/services/testTreeSitterLibraryService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { TestDialogService } from '../../../../platform/dialogs/test/common/testDialogService.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { SyncDescriptor } from '../../../../platform/instantiation/common/descriptors.js';\nimport { InstantiationService } from '../../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { TestNotificationService } from '../../../../platform/notification/test/common/testNotificationService.js';\nimport { TestThemeService } from '../../../../platform/theme/test/common/testThemeService.js';\nimport { IUndoRedoService } from '../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../platform/undoRedo/common/undoRedoService.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { BulkEditService } from '../../../contrib/bulkEdit/browser/bulkEditService.js';\nimport { IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { SerializableObjectWithBuffers } from '../../../services/extensions/common/proxyIdentifier.js';\nimport { LabelService } from '../../../services/label/common/labelService.js';\nimport { ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IPaneCompositePartService } from '../../../services/panecomposite/browser/panecomposite.js';\nimport { ITextFileService } from '../../../services/textfile/common/textfiles.js';\nimport { ICopyOperation, ICreateFileOperation, ICreateOperation, IDeleteOperation, IMoveOperation, IWorkingCopyFileService } from '../../../services/workingCopy/common/workingCopyFileService.js';\nimport { IWorkingCopyService } from '../../../services/workingCopy/common/workingCopyService.js';\nimport { TestEditorGroupsService, TestEditorService, TestEnvironmentService, TestLifecycleService, TestWorkingCopyService } from '../../../test/browser/workbenchTestServices.js';\nimport { TestContextService, TestFileService, TestTextResourcePropertiesService } from '../../../test/common/workbenchTestServices.js';\nimport { MainThreadBulkEdits } from '../../browser/mainThreadBulkEdits.js';\nimport { MainThreadTextEditors, IMainThreadEditorLocator } from '../../browser/mainThreadEditors.js';\nimport { MainThreadTextEditor } from '../../browser/mainThreadEditor.js';\nimport { MainThreadDocuments } from '../../browser/mainThreadDocuments.js';\nimport { IWorkspaceTextEditDto } from '../../common/extHost.protocol.js';\nimport { SingleProxyRPCProtocol } from '../common/testRPCProtocol.js';\nimport { ITextResourcePropertiesService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { TestClipboardService } from '../../../../platform/clipboard/test/common/testClipboardService.js';\nimport { createTestCodeEditor } from '../../../../editor/test/browser/testCodeEditor.js';\n\nsuite('MainThreadEditors', () => {\n\n\tlet disposables: DisposableStore;\n\tconst existingResource = URI.parse('foo:existing');\n\tconst resource = URI.parse('foo:bar');\n\n\tlet modelService: IModelService;\n\n\tlet bulkEdits: MainThreadBulkEdits;\n\tlet editors: MainThreadTextEditors;\n\tlet editorLocator: IMainThreadEditorLocator;\n\tlet testEditor: MainThreadTextEditor;\n\n\tconst movedResources = new Map<URI, URI>();\n\tconst copiedResources = new Map<URI, URI>();\n\tconst createdResources = new Set<URI>();\n\tconst deletedResources = new Set<URI>();\n\n\tconst editorId = 'testEditorId';\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\n\t\tmovedResources.clear();\n\t\tcopiedResources.clear();\n\t\tcreatedResources.clear();\n\t\tdeletedResources.clear();\n\n\t\tconst configService = new TestConfigurationService();\n\t\tconst dialogService = new TestDialogService();\n\t\tconst notificationService = new TestNotificationService();\n\t\tconst undoRedoService = new UndoRedoService(dialogService, notificationService);\n\t\tconst themeService = new TestThemeService();\n\n\t\tconst services = new ServiceCollection();\n\t\tservices.set(IBulkEditService, new SyncDescriptor(BulkEditService));\n\t\tservices.set(ILabelService, new SyncDescriptor(LabelService));\n\t\tservices.set(ILogService, new NullLogService());\n\t\tservices.set(IWorkspaceContextService, new TestContextService());\n\t\tservices.set(IEnvironmentService, TestEnvironmentService);\n\t\tservices.set(IWorkbenchEnvironmentService, TestEnvironmentService);\n\t\tservices.set(IConfigurationService, configService);\n\t\tservices.set(IDialogService, dialogService);\n\t\tservices.set(INotificationService, notificationService);\n\t\tservices.set(IUndoRedoService, undoRedoService);\n\t\tservices.set(ITextResourcePropertiesService, new SyncDescriptor(TestTextResourcePropertiesService));\n\t\tservices.set(IModelService, new SyncDescriptor(ModelService));\n\t\tservices.set(ICodeEditorService, new TestCodeEditorService(themeService));\n\t\tservices.set(IFileService, new TestFileService());\n\t\tservices.set(IUriIdentityService, new SyncDescriptor(UriIdentityService));\n\t\tservices.set(ITreeSitterLibraryService, new TestTreeSitterLibraryService());\n\t\tservices.set(IEditorService, disposables.add(new TestEditorService()));\n\t\tservices.set(ILifecycleService, new TestLifecycleService());\n\t\tservices.set(IWorkingCopyService, new TestWorkingCopyService());\n\t\tservices.set(IEditorGroupsService, new TestEditorGroupsService());\n\t\tservices.set(IClipboardService, new TestClipboardService());\n\t\tservices.set(ITextFileService, new class extends mock<ITextFileService>() {\n\t\t\toverride isDirty() { return false; }\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\toverride files = <any>{\n\t\t\t\tonDidSave: Event.None,\n\t\t\t\tonDidRevert: Event.None,\n\t\t\t\tonDidChangeDirty: Event.None,\n\t\t\t\tonDidChangeEncoding: Event.None\n\t\t\t};\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\toverride untitled = <any>{\n\t\t\t\tonDidChangeEncoding: Event.None\n\t\t\t};\n\t\t\toverride create(operations: { resource: URI }[]) {\n\t\t\t\tfor (const o of operations) {\n\t\t\t\t\tcreatedResources.add(o.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride async getEncodedReadable(resource: URI, value?: string | ITextSnapshot): Promise<any> {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\t\tservices.set(IWorkingCopyFileService, new class extends mock<IWorkingCopyFileService>() {\n\t\t\toverride onDidRunWorkingCopyFileOperation = Event.None;\n\t\t\toverride createFolder(operations: ICreateOperation[]): any {\n\t\t\t\tthis.create(operations);\n\t\t\t}\n\t\t\toverride create(operations: ICreateFileOperation[]) {\n\t\t\t\tfor (const operation of operations) {\n\t\t\t\t\tcreatedResources.add(operation.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride move(operations: IMoveOperation[]) {\n\t\t\t\tconst { source, target } = operations[0].file;\n\t\t\t\tmovedResources.set(source, target);\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride copy(operations: ICopyOperation[]) {\n\t\t\t\tconst { source, target } = operations[0].file;\n\t\t\t\tcopiedResources.set(source, target);\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride delete(operations: IDeleteOperation[]) {\n\t\t\t\tfor (const operation of operations) {\n\t\t\t\t\tdeletedResources.add(operation.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\t\t});\n\t\tservices.set(ITextModelService, new class extends mock<ITextModelService>() {\n\t\t\toverride createModelReference(resource: URI): Promise<IReference<IResolvedTextEditorModel>> {\n\t\t\t\tconst textEditorModel = new class extends mock<IResolvedTextEditorModel>() {\n\t\t\t\t\toverride textEditorModel = modelService.getModel(resource)!;\n\t\t\t\t};\n\t\t\t\ttextEditorModel.isReadonly = () => false;\n\t\t\t\treturn Promise.resolve(new ImmortalReference(textEditorModel));\n\t\t\t}\n\t\t});\n\t\tservices.set(IEditorWorkerService, new class extends mock<IEditorWorkerService>() {\n\n\t\t});\n\t\tservices.set(IPaneCompositePartService, new class extends mock<IPaneCompositePartService>() implements IPaneCompositePartService {\n\t\t\toverride onDidPaneCompositeOpen = Event.None;\n\t\t\toverride onDidPaneCompositeClose = Event.None;\n\t\t\toverride getActivePaneComposite() {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\n\t\tservices.set(ILanguageService, disposables.add(new LanguageService()));\n\t\tservices.set(ILanguageConfigurationService, new TestLanguageConfigurationService());\n\n\t\tconst instaService = new InstantiationService(services);\n\n\t\tbulkEdits = instaService.createInstance(MainThreadBulkEdits, SingleProxyRPCProtocol(null));\n\t\tconst documents = instaService.createInstance(MainThreadDocuments, SingleProxyRPCProtocol(null));\n\n\t\t// Create editor locator\n\t\teditorLocator = {\n\t\t\tgetEditor(id: string): MainThreadTextEditor | undefined {\n\t\t\t\treturn id === editorId ? testEditor : undefined;\n\t\t\t},\n\t\t\tfindTextEditorIdFor() { return undefined; },\n\t\t\tgetIdOfCodeEditor() { return undefined; }\n\t\t};\n\n\t\teditors = instaService.createInstance(MainThreadTextEditors, editorLocator, SingleProxyRPCProtocol(null));\n\t\tmodelService = instaService.invokeFunction(accessor => accessor.get(IModelService));\n\n\t\t// Create a test code editor using the helper\n\t\tconst model = modelService.createModel('Hello world!', null, existingResource);\n\t\tconst testCodeEditor = disposables.add(createTestCodeEditor(model));\n\n\t\ttestEditor = disposables.add(instaService.createInstance(\n\t\t\tMainThreadTextEditor,\n\t\t\teditorId,\n\t\t\tmodel,\n\t\t\ttestCodeEditor,\n\t\t\t{ onGainedFocus() { }, onLostFocus() { } },\n\t\t\tdocuments\n\t\t));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest(`applyWorkspaceEdit returns false if model is changed by user`, () => {\n\n\t\tconst model = disposables.add(modelService.createModel('something', null, resource));\n\n\t\tconst workspaceResourceEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\n\t\t// Act as if the user edited the model\n\t\tmodel.applyEdits([EditOperation.insert(new Position(0, 0), 'something')]);\n\n\t\treturn bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit] })).then((result) => {\n\t\t\tassert.strictEqual(result, false);\n\t\t});\n\t});\n\n\ttest(`issue #54773: applyWorkspaceEdit checks model version in race situation`, () => {\n\n\t\tconst model = disposables.add(modelService.createModel('something', null, resource));\n\n\t\tconst workspaceResourceEdit1: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\t\tconst workspaceResourceEdit2: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\n\t\tconst p1 = bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit1] })).then((result) => {\n\t\t\t// first edit request succeeds\n\t\t\tassert.strictEqual(result, true);\n\t\t});\n\t\tconst p2 = bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit2] })).then((result) => {\n\t\t\t// second edit request fails\n\t\t\tassert.strictEqual(result, false);\n\t\t});\n\t\treturn Promise.all([p1, p2]);\n\t});\n\n\ttest('applyWorkspaceEdit: noop eol edit keeps undo stack clean', async () => {\n\n\t\tconst initialText = 'hello\\nworld';\n\t\tconst model = disposables.add(modelService.createModel(initialText, null, resource));\n\t\tconst initialAlternativeVersionId = model.getAlternativeVersionId();\n\n\t\tconst insertEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\trange: new Range(1, 6, 1, 6),\n\t\t\t\ttext: '2'\n\t\t\t}\n\t\t};\n\n\t\tconst insertResult = await bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [insertEdit] }));\n\t\tassert.strictEqual(insertResult, true);\n\t\tassert.strictEqual(model.getValue(), 'hello2\\nworld');\n\t\tassert.notStrictEqual(model.getAlternativeVersionId(), initialAlternativeVersionId);\n\n\t\tconst eolEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\trange: new Range(1, 1, 1, 1),\n\t\t\t\ttext: '',\n\t\t\t\teol: EndOfLineSequence.LF\n\t\t\t}\n\t\t};\n\n\t\tconst eolResult = await bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [eolEdit] }));\n\t\tassert.strictEqual(eolResult, true);\n\t\tassert.strictEqual(model.getValue(), 'hello2\\nworld');\n\n\t\tconst undoResult = model.undo();\n\t\tif (undoResult) {\n\t\t\tawait undoResult;\n\t\t}\n\t\tassert.strictEqual(model.getValue(), initialText);\n\t\tassert.strictEqual(model.getAlternativeVersionId(), initialAlternativeVersionId);\n\t});\n\n\ttest(`applyWorkspaceEdit with only resource edit`, () => {\n\t\treturn bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({\n\t\t\tedits: [\n\t\t\t\t{ oldResource: resource, newResource: resource, options: undefined },\n\t\t\t\t{ oldResource: undefined, newResource: resource, options: undefined },\n\t\t\t\t{ oldResource: resource, newResource: undefined, options: undefined }\n\t\t\t]\n\t\t})).then((result) => {\n\t\t\tassert.strictEqual(result, true);\n\t\t\tassert.strictEqual(movedResources.get(resource), resource);\n\t\t\tassert.strictEqual(createdResources.has(resource), true);\n\t\t\tassert.strictEqual(deletedResources.has(resource), true);\n\t\t});\n\t});\n\n\ttest('applyWorkspaceEdit can control undo/redo stack 1', async () => {\n\t\tconst model = modelService.getModel(existingResource)!;\n\n\t\tconst edit1: ISingleEditOperation = {\n\t\t\trange: new Range(1, 1, 1, 2),\n\t\t\ttext: 'h',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied1 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit1], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied1, true);\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\n\t\tconst edit2: ISingleEditOperation = {\n\t\t\trange: new Range(1, 2, 1, 6),\n\t\t\ttext: 'ELLO',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied2 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit2], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied2, true);\n\t\tassert.strictEqual(model.getValue(), 'hELLO world!');\n\n\t\tawait model.undo();\n\t\tassert.strictEqual(model.getValue(), 'Hello world!');\n\t});\n\n\ttest('applyWorkspaceEdit can control undo/redo stack 2', async () => {\n\t\tconst model = modelService.getModel(existingResource)!;\n\n\t\tconst edit1: ISingleEditOperation = {\n\t\t\trange: new Range(1, 1, 1, 2),\n\t\t\ttext: 'h',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied1 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit1], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied1, true);\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\n\t\tconst edit2: ISingleEditOperation = {\n\t\t\trange: new Range(1, 2, 1, 6),\n\t\t\ttext: 'ELLO',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied2 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit2], { undoStopBefore: true, undoStopAfter: false });\n\t\tassert.strictEqual(applied2, true);\n\t\tassert.strictEqual(model.getValue(), 'hELLO world!');\n\n\t\tawait model.undo();\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../base/common/event.js';\nimport { DisposableStore, IReference, ImmortalReference } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { IBulkEditService } from '../../../../editor/browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { EditOperation, ISingleEditOperation } from '../../../../editor/common/core/editOperation.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { EndOfLineSequence, ITextSnapshot } from '../../../../editor/common/model.js';\nimport { IEditorWorkerService } from '../../../../editor/common/services/editorWorker.js';\nimport { LanguageService } from '../../../../editor/common/services/languageService.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { ModelService } from '../../../../editor/common/services/modelService.js';\nimport { IResolvedTextEditorModel, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { ITreeSitterLibraryService } from '../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { TestCodeEditorService } from '../../../../editor/test/browser/editorTestServices.js';\nimport { TestLanguageConfigurationService } from '../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { TestTreeSitterLibraryService } from '../../../../editor/test/common/services/testTreeSitterLibraryService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { TestDialogService } from '../../../../platform/dialogs/test/common/testDialogService.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { SyncDescriptor } from '../../../../platform/instantiation/common/descriptors.js';\nimport { InstantiationService } from '../../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { TestNotificationService } from '../../../../platform/notification/test/common/testNotificationService.js';\nimport { TestThemeService } from '../../../../platform/theme/test/common/testThemeService.js';\nimport { IUndoRedoService } from '../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../platform/undoRedo/common/undoRedoService.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { BulkEditService } from '../../../contrib/bulkEdit/browser/bulkEditService.js';\nimport { IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { SerializableObjectWithBuffers } from '../../../services/extensions/common/proxyIdentifier.js';\nimport { LabelService } from '../../../services/label/common/labelService.js';\nimport { ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IPaneCompositePartService } from '../../../services/panecomposite/browser/panecomposite.js';\nimport { ITextFileService } from '../../../services/textfile/common/textfiles.js';\nimport { ICopyOperation, ICreateFileOperation, ICreateOperation, IDeleteOperation, IMoveOperation, IWorkingCopyFileService } from '../../../services/workingCopy/common/workingCopyFileService.js';\nimport { IWorkingCopyService } from '../../../services/workingCopy/common/workingCopyService.js';\nimport { TestEditorGroupsService, TestEditorService, TestEnvironmentService, TestLifecycleService, TestWorkingCopyService } from '../../../test/browser/workbenchTestServices.js';\nimport { TestContextService, TestFileService, TestTextResourcePropertiesService } from '../../../test/common/workbenchTestServices.js';\nimport { MainThreadBulkEdits } from '../../browser/mainThreadBulkEdits.js';\nimport { MainThreadTextEditors, IMainThreadEditorLocator } from '../../browser/mainThreadEditors.js';\nimport { MainThreadTextEditor } from '../../browser/mainThreadEditor.js';\nimport { MainThreadDocuments } from '../../browser/mainThreadDocuments.js';\nimport { IWorkspaceTextEditDto } from '../../common/extHost.protocol.js';\nimport { SingleProxyRPCProtocol } from '../common/testRPCProtocol.js';\nimport { ITextResourcePropertiesService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { TestClipboardService } from '../../../../platform/clipboard/test/common/testClipboardService.js';\nimport { createTestCodeEditor } from '../../../../editor/test/browser/testCodeEditor.js';\n\nsuite('MainThreadEditors', () => {\n\n\tlet disposables: DisposableStore;\n\tconst existingResource = URI.parse('foo:existing');\n\tconst resource = URI.parse('foo:bar');\n\n\tlet modelService: IModelService;\n\n\tlet bulkEdits: MainThreadBulkEdits;\n\tlet editors: MainThreadTextEditors;\n\tlet editorLocator: IMainThreadEditorLocator;\n\tlet testEditor: MainThreadTextEditor;\n\n\tconst movedResources = new Map<URI, URI>();\n\tconst copiedResources = new Map<URI, URI>();\n\tconst createdResources = new Set<URI>();\n\tconst deletedResources = new Set<URI>();\n\n\tconst editorId = 'testEditorId';\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\n\t\tmovedResources.clear();\n\t\tcopiedResources.clear();\n\t\tcreatedResources.clear();\n\t\tdeletedResources.clear();\n\n\t\tconst configService = new TestConfigurationService();\n\t\tconst dialogService = new TestDialogService();\n\t\tconst notificationService = new TestNotificationService();\n\t\tconst undoRedoService = new UndoRedoService(dialogService, notificationService);\n\t\tconst themeService = new TestThemeService();\n\n\t\tconst services = new ServiceCollection();\n\t\tservices.set(IBulkEditService, new SyncDescriptor(BulkEditService));\n\t\tservices.set(ILabelService, new SyncDescriptor(LabelService));\n\t\tservices.set(ILogService, new NullLogService());\n\t\tservices.set(IWorkspaceContextService, new TestContextService());\n\t\tservices.set(IEnvironmentService, TestEnvironmentService);\n\t\tservices.set(IWorkbenchEnvironmentService, TestEnvironmentService);\n\t\tservices.set(IConfigurationService, configService);\n\t\tservices.set(IDialogService, dialogService);\n\t\tservices.set(INotificationService, notificationService);\n\t\tservices.set(IUndoRedoService, undoRedoService);\n\t\tservices.set(ITextResourcePropertiesService, new SyncDescriptor(TestTextResourcePropertiesService));\n\t\tservices.set(IModelService, new SyncDescriptor(ModelService));\n\t\tservices.set(ICodeEditorService, new TestCodeEditorService(themeService));\n\t\tservices.set(IFileService, new TestFileService());\n\t\tservices.set(IUriIdentityService, new SyncDescriptor(UriIdentityService));\n\t\tservices.set(ITreeSitterLibraryService, new TestTreeSitterLibraryService());\n\t\tservices.set(IEditorService, disposables.add(new TestEditorService()));\n\t\tservices.set(ILifecycleService, new TestLifecycleService());\n\t\tservices.set(IWorkingCopyService, new TestWorkingCopyService());\n\t\tservices.set(IEditorGroupsService, new TestEditorGroupsService());\n\t\tservices.set(IClipboardService, new TestClipboardService());\n\t\tservices.set(ITextFileService, new class extends mock<ITextFileService>() {\n\t\t\toverride isDirty() { return false; }\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\toverride files = <any>{\n\t\t\t\tonDidSave: Event.None,\n\t\t\t\tonDidRevert: Event.None,\n\t\t\t\tonDidChangeDirty: Event.None,\n\t\t\t\tonDidChangeEncoding: Event.None\n\t\t\t};\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\toverride untitled = <any>{\n\t\t\t\tonDidChangeEncoding: Event.None\n\t\t\t};\n\t\t\toverride create(operations: { resource: URI }[]) {\n\t\t\t\tfor (const o of operations) {\n\t\t\t\t\tcreatedResources.add(o.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride async getEncodedReadable(resource: URI, value?: string | ITextSnapshot): Promise<any> {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\t\tservices.set(IWorkingCopyFileService, new class extends mock<IWorkingCopyFileService>() {\n\t\t\toverride onDidRunWorkingCopyFileOperation = Event.None;\n\t\t\toverride createFolder(operations: ICreateOperation[]): any {\n\t\t\t\tthis.create(operations);\n\t\t\t}\n\t\t\toverride create(operations: ICreateFileOperation[]) {\n\t\t\t\tfor (const operation of operations) {\n\t\t\t\t\tcreatedResources.add(operation.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride move(operations: IMoveOperation[]) {\n\t\t\t\tconst { source, target } = operations[0].file;\n\t\t\t\tmovedResources.set(source, target);\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride copy(operations: ICopyOperation[]) {\n\t\t\t\tconst { source, target } = operations[0].file;\n\t\t\t\tcopiedResources.set(source, target);\n\t\t\t\treturn Promise.resolve(Object.create(null));\n\t\t\t}\n\t\t\toverride delete(operations: IDeleteOperation[]) {\n\t\t\t\tfor (const operation of operations) {\n\t\t\t\t\tdeletedResources.add(operation.resource);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\t\t});\n\t\tservices.set(ITextModelService, new class extends mock<ITextModelService>() {\n\t\t\toverride createModelReference(resource: URI): Promise<IReference<IResolvedTextEditorModel>> {\n\t\t\t\tconst textEditorModel = new class extends mock<IResolvedTextEditorModel>() {\n\t\t\t\t\toverride textEditorModel = modelService.getModel(resource)!;\n\t\t\t\t};\n\t\t\t\ttextEditorModel.isReadonly = () => false;\n\t\t\t\treturn Promise.resolve(new ImmortalReference(textEditorModel));\n\t\t\t}\n\t\t});\n\t\tservices.set(IEditorWorkerService, new class extends mock<IEditorWorkerService>() {\n\n\t\t});\n\t\tservices.set(IPaneCompositePartService, new class extends mock<IPaneCompositePartService>() implements IPaneCompositePartService {\n\t\t\toverride onDidPaneCompositeOpen = Event.None;\n\t\t\toverride onDidPaneCompositeClose = Event.None;\n\t\t\toverride getActivePaneComposite() {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\n\t\tservices.set(ILanguageService, disposables.add(new LanguageService()));\n\t\tservices.set(ILanguageConfigurationService, new TestLanguageConfigurationService());\n\n\t\tconst instaService = new InstantiationService(services);\n\n\t\tbulkEdits = instaService.createInstance(MainThreadBulkEdits, SingleProxyRPCProtocol(null));\n\t\tconst documents = instaService.createInstance(MainThreadDocuments, SingleProxyRPCProtocol(null));\n\n\t\t// Create editor locator\n\t\teditorLocator = {\n\t\t\tgetEditor(id: string): MainThreadTextEditor | undefined {\n\t\t\t\treturn id === editorId ? testEditor : undefined;\n\t\t\t},\n\t\t\tfindTextEditorIdFor() { return undefined; },\n\t\t\tgetIdOfCodeEditor() { return undefined; }\n\t\t};\n\n\t\teditors = instaService.createInstance(MainThreadTextEditors, editorLocator, SingleProxyRPCProtocol(null));\n\t\tmodelService = instaService.invokeFunction(accessor => accessor.get(IModelService));\n\n\t\t// Create a test code editor using the helper\n\t\tconst model = modelService.createModel('Hello world!', null, existingResource);\n\t\tconst testCodeEditor = disposables.add(createTestCodeEditor(model));\n\n\t\ttestEditor = disposables.add(instaService.createInstance(\n\t\t\tMainThreadTextEditor,\n\t\t\teditorId,\n\t\t\tmodel,\n\t\t\ttestCodeEditor,\n\t\t\t{ onGainedFocus() { }, onLostFocus() { } },\n\t\t\tdocuments\n\t\t));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest(`applyWorkspaceEdit returns false if model is changed by user`, () => {\n\n\t\tconst model = disposables.add(modelService.createModel('something', null, resource));\n\n\t\tconst workspaceResourceEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\n\t\t// Act as if the user edited the model\n\t\tmodel.applyEdits([EditOperation.insert(new Position(0, 0), 'something')]);\n\n\t\treturn bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit] })).then((result) => {\n\t\t\tassert.strictEqual(result, false);\n\t\t});\n\t});\n\n\ttest(`issue #54773: applyWorkspaceEdit checks model version in race situation`, () => {\n\n\t\tconst model = disposables.add(modelService.createModel('something', null, resource));\n\n\t\tconst workspaceResourceEdit1: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\t\tconst workspaceResourceEdit2: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\ttext: 'asdfg',\n\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t}\n\t\t};\n\n\t\tconst p1 = bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit1] })).then((result) => {\n\t\t\t// first edit request succeeds\n\t\t\tassert.strictEqual(result, true);\n\t\t});\n\t\tconst p2 = bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [workspaceResourceEdit2] })).then((result) => {\n\t\t\t// second edit request fails\n\t\t\tassert.strictEqual(result, false);\n\t\t});\n\t\treturn Promise.all([p1, p2]);\n\t});\n\n\ttest('applyWorkspaceEdit: noop eol edit keeps undo stack clean', async () => {\n\n\t\tconst initialText = 'hello\\nworld';\n\t\tconst model = disposables.add(modelService.createModel(initialText, null, resource));\n\t\tconst initialAlternativeVersionId = model.getAlternativeVersionId();\n\n\t\tconst insertEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\trange: new Range(1, 6, 1, 6),\n\t\t\t\ttext: '2'\n\t\t\t}\n\t\t};\n\n\t\tconst insertResult = await bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [insertEdit] }));\n\t\tassert.strictEqual(insertResult, true);\n\t\tassert.strictEqual(model.getValue(), 'hello2\\nworld');\n\t\tassert.notStrictEqual(model.getAlternativeVersionId(), initialAlternativeVersionId);\n\n\t\tconst eolEdit: IWorkspaceTextEditDto = {\n\t\t\tresource: resource,\n\t\t\tversionId: model.getVersionId(),\n\t\t\ttextEdit: {\n\t\t\t\trange: new Range(1, 1, 1, 1),\n\t\t\t\ttext: '',\n\t\t\t\teol: EndOfLineSequence.LF\n\t\t\t}\n\t\t};\n\n\t\tconst eolResult = await bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({ edits: [eolEdit] }));\n\t\tassert.strictEqual(eolResult, true);\n\t\tassert.strictEqual(model.getValue(), 'hello2\\nworld');\n\n\t\tconst undoResult = model.undo();\n\t\tif (undoResult) {\n\t\t\tawait undoResult;\n\t\t}\n\t\tassert.strictEqual(model.getValue(), initialText);\n\t\tassert.strictEqual(model.getAlternativeVersionId(), initialAlternativeVersionId);\n\t});\n\n\ttest(`applyWorkspaceEdit with only resource edit`, () => {\n\t\treturn bulkEdits.$tryApplyWorkspaceEdit(new SerializableObjectWithBuffers({\n\t\t\tedits: [\n\t\t\t\t{ oldResource: resource, newResource: resource, options: undefined },\n\t\t\t\t{ oldResource: undefined, newResource: resource, options: undefined },\n\t\t\t\t{ oldResource: resource, newResource: undefined, options: undefined }\n\t\t\t]\n\t\t})).then((result) => {\n\t\t\tassert.strictEqual(result, true);\n\t\t\tassert.strictEqual(movedResources.get(resource), resource);\n\t\t\tassert.strictEqual(createdResources.has(resource), true);\n\t\t\tassert.strictEqual(deletedResources.has(resource), true);\n\t\t});\n\t});\n\n\ttest('applyWorkspaceEdit can control undo/redo stack 1', async () => {\n\t\tconst model = modelService.getModel(existingResource)!;\n\n\t\tconst edit1: ISingleEditOperation = {\n\t\t\trange: new Range(1, 1, 1, 2),\n\t\t\ttext: 'h',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied1 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit1], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied1, true);\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\n\t\tconst edit2: ISingleEditOperation = {\n\t\t\trange: new Range(1, 2, 1, 6),\n\t\t\ttext: 'ELLO',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied2 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit2], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied2, true);\n\t\tassert.strictEqual(model.getValue(), 'hELLO world!');\n\n\t\tawait model.undo();\n\t\tassert.strictEqual(model.getValue(), 'Hello world!');\n\t});\n\n\ttest('applyWorkspaceEdit can control undo/redo stack 2', async () => {\n\t\tconst model = modelService.getModel(existingResource)!;\n\n\t\tconst edit1: ISingleEditOperation = {\n\t\t\trange: new Range(1, 1, 1, 2),\n\t\t\ttext: 'h',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied1 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit1], { undoStopBefore: false, undoStopAfter: false });\n\t\tassert.strictEqual(applied1, true);\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\n\t\tconst edit2: ISingleEditOperation = {\n\t\t\trange: new Range(1, 2, 1, 6),\n\t\t\ttext: 'ELLO',\n\t\t\tforceMoveMarkers: false\n\t\t};\n\n\t\tconst applied2 = await editors.$tryApplyEdits(editorId, model.getVersionId(), [edit2], { undoStopBefore: true, undoStopAfter: false });\n\t\tassert.strictEqual(applied2, true);\n\t\tassert.strictEqual(model.getValue(), 'hELLO world!');\n\n\t\tawait model.undo();\n\t\tassert.strictEqual(model.getValue(), 'hello world!');\n\t});\n});\n"]}