{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/extHostEditorTabs.test.ts","vs/workbench/api/test/browser/extHostEditorTabs.test.ts"],"names":[],"mappings":"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","file":"extHostEditorTabs.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport assert from 'assert';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IEditorTabDto, IEditorTabGroupDto, MainThreadEditorTabsShape, TabInputKind, TabModelOperationKind, TextInputDto } from '../../common/extHost.protocol.js';\nimport { ExtHostEditorTabs } from '../../common/extHostEditorTabs.js';\nimport { SingleProxyRPCProtocol } from '../common/testRPCProtocol.js';\nimport { TextMergeTabInput, TextTabInput } from '../../common/extHostTypes.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('ExtHostEditorTabs', function () {\n\n\tconst defaultTabDto: IEditorTabDto = {\n\t\tid: 'uniquestring',\n\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/def.txt') },\n\t\tisActive: true,\n\t\tisDirty: true,\n\t\tisPinned: true,\n\t\tisPreview: false,\n\t\tlabel: 'label1',\n\t};\n\n\tfunction createTabDto(dto?: Partial<IEditorTabDto>): IEditorTabDto {\n\t\treturn { ...defaultTabDto, ...dto };\n\t}\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Ensure empty model throws when accessing active group', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 0);\n\t\t// Active group should never be undefined (there is always an active group). Ensure accessing it undefined throws.\n\t\t// TODO @lramos15 Add a throw on the main side when a model is sent without an active group\n\t\tassert.throws(() => extHostEditorTabs.tabGroups.activeTabGroup);\n\t});\n\n\ttest('single tab', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\n\t\t{\n\t\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\t\tisActive: true,\n\t\t\t\tviewColumn: 0,\n\t\t\t\tgroupId: 12,\n\t\t\t\ttabs: [tab]\n\t\t\t}]);\n\t\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\t\tassert.ok(first.activeTab);\n\t\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\t}\n\t});\n\n\ttest('Empty tab group', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.strictEqual(first.activeTab, undefined);\n\t\tassert.strictEqual(first.tabs.length, 0);\n\t});\n\n\ttest('Ensure tabGroup change events fires', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tlet count = 0;\n\t\tstore.add(extHostEditorTabs.tabGroups.onDidChangeTabGroups(() => count++));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.ok(extHostEditorTabs.tabGroups.activeTabGroup);\n\t\tconst activeTabGroup: vscode.TabGroup = extHostEditorTabs.tabGroups.activeTabGroup;\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(activeTabGroup.tabs.length, 0);\n\t\tassert.strictEqual(count, 1);\n\t});\n\n\ttest('Check TabGroupChangeEvent properties', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst group1Data: IEditorTabGroupDto = {\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t};\n\t\tconst group2Data: IEditorTabGroupDto = { ...group1Data, groupId: 13 };\n\n\t\tconst events: vscode.TabGroupChangeEvent[] = [];\n\t\tstore.add(extHostEditorTabs.tabGroups.onDidChangeTabGroups(e => events.push(e)));\n\t\t// OPEN\n\t\textHostEditorTabs.$acceptEditorTabModel([group1Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: [],\n\t\t\tclosed: [],\n\t\t\topened: [extHostEditorTabs.tabGroups.activeTabGroup]\n\t\t}]);\n\n\t\t// OPEN, CHANGE\n\t\tevents.length = 0;\n\t\textHostEditorTabs.$acceptEditorTabModel([{ ...group1Data, isActive: false }, group2Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: [extHostEditorTabs.tabGroups.all[0]],\n\t\t\tclosed: [],\n\t\t\topened: [extHostEditorTabs.tabGroups.all[1]]\n\t\t}]);\n\n\t\t// CHANGE\n\t\tevents.length = 0;\n\t\textHostEditorTabs.$acceptEditorTabModel([group1Data, { ...group2Data, isActive: false }]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: extHostEditorTabs.tabGroups.all,\n\t\t\tclosed: [],\n\t\t\topened: []\n\t\t}]);\n\n\t\t// CLOSE, CHANGE\n\t\tevents.length = 0;\n\t\tconst oldActiveGroup = extHostEditorTabs.tabGroups.activeTabGroup;\n\t\textHostEditorTabs.$acceptEditorTabModel([group2Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: extHostEditorTabs.tabGroups.all,\n\t\t\tclosed: [oldActiveGroup],\n\t\t\topened: []\n\t\t}]);\n\t});\n\n\ttest('Ensure reference equality for activeTab and activeGroup', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tab = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\tassert.strictEqual(first.activeTab, first.tabs[0]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup, first);\n\t});\n\n\ttest('TextMergeTabInput surfaces in the UI', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tinput: {\n\t\t\t\tkind: TabInputKind.TextMergeInput,\n\t\t\t\tbase: URI.from({ scheme: 'test', path: 'base' }),\n\t\t\t\tinput1: URI.from({ scheme: 'test', path: 'input1' }),\n\t\t\t\tinput2: URI.from({ scheme: 'test', path: 'input2' }),\n\t\t\t\tresult: URI.from({ scheme: 'test', path: 'result' }),\n\t\t\t}\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\tassert.ok(first.activeTab.input instanceof TextMergeTabInput);\n\t});\n\n\ttest('Ensure reference stability', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tabDto = createTabDto();\n\n\t\t// single dirty tab\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDto]\n\t\t}]);\n\t\tlet all = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 1);\n\t\tconst apiTab1 = all[0];\n\t\tassert.ok(apiTab1.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDto.input.kind, TabInputKind.TextInput);\n\t\tconst dtoResource = (tabDto.input as TextInputDto).uri;\n\t\tassert.strictEqual(apiTab1.input.uri.toString(), URI.revive(dtoResource).toString());\n\t\tassert.strictEqual(apiTab1.isDirty, true);\n\n\n\t\t// NOT DIRTY anymore\n\n\t\tconst tabDto2: IEditorTabDto = { ...tabDto, isDirty: false };\n\t\t// Accept a simple update\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\tindex: 0,\n\t\t\ttabDto: tabDto2,\n\t\t\tgroupId: 12\n\t\t});\n\n\t\tall = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 1);\n\t\tconst apiTab2 = all[0];\n\t\tassert.ok(apiTab1.input instanceof TextTabInput);\n\t\tassert.strictEqual(apiTab1.input.uri.toString(), URI.revive(dtoResource).toString());\n\t\tassert.strictEqual(apiTab2.isDirty, false);\n\n\t\tassert.strictEqual(apiTab1 === apiTab2, true);\n\t});\n\n\ttest('Tab.isActive working', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tabDtoAAA = createTabDto({\n\t\t\tid: 'AAA',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/AAA.txt') },\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\tconst tabDtoBBB = createTabDto({\n\t\t\tid: 'BBB',\n\t\t\tisActive: false,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/BBB.txt') },\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\t// single dirty tab\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDtoAAA, tabDtoBBB]\n\t\t}]);\n\n\t\tconst all = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 2);\n\n\t\tconst activeTab1 = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab1?.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDtoAAA.input.kind, TabInputKind.TextInput);\n\t\tconst dtoAAAResource = (tabDtoAAA.input as TextInputDto).uri;\n\t\tassert.strictEqual(activeTab1?.input?.uri.toString(), URI.revive(dtoAAAResource)?.toString());\n\t\tassert.strictEqual(activeTab1?.isActive, true);\n\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: { ...tabDtoBBB, isActive: true } /// BBB is now active\n\t\t});\n\n\t\tconst activeTab2 = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab2?.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDtoBBB.input.kind, TabInputKind.TextInput);\n\t\tconst dtoBBBResource = (tabDtoBBB.input as TextInputDto).uri;\n\t\tassert.strictEqual(activeTab2?.input?.uri.toString(), URI.revive(dtoBBBResource)?.toString());\n\t\tassert.strictEqual(activeTab2?.isActive, true);\n\t\tassert.strictEqual(activeTab1?.isActive, false);\n\t});\n\n\ttest('vscode.window.tagGroups is immutable', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.activeTabGroup = undefined;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.all.length = 0;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.onDidChangeActiveTabGroup = undefined;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.onDidChangeTabGroups = undefined;\n\t\t});\n\t});\n\n\ttest('Ensure close is called with all tab ids', function () {\n\t\tconst closedTabIds: string[][] = [];\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t\toverride async $closeTab(tabIds: string[], preserveFocus?: boolean) {\n\t\t\t\t\tclosedTabIds.push(tabIds);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst activeTab = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab);\n\t\textHostEditorTabs.tabGroups.close(activeTab, false);\n\t\tassert.strictEqual(closedTabIds.length, 1);\n\t\tassert.deepStrictEqual(closedTabIds[0], ['uniquestring']);\n\t\t// Close with array\n\t\textHostEditorTabs.tabGroups.close([activeTab], false);\n\t\tassert.strictEqual(closedTabIds.length, 2);\n\t\tassert.deepStrictEqual(closedTabIds[1], ['uniquestring']);\n\t});\n\n\ttest('Update tab only sends tab change event', async function () {\n\t\tconst closedTabIds: string[][] = [];\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t\toverride async $closeTab(tabIds: string[], preserveFocus?: boolean) {\n\t\t\t\t\tclosedTabIds.push(tabIds);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tconst tabDto: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDto]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\n\t\tconst tab = extHostEditorTabs.tabGroups.all[0].tabs[0];\n\n\n\t\tconst p = new Promise<vscode.TabChangeEvent>(resolve => store.add(extHostEditorTabs.tabGroups.onDidChangeTabs(resolve)));\n\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: { ...tabDto, label: 'NEW LABEL' }\n\t\t});\n\n\t\tconst changedTab = (await p).changed[0];\n\n\t\tassert.ok(tab === changedTab);\n\t\tassert.strictEqual(changedTab.label, 'NEW LABEL');\n\n\t});\n\n\ttest('Active tab', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Active tab is correct\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[0]);\n\n\t\t// Switching active tab works\n\t\ttab1.isActive = false;\n\t\ttab2.isActive = true;\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab1\n\t\t});\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[1]);\n\n\t\t//Closing tabs out works\n\t\ttab3.isActive = true;\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab3]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[0]);\n\n\t\t// Closing out all tabs returns undefine active tab\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 0);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, undefined);\n\t});\n\n\ttest('Tab operations patches open and close correctly', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t\tlabel: 'label2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t\tlabel: 'label3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Close tab 2\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_CLOSE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 2);\n\n\t\t// Close active tab and update tab 3 to be active\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_CLOSE,\n\t\t\ttabDto: tab1\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\ttab3.isActive = true;\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab3\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.activeTab?.label, 'label3');\n\n\t\t// Open tab 2 back\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_OPEN,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 2);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[1]?.label, 'label2');\n\t});\n\n\ttest('Tab operations patches move correctly', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t\tlabel: 'label2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t\tlabel: 'label3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Move tab 2 to index 0\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\toldIndex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_MOVE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[0]?.label, 'label2');\n\n\t\t// Move tab 3 to index 1\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\toldIndex: 2,\n\t\t\tkind: TabModelOperationKind.TAB_MOVE,\n\t\t\ttabDto: tab3\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[1]?.label, 'label3');\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[0]?.label, 'label2');\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[2]?.label, 'label1');\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport assert from 'assert';\nimport { URI } from '../../../../base/common/uri.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { IEditorTabDto, IEditorTabGroupDto, MainThreadEditorTabsShape, TabInputKind, TabModelOperationKind, TextInputDto } from '../../common/extHost.protocol.js';\nimport { ExtHostEditorTabs } from '../../common/extHostEditorTabs.js';\nimport { SingleProxyRPCProtocol } from '../common/testRPCProtocol.js';\nimport { TextMergeTabInput, TextTabInput } from '../../common/extHostTypes.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('ExtHostEditorTabs', function () {\n\n\tconst defaultTabDto: IEditorTabDto = {\n\t\tid: 'uniquestring',\n\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/def.txt') },\n\t\tisActive: true,\n\t\tisDirty: true,\n\t\tisPinned: true,\n\t\tisPreview: false,\n\t\tlabel: 'label1',\n\t};\n\n\tfunction createTabDto(dto?: Partial<IEditorTabDto>): IEditorTabDto {\n\t\treturn { ...defaultTabDto, ...dto };\n\t}\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Ensure empty model throws when accessing active group', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 0);\n\t\t// Active group should never be undefined (there is always an active group). Ensure accessing it undefined throws.\n\t\t// TODO @lramos15 Add a throw on the main side when a model is sent without an active group\n\t\tassert.throws(() => extHostEditorTabs.tabGroups.activeTabGroup);\n\t});\n\n\ttest('single tab', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\n\t\t{\n\t\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\t\tisActive: true,\n\t\t\t\tviewColumn: 0,\n\t\t\t\tgroupId: 12,\n\t\t\t\ttabs: [tab]\n\t\t\t}]);\n\t\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\t\tassert.ok(first.activeTab);\n\t\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\t}\n\t});\n\n\ttest('Empty tab group', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.strictEqual(first.activeTab, undefined);\n\t\tassert.strictEqual(first.tabs.length, 0);\n\t});\n\n\ttest('Ensure tabGroup change events fires', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tlet count = 0;\n\t\tstore.add(extHostEditorTabs.tabGroups.onDidChangeTabGroups(() => count++));\n\n\t\tassert.strictEqual(count, 0);\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.ok(extHostEditorTabs.tabGroups.activeTabGroup);\n\t\tconst activeTabGroup: vscode.TabGroup = extHostEditorTabs.tabGroups.activeTabGroup;\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(activeTabGroup.tabs.length, 0);\n\t\tassert.strictEqual(count, 1);\n\t});\n\n\ttest('Check TabGroupChangeEvent properties', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst group1Data: IEditorTabGroupDto = {\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t};\n\t\tconst group2Data: IEditorTabGroupDto = { ...group1Data, groupId: 13 };\n\n\t\tconst events: vscode.TabGroupChangeEvent[] = [];\n\t\tstore.add(extHostEditorTabs.tabGroups.onDidChangeTabGroups(e => events.push(e)));\n\t\t// OPEN\n\t\textHostEditorTabs.$acceptEditorTabModel([group1Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: [],\n\t\t\tclosed: [],\n\t\t\topened: [extHostEditorTabs.tabGroups.activeTabGroup]\n\t\t}]);\n\n\t\t// OPEN, CHANGE\n\t\tevents.length = 0;\n\t\textHostEditorTabs.$acceptEditorTabModel([{ ...group1Data, isActive: false }, group2Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: [extHostEditorTabs.tabGroups.all[0]],\n\t\t\tclosed: [],\n\t\t\topened: [extHostEditorTabs.tabGroups.all[1]]\n\t\t}]);\n\n\t\t// CHANGE\n\t\tevents.length = 0;\n\t\textHostEditorTabs.$acceptEditorTabModel([group1Data, { ...group2Data, isActive: false }]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: extHostEditorTabs.tabGroups.all,\n\t\t\tclosed: [],\n\t\t\topened: []\n\t\t}]);\n\n\t\t// CLOSE, CHANGE\n\t\tevents.length = 0;\n\t\tconst oldActiveGroup = extHostEditorTabs.tabGroups.activeTabGroup;\n\t\textHostEditorTabs.$acceptEditorTabModel([group2Data]);\n\t\tassert.deepStrictEqual(events, [{\n\t\t\tchanged: extHostEditorTabs.tabGroups.all,\n\t\t\tclosed: [oldActiveGroup],\n\t\t\topened: []\n\t\t}]);\n\t});\n\n\ttest('Ensure reference equality for activeTab and activeGroup', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tab = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\tassert.strictEqual(first.activeTab, first.tabs[0]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup, first);\n\t});\n\n\ttest('TextMergeTabInput surfaces in the UI', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tinput: {\n\t\t\t\tkind: TabInputKind.TextMergeInput,\n\t\t\t\tbase: URI.from({ scheme: 'test', path: 'base' }),\n\t\t\t\tinput1: URI.from({ scheme: 'test', path: 'input1' }),\n\t\t\t\tinput2: URI.from({ scheme: 'test', path: 'input2' }),\n\t\t\t\tresult: URI.from({ scheme: 'test', path: 'result' }),\n\t\t\t}\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst [first] = extHostEditorTabs.tabGroups.all;\n\t\tassert.ok(first.activeTab);\n\t\tassert.strictEqual(first.tabs.indexOf(first.activeTab), 0);\n\t\tassert.ok(first.activeTab.input instanceof TextMergeTabInput);\n\t});\n\n\ttest('Ensure reference stability', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tabDto = createTabDto();\n\n\t\t// single dirty tab\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDto]\n\t\t}]);\n\t\tlet all = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 1);\n\t\tconst apiTab1 = all[0];\n\t\tassert.ok(apiTab1.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDto.input.kind, TabInputKind.TextInput);\n\t\tconst dtoResource = (tabDto.input as TextInputDto).uri;\n\t\tassert.strictEqual(apiTab1.input.uri.toString(), URI.revive(dtoResource).toString());\n\t\tassert.strictEqual(apiTab1.isDirty, true);\n\n\n\t\t// NOT DIRTY anymore\n\n\t\tconst tabDto2: IEditorTabDto = { ...tabDto, isDirty: false };\n\t\t// Accept a simple update\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\tindex: 0,\n\t\t\ttabDto: tabDto2,\n\t\t\tgroupId: 12\n\t\t});\n\n\t\tall = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 1);\n\t\tconst apiTab2 = all[0];\n\t\tassert.ok(apiTab1.input instanceof TextTabInput);\n\t\tassert.strictEqual(apiTab1.input.uri.toString(), URI.revive(dtoResource).toString());\n\t\tassert.strictEqual(apiTab2.isDirty, false);\n\n\t\tassert.strictEqual(apiTab1 === apiTab2, true);\n\t});\n\n\ttest('Tab.isActive working', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\t\tconst tabDtoAAA = createTabDto({\n\t\t\tid: 'AAA',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/AAA.txt') },\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\tconst tabDtoBBB = createTabDto({\n\t\t\tid: 'BBB',\n\t\t\tisActive: false,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\tinput: { kind: TabInputKind.TextInput, uri: URI.parse('file://abc/BBB.txt') },\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\t// single dirty tab\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDtoAAA, tabDtoBBB]\n\t\t}]);\n\n\t\tconst all = extHostEditorTabs.tabGroups.all.map(group => group.tabs).flat();\n\t\tassert.strictEqual(all.length, 2);\n\n\t\tconst activeTab1 = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab1?.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDtoAAA.input.kind, TabInputKind.TextInput);\n\t\tconst dtoAAAResource = (tabDtoAAA.input as TextInputDto).uri;\n\t\tassert.strictEqual(activeTab1?.input?.uri.toString(), URI.revive(dtoAAAResource)?.toString());\n\t\tassert.strictEqual(activeTab1?.isActive, true);\n\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: { ...tabDtoBBB, isActive: true } /// BBB is now active\n\t\t});\n\n\t\tconst activeTab2 = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab2?.input instanceof TextTabInput);\n\t\tassert.strictEqual(tabDtoBBB.input.kind, TabInputKind.TextInput);\n\t\tconst dtoBBBResource = (tabDtoBBB.input as TextInputDto).uri;\n\t\tassert.strictEqual(activeTab2?.input?.uri.toString(), URI.revive(dtoBBBResource)?.toString());\n\t\tassert.strictEqual(activeTab2?.isActive, true);\n\t\tassert.strictEqual(activeTab1?.isActive, false);\n\t});\n\n\ttest('vscode.window.tagGroups is immutable', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.activeTabGroup = undefined;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.all.length = 0;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.onDidChangeActiveTabGroup = undefined;\n\t\t});\n\t\tassert.throws(() => {\n\t\t\t// @ts-expect-error write to readonly prop\n\t\t\textHostEditorTabs.tabGroups.onDidChangeTabGroups = undefined;\n\t\t});\n\t});\n\n\ttest('Ensure close is called with all tab ids', function () {\n\t\tconst closedTabIds: string[][] = [];\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t\toverride async $closeTab(tabIds: string[], preserveFocus?: boolean) {\n\t\t\t\t\tclosedTabIds.push(tabIds);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tconst tab: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tconst activeTab = extHostEditorTabs.tabGroups.activeTabGroup?.activeTab;\n\t\tassert.ok(activeTab);\n\t\textHostEditorTabs.tabGroups.close(activeTab, false);\n\t\tassert.strictEqual(closedTabIds.length, 1);\n\t\tassert.deepStrictEqual(closedTabIds[0], ['uniquestring']);\n\t\t// Close with array\n\t\textHostEditorTabs.tabGroups.close([activeTab], false);\n\t\tassert.strictEqual(closedTabIds.length, 2);\n\t\tassert.deepStrictEqual(closedTabIds[1], ['uniquestring']);\n\t});\n\n\ttest('Update tab only sends tab change event', async function () {\n\t\tconst closedTabIds: string[][] = [];\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t\toverride async $closeTab(tabIds: string[], preserveFocus?: boolean) {\n\t\t\t\t\tclosedTabIds.push(tabIds);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tconst tabDto: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t\teditorId: 'default'\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tabDto]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\n\t\tconst tab = extHostEditorTabs.tabGroups.all[0].tabs[0];\n\n\n\t\tconst p = new Promise<vscode.TabChangeEvent>(resolve => store.add(extHostEditorTabs.tabGroups.onDidChangeTabs(resolve)));\n\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: { ...tabDto, label: 'NEW LABEL' }\n\t\t});\n\n\t\tconst changedTab = (await p).changed[0];\n\n\t\tassert.ok(tab === changedTab);\n\t\tassert.strictEqual(changedTab.label, 'NEW LABEL');\n\n\t});\n\n\ttest('Active tab', function () {\n\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tisDirty: true,\n\t\t\tisPinned: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Active tab is correct\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[0]);\n\n\t\t// Switching active tab works\n\t\ttab1.isActive = false;\n\t\ttab2.isActive = true;\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab1\n\t\t});\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[1]);\n\n\t\t//Closing tabs out works\n\t\ttab3.isActive = true;\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab3]\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, extHostEditorTabs.tabGroups.activeTabGroup?.tabs[0]);\n\n\t\t// Closing out all tabs returns undefine active tab\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: []\n\t\t}]);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 0);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.activeTabGroup?.activeTab, undefined);\n\t});\n\n\ttest('Tab operations patches open and close correctly', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t\tlabel: 'label2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t\tlabel: 'label3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Close tab 2\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_CLOSE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 2);\n\n\t\t// Close active tab and update tab 3 to be active\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_CLOSE,\n\t\t\ttabDto: tab1\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\ttab3.isActive = true;\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\tkind: TabModelOperationKind.TAB_UPDATE,\n\t\t\ttabDto: tab3\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.activeTab?.label, 'label3');\n\n\t\t// Open tab 2 back\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_OPEN,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 2);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[1]?.label, 'label2');\n\t});\n\n\ttest('Tab operations patches move correctly', function () {\n\t\tconst extHostEditorTabs = new ExtHostEditorTabs(\n\t\t\tSingleProxyRPCProtocol(new class extends mock<MainThreadEditorTabsShape>() {\n\t\t\t\t// override/implement $moveTab or $closeTab\n\t\t\t})\n\t\t);\n\n\t\tconst tab1: IEditorTabDto = createTabDto({\n\t\t\tid: 'uniquestring',\n\t\t\tisActive: true,\n\t\t\tlabel: 'label1',\n\t\t});\n\n\t\tconst tab2: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring2',\n\t\t\tlabel: 'label2',\n\t\t});\n\n\t\tconst tab3: IEditorTabDto = createTabDto({\n\t\t\tisActive: false,\n\t\t\tid: 'uniquestring3',\n\t\t\tlabel: 'label3',\n\t\t});\n\n\t\textHostEditorTabs.$acceptEditorTabModel([{\n\t\t\tisActive: true,\n\t\t\tviewColumn: 0,\n\t\t\tgroupId: 12,\n\t\t\ttabs: [tab1, tab2, tab3]\n\t\t}]);\n\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\n\t\t// Move tab 2 to index 0\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 0,\n\t\t\toldIndex: 1,\n\t\t\tkind: TabModelOperationKind.TAB_MOVE,\n\t\t\ttabDto: tab2\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[0]?.label, 'label2');\n\n\t\t// Move tab 3 to index 1\n\t\textHostEditorTabs.$acceptTabOperation({\n\t\t\tgroupId: 12,\n\t\t\tindex: 1,\n\t\t\toldIndex: 2,\n\t\t\tkind: TabModelOperationKind.TAB_MOVE,\n\t\t\ttabDto: tab3\n\t\t});\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.length, 1);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all.map(g => g.tabs).flat().length, 3);\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[1]?.label, 'label3');\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[0]?.label, 'label2');\n\t\tassert.strictEqual(extHostEditorTabs.tabGroups.all[0]?.tabs[2]?.label, 'label1');\n\t});\n});\n"]}