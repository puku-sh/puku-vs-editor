{"version":3,"sources":["vs/workbench/api/test/browser/mainThreadTreeViews.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,KAAK,GAAG,MAAM,oBAAoB,CAAC;AAC1C,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,IAAI,EAAE,MAAM,sCAAsC,CAAC;AAC5D,OAAO,EAAE,uCAAuC,EAAE,MAAM,uCAAuC,CAAC;AAChG,OAAO,EAAE,cAAc,EAAE,MAAM,0DAA0D,CAAC;AAE1F,OAAO,EAAE,cAAc,EAAE,MAAM,wCAAwC,CAAC;AACxE,OAAO,EAAE,uBAAuB,EAAE,MAAM,0EAA0E,CAAC;AACnH,OAAO,EAAE,QAAQ,EAAE,MAAM,kDAAkD,CAAC;AAC5E,OAAO,EAAE,mBAAmB,EAAE,MAAM,sCAAsC,CAAC;AAE3E,OAAO,EAAE,cAAc,EAAE,MAAM,0CAA0C,CAAC;AAC1E,OAAO,EAAE,UAAU,EAAsE,sBAAsB,EAAkB,wBAAwB,EAAwC,MAAM,0BAA0B,CAAC;AAGlO,OAAO,EAAE,qBAAqB,EAAE,MAAM,0DAA0D,CAAC;AACjG,OAAO,EAAE,gBAAgB,EAAE,6BAA6B,EAAE,MAAM,gDAAgD,CAAC;AACjH,OAAO,EAAE,oBAAoB,EAAE,MAAM,+CAA+C,CAAC;AAErF,KAAK,CAAC,wBAAwB,EAAE;IAC/B,MAAM,cAAc,GAAG,cAAc,CAAC;IACtC,MAAM,WAAW,GAAG,aAAa,CAAC;IAClC,MAAM,aAAa,GAAG,QAAQ,CAAC,EAAE,CAAiB,UAAU,CAAC,aAAa,CAAC,CAAC;IAM5E,MAAM,yBAA0B,SAAQ,IAAI,EAAyB;QAC3D,KAAK,CAAC,YAAY,CAAC,UAAkB,EAAE,cAAyB;YACxE,OAAO,CAAC,CAAC,CAAC,EAAkB,EAAE,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,wBAAwB,CAAC,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;QACrI,CAAC;QAEQ,KAAK,CAAC,WAAW;YACzB,OAAO,KAAK,CAAC;QACd,CAAC;QAEQ,WAAW,KAAW,CAAC;KAChC;IAED,IAAI,SAAwB,CAAC;IAC7B,IAAI,mBAAwC,CAAC;IAC7C,IAAI,qBAAgD,CAAC;IAErD,QAAQ,CAAC,GAAG,EAAE;QACb,aAAa,CAAC,eAAe,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,SAAS,CAAC,CAAC;IAC7E,CAAC,CAAC,CAAC;IAEH,MAAM,WAAW,GAAG,uCAAuC,EAAE,CAAC;IAE9D,KAAK,CAAC,KAAK,IAAI,EAAE;QAChB,MAAM,oBAAoB,GAA6B,6BAA6B,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;QAC7G,MAAM,qBAAqB,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAC1G,oBAAoB,CAAC,IAAI,CAAC,sBAAsB,EAAE,qBAAqB,CAAC,CAAC;QACzE,mDAAmD;QACnD,SAAS,GAAG,QAAQ,CAAC,EAAE,CAA0B,UAAU,CAAC,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,EAAE,EAAE,EAAE,eAAe,EAAE,KAAK,EAAE,GAAG,CAAC,SAAS,CAAC,IAAM,EAAE,MAAM,CAAC,EAAE,cAAc,EAAE,IAAI,cAAc,CAAM,EAAE,CAAC,EAAE,wCAAgC,CAAC;QACrP,MAAM,cAAc,GAAwB;YAC3C,EAAE,EAAE,cAAc;YAClB,cAAc,EAAE,IAAK;YACrB,IAAI,EAAE,GAAG,CAAC,SAAS,CAAC,IAAa,EAAE,aAAa,CAAC;YACjD,QAAQ,EAAE,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,cAAc,EAAE,UAAU,EAAE,YAAY,EAAE,cAAc,CAAC,CAAC;SACxH,CAAC;QACF,aAAa,CAAC,aAAa,CAAC,CAAC,cAAc,CAAC,EAAE,SAAS,CAAC,CAAC;QAEzD,MAAM,oBAAoB,GAAG,IAAI,oBAAoB,EAAE,CAAC;QACxD,qBAAqB,GAAG,IAAI,yBAAyB,EAAE,CAAC;QACxD,mBAAmB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,mBAAmB,CAC5D,IAAI;YAAA;gBACH,oBAAe,GAAG,EAAE,CAAC;gBACrB,sBAAiB,0CAAkC;YAQpD,CAAC;YAPA,OAAO,KAAK,CAAC;YACb,gBAAgB,KAAK,CAAC;YACtB,GAAG,CAAC,CAAM,IAAS,OAAO,IAAI,CAAC,CAAC,CAAC;YACjC,QAAQ;gBACP,OAAO,qBAAqB,CAAC;YAC9B,CAAC;YACD,KAAK,KAAU,OAAO,IAAI,CAAC,CAAC,CAAC;SAC7B,EAAE,IAAI,gBAAgB,EAAE,EAAE,IAAI,uBAAuB,EAAE,EAAE,oBAAoB,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC,CAAC;QACxG,mBAAmB,CAAC,6BAA6B,CAAC,cAAc,EAAE,EAAE,eAAe,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,aAAa,EAAE,EAAE,EAAE,aAAa,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,wBAAwB,EAAE,KAAK,EAAE,CAAC,CAAC;QACvO,MAAM,oBAAoB,CAAC,iCAAiC,EAAE,CAAC;IAChE,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;QACtD,MAAM,QAAQ,GAAoC,aAAa,CAAC,OAAO,CAAC,cAAc,CAAE,CAAC,QAAQ,CAAC;QAClG,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,YAAY,EAAE,WAAW,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,gBAAgB,EAAE,wBAAwB,CAAC,QAAQ,EAAE,CAAC,CAAC;QACnI,MAAM,CAAC,QAAS,CAAC,MAAM,KAAK,CAAC,EAAE,sCAAsC,CAAC,CAAC;QACvE,MAAM,CAAkB,QAAS,CAAC,CAAC,CAAE,CAAC,UAAU,KAAK,WAAW,EAAE,0CAA0C,CAAC,CAAC;IAC/G,CAAC,CAAC,CAAC;AAGJ,CAAC,CAAC,CAAC","file":"mainThreadTreeViews.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport assert from 'assert';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\nimport { SyncDescriptor } from '../../../../platform/instantiation/common/descriptors.js';\nimport { TestInstantiationService } from '../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { NullLogService } from '../../../../platform/log/common/log.js';\nimport { TestNotificationService } from '../../../../platform/notification/test/common/testNotificationService.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { MainThreadTreeViews } from '../../browser/mainThreadTreeViews.js';\nimport { ExtHostTreeViewsShape } from '../../common/extHost.protocol.js';\nimport { CustomTreeView } from '../../../browser/parts/views/treeView.js';\nimport { Extensions, ITreeItem, ITreeView, ITreeViewDescriptor, IViewContainersRegistry, IViewDescriptorService, IViewsRegistry, TreeItemCollapsibleState, ViewContainer, ViewContainerLocation } from '../../../common/views.js';\nimport { IExtHostContext } from '../../../services/extensions/common/extHostCustomers.js';\nimport { ExtensionHostKind } from '../../../services/extensions/common/extensionHostKind.js';\nimport { ViewDescriptorService } from '../../../services/views/browser/viewDescriptorService.js';\nimport { TestViewsService, workbenchInstantiationService } from '../../../test/browser/workbenchTestServices.js';\nimport { TestExtensionService } from '../../../test/common/workbenchTestServices.js';\n\nsuite('MainThreadHostTreeView', function () {\n\tconst testTreeViewId = 'testTreeView';\n\tconst customValue = 'customValue';\n\tconst ViewsRegistry = Registry.as<IViewsRegistry>(Extensions.ViewsRegistry);\n\n\tinterface CustomTreeItem extends ITreeItem {\n\t\tcustomProp: string;\n\t}\n\n\tclass MockExtHostTreeViewsShape extends mock<ExtHostTreeViewsShape>() {\n\t\toverride async $getChildren(treeViewId: string, treeItemHandle?: string[]): Promise<(number | ITreeItem)[][]> {\n\t\t\treturn [[0, <CustomTreeItem>{ handle: 'testItem1', collapsibleState: TreeItemCollapsibleState.Expanded, customProp: customValue }]];\n\t\t}\n\n\t\toverride async $hasResolve(): Promise<boolean> {\n\t\t\treturn false;\n\t\t}\n\n\t\toverride $setVisible(): void { }\n\t}\n\n\tlet container: ViewContainer;\n\tlet mainThreadTreeViews: MainThreadTreeViews;\n\tlet extHostTreeViewsShape: MockExtHostTreeViewsShape;\n\n\tteardown(() => {\n\t\tViewsRegistry.deregisterViews(ViewsRegistry.getViews(container), container);\n\t});\n\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(async () => {\n\t\tconst instantiationService: TestInstantiationService = workbenchInstantiationService(undefined, disposables);\n\t\tconst viewDescriptorService = disposables.add(instantiationService.createInstance(ViewDescriptorService));\n\t\tinstantiationService.stub(IViewDescriptorService, viewDescriptorService);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tcontainer = Registry.as<IViewContainersRegistry>(Extensions.ViewContainersRegistry).registerViewContainer({ id: 'testContainer', title: nls.localize2('test', 'test'), ctorDescriptor: new SyncDescriptor(<any>{}) }, ViewContainerLocation.Sidebar);\n\t\tconst viewDescriptor: ITreeViewDescriptor = {\n\t\t\tid: testTreeViewId,\n\t\t\tctorDescriptor: null!,\n\t\t\tname: nls.localize2('Test View 1', 'Test View 1'),\n\t\t\ttreeView: disposables.add(instantiationService.createInstance(CustomTreeView, 'testTree', 'Test Title', 'extension.id')),\n\t\t};\n\t\tViewsRegistry.registerViews([viewDescriptor], container);\n\n\t\tconst testExtensionService = new TestExtensionService();\n\t\textHostTreeViewsShape = new MockExtHostTreeViewsShape();\n\t\tmainThreadTreeViews = disposables.add(new MainThreadTreeViews(\n\t\t\tnew class implements IExtHostContext {\n\t\t\t\tremoteAuthority = '';\n\t\t\t\textensionHostKind = ExtensionHostKind.LocalProcess;\n\t\t\t\tdispose() { }\n\t\t\t\tassertRegistered() { }\n\t\t\t\tset(v: any): any { return null; }\n\t\t\t\tgetProxy(): any {\n\t\t\t\t\treturn extHostTreeViewsShape;\n\t\t\t\t}\n\t\t\t\tdrain(): any { return null; }\n\t\t\t}, new TestViewsService(), new TestNotificationService(), testExtensionService, new NullLogService()));\n\t\tmainThreadTreeViews.$registerTreeViewDataProvider(testTreeViewId, { showCollapseAll: false, canSelectMany: false, dropMimeTypes: [], dragMimeTypes: [], hasHandleDrag: false, hasHandleDrop: false, manuallyManageCheckboxes: false });\n\t\tawait testExtensionService.whenInstalledExtensionsRegistered();\n\t});\n\n\ttest('getChildren keeps custom properties', async () => {\n\t\tconst treeView: ITreeView = (<ITreeViewDescriptor>ViewsRegistry.getView(testTreeViewId)).treeView;\n\t\tconst children = await treeView.dataProvider?.getChildren({ handle: 'root', collapsibleState: TreeItemCollapsibleState.Expanded });\n\t\tassert(children!.length === 1, 'Exactly one child should be returned');\n\t\tassert((<CustomTreeItem>children![0]).customProp === customValue, 'Tree Items should keep custom properties');\n\t});\n\n\n});\n"]}