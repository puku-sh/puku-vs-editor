{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/api/test/browser/mainThreadBulkEdits.test.ts","vs/workbench/api/test/browser/mainThreadBulkEdits.test.ts"],"names":[],"mappings":"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","file":"mainThreadBulkEdits.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { IWorkspaceTextEditDto } from '../../common/extHost.protocol.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { FileSystemProviderCapabilities, IFileService } from '../../../../platform/files/common/files.js';\nimport { reviveWorkspaceEditDto } from '../../browser/mainThreadBulkEdits.js';\nimport { UriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceTextEdit } from '../../../../editor/common/languages.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('MainThreadBulkEdits', function () {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('\"Rename failed to apply edits\" in monorepo with pnpm #158845', function () {\n\n\n\t\tconst fileService = new class extends mock<IFileService>() {\n\t\t\toverride onDidChangeFileSystemProviderCapabilities = Event.None;\n\t\t\toverride onDidChangeFileSystemProviderRegistrations = Event.None;\n\n\t\t\toverride hasProvider(uri: URI) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\toverride hasCapability(resource: URI, capability: FileSystemProviderCapabilities): boolean {\n\t\t\t\t// if (resource.scheme === 'case' && capability === FileSystemProviderCapabilities.PathCaseSensitive) {\n\t\t\t\t// \treturn false;\n\t\t\t\t// }\n\t\t\t\t// NO capabilities, esp not being case-sensitive\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tconst uriIdentityService = new UriIdentityService(fileService);\n\n\t\tconst edits: IWorkspaceTextEditDto[] = [\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/hello/WORLD/foo.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/heLLO/world/fOO.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/other/path.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'foo', path: '/other/path.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t];\n\n\n\t\tconst out = reviveWorkspaceEditDto({ edits }, uriIdentityService);\n\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[0]).resource.path, '/hello/WORLD/foo.txt');\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[1]).resource.path, '/hello/WORLD/foo.txt'); // the FIRST occurrence defined the shape!\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[2]).resource.path, '/other/path.txt');\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[3]).resource.path, '/other/path.txt');\n\n\t\turiIdentityService.dispose();\n\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { IWorkspaceTextEditDto } from '../../common/extHost.protocol.js';\nimport { mock } from '../../../../base/test/common/mock.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { FileSystemProviderCapabilities, IFileService } from '../../../../platform/files/common/files.js';\nimport { reviveWorkspaceEditDto } from '../../browser/mainThreadBulkEdits.js';\nimport { UriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceTextEdit } from '../../../../editor/common/languages.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../base/test/common/utils.js';\n\nsuite('MainThreadBulkEdits', function () {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('\"Rename failed to apply edits\" in monorepo with pnpm #158845', function () {\n\n\n\t\tconst fileService = new class extends mock<IFileService>() {\n\t\t\toverride onDidChangeFileSystemProviderCapabilities = Event.None;\n\t\t\toverride onDidChangeFileSystemProviderRegistrations = Event.None;\n\n\t\t\toverride hasProvider(uri: URI) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\toverride hasCapability(resource: URI, capability: FileSystemProviderCapabilities): boolean {\n\t\t\t\t// if (resource.scheme === 'case' && capability === FileSystemProviderCapabilities.PathCaseSensitive) {\n\t\t\t\t// \treturn false;\n\t\t\t\t// }\n\t\t\t\t// NO capabilities, esp not being case-sensitive\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tconst uriIdentityService = new UriIdentityService(fileService);\n\n\t\tconst edits: IWorkspaceTextEditDto[] = [\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/hello/WORLD/foo.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/heLLO/world/fOO.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'case', path: '/other/path.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t\t{ resource: URI.from({ scheme: 'foo', path: '/other/path.txt' }), textEdit: { range: { startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 }, text: 'sss' }, versionId: undefined },\n\t\t];\n\n\n\t\tconst out = reviveWorkspaceEditDto({ edits }, uriIdentityService);\n\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[0]).resource.path, '/hello/WORLD/foo.txt');\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[1]).resource.path, '/hello/WORLD/foo.txt'); // the FIRST occurrence defined the shape!\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[2]).resource.path, '/other/path.txt');\n\t\tassert.strictEqual((<IWorkspaceTextEdit>out.edits[3]).resource.path, '/other/path.txt');\n\n\t\turiIdentityService.dispose();\n\n\t});\n});\n"]}