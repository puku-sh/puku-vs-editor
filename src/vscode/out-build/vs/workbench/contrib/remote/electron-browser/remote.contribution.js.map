{"version":3,"sources":["vs/workbench/contrib/remote/electron-browser/remote.contribution.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,KAAK,GAAG,MAAM,oBAAoB,CAAC;AAC1C,OAAO,EAAE,QAAQ,EAAE,MAAM,kDAAkD,CAAC;AAC5E,OAAO,EAAE,mBAAmB,EAAE,+BAA+B,EAAE,MAAM,uDAAuD,CAAC;AAC7H,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAClE,OAAO,EAAE,WAAW,EAAE,SAAS,EAAE,MAAM,qCAAqC,CAAC;AAC7E,OAAO,EAAU,QAAQ,EAAW,MAAM,qCAAqC,CAAC;AAChF,OAAO,EAAE,mBAAmB,EAAoB,MAAM,+DAA+D,CAAC;AACtH,OAAO,EAA2E,UAAU,IAAI,gCAAgC,EAAE,8BAA8B,EAAE,MAAM,kCAAkC,CAAC;AAC3M,OAAO,EAAE,iBAAiB,EAAkB,MAAM,iDAAiD,CAAC;AACpG,OAAO,EAAE,aAAa,EAAE,MAAM,4CAA4C,CAAC;AAC3E,OAAO,EAAE,eAAe,EAAE,MAAM,kDAAkD,CAAC;AACnF,OAAO,EAAE,OAAO,EAAE,MAAM,oCAAoC,CAAC;AAC7D,OAAO,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACtF,OAAO,EAAE,WAAW,EAAE,MAAM,4DAA4D,CAAC;AAEzF,OAAO,EAAE,kCAAkC,EAAE,MAAM,sEAAsE,CAAC;AAE1H,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAA0B,UAAU,IAAI,uBAAuB,EAAE,MAAM,oEAAoE,CAAC;AACnJ,OAAO,EAAE,+BAA+B,EAAE,MAAM,+DAA+D,CAAC;AAChH,OAAO,EAAE,0BAA0B,EAAE,oBAAoB,EAAE,sBAAsB,EAAE,oBAAoB,EAAE,uBAAuB,EAAE,MAAM,uDAAuD,CAAC;AAChM,OAAO,EAAE,wBAAwB,EAAkB,MAAM,oDAAoD,CAAC;AAC9G,OAAO,EAAE,oBAAoB,EAAE,MAAM,oDAAoD,CAAC;AAC1F,OAAO,EAAE,iBAAiB,EAAE,MAAM,yDAAyD,CAAC;AAC5F,OAAO,EAAE,kBAAkB,EAAE,aAAa,EAAE,cAAc,EAAE,MAAM,sDAAsD,CAAC;AACzH,OAAO,EAAE,kBAAkB,EAAE,MAAM,8CAA8C,CAAC;AAClF,OAAO,EAAE,eAAe,EAA+B,MAAM,gDAAgD,CAAC;AAC9G,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,gDAAgD,CAAC;AAElG,OAAO,EAAE,sBAAsB,EAAE,wBAAwB,EAAE,+BAA+B,EAAE,MAAM,0DAA0D,CAAC;AAC7J,OAAO,EAAU,iBAAiB,EAAE,MAAM,gDAAgD,CAAC;AAC3F,OAAO,EAAE,QAAQ,EAAE,MAAM,oBAAoB,CAAC;AAC9C,OAAO,EAAE,iBAAiB,EAAE,MAAM,gCAAgC,CAAC;AAEnE,IAAM,6BAA6B,GAAnC,MAAM,6BAA6B;IAClC,YACsB,kBAAuC,EAC7C,YAA2B;QAE1C,WAAW,CAAC,EAAE,CAAC,0BAA0B,EAAE,CAAC,KAAc,EAAE,GAAG,IAAe,EAAQ,EAAE;YACvF,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAA2D,CAAC;YAClF,MAAM,UAAU,GAAG,kBAAkB,CAAC,aAAa,EAAE,CAAC;YACtD,IAAI,UAAU,EAAE,CAAC;gBAChB,MAAM,QAAQ,GAAG,YAAY,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,EAAE,UAAU,CAAC,eAAe,CAAC,CAAC;gBAC7F,kBAAkB,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC;qBAChD,IAAI,CAAC,IAAI,CAAC,EAAE;oBACZ,IAAI,IAAI,EAAE,CAAC;wBACT,IAA8B,CAAC,QAAQ,GAAG,QAAQ,CAAC;wBACpD,IAAI,+BAA+B,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC;4BAClD,IAA8B,CAAC,OAAO,GAAG;gCACzC,OAAO,EAAE,+BAA+B,CAAC,OAAO,CAAC,OAAO;gCACxD,OAAO,EAAE,+BAA+B,CAAC,OAAO,CAAC,OAAO;6BACxD,CAAC;wBACH,CAAC;oBACF,CAAC;oBAED,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;gBAC9C,CAAC,CAAC;qBACD,KAAK,CAAC,CAAC,CAAC,EAAE;oBACV,MAAM,YAAY,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,kBAAkB,QAAQ,+BAA+B,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,kBAAkB,QAAQ,6BAA6B,CAAC;oBACrK,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC;gBACpE,CAAC,CAAC,CAAC;YACL,CAAC;iBAAM,CAAC;gBACP,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;YACxC,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;CACD,CAAA;AAjCK,6BAA6B;IAEhC,WAAA,mBAAmB,CAAA;IACnB,WAAA,aAAa,CAAA;GAHV,6BAA6B,CAiClC;AAED,IAAM,qCAAqC,GAA3C,MAAM,qCAAsC,SAAQ,UAAU;IAC7D,YACsB,kBAAuC,EAC3B,qBAAsD,EACpE,gBAAmC;QAEtD,KAAK,EAAE,CAAC;QAER,MAAM,UAAU,GAAG,kBAAkB,CAAC,aAAa,EAAE,CAAC;QACtD,IAAI,UAAU,EAAE,CAAC;YAChB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAC,CAAC,EAAC,EAAE;gBACpD,IAAI,CAAC,CAAC,IAAI,yDAAiD,EAAE,CAAC;oBAC7D,MAAM,aAAa,GAAG,MAAM,qBAAqB,CAAC,gBAAgB,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC;oBAC/F,IAAI,aAAa,CAAC,OAAO,IAAI,aAAa,CAAC,OAAO,CAAC,gBAAgB,EAAE,CAAC;wBACrE,MAAM,gBAAgB,CAAC,oBAAoB,CAAC,aAAa,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;oBACrF,CAAC;gBACF,CAAC;YACF,CAAC,CAAC,CAAC,CAAC;QACL,CAAC;IACF,CAAC;CACD,CAAA;AApBK,qCAAqC;IAExC,WAAA,mBAAmB,CAAA;IACnB,WAAA,+BAA+B,CAAA;IAC/B,WAAA,iBAAiB,CAAA;GAJd,qCAAqC,CAoB1C;AAED,IAAM,gCAAgC,GAAtC,MAAM,gCAAiC,SAAQ,UAAU;aAExC,OAAE,GAAG,oDAAH,AAAuD,CAAC;IAE1E,YACuC,kBAAuC,EACrC,oBAA2C;QAEnF,KAAK,EAAE,CAAC;QAH8B,uBAAkB,GAAlB,kBAAkB,CAAqB;QACrC,yBAAoB,GAApB,oBAAoB,CAAuB;QAInF,IAAI,CAAC,+BAA+B,EAAE,CAAC;QAEvC,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAAE;YAChE,IAAI,CAAC,CAAC,oBAAoB,CAAC,oBAAoB,CAAC,EAAE,CAAC;gBAClD,IAAI,CAAC,+BAA+B,EAAE,CAAC;YACxC,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,+BAA+B;QACtC,OAAO,IAAI,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,CAAC;IACnG,CAAC;;AArBI,gCAAgC;IAKnC,WAAA,mBAAmB,CAAA;IACnB,WAAA,qBAAqB,CAAA;GANlB,gCAAgC,CAsBrC;AAGD,IAAM,gCAAgC,GAAtC,MAAM,gCAAiC,SAAQ,UAAU;aAExC,OAAE,GAAG,oDAAH,AAAuD,CAAC;IAE1E,YACqC,kBAAsD,EACzD,8BAA+D,EACzE,oBAA2C,EACjD,cAA+B,EACtB,cAAwC;QAElE,KAAK,EAAE,CAAC;QAER,SAAS,kBAAkB;YAC1B,MAAM,aAAa,GAAG,oBAAoB,CAAC,QAAQ,CAAS,yBAAyB,CAAC,CAAC;YACvF,OAAO,aAAa,KAAK,aAAa,IAAI,aAAa,KAAK,6BAA6B,CAAC;QAC3F,CAAC;QAED,SAAS,kBAAkB;YAC1B,OAAO,kBAAkB,EAAE,CAAC;QAC7B,CAAC;QAED,MAAM,EAAE,eAAe,EAAE,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE,WAAW,EAAE,GAAG,kBAAkB,CAAC;QAC5G,IAAI,eAAe,IAAI,cAAc,CAAC,iBAAiB,EAAE,iCAAyB,IAAI,CAAC,WAAW,EAAE,MAAM,IAAI,CAAC,YAAY,EAAE,MAAM,IAAI,CAAC,mBAAmB,EAAE,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACrL,8BAA8B,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC1E,IAAI,kBAAkB,EAAE,EAAE,CAAC;oBAC1B,cAAc,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC;gBAC1D,CAAC;gBACD,IAAI,kBAAkB,EAAE,EAAE,CAAC;oBAC1B,cAAc,CAAC,cAAc,CAAC,0CAA0C,CAAC,CAAC;gBAC3E,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;;AAjCI,gCAAgC;IAKnC,WAAA,kCAAkC,CAAA;IAClC,WAAA,+BAA+B,CAAA;IAC/B,WAAA,qBAAqB,CAAA;IACrB,WAAA,eAAe,CAAA;IACf,WAAA,wBAAwB,CAAA;GATrB,gCAAgC,CAkCrC;AAED;;GAEG;AACH,IAAM,wBAAwB,GAA9B,MAAM,wBAAyB,SAAQ,UAAU;aAEhC,OAAE,GAAG,4CAAH,AAA+C,CAAC;IAElE,YACqB,iBAAqC,EACrC,iBAAqC,EACxC,cAA+B,EAC7B,gBAAmC;QAEtD,KAAK,EAAE,CAAC;QAER,MAAM,YAAY,GAAG,qBAAqB,CAAC;QAC3C,MAAM,UAAU,GAAG,4BAA4B,CAAC;QAEhD,MAAM,YAAY,GAAG,cAAc,CAAC,UAAU,CAAC,UAAU,qCAA4B,SAAS,CAAC,CAAC;QAEhG,MAAM,oBAAoB,GAAG,IAAI,aAAa,CAAU,YAAY,EAAE,CAAC,CAAC,YAAY,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAqB,EAAE,IAAoD,CAAC,CAAC,CAAC;QACjL,MAAM,UAAU,GAAG,oBAAoB,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;QAElE,IAAI,YAAY,KAAK,SAAS,EAAE,CAAC;YAChC,gBAAgB,CAAC,IAAI,mCAA2B,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE;gBAChE,iBAAiB,CAAC,sBAAsB,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;oBACrD,IAAI,GAAG,EAAE,CAAC;wBACT,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;wBACrB,6BAA6B;wBAC7B,cAAc,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,mEAAkD,CAAC;oBACzF,CAAC;gBACF,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;;AA/BI,wBAAwB;IAK3B,WAAA,kBAAkB,CAAA;IAClB,WAAA,kBAAkB,CAAA;IAClB,WAAA,eAAe,CAAA;IACf,WAAA,iBAAiB,CAAA;GARd,wBAAwB,CAgC7B;AAED,MAAM,8BAA8B,GAAG,QAAQ,CAAC,EAAE,CAAkC,gCAAgC,CAAC,SAAS,CAAC,CAAC;AAChI,8BAA8B,CAAC,6BAA6B,CAAC,6BAA6B,oCAA4B,CAAC;AACvH,8BAA8B,CAAC,6BAA6B,CAAC,qCAAqC,oCAA4B,CAAC;AAC/H,8BAA8B,CAAC,gCAAgC,CAAC,EAAE,EAAE,gCAAgC,sCAA8B,CAAC;AACnI,8BAA8B,CAAC,gCAAgC,CAAC,EAAE,EAAE,gCAAgC,sCAA8B,CAAC;AACnI,IAAI,SAAS,EAAE,CAAC;IACf,8BAA8B,CAAC,wBAAwB,CAAC,EAAE,EAAE,wBAAwB,sCAA8B,CAAC;AACpH,CAAC;AAED,QAAQ,CAAC,EAAE,CAAyB,uBAAuB,CAAC,aAAa,CAAC;KACxE,qBAAqB,CAAC;IACtB,EAAE,EAAE,QAAQ;IACZ,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAQ,EAAE,IAAQ,CAAC;IACvC,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACX,kCAAkC,EAAE;YACnC,IAAI,EAAE,SAAS;YACf,mBAAmB,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAkC,EAAE,IAAyE,CAAC;YAChJ,OAAO,EAAE,KAAK;SACd;KACD;CACD,CAAC,CAAC;AAEJ,IAAI,WAAW,EAAE,CAAC;IACjB,mBAAmB,CAAC,gCAAgC,CAAC;QACpD,EAAE,EAAE,0BAA0B,CAAC,EAAE;QACjC,MAAM,6CAAmC;QACzC,OAAO,EAAE,iDAA6B;QACtC,IAAI,EAAE,uBAAuB;QAC7B,QAAQ,EAAE,EAAE,WAAW,EAAE,0BAA0B,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE;QACrE,OAAO,EAAE,0BAA0B,CAAC,OAAO,EAAE;KAC7C,CAAC,CAAC;AACJ,CAAC;KAAM,CAAC;IACP,mBAAmB,CAAC,gCAAgC,CAAC;QACpD,EAAE,EAAE,oBAAoB,CAAC,EAAE;QAC3B,MAAM,6CAAmC;QACzC,OAAO,EAAE,iDAA6B;QACtC,IAAI,EAAE,uBAAuB;QAC7B,QAAQ,EAAE,EAAE,WAAW,EAAE,oBAAoB,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE;QAC/D,OAAO,EAAE,oBAAoB,CAAC,OAAO,EAAE;KACvC,CAAC,CAAC;IACH,mBAAmB,CAAC,gCAAgC,CAAC;QACpD,EAAE,EAAE,sBAAsB,CAAC,EAAE;QAC7B,MAAM,6CAAmC;QACzC,OAAO,EAAE,QAAQ,CAAC,iDAA6B,EAAE,iDAA6B,CAAC;QAC/E,IAAI,EAAE,uBAAuB;QAC7B,QAAQ,EAAE,EAAE,WAAW,EAAE,sBAAsB,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE;QACjE,OAAO,EAAE,sBAAsB,CAAC,OAAO,EAAE;KACzC,CAAC,CAAC;AACJ,CAAC;AAED,mBAAmB,CAAC,gCAAgC,CAAC;IACpD,EAAE,EAAE,oBAAoB,CAAC,EAAE;IAC3B,MAAM,6CAAmC;IACzC,OAAO,EAAE,mDAA6B,wBAAe;IACrD,IAAI,EAAE,uBAAuB;IAC7B,QAAQ,EAAE,EAAE,WAAW,EAAE,oBAAoB,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE;IAC/D,OAAO,EAAE,oBAAoB,CAAC,OAAO,EAAE;CACvC,CAAC,CAAC;AAEH,eAAe,CAAC,KAAM,SAAQ,OAAO;IACpC;QACC,KAAK,CAAC;YACL,EAAE,EAAE,0CAA0C;YAC9C,KAAK,EAAE,QAAQ,CAAC,KAAiC,EAAE,IAA8B,CAAC;YAClF,QAAQ,EAAE,QAAQ,CAAC,KAAiB,EAAE,IAAQ,CAAC;YAC/C,IAAI,EAAE,CAAC;oBACN,EAAE,EAAE,MAAM,CAAC,cAAc;iBACzB,CAAC;YACF,YAAY,EAAE,cAAc,CAAC,GAAG,CAAC,cAAc,CAAC,SAAS,CAAC,UAAU,wBAAwB,EAAE,EAAE,+BAA+B,CAAC,EAAE,iBAAiB,CAAC;SACpJ,CAAC,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,GAAG,CAAC,QAA0B;QACnC,MAAM,qBAAqB,GAAG,QAAQ,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;QACnE,MAAM,KAAK,GAAa,EAAE,CAAC;QAC3B,qFAAqF;QACrF,MAAM,SAAS,GAAG,qBAAqB,CAAC,WAAW,CAAC,SAAS,CAAC;QAC9D,KAAK,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,IAAI,SAAS,EAAE,CAAC;YACrC,IAAI,MAAM,CAAC,iBAAiB,KAAK,KAAK,EAAE,CAAC;gBACxC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpB,CAAC;QACF,CAAC;QAED,mCAAmC;QACnC,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;YAClB,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;gBAC1B,MAAM,qBAAqB,CAAC,KAAK,CAAC;oBACjC,IAAI,EAAE,IAAI,CAAC,UAAU;oBACrB,IAAI,EAAE,IAAI,CAAC,UAAU;iBACrB,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAC5B,CAAC;QACF,CAAC;IACF,CAAC;CACD,CAAC,CAAC","file":"remote.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IRemoteAgentService, remoteConnectionLatencyMeasurer } from '../../../services/remote/common/remoteAgentService.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { isMacintosh, isWindows } from '../../../../base/common/platform.js';\nimport { KeyMod, KeyChord, KeyCode } from '../../../../base/common/keyCodes.js';\nimport { KeybindingsRegistry, KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IWorkbenchContribution, IWorkbenchContributionsRegistry, WorkbenchPhase, Extensions as WorkbenchContributionsExtensions, registerWorkbenchContribution2 } from '../../../common/contributions.js';\nimport { ILifecycleService, LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\nimport { ipcRenderer } from '../../../../base/parts/sandbox/electron-browser/globals.js';\nimport { IDiagnosticInfoOptions, IRemoteDiagnosticInfo } from '../../../../platform/diagnostics/common/diagnostics.js';\nimport { INativeWorkbenchEnvironmentService } from '../../../services/environment/electron-browser/environmentService.js';\nimport { PersistentConnectionEventType } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IConfigurationRegistry, Extensions as ConfigurationExtensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { IRemoteAuthorityResolverService } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { OpenLocalFileFolderCommand, OpenLocalFileCommand, OpenLocalFolderCommand, SaveLocalFileCommand, RemoteFileDialogContext } from '../../../services/dialogs/browser/simpleFileDialog.js';\nimport { IWorkspaceContextService, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { TELEMETRY_SETTING_ID } from '../../../../platform/telemetry/common/telemetry.js';\nimport { getTelemetryLevel } from '../../../../platform/telemetry/common/telemetryUtils.js';\nimport { IContextKeyService, RawContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { Action2, MenuId, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IRemoteExplorerService, PORT_AUTO_SOURCE_SETTING, PORT_AUTO_SOURCE_SETTING_OUTPUT } from '../../../services/remote/common/remoteExplorerService.js';\nimport { Tunnel, TunnelCloseReason } from '../../../services/remote/common/tunnelModel.js';\nimport { localize } from '../../../../nls.js';\nimport { RemoteNameContext } from '../../../common/contextkeys.js';\n\nclass RemoteAgentDiagnosticListener implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@ILabelService labelService: ILabelService\n\t) {\n\t\tipcRenderer.on('vscode:getDiagnosticInfo', (event: unknown, ...args: unknown[]): void => {\n\t\t\tconst request = args[0] as { replyChannel: string; args: IDiagnosticInfoOptions };\n\t\t\tconst connection = remoteAgentService.getConnection();\n\t\t\tif (connection) {\n\t\t\t\tconst hostName = labelService.getHostLabel(Schemas.vscodeRemote, connection.remoteAuthority);\n\t\t\t\tremoteAgentService.getDiagnosticInfo(request.args)\n\t\t\t\t\t.then(info => {\n\t\t\t\t\t\tif (info) {\n\t\t\t\t\t\t\t(info as IRemoteDiagnosticInfo).hostName = hostName;\n\t\t\t\t\t\t\tif (remoteConnectionLatencyMeasurer.latency?.high) {\n\t\t\t\t\t\t\t\t(info as IRemoteDiagnosticInfo).latency = {\n\t\t\t\t\t\t\t\t\taverage: remoteConnectionLatencyMeasurer.latency.average,\n\t\t\t\t\t\t\t\t\tcurrent: remoteConnectionLatencyMeasurer.latency.current\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tipcRenderer.send(request.replyChannel, info);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\tconst errorMessage = e && e.message ? `Connection to '${hostName}' could not be established  ${e.message}` : `Connection to '${hostName}' could not be established `;\n\t\t\t\t\t\tipcRenderer.send(request.replyChannel, { hostName, errorMessage });\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tipcRenderer.send(request.replyChannel);\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass RemoteExtensionHostEnvironmentUpdater extends Disposable implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteAuthorityResolverService remoteResolverService: IRemoteAuthorityResolverService,\n\t\t@IExtensionService extensionService: IExtensionService\n\t) {\n\t\tsuper();\n\n\t\tconst connection = remoteAgentService.getConnection();\n\t\tif (connection) {\n\t\t\tthis._register(connection.onDidStateChange(async e => {\n\t\t\t\tif (e.type === PersistentConnectionEventType.ConnectionGain) {\n\t\t\t\t\tconst resolveResult = await remoteResolverService.resolveAuthority(connection.remoteAuthority);\n\t\t\t\t\tif (resolveResult.options && resolveResult.options.extensionHostEnv) {\n\t\t\t\t\t\tawait extensionService.setRemoteEnvironment(resolveResult.options.extensionHostEnv);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n}\n\nclass RemoteTelemetryEnablementUpdater extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.remoteTelemetryEnablementUpdater';\n\n\tconstructor(\n\t\t@IRemoteAgentService private readonly remoteAgentService: IRemoteAgentService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\n\t\tthis.updateRemoteTelemetryEnablement();\n\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TELEMETRY_SETTING_ID)) {\n\t\t\t\tthis.updateRemoteTelemetryEnablement();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateRemoteTelemetryEnablement(): Promise<void> {\n\t\treturn this.remoteAgentService.updateTelemetryLevel(getTelemetryLevel(this.configurationService));\n\t}\n}\n\n\nclass RemoteEmptyWorkbenchPresentation extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.remoteEmptyWorkbenchPresentation';\n\n\tconstructor(\n\t\t@INativeWorkbenchEnvironmentService environmentService: INativeWorkbenchEnvironmentService,\n\t\t@IRemoteAuthorityResolverService remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IWorkspaceContextService contextService: IWorkspaceContextService\n\t) {\n\t\tsuper();\n\n\t\tfunction shouldShowExplorer(): boolean {\n\t\t\tconst startupEditor = configurationService.getValue<string>('workbench.startupEditor');\n\t\t\treturn startupEditor !== 'welcomePage' && startupEditor !== 'welcomePageInEmptyWorkbench';\n\t\t}\n\n\t\tfunction shouldShowTerminal(): boolean {\n\t\t\treturn shouldShowExplorer();\n\t\t}\n\n\t\tconst { remoteAuthority, filesToDiff, filesToMerge, filesToOpenOrCreate, filesToWait } = environmentService;\n\t\tif (remoteAuthority && contextService.getWorkbenchState() === WorkbenchState.EMPTY && !filesToDiff?.length && !filesToMerge?.length && !filesToOpenOrCreate?.length && !filesToWait) {\n\t\t\tremoteAuthorityResolverService.resolveAuthority(remoteAuthority).then(() => {\n\t\t\t\tif (shouldShowExplorer()) {\n\t\t\t\t\tcommandService.executeCommand('workbench.view.explorer');\n\t\t\t\t}\n\t\t\t\tif (shouldShowTerminal()) {\n\t\t\t\t\tcommandService.executeCommand('workbench.action.terminal.toggleTerminal');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * Sets the 'wslFeatureInstalled' context key if the WSL feature is or was installed on this machine.\n */\nclass WSLContextKeyInitializer extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.wslContextKeyInitializer';\n\n\tconstructor(\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@INativeHostService nativeHostService: INativeHostService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService\n\t) {\n\t\tsuper();\n\n\t\tconst contextKeyId = 'wslFeatureInstalled';\n\t\tconst storageKey = 'remote.wslFeatureInstalled';\n\n\t\tconst defaultValue = storageService.getBoolean(storageKey, StorageScope.APPLICATION, undefined);\n\n\t\tconst hasWSLFeatureContext = new RawContextKey<boolean>(contextKeyId, !!defaultValue, nls.localize('wslFeatureInstalled', \"Whether the platform has the WSL feature installed\"));\n\t\tconst contextKey = hasWSLFeatureContext.bindTo(contextKeyService);\n\n\t\tif (defaultValue === undefined) {\n\t\t\tlifecycleService.when(LifecyclePhase.Eventually).then(async () => {\n\t\t\t\tnativeHostService.hasWSLFeatureInstalled().then(res => {\n\t\t\t\t\tif (res) {\n\t\t\t\t\t\tcontextKey.set(true);\n\t\t\t\t\t\t// once detected, set to true\n\t\t\t\t\t\tstorageService.store(storageKey, true, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(WorkbenchContributionsExtensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(RemoteAgentDiagnosticListener, LifecyclePhase.Eventually);\nworkbenchContributionsRegistry.registerWorkbenchContribution(RemoteExtensionHostEnvironmentUpdater, LifecyclePhase.Eventually);\nregisterWorkbenchContribution2(RemoteTelemetryEnablementUpdater.ID, RemoteTelemetryEnablementUpdater, WorkbenchPhase.BlockRestore);\nregisterWorkbenchContribution2(RemoteEmptyWorkbenchPresentation.ID, RemoteEmptyWorkbenchPresentation, WorkbenchPhase.BlockRestore);\nif (isWindows) {\n\tregisterWorkbenchContribution2(WSLContextKeyInitializer.ID, WSLContextKeyInitializer, WorkbenchPhase.BlockRestore);\n}\n\nRegistry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration)\n\t.registerConfiguration({\n\t\tid: 'remote',\n\t\ttitle: nls.localize('remote', \"Remote\"),\n\t\ttype: 'object',\n\t\tproperties: {\n\t\t\t'remote.downloadExtensionsLocally': {\n\t\t\t\ttype: 'boolean',\n\t\t\t\tmarkdownDescription: nls.localize('remote.downloadExtensionsLocally', \"When enabled extensions are downloaded locally and installed on remote.\"),\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t}\n\t});\n\nif (isMacintosh) {\n\tKeybindingsRegistry.registerCommandAndKeybindingRule({\n\t\tid: OpenLocalFileFolderCommand.ID,\n\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyO,\n\t\twhen: RemoteFileDialogContext,\n\t\tmetadata: { description: OpenLocalFileFolderCommand.LABEL, args: [] },\n\t\thandler: OpenLocalFileFolderCommand.handler()\n\t});\n} else {\n\tKeybindingsRegistry.registerCommandAndKeybindingRule({\n\t\tid: OpenLocalFileCommand.ID,\n\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyO,\n\t\twhen: RemoteFileDialogContext,\n\t\tmetadata: { description: OpenLocalFileCommand.LABEL, args: [] },\n\t\thandler: OpenLocalFileCommand.handler()\n\t});\n\tKeybindingsRegistry.registerCommandAndKeybindingRule({\n\t\tid: OpenLocalFolderCommand.ID,\n\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KeyK, KeyMod.CtrlCmd | KeyCode.KeyO),\n\t\twhen: RemoteFileDialogContext,\n\t\tmetadata: { description: OpenLocalFolderCommand.LABEL, args: [] },\n\t\thandler: OpenLocalFolderCommand.handler()\n\t});\n}\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: SaveLocalFileCommand.ID,\n\tweight: KeybindingWeight.WorkbenchContrib,\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KeyS,\n\twhen: RemoteFileDialogContext,\n\tmetadata: { description: SaveLocalFileCommand.LABEL, args: [] },\n\thandler: SaveLocalFileCommand.handler()\n});\n\nregisterAction2(class extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.remote.action.closeUnusedPorts',\n\t\t\ttitle: localize('remote.actions.closeUnusedPorts', 'Close Unused Forwarded Ports'),\n\t\t\tcategory: localize('remote.category', 'Remote'),\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.CommandPalette\n\t\t\t}],\n\t\t\tprecondition: ContextKeyExpr.and(ContextKeyExpr.notEquals(`config.${PORT_AUTO_SOURCE_SETTING}`, PORT_AUTO_SOURCE_SETTING_OUTPUT), RemoteNameContext)\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tconst remoteExplorerService = accessor.get(IRemoteExplorerService);\n\t\tconst ports: Tunnel[] = [];\n\t\t// collect all forwarded ports and filter out those who do not have a process running\n\t\tconst forwarded = remoteExplorerService.tunnelModel.forwarded;\n\t\tfor (const [_, tunnel] of forwarded) {\n\t\t\tif (tunnel.hasRunningProcess === false) {\n\t\t\t\tports.push(tunnel);\n\t\t\t}\n\t\t}\n\n\t\t// Close the collected unused ports\n\t\tif (ports.length) {\n\t\t\tfor (const port of ports) {\n\t\t\t\tawait remoteExplorerService.close({\n\t\t\t\t\thost: port.remoteHost,\n\t\t\t\t\tport: port.remotePort\n\t\t\t\t}, TunnelCloseReason.User);\n\t\t\t}\n\t\t}\n\t}\n});\n"]}