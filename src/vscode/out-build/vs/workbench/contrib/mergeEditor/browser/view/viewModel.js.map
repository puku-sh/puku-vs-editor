{"version":3,"sources":["vs/workbench/contrib/mergeEditor/browser/view/viewModel.ts"],"names":[],"mappings":"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","file":"viewModel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { findLast } from '../../../../../base/common/arraysFind.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { derived, derivedObservableWithWritableCache, IObservable, IReader, ITransaction, observableValue, transaction } from '../../../../../base/common/observable.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { ScrollType } from '../../../../../editor/common/editorCommon.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { localize } from '../../../../../nls.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { MergeEditorLineRange } from '../model/lineRange.js';\nimport { MergeEditorModel } from '../model/mergeEditorModel.js';\nimport { InputNumber, ModifiedBaseRange, ModifiedBaseRangeState } from '../model/modifiedBaseRange.js';\nimport { observableConfigValue } from '../../../../../platform/observable/common/platformObservableUtils.js';\nimport { BaseCodeEditorView } from './editors/baseCodeEditorView.js';\nimport { CodeEditorView } from './editors/codeEditorView.js';\nimport { InputCodeEditorView } from './editors/inputCodeEditorView.js';\nimport { ResultCodeEditorView } from './editors/resultCodeEditorView.js';\n\nexport class MergeEditorViewModel extends Disposable {\n\tprivate readonly manuallySetActiveModifiedBaseRange;\n\n\tprivate readonly attachedHistory;\n\n\tconstructor(\n\t\tpublic readonly model: MergeEditorModel,\n\t\tpublic readonly inputCodeEditorView1: InputCodeEditorView,\n\t\tpublic readonly inputCodeEditorView2: InputCodeEditorView,\n\t\tpublic readonly resultCodeEditorView: ResultCodeEditorView,\n\t\tpublic readonly baseCodeEditorView: IObservable<BaseCodeEditorView | undefined>,\n\t\tpublic readonly showNonConflictingChanges: IObservable<boolean>,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t) {\n\t\tsuper();\n\t\tthis.manuallySetActiveModifiedBaseRange = observableValue<\n\t\t\t{ range: ModifiedBaseRange | undefined; counter: number }\n\t\t>(this, { range: undefined, counter: 0 });\n\t\tthis.attachedHistory = this._register(new AttachedHistory(this.model.resultTextModel));\n\t\tthis.shouldUseAppendInsteadOfAccept = observableConfigValue<boolean>(\n\t\t\t'mergeEditor.shouldUseAppendInsteadOfAccept',\n\t\t\tfalse,\n\t\t\tthis.configurationService,\n\t\t);\n\t\tthis.counter = 0;\n\t\tthis.lastFocusedEditor = derivedObservableWithWritableCache<\n\t\t\t{ view: CodeEditorView | undefined; counter: number }\n\t\t>(this, (reader, lastValue) => {\n\t\t\tconst editors = [\n\t\t\t\tthis.inputCodeEditorView1,\n\t\t\t\tthis.inputCodeEditorView2,\n\t\t\t\tthis.resultCodeEditorView,\n\t\t\t\tthis.baseCodeEditorView.read(reader),\n\t\t\t];\n\t\t\tconst view = editors.find((e) => e && e.isFocused.read(reader));\n\t\t\treturn view ? { view, counter: this.counter++ } : lastValue || { view: undefined, counter: this.counter++ };\n\t\t});\n\t\tthis.baseShowDiffAgainst = derived<1 | 2 | undefined>(this, reader => {\n\t\t\tconst lastFocusedEditor = this.lastFocusedEditor.read(reader);\n\t\t\tif (lastFocusedEditor.view === this.inputCodeEditorView1) {\n\t\t\t\treturn 1;\n\t\t\t} else if (lastFocusedEditor.view === this.inputCodeEditorView2) {\n\t\t\t\treturn 2;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t\tthis.focusedEditorType = derived<MergeEditorType | undefined>(this, reader => {\n\t\t\tconst lastFocusedEditor = this.lastFocusedEditor.read(reader);\n\n\t\t\tif (!lastFocusedEditor.view) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (lastFocusedEditor.view === this.inputCodeEditorView1) {\n\t\t\t\treturn 'input1';\n\t\t\t} else if (lastFocusedEditor.view === this.inputCodeEditorView2) {\n\t\t\t\treturn 'input2';\n\t\t\t} else if (lastFocusedEditor.view === this.resultCodeEditorView) {\n\t\t\t\treturn 'result';\n\t\t\t} else if (lastFocusedEditor.view === this.baseCodeEditorView.read(reader)) {\n\t\t\t\treturn 'base';\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t});\n\t\tthis.selectionInBase = derived(this, reader => {\n\t\t\tconst sourceEditor = this.lastFocusedEditor.read(reader).view;\n\t\t\tif (!sourceEditor) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tconst selections = sourceEditor.selection.read(reader) || [];\n\n\t\t\tconst rangesInBase = selections.map((selection) => {\n\t\t\t\tif (sourceEditor === this.inputCodeEditorView1) {\n\t\t\t\t\treturn this.model.translateInputRangeToBase(1, selection);\n\t\t\t\t} else if (sourceEditor === this.inputCodeEditorView2) {\n\t\t\t\t\treturn this.model.translateInputRangeToBase(2, selection);\n\t\t\t\t} else if (sourceEditor === this.resultCodeEditorView) {\n\t\t\t\t\treturn this.model.translateResultRangeToBase(selection);\n\t\t\t\t} else if (sourceEditor === this.baseCodeEditorView.read(reader)) {\n\t\t\t\t\treturn selection;\n\t\t\t\t} else {\n\t\t\t\t\treturn selection;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\trangesInBase,\n\t\t\t\tsourceEditor\n\t\t\t};\n\t\t});\n\t\tthis.activeModifiedBaseRange = derived(this,\n\t\t\t(reader) => {\n\t\t\t\t/** @description activeModifiedBaseRange */\n\t\t\t\tconst focusedEditor = this.lastFocusedEditor.read(reader);\n\t\t\t\tconst manualRange = this.manuallySetActiveModifiedBaseRange.read(reader);\n\t\t\t\tif (manualRange.counter > focusedEditor.counter) {\n\t\t\t\t\treturn manualRange.range;\n\t\t\t\t}\n\n\t\t\t\tif (!focusedEditor.view) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cursorLineNumber = focusedEditor.view.cursorLineNumber.read(reader);\n\t\t\t\tif (!cursorLineNumber) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tconst modifiedBaseRanges = this.model.modifiedBaseRanges.read(reader);\n\t\t\t\treturn modifiedBaseRanges.find((r) => {\n\t\t\t\t\tconst range = this.getRangeOfModifiedBaseRange(focusedEditor.view!, r, reader);\n\t\t\t\t\treturn range.isEmpty\n\t\t\t\t\t\t? range.startLineNumber === cursorLineNumber\n\t\t\t\t\t\t: range.contains(cursorLineNumber);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\n\t\tthis._register(resultCodeEditorView.editor.onDidChangeModelContent(e => {\n\t\t\tif (this.model.isApplyingEditInResult || e.isRedoing || e.isUndoing) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst baseRangeStates: ModifiedBaseRange[] = [];\n\n\t\t\tfor (const change of e.changes) {\n\t\t\t\tconst rangeInBase = this.model.translateResultRangeToBase(Range.lift(change.range));\n\t\t\t\tconst baseRanges = this.model.findModifiedBaseRangesInRange(MergeEditorLineRange.fromLength(rangeInBase.startLineNumber, rangeInBase.endLineNumber - rangeInBase.startLineNumber));\n\t\t\t\tif (baseRanges.length === 1) {\n\t\t\t\t\tconst isHandled = this.model.isHandled(baseRanges[0]).get();\n\t\t\t\t\tif (!isHandled) {\n\t\t\t\t\t\tbaseRangeStates.push(baseRanges[0]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (baseRangeStates.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst element = {\n\t\t\t\tmodel: this.model,\n\t\t\t\tredo() {\n\t\t\t\t\ttransaction(tx => {\n\t\t\t\t\t\t/** @description Mark conflicts touched by manual edits as handled */\n\t\t\t\t\t\tfor (const r of baseRangeStates) {\n\t\t\t\t\t\t\tthis.model.setHandled(r, true, tx);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tundo() {\n\t\t\t\t\ttransaction(tx => {\n\t\t\t\t\t\t/** @description Mark conflicts touched by manual edits as handled */\n\t\t\t\t\t\tfor (const r of baseRangeStates) {\n\t\t\t\t\t\t\tthis.model.setHandled(r, false, tx);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.attachedHistory.pushAttachedHistoryElement(element);\n\t\t\telement.redo();\n\t\t}));\n\t}\n\n\tpublic readonly shouldUseAppendInsteadOfAccept;\n\n\tprivate counter;\n\tprivate readonly lastFocusedEditor;\n\n\tpublic readonly baseShowDiffAgainst;\n\n\t/**\n\t * Returns an observable that tracks which editor type is currently focused\n\t */\n\tpublic readonly focusedEditorType;\n\n\tpublic readonly selectionInBase;\n\n\tprivate getRangeOfModifiedBaseRange(editor: CodeEditorView, modifiedBaseRange: ModifiedBaseRange, reader: IReader | undefined): MergeEditorLineRange {\n\t\tif (editor === this.resultCodeEditorView) {\n\t\t\treturn this.model.getLineRangeInResult(modifiedBaseRange.baseRange, reader);\n\t\t} else if (editor === this.baseCodeEditorView.get()) {\n\t\t\treturn modifiedBaseRange.baseRange;\n\t\t} else {\n\t\t\tconst input = editor === this.inputCodeEditorView1 ? 1 : 2;\n\t\t\treturn modifiedBaseRange.getInputRange(input);\n\t\t}\n\t}\n\n\tpublic readonly activeModifiedBaseRange;\n\n\tpublic setActiveModifiedBaseRange(range: ModifiedBaseRange | undefined, tx: ITransaction): void {\n\t\tthis.manuallySetActiveModifiedBaseRange.set({ range, counter: this.counter++ }, tx);\n\t}\n\n\tpublic setState(\n\t\tbaseRange: ModifiedBaseRange,\n\t\tstate: ModifiedBaseRangeState,\n\t\ttx: ITransaction,\n\t\tinputNumber: InputNumber,\n\t): void {\n\t\tthis.manuallySetActiveModifiedBaseRange.set({ range: baseRange, counter: this.counter++ }, tx);\n\t\tthis.model.setState(baseRange, state, inputNumber, tx);\n\t\tthis.lastFocusedEditor.clearCache(tx);\n\t}\n\n\tprivate goToConflict(getModifiedBaseRange: (editor: CodeEditorView, curLineNumber: number) => ModifiedBaseRange | undefined): void {\n\t\tlet editor = this.lastFocusedEditor.get().view;\n\t\tif (!editor) {\n\t\t\teditor = this.resultCodeEditorView;\n\t\t}\n\t\tconst curLineNumber = editor.editor.getPosition()?.lineNumber;\n\t\tif (curLineNumber === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tconst modifiedBaseRange = getModifiedBaseRange(editor, curLineNumber);\n\t\tif (modifiedBaseRange) {\n\t\t\tconst range = this.getRangeOfModifiedBaseRange(editor, modifiedBaseRange, undefined);\n\t\t\teditor.editor.focus();\n\n\t\t\tlet startLineNumber = range.startLineNumber;\n\t\t\tlet endLineNumberExclusive = range.endLineNumberExclusive;\n\t\t\tif (range.startLineNumber > editor.editor.getModel()!.getLineCount()) {\n\t\t\t\ttransaction(tx => {\n\t\t\t\t\tthis.setActiveModifiedBaseRange(modifiedBaseRange, tx);\n\t\t\t\t});\n\t\t\t\tstartLineNumber = endLineNumberExclusive = editor.editor.getModel()!.getLineCount();\n\t\t\t}\n\n\t\t\teditor.editor.setPosition({\n\t\t\t\tlineNumber: startLineNumber,\n\t\t\t\tcolumn: editor.editor.getModel()!.getLineFirstNonWhitespaceColumn(startLineNumber),\n\t\t\t});\n\t\t\teditor.editor.revealLinesNearTop(startLineNumber, endLineNumberExclusive, ScrollType.Smooth);\n\t\t}\n\t}\n\n\tpublic goToNextModifiedBaseRange(predicate: (m: ModifiedBaseRange) => boolean): void {\n\t\tthis.goToConflict(\n\t\t\t(e, l) =>\n\t\t\t\tthis.model.modifiedBaseRanges\n\t\t\t\t\t.get()\n\t\t\t\t\t.find(\n\t\t\t\t\t\t(r) =>\n\t\t\t\t\t\t\tpredicate(r) &&\n\t\t\t\t\t\t\tthis.getRangeOfModifiedBaseRange(e, r, undefined).startLineNumber > l\n\t\t\t\t\t) ||\n\t\t\t\tthis.model.modifiedBaseRanges\n\t\t\t\t\t.get()\n\t\t\t\t\t.find((r) => predicate(r))\n\t\t);\n\t}\n\n\tpublic goToPreviousModifiedBaseRange(predicate: (m: ModifiedBaseRange) => boolean): void {\n\t\tthis.goToConflict(\n\t\t\t(e, l) =>\n\t\t\t\tfindLast(\n\t\t\t\t\tthis.model.modifiedBaseRanges.get(),\n\t\t\t\t\t(r) =>\n\t\t\t\t\t\tpredicate(r) &&\n\t\t\t\t\t\tthis.getRangeOfModifiedBaseRange(e, r, undefined).endLineNumberExclusive < l\n\t\t\t\t) ||\n\t\t\t\tfindLast(\n\t\t\t\t\tthis.model.modifiedBaseRanges.get(),\n\t\t\t\t\t(r) => predicate(r)\n\t\t\t\t)\n\t\t);\n\t}\n\n\tpublic toggleActiveConflict(inputNumber: 1 | 2): void {\n\t\tconst activeModifiedBaseRange = this.activeModifiedBaseRange.get();\n\t\tif (!activeModifiedBaseRange) {\n\t\t\tthis.notificationService.error(localize('noConflictMessage', \"There is currently no conflict focused that can be toggled.\"));\n\t\t\treturn;\n\t\t}\n\t\ttransaction(tx => {\n\t\t\t/** @description Toggle Active Conflict */\n\t\t\tthis.setState(\n\t\t\t\tactiveModifiedBaseRange,\n\t\t\t\tthis.model.getState(activeModifiedBaseRange).get().toggle(inputNumber),\n\t\t\t\ttx,\n\t\t\t\tinputNumber,\n\t\t\t);\n\t\t});\n\t}\n\n\tpublic acceptAll(inputNumber: 1 | 2): void {\n\t\ttransaction(tx => {\n\t\t\t/** @description Toggle Active Conflict */\n\t\t\tfor (const range of this.model.modifiedBaseRanges.get()) {\n\t\t\t\tthis.setState(\n\t\t\t\t\trange,\n\t\t\t\t\tthis.model.getState(range).get().withInputValue(inputNumber, true),\n\t\t\t\t\ttx,\n\t\t\t\t\tinputNumber\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass AttachedHistory extends Disposable {\n\tprivate readonly attachedHistory: { element: IAttachedHistoryElement; altId: number }[];\n\tprivate previousAltId: number;\n\n\tconstructor(private readonly model: ITextModel) {\n\t\tsuper();\n\t\tthis.attachedHistory = [];\n\t\tthis.previousAltId = this.model.getAlternativeVersionId();\n\n\t\tthis._register(model.onDidChangeContent((e) => {\n\t\t\tconst currentAltId = model.getAlternativeVersionId();\n\n\t\t\tif (e.isRedoing) {\n\t\t\t\tfor (const item of this.attachedHistory) {\n\t\t\t\t\tif (this.previousAltId < item.altId && item.altId <= currentAltId) {\n\t\t\t\t\t\titem.element.redo();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (e.isUndoing) {\n\t\t\t\tfor (let i = this.attachedHistory.length - 1; i >= 0; i--) {\n\t\t\t\t\tconst item = this.attachedHistory[i];\n\t\t\t\t\tif (currentAltId < item.altId && item.altId <= this.previousAltId) {\n\t\t\t\t\t\titem.element.undo();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// The user destroyed the redo stack by performing a non redo/undo operation.\n\t\t\t\t// Thus we also need to remove all history elements after the last version id.\n\t\t\t\twhile (\n\t\t\t\t\tthis.attachedHistory.length > 0\n\t\t\t\t\t&& this.attachedHistory[this.attachedHistory.length - 1]!.altId > this.previousAltId\n\t\t\t\t) {\n\t\t\t\t\tthis.attachedHistory.pop();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.previousAltId = currentAltId;\n\t\t}));\n\t}\n\n\t/**\n\t * Pushes an history item that is tied to the last text edit (or an extension of it).\n\t * When the last text edit is undone/redone, so is is this history item.\n\t */\n\tpublic pushAttachedHistoryElement(element: IAttachedHistoryElement): void {\n\t\tthis.attachedHistory.push({ altId: this.model.getAlternativeVersionId(), element });\n\t}\n}\n\ninterface IAttachedHistoryElement {\n\tundo(): void;\n\tredo(): void;\n}\n\nexport type MergeEditorType = 'input1' | 'input2' | 'result' | 'base';\n"]}