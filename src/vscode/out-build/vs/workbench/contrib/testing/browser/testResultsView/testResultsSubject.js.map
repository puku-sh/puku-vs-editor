{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/testing/browser/testResultsView/testResultsSubject.ts","vs/workbench/contrib/testing/browser/testResultsView/testResultsSubject.ts"],"names":[],"mappings":"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","file":"testResultsSubject.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n\nimport { MarshalledId } from '../../../../../base/common/marshallingIds.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { TestId } from '../../common/testId.js';\nimport { ITestResult } from '../../common/testResult.js';\nimport { IRichLocation, ITestItem, ITestMessage, ITestMessageMenuArgs, ITestRunTask, ITestTaskState, InternalTestItem, TestMessageType, TestResultItem } from '../../common/testTypes.js';\nimport { TestUriType, buildTestUri } from '../../common/testingUri.js';\n\nexport const getMessageArgs = (test: TestResultItem, message: ITestMessage): ITestMessageMenuArgs => ({\n\t$mid: MarshalledId.TestMessageMenuArgs,\n\ttest: InternalTestItem.serialize(test),\n\tmessage: ITestMessage.serialize(message),\n});\n\ninterface ISubjectCommon {\n\tcontrollerId: string;\n}\n\nexport const inspectSubjectHasStack = (subject: InspectSubject | undefined) =>\n\tsubject instanceof MessageSubject && !!subject.stack?.length;\n\nexport class MessageSubject implements ISubjectCommon {\n\tpublic readonly test: ITestItem;\n\tpublic readonly message: ITestMessage;\n\tpublic readonly expectedUri: URI;\n\tpublic readonly actualUri: URI;\n\tpublic readonly messageUri: URI;\n\tpublic readonly revealLocation: IRichLocation | undefined;\n\tpublic readonly context: ITestMessageMenuArgs | undefined;\n\n\tpublic get controllerId() {\n\t\treturn TestId.root(this.test.extId);\n\t}\n\n\tpublic get isDiffable() {\n\t\treturn this.message.type === TestMessageType.Error && ITestMessage.isDiffable(this.message);\n\t}\n\n\tpublic get contextValue() {\n\t\treturn this.message.type === TestMessageType.Error ? this.message.contextValue : undefined;\n\t}\n\n\tpublic get stack() {\n\t\treturn this.message.type === TestMessageType.Error && this.message.stackTrace?.length ? this.message.stackTrace : undefined;\n\t}\n\n\tconstructor(public readonly result: ITestResult, test: TestResultItem, public readonly taskIndex: number, public readonly messageIndex: number) {\n\t\tthis.test = test.item;\n\t\tconst messages = test.tasks[taskIndex].messages;\n\t\tthis.messageIndex = messageIndex;\n\n\t\tconst parts = { messageIndex, resultId: result.id, taskIndex, testExtId: test.item.extId };\n\t\tthis.expectedUri = buildTestUri({ ...parts, type: TestUriType.ResultExpectedOutput });\n\t\tthis.actualUri = buildTestUri({ ...parts, type: TestUriType.ResultActualOutput });\n\t\tthis.messageUri = buildTestUri({ ...parts, type: TestUriType.ResultMessage });\n\n\t\tconst message = this.message = messages[this.messageIndex];\n\t\tthis.context = getMessageArgs(test, message);\n\t\tthis.revealLocation = message.location ?? (test.item.uri && test.item.range ? { uri: test.item.uri, range: Range.lift(test.item.range) } : undefined);\n\t}\n}\n\nexport class TaskSubject implements ISubjectCommon {\n\tpublic readonly outputUri: URI;\n\tpublic readonly revealLocation: undefined;\n\n\tpublic get controllerId() {\n\t\treturn this.result.tasks[this.taskIndex].ctrlId;\n\t}\n\n\tconstructor(public readonly result: ITestResult, public readonly taskIndex: number) {\n\t\tthis.outputUri = buildTestUri({ resultId: result.id, taskIndex, type: TestUriType.TaskOutput });\n\t}\n}\n\nexport class TestOutputSubject implements ISubjectCommon {\n\tpublic readonly outputUri: URI;\n\tpublic readonly revealLocation: undefined;\n\tpublic readonly task: ITestRunTask;\n\n\tpublic get controllerId() {\n\t\treturn TestId.root(this.test.item.extId);\n\t}\n\n\tconstructor(public readonly result: ITestResult, public readonly taskIndex: number, public readonly test: TestResultItem) {\n\t\tthis.outputUri = buildTestUri({ resultId: this.result.id, taskIndex: this.taskIndex, testExtId: this.test.item.extId, type: TestUriType.TestOutput });\n\t\tthis.task = result.tasks[this.taskIndex];\n\t}\n}\n\nexport type InspectSubject = MessageSubject | TaskSubject | TestOutputSubject;\n\nexport const equalsSubject = (a: InspectSubject, b: InspectSubject) => (\n\t(a instanceof MessageSubject && b instanceof MessageSubject && a.message === b.message) ||\n\t(a instanceof TaskSubject && b instanceof TaskSubject && a.result === b.result && a.taskIndex === b.taskIndex) ||\n\t(a instanceof TestOutputSubject && b instanceof TestOutputSubject && a.test === b.test && a.taskIndex === b.taskIndex)\n);\n\n\nexport const mapFindTestMessage = <T>(test: TestResultItem, fn: (task: ITestTaskState, message: ITestMessage, messageIndex: number, taskIndex: number) => T | undefined) => {\n\tfor (let taskIndex = 0; taskIndex < test.tasks.length; taskIndex++) {\n\t\tconst task = test.tasks[taskIndex];\n\t\tfor (let messageIndex = 0; messageIndex < task.messages.length; messageIndex++) {\n\t\t\tconst r = fn(task, task.messages[messageIndex], messageIndex, taskIndex);\n\t\t\tif (r !== undefined) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn undefined;\n};\n\nexport const getSubjectTestItem = (subject: InspectSubject) => {\n\tif (subject instanceof MessageSubject) {\n\t\treturn subject.test;\n\t}\n\n\tif (subject instanceof TaskSubject) {\n\t\treturn undefined;\n\t}\n\n\treturn subject.test.item;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n\nimport { MarshalledId } from '../../../../../base/common/marshallingIds.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { TestId } from '../../common/testId.js';\nimport { ITestResult } from '../../common/testResult.js';\nimport { IRichLocation, ITestItem, ITestMessage, ITestMessageMenuArgs, ITestRunTask, ITestTaskState, InternalTestItem, TestMessageType, TestResultItem } from '../../common/testTypes.js';\nimport { TestUriType, buildTestUri } from '../../common/testingUri.js';\n\nexport const getMessageArgs = (test: TestResultItem, message: ITestMessage): ITestMessageMenuArgs => ({\n\t$mid: MarshalledId.TestMessageMenuArgs,\n\ttest: InternalTestItem.serialize(test),\n\tmessage: ITestMessage.serialize(message),\n});\n\ninterface ISubjectCommon {\n\tcontrollerId: string;\n}\n\nexport const inspectSubjectHasStack = (subject: InspectSubject | undefined) =>\n\tsubject instanceof MessageSubject && !!subject.stack?.length;\n\nexport class MessageSubject implements ISubjectCommon {\n\tpublic readonly test: ITestItem;\n\tpublic readonly message: ITestMessage;\n\tpublic readonly expectedUri: URI;\n\tpublic readonly actualUri: URI;\n\tpublic readonly messageUri: URI;\n\tpublic readonly revealLocation: IRichLocation | undefined;\n\tpublic readonly context: ITestMessageMenuArgs | undefined;\n\n\tpublic get controllerId() {\n\t\treturn TestId.root(this.test.extId);\n\t}\n\n\tpublic get isDiffable() {\n\t\treturn this.message.type === TestMessageType.Error && ITestMessage.isDiffable(this.message);\n\t}\n\n\tpublic get contextValue() {\n\t\treturn this.message.type === TestMessageType.Error ? this.message.contextValue : undefined;\n\t}\n\n\tpublic get stack() {\n\t\treturn this.message.type === TestMessageType.Error && this.message.stackTrace?.length ? this.message.stackTrace : undefined;\n\t}\n\n\tconstructor(public readonly result: ITestResult, test: TestResultItem, public readonly taskIndex: number, public readonly messageIndex: number) {\n\t\tthis.test = test.item;\n\t\tconst messages = test.tasks[taskIndex].messages;\n\t\tthis.messageIndex = messageIndex;\n\n\t\tconst parts = { messageIndex, resultId: result.id, taskIndex, testExtId: test.item.extId };\n\t\tthis.expectedUri = buildTestUri({ ...parts, type: TestUriType.ResultExpectedOutput });\n\t\tthis.actualUri = buildTestUri({ ...parts, type: TestUriType.ResultActualOutput });\n\t\tthis.messageUri = buildTestUri({ ...parts, type: TestUriType.ResultMessage });\n\n\t\tconst message = this.message = messages[this.messageIndex];\n\t\tthis.context = getMessageArgs(test, message);\n\t\tthis.revealLocation = message.location ?? (test.item.uri && test.item.range ? { uri: test.item.uri, range: Range.lift(test.item.range) } : undefined);\n\t}\n}\n\nexport class TaskSubject implements ISubjectCommon {\n\tpublic readonly outputUri: URI;\n\tpublic readonly revealLocation: undefined;\n\n\tpublic get controllerId() {\n\t\treturn this.result.tasks[this.taskIndex].ctrlId;\n\t}\n\n\tconstructor(public readonly result: ITestResult, public readonly taskIndex: number) {\n\t\tthis.outputUri = buildTestUri({ resultId: result.id, taskIndex, type: TestUriType.TaskOutput });\n\t}\n}\n\nexport class TestOutputSubject implements ISubjectCommon {\n\tpublic readonly outputUri: URI;\n\tpublic readonly revealLocation: undefined;\n\tpublic readonly task: ITestRunTask;\n\n\tpublic get controllerId() {\n\t\treturn TestId.root(this.test.item.extId);\n\t}\n\n\tconstructor(public readonly result: ITestResult, public readonly taskIndex: number, public readonly test: TestResultItem) {\n\t\tthis.outputUri = buildTestUri({ resultId: this.result.id, taskIndex: this.taskIndex, testExtId: this.test.item.extId, type: TestUriType.TestOutput });\n\t\tthis.task = result.tasks[this.taskIndex];\n\t}\n}\n\nexport type InspectSubject = MessageSubject | TaskSubject | TestOutputSubject;\n\nexport const equalsSubject = (a: InspectSubject, b: InspectSubject) => (\n\t(a instanceof MessageSubject && b instanceof MessageSubject && a.message === b.message) ||\n\t(a instanceof TaskSubject && b instanceof TaskSubject && a.result === b.result && a.taskIndex === b.taskIndex) ||\n\t(a instanceof TestOutputSubject && b instanceof TestOutputSubject && a.test === b.test && a.taskIndex === b.taskIndex)\n);\n\n\nexport const mapFindTestMessage = <T>(test: TestResultItem, fn: (task: ITestTaskState, message: ITestMessage, messageIndex: number, taskIndex: number) => T | undefined) => {\n\tfor (let taskIndex = 0; taskIndex < test.tasks.length; taskIndex++) {\n\t\tconst task = test.tasks[taskIndex];\n\t\tfor (let messageIndex = 0; messageIndex < task.messages.length; messageIndex++) {\n\t\t\tconst r = fn(task, task.messages[messageIndex], messageIndex, taskIndex);\n\t\t\tif (r !== undefined) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn undefined;\n};\n\nexport const getSubjectTestItem = (subject: InspectSubject) => {\n\tif (subject instanceof MessageSubject) {\n\t\treturn subject.test;\n\t}\n\n\tif (subject instanceof TaskSubject) {\n\t\treturn undefined;\n\t}\n\n\treturn subject.test.item;\n};\n"]}