{"version":3,"sources":["vs/workbench/contrib/testing/browser/testingOutputPeek.ts"],"names":[],"mappings":"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","file":"testingOutputPeek.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { derived, disposableObservableValue, observableValue } from '../../../../base/common/observable.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ICodeEditor, isCodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../../editor/browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EmbeddedDiffEditorWidget } from '../../../../editor/browser/widget/diffEditor/embeddedDiffEditorWidget.js';\nimport { EditorOption } from '../../../../editor/common/config/editorOptions.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { IEditor, IEditorContribution, ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { EditorContextKeys } from '../../../../editor/common/editorContextKeys.js';\nimport { ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { IPeekViewService, PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../../../../editor/contrib/peekView/browser/peekView.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { fillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { Action2, IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { ITextEditorOptions, TextEditorSelectionRevealType } from '../../../../platform/editor/common/editor.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { bindContextKey } from '../../../../platform/observable/common/platformObservableUtils.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { editorBackground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IViewPaneOptions, ViewPane } from '../../../browser/parts/views/viewPane.js';\nimport { IViewDescriptorService } from '../../../common/views.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { AutoOpenPeekViewWhen, TestingConfigKeys, getTestingConfiguration } from '../common/configuration.js';\nimport { Testing } from '../common/constants.js';\nimport { MutableObservableValue, staticObservableValue } from '../common/observableValue.js';\nimport { StoredValue } from '../common/storedValue.js';\nimport { ITestResult, TestResultItemChange, TestResultItemChangeReason, resultItemParents } from '../common/testResult.js';\nimport { ITestResultService, ResultChangeEvent } from '../common/testResultService.js';\nimport { ITestService } from '../common/testService.js';\nimport { IRichLocation, ITestMessage, TestMessageType, TestResultItem } from '../common/testTypes.js';\nimport { TestingContextKeys } from '../common/testingContextKeys.js';\nimport { IShowResultOptions, ITestingPeekOpener } from '../common/testingPeekOpener.js';\nimport { isFailedState } from '../common/testingStates.js';\nimport { ParsedTestUri, TestUriType, buildTestUri, parseTestUri } from '../common/testingUri.js';\nimport { renderTestMessageAsText } from './testMessageColorizer.js';\nimport { InspectSubject, MessageSubject, TaskSubject, TestOutputSubject, inspectSubjectHasStack, mapFindTestMessage } from './testResultsView/testResultsSubject.js';\nimport { TestResultsViewContent } from './testResultsView/testResultsViewContent.js';\nimport { testingMessagePeekBorder, testingPeekBorder, testingPeekHeaderBackground, testingPeekMessageHeaderBackground } from './theme.js';\n\n\n/** Iterates through every message in every result */\nfunction* allMessages([result]: readonly ITestResult[]) {\n\tif (!result) {\n\t\treturn;\n\t}\n\n\tfor (const test of result.tests) {\n\t\tfor (let taskIndex = 0; taskIndex < test.tasks.length; taskIndex++) {\n\t\t\tconst messages = test.tasks[taskIndex].messages;\n\t\t\tfor (let messageIndex = 0; messageIndex < messages.length; messageIndex++) {\n\n\t\t\t\tif (messages[messageIndex].type === TestMessageType.Error) {\n\t\t\t\t\tyield { result, test, taskIndex, messageIndex };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\ninterface IMessageIteratedReference {\n\tmessageIndex: number;\n\ttaskIndex: number;\n\tresult: ITestResult;\n\ttest: TestResultItem;\n}\n\nfunction messageItReferenceToUri({ result, test, taskIndex, messageIndex }: IMessageIteratedReference) {\n\treturn buildTestUri({\n\t\ttype: TestUriType.ResultMessage,\n\t\tresultId: result.id,\n\t\ttestExtId: test.item.extId,\n\t\ttaskIndex,\n\t\tmessageIndex,\n\t});\n}\n\ntype TestUriWithDocument = ParsedTestUri & { documentUri: URI };\n\nexport class TestingPeekOpener extends Disposable implements ITestingPeekOpener {\n\tpublic static readonly ID = 'workbench.contrib.testing.peekOpener';\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate lastUri?: TestUriWithDocument;\n\n\t/** @inheritdoc */\n\tpublic readonly historyVisible: MutableObservableValue<boolean>;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configuration: IConfigurationService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService,\n\t\t@ITestResultService private readonly testResults: ITestResultService,\n\t\t@ITestService private readonly testService: ITestService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IViewsService private readonly viewsService: IViewsService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t) {\n\t\tsuper();\n\t\tthis._register(testResults.onTestChanged(this.openPeekOnFailure, this));\n\t\tthis.historyVisible = this._register(MutableObservableValue.stored(new StoredValue<boolean>({\n\t\t\tkey: 'testHistoryVisibleInPeek',\n\t\t\tscope: StorageScope.PROFILE,\n\t\t\ttarget: StorageTarget.USER,\n\t\t}, storageService), false));\n\t}\n\n\t/** @inheritdoc */\n\tpublic async open() {\n\t\tlet uri: TestUriWithDocument | undefined;\n\t\tconst active = this.editorService.activeTextEditorControl;\n\t\tif (isCodeEditor(active) && active.getModel()?.uri) {\n\t\t\tconst modelUri = active.getModel()?.uri;\n\t\t\tif (modelUri) {\n\t\t\t\turi = await this.getFileCandidateMessage(modelUri, active.getPosition());\n\t\t\t}\n\t\t}\n\n\t\tif (!uri) {\n\t\t\turi = this.lastUri;\n\t\t}\n\n\t\tif (!uri) {\n\t\t\turi = this.getAnyCandidateMessage();\n\t\t}\n\n\t\tif (!uri) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.showPeekFromUri(uri);\n\t}\n\n\t/** @inheritdoc */\n\tpublic tryPeekFirstError(result: ITestResult, test: TestResultItem, options?: Partial<ITextEditorOptions>) {\n\t\tconst candidate = this.getFailedCandidateMessage(test);\n\t\tif (!candidate) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.showPeekFromUri({\n\t\t\ttype: TestUriType.ResultMessage,\n\t\t\tdocumentUri: candidate.location.uri,\n\t\t\ttaskIndex: candidate.taskId,\n\t\t\tmessageIndex: candidate.index,\n\t\t\tresultId: result.id,\n\t\t\ttestExtId: test.item.extId,\n\t\t}, undefined, { selection: candidate.location.range, selectionRevealType: TextEditorSelectionRevealType.NearTopIfOutsideViewport, ...options });\n\t\treturn true;\n\t}\n\n\t/** @inheritdoc */\n\tpublic peekUri(uri: URI, options: IShowResultOptions = {}) {\n\t\tconst parsed = parseTestUri(uri);\n\t\tconst result = parsed && this.testResults.getResult(parsed.resultId);\n\t\tif (!parsed || !result || !('testExtId' in parsed)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!('messageIndex' in parsed)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst message = result.getStateById(parsed.testExtId)?.tasks[parsed.taskIndex].messages[parsed.messageIndex];\n\t\tif (!message?.location) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.showPeekFromUri({\n\t\t\ttype: TestUriType.ResultMessage,\n\t\t\tdocumentUri: message.location.uri,\n\t\t\ttaskIndex: parsed.taskIndex,\n\t\t\tmessageIndex: parsed.messageIndex,\n\t\t\tresultId: result.id,\n\t\t\ttestExtId: parsed.testExtId,\n\t\t}, options.inEditor, { selection: message.location.range, ...options.options });\n\t\treturn true;\n\t}\n\n\t/** @inheritdoc */\n\tpublic closeAllPeeks() {\n\t\tfor (const editor of this.codeEditorService.listCodeEditors()) {\n\t\t\tTestingOutputPeekController.get(editor)?.removePeek();\n\t\t}\n\t}\n\n\tpublic openCurrentInEditor(): void {\n\t\tconst current = this.getActiveControl();\n\t\tif (!current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst options = { pinned: false, revealIfOpened: true };\n\t\tif (current instanceof TaskSubject || current instanceof TestOutputSubject) {\n\t\t\tthis.editorService.openEditor({ resource: current.outputUri, options });\n\t\t\treturn;\n\t\t}\n\n\t\tif (current instanceof TestOutputSubject) {\n\t\t\tthis.editorService.openEditor({ resource: current.outputUri, options });\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = current.message;\n\t\tif (current.isDiffable) {\n\t\t\tthis.editorService.openEditor({\n\t\t\t\toriginal: { resource: current.expectedUri },\n\t\t\t\tmodified: { resource: current.actualUri },\n\t\t\t\toptions,\n\t\t\t});\n\t\t} else if (typeof message.message === 'string') {\n\t\t\tthis.editorService.openEditor({ resource: current.messageUri, options });\n\t\t} else {\n\t\t\tthis.commandService.executeCommand('markdown.showPreview', current.messageUri).catch(err => {\n\t\t\t\tthis.notificationService.error(localize('testing.markdownPeekError', 'Could not open markdown preview: {0}.\\n\\nPlease make sure the markdown extension is enabled.', err.message));\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate getActiveControl(): InspectSubject | undefined {\n\t\tconst editor = getPeekedEditorFromFocus(this.codeEditorService);\n\t\tconst controller = editor && TestingOutputPeekController.get(editor);\n\t\treturn controller?.subject.get() ?? this.viewsService.getActiveViewWithId<TestResultsView>(Testing.ResultsViewId)?.subject;\n\t}\n\n\t/** @inheritdoc */\n\tprivate async showPeekFromUri(uri: TestUriWithDocument, editor?: IEditor, options?: ITextEditorOptions) {\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.lastUri = uri;\n\t\t\tTestingOutputPeekController.get(editor)?.show(buildTestUri(this.lastUri));\n\t\t\treturn true;\n\t\t}\n\n\t\tconst pane = await this.editorService.openEditor({\n\t\t\tresource: uri.documentUri,\n\t\t\toptions: { revealIfOpened: true, ...options }\n\t\t});\n\n\t\tconst control = pane?.getControl();\n\t\tif (!isCodeEditor(control)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.lastUri = uri;\n\t\tTestingOutputPeekController.get(control)?.show(buildTestUri(this.lastUri));\n\t\treturn true;\n\t}\n\n\t/**\n\t * Opens the peek view on a test failure, based on user preferences.\n\t */\n\tprivate openPeekOnFailure(evt: TestResultItemChange) {\n\t\tif (evt.reason !== TestResultItemChangeReason.OwnStateChange) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst candidate = this.getFailedCandidateMessage(evt.item);\n\t\tif (!candidate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (evt.result.request.continuous && !getTestingConfiguration(this.configuration, TestingConfigKeys.AutoOpenPeekViewDuringContinuousRun)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editors = this.codeEditorService.listCodeEditors();\n\t\tconst cfg = getTestingConfiguration(this.configuration, TestingConfigKeys.AutoOpenPeekView);\n\n\t\t// don't show the peek if the user asked to only auto-open peeks for visible tests,\n\t\t// and this test is not in any of the editors' models.\n\t\tswitch (cfg) {\n\t\t\tcase AutoOpenPeekViewWhen.FailureVisible: {\n\t\t\t\tconst visibleEditors = this.editorService.visibleTextEditorControls;\n\t\t\t\tconst editorUris = new Set(visibleEditors.filter(isCodeEditor).map(e => e.getModel()?.uri.toString()));\n\t\t\t\tif (!Iterable.some(resultItemParents(evt.result, evt.item), i => i.item.uri && editorUris.has(i.item.uri.toString()))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbreak; //continue\n\t\t\t}\n\t\t\tcase AutoOpenPeekViewWhen.FailureAnywhere:\n\t\t\t\tbreak; //continue\n\n\t\t\tdefault:\n\t\t\t\treturn; // never show\n\t\t}\n\n\t\tconst controllers = editors.map(TestingOutputPeekController.get);\n\t\tif (controllers.some(c => c?.subject.get())) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tryPeekFirstError(evt.result, evt.item);\n\t}\n\n\t/**\n\t * Gets the message closest to the given position from a test in the file.\n\t */\n\tprivate async getFileCandidateMessage(uri: URI, position: Position | null) {\n\t\tlet best: TestUriWithDocument | undefined;\n\t\tlet bestDistance = Infinity;\n\n\t\t// Get all tests for the document. In those, find one that has a test\n\t\t// message closest to the cursor position.\n\t\tconst demandedUriStr = uri.toString();\n\t\tfor (const test of this.testService.collection.all) {\n\t\t\tconst result = this.testResults.getStateById(test.item.extId);\n\t\t\tif (!result) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmapFindTestMessage(result[1], (_task, message, messageIndex, taskIndex) => {\n\t\t\t\tif (message.type !== TestMessageType.Error || !message.location || message.location.uri.toString() !== demandedUriStr) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst distance = position ? Math.abs(position.lineNumber - message.location.range.startLineNumber) : 0;\n\t\t\t\tif (!best || distance <= bestDistance) {\n\t\t\t\t\tbestDistance = distance;\n\t\t\t\t\tbest = {\n\t\t\t\t\t\ttype: TestUriType.ResultMessage,\n\t\t\t\t\t\ttestExtId: result[1].item.extId,\n\t\t\t\t\t\tresultId: result[0].id,\n\t\t\t\t\t\ttaskIndex,\n\t\t\t\t\t\tmessageIndex,\n\t\t\t\t\t\tdocumentUri: uri,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn best;\n\t}\n\n\t/**\n\t * Gets any possible still-relevant message from the results.\n\t */\n\tprivate getAnyCandidateMessage() {\n\t\tconst seen = new Set<string>();\n\t\tfor (const result of this.testResults.results) {\n\t\t\tfor (const test of result.tests) {\n\t\t\t\tif (seen.has(test.item.extId)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tseen.add(test.item.extId);\n\t\t\t\tconst found = mapFindTestMessage(test, (task, message, messageIndex, taskIndex) => (\n\t\t\t\t\tmessage.location && {\n\t\t\t\t\t\ttype: TestUriType.ResultMessage,\n\t\t\t\t\t\ttestExtId: test.item.extId,\n\t\t\t\t\t\tresultId: result.id,\n\t\t\t\t\t\ttaskIndex,\n\t\t\t\t\t\tmessageIndex,\n\t\t\t\t\t\tdocumentUri: message.location.uri,\n\t\t\t\t\t}\n\t\t\t\t));\n\n\t\t\t\tif (found) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Gets the first failed message that can be displayed from the result.\n\t */\n\tprivate getFailedCandidateMessage(test: TestResultItem) {\n\t\tconst fallbackLocation = test.item.uri && test.item.range\n\t\t\t? { uri: test.item.uri, range: test.item.range }\n\t\t\t: undefined;\n\n\t\tlet best: { taskId: number; index: number; message: ITestMessage; location: IRichLocation } | undefined;\n\t\tmapFindTestMessage(test, (task, message, messageIndex, taskId) => {\n\t\t\tconst location = message.location || fallbackLocation;\n\t\t\tif (!isFailedState(task.state) || !location) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (best && message.type !== TestMessageType.Error) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tbest = { taskId, index: messageIndex, message, location };\n\t\t});\n\n\t\treturn best;\n\t}\n}\n\n/**\n * Adds output/message peek functionality to code editors.\n */\nexport class TestingOutputPeekController extends Disposable implements IEditorContribution {\n\t/**\n\t * Gets the controller associated with the given code editor.\n\t */\n\tpublic static get(editor: ICodeEditor): TestingOutputPeekController | null {\n\t\treturn editor.getContribution<TestingOutputPeekController>(Testing.OutputPeekContributionId);\n\t}\n\n\t/**\n\t * Currently-shown peek view.\n\t */\n\tprivate readonly peek = this._register(disposableObservableValue<TestResultsPeek | undefined>('TestingOutputPeek', undefined));\n\n\t/**\n\t * Context key updated when the peek is visible/hidden.\n\t */\n\tprivate readonly visible: IContextKey<boolean>;\n\n\t/**\n\t * Gets the currently display subject. Undefined if the peek is not open.\n\t */\n\tpublic readonly subject = derived(reader => this.peek.read(reader)?.current.read(reader));\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ITestResultService private readonly testResults: ITestResultService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t) {\n\n\t\tsuper();\n\t\tthis.visible = TestingContextKeys.isPeekVisible.bindTo(contextKeyService);\n\t\tthis._register(editor.onDidChangeModel(() => this.peek.set(undefined, undefined)));\n\t\tthis._register(testResults.onResultsChanged(this.closePeekOnCertainResultEvents, this));\n\t\tthis._register(testResults.onTestChanged(this.closePeekOnTestChange, this));\n\t}\n\n\t/**\n\t * Shows a peek for the message in the editor.\n\t */\n\tpublic async show(uri: URI) {\n\t\tconst subject = this.retrieveTest(uri);\n\t\tif (subject) {\n\t\t\tthis.showSubject(subject);\n\t\t}\n\t}\n\n\t/**\n\t * Shows a peek for the existing inspect subject.\n\t */\n\tpublic async showSubject(subject: InspectSubject) {\n\t\tif (!this.peek.get()) {\n\t\t\tconst peek = this.instantiationService.createInstance(TestResultsPeek, this.editor);\n\t\t\tthis.peek.set(peek, undefined);\n\t\t\tpeek.onDidClose(() => {\n\t\t\t\tthis.visible.set(false);\n\t\t\t\tthis.peek.set(undefined, undefined);\n\t\t\t});\n\n\t\t\tthis.visible.set(true);\n\t\t\tpeek.create();\n\t\t}\n\n\t\tif (subject instanceof MessageSubject) {\n\t\t\talert(renderTestMessageAsText(subject.message.message));\n\t\t}\n\n\t\tthis.peek.get()!.setModel(subject);\n\t}\n\n\tpublic async openAndShow(uri: URI) {\n\t\tconst subject = this.retrieveTest(uri);\n\t\tif (!subject) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!subject.revealLocation || subject.revealLocation.uri.toString() === this.editor.getModel()?.uri.toString()) {\n\t\t\treturn this.show(uri);\n\t\t}\n\n\t\tconst otherEditor = await this.codeEditorService.openCodeEditor({\n\t\t\tresource: subject.revealLocation.uri,\n\t\t\toptions: { pinned: false, revealIfOpened: true }\n\t\t}, this.editor);\n\n\t\tif (otherEditor) {\n\t\t\tTestingOutputPeekController.get(otherEditor)?.removePeek();\n\t\t\treturn TestingOutputPeekController.get(otherEditor)?.show(uri);\n\t\t}\n\t}\n\n\t/**\n\t * Disposes the peek view, if any.\n\t */\n\tpublic removePeek() {\n\t\tthis.peek.set(undefined, undefined);\n\t}\n\n\t/**\n\t * Collapses all displayed stack frames.\n\t */\n\tpublic collapseStack() {\n\t\tthis.peek.get()?.collapseStack();\n\t}\n\n\t/**\n\t * Shows the next message in the peek, if possible.\n\t */\n\tpublic next() {\n\t\tconst subject = this.peek.get()?.current.get();\n\t\tif (!subject) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet first: IMessageIteratedReference | undefined;\n\n\t\tlet found = false;\n\t\tfor (const m of allMessages(this.testResults.results)) {\n\t\t\tfirst ??= m;\n\t\t\tif (subject instanceof TaskSubject && m.result.id === subject.result.id) {\n\t\t\t\tfound = true; // open the first message found in the current result\n\t\t\t}\n\n\t\t\tif (found) {\n\t\t\t\tthis.openAndShow(messageItReferenceToUri(m));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (subject instanceof TestOutputSubject && subject.test.item.extId === m.test.item.extId && subject.taskIndex === m.taskIndex && subject.result.id === m.result.id) {\n\t\t\t\tfound = true;\n\t\t\t}\n\n\t\t\tif (subject instanceof MessageSubject && subject.test.extId === m.test.item.extId && subject.messageIndex === m.messageIndex && subject.taskIndex === m.taskIndex && subject.result.id === m.result.id) {\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t}\n\n\t\tif (first) {\n\t\t\tthis.openAndShow(messageItReferenceToUri(first));\n\t\t}\n\t}\n\n\t/**\n\t * Shows the previous message in the peek, if possible.\n\t */\n\tpublic previous() {\n\t\tconst subject = this.subject.get();\n\t\tif (!subject) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet previous: IMessageIteratedReference | undefined; // pointer to the last message\n\t\tlet previousLockedIn = false; // whether the last message was verified as previous to the current subject\n\t\tlet last: IMessageIteratedReference | undefined; // overall last message\n\t\tfor (const m of allMessages(this.testResults.results)) {\n\t\t\tlast = m;\n\n\t\t\tif (!previousLockedIn) {\n\t\t\t\tif (subject instanceof TaskSubject) {\n\t\t\t\t\tif (m.result.id === subject.result.id) {\n\t\t\t\t\t\tpreviousLockedIn = true;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (subject instanceof TestOutputSubject) {\n\t\t\t\t\tif (m.test.item.extId === subject.test.item.extId && m.result.id === subject.result.id && m.taskIndex === subject.taskIndex) {\n\t\t\t\t\t\tpreviousLockedIn = true;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (subject.test.extId === m.test.item.extId && subject.messageIndex === m.messageIndex && subject.taskIndex === m.taskIndex && subject.result.id === m.result.id) {\n\t\t\t\t\tpreviousLockedIn = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tprevious = m;\n\t\t\t}\n\t\t}\n\n\t\tconst target = previous || last;\n\t\tif (target) {\n\t\t\tthis.openAndShow(messageItReferenceToUri(target));\n\t\t}\n\t}\n\n\t/**\n\t * Removes the peek view if it's being displayed on the given test ID.\n\t */\n\tpublic removeIfPeekingForTest(testId: string) {\n\t\tconst c = this.subject.get();\n\t\tif (c && c instanceof MessageSubject && c.test.extId === testId) {\n\t\t\tthis.peek.set(undefined, undefined);\n\t\t}\n\t}\n\n\t/**\n\t * If the test we're currently showing has its state change to something\n\t * else, then clear the peek.\n\t */\n\tprivate closePeekOnTestChange(evt: TestResultItemChange) {\n\t\tif (evt.reason !== TestResultItemChangeReason.OwnStateChange || evt.previousState === evt.item.ownComputedState) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeIfPeekingForTest(evt.item.item.extId);\n\t}\n\n\tprivate closePeekOnCertainResultEvents(evt: ResultChangeEvent) {\n\t\tif ('started' in evt) {\n\t\t\tthis.peek.set(undefined, undefined); // close peek when runs start\n\t\t}\n\n\t\tif ('removed' in evt && this.testResults.results.length === 0) {\n\t\t\tthis.peek.set(undefined, undefined); // close the peek if results are cleared\n\t\t}\n\t}\n\n\tprivate retrieveTest(uri: URI): InspectSubject | undefined {\n\t\tconst parts = parseTestUri(uri);\n\t\tif (!parts) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst result = this.testResults.results.find(r => r.id === parts.resultId);\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (parts.type === TestUriType.TaskOutput) {\n\t\t\treturn new TaskSubject(result, parts.taskIndex);\n\t\t}\n\n\t\tif (parts.type === TestUriType.TestOutput) {\n\t\t\tconst test = result.getStateById(parts.testExtId);\n\t\t\tif (!test) { return; }\n\t\t\treturn new TestOutputSubject(result, parts.taskIndex, test);\n\t\t}\n\n\t\tconst { testExtId, taskIndex, messageIndex } = parts;\n\t\tconst test = result?.getStateById(testExtId);\n\t\tif (!test || !test.tasks[parts.taskIndex]) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn new MessageSubject(result, test, taskIndex, messageIndex);\n\t}\n}\n\n\nclass TestResultsPeek extends PeekViewWidget {\n\tpublic readonly current = observableValue<InspectSubject | undefined>('testPeekCurrent', undefined);\n\tprivate resizeOnNextContentHeightUpdate = false;\n\tprivate content!: TestResultsViewContent;\n\tprivate scopedContextKeyService!: IContextKeyService;\n\tprivate dimension?: dom.Dimension;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@IPeekViewService peekViewService: IPeekViewService,\n\t\t@ITestingPeekOpener private readonly testingPeek: ITestingPeekOpener,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ITextModelService protected readonly modelService: ITextModelService,\n\t\t@ICodeEditorService protected readonly codeEditorService: ICodeEditorService,\n\t\t@IUriIdentityService protected readonly uriIdentityService: IUriIdentityService,\n\t) {\n\t\tsuper(editor, { showFrame: true, frameWidth: 1, showArrow: true, isResizeable: true, isAccessible: true, className: 'test-output-peek' }, instantiationService);\n\n\t\tthis._disposables.add(themeService.onDidColorThemeChange(this.applyTheme, this));\n\t\tpeekViewService.addExclusiveWidget(editor, this);\n\t}\n\n\tprotected override _getMaximumHeightInLines(): number | undefined {\n\t\tconst defaultMaxHeight = super._getMaximumHeightInLines();\n\t\tconst contentHeight = this.content?.contentHeight;\n\t\tif (!contentHeight) { // undefined or 0\n\t\t\treturn defaultMaxHeight;\n\t\t}\n\n\t\tif (this.testingPeek.historyVisible.value) { // don't cap height with the history split\n\t\t\treturn defaultMaxHeight;\n\t\t}\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\t// 41 is experimentally determined to be the overhead of the peek view itself\n\t\t// to avoid showing scrollbars by default in its content.\n\t\tconst basePeekOverhead = 41;\n\n\t\treturn Math.min(defaultMaxHeight || Infinity, (contentHeight + basePeekOverhead) / lineHeight + 1);\n\t}\n\n\tprivate applyTheme() {\n\t\tconst theme = this.themeService.getColorTheme();\n\t\tconst current = this.current.get();\n\t\tconst isError = current instanceof MessageSubject && current.message.type === TestMessageType.Error;\n\t\tconst borderColor = (isError ? theme.getColor(testingPeekBorder) : theme.getColor(testingMessagePeekBorder)) || Color.transparent;\n\t\tconst headerBg = (isError ? theme.getColor(testingPeekHeaderBackground) : theme.getColor(testingPeekMessageHeaderBackground)) || Color.transparent;\n\t\tconst editorBg = theme.getColor(editorBackground);\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor,\n\t\t\theaderBackgroundColor: editorBg && headerBg ? headerBg.makeOpaque(editorBg) : headerBg,\n\t\t\tprimaryHeadingColor: theme.getColor(peekViewTitleForeground),\n\t\t\tsecondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n\t\t});\n\t}\n\n\tprotected override _fillContainer(container: HTMLElement): void {\n\t\tif (!this.scopedContextKeyService) {\n\t\t\tthis.scopedContextKeyService = this._disposables.add(this.contextKeyService.createScoped(container));\n\t\t\tTestingContextKeys.isInPeek.bindTo(this.scopedContextKeyService).set(true);\n\t\t\tconst instaService = this._disposables.add(this.instantiationService.createChild(new ServiceCollection([IContextKeyService, this.scopedContextKeyService])));\n\t\t\tthis.content = this._disposables.add(instaService.createInstance(TestResultsViewContent, this.editor, { historyVisible: this.testingPeek.historyVisible, showRevealLocationOnMessages: false, locationForProgress: Testing.ResultsViewId }));\n\n\t\t\tthis._disposables.add(this.content.onClose(() => {\n\t\t\t\tTestingOutputPeekController.get(this.editor)?.removePeek();\n\t\t\t}));\n\t\t}\n\n\t\tsuper._fillContainer(container);\n\t}\n\n\tprotected override _fillHead(container: HTMLElement): void {\n\t\tsuper._fillHead(container);\n\n\t\tconst menuContextKeyService = this._disposables.add(this.contextKeyService.createScoped(container));\n\t\tthis._disposables.add(bindContextKey(\n\t\t\tTestingContextKeys.peekHasStack,\n\t\t\tmenuContextKeyService,\n\t\t\treader => inspectSubjectHasStack(this.current.read(reader)),\n\t\t));\n\n\t\tconst menu = this.menuService.createMenu(MenuId.TestPeekTitle, menuContextKeyService);\n\t\tconst actionBar = this._actionbarWidget!;\n\t\tthis._disposables.add(menu.onDidChange(() => {\n\t\t\tactions.length = 0;\n\t\t\tfillInActionBarActions(menu.getActions(), actions);\n\t\t\twhile (actionBar.getAction(1)) {\n\t\t\t\tactionBar.pull(0); // remove all but the view's default \"close\" button\n\t\t\t}\n\t\t\tactionBar.push(actions, { label: false, icon: true, index: 0 });\n\t\t}));\n\n\t\tconst actions: IAction[] = [];\n\t\tfillInActionBarActions(menu.getActions(), actions);\n\t\tactionBar.push(actions, { label: false, icon: true, index: 0 });\n\t}\n\n\tprotected override _fillBody(containerElement: HTMLElement): void {\n\t\tthis.content.fillBody(containerElement);\n\n\t\t// Resize on height updates for a short time to allow any heights made\n\t\t// by editor contributions to come into effect before.\n\t\tconst contentHeightSettleTimer = this._disposables.add(new RunOnceScheduler(() => {\n\t\t\tthis.resizeOnNextContentHeightUpdate = false;\n\t\t}, 500));\n\n\t\tthis._disposables.add(this.content.onDidChangeContentHeight(height => {\n\t\t\tif (!this.resizeOnNextContentHeightUpdate || !height) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst displayed = this._getMaximumHeightInLines();\n\t\t\tif (displayed) {\n\t\t\t\tthis._relayout(Math.min(displayed, this.getVisibleEditorLines() / 2), true);\n\t\t\t\tif (!contentHeightSettleTimer.isScheduled()) {\n\t\t\t\t\tcontentHeightSettleTimer.schedule();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._disposables.add(this.content.onDidRequestReveal(sub => {\n\t\t\tTestingOutputPeekController.get(this.editor)?.show(sub instanceof MessageSubject\n\t\t\t\t? sub.messageUri\n\t\t\t\t: sub.outputUri);\n\t\t}));\n\t}\n\n\t/**\n\t * Updates the test to be shown.\n\t */\n\tpublic setModel(subject: InspectSubject): Promise<void> {\n\t\tif (subject instanceof TaskSubject || subject instanceof TestOutputSubject) {\n\t\t\tthis.current.set(subject, undefined);\n\t\t\treturn this.showInPlace(subject);\n\t\t}\n\n\t\tconst previous = this.current;\n\t\tconst revealLocation = subject.revealLocation?.range.getStartPosition();\n\t\tif (!revealLocation && !previous) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.current.set(subject, undefined);\n\t\tif (!revealLocation) {\n\t\t\treturn this.showInPlace(subject);\n\t\t}\n\n\t\tthis.resizeOnNextContentHeightUpdate = true;\n\t\tthis.show(revealLocation, 10); // 10 is just a random number, we resize once content is available\n\t\tthis.editor.revealRangeNearTopIfOutsideViewport(Range.fromPositions(revealLocation), ScrollType.Smooth);\n\n\t\treturn this.showInPlace(subject);\n\t}\n\n\t/**\n\t * Collapses all displayed stack frames.\n\t */\n\tpublic collapseStack() {\n\t\tthis.content.collapseStack();\n\t}\n\n\tprivate getVisibleEditorLines() {\n\t\t// note that we don't use the view ranges because we don't want to get\n\t\t// thrown off by large wrapping lines. Being approximate here is okay.\n\t\treturn Math.round(this.editor.getDomNode()!.clientHeight / this.editor.getOption(EditorOption.lineHeight));\n\t}\n\n\t/**\n\t * Shows a message in-place without showing or changing the peek location.\n\t * This is mostly used if peeking a message without a location.\n\t */\n\tpublic async showInPlace(subject: InspectSubject) {\n\t\tif (subject instanceof MessageSubject) {\n\t\t\tconst message = subject.message;\n\t\t\tthis.setTitle(firstLine(renderTestMessageAsText(message.message)), stripIcons(subject.test.label));\n\t\t} else {\n\t\t\tthis.setTitle(localize('testOutputTitle', 'Test Output'));\n\t\t}\n\t\tthis.applyTheme();\n\t\tawait this.content.reveal({ subject, preserveFocus: false });\n\t}\n\n\t/** @override */\n\tprotected override _doLayoutBody(height: number, width: number) {\n\t\tsuper._doLayoutBody(height, width);\n\t\tthis.content.onLayoutBody(height, width);\n\t}\n\n\t/** @override */\n\tprotected override _onWidth(width: number) {\n\t\tsuper._onWidth(width);\n\t\tif (this.dimension) {\n\t\t\tthis.dimension = new dom.Dimension(width, this.dimension.height);\n\t\t}\n\n\t\tthis.content.onWidth(width);\n\t}\n}\n\nexport class TestResultsView extends ViewPane {\n\tprivate readonly content = new Lazy(() => this._register(this.instantiationService.createInstance(TestResultsViewContent, undefined, {\n\t\thistoryVisible: staticObservableValue(true),\n\t\tshowRevealLocationOnMessages: true,\n\t\tlocationForProgress: Testing.ExplorerViewId,\n\t})));\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@ITestResultService private readonly resultService: ITestResultService,\n\t) {\n\t\tsuper(options, keybindingService, contextMenuService, configurationService, contextKeyService, viewDescriptorService, instantiationService, openerService, themeService, hoverService);\n\t}\n\n\tpublic get subject() {\n\t\treturn this.content.rawValue?.current;\n\t}\n\n\tpublic showLatestRun(preserveFocus = false) {\n\t\tconst result = this.resultService.results.find(r => r.tasks.length);\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.content.rawValue?.reveal({ preserveFocus, subject: new TaskSubject(result, 0) });\n\t}\n\n\tprotected override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\t\t// Avoid rendering into the body until it's attached the DOM, as it can\n\t\t// result in rendering issues in the terminal (#194156)\n\t\tif (this.isBodyVisible()) {\n\t\t\tthis.renderContent(container);\n\t\t} else {\n\t\t\tthis._register(Event.once(Event.filter(this.onDidChangeBodyVisibility, Boolean))(() => this.renderContent(container)));\n\t\t}\n\t}\n\n\tprotected override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis.content.rawValue?.onLayoutBody(height, width);\n\t}\n\n\tprivate renderContent(container: HTMLElement) {\n\t\tconst content = this.content.value;\n\t\tcontent.fillBody(container);\n\t\tthis._register(content.onDidRequestReveal(subject => content.reveal({ preserveFocus: true, subject })));\n\n\t\tconst [lastResult] = this.resultService.results;\n\t\tif (lastResult && lastResult.tasks.length) {\n\t\t\tcontent.reveal({ preserveFocus: true, subject: new TaskSubject(lastResult, 0) });\n\t\t}\n\t}\n}\n\nconst firstLine = (str: string) => {\n\tconst index = str.indexOf('\\n');\n\treturn index === -1 ? str : str.slice(0, index);\n};\n\nfunction getOuterEditorFromDiffEditor(codeEditorService: ICodeEditorService): ICodeEditor | null {\n\tconst diffEditors = codeEditorService.listDiffEditors();\n\n\tfor (const diffEditor of diffEditors) {\n\t\tif (diffEditor.hasTextFocus() && diffEditor instanceof EmbeddedDiffEditorWidget) {\n\t\t\treturn diffEditor.getParentEditor();\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport class CloseTestPeek extends EditorAction2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.closeTestPeek',\n\t\t\ttitle: localize2('close', 'Close'),\n\t\t\ticon: Codicon.close,\n\t\t\tprecondition: ContextKeyExpr.or(TestingContextKeys.isInPeek, TestingContextKeys.isPeekVisible),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.EditorContrib - 101,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\twhen: ContextKeyExpr.not('config.editor.stablePeek')\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tconst parent = getPeekedEditorFromFocus(accessor.get(ICodeEditorService));\n\t\tTestingOutputPeekController.get(parent ?? editor)?.removePeek();\n\t}\n}\n\n\nconst navWhen = ContextKeyExpr.and(\n\tEditorContextKeys.focus,\n\tTestingContextKeys.isPeekVisible,\n);\n\n/**\n * Gets the appropriate editor for peeking based on the currently focused editor.\n */\nconst getPeekedEditorFromFocus = (codeEditorService: ICodeEditorService) => {\n\tconst editor = codeEditorService.getFocusedCodeEditor() || codeEditorService.getActiveCodeEditor();\n\treturn editor && getPeekedEditor(codeEditorService, editor);\n};\n\n/**\n * Gets the editor where the peek may be shown, bubbling upwards if the given\n * editor is embedded (i.e. inside a peek already).\n */\nconst getPeekedEditor = (codeEditorService: ICodeEditorService, editor: ICodeEditor) => {\n\tif (TestingOutputPeekController.get(editor)?.subject.get()) {\n\t\treturn editor;\n\t}\n\n\tif (editor instanceof EmbeddedCodeEditorWidget) {\n\t\treturn editor.getParentEditor();\n\t}\n\n\tconst outer = getOuterEditorFromDiffEditor(codeEditorService);\n\tif (outer) {\n\t\treturn outer;\n\t}\n\n\treturn editor;\n};\n\nexport class GoToNextMessageAction extends Action2 {\n\tpublic static readonly ID = 'testing.goToNextMessage';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: GoToNextMessageAction.ID,\n\t\t\tf1: true,\n\t\t\ttitle: localize2('testing.goToNextMessage', 'Go to Next Test Failure'),\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize2('testing.goToNextMessage.description', 'Shows the next failure message in your file')\n\t\t\t},\n\t\t\ticon: Codicon.arrowDown,\n\t\t\tcategory: Categories.Test,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.F8,\n\t\t\t\tweight: KeybindingWeight.EditorContrib + 1,\n\t\t\t\twhen: navWhen,\n\t\t\t},\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.TestPeekTitle,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 2,\n\t\t\t}, {\n\t\t\t\tid: MenuId.CommandPalette,\n\t\t\t\twhen: navWhen\n\t\t\t}],\n\t\t});\n\t}\n\n\tpublic override run(accessor: ServicesAccessor) {\n\t\tconst editor = getPeekedEditorFromFocus(accessor.get(ICodeEditorService));\n\t\tif (editor) {\n\t\t\tTestingOutputPeekController.get(editor)?.next();\n\t\t}\n\t}\n}\n\nexport class GoToPreviousMessageAction extends Action2 {\n\tpublic static readonly ID = 'testing.goToPreviousMessage';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: GoToPreviousMessageAction.ID,\n\t\t\tf1: true,\n\t\t\ttitle: localize2('testing.goToPreviousMessage', 'Go to Previous Test Failure'),\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize2('testing.goToPreviousMessage.description', 'Shows the previous failure message in your file')\n\t\t\t},\n\t\t\ticon: Codicon.arrowUp,\n\t\t\tcategory: Categories.Test,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.Alt | KeyCode.F8,\n\t\t\t\tweight: KeybindingWeight.EditorContrib + 1,\n\t\t\t\twhen: navWhen\n\t\t\t},\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.TestPeekTitle,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1,\n\t\t\t}, {\n\t\t\t\tid: MenuId.CommandPalette,\n\t\t\t\twhen: navWhen\n\t\t\t}],\n\t\t});\n\t}\n\n\tpublic override run(accessor: ServicesAccessor) {\n\t\tconst editor = getPeekedEditorFromFocus(accessor.get(ICodeEditorService));\n\t\tif (editor) {\n\t\t\tTestingOutputPeekController.get(editor)?.previous();\n\t\t}\n\t}\n}\n\nexport class CollapsePeekStack extends Action2 {\n\tpublic static readonly ID = 'testing.collapsePeekStack';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CollapsePeekStack.ID,\n\t\t\ttitle: localize2('testing.collapsePeekStack', 'Collapse Stack Frames'),\n\t\t\ticon: Codicon.collapseAll,\n\t\t\tcategory: Categories.Test,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.TestPeekTitle,\n\t\t\t\twhen: TestingContextKeys.peekHasStack,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 4,\n\t\t\t}],\n\t\t});\n\t}\n\n\tpublic override run(accessor: ServicesAccessor) {\n\t\tconst editor = getPeekedEditorFromFocus(accessor.get(ICodeEditorService));\n\t\tif (editor) {\n\t\t\tTestingOutputPeekController.get(editor)?.collapseStack();\n\t\t}\n\t}\n}\n\nexport class OpenMessageInEditorAction extends Action2 {\n\tpublic static readonly ID = 'testing.openMessageInEditor';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: OpenMessageInEditorAction.ID,\n\t\t\tf1: false,\n\t\t\ttitle: localize2('testing.openMessageInEditor', 'Open in Editor'),\n\t\t\ticon: Codicon.goToFile,\n\t\t\tcategory: Categories.Test,\n\t\t\tmenu: [{ id: MenuId.TestPeekTitle }],\n\t\t});\n\t}\n\n\tpublic override run(accessor: ServicesAccessor) {\n\t\taccessor.get(ITestingPeekOpener).openCurrentInEditor();\n\t}\n}\n\nexport class ToggleTestingPeekHistory extends Action2 {\n\tpublic static readonly ID = 'testing.toggleTestingPeekHistory';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ToggleTestingPeekHistory.ID,\n\t\t\tf1: true,\n\t\t\ttitle: localize2('testing.toggleTestingPeekHistory', 'Toggle Test History in Peek'),\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize2('testing.toggleTestingPeekHistory.description', 'Shows or hides the history of test runs in the peek view')\n\t\t\t},\n\t\t\ticon: Codicon.history,\n\t\t\tcategory: Categories.Test,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.TestPeekTitle,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 3,\n\t\t\t}],\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.KeyH,\n\t\t\t\twhen: TestingContextKeys.isPeekVisible.isEqualTo(true),\n\t\t\t},\n\t\t});\n\t}\n\n\tpublic override run(accessor: ServicesAccessor) {\n\t\tconst opener = accessor.get(ITestingPeekOpener);\n\t\topener.historyVisible.value = !opener.historyVisible.value;\n\t}\n}\n"]}