{"version":3,"sources":["vs/workbench/contrib/testing/browser/testCoverageBars.ts"],"names":[],"mappings":"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","file":"testCoverageBars.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { h } from '../../../../base/browser/dom.js';\nimport type { IManagedHover, IManagedHoverTooltipMarkdownString } from '../../../../base/browser/ui/hover/hover.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ITransaction, autorun, observableValue } from '../../../../base/common/observable.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ExplorerExtensions, IExplorerFileContribution, IExplorerFileContributionRegistry } from '../../files/browser/explorerFileContrib.js';\nimport * as coverUtils from './codeCoverageDisplayUtils.js';\nimport { ITestingCoverageBarThresholds, TestingConfigKeys, getTestingConfiguration, observeTestingConfiguration } from '../common/configuration.js';\nimport { AbstractFileCoverage } from '../common/testCoverage.js';\nimport { ITestCoverageService } from '../common/testCoverageService.js';\nimport { safeIntl } from '../../../../base/common/date.js';\n\nexport interface TestCoverageBarsOptions {\n\t/**\n\t * Whether the bars should be shown in a more compact way, where only the\n\t * overall bar is shown and more details are given in the hover.\n\t */\n\tcompact: boolean;\n\t/**\n\t * Whether the overall stat is shown, defaults to true.\n\t */\n\toverall?: boolean;\n\t/**\n\t * Container in which is render the bars.\n\t */\n\tcontainer: HTMLElement;\n}\n\n/** Type that can be used to render coverage bars */\nexport type CoverageBarSource = Pick<AbstractFileCoverage, 'statement' | 'branch' | 'declaration'>;\n\nexport class ManagedTestCoverageBars extends Disposable {\n\tprivate _coverage?: CoverageBarSource;\n\tprivate readonly el = new Lazy(() => {\n\t\tif (this.options.compact) {\n\t\t\tconst el = h('.test-coverage-bars.compact', [\n\t\t\t\th('.tpc@overall'),\n\t\t\t\th('.bar@tpcBar'),\n\t\t\t]);\n\t\t\tthis.attachHover(el.tpcBar, getOverallHoverText);\n\t\t\treturn el;\n\t\t} else {\n\t\t\tconst el = h('.test-coverage-bars', [\n\t\t\t\th('.tpc@overall'),\n\t\t\t\th('.bar@statement'),\n\t\t\t\th('.bar@function'),\n\t\t\t\th('.bar@branch'),\n\t\t\t]);\n\t\t\tthis.attachHover(el.statement, stmtCoverageText);\n\t\t\tthis.attachHover(el.function, fnCoverageText);\n\t\t\tthis.attachHover(el.branch, branchCoverageText);\n\t\t\treturn el;\n\t\t}\n\t});\n\n\tprivate readonly visibleStore = this._register(new DisposableStore());\n\tprivate readonly customHovers: IManagedHover[] = [];\n\n\t/** Gets whether coverage is currently visible for the resource. */\n\tpublic get visible() {\n\t\treturn !!this._coverage;\n\t}\n\n\tconstructor(\n\t\tprotected readonly options: TestCoverageBarsOptions,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t) {\n\t\tsuper();\n\t}\n\n\tprivate attachHover(target: HTMLElement, factory: (coverage: CoverageBarSource) => string | IManagedHoverTooltipMarkdownString | undefined) {\n\t\tthis._register(this.hoverService.setupManagedHover(getDefaultHoverDelegate('element'), target, () => this._coverage && factory(this._coverage)));\n\t}\n\n\tpublic setCoverageInfo(coverage: CoverageBarSource | undefined) {\n\t\tconst ds = this.visibleStore;\n\t\tif (!coverage) {\n\t\t\tif (this._coverage) {\n\t\t\t\tthis._coverage = undefined;\n\t\t\t\tthis.customHovers.forEach(c => c.hide());\n\t\t\t\tds.clear();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._coverage) {\n\t\t\tconst root = this.el.value.root;\n\t\t\tds.add(toDisposable(() => root.remove()));\n\t\t\tthis.options.container.appendChild(root);\n\t\t\tds.add(this.configurationService.onDidChangeConfiguration(c => {\n\t\t\t\tif (!this._coverage) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (c.affectsConfiguration(TestingConfigKeys.CoveragePercent) || c.affectsConfiguration(TestingConfigKeys.CoverageBarThresholds)) {\n\t\t\t\t\tthis.doRender(this._coverage);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis._coverage = coverage;\n\t\tthis.doRender(coverage);\n\t}\n\n\tprivate doRender(coverage: CoverageBarSource) {\n\t\tconst el = this.el.value;\n\n\t\tconst precision = this.options.compact ? 0 : 2;\n\t\tconst thresholds = getTestingConfiguration(this.configurationService, TestingConfigKeys.CoverageBarThresholds);\n\t\tconst overallStat = coverUtils.calculateDisplayedStat(coverage, getTestingConfiguration(this.configurationService, TestingConfigKeys.CoveragePercent));\n\t\tif (this.options.overall !== false) {\n\t\t\tel.overall.textContent = coverUtils.displayPercent(overallStat, precision);\n\t\t} else {\n\t\t\tel.overall.style.display = 'none';\n\t\t}\n\t\tif ('tpcBar' in el) { // compact mode\n\t\t\trenderBar(el.tpcBar, overallStat, false, thresholds);\n\t\t} else {\n\t\t\trenderBar(el.statement, coverUtils.percent(coverage.statement), coverage.statement.total === 0, thresholds);\n\t\t\trenderBar(el.function, coverage.declaration && coverUtils.percent(coverage.declaration), coverage.declaration?.total === 0, thresholds);\n\t\t\trenderBar(el.branch, coverage.branch && coverUtils.percent(coverage.branch), coverage.branch?.total === 0, thresholds);\n\t\t}\n\t}\n}\n\nconst barWidth = 16;\n\nconst renderBar = (bar: HTMLElement, pct: number | undefined, isZero: boolean, thresholds: ITestingCoverageBarThresholds) => {\n\tif (pct === undefined) {\n\t\tbar.style.display = 'none';\n\t\treturn;\n\t}\n\n\tbar.style.display = 'block';\n\tbar.style.width = `${barWidth}px`;\n\t// this is floored so the bar is only completely filled at 100% and not 99.9%\n\tbar.style.setProperty('--test-bar-width', `${Math.floor(pct * 16)}px`);\n\n\tif (isZero) {\n\t\tbar.style.color = 'currentColor';\n\t\tbar.style.opacity = '0.5';\n\t\treturn;\n\t}\n\n\tbar.style.color = coverUtils.getCoverageColor(pct, thresholds);\n\tbar.style.opacity = '1';\n};\n\nconst nf = safeIntl.NumberFormat();\nconst stmtCoverageText = (coverage: CoverageBarSource) => localize('statementCoverage', '{0}/{1} statements covered ({2})', nf.value.format(coverage.statement.covered), nf.value.format(coverage.statement.total), coverUtils.displayPercent(coverUtils.percent(coverage.statement)));\nconst fnCoverageText = (coverage: CoverageBarSource) => coverage.declaration && localize('functionCoverage', '{0}/{1} functions covered ({2})', nf.value.format(coverage.declaration.covered), nf.value.format(coverage.declaration.total), coverUtils.displayPercent(coverUtils.percent(coverage.declaration)));\nconst branchCoverageText = (coverage: CoverageBarSource) => coverage.branch && localize('branchCoverage', '{0}/{1} branches covered ({2})', nf.value.format(coverage.branch.covered), nf.value.format(coverage.branch.total), coverUtils.displayPercent(coverUtils.percent(coverage.branch)));\n\nconst getOverallHoverText = (coverage: CoverageBarSource): IManagedHoverTooltipMarkdownString => {\n\tconst str = [\n\t\tstmtCoverageText(coverage),\n\t\tfnCoverageText(coverage),\n\t\tbranchCoverageText(coverage),\n\t].filter(isDefined).join('\\n\\n');\n\n\treturn {\n\t\tmarkdown: new MarkdownString().appendText(str),\n\t\tmarkdownNotSupportedFallback: str\n\t};\n};\n\n/**\n * Renders test coverage bars for a resource in the given container. It will\n * not render anything unless a test coverage report has been opened.\n */\nexport class ExplorerTestCoverageBars extends ManagedTestCoverageBars implements IExplorerFileContribution {\n\tprivate readonly resource = observableValue<URI | undefined>(this, undefined);\n\tprivate static hasRegistered = false;\n\tpublic static register() {\n\t\tif (this.hasRegistered) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hasRegistered = true;\n\t\tRegistry.as<IExplorerFileContributionRegistry>(ExplorerExtensions.FileContributionRegistry).register({\n\t\t\tcreate(insta, container) {\n\t\t\t\treturn insta.createInstance(\n\t\t\t\t\tExplorerTestCoverageBars,\n\t\t\t\t\t{ compact: true, container }\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\tconstructor(\n\t\toptions: TestCoverageBarsOptions,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@ITestCoverageService testCoverageService: ITestCoverageService,\n\t) {\n\t\tsuper(options, configurationService, hoverService);\n\n\t\tconst isEnabled = observeTestingConfiguration(configurationService, TestingConfigKeys.ShowCoverageInExplorer);\n\n\t\tthis._register(autorun(async reader => {\n\t\t\tlet info: AbstractFileCoverage | undefined;\n\t\t\tconst coverage = testCoverageService.selected.read(reader);\n\t\t\tif (coverage && isEnabled.read(reader)) {\n\t\t\t\tconst resource = this.resource.read(reader);\n\t\t\t\tif (resource) {\n\t\t\t\t\tinfo = coverage.getComputedForUri(resource);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setCoverageInfo(info);\n\t\t}));\n\t}\n\n\t/** @inheritdoc */\n\tpublic setResource(resource: URI | undefined, transaction?: ITransaction) {\n\t\tthis.resource.set(resource, transaction);\n\t}\n\n\tpublic override setCoverageInfo(coverage: AbstractFileCoverage | undefined) {\n\t\tsuper.setCoverageInfo(coverage);\n\t\tthis.options.container?.classList.toggle('explorer-item-with-test-coverage', this.visible);\n\t}\n}\n"]}