{"version":3,"sources":["vs/workbench/contrib/testing/browser/testingExplorerFilter.ts"],"names":[],"mappings":"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","file":"testingExplorerFilter.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { BaseActionViewItem, IActionViewItemOptions, IBaseActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { AnchorAlignment } from '../../../../base/browser/ui/contextview/contextview.js';\nimport { DropdownMenuActionViewItem } from '../../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { Action, IAction, IActionRunner, Separator } from '../../../../base/common/actions.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { ContextScopedSuggestEnabledInputWithHistory, SuggestEnabledInputWithHistory, SuggestResultsProvider } from '../../codeEditor/browser/suggestEnabledInput/suggestEnabledInput.js';\nimport { testingFilterIcon } from './icons.js';\nimport { StoredValue } from '../common/storedValue.js';\nimport { ITestExplorerFilterState, TestFilterTerm } from '../common/testExplorerFilterState.js';\nimport { ITestService } from '../common/testService.js';\nimport { denamespaceTestTag } from '../common/testTypes.js';\n\nconst testFilterDescriptions: { [K in TestFilterTerm]: string } = {\n\t[TestFilterTerm.Failed]: localize('testing.filters.showOnlyFailed', \"Show Only Failed Tests\"),\n\t[TestFilterTerm.Executed]: localize('testing.filters.showOnlyExecuted', \"Show Only Executed Tests\"),\n\t[TestFilterTerm.CurrentDoc]: localize('testing.filters.currentFile', \"Show in Active File Only\"),\n\t[TestFilterTerm.OpenedFiles]: localize('testing.filters.openedFiles', \"Show in Opened Files Only\"),\n\t[TestFilterTerm.Hidden]: localize('testing.filters.showExcludedTests', \"Show Hidden Tests\"),\n};\n\nexport class TestingExplorerFilter extends BaseActionViewItem {\n\tprivate input!: SuggestEnabledInputWithHistory;\n\tprivate wrapper!: HTMLDivElement;\n\tprivate readonly focusEmitter = this._register(new Emitter<void>());\n\tpublic readonly onDidFocus = this.focusEmitter.event;\n\tprivate readonly history: StoredValue<{ values: string[]; lastValue: string } | string[]>;\n\n\tprivate readonly filtersAction = new Action('markersFiltersAction', localize('testing.filters.menu', \"More Filters...\"), 'testing-filter-button ' + ThemeIcon.asClassName(testingFilterIcon));\n\n\tconstructor(\n\t\taction: IAction,\n\t\toptions: IBaseActionViewItemOptions,\n\t\t@ITestExplorerFilterState private readonly state: ITestExplorerFilterState,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ITestService private readonly testService: ITestService,\n\t) {\n\t\tsuper(null, action, options);\n\t\tthis.history = this._register(instantiationService.createInstance(StoredValue, {\n\t\t\tkey: 'testing.filterHistory2',\n\t\t\tscope: StorageScope.WORKSPACE,\n\t\t\ttarget: StorageTarget.MACHINE\n\t\t}));\n\t\tthis.updateFilterActiveState();\n\t\tthis._register(testService.excluded.onTestExclusionsChanged(this.updateFilterActiveState, this));\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override render(container: HTMLElement) {\n\t\tcontainer.classList.add('testing-filter-action-item');\n\n\t\tconst updateDelayer = this._register(new Delayer<void>(400));\n\t\tconst wrapper = this.wrapper = dom.$('.testing-filter-wrapper');\n\t\tcontainer.appendChild(wrapper);\n\n\t\tlet history = this.history.get({ lastValue: '', values: [] });\n\t\tif (history instanceof Array) {\n\t\t\thistory = { lastValue: '', values: history };\n\t\t}\n\t\tif (history.lastValue) {\n\t\t\tthis.state.setText(history.lastValue);\n\t\t}\n\n\t\tconst input = this.input = this._register(this.instantiationService.createInstance(ContextScopedSuggestEnabledInputWithHistory, {\n\t\t\tid: 'testing.explorer.filter',\n\t\t\tariaLabel: localize('testExplorerFilterLabel', \"Filter text for tests in the explorer\"),\n\t\t\tparent: wrapper,\n\t\t\tsuggestionProvider: {\n\t\t\t\ttriggerCharacters: ['@'],\n\t\t\t\tprovideResults: () => [\n\t\t\t\t\t...Object.entries(testFilterDescriptions).map(([label, detail]) => ({ label, detail })),\n\t\t\t\t\t...Iterable.map(this.testService.collection.tags.values(), tag => {\n\t\t\t\t\t\tconst { ctrlId, tagId } = denamespaceTestTag(tag.id);\n\t\t\t\t\t\tconst insertText = `@${ctrlId}:${tagId}`;\n\t\t\t\t\t\treturn ({\n\t\t\t\t\t\t\tlabel: `@${ctrlId}:${tagId}`,\n\t\t\t\t\t\t\tdetail: this.testService.collection.getNodeById(ctrlId)?.item.label,\n\t\t\t\t\t\t\tinsertText: tagId.includes(' ') ? `@${ctrlId}:\"${tagId.replace(/([\"\\\\])/g, '\\\\$1')}\"` : insertText,\n\t\t\t\t\t\t});\n\t\t\t\t\t}),\n\t\t\t\t].filter(r => !this.state.text.value.includes(r.label)),\n\t\t\t} satisfies SuggestResultsProvider,\n\t\t\tresourceHandle: 'testing:filter',\n\t\t\tsuggestOptions: {\n\t\t\t\tvalue: this.state.text.value,\n\t\t\t\tplaceholderText: localize('testExplorerFilter', \"Filter (e.g. text, !exclude, @tag)\"),\n\t\t\t},\n\t\t\thistory: history.values\n\t\t}));\n\n\t\tthis._register(this.state.text.onDidChange(newValue => {\n\t\t\tif (input.getValue() !== newValue) {\n\t\t\t\tinput.setValue(newValue);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.state.onDidRequestInputFocus(() => {\n\t\t\tinput.focus();\n\t\t}));\n\n\t\tthis._register(input.onDidFocus(() => {\n\t\t\tthis.focusEmitter.fire();\n\t\t}));\n\n\t\tthis._register(input.onInputDidChange(() => updateDelayer.trigger(() => {\n\t\t\tinput.addToHistory();\n\t\t\tthis.state.setText(input.getValue());\n\t\t})));\n\n\t\tconst actionbar = this._register(new ActionBar(container, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action.id === this.filtersAction.id) {\n\t\t\t\t\treturn this.instantiationService.createInstance(FiltersDropdownMenuActionViewItem, action, options, this.state, this.actionRunner);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t}));\n\t\tactionbar.push(this.filtersAction, { icon: true, label: false });\n\n\t\tthis.layout(this.wrapper.clientWidth);\n\t}\n\n\tpublic layout(width: number) {\n\t\tthis.input.layout(new dom.Dimension(\n\t\t\twidth - /* horizontal padding */ 24 - /* editor padding */ 8 - /* filter button padding */ 22,\n\t\t\t20, // line height from suggestEnabledInput.ts\n\t\t));\n\t}\n\n\n\t/**\n\t * Focuses the filter input.\n\t */\n\tpublic override focus(): void {\n\t\tthis.input.focus();\n\t}\n\n\t/**\n\t * Persists changes to the input history.\n\t */\n\tpublic saveState() {\n\t\tthis.history.store({ lastValue: this.input.getValue(), values: this.input.getHistory() });\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override dispose() {\n\t\tthis.saveState();\n\t\tsuper.dispose();\n\t}\n\n\t/**\n\t * Updates the 'checked' state of the filter submenu.\n\t */\n\tprivate updateFilterActiveState() {\n\t\tthis.filtersAction.checked = this.testService.excluded.hasAny;\n\t}\n}\n\n\nclass FiltersDropdownMenuActionViewItem extends DropdownMenuActionViewItem {\n\n\tconstructor(\n\t\taction: IAction,\n\t\toptions: IActionViewItemOptions,\n\t\tprivate readonly filters: ITestExplorerFilterState,\n\t\tactionRunner: IActionRunner,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ITestService private readonly testService: ITestService,\n\t) {\n\t\tsuper(action,\n\t\t\t{ getActions: () => this.getActions() },\n\t\t\tcontextMenuService,\n\t\t\t{\n\t\t\t\tactionRunner,\n\t\t\t\tclassNames: action.class,\n\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT,\n\t\t\t\tmenuAsChild: true\n\t\t\t}\n\t\t);\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tthis.updateChecked();\n\t}\n\n\tprivate getActions(): IAction[] {\n\t\treturn [\n\t\t\t...[TestFilterTerm.Failed, TestFilterTerm.Executed, TestFilterTerm.CurrentDoc, TestFilterTerm.OpenedFiles].map(term => ({\n\t\t\t\tchecked: this.filters.isFilteringFor(term),\n\t\t\t\tclass: undefined,\n\t\t\t\tenabled: true,\n\t\t\t\tid: term,\n\t\t\t\tlabel: testFilterDescriptions[term],\n\t\t\t\trun: () => this.filters.toggleFilteringFor(term),\n\t\t\t\ttooltip: '',\n\t\t\t\tdispose: () => null\n\t\t\t})),\n\t\t\tnew Separator(),\n\t\t\t{\n\t\t\t\tchecked: this.filters.fuzzy.value,\n\t\t\t\tclass: undefined,\n\t\t\t\tenabled: true,\n\t\t\t\tid: 'fuzzy',\n\t\t\t\tlabel: localize('testing.filters.fuzzyMatch', \"Fuzzy Match\"),\n\t\t\t\trun: () => this.filters.fuzzy.value = !this.filters.fuzzy.value,\n\t\t\t\ttooltip: ''\n\t\t\t},\n\t\t\tnew Separator(),\n\t\t\t{\n\t\t\t\tchecked: this.filters.isFilteringFor(TestFilterTerm.Hidden),\n\t\t\t\tclass: undefined,\n\t\t\t\tenabled: this.testService.excluded.hasAny,\n\t\t\t\tid: 'showExcluded',\n\t\t\t\tlabel: localize('testing.filters.showExcludedTests', \"Show Hidden Tests\"),\n\t\t\t\trun: () => this.filters.toggleFilteringFor(TestFilterTerm.Hidden),\n\t\t\t\ttooltip: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tclass: undefined,\n\t\t\t\tenabled: this.testService.excluded.hasAny,\n\t\t\t\tid: 'removeExcluded',\n\t\t\t\tlabel: localize('testing.filters.removeTestExclusions', \"Unhide All Tests\"),\n\t\t\t\trun: async () => this.testService.excluded.clear(),\n\t\t\t\ttooltip: ''\n\t\t\t}\n\t\t];\n\t}\n\n\tprotected override updateChecked(): void {\n\t\tthis.element!.classList.toggle('checked', this._action.checked);\n\t}\n}\n"]}