{"version":3,"sources":["vs/workbench/contrib/testing/browser/testingConfigurationUi.ts"],"names":[],"mappings":"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","file":"testingConfigurationUi.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { localize } from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { QuickPickInput, IQuickPickItem, IQuickInputService, IQuickPickItemButtonEvent } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { testingUpdateProfiles } from './icons.js';\nimport { testConfigurationGroupNames } from '../common/constants.js';\nimport { InternalTestItem, ITestRunProfile, TestRunProfileBitset } from '../common/testTypes.js';\nimport { canUseProfileWithTest, ITestProfileService } from '../common/testProfileService.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\ninterface IConfigurationPickerOptions {\n\t/** Placeholder text */\n\tplaceholder?: string;\n\t/** Show buttons to trigger configuration */\n\tshowConfigureButtons?: boolean;\n\t/** Only show configurations from this controller */\n\tonlyForTest?: InternalTestItem;\n\t/** Only show this group */\n\tonlyGroup?: TestRunProfileBitset;\n\t/** Only show items which are configurable */\n\tonlyConfigurable?: boolean;\n}\n\nfunction buildPicker(accessor: ServicesAccessor, {\n\tonlyGroup,\n\tshowConfigureButtons = true,\n\tonlyForTest,\n\tonlyConfigurable,\n\tplaceholder = localize('testConfigurationUi.pick', 'Pick a test profile to use'),\n}: IConfigurationPickerOptions) {\n\tconst profileService = accessor.get(ITestProfileService);\n\tconst items: QuickPickInput<IQuickPickItem & { profile: ITestRunProfile }>[] = [];\n\tconst pushItems = (allProfiles: ITestRunProfile[], description?: string) => {\n\t\tfor (const profiles of groupBy(allProfiles, (a, b) => a.group - b.group)) {\n\t\t\tlet addedHeader = false;\n\t\t\tif (onlyGroup) {\n\t\t\t\tif (profiles[0].group !== onlyGroup) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\taddedHeader = true; // showing one group, no need for label\n\t\t\t}\n\n\t\t\tfor (const profile of profiles) {\n\t\t\t\tif (onlyConfigurable && !profile.hasConfigurationHandler) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!addedHeader) {\n\t\t\t\t\titems.push({ type: 'separator', label: testConfigurationGroupNames[profiles[0].group] });\n\t\t\t\t\taddedHeader = true;\n\t\t\t\t}\n\n\t\t\t\titems.push(({\n\t\t\t\t\ttype: 'item',\n\t\t\t\t\tprofile,\n\t\t\t\t\tlabel: profile.label,\n\t\t\t\t\tdescription,\n\t\t\t\t\talwaysShow: true,\n\t\t\t\t\tbuttons: profile.hasConfigurationHandler && showConfigureButtons\n\t\t\t\t\t\t? [{\n\t\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(testingUpdateProfiles),\n\t\t\t\t\t\t\ttooltip: localize('updateTestConfiguration', 'Update Test Configuration')\n\t\t\t\t\t\t}] : []\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t};\n\n\tif (onlyForTest !== undefined) {\n\t\tpushItems(profileService.getControllerProfiles(onlyForTest.controllerId).filter(p => canUseProfileWithTest(p, onlyForTest)));\n\t} else {\n\t\tfor (const { profiles, controller } of profileService.all()) {\n\t\t\tpushItems(profiles, controller.label.get());\n\t\t}\n\t}\n\n\tconst quickpick = accessor.get(IQuickInputService).createQuickPick<IQuickPickItem & { profile: ITestRunProfile }>({ useSeparators: true });\n\tquickpick.items = items;\n\tquickpick.placeholder = placeholder;\n\treturn quickpick;\n}\n\nconst triggerButtonHandler = (service: ITestProfileService, resolve: (arg: undefined) => void) =>\n\t(evt: IQuickPickItemButtonEvent<IQuickPickItem>) => {\n\t\tconst profile = (evt.item as { profile?: ITestRunProfile }).profile;\n\t\tif (profile) {\n\t\t\tservice.configure(profile.controllerId, profile.profileId);\n\t\t\tresolve(undefined);\n\t\t}\n\t};\n\nCommandsRegistry.registerCommand({\n\tid: 'vscode.pickMultipleTestProfiles',\n\thandler: async (accessor: ServicesAccessor, options: IConfigurationPickerOptions & {\n\t\tselected?: ITestRunProfile[];\n\t}) => {\n\t\tconst profileService = accessor.get(ITestProfileService);\n\t\tconst quickpick = buildPicker(accessor, options);\n\t\tif (!quickpick) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(quickpick);\n\n\t\tquickpick.canSelectMany = true;\n\t\tif (options.selected) {\n\t\t\tquickpick.selectedItems = quickpick.items\n\t\t\t\t.filter((i): i is IQuickPickItem & { profile: ITestRunProfile } => i.type === 'item')\n\t\t\t\t.filter(i => options.selected!.some(s => s.controllerId === i.profile.controllerId && s.profileId === i.profile.profileId));\n\t\t}\n\n\t\tconst pick = await new Promise<ITestRunProfile[] | undefined>(resolve => {\n\t\t\tdisposables.add(quickpick.onDidAccept(() => {\n\t\t\t\tconst selected = quickpick.selectedItems as readonly { profile?: ITestRunProfile }[];\n\t\t\t\tresolve(selected.map(s => s.profile).filter(isDefined));\n\t\t\t}));\n\t\t\tdisposables.add(quickpick.onDidHide(() => resolve(undefined)));\n\t\t\tdisposables.add(quickpick.onDidTriggerItemButton(triggerButtonHandler(profileService, resolve)));\n\t\t\tquickpick.show();\n\t\t});\n\n\t\tdisposables.dispose();\n\t\treturn pick;\n\t}\n});\n\nCommandsRegistry.registerCommand({\n\tid: 'vscode.pickTestProfile',\n\thandler: async (accessor: ServicesAccessor, options: IConfigurationPickerOptions) => {\n\t\tconst profileService = accessor.get(ITestProfileService);\n\t\tconst quickpick = buildPicker(accessor, options);\n\t\tif (!quickpick) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(quickpick);\n\n\t\tconst pick = await new Promise<ITestRunProfile | undefined>(resolve => {\n\t\t\tdisposables.add(quickpick.onDidAccept(() => resolve((quickpick.selectedItems[0] as { profile?: ITestRunProfile })?.profile)));\n\t\t\tdisposables.add(quickpick.onDidHide(() => resolve(undefined)));\n\t\t\tdisposables.add(quickpick.onDidTriggerItemButton(triggerButtonHandler(profileService, resolve)));\n\t\t\tquickpick.show();\n\t\t});\n\n\t\tdisposables.dispose();\n\t\treturn pick;\n\t}\n});\n\n"]}