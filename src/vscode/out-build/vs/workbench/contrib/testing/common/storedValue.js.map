{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/testing/common/storedValue.ts","vs/workbench/contrib/testing/common/storedValue.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAGhG,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAClE,OAAO,EAAE,eAAe,EAAyD,MAAM,gDAAgD,CAAC;AAOxI,MAAM,oBAAoB,GAAmC;IAC5D,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;IAC/B,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;CACjC,CAAC;AASF;;GAEG;AACI,IAAM,WAAW,GAAjB,MAAM,WAAe,SAAQ,UAAU;IAY7C,YACC,OAA+B,EACG,OAAwB;QAE1D,KAAK,EAAE,CAAC;QAF0B,YAAO,GAAP,OAAO,CAAiB;QAI1D,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;QACvB,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAC3B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC7B,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,oBAAoB,CAAC;QACnE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IACrF,CAAC;IAYM,GAAG,CAAC,YAAgB;QAC1B,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE,CAAC;YAC9B,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACrD,IAAI,CAAC,KAAK,GAAG,KAAK,KAAK,SAAS,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACzF,CAAC;QAED,OAAO,IAAI,CAAC,KAAK,CAAC;IACnB,CAAC;IAED;;;OAGG;IACI,KAAK,CAAC,KAAQ;QACpB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IAC5F,CAAC;IAED;;OAEG;IACI,MAAM;QACZ,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC3C,CAAC;CACD,CAAA;AA3DY,WAAW;IAcrB,WAAA,eAAe,CAAA;GAdL,WAAW,CA2DvB","file":"storedValue.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IStorageService, IStorageValueChangeEvent, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\n\nexport interface IStoredValueSerialization<T> {\n\tdeserialize(data: string): T;\n\tserialize(data: T): string;\n}\n\nconst defaultSerialization: IStoredValueSerialization<any> = {\n\tdeserialize: d => JSON.parse(d),\n\tserialize: d => JSON.stringify(d),\n};\n\ninterface IStoredValueOptions<T> {\n\tkey: string;\n\tscope: StorageScope;\n\ttarget: StorageTarget;\n\tserialization?: IStoredValueSerialization<T>;\n}\n\n/**\n * todo@connor4312: is this worthy to be in common?\n */\nexport class StoredValue<T> extends Disposable {\n\tprivate readonly serialization: IStoredValueSerialization<T>;\n\tprivate readonly key: string;\n\tprivate readonly scope: StorageScope;\n\tprivate readonly target: StorageTarget;\n\tprivate value?: T;\n\n\t/**\n\t * Emitted whenever the value is updated or deleted.\n\t */\n\tpublic readonly onDidChange: Event<IStorageValueChangeEvent>;\n\n\tconstructor(\n\t\toptions: IStoredValueOptions<T>,\n\t\t@IStorageService private readonly storage: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\tthis.key = options.key;\n\t\tthis.scope = options.scope;\n\t\tthis.target = options.target;\n\t\tthis.serialization = options.serialization ?? defaultSerialization;\n\t\tthis.onDidChange = this.storage.onDidChangeValue(this.scope, this.key, this._store);\n\t}\n\n\t/**\n\t * Reads the value, returning the undefined if it's not set.\n\t */\n\tpublic get(): T | undefined;\n\n\t/**\n\t * Reads the value, returning the default value if it's not set.\n\t */\n\tpublic get(defaultValue: T): T;\n\n\tpublic get(defaultValue?: T): T | undefined {\n\t\tif (this.value === undefined) {\n\t\t\tconst value = this.storage.get(this.key, this.scope);\n\t\t\tthis.value = value === undefined ? defaultValue : this.serialization.deserialize(value);\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\t/**\n\t * Persists changes to the value.\n\t * @param value\n\t */\n\tpublic store(value: T) {\n\t\tthis.value = value;\n\t\tthis.storage.store(this.key, this.serialization.serialize(value), this.scope, this.target);\n\t}\n\n\t/**\n\t * Delete an element stored under the provided key from storage.\n\t */\n\tpublic delete() {\n\t\tthis.storage.remove(this.key, this.scope);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IStorageService, IStorageValueChangeEvent, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\n\nexport interface IStoredValueSerialization<T> {\n\tdeserialize(data: string): T;\n\tserialize(data: T): string;\n}\n\nconst defaultSerialization: IStoredValueSerialization<any> = {\n\tdeserialize: d => JSON.parse(d),\n\tserialize: d => JSON.stringify(d),\n};\n\ninterface IStoredValueOptions<T> {\n\tkey: string;\n\tscope: StorageScope;\n\ttarget: StorageTarget;\n\tserialization?: IStoredValueSerialization<T>;\n}\n\n/**\n * todo@connor4312: is this worthy to be in common?\n */\nexport class StoredValue<T> extends Disposable {\n\tprivate readonly serialization: IStoredValueSerialization<T>;\n\tprivate readonly key: string;\n\tprivate readonly scope: StorageScope;\n\tprivate readonly target: StorageTarget;\n\tprivate value?: T;\n\n\t/**\n\t * Emitted whenever the value is updated or deleted.\n\t */\n\tpublic readonly onDidChange: Event<IStorageValueChangeEvent>;\n\n\tconstructor(\n\t\toptions: IStoredValueOptions<T>,\n\t\t@IStorageService private readonly storage: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\tthis.key = options.key;\n\t\tthis.scope = options.scope;\n\t\tthis.target = options.target;\n\t\tthis.serialization = options.serialization ?? defaultSerialization;\n\t\tthis.onDidChange = this.storage.onDidChangeValue(this.scope, this.key, this._store);\n\t}\n\n\t/**\n\t * Reads the value, returning the undefined if it's not set.\n\t */\n\tpublic get(): T | undefined;\n\n\t/**\n\t * Reads the value, returning the default value if it's not set.\n\t */\n\tpublic get(defaultValue: T): T;\n\n\tpublic get(defaultValue?: T): T | undefined {\n\t\tif (this.value === undefined) {\n\t\t\tconst value = this.storage.get(this.key, this.scope);\n\t\t\tthis.value = value === undefined ? defaultValue : this.serialization.deserialize(value);\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\t/**\n\t * Persists changes to the value.\n\t * @param value\n\t */\n\tpublic store(value: T) {\n\t\tthis.value = value;\n\t\tthis.storage.store(this.key, this.serialization.serialize(value), this.scope, this.target);\n\t}\n\n\t/**\n\t * Delete an element stored under the provided key from storage.\n\t */\n\tpublic delete() {\n\t\tthis.storage.remove(this.key, this.scope);\n\t}\n}\n"]}