{"version":3,"sources":["vs/workbench/contrib/testing/common/testResult.ts"],"names":[],"mappings":"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","file":"testResult.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable, observableValue } from '../../../../base/common/observable.js';\nimport { language } from '../../../../base/common/platform.js';\nimport { WellDefinedPrefixTree } from '../../../../base/common/prefixTree.js';\nimport { localize } from '../../../../nls.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IComputedStateAccessor, refreshComputedState } from './getComputedState.js';\nimport { TestCoverage } from './testCoverage.js';\nimport { TestId } from './testId.js';\nimport { makeEmptyCounts, maxPriority, statesInOrder, terminalStatePriorities, TestStateCount } from './testingStates.js';\nimport { getMarkId, IRichLocation, ISerializedTestResults, ITestItem, ITestMessage, ITestOutputMessage, ITestRunTask, ITestTaskState, ResolvedTestRunRequest, TestItemExpandState, TestMessageType, TestResultItem, TestResultState } from './testTypes.js';\n\nexport interface ITestRunTaskResults extends ITestRunTask {\n\t/**\n\t * Contains test coverage for the result, if it's available.\n\t */\n\treadonly coverage: IObservable<TestCoverage | undefined>;\n\n\t/**\n\t * Messages from the task not associated with any specific test.\n\t */\n\treadonly otherMessages: ITestOutputMessage[];\n\n\t/**\n\t * Test results output for the task.\n\t */\n\treadonly output: ITaskRawOutput;\n}\n\nexport interface ITestResult {\n\t/**\n\t * Count of the number of tests in each run state.\n\t */\n\treadonly counts: Readonly<TestStateCount>;\n\n\t/**\n\t * Unique ID of this set of test results.\n\t */\n\treadonly id: string;\n\n\t/**\n\t * If the test is completed, the unix milliseconds time at which it was\n\t * completed. If undefined, the test is still running.\n\t */\n\treadonly completedAt: number | undefined;\n\n\t/**\n\t * Whether this test result is triggered from an auto run.\n\t */\n\treadonly request: ResolvedTestRunRequest;\n\n\t/**\n\t * Human-readable name of the test result.\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Gets all tests involved in the run.\n\t */\n\ttests: IterableIterator<TestResultItem>;\n\n\t/**\n\t * List of this result's subtasks.\n\t */\n\ttasks: ReadonlyArray<ITestRunTaskResults>;\n\n\t/**\n\t * Gets the state of the test by its extension-assigned ID.\n\t */\n\tgetStateById(testExtId: string): TestResultItem | undefined;\n\n\t/**\n\t * Serializes the test result. Used to save and restore results\n\t * in the workspace.\n\t */\n\ttoJSON(): ISerializedTestResults | undefined;\n\n\t/**\n\t * Serializes the test result, includes messages. Used to send the test states to the extension host.\n\t */\n\ttoJSONWithMessages(): ISerializedTestResults | undefined;\n}\n\n/**\n * Output type exposed from live test results.\n */\nexport interface ITaskRawOutput {\n\treadonly onDidWriteData: Event<VSBuffer>;\n\treadonly endPromise: Promise<void>;\n\treadonly buffers: VSBuffer[];\n\treadonly length: number;\n\n\t/** Gets a continuous buffer for the desired range */\n\tgetRange(start: number, length: number): VSBuffer;\n\t/** Gets an iterator of buffers for the range; may avoid allocation of getRange() */\n\tgetRangeIter(start: number, length: number): Iterable<VSBuffer>;\n}\n\nconst emptyRawOutput: ITaskRawOutput = {\n\tbuffers: [],\n\tlength: 0,\n\tonDidWriteData: Event.None,\n\tendPromise: Promise.resolve(),\n\tgetRange: () => VSBuffer.alloc(0),\n\tgetRangeIter: () => [],\n};\n\nexport class TaskRawOutput implements ITaskRawOutput {\n\tprivate readonly writeDataEmitter = new Emitter<VSBuffer>();\n\tprivate readonly endDeferred = new DeferredPromise<void>();\n\tprivate offset = 0;\n\n\t/** @inheritdoc */\n\tpublic readonly onDidWriteData = this.writeDataEmitter.event;\n\n\t/** @inheritdoc */\n\tpublic readonly endPromise = this.endDeferred.p;\n\n\t/** @inheritdoc */\n\tpublic readonly buffers: VSBuffer[] = [];\n\n\t/** @inheritdoc */\n\tpublic get length() {\n\t\treturn this.offset;\n\t}\n\n\t/** @inheritdoc */\n\tgetRange(start: number, length: number): VSBuffer {\n\t\tconst buf = VSBuffer.alloc(length);\n\t\tlet bufLastWrite = 0;\n\t\tfor (const chunk of this.getRangeIter(start, length)) {\n\t\t\tbuf.buffer.set(chunk.buffer, bufLastWrite);\n\t\t\tbufLastWrite += chunk.byteLength;\n\t\t}\n\n\t\treturn bufLastWrite < length ? buf.slice(0, bufLastWrite) : buf;\n\t}\n\n\t/** @inheritdoc */\n\t*getRangeIter(start: number, length: number) {\n\t\tlet soFar = 0;\n\t\tlet internalLastRead = 0;\n\t\tfor (const b of this.buffers) {\n\t\t\tif (internalLastRead + b.byteLength <= start) {\n\t\t\t\tinternalLastRead += b.byteLength;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst bstart = Math.max(0, start - internalLastRead);\n\t\t\tconst bend = Math.min(b.byteLength, bstart + length - soFar);\n\n\t\t\tyield b.slice(bstart, bend);\n\t\t\tsoFar += bend - bstart;\n\t\t\tinternalLastRead += b.byteLength;\n\n\t\t\tif (soFar === length) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Appends data to the output, returning the byte range where the data can be found.\n\t */\n\tpublic append(data: VSBuffer, marker?: number) {\n\t\tconst offset = this.offset;\n\t\tlet length = data.byteLength;\n\t\tif (marker === undefined) {\n\t\t\tthis.push(data);\n\t\t\treturn { offset, length };\n\t\t}\n\n\t\t// Bytes that should be 'trimmed' off the end of data. This is done because\n\t\t// selections in the terminal are based on the entire line, and commonly\n\t\t// the interesting marked range has a trailing new line. We don't want to\n\t\t// select the trailing line (which might have other data)\n\t\t// so we place the marker before all trailing trimbytes.\n\t\tconst enum TrimBytes {\n\t\t\tCR = 13,\n\t\t\tLF = 10,\n\t\t}\n\n\t\tconst start = VSBuffer.fromString(getMarkCode(marker, true));\n\t\tconst end = VSBuffer.fromString(getMarkCode(marker, false));\n\t\tlength += start.byteLength + end.byteLength;\n\n\t\tthis.push(start);\n\t\tlet trimLen = data.byteLength;\n\t\tfor (; trimLen > 0; trimLen--) {\n\t\t\tconst last = data.buffer[trimLen - 1];\n\t\t\tif (last !== TrimBytes.CR && last !== TrimBytes.LF) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.push(data.slice(0, trimLen));\n\t\tthis.push(end);\n\t\tthis.push(data.slice(trimLen));\n\n\n\t\treturn { offset, length };\n\t}\n\n\tprivate push(data: VSBuffer) {\n\t\tif (data.byteLength === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.buffers.push(data);\n\t\tthis.writeDataEmitter.fire(data);\n\t\tthis.offset += data.byteLength;\n\t}\n\n\t/** Signals the output has ended. */\n\tpublic end() {\n\t\tthis.endDeferred.complete();\n\t}\n}\n\nexport const resultItemParents = function* (results: ITestResult, item: TestResultItem) {\n\tfor (const id of TestId.fromString(item.item.extId).idsToRoot()) {\n\t\tyield results.getStateById(id.toString())!;\n\t}\n};\n\nexport const maxCountPriority = (counts: Readonly<TestStateCount>) => {\n\tfor (const state of statesInOrder) {\n\t\tif (counts[state] > 0) {\n\t\t\treturn state;\n\t\t}\n\t}\n\n\treturn TestResultState.Unset;\n};\n\nconst getMarkCode = (marker: number, start: boolean) => `\\x1b]633;SetMark;Id=${getMarkId(marker, start)};Hidden\\x07`;\n\ninterface TestResultItemWithChildren extends TestResultItem {\n\t/** Children in the run */\n\tchildren: TestResultItemWithChildren[];\n}\n\nconst itemToNode = (controllerId: string, item: ITestItem, parent: string | null): TestResultItemWithChildren => ({\n\tcontrollerId,\n\texpand: TestItemExpandState.NotExpandable,\n\titem: { ...item },\n\tchildren: [],\n\ttasks: [],\n\townComputedState: TestResultState.Unset,\n\tcomputedState: TestResultState.Unset,\n});\n\nexport const enum TestResultItemChangeReason {\n\tComputedStateChange,\n\tOwnStateChange,\n\tNewMessage,\n}\n\nexport type TestResultItemChange = { item: TestResultItem; result: ITestResult } & (\n\t| { reason: TestResultItemChangeReason.ComputedStateChange }\n\t| { reason: TestResultItemChangeReason.OwnStateChange; previousState: TestResultState; previousOwnDuration: number | undefined }\n\t| { reason: TestResultItemChangeReason.NewMessage; message: ITestMessage }\n);\n\n/**\n * Results of a test. These are created when the test initially started running\n * and marked as \"complete\" when the run finishes.\n */\nexport class LiveTestResult extends Disposable implements ITestResult {\n\tprivate readonly completeEmitter = this._register(new Emitter<void>());\n\tprivate readonly newTaskEmitter = this._register(new Emitter<number>());\n\tprivate readonly endTaskEmitter = this._register(new Emitter<number>());\n\tprivate readonly changeEmitter = this._register(new Emitter<TestResultItemChange>());\n\t/** todo@connor4312: convert to a WellDefinedPrefixTree */\n\tprivate readonly testById = new Map<string, TestResultItemWithChildren>();\n\tprivate testMarkerCounter = 0;\n\tprivate _completedAt?: number;\n\n\tpublic readonly startedAt = Date.now();\n\tpublic readonly onChange = this.changeEmitter.event;\n\tpublic readonly onComplete = this.completeEmitter.event;\n\tpublic readonly onNewTask = this.newTaskEmitter.event;\n\tpublic readonly onEndTask = this.endTaskEmitter.event;\n\tpublic readonly tasks: (ITestRunTaskResults & { output: TaskRawOutput })[] = [];\n\tpublic readonly name = localize('runFinished', 'Test run at {0}', new Date().toLocaleString(language));\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic get completedAt() {\n\t\treturn this._completedAt;\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly counts = makeEmptyCounts();\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic get tests() {\n\t\treturn this.testById.values();\n\t}\n\n\t/** Gets an included test item by ID. */\n\tpublic getTestById(id: string) {\n\t\treturn this.testById.get(id)?.item;\n\t}\n\n\tprivate readonly computedStateAccessor: IComputedStateAccessor<TestResultItemWithChildren> = {\n\t\tgetOwnState: i => i.ownComputedState,\n\t\tgetCurrentComputedState: i => i.computedState,\n\t\tsetComputedState: (i, s) => i.computedState = s,\n\t\tgetChildren: i => i.children,\n\t\tgetParents: i => {\n\t\t\tconst { testById: testByExtId } = this;\n\t\t\treturn (function* () {\n\t\t\t\tconst parentId = TestId.fromString(i.item.extId).parentId;\n\t\t\t\tif (parentId) {\n\t\t\t\t\tfor (const id of parentId.idsToRoot()) {\n\t\t\t\t\t\tyield testByExtId.get(id.toString())!;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})();\n\t\t},\n\t};\n\n\tconstructor(\n\t\tpublic readonly id: string,\n\t\tpublic readonly persist: boolean,\n\t\tpublic readonly request: ResolvedTestRunRequest,\n\t\tpublic readonly insertOrder: number,\n\t\t@ITelemetryService private readonly telemetry: ITelemetryService,\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic getStateById(extTestId: string) {\n\t\treturn this.testById.get(extTestId);\n\t}\n\n\t/**\n\t * Appends output that occurred during the test run.\n\t */\n\tpublic appendOutput(output: VSBuffer, taskId: string, location?: IRichLocation, testId?: string): void {\n\t\tconst preview = output.byteLength > 100 ? output.slice(0, 100).toString() + 'â€¦' : output.toString();\n\t\tlet marker: number | undefined;\n\n\t\t// currently, the UI only exposes jump-to-message from tests or locations,\n\t\t// so no need to mark outputs that don't come from either of those.\n\t\tif (testId || location) {\n\t\t\tmarker = this.testMarkerCounter++;\n\t\t}\n\n\t\tconst index = this.mustGetTaskIndex(taskId);\n\t\tconst task = this.tasks[index];\n\n\t\tconst { offset, length } = task.output.append(output, marker);\n\t\tconst message: ITestOutputMessage = {\n\t\t\tlocation,\n\t\t\tmessage: preview,\n\t\t\toffset,\n\t\t\tlength,\n\t\t\tmarker,\n\t\t\ttype: TestMessageType.Output,\n\t\t};\n\n\t\tconst test = testId && this.testById.get(testId);\n\t\tif (test) {\n\t\t\ttest.tasks[index].messages.push(message);\n\t\t\tthis.changeEmitter.fire({ item: test, result: this, reason: TestResultItemChangeReason.NewMessage, message });\n\t\t} else {\n\t\t\ttask.otherMessages.push(message);\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new run task to the results.\n\t */\n\tpublic addTask(task: ITestRunTask) {\n\t\tthis.tasks.push({ ...task, coverage: observableValue(this, undefined), otherMessages: [], output: new TaskRawOutput() });\n\n\t\tfor (const test of this.tests) {\n\t\t\ttest.tasks.push({ duration: undefined, messages: [], state: TestResultState.Unset });\n\t\t}\n\n\t\tthis.newTaskEmitter.fire(this.tasks.length - 1);\n\t}\n\n\t/**\n\t * Add the chain of tests to the run. The first test in the chain should\n\t * be either a test root, or a previously-known test.\n\t */\n\tpublic addTestChainToRun(controllerId: string, chain: ReadonlyArray<ITestItem>) {\n\t\tlet parent = this.testById.get(chain[0].extId);\n\t\tif (!parent) { // must be a test root\n\t\t\tparent = this.addTestToRun(controllerId, chain[0], null);\n\t\t}\n\n\t\tfor (let i = 1; i < chain.length; i++) {\n\t\t\tparent = this.addTestToRun(controllerId, chain[i], parent.item.extId);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Updates the state of the test by its internal ID.\n\t */\n\tpublic updateState(testId: string, taskId: string, state: TestResultState, duration?: number) {\n\t\tconst entry = this.testById.get(testId);\n\t\tif (!entry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = this.mustGetTaskIndex(taskId);\n\n\t\tconst oldTerminalStatePrio = terminalStatePriorities[entry.tasks[index].state];\n\t\tconst newTerminalStatePrio = terminalStatePriorities[state];\n\n\t\t// Ignore requests to set the state from one terminal state back to a\n\t\t// \"lower\" one, e.g. from failed back to passed:\n\t\tif (oldTerminalStatePrio !== undefined &&\n\t\t\t(newTerminalStatePrio === undefined || newTerminalStatePrio < oldTerminalStatePrio)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.fireUpdateAndRefresh(entry, index, state, duration);\n\t}\n\n\t/**\n\t * Appends a message for the test in the run.\n\t */\n\tpublic appendMessage(testId: string, taskId: string, message: ITestMessage) {\n\t\tconst entry = this.testById.get(testId);\n\t\tif (!entry) {\n\t\t\treturn;\n\t\t}\n\n\t\tentry.tasks[this.mustGetTaskIndex(taskId)].messages.push(message);\n\t\tthis.changeEmitter.fire({ item: entry, result: this, reason: TestResultItemChangeReason.NewMessage, message });\n\t}\n\n\t/**\n\t * Marks the task in the test run complete.\n\t */\n\tpublic markTaskComplete(taskId: string) {\n\t\tconst index = this.mustGetTaskIndex(taskId);\n\t\tconst task = this.tasks[index];\n\t\ttask.running = false;\n\t\ttask.output.end();\n\n\t\tthis.setAllToState(\n\t\t\tTestResultState.Skipped,\n\t\t\ttaskId,\n\t\t\tt => t.state === TestResultState.Queued || t.state === TestResultState.Running,\n\t\t);\n\n\t\tthis.endTaskEmitter.fire(index);\n\t}\n\n\t/**\n\t * Notifies the service that all tests are complete.\n\t */\n\tpublic markComplete() {\n\t\tif (this._completedAt !== undefined) {\n\t\t\tthrow new Error('cannot complete a test result multiple times');\n\t\t}\n\n\t\tfor (const task of this.tasks) {\n\t\t\tif (task.running) {\n\t\t\t\tthis.markTaskComplete(task.id);\n\t\t\t}\n\t\t}\n\n\t\tthis._completedAt = Date.now();\n\t\tthis.completeEmitter.fire();\n\n\t\tthis.telemetry.publicLog2<\n\t\t\t{ failures: number; passes: number; controller: string },\n\t\t\t{\n\t\t\t\towner: 'connor4312';\n\t\t\t\tcomment: 'Test outcome metrics. This helps us understand magnitude of feature use and how to build fix suggestions.';\n\t\t\t\tfailures: { comment: 'Number of test failures'; classification: 'SystemMetaData'; purpose: 'FeatureInsight' };\n\t\t\t\tpasses: { comment: 'Number of test failures'; classification: 'SystemMetaData'; purpose: 'FeatureInsight' };\n\t\t\t\tcontroller: { comment: 'The test controller being used'; classification: 'SystemMetaData'; purpose: 'FeatureInsight' };\n\t\t\t}\n\t\t>('test.outcomes', {\n\t\t\tfailures: this.counts[TestResultState.Errored] + this.counts[TestResultState.Failed],\n\t\t\tpasses: this.counts[TestResultState.Passed],\n\t\t\tcontroller: this.request.targets.map(t => t.controllerId).join(',')\n\t\t});\n\t}\n\n\t/**\n\t * Marks the test and all of its children in the run as retired.\n\t */\n\tpublic markRetired(testIds: WellDefinedPrefixTree<undefined> | undefined) {\n\t\tfor (const [id, test] of this.testById) {\n\t\t\tif (!test.retired && (!testIds || testIds.hasKeyOrParent(TestId.fromString(id).path))) {\n\t\t\t\ttest.retired = true;\n\t\t\t\tthis.changeEmitter.fire({ reason: TestResultItemChangeReason.ComputedStateChange, item: test, result: this });\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic toJSON(): ISerializedTestResults | undefined {\n\t\treturn this.completedAt && this.persist ? this.doSerialize.value : undefined;\n\t}\n\n\tpublic toJSONWithMessages(): ISerializedTestResults | undefined {\n\t\treturn this.completedAt && this.persist ? this.doSerializeWithMessages.value : undefined;\n\t}\n\n\t/**\n\t * Updates all tests in the collection to the given state.\n\t */\n\tprotected setAllToState(state: TestResultState, taskId: string, when: (task: ITestTaskState, item: TestResultItem) => boolean) {\n\t\tconst index = this.mustGetTaskIndex(taskId);\n\t\tfor (const test of this.testById.values()) {\n\t\t\tif (when(test.tasks[index], test)) {\n\t\t\t\tthis.fireUpdateAndRefresh(test, index, state);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate fireUpdateAndRefresh(entry: TestResultItem, taskIndex: number, newState: TestResultState, newOwnDuration?: number) {\n\t\tconst previousOwnComputed = entry.ownComputedState;\n\t\tconst previousOwnDuration = entry.ownDuration;\n\t\tconst changeEvent: TestResultItemChange = {\n\t\t\titem: entry,\n\t\t\tresult: this,\n\t\t\treason: TestResultItemChangeReason.OwnStateChange,\n\t\t\tpreviousState: previousOwnComputed,\n\t\t\tpreviousOwnDuration: previousOwnDuration,\n\t\t};\n\n\t\tentry.tasks[taskIndex].state = newState;\n\t\tif (newOwnDuration !== undefined) {\n\t\t\tentry.tasks[taskIndex].duration = newOwnDuration;\n\t\t\tentry.ownDuration = Math.max(entry.ownDuration || 0, newOwnDuration);\n\t\t}\n\n\t\tconst newOwnComputed = maxPriority(...entry.tasks.map(t => t.state));\n\t\tif (newOwnComputed === previousOwnComputed) {\n\t\t\tif (newOwnDuration !== previousOwnDuration) {\n\t\t\t\tthis.changeEmitter.fire(changeEvent); // fire manually since state change won't do it\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tentry.ownComputedState = newOwnComputed;\n\t\tthis.counts[previousOwnComputed]--;\n\t\tthis.counts[newOwnComputed]++;\n\t\trefreshComputedState(this.computedStateAccessor, entry).forEach(t =>\n\t\t\tthis.changeEmitter.fire(t === entry ? changeEvent : {\n\t\t\t\titem: t,\n\t\t\t\tresult: this,\n\t\t\t\treason: TestResultItemChangeReason.ComputedStateChange,\n\t\t\t}),\n\t\t);\n\t}\n\n\tprivate addTestToRun(controllerId: string, item: ITestItem, parent: string | null) {\n\t\tconst node = itemToNode(controllerId, item, parent);\n\t\tthis.testById.set(item.extId, node);\n\t\tthis.counts[TestResultState.Unset]++;\n\n\t\tif (parent) {\n\t\t\tthis.testById.get(parent)?.children.push(node);\n\t\t}\n\n\t\tif (this.tasks.length) {\n\t\t\tfor (let i = 0; i < this.tasks.length; i++) {\n\t\t\t\tnode.tasks.push({ duration: undefined, messages: [], state: TestResultState.Unset });\n\t\t\t}\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tprivate mustGetTaskIndex(taskId: string) {\n\t\tconst index = this.tasks.findIndex(t => t.id === taskId);\n\t\tif (index === -1) {\n\t\t\tthrow new Error(`Unknown task ${taskId} in updateState`);\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tprivate readonly doSerialize = new Lazy((): ISerializedTestResults => ({\n\t\tid: this.id,\n\t\tcompletedAt: this.completedAt!,\n\t\ttasks: this.tasks.map(t => ({ id: t.id, name: t.name, ctrlId: t.ctrlId, hasCoverage: !!t.coverage.get() })),\n\t\tname: this.name,\n\t\trequest: this.request,\n\t\titems: [...this.testById.values()].map(TestResultItem.serializeWithoutMessages),\n\t}));\n\n\tprivate readonly doSerializeWithMessages = new Lazy((): ISerializedTestResults => ({\n\t\tid: this.id,\n\t\tcompletedAt: this.completedAt!,\n\t\ttasks: this.tasks.map(t => ({ id: t.id, name: t.name, ctrlId: t.ctrlId, hasCoverage: !!t.coverage.get() })),\n\t\tname: this.name,\n\t\trequest: this.request,\n\t\titems: [...this.testById.values()].map(TestResultItem.serialize),\n\t}));\n}\n\n/**\n * Test results hydrated from a previously-serialized test run.\n */\nexport class HydratedTestResult implements ITestResult {\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly counts = makeEmptyCounts();\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly id: string;\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly completedAt: number;\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly tasks: ITestRunTaskResults[];\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic get tests() {\n\t\treturn this.testById.values();\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly name: string;\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic readonly request: ResolvedTestRunRequest;\n\n\tprivate readonly testById = new Map<string, TestResultItem>();\n\n\tconstructor(\n\t\tidentity: IUriIdentityService,\n\t\tprivate readonly serialized: ISerializedTestResults,\n\t\tprivate readonly persist = true,\n\t) {\n\t\tthis.id = serialized.id;\n\t\tthis.completedAt = serialized.completedAt;\n\t\tthis.tasks = serialized.tasks.map((task, i) => ({\n\t\t\tid: task.id,\n\t\t\tname: task.name || localize('testUnnamedTask', 'Unnamed Task'),\n\t\t\tctrlId: task.ctrlId,\n\t\t\trunning: false,\n\t\t\tcoverage: observableValue(this, undefined),\n\t\t\toutput: emptyRawOutput,\n\t\t\totherMessages: []\n\t\t}));\n\t\tthis.name = serialized.name;\n\t\tthis.request = serialized.request;\n\n\t\tfor (const item of serialized.items) {\n\t\t\tconst de = TestResultItem.deserialize(identity, item);\n\t\t\tthis.counts[de.ownComputedState]++;\n\t\t\tthis.testById.set(item.item.extId, de);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic getStateById(extTestId: string) {\n\t\treturn this.testById.get(extTestId);\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic toJSON(): ISerializedTestResults | undefined {\n\t\treturn this.persist ? this.serialized : undefined;\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\tpublic toJSONWithMessages(): ISerializedTestResults | undefined {\n\t\treturn this.toJSON();\n\t}\n}\n"]}