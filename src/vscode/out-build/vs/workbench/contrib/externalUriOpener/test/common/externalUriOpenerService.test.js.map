{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/externalUriOpener/test/common/externalUriOpenerService.test.ts","vs/workbench/contrib/externalUriOpener/test/common/externalUriOpenerService.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,iBAAiB,EAAE,MAAM,4CAA4C,CAAC;AAC/E,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE,MAAM,yCAAyC,CAAC;AACtF,OAAO,EAAE,GAAG,EAAE,MAAM,mCAAmC,CAAC;AACxD,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AACnG,OAAO,EAAE,yBAAyB,EAAE,MAAM,2CAA2C,CAAC;AACtF,OAAO,EAAE,qBAAqB,EAAE,MAAM,+DAA+D,CAAC;AACtG,OAAO,EAAE,wBAAwB,EAAE,MAAM,+EAA+E,CAAC;AACzH,OAAO,EAAE,wBAAwB,EAAE,MAAM,+EAA+E,CAAC;AACzH,OAAO,EAAE,cAAc,EAAE,MAAM,iDAAiD,CAAC;AACjF,OAAO,EAAgB,kBAAkB,EAAkC,MAAM,yDAAyD,CAAC;AAC3I,OAAO,EAAE,wBAAwB,EAA+C,MAAM,0CAA0C,CAAC;AAGjI,MAAM,qBAAqB;IAE1B,YACkB,SAAiB;QAAjB,cAAS,GAAT,SAAS,CAAQ;IAC/B,CAAC;IAIE,KAAK,CAAC,IAAI,CAA2B,KAAyD,EAAE,OAA8C,EAAE,KAAyB;QAC/K,MAAM,aAAa,GAAG,MAAM,KAAK,CAAC;QAClC,MAAM,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC3C,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE,CAAC;YAC/B,OAAO,SAAS,CAAC;QAClB,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;CAED;AAED,KAAK,CAAC,0BAA0B,EAAE,GAAG,EAAE;IACtC,IAAI,WAA4B,CAAC;IACjC,IAAI,oBAA8C,CAAC;IAEnD,KAAK,CAAC,GAAG,EAAE;QACV,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;QACpC,oBAAoB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,wBAAwB,EAAE,CAAC,CAAC;QAEvE,oBAAoB,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,wBAAwB,EAAE,CAAC,CAAC;QACjF,oBAAoB,CAAC,IAAI,CAAC,cAAc,EAAE;YACzC,sBAAsB,EAAE,GAAG,EAAE,GAAG,OAAO,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;SACzD,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,GAAG,EAAE;QACb,WAAW,CAAC,OAAO,EAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,uCAAuC,EAAE,CAAC;IAE1C,IAAI,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;QAC1D,MAAM,wBAAwB,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAEhH,wBAAwB,CAAC,8BAA8B,CAAC,IAAI;YAC3D,KAAK,CAAC,CAAC,UAAU,CAAC,UAAe;gBAChC,OAAO;YACR,CAAC;SACD,CAAC,CAAC;QAEH,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;QAC5C,MAAM,OAAO,GAAG,MAAM,wBAAwB,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,EAAE,SAAS,EAAE,GAAG,EAAE,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACxH,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;IACpC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,uDAAuD,EAAE,KAAK,IAAI,EAAE;QACxE,oBAAoB,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,qBAAqB,CAAC,CAAC,CAAC,CAAC,CAAC;QAE5E,MAAM,wBAAwB,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAEhH,IAAI,iBAAiB,GAAG,KAAK,CAAC;QAC9B,wBAAwB,CAAC,8BAA8B,CAAC,IAAI;YAC3D,KAAK,CAAC,CAAC,UAAU,CAAC,UAAe;gBAChC,MAAM;oBACL,EAAE,EAAE,aAAa;oBACjB,KAAK,EAAE,UAAU;oBACjB,OAAO,EAAE,KAAK,IAAI,EAAE,CAAC,yBAAyB,CAAC,IAAI;oBACnD,eAAe,EAAE,KAAK,IAAI,EAAE,CAAC,IAAI;iBACjC,CAAC;gBACF,MAAM;oBACL,EAAE,EAAE,YAAY;oBAChB,KAAK,EAAE,SAAS;oBAChB,OAAO,EAAE,KAAK,IAAI,EAAE,CAAC,yBAAyB,CAAC,OAAO;oBACtD,eAAe,EAAE,KAAK,IAAI,EAAE;wBAC3B,iBAAiB,GAAG,IAAI,CAAC;wBACzB,OAAO,IAAI,CAAC;oBACb,CAAC;iBACD,CAAC;YACH,CAAC;SACD,CAAC,CAAC;QAEH,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;QAC5C,MAAM,OAAO,GAAG,MAAM,wBAAwB,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,EAAE,SAAS,EAAE,GAAG,EAAE,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACxH,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAClC,MAAM,CAAC,WAAW,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAC7C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kEAAkE,EAAE,KAAK,IAAI,EAAE;QACnF,MAAM,wBAAwB,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAEhH,IAAI,mBAAmB,GAAG,KAAK,CAAC;QAChC,wBAAwB,CAAC,8BAA8B,CAAC,IAAI;YAC3D,KAAK,CAAC,CAAC,UAAU,CAAC,UAAe;gBAChC,MAAM;oBACL,EAAE,EAAE,UAAU;oBACd,KAAK,EAAE,OAAO;oBACd,OAAO,EAAE,KAAK,IAAI,EAAE,CAAC,yBAAyB,CAAC,OAAO;oBACtD,eAAe,EAAE,KAAK,IAAI,EAAE;wBAC3B,OAAO,IAAI,CAAC;oBACb,CAAC;iBACD,CAAC;gBACF,MAAM;oBACL,EAAE,EAAE,cAAc;oBAClB,KAAK,EAAE,WAAW;oBAClB,OAAO,EAAE,KAAK,IAAI,EAAE,CAAC,yBAAyB,CAAC,SAAS;oBACxD,eAAe,EAAE,KAAK,IAAI,EAAE;wBAC3B,mBAAmB,GAAG,IAAI,CAAC;wBAC3B,OAAO,IAAI,CAAC;oBACb,CAAC;iBACD,CAAC;YACH,CAAC;SACD,CAAC,CAAC;QAEH,MAAM,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;QAC5C,MAAM,OAAO,GAAG,MAAM,wBAAwB,CAAC,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,EAAE,SAAS,EAAE,GAAG,EAAE,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QACxH,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAClC,MAAM,CAAC,WAAW,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"externalUriOpenerService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ExternalUriOpenerPriority } from '../../../../../editor/common/languages.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { IPickOptions, IQuickInputService, IQuickPickItem, QuickPickInput } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ExternalUriOpenerService, IExternalOpenerProvider, IExternalUriOpener } from '../../common/externalUriOpenerService.js';\n\n\nclass MockQuickInputService implements Partial<IQuickInputService> {\n\n\tconstructor(\n\t\tprivate readonly pickIndex: number\n\t) { }\n\n\tpublic pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: IPickOptions<T> & { canPickMany: true }, token?: CancellationToken): Promise<T[]>;\n\tpublic pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: IPickOptions<T> & { canPickMany: false }, token?: CancellationToken): Promise<T>;\n\tpublic async pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: Omit<IPickOptions<T>, 'canPickMany'>, token?: CancellationToken): Promise<T | undefined> {\n\t\tconst resolvedPicks = await picks;\n\t\tconst item = resolvedPicks[this.pickIndex];\n\t\tif (item.type === 'separator') {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn item;\n\t}\n\n}\n\nsuite('ExternalUriOpenerService', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(IOpenerService, {\n\t\t\tregisterExternalOpener: () => { return Disposable.None; }\n\t\t});\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Should not open if there are no openers', async () => {\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\t// noop\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, false);\n\t});\n\n\ttest('Should prompt if there is at least one enabled opener', async () => {\n\t\tinstantiationService.stub(IQuickInputService, new MockQuickInputService(0));\n\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\tlet openedWithEnabled = false;\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\tyield {\n\t\t\t\t\tid: 'disabled-id',\n\t\t\t\t\tlabel: 'disabled',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.None,\n\t\t\t\t\topenExternalUri: async () => true,\n\t\t\t\t};\n\t\t\t\tyield {\n\t\t\t\t\tid: 'enabled-id',\n\t\t\t\t\tlabel: 'enabled',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Default,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\topenedWithEnabled = true;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, true);\n\t\tassert.strictEqual(openedWithEnabled, true);\n\t});\n\n\ttest('Should automatically pick single preferred opener without prompt', async () => {\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\tlet openedWithPreferred = false;\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\tyield {\n\t\t\t\t\tid: 'other-id',\n\t\t\t\t\tlabel: 'other',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Default,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tyield {\n\t\t\t\t\tid: 'preferred-id',\n\t\t\t\t\tlabel: 'preferred',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Preferred,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\topenedWithPreferred = true;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, true);\n\t\tassert.strictEqual(openedWithPreferred, true);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ExternalUriOpenerPriority } from '../../../../../editor/common/languages.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { IPickOptions, IQuickInputService, IQuickPickItem, QuickPickInput } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ExternalUriOpenerService, IExternalOpenerProvider, IExternalUriOpener } from '../../common/externalUriOpenerService.js';\n\n\nclass MockQuickInputService implements Partial<IQuickInputService> {\n\n\tconstructor(\n\t\tprivate readonly pickIndex: number\n\t) { }\n\n\tpublic pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: IPickOptions<T> & { canPickMany: true }, token?: CancellationToken): Promise<T[]>;\n\tpublic pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: IPickOptions<T> & { canPickMany: false }, token?: CancellationToken): Promise<T>;\n\tpublic async pick<T extends IQuickPickItem>(picks: Promise<QuickPickInput<T>[]> | QuickPickInput<T>[], options?: Omit<IPickOptions<T>, 'canPickMany'>, token?: CancellationToken): Promise<T | undefined> {\n\t\tconst resolvedPicks = await picks;\n\t\tconst item = resolvedPicks[this.pickIndex];\n\t\tif (item.type === 'separator') {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn item;\n\t}\n\n}\n\nsuite('ExternalUriOpenerService', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(IOpenerService, {\n\t\t\tregisterExternalOpener: () => { return Disposable.None; }\n\t\t});\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('Should not open if there are no openers', async () => {\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\t// noop\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, false);\n\t});\n\n\ttest('Should prompt if there is at least one enabled opener', async () => {\n\t\tinstantiationService.stub(IQuickInputService, new MockQuickInputService(0));\n\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\tlet openedWithEnabled = false;\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\tyield {\n\t\t\t\t\tid: 'disabled-id',\n\t\t\t\t\tlabel: 'disabled',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.None,\n\t\t\t\t\topenExternalUri: async () => true,\n\t\t\t\t};\n\t\t\t\tyield {\n\t\t\t\t\tid: 'enabled-id',\n\t\t\t\t\tlabel: 'enabled',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Default,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\topenedWithEnabled = true;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, true);\n\t\tassert.strictEqual(openedWithEnabled, true);\n\t});\n\n\ttest('Should automatically pick single preferred opener without prompt', async () => {\n\t\tconst externalUriOpenerService = disposables.add(instantiationService.createInstance(ExternalUriOpenerService));\n\n\t\tlet openedWithPreferred = false;\n\t\texternalUriOpenerService.registerExternalOpenerProvider(new class implements IExternalOpenerProvider {\n\t\t\tasync *getOpeners(_targetUri: URI): AsyncGenerator<IExternalUriOpener> {\n\t\t\t\tyield {\n\t\t\t\t\tid: 'other-id',\n\t\t\t\t\tlabel: 'other',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Default,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tyield {\n\t\t\t\t\tid: 'preferred-id',\n\t\t\t\t\tlabel: 'preferred',\n\t\t\t\t\tcanOpen: async () => ExternalUriOpenerPriority.Preferred,\n\t\t\t\t\topenExternalUri: async () => {\n\t\t\t\t\t\topenedWithPreferred = true;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('http://contoso.com');\n\t\tconst didOpen = await externalUriOpenerService.openExternal(uri.toString(), { sourceUri: uri }, CancellationToken.None);\n\t\tassert.strictEqual(didOpen, true);\n\t\tassert.strictEqual(openedWithPreferred, true);\n\t});\n});\n"]}