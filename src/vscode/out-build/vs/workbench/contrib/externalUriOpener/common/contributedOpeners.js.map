{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/externalUriOpener/common/contributedOpeners.ts","vs/workbench/contrib/externalUriOpener/common/contributedOpeners.ts"],"names":[],"mappings":"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","file":"contributedOpeners.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { Memento } from '../../../common/memento.js';\nimport { updateContributedOpeners } from './configuration.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\n\ninterface RegisteredExternalOpener {\n\treadonly extensionId: string;\n\n\tisCurrentlyRegistered: boolean;\n}\n\ninterface OpenersMemento {\n\t[id: string]: RegisteredExternalOpener | undefined;\n}\n\nexport class ContributedExternalUriOpenersStore extends Disposable {\n\n\tprivate static readonly STORAGE_ID = 'externalUriOpeners';\n\n\tprivate readonly _openers = new Map<string, RegisteredExternalOpener>();\n\tprivate readonly _memento: Memento<OpenersMemento>;\n\tprivate _mementoObject: OpenersMemento;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService\n\t) {\n\t\tsuper();\n\n\t\tthis._memento = new Memento(ContributedExternalUriOpenersStore.STORAGE_ID, storageService);\n\t\tthis._mementoObject = this._memento.getMemento(StorageScope.PROFILE, StorageTarget.MACHINE);\n\t\tfor (const [id, value] of Object.entries(this._mementoObject || {})) {\n\t\t\tif (value) {\n\t\t\t\tthis.add(id, value.extensionId, { isCurrentlyRegistered: false });\n\t\t\t}\n\t\t}\n\n\t\tthis.invalidateOpenersOnExtensionsChanged();\n\n\t\tthis._register(this._extensionService.onDidChangeExtensions(() => this.invalidateOpenersOnExtensionsChanged()));\n\t\tthis._register(this._extensionService.onDidChangeExtensionsStatus(() => this.invalidateOpenersOnExtensionsChanged()));\n\t}\n\n\tpublic didRegisterOpener(id: string, extensionId: string): void {\n\t\tthis.add(id, extensionId, {\n\t\t\tisCurrentlyRegistered: true\n\t\t});\n\t}\n\n\tprivate add(id: string, extensionId: string, options: { isCurrentlyRegistered: boolean }): void {\n\t\tconst existing = this._openers.get(id);\n\t\tif (existing) {\n\t\t\texisting.isCurrentlyRegistered = existing.isCurrentlyRegistered || options.isCurrentlyRegistered;\n\t\t\treturn;\n\t\t}\n\n\t\tconst entry = {\n\t\t\textensionId,\n\t\t\tisCurrentlyRegistered: options.isCurrentlyRegistered\n\t\t};\n\t\tthis._openers.set(id, entry);\n\n\t\tthis._mementoObject[id] = entry;\n\t\tthis._memento.saveMemento();\n\n\t\tthis.updateSchema();\n\t}\n\n\tpublic delete(id: string): void {\n\t\tthis._openers.delete(id);\n\n\t\tdelete this._mementoObject[id];\n\t\tthis._memento.saveMemento();\n\n\t\tthis.updateSchema();\n\t}\n\n\tprivate async invalidateOpenersOnExtensionsChanged() {\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tconst registeredExtensions = this._extensionService.extensions;\n\n\t\tfor (const [id, entry] of this._openers) {\n\t\t\tconst extension = registeredExtensions.find(r => r.identifier.value === entry.extensionId);\n\t\t\tif (extension) {\n\t\t\t\tif (!this._extensionService.canRemoveExtension(extension)) {\n\t\t\t\t\t// The extension is running. We should have registered openers at this point\n\t\t\t\t\tif (!entry.isCurrentlyRegistered) {\n\t\t\t\t\t\tthis.delete(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// The opener came from an extension that is no longer enabled/installed\n\t\t\t\tthis.delete(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateSchema() {\n\t\tconst ids: string[] = [];\n\t\tconst descriptions: string[] = [];\n\n\t\tfor (const [id, entry] of this._openers) {\n\t\t\tids.push(id);\n\t\t\tdescriptions.push(entry.extensionId);\n\t\t}\n\n\t\tupdateContributedOpeners(ids, descriptions);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { Memento } from '../../../common/memento.js';\nimport { updateContributedOpeners } from './configuration.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\n\ninterface RegisteredExternalOpener {\n\treadonly extensionId: string;\n\n\tisCurrentlyRegistered: boolean;\n}\n\ninterface OpenersMemento {\n\t[id: string]: RegisteredExternalOpener | undefined;\n}\n\nexport class ContributedExternalUriOpenersStore extends Disposable {\n\n\tprivate static readonly STORAGE_ID = 'externalUriOpeners';\n\n\tprivate readonly _openers = new Map<string, RegisteredExternalOpener>();\n\tprivate readonly _memento: Memento<OpenersMemento>;\n\tprivate _mementoObject: OpenersMemento;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService\n\t) {\n\t\tsuper();\n\n\t\tthis._memento = new Memento(ContributedExternalUriOpenersStore.STORAGE_ID, storageService);\n\t\tthis._mementoObject = this._memento.getMemento(StorageScope.PROFILE, StorageTarget.MACHINE);\n\t\tfor (const [id, value] of Object.entries(this._mementoObject || {})) {\n\t\t\tif (value) {\n\t\t\t\tthis.add(id, value.extensionId, { isCurrentlyRegistered: false });\n\t\t\t}\n\t\t}\n\n\t\tthis.invalidateOpenersOnExtensionsChanged();\n\n\t\tthis._register(this._extensionService.onDidChangeExtensions(() => this.invalidateOpenersOnExtensionsChanged()));\n\t\tthis._register(this._extensionService.onDidChangeExtensionsStatus(() => this.invalidateOpenersOnExtensionsChanged()));\n\t}\n\n\tpublic didRegisterOpener(id: string, extensionId: string): void {\n\t\tthis.add(id, extensionId, {\n\t\t\tisCurrentlyRegistered: true\n\t\t});\n\t}\n\n\tprivate add(id: string, extensionId: string, options: { isCurrentlyRegistered: boolean }): void {\n\t\tconst existing = this._openers.get(id);\n\t\tif (existing) {\n\t\t\texisting.isCurrentlyRegistered = existing.isCurrentlyRegistered || options.isCurrentlyRegistered;\n\t\t\treturn;\n\t\t}\n\n\t\tconst entry = {\n\t\t\textensionId,\n\t\t\tisCurrentlyRegistered: options.isCurrentlyRegistered\n\t\t};\n\t\tthis._openers.set(id, entry);\n\n\t\tthis._mementoObject[id] = entry;\n\t\tthis._memento.saveMemento();\n\n\t\tthis.updateSchema();\n\t}\n\n\tpublic delete(id: string): void {\n\t\tthis._openers.delete(id);\n\n\t\tdelete this._mementoObject[id];\n\t\tthis._memento.saveMemento();\n\n\t\tthis.updateSchema();\n\t}\n\n\tprivate async invalidateOpenersOnExtensionsChanged() {\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tconst registeredExtensions = this._extensionService.extensions;\n\n\t\tfor (const [id, entry] of this._openers) {\n\t\t\tconst extension = registeredExtensions.find(r => r.identifier.value === entry.extensionId);\n\t\t\tif (extension) {\n\t\t\t\tif (!this._extensionService.canRemoveExtension(extension)) {\n\t\t\t\t\t// The extension is running. We should have registered openers at this point\n\t\t\t\t\tif (!entry.isCurrentlyRegistered) {\n\t\t\t\t\t\tthis.delete(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// The opener came from an extension that is no longer enabled/installed\n\t\t\t\tthis.delete(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateSchema() {\n\t\tconst ids: string[] = [];\n\t\tconst descriptions: string[] = [];\n\n\t\tfor (const [id, entry] of this._openers) {\n\t\t\tids.push(id);\n\t\t\tdescriptions.push(entry.extensionId);\n\t\t}\n\n\t\tupdateContributedOpeners(ids, descriptions);\n\t}\n}\n"]}