{"version":3,"sources":["vs/workbench/contrib/welcomeViews/common/viewsWelcomeContribution.ts"],"names":[],"mappings":"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","file":"viewsWelcomeContribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport { Disposable, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IExtensionPoint, IExtensionPointUser } from '../../../services/extensions/common/extensionsRegistry.js';\nimport { ViewsWelcomeExtensionPoint, ViewWelcome, ViewIdentifierMap } from './viewsWelcomeExtensionPoint.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions as ViewContainerExtensions, IViewContentDescriptor, IViewsRegistry } from '../../../common/views.js';\nimport { isProposedApiEnabled } from '../../../services/extensions/common/extensions.js';\n\nconst viewsRegistry = Registry.as<IViewsRegistry>(ViewContainerExtensions.ViewsRegistry);\n\nexport class ViewsWelcomeContribution extends Disposable implements IWorkbenchContribution {\n\n\tprivate viewWelcomeContents = new Map<ViewWelcome, IDisposable>();\n\n\tconstructor(extensionPoint: IExtensionPoint<ViewsWelcomeExtensionPoint>) {\n\t\tsuper();\n\n\t\textensionPoint.setHandler((_, { added, removed }) => {\n\t\t\tfor (const contribution of removed) {\n\t\t\t\tfor (const welcome of contribution.value) {\n\t\t\t\t\tconst disposable = this.viewWelcomeContents.get(welcome);\n\n\t\t\t\t\tdisposable?.dispose();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst welcomesByViewId = new Map<string, Map<ViewWelcome, IViewContentDescriptor>>();\n\n\t\t\tfor (const contribution of added) {\n\t\t\t\tfor (const welcome of contribution.value) {\n\t\t\t\t\tconst { group, order } = parseGroupAndOrder(welcome, contribution);\n\t\t\t\t\tconst precondition = ContextKeyExpr.deserialize(welcome.enablement);\n\n\t\t\t\t\tconst id = ViewIdentifierMap[welcome.view] ?? welcome.view;\n\t\t\t\t\tlet viewContentMap = welcomesByViewId.get(id);\n\t\t\t\t\tif (!viewContentMap) {\n\t\t\t\t\t\tviewContentMap = new Map();\n\t\t\t\t\t\twelcomesByViewId.set(id, viewContentMap);\n\t\t\t\t\t}\n\n\t\t\t\t\tviewContentMap.set(welcome, {\n\t\t\t\t\t\tcontent: welcome.contents,\n\t\t\t\t\t\twhen: ContextKeyExpr.deserialize(welcome.when),\n\t\t\t\t\t\tprecondition,\n\t\t\t\t\t\tgroup,\n\t\t\t\t\t\torder\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const [id, viewContentMap] of welcomesByViewId) {\n\t\t\t\tconst disposables = viewsRegistry.registerViewWelcomeContent2(id, viewContentMap);\n\n\t\t\t\tfor (const [welcome, disposable] of disposables) {\n\t\t\t\t\tthis.viewWelcomeContents.set(welcome, disposable);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction parseGroupAndOrder(welcome: ViewWelcome, contribution: IExtensionPointUser<ViewsWelcomeExtensionPoint>): { group: string | undefined; order: number | undefined } {\n\n\tlet group: string | undefined;\n\tlet order: number | undefined;\n\tif (welcome.group) {\n\t\tif (!isProposedApiEnabled(contribution.description, 'contribViewsWelcome')) {\n\t\t\tcontribution.collector.warn(nls.localize('ViewsWelcomeExtensionPoint.proposedAPI', \"The viewsWelcome contribution in '{0}' requires 'enabledApiProposals: [\\\"contribViewsWelcome\\\"]' in order to use the 'group' proposed property.\", contribution.description.identifier.value));\n\t\t\treturn { group, order };\n\t\t}\n\n\t\tconst idx = welcome.group.lastIndexOf('@');\n\t\tif (idx > 0) {\n\t\t\tgroup = welcome.group.substr(0, idx);\n\t\t\torder = Number(welcome.group.substr(idx + 1)) || undefined;\n\t\t} else {\n\t\t\tgroup = welcome.group;\n\t\t}\n\t}\n\treturn { group, order };\n}\n"]}