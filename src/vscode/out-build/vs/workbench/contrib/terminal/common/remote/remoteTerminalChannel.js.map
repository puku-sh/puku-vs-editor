{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/common/remote/remoteTerminalChannel.ts","vs/workbench/contrib/terminal/common/remote/remoteTerminalChannel.ts"],"names":[],"mappings":"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","file":"remoteTerminalChannel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../../../base/common/event.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { IChannel } from '../../../../../base/parts/ipc/common/ipc.js';\nimport { IWorkbenchConfigurationService } from '../../../../services/configuration/common/configuration.js';\nimport { IRemoteAuthorityResolverService } from '../../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { serializeEnvironmentDescriptionMap, serializeEnvironmentVariableCollection } from '../../../../../platform/terminal/common/environmentVariableShared.js';\nimport { IConfigurationResolverService } from '../../../../services/configurationResolver/common/configurationResolver.js';\nimport { SideBySideEditor, EditorResourceAccessor } from '../../../../common/editor.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IEnvironmentVariableService } from '../environmentVariable.js';\nimport { IProcessDataEvent, IRequestResolveVariablesEvent, IShellLaunchConfigDto, ITerminalLaunchError, ITerminalProfile, ITerminalsLayoutInfo, ITerminalsLayoutInfoById, TerminalIcon, IProcessProperty, ProcessPropertyType, IProcessPropertyMap, TitleEventSource, ISerializedTerminalState, IPtyHostController, ITerminalProcessOptions, IProcessReadyEvent, ITerminalLogService, IPtyHostLatencyMeasurement, ITerminalLaunchResult } from '../../../../../platform/terminal/common/terminal.js';\nimport { IGetTerminalLayoutInfoArgs, IProcessDetails, ISetTerminalLayoutInfoArgs } from '../../../../../platform/terminal/common/terminalProcess.js';\nimport { IProcessEnvironment, OperatingSystem } from '../../../../../base/common/platform.js';\nimport { ICompleteTerminalConfiguration } from '../terminal.js';\nimport { IPtyHostProcessReplayEvent } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { ISerializableEnvironmentDescriptionMap as ISerializableEnvironmentDescriptionMap, ISerializableEnvironmentVariableCollection } from '../../../../../platform/terminal/common/environmentVariable.js';\nimport type * as performance from '../../../../../base/common/performance.js';\nimport { RemoteTerminalChannelEvent, RemoteTerminalChannelRequest } from './terminal.js';\nimport { ConfigurationResolverExpression } from '../../../../services/configurationResolver/common/configurationResolverExpression.js';\n\nexport const REMOTE_TERMINAL_CHANNEL_NAME = 'remoteterminal';\n\nexport type ITerminalEnvironmentVariableCollections = [string, ISerializableEnvironmentVariableCollection, ISerializableEnvironmentDescriptionMap][];\n\nexport interface IWorkspaceFolderData {\n\turi: UriComponents;\n\tname: string;\n\tindex: number;\n}\n\nexport interface ICreateTerminalProcessArguments {\n\tconfiguration: ICompleteTerminalConfiguration;\n\tresolvedVariables: { [name: string]: string };\n\tenvVariableCollections: ITerminalEnvironmentVariableCollections;\n\tshellLaunchConfig: IShellLaunchConfigDto;\n\tworkspaceId: string;\n\tworkspaceName: string;\n\tworkspaceFolders: IWorkspaceFolderData[];\n\tactiveWorkspaceFolder: IWorkspaceFolderData | null;\n\tactiveFileResource: UriComponents | undefined;\n\tshouldPersistTerminal: boolean;\n\toptions: ITerminalProcessOptions;\n\tcols: number;\n\trows: number;\n\tunicodeVersion: '6' | '11';\n\tresolverEnv: { [key: string]: string | null } | undefined;\n}\n\nexport interface ICreateTerminalProcessResult {\n\tpersistentTerminalId: number;\n\tresolvedShellLaunchConfig: IShellLaunchConfigDto;\n}\n\nexport class RemoteTerminalChannelClient implements IPtyHostController {\n\tget onPtyHostExit(): Event<number> {\n\t\treturn this._channel.listen<number>(RemoteTerminalChannelEvent.OnPtyHostExitEvent);\n\t}\n\tget onPtyHostStart(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostStartEvent);\n\t}\n\tget onPtyHostUnresponsive(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostUnresponsiveEvent);\n\t}\n\tget onPtyHostResponsive(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostResponsiveEvent);\n\t}\n\tget onPtyHostRequestResolveVariables(): Event<IRequestResolveVariablesEvent> {\n\t\treturn this._channel.listen<IRequestResolveVariablesEvent>(RemoteTerminalChannelEvent.OnPtyHostRequestResolveVariablesEvent);\n\t}\n\tget onProcessData(): Event<{ id: number; event: IProcessDataEvent | string }> {\n\t\treturn this._channel.listen<{ id: number; event: IProcessDataEvent | string }>(RemoteTerminalChannelEvent.OnProcessDataEvent);\n\t}\n\tget onProcessExit(): Event<{ id: number; event: number | undefined }> {\n\t\treturn this._channel.listen<{ id: number; event: number | undefined }>(RemoteTerminalChannelEvent.OnProcessExitEvent);\n\t}\n\tget onProcessReady(): Event<{ id: number; event: IProcessReadyEvent }> {\n\t\treturn this._channel.listen<{ id: number; event: IProcessReadyEvent }>(RemoteTerminalChannelEvent.OnProcessReadyEvent);\n\t}\n\tget onProcessReplay(): Event<{ id: number; event: IPtyHostProcessReplayEvent }> {\n\t\treturn this._channel.listen<{ id: number; event: IPtyHostProcessReplayEvent }>(RemoteTerminalChannelEvent.OnProcessReplayEvent);\n\t}\n\tget onProcessOrphanQuestion(): Event<{ id: number }> {\n\t\treturn this._channel.listen<{ id: number }>(RemoteTerminalChannelEvent.OnProcessOrphanQuestion);\n\t}\n\tget onExecuteCommand(): Event<{ reqId: number; persistentProcessId: number; commandId: string; commandArgs: unknown[] }> {\n\t\treturn this._channel.listen<{ reqId: number; persistentProcessId: number; commandId: string; commandArgs: unknown[] }>(RemoteTerminalChannelEvent.OnExecuteCommand);\n\t}\n\tget onDidRequestDetach(): Event<{ requestId: number; workspaceId: string; instanceId: number }> {\n\t\treturn this._channel.listen<{ requestId: number; workspaceId: string; instanceId: number }>(RemoteTerminalChannelEvent.OnDidRequestDetach);\n\t}\n\tget onDidChangeProperty(): Event<{ id: number; property: IProcessProperty }> {\n\t\treturn this._channel.listen<{ id: number; property: IProcessProperty }>(RemoteTerminalChannelEvent.OnDidChangeProperty);\n\t}\n\n\tconstructor(\n\t\tprivate readonly _remoteAuthority: string,\n\t\tprivate readonly _channel: IChannel,\n\t\t@IWorkbenchConfigurationService private readonly _configurationService: IWorkbenchConfigurationService,\n\t\t@IWorkspaceContextService private readonly _workspaceContextService: IWorkspaceContextService,\n\t\t@IConfigurationResolverService private readonly _resolverService: IConfigurationResolverService,\n\t\t@IEnvironmentVariableService private readonly _environmentVariableService: IEnvironmentVariableService,\n\t\t@IRemoteAuthorityResolverService private readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@ITerminalLogService private readonly _logService: ITerminalLogService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t) { }\n\n\trestartPtyHost(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RestartPtyHost, []);\n\t}\n\n\tasync createProcess(\n\t\tshellLaunchConfig: IShellLaunchConfigDto,\n\t\tconfiguration: ICompleteTerminalConfiguration,\n\t\tactiveWorkspaceRootUri: URI | undefined,\n\t\toptions: ITerminalProcessOptions,\n\t\tshouldPersistTerminal: boolean,\n\t\tcols: number,\n\t\trows: number,\n\t\tunicodeVersion: '6' | '11'\n\t): Promise<ICreateTerminalProcessResult> {\n\t\t// Be sure to first wait for the remote configuration\n\t\tawait this._configurationService.whenRemoteConfigurationLoaded();\n\n\t\t// We will use the resolver service to resolve all the variables in the config / launch config\n\t\t// But then we will keep only some variables, since the rest need to be resolved on the remote side\n\t\tconst resolvedVariables = Object.create(null);\n\t\tconst lastActiveWorkspace = activeWorkspaceRootUri ? this._workspaceContextService.getWorkspaceFolder(activeWorkspaceRootUri) ?? undefined : undefined;\n\t\tconst expr = ConfigurationResolverExpression.parse({ shellLaunchConfig, configuration });\n\t\ttry {\n\t\t\tawait this._resolverService.resolveAsync(lastActiveWorkspace, expr);\n\t\t} catch (err) {\n\t\t\tthis._logService.error(err);\n\t\t}\n\t\tfor (const [{ inner }, resolved] of expr.resolved()) {\n\t\t\tif (/^config:/.test(inner) || inner === 'selectedText' || inner === 'lineNumber') {\n\t\t\t\tresolvedVariables[inner] = resolved.value;\n\t\t\t}\n\t\t}\n\n\t\tconst envVariableCollections: ITerminalEnvironmentVariableCollections = [];\n\t\tfor (const [k, v] of this._environmentVariableService.collections.entries()) {\n\t\t\tenvVariableCollections.push([k, serializeEnvironmentVariableCollection(v.map), serializeEnvironmentDescriptionMap(v.descriptionMap)]);\n\t\t}\n\n\t\tconst resolverResult = await this._remoteAuthorityResolverService.resolveAuthority(this._remoteAuthority);\n\t\tconst resolverEnv = resolverResult.options && resolverResult.options.extensionHostEnv;\n\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst workspaceFolders = workspace.folders;\n\t\tconst activeWorkspaceFolder = activeWorkspaceRootUri ? this._workspaceContextService.getWorkspaceFolder(activeWorkspaceRootUri) : null;\n\n\t\tconst activeFileResource = EditorResourceAccessor.getOriginalUri(this._editorService.activeEditor, {\n\t\t\tsupportSideBySide: SideBySideEditor.PRIMARY,\n\t\t\tfilterByScheme: [Schemas.file, Schemas.vscodeUserData, Schemas.vscodeRemote]\n\t\t});\n\n\t\tconst args: ICreateTerminalProcessArguments = {\n\t\t\tconfiguration,\n\t\t\tresolvedVariables,\n\t\t\tenvVariableCollections,\n\t\t\tshellLaunchConfig,\n\t\t\tworkspaceId: workspace.id,\n\t\t\tworkspaceName: this._labelService.getWorkspaceLabel(workspace),\n\t\t\tworkspaceFolders,\n\t\t\tactiveWorkspaceFolder,\n\t\t\tactiveFileResource,\n\t\t\tshouldPersistTerminal,\n\t\t\toptions,\n\t\t\tcols,\n\t\t\trows,\n\t\t\tunicodeVersion,\n\t\t\tresolverEnv\n\t\t};\n\t\treturn await this._channel.call<ICreateTerminalProcessResult>(RemoteTerminalChannelRequest.CreateProcess, args);\n\t}\n\n\trequestDetachInstance(workspaceId: string, instanceId: number): Promise<IProcessDetails | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RequestDetachInstance, [workspaceId, instanceId]);\n\t}\n\tacceptDetachInstanceReply(requestId: number, persistentProcessId: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcceptDetachInstanceReply, [requestId, persistentProcessId]);\n\t}\n\tattachToProcess(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AttachToProcess, [id]);\n\t}\n\tdetachFromProcess(id: number, forcePersist?: boolean): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.DetachFromProcess, [id, forcePersist]);\n\t}\n\tlistProcesses(): Promise<IProcessDetails[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ListProcesses);\n\t}\n\tgetLatency(): Promise<IPtyHostLatencyMeasurement[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetLatency);\n\t}\n\tgetPerformanceMarks(): Promise<performance.PerformanceMark[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetPerformanceMarks);\n\t}\n\treduceConnectionGraceTime(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ReduceConnectionGraceTime);\n\t}\n\tprocessBinary(id: number, data: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ProcessBinary, [id, data]);\n\t}\n\tstart(id: number): Promise<ITerminalLaunchError | ITerminalLaunchResult | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Start, [id]);\n\t}\n\tinput(id: number, data: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Input, [id, data]);\n\t}\n\tsendSignal(id: number, signal: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SendSignal, [id, signal]);\n\t}\n\tacknowledgeDataEvent(id: number, charCount: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcknowledgeDataEvent, [id, charCount]);\n\t}\n\tsetUnicodeVersion(id: number, version: '6' | '11'): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SetUnicodeVersion, [id, version]);\n\t}\n\tsetNextCommandId(id: number, commandLine: string, commandId: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SetNextCommandId, [id, commandLine, commandId]);\n\t}\n\tshutdown(id: number, immediate: boolean): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Shutdown, [id, immediate]);\n\t}\n\tresize(id: number, cols: number, rows: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Resize, [id, cols, rows]);\n\t}\n\tclearBuffer(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ClearBuffer, [id]);\n\t}\n\tgetInitialCwd(id: number): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetInitialCwd, [id]);\n\t}\n\tgetCwd(id: number): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetCwd, [id]);\n\t}\n\torphanQuestionReply(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.OrphanQuestionReply, [id]);\n\t}\n\tsendCommandResult(reqId: number, isError: boolean, payload: unknown): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SendCommandResult, [reqId, isError, payload]);\n\t}\n\tfreePortKillProcess(port: string): Promise<{ port: string; processId: string }> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.FreePortKillProcess, [port]);\n\t}\n\tgetDefaultSystemShell(osOverride?: OperatingSystem): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetDefaultSystemShell, [osOverride]);\n\t}\n\tgetProfiles(profiles: unknown, defaultProfile: unknown, includeDetectedProfiles?: boolean): Promise<ITerminalProfile[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetProfiles, [this._workspaceContextService.getWorkspace().id, profiles, defaultProfile, includeDetectedProfiles]);\n\t}\n\tacceptPtyHostResolvedVariables(requestId: number, resolved: string[]): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcceptPtyHostResolvedVariables, [requestId, resolved]);\n\t}\n\n\tgetEnvironment(): Promise<IProcessEnvironment> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetEnvironment);\n\t}\n\n\tgetWslPath(original: string, direction: 'unix-to-win' | 'win-to-unix'): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetWslPath, [original, direction]);\n\t}\n\n\tsetTerminalLayoutInfo(layout?: ITerminalsLayoutInfoById): Promise<void> {\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst args: ISetTerminalLayoutInfoArgs = {\n\t\t\tworkspaceId: workspace.id,\n\t\t\ttabs: layout ? layout.tabs : [],\n\t\t\tbackground: layout ? layout.background : null\n\t\t};\n\t\treturn this._channel.call<void>(RemoteTerminalChannelRequest.SetTerminalLayoutInfo, args);\n\t}\n\n\tupdateTitle(id: number, title: string, titleSource: TitleEventSource): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateTitle, [id, title, titleSource]);\n\t}\n\n\tupdateIcon(id: number, userInitiated: boolean, icon: TerminalIcon, color?: string): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateIcon, [id, userInitiated, icon, color]);\n\t}\n\n\trefreshProperty<T extends ProcessPropertyType>(id: number, property: T): Promise<IProcessPropertyMap[T]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RefreshProperty, [id, property]);\n\t}\n\n\tupdateProperty<T extends ProcessPropertyType>(id: number, property: T, value: IProcessPropertyMap[T]): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateProperty, [id, property, value]);\n\t}\n\n\tgetTerminalLayoutInfo(): Promise<ITerminalsLayoutInfo | undefined> {\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst args: IGetTerminalLayoutInfoArgs = {\n\t\t\tworkspaceId: workspace.id,\n\t\t};\n\t\treturn this._channel.call<ITerminalsLayoutInfo>(RemoteTerminalChannelRequest.GetTerminalLayoutInfo, args);\n\t}\n\n\treviveTerminalProcesses(workspaceId: string, state: ISerializedTerminalState[], dateTimeFormatLocate: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ReviveTerminalProcesses, [workspaceId, state, dateTimeFormatLocate]);\n\t}\n\n\tgetRevivedPtyNewId(id: number): Promise<number | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetRevivedPtyNewId, [id]);\n\t}\n\n\tserializeTerminalState(ids: number[]): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SerializeTerminalState, [ids]);\n\t}\n\n\t// #region Pty service contribution RPC calls\n\n\tinstallAutoReply(match: string, reply: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.InstallAutoReply, [match, reply]);\n\t}\n\tuninstallAllAutoReplies(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UninstallAllAutoReplies, []);\n\t}\n\n\t// #endregion\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../../../base/common/event.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { IChannel } from '../../../../../base/parts/ipc/common/ipc.js';\nimport { IWorkbenchConfigurationService } from '../../../../services/configuration/common/configuration.js';\nimport { IRemoteAuthorityResolverService } from '../../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { serializeEnvironmentDescriptionMap, serializeEnvironmentVariableCollection } from '../../../../../platform/terminal/common/environmentVariableShared.js';\nimport { IConfigurationResolverService } from '../../../../services/configurationResolver/common/configurationResolver.js';\nimport { SideBySideEditor, EditorResourceAccessor } from '../../../../common/editor.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IEnvironmentVariableService } from '../environmentVariable.js';\nimport { IProcessDataEvent, IRequestResolveVariablesEvent, IShellLaunchConfigDto, ITerminalLaunchError, ITerminalProfile, ITerminalsLayoutInfo, ITerminalsLayoutInfoById, TerminalIcon, IProcessProperty, ProcessPropertyType, IProcessPropertyMap, TitleEventSource, ISerializedTerminalState, IPtyHostController, ITerminalProcessOptions, IProcessReadyEvent, ITerminalLogService, IPtyHostLatencyMeasurement, ITerminalLaunchResult } from '../../../../../platform/terminal/common/terminal.js';\nimport { IGetTerminalLayoutInfoArgs, IProcessDetails, ISetTerminalLayoutInfoArgs } from '../../../../../platform/terminal/common/terminalProcess.js';\nimport { IProcessEnvironment, OperatingSystem } from '../../../../../base/common/platform.js';\nimport { ICompleteTerminalConfiguration } from '../terminal.js';\nimport { IPtyHostProcessReplayEvent } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { ISerializableEnvironmentDescriptionMap as ISerializableEnvironmentDescriptionMap, ISerializableEnvironmentVariableCollection } from '../../../../../platform/terminal/common/environmentVariable.js';\nimport type * as performance from '../../../../../base/common/performance.js';\nimport { RemoteTerminalChannelEvent, RemoteTerminalChannelRequest } from './terminal.js';\nimport { ConfigurationResolverExpression } from '../../../../services/configurationResolver/common/configurationResolverExpression.js';\n\nexport const REMOTE_TERMINAL_CHANNEL_NAME = 'remoteterminal';\n\nexport type ITerminalEnvironmentVariableCollections = [string, ISerializableEnvironmentVariableCollection, ISerializableEnvironmentDescriptionMap][];\n\nexport interface IWorkspaceFolderData {\n\turi: UriComponents;\n\tname: string;\n\tindex: number;\n}\n\nexport interface ICreateTerminalProcessArguments {\n\tconfiguration: ICompleteTerminalConfiguration;\n\tresolvedVariables: { [name: string]: string };\n\tenvVariableCollections: ITerminalEnvironmentVariableCollections;\n\tshellLaunchConfig: IShellLaunchConfigDto;\n\tworkspaceId: string;\n\tworkspaceName: string;\n\tworkspaceFolders: IWorkspaceFolderData[];\n\tactiveWorkspaceFolder: IWorkspaceFolderData | null;\n\tactiveFileResource: UriComponents | undefined;\n\tshouldPersistTerminal: boolean;\n\toptions: ITerminalProcessOptions;\n\tcols: number;\n\trows: number;\n\tunicodeVersion: '6' | '11';\n\tresolverEnv: { [key: string]: string | null } | undefined;\n}\n\nexport interface ICreateTerminalProcessResult {\n\tpersistentTerminalId: number;\n\tresolvedShellLaunchConfig: IShellLaunchConfigDto;\n}\n\nexport class RemoteTerminalChannelClient implements IPtyHostController {\n\tget onPtyHostExit(): Event<number> {\n\t\treturn this._channel.listen<number>(RemoteTerminalChannelEvent.OnPtyHostExitEvent);\n\t}\n\tget onPtyHostStart(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostStartEvent);\n\t}\n\tget onPtyHostUnresponsive(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostUnresponsiveEvent);\n\t}\n\tget onPtyHostResponsive(): Event<void> {\n\t\treturn this._channel.listen<void>(RemoteTerminalChannelEvent.OnPtyHostResponsiveEvent);\n\t}\n\tget onPtyHostRequestResolveVariables(): Event<IRequestResolveVariablesEvent> {\n\t\treturn this._channel.listen<IRequestResolveVariablesEvent>(RemoteTerminalChannelEvent.OnPtyHostRequestResolveVariablesEvent);\n\t}\n\tget onProcessData(): Event<{ id: number; event: IProcessDataEvent | string }> {\n\t\treturn this._channel.listen<{ id: number; event: IProcessDataEvent | string }>(RemoteTerminalChannelEvent.OnProcessDataEvent);\n\t}\n\tget onProcessExit(): Event<{ id: number; event: number | undefined }> {\n\t\treturn this._channel.listen<{ id: number; event: number | undefined }>(RemoteTerminalChannelEvent.OnProcessExitEvent);\n\t}\n\tget onProcessReady(): Event<{ id: number; event: IProcessReadyEvent }> {\n\t\treturn this._channel.listen<{ id: number; event: IProcessReadyEvent }>(RemoteTerminalChannelEvent.OnProcessReadyEvent);\n\t}\n\tget onProcessReplay(): Event<{ id: number; event: IPtyHostProcessReplayEvent }> {\n\t\treturn this._channel.listen<{ id: number; event: IPtyHostProcessReplayEvent }>(RemoteTerminalChannelEvent.OnProcessReplayEvent);\n\t}\n\tget onProcessOrphanQuestion(): Event<{ id: number }> {\n\t\treturn this._channel.listen<{ id: number }>(RemoteTerminalChannelEvent.OnProcessOrphanQuestion);\n\t}\n\tget onExecuteCommand(): Event<{ reqId: number; persistentProcessId: number; commandId: string; commandArgs: unknown[] }> {\n\t\treturn this._channel.listen<{ reqId: number; persistentProcessId: number; commandId: string; commandArgs: unknown[] }>(RemoteTerminalChannelEvent.OnExecuteCommand);\n\t}\n\tget onDidRequestDetach(): Event<{ requestId: number; workspaceId: string; instanceId: number }> {\n\t\treturn this._channel.listen<{ requestId: number; workspaceId: string; instanceId: number }>(RemoteTerminalChannelEvent.OnDidRequestDetach);\n\t}\n\tget onDidChangeProperty(): Event<{ id: number; property: IProcessProperty }> {\n\t\treturn this._channel.listen<{ id: number; property: IProcessProperty }>(RemoteTerminalChannelEvent.OnDidChangeProperty);\n\t}\n\n\tconstructor(\n\t\tprivate readonly _remoteAuthority: string,\n\t\tprivate readonly _channel: IChannel,\n\t\t@IWorkbenchConfigurationService private readonly _configurationService: IWorkbenchConfigurationService,\n\t\t@IWorkspaceContextService private readonly _workspaceContextService: IWorkspaceContextService,\n\t\t@IConfigurationResolverService private readonly _resolverService: IConfigurationResolverService,\n\t\t@IEnvironmentVariableService private readonly _environmentVariableService: IEnvironmentVariableService,\n\t\t@IRemoteAuthorityResolverService private readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@ITerminalLogService private readonly _logService: ITerminalLogService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t) { }\n\n\trestartPtyHost(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RestartPtyHost, []);\n\t}\n\n\tasync createProcess(\n\t\tshellLaunchConfig: IShellLaunchConfigDto,\n\t\tconfiguration: ICompleteTerminalConfiguration,\n\t\tactiveWorkspaceRootUri: URI | undefined,\n\t\toptions: ITerminalProcessOptions,\n\t\tshouldPersistTerminal: boolean,\n\t\tcols: number,\n\t\trows: number,\n\t\tunicodeVersion: '6' | '11'\n\t): Promise<ICreateTerminalProcessResult> {\n\t\t// Be sure to first wait for the remote configuration\n\t\tawait this._configurationService.whenRemoteConfigurationLoaded();\n\n\t\t// We will use the resolver service to resolve all the variables in the config / launch config\n\t\t// But then we will keep only some variables, since the rest need to be resolved on the remote side\n\t\tconst resolvedVariables = Object.create(null);\n\t\tconst lastActiveWorkspace = activeWorkspaceRootUri ? this._workspaceContextService.getWorkspaceFolder(activeWorkspaceRootUri) ?? undefined : undefined;\n\t\tconst expr = ConfigurationResolverExpression.parse({ shellLaunchConfig, configuration });\n\t\ttry {\n\t\t\tawait this._resolverService.resolveAsync(lastActiveWorkspace, expr);\n\t\t} catch (err) {\n\t\t\tthis._logService.error(err);\n\t\t}\n\t\tfor (const [{ inner }, resolved] of expr.resolved()) {\n\t\t\tif (/^config:/.test(inner) || inner === 'selectedText' || inner === 'lineNumber') {\n\t\t\t\tresolvedVariables[inner] = resolved.value;\n\t\t\t}\n\t\t}\n\n\t\tconst envVariableCollections: ITerminalEnvironmentVariableCollections = [];\n\t\tfor (const [k, v] of this._environmentVariableService.collections.entries()) {\n\t\t\tenvVariableCollections.push([k, serializeEnvironmentVariableCollection(v.map), serializeEnvironmentDescriptionMap(v.descriptionMap)]);\n\t\t}\n\n\t\tconst resolverResult = await this._remoteAuthorityResolverService.resolveAuthority(this._remoteAuthority);\n\t\tconst resolverEnv = resolverResult.options && resolverResult.options.extensionHostEnv;\n\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst workspaceFolders = workspace.folders;\n\t\tconst activeWorkspaceFolder = activeWorkspaceRootUri ? this._workspaceContextService.getWorkspaceFolder(activeWorkspaceRootUri) : null;\n\n\t\tconst activeFileResource = EditorResourceAccessor.getOriginalUri(this._editorService.activeEditor, {\n\t\t\tsupportSideBySide: SideBySideEditor.PRIMARY,\n\t\t\tfilterByScheme: [Schemas.file, Schemas.vscodeUserData, Schemas.vscodeRemote]\n\t\t});\n\n\t\tconst args: ICreateTerminalProcessArguments = {\n\t\t\tconfiguration,\n\t\t\tresolvedVariables,\n\t\t\tenvVariableCollections,\n\t\t\tshellLaunchConfig,\n\t\t\tworkspaceId: workspace.id,\n\t\t\tworkspaceName: this._labelService.getWorkspaceLabel(workspace),\n\t\t\tworkspaceFolders,\n\t\t\tactiveWorkspaceFolder,\n\t\t\tactiveFileResource,\n\t\t\tshouldPersistTerminal,\n\t\t\toptions,\n\t\t\tcols,\n\t\t\trows,\n\t\t\tunicodeVersion,\n\t\t\tresolverEnv\n\t\t};\n\t\treturn await this._channel.call<ICreateTerminalProcessResult>(RemoteTerminalChannelRequest.CreateProcess, args);\n\t}\n\n\trequestDetachInstance(workspaceId: string, instanceId: number): Promise<IProcessDetails | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RequestDetachInstance, [workspaceId, instanceId]);\n\t}\n\tacceptDetachInstanceReply(requestId: number, persistentProcessId: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcceptDetachInstanceReply, [requestId, persistentProcessId]);\n\t}\n\tattachToProcess(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AttachToProcess, [id]);\n\t}\n\tdetachFromProcess(id: number, forcePersist?: boolean): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.DetachFromProcess, [id, forcePersist]);\n\t}\n\tlistProcesses(): Promise<IProcessDetails[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ListProcesses);\n\t}\n\tgetLatency(): Promise<IPtyHostLatencyMeasurement[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetLatency);\n\t}\n\tgetPerformanceMarks(): Promise<performance.PerformanceMark[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetPerformanceMarks);\n\t}\n\treduceConnectionGraceTime(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ReduceConnectionGraceTime);\n\t}\n\tprocessBinary(id: number, data: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ProcessBinary, [id, data]);\n\t}\n\tstart(id: number): Promise<ITerminalLaunchError | ITerminalLaunchResult | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Start, [id]);\n\t}\n\tinput(id: number, data: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Input, [id, data]);\n\t}\n\tsendSignal(id: number, signal: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SendSignal, [id, signal]);\n\t}\n\tacknowledgeDataEvent(id: number, charCount: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcknowledgeDataEvent, [id, charCount]);\n\t}\n\tsetUnicodeVersion(id: number, version: '6' | '11'): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SetUnicodeVersion, [id, version]);\n\t}\n\tsetNextCommandId(id: number, commandLine: string, commandId: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SetNextCommandId, [id, commandLine, commandId]);\n\t}\n\tshutdown(id: number, immediate: boolean): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Shutdown, [id, immediate]);\n\t}\n\tresize(id: number, cols: number, rows: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.Resize, [id, cols, rows]);\n\t}\n\tclearBuffer(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ClearBuffer, [id]);\n\t}\n\tgetInitialCwd(id: number): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetInitialCwd, [id]);\n\t}\n\tgetCwd(id: number): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetCwd, [id]);\n\t}\n\torphanQuestionReply(id: number): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.OrphanQuestionReply, [id]);\n\t}\n\tsendCommandResult(reqId: number, isError: boolean, payload: unknown): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SendCommandResult, [reqId, isError, payload]);\n\t}\n\tfreePortKillProcess(port: string): Promise<{ port: string; processId: string }> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.FreePortKillProcess, [port]);\n\t}\n\tgetDefaultSystemShell(osOverride?: OperatingSystem): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetDefaultSystemShell, [osOverride]);\n\t}\n\tgetProfiles(profiles: unknown, defaultProfile: unknown, includeDetectedProfiles?: boolean): Promise<ITerminalProfile[]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetProfiles, [this._workspaceContextService.getWorkspace().id, profiles, defaultProfile, includeDetectedProfiles]);\n\t}\n\tacceptPtyHostResolvedVariables(requestId: number, resolved: string[]): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.AcceptPtyHostResolvedVariables, [requestId, resolved]);\n\t}\n\n\tgetEnvironment(): Promise<IProcessEnvironment> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetEnvironment);\n\t}\n\n\tgetWslPath(original: string, direction: 'unix-to-win' | 'win-to-unix'): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetWslPath, [original, direction]);\n\t}\n\n\tsetTerminalLayoutInfo(layout?: ITerminalsLayoutInfoById): Promise<void> {\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst args: ISetTerminalLayoutInfoArgs = {\n\t\t\tworkspaceId: workspace.id,\n\t\t\ttabs: layout ? layout.tabs : [],\n\t\t\tbackground: layout ? layout.background : null\n\t\t};\n\t\treturn this._channel.call<void>(RemoteTerminalChannelRequest.SetTerminalLayoutInfo, args);\n\t}\n\n\tupdateTitle(id: number, title: string, titleSource: TitleEventSource): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateTitle, [id, title, titleSource]);\n\t}\n\n\tupdateIcon(id: number, userInitiated: boolean, icon: TerminalIcon, color?: string): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateIcon, [id, userInitiated, icon, color]);\n\t}\n\n\trefreshProperty<T extends ProcessPropertyType>(id: number, property: T): Promise<IProcessPropertyMap[T]> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.RefreshProperty, [id, property]);\n\t}\n\n\tupdateProperty<T extends ProcessPropertyType>(id: number, property: T, value: IProcessPropertyMap[T]): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UpdateProperty, [id, property, value]);\n\t}\n\n\tgetTerminalLayoutInfo(): Promise<ITerminalsLayoutInfo | undefined> {\n\t\tconst workspace = this._workspaceContextService.getWorkspace();\n\t\tconst args: IGetTerminalLayoutInfoArgs = {\n\t\t\tworkspaceId: workspace.id,\n\t\t};\n\t\treturn this._channel.call<ITerminalsLayoutInfo>(RemoteTerminalChannelRequest.GetTerminalLayoutInfo, args);\n\t}\n\n\treviveTerminalProcesses(workspaceId: string, state: ISerializedTerminalState[], dateTimeFormatLocate: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.ReviveTerminalProcesses, [workspaceId, state, dateTimeFormatLocate]);\n\t}\n\n\tgetRevivedPtyNewId(id: number): Promise<number | undefined> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.GetRevivedPtyNewId, [id]);\n\t}\n\n\tserializeTerminalState(ids: number[]): Promise<string> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.SerializeTerminalState, [ids]);\n\t}\n\n\t// #region Pty service contribution RPC calls\n\n\tinstallAutoReply(match: string, reply: string): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.InstallAutoReply, [match, reply]);\n\t}\n\tuninstallAllAutoReplies(): Promise<void> {\n\t\treturn this._channel.call(RemoteTerminalChannelRequest.UninstallAllAutoReplies, []);\n\t}\n\n\t// #endregion\n}\n"]}