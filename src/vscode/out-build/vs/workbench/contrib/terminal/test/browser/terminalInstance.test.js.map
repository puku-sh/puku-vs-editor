{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/test/browser/terminalInstance.test.ts","vs/workbench/contrib/terminal/test/browser/terminalInstance.test.ts"],"names":[],"mappings":"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","file":"terminalInstance.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, strictEqual } from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { isWindows, type IProcessEnvironment } from '../../../../../base/common/platform.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { TerminalCapability, type ICwdDetectionCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalCapabilityStore } from '../../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { GeneralShellType, ITerminalChildProcess, ITerminalProfile, TitleEventSource, type IShellLaunchConfig, type ITerminalBackend, type ITerminalProcessOptions } from '../../../../../platform/terminal/common/terminal.js';\nimport { IWorkspaceFolder } from '../../../../../platform/workspace/common/workspace.js';\nimport { IViewDescriptorService } from '../../../../common/views.js';\nimport { ITerminalConfigurationService, ITerminalInstance, ITerminalInstanceService, ITerminalService } from '../../browser/terminal.js';\nimport { TerminalConfigurationService } from '../../browser/terminalConfigurationService.js';\nimport { parseExitResult, TerminalInstance, TerminalLabelComputer } from '../../browser/terminalInstance.js';\nimport { IEnvironmentVariableService } from '../../common/environmentVariable.js';\nimport { EnvironmentVariableService } from '../../common/environmentVariableService.js';\nimport { ITerminalProfileResolverService, ProcessState } from '../../common/terminal.js';\nimport { TestViewDescriptorService } from './xterm/xtermTerminal.test.js';\nimport { fixPath } from '../../../../services/search/test/browser/queryBuilder.test.js';\nimport { TestTerminalProfileResolverService, workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\n\nconst root1 = '/foo/root1';\nconst ROOT_1 = fixPath(root1);\nconst root2 = '/foo/root2';\nconst ROOT_2 = fixPath(root2);\n\nclass MockTerminalProfileResolverService extends TestTerminalProfileResolverService {\n\toverride async getDefaultProfile(): Promise<ITerminalProfile> {\n\t\treturn {\n\t\t\tprofileName: 'my-sh',\n\t\t\tpath: '/usr/bin/zsh',\n\t\t\tenv: {\n\t\t\t\tTEST: 'TEST',\n\t\t\t},\n\t\t\tisDefault: true,\n\t\t\tisUnsafePath: false,\n\t\t\tisFromPath: true,\n\t\t\ticon: {\n\t\t\t\tid: 'terminal-linux',\n\t\t\t},\n\t\t\tcolor: 'terminal.ansiYellow',\n\t\t};\n\t}\n}\n\nconst terminalShellTypeContextKey = {\n\tset: () => { },\n\treset: () => { },\n\tget: () => undefined\n};\n\nclass TestTerminalChildProcess extends Disposable implements ITerminalChildProcess {\n\tid: number = 0;\n\tget capabilities() { return []; }\n\tconstructor(\n\t\treadonly shouldPersist: boolean\n\t) {\n\t\tsuper();\n\t}\n\tupdateProperty(property: any, value: any): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\treadonly onProcessOverrideDimensions?: Event<any> | undefined;\n\treadonly onProcessResolvedShellLaunchConfig?: Event<any> | undefined;\n\treadonly onDidChangeHasChildProcesses?: Event<any> | undefined;\n\n\tonDidChangeProperty = Event.None;\n\tonProcessData = Event.None;\n\tonProcessExit = Event.None;\n\tonProcessReady = Event.None;\n\tonProcessTitleChanged = Event.None;\n\tonProcessShellTypeChanged = Event.None;\n\tasync start(): Promise<undefined> { return undefined; }\n\tshutdown(immediate: boolean): void { }\n\tinput(data: string): void { }\n\tsendSignal(signal: string): void { }\n\tresize(cols: number, rows: number): void { }\n\tclearBuffer(): void { }\n\tacknowledgeDataEvent(charCount: number): void { }\n\tasync setUnicodeVersion(version: '6' | '11'): Promise<void> { }\n\tasync getInitialCwd(): Promise<string> { return ''; }\n\tasync getCwd(): Promise<string> { return ''; }\n\tasync processBinary(data: string): Promise<void> { }\n\trefreshProperty(property: any): Promise<any> { return Promise.resolve(''); }\n}\n\nclass TestTerminalInstanceService extends Disposable implements Partial<ITerminalInstanceService> {\n\tasync getBackend() {\n\t\treturn {\n\t\t\tonPtyHostExit: Event.None,\n\t\t\tonPtyHostUnresponsive: Event.None,\n\t\t\tonPtyHostResponsive: Event.None,\n\t\t\tonPtyHostRestart: Event.None,\n\t\t\tonDidMoveWindowInstance: Event.None,\n\t\t\tonDidRequestDetach: Event.None,\n\t\t\tcreateProcess: async (\n\t\t\t\tshellLaunchConfig: IShellLaunchConfig,\n\t\t\t\tcwd: string,\n\t\t\t\tcols: number,\n\t\t\t\trows: number,\n\t\t\t\tunicodeVersion: '6' | '11',\n\t\t\t\tenv: IProcessEnvironment,\n\t\t\t\toptions: ITerminalProcessOptions,\n\t\t\t\tshouldPersist: boolean\n\t\t\t) => this._register(new TestTerminalChildProcess(shouldPersist)),\n\t\t\tgetLatency: () => Promise.resolve([])\n\t\t} as unknown as ITerminalBackend;\n\t}\n}\n\nsuite('Workbench - TerminalInstance', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('TerminalInstance', () => {\n\t\tlet terminalInstance: ITerminalInstance;\n\t\ttest('should create an instance of TerminalInstance with env from default profile', async () => {\n\t\t\tconst instantiationService = workbenchInstantiationService({\n\t\t\t\tconfigurationService: () => new TestConfigurationService({\n\t\t\t\t\tfiles: {},\n\t\t\t\t\tterminal: {\n\t\t\t\t\t\tintegrated: {\n\t\t\t\t\t\t\tfontFamily: 'monospace',\n\t\t\t\t\t\t\tscrollback: 1000,\n\t\t\t\t\t\t\tfastScrollSensitivity: 2,\n\t\t\t\t\t\t\tmouseWheelScrollSensitivity: 1,\n\t\t\t\t\t\t\tunicodeVersion: '6',\n\t\t\t\t\t\t\tshellIntegration: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}, store);\n\t\t\tinstantiationService.set(ITerminalProfileResolverService, new MockTerminalProfileResolverService());\n\t\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\t\tinstantiationService.stub(IEnvironmentVariableService, store.add(instantiationService.createInstance(EnvironmentVariableService)));\n\t\t\tinstantiationService.stub(ITerminalInstanceService, store.add(new TestTerminalInstanceService()));\n\t\t\tinstantiationService.stub(ITerminalService, { setNextCommandId: async () => { } } as Partial<ITerminalService>);\n\t\t\tterminalInstance = store.add(instantiationService.createInstance(TerminalInstance, terminalShellTypeContextKey, {}));\n\t\t\t// //Wait for the teminalInstance._xtermReadyPromise to resolve\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 100));\n\t\t\tdeepStrictEqual(terminalInstance.shellLaunchConfig.env, { TEST: 'TEST' });\n\t\t});\n\n\t\ttest('should preserve title for task terminals', async () => {\n\t\t\tconst instantiationService = workbenchInstantiationService({\n\t\t\t\tconfigurationService: () => new TestConfigurationService({\n\t\t\t\t\tfiles: {},\n\t\t\t\t\tterminal: {\n\t\t\t\t\t\tintegrated: {\n\t\t\t\t\t\t\tfontFamily: 'monospace',\n\t\t\t\t\t\t\tscrollback: 1000,\n\t\t\t\t\t\t\tfastScrollSensitivity: 2,\n\t\t\t\t\t\t\tmouseWheelScrollSensitivity: 1,\n\t\t\t\t\t\t\tunicodeVersion: '6',\n\t\t\t\t\t\t\tshellIntegration: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}, store);\n\t\t\tinstantiationService.set(ITerminalProfileResolverService, new MockTerminalProfileResolverService());\n\t\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\t\tinstantiationService.stub(IEnvironmentVariableService, store.add(instantiationService.createInstance(EnvironmentVariableService)));\n\t\t\tinstantiationService.stub(ITerminalInstanceService, store.add(new TestTerminalInstanceService()));\n\t\t\tinstantiationService.stub(ITerminalService, { setNextCommandId: async () => { } } as Partial<ITerminalService>);\n\n\t\t\tconst taskTerminal = store.add(instantiationService.createInstance(TerminalInstance, terminalShellTypeContextKey, {\n\t\t\t\ttype: 'Task',\n\t\t\t\tname: 'Test Task Name'\n\t\t\t}));\n\n\n\t\t\t// Simulate setting the title via API (as the task system would do)\n\t\t\tawait taskTerminal.rename('Test Task Name');\n\t\t\tstrictEqual(taskTerminal.title, 'Test Task Name');\n\n\t\t\t// Simulate a process title change (which happens when task completes)\n\t\t\tawait taskTerminal.rename('some-process-name', TitleEventSource.Process);\n\n\t\t\t// Verify that the task name is preserved\n\t\t\tstrictEqual(taskTerminal.title, 'Test Task Name', 'Task terminal should preserve API-set title');\n\t\t});\n\t});\n\tsuite('parseExitResult', () => {\n\t\ttest('should return no message for exit code = undefined', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should return no message for exit code = 0', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable is specified for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" failed to launch (exit code: 1).' }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" terminated with exit code: 1.' }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" terminated with exit code: 1.' }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable and args are specified for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" failed to launch (exit code: 1).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" terminated with exit code: 1.` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" terminated with exit code: 1.` }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable and arguments are omitted for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process failed to launch (exit code: 1).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process terminated with exit code: 1.` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process terminated with exit code: 1.` }\n\t\t\t);\n\t\t});\n\t\ttest('should ignore pty host-related errors', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ message: 'Could not find pty with id 16' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 5', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 5, message: 'A native exception occurred during launch (Cannot create process, error code: 5)' }, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 5, message: `The terminal process failed to launch: Access was denied to the path containing your executable \"foo\". Manage and change your permissions to get this to work.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 267', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 267, message: 'A native exception occurred during launch (Cannot create process, error code: 267)' }, {}, ProcessState.KilledDuringLaunch, '/foo'),\n\t\t\t\t{ code: 267, message: `The terminal process failed to launch: Invalid starting directory \"/foo\", review your terminal.integrated.cwd setting.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 1260', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 1260, message: 'A native exception occurred during launch (Cannot create process, error code: 1260)' }, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1260, message: `The terminal process failed to launch: Windows cannot open this program because it has been prevented by a software restriction policy. For more information, open Event Viewer or contact your system Administrator.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format generic failures', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 123, message: 'A native exception occurred during launch (Cannot create process, error code: 123)' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 123, message: `The terminal process failed to launch: A native exception occurred during launch (Cannot create process, error code: 123).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 123, message: 'foo' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 123, message: `The terminal process failed to launch: foo.` }\n\t\t\t);\n\t\t});\n\t});\n\tsuite('TerminalLabelComputer', () => {\n\t\tlet instantiationService: TestInstantiationService;\n\t\tlet capabilities: TerminalCapabilityStore;\n\n\t\tfunction createInstance(partial?: Partial<ITerminalInstance>): Pick<ITerminalInstance, 'shellLaunchConfig' | 'shellType' | 'userHome' | 'cwd' | 'initialCwd' | 'processName' | 'sequence' | 'workspaceFolder' | 'staticTitle' | 'capabilities' | 'title' | 'description'> {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tif (!isWindows) {\n\t\t\t\tcapabilities.add(TerminalCapability.NaiveCwdDetection, null!);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tshellLaunchConfig: {},\n\t\t\t\tshellType: GeneralShellType.PowerShell,\n\t\t\t\tcwd: 'cwd',\n\t\t\t\tinitialCwd: undefined,\n\t\t\t\tprocessName: '',\n\t\t\t\tsequence: undefined,\n\t\t\t\tworkspaceFolder: undefined,\n\t\t\t\tstaticTitle: undefined,\n\t\t\t\tcapabilities,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tuserHome: undefined,\n\t\t\t\t...partial\n\t\t\t};\n\t\t}\n\n\t\tsetup(async () => {\n\t\t\tinstantiationService = workbenchInstantiationService(undefined, store);\n\t\t\tcapabilities = store.add(new TerminalCapabilityStore());\n\t\t\tif (!isWindows) {\n\t\t\t\tcapabilities.add(TerminalCapability.NaiveCwdDetection, null!);\n\t\t\t}\n\t\t});\n\n\t\tfunction createLabelComputer(configuration: any) {\n\t\t\tinstantiationService.set(IConfigurationService, new TestConfigurationService(configuration));\n\t\t\tinstantiationService.set(ITerminalConfigurationService, store.add(instantiationService.createInstance(TerminalConfigurationService)));\n\t\t\treturn store.add(instantiationService.createInstance(TerminalLabelComputer));\n\t\t}\n\n\t\ttest('should resolve to \"\" when the template variables are empty', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '', description: '' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: '' }));\n\t\t\t// TODO:\n\t\t\t// terminalLabelComputer.onLabelChanged(e => {\n\t\t\t// \tstrictEqual(e.title, '');\n\t\t\t// \tstrictEqual(e.description, '');\n\t\t\t// });\n\t\t\tstrictEqual(terminalLabelComputer.title, '');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t});\n\t\ttest('should resolve cwd', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${cwd}', description: '${cwd}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, cwd: ROOT_1 }));\n\t\t\tstrictEqual(terminalLabelComputer.title, ROOT_1);\n\t\t\tstrictEqual(terminalLabelComputer.description, ROOT_1);\n\t\t});\n\t\ttest('should resolve workspaceFolder', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${workspaceFolder}', description: '${workspaceFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: 'folder' }) } as IWorkspaceFolder }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'folder');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'folder');\n\t\t});\n\t\ttest('should resolve local', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${local}', description: '${local}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Local' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'Local');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'Local');\n\t\t});\n\t\ttest('should resolve process', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${process}', description: '${process}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'zsh');\n\t\t});\n\t\ttest('should resolve sequence', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${sequence}', description: '${sequence}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, sequence: 'sequence' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'sequence');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'sequence');\n\t\t});\n\t\ttest('should resolve task', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${task}', description: '${task}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Task' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh ~ Task');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'Task');\n\t\t});\n\t\ttest('should resolve separator', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${separator}', description: '${separator}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Task' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t});\n\t\ttest('should always return static title when specified', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}', description: '${workspaceFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: 'folder' }) } as IWorkspaceFolder, staticTitle: 'my-title' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'my-title');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'folder');\n\t\t});\n\t\ttest('should provide cwdFolder for all cwds only when in multi-root', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_1 }));\n\t\t\t// single-root, cwd is same as root\n\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\t// multi-root\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_2 }));\n\t\t\tif (isWindows) {\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\t} else {\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process ~ root2');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, 'root2');\n\t\t\t}\n\t\t});\n\t\ttest('should hide cwdFolder in single folder workspaces when cwd matches the workspace\\'s default cwd even when slashes differ', async () => {\n\t\t\tlet terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_1 }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\tif (!isWindows) {\n\t\t\t\tterminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_2 }));\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process ~ root2');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, 'root2');\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('getCwdResource', () => {\n\t\tlet mockFileService: any;\n\t\tlet mockPathService: any;\n\n\t\tfunction createMockTerminalInstance(options: {\n\t\t\tcwd?: string;\n\t\t\tremoteAuthority?: string;\n\t\t\tfileExists?: boolean;\n\t\t}): Pick<ITerminalInstance, 'getCwdResource' | 'capabilities' | 'remoteAuthority'> {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\n\t\t\tif (options.cwd) {\n\t\t\t\tconst mockCwdDetection = {\n\t\t\t\t\tgetCwd: () => options.cwd\n\t\t\t\t};\n\t\t\t\tcapabilities.add(TerminalCapability.CwdDetection, mockCwdDetection as unknown as ICwdDetectionCapability);\n\t\t\t}\n\n\t\t\t// Mock file service\n\t\t\tmockFileService = {\n\t\t\t\texists: async (resource: URI) => options.fileExists !== false\n\t\t\t};\n\n\t\t\t// Mock path service\n\t\t\tmockPathService = {\n\t\t\t\tfileURI: async (path: string) => {\n\t\t\t\t\tif (options.remoteAuthority) {\n\t\t\t\t\t\treturn URI.parse(`vscode-remote://${options.remoteAuthority}${path}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn URI.file(path);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tcapabilities,\n\t\t\t\tremoteAuthority: options.remoteAuthority,\n\t\t\t\tasync getCwdResource(): Promise<URI | undefined> {\n\t\t\t\t\tconst cwd = this.capabilities.get(TerminalCapability.CwdDetection)?.getCwd();\n\t\t\t\t\tif (!cwd) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\tlet resource: URI;\n\t\t\t\t\tif (this.remoteAuthority) {\n\t\t\t\t\t\tresource = await mockPathService.fileURI(cwd);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresource = URI.file(cwd);\n\t\t\t\t\t}\n\t\t\t\t\tif (await mockFileService.exists(resource)) {\n\t\t\t\t\t\treturn resource;\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\ttest('should return undefined when no CwdDetection capability', async () => {\n\t\t\tconst instance = createMockTerminalInstance({});\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should return undefined when CwdDetection capability returns no cwd', async () => {\n\t\t\tconst instance = createMockTerminalInstance({ cwd: undefined });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should return URI.file for local terminal when file exists', async () => {\n\t\t\tconst testCwd = '/test/path';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: true });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'file');\n\t\t\tstrictEqual(result?.path, testCwd);\n\t\t});\n\n\t\ttest('should return undefined when file does not exist', async () => {\n\t\t\tconst testCwd = '/test/nonexistent';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: false });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should use pathService.fileURI for remote terminal', async () => {\n\t\t\tconst testCwd = '/test/remote/path';\n\t\t\tconst instance = createMockTerminalInstance({\n\t\t\t\tcwd: testCwd,\n\t\t\t\tremoteAuthority: 'test-remote',\n\t\t\t\tfileExists: true\n\t\t\t});\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'vscode-remote');\n\t\t\tstrictEqual(result?.authority, 'test-remote');\n\t\t\tstrictEqual(result?.path, testCwd);\n\t\t});\n\n\t\ttest('should handle Windows paths correctly', async () => {\n\t\t\tconst testCwd = isWindows ? 'C:\\\\test\\\\path' : '/test/path';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: true });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'file');\n\t\t\tif (isWindows) {\n\t\t\t\tstrictEqual(result?.path, '/C:/test/path');\n\t\t\t} else {\n\t\t\t\tstrictEqual(result?.path, testCwd);\n\t\t\t}\n\t\t});\n\n\t\ttest('should handle empty cwd string', async () => {\n\t\t\tconst instance = createMockTerminalInstance({ cwd: '' });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, strictEqual } from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { isWindows, type IProcessEnvironment } from '../../../../../base/common/platform.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { TerminalCapability, type ICwdDetectionCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalCapabilityStore } from '../../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { GeneralShellType, ITerminalChildProcess, ITerminalProfile, TitleEventSource, type IShellLaunchConfig, type ITerminalBackend, type ITerminalProcessOptions } from '../../../../../platform/terminal/common/terminal.js';\nimport { IWorkspaceFolder } from '../../../../../platform/workspace/common/workspace.js';\nimport { IViewDescriptorService } from '../../../../common/views.js';\nimport { ITerminalConfigurationService, ITerminalInstance, ITerminalInstanceService, ITerminalService } from '../../browser/terminal.js';\nimport { TerminalConfigurationService } from '../../browser/terminalConfigurationService.js';\nimport { parseExitResult, TerminalInstance, TerminalLabelComputer } from '../../browser/terminalInstance.js';\nimport { IEnvironmentVariableService } from '../../common/environmentVariable.js';\nimport { EnvironmentVariableService } from '../../common/environmentVariableService.js';\nimport { ITerminalProfileResolverService, ProcessState } from '../../common/terminal.js';\nimport { TestViewDescriptorService } from './xterm/xtermTerminal.test.js';\nimport { fixPath } from '../../../../services/search/test/browser/queryBuilder.test.js';\nimport { TestTerminalProfileResolverService, workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\n\nconst root1 = '/foo/root1';\nconst ROOT_1 = fixPath(root1);\nconst root2 = '/foo/root2';\nconst ROOT_2 = fixPath(root2);\n\nclass MockTerminalProfileResolverService extends TestTerminalProfileResolverService {\n\toverride async getDefaultProfile(): Promise<ITerminalProfile> {\n\t\treturn {\n\t\t\tprofileName: 'my-sh',\n\t\t\tpath: '/usr/bin/zsh',\n\t\t\tenv: {\n\t\t\t\tTEST: 'TEST',\n\t\t\t},\n\t\t\tisDefault: true,\n\t\t\tisUnsafePath: false,\n\t\t\tisFromPath: true,\n\t\t\ticon: {\n\t\t\t\tid: 'terminal-linux',\n\t\t\t},\n\t\t\tcolor: 'terminal.ansiYellow',\n\t\t};\n\t}\n}\n\nconst terminalShellTypeContextKey = {\n\tset: () => { },\n\treset: () => { },\n\tget: () => undefined\n};\n\nclass TestTerminalChildProcess extends Disposable implements ITerminalChildProcess {\n\tid: number = 0;\n\tget capabilities() { return []; }\n\tconstructor(\n\t\treadonly shouldPersist: boolean\n\t) {\n\t\tsuper();\n\t}\n\tupdateProperty(property: any, value: any): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\treadonly onProcessOverrideDimensions?: Event<any> | undefined;\n\treadonly onProcessResolvedShellLaunchConfig?: Event<any> | undefined;\n\treadonly onDidChangeHasChildProcesses?: Event<any> | undefined;\n\n\tonDidChangeProperty = Event.None;\n\tonProcessData = Event.None;\n\tonProcessExit = Event.None;\n\tonProcessReady = Event.None;\n\tonProcessTitleChanged = Event.None;\n\tonProcessShellTypeChanged = Event.None;\n\tasync start(): Promise<undefined> { return undefined; }\n\tshutdown(immediate: boolean): void { }\n\tinput(data: string): void { }\n\tsendSignal(signal: string): void { }\n\tresize(cols: number, rows: number): void { }\n\tclearBuffer(): void { }\n\tacknowledgeDataEvent(charCount: number): void { }\n\tasync setUnicodeVersion(version: '6' | '11'): Promise<void> { }\n\tasync getInitialCwd(): Promise<string> { return ''; }\n\tasync getCwd(): Promise<string> { return ''; }\n\tasync processBinary(data: string): Promise<void> { }\n\trefreshProperty(property: any): Promise<any> { return Promise.resolve(''); }\n}\n\nclass TestTerminalInstanceService extends Disposable implements Partial<ITerminalInstanceService> {\n\tasync getBackend() {\n\t\treturn {\n\t\t\tonPtyHostExit: Event.None,\n\t\t\tonPtyHostUnresponsive: Event.None,\n\t\t\tonPtyHostResponsive: Event.None,\n\t\t\tonPtyHostRestart: Event.None,\n\t\t\tonDidMoveWindowInstance: Event.None,\n\t\t\tonDidRequestDetach: Event.None,\n\t\t\tcreateProcess: async (\n\t\t\t\tshellLaunchConfig: IShellLaunchConfig,\n\t\t\t\tcwd: string,\n\t\t\t\tcols: number,\n\t\t\t\trows: number,\n\t\t\t\tunicodeVersion: '6' | '11',\n\t\t\t\tenv: IProcessEnvironment,\n\t\t\t\toptions: ITerminalProcessOptions,\n\t\t\t\tshouldPersist: boolean\n\t\t\t) => this._register(new TestTerminalChildProcess(shouldPersist)),\n\t\t\tgetLatency: () => Promise.resolve([])\n\t\t} as unknown as ITerminalBackend;\n\t}\n}\n\nsuite('Workbench - TerminalInstance', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('TerminalInstance', () => {\n\t\tlet terminalInstance: ITerminalInstance;\n\t\ttest('should create an instance of TerminalInstance with env from default profile', async () => {\n\t\t\tconst instantiationService = workbenchInstantiationService({\n\t\t\t\tconfigurationService: () => new TestConfigurationService({\n\t\t\t\t\tfiles: {},\n\t\t\t\t\tterminal: {\n\t\t\t\t\t\tintegrated: {\n\t\t\t\t\t\t\tfontFamily: 'monospace',\n\t\t\t\t\t\t\tscrollback: 1000,\n\t\t\t\t\t\t\tfastScrollSensitivity: 2,\n\t\t\t\t\t\t\tmouseWheelScrollSensitivity: 1,\n\t\t\t\t\t\t\tunicodeVersion: '6',\n\t\t\t\t\t\t\tshellIntegration: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}, store);\n\t\t\tinstantiationService.set(ITerminalProfileResolverService, new MockTerminalProfileResolverService());\n\t\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\t\tinstantiationService.stub(IEnvironmentVariableService, store.add(instantiationService.createInstance(EnvironmentVariableService)));\n\t\t\tinstantiationService.stub(ITerminalInstanceService, store.add(new TestTerminalInstanceService()));\n\t\t\tinstantiationService.stub(ITerminalService, { setNextCommandId: async () => { } } as Partial<ITerminalService>);\n\t\t\tterminalInstance = store.add(instantiationService.createInstance(TerminalInstance, terminalShellTypeContextKey, {}));\n\t\t\t// //Wait for the teminalInstance._xtermReadyPromise to resolve\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 100));\n\t\t\tdeepStrictEqual(terminalInstance.shellLaunchConfig.env, { TEST: 'TEST' });\n\t\t});\n\n\t\ttest('should preserve title for task terminals', async () => {\n\t\t\tconst instantiationService = workbenchInstantiationService({\n\t\t\t\tconfigurationService: () => new TestConfigurationService({\n\t\t\t\t\tfiles: {},\n\t\t\t\t\tterminal: {\n\t\t\t\t\t\tintegrated: {\n\t\t\t\t\t\t\tfontFamily: 'monospace',\n\t\t\t\t\t\t\tscrollback: 1000,\n\t\t\t\t\t\t\tfastScrollSensitivity: 2,\n\t\t\t\t\t\t\tmouseWheelScrollSensitivity: 1,\n\t\t\t\t\t\t\tunicodeVersion: '6',\n\t\t\t\t\t\t\tshellIntegration: {\n\t\t\t\t\t\t\t\tenabled: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}, store);\n\t\t\tinstantiationService.set(ITerminalProfileResolverService, new MockTerminalProfileResolverService());\n\t\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\t\tinstantiationService.stub(IEnvironmentVariableService, store.add(instantiationService.createInstance(EnvironmentVariableService)));\n\t\t\tinstantiationService.stub(ITerminalInstanceService, store.add(new TestTerminalInstanceService()));\n\t\t\tinstantiationService.stub(ITerminalService, { setNextCommandId: async () => { } } as Partial<ITerminalService>);\n\n\t\t\tconst taskTerminal = store.add(instantiationService.createInstance(TerminalInstance, terminalShellTypeContextKey, {\n\t\t\t\ttype: 'Task',\n\t\t\t\tname: 'Test Task Name'\n\t\t\t}));\n\n\n\t\t\t// Simulate setting the title via API (as the task system would do)\n\t\t\tawait taskTerminal.rename('Test Task Name');\n\t\t\tstrictEqual(taskTerminal.title, 'Test Task Name');\n\n\t\t\t// Simulate a process title change (which happens when task completes)\n\t\t\tawait taskTerminal.rename('some-process-name', TitleEventSource.Process);\n\n\t\t\t// Verify that the task name is preserved\n\t\t\tstrictEqual(taskTerminal.title, 'Test Task Name', 'Task terminal should preserve API-set title');\n\t\t});\n\t});\n\tsuite('parseExitResult', () => {\n\t\ttest('should return no message for exit code = undefined', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(undefined, {}, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should return no message for exit code = 0', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(0, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 0, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable is specified for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" failed to launch (exit code: 1).' }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" terminated with exit code: 1.' }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo' }, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: 'The terminal process \"foo\" terminated with exit code: 1.' }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable and args are specified for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" failed to launch (exit code: 1).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" terminated with exit code: 1.` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, { executable: 'foo', args: ['bar', 'baz'] }, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process \"foo 'bar', 'baz'\" terminated with exit code: 1.` }\n\t\t\t);\n\t\t});\n\t\ttest('should return friendly message when executable and arguments are omitted for non-zero exit codes', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process failed to launch (exit code: 1).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledByUser, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process terminated with exit code: 1.` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult(1, {}, ProcessState.KilledByProcess, undefined),\n\t\t\t\t{ code: 1, message: `The terminal process terminated with exit code: 1.` }\n\t\t\t);\n\t\t});\n\t\ttest('should ignore pty host-related errors', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ message: 'Could not find pty with id 16' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: undefined, message: undefined }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 5', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 5, message: 'A native exception occurred during launch (Cannot create process, error code: 5)' }, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 5, message: `The terminal process failed to launch: Access was denied to the path containing your executable \"foo\". Manage and change your permissions to get this to work.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 267', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 267, message: 'A native exception occurred during launch (Cannot create process, error code: 267)' }, {}, ProcessState.KilledDuringLaunch, '/foo'),\n\t\t\t\t{ code: 267, message: `The terminal process failed to launch: Invalid starting directory \"/foo\", review your terminal.integrated.cwd setting.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format conpty failure code 1260', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 1260, message: 'A native exception occurred during launch (Cannot create process, error code: 1260)' }, { executable: 'foo' }, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 1260, message: `The terminal process failed to launch: Windows cannot open this program because it has been prevented by a software restriction policy. For more information, open Event Viewer or contact your system Administrator.` }\n\t\t\t);\n\t\t});\n\t\ttest('should format generic failures', () => {\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 123, message: 'A native exception occurred during launch (Cannot create process, error code: 123)' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 123, message: `The terminal process failed to launch: A native exception occurred during launch (Cannot create process, error code: 123).` }\n\t\t\t);\n\t\t\tdeepStrictEqual(\n\t\t\t\tparseExitResult({ code: 123, message: 'foo' }, {}, ProcessState.KilledDuringLaunch, undefined),\n\t\t\t\t{ code: 123, message: `The terminal process failed to launch: foo.` }\n\t\t\t);\n\t\t});\n\t});\n\tsuite('TerminalLabelComputer', () => {\n\t\tlet instantiationService: TestInstantiationService;\n\t\tlet capabilities: TerminalCapabilityStore;\n\n\t\tfunction createInstance(partial?: Partial<ITerminalInstance>): Pick<ITerminalInstance, 'shellLaunchConfig' | 'shellType' | 'userHome' | 'cwd' | 'initialCwd' | 'processName' | 'sequence' | 'workspaceFolder' | 'staticTitle' | 'capabilities' | 'title' | 'description'> {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tif (!isWindows) {\n\t\t\t\tcapabilities.add(TerminalCapability.NaiveCwdDetection, null!);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tshellLaunchConfig: {},\n\t\t\t\tshellType: GeneralShellType.PowerShell,\n\t\t\t\tcwd: 'cwd',\n\t\t\t\tinitialCwd: undefined,\n\t\t\t\tprocessName: '',\n\t\t\t\tsequence: undefined,\n\t\t\t\tworkspaceFolder: undefined,\n\t\t\t\tstaticTitle: undefined,\n\t\t\t\tcapabilities,\n\t\t\t\ttitle: '',\n\t\t\t\tdescription: '',\n\t\t\t\tuserHome: undefined,\n\t\t\t\t...partial\n\t\t\t};\n\t\t}\n\n\t\tsetup(async () => {\n\t\t\tinstantiationService = workbenchInstantiationService(undefined, store);\n\t\t\tcapabilities = store.add(new TerminalCapabilityStore());\n\t\t\tif (!isWindows) {\n\t\t\t\tcapabilities.add(TerminalCapability.NaiveCwdDetection, null!);\n\t\t\t}\n\t\t});\n\n\t\tfunction createLabelComputer(configuration: any) {\n\t\t\tinstantiationService.set(IConfigurationService, new TestConfigurationService(configuration));\n\t\t\tinstantiationService.set(ITerminalConfigurationService, store.add(instantiationService.createInstance(TerminalConfigurationService)));\n\t\t\treturn store.add(instantiationService.createInstance(TerminalLabelComputer));\n\t\t}\n\n\t\ttest('should resolve to \"\" when the template variables are empty', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '', description: '' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: '' }));\n\t\t\t// TODO:\n\t\t\t// terminalLabelComputer.onLabelChanged(e => {\n\t\t\t// \tstrictEqual(e.title, '');\n\t\t\t// \tstrictEqual(e.description, '');\n\t\t\t// });\n\t\t\tstrictEqual(terminalLabelComputer.title, '');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t});\n\t\ttest('should resolve cwd', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${cwd}', description: '${cwd}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, cwd: ROOT_1 }));\n\t\t\tstrictEqual(terminalLabelComputer.title, ROOT_1);\n\t\t\tstrictEqual(terminalLabelComputer.description, ROOT_1);\n\t\t});\n\t\ttest('should resolve workspaceFolder', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${workspaceFolder}', description: '${workspaceFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: 'folder' }) } as IWorkspaceFolder }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'folder');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'folder');\n\t\t});\n\t\ttest('should resolve local', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${local}', description: '${local}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Local' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'Local');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'Local');\n\t\t});\n\t\ttest('should resolve process', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${process}', description: '${process}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'zsh');\n\t\t});\n\t\ttest('should resolve sequence', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' - ', title: '${sequence}', description: '${sequence}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, sequence: 'sequence' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'sequence');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'sequence');\n\t\t});\n\t\ttest('should resolve task', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${task}', description: '${task}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Task' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh ~ Task');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'Task');\n\t\t});\n\t\ttest('should resolve separator', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${separator}', description: '${separator}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'zsh', shellLaunchConfig: { type: 'Task' } }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'zsh');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t});\n\t\ttest('should always return static title when specified', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}', description: '${workspaceFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: 'folder' }) } as IWorkspaceFolder, staticTitle: 'my-title' }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'my-title');\n\t\t\tstrictEqual(terminalLabelComputer.description, 'folder');\n\t\t});\n\t\ttest('should provide cwdFolder for all cwds only when in multi-root', () => {\n\t\t\tconst terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_1 }));\n\t\t\t// single-root, cwd is same as root\n\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\t// multi-root\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_2 }));\n\t\t\tif (isWindows) {\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\t} else {\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process ~ root2');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, 'root2');\n\t\t\t}\n\t\t});\n\t\ttest('should hide cwdFolder in single folder workspaces when cwd matches the workspace\\'s default cwd even when slashes differ', async () => {\n\t\t\tlet terminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_1 }));\n\t\t\tstrictEqual(terminalLabelComputer.title, 'process');\n\t\t\tstrictEqual(terminalLabelComputer.description, '');\n\t\t\tif (!isWindows) {\n\t\t\t\tterminalLabelComputer = createLabelComputer({ terminal: { integrated: { tabs: { separator: ' ~ ', title: '${process}${separator}${cwdFolder}', description: '${cwdFolder}' } } } });\n\t\t\t\tterminalLabelComputer.refreshLabel(createInstance({ capabilities, processName: 'process', workspaceFolder: { uri: URI.from({ scheme: Schemas.file, path: ROOT_1 }) } as IWorkspaceFolder, cwd: ROOT_2 }));\n\t\t\t\tstrictEqual(terminalLabelComputer.title, 'process ~ root2');\n\t\t\t\tstrictEqual(terminalLabelComputer.description, 'root2');\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('getCwdResource', () => {\n\t\tlet mockFileService: any;\n\t\tlet mockPathService: any;\n\n\t\tfunction createMockTerminalInstance(options: {\n\t\t\tcwd?: string;\n\t\t\tremoteAuthority?: string;\n\t\t\tfileExists?: boolean;\n\t\t}): Pick<ITerminalInstance, 'getCwdResource' | 'capabilities' | 'remoteAuthority'> {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\n\t\t\tif (options.cwd) {\n\t\t\t\tconst mockCwdDetection = {\n\t\t\t\t\tgetCwd: () => options.cwd\n\t\t\t\t};\n\t\t\t\tcapabilities.add(TerminalCapability.CwdDetection, mockCwdDetection as unknown as ICwdDetectionCapability);\n\t\t\t}\n\n\t\t\t// Mock file service\n\t\t\tmockFileService = {\n\t\t\t\texists: async (resource: URI) => options.fileExists !== false\n\t\t\t};\n\n\t\t\t// Mock path service\n\t\t\tmockPathService = {\n\t\t\t\tfileURI: async (path: string) => {\n\t\t\t\t\tif (options.remoteAuthority) {\n\t\t\t\t\t\treturn URI.parse(`vscode-remote://${options.remoteAuthority}${path}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn URI.file(path);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tcapabilities,\n\t\t\t\tremoteAuthority: options.remoteAuthority,\n\t\t\t\tasync getCwdResource(): Promise<URI | undefined> {\n\t\t\t\t\tconst cwd = this.capabilities.get(TerminalCapability.CwdDetection)?.getCwd();\n\t\t\t\t\tif (!cwd) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\tlet resource: URI;\n\t\t\t\t\tif (this.remoteAuthority) {\n\t\t\t\t\t\tresource = await mockPathService.fileURI(cwd);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresource = URI.file(cwd);\n\t\t\t\t\t}\n\t\t\t\t\tif (await mockFileService.exists(resource)) {\n\t\t\t\t\t\treturn resource;\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\ttest('should return undefined when no CwdDetection capability', async () => {\n\t\t\tconst instance = createMockTerminalInstance({});\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should return undefined when CwdDetection capability returns no cwd', async () => {\n\t\t\tconst instance = createMockTerminalInstance({ cwd: undefined });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should return URI.file for local terminal when file exists', async () => {\n\t\t\tconst testCwd = '/test/path';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: true });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'file');\n\t\t\tstrictEqual(result?.path, testCwd);\n\t\t});\n\n\t\ttest('should return undefined when file does not exist', async () => {\n\t\t\tconst testCwd = '/test/nonexistent';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: false });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\n\t\ttest('should use pathService.fileURI for remote terminal', async () => {\n\t\t\tconst testCwd = '/test/remote/path';\n\t\t\tconst instance = createMockTerminalInstance({\n\t\t\t\tcwd: testCwd,\n\t\t\t\tremoteAuthority: 'test-remote',\n\t\t\t\tfileExists: true\n\t\t\t});\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'vscode-remote');\n\t\t\tstrictEqual(result?.authority, 'test-remote');\n\t\t\tstrictEqual(result?.path, testCwd);\n\t\t});\n\n\t\ttest('should handle Windows paths correctly', async () => {\n\t\t\tconst testCwd = isWindows ? 'C:\\\\test\\\\path' : '/test/path';\n\t\t\tconst instance = createMockTerminalInstance({ cwd: testCwd, fileExists: true });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result?.scheme, 'file');\n\t\t\tif (isWindows) {\n\t\t\t\tstrictEqual(result?.path, '/C:/test/path');\n\t\t\t} else {\n\t\t\t\tstrictEqual(result?.path, testCwd);\n\t\t\t}\n\t\t});\n\n\t\ttest('should handle empty cwd string', async () => {\n\t\t\tconst instance = createMockTerminalInstance({ cwd: '' });\n\n\t\t\tconst result = await instance.getCwdResource();\n\t\t\tstrictEqual(result, undefined);\n\t\t});\n\t});\n});\n"]}