{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/test/node/terminalProfiles.test.ts","vs/workbench/contrib/terminal/test/node/terminalProfiles.test.ts"],"names":[],"mappings":"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","file":"terminalProfiles.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, fail, ok, strictEqual } from 'assert';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { ITerminalProfile, ProfileSource } from '../../../../../platform/terminal/common/terminal.js';\nimport { ITerminalConfiguration, ITerminalProfiles } from '../../common/terminal.js';\nimport { detectAvailableProfiles, IFsProvider } from '../../../../../platform/terminal/node/terminalProfiles.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\n/**\n * Assets that two profiles objects are equal, this will treat explicit undefined and unset\n * properties the same. Order of the profiles is ignored.\n */\nfunction profilesEqual(actualProfiles: ITerminalProfile[], expectedProfiles: ITerminalProfile[]) {\n\tstrictEqual(actualProfiles.length, expectedProfiles.length, `Actual: ${actualProfiles.map(e => e.profileName).join(',')}\\nExpected: ${expectedProfiles.map(e => e.profileName).join(',')}`);\n\tfor (const expected of expectedProfiles) {\n\t\tconst actual = actualProfiles.find(e => e.profileName === expected.profileName);\n\t\tok(actual, `Expected profile ${expected.profileName} not found`);\n\t\tstrictEqual(actual.profileName, expected.profileName);\n\t\tstrictEqual(actual.path, expected.path);\n\t\tdeepStrictEqual(actual.args, expected.args);\n\t\tstrictEqual(actual.isAutoDetected, expected.isAutoDetected);\n\t\tstrictEqual(actual.overrideName, expected.overrideName);\n\t}\n}\n\nsuite('Workbench - TerminalProfiles', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('detectAvailableProfiles', () => {\n\t\tif (isWindows) {\n\t\t\ttest('should detect Git Bash and provide login args', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe'\n\t\t\t\t]);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'Git Bash': { source: ProfileSource.GitBash }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {}\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected = [\n\t\t\t\t\t{ profileName: 'Git Bash', path: 'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe', args: ['--login', '-i'], isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should allow source to have args', async () => {\n\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe'\n\t\t\t\t];\n\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'PowerShell': { source: ProfileSource.Pwsh, args: ['-NoProfile'], overrideName: true }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {},\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\tconst expected = [\n\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', overrideName: true, args: ['-NoProfile'], isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('configured args should override default source ones', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe'\n\t\t\t\t]);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'Git Bash': { source: ProfileSource.GitBash, args: [] }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {}\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected = [{ profileName: 'Git Bash', path: 'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe', args: [], isAutoDetected: undefined, overrideName: undefined, isDefault: true }];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\tsuite('pwsh source detection/fallback', () => {\n\t\t\t\tconst pwshSourceConfig = ({\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'PowerShell': { source: ProfileSource.Pwsh }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {},\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\n\t\t\t\ttest('should prefer pwsh 7 to Windows PowerShell', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tconst expected = [\n\t\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', isDefault: true }\n\t\t\t\t\t];\n\t\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t\t});\n\t\t\t\ttest('should prefer pwsh 7 to pwsh 6', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\6\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tconst expected = [\n\t\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', isDefault: true }\n\t\t\t\t\t];\n\t\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t\t});\n\t\t\t\ttest('should fallback to Windows PowerShell', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Windows\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tstrictEqual(profiles.length, 1);\n\t\t\t\t\tstrictEqual(profiles[0].profileName, 'PowerShell');\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tconst absoluteConfig = ({\n\t\t\t\tprofiles: {\n\t\t\t\t\twindows: {},\n\t\t\t\t\tosx: {\n\t\t\t\t\t\t'fakeshell1': { path: '/bin/fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: '/bin/fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: '/bin/fakeshell3' }\n\t\t\t\t\t},\n\t\t\t\t\tlinux: {\n\t\t\t\t\t\t'fakeshell1': { path: '/bin/fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: '/bin/fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: '/bin/fakeshell3' }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuseWslProfiles: false\n\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\t\t\tconst onPathConfig = ({\n\t\t\t\tprofiles: {\n\t\t\t\t\twindows: {},\n\t\t\t\t\tosx: {\n\t\t\t\t\t\t'fakeshell1': { path: 'fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: 'fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: 'fakeshell3' }\n\t\t\t\t\t},\n\t\t\t\t\tlinux: {\n\t\t\t\t\t\t'fakeshell1': { path: 'fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: 'fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: 'fakeshell3' }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuseWslProfiles: false\n\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\n\t\t\ttest('should detect shells via absolute paths', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1',\n\t\t\t\t\t'/bin/fakeshell3'\n\t\t\t\t]);\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: absoluteConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isDefault: true },\n\t\t\t\t\t{ profileName: 'fakeshell3', path: '/bin/fakeshell3', isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should auto detect shells via /etc/shells', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1',\n\t\t\t\t\t'/bin/fakeshell3'\n\t\t\t\t], '/bin/fakeshell1\\n/bin/fakeshell3');\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: onPathConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, true, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isFromPath: true, isDefault: true },\n\t\t\t\t\t{ profileName: 'fakeshell3', path: '/bin/fakeshell3', isFromPath: true, isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should validate auto detected shells from /etc/shells exist', async () => {\n\t\t\t\t// fakeshell3 exists in /etc/shells but not on FS\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1'\n\t\t\t\t], '/bin/fakeshell1\\n/bin/fakeshell3');\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: onPathConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, true, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isFromPath: true, isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t}\n\t});\n\n\tfunction createFsProvider(expectedPaths: string[], etcShellsContent: string = ''): IFsProvider {\n\t\tconst provider = {\n\t\t\tasync existsFile(path: string): Promise<boolean> {\n\t\t\t\treturn expectedPaths.includes(path);\n\t\t\t},\n\t\t\tasync readFile(path: string): Promise<Buffer> {\n\t\t\t\tif (path !== '/etc/shells') {\n\t\t\t\t\tfail('Unexepected path');\n\t\t\t\t}\n\t\t\t\treturn Buffer.from(etcShellsContent);\n\t\t\t}\n\t\t};\n\t\treturn provider;\n\t}\n});\n\nexport interface ITestTerminalConfig {\n\tprofiles: ITerminalProfiles;\n\tuseWslProfiles: boolean;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { deepStrictEqual, fail, ok, strictEqual } from 'assert';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { ITerminalProfile, ProfileSource } from '../../../../../platform/terminal/common/terminal.js';\nimport { ITerminalConfiguration, ITerminalProfiles } from '../../common/terminal.js';\nimport { detectAvailableProfiles, IFsProvider } from '../../../../../platform/terminal/node/terminalProfiles.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\n\n/**\n * Assets that two profiles objects are equal, this will treat explicit undefined and unset\n * properties the same. Order of the profiles is ignored.\n */\nfunction profilesEqual(actualProfiles: ITerminalProfile[], expectedProfiles: ITerminalProfile[]) {\n\tstrictEqual(actualProfiles.length, expectedProfiles.length, `Actual: ${actualProfiles.map(e => e.profileName).join(',')}\\nExpected: ${expectedProfiles.map(e => e.profileName).join(',')}`);\n\tfor (const expected of expectedProfiles) {\n\t\tconst actual = actualProfiles.find(e => e.profileName === expected.profileName);\n\t\tok(actual, `Expected profile ${expected.profileName} not found`);\n\t\tstrictEqual(actual.profileName, expected.profileName);\n\t\tstrictEqual(actual.path, expected.path);\n\t\tdeepStrictEqual(actual.args, expected.args);\n\t\tstrictEqual(actual.isAutoDetected, expected.isAutoDetected);\n\t\tstrictEqual(actual.overrideName, expected.overrideName);\n\t}\n}\n\nsuite('Workbench - TerminalProfiles', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('detectAvailableProfiles', () => {\n\t\tif (isWindows) {\n\t\t\ttest('should detect Git Bash and provide login args', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe'\n\t\t\t\t]);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'Git Bash': { source: ProfileSource.GitBash }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {}\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected = [\n\t\t\t\t\t{ profileName: 'Git Bash', path: 'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe', args: ['--login', '-i'], isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should allow source to have args', async () => {\n\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe'\n\t\t\t\t];\n\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'PowerShell': { source: ProfileSource.Pwsh, args: ['-NoProfile'], overrideName: true }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {},\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\tconst expected = [\n\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', overrideName: true, args: ['-NoProfile'], isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('configured args should override default source ones', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe'\n\t\t\t\t]);\n\t\t\t\tconst config: ITestTerminalConfig = {\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'Git Bash': { source: ProfileSource.GitBash, args: [] }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {}\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t};\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: config } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected = [{ profileName: 'Git Bash', path: 'C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe', args: [], isAutoDetected: undefined, overrideName: undefined, isDefault: true }];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\tsuite('pwsh source detection/fallback', () => {\n\t\t\t\tconst pwshSourceConfig = ({\n\t\t\t\t\tprofiles: {\n\t\t\t\t\t\twindows: {\n\t\t\t\t\t\t\t'PowerShell': { source: ProfileSource.Pwsh }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlinux: {},\n\t\t\t\t\t\tosx: {},\n\t\t\t\t\t},\n\t\t\t\t\tuseWslProfiles: false\n\t\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\n\t\t\t\ttest('should prefer pwsh 7 to Windows PowerShell', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tconst expected = [\n\t\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', isDefault: true }\n\t\t\t\t\t];\n\t\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t\t});\n\t\t\t\ttest('should prefer pwsh 7 to pwsh 6', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Program Files\\\\PowerShell\\\\6\\\\pwsh.exe',\n\t\t\t\t\t\t'C:\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tconst expected = [\n\t\t\t\t\t\t{ profileName: 'PowerShell', path: 'C:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe', isDefault: true }\n\t\t\t\t\t];\n\t\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t\t});\n\t\t\t\ttest('should fallback to Windows PowerShell', async () => {\n\t\t\t\t\tconst pwshSourcePaths = [\n\t\t\t\t\t\t'C:\\\\Windows\\\\Sysnative\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe',\n\t\t\t\t\t\t'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\n\t\t\t\t\t];\n\t\t\t\t\tconst fsProvider = createFsProvider(pwshSourcePaths);\n\t\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: pwshSourceConfig } });\n\t\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, pwshSourcePaths);\n\t\t\t\t\tstrictEqual(profiles.length, 1);\n\t\t\t\t\tstrictEqual(profiles[0].profileName, 'PowerShell');\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tconst absoluteConfig = ({\n\t\t\t\tprofiles: {\n\t\t\t\t\twindows: {},\n\t\t\t\t\tosx: {\n\t\t\t\t\t\t'fakeshell1': { path: '/bin/fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: '/bin/fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: '/bin/fakeshell3' }\n\t\t\t\t\t},\n\t\t\t\t\tlinux: {\n\t\t\t\t\t\t'fakeshell1': { path: '/bin/fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: '/bin/fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: '/bin/fakeshell3' }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuseWslProfiles: false\n\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\t\t\tconst onPathConfig = ({\n\t\t\t\tprofiles: {\n\t\t\t\t\twindows: {},\n\t\t\t\t\tosx: {\n\t\t\t\t\t\t'fakeshell1': { path: 'fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: 'fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: 'fakeshell3' }\n\t\t\t\t\t},\n\t\t\t\t\tlinux: {\n\t\t\t\t\t\t'fakeshell1': { path: 'fakeshell1' },\n\t\t\t\t\t\t'fakeshell2': { path: 'fakeshell2' },\n\t\t\t\t\t\t'fakeshell3': { path: 'fakeshell3' }\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuseWslProfiles: false\n\t\t\t} as ITestTerminalConfig) as ITerminalConfiguration;\n\n\t\t\ttest('should detect shells via absolute paths', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1',\n\t\t\t\t\t'/bin/fakeshell3'\n\t\t\t\t]);\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: absoluteConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, false, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isDefault: true },\n\t\t\t\t\t{ profileName: 'fakeshell3', path: '/bin/fakeshell3', isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should auto detect shells via /etc/shells', async () => {\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1',\n\t\t\t\t\t'/bin/fakeshell3'\n\t\t\t\t], '/bin/fakeshell1\\n/bin/fakeshell3');\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: onPathConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, true, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isFromPath: true, isDefault: true },\n\t\t\t\t\t{ profileName: 'fakeshell3', path: '/bin/fakeshell3', isFromPath: true, isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t\ttest('should validate auto detected shells from /etc/shells exist', async () => {\n\t\t\t\t// fakeshell3 exists in /etc/shells but not on FS\n\t\t\t\tconst fsProvider = createFsProvider([\n\t\t\t\t\t'/bin/fakeshell1'\n\t\t\t\t], '/bin/fakeshell1\\n/bin/fakeshell3');\n\t\t\t\tconst configurationService = new TestConfigurationService({ terminal: { integrated: onPathConfig } });\n\t\t\t\tconst profiles = await detectAvailableProfiles(undefined, undefined, true, configurationService, process.env, fsProvider, undefined, undefined, undefined);\n\t\t\t\tconst expected: ITerminalProfile[] = [\n\t\t\t\t\t{ profileName: 'fakeshell1', path: '/bin/fakeshell1', isFromPath: true, isDefault: true }\n\t\t\t\t];\n\t\t\t\tprofilesEqual(profiles, expected);\n\t\t\t});\n\t\t}\n\t});\n\n\tfunction createFsProvider(expectedPaths: string[], etcShellsContent: string = ''): IFsProvider {\n\t\tconst provider = {\n\t\t\tasync existsFile(path: string): Promise<boolean> {\n\t\t\t\treturn expectedPaths.includes(path);\n\t\t\t},\n\t\t\tasync readFile(path: string): Promise<Buffer> {\n\t\t\t\tif (path !== '/etc/shells') {\n\t\t\t\t\tfail('Unexepected path');\n\t\t\t\t}\n\t\t\t\treturn Buffer.from(etcShellsContent);\n\t\t\t}\n\t\t};\n\t\treturn provider;\n\t}\n});\n\nexport interface ITestTerminalConfig {\n\tprofiles: ITerminalProfiles;\n\tuseWslProfiles: boolean;\n}\n"]}