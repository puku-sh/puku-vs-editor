{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/test/browser/terminalEvents.test.ts","vs/workbench/contrib/terminal/test/browser/terminalEvents.test.ts"],"names":[],"mappings":"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","file":"terminalEvents.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ICwdDetectionCapability, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalCapabilityStore } from '../../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { createInstanceCapabilityEventMultiplexer } from '../../browser/terminalEvents.js';\nimport { ITerminalInstance } from '../../browser/terminal.js';\n\n// Mock implementations for testing\nclass MockCwdDetectionCapability implements ICwdDetectionCapability {\n\treadonly type = TerminalCapability.CwdDetection;\n\treadonly cwds: string[] = [];\n\n\tprivate readonly _onDidChangeCwd = new Emitter<string>();\n\treadonly onDidChangeCwd = this._onDidChangeCwd.event;\n\n\tgetCwd(): string {\n\t\treturn this.cwds[this.cwds.length - 1] || '';\n\t}\n\n\tupdateCwd(cwd: string): void {\n\t\tthis.cwds.push(cwd);\n\t\tthis._onDidChangeCwd.fire(cwd);\n\t}\n\n\tfireEvent(cwd: string): void {\n\t\tthis.updateCwd(cwd);\n\t}\n\n\tdispose(): void {\n\t\tthis._onDidChangeCwd.dispose();\n\t}\n}\n\n\n\nfunction createMockTerminalInstance(instanceId: number, capabilities: TerminalCapabilityStore): ITerminalInstance {\n\tconst instance = {\n\t\tinstanceId,\n\t\tcapabilities\n\t} as unknown as ITerminalInstance;\n\treturn instance;\n}\n\nsuite('Terminal Events', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('createInstanceCapabilityEventMultiplexer', () => {\n\t\ttest('should handle existing instances with capabilities', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(1, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\tcapability.fireEvent('test-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct instance');\n\t\t\tstrictEqual(capturedData?.data, 'test-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle instances without capabilities', () => {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(1, capabilities);\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventFired = true;\n\t\t\t}));\n\n\t\t\tstrictEqual(eventFired, false, 'No event should be fired for instances without capabilities');\n\t\t});\n\n\t\ttest('should handle adding new instances', () => {\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\t// Add a new instance with capability\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(2, capabilities);\n\n\t\t\tonAddInstance.fire(instance);\n\n\t\t\t// Add capability to the instance after it's added to the multiplexer\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\n\t\t\t// Fire an event from the capability\n\t\t\tcapability.fireEvent('new-instance-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired from new instance');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct new instance');\n\t\t\tstrictEqual(capturedData?.data, 'new-instance-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle removing instances', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(3, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before removal\n\t\t\tcapability.fireEvent('before-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before removal');\n\n\t\t\t// Remove the instance\n\t\t\tonRemoveInstance.fire(instance);\n\n\t\t\t// Fire event after removal - should not be received\n\t\t\tcapability.fireEvent('after-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after instance removal');\n\t\t});\n\n\t\ttest('should handle adding capabilities to existing instances', () => {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(4, capabilities);\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\t// Add capability to existing instance\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\n\t\t\t// Fire an event from the newly added capability\n\t\t\tcapability.fireEvent('added-capability-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired from newly added capability');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct instance');\n\t\t\tstrictEqual(capturedData?.data, 'added-capability-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle removing capabilities from existing instances', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(5, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before removing capability\n\t\t\tcapability.fireEvent('before-capability-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before capability removal');\n\n\t\t\t// Remove the capability\n\t\t\tcapabilities.remove(TerminalCapability.CwdDetection);\t\t\t// Fire event after capability removal - should not be received\n\t\t\tcapability.fireEvent('after-capability-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after capability removal');\n\t\t});\n\n\t\ttest('should handle multiple instances with same capability', () => {\n\t\t\tconst capability1 = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capability2 = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities1 = store.add(new TerminalCapabilityStore());\n\t\t\tconst capabilities2 = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities1.add(TerminalCapability.CwdDetection, capability1);\n\t\t\tcapabilities2.add(TerminalCapability.CwdDetection, capability2);\n\t\t\tconst instance1 = createMockTerminalInstance(6, capabilities1);\n\t\t\tconst instance2 = createMockTerminalInstance(7, capabilities2);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance1, instance2],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tconst events: Array<{ instance: ITerminalInstance; data: string }> = [];\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\tevents.push(e);\n\t\t\t}));\n\n\t\t\t// Fire events from both capabilities\n\t\t\tcapability1.fireEvent('data-from-instance1');\n\t\t\tcapability2.fireEvent('data-from-instance2');\n\n\t\t\tstrictEqual(events.length, 2, 'Both events should be received');\n\t\t\tstrictEqual(events[0].instance, instance1, 'First event should be from instance1');\n\t\t\tstrictEqual(events[0].data, 'data-from-instance1', 'First event should have correct data');\n\t\t\tstrictEqual(events[1].instance, instance2, 'Second event should be from instance2');\n\t\t\tstrictEqual(events[1].data, 'data-from-instance2', 'Second event should have correct data');\n\t\t});\n\n\t\ttest('should properly dispose all resources', () => {\n\t\t\tconst testStore = new DisposableStore();\n\t\t\tconst capability = testStore.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = testStore.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(8, capabilities);\n\n\t\t\tconst onAddInstance = testStore.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = testStore.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = testStore.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\ttestStore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before disposal\n\t\t\tcapability.fireEvent('before-disposal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before disposal');\n\n\t\t\t// Dispose everything\n\t\t\ttestStore.dispose();\n\n\t\t\t// Fire event after disposal - should not be received\n\t\t\tcapability.fireEvent('after-disposal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after disposal');\n\t\t});\n\n\t\ttest('should handle empty current instances array', () => {\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventFired = true;\n\t\t\t}));\n\n\t\t\t// No instances, so no events should be fired initially\n\t\t\tstrictEqual(eventFired, false, 'No events should be fired with empty instances array');\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ICwdDetectionCapability, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalCapabilityStore } from '../../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { createInstanceCapabilityEventMultiplexer } from '../../browser/terminalEvents.js';\nimport { ITerminalInstance } from '../../browser/terminal.js';\n\n// Mock implementations for testing\nclass MockCwdDetectionCapability implements ICwdDetectionCapability {\n\treadonly type = TerminalCapability.CwdDetection;\n\treadonly cwds: string[] = [];\n\n\tprivate readonly _onDidChangeCwd = new Emitter<string>();\n\treadonly onDidChangeCwd = this._onDidChangeCwd.event;\n\n\tgetCwd(): string {\n\t\treturn this.cwds[this.cwds.length - 1] || '';\n\t}\n\n\tupdateCwd(cwd: string): void {\n\t\tthis.cwds.push(cwd);\n\t\tthis._onDidChangeCwd.fire(cwd);\n\t}\n\n\tfireEvent(cwd: string): void {\n\t\tthis.updateCwd(cwd);\n\t}\n\n\tdispose(): void {\n\t\tthis._onDidChangeCwd.dispose();\n\t}\n}\n\n\n\nfunction createMockTerminalInstance(instanceId: number, capabilities: TerminalCapabilityStore): ITerminalInstance {\n\tconst instance = {\n\t\tinstanceId,\n\t\tcapabilities\n\t} as unknown as ITerminalInstance;\n\treturn instance;\n}\n\nsuite('Terminal Events', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('createInstanceCapabilityEventMultiplexer', () => {\n\t\ttest('should handle existing instances with capabilities', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(1, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\tcapability.fireEvent('test-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct instance');\n\t\t\tstrictEqual(capturedData?.data, 'test-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle instances without capabilities', () => {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(1, capabilities);\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventFired = true;\n\t\t\t}));\n\n\t\t\tstrictEqual(eventFired, false, 'No event should be fired for instances without capabilities');\n\t\t});\n\n\t\ttest('should handle adding new instances', () => {\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\t// Add a new instance with capability\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(2, capabilities);\n\n\t\t\tonAddInstance.fire(instance);\n\n\t\t\t// Add capability to the instance after it's added to the multiplexer\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\n\t\t\t// Fire an event from the capability\n\t\t\tcapability.fireEvent('new-instance-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired from new instance');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct new instance');\n\t\t\tstrictEqual(capturedData?.data, 'new-instance-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle removing instances', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(3, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before removal\n\t\t\tcapability.fireEvent('before-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before removal');\n\n\t\t\t// Remove the instance\n\t\t\tonRemoveInstance.fire(instance);\n\n\t\t\t// Fire event after removal - should not be received\n\t\t\tcapability.fireEvent('after-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after instance removal');\n\t\t});\n\n\t\ttest('should handle adding capabilities to existing instances', () => {\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tconst instance = createMockTerminalInstance(4, capabilities);\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tlet capturedData: { instance: ITerminalInstance; data: string } | undefined;\n\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\teventFired = true;\n\t\t\t\tcapturedData = e;\n\t\t\t}));\n\n\t\t\t// Add capability to existing instance\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\n\t\t\t// Fire an event from the newly added capability\n\t\t\tcapability.fireEvent('added-capability-data');\n\n\t\t\tstrictEqual(eventFired, true, 'Event should be fired from newly added capability');\n\t\t\tstrictEqual(capturedData?.instance, instance, 'Event should contain correct instance');\n\t\t\tstrictEqual(capturedData?.data, 'added-capability-data', 'Event should contain correct data');\n\t\t});\n\n\t\ttest('should handle removing capabilities from existing instances', () => {\n\t\t\tconst capability = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(5, capabilities);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before removing capability\n\t\t\tcapability.fireEvent('before-capability-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before capability removal');\n\n\t\t\t// Remove the capability\n\t\t\tcapabilities.remove(TerminalCapability.CwdDetection);\t\t\t// Fire event after capability removal - should not be received\n\t\t\tcapability.fireEvent('after-capability-removal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after capability removal');\n\t\t});\n\n\t\ttest('should handle multiple instances with same capability', () => {\n\t\t\tconst capability1 = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capability2 = store.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities1 = store.add(new TerminalCapabilityStore());\n\t\t\tconst capabilities2 = store.add(new TerminalCapabilityStore());\n\t\t\tcapabilities1.add(TerminalCapability.CwdDetection, capability1);\n\t\t\tcapabilities2.add(TerminalCapability.CwdDetection, capability2);\n\t\t\tconst instance1 = createMockTerminalInstance(6, capabilities1);\n\t\t\tconst instance2 = createMockTerminalInstance(7, capabilities2);\n\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance1, instance2],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tconst events: Array<{ instance: ITerminalInstance; data: string }> = [];\n\t\t\tstore.add(multiplexer.event(e => {\n\t\t\t\tevents.push(e);\n\t\t\t}));\n\n\t\t\t// Fire events from both capabilities\n\t\t\tcapability1.fireEvent('data-from-instance1');\n\t\t\tcapability2.fireEvent('data-from-instance2');\n\n\t\t\tstrictEqual(events.length, 2, 'Both events should be received');\n\t\t\tstrictEqual(events[0].instance, instance1, 'First event should be from instance1');\n\t\t\tstrictEqual(events[0].data, 'data-from-instance1', 'First event should have correct data');\n\t\t\tstrictEqual(events[1].instance, instance2, 'Second event should be from instance2');\n\t\t\tstrictEqual(events[1].data, 'data-from-instance2', 'Second event should have correct data');\n\t\t});\n\n\t\ttest('should properly dispose all resources', () => {\n\t\t\tconst testStore = new DisposableStore();\n\t\t\tconst capability = testStore.add(new MockCwdDetectionCapability());\n\t\t\tconst capabilities = testStore.add(new TerminalCapabilityStore());\n\t\t\tcapabilities.add(TerminalCapability.CwdDetection, capability);\n\t\t\tconst instance = createMockTerminalInstance(8, capabilities);\n\n\t\t\tconst onAddInstance = testStore.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = testStore.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = testStore.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[instance],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventCount = 0;\n\t\t\ttestStore.add(multiplexer.event(() => {\n\t\t\t\teventCount++;\n\t\t\t}));\n\n\t\t\t// Fire event before disposal\n\t\t\tcapability.fireEvent('before-disposal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should be fired before disposal');\n\n\t\t\t// Dispose everything\n\t\t\ttestStore.dispose();\n\n\t\t\t// Fire event after disposal - should not be received\n\t\t\tcapability.fireEvent('after-disposal');\n\t\t\tstrictEqual(eventCount, 1, 'Event should not be fired after disposal');\n\t\t});\n\n\t\ttest('should handle empty current instances array', () => {\n\t\t\tconst onAddInstance = store.add(new Emitter<ITerminalInstance>());\n\t\t\tconst onRemoveInstance = store.add(new Emitter<ITerminalInstance>());\n\n\t\t\tconst multiplexer = store.add(createInstanceCapabilityEventMultiplexer(\n\t\t\t\t[],\n\t\t\t\tonAddInstance.event,\n\t\t\t\tonRemoveInstance.event,\n\t\t\t\tTerminalCapability.CwdDetection,\n\t\t\t\t(cap) => cap.onDidChangeCwd\n\t\t\t));\n\n\t\t\tlet eventFired = false;\n\t\t\tstore.add(multiplexer.event(() => {\n\t\t\t\teventFired = true;\n\t\t\t}));\n\n\t\t\t// No instances, so no events should be fired initially\n\t\t\tstrictEqual(eventFired, false, 'No events should be fired with empty instances array');\n\t\t});\n\t});\n});\n"]}