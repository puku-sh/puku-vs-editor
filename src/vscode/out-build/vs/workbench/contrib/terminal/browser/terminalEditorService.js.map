{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/terminalEditorService.ts","vs/workbench/contrib/terminal/browser/terminalEditorService.ts"],"names":[],"mappings":"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","file":"terminalEditorService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, dispose, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorActivation } from '../../../../platform/editor/common/editor.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IShellLaunchConfig, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IEditorPane } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { IDeserializedTerminalEditorInput, ITerminalEditorService, ITerminalInstance, ITerminalInstanceService, TerminalEditorLocation } from './terminal.js';\nimport { TerminalEditorInput } from './terminalEditorInput.js';\nimport { getInstanceFromResource } from './terminalUri.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { IEditorService, ACTIVE_GROUP, SIDE_GROUP } from '../../../services/editor/common/editorService.js';\nimport { ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\n\nexport class TerminalEditorService extends Disposable implements ITerminalEditorService {\n\tdeclare _serviceBrand: undefined;\n\n\tinstances: ITerminalInstance[] = [];\n\tprivate _activeInstanceIndex: number = -1;\n\tprivate _isShuttingDown = false;\n\tprivate _activeOpenEditorRequest?: { instanceId: number; promise: Promise<IEditorPane | undefined> };\n\n\tprivate _terminalEditorActive: IContextKey<boolean>;\n\n\tprivate _editorInputs: Map</*resource*/string, TerminalEditorInput> = new Map();\n\tprivate _instanceDisposables: Map</*resource*/string, IDisposable[]> = new Map();\n\n\tprivate readonly _onDidDisposeInstance = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidDisposeInstance = this._onDidDisposeInstance.event;\n\tprivate readonly _onDidFocusInstance = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidFocusInstance = this._onDidFocusInstance.event;\n\tprivate readonly _onDidChangeInstanceCapability = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidChangeInstanceCapability = this._onDidChangeInstanceCapability.event;\n\tprivate readonly _onDidChangeActiveInstance = this._register(new Emitter<ITerminalInstance | undefined>());\n\treadonly onDidChangeActiveInstance = this._onDidChangeActiveInstance.event;\n\tprivate readonly _onDidChangeInstances = this._register(new Emitter<void>());\n\treadonly onDidChangeInstances = this._onDidChangeInstances.event;\n\n\tconstructor(\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly _editorGroupsService: IEditorGroupsService,\n\t\t@ITerminalInstanceService private readonly _terminalInstanceService: ITerminalInstanceService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\t\tthis._terminalEditorActive = TerminalContextKeys.terminalEditorActive.bindTo(contextKeyService);\n\t\tthis._register(toDisposable(() => {\n\t\t\tfor (const d of this._instanceDisposables.values()) {\n\t\t\t\tdispose(d);\n\t\t\t}\n\t\t}));\n\t\tthis._register(lifecycleService.onWillShutdown(() => this._isShuttingDown = true));\n\t\tthis._register(this._editorService.onDidActiveEditorChange(() => {\n\t\t\tconst activeEditor = this._editorService.activeEditor;\n\t\t\tconst instance = activeEditor instanceof TerminalEditorInput ? activeEditor?.terminalInstance : undefined;\n\t\t\tconst terminalEditorActive = !!instance && activeEditor instanceof TerminalEditorInput;\n\t\t\tthis._terminalEditorActive.set(terminalEditorActive);\n\t\t\tif (terminalEditorActive) {\n\t\t\t\tactiveEditor?.setGroup(this._editorService.activeEditorPane?.group);\n\t\t\t\tthis.setActiveInstance(instance);\n\t\t\t} else {\n\t\t\t\tfor (const instance of this.instances) {\n\t\t\t\t\tinstance.resetFocusContextKey();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editorService.onDidVisibleEditorsChange(() => {\n\t\t\t// add any terminal editors created via the editor service split command\n\t\t\tconst knownIds = this.instances.map(i => i.instanceId);\n\t\t\tconst terminalEditors = this._getActiveTerminalEditors();\n\t\t\tconst unknownEditor = terminalEditors.find(input => {\n\t\t\t\tconst inputId = input instanceof TerminalEditorInput ? input.terminalInstance?.instanceId : undefined;\n\t\t\t\tif (inputId === undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !knownIds.includes(inputId);\n\t\t\t});\n\t\t\tif (unknownEditor instanceof TerminalEditorInput && unknownEditor.terminalInstance) {\n\t\t\t\tthis._editorInputs.set(unknownEditor.terminalInstance.resource.path, unknownEditor);\n\t\t\t\tthis.instances.push(unknownEditor.terminalInstance);\n\t\t\t}\n\t\t}));\n\n\t\t// Remove the terminal from the managed instances when the editor closes. This fires when\n\t\t// dragging and dropping to another editor or closing the editor via cmd/ctrl+w.\n\t\tthis._register(this._editorService.onDidCloseEditor(e => {\n\t\t\tconst instance = e.editor instanceof TerminalEditorInput ? e.editor.terminalInstance : undefined;\n\t\t\tif (instance) {\n\t\t\t\tconst instanceIndex = this.instances.findIndex(e => e === instance);\n\t\t\t\tif (instanceIndex !== -1) {\n\t\t\t\t\tconst wasActiveInstance = this.instances[instanceIndex] === this.activeInstance;\n\t\t\t\t\tthis._removeInstance(instance);\n\t\t\t\t\tif (wasActiveInstance) {\n\t\t\t\t\t\tthis.setActiveInstance(undefined);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _getActiveTerminalEditors(): EditorInput[] {\n\t\treturn this._editorService.visibleEditors.filter(e => e instanceof TerminalEditorInput && e.terminalInstance?.instanceId);\n\t}\n\n\tget activeInstance(): ITerminalInstance | undefined {\n\t\tif (this.instances.length === 0 || this._activeInstanceIndex === -1) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.instances[this._activeInstanceIndex];\n\t}\n\n\tsetActiveInstance(instance: ITerminalInstance | undefined): void {\n\t\tthis._activeInstanceIndex = instance ? this.instances.findIndex(e => e === instance) : -1;\n\t\tthis._onDidChangeActiveInstance.fire(this.activeInstance);\n\t}\n\n\tasync focusInstance(instance: ITerminalInstance): Promise<void> {\n\t\treturn instance.focusWhenReady(true);\n\t}\n\n\tasync focusActiveInstance(): Promise<void> {\n\t\treturn this.activeInstance?.focusWhenReady(true);\n\t}\n\n\tasync openEditor(instance: ITerminalInstance, editorOptions?: TerminalEditorLocation): Promise<void> {\n\t\tconst resource = this.resolveResource(instance);\n\t\tif (resource) {\n\t\t\tawait this._activeOpenEditorRequest?.promise;\n\t\t\tthis._activeOpenEditorRequest = {\n\t\t\t\tinstanceId: instance.instanceId,\n\t\t\t\tpromise: this._editorService.openEditor({\n\t\t\t\t\tresource,\n\t\t\t\t\tdescription: instance.description || instance.shellLaunchConfig.type,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpinned: true,\n\t\t\t\t\t\tforceReload: true,\n\t\t\t\t\t\tpreserveFocus: editorOptions?.preserveFocus,\n\t\t\t\t\t\tauxiliary: editorOptions?.auxiliary,\n\t\t\t\t\t}\n\t\t\t\t}, editorOptions?.viewColumn ?? ACTIVE_GROUP)\n\t\t\t};\n\t\t\tawait this._activeOpenEditorRequest?.promise;\n\t\t\tthis._activeOpenEditorRequest = undefined;\n\t\t}\n\t}\n\n\tresolveResource(instance: ITerminalInstance): URI {\n\t\tconst resource = instance.resource;\n\t\tconst inputKey = resource.path;\n\t\tconst cachedEditor = this._editorInputs.get(inputKey);\n\n\t\tif (cachedEditor) {\n\t\t\treturn cachedEditor.resource;\n\t\t}\n\n\t\tinstance.target = TerminalLocation.Editor;\n\t\tconst input = this._instantiationService.createInstance(TerminalEditorInput, resource, instance);\n\t\tthis._registerInstance(inputKey, input, instance);\n\t\treturn input.resource;\n\t}\n\n\tgetInputFromResource(resource: URI): TerminalEditorInput {\n\t\tconst input = this._editorInputs.get(resource.path);\n\t\tif (!input) {\n\t\t\tthrow new Error(`Could not get input from resource: ${resource.path}`);\n\t\t}\n\t\treturn input;\n\t}\n\n\tprivate _registerInstance(inputKey: string, input: TerminalEditorInput, instance: ITerminalInstance): void {\n\t\tthis._editorInputs.set(inputKey, input);\n\t\tthis._instanceDisposables.set(inputKey, [\n\t\t\tinstance.onDidFocus(this._onDidFocusInstance.fire, this._onDidFocusInstance),\n\t\t\tinstance.onDisposed(this._onDidDisposeInstance.fire, this._onDidDisposeInstance),\n\t\t\tinstance.capabilities.onDidChangeCapabilities(() => this._onDidChangeInstanceCapability.fire(instance)),\n\t\t]);\n\t\tthis.instances.push(instance);\n\t\tthis._onDidChangeInstances.fire();\n\t}\n\n\tprivate _removeInstance(instance: ITerminalInstance) {\n\t\tconst inputKey = instance.resource.path;\n\t\tthis._editorInputs.delete(inputKey);\n\t\tconst instanceIndex = this.instances.findIndex(e => e === instance);\n\t\tif (instanceIndex !== -1) {\n\t\t\tthis.instances.splice(instanceIndex, 1);\n\t\t}\n\t\tconst disposables = this._instanceDisposables.get(inputKey);\n\t\tthis._instanceDisposables.delete(inputKey);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t}\n\t\tthis._onDidChangeInstances.fire();\n\t}\n\n\tgetInstanceFromResource(resource?: URI): ITerminalInstance | undefined {\n\t\treturn getInstanceFromResource(this.instances, resource);\n\t}\n\n\tsplitInstance(instanceToSplit: ITerminalInstance, shellLaunchConfig: IShellLaunchConfig = {}): ITerminalInstance {\n\t\tif (instanceToSplit.target === TerminalLocation.Editor) {\n\t\t\t// Make sure the instance to split's group is active\n\t\t\tconst group = this._editorInputs.get(instanceToSplit.resource.path)?.group;\n\t\t\tif (group) {\n\t\t\t\tthis._editorGroupsService.activateGroup(group);\n\t\t\t}\n\t\t}\n\t\tconst instance = this._terminalInstanceService.createInstance(shellLaunchConfig, TerminalLocation.Editor);\n\t\tconst resource = this.resolveResource(instance);\n\t\tif (resource) {\n\t\t\tthis._editorService.openEditor({\n\t\t\t\tresource: URI.revive(resource),\n\t\t\t\tdescription: instance.description,\n\t\t\t\toptions: {\n\t\t\t\t\tpinned: true,\n\t\t\t\t\tforceReload: true\n\t\t\t\t}\n\t\t\t}, SIDE_GROUP);\n\t\t}\n\t\treturn instance;\n\t}\n\n\treviveInput(deserializedInput: IDeserializedTerminalEditorInput): EditorInput {\n\t\tconst newDeserializedInput = { ...deserializedInput, findRevivedId: true };\n\t\tconst instance = this._terminalInstanceService.createInstance({ attachPersistentProcess: newDeserializedInput }, TerminalLocation.Editor);\n\t\tconst input = this._instantiationService.createInstance(TerminalEditorInput, instance.resource, instance);\n\t\tthis._registerInstance(instance.resource.path, input, instance);\n\t\treturn input;\n\t}\n\n\tdetachInstance(instance: ITerminalInstance) {\n\t\tconst inputKey = instance.resource.path;\n\t\tconst editorInput = this._editorInputs.get(inputKey);\n\t\teditorInput?.detachInstance();\n\t\tthis._removeInstance(instance);\n\t\t// Don't dispose the input when shutting down to avoid layouts in the editor area\n\t\tif (!this._isShuttingDown) {\n\t\t\teditorInput?.dispose();\n\t\t}\n\t}\n\n\tasync revealActiveEditor(preserveFocus?: boolean): Promise<void> {\n\t\tconst instance = this.activeInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there is an active openEditor call for this instance it will be revealed by that\n\t\tif (this._activeOpenEditorRequest?.instanceId === instance.instanceId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editorInput = this._editorInputs.get(instance.resource.path)!;\n\t\tthis._editorService.openEditor(\n\t\t\teditorInput,\n\t\t\t{\n\t\t\t\tpinned: true,\n\t\t\t\tforceReload: true,\n\t\t\t\tpreserveFocus,\n\t\t\t\tactivation: EditorActivation.PRESERVE\n\t\t\t}\n\t\t);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, dispose, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorActivation } from '../../../../platform/editor/common/editor.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IShellLaunchConfig, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IEditorPane } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { IDeserializedTerminalEditorInput, ITerminalEditorService, ITerminalInstance, ITerminalInstanceService, TerminalEditorLocation } from './terminal.js';\nimport { TerminalEditorInput } from './terminalEditorInput.js';\nimport { getInstanceFromResource } from './terminalUri.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { IEditorService, ACTIVE_GROUP, SIDE_GROUP } from '../../../services/editor/common/editorService.js';\nimport { ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\n\nexport class TerminalEditorService extends Disposable implements ITerminalEditorService {\n\tdeclare _serviceBrand: undefined;\n\n\tinstances: ITerminalInstance[] = [];\n\tprivate _activeInstanceIndex: number = -1;\n\tprivate _isShuttingDown = false;\n\tprivate _activeOpenEditorRequest?: { instanceId: number; promise: Promise<IEditorPane | undefined> };\n\n\tprivate _terminalEditorActive: IContextKey<boolean>;\n\n\tprivate _editorInputs: Map</*resource*/string, TerminalEditorInput> = new Map();\n\tprivate _instanceDisposables: Map</*resource*/string, IDisposable[]> = new Map();\n\n\tprivate readonly _onDidDisposeInstance = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidDisposeInstance = this._onDidDisposeInstance.event;\n\tprivate readonly _onDidFocusInstance = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidFocusInstance = this._onDidFocusInstance.event;\n\tprivate readonly _onDidChangeInstanceCapability = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidChangeInstanceCapability = this._onDidChangeInstanceCapability.event;\n\tprivate readonly _onDidChangeActiveInstance = this._register(new Emitter<ITerminalInstance | undefined>());\n\treadonly onDidChangeActiveInstance = this._onDidChangeActiveInstance.event;\n\tprivate readonly _onDidChangeInstances = this._register(new Emitter<void>());\n\treadonly onDidChangeInstances = this._onDidChangeInstances.event;\n\n\tconstructor(\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly _editorGroupsService: IEditorGroupsService,\n\t\t@ITerminalInstanceService private readonly _terminalInstanceService: ITerminalInstanceService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\t\tthis._terminalEditorActive = TerminalContextKeys.terminalEditorActive.bindTo(contextKeyService);\n\t\tthis._register(toDisposable(() => {\n\t\t\tfor (const d of this._instanceDisposables.values()) {\n\t\t\t\tdispose(d);\n\t\t\t}\n\t\t}));\n\t\tthis._register(lifecycleService.onWillShutdown(() => this._isShuttingDown = true));\n\t\tthis._register(this._editorService.onDidActiveEditorChange(() => {\n\t\t\tconst activeEditor = this._editorService.activeEditor;\n\t\t\tconst instance = activeEditor instanceof TerminalEditorInput ? activeEditor?.terminalInstance : undefined;\n\t\t\tconst terminalEditorActive = !!instance && activeEditor instanceof TerminalEditorInput;\n\t\t\tthis._terminalEditorActive.set(terminalEditorActive);\n\t\t\tif (terminalEditorActive) {\n\t\t\t\tactiveEditor?.setGroup(this._editorService.activeEditorPane?.group);\n\t\t\t\tthis.setActiveInstance(instance);\n\t\t\t} else {\n\t\t\t\tfor (const instance of this.instances) {\n\t\t\t\t\tinstance.resetFocusContextKey();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editorService.onDidVisibleEditorsChange(() => {\n\t\t\t// add any terminal editors created via the editor service split command\n\t\t\tconst knownIds = this.instances.map(i => i.instanceId);\n\t\t\tconst terminalEditors = this._getActiveTerminalEditors();\n\t\t\tconst unknownEditor = terminalEditors.find(input => {\n\t\t\t\tconst inputId = input instanceof TerminalEditorInput ? input.terminalInstance?.instanceId : undefined;\n\t\t\t\tif (inputId === undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !knownIds.includes(inputId);\n\t\t\t});\n\t\t\tif (unknownEditor instanceof TerminalEditorInput && unknownEditor.terminalInstance) {\n\t\t\t\tthis._editorInputs.set(unknownEditor.terminalInstance.resource.path, unknownEditor);\n\t\t\t\tthis.instances.push(unknownEditor.terminalInstance);\n\t\t\t}\n\t\t}));\n\n\t\t// Remove the terminal from the managed instances when the editor closes. This fires when\n\t\t// dragging and dropping to another editor or closing the editor via cmd/ctrl+w.\n\t\tthis._register(this._editorService.onDidCloseEditor(e => {\n\t\t\tconst instance = e.editor instanceof TerminalEditorInput ? e.editor.terminalInstance : undefined;\n\t\t\tif (instance) {\n\t\t\t\tconst instanceIndex = this.instances.findIndex(e => e === instance);\n\t\t\t\tif (instanceIndex !== -1) {\n\t\t\t\t\tconst wasActiveInstance = this.instances[instanceIndex] === this.activeInstance;\n\t\t\t\t\tthis._removeInstance(instance);\n\t\t\t\t\tif (wasActiveInstance) {\n\t\t\t\t\t\tthis.setActiveInstance(undefined);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _getActiveTerminalEditors(): EditorInput[] {\n\t\treturn this._editorService.visibleEditors.filter(e => e instanceof TerminalEditorInput && e.terminalInstance?.instanceId);\n\t}\n\n\tget activeInstance(): ITerminalInstance | undefined {\n\t\tif (this.instances.length === 0 || this._activeInstanceIndex === -1) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.instances[this._activeInstanceIndex];\n\t}\n\n\tsetActiveInstance(instance: ITerminalInstance | undefined): void {\n\t\tthis._activeInstanceIndex = instance ? this.instances.findIndex(e => e === instance) : -1;\n\t\tthis._onDidChangeActiveInstance.fire(this.activeInstance);\n\t}\n\n\tasync focusInstance(instance: ITerminalInstance): Promise<void> {\n\t\treturn instance.focusWhenReady(true);\n\t}\n\n\tasync focusActiveInstance(): Promise<void> {\n\t\treturn this.activeInstance?.focusWhenReady(true);\n\t}\n\n\tasync openEditor(instance: ITerminalInstance, editorOptions?: TerminalEditorLocation): Promise<void> {\n\t\tconst resource = this.resolveResource(instance);\n\t\tif (resource) {\n\t\t\tawait this._activeOpenEditorRequest?.promise;\n\t\t\tthis._activeOpenEditorRequest = {\n\t\t\t\tinstanceId: instance.instanceId,\n\t\t\t\tpromise: this._editorService.openEditor({\n\t\t\t\t\tresource,\n\t\t\t\t\tdescription: instance.description || instance.shellLaunchConfig.type,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpinned: true,\n\t\t\t\t\t\tforceReload: true,\n\t\t\t\t\t\tpreserveFocus: editorOptions?.preserveFocus,\n\t\t\t\t\t\tauxiliary: editorOptions?.auxiliary,\n\t\t\t\t\t}\n\t\t\t\t}, editorOptions?.viewColumn ?? ACTIVE_GROUP)\n\t\t\t};\n\t\t\tawait this._activeOpenEditorRequest?.promise;\n\t\t\tthis._activeOpenEditorRequest = undefined;\n\t\t}\n\t}\n\n\tresolveResource(instance: ITerminalInstance): URI {\n\t\tconst resource = instance.resource;\n\t\tconst inputKey = resource.path;\n\t\tconst cachedEditor = this._editorInputs.get(inputKey);\n\n\t\tif (cachedEditor) {\n\t\t\treturn cachedEditor.resource;\n\t\t}\n\n\t\tinstance.target = TerminalLocation.Editor;\n\t\tconst input = this._instantiationService.createInstance(TerminalEditorInput, resource, instance);\n\t\tthis._registerInstance(inputKey, input, instance);\n\t\treturn input.resource;\n\t}\n\n\tgetInputFromResource(resource: URI): TerminalEditorInput {\n\t\tconst input = this._editorInputs.get(resource.path);\n\t\tif (!input) {\n\t\t\tthrow new Error(`Could not get input from resource: ${resource.path}`);\n\t\t}\n\t\treturn input;\n\t}\n\n\tprivate _registerInstance(inputKey: string, input: TerminalEditorInput, instance: ITerminalInstance): void {\n\t\tthis._editorInputs.set(inputKey, input);\n\t\tthis._instanceDisposables.set(inputKey, [\n\t\t\tinstance.onDidFocus(this._onDidFocusInstance.fire, this._onDidFocusInstance),\n\t\t\tinstance.onDisposed(this._onDidDisposeInstance.fire, this._onDidDisposeInstance),\n\t\t\tinstance.capabilities.onDidChangeCapabilities(() => this._onDidChangeInstanceCapability.fire(instance)),\n\t\t]);\n\t\tthis.instances.push(instance);\n\t\tthis._onDidChangeInstances.fire();\n\t}\n\n\tprivate _removeInstance(instance: ITerminalInstance) {\n\t\tconst inputKey = instance.resource.path;\n\t\tthis._editorInputs.delete(inputKey);\n\t\tconst instanceIndex = this.instances.findIndex(e => e === instance);\n\t\tif (instanceIndex !== -1) {\n\t\t\tthis.instances.splice(instanceIndex, 1);\n\t\t}\n\t\tconst disposables = this._instanceDisposables.get(inputKey);\n\t\tthis._instanceDisposables.delete(inputKey);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t}\n\t\tthis._onDidChangeInstances.fire();\n\t}\n\n\tgetInstanceFromResource(resource?: URI): ITerminalInstance | undefined {\n\t\treturn getInstanceFromResource(this.instances, resource);\n\t}\n\n\tsplitInstance(instanceToSplit: ITerminalInstance, shellLaunchConfig: IShellLaunchConfig = {}): ITerminalInstance {\n\t\tif (instanceToSplit.target === TerminalLocation.Editor) {\n\t\t\t// Make sure the instance to split's group is active\n\t\t\tconst group = this._editorInputs.get(instanceToSplit.resource.path)?.group;\n\t\t\tif (group) {\n\t\t\t\tthis._editorGroupsService.activateGroup(group);\n\t\t\t}\n\t\t}\n\t\tconst instance = this._terminalInstanceService.createInstance(shellLaunchConfig, TerminalLocation.Editor);\n\t\tconst resource = this.resolveResource(instance);\n\t\tif (resource) {\n\t\t\tthis._editorService.openEditor({\n\t\t\t\tresource: URI.revive(resource),\n\t\t\t\tdescription: instance.description,\n\t\t\t\toptions: {\n\t\t\t\t\tpinned: true,\n\t\t\t\t\tforceReload: true\n\t\t\t\t}\n\t\t\t}, SIDE_GROUP);\n\t\t}\n\t\treturn instance;\n\t}\n\n\treviveInput(deserializedInput: IDeserializedTerminalEditorInput): EditorInput {\n\t\tconst newDeserializedInput = { ...deserializedInput, findRevivedId: true };\n\t\tconst instance = this._terminalInstanceService.createInstance({ attachPersistentProcess: newDeserializedInput }, TerminalLocation.Editor);\n\t\tconst input = this._instantiationService.createInstance(TerminalEditorInput, instance.resource, instance);\n\t\tthis._registerInstance(instance.resource.path, input, instance);\n\t\treturn input;\n\t}\n\n\tdetachInstance(instance: ITerminalInstance) {\n\t\tconst inputKey = instance.resource.path;\n\t\tconst editorInput = this._editorInputs.get(inputKey);\n\t\teditorInput?.detachInstance();\n\t\tthis._removeInstance(instance);\n\t\t// Don't dispose the input when shutting down to avoid layouts in the editor area\n\t\tif (!this._isShuttingDown) {\n\t\t\teditorInput?.dispose();\n\t\t}\n\t}\n\n\tasync revealActiveEditor(preserveFocus?: boolean): Promise<void> {\n\t\tconst instance = this.activeInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there is an active openEditor call for this instance it will be revealed by that\n\t\tif (this._activeOpenEditorRequest?.instanceId === instance.instanceId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editorInput = this._editorInputs.get(instance.resource.path)!;\n\t\tthis._editorService.openEditor(\n\t\t\teditorInput,\n\t\t\t{\n\t\t\t\tpinned: true,\n\t\t\t\tforceReload: true,\n\t\t\t\tpreserveFocus,\n\t\t\t\tactivation: EditorActivation.PRESERVE\n\t\t\t}\n\t\t);\n\t}\n}\n"]}