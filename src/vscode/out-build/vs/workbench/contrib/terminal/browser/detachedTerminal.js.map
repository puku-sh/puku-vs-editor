{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/detachedTerminal.ts","vs/workbench/contrib/terminal/browser/detachedTerminal.ts"],"names":[],"mappings":"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","file":"detachedTerminal.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { OperatingSystem } from '../../../../base/common/platform.js';\nimport { MicrotaskDelay } from '../../../../base/common/symbols.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalCapabilityStore } from '../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { IMergedEnvironmentVariableCollection } from '../../../../platform/terminal/common/environmentVariable.js';\nimport { ITerminalBackend } from '../../../../platform/terminal/common/terminal.js';\nimport { IDetachedTerminalInstance, IDetachedXTermOptions, IDetachedXtermTerminal, ITerminalContribution, IXtermAttachToElementOptions } from './terminal.js';\nimport { TerminalExtensionsRegistry } from './terminalExtensions.js';\nimport { TerminalWidgetManager } from './widgets/widgetManager.js';\nimport { XtermTerminal } from './xterm/xtermTerminal.js';\nimport { IEnvironmentVariableInfo } from '../common/environmentVariable.js';\nimport { ITerminalProcessInfo, ProcessState } from '../common/terminal.js';\n\nexport class DetachedTerminal extends Disposable implements IDetachedTerminalInstance {\n\tprivate readonly _widgets = this._register(new TerminalWidgetManager());\n\tpublic readonly capabilities = new TerminalCapabilityStore();\n\tprivate readonly _contributions: Map<string, ITerminalContribution> = new Map();\n\n\tpublic domElement?: HTMLElement;\n\n\tpublic get xterm(): IDetachedXtermTerminal {\n\t\treturn this._xterm;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _xterm: XtermTerminal,\n\t\toptions: IDetachedXTermOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis._register(_xterm);\n\n\t\t// Initialize contributions\n\t\tconst contributionDescs = TerminalExtensionsRegistry.getTerminalContributions();\n\t\tfor (const desc of contributionDescs) {\n\t\t\tif (this._contributions.has(desc.id)) {\n\t\t\t\tonUnexpectedError(new Error(`Cannot have two terminal contributions with the same id ${desc.id}`));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (desc.canRunInDetachedTerminals === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet contribution: ITerminalContribution;\n\t\t\ttry {\n\t\t\t\tcontribution = instantiationService.createInstance(desc.ctor, {\n\t\t\t\t\tinstance: this,\n\t\t\t\t\tprocessManager: options.processInfo,\n\t\t\t\t\twidgetManager: this._widgets\n\t\t\t\t});\n\t\t\t\tthis._contributions.set(desc.id, contribution);\n\t\t\t\tthis._register(contribution);\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\t// xterm is already by the time DetachedTerminal is created, so trigger everything\n\t\t// on the next microtask, allowing the caller to do any extra initialization\n\t\tthis._register(new Delayer(MicrotaskDelay)).trigger(() => {\n\t\t\tfor (const contr of this._contributions.values()) {\n\t\t\t\tcontr.xtermReady?.(this._xterm);\n\t\t\t}\n\t\t});\n\t}\n\n\tget selection(): string | undefined {\n\t\treturn this._xterm && this.hasSelection() ? this._xterm.raw.getSelection() : undefined;\n\t}\n\n\thasSelection(): boolean {\n\t\treturn this._xterm.hasSelection();\n\t}\n\n\tclearSelection(): void {\n\t\tthis._xterm.clearSelection();\n\t}\n\n\tfocus(force?: boolean): void {\n\t\tif (force || !dom.getActiveWindow().getSelection()?.toString()) {\n\t\t\tthis.xterm.focus();\n\t\t}\n\t}\n\n\tattachToElement(container: HTMLElement, options?: Partial<IXtermAttachToElementOptions> | undefined): void {\n\t\tthis.domElement = container;\n\t\tconst screenElement = this._xterm.attachToElement(container, options);\n\t\tthis._widgets.attachToElement(screenElement);\n\t}\n\n\tforceScrollbarVisibility(): void {\n\t\tthis.domElement?.classList.add('force-scrollbar');\n\t}\n\n\tresetScrollbarVisibility(): void {\n\t\tthis.domElement?.classList.remove('force-scrollbar');\n\t}\n\n\tgetContribution<T extends ITerminalContribution>(id: string): T | null {\n\t\treturn this._contributions.get(id) as T | null;\n\t}\n}\n\n/**\n * Implements {@link ITerminalProcessInfo} for a detached terminal where most\n * properties are stubbed. Properties are mutable and can be updated by\n * the instantiator.\n */\nexport class DetachedProcessInfo implements ITerminalProcessInfo {\n\tprocessState = ProcessState.Running;\n\tptyProcessReady = Promise.resolve();\n\tshellProcessId: number | undefined;\n\tremoteAuthority: string | undefined;\n\tos: OperatingSystem | undefined;\n\tuserHome: string | undefined;\n\tinitialCwd = '';\n\tenvironmentVariableInfo: IEnvironmentVariableInfo | undefined;\n\tpersistentProcessId: number | undefined;\n\tshouldPersist = false;\n\thasWrittenData = false;\n\thasChildProcesses = false;\n\tbackend: ITerminalBackend | undefined;\n\tcapabilities = new TerminalCapabilityStore();\n\tshellIntegrationNonce = '';\n\textEnvironmentVariableCollection: IMergedEnvironmentVariableCollection | undefined;\n\n\tconstructor(initialValues: Partial<ITerminalProcessInfo>) {\n\t\tObject.assign(this, initialValues);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { OperatingSystem } from '../../../../base/common/platform.js';\nimport { MicrotaskDelay } from '../../../../base/common/symbols.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalCapabilityStore } from '../../../../platform/terminal/common/capabilities/terminalCapabilityStore.js';\nimport { IMergedEnvironmentVariableCollection } from '../../../../platform/terminal/common/environmentVariable.js';\nimport { ITerminalBackend } from '../../../../platform/terminal/common/terminal.js';\nimport { IDetachedTerminalInstance, IDetachedXTermOptions, IDetachedXtermTerminal, ITerminalContribution, IXtermAttachToElementOptions } from './terminal.js';\nimport { TerminalExtensionsRegistry } from './terminalExtensions.js';\nimport { TerminalWidgetManager } from './widgets/widgetManager.js';\nimport { XtermTerminal } from './xterm/xtermTerminal.js';\nimport { IEnvironmentVariableInfo } from '../common/environmentVariable.js';\nimport { ITerminalProcessInfo, ProcessState } from '../common/terminal.js';\n\nexport class DetachedTerminal extends Disposable implements IDetachedTerminalInstance {\n\tprivate readonly _widgets = this._register(new TerminalWidgetManager());\n\tpublic readonly capabilities = new TerminalCapabilityStore();\n\tprivate readonly _contributions: Map<string, ITerminalContribution> = new Map();\n\n\tpublic domElement?: HTMLElement;\n\n\tpublic get xterm(): IDetachedXtermTerminal {\n\t\treturn this._xterm;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _xterm: XtermTerminal,\n\t\toptions: IDetachedXTermOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis._register(_xterm);\n\n\t\t// Initialize contributions\n\t\tconst contributionDescs = TerminalExtensionsRegistry.getTerminalContributions();\n\t\tfor (const desc of contributionDescs) {\n\t\t\tif (this._contributions.has(desc.id)) {\n\t\t\t\tonUnexpectedError(new Error(`Cannot have two terminal contributions with the same id ${desc.id}`));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (desc.canRunInDetachedTerminals === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet contribution: ITerminalContribution;\n\t\t\ttry {\n\t\t\t\tcontribution = instantiationService.createInstance(desc.ctor, {\n\t\t\t\t\tinstance: this,\n\t\t\t\t\tprocessManager: options.processInfo,\n\t\t\t\t\twidgetManager: this._widgets\n\t\t\t\t});\n\t\t\t\tthis._contributions.set(desc.id, contribution);\n\t\t\t\tthis._register(contribution);\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\t// xterm is already by the time DetachedTerminal is created, so trigger everything\n\t\t// on the next microtask, allowing the caller to do any extra initialization\n\t\tthis._register(new Delayer(MicrotaskDelay)).trigger(() => {\n\t\t\tfor (const contr of this._contributions.values()) {\n\t\t\t\tcontr.xtermReady?.(this._xterm);\n\t\t\t}\n\t\t});\n\t}\n\n\tget selection(): string | undefined {\n\t\treturn this._xterm && this.hasSelection() ? this._xterm.raw.getSelection() : undefined;\n\t}\n\n\thasSelection(): boolean {\n\t\treturn this._xterm.hasSelection();\n\t}\n\n\tclearSelection(): void {\n\t\tthis._xterm.clearSelection();\n\t}\n\n\tfocus(force?: boolean): void {\n\t\tif (force || !dom.getActiveWindow().getSelection()?.toString()) {\n\t\t\tthis.xterm.focus();\n\t\t}\n\t}\n\n\tattachToElement(container: HTMLElement, options?: Partial<IXtermAttachToElementOptions> | undefined): void {\n\t\tthis.domElement = container;\n\t\tconst screenElement = this._xterm.attachToElement(container, options);\n\t\tthis._widgets.attachToElement(screenElement);\n\t}\n\n\tforceScrollbarVisibility(): void {\n\t\tthis.domElement?.classList.add('force-scrollbar');\n\t}\n\n\tresetScrollbarVisibility(): void {\n\t\tthis.domElement?.classList.remove('force-scrollbar');\n\t}\n\n\tgetContribution<T extends ITerminalContribution>(id: string): T | null {\n\t\treturn this._contributions.get(id) as T | null;\n\t}\n}\n\n/**\n * Implements {@link ITerminalProcessInfo} for a detached terminal where most\n * properties are stubbed. Properties are mutable and can be updated by\n * the instantiator.\n */\nexport class DetachedProcessInfo implements ITerminalProcessInfo {\n\tprocessState = ProcessState.Running;\n\tptyProcessReady = Promise.resolve();\n\tshellProcessId: number | undefined;\n\tremoteAuthority: string | undefined;\n\tos: OperatingSystem | undefined;\n\tuserHome: string | undefined;\n\tinitialCwd = '';\n\tenvironmentVariableInfo: IEnvironmentVariableInfo | undefined;\n\tpersistentProcessId: number | undefined;\n\tshouldPersist = false;\n\thasWrittenData = false;\n\thasChildProcesses = false;\n\tbackend: ITerminalBackend | undefined;\n\tcapabilities = new TerminalCapabilityStore();\n\tshellIntegrationNonce = '';\n\textEnvironmentVariableCollection: IMergedEnvironmentVariableCollection | undefined;\n\n\tconstructor(initialValues: Partial<ITerminalProcessInfo>) {\n\t\tObject.assign(this, initialValues);\n\t}\n}\n"]}