{"version":3,"sources":["vs/workbench/contrib/terminal/browser/terminalTabbedView.ts"],"names":[],"mappings":"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","file":"terminalTabbedView.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { LayoutPriority, Orientation, Sizing, SplitView } from '../../../../base/browser/ui/splitview/splitview.js';\nimport { Disposable, dispose, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITerminalChatService, ITerminalConfigurationService, ITerminalGroupService, ITerminalInstance, ITerminalService, TerminalConnectionState, TerminalDataTransfers } from './terminal.js';\nimport { TerminalTabsListSizes, TerminalTabList } from './terminalTabsList.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, IAction, Separator } from '../../../../base/common/actions.js';\nimport { IMenu, IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { TerminalLocation, TerminalSettingId } from '../../../../platform/terminal/common/terminal.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { localize } from '../../../../nls.js';\nimport { openContextMenu } from './terminalContextMenu.js';\nimport { TerminalStorageKeys } from '../common/terminalStorageKeys.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { getInstanceHoverInfo } from './terminalTooltip.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { TerminalTabsChatEntry } from './terminalTabsChatEntry.js';\nimport { containsDragType } from '../../../../platform/dnd/browser/dnd.js';\nimport { getTerminalResourcesFromDragEvent, parseTerminalUri } from './terminalUri.js';\nimport type { IProcessDetails } from '../../../../platform/terminal/common/terminalProcess.js';\n\nconst $ = dom.$;\n\nconst enum CssClass {\n\tViewIsVertical = 'terminal-side-view',\n}\n\nconst enum WidthConstants {\n\tStatusIcon = 30,\n\tSplitAnnotation = 30\n}\n\nexport class TerminalTabbedView extends Disposable {\n\n\tprivate _splitView: SplitView;\n\n\tprivate _terminalContainer: HTMLElement;\n\tprivate _tabListElement: HTMLElement;\n\tprivate _tabContainer: HTMLElement;\n\n\tprivate _tabList: TerminalTabList;\n\tprivate _tabListContainer: HTMLElement;\n\tprivate _tabListDomElement: HTMLElement;\n\tprivate _sashDisposables: IDisposable[] | undefined;\n\n\tprivate _plusButton: HTMLElement | undefined;\n\tprivate _chatEntry: TerminalTabsChatEntry | undefined;\n\n\tprivate _tabTreeIndex: number;\n\tprivate _terminalContainerIndex: number;\n\n\tprivate _height: number | undefined;\n\tprivate _width: number | undefined;\n\n\tprivate _cancelContextMenu: boolean = false;\n\tprivate _instanceMenu: IMenu;\n\tprivate _tabsListMenu: IMenu;\n\tprivate _tabsListEmptyMenu: IMenu;\n\n\tprivate _terminalIsTabsNarrowContextKey: IContextKey<boolean>;\n\tprivate _terminalTabsFocusContextKey: IContextKey<boolean>;\n\tprivate _terminalTabsMouseContextKey: IContextKey<boolean>;\n\n\tprivate _panelOrientation: Orientation | undefined;\n\tprivate _emptyAreaDropTargetCount = 0;\n\n\tconstructor(\n\t\tparentElement: HTMLElement,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalChatService private readonly _terminalChatService: ITerminalChatService,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t) {\n\t\tsuper();\n\n\t\tthis._tabContainer = $('.tabs-container');\n\t\tconst tabListContainer = $('.tabs-list-container');\n\t\tthis._tabListContainer = tabListContainer;\n\t\tthis._tabListElement = $('.tabs-list');\n\t\ttabListContainer.appendChild(this._tabListElement);\n\t\tthis._tabContainer.appendChild(tabListContainer);\n\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, dom.EventType.DBLCLICK, async () => {\n\t\t\tconst instance = await this._terminalService.createTerminal({ location: TerminalLocation.Panel });\n\t\t\tthis._terminalGroupService.setActiveInstance(instance);\n\t\t\tawait instance.focusWhenReady();\n\t\t}));\n\n\t\tthis._instanceMenu = this._register(menuService.createMenu(MenuId.TerminalInstanceContext, contextKeyService));\n\t\tthis._tabsListMenu = this._register(menuService.createMenu(MenuId.TerminalTabContext, contextKeyService));\n\t\tthis._tabsListEmptyMenu = this._register(menuService.createMenu(MenuId.TerminalTabEmptyAreaContext, contextKeyService));\n\n\t\tthis._tabList = this._register(this._instantiationService.createInstance(TerminalTabList, this._tabListElement));\n\t\tthis._tabListDomElement = this._tabList.getHTMLElement();\n\t\tthis._chatEntry = this._register(this._instantiationService.createInstance(TerminalTabsChatEntry, tabListContainer, this._tabContainer));\n\n\t\tconst terminalOuterContainer = $('.terminal-outer-container');\n\t\tthis._terminalContainer = $('.terminal-groups-container');\n\t\tterminalOuterContainer.appendChild(this._terminalContainer);\n\n\t\tthis._terminalService.setContainers(parentElement, this._terminalContainer);\n\n\t\tthis._terminalIsTabsNarrowContextKey = TerminalContextKeys.tabsNarrow.bindTo(contextKeyService);\n\t\tthis._terminalTabsFocusContextKey = TerminalContextKeys.tabsFocus.bindTo(contextKeyService);\n\t\tthis._terminalTabsMouseContextKey = TerminalContextKeys.tabsMouse.bindTo(contextKeyService);\n\n\t\tthis._tabTreeIndex = this._terminalConfigurationService.config.tabs.location === 'left' ? 0 : 1;\n\t\tthis._terminalContainerIndex = this._terminalConfigurationService.config.tabs.location === 'left' ? 1 : 0;\n\n\t\tthis._register(_configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.TabsEnabled) ||\n\t\t\t\te.affectsConfiguration(TerminalSettingId.TabsHideCondition)) {\n\t\t\t\tthis._refreshShowTabs();\n\t\t\t} else if (e.affectsConfiguration(TerminalSettingId.TabsLocation)) {\n\t\t\t\tthis._tabTreeIndex = this._terminalConfigurationService.config.tabs.location === 'left' ? 0 : 1;\n\t\t\t\tthis._terminalContainerIndex = this._terminalConfigurationService.config.tabs.location === 'left' ? 1 : 0;\n\t\t\t\tif (this._shouldShowTabs()) {\n\t\t\t\t\tthis._splitView.swapViews(0, 1);\n\t\t\t\t\tthis._removeSashListener();\n\t\t\t\t\tthis._addSashListener();\n\t\t\t\t\tthis._splitView.resizeView(this._tabTreeIndex, this._getLastListWidth());\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(Event.any(this._terminalGroupService.onDidChangeInstances, this._terminalGroupService.onDidChangeGroups)(() => {\n\t\t\tthis._refreshShowTabs();\n\t\t\tthis._updateChatTerminalsEntry();\n\t\t}));\n\n\t\tthis._register(Event.any(this._terminalChatService.onDidRegisterTerminalInstanceWithToolSession, this._terminalService.onDidChangeInstances)(() => {\n\t\t\tthis._refreshShowTabs();\n\t\t\tthis._updateChatTerminalsEntry();\n\t\t}));\n\n\t\tthis._register(contextKeyService.onDidChangeContext(e => {\n\t\t\tif (e.affectsSome(new Set(['hasHiddenChatTerminals']))) {\n\t\t\t\tthis._refreshShowTabs();\n\t\t\t\tthis._updateChatTerminalsEntry();\n\t\t\t}\n\t\t}));\n\t\tthis._attachEventListeners(parentElement, this._terminalContainer);\n\n\t\tthis._register(this._terminalGroupService.onDidChangePanelOrientation((orientation) => {\n\t\t\tthis._panelOrientation = orientation;\n\t\t\tif (this._panelOrientation === Orientation.VERTICAL) {\n\t\t\t\tthis._terminalContainer.classList.add(CssClass.ViewIsVertical);\n\t\t\t} else {\n\t\t\t\tthis._terminalContainer.classList.remove(CssClass.ViewIsVertical);\n\t\t\t}\n\t\t}));\n\n\t\tthis._splitView = new SplitView(parentElement, { orientation: Orientation.HORIZONTAL, proportionalLayout: false });\n\t\tthis._setupSplitView(terminalOuterContainer);\n\t\tthis._updateChatTerminalsEntry();\n\t}\n\n\tprivate _shouldShowTabs(): boolean {\n\t\tconst enabled = this._terminalConfigurationService.config.tabs.enabled;\n\t\tconst hide = this._terminalConfigurationService.config.tabs.hideCondition;\n\t\tconst hiddenChatTerminals = this._terminalChatService.getToolSessionTerminalInstances(true);\n\t\tif (!enabled) {\n\t\t\treturn false;\n\t\t}\n\t\tif (hiddenChatTerminals.length > 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tswitch (hide) {\n\t\t\tcase 'never':\n\t\t\t\treturn true;\n\t\t\tcase 'singleTerminal':\n\t\t\t\tif (this._terminalGroupService.instances.length > 1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'singleGroup':\n\t\t\t\tif (this._terminalGroupService.groups.length > 1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _refreshShowTabs() {\n\t\tif (this._shouldShowTabs()) {\n\t\t\tif (this._splitView.length === 1) {\n\t\t\t\tthis._addTabTree();\n\t\t\t\tthis._addSashListener();\n\t\t\t\tthis._splitView.resizeView(this._tabTreeIndex, this._getLastListWidth());\n\t\t\t\tthis.rerenderTabs();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._splitView.length === 2 && !this._terminalTabsMouseContextKey.get()) {\n\t\t\t\tthis._splitView.removeView(this._tabTreeIndex);\n\t\t\t\tthis._plusButton?.remove();\n\t\t\t\tthis._removeSashListener();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _updateChatTerminalsEntry(): void {\n\t\tthis._chatEntry?.update();\n\t}\n\n\tprivate _getLastListWidth(): number {\n\t\tconst widthKey = this._panelOrientation === Orientation.VERTICAL ? TerminalStorageKeys.TabsListWidthVertical : TerminalStorageKeys.TabsListWidthHorizontal;\n\t\tconst storedValue = this._storageService.get(widthKey, StorageScope.PROFILE);\n\n\t\tif (!storedValue || !parseInt(storedValue)) {\n\t\t\t// we want to use the min width by default for the vertical orientation bc\n\t\t\t// there is such a limited width for the terminal panel to begin w there.\n\t\t\treturn this._panelOrientation === Orientation.VERTICAL ? TerminalTabsListSizes.NarrowViewWidth : TerminalTabsListSizes.DefaultWidth;\n\t\t}\n\t\treturn parseInt(storedValue);\n\t}\n\n\tprivate _handleOnDidSashReset(): void {\n\t\t// Calculate ideal size of list to display all text based on its contents\n\t\tlet idealWidth = TerminalTabsListSizes.WideViewMinimumWidth;\n\t\tconst offscreenCanvas = document.createElement('canvas');\n\t\toffscreenCanvas.width = 1;\n\t\toffscreenCanvas.height = 1;\n\t\tconst ctx = offscreenCanvas.getContext('2d');\n\t\tif (ctx) {\n\t\t\tconst style = dom.getWindow(this._tabListElement).getComputedStyle(this._tabListElement);\n\t\t\tctx.font = `${style.fontStyle} ${style.fontSize} ${style.fontFamily}`;\n\t\t\tconst maxInstanceWidth = this._terminalGroupService.instances.reduce((p, c) => {\n\t\t\t\treturn Math.max(p, ctx.measureText(c.title + (c.description || '')).width + this._getAdditionalWidth(c));\n\t\t\t}, 0);\n\t\t\tidealWidth = Math.ceil(Math.max(maxInstanceWidth, TerminalTabsListSizes.WideViewMinimumWidth));\n\t\t}\n\t\t// If the size is already ideal, toggle to collapsed\n\t\tconst currentWidth = Math.ceil(this._splitView.getViewSize(this._tabTreeIndex));\n\t\tif (currentWidth === idealWidth) {\n\t\t\tidealWidth = TerminalTabsListSizes.NarrowViewWidth;\n\t\t}\n\t\tthis._splitView.resizeView(this._tabTreeIndex, idealWidth);\n\t\tthis._updateListWidth(idealWidth);\n\t}\n\n\tprivate _getAdditionalWidth(instance: ITerminalInstance): number {\n\t\t// Size to include padding, icon, status icon (if any), split annotation (if any), + a little more\n\t\tconst additionalWidth = 40;\n\t\tconst statusIconWidth = instance.statusList.statuses.length > 0 ? WidthConstants.StatusIcon : 0;\n\t\tconst splitAnnotationWidth = (this._terminalGroupService.getGroupForInstance(instance)?.terminalInstances.length || 0) > 1 ? WidthConstants.SplitAnnotation : 0;\n\t\treturn additionalWidth + splitAnnotationWidth + statusIconWidth;\n\t}\n\n\tprivate _handleOnDidSashChange(): void {\n\t\tconst listWidth = this._splitView.getViewSize(this._tabTreeIndex);\n\t\tif (!this._width || listWidth <= 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis._updateListWidth(listWidth);\n\t}\n\n\tprivate _updateListWidth(width: number): void {\n\t\tif (width < TerminalTabsListSizes.MidpointViewWidth && width >= TerminalTabsListSizes.NarrowViewWidth) {\n\t\t\twidth = TerminalTabsListSizes.NarrowViewWidth;\n\t\t\tthis._splitView.resizeView(this._tabTreeIndex, width);\n\t\t} else if (width >= TerminalTabsListSizes.MidpointViewWidth && width < TerminalTabsListSizes.WideViewMinimumWidth) {\n\t\t\twidth = TerminalTabsListSizes.WideViewMinimumWidth;\n\t\t\tthis._splitView.resizeView(this._tabTreeIndex, width);\n\t\t}\n\t\tthis.rerenderTabs();\n\t\tconst widthKey = this._panelOrientation === Orientation.VERTICAL ? TerminalStorageKeys.TabsListWidthVertical : TerminalStorageKeys.TabsListWidthHorizontal;\n\t\tthis._storageService.store(widthKey, width, StorageScope.PROFILE, StorageTarget.USER);\n\t}\n\n\tprivate _setupSplitView(terminalOuterContainer: HTMLElement): void {\n\t\tthis._register(this._splitView.onDidSashReset(() => this._handleOnDidSashReset()));\n\t\tthis._register(this._splitView.onDidSashChange(() => this._handleOnDidSashChange()));\n\n\t\tif (this._shouldShowTabs()) {\n\t\t\tthis._addTabTree();\n\t\t}\n\t\tthis._splitView.addView({\n\t\t\telement: terminalOuterContainer,\n\t\t\tlayout: width => this._terminalGroupService.groups.forEach(tab => tab.layout(width, this._height || 0)),\n\t\t\tminimumSize: 120,\n\t\t\tmaximumSize: Number.POSITIVE_INFINITY,\n\t\t\tonDidChange: () => Disposable.None,\n\t\t\tpriority: LayoutPriority.High\n\t\t}, Sizing.Distribute, this._terminalContainerIndex);\n\n\t\tif (this._shouldShowTabs()) {\n\t\t\tthis._addSashListener();\n\t\t}\n\t}\n\n\tprivate _addTabTree() {\n\t\tthis._splitView.addView({\n\t\t\telement: this._tabContainer,\n\t\t\tlayout: width => this._tabList.layout(this._height || 0, width),\n\t\t\tminimumSize: TerminalTabsListSizes.NarrowViewWidth,\n\t\t\tmaximumSize: TerminalTabsListSizes.MaximumWidth,\n\t\t\tonDidChange: () => Disposable.None,\n\t\t\tpriority: LayoutPriority.Low\n\t\t}, Sizing.Distribute, this._tabTreeIndex);\n\t\tthis.rerenderTabs();\n\t}\n\n\trerenderTabs() {\n\t\tthis._updateHasText();\n\t\tthis._tabList.refresh();\n\t}\n\n\tprivate _addSashListener() {\n\t\tlet interval: IDisposable;\n\t\tthis._sashDisposables = [\n\t\t\tthis._splitView.sashes[0].onDidStart(e => {\n\t\t\t\tinterval = dom.disposableWindowInterval(dom.getWindow(this._splitView.el), () => {\n\t\t\t\t\tthis.rerenderTabs();\n\t\t\t\t}, 100);\n\t\t\t}),\n\t\t\tthis._splitView.sashes[0].onDidEnd(e => {\n\t\t\t\tinterval.dispose();\n\t\t\t})\n\t\t];\n\t}\n\n\tprivate _removeSashListener() {\n\t\tif (this._sashDisposables) {\n\t\t\tdispose(this._sashDisposables);\n\t\t\tthis._sashDisposables = undefined;\n\t\t}\n\t}\n\n\tprivate _updateHasText() {\n\t\tconst hasText = this._tabListElement.clientWidth > TerminalTabsListSizes.MidpointViewWidth;\n\t\tthis._tabContainer.classList.toggle('has-text', hasText);\n\t\tthis._terminalIsTabsNarrowContextKey.set(!hasText);\n\t\tthis._updateChatTerminalsEntry();\n\t}\n\n\tlayout(width: number, height: number): void {\n\t\tconst chatItemHeight = this._chatEntry?.element.style.display === 'none' ? 0 : this._chatEntry?.element.clientHeight;\n\t\tthis._height = height - (chatItemHeight ?? 0);\n\t\tthis._width = width;\n\t\tthis._splitView.layout(width);\n\t\tif (this._shouldShowTabs()) {\n\t\t\tthis._splitView.resizeView(this._tabTreeIndex, this._getLastListWidth());\n\t\t}\n\t\tthis._updateHasText();\n\t}\n\n\n\tprivate _attachEventListeners(parentDomElement: HTMLElement, terminalContainer: HTMLElement): void {\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'mouseleave', async (event: MouseEvent) => {\n\t\t\tthis._terminalTabsMouseContextKey.set(false);\n\t\t\tthis._refreshShowTabs();\n\t\t\tevent.stopPropagation();\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'mouseenter', async (event: MouseEvent) => {\n\t\t\tthis._terminalTabsMouseContextKey.set(true);\n\t\t\tevent.stopPropagation();\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'dragenter', (event: DragEvent) => {\n\t\t\tif (!this._shouldHandleEmptyAreaDrop(event)) {\n\t\t\t\tthis._resetEmptyAreaDropState();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._emptyAreaDropTargetCount++;\n\t\t\tthis._setEmptyAreaDropState(true);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'dragover', (event: DragEvent) => {\n\t\t\tif (!this._shouldHandleEmptyAreaDrop(event)) {\n\t\t\t\tthis._resetEmptyAreaDropState();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tthis._setEmptyAreaDropState(true);\n\t\t\tif (event.dataTransfer) {\n\t\t\t\tevent.dataTransfer.dropEffect = 'move';\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'dragleave', (event: DragEvent) => {\n\t\t\tif (!this._shouldHandleEmptyAreaDrop(event)) {\n\t\t\t\tif (!this._tabContainer.contains(event.relatedTarget as Node | null)) {\n\t\t\t\t\tthis._resetEmptyAreaDropState();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._tabContainer.contains(event.relatedTarget as Node | null)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._emptyAreaDropTargetCount = Math.max(0, this._emptyAreaDropTargetCount - 1);\n\t\t\tif (this._emptyAreaDropTargetCount === 0) {\n\t\t\t\tthis._resetEmptyAreaDropState();\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'drop', (event: DragEvent) => {\n\t\t\tif (!this._shouldHandleEmptyAreaDrop(event)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvoid this._handleContainerDrop(event);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(terminalContainer, 'mousedown', async (event: MouseEvent) => {\n\t\t\tconst terminal = this._terminalGroupService.activeInstance;\n\t\t\tif (this._terminalGroupService.instances.length > 0 && terminal) {\n\t\t\t\tconst result = await terminal.handleMouseEvent(event, this._instanceMenu);\n\t\t\t\tif (typeof result === 'object' && result.cancelContextMenu) {\n\t\t\t\t\tthis._cancelContextMenu = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(terminalContainer, 'contextmenu', (event: MouseEvent) => {\n\t\t\tconst rightClickBehavior = this._terminalConfigurationService.config.rightClickBehavior;\n\t\t\tif (rightClickBehavior === 'nothing' && !event.shiftKey) {\n\t\t\t\tthis._cancelContextMenu = true;\n\t\t\t}\n\t\t\tterminalContainer.focus();\n\t\t\tif (!this._cancelContextMenu) {\n\t\t\t\topenContextMenu(dom.getWindow(terminalContainer), event, this._terminalGroupService.activeInstance, this._instanceMenu, this._contextMenuService);\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\tthis._cancelContextMenu = false;\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, 'contextmenu', (event: MouseEvent) => {\n\t\t\tconst rightClickBehavior = this._terminalConfigurationService.config.rightClickBehavior;\n\t\t\tif (rightClickBehavior === 'nothing' && !event.shiftKey) {\n\t\t\t\tthis._cancelContextMenu = true;\n\t\t\t}\n\t\t\tif (!this._cancelContextMenu) {\n\t\t\t\tconst emptyList = this._tabList.getFocus().length === 0;\n\t\t\t\tif (!emptyList) {\n\t\t\t\t\tthis._terminalGroupService.lastAccessedMenu = 'tab-list';\n\t\t\t\t}\n\n\t\t\t\t// Put the focused item first as it's used as the first positional argument\n\t\t\t\tconst selectedInstances = this._tabList.getSelectedElements();\n\t\t\t\tconst focusedInstance = this._tabList.getFocusedElements()?.[0];\n\t\t\t\tif (focusedInstance) {\n\t\t\t\t\tselectedInstances.splice(selectedInstances.findIndex(e => e.instanceId === focusedInstance.instanceId), 1);\n\t\t\t\t\tselectedInstances.unshift(focusedInstance);\n\t\t\t\t}\n\n\t\t\t\topenContextMenu(dom.getWindow(this._tabContainer), event, selectedInstances, emptyList ? this._tabsListEmptyMenu : this._tabsListMenu, this._contextMenuService, emptyList ? this._getTabActions() : undefined);\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\tthis._cancelContextMenu = false;\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(terminalContainer.ownerDocument, 'keydown', (event: KeyboardEvent) => {\n\t\t\tterminalContainer.classList.toggle('alt-active', !!event.altKey);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(terminalContainer.ownerDocument, 'keyup', (event: KeyboardEvent) => {\n\t\t\tterminalContainer.classList.toggle('alt-active', !!event.altKey);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(parentDomElement, 'keyup', (event: KeyboardEvent) => {\n\t\t\tif (event.keyCode === 27) {\n\t\t\t\t// Keep terminal open on escape\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, dom.EventType.FOCUS_IN, () => {\n\t\t\tthis._terminalTabsFocusContextKey.set(true);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._tabContainer, dom.EventType.FOCUS_OUT, () => {\n\t\t\tthis._terminalTabsFocusContextKey.set(false);\n\t\t}));\n\t}\n\n\tprivate _shouldHandleEmptyAreaDrop(event: DragEvent): boolean {\n\t\tconst targetNode = event.target as Node | null;\n\t\tif (targetNode && (this._tabListDomElement.contains(targetNode) || this._tabListElement.contains(targetNode))) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !!event.dataTransfer && containsDragType(event, TerminalDataTransfers.Terminals);\n\t}\n\n\tprivate _setEmptyAreaDropState(active: boolean): void {\n\t\tthis._tabListContainer.classList.toggle('drop-target', active);\n\t\tthis._tabContainer.classList.toggle('drop-target', active);\n\t\tthis._chatEntry?.element.classList.toggle('drop-target', active);\n\t}\n\n\tprivate _resetEmptyAreaDropState(): void {\n\t\tthis._emptyAreaDropTargetCount = 0;\n\t\tthis._setEmptyAreaDropState(false);\n\t}\n\n\tprivate async _handleContainerDrop(event: DragEvent): Promise<void> {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis._resetEmptyAreaDropState();\n\t\tconst primaryBackend = this._terminalService.getPrimaryBackend();\n\t\tconst resources = getTerminalResourcesFromDragEvent(event);\n\t\tlet sourceInstances: ITerminalInstance[] | undefined;\n\t\tconst promises: Promise<IProcessDetails | undefined>[] = [];\n\t\tif (resources) {\n\t\t\tfor (const uri of resources) {\n\t\t\t\tconst instance = this._terminalService.getInstanceFromResource(uri);\n\t\t\t\tif (instance) {\n\t\t\t\t\tif (sourceInstances) {\n\t\t\t\t\t\tsourceInstances.push(instance);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsourceInstances = [instance];\n\t\t\t\t\t}\n\t\t\t\t\tthis._terminalService.moveToTerminalView(instance);\n\t\t\t\t} else if (primaryBackend) {\n\t\t\t\t\tconst terminalIdentifier = parseTerminalUri(uri);\n\t\t\t\t\tif (terminalIdentifier.instanceId) {\n\t\t\t\t\t\tpromises.push(primaryBackend.requestDetachInstance(terminalIdentifier.workspaceId, terminalIdentifier.instanceId));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (promises.length) {\n\t\t\tconst processes = (await Promise.all(promises)).filter((process): process is IProcessDetails => !!process);\n\t\t\tlet lastInstance: ITerminalInstance | undefined;\n\t\t\tfor (const attachPersistentProcess of processes) {\n\t\t\t\tlastInstance = await this._terminalService.createTerminal({ config: { attachPersistentProcess } });\n\t\t\t}\n\t\t\tif (lastInstance) {\n\t\t\t\tthis._terminalService.setActiveInstance(lastInstance);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (!sourceInstances || !sourceInstances.length) {\n\t\t\tsourceInstances = this._tabList.getSelectedElements();\n\t\t\tif (!sourceInstances.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._terminalGroupService.moveGroupToEnd(sourceInstances);\n\t\tthis._terminalService.setActiveInstance(sourceInstances[0]);\n\t\tconst indexes = sourceInstances\n\t\t\t.map(instance => this._terminalGroupService.instances.indexOf(instance))\n\t\t\t.filter(index => index >= 0);\n\t\tif (indexes.length) {\n\t\t\tthis._tabList.setSelection(indexes);\n\t\t\tthis._tabList.setFocus([indexes[0]]);\n\t\t}\n\t}\n\n\tprivate _getTabActions(): IAction[] {\n\t\treturn [\n\t\t\tnew Separator(),\n\t\t\tthis._configurationService.inspect(TerminalSettingId.TabsLocation).userValue === 'left' ?\n\t\t\t\tnew Action('moveRight', localize('moveTabsRight', \"Move Tabs Right\"), undefined, undefined, async () => {\n\t\t\t\t\tthis._configurationService.updateValue(TerminalSettingId.TabsLocation, 'right');\n\t\t\t\t}) :\n\t\t\t\tnew Action('moveLeft', localize('moveTabsLeft', \"Move Tabs Left\"), undefined, undefined, async () => {\n\t\t\t\t\tthis._configurationService.updateValue(TerminalSettingId.TabsLocation, 'left');\n\t\t\t\t}),\n\t\t\tnew Action('hideTabs', localize('hideTabs', \"Hide Tabs\"), undefined, undefined, async () => {\n\t\t\t\tthis._configurationService.updateValue(TerminalSettingId.TabsEnabled, false);\n\t\t\t})\n\t\t];\n\t}\n\n\tsetEditable(isEditing: boolean): void {\n\t\tif (!isEditing) {\n\t\t\tthis._tabList.domFocus();\n\t\t}\n\t\tthis._tabList.refresh(false);\n\t}\n\n\tfocusTabs(): void {\n\t\tif (!this._shouldShowTabs()) {\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalTabsFocusContextKey.set(true);\n\t\tconst selected = this._tabList.getSelection();\n\t\tthis._tabList.domFocus();\n\t\tif (selected) {\n\t\t\tthis._tabList.setFocus(selected);\n\t\t}\n\t}\n\n\tfocus() {\n\t\tif (this._terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\t\tthis._focus();\n\t\t\treturn;\n\t\t}\n\n\t\t// If the terminal is waiting to reconnect to remote terminals, then there is no TerminalInstance yet that can\n\t\t// be focused. So wait for connection to finish, then focus.\n\t\tconst previousActiveElement = this._tabListElement.ownerDocument.activeElement;\n\t\tif (previousActiveElement) {\n\t\t\t// TODO: Improve lifecycle management this event should be disposed after first fire\n\t\t\tthis._register(this._terminalService.onDidChangeConnectionState(() => {\n\t\t\t\t// Only focus the terminal if the activeElement has not changed since focus() was called\n\t\t\t\t// TODO: Hack\n\t\t\t\tif (dom.isActiveElement(previousActiveElement)) {\n\t\t\t\t\tthis._focus();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tfocusHover() {\n\t\tif (this._shouldShowTabs()) {\n\t\t\tthis._tabList.focusHover();\n\t\t\treturn;\n\t\t}\n\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\t\tthis._hoverService.showInstantHover({\n\t\t\t...getInstanceHoverInfo(instance, this._storageService),\n\t\t\ttarget: this._terminalContainer,\n\t\t\ttrapFocus: true\n\t\t}, true);\n\t}\n\n\tprivate _focus() {\n\t\tthis._terminalGroupService.activeInstance?.focusWhenReady();\n\t}\n}\n"]}