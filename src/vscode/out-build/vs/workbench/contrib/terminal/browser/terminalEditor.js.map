{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/terminalEditor.ts","vs/workbench/contrib/terminal/browser/terminalEditor.ts"],"names":[],"mappings":"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","file":"terminalEditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IActionViewItem } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { DropdownWithPrimaryActionViewItem } from '../../../../platform/actions/browser/dropdownWithPrimaryActionViewItem.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IEditorOptions } from '../../../../platform/editor/common/editor.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { EditorPane } from '../../../browser/parts/editor/editorPane.js';\nimport { IEditorOpenContext } from '../../../common/editor.js';\nimport { ITerminalConfigurationService, ITerminalEditorService, ITerminalService, terminalEditorId } from './terminal.js';\nimport { TerminalEditorInput } from './terminalEditorInput.js';\nimport { getTerminalActionBarArgs } from './terminalMenus.js';\nimport { ITerminalProfileResolverService, ITerminalProfileService, TerminalCommandId } from '../common/terminal.js';\nimport { IEditorGroup } from '../../../services/editor/common/editorGroupsService.js';\nimport { openContextMenu } from './terminalContextMenu.js';\nimport { ACTIVE_GROUP } from '../../../services/editor/common/editorService.js';\nimport { IWorkbenchLayoutService, Parts } from '../../../services/layout/browser/layoutService.js';\nimport { IBaseActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { ITerminalProfile, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\n\nexport class TerminalEditor extends EditorPane {\n\n\tprivate _editorInstanceElement: HTMLElement | undefined;\n\tprivate _overflowGuardElement: HTMLElement | undefined;\n\n\tprivate _editorInput?: TerminalEditorInput = undefined;\n\n\tprivate _lastDimension?: dom.Dimension;\n\n\tprivate readonly _dropdownMenu: IMenu;\n\n\tprivate readonly _instanceMenu: IMenu;\n\n\tprivate _cancelContextMenu: boolean = false;\n\n\tprivate readonly _newDropdown: MutableDisposable<DropdownWithPrimaryActionViewItem> = this._register(new MutableDisposable());\n\n\tprivate readonly _disposableStore = this._register(new DisposableStore());\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@ITerminalEditorService private readonly _terminalEditorService: ITerminalEditorService,\n\t\t@ITerminalProfileResolverService private readonly _terminalProfileResolverService: ITerminalProfileResolverService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@ITerminalProfileService private readonly _terminalProfileService: ITerminalProfileService,\n\t\t@IWorkbenchLayoutService private readonly _workbenchLayoutService: IWorkbenchLayoutService\n\t) {\n\t\tsuper(terminalEditorId, group, telemetryService, themeService, storageService);\n\t\tthis._dropdownMenu = this._register(menuService.createMenu(MenuId.TerminalNewDropdownContext, contextKeyService));\n\t\tthis._instanceMenu = this._register(menuService.createMenu(MenuId.TerminalInstanceContext, contextKeyService));\n\t\tthis._register(this._terminalProfileService.onDidChangeAvailableProfiles(profiles => this._updateTabActionBar(profiles)));\n\t}\n\n\toverride async setInput(newInput: TerminalEditorInput, options: IEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken) {\n\t\tthis._editorInput?.terminalInstance?.detachFromElement();\n\t\tthis._editorInput = newInput;\n\t\tawait super.setInput(newInput, options, context, token);\n\t\tthis._editorInput.terminalInstance?.attachToElement(this._overflowGuardElement!);\n\t\tif (this._lastDimension) {\n\t\t\tthis.layout(this._lastDimension);\n\t\t}\n\t\tthis._editorInput.terminalInstance?.setVisible(this.isVisible() && this._workbenchLayoutService.isVisible(Parts.EDITOR_PART, this.window));\n\t\tif (this._editorInput.terminalInstance) {\n\t\t\t// since the editor does not monitor focus changes, for ex. between the terminal\n\t\t\t// panel and the editors, this is needed so that the active instance gets set\n\t\t\t// when focus changes between them.\n\t\t\tthis._register(this._editorInput.terminalInstance.onDidFocus(() => this._setActiveInstance()));\n\t\t\tthis._editorInput.setCopyLaunchConfig(this._editorInput.terminalInstance.shellLaunchConfig);\n\t\t}\n\t}\n\n\toverride clearInput(): void {\n\t\tsuper.clearInput();\n\t\tif (this._overflowGuardElement && this._editorInput?.terminalInstance?.domElement.parentElement === this._overflowGuardElement) {\n\t\t\tthis._editorInput.terminalInstance?.detachFromElement();\n\t\t}\n\t\tthis._editorInput = undefined;\n\t}\n\n\tprivate _setActiveInstance(): void {\n\t\tif (!this._editorInput?.terminalInstance) {\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalEditorService.setActiveInstance(this._editorInput.terminalInstance);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\n\t\tthis._editorInput?.terminalInstance?.focus(true);\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._editorInstanceElement = parent;\n\t\tthis._overflowGuardElement = dom.$('.terminal-overflow-guard.terminal-editor');\n\t\tthis._editorInstanceElement.appendChild(this._overflowGuardElement);\n\t\tthis._registerListeners();\n\t}\n\n\tprivate _registerListeners(): void {\n\t\tif (!this._editorInstanceElement) {\n\t\t\treturn;\n\t\t}\n\t\tthis._register(dom.addDisposableListener(this._editorInstanceElement, 'mousedown', async (event: MouseEvent) => {\n\t\t\tconst terminal = this._terminalEditorService.activeInstance;\n\t\t\tif (this._terminalEditorService.instances.length > 0 && terminal) {\n\t\t\t\tconst result = await terminal.handleMouseEvent(event, this._instanceMenu);\n\t\t\t\tif (typeof result === 'object' && result.cancelContextMenu) {\n\t\t\t\t\tthis._cancelContextMenu = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._editorInstanceElement, 'contextmenu', (event: MouseEvent) => {\n\t\t\tconst rightClickBehavior = this._terminalConfigurationService.config.rightClickBehavior;\n\t\t\tif (rightClickBehavior === 'nothing' && !event.shiftKey) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\tthis._cancelContextMenu = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif (!this._cancelContextMenu && rightClickBehavior !== 'copyPaste' && rightClickBehavior !== 'paste') {\n\t\t\t\t\tif (!this._cancelContextMenu) {\n\t\t\t\t\t\topenContextMenu(this.window, event, this._editorInput?.terminalInstance, this._instanceMenu, this._contextMenuService);\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\tthis._cancelContextMenu = false;\n\t\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _updateTabActionBar(profiles: ITerminalProfile[]): void {\n\t\tthis._disposableStore.clear();\n\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Editor, profiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu, this._disposableStore);\n\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t}\n\n\tlayout(dimension: dom.Dimension): void {\n\t\tconst instance = this._editorInput?.terminalInstance;\n\t\tif (instance) {\n\t\t\tinstance.attachToElement(this._overflowGuardElement!);\n\t\t\tinstance.layout(dimension);\n\t\t}\n\t\tthis._lastDimension = dimension;\n\t}\n\n\toverride setVisible(visible: boolean): void {\n\t\tsuper.setVisible(visible);\n\t\tthis._editorInput?.terminalInstance?.setVisible(visible && this._workbenchLayoutService.isVisible(Parts.EDITOR_PART, this.window));\n\t}\n\n\toverride getActionViewItem(action: IAction, options: IBaseActionViewItemOptions): IActionViewItem | undefined {\n\t\tswitch (action.id) {\n\t\t\tcase TerminalCommandId.CreateTerminalEditorSameGroup: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst location = { viewColumn: ACTIVE_GROUP };\n\t\t\t\t\tthis._disposableStore.clear();\n\t\t\t\t\tconst actions = getTerminalActionBarArgs(location, this._terminalProfileService.availableProfiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu, this._disposableStore);\n\t\t\t\t\tthis._newDropdown.value = this._instantiationService.createInstance(DropdownWithPrimaryActionViewItem, action, actions.dropdownAction, actions.dropdownMenuActions, actions.className, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t\t\t\t\treturn this._newDropdown.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.getActionViewItem(action, options);\n\t}\n\n\tprivate _getDefaultProfileName(): string {\n\t\tlet defaultProfileName;\n\t\ttry {\n\t\t\tdefaultProfileName = this._terminalProfileService.getDefaultProfileName();\n\t\t} catch (e) {\n\t\t\tdefaultProfileName = this._terminalProfileResolverService.defaultProfileName;\n\t\t}\n\t\treturn defaultProfileName!;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IActionViewItem } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { DropdownWithPrimaryActionViewItem } from '../../../../platform/actions/browser/dropdownWithPrimaryActionViewItem.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IEditorOptions } from '../../../../platform/editor/common/editor.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { EditorPane } from '../../../browser/parts/editor/editorPane.js';\nimport { IEditorOpenContext } from '../../../common/editor.js';\nimport { ITerminalConfigurationService, ITerminalEditorService, ITerminalService, terminalEditorId } from './terminal.js';\nimport { TerminalEditorInput } from './terminalEditorInput.js';\nimport { getTerminalActionBarArgs } from './terminalMenus.js';\nimport { ITerminalProfileResolverService, ITerminalProfileService, TerminalCommandId } from '../common/terminal.js';\nimport { IEditorGroup } from '../../../services/editor/common/editorGroupsService.js';\nimport { openContextMenu } from './terminalContextMenu.js';\nimport { ACTIVE_GROUP } from '../../../services/editor/common/editorService.js';\nimport { IWorkbenchLayoutService, Parts } from '../../../services/layout/browser/layoutService.js';\nimport { IBaseActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { ITerminalProfile, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\n\nexport class TerminalEditor extends EditorPane {\n\n\tprivate _editorInstanceElement: HTMLElement | undefined;\n\tprivate _overflowGuardElement: HTMLElement | undefined;\n\n\tprivate _editorInput?: TerminalEditorInput = undefined;\n\n\tprivate _lastDimension?: dom.Dimension;\n\n\tprivate readonly _dropdownMenu: IMenu;\n\n\tprivate readonly _instanceMenu: IMenu;\n\n\tprivate _cancelContextMenu: boolean = false;\n\n\tprivate readonly _newDropdown: MutableDisposable<DropdownWithPrimaryActionViewItem> = this._register(new MutableDisposable());\n\n\tprivate readonly _disposableStore = this._register(new DisposableStore());\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@ITerminalEditorService private readonly _terminalEditorService: ITerminalEditorService,\n\t\t@ITerminalProfileResolverService private readonly _terminalProfileResolverService: ITerminalProfileResolverService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@ITerminalProfileService private readonly _terminalProfileService: ITerminalProfileService,\n\t\t@IWorkbenchLayoutService private readonly _workbenchLayoutService: IWorkbenchLayoutService\n\t) {\n\t\tsuper(terminalEditorId, group, telemetryService, themeService, storageService);\n\t\tthis._dropdownMenu = this._register(menuService.createMenu(MenuId.TerminalNewDropdownContext, contextKeyService));\n\t\tthis._instanceMenu = this._register(menuService.createMenu(MenuId.TerminalInstanceContext, contextKeyService));\n\t\tthis._register(this._terminalProfileService.onDidChangeAvailableProfiles(profiles => this._updateTabActionBar(profiles)));\n\t}\n\n\toverride async setInput(newInput: TerminalEditorInput, options: IEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken) {\n\t\tthis._editorInput?.terminalInstance?.detachFromElement();\n\t\tthis._editorInput = newInput;\n\t\tawait super.setInput(newInput, options, context, token);\n\t\tthis._editorInput.terminalInstance?.attachToElement(this._overflowGuardElement!);\n\t\tif (this._lastDimension) {\n\t\t\tthis.layout(this._lastDimension);\n\t\t}\n\t\tthis._editorInput.terminalInstance?.setVisible(this.isVisible() && this._workbenchLayoutService.isVisible(Parts.EDITOR_PART, this.window));\n\t\tif (this._editorInput.terminalInstance) {\n\t\t\t// since the editor does not monitor focus changes, for ex. between the terminal\n\t\t\t// panel and the editors, this is needed so that the active instance gets set\n\t\t\t// when focus changes between them.\n\t\t\tthis._register(this._editorInput.terminalInstance.onDidFocus(() => this._setActiveInstance()));\n\t\t\tthis._editorInput.setCopyLaunchConfig(this._editorInput.terminalInstance.shellLaunchConfig);\n\t\t}\n\t}\n\n\toverride clearInput(): void {\n\t\tsuper.clearInput();\n\t\tif (this._overflowGuardElement && this._editorInput?.terminalInstance?.domElement.parentElement === this._overflowGuardElement) {\n\t\t\tthis._editorInput.terminalInstance?.detachFromElement();\n\t\t}\n\t\tthis._editorInput = undefined;\n\t}\n\n\tprivate _setActiveInstance(): void {\n\t\tif (!this._editorInput?.terminalInstance) {\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalEditorService.setActiveInstance(this._editorInput.terminalInstance);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\n\t\tthis._editorInput?.terminalInstance?.focus(true);\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._editorInstanceElement = parent;\n\t\tthis._overflowGuardElement = dom.$('.terminal-overflow-guard.terminal-editor');\n\t\tthis._editorInstanceElement.appendChild(this._overflowGuardElement);\n\t\tthis._registerListeners();\n\t}\n\n\tprivate _registerListeners(): void {\n\t\tif (!this._editorInstanceElement) {\n\t\t\treturn;\n\t\t}\n\t\tthis._register(dom.addDisposableListener(this._editorInstanceElement, 'mousedown', async (event: MouseEvent) => {\n\t\t\tconst terminal = this._terminalEditorService.activeInstance;\n\t\t\tif (this._terminalEditorService.instances.length > 0 && terminal) {\n\t\t\t\tconst result = await terminal.handleMouseEvent(event, this._instanceMenu);\n\t\t\t\tif (typeof result === 'object' && result.cancelContextMenu) {\n\t\t\t\t\tthis._cancelContextMenu = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._editorInstanceElement, 'contextmenu', (event: MouseEvent) => {\n\t\t\tconst rightClickBehavior = this._terminalConfigurationService.config.rightClickBehavior;\n\t\t\tif (rightClickBehavior === 'nothing' && !event.shiftKey) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\tthis._cancelContextMenu = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif (!this._cancelContextMenu && rightClickBehavior !== 'copyPaste' && rightClickBehavior !== 'paste') {\n\t\t\t\t\tif (!this._cancelContextMenu) {\n\t\t\t\t\t\topenContextMenu(this.window, event, this._editorInput?.terminalInstance, this._instanceMenu, this._contextMenuService);\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\tthis._cancelContextMenu = false;\n\t\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _updateTabActionBar(profiles: ITerminalProfile[]): void {\n\t\tthis._disposableStore.clear();\n\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Editor, profiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu, this._disposableStore);\n\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t}\n\n\tlayout(dimension: dom.Dimension): void {\n\t\tconst instance = this._editorInput?.terminalInstance;\n\t\tif (instance) {\n\t\t\tinstance.attachToElement(this._overflowGuardElement!);\n\t\t\tinstance.layout(dimension);\n\t\t}\n\t\tthis._lastDimension = dimension;\n\t}\n\n\toverride setVisible(visible: boolean): void {\n\t\tsuper.setVisible(visible);\n\t\tthis._editorInput?.terminalInstance?.setVisible(visible && this._workbenchLayoutService.isVisible(Parts.EDITOR_PART, this.window));\n\t}\n\n\toverride getActionViewItem(action: IAction, options: IBaseActionViewItemOptions): IActionViewItem | undefined {\n\t\tswitch (action.id) {\n\t\t\tcase TerminalCommandId.CreateTerminalEditorSameGroup: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst location = { viewColumn: ACTIVE_GROUP };\n\t\t\t\t\tthis._disposableStore.clear();\n\t\t\t\t\tconst actions = getTerminalActionBarArgs(location, this._terminalProfileService.availableProfiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu, this._disposableStore);\n\t\t\t\t\tthis._newDropdown.value = this._instantiationService.createInstance(DropdownWithPrimaryActionViewItem, action, actions.dropdownAction, actions.dropdownMenuActions, actions.className, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t\tthis._newDropdown.value?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t\t\t\t\treturn this._newDropdown.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.getActionViewItem(action, options);\n\t}\n\n\tprivate _getDefaultProfileName(): string {\n\t\tlet defaultProfileName;\n\t\ttry {\n\t\t\tdefaultProfileName = this._terminalProfileService.getDefaultProfileName();\n\t\t} catch (e) {\n\t\t\tdefaultProfileName = this._terminalProfileResolverService.defaultProfileName;\n\t\t}\n\t\treturn defaultProfileName!;\n\t}\n}\n"]}