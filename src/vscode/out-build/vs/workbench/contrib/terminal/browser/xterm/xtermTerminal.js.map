{"version":3,"sources":["vs/workbench/contrib/terminal/browser/xterm/xtermTerminal.ts"],"names":[],"mappings":"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","file":"xtermTerminal.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IBuffer, ITerminalOptions, ITheme, Terminal as RawXtermTerminal, LogLevel as XtermLogLevel, IMarker as IXtermMarker } from '@xterm/xterm';\nimport type { ISearchOptions, SearchAddon as SearchAddonType } from '@xterm/addon-search';\nimport type { Unicode11Addon as Unicode11AddonType } from '@xterm/addon-unicode11';\nimport type { ILigatureOptions, LigaturesAddon as LigaturesAddonType } from '@xterm/addon-ligatures';\nimport type { WebglAddon as WebglAddonType } from '@xterm/addon-webgl';\nimport type { SerializeAddon as SerializeAddonType } from '@xterm/addon-serialize';\nimport type { ImageAddon as ImageAddonType } from '@xterm/addon-image';\nimport type { ClipboardAddon as ClipboardAddonType, ClipboardSelectionType } from '@xterm/addon-clipboard';\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { IXtermCore } from '../xterm-private.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IEditorOptions } from '../../../../../editor/common/config/editorOptions.js';\nimport { IShellIntegration, ITerminalLogService, TerminalSettingId, type IDecorationAddon } from '../../../../../platform/terminal/common/terminal.js';\nimport { ITerminalFont, ITerminalConfiguration } from '../../common/terminal.js';\nimport { IMarkTracker, IInternalXtermTerminal, IXtermTerminal, IXtermColorProvider, XtermTerminalConstants, IXtermAttachToElementOptions, IDetachedXtermTerminal, ITerminalConfigurationService } from '../terminal.js';\nimport { LogLevel } from '../../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { MarkNavigationAddon, ScrollPosition } from './markNavigationAddon.js';\nimport { localize } from '../../../../../nls.js';\nimport { IColorTheme, IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { PANEL_BACKGROUND } from '../../../../common/theme.js';\nimport { TERMINAL_FOREGROUND_COLOR, TERMINAL_BACKGROUND_COLOR, TERMINAL_CURSOR_FOREGROUND_COLOR, TERMINAL_CURSOR_BACKGROUND_COLOR, ansiColorIdentifiers, TERMINAL_SELECTION_BACKGROUND_COLOR, TERMINAL_FIND_MATCH_BACKGROUND_COLOR, TERMINAL_FIND_MATCH_HIGHLIGHT_BACKGROUND_COLOR, TERMINAL_FIND_MATCH_BORDER_COLOR, TERMINAL_OVERVIEW_RULER_FIND_MATCH_FOREGROUND_COLOR, TERMINAL_FIND_MATCH_HIGHLIGHT_BORDER_COLOR, TERMINAL_OVERVIEW_RULER_CURSOR_FOREGROUND_COLOR, TERMINAL_SELECTION_FOREGROUND_COLOR, TERMINAL_INACTIVE_SELECTION_BACKGROUND_COLOR, TERMINAL_OVERVIEW_RULER_BORDER_COLOR } from '../../common/terminalColorRegistry.js';\nimport { ShellIntegrationAddon } from '../../../../../platform/terminal/common/xterm/shellIntegrationAddon.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { DecorationAddon } from './decorationAddon.js';\nimport { ITerminalCapabilityStore, ITerminalCommand, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { IContextKey, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { TerminalContextKeys } from '../../common/terminalContextKey.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { debounce } from '../../../../../base/common/decorators.js';\nimport { MouseWheelClassifier } from '../../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { IMouseWheelEvent, StandardWheelEvent } from '../../../../../base/browser/mouseEvent.js';\nimport { ILayoutService } from '../../../../../platform/layout/browser/layoutService.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { scrollbarSliderActiveBackground, scrollbarSliderBackground, scrollbarSliderHoverBackground } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { XtermAddonImporter } from './xtermAddonImporter.js';\nimport { equals } from '../../../../../base/common/objects.js';\nimport type { IProgressState } from '@xterm/addon-progress';\nimport type { CommandDetectionCapability } from '../../../../../platform/terminal/common/capabilities/commandDetectionCapability.js';\nimport { URI } from '../../../../../base/common/uri.js';\n\nconst enum RenderConstants {\n\tSmoothScrollDuration = 125\n}\n\n\nfunction getFullBufferLineAsString(lineIndex: number, buffer: IBuffer): { lineData: string | undefined; lineIndex: number } {\n\tlet line = buffer.getLine(lineIndex);\n\tif (!line) {\n\t\treturn { lineData: undefined, lineIndex };\n\t}\n\tlet lineData = line.translateToString(true);\n\twhile (lineIndex > 0 && line.isWrapped) {\n\t\tline = buffer.getLine(--lineIndex);\n\t\tif (!line) {\n\t\t\tbreak;\n\t\t}\n\t\tlineData = line.translateToString(false) + lineData;\n\t}\n\treturn { lineData, lineIndex };\n}\n\nexport interface IXtermTerminalOptions {\n\t/** The columns to initialize the terminal with. */\n\tcols: number;\n\t/** The rows to initialize the terminal with. */\n\trows: number;\n\t/** The color provider for the terminal. */\n\txtermColorProvider: IXtermColorProvider;\n\t/** The capabilities of the terminal. */\n\tcapabilities: ITerminalCapabilityStore;\n\t/** The shell integration nonce to verify data coming from SI is trustworthy. */\n\tshellIntegrationNonce?: string;\n\t/** Whether to disable shell integration telemetry reporting. */\n\tdisableShellIntegrationReporting?: boolean;\n\t/** The object that imports xterm addons, set this to inject an importer in tests. */\n\txtermAddonImporter?: XtermAddonImporter;\n}\n\n/**\n * Wraps the xterm object with additional functionality. Interaction with the backing process is out\n * of the scope of this class.\n */\nexport class XtermTerminal extends Disposable implements IXtermTerminal, IDetachedXtermTerminal, IInternalXtermTerminal {\n\t/** The raw xterm.js instance */\n\treadonly raw: RawXtermTerminal;\n\tprivate _core: IXtermCore;\n\tprivate readonly _xtermAddonLoader: XtermAddonImporter;\n\tprivate readonly _xtermColorProvider: IXtermColorProvider;\n\tprivate readonly _capabilities: ITerminalCapabilityStore;\n\n\tprivate static _suggestedRendererType: 'dom' | undefined = undefined;\n\tprivate _attached?: { container: HTMLElement; options: IXtermAttachToElementOptions };\n\tprivate _isPhysicalMouseWheel = MouseWheelClassifier.INSTANCE.isPhysicalMouseWheel();\n\tprivate _lastInputEvent: string | undefined;\n\tget lastInputEvent(): string | undefined { return this._lastInputEvent; }\n\tprivate _progressState: IProgressState = { state: 0, value: 0 };\n\tget progressState(): IProgressState { return this._progressState; }\n\n\t// Always on addons\n\tprivate _markNavigationAddon: MarkNavigationAddon;\n\tprivate _shellIntegrationAddon: ShellIntegrationAddon;\n\tprivate _decorationAddon: DecorationAddon;\n\n\t// Always on dynamicly imported addons\n\tprivate _clipboardAddon?: ClipboardAddonType;\n\n\t// Optional addons\n\tprivate _searchAddon?: SearchAddonType;\n\tprivate _unicode11Addon?: Unicode11AddonType;\n\tprivate _webglAddon?: WebglAddonType;\n\tprivate _serializeAddon?: SerializeAddonType;\n\tprivate _imageAddon?: ImageAddonType;\n\tprivate readonly _ligaturesAddon: MutableDisposable<LigaturesAddonType> = this._register(new MutableDisposable());\n\tprivate readonly _ligaturesAddonConfig?: ILigatureOptions;\n\n\tprivate readonly _attachedDisposables = this._register(new DisposableStore());\n\tprivate readonly _anyTerminalFocusContextKey: IContextKey<boolean>;\n\tprivate readonly _anyFocusedTerminalHasSelection: IContextKey<boolean>;\n\n\tprivate _lastFindResult: { resultIndex: number; resultCount: number } | undefined;\n\tget findResult(): { resultIndex: number; resultCount: number } | undefined { return this._lastFindResult; }\n\n\tget isStdinDisabled(): boolean { return !!this.raw.options.disableStdin; }\n\tget isGpuAccelerated(): boolean { return !!this._webglAddon; }\n\n\tprivate readonly _onDidRequestRunCommand = this._register(new Emitter<{ command: ITerminalCommand; noNewLine?: boolean }>());\n\treadonly onDidRequestRunCommand = this._onDidRequestRunCommand.event;\n\tprivate readonly _onDidRequestCopyAsHtml = this._register(new Emitter<{ command: ITerminalCommand }>());\n\treadonly onDidRequestCopyAsHtml = this._onDidRequestCopyAsHtml.event;\n\tprivate readonly _onDidRequestRefreshDimensions = this._register(new Emitter<void>());\n\treadonly onDidRequestRefreshDimensions = this._onDidRequestRefreshDimensions.event;\n\tprivate readonly _onDidChangeFindResults = this._register(new Emitter<{ resultIndex: number; resultCount: number }>());\n\treadonly onDidChangeFindResults = this._onDidChangeFindResults.event;\n\tprivate readonly _onDidChangeSelection = this._register(new Emitter<void>());\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\tprivate readonly _onDidChangeFocus = this._register(new Emitter<boolean>());\n\treadonly onDidChangeFocus = this._onDidChangeFocus.event;\n\tprivate readonly _onDidDispose = this._register(new Emitter<void>());\n\treadonly onDidDispose = this._onDidDispose.event;\n\tprivate readonly _onDidChangeProgress = this._register(new Emitter<IProgressState>());\n\treadonly onDidChangeProgress = this._onDidChangeProgress.event;\n\n\tget markTracker(): IMarkTracker { return this._markNavigationAddon; }\n\tget shellIntegration(): IShellIntegration { return this._shellIntegrationAddon; }\n\tget decorationAddon(): IDecorationAddon { return this._decorationAddon; }\n\n\tget textureAtlas(): Promise<ImageBitmap> | undefined {\n\t\tconst canvas = this._webglAddon?.textureAtlas;\n\t\tif (!canvas) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn createImageBitmap(canvas);\n\t}\n\n\tpublic get isFocused() {\n\t\tif (!this.raw.element) {\n\t\t\treturn false;\n\t\t}\n\t\treturn dom.isAncestorOfActiveElement(this.raw.element);\n\t}\n\n\t/**\n\t * @param xtermCtor The xterm.js constructor, this is passed in so it can be fetched lazily\n\t * outside of this class such that {@link raw} is not nullable.\n\t */\n\tconstructor(\n\t\tresource: URI | undefined,\n\t\txtermCtor: typeof RawXtermTerminal,\n\t\toptions: IXtermTerminalOptions,\n\t\tprivate readonly _onDidExecuteText: Event<void> | undefined,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ITerminalLogService private readonly _logService: ITerminalLogService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@IClipboardService private readonly _clipboardService: IClipboardService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IAccessibilitySignalService private readonly _accessibilitySignalService: IAccessibilitySignalService,\n\t\t@ILayoutService layoutService: ILayoutService\n\t) {\n\t\tsuper();\n\n\t\tthis._xtermAddonLoader = options.xtermAddonImporter ?? new XtermAddonImporter();\n\t\tthis._xtermColorProvider = options.xtermColorProvider;\n\t\tthis._capabilities = options.capabilities;\n\n\t\tconst font = this._terminalConfigurationService.getFont(dom.getActiveWindow(), undefined, true);\n\t\tconst config = this._terminalConfigurationService.config;\n\t\tconst editorOptions = this._configurationService.getValue<IEditorOptions>('editor');\n\n\t\tthis.raw = this._register(new xtermCtor({\n\t\t\tallowProposedApi: true,\n\t\t\tcols: options.cols,\n\t\t\trows: options.rows,\n\t\t\tdocumentOverride: layoutService.mainContainer.ownerDocument,\n\t\t\taltClickMovesCursor: config.altClickMovesCursor && editorOptions.multiCursorModifier === 'alt',\n\t\t\tscrollback: config.scrollback,\n\t\t\ttheme: this.getXtermTheme(),\n\t\t\tdrawBoldTextInBrightColors: config.drawBoldTextInBrightColors,\n\t\t\tfontFamily: font.fontFamily,\n\t\t\tfontWeight: config.fontWeight,\n\t\t\tfontWeightBold: config.fontWeightBold,\n\t\t\tfontSize: font.fontSize,\n\t\t\tletterSpacing: font.letterSpacing,\n\t\t\tlineHeight: font.lineHeight,\n\t\t\tlogLevel: vscodeToXtermLogLevel(this._logService.getLevel()),\n\t\t\tlogger: this._logService,\n\t\t\tminimumContrastRatio: config.minimumContrastRatio,\n\t\t\ttabStopWidth: config.tabStopWidth,\n\t\t\tcursorBlink: config.cursorBlinking,\n\t\t\tcursorStyle: vscodeToXtermCursorStyle<'cursorStyle'>(config.cursorStyle),\n\t\t\tcursorInactiveStyle: vscodeToXtermCursorStyle(config.cursorStyleInactive),\n\t\t\tcursorWidth: config.cursorWidth,\n\t\t\tmacOptionIsMeta: config.macOptionIsMeta,\n\t\t\tmacOptionClickForcesSelection: config.macOptionClickForcesSelection,\n\t\t\trightClickSelectsWord: config.rightClickBehavior === 'selectWord',\n\t\t\tfastScrollModifier: 'alt',\n\t\t\tfastScrollSensitivity: config.fastScrollSensitivity,\n\t\t\tscrollSensitivity: config.mouseWheelScrollSensitivity,\n\t\t\tscrollOnEraseInDisplay: true,\n\t\t\twordSeparator: config.wordSeparators,\n\t\t\toverviewRuler: {\n\t\t\t\twidth: 14,\n\t\t\t\tshowTopBorder: true,\n\t\t\t},\n\t\t\tignoreBracketedPasteMode: config.ignoreBracketedPasteMode,\n\t\t\trescaleOverlappingGlyphs: config.rescaleOverlappingGlyphs,\n\t\t\twindowOptions: {\n\t\t\t\tgetWinSizePixels: true,\n\t\t\t\tgetCellSizePixels: true,\n\t\t\t\tgetWinSizeChars: true,\n\t\t\t},\n\t\t}));\n\t\tthis._updateSmoothScrolling();\n\t\tinterface ITerminalWithCore extends RawXtermTerminal {\n\t\t\t_core: IXtermCore;\n\t\t}\n\t\tthis._core = (this.raw as ITerminalWithCore)._core as IXtermCore;\n\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(async e => {\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.GpuAcceleration)) {\n\t\t\t\tXtermTerminal._suggestedRendererType = undefined;\n\t\t\t}\n\t\t\tif (e.affectsConfiguration('terminal.integrated') || e.affectsConfiguration('editor.fastScrollSensitivity') || e.affectsConfiguration('editor.mouseWheelScrollSensitivity') || e.affectsConfiguration('editor.multiCursorModifier')) {\n\t\t\t\tthis.updateConfig();\n\t\t\t}\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.UnicodeVersion)) {\n\t\t\t\tthis._updateUnicodeVersion();\n\t\t\t}\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.ShellIntegrationDecorationsEnabled)) {\n\t\t\t\tthis._updateTheme();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._themeService.onDidColorThemeChange(theme => this._updateTheme(theme)));\n\t\tthis._register(this._logService.onDidChangeLogLevel(e => this.raw.options.logLevel = vscodeToXtermLogLevel(e)));\n\n\t\t// Refire events\n\t\tthis._register(this.raw.onSelectionChange(() => {\n\t\t\tthis._onDidChangeSelection.fire();\n\t\t\tif (this.isFocused) {\n\t\t\t\tthis._anyFocusedTerminalHasSelection.set(this.raw.hasSelection());\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.raw.onData(e => this._lastInputEvent = e));\n\n\t\t// Load addons\n\t\tthis._updateUnicodeVersion();\n\t\tthis._markNavigationAddon = this._instantiationService.createInstance(MarkNavigationAddon, options.capabilities);\n\t\tthis.raw.loadAddon(this._markNavigationAddon);\n\t\tthis._decorationAddon = this._instantiationService.createInstance(DecorationAddon, resource, this._capabilities);\n\t\tthis._register(this._decorationAddon.onDidRequestRunCommand(e => this._onDidRequestRunCommand.fire(e)));\n\t\tthis._register(this._decorationAddon.onDidRequestCopyAsHtml(e => this._onDidRequestCopyAsHtml.fire(e)));\n\t\tthis.raw.loadAddon(this._decorationAddon);\n\t\tthis._shellIntegrationAddon = new ShellIntegrationAddon(options.shellIntegrationNonce ?? '', options.disableShellIntegrationReporting, this._onDidExecuteText, this._telemetryService, this._logService);\n\t\tthis.raw.loadAddon(this._shellIntegrationAddon);\n\t\tthis._xtermAddonLoader.importAddon('clipboard').then(ClipboardAddon => {\n\t\t\tif (this._store.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._clipboardAddon = this._instantiationService.createInstance(ClipboardAddon, undefined, {\n\t\t\t\tasync readText(type: ClipboardSelectionType): Promise<string> {\n\t\t\t\t\treturn _clipboardService.readText(type === 'p' ? 'selection' : 'clipboard');\n\t\t\t\t},\n\t\t\t\tasync writeText(type: ClipboardSelectionType, text: string): Promise<void> {\n\t\t\t\t\treturn _clipboardService.writeText(text, type === 'p' ? 'selection' : 'clipboard');\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.raw.loadAddon(this._clipboardAddon);\n\t\t});\n\t\tthis._xtermAddonLoader.importAddon('progress').then(ProgressAddon => {\n\t\t\tif (this._store.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst progressAddon = this._instantiationService.createInstance(ProgressAddon);\n\t\t\tthis.raw.loadAddon(progressAddon);\n\t\t\tconst updateProgress = () => {\n\t\t\t\tif (!equals(this._progressState, progressAddon.progress)) {\n\t\t\t\t\tthis._progressState = progressAddon.progress;\n\t\t\t\t\tthis._onDidChangeProgress.fire(this._progressState);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._register(progressAddon.onChange(() => updateProgress()));\n\t\t\tupdateProgress();\n\t\t\tconst commandDetection = this._capabilities.get(TerminalCapability.CommandDetection);\n\t\t\tif (commandDetection) {\n\t\t\t\tthis._register(commandDetection.onCommandFinished(() => progressAddon.progress = { state: 0, value: 0 }));\n\t\t\t} else {\n\t\t\t\tconst disposable = this._capabilities.onDidAddCapability(e => {\n\t\t\t\t\tif (e.id === TerminalCapability.CommandDetection) {\n\t\t\t\t\t\tthis._register((e.capability as CommandDetectionCapability).onCommandFinished(() => progressAddon.progress = { state: 0, value: 0 }));\n\t\t\t\t\t\tthis._store.delete(disposable);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._store.add(disposable);\n\t\t\t}\n\t\t});\n\n\t\tthis._anyTerminalFocusContextKey = TerminalContextKeys.focusInAny.bindTo(contextKeyService);\n\t\tthis._anyFocusedTerminalHasSelection = TerminalContextKeys.textSelectedInFocused.bindTo(contextKeyService);\n\t}\n\n\t*getBufferReverseIterator(): IterableIterator<string> {\n\t\tfor (let i = this.raw.buffer.active.length - 1; i >= 0; i--) {\n\t\t\tconst { lineData, lineIndex } = getFullBufferLineAsString(i, this.raw.buffer.active);\n\t\t\tif (lineData) {\n\t\t\t\ti = lineIndex;\n\t\t\t\tyield lineData;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContentsAsText(startMarker?: IXtermMarker, endMarker?: IXtermMarker): string {\n\t\tconst lines: string[] = [];\n\t\tconst buffer = this.raw.buffer.active;\n\t\tif (startMarker?.line === -1) {\n\t\t\tthrow new Error('Cannot get contents of a disposed startMarker');\n\t\t}\n\t\tif (endMarker?.line === -1) {\n\t\t\tthrow new Error('Cannot get contents of a disposed endMarker');\n\t\t}\n\t\tconst startLine = startMarker?.line ?? 0;\n\t\tconst endLine = endMarker?.line ?? buffer.length - 1;\n\t\tfor (let y = startLine; y <= endLine; y++) {\n\t\t\tlines.push(buffer.getLine(y)?.translateToString(true) ?? '');\n\t\t}\n\t\treturn lines.join('\\n');\n\t}\n\n\tasync getContentsAsHtml(): Promise<string> {\n\t\tif (!this._serializeAddon) {\n\t\t\tconst Addon = await this._xtermAddonLoader.importAddon('serialize');\n\t\t\tthis._serializeAddon = new Addon();\n\t\t\tthis.raw.loadAddon(this._serializeAddon);\n\t\t}\n\n\t\treturn this._serializeAddon.serializeAsHTML();\n\t}\n\n\tasync getCommandOutputAsHtml(command: ITerminalCommand, maxLines: number): Promise<{ text: string; truncated?: boolean }> {\n\t\tif (!this._serializeAddon) {\n\t\t\tconst Addon = await this._xtermAddonLoader.importAddon('serialize');\n\t\t\tthis._serializeAddon = new Addon();\n\t\t\tthis.raw.loadAddon(this._serializeAddon);\n\t\t}\n\t\tlet startLine: number;\n\t\tlet startCol: number;\n\t\tif (command.executedMarker && command.executedMarker.line >= 0) {\n\t\t\tstartLine = command.executedMarker.line;\n\t\t\tstartCol = Math.max(command.executedX ?? 0, 0);\n\t\t} else {\n\t\t\tstartLine = command.marker?.line !== undefined ? command.marker.line + 1 : 1;\n\t\t\tstartCol = Math.max(command.startX ?? 0, 0);\n\t\t}\n\n\t\tlet endLine = command.endMarker?.line !== undefined ? command.endMarker.line - 1 : this.raw.buffer.active.length - 1;\n\t\tif (endLine < startLine) {\n\t\t\treturn { text: '', truncated: false };\n\t\t}\n\t\t// Trim empty lines from the end\n\t\tlet emptyLinesFromEnd = 0;\n\t\tfor (let i = endLine; i >= startLine; i--) {\n\t\t\tconst line = this.raw.buffer.active.getLine(i);\n\t\t\tif (line && line.translateToString(true).trim() === '') {\n\t\t\t\temptyLinesFromEnd++;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tendLine = endLine - emptyLinesFromEnd;\n\n\t\t// Trim empty lines from the start\n\t\tlet emptyLinesFromStart = 0;\n\t\tfor (let i = startLine; i <= endLine; i++) {\n\t\t\tconst line = this.raw.buffer.active.getLine(i);\n\t\t\tif (line && line.translateToString(true, i === startLine ? startCol : undefined).trim() === '') {\n\t\t\t\tif (i === startLine) {\n\t\t\t\t\tstartCol = 0;\n\t\t\t\t}\n\t\t\t\temptyLinesFromStart++;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstartLine = startLine + emptyLinesFromStart;\n\n\t\tif (maxLines && endLine - startLine > maxLines) {\n\t\t\tstartLine = endLine - maxLines;\n\t\t\tstartCol = 0;\n\t\t}\n\n\t\tconst bufferLine = this.raw.buffer.active.getLine(startLine);\n\t\tif (bufferLine) {\n\t\t\tstartCol = Math.min(startCol, bufferLine.length);\n\t\t}\n\n\t\tconst range = { startLine, endLine, startCol };\n\t\tconst result = this._serializeAddon.serializeAsHTML({ range });\n\t\treturn { text: result, truncated: (endLine - startLine) >= maxLines };\n\t}\n\n\tasync getSelectionAsHtml(command?: ITerminalCommand): Promise<string> {\n\t\tif (!this._serializeAddon) {\n\t\t\tconst Addon = await this._xtermAddonLoader.importAddon('serialize');\n\t\t\tthis._serializeAddon = new Addon();\n\t\t\tthis.raw.loadAddon(this._serializeAddon);\n\t\t}\n\t\tif (command) {\n\t\t\tconst length = command.getOutput()?.length;\n\t\t\tconst row = command.marker?.line;\n\t\t\tif (!length || !row) {\n\t\t\t\tthrow new Error(`No row ${row} or output length ${length} for command ${command}`);\n\t\t\t}\n\t\t\tthis.raw.select(0, row + 1, length - Math.floor(length / this.raw.cols));\n\t\t}\n\t\tconst result = this._serializeAddon.serializeAsHTML({ onlySelection: true });\n\t\tif (command) {\n\t\t\tthis.raw.clearSelection();\n\t\t}\n\t\treturn result;\n\t}\n\n\tattachToElement(container: HTMLElement, partialOptions?: Partial<IXtermAttachToElementOptions>): HTMLElement {\n\t\tconst options: IXtermAttachToElementOptions = { enableGpu: true, ...partialOptions };\n\t\tif (!this._attached) {\n\t\t\tthis.raw.open(container);\n\t\t}\n\n\t\t// TODO: Move before open so the DOM renderer doesn't initialize\n\t\tif (options.enableGpu) {\n\t\t\tif (this._shouldLoadWebgl()) {\n\t\t\t\tthis._enableWebglRenderer();\n\t\t\t}\n\t\t}\n\n\t\tif (!this.raw.element || !this.raw.textarea) {\n\t\t\tthrow new Error('xterm elements not set after open');\n\t\t}\n\n\t\tconst ad = this._attachedDisposables;\n\t\tad.clear();\n\t\tad.add(dom.addDisposableListener(this.raw.textarea, 'focus', () => this._setFocused(true)));\n\t\tad.add(dom.addDisposableListener(this.raw.textarea, 'blur', () => this._setFocused(false)));\n\t\tad.add(dom.addDisposableListener(this.raw.textarea, 'focusout', () => this._setFocused(false)));\n\n\t\t// Track wheel events in mouse wheel classifier and update smoothScrolling when it changes\n\t\t// as it must be disabled when a trackpad is used\n\t\tad.add(dom.addDisposableListener(this.raw.element, dom.EventType.MOUSE_WHEEL, (e: IMouseWheelEvent) => {\n\t\t\tconst classifier = MouseWheelClassifier.INSTANCE;\n\t\t\tclassifier.acceptStandardWheelEvent(new StandardWheelEvent(e));\n\t\t\tconst value = classifier.isPhysicalMouseWheel();\n\t\t\tif (value !== this._isPhysicalMouseWheel) {\n\t\t\t\tthis._isPhysicalMouseWheel = value;\n\t\t\t\tthis._updateSmoothScrolling();\n\t\t\t}\n\t\t}, { passive: true }));\n\n\t\tthis._refreshLigaturesAddon();\n\n\t\tthis._attached = { container, options };\n\t\t// Screen must be created at this point as xterm.open is called\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\treturn this._attached?.container.querySelector('.xterm-screen')!;\n\t}\n\n\tprivate _setFocused(isFocused: boolean) {\n\t\tthis._onDidChangeFocus.fire(isFocused);\n\t\tthis._anyTerminalFocusContextKey.set(isFocused);\n\t\tthis._anyFocusedTerminalHasSelection.set(isFocused && this.raw.hasSelection());\n\t}\n\n\twrite(data: string | Uint8Array, callback?: () => void): void {\n\t\tthis.raw.write(data, callback);\n\t}\n\n\tresize(columns: number, rows: number): void {\n\t\tthis._logService.debug('resizing', columns, rows);\n\t\tthis.raw.resize(columns, rows);\n\t}\n\n\tupdateConfig(): void {\n\t\tconst config = this._terminalConfigurationService.config;\n\t\tthis.raw.options.altClickMovesCursor = config.altClickMovesCursor;\n\t\tthis._setCursorBlink(config.cursorBlinking);\n\t\tthis._setCursorStyle(config.cursorStyle);\n\t\tthis._setCursorStyleInactive(config.cursorStyleInactive);\n\t\tthis._setCursorWidth(config.cursorWidth);\n\t\tthis.raw.options.scrollback = config.scrollback;\n\t\tthis.raw.options.drawBoldTextInBrightColors = config.drawBoldTextInBrightColors;\n\t\tthis.raw.options.minimumContrastRatio = config.minimumContrastRatio;\n\t\tthis.raw.options.tabStopWidth = config.tabStopWidth;\n\t\tthis.raw.options.fastScrollSensitivity = config.fastScrollSensitivity;\n\t\tthis.raw.options.scrollSensitivity = config.mouseWheelScrollSensitivity;\n\t\tthis.raw.options.macOptionIsMeta = config.macOptionIsMeta;\n\t\tconst editorOptions = this._configurationService.getValue<IEditorOptions>('editor');\n\t\tthis.raw.options.altClickMovesCursor = config.altClickMovesCursor && editorOptions.multiCursorModifier === 'alt';\n\t\tthis.raw.options.macOptionClickForcesSelection = config.macOptionClickForcesSelection;\n\t\tthis.raw.options.rightClickSelectsWord = config.rightClickBehavior === 'selectWord';\n\t\tthis.raw.options.wordSeparator = config.wordSeparators;\n\t\tthis.raw.options.customGlyphs = config.customGlyphs;\n\t\tthis.raw.options.ignoreBracketedPasteMode = config.ignoreBracketedPasteMode;\n\t\tthis.raw.options.rescaleOverlappingGlyphs = config.rescaleOverlappingGlyphs;\n\t\tthis.raw.options.overviewRuler = {\n\t\t\twidth: 14,\n\t\t\tshowTopBorder: true,\n\t\t};\n\t\tthis._updateSmoothScrolling();\n\t\tif (this._attached) {\n\t\t\tif (this._attached.options.enableGpu) {\n\t\t\t\tif (this._shouldLoadWebgl()) {\n\t\t\t\t\tthis._enableWebglRenderer();\n\t\t\t\t} else {\n\t\t\t\t\tthis._disposeOfWebglRenderer();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._refreshLigaturesAddon();\n\t\t}\n\t}\n\n\tprivate _updateSmoothScrolling() {\n\t\tthis.raw.options.smoothScrollDuration = this._terminalConfigurationService.config.smoothScrolling && this._isPhysicalMouseWheel ? RenderConstants.SmoothScrollDuration : 0;\n\t}\n\n\tprivate _shouldLoadWebgl(): boolean {\n\t\treturn (this._terminalConfigurationService.config.gpuAcceleration === 'auto' && XtermTerminal._suggestedRendererType === undefined) || this._terminalConfigurationService.config.gpuAcceleration === 'on';\n\t}\n\n\tforceRedraw() {\n\t\tthis.raw.clearTextureAtlas();\n\t}\n\n\tclearDecorations(): void {\n\t\tthis._decorationAddon?.clearDecorations();\n\t}\n\n\tforceRefresh() {\n\t\tthis._core.viewport?._innerRefresh();\n\t}\n\n\tasync findNext(term: string, searchOptions: ISearchOptions): Promise<boolean> {\n\t\tthis._updateFindColors(searchOptions);\n\t\treturn (await this._getSearchAddon()).findNext(term, searchOptions);\n\t}\n\n\tasync findPrevious(term: string, searchOptions: ISearchOptions): Promise<boolean> {\n\t\tthis._updateFindColors(searchOptions);\n\t\treturn (await this._getSearchAddon()).findPrevious(term, searchOptions);\n\t}\n\n\tprivate _updateFindColors(searchOptions: ISearchOptions): void {\n\t\tconst theme = this._themeService.getColorTheme();\n\t\t// Theme color names align with monaco/vscode whereas xterm.js has some different naming.\n\t\t// The mapping is as follows:\n\t\t// - findMatch -> activeMatch\n\t\t// - findMatchHighlight -> match\n\t\tconst terminalBackground = theme.getColor(TERMINAL_BACKGROUND_COLOR) || theme.getColor(PANEL_BACKGROUND);\n\t\tconst findMatchBackground = theme.getColor(TERMINAL_FIND_MATCH_BACKGROUND_COLOR);\n\t\tconst findMatchBorder = theme.getColor(TERMINAL_FIND_MATCH_BORDER_COLOR);\n\t\tconst findMatchOverviewRuler = theme.getColor(TERMINAL_OVERVIEW_RULER_CURSOR_FOREGROUND_COLOR);\n\t\tconst findMatchHighlightBackground = theme.getColor(TERMINAL_FIND_MATCH_HIGHLIGHT_BACKGROUND_COLOR);\n\t\tconst findMatchHighlightBorder = theme.getColor(TERMINAL_FIND_MATCH_HIGHLIGHT_BORDER_COLOR);\n\t\tconst findMatchHighlightOverviewRuler = theme.getColor(TERMINAL_OVERVIEW_RULER_FIND_MATCH_FOREGROUND_COLOR);\n\t\tsearchOptions.decorations = {\n\t\t\tactiveMatchBackground: findMatchBackground?.toString(),\n\t\t\tactiveMatchBorder: findMatchBorder?.toString() || 'transparent',\n\t\t\tactiveMatchColorOverviewRuler: findMatchOverviewRuler?.toString() || 'transparent',\n\t\t\t// decoration bgs don't support the alpha channel so blend it with the regular bg\n\t\t\tmatchBackground: terminalBackground ? findMatchHighlightBackground?.blend(terminalBackground).toString() : undefined,\n\t\t\tmatchBorder: findMatchHighlightBorder?.toString() || 'transparent',\n\t\t\tmatchOverviewRuler: findMatchHighlightOverviewRuler?.toString() || 'transparent'\n\t\t};\n\t}\n\n\tprivate _searchAddonPromise: Promise<SearchAddonType> | undefined;\n\tprivate _getSearchAddon(): Promise<SearchAddonType> {\n\t\tif (!this._searchAddonPromise) {\n\t\t\tthis._searchAddonPromise = this._xtermAddonLoader.importAddon('search').then((AddonCtor) => {\n\t\t\t\tif (this._store.isDisposed) {\n\t\t\t\t\treturn Promise.reject('Could not create search addon, terminal is disposed');\n\t\t\t\t}\n\t\t\t\tthis._searchAddon = new AddonCtor({ highlightLimit: XtermTerminalConstants.SearchHighlightLimit });\n\t\t\t\tthis.raw.loadAddon(this._searchAddon);\n\t\t\t\tthis._searchAddon.onDidChangeResults((results: { resultIndex: number; resultCount: number }) => {\n\t\t\t\t\tthis._lastFindResult = results;\n\t\t\t\t\tthis._onDidChangeFindResults.fire(results);\n\t\t\t\t});\n\t\t\t\treturn this._searchAddon;\n\t\t\t});\n\t\t}\n\t\treturn this._searchAddonPromise;\n\t}\n\n\tclearSearchDecorations(): void {\n\t\tthis._searchAddon?.clearDecorations();\n\t}\n\n\tclearActiveSearchDecoration(): void {\n\t\tthis._searchAddon?.clearActiveDecoration();\n\t}\n\n\tgetFont(): ITerminalFont {\n\t\treturn this._terminalConfigurationService.getFont(dom.getWindow(this.raw.element), this._core);\n\t}\n\n\tgetLongestViewportWrappedLineLength(): number {\n\t\tlet maxLineLength = 0;\n\t\tfor (let i = this.raw.buffer.active.length - 1; i >= this.raw.buffer.active.viewportY; i--) {\n\t\t\tconst lineInfo = this._getWrappedLineCount(i, this.raw.buffer.active);\n\t\t\tmaxLineLength = Math.max(maxLineLength, ((lineInfo.lineCount * this.raw.cols) - lineInfo.endSpaces) || 0);\n\t\t\ti = lineInfo.currentIndex;\n\t\t}\n\t\treturn maxLineLength;\n\t}\n\n\tprivate _getWrappedLineCount(index: number, buffer: IBuffer): { lineCount: number; currentIndex: number; endSpaces: number } {\n\t\tlet line = buffer.getLine(index);\n\t\tif (!line) {\n\t\t\tthrow new Error('Could not get line');\n\t\t}\n\t\tlet currentIndex = index;\n\t\tlet endSpaces = 0;\n\t\t// line.length may exceed cols as it doesn't necessarily trim the backing array on resize\n\t\tfor (let i = Math.min(line.length, this.raw.cols) - 1; i >= 0; i--) {\n\t\t\tif (!line?.getCell(i)?.getChars()) {\n\t\t\t\tendSpaces++;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\twhile (line?.isWrapped && currentIndex > 0) {\n\t\t\tcurrentIndex--;\n\t\t\tline = buffer.getLine(currentIndex);\n\t\t}\n\t\treturn { lineCount: index - currentIndex + 1, currentIndex, endSpaces };\n\t}\n\n\tscrollDownLine(): void {\n\t\tthis.raw.scrollLines(1);\n\t}\n\n\tscrollDownPage(): void {\n\t\tthis.raw.scrollPages(1);\n\t}\n\n\tscrollToBottom(): void {\n\t\tthis.raw.scrollToBottom();\n\t}\n\n\tscrollUpLine(): void {\n\t\tthis.raw.scrollLines(-1);\n\t}\n\n\tscrollUpPage(): void {\n\t\tthis.raw.scrollPages(-1);\n\t}\n\n\tscrollToTop(): void {\n\t\tthis.raw.scrollToTop();\n\t}\n\n\tscrollToLine(line: number, position: ScrollPosition = ScrollPosition.Top): void {\n\t\tthis.markTracker.scrollToLine(line, position);\n\t}\n\n\tclearBuffer(): void {\n\t\tthis.raw.clear();\n\t\t// xterm.js does not clear the first prompt, so trigger these to simulate\n\t\t// the prompt being written\n\t\tthis._capabilities.get(TerminalCapability.CommandDetection)?.handlePromptStart();\n\t\tthis._capabilities.get(TerminalCapability.CommandDetection)?.handleCommandStart();\n\t\tthis._accessibilitySignalService.playSignal(AccessibilitySignal.clear);\n\t}\n\n\thasSelection(): boolean {\n\t\treturn this.raw.hasSelection();\n\t}\n\n\tclearSelection(): void {\n\t\tthis.raw.clearSelection();\n\t}\n\n\tselectMarkedRange(fromMarkerId: string, toMarkerId: string, scrollIntoView = false) {\n\t\tconst detectionCapability = this.shellIntegration.capabilities.get(TerminalCapability.BufferMarkDetection);\n\t\tif (!detectionCapability) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst start = detectionCapability.getMark(fromMarkerId);\n\t\tconst end = detectionCapability.getMark(toMarkerId);\n\t\tif (start === undefined || end === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.raw.selectLines(start.line, end.line);\n\t\tif (scrollIntoView) {\n\t\t\tthis.raw.scrollToLine(start.line);\n\t\t}\n\t}\n\n\tselectAll(): void {\n\t\tthis.raw.focus();\n\t\tthis.raw.selectAll();\n\t}\n\n\tfocus(): void {\n\t\tthis.raw.focus();\n\t}\n\n\tasync copySelection(asHtml?: boolean, command?: ITerminalCommand): Promise<void> {\n\t\tif (this.hasSelection() || (asHtml && command)) {\n\t\t\tif (asHtml) {\n\t\t\t\tconst textAsHtml = await this.getSelectionAsHtml(command);\n\t\t\t\tfunction listener(e: ClipboardEvent) {\n\t\t\t\t\tif (e.clipboardData) {\n\t\t\t\t\t\tif (!e.clipboardData.types.includes('text/plain')) {\n\t\t\t\t\t\t\te.clipboardData.setData('text/plain', command?.getOutput() ?? '');\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.clipboardData.setData('text/html', textAsHtml);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tconst doc = dom.getDocument(this.raw.element);\n\t\t\t\tdoc.addEventListener('copy', listener);\n\t\t\t\tdoc.execCommand('copy');\n\t\t\t\tdoc.removeEventListener('copy', listener);\n\t\t\t} else {\n\t\t\t\tawait this._clipboardService.writeText(this.raw.getSelection());\n\t\t\t}\n\t\t} else {\n\t\t\tthis._notificationService.warn(localize('terminal.integrated.copySelection.noSelection', 'The terminal has no selection to copy'));\n\t\t}\n\t}\n\n\tprivate _setCursorBlink(blink: boolean): void {\n\t\tif (this.raw.options.cursorBlink !== blink) {\n\t\t\tthis.raw.options.cursorBlink = blink;\n\t\t\tthis.raw.refresh(0, this.raw.rows - 1);\n\t\t}\n\t}\n\n\tprivate _setCursorStyle(style: ITerminalConfiguration['cursorStyle']): void {\n\t\tconst mapped = vscodeToXtermCursorStyle<'cursorStyle'>(style);\n\t\tif (this.raw.options.cursorStyle !== mapped) {\n\t\t\tthis.raw.options.cursorStyle = mapped;\n\t\t}\n\t}\n\n\tprivate _setCursorStyleInactive(style: ITerminalConfiguration['cursorStyleInactive']): void {\n\t\tconst mapped = vscodeToXtermCursorStyle(style);\n\t\tif (this.raw.options.cursorInactiveStyle !== mapped) {\n\t\t\tthis.raw.options.cursorInactiveStyle = mapped;\n\t\t}\n\t}\n\n\tprivate _setCursorWidth(width: number): void {\n\t\tif (this.raw.options.cursorWidth !== width) {\n\t\t\tthis.raw.options.cursorWidth = width;\n\t\t}\n\t}\n\n\tprivate async _enableWebglRenderer(): Promise<void> {\n\t\tif (!this.raw.element || this._webglAddon) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst Addon = await this._xtermAddonLoader.importAddon('webgl');\n\t\tthis._webglAddon = new Addon();\n\t\ttry {\n\t\t\tthis.raw.loadAddon(this._webglAddon);\n\t\t\tthis._logService.trace('Webgl was loaded');\n\t\t\tthis._webglAddon.onContextLoss(() => {\n\t\t\t\tthis._logService.info(`Webgl lost context, disposing of webgl renderer`);\n\t\t\t\tthis._disposeOfWebglRenderer();\n\t\t\t});\n\t\t\tthis._refreshImageAddon();\n\t\t\t// WebGL renderer cell dimensions differ from the DOM renderer, make sure the terminal\n\t\t\t// gets resized after the webgl addon is loaded\n\t\t\tthis._onDidRequestRefreshDimensions.fire();\n\t\t\t// Uncomment to add the texture atlas to the DOM\n\t\t\t// setTimeout(() => {\n\t\t\t// \tif (this._webglAddon?.textureAtlas) {\n\t\t\t// \t\tdocument.body.appendChild(this._webglAddon?.textureAtlas);\n\t\t\t// \t}\n\t\t\t// }, 5000);\n\t\t} catch (e) {\n\t\t\tthis._logService.warn(`Webgl could not be loaded. Falling back to the DOM renderer`, e);\n\t\t\tXtermTerminal._suggestedRendererType = 'dom';\n\t\t\tthis._disposeOfWebglRenderer();\n\t\t}\n\t}\n\n\t@debounce(100)\n\tprivate async _refreshLigaturesAddon(): Promise<void> {\n\t\tif (!this.raw.element) {\n\t\t\treturn;\n\t\t}\n\t\tconst ligaturesConfig = this._terminalConfigurationService.config.fontLigatures;\n\t\tlet shouldRecreateWebglRenderer = false;\n\t\tif (ligaturesConfig?.enabled) {\n\t\t\tif (this._ligaturesAddon.value && !equals(ligaturesConfig, this._ligaturesAddonConfig)) {\n\t\t\t\tthis._ligaturesAddon.clear();\n\t\t\t}\n\t\t\tif (!this._ligaturesAddon.value) {\n\t\t\t\tconst LigaturesAddon = await this._xtermAddonLoader.importAddon('ligatures');\n\t\t\t\tif (this._store.isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._ligaturesAddon.value = this._instantiationService.createInstance(LigaturesAddon, {\n\t\t\t\t\tfontFeatureSettings: ligaturesConfig.featureSettings,\n\t\t\t\t\tfallbackLigatures: ligaturesConfig.fallbackLigatures,\n\t\t\t\t});\n\t\t\t\tthis.raw.loadAddon(this._ligaturesAddon.value);\n\t\t\t\tshouldRecreateWebglRenderer = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this._ligaturesAddon.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._ligaturesAddon.clear();\n\t\t\tshouldRecreateWebglRenderer = true;\n\t\t}\n\n\t\tif (shouldRecreateWebglRenderer && this._webglAddon) {\n\t\t\t// Re-create the webgl addon when ligatures state changes to so the texture atlas picks up\n\t\t\t// styles from the DOM.\n\t\t\tthis._disposeOfWebglRenderer();\n\t\t\tawait this._enableWebglRenderer();\n\t\t}\n\t}\n\n\t@debounce(100)\n\tprivate async _refreshImageAddon(): Promise<void> {\n\t\t// Only allow the image addon when webgl is being used to avoid possible GPU issues\n\t\tif (this._terminalConfigurationService.config.enableImages && this._webglAddon) {\n\t\t\tif (!this._imageAddon) {\n\t\t\t\tconst AddonCtor = await this._xtermAddonLoader.importAddon('image');\n\t\t\t\tthis._imageAddon = new AddonCtor();\n\t\t\t\tthis.raw.loadAddon(this._imageAddon);\n\t\t\t}\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tthis._imageAddon?.dispose();\n\t\t\t} catch {\n\t\t\t\t// ignore\n\t\t\t}\n\t\t\tthis._imageAddon = undefined;\n\t\t}\n\t}\n\n\tprivate _disposeOfWebglRenderer(): void {\n\t\ttry {\n\t\t\tthis._webglAddon?.dispose();\n\t\t} catch {\n\t\t\t// ignore\n\t\t}\n\t\tthis._webglAddon = undefined;\n\t\tthis._refreshImageAddon();\n\t\t// WebGL renderer cell dimensions differ from the DOM renderer, make sure the terminal\n\t\t// gets resized after the webgl addon is disposed\n\t\tthis._onDidRequestRefreshDimensions.fire();\n\t}\n\n\tgetXtermTheme(theme?: IColorTheme): ITheme {\n\t\tif (!theme) {\n\t\t\ttheme = this._themeService.getColorTheme();\n\t\t}\n\n\t\tconst config = this._terminalConfigurationService.config;\n\t\tconst hideOverviewRuler = ['never', 'gutter'].includes(config.shellIntegration?.decorationsEnabled ?? '');\n\n\t\tconst foregroundColor = theme.getColor(TERMINAL_FOREGROUND_COLOR);\n\t\tconst backgroundColor = this._xtermColorProvider.getBackgroundColor(theme);\n\t\tconst cursorColor = theme.getColor(TERMINAL_CURSOR_FOREGROUND_COLOR) || foregroundColor;\n\t\tconst cursorAccentColor = theme.getColor(TERMINAL_CURSOR_BACKGROUND_COLOR) || backgroundColor;\n\t\tconst selectionBackgroundColor = theme.getColor(TERMINAL_SELECTION_BACKGROUND_COLOR);\n\t\tconst selectionInactiveBackgroundColor = theme.getColor(TERMINAL_INACTIVE_SELECTION_BACKGROUND_COLOR);\n\t\tconst selectionForegroundColor = theme.getColor(TERMINAL_SELECTION_FOREGROUND_COLOR) || undefined;\n\n\t\treturn {\n\t\t\tbackground: backgroundColor?.toString(),\n\t\t\tforeground: foregroundColor?.toString(),\n\t\t\tcursor: cursorColor?.toString(),\n\t\t\tcursorAccent: cursorAccentColor?.toString(),\n\t\t\tselectionBackground: selectionBackgroundColor?.toString(),\n\t\t\tselectionInactiveBackground: selectionInactiveBackgroundColor?.toString(),\n\t\t\tselectionForeground: selectionForegroundColor?.toString(),\n\t\t\toverviewRulerBorder: hideOverviewRuler ? '#0000' : theme.getColor(TERMINAL_OVERVIEW_RULER_BORDER_COLOR)?.toString(),\n\t\t\tscrollbarSliderActiveBackground: theme.getColor(scrollbarSliderActiveBackground)?.toString(),\n\t\t\tscrollbarSliderBackground: theme.getColor(scrollbarSliderBackground)?.toString(),\n\t\t\tscrollbarSliderHoverBackground: theme.getColor(scrollbarSliderHoverBackground)?.toString(),\n\t\t\tblack: theme.getColor(ansiColorIdentifiers[0])?.toString(),\n\t\t\tred: theme.getColor(ansiColorIdentifiers[1])?.toString(),\n\t\t\tgreen: theme.getColor(ansiColorIdentifiers[2])?.toString(),\n\t\t\tyellow: theme.getColor(ansiColorIdentifiers[3])?.toString(),\n\t\t\tblue: theme.getColor(ansiColorIdentifiers[4])?.toString(),\n\t\t\tmagenta: theme.getColor(ansiColorIdentifiers[5])?.toString(),\n\t\t\tcyan: theme.getColor(ansiColorIdentifiers[6])?.toString(),\n\t\t\twhite: theme.getColor(ansiColorIdentifiers[7])?.toString(),\n\t\t\tbrightBlack: theme.getColor(ansiColorIdentifiers[8])?.toString(),\n\t\t\tbrightRed: theme.getColor(ansiColorIdentifiers[9])?.toString(),\n\t\t\tbrightGreen: theme.getColor(ansiColorIdentifiers[10])?.toString(),\n\t\t\tbrightYellow: theme.getColor(ansiColorIdentifiers[11])?.toString(),\n\t\t\tbrightBlue: theme.getColor(ansiColorIdentifiers[12])?.toString(),\n\t\t\tbrightMagenta: theme.getColor(ansiColorIdentifiers[13])?.toString(),\n\t\t\tbrightCyan: theme.getColor(ansiColorIdentifiers[14])?.toString(),\n\t\t\tbrightWhite: theme.getColor(ansiColorIdentifiers[15])?.toString()\n\t\t};\n\t}\n\n\tprivate _updateTheme(theme?: IColorTheme): void {\n\t\tthis.raw.options.theme = this.getXtermTheme(theme);\n\t}\n\n\trefresh() {\n\t\tthis._updateTheme();\n\t\tthis._decorationAddon.refreshLayouts();\n\t}\n\n\tprivate async _updateUnicodeVersion(): Promise<void> {\n\t\tif (!this._unicode11Addon && this._terminalConfigurationService.config.unicodeVersion === '11') {\n\t\t\tconst Addon = await this._xtermAddonLoader.importAddon('unicode11');\n\t\t\tthis._unicode11Addon = new Addon();\n\t\t\tthis.raw.loadAddon(this._unicode11Addon);\n\t\t}\n\t\tif (this.raw.unicode.activeVersion !== this._terminalConfigurationService.config.unicodeVersion) {\n\t\t\tthis.raw.unicode.activeVersion = this._terminalConfigurationService.config.unicodeVersion;\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\t_writeText(data: string): void {\n\t\tthis.raw.write(data);\n\t}\n\n\toverride dispose(): void {\n\t\tthis._anyTerminalFocusContextKey.reset();\n\t\tthis._anyFocusedTerminalHasSelection.reset();\n\t\tthis._onDidDispose.fire();\n\t\tsuper.dispose();\n\t}\n}\n\nexport function getXtermScaledDimensions(w: Window, font: ITerminalFont, width: number, height: number): { rows: number; cols: number } | null {\n\tif (!font.charWidth || !font.charHeight) {\n\t\treturn null;\n\t}\n\n\t// Because xterm.js converts from CSS pixels to actual pixels through\n\t// the use of canvas, window.devicePixelRatio needs to be used here in\n\t// order to be precise. font.charWidth/charHeight alone as insufficient\n\t// when window.devicePixelRatio changes.\n\tconst scaledWidthAvailable = width * w.devicePixelRatio;\n\n\tconst scaledCharWidth = font.charWidth * w.devicePixelRatio + font.letterSpacing;\n\tconst cols = Math.max(Math.floor(scaledWidthAvailable / scaledCharWidth), 1);\n\n\tconst scaledHeightAvailable = height * w.devicePixelRatio;\n\tconst scaledCharHeight = Math.ceil(font.charHeight * w.devicePixelRatio);\n\tconst scaledLineHeight = Math.floor(scaledCharHeight * font.lineHeight);\n\tconst rows = Math.max(Math.floor(scaledHeightAvailable / scaledLineHeight), 1);\n\n\treturn { rows, cols };\n}\n\nfunction vscodeToXtermLogLevel(logLevel: LogLevel): XtermLogLevel {\n\tswitch (logLevel) {\n\t\tcase LogLevel.Trace: return 'trace';\n\t\tcase LogLevel.Debug: return 'debug';\n\t\tcase LogLevel.Info: return 'info';\n\t\tcase LogLevel.Warning: return 'warn';\n\t\tcase LogLevel.Error: return 'error';\n\t\tdefault: return 'off';\n\t}\n}\n\ninterface ICursorStyleVscodeToXtermMap {\n\t'cursorStyle': NonNullable<ITerminalOptions['cursorStyle']>;\n\t'cursorStyleInactive': NonNullable<ITerminalOptions['cursorInactiveStyle']>;\n}\nfunction vscodeToXtermCursorStyle<T extends 'cursorStyle' | 'cursorStyleInactive'>(style: ITerminalConfiguration[T]): ICursorStyleVscodeToXtermMap[T] {\n\t// 'line' is used instead of bar in VS Code to be consistent with editor.cursorStyle\n\tif (style === 'line') {\n\t\treturn 'bar';\n\t}\n\treturn style as ICursorStyleVscodeToXtermMap[T];\n}\n"]}