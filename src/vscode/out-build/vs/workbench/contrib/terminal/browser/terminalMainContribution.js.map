{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/terminalMainContribution.ts","vs/workbench/contrib/terminal/browser/terminalMainContribution.ts"],"names":[],"mappings":"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","file":"terminalMainContribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ITerminalEditorService, ITerminalGroupService, ITerminalInstanceService, ITerminalService, terminalEditorId } from './terminal.js';\nimport { parseTerminalUri } from './terminalUri.js';\nimport { terminalStrings } from '../common/terminalStrings.js';\nimport { IEditorResolverService, RegisteredEditorPriority } from '../../../services/editor/common/editorResolverService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { ILifecycleService, LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IEmbedderTerminalService } from '../../../services/terminal/common/embedderTerminalService.js';\n\n/**\n * The main contribution for the terminal contrib. This contains calls to other components necessary\n * to set up the terminal but don't need to be tracked in the long term (where TerminalService would\n * be more relevant).\n */\nexport class TerminalMainContribution extends Disposable implements IWorkbenchContribution {\n\tstatic ID = 'terminalMain';\n\n\tconstructor(\n\t\t@IEditorResolverService editorResolverService: IEditorResolverService,\n\t\t@IEmbedderTerminalService embedderTerminalService: IEmbedderTerminalService,\n\t\t@IWorkbenchEnvironmentService workbenchEnvironmentService: IWorkbenchEnvironmentService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@ITerminalService terminalService: ITerminalService,\n\t\t@ITerminalEditorService terminalEditorService: ITerminalEditorService,\n\t\t@ITerminalGroupService terminalGroupService: ITerminalGroupService,\n\t\t@ITerminalInstanceService terminalInstanceService: ITerminalInstanceService\n\t) {\n\t\tsuper();\n\n\t\tthis._init(\n\t\t\teditorResolverService,\n\t\t\tembedderTerminalService,\n\t\t\tworkbenchEnvironmentService,\n\t\t\tlabelService,\n\t\t\tlifecycleService,\n\t\t\tterminalService,\n\t\t\tterminalEditorService,\n\t\t\tterminalGroupService,\n\t\t\tterminalInstanceService\n\t\t);\n\t}\n\n\tprivate async _init(\n\t\teditorResolverService: IEditorResolverService,\n\t\tembedderTerminalService: IEmbedderTerminalService,\n\t\tworkbenchEnvironmentService: IWorkbenchEnvironmentService,\n\t\tlabelService: ILabelService,\n\t\tlifecycleService: ILifecycleService,\n\t\tterminalService: ITerminalService,\n\t\tterminalEditorService: ITerminalEditorService,\n\t\tterminalGroupService: ITerminalGroupService,\n\t\tterminalInstanceService: ITerminalInstanceService\n\t) {\n\t\t// IMPORTANT: This listener needs to be set up before the workbench is ready to support\n\t\t// embedder terminals.\n\t\tthis._register(embedderTerminalService.onDidCreateTerminal(async embedderTerminal => {\n\t\t\tconst terminal = await terminalService.createTerminal({\n\t\t\t\tconfig: embedderTerminal,\n\t\t\t\tlocation: TerminalLocation.Panel,\n\t\t\t\tskipContributedProfileCheck: true,\n\t\t\t});\n\t\t\tterminalService.setActiveInstance(terminal);\n\t\t\tawait terminalService.revealActiveTerminal();\n\t\t}));\n\n\t\tawait lifecycleService.when(LifecyclePhase.Restored);\n\n\t\t// Register terminal editors\n\t\tthis._register(editorResolverService.registerEditor(\n\t\t\t`${Schemas.vscodeTerminal}:/**`,\n\t\t\t{\n\t\t\t\tid: terminalEditorId,\n\t\t\t\tlabel: terminalStrings.terminal,\n\t\t\t\tpriority: RegisteredEditorPriority.exclusive\n\t\t\t},\n\t\t\t{\n\t\t\t\tcanSupportResource: uri => uri.scheme === Schemas.vscodeTerminal,\n\t\t\t\tsinglePerResource: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tcreateEditorInput: async ({ resource, options }) => {\n\t\t\t\t\tlet instance = terminalService.getInstanceFromResource(resource);\n\t\t\t\t\tif (instance) {\n\t\t\t\t\t\tconst sourceGroup = terminalGroupService.getGroupForInstance(instance);\n\t\t\t\t\t\tsourceGroup?.removeInstance(instance);\n\t\t\t\t\t} else { // Terminal from a different window\n\t\t\t\t\t\tconst terminalIdentifier = parseTerminalUri(resource);\n\t\t\t\t\t\tif (!terminalIdentifier.instanceId) {\n\t\t\t\t\t\t\tthrow new Error('Terminal identifier without instanceId');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst primaryBackend = terminalService.getPrimaryBackend();\n\t\t\t\t\t\tif (!primaryBackend) {\n\t\t\t\t\t\t\tthrow new Error('No terminal primary backend');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst attachPersistentProcess = await primaryBackend.requestDetachInstance(terminalIdentifier.workspaceId, terminalIdentifier.instanceId);\n\t\t\t\t\t\tif (!attachPersistentProcess) {\n\t\t\t\t\t\t\tthrow new Error('No terminal persistent process to attach');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinstance = terminalInstanceService.createInstance({ attachPersistentProcess }, TerminalLocation.Editor);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resolvedResource = terminalEditorService.resolveResource(instance);\n\t\t\t\t\tconst editor = terminalEditorService.getInputFromResource(resolvedResource);\n\t\t\t\t\treturn {\n\t\t\t\t\t\teditor,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\tpinned: true,\n\t\t\t\t\t\t\tforceReload: true,\n\t\t\t\t\t\t\toverride: terminalEditorId\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t));\n\n\t\t// Register a resource formatter for terminal URIs\n\t\tthis._register(labelService.registerFormatter({\n\t\t\tscheme: Schemas.vscodeTerminal,\n\t\t\tformatting: {\n\t\t\t\tlabel: '${path}',\n\t\t\t\tseparator: ''\n\t\t\t}\n\t\t}));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ITerminalEditorService, ITerminalGroupService, ITerminalInstanceService, ITerminalService, terminalEditorId } from './terminal.js';\nimport { parseTerminalUri } from './terminalUri.js';\nimport { terminalStrings } from '../common/terminalStrings.js';\nimport { IEditorResolverService, RegisteredEditorPriority } from '../../../services/editor/common/editorResolverService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { ILifecycleService, LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IEmbedderTerminalService } from '../../../services/terminal/common/embedderTerminalService.js';\n\n/**\n * The main contribution for the terminal contrib. This contains calls to other components necessary\n * to set up the terminal but don't need to be tracked in the long term (where TerminalService would\n * be more relevant).\n */\nexport class TerminalMainContribution extends Disposable implements IWorkbenchContribution {\n\tstatic ID = 'terminalMain';\n\n\tconstructor(\n\t\t@IEditorResolverService editorResolverService: IEditorResolverService,\n\t\t@IEmbedderTerminalService embedderTerminalService: IEmbedderTerminalService,\n\t\t@IWorkbenchEnvironmentService workbenchEnvironmentService: IWorkbenchEnvironmentService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@ITerminalService terminalService: ITerminalService,\n\t\t@ITerminalEditorService terminalEditorService: ITerminalEditorService,\n\t\t@ITerminalGroupService terminalGroupService: ITerminalGroupService,\n\t\t@ITerminalInstanceService terminalInstanceService: ITerminalInstanceService\n\t) {\n\t\tsuper();\n\n\t\tthis._init(\n\t\t\teditorResolverService,\n\t\t\tembedderTerminalService,\n\t\t\tworkbenchEnvironmentService,\n\t\t\tlabelService,\n\t\t\tlifecycleService,\n\t\t\tterminalService,\n\t\t\tterminalEditorService,\n\t\t\tterminalGroupService,\n\t\t\tterminalInstanceService\n\t\t);\n\t}\n\n\tprivate async _init(\n\t\teditorResolverService: IEditorResolverService,\n\t\tembedderTerminalService: IEmbedderTerminalService,\n\t\tworkbenchEnvironmentService: IWorkbenchEnvironmentService,\n\t\tlabelService: ILabelService,\n\t\tlifecycleService: ILifecycleService,\n\t\tterminalService: ITerminalService,\n\t\tterminalEditorService: ITerminalEditorService,\n\t\tterminalGroupService: ITerminalGroupService,\n\t\tterminalInstanceService: ITerminalInstanceService\n\t) {\n\t\t// IMPORTANT: This listener needs to be set up before the workbench is ready to support\n\t\t// embedder terminals.\n\t\tthis._register(embedderTerminalService.onDidCreateTerminal(async embedderTerminal => {\n\t\t\tconst terminal = await terminalService.createTerminal({\n\t\t\t\tconfig: embedderTerminal,\n\t\t\t\tlocation: TerminalLocation.Panel,\n\t\t\t\tskipContributedProfileCheck: true,\n\t\t\t});\n\t\t\tterminalService.setActiveInstance(terminal);\n\t\t\tawait terminalService.revealActiveTerminal();\n\t\t}));\n\n\t\tawait lifecycleService.when(LifecyclePhase.Restored);\n\n\t\t// Register terminal editors\n\t\tthis._register(editorResolverService.registerEditor(\n\t\t\t`${Schemas.vscodeTerminal}:/**`,\n\t\t\t{\n\t\t\t\tid: terminalEditorId,\n\t\t\t\tlabel: terminalStrings.terminal,\n\t\t\t\tpriority: RegisteredEditorPriority.exclusive\n\t\t\t},\n\t\t\t{\n\t\t\t\tcanSupportResource: uri => uri.scheme === Schemas.vscodeTerminal,\n\t\t\t\tsinglePerResource: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tcreateEditorInput: async ({ resource, options }) => {\n\t\t\t\t\tlet instance = terminalService.getInstanceFromResource(resource);\n\t\t\t\t\tif (instance) {\n\t\t\t\t\t\tconst sourceGroup = terminalGroupService.getGroupForInstance(instance);\n\t\t\t\t\t\tsourceGroup?.removeInstance(instance);\n\t\t\t\t\t} else { // Terminal from a different window\n\t\t\t\t\t\tconst terminalIdentifier = parseTerminalUri(resource);\n\t\t\t\t\t\tif (!terminalIdentifier.instanceId) {\n\t\t\t\t\t\t\tthrow new Error('Terminal identifier without instanceId');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst primaryBackend = terminalService.getPrimaryBackend();\n\t\t\t\t\t\tif (!primaryBackend) {\n\t\t\t\t\t\t\tthrow new Error('No terminal primary backend');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst attachPersistentProcess = await primaryBackend.requestDetachInstance(terminalIdentifier.workspaceId, terminalIdentifier.instanceId);\n\t\t\t\t\t\tif (!attachPersistentProcess) {\n\t\t\t\t\t\t\tthrow new Error('No terminal persistent process to attach');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinstance = terminalInstanceService.createInstance({ attachPersistentProcess }, TerminalLocation.Editor);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resolvedResource = terminalEditorService.resolveResource(instance);\n\t\t\t\t\tconst editor = terminalEditorService.getInputFromResource(resolvedResource);\n\t\t\t\t\treturn {\n\t\t\t\t\t\teditor,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\tpinned: true,\n\t\t\t\t\t\t\tforceReload: true,\n\t\t\t\t\t\t\toverride: terminalEditorId\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t));\n\n\t\t// Register a resource formatter for terminal URIs\n\t\tthis._register(labelService.registerFormatter({\n\t\t\tscheme: Schemas.vscodeTerminal,\n\t\t\tformatting: {\n\t\t\t\tlabel: '${path}',\n\t\t\t\tseparator: ''\n\t\t\t}\n\t\t}));\n\t}\n}\n"]}