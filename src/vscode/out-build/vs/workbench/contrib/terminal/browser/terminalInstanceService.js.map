{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/terminalInstanceService.ts","vs/workbench/contrib/terminal/browser/terminalInstanceService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAqB,wBAAwB,EAAE,MAAM,eAAe,CAAC;AAC5E,OAAO,EAAqB,iBAAiB,EAAE,MAAM,yDAAyD,CAAC;AAC/G,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAClE,OAAO,EAAoF,kBAAkB,EAAoB,MAAM,kDAAkD,CAAC;AAC1L,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAE,gBAAgB,EAAE,MAAM,uBAAuB,CAAC;AACzD,OAAO,EAAe,kBAAkB,EAAE,MAAM,sDAAsD,CAAC;AAEvG,OAAO,EAAE,OAAO,EAAS,MAAM,kCAAkC,CAAC;AAClE,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,QAAQ,EAAE,MAAM,kDAAkD,CAAC;AAC5E,OAAO,EAAE,4BAA4B,EAAE,MAAM,4DAA4D,CAAC;AAC1G,OAAO,EAAE,oBAAoB,EAAE,MAAM,kCAAkC,CAAC;AACxE,OAAO,EAAE,MAAM,EAAE,MAAM,kCAAkC,CAAC;AAEnD,IAAM,uBAAuB,GAA7B,MAAM,uBAAwB,SAAQ,UAAU;IAMtD,IAAI,mBAAmB,KAA+B,OAAO,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC,CAAC;IAG/F,IAAI,oBAAoB,KAA8B,OAAO,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,CAAC;IAEhG,YACwB,qBAA6D,EAChE,kBAAuD,EAC7C,kBAAgD;QAE9E,KAAK,EAAE,CAAC;QAJgC,0BAAqB,GAArB,qBAAqB,CAAuB;QAC/C,uBAAkB,GAAlB,kBAAkB,CAAoB;QAVpE,yBAAoB,GAAG,IAAI,GAAG,EAAuE,CAAC;QAE7F,yBAAoB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAqB,CAAC,CAAC;QAGxE,0BAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAoB,CAAC,CAAC;QASxF,IAAI,CAAC,4BAA4B,GAAG,mBAAmB,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAElG,KAAK,MAAM,eAAe,IAAI,CAAC,SAAS,EAAE,kBAAkB,CAAC,eAAe,CAAC,EAAE,CAAC;YAC/E,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,oBAAoB,EAAQ,CAAC;YAC1D,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,eAAe,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,CAAC;IACF,CAAC;IAID,cAAc,CAAC,MAA6C,EAAE,MAAwB;QACrF,MAAM,iBAAiB,GAAG,IAAI,CAAC,iCAAiC,CAAC,MAAM,CAAC,CAAC;QACzE,MAAM,QAAQ,GAAG,IAAI,CAAC,qBAAqB,CAAC,cAAc,CAAC,gBAAgB,EAAE,IAAI,CAAC,4BAA4B,EAAE,iBAAiB,CAAC,CAAC;QACnI,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACzC,OAAO,QAAQ,CAAC;IACjB,CAAC;IAED,iCAAiC,CAAC,0BAAkE,EAAE,GAAkB;QACvH,uBAAuB;QACvB,IAAI,0BAA0B,IAAI,MAAM,CAAC,0BAA0B,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;YAC7F,MAAM,OAAO,GAAG,0BAA0B,CAAC;YAC3C,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACnB,OAAO,0BAA0B,CAAC;YACnC,CAAC;YACD,OAAO;gBACN,UAAU,EAAE,OAAO,CAAC,IAAI;gBACxB,IAAI,EAAE,OAAO,CAAC,IAAI;gBAClB,GAAG,EAAE,OAAO,CAAC,GAAG;gBAChB,IAAI,EAAE,OAAO,CAAC,IAAI;gBAClB,KAAK,EAAE,OAAO,CAAC,KAAK;gBACpB,IAAI,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,SAAS;gBAC5D,GAAG;aACH,CAAC;QACH,CAAC;QAED,qCAAqC;QACrC,IAAI,0BAA0B,EAAE,CAAC;YAChC,IAAI,GAAG,EAAE,CAAC;gBACT,0BAA0B,CAAC,GAAG,GAAG,GAAG,CAAC;YACtC,CAAC;YACD,OAAO,0BAA0B,CAAC;QACnC,CAAC;QAED,mCAAmC;QACnC,OAAO,EAAE,CAAC;IACX,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,eAAwB;QACxC,IAAI,OAAO,GAAG,QAAQ,CAAC,EAAE,CAA2B,kBAAkB,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAC,eAAe,CAAC,CAAC;QACpH,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,8CAA8C;YAC9C,MAAM,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,eAAe,CAAC,EAAE,OAAO,CAAC;YAC9D,OAAO,GAAG,QAAQ,CAAC,EAAE,CAA2B,kBAAkB,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAC,eAAe,CAAC,CAAC;QACjH,CAAC;QACD,OAAO,OAAO,CAAC;IAChB,CAAC;IAED,qBAAqB;QACpB,OAAO,QAAQ,CAAC,EAAE,CAA2B,kBAAkB,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;IAC5F,CAAC;IAED,kBAAkB,CAAC,OAAyB;QAC3C,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,OAAO,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,CAAC;QAClE,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC1C,CAAC;CACD,CAAA;AAnFY,uBAAuB;IAYjC,WAAA,qBAAqB,CAAA;IACrB,WAAA,kBAAkB,CAAA;IAClB,WAAA,4BAA4B,CAAA;GAdlB,uBAAuB,CAmFnC;;AAED,iBAAiB,CAAC,wBAAwB,EAAE,uBAAuB,oCAA4B,CAAC","file":"terminalInstanceService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ITerminalInstance, ITerminalInstanceService } from './terminal.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IShellLaunchConfig, ITerminalBackend, ITerminalBackendRegistry, ITerminalProfile, TerminalExtensions, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalInstance } from './terminalInstance.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { promiseWithResolvers } from '../../../../base/common/async.js';\nimport { hasKey } from '../../../../base/common/types.js';\n\nexport class TerminalInstanceService extends Disposable implements ITerminalInstanceService {\n\tdeclare _serviceBrand: undefined;\n\tprivate _terminalShellTypeContextKey: IContextKey<string>;\n\tprivate _backendRegistration = new Map<string | undefined, { promise: Promise<void>; resolve: () => void }>();\n\n\tprivate readonly _onDidCreateInstance = this._register(new Emitter<ITerminalInstance>());\n\tget onDidCreateInstance(): Event<ITerminalInstance> { return this._onDidCreateInstance.event; }\n\n\tprivate readonly _onDidRegisterBackend = this._register(new Emitter<ITerminalBackend>());\n\tget onDidRegisterBackend(): Event<ITerminalBackend> { return this._onDidRegisterBackend.event; }\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t) {\n\t\tsuper();\n\t\tthis._terminalShellTypeContextKey = TerminalContextKeys.shellType.bindTo(this._contextKeyService);\n\n\t\tfor (const remoteAuthority of [undefined, environmentService.remoteAuthority]) {\n\t\t\tconst { promise, resolve } = promiseWithResolvers<void>();\n\t\t\tthis._backendRegistration.set(remoteAuthority, { promise, resolve });\n\t\t}\n\t}\n\n\tcreateInstance(profile: ITerminalProfile, target: TerminalLocation): ITerminalInstance;\n\tcreateInstance(shellLaunchConfig: IShellLaunchConfig, target: TerminalLocation): ITerminalInstance;\n\tcreateInstance(config: IShellLaunchConfig | ITerminalProfile, target: TerminalLocation): ITerminalInstance {\n\t\tconst shellLaunchConfig = this.convertProfileToShellLaunchConfig(config);\n\t\tconst instance = this._instantiationService.createInstance(TerminalInstance, this._terminalShellTypeContextKey, shellLaunchConfig);\n\t\tinstance.target = target;\n\t\tthis._onDidCreateInstance.fire(instance);\n\t\treturn instance;\n\t}\n\n\tconvertProfileToShellLaunchConfig(shellLaunchConfigOrProfile?: IShellLaunchConfig | ITerminalProfile, cwd?: string | URI): IShellLaunchConfig {\n\t\t// Profile was provided\n\t\tif (shellLaunchConfigOrProfile && hasKey(shellLaunchConfigOrProfile, { profileName: true })) {\n\t\t\tconst profile = shellLaunchConfigOrProfile;\n\t\t\tif (!profile.path) {\n\t\t\t\treturn shellLaunchConfigOrProfile;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\texecutable: profile.path,\n\t\t\t\targs: profile.args,\n\t\t\t\tenv: profile.env,\n\t\t\t\ticon: profile.icon,\n\t\t\t\tcolor: profile.color,\n\t\t\t\tname: profile.overrideName ? profile.profileName : undefined,\n\t\t\t\tcwd\n\t\t\t};\n\t\t}\n\n\t\t// A shell launch config was provided\n\t\tif (shellLaunchConfigOrProfile) {\n\t\t\tif (cwd) {\n\t\t\t\tshellLaunchConfigOrProfile.cwd = cwd;\n\t\t\t}\n\t\t\treturn shellLaunchConfigOrProfile;\n\t\t}\n\n\t\t// Return empty shell launch config\n\t\treturn {};\n\t}\n\n\tasync getBackend(remoteAuthority?: string): Promise<ITerminalBackend | undefined> {\n\t\tlet backend = Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).getTerminalBackend(remoteAuthority);\n\t\tif (!backend) {\n\t\t\t// Ensure backend is initialized and try again\n\t\t\tawait this._backendRegistration.get(remoteAuthority)?.promise;\n\t\t\tbackend = Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).getTerminalBackend(remoteAuthority);\n\t\t}\n\t\treturn backend;\n\t}\n\n\tgetRegisteredBackends(): IterableIterator<ITerminalBackend> {\n\t\treturn Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).backends.values();\n\t}\n\n\tdidRegisterBackend(backend: ITerminalBackend) {\n\t\tthis._backendRegistration.get(backend.remoteAuthority)?.resolve();\n\t\tthis._onDidRegisterBackend.fire(backend);\n\t}\n}\n\nregisterSingleton(ITerminalInstanceService, TerminalInstanceService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ITerminalInstance, ITerminalInstanceService } from './terminal.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IShellLaunchConfig, ITerminalBackend, ITerminalBackendRegistry, ITerminalProfile, TerminalExtensions, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalInstance } from './terminalInstance.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { TerminalContextKeys } from '../common/terminalContextKey.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { promiseWithResolvers } from '../../../../base/common/async.js';\nimport { hasKey } from '../../../../base/common/types.js';\n\nexport class TerminalInstanceService extends Disposable implements ITerminalInstanceService {\n\tdeclare _serviceBrand: undefined;\n\tprivate _terminalShellTypeContextKey: IContextKey<string>;\n\tprivate _backendRegistration = new Map<string | undefined, { promise: Promise<void>; resolve: () => void }>();\n\n\tprivate readonly _onDidCreateInstance = this._register(new Emitter<ITerminalInstance>());\n\tget onDidCreateInstance(): Event<ITerminalInstance> { return this._onDidCreateInstance.event; }\n\n\tprivate readonly _onDidRegisterBackend = this._register(new Emitter<ITerminalBackend>());\n\tget onDidRegisterBackend(): Event<ITerminalBackend> { return this._onDidRegisterBackend.event; }\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t) {\n\t\tsuper();\n\t\tthis._terminalShellTypeContextKey = TerminalContextKeys.shellType.bindTo(this._contextKeyService);\n\n\t\tfor (const remoteAuthority of [undefined, environmentService.remoteAuthority]) {\n\t\t\tconst { promise, resolve } = promiseWithResolvers<void>();\n\t\t\tthis._backendRegistration.set(remoteAuthority, { promise, resolve });\n\t\t}\n\t}\n\n\tcreateInstance(profile: ITerminalProfile, target: TerminalLocation): ITerminalInstance;\n\tcreateInstance(shellLaunchConfig: IShellLaunchConfig, target: TerminalLocation): ITerminalInstance;\n\tcreateInstance(config: IShellLaunchConfig | ITerminalProfile, target: TerminalLocation): ITerminalInstance {\n\t\tconst shellLaunchConfig = this.convertProfileToShellLaunchConfig(config);\n\t\tconst instance = this._instantiationService.createInstance(TerminalInstance, this._terminalShellTypeContextKey, shellLaunchConfig);\n\t\tinstance.target = target;\n\t\tthis._onDidCreateInstance.fire(instance);\n\t\treturn instance;\n\t}\n\n\tconvertProfileToShellLaunchConfig(shellLaunchConfigOrProfile?: IShellLaunchConfig | ITerminalProfile, cwd?: string | URI): IShellLaunchConfig {\n\t\t// Profile was provided\n\t\tif (shellLaunchConfigOrProfile && hasKey(shellLaunchConfigOrProfile, { profileName: true })) {\n\t\t\tconst profile = shellLaunchConfigOrProfile;\n\t\t\tif (!profile.path) {\n\t\t\t\treturn shellLaunchConfigOrProfile;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\texecutable: profile.path,\n\t\t\t\targs: profile.args,\n\t\t\t\tenv: profile.env,\n\t\t\t\ticon: profile.icon,\n\t\t\t\tcolor: profile.color,\n\t\t\t\tname: profile.overrideName ? profile.profileName : undefined,\n\t\t\t\tcwd\n\t\t\t};\n\t\t}\n\n\t\t// A shell launch config was provided\n\t\tif (shellLaunchConfigOrProfile) {\n\t\t\tif (cwd) {\n\t\t\t\tshellLaunchConfigOrProfile.cwd = cwd;\n\t\t\t}\n\t\t\treturn shellLaunchConfigOrProfile;\n\t\t}\n\n\t\t// Return empty shell launch config\n\t\treturn {};\n\t}\n\n\tasync getBackend(remoteAuthority?: string): Promise<ITerminalBackend | undefined> {\n\t\tlet backend = Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).getTerminalBackend(remoteAuthority);\n\t\tif (!backend) {\n\t\t\t// Ensure backend is initialized and try again\n\t\t\tawait this._backendRegistration.get(remoteAuthority)?.promise;\n\t\t\tbackend = Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).getTerminalBackend(remoteAuthority);\n\t\t}\n\t\treturn backend;\n\t}\n\n\tgetRegisteredBackends(): IterableIterator<ITerminalBackend> {\n\t\treturn Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).backends.values();\n\t}\n\n\tdidRegisterBackend(backend: ITerminalBackend) {\n\t\tthis._backendRegistration.get(backend.remoteAuthority)?.resolve();\n\t\tthis._onDidRegisterBackend.fire(backend);\n\t}\n}\n\nregisterSingleton(ITerminalInstanceService, TerminalInstanceService, InstantiationType.Delayed);\n"]}