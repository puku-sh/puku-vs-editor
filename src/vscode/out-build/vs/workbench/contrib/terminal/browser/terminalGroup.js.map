{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminal/browser/terminalGroup.ts","vs/workbench/contrib/terminal/browser/terminalGroup.ts"],"names":[],"mappings":"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","file":"terminalGroup.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { TERMINAL_VIEW_ID } from '../common/terminal.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { IDisposable, Disposable, DisposableStore, dispose, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { SplitView, Orientation, IView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\nimport { isHorizontal, IWorkbenchLayoutService, Position } from '../../../services/layout/browser/layoutService.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITerminalInstance, Direction, ITerminalGroup, ITerminalInstanceService, ITerminalConfigurationService } from './terminal.js';\nimport { ViewContainerLocation, IViewDescriptorService } from '../../../common/views.js';\nimport { IShellLaunchConfig, ITerminalTabLayoutInfoById, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { TerminalStatus } from './terminalStatusList.js';\nimport { getWindow } from '../../../../base/browser/dom.js';\nimport { getPartByLocation } from '../../../services/views/browser/viewsService.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { hasKey, isNumber, type SingleOrMany } from '../../../../base/common/types.js';\n\nconst enum Constants {\n\t/**\n\t * The minimum size in pixels of a split pane.\n\t */\n\tSplitPaneMinSize = 80,\n\t/**\n\t * The number of cells the terminal gets added or removed when asked to increase or decrease\n\t * the view size.\n\t */\n\tResizePartCellCount = 4\n}\n\nclass SplitPaneContainer extends Disposable {\n\tprivate _height: number;\n\tprivate _width: number;\n\tprivate _splitView!: SplitView;\n\tprivate readonly _splitViewDisposables = this._register(new DisposableStore());\n\tprivate _children: SplitPane[] = [];\n\tprivate _terminalToPane: Map<ITerminalInstance, SplitPane> = new Map();\n\n\tprivate _onDidChange: Event<number | undefined> = Event.None;\n\tget onDidChange(): Event<number | undefined> { return this._onDidChange; }\n\n\tconstructor(\n\t\tprivate _container: HTMLElement,\n\t\tpublic orientation: Orientation,\n\t) {\n\t\tsuper();\n\t\tthis._width = this._container.offsetWidth;\n\t\tthis._height = this._container.offsetHeight;\n\t\tthis._createSplitView();\n\t\tthis._splitView.layout(this.orientation === Orientation.HORIZONTAL ? this._width : this._height);\n\t}\n\n\tprivate _createSplitView(): void {\n\t\tthis._splitViewDisposables.clear();\n\t\tthis._splitView = new SplitView(this._container, { orientation: this.orientation });\n\t\tthis._splitViewDisposables.add(this._splitView);\n\t\tthis._splitViewDisposables.add(this._splitView.onDidSashReset(() => this._splitView.distributeViewSizes()));\n\t}\n\n\tsplit(instance: ITerminalInstance, index: number): void {\n\t\tthis._addChild(instance, index);\n\t}\n\n\tresizePane(index: number, direction: Direction, amount: number): void {\n\t\t// Only resize when there is more than one pane\n\t\tif (this._children.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get sizes\n\t\tconst sizes: number[] = [];\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\tsizes.push(this._splitView.getViewSize(i));\n\t\t}\n\n\t\t// Remove size from right pane, unless index is the last pane in which case use left pane\n\t\tconst isSizingEndPane = index !== this._children.length - 1;\n\t\tconst indexToChange = isSizingEndPane ? index + 1 : index - 1;\n\t\tif (isSizingEndPane && direction === Direction.Left) {\n\t\t\tamount *= -1;\n\t\t} else if (!isSizingEndPane && direction === Direction.Right) {\n\t\t\tamount *= -1;\n\t\t} else if (isSizingEndPane && direction === Direction.Up) {\n\t\t\tamount *= -1;\n\t\t} else if (!isSizingEndPane && direction === Direction.Down) {\n\t\t\tamount *= -1;\n\t\t}\n\n\t\t// Ensure the size is not reduced beyond the minimum, otherwise weird things can happen\n\t\tif (sizes[index] + amount < Constants.SplitPaneMinSize) {\n\t\t\tamount = Constants.SplitPaneMinSize - sizes[index];\n\t\t} else if (sizes[indexToChange] - amount < Constants.SplitPaneMinSize) {\n\t\t\tamount = sizes[indexToChange] - Constants.SplitPaneMinSize;\n\t\t}\n\n\t\t// Apply the size change\n\t\tsizes[index] += amount;\n\t\tsizes[indexToChange] -= amount;\n\t\tfor (let i = 0; i < this._splitView.length - 1; i++) {\n\t\t\tthis._splitView.resizeView(i, sizes[i]);\n\t\t}\n\t}\n\n\tresizePanes(relativeSizes: number[]): void {\n\t\tif (this._children.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// assign any extra size to last terminal\n\t\trelativeSizes[relativeSizes.length - 1] += 1 - relativeSizes.reduce((totalValue, currentValue) => totalValue + currentValue, 0);\n\t\tlet totalSize = 0;\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\ttotalSize += this._splitView.getViewSize(i);\n\t\t}\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\tthis._splitView.resizeView(i, totalSize * relativeSizes[i]);\n\t\t}\n\t}\n\n\tgetPaneSize(instance: ITerminalInstance): number {\n\t\tconst paneForInstance = this._terminalToPane.get(instance);\n\t\tif (!paneForInstance) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst index = this._children.indexOf(paneForInstance);\n\t\treturn this._splitView.getViewSize(index);\n\t}\n\n\tprivate _addChild(instance: ITerminalInstance, index: number): void {\n\t\tconst child = new SplitPane(instance, this.orientation === Orientation.HORIZONTAL ? this._height : this._width);\n\t\tchild.orientation = this.orientation;\n\t\tif (isNumber(index)) {\n\t\t\tthis._children.splice(index, 0, child);\n\t\t} else {\n\t\t\tthis._children.push(child);\n\t\t}\n\t\tthis._terminalToPane.set(instance, this._children[this._children.indexOf(child)]);\n\n\t\tthis._withDisabledLayout(() => this._splitView.addView(child, Sizing.Distribute, index));\n\t\tthis.layout(this._width, this._height);\n\n\t\tthis._onDidChange = Event.any(...this._children.map(c => c.onDidChange));\n\t}\n\n\tremove(instance: ITerminalInstance): void {\n\t\tlet index: number | null = null;\n\t\tfor (let i = 0; i < this._children.length; i++) {\n\t\t\tif (this._children[i].instance === instance) {\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t}\n\t\tif (index !== null) {\n\t\t\tthis._children.splice(index, 1);\n\t\t\tthis._terminalToPane.delete(instance);\n\t\t\tthis._splitView.removeView(index, Sizing.Distribute);\n\t\t\tinstance.detachFromElement();\n\t\t}\n\t}\n\n\tlayout(width: number, height: number): void {\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tif (this.orientation === Orientation.HORIZONTAL) {\n\t\t\tthis._children.forEach(c => c.orthogonalLayout(height));\n\t\t\tthis._splitView.layout(width);\n\t\t} else {\n\t\t\tthis._children.forEach(c => c.orthogonalLayout(width));\n\t\t\tthis._splitView.layout(height);\n\t\t}\n\t}\n\n\tsetOrientation(orientation: Orientation): void {\n\t\tif (this.orientation === orientation) {\n\t\t\treturn;\n\t\t}\n\t\tthis.orientation = orientation;\n\n\t\t// Remove old split view\n\t\twhile (this._container.children.length > 0) {\n\t\t\tthis._container.children[0].remove();\n\t\t}\n\n\t\t// Create new split view with updated orientation\n\t\tthis._createSplitView();\n\t\tthis._withDisabledLayout(() => {\n\t\t\tthis._children.forEach(child => {\n\t\t\t\tchild.orientation = orientation;\n\t\t\t\tthis._splitView.addView(child, 1);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _withDisabledLayout(innerFunction: () => void): void {\n\t\t// Whenever manipulating views that are going to be changed immediately, disabling\n\t\t// layout/resize events in the terminal prevent bad dimensions going to the pty.\n\t\tthis._children.forEach(c => c.instance.disableLayout = true);\n\t\tinnerFunction();\n\t\tthis._children.forEach(c => c.instance.disableLayout = false);\n\t}\n}\n\nclass SplitPane implements IView {\n\tminimumSize: number = Constants.SplitPaneMinSize;\n\tmaximumSize: number = Number.MAX_VALUE;\n\n\torientation: Orientation | undefined;\n\n\tprivate _onDidChange: Event<number | undefined> = Event.None;\n\tget onDidChange(): Event<number | undefined> { return this._onDidChange; }\n\n\treadonly element: HTMLElement;\n\n\tconstructor(\n\t\treadonly instance: ITerminalInstance,\n\t\tpublic orthogonalSize: number\n\t) {\n\t\tthis.element = document.createElement('div');\n\t\tthis.element.className = 'terminal-split-pane';\n\t\tthis.instance.attachToElement(this.element);\n\t}\n\n\tlayout(size: number): void {\n\t\t// Only layout when both sizes are known\n\t\tif (!size || !this.orthogonalSize) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.orientation === Orientation.VERTICAL) {\n\t\t\tthis.instance.layout({ width: this.orthogonalSize, height: size });\n\t\t} else {\n\t\t\tthis.instance.layout({ width: size, height: this.orthogonalSize });\n\t\t}\n\t}\n\n\torthogonalLayout(size: number): void {\n\t\tthis.orthogonalSize = size;\n\t}\n}\n\nexport class TerminalGroup extends Disposable implements ITerminalGroup {\n\tprivate _terminalInstances: ITerminalInstance[] = [];\n\tprivate _splitPaneContainer: SplitPaneContainer | undefined;\n\tprivate _groupElement: HTMLElement | undefined;\n\tprivate _panelPosition: Position = Position.BOTTOM;\n\tprivate _terminalLocation: ViewContainerLocation = ViewContainerLocation.Panel;\n\tprivate _instanceDisposables: Map<number, IDisposable[]> = new Map();\n\n\tprivate _activeInstanceIndex: number = -1;\n\n\tget terminalInstances(): ITerminalInstance[] { return this._terminalInstances; }\n\n\tprivate _hadFocusOnExit: boolean = false;\n\tget hadFocusOnExit(): boolean { return this._hadFocusOnExit; }\n\n\tprivate _initialRelativeSizes: number[] | undefined;\n\tprivate _visible: boolean = false;\n\n\tprivate readonly _onDidDisposeInstance: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidDisposeInstance = this._onDidDisposeInstance.event;\n\tprivate readonly _onDidFocusInstance: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidFocusInstance = this._onDidFocusInstance.event;\n\tprivate readonly _onDidChangeInstanceCapability: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidChangeInstanceCapability = this._onDidChangeInstanceCapability.event;\n\tprivate readonly _onDisposed: Emitter<ITerminalGroup> = this._register(new Emitter<ITerminalGroup>());\n\treadonly onDisposed = this._onDisposed.event;\n\tprivate readonly _onInstancesChanged: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onInstancesChanged = this._onInstancesChanged.event;\n\tprivate readonly _onDidChangeActiveInstance = this._register(new Emitter<ITerminalInstance | undefined>());\n\treadonly onDidChangeActiveInstance = this._onDidChangeActiveInstance.event;\n\tprivate readonly _onPanelOrientationChanged = this._register(new Emitter<Orientation>());\n\treadonly onPanelOrientationChanged = this._onPanelOrientationChanged.event;\n\n\tconstructor(\n\t\tprivate _container: HTMLElement | undefined,\n\t\tshellLaunchConfigOrInstance: IShellLaunchConfig | ITerminalInstance | undefined,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@ITerminalInstanceService private readonly _terminalInstanceService: ITerminalInstanceService,\n\t\t@IWorkbenchLayoutService private readonly _layoutService: IWorkbenchLayoutService,\n\t\t@IViewDescriptorService private readonly _viewDescriptorService: IViewDescriptorService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tif (shellLaunchConfigOrInstance) {\n\t\t\tthis.addInstance(shellLaunchConfigOrInstance);\n\t\t}\n\t\tif (this._container) {\n\t\t\tthis.attachToElement(this._container);\n\t\t}\n\t\tthis._onPanelOrientationChanged.fire(this._terminalLocation === ViewContainerLocation.Panel && isHorizontal(this._panelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL);\n\t\tthis._register(toDisposable(() => {\n\t\t\tif (this._container && this._groupElement) {\n\t\t\t\tthis._groupElement.remove();\n\t\t\t\tthis._groupElement = undefined;\n\t\t\t}\n\t\t}));\n\t}\n\n\taddInstance(shellLaunchConfigOrInstance: IShellLaunchConfig | ITerminalInstance, parentTerminalId?: number): void {\n\t\tlet instance: ITerminalInstance;\n\t\t// if a parent terminal is provided, find it\n\t\t// otherwise, parent is the active terminal\n\t\tconst parentIndex = parentTerminalId ? this._terminalInstances.findIndex(t => t.instanceId === parentTerminalId) : this._activeInstanceIndex;\n\t\tif (hasKey(shellLaunchConfigOrInstance, { instanceId: true })) {\n\t\t\tinstance = shellLaunchConfigOrInstance;\n\t\t} else {\n\t\t\tinstance = this._terminalInstanceService.createInstance(shellLaunchConfigOrInstance, TerminalLocation.Panel);\n\t\t}\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\tthis._terminalInstances.push(instance);\n\t\t\tthis._activeInstanceIndex = 0;\n\t\t} else {\n\t\t\tthis._terminalInstances.splice(parentIndex + 1, 0, instance);\n\t\t}\n\t\tthis._initInstanceListeners(instance);\n\n\t\tif (this._splitPaneContainer) {\n\t\t\tthis._splitPaneContainer.split(instance, parentIndex + 1);\n\t\t}\n\n\t\tthis._onInstancesChanged.fire();\n\t}\n\n\toverride dispose(): void {\n\t\tthis._terminalInstances = [];\n\t\tthis._onInstancesChanged.fire();\n\t\tthis._splitPaneContainer?.dispose();\n\t\tsuper.dispose();\n\t}\n\n\tget activeInstance(): ITerminalInstance | undefined {\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._terminalInstances[this._activeInstanceIndex];\n\t}\n\n\tgetLayoutInfo(isActive: boolean): ITerminalTabLayoutInfoById {\n\t\tconst instances = this.terminalInstances.filter(instance => isNumber(instance.persistentProcessId) && instance.shouldPersist);\n\t\tconst totalSize = instances.map(t => this._splitPaneContainer?.getPaneSize(t) || 0).reduce((total, size) => total += size, 0);\n\t\treturn {\n\t\t\tisActive: isActive,\n\t\t\tactivePersistentProcessId: this.activeInstance ? this.activeInstance.persistentProcessId : undefined,\n\t\t\tterminals: instances.map(t => {\n\t\t\t\treturn {\n\t\t\t\t\trelativeSize: totalSize > 0 ? this._splitPaneContainer!.getPaneSize(t) / totalSize : 0,\n\t\t\t\t\tterminal: t.persistentProcessId || 0\n\t\t\t\t};\n\t\t\t})\n\t\t};\n\t}\n\n\tprivate _initInstanceListeners(instance: ITerminalInstance) {\n\t\tthis._instanceDisposables.set(instance.instanceId, [\n\t\t\tinstance.onDisposed(instance => {\n\t\t\t\tthis._onDidDisposeInstance.fire(instance);\n\t\t\t\tthis._handleOnDidDisposeInstance(instance);\n\t\t\t}),\n\t\t\tinstance.onDidFocus(instance => {\n\t\t\t\tthis._setActiveInstance(instance);\n\t\t\t\tthis._onDidFocusInstance.fire(instance);\n\t\t\t}),\n\t\t\tinstance.capabilities.onDidChangeCapabilities(() => this._onDidChangeInstanceCapability.fire(instance)),\n\t\t]);\n\t}\n\n\tprivate _handleOnDidDisposeInstance(instance: ITerminalInstance) {\n\t\tthis._removeInstance(instance);\n\t}\n\n\tremoveInstance(instance: ITerminalInstance) {\n\t\tthis._removeInstance(instance);\n\t}\n\n\tprivate _removeInstance(instance: ITerminalInstance) {\n\t\tconst index = this._terminalInstances.indexOf(instance);\n\t\tif (index === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst wasActiveInstance = instance === this.activeInstance;\n\t\tthis._terminalInstances.splice(index, 1);\n\n\t\t// Adjust focus if the instance was active\n\t\tif (wasActiveInstance && this._terminalInstances.length > 0) {\n\t\t\tconst newIndex = index < this._terminalInstances.length ? index : this._terminalInstances.length - 1;\n\t\t\tthis.setActiveInstanceByIndex(newIndex);\n\t\t\t// TODO: Only focus the new instance if the group had focus?\n\t\t\tthis.activeInstance?.focus(true);\n\t\t} else if (index < this._activeInstanceIndex) {\n\t\t\t// Adjust active instance index if needed\n\t\t\tthis._activeInstanceIndex--;\n\t\t}\n\n\t\tthis._splitPaneContainer?.remove(instance);\n\n\t\t// Fire events and dispose group if it was the last instance\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\tthis._hadFocusOnExit = instance.hadFocusOnExit;\n\t\t\tthis._onDisposed.fire(this);\n\t\t\tthis.dispose();\n\t\t} else {\n\t\t\tthis._onInstancesChanged.fire();\n\t\t}\n\n\t\t// Dispose instance event listeners\n\t\tconst disposables = this._instanceDisposables.get(instance.instanceId);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t\tthis._instanceDisposables.delete(instance.instanceId);\n\t\t}\n\t}\n\n\tmoveInstance(instances: SingleOrMany<ITerminalInstance>, index: number, position: 'before' | 'after'): void {\n\t\tinstances = asArray(instances);\n\t\tconst hasInvalidInstance = instances.some(instance => !this.terminalInstances.includes(instance));\n\t\tif (hasInvalidInstance) {\n\t\t\treturn;\n\t\t}\n\t\tconst insertIndex = position === 'before' ? index : index + 1;\n\t\tthis._terminalInstances.splice(insertIndex, 0, ...instances);\n\t\tfor (const item of instances) {\n\t\t\tconst originSourceGroupIndex = position === 'after' ? this._terminalInstances.indexOf(item) : this._terminalInstances.lastIndexOf(item);\n\t\t\tthis._terminalInstances.splice(originSourceGroupIndex, 1);\n\t\t}\n\t\tif (this._splitPaneContainer) {\n\t\t\tfor (let i = 0; i < instances.length; i++) {\n\t\t\t\tconst item = instances[i];\n\t\t\t\tthis._splitPaneContainer.remove(item);\n\t\t\t\tthis._splitPaneContainer.split(item, index + (position === 'before' ? i : 0));\n\t\t\t}\n\t\t}\n\t\tthis._onInstancesChanged.fire();\n\t}\n\n\tprivate _setActiveInstance(instance: ITerminalInstance) {\n\t\tthis.setActiveInstanceByIndex(this._getIndexFromId(instance.instanceId));\n\t}\n\n\tprivate _getIndexFromId(terminalId: number): number {\n\t\tlet terminalIndex = -1;\n\t\tthis.terminalInstances.forEach((terminalInstance, i) => {\n\t\t\tif (terminalInstance.instanceId === terminalId) {\n\t\t\t\tterminalIndex = i;\n\t\t\t}\n\t\t});\n\t\tif (terminalIndex === -1) {\n\t\t\tthrow new Error(`Terminal with ID ${terminalId} does not exist (has it already been disposed?)`);\n\t\t}\n\t\treturn terminalIndex;\n\t}\n\n\tsetActiveInstanceByIndex(index: number, force?: boolean): void {\n\t\t// Check for invalid value\n\t\tif (index < 0 || index >= this._terminalInstances.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldActiveInstance = this.activeInstance;\n\t\tthis._activeInstanceIndex = index;\n\t\tif (oldActiveInstance !== this.activeInstance || force) {\n\t\t\tthis._onInstancesChanged.fire();\n\t\t\tthis._onDidChangeActiveInstance.fire(this.activeInstance);\n\t\t}\n\t}\n\n\tattachToElement(element: HTMLElement): void {\n\t\tthis._container = element;\n\n\t\t// If we already have a group element, we can reparent it\n\t\tif (!this._groupElement) {\n\t\t\tthis._groupElement = document.createElement('div');\n\t\t\tthis._groupElement.classList.add('terminal-group');\n\t\t}\n\n\t\tthis._container.appendChild(this._groupElement);\n\t\tif (!this._splitPaneContainer) {\n\t\t\tthis._panelPosition = this._layoutService.getPanelPosition();\n\t\t\tthis._terminalLocation = this._viewDescriptorService.getViewLocationById(TERMINAL_VIEW_ID)!;\n\t\t\tconst orientation = this._terminalLocation === ViewContainerLocation.Panel && isHorizontal(this._panelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t\t\tthis._splitPaneContainer = this._instantiationService.createInstance(SplitPaneContainer, this._groupElement, orientation);\n\t\t\tthis.terminalInstances.forEach(instance => this._splitPaneContainer!.split(instance, this._activeInstanceIndex + 1));\n\t\t}\n\t}\n\n\tget title(): string {\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\t// Normally consumers should not call into title at all after the group is disposed but\n\t\t\t// this is required when the group is used as part of a tree.\n\t\t\treturn '';\n\t\t}\n\t\tlet title = this.terminalInstances[0].title + this._getBellTitle(this.terminalInstances[0]);\n\t\tif (this.terminalInstances[0].description) {\n\t\t\ttitle += ` (${this.terminalInstances[0].description})`;\n\t\t}\n\t\tfor (let i = 1; i < this.terminalInstances.length; i++) {\n\t\t\tconst instance = this.terminalInstances[i];\n\t\t\tif (instance.title) {\n\t\t\t\ttitle += `, ${instance.title + this._getBellTitle(instance)}`;\n\t\t\t\tif (instance.description) {\n\t\t\t\t\ttitle += ` (${instance.description})`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn title;\n\t}\n\n\tprivate _getBellTitle(instance: ITerminalInstance) {\n\t\tif (this._terminalConfigurationService.config.enableBell && instance.statusList.statuses.some(e => e.id === TerminalStatus.Bell)) {\n\t\t\treturn '*';\n\t\t}\n\t\treturn '';\n\t}\n\n\tsetVisible(visible: boolean): void {\n\t\tthis._visible = visible;\n\t\tif (this._groupElement) {\n\t\t\tthis._groupElement.style.display = visible ? '' : 'none';\n\t\t}\n\t\tthis.terminalInstances.forEach(i => i.setVisible(visible));\n\t}\n\n\tsplit(shellLaunchConfig: IShellLaunchConfig): ITerminalInstance {\n\t\tconst instance = this._terminalInstanceService.createInstance(shellLaunchConfig, TerminalLocation.Panel);\n\t\tthis.addInstance(instance, shellLaunchConfig.parentTerminalId);\n\t\tthis._setActiveInstance(instance);\n\t\treturn instance;\n\t}\n\n\taddDisposable(disposable: IDisposable): void {\n\t\tthis._register(disposable);\n\t}\n\n\tlayout(width: number, height: number): void {\n\t\tif (this._splitPaneContainer) {\n\t\t\t// Check if the panel position changed and rotate panes if so\n\t\t\tconst newPanelPosition = this._layoutService.getPanelPosition();\n\t\t\tconst newTerminalLocation = this._viewDescriptorService.getViewLocationById(TERMINAL_VIEW_ID)!;\n\t\t\tconst terminalPositionChanged = newPanelPosition !== this._panelPosition || newTerminalLocation !== this._terminalLocation;\n\t\t\tif (terminalPositionChanged) {\n\t\t\t\tconst newOrientation = newTerminalLocation === ViewContainerLocation.Panel && isHorizontal(newPanelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t\t\t\tthis._splitPaneContainer.setOrientation(newOrientation);\n\t\t\t\tthis._panelPosition = newPanelPosition;\n\t\t\t\tthis._terminalLocation = newTerminalLocation;\n\t\t\t\tthis._onPanelOrientationChanged.fire(this._splitPaneContainer.orientation);\n\t\t\t}\n\t\t\tthis._splitPaneContainer.layout(width, height);\n\t\t\tif (this._initialRelativeSizes && this._visible) {\n\t\t\t\tthis.resizePanes(this._initialRelativeSizes);\n\t\t\t\tthis._initialRelativeSizes = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusPreviousPane(): void {\n\t\tconst newIndex = this._activeInstanceIndex === 0 ? this._terminalInstances.length - 1 : this._activeInstanceIndex - 1;\n\t\tthis.setActiveInstanceByIndex(newIndex);\n\t}\n\n\tfocusNextPane(): void {\n\t\tconst newIndex = this._activeInstanceIndex === this._terminalInstances.length - 1 ? 0 : this._activeInstanceIndex + 1;\n\t\tthis.setActiveInstanceByIndex(newIndex);\n\t}\n\n\tprivate _getPosition(): Position {\n\t\tswitch (this._terminalLocation) {\n\t\t\tcase ViewContainerLocation.Panel:\n\t\t\t\treturn this._panelPosition;\n\t\t\tcase ViewContainerLocation.Sidebar:\n\t\t\t\treturn this._layoutService.getSideBarPosition();\n\t\t\tcase ViewContainerLocation.AuxiliaryBar:\n\t\t\t\treturn this._layoutService.getSideBarPosition() === Position.LEFT ? Position.RIGHT : Position.LEFT;\n\t\t}\n\t}\n\n\tprivate _getOrientation(): Orientation {\n\t\treturn isHorizontal(this._getPosition()) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t}\n\n\tresizePane(direction: Direction): void {\n\t\tif (!this._splitPaneContainer) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isHorizontalResize = (direction === Direction.Left || direction === Direction.Right);\n\n\t\tconst groupOrientation = this._getOrientation();\n\n\t\tconst shouldResizePart =\n\t\t\t(isHorizontalResize && groupOrientation === Orientation.VERTICAL) ||\n\t\t\t(!isHorizontalResize && groupOrientation === Orientation.HORIZONTAL);\n\n\t\tconst font = this._terminalConfigurationService.getFont(getWindow(this._groupElement));\n\t\t// TODO: Support letter spacing and line height\n\t\tconst charSize = (isHorizontalResize ? font.charWidth : font.charHeight);\n\n\t\tif (charSize) {\n\t\t\tlet resizeAmount = charSize * Constants.ResizePartCellCount;\n\n\t\t\tif (shouldResizePart) {\n\n\t\t\t\tconst position = this._getPosition();\n\t\t\t\tconst shouldShrink =\n\t\t\t\t\t(position === Position.LEFT && direction === Direction.Left) ||\n\t\t\t\t\t(position === Position.RIGHT && direction === Direction.Right) ||\n\t\t\t\t\t(position === Position.BOTTOM && direction === Direction.Down) ||\n\t\t\t\t\t(position === Position.TOP && direction === Direction.Up);\n\n\t\t\t\tif (shouldShrink) {\n\t\t\t\t\tresizeAmount *= -1;\n\t\t\t\t}\n\n\t\t\t\tthis._layoutService.resizePart(getPartByLocation(this._terminalLocation), resizeAmount, resizeAmount);\n\t\t\t} else {\n\t\t\t\tthis._splitPaneContainer.resizePane(this._activeInstanceIndex, direction, resizeAmount);\n\t\t\t}\n\n\t\t}\n\t}\n\n\tresizePanes(relativeSizes: number[]): void {\n\t\tif (!this._splitPaneContainer) {\n\t\t\tthis._initialRelativeSizes = relativeSizes;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._splitPaneContainer.resizePanes(relativeSizes);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { TERMINAL_VIEW_ID } from '../common/terminal.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { IDisposable, Disposable, DisposableStore, dispose, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { SplitView, Orientation, IView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\nimport { isHorizontal, IWorkbenchLayoutService, Position } from '../../../services/layout/browser/layoutService.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITerminalInstance, Direction, ITerminalGroup, ITerminalInstanceService, ITerminalConfigurationService } from './terminal.js';\nimport { ViewContainerLocation, IViewDescriptorService } from '../../../common/views.js';\nimport { IShellLaunchConfig, ITerminalTabLayoutInfoById, TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { TerminalStatus } from './terminalStatusList.js';\nimport { getWindow } from '../../../../base/browser/dom.js';\nimport { getPartByLocation } from '../../../services/views/browser/viewsService.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { hasKey, isNumber, type SingleOrMany } from '../../../../base/common/types.js';\n\nconst enum Constants {\n\t/**\n\t * The minimum size in pixels of a split pane.\n\t */\n\tSplitPaneMinSize = 80,\n\t/**\n\t * The number of cells the terminal gets added or removed when asked to increase or decrease\n\t * the view size.\n\t */\n\tResizePartCellCount = 4\n}\n\nclass SplitPaneContainer extends Disposable {\n\tprivate _height: number;\n\tprivate _width: number;\n\tprivate _splitView!: SplitView;\n\tprivate readonly _splitViewDisposables = this._register(new DisposableStore());\n\tprivate _children: SplitPane[] = [];\n\tprivate _terminalToPane: Map<ITerminalInstance, SplitPane> = new Map();\n\n\tprivate _onDidChange: Event<number | undefined> = Event.None;\n\tget onDidChange(): Event<number | undefined> { return this._onDidChange; }\n\n\tconstructor(\n\t\tprivate _container: HTMLElement,\n\t\tpublic orientation: Orientation,\n\t) {\n\t\tsuper();\n\t\tthis._width = this._container.offsetWidth;\n\t\tthis._height = this._container.offsetHeight;\n\t\tthis._createSplitView();\n\t\tthis._splitView.layout(this.orientation === Orientation.HORIZONTAL ? this._width : this._height);\n\t}\n\n\tprivate _createSplitView(): void {\n\t\tthis._splitViewDisposables.clear();\n\t\tthis._splitView = new SplitView(this._container, { orientation: this.orientation });\n\t\tthis._splitViewDisposables.add(this._splitView);\n\t\tthis._splitViewDisposables.add(this._splitView.onDidSashReset(() => this._splitView.distributeViewSizes()));\n\t}\n\n\tsplit(instance: ITerminalInstance, index: number): void {\n\t\tthis._addChild(instance, index);\n\t}\n\n\tresizePane(index: number, direction: Direction, amount: number): void {\n\t\t// Only resize when there is more than one pane\n\t\tif (this._children.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get sizes\n\t\tconst sizes: number[] = [];\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\tsizes.push(this._splitView.getViewSize(i));\n\t\t}\n\n\t\t// Remove size from right pane, unless index is the last pane in which case use left pane\n\t\tconst isSizingEndPane = index !== this._children.length - 1;\n\t\tconst indexToChange = isSizingEndPane ? index + 1 : index - 1;\n\t\tif (isSizingEndPane && direction === Direction.Left) {\n\t\t\tamount *= -1;\n\t\t} else if (!isSizingEndPane && direction === Direction.Right) {\n\t\t\tamount *= -1;\n\t\t} else if (isSizingEndPane && direction === Direction.Up) {\n\t\t\tamount *= -1;\n\t\t} else if (!isSizingEndPane && direction === Direction.Down) {\n\t\t\tamount *= -1;\n\t\t}\n\n\t\t// Ensure the size is not reduced beyond the minimum, otherwise weird things can happen\n\t\tif (sizes[index] + amount < Constants.SplitPaneMinSize) {\n\t\t\tamount = Constants.SplitPaneMinSize - sizes[index];\n\t\t} else if (sizes[indexToChange] - amount < Constants.SplitPaneMinSize) {\n\t\t\tamount = sizes[indexToChange] - Constants.SplitPaneMinSize;\n\t\t}\n\n\t\t// Apply the size change\n\t\tsizes[index] += amount;\n\t\tsizes[indexToChange] -= amount;\n\t\tfor (let i = 0; i < this._splitView.length - 1; i++) {\n\t\t\tthis._splitView.resizeView(i, sizes[i]);\n\t\t}\n\t}\n\n\tresizePanes(relativeSizes: number[]): void {\n\t\tif (this._children.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// assign any extra size to last terminal\n\t\trelativeSizes[relativeSizes.length - 1] += 1 - relativeSizes.reduce((totalValue, currentValue) => totalValue + currentValue, 0);\n\t\tlet totalSize = 0;\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\ttotalSize += this._splitView.getViewSize(i);\n\t\t}\n\t\tfor (let i = 0; i < this._splitView.length; i++) {\n\t\t\tthis._splitView.resizeView(i, totalSize * relativeSizes[i]);\n\t\t}\n\t}\n\n\tgetPaneSize(instance: ITerminalInstance): number {\n\t\tconst paneForInstance = this._terminalToPane.get(instance);\n\t\tif (!paneForInstance) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst index = this._children.indexOf(paneForInstance);\n\t\treturn this._splitView.getViewSize(index);\n\t}\n\n\tprivate _addChild(instance: ITerminalInstance, index: number): void {\n\t\tconst child = new SplitPane(instance, this.orientation === Orientation.HORIZONTAL ? this._height : this._width);\n\t\tchild.orientation = this.orientation;\n\t\tif (isNumber(index)) {\n\t\t\tthis._children.splice(index, 0, child);\n\t\t} else {\n\t\t\tthis._children.push(child);\n\t\t}\n\t\tthis._terminalToPane.set(instance, this._children[this._children.indexOf(child)]);\n\n\t\tthis._withDisabledLayout(() => this._splitView.addView(child, Sizing.Distribute, index));\n\t\tthis.layout(this._width, this._height);\n\n\t\tthis._onDidChange = Event.any(...this._children.map(c => c.onDidChange));\n\t}\n\n\tremove(instance: ITerminalInstance): void {\n\t\tlet index: number | null = null;\n\t\tfor (let i = 0; i < this._children.length; i++) {\n\t\t\tif (this._children[i].instance === instance) {\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t}\n\t\tif (index !== null) {\n\t\t\tthis._children.splice(index, 1);\n\t\t\tthis._terminalToPane.delete(instance);\n\t\t\tthis._splitView.removeView(index, Sizing.Distribute);\n\t\t\tinstance.detachFromElement();\n\t\t}\n\t}\n\n\tlayout(width: number, height: number): void {\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tif (this.orientation === Orientation.HORIZONTAL) {\n\t\t\tthis._children.forEach(c => c.orthogonalLayout(height));\n\t\t\tthis._splitView.layout(width);\n\t\t} else {\n\t\t\tthis._children.forEach(c => c.orthogonalLayout(width));\n\t\t\tthis._splitView.layout(height);\n\t\t}\n\t}\n\n\tsetOrientation(orientation: Orientation): void {\n\t\tif (this.orientation === orientation) {\n\t\t\treturn;\n\t\t}\n\t\tthis.orientation = orientation;\n\n\t\t// Remove old split view\n\t\twhile (this._container.children.length > 0) {\n\t\t\tthis._container.children[0].remove();\n\t\t}\n\n\t\t// Create new split view with updated orientation\n\t\tthis._createSplitView();\n\t\tthis._withDisabledLayout(() => {\n\t\t\tthis._children.forEach(child => {\n\t\t\t\tchild.orientation = orientation;\n\t\t\t\tthis._splitView.addView(child, 1);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _withDisabledLayout(innerFunction: () => void): void {\n\t\t// Whenever manipulating views that are going to be changed immediately, disabling\n\t\t// layout/resize events in the terminal prevent bad dimensions going to the pty.\n\t\tthis._children.forEach(c => c.instance.disableLayout = true);\n\t\tinnerFunction();\n\t\tthis._children.forEach(c => c.instance.disableLayout = false);\n\t}\n}\n\nclass SplitPane implements IView {\n\tminimumSize: number = Constants.SplitPaneMinSize;\n\tmaximumSize: number = Number.MAX_VALUE;\n\n\torientation: Orientation | undefined;\n\n\tprivate _onDidChange: Event<number | undefined> = Event.None;\n\tget onDidChange(): Event<number | undefined> { return this._onDidChange; }\n\n\treadonly element: HTMLElement;\n\n\tconstructor(\n\t\treadonly instance: ITerminalInstance,\n\t\tpublic orthogonalSize: number\n\t) {\n\t\tthis.element = document.createElement('div');\n\t\tthis.element.className = 'terminal-split-pane';\n\t\tthis.instance.attachToElement(this.element);\n\t}\n\n\tlayout(size: number): void {\n\t\t// Only layout when both sizes are known\n\t\tif (!size || !this.orthogonalSize) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.orientation === Orientation.VERTICAL) {\n\t\t\tthis.instance.layout({ width: this.orthogonalSize, height: size });\n\t\t} else {\n\t\t\tthis.instance.layout({ width: size, height: this.orthogonalSize });\n\t\t}\n\t}\n\n\torthogonalLayout(size: number): void {\n\t\tthis.orthogonalSize = size;\n\t}\n}\n\nexport class TerminalGroup extends Disposable implements ITerminalGroup {\n\tprivate _terminalInstances: ITerminalInstance[] = [];\n\tprivate _splitPaneContainer: SplitPaneContainer | undefined;\n\tprivate _groupElement: HTMLElement | undefined;\n\tprivate _panelPosition: Position = Position.BOTTOM;\n\tprivate _terminalLocation: ViewContainerLocation = ViewContainerLocation.Panel;\n\tprivate _instanceDisposables: Map<number, IDisposable[]> = new Map();\n\n\tprivate _activeInstanceIndex: number = -1;\n\n\tget terminalInstances(): ITerminalInstance[] { return this._terminalInstances; }\n\n\tprivate _hadFocusOnExit: boolean = false;\n\tget hadFocusOnExit(): boolean { return this._hadFocusOnExit; }\n\n\tprivate _initialRelativeSizes: number[] | undefined;\n\tprivate _visible: boolean = false;\n\n\tprivate readonly _onDidDisposeInstance: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidDisposeInstance = this._onDidDisposeInstance.event;\n\tprivate readonly _onDidFocusInstance: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidFocusInstance = this._onDidFocusInstance.event;\n\tprivate readonly _onDidChangeInstanceCapability: Emitter<ITerminalInstance> = this._register(new Emitter<ITerminalInstance>());\n\treadonly onDidChangeInstanceCapability = this._onDidChangeInstanceCapability.event;\n\tprivate readonly _onDisposed: Emitter<ITerminalGroup> = this._register(new Emitter<ITerminalGroup>());\n\treadonly onDisposed = this._onDisposed.event;\n\tprivate readonly _onInstancesChanged: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onInstancesChanged = this._onInstancesChanged.event;\n\tprivate readonly _onDidChangeActiveInstance = this._register(new Emitter<ITerminalInstance | undefined>());\n\treadonly onDidChangeActiveInstance = this._onDidChangeActiveInstance.event;\n\tprivate readonly _onPanelOrientationChanged = this._register(new Emitter<Orientation>());\n\treadonly onPanelOrientationChanged = this._onPanelOrientationChanged.event;\n\n\tconstructor(\n\t\tprivate _container: HTMLElement | undefined,\n\t\tshellLaunchConfigOrInstance: IShellLaunchConfig | ITerminalInstance | undefined,\n\t\t@ITerminalConfigurationService private readonly _terminalConfigurationService: ITerminalConfigurationService,\n\t\t@ITerminalInstanceService private readonly _terminalInstanceService: ITerminalInstanceService,\n\t\t@IWorkbenchLayoutService private readonly _layoutService: IWorkbenchLayoutService,\n\t\t@IViewDescriptorService private readonly _viewDescriptorService: IViewDescriptorService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tif (shellLaunchConfigOrInstance) {\n\t\t\tthis.addInstance(shellLaunchConfigOrInstance);\n\t\t}\n\t\tif (this._container) {\n\t\t\tthis.attachToElement(this._container);\n\t\t}\n\t\tthis._onPanelOrientationChanged.fire(this._terminalLocation === ViewContainerLocation.Panel && isHorizontal(this._panelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL);\n\t\tthis._register(toDisposable(() => {\n\t\t\tif (this._container && this._groupElement) {\n\t\t\t\tthis._groupElement.remove();\n\t\t\t\tthis._groupElement = undefined;\n\t\t\t}\n\t\t}));\n\t}\n\n\taddInstance(shellLaunchConfigOrInstance: IShellLaunchConfig | ITerminalInstance, parentTerminalId?: number): void {\n\t\tlet instance: ITerminalInstance;\n\t\t// if a parent terminal is provided, find it\n\t\t// otherwise, parent is the active terminal\n\t\tconst parentIndex = parentTerminalId ? this._terminalInstances.findIndex(t => t.instanceId === parentTerminalId) : this._activeInstanceIndex;\n\t\tif (hasKey(shellLaunchConfigOrInstance, { instanceId: true })) {\n\t\t\tinstance = shellLaunchConfigOrInstance;\n\t\t} else {\n\t\t\tinstance = this._terminalInstanceService.createInstance(shellLaunchConfigOrInstance, TerminalLocation.Panel);\n\t\t}\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\tthis._terminalInstances.push(instance);\n\t\t\tthis._activeInstanceIndex = 0;\n\t\t} else {\n\t\t\tthis._terminalInstances.splice(parentIndex + 1, 0, instance);\n\t\t}\n\t\tthis._initInstanceListeners(instance);\n\n\t\tif (this._splitPaneContainer) {\n\t\t\tthis._splitPaneContainer.split(instance, parentIndex + 1);\n\t\t}\n\n\t\tthis._onInstancesChanged.fire();\n\t}\n\n\toverride dispose(): void {\n\t\tthis._terminalInstances = [];\n\t\tthis._onInstancesChanged.fire();\n\t\tthis._splitPaneContainer?.dispose();\n\t\tsuper.dispose();\n\t}\n\n\tget activeInstance(): ITerminalInstance | undefined {\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._terminalInstances[this._activeInstanceIndex];\n\t}\n\n\tgetLayoutInfo(isActive: boolean): ITerminalTabLayoutInfoById {\n\t\tconst instances = this.terminalInstances.filter(instance => isNumber(instance.persistentProcessId) && instance.shouldPersist);\n\t\tconst totalSize = instances.map(t => this._splitPaneContainer?.getPaneSize(t) || 0).reduce((total, size) => total += size, 0);\n\t\treturn {\n\t\t\tisActive: isActive,\n\t\t\tactivePersistentProcessId: this.activeInstance ? this.activeInstance.persistentProcessId : undefined,\n\t\t\tterminals: instances.map(t => {\n\t\t\t\treturn {\n\t\t\t\t\trelativeSize: totalSize > 0 ? this._splitPaneContainer!.getPaneSize(t) / totalSize : 0,\n\t\t\t\t\tterminal: t.persistentProcessId || 0\n\t\t\t\t};\n\t\t\t})\n\t\t};\n\t}\n\n\tprivate _initInstanceListeners(instance: ITerminalInstance) {\n\t\tthis._instanceDisposables.set(instance.instanceId, [\n\t\t\tinstance.onDisposed(instance => {\n\t\t\t\tthis._onDidDisposeInstance.fire(instance);\n\t\t\t\tthis._handleOnDidDisposeInstance(instance);\n\t\t\t}),\n\t\t\tinstance.onDidFocus(instance => {\n\t\t\t\tthis._setActiveInstance(instance);\n\t\t\t\tthis._onDidFocusInstance.fire(instance);\n\t\t\t}),\n\t\t\tinstance.capabilities.onDidChangeCapabilities(() => this._onDidChangeInstanceCapability.fire(instance)),\n\t\t]);\n\t}\n\n\tprivate _handleOnDidDisposeInstance(instance: ITerminalInstance) {\n\t\tthis._removeInstance(instance);\n\t}\n\n\tremoveInstance(instance: ITerminalInstance) {\n\t\tthis._removeInstance(instance);\n\t}\n\n\tprivate _removeInstance(instance: ITerminalInstance) {\n\t\tconst index = this._terminalInstances.indexOf(instance);\n\t\tif (index === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst wasActiveInstance = instance === this.activeInstance;\n\t\tthis._terminalInstances.splice(index, 1);\n\n\t\t// Adjust focus if the instance was active\n\t\tif (wasActiveInstance && this._terminalInstances.length > 0) {\n\t\t\tconst newIndex = index < this._terminalInstances.length ? index : this._terminalInstances.length - 1;\n\t\t\tthis.setActiveInstanceByIndex(newIndex);\n\t\t\t// TODO: Only focus the new instance if the group had focus?\n\t\t\tthis.activeInstance?.focus(true);\n\t\t} else if (index < this._activeInstanceIndex) {\n\t\t\t// Adjust active instance index if needed\n\t\t\tthis._activeInstanceIndex--;\n\t\t}\n\n\t\tthis._splitPaneContainer?.remove(instance);\n\n\t\t// Fire events and dispose group if it was the last instance\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\tthis._hadFocusOnExit = instance.hadFocusOnExit;\n\t\t\tthis._onDisposed.fire(this);\n\t\t\tthis.dispose();\n\t\t} else {\n\t\t\tthis._onInstancesChanged.fire();\n\t\t}\n\n\t\t// Dispose instance event listeners\n\t\tconst disposables = this._instanceDisposables.get(instance.instanceId);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t\tthis._instanceDisposables.delete(instance.instanceId);\n\t\t}\n\t}\n\n\tmoveInstance(instances: SingleOrMany<ITerminalInstance>, index: number, position: 'before' | 'after'): void {\n\t\tinstances = asArray(instances);\n\t\tconst hasInvalidInstance = instances.some(instance => !this.terminalInstances.includes(instance));\n\t\tif (hasInvalidInstance) {\n\t\t\treturn;\n\t\t}\n\t\tconst insertIndex = position === 'before' ? index : index + 1;\n\t\tthis._terminalInstances.splice(insertIndex, 0, ...instances);\n\t\tfor (const item of instances) {\n\t\t\tconst originSourceGroupIndex = position === 'after' ? this._terminalInstances.indexOf(item) : this._terminalInstances.lastIndexOf(item);\n\t\t\tthis._terminalInstances.splice(originSourceGroupIndex, 1);\n\t\t}\n\t\tif (this._splitPaneContainer) {\n\t\t\tfor (let i = 0; i < instances.length; i++) {\n\t\t\t\tconst item = instances[i];\n\t\t\t\tthis._splitPaneContainer.remove(item);\n\t\t\t\tthis._splitPaneContainer.split(item, index + (position === 'before' ? i : 0));\n\t\t\t}\n\t\t}\n\t\tthis._onInstancesChanged.fire();\n\t}\n\n\tprivate _setActiveInstance(instance: ITerminalInstance) {\n\t\tthis.setActiveInstanceByIndex(this._getIndexFromId(instance.instanceId));\n\t}\n\n\tprivate _getIndexFromId(terminalId: number): number {\n\t\tlet terminalIndex = -1;\n\t\tthis.terminalInstances.forEach((terminalInstance, i) => {\n\t\t\tif (terminalInstance.instanceId === terminalId) {\n\t\t\t\tterminalIndex = i;\n\t\t\t}\n\t\t});\n\t\tif (terminalIndex === -1) {\n\t\t\tthrow new Error(`Terminal with ID ${terminalId} does not exist (has it already been disposed?)`);\n\t\t}\n\t\treturn terminalIndex;\n\t}\n\n\tsetActiveInstanceByIndex(index: number, force?: boolean): void {\n\t\t// Check for invalid value\n\t\tif (index < 0 || index >= this._terminalInstances.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldActiveInstance = this.activeInstance;\n\t\tthis._activeInstanceIndex = index;\n\t\tif (oldActiveInstance !== this.activeInstance || force) {\n\t\t\tthis._onInstancesChanged.fire();\n\t\t\tthis._onDidChangeActiveInstance.fire(this.activeInstance);\n\t\t}\n\t}\n\n\tattachToElement(element: HTMLElement): void {\n\t\tthis._container = element;\n\n\t\t// If we already have a group element, we can reparent it\n\t\tif (!this._groupElement) {\n\t\t\tthis._groupElement = document.createElement('div');\n\t\t\tthis._groupElement.classList.add('terminal-group');\n\t\t}\n\n\t\tthis._container.appendChild(this._groupElement);\n\t\tif (!this._splitPaneContainer) {\n\t\t\tthis._panelPosition = this._layoutService.getPanelPosition();\n\t\t\tthis._terminalLocation = this._viewDescriptorService.getViewLocationById(TERMINAL_VIEW_ID)!;\n\t\t\tconst orientation = this._terminalLocation === ViewContainerLocation.Panel && isHorizontal(this._panelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t\t\tthis._splitPaneContainer = this._instantiationService.createInstance(SplitPaneContainer, this._groupElement, orientation);\n\t\t\tthis.terminalInstances.forEach(instance => this._splitPaneContainer!.split(instance, this._activeInstanceIndex + 1));\n\t\t}\n\t}\n\n\tget title(): string {\n\t\tif (this._terminalInstances.length === 0) {\n\t\t\t// Normally consumers should not call into title at all after the group is disposed but\n\t\t\t// this is required when the group is used as part of a tree.\n\t\t\treturn '';\n\t\t}\n\t\tlet title = this.terminalInstances[0].title + this._getBellTitle(this.terminalInstances[0]);\n\t\tif (this.terminalInstances[0].description) {\n\t\t\ttitle += ` (${this.terminalInstances[0].description})`;\n\t\t}\n\t\tfor (let i = 1; i < this.terminalInstances.length; i++) {\n\t\t\tconst instance = this.terminalInstances[i];\n\t\t\tif (instance.title) {\n\t\t\t\ttitle += `, ${instance.title + this._getBellTitle(instance)}`;\n\t\t\t\tif (instance.description) {\n\t\t\t\t\ttitle += ` (${instance.description})`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn title;\n\t}\n\n\tprivate _getBellTitle(instance: ITerminalInstance) {\n\t\tif (this._terminalConfigurationService.config.enableBell && instance.statusList.statuses.some(e => e.id === TerminalStatus.Bell)) {\n\t\t\treturn '*';\n\t\t}\n\t\treturn '';\n\t}\n\n\tsetVisible(visible: boolean): void {\n\t\tthis._visible = visible;\n\t\tif (this._groupElement) {\n\t\t\tthis._groupElement.style.display = visible ? '' : 'none';\n\t\t}\n\t\tthis.terminalInstances.forEach(i => i.setVisible(visible));\n\t}\n\n\tsplit(shellLaunchConfig: IShellLaunchConfig): ITerminalInstance {\n\t\tconst instance = this._terminalInstanceService.createInstance(shellLaunchConfig, TerminalLocation.Panel);\n\t\tthis.addInstance(instance, shellLaunchConfig.parentTerminalId);\n\t\tthis._setActiveInstance(instance);\n\t\treturn instance;\n\t}\n\n\taddDisposable(disposable: IDisposable): void {\n\t\tthis._register(disposable);\n\t}\n\n\tlayout(width: number, height: number): void {\n\t\tif (this._splitPaneContainer) {\n\t\t\t// Check if the panel position changed and rotate panes if so\n\t\t\tconst newPanelPosition = this._layoutService.getPanelPosition();\n\t\t\tconst newTerminalLocation = this._viewDescriptorService.getViewLocationById(TERMINAL_VIEW_ID)!;\n\t\t\tconst terminalPositionChanged = newPanelPosition !== this._panelPosition || newTerminalLocation !== this._terminalLocation;\n\t\t\tif (terminalPositionChanged) {\n\t\t\t\tconst newOrientation = newTerminalLocation === ViewContainerLocation.Panel && isHorizontal(newPanelPosition) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t\t\t\tthis._splitPaneContainer.setOrientation(newOrientation);\n\t\t\t\tthis._panelPosition = newPanelPosition;\n\t\t\t\tthis._terminalLocation = newTerminalLocation;\n\t\t\t\tthis._onPanelOrientationChanged.fire(this._splitPaneContainer.orientation);\n\t\t\t}\n\t\t\tthis._splitPaneContainer.layout(width, height);\n\t\t\tif (this._initialRelativeSizes && this._visible) {\n\t\t\t\tthis.resizePanes(this._initialRelativeSizes);\n\t\t\t\tthis._initialRelativeSizes = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusPreviousPane(): void {\n\t\tconst newIndex = this._activeInstanceIndex === 0 ? this._terminalInstances.length - 1 : this._activeInstanceIndex - 1;\n\t\tthis.setActiveInstanceByIndex(newIndex);\n\t}\n\n\tfocusNextPane(): void {\n\t\tconst newIndex = this._activeInstanceIndex === this._terminalInstances.length - 1 ? 0 : this._activeInstanceIndex + 1;\n\t\tthis.setActiveInstanceByIndex(newIndex);\n\t}\n\n\tprivate _getPosition(): Position {\n\t\tswitch (this._terminalLocation) {\n\t\t\tcase ViewContainerLocation.Panel:\n\t\t\t\treturn this._panelPosition;\n\t\t\tcase ViewContainerLocation.Sidebar:\n\t\t\t\treturn this._layoutService.getSideBarPosition();\n\t\t\tcase ViewContainerLocation.AuxiliaryBar:\n\t\t\t\treturn this._layoutService.getSideBarPosition() === Position.LEFT ? Position.RIGHT : Position.LEFT;\n\t\t}\n\t}\n\n\tprivate _getOrientation(): Orientation {\n\t\treturn isHorizontal(this._getPosition()) ? Orientation.HORIZONTAL : Orientation.VERTICAL;\n\t}\n\n\tresizePane(direction: Direction): void {\n\t\tif (!this._splitPaneContainer) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isHorizontalResize = (direction === Direction.Left || direction === Direction.Right);\n\n\t\tconst groupOrientation = this._getOrientation();\n\n\t\tconst shouldResizePart =\n\t\t\t(isHorizontalResize && groupOrientation === Orientation.VERTICAL) ||\n\t\t\t(!isHorizontalResize && groupOrientation === Orientation.HORIZONTAL);\n\n\t\tconst font = this._terminalConfigurationService.getFont(getWindow(this._groupElement));\n\t\t// TODO: Support letter spacing and line height\n\t\tconst charSize = (isHorizontalResize ? font.charWidth : font.charHeight);\n\n\t\tif (charSize) {\n\t\t\tlet resizeAmount = charSize * Constants.ResizePartCellCount;\n\n\t\t\tif (shouldResizePart) {\n\n\t\t\t\tconst position = this._getPosition();\n\t\t\t\tconst shouldShrink =\n\t\t\t\t\t(position === Position.LEFT && direction === Direction.Left) ||\n\t\t\t\t\t(position === Position.RIGHT && direction === Direction.Right) ||\n\t\t\t\t\t(position === Position.BOTTOM && direction === Direction.Down) ||\n\t\t\t\t\t(position === Position.TOP && direction === Direction.Up);\n\n\t\t\t\tif (shouldShrink) {\n\t\t\t\t\tresizeAmount *= -1;\n\t\t\t\t}\n\n\t\t\t\tthis._layoutService.resizePart(getPartByLocation(this._terminalLocation), resizeAmount, resizeAmount);\n\t\t\t} else {\n\t\t\t\tthis._splitPaneContainer.resizePane(this._activeInstanceIndex, direction, resizeAmount);\n\t\t\t}\n\n\t\t}\n\t}\n\n\tresizePanes(relativeSizes: number[]): void {\n\t\tif (!this._splitPaneContainer) {\n\t\t\tthis._initialRelativeSizes = relativeSizes;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._splitPaneContainer.resizePanes(relativeSizes);\n\t}\n}\n"]}