{"version":3,"sources":["vs/workbench/contrib/inlineChat/browser/inlineChatZoneWidget.ts"],"names":[],"mappings":"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","file":"inlineChatZoneWidget.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { addDisposableListener, Dimension } from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun } from '../../../../base/common/observable.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { StableEditorBottomScrollState } from '../../../../editor/browser/stableEditorScroll.js';\nimport { EditorOption } from '../../../../editor/common/config/editorOptions.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { IOptions, ZoneWidget } from '../../../../editor/contrib/zoneWidget/browser/zoneWidget.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IChatWidgetViewOptions } from '../../chat/browser/chat.js';\nimport { IChatWidgetLocationOptions } from '../../chat/browser/chatWidget.js';\nimport { ChatMode } from '../../chat/common/chatModes.js';\nimport { isResponseVM } from '../../chat/common/chatViewModel.js';\nimport { INotebookEditor } from '../../notebook/browser/notebookBrowser.js';\nimport { ACTION_REGENERATE_RESPONSE, ACTION_REPORT_ISSUE, ACTION_TOGGLE_DIFF, CTX_INLINE_CHAT_OUTER_CURSOR_POSITION, MENU_INLINE_CHAT_SIDE, MENU_INLINE_CHAT_WIDGET_SECONDARY, MENU_INLINE_CHAT_WIDGET_STATUS } from '../common/inlineChat.js';\nimport { EditorBasedInlineChatWidget } from './inlineChatWidget.js';\n\nexport class InlineChatZoneWidget extends ZoneWidget {\n\n\tprivate static readonly _options: IOptions = {\n\t\tshowFrame: true,\n\t\tframeWidth: 1,\n\t\t// frameColor: 'var(--vscode-inlineChat-border)',\n\t\tisResizeable: true,\n\t\tshowArrow: false,\n\t\tisAccessible: true,\n\t\tclassName: 'inline-chat-widget',\n\t\tkeepEditorSelection: true,\n\t\tshowInHiddenAreas: true,\n\t\tordinal: 50000,\n\t};\n\n\treadonly widget: EditorBasedInlineChatWidget;\n\n\tprivate readonly _scrollUp = this._disposables.add(new ScrollUpState(this.editor));\n\tprivate readonly _ctxCursorPosition: IContextKey<'above' | 'below' | ''>;\n\tprivate _dimension?: Dimension;\n\tprivate notebookEditor?: INotebookEditor;\n\n\tconstructor(\n\t\tlocation: IChatWidgetLocationOptions,\n\t\toptions: IChatWidgetViewOptions | undefined,\n\t\teditors: { editor: ICodeEditor; notebookEditor?: INotebookEditor },\n\t\t/** @deprecated should go away with inline2 */\n\t\tclearDelegate: () => Promise<void>,\n\t\t@IInstantiationService private readonly _instaService: IInstantiationService,\n\t\t@ILogService private _logService: ILogService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t) {\n\t\tsuper(editors.editor, InlineChatZoneWidget._options);\n\t\tthis.notebookEditor = editors.notebookEditor;\n\n\t\tthis._ctxCursorPosition = CTX_INLINE_CHAT_OUTER_CURSOR_POSITION.bindTo(contextKeyService);\n\n\t\tthis._disposables.add(toDisposable(() => {\n\t\t\tthis._ctxCursorPosition.reset();\n\t\t}));\n\n\t\tthis.widget = this._instaService.createInstance(EditorBasedInlineChatWidget, location, this.editor, {\n\t\t\tstatusMenuId: {\n\t\t\t\tmenu: MENU_INLINE_CHAT_WIDGET_STATUS,\n\t\t\t\toptions: {\n\t\t\t\t\tbuttonConfigProvider: (action, index) => {\n\t\t\t\t\t\tconst isSecondary = index > 0;\n\t\t\t\t\t\tif (new Set([ACTION_REGENERATE_RESPONSE, ACTION_TOGGLE_DIFF, ACTION_REPORT_ISSUE]).has(action.id)) {\n\t\t\t\t\t\t\treturn { isSecondary, showIcon: true, showLabel: false };\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn { isSecondary };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsecondaryMenuId: MENU_INLINE_CHAT_WIDGET_SECONDARY,\n\t\t\tinZoneWidget: true,\n\t\t\tchatWidgetViewOptions: {\n\t\t\t\tmenus: {\n\t\t\t\t\ttelemetrySource: 'interactiveEditorWidget-toolbar',\n\t\t\t\t\tinputSideToolbar: MENU_INLINE_CHAT_SIDE\n\t\t\t\t},\n\t\t\t\tclear: clearDelegate,\n\t\t\t\t...options,\n\t\t\t\trendererOptions: {\n\t\t\t\t\trenderTextEditsAsSummary: (uri) => {\n\t\t\t\t\t\t// render when dealing with the current file in the editor\n\t\t\t\t\t\treturn isEqual(uri, editors.editor.getModel()?.uri);\n\t\t\t\t\t},\n\t\t\t\t\trenderDetectedCommandsWithRequest: true,\n\t\t\t\t\t...options?.rendererOptions\n\t\t\t\t},\n\t\t\t\tdefaultMode: ChatMode.Ask\n\t\t\t}\n\t\t});\n\t\tthis._disposables.add(this.widget);\n\n\t\tlet revealFn: (() => void) | undefined;\n\t\tthis._disposables.add(this.widget.chatWidget.onWillMaybeChangeHeight(() => {\n\t\t\tif (this.position) {\n\t\t\t\trevealFn = this._createZoneAndScrollRestoreFn(this.position);\n\t\t\t}\n\t\t}));\n\t\tthis._disposables.add(this.widget.onDidChangeHeight(() => {\n\t\t\tif (this.position && !this._usesResizeHeight) {\n\t\t\t\t// only relayout when visible\n\t\t\t\trevealFn ??= this._createZoneAndScrollRestoreFn(this.position);\n\t\t\t\tconst height = this._computeHeight();\n\t\t\t\tthis._relayout(height.linesValue);\n\t\t\t\trevealFn?.();\n\t\t\t\trevealFn = undefined;\n\t\t\t}\n\t\t}));\n\n\t\tthis.create();\n\n\t\tthis._disposables.add(autorun(r => {\n\t\t\tconst isBusy = this.widget.requestInProgress.read(r);\n\t\t\tthis.domNode.firstElementChild?.classList.toggle('busy', isBusy);\n\t\t}));\n\n\t\tthis._disposables.add(addDisposableListener(this.domNode, 'click', e => {\n\t\t\tif (!this.editor.hasWidgetFocus() && !this.widget.hasFocus()) {\n\t\t\t\tthis.editor.focus();\n\t\t\t}\n\t\t}, true));\n\n\n\t\t// todo@jrieken listen ONLY when showing\n\t\tconst updateCursorIsAboveContextKey = () => {\n\t\t\tif (!this.position || !this.editor.hasModel()) {\n\t\t\t\tthis._ctxCursorPosition.reset();\n\t\t\t} else if (this.position.lineNumber === this.editor.getPosition().lineNumber) {\n\t\t\t\tthis._ctxCursorPosition.set('above');\n\t\t\t} else if (this.position.lineNumber + 1 === this.editor.getPosition().lineNumber) {\n\t\t\t\tthis._ctxCursorPosition.set('below');\n\t\t\t} else {\n\t\t\t\tthis._ctxCursorPosition.reset();\n\t\t\t}\n\t\t};\n\t\tthis._disposables.add(this.editor.onDidChangeCursorPosition(e => updateCursorIsAboveContextKey()));\n\t\tthis._disposables.add(this.editor.onDidFocusEditorText(e => updateCursorIsAboveContextKey()));\n\t\tupdateCursorIsAboveContextKey();\n\t}\n\n\tprotected override _fillContainer(container: HTMLElement): void {\n\n\t\tcontainer.style.setProperty('--vscode-inlineChat-background', 'var(--vscode-editor-background)');\n\n\t\tcontainer.appendChild(this.widget.domNode);\n\t}\n\n\tprotected override _doLayout(heightInPixel: number): void {\n\n\t\tthis._updatePadding();\n\n\t\tconst info = this.editor.getLayoutInfo();\n\t\tconst width = info.contentWidth - info.verticalScrollbarWidth;\n\t\t// width = Math.min(850, width);\n\n\t\tthis._dimension = new Dimension(width, heightInPixel);\n\t\tthis.widget.layout(this._dimension);\n\t}\n\n\tprivate _computeHeight(): { linesValue: number; pixelsValue: number } {\n\t\tconst chatContentHeight = this.widget.contentHeight;\n\t\tconst editorHeight = this.notebookEditor?.getLayoutInfo().height ?? this.editor.getLayoutInfo().height;\n\n\t\tconst contentHeight = this._decoratingElementsHeight() + Math.min(chatContentHeight, Math.max(this.widget.minHeight, editorHeight * 0.42));\n\t\tconst heightInLines = contentHeight / this.editor.getOption(EditorOption.lineHeight);\n\t\treturn { linesValue: heightInLines, pixelsValue: contentHeight };\n\t}\n\n\tprotected override _getResizeBounds(): { minLines: number; maxLines: number } {\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst decoHeight = this._decoratingElementsHeight();\n\n\t\tconst minHeightPx = decoHeight + this.widget.minHeight;\n\t\tconst maxHeightPx = decoHeight + this.widget.contentHeight;\n\n\t\treturn {\n\t\t\tminLines: minHeightPx / lineHeight,\n\t\t\tmaxLines: maxHeightPx / lineHeight\n\t\t};\n\t}\n\n\tprotected override _onWidth(_widthInPixel: number): void {\n\t\tif (this._dimension) {\n\t\t\tthis._doLayout(this._dimension.height);\n\t\t}\n\t}\n\n\toverride show(position: Position): void {\n\t\tassertType(this.container);\n\n\t\tthis._updatePadding();\n\n\t\tconst revealZone = this._createZoneAndScrollRestoreFn(position);\n\t\tsuper.show(position, this._computeHeight().linesValue);\n\t\tthis.widget.chatWidget.setVisible(true);\n\t\tthis.widget.focus();\n\n\t\trevealZone();\n\t\tthis._scrollUp.enable();\n\t}\n\n\tprivate _updatePadding() {\n\t\tassertType(this.container);\n\n\t\tconst info = this.editor.getLayoutInfo();\n\t\tconst marginWithoutIndentation = info.glyphMarginWidth + info.lineNumbersWidth + info.decorationsWidth;\n\t\tthis.container.style.paddingLeft = `${marginWithoutIndentation}px`;\n\t}\n\n\treveal(position: Position) {\n\t\tconst stickyScroll = this.editor.getOption(EditorOption.stickyScroll);\n\t\tconst magicValue = stickyScroll.enabled ? stickyScroll.maxLineCount : 0;\n\t\tthis.editor.revealLines(position.lineNumber + magicValue, position.lineNumber + magicValue, ScrollType.Immediate);\n\t\tthis._scrollUp.reset();\n\t\tthis.updatePositionAndHeight(position);\n\t}\n\n\toverride updatePositionAndHeight(position: Position): void {\n\t\tconst revealZone = this._createZoneAndScrollRestoreFn(position);\n\t\tsuper.updatePositionAndHeight(position, !this._usesResizeHeight ? this._computeHeight().linesValue : undefined);\n\t\trevealZone();\n\t}\n\n\tprivate _createZoneAndScrollRestoreFn(position: Position): () => void {\n\n\t\tconst scrollState = StableEditorBottomScrollState.capture(this.editor);\n\n\t\tconst lineNumber = position.lineNumber <= 1 ? 1 : 1 + position.lineNumber;\n\t\tconst scrollTop = this.editor.getScrollTop();\n\t\tconst lineTop = this.editor.getTopForLineNumber(lineNumber);\n\t\tconst zoneTop = lineTop - this._computeHeight().pixelsValue;\n\n\t\tconst hasResponse = this.widget.chatWidget.viewModel?.getItems().find(candidate => {\n\t\t\treturn isResponseVM(candidate) && candidate.response.value.length > 0;\n\t\t});\n\n\t\tif (hasResponse && zoneTop < scrollTop || this._scrollUp.didScrollUpOrDown) {\n\t\t\t// don't reveal the zone if it is already out of view (unless we are still getting ready)\n\t\t\t// or if an outside scroll-up happened (e.g the user scrolled up/down to see the new content)\n\t\t\treturn this._scrollUp.runIgnored(() => {\n\t\t\t\tscrollState.restore(this.editor);\n\t\t\t});\n\t\t}\n\n\t\treturn this._scrollUp.runIgnored(() => {\n\t\t\tscrollState.restore(this.editor);\n\n\t\t\tconst scrollTop = this.editor.getScrollTop();\n\t\t\tconst lineTop = this.editor.getTopForLineNumber(lineNumber);\n\t\t\tconst zoneTop = lineTop - this._computeHeight().pixelsValue;\n\t\t\tconst editorHeight = this.editor.getLayoutInfo().height;\n\t\t\tconst lineBottom = this.editor.getBottomForLineNumber(lineNumber);\n\n\t\t\tlet newScrollTop = zoneTop;\n\t\t\tlet forceScrollTop = false;\n\n\t\t\tif (lineBottom >= (scrollTop + editorHeight)) {\n\t\t\t\t// revealing the top of the zone would push out the line we are interested in and\n\t\t\t\t// therefore we keep the line in the viewport\n\t\t\t\tnewScrollTop = lineBottom - editorHeight;\n\t\t\t\tforceScrollTop = true;\n\t\t\t}\n\n\t\t\tif (newScrollTop < scrollTop || forceScrollTop) {\n\t\t\t\tthis._logService.trace('[IE] REVEAL zone', { zoneTop, lineTop, lineBottom, scrollTop, newScrollTop, forceScrollTop });\n\t\t\t\tthis.editor.setScrollTop(newScrollTop, ScrollType.Immediate);\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected override revealRange(range: Range, isLastLine: boolean): void {\n\t\t// noop\n\t}\n\n\toverride hide(): void {\n\t\tconst scrollState = StableEditorBottomScrollState.capture(this.editor);\n\t\tthis._scrollUp.disable();\n\t\tthis._ctxCursorPosition.reset();\n\t\tthis.widget.reset();\n\t\tthis.widget.chatWidget.setVisible(false);\n\t\tsuper.hide();\n\t\taria.status(localize('inlineChatClosed', 'Closed inline chat widget'));\n\t\tscrollState.restore(this.editor);\n\t}\n}\n\nclass ScrollUpState {\n\n\tprivate _didScrollUpOrDown?: boolean;\n\tprivate _ignoreEvents = false;\n\n\tprivate readonly _listener = new MutableDisposable();\n\n\tconstructor(private readonly _editor: ICodeEditor) { }\n\n\tdispose(): void {\n\t\tthis._listener.dispose();\n\t}\n\n\treset(): void {\n\t\tthis._didScrollUpOrDown = undefined;\n\t}\n\n\tenable(): void {\n\t\tthis._didScrollUpOrDown = undefined;\n\t\tthis._listener.value = this._editor.onDidScrollChange(e => {\n\t\t\tif (!e.scrollTopChanged || this._ignoreEvents) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._listener.clear();\n\t\t\tthis._didScrollUpOrDown = true;\n\t\t});\n\t}\n\n\tdisable(): void {\n\t\tthis._listener.clear();\n\t\tthis._didScrollUpOrDown = undefined;\n\t}\n\n\trunIgnored(callback: () => void): () => void {\n\t\treturn () => {\n\t\t\tthis._ignoreEvents = true;\n\t\t\ttry {\n\t\t\t\treturn callback();\n\t\t\t} finally {\n\t\t\t\tthis._ignoreEvents = false;\n\t\t\t}\n\t\t};\n\t}\n\n\tget didScrollUpOrDown(): boolean | undefined {\n\t\treturn this._didScrollUpOrDown;\n\t}\n\n}\n"]}