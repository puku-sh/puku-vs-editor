{"version":3,"sources":["vs/workbench/contrib/inlineChat/browser/inlineChatWidget.ts"],"names":[],"mappings":"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","file":"inlineChatWidget.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { $, Dimension, getActiveElement, getTotalHeight, getWindow, h, reset, trackFocus } from '../../../../base/browser/dom.js';\nimport { IActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derived, IObservable, ISettableObservable, observableValue } from '../../../../base/common/observable.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { AccessibleDiffViewer, IAccessibleDiffViewerModel } from '../../../../editor/browser/widget/diffEditor/components/accessibleDiffViewer.js';\nimport { EditorOption, IComputedEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { LineRange } from '../../../../editor/common/core/ranges/lineRange.js';\nimport { Selection } from '../../../../editor/common/core/selection.js';\nimport { DetailedLineRangeMapping, RangeMapping } from '../../../../editor/common/diff/rangeMapping.js';\nimport { ICodeEditorViewState, ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\nimport { ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { localize } from '../../../../nls.js';\nimport { IAccessibleViewService } from '../../../../platform/accessibility/browser/accessibleView.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { IWorkbenchButtonBarOptions, MenuWorkbenchButtonBar } from '../../../../platform/actions/browser/buttonbar.js';\nimport { createActionViewItem, IMenuEntryActionViewItemOptions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { MenuWorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { IMarkdownRendererService } from '../../../../platform/markdown/browser/markdownRenderer.js';\nimport product from '../../../../platform/product/common/product.js';\nimport { asCssVariable, asCssVariableName, editorBackground, inputBackground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { EDITOR_DRAG_AND_DROP_BACKGROUND } from '../../../common/theme.js';\nimport { IChatEntitlementService } from '../../../services/chat/common/chatEntitlementService.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { AccessibilityCommandId } from '../../accessibility/common/accessibilityCommands.js';\nimport { MarkUnhelpfulActionId } from '../../chat/browser/actions/chatTitleActions.js';\nimport { IChatWidgetViewOptions } from '../../chat/browser/chat.js';\nimport { ChatVoteDownButton } from '../../chat/browser/chatListRenderer.js';\nimport { ChatWidget, IChatWidgetLocationOptions } from '../../chat/browser/chatWidget.js';\nimport { chatRequestBackground } from '../../chat/common/chatColors.js';\nimport { ChatContextKeys } from '../../chat/common/chatContextKeys.js';\nimport { IChatModel } from '../../chat/common/chatModel.js';\nimport { ChatMode } from '../../chat/common/chatModes.js';\nimport { ChatAgentVoteDirection, IChatService } from '../../chat/common/chatService.js';\nimport { isResponseVM } from '../../chat/common/chatViewModel.js';\nimport { CTX_INLINE_CHAT_FOCUSED, CTX_INLINE_CHAT_RESPONSE_FOCUSED, inlineChatBackground, inlineChatForeground } from '../common/inlineChat.js';\nimport { HunkInformation, Session } from './inlineChatSession.js';\nimport './media/inlineChat.css';\n\nexport interface InlineChatWidgetViewState {\n\teditorViewState: ICodeEditorViewState;\n\tinput: string;\n\tplaceholder: string;\n}\n\nexport interface IInlineChatWidgetConstructionOptions {\n\n\t/**\n\t * The menu that rendered as button bar, use for accept, discard etc\n\t */\n\tstatusMenuId: MenuId | { menu: MenuId; options: IWorkbenchButtonBarOptions };\n\n\tsecondaryMenuId?: MenuId;\n\n\t/**\n\t * The options for the chat widget\n\t */\n\tchatWidgetViewOptions?: IChatWidgetViewOptions;\n\n\tinZoneWidget?: boolean;\n}\n\nexport class InlineChatWidget {\n\n\tprotected readonly _elements = h(\n\t\t'div.inline-chat@root',\n\t\t[\n\t\t\th('div.chat-widget@chatWidget'),\n\t\t\th('div.accessibleViewer@accessibleViewer'),\n\t\t\th('div.status@status', [\n\t\t\t\th('div.label.info.hidden@infoLabel'),\n\t\t\t\th('div.actions.hidden@toolbar1'),\n\t\t\t\th('div.label.status.hidden@statusLabel'),\n\t\t\t\th('div.actions.secondary.hidden@toolbar2'),\n\t\t\t\th('div.label.disclaimer.hidden@disclaimerLabel'),\n\t\t\t]),\n\t\t]\n\t);\n\n\tprotected readonly _store = new DisposableStore();\n\n\tprivate readonly _ctxInputEditorFocused: IContextKey<boolean>;\n\tprivate readonly _ctxResponseFocused: IContextKey<boolean>;\n\n\tprivate readonly _chatWidget: ChatWidget;\n\n\tprotected readonly _onDidChangeHeight = this._store.add(new Emitter<void>());\n\treadonly onDidChangeHeight: Event<void> = Event.filter(this._onDidChangeHeight.event, _ => !this._isLayouting);\n\n\tprivate readonly _requestInProgress = observableValue(this, false);\n\treadonly requestInProgress: IObservable<boolean> = this._requestInProgress;\n\n\tprivate _isLayouting: boolean = false;\n\n\treadonly scopedContextKeyService: IContextKeyService;\n\n\tconstructor(\n\t\tlocation: IChatWidgetLocationOptions,\n\t\tprivate readonly _options: IInlineChatWidgetConstructionOptions,\n\t\t@IInstantiationService protected readonly _instantiationService: IInstantiationService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IAccessibleViewService private readonly _accessibleViewService: IAccessibleViewService,\n\t\t@ITextModelService protected readonly _textModelResolverService: ITextModelService,\n\t\t@IChatService private readonly _chatService: IChatService,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t\t@IChatEntitlementService private readonly _chatEntitlementService: IChatEntitlementService,\n\t\t@IMarkdownRendererService private readonly _markdownRendererService: IMarkdownRendererService,\n\t) {\n\t\tthis.scopedContextKeyService = this._store.add(_contextKeyService.createScoped(this._elements.chatWidget));\n\t\tconst scopedInstaService = _instantiationService.createChild(\n\t\t\tnew ServiceCollection([\n\t\t\t\tIContextKeyService,\n\t\t\t\tthis.scopedContextKeyService\n\t\t\t]),\n\t\t\tthis._store\n\t\t);\n\n\t\tthis._chatWidget = scopedInstaService.createInstance(\n\t\t\tChatWidget,\n\t\t\tlocation,\n\t\t\t{ isInlineChat: true },\n\t\t\t{\n\t\t\t\tautoScroll: true,\n\t\t\t\tdefaultElementHeight: 32,\n\t\t\t\trenderStyle: 'minimal',\n\t\t\t\trenderInputOnTop: false,\n\t\t\t\trenderFollowups: true,\n\t\t\t\tsupportsFileReferences: true,\n\t\t\t\tfilter: item => {\n\t\t\t\t\tif (!isResponseVM(item) || item.errorDetails) {\n\t\t\t\t\t\t// show all requests and errors\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tconst emptyResponse = item.response.value.length === 0;\n\t\t\t\t\tif (emptyResponse) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (item.response.value.every(item => item.kind === 'textEditGroup' && _options.chatWidgetViewOptions?.rendererOptions?.renderTextEditsAsSummary?.(item.uri))) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tdndContainer: this._elements.root,\n\t\t\t\tdefaultMode: ChatMode.Ask,\n\t\t\t\t..._options.chatWidgetViewOptions\n\t\t\t},\n\t\t\t{\n\t\t\t\tlistForeground: inlineChatForeground,\n\t\t\t\tlistBackground: inlineChatBackground,\n\t\t\t\toverlayBackground: EDITOR_DRAG_AND_DROP_BACKGROUND,\n\t\t\t\tinputEditorBackground: inputBackground,\n\t\t\t\tresultEditorBackground: editorBackground\n\t\t\t}\n\t\t);\n\t\tthis._elements.root.classList.toggle('in-zone-widget', !!_options.inZoneWidget);\n\t\tthis._chatWidget.render(this._elements.chatWidget);\n\t\tthis._elements.chatWidget.style.setProperty(asCssVariableName(chatRequestBackground), asCssVariable(inlineChatBackground));\n\t\tthis._chatWidget.setVisible(true);\n\t\tthis._store.add(this._chatWidget);\n\n\t\tconst ctxResponse = ChatContextKeys.isResponse.bindTo(this.scopedContextKeyService);\n\t\tconst ctxResponseVote = ChatContextKeys.responseVote.bindTo(this.scopedContextKeyService);\n\t\tconst ctxResponseSupportIssues = ChatContextKeys.responseSupportsIssueReporting.bindTo(this.scopedContextKeyService);\n\t\tconst ctxResponseError = ChatContextKeys.responseHasError.bindTo(this.scopedContextKeyService);\n\t\tconst ctxResponseErrorFiltered = ChatContextKeys.responseIsFiltered.bindTo(this.scopedContextKeyService);\n\n\t\tconst viewModelStore = this._store.add(new DisposableStore());\n\t\tthis._store.add(this._chatWidget.onDidChangeViewModel(() => {\n\t\t\tviewModelStore.clear();\n\n\t\t\tconst viewModel = this._chatWidget.viewModel;\n\t\t\tif (!viewModel) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tviewModelStore.add(toDisposable(() => {\n\t\t\t\ttoolbar2.context = undefined;\n\t\t\t\tctxResponse.reset();\n\t\t\t\tctxResponseVote.reset();\n\t\t\t\tctxResponseError.reset();\n\t\t\t\tctxResponseErrorFiltered.reset();\n\t\t\t\tctxResponseSupportIssues.reset();\n\t\t\t}));\n\n\t\t\tviewModelStore.add(viewModel.onDidChange(() => {\n\n\t\t\t\tthis._requestInProgress.set(viewModel.model.requestInProgress.get(), undefined);\n\n\t\t\t\tconst last = viewModel.getItems().at(-1);\n\t\t\t\ttoolbar2.context = last;\n\n\t\t\t\tctxResponse.set(isResponseVM(last));\n\t\t\t\tctxResponseVote.set(isResponseVM(last) ? last.vote === ChatAgentVoteDirection.Down ? 'down' : last.vote === ChatAgentVoteDirection.Up ? 'up' : '' : '');\n\t\t\t\tctxResponseError.set(isResponseVM(last) && last.errorDetails !== undefined);\n\t\t\t\tctxResponseErrorFiltered.set((!!(isResponseVM(last) && last.errorDetails?.responseIsFiltered)));\n\t\t\t\tctxResponseSupportIssues.set(isResponseVM(last) && (last.agent?.metadata.supportIssueReporting ?? false));\n\n\t\t\t\tthis._onDidChangeHeight.fire();\n\t\t\t}));\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\n\t\tthis._store.add(this.chatWidget.onDidChangeContentHeight(() => {\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\n\t\t// context keys\n\t\tthis._ctxResponseFocused = CTX_INLINE_CHAT_RESPONSE_FOCUSED.bindTo(this._contextKeyService);\n\t\tconst tracker = this._store.add(trackFocus(this.domNode));\n\t\tthis._store.add(tracker.onDidBlur(() => this._ctxResponseFocused.set(false)));\n\t\tthis._store.add(tracker.onDidFocus(() => this._ctxResponseFocused.set(true)));\n\n\t\tthis._ctxInputEditorFocused = CTX_INLINE_CHAT_FOCUSED.bindTo(_contextKeyService);\n\t\tthis._store.add(this._chatWidget.inputEditor.onDidFocusEditorWidget(() => this._ctxInputEditorFocused.set(true)));\n\t\tthis._store.add(this._chatWidget.inputEditor.onDidBlurEditorWidget(() => this._ctxInputEditorFocused.set(false)));\n\n\t\tconst statusMenuId = _options.statusMenuId instanceof MenuId ? _options.statusMenuId : _options.statusMenuId.menu;\n\n\t\t// BUTTON bar\n\t\tconst statusMenuOptions = _options.statusMenuId instanceof MenuId ? undefined : _options.statusMenuId.options;\n\t\tconst statusButtonBar = scopedInstaService.createInstance(MenuWorkbenchButtonBar, this._elements.toolbar1, statusMenuId, {\n\t\t\ttoolbarOptions: { primaryGroup: '0_main' },\n\t\t\ttelemetrySource: _options.chatWidgetViewOptions?.menus?.telemetrySource,\n\t\t\tmenuOptions: { renderShortTitle: true },\n\t\t\t...statusMenuOptions,\n\t\t});\n\t\tthis._store.add(statusButtonBar.onDidChange(() => this._onDidChangeHeight.fire()));\n\t\tthis._store.add(statusButtonBar);\n\n\t\t// secondary toolbar\n\t\tconst toolbar2 = scopedInstaService.createInstance(MenuWorkbenchToolBar, this._elements.toolbar2, _options.secondaryMenuId ?? MenuId.for(''), {\n\t\t\ttelemetrySource: _options.chatWidgetViewOptions?.menus?.telemetrySource,\n\t\t\tmenuOptions: { renderShortTitle: true, shouldForwardArgs: true },\n\t\t\tactionViewItemProvider: (action: IAction, options: IActionViewItemOptions) => {\n\t\t\t\tif (action instanceof MenuItemAction && action.item.id === MarkUnhelpfulActionId) {\n\t\t\t\t\treturn scopedInstaService.createInstance(ChatVoteDownButton, action, options as IMenuEntryActionViewItemOptions);\n\t\t\t\t}\n\t\t\t\treturn createActionViewItem(scopedInstaService, action, options);\n\t\t\t}\n\t\t});\n\t\tthis._store.add(toolbar2.onDidChangeMenuItems(() => this._onDidChangeHeight.fire()));\n\t\tthis._store.add(toolbar2);\n\n\n\t\tthis._store.add(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(AccessibilityVerbositySettingId.InlineChat)) {\n\t\t\t\tthis._updateAriaLabel();\n\t\t\t}\n\t\t}));\n\n\t\tthis._elements.root.tabIndex = 0;\n\t\tthis._elements.statusLabel.tabIndex = 0;\n\t\tthis._updateAriaLabel();\n\t\tthis._setupDisclaimer();\n\n\t\tthis._store.add(this._hoverService.setupManagedHover(getDefaultHoverDelegate('element'), this._elements.statusLabel, () => {\n\t\t\treturn this._elements.statusLabel.dataset['title'];\n\t\t}));\n\n\t\tthis._store.add(this._chatService.onDidPerformUserAction(e => {\n\t\t\tif (isEqual(e.sessionResource, this._chatWidget.viewModel?.model.sessionResource) && e.action.kind === 'vote') {\n\t\t\t\tthis.updateStatus(localize('feedbackThanks', \"Thank you for your feedback!\"), { resetAfter: 1250 });\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _updateAriaLabel(): void {\n\n\t\tthis._elements.root.ariaLabel = this._accessibleViewService.getOpenAriaHint(AccessibilityVerbositySettingId.InlineChat);\n\n\t\tif (this._accessibilityService.isScreenReaderOptimized()) {\n\t\t\tlet label = defaultAriaLabel;\n\t\t\tif (this._configurationService.getValue<boolean>(AccessibilityVerbositySettingId.InlineChat)) {\n\t\t\t\tconst kbLabel = this._keybindingService.lookupKeybinding(AccessibilityCommandId.OpenAccessibilityHelp)?.getLabel();\n\t\t\t\tlabel = kbLabel\n\t\t\t\t\t? localize('inlineChat.accessibilityHelp', \"Inline Chat Input, Use {0} for Inline Chat Accessibility Help.\", kbLabel)\n\t\t\t\t\t: localize('inlineChat.accessibilityHelpNoKb', \"Inline Chat Input, Run the Inline Chat Accessibility Help command for more information.\");\n\t\t\t}\n\t\t\tthis._chatWidget.inputEditor.updateOptions({ ariaLabel: label });\n\t\t}\n\t}\n\n\tprivate _setupDisclaimer(): void {\n\t\tconst disposables = this._store.add(new DisposableStore());\n\n\t\tthis._store.add(autorun(reader => {\n\t\t\tdisposables.clear();\n\t\t\treset(this._elements.disclaimerLabel);\n\n\t\t\tconst sentiment = this._chatEntitlementService.sentimentObs.read(reader);\n\t\t\tconst anonymous = this._chatEntitlementService.anonymousObs.read(reader);\n\t\t\tconst requestInProgress = this._chatService.requestInProgressObs.read(reader);\n\n\t\t\tconst showDisclaimer = !sentiment.installed && anonymous && !requestInProgress;\n\t\t\tthis._elements.disclaimerLabel.classList.toggle('hidden', !showDisclaimer);\n\n\t\t\tif (showDisclaimer) {\n\t\t\t\tconst renderedMarkdown = disposables.add(this._markdownRendererService.render(new MarkdownString(localize({ key: 'termsDisclaimer', comment: ['{Locked=\"]({2})\"}', '{Locked=\"]({3})\"}'] }, \"By continuing with {0} Copilot, you agree to {1}'s [Terms]({2}) and [Privacy Statement]({3})\", product.defaultChatAgent?.provider?.default?.name ?? '', product.defaultChatAgent?.provider?.default?.name ?? '', product.defaultChatAgent?.termsStatementUrl ?? '', product.defaultChatAgent?.privacyStatementUrl ?? ''), { isTrusted: true })));\n\t\t\t\tthis._elements.disclaimerLabel.appendChild(renderedMarkdown.element);\n\t\t\t}\n\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n\n\tget domNode(): HTMLElement {\n\t\treturn this._elements.root;\n\t}\n\n\tget chatWidget(): ChatWidget {\n\t\treturn this._chatWidget;\n\t}\n\n\tsaveState() {\n\t\tthis._chatWidget.saveState();\n\t}\n\n\tlayout(widgetDim: Dimension) {\n\t\tconst contentHeight = this.contentHeight;\n\t\tthis._isLayouting = true;\n\t\ttry {\n\t\t\tthis._doLayout(widgetDim);\n\t\t} finally {\n\t\t\tthis._isLayouting = false;\n\n\t\t\tif (this.contentHeight !== contentHeight) {\n\t\t\t\tthis._onDidChangeHeight.fire();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _doLayout(dimension: Dimension): void {\n\t\tconst extraHeight = this._getExtraHeight();\n\t\tconst statusHeight = getTotalHeight(this._elements.status);\n\n\t\t// console.log('ZONE#Widget#layout', { height: dimension.height, extraHeight, progressHeight, followUpsHeight, statusHeight, LIST: dimension.height - progressHeight - followUpsHeight - statusHeight - extraHeight });\n\n\t\tthis._elements.root.style.height = `${dimension.height - extraHeight}px`;\n\t\tthis._elements.root.style.width = `${dimension.width}px`;\n\n\t\tthis._chatWidget.layout(\n\t\t\tdimension.height - statusHeight - extraHeight,\n\t\t\tdimension.width\n\t\t);\n\t}\n\n\t/**\n\t * The content height of this widget is the size that would require no scrolling\n\t */\n\tget contentHeight(): number {\n\t\tconst data = {\n\t\t\tchatWidgetContentHeight: this._chatWidget.contentHeight,\n\t\t\tstatusHeight: getTotalHeight(this._elements.status),\n\t\t\textraHeight: this._getExtraHeight()\n\t\t};\n\t\tconst result = data.chatWidgetContentHeight + data.statusHeight + data.extraHeight;\n\t\treturn result;\n\t}\n\n\tget minHeight(): number {\n\t\t// The chat widget is variable height and supports scrolling. It should be\n\t\t// at least \"maxWidgetHeight\" high and at most the content height.\n\n\t\tlet maxWidgetOutputHeight = 100;\n\t\tfor (const item of this._chatWidget.viewModel?.getItems() ?? []) {\n\t\t\tif (isResponseVM(item) && item.response.value.some(r => r.kind === 'textEditGroup' && !r.state?.applied)) {\n\t\t\t\tmaxWidgetOutputHeight = 270;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet value = this.contentHeight;\n\t\tvalue -= this._chatWidget.contentHeight;\n\t\tvalue += Math.min(this._chatWidget.input.contentHeight + maxWidgetOutputHeight, this._chatWidget.contentHeight);\n\t\treturn value;\n\t}\n\n\tprotected _getExtraHeight(): number {\n\t\treturn this._options.inZoneWidget ? 1 : (2 /*border*/ + 4 /*shadow*/);\n\t}\n\n\tget value(): string {\n\t\treturn this._chatWidget.getInput();\n\t}\n\n\tset value(value: string) {\n\t\tthis._chatWidget.setInput(value);\n\t}\n\n\tselectAll() {\n\t\tthis._chatWidget.inputEditor.setSelection(new Selection(1, 1, Number.MAX_SAFE_INTEGER, 1));\n\t}\n\n\tset placeholder(value: string) {\n\t\tthis._chatWidget.setInputPlaceholder(value);\n\t}\n\n\ttoggleStatus(show: boolean) {\n\t\tthis._elements.toolbar1.classList.toggle('hidden', !show);\n\t\tthis._elements.toolbar2.classList.toggle('hidden', !show);\n\t\tthis._elements.status.classList.toggle('hidden', !show);\n\t\tthis._elements.infoLabel.classList.toggle('hidden', !show);\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\tupdateToolbar(show: boolean) {\n\t\tthis._elements.root.classList.toggle('toolbar', show);\n\t\tthis._elements.toolbar1.classList.toggle('hidden', !show);\n\t\tthis._elements.toolbar2.classList.toggle('hidden', !show);\n\t\tthis._elements.status.classList.toggle('actions', show);\n\t\tthis._elements.infoLabel.classList.toggle('hidden', show);\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\tasync getCodeBlockInfo(codeBlockIndex: number): Promise<ITextModel | undefined> {\n\t\tconst { viewModel } = this._chatWidget;\n\t\tif (!viewModel) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst items = viewModel.getItems().filter(i => isResponseVM(i));\n\t\tconst item = items.at(-1);\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\t\treturn viewModel.codeBlockModelCollection.get(viewModel.sessionResource, item, codeBlockIndex)?.model;\n\t}\n\n\tget responseContent(): string | undefined {\n\t\tconst requests = this._chatWidget.viewModel?.model.getRequests();\n\t\treturn requests?.at(-1)?.response?.response.toString();\n\t}\n\n\n\tgetChatModel(): IChatModel | undefined {\n\t\treturn this._chatWidget.viewModel?.model;\n\t}\n\n\tsetChatModel(chatModel: IChatModel) {\n\t\tchatModel.inputModel.setState({ inputText: '', selections: [] });\n\t\tthis._chatWidget.setModel(chatModel);\n\t}\n\n\tupdateInfo(message: string): void {\n\t\tthis._elements.infoLabel.classList.toggle('hidden', !message);\n\t\tconst renderedMessage = renderLabelWithIcons(message);\n\t\treset(this._elements.infoLabel, ...renderedMessage);\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\tupdateStatus(message: string, ops: { classes?: string[]; resetAfter?: number; keepMessage?: boolean; title?: string } = {}) {\n\t\tconst isTempMessage = typeof ops.resetAfter === 'number';\n\t\tif (isTempMessage && !this._elements.statusLabel.dataset['state']) {\n\t\t\tconst statusLabel = this._elements.statusLabel.innerText;\n\t\t\tconst title = this._elements.statusLabel.dataset['title'];\n\t\t\tconst classes = Array.from(this._elements.statusLabel.classList.values());\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.updateStatus(statusLabel, { classes, keepMessage: true, title });\n\t\t\t}, ops.resetAfter);\n\t\t}\n\t\tconst renderedMessage = renderLabelWithIcons(message);\n\t\treset(this._elements.statusLabel, ...renderedMessage);\n\t\tthis._elements.statusLabel.className = `label status ${(ops.classes ?? []).join(' ')}`;\n\t\tthis._elements.statusLabel.classList.toggle('hidden', !message);\n\t\tif (isTempMessage) {\n\t\t\tthis._elements.statusLabel.dataset['state'] = 'temp';\n\t\t} else {\n\t\t\tdelete this._elements.statusLabel.dataset['state'];\n\t\t}\n\n\t\tif (ops.title) {\n\t\t\tthis._elements.statusLabel.dataset['title'] = ops.title;\n\t\t} else {\n\t\t\tdelete this._elements.statusLabel.dataset['title'];\n\t\t}\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\treset() {\n\t\tthis._chatWidget.attachmentModel.clear(true);\n\t\tthis._chatWidget.saveState();\n\n\t\treset(this._elements.statusLabel);\n\t\tthis._elements.statusLabel.classList.toggle('hidden', true);\n\t\tthis._elements.toolbar1.classList.add('hidden');\n\t\tthis._elements.toolbar2.classList.add('hidden');\n\t\tthis.updateInfo('');\n\n\t\tthis._elements.accessibleViewer.classList.toggle('hidden', true);\n\t\tthis._onDidChangeHeight.fire();\n\t}\n\n\tfocus() {\n\t\tthis._chatWidget.focusInput();\n\t}\n\n\thasFocus() {\n\t\treturn this.domNode.contains(getActiveElement());\n\t}\n\n}\n\nconst defaultAriaLabel = localize('aria-label', \"Inline Chat Input\");\n\nexport class EditorBasedInlineChatWidget extends InlineChatWidget {\n\n\tprivate readonly _accessibleViewer = this._store.add(new MutableDisposable<HunkAccessibleDiffViewer>());\n\n\n\tconstructor(\n\t\tlocation: IChatWidgetLocationOptions,\n\t\tprivate readonly _parentEditor: ICodeEditor,\n\t\toptions: IInlineChatWidgetConstructionOptions,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IAccessibleViewService accessibleViewService: IAccessibleViewService,\n\t\t@ITextModelService textModelResolverService: ITextModelService,\n\t\t@IChatService chatService: IChatService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@ILayoutService layoutService: ILayoutService,\n\t\t@IChatEntitlementService chatEntitlementService: IChatEntitlementService,\n\t\t@IMarkdownRendererService markdownRendererService: IMarkdownRendererService,\n\t) {\n\t\tconst overflowWidgetsNode = layoutService.getContainer(getWindow(_parentEditor.getContainerDomNode())).appendChild($('.inline-chat-overflow.monaco-editor'));\n\t\tsuper(location, {\n\t\t\t...options,\n\t\t\tchatWidgetViewOptions: {\n\t\t\t\t...options.chatWidgetViewOptions,\n\t\t\t\teditorOverflowWidgetsDomNode: overflowWidgetsNode\n\t\t\t}\n\t\t}, instantiationService, contextKeyService, keybindingService, accessibilityService, configurationService, accessibleViewService, textModelResolverService, chatService, hoverService, chatEntitlementService, markdownRendererService);\n\n\t\tthis._store.add(toDisposable(() => {\n\t\t\toverflowWidgetsNode.remove();\n\t\t}));\n\t}\n\n\t// --- layout\n\n\toverride get contentHeight(): number {\n\t\tlet result = super.contentHeight;\n\n\t\tif (this._accessibleViewer.value) {\n\t\t\tresult += this._accessibleViewer.value.height + 8 /* padding */;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprotected override _doLayout(dimension: Dimension): void {\n\n\t\tlet newHeight = dimension.height;\n\n\t\tif (this._accessibleViewer.value) {\n\t\t\tthis._accessibleViewer.value.width = dimension.width - 12;\n\t\t\tnewHeight -= this._accessibleViewer.value.height + 8;\n\t\t}\n\n\t\tsuper._doLayout(dimension.with(undefined, newHeight));\n\n\t\t// update/fix the height of the zone which was set to newHeight in super._doLayout\n\t\tthis._elements.root.style.height = `${dimension.height - this._getExtraHeight()}px`;\n\t}\n\n\toverride reset() {\n\t\tthis._accessibleViewer.clear();\n\t\tthis.chatWidget.setInput();\n\t\tsuper.reset();\n\t}\n\n\t// --- accessible viewer\n\n\tshowAccessibleHunk(session: Session, hunkData: HunkInformation): void {\n\n\t\tthis._elements.accessibleViewer.classList.remove('hidden');\n\t\tthis._accessibleViewer.clear();\n\n\t\tthis._accessibleViewer.value = this._instantiationService.createInstance(HunkAccessibleDiffViewer,\n\t\t\tthis._elements.accessibleViewer,\n\t\t\tsession,\n\t\t\thunkData,\n\t\t\tnew AccessibleHunk(this._parentEditor, session, hunkData)\n\t\t);\n\n\t\tthis._onDidChangeHeight.fire();\n\t}\n}\n\nclass HunkAccessibleDiffViewer extends AccessibleDiffViewer {\n\n\treadonly height: number;\n\n\tset width(value: number) {\n\t\tthis._width2.set(value, undefined);\n\t}\n\n\tprivate readonly _width2: ISettableObservable<number>;\n\n\tconstructor(\n\t\tparentNode: HTMLElement,\n\t\tsession: Session,\n\t\thunk: HunkInformation,\n\t\tmodels: IAccessibleDiffViewerModel,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tconst width = observableValue('width', 0);\n\t\tconst diff = observableValue('diff', HunkAccessibleDiffViewer._asMapping(hunk));\n\t\tconst diffs = derived(r => [diff.read(r)]);\n\t\tconst lines = Math.min(10, 8 + diff.get().changedLineCount);\n\t\tconst height = models.getModifiedOptions().get(EditorOption.lineHeight) * lines;\n\n\t\tsuper(parentNode, constObservable(true), () => { }, constObservable(false), width, constObservable(height), diffs, models, instantiationService);\n\n\t\tthis.height = height;\n\t\tthis._width2 = width;\n\n\t\tthis._store.add(session.textModelN.onDidChangeContent(() => {\n\t\t\tdiff.set(HunkAccessibleDiffViewer._asMapping(hunk), undefined);\n\t\t}));\n\t}\n\n\tprivate static _asMapping(hunk: HunkInformation): DetailedLineRangeMapping {\n\t\tconst ranges0 = hunk.getRanges0();\n\t\tconst rangesN = hunk.getRangesN();\n\t\tconst originalLineRange = LineRange.fromRangeInclusive(ranges0[0]);\n\t\tconst modifiedLineRange = LineRange.fromRangeInclusive(rangesN[0]);\n\t\tconst innerChanges: RangeMapping[] = [];\n\t\tfor (let i = 1; i < ranges0.length; i++) {\n\t\t\tinnerChanges.push(new RangeMapping(ranges0[i], rangesN[i]));\n\t\t}\n\t\treturn new DetailedLineRangeMapping(originalLineRange, modifiedLineRange, innerChanges);\n\t}\n\n}\n\nclass AccessibleHunk implements IAccessibleDiffViewerModel {\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\tprivate readonly _session: Session,\n\t\tprivate readonly _hunk: HunkInformation\n\t) { }\n\n\tgetOriginalModel(): ITextModel {\n\t\treturn this._session.textModel0;\n\t}\n\tgetModifiedModel(): ITextModel {\n\t\treturn this._session.textModelN;\n\t}\n\tgetOriginalOptions(): IComputedEditorOptions {\n\t\treturn this._editor.getOptions();\n\t}\n\tgetModifiedOptions(): IComputedEditorOptions {\n\t\treturn this._editor.getOptions();\n\t}\n\toriginalReveal(range: Range): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tmodifiedReveal(range?: Range | undefined): void {\n\t\tthis._editor.revealRangeInCenterIfOutsideViewport(range || this._hunk.getRangesN()[0], ScrollType.Smooth);\n\t}\n\tmodifiedSetSelection(range: Range): void {\n\t\t// this._editor.revealRangeInCenterIfOutsideViewport(range, ScrollType.Smooth);\n\t\t// this._editor.setSelection(range);\n\t}\n\tmodifiedFocus(): void {\n\t\tthis._editor.focus();\n\t}\n\tgetModifiedPosition(): Position | undefined {\n\t\treturn this._hunk.getRangesN()[0].getStartPosition();\n\t}\n}\n"]}