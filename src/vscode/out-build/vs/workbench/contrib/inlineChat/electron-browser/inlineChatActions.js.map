{"version":3,"sources":["vs/workbench/contrib/inlineChat/electron-browser/inlineChatActions.ts"],"names":[],"mappings":"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","file":"inlineChatActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { InlineChatController } from '../browser/inlineChatController.js';\nimport { AbstractInline1ChatAction, setHoldForSpeech } from '../browser/inlineChatActions.js';\nimport { disposableTimeout } from '../../../../base/common/async.js';\nimport { EditorContextKeys } from '../../../../editor/common/editorContextKeys.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { StartVoiceChatAction, StopListeningAction, VOICE_KEY_HOLD_THRESHOLD } from '../../chat/electron-browser/actions/voiceChatActions.js';\nimport { IChatExecuteActionContext } from '../../chat/browser/actions/chatExecuteActions.js';\nimport { CTX_INLINE_CHAT_VISIBLE, InlineChatConfigKeys } from '../common/inlineChat.js';\nimport { HasSpeechProvider, ISpeechService } from '../../speech/common/speechService.js';\nimport { localize2 } from '../../../../nls.js';\nimport { Action2 } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { EditorAction2 } from '../../../../editor/browser/editorExtensions.js';\n\nexport class HoldToSpeak extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'inlineChat.holdForSpeech',\n\t\t\tcategory: AbstractInline1ChatAction.category,\n\t\t\tprecondition: ContextKeyExpr.and(HasSpeechProvider, CTX_INLINE_CHAT_VISIBLE),\n\t\t\ttitle: localize2('holdForSpeech', \"Hold for Speech\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: EditorContextKeys.textInputFocus,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyI,\n\t\t\t},\n\t\t});\n\t}\n\n\toverride runEditorCommand(accessor: ServicesAccessor, editor: ICodeEditor, ..._args: unknown[]) {\n\t\tconst ctrl = InlineChatController.get(editor);\n\t\tif (ctrl) {\n\t\t\tholdForSpeech(accessor, ctrl, this);\n\t\t}\n\t}\n}\n\nfunction holdForSpeech(accessor: ServicesAccessor, ctrl: InlineChatController, action: Action2): void {\n\n\tconst configService = accessor.get(IConfigurationService);\n\tconst speechService = accessor.get(ISpeechService);\n\tconst keybindingService = accessor.get(IKeybindingService);\n\tconst commandService = accessor.get(ICommandService);\n\n\t// enabled or possible?\n\tif (!configService.getValue<boolean>(InlineChatConfigKeys.HoldToSpeech || !speechService.hasSpeechProvider)) {\n\t\treturn;\n\t}\n\n\tconst holdMode = keybindingService.enableKeybindingHoldMode(action.desc.id);\n\tif (!holdMode) {\n\t\treturn;\n\t}\n\tlet listening = false;\n\tconst handle = disposableTimeout(() => {\n\t\t// start VOICE input\n\t\tcommandService.executeCommand(StartVoiceChatAction.ID, { voice: { disableTimeout: true } } satisfies IChatExecuteActionContext);\n\t\tlistening = true;\n\t}, VOICE_KEY_HOLD_THRESHOLD);\n\n\tholdMode.finally(() => {\n\t\tif (listening) {\n\t\t\tcommandService.executeCommand(StopListeningAction.ID).finally(() => {\n\t\t\t\tctrl.widget.chatWidget.acceptInput();\n\t\t\t});\n\t\t}\n\t\thandle.dispose();\n\t});\n}\n\n// make this accessible to the chat actions from the browser layer\nsetHoldForSpeech(holdForSpeech);\n"]}