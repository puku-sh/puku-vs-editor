{"version":3,"sources":["vs/workbench/contrib/snippets/browser/commands/insertSnippet.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAIhG,OAAO,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACtF,OAAO,EAAE,gBAAgB,EAAE,MAAM,oDAAoD,CAAC;AACtF,OAAO,EAAE,kBAAkB,EAAE,MAAM,qEAAqE,CAAC;AACzG,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAC7C,OAAO,EAAE,iBAAiB,EAAE,MAAM,8DAA8D,CAAC;AACjG,OAAO,EAAE,qBAAqB,EAAE,MAAM,+DAA+D,CAAC;AACtG,OAAO,EAAE,mBAAmB,EAAE,MAAM,8BAA8B,CAAC;AACnE,OAAO,EAAE,WAAW,EAAE,MAAM,qBAAqB,CAAC;AAClD,OAAO,EAAE,gBAAgB,EAAE,MAAM,gBAAgB,CAAC;AAClD,OAAO,EAAE,OAAO,EAAiB,MAAM,oBAAoB,CAAC;AAE5D,MAAM,IAAI;IAET,MAAM,CAAC,QAAQ,CAAC,GAAQ;QACvB,IAAI,CAAC,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE,CAAC;YACrC,OAAO,IAAI,CAAC,MAAM,CAAC;QACpB,CAAC;QACD,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC;QACpC,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE,CAAC;YACjC,OAAO,GAAG,SAAS,CAAC;QACrB,CAAC;QACD,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,CAAC;YAC9B,IAAI,GAAG,SAAS,CAAC;QAClB,CAAC;QACD,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE,CAAC;YAChC,MAAM,GAAG,SAAS,CAAC;QACpB,CAAC;QACD,OAAO,IAAI,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;IACxC,CAAC;aAEuB,WAAM,GAAG,IAAI,IAAI,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IAE3E,YACiB,OAA2B,EAC3B,IAAwB,EACxB,MAA0B;QAF1B,YAAO,GAAP,OAAO,CAAoB;QAC3B,SAAI,GAAJ,IAAI,CAAoB;QACxB,WAAM,GAAN,MAAM,CAAoB;IACvC,CAAC;;AAGN,MAAM,OAAO,mBAAoB,SAAQ,mBAAmB;IAE3D;QACC,KAAK,CAAC;YACL,EAAE,EAAE,6BAA6B;YACjC,KAAK,EAAE,GAAG,CAAC,SAAS,CAAC,KAA2B,EAAE,gBAAgB,CAAC;YACnE,EAAE,EAAE,IAAI;YACR,YAAY,EAAE,iBAAiB,CAAC,QAAQ;YACxC,QAAQ,EAAE;gBACT,WAAW,EAAE,gBAAgB;gBAC7B,IAAI,EAAE,CAAC;wBACN,IAAI,EAAE,MAAM;wBACZ,MAAM,EAAE;4BACP,MAAM,EAAE,QAAQ;4BAChB,YAAY,EAAE;gCACb,SAAS,EAAE;oCACV,MAAM,EAAE,QAAQ;iCAChB;gCACD,QAAQ,EAAE;oCACT,MAAM,EAAE,QAAQ;iCAEhB;gCACD,MAAM,EAAE;oCACP,MAAM,EAAE,QAAQ;iCAChB;6BACD;yBACD;qBACD,CAAC;aACF;SACD,CAAC,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,QAA0B,EAAE,MAAmB,EAAE,GAAQ;QAE/E,MAAM,eAAe,GAAG,QAAQ,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;QACvD,MAAM,cAAc,GAAG,QAAQ,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;QAEtD,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC;YACxB,OAAO;QACR,CAAC;QAED,MAAM,gBAAgB,GAAG,QAAQ,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QACzD,MAAM,YAAY,GAAG,QAAQ,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;QAEzD,MAAM,OAAO,GAAG,MAAM,IAAI,OAAO,CAAsB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YAE1E,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;YACpD,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAErD,IAAI,OAAO,EAAE,CAAC;gBACb,OAAO,OAAO,CAAC,IAAI,OAAO,CACzB,KAAK,EACL,EAAE,EACF,EAAE,EACF,EAAE,EACF,EAAE,EACF,OAAO,EACP,EAAE,8BAEF,UAAU,IAAI,CAAC,MAAM,EAAE,EAAE,CACzB,CAAC,CAAC;YACJ,CAAC;YAED,IAAI,UAAkB,CAAC;YACvB,IAAI,MAAM,EAAE,CAAC;gBACZ,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,MAAM,CAAC,EAAE,CAAC;oBACrD,OAAO,OAAO,CAAC,SAAS,CAAC,CAAC;gBAC3B,CAAC;gBACD,UAAU,GAAG,MAAM,CAAC;YACrB,CAAC;iBAAM,CAAC;gBACP,MAAM,CAAC,QAAQ,EAAE,CAAC,YAAY,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;gBAC3D,UAAU,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC,uBAAuB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;gBAE3E,qDAAqD;gBACrD,qDAAqD;gBACrD,iDAAiD;gBACjD,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE,CAAC;oBAClD,UAAU,GAAG,MAAM,CAAC,QAAQ,EAAE,CAAC,aAAa,EAAE,CAAC;gBAChD,CAAC;YACF,CAAC;YAED,IAAI,IAAI,EAAE,CAAC;gBACV,wBAAwB;gBACxB,cAAc,CAAC,WAAW,CAAC,UAAU,EAAE,EAAE,uBAAuB,EAAE,IAAI,EAAE,CAAC;qBACvE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC;qBACjE,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YAEzB,CAAC;iBAAM,CAAC;gBACP,0BAA0B;gBAC1B,OAAO,CAAC,YAAY,CAAC,cAAc,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC;YAC/D,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,OAAO;QACR,CAAC;QACD,IAAI,aAAiC,CAAC;QACtC,IAAI,OAAO,CAAC,cAAc,EAAE,CAAC;YAC5B,aAAa,GAAG,MAAM,gBAAgB,CAAC,QAAQ,EAAE,CAAC;QACnD,CAAC;QACD,MAAM,CAAC,KAAK,EAAE,CAAC;QACf,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;QAC/E,cAAc,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;IAC9C,CAAC;CACD","file":"insertSnippet.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ICodeEditor } from '../../../../../editor/browser/editorBrowser.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../../../editor/common/editorContextKeys.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { SnippetController2 } from '../../../../../editor/contrib/snippet/browser/snippetController2.js';\nimport * as nls from '../../../../../nls.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { SnippetEditorAction } from './abstractSnippetsActions.js';\nimport { pickSnippet } from '../snippetPicker.js';\nimport { ISnippetsService } from '../snippets.js';\nimport { Snippet, SnippetSource } from '../snippetsFile.js';\n\nclass Args {\n\n\tstatic fromUser(arg: any): Args {\n\t\tif (!arg || typeof arg !== 'object') {\n\t\t\treturn Args._empty;\n\t\t}\n\t\tlet { snippet, name, langId } = arg;\n\t\tif (typeof snippet !== 'string') {\n\t\t\tsnippet = undefined;\n\t\t}\n\t\tif (typeof name !== 'string') {\n\t\t\tname = undefined;\n\t\t}\n\t\tif (typeof langId !== 'string') {\n\t\t\tlangId = undefined;\n\t\t}\n\t\treturn new Args(snippet, name, langId);\n\t}\n\n\tprivate static readonly _empty = new Args(undefined, undefined, undefined);\n\n\tprivate constructor(\n\t\tpublic readonly snippet: string | undefined,\n\t\tpublic readonly name: string | undefined,\n\t\tpublic readonly langId: string | undefined\n\t) { }\n}\n\nexport class InsertSnippetAction extends SnippetEditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.insertSnippet',\n\t\t\ttitle: nls.localize2('snippet.suggestions.label', \"Insert Snippet\"),\n\t\t\tf1: true,\n\t\t\tprecondition: EditorContextKeys.writable,\n\t\t\tmetadata: {\n\t\t\t\tdescription: `Insert Snippet`,\n\t\t\t\targs: [{\n\t\t\t\t\tname: 'args',\n\t\t\t\t\tschema: {\n\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t'snippet': {\n\t\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'langId': {\n\t\t\t\t\t\t\t\t'type': 'string',\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'name': {\n\t\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runEditorCommand(accessor: ServicesAccessor, editor: ICodeEditor, arg: any) {\n\n\t\tconst languageService = accessor.get(ILanguageService);\n\t\tconst snippetService = accessor.get(ISnippetsService);\n\n\t\tif (!editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst clipboardService = accessor.get(IClipboardService);\n\t\tconst instaService = accessor.get(IInstantiationService);\n\n\t\tconst snippet = await new Promise<Snippet | undefined>((resolve, reject) => {\n\n\t\t\tconst { lineNumber, column } = editor.getPosition();\n\t\t\tconst { snippet, name, langId } = Args.fromUser(arg);\n\n\t\t\tif (snippet) {\n\t\t\t\treturn resolve(new Snippet(\n\t\t\t\t\tfalse,\n\t\t\t\t\t[],\n\t\t\t\t\t'',\n\t\t\t\t\t'',\n\t\t\t\t\t'',\n\t\t\t\t\tsnippet,\n\t\t\t\t\t'',\n\t\t\t\t\tSnippetSource.User,\n\t\t\t\t\t`random/${Math.random()}`\n\t\t\t\t));\n\t\t\t}\n\n\t\t\tlet languageId: string;\n\t\t\tif (langId) {\n\t\t\t\tif (!languageService.isRegisteredLanguageId(langId)) {\n\t\t\t\t\treturn resolve(undefined);\n\t\t\t\t}\n\t\t\t\tlanguageId = langId;\n\t\t\t} else {\n\t\t\t\teditor.getModel().tokenization.tokenizeIfCheap(lineNumber);\n\t\t\t\tlanguageId = editor.getModel().getLanguageIdAtPosition(lineNumber, column);\n\n\t\t\t\t// validate the `languageId` to ensure this is a user\n\t\t\t\t// facing language with a name and the chance to have\n\t\t\t\t// snippets, else fall back to the outer language\n\t\t\t\tif (!languageService.getLanguageName(languageId)) {\n\t\t\t\t\tlanguageId = editor.getModel().getLanguageId();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (name) {\n\t\t\t\t// take selected snippet\n\t\t\t\tsnippetService.getSnippets(languageId, { includeNoPrefixSnippets: true })\n\t\t\t\t\t.then(snippets => snippets.find(snippet => snippet.name === name))\n\t\t\t\t\t.then(resolve, reject);\n\n\t\t\t} else {\n\t\t\t\t// let user pick a snippet\n\t\t\t\tresolve(instaService.invokeFunction(pickSnippet, languageId));\n\t\t\t}\n\t\t});\n\n\t\tif (!snippet) {\n\t\t\treturn;\n\t\t}\n\t\tlet clipboardText: string | undefined;\n\t\tif (snippet.needsClipboard) {\n\t\t\tclipboardText = await clipboardService.readText();\n\t\t}\n\t\teditor.focus();\n\t\tSnippetController2.get(editor)?.insert(snippet.codeSnippet, { clipboardText });\n\t\tsnippetService.updateUsageTimestamp(snippet);\n\t}\n}\n"]}