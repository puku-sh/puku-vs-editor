{"version":3,"sources":["vs/workbench/contrib/snippets/browser/snippetsService.ts"],"names":[],"mappings":"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","file":"snippetsService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IJSONSchema } from '../../../../base/common/jsonSchema.js';\nimport { combinedDisposable, IDisposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { isFalsyOrWhitespace } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { setSnippetSuggestSupport } from '../../../../editor/contrib/suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { FileChangeType, IFileService } from '../../../../platform/files/common/files.js';\nimport { ILifecycleService, LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IWorkspace, IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { ISnippetGetOptions, ISnippetsService } from './snippets.js';\nimport { Snippet, SnippetFile, SnippetSource } from './snippetsFile.js';\nimport { ExtensionsRegistry, IExtensionPointUser } from '../../../services/extensions/common/extensionsRegistry.js';\nimport { languagesExtPoint } from '../../../services/language/common/languageService.js';\nimport { SnippetCompletionProvider } from './snippetCompletionProvider.js';\nimport { IExtensionResourceLoaderService } from '../../../../platform/extensionResourceLoader/common/extensionResourceLoader.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { isStringArray } from '../../../../base/common/types.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITextFileService } from '../../../services/textfile/common/textfiles.js';\nimport { ILanguageConfigurationService } from '../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { IUserDataProfileService } from '../../../services/userDataProfile/common/userDataProfile.js';\nimport { insertInto } from '../../../../base/common/arrays.js';\n\nnamespace snippetExt {\n\n\texport interface ISnippetsExtensionPoint {\n\t\tlanguage: string;\n\t\tpath: string;\n\t}\n\n\texport interface IValidSnippetsExtensionPoint {\n\t\tlanguage: string;\n\t\tlocation: URI;\n\t}\n\n\texport function toValidSnippet(extension: IExtensionPointUser<ISnippetsExtensionPoint[]>, snippet: ISnippetsExtensionPoint, languageService: ILanguageService): IValidSnippetsExtensionPoint | null {\n\n\t\tif (isFalsyOrWhitespace(snippet.path)) {\n\t\t\textension.collector.error(localize(\n\t\t\t\t'invalid.path.0',\n\t\t\t\t\"Expected string in `contributes.{0}.path`. Provided value: {1}\",\n\t\t\t\textension.description.name, String(snippet.path)\n\t\t\t));\n\t\t\treturn null;\n\t\t}\n\n\t\tif (isFalsyOrWhitespace(snippet.language) && !snippet.path.endsWith('.code-snippets')) {\n\t\t\textension.collector.error(localize(\n\t\t\t\t'invalid.language.0',\n\t\t\t\t\"When omitting the language, the value of `contributes.{0}.path` must be a `.code-snippets`-file. Provided value: {1}\",\n\t\t\t\textension.description.name, String(snippet.path)\n\t\t\t));\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!isFalsyOrWhitespace(snippet.language) && !languageService.isRegisteredLanguageId(snippet.language)) {\n\t\t\textension.collector.error(localize(\n\t\t\t\t'invalid.language',\n\t\t\t\t\"Unknown language in `contributes.{0}.language`. Provided value: {1}\",\n\t\t\t\textension.description.name, String(snippet.language)\n\t\t\t));\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extensionLocation = extension.description.extensionLocation;\n\t\tconst snippetLocation = resources.joinPath(extensionLocation, snippet.path);\n\t\tif (!resources.isEqualOrParent(snippetLocation, extensionLocation)) {\n\t\t\textension.collector.error(localize(\n\t\t\t\t'invalid.path.1',\n\t\t\t\t\"Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.\",\n\t\t\t\textension.description.name, snippetLocation.path, extensionLocation.path\n\t\t\t));\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tlanguage: snippet.language,\n\t\t\tlocation: snippetLocation\n\t\t};\n\t}\n\n\texport const snippetsContribution: IJSONSchema = {\n\t\tdescription: localize('vscode.extension.contributes.snippets', 'Contributes snippets.'),\n\t\ttype: 'array',\n\t\tdefaultSnippets: [{ body: [{ language: '', path: '' }] }],\n\t\titems: {\n\t\t\ttype: 'object',\n\t\t\tdefaultSnippets: [{ body: { language: '${1:id}', path: './snippets/${2:id}.json.' } }],\n\t\t\tproperties: {\n\t\t\t\tlanguage: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.snippets-language', 'Language identifier for which this snippet is contributed to.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\tpath: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.snippets-path', 'Path of the snippets file. The path is relative to the extension folder and typically starts with \\'./snippets/\\'.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\texport const point = ExtensionsRegistry.registerExtensionPoint<snippetExt.ISnippetsExtensionPoint[]>({\n\t\textensionPoint: 'snippets',\n\t\tdeps: [languagesExtPoint],\n\t\tjsonSchema: snippetExt.snippetsContribution\n\t});\n}\n\nfunction watch(service: IFileService, resource: URI, callback: () => unknown): IDisposable {\n\treturn combinedDisposable(\n\t\tservice.watch(resource),\n\t\tservice.onDidFilesChange(e => {\n\t\t\tif (e.affects(resource)) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t})\n\t);\n}\n\nclass SnippetEnablement {\n\n\tprivate static _key = 'snippets.ignoredSnippets';\n\n\tprivate readonly _ignored: Set<string>;\n\n\tconstructor(\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t) {\n\n\t\tconst raw = _storageService.get(SnippetEnablement._key, StorageScope.PROFILE, '');\n\t\tlet data: string[] | undefined;\n\t\ttry {\n\t\t\tdata = JSON.parse(raw);\n\t\t} catch { }\n\n\t\tthis._ignored = isStringArray(data) ? new Set(data) : new Set();\n\t}\n\n\tisIgnored(id: string): boolean {\n\t\treturn this._ignored.has(id);\n\t}\n\n\tupdateIgnored(id: string, value: boolean): void {\n\t\tlet changed = false;\n\t\tif (this._ignored.has(id) && !value) {\n\t\t\tthis._ignored.delete(id);\n\t\t\tchanged = true;\n\t\t} else if (!this._ignored.has(id) && value) {\n\t\t\tthis._ignored.add(id);\n\t\t\tchanged = true;\n\t\t}\n\t\tif (changed) {\n\t\t\tthis._storageService.store(SnippetEnablement._key, JSON.stringify(Array.from(this._ignored)), StorageScope.PROFILE, StorageTarget.USER);\n\t\t}\n\t}\n}\n\nclass SnippetUsageTimestamps {\n\n\tprivate static _key = 'snippets.usageTimestamps';\n\n\tprivate readonly _usages: Map<string, number>;\n\n\tconstructor(\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t) {\n\n\t\tconst raw = _storageService.get(SnippetUsageTimestamps._key, StorageScope.PROFILE, '');\n\t\tlet data: [string, number][] | undefined;\n\t\ttry {\n\t\t\tdata = JSON.parse(raw);\n\t\t} catch {\n\t\t\tdata = [];\n\t\t}\n\n\t\tthis._usages = Array.isArray(data) ? new Map(data) : new Map();\n\t}\n\n\tgetUsageTimestamp(id: string): number | undefined {\n\t\treturn this._usages.get(id);\n\t}\n\n\tupdateUsageTimestamp(id: string): void {\n\t\t// map uses insertion order, we want most recent at the end\n\t\tthis._usages.delete(id);\n\t\tthis._usages.set(id, Date.now());\n\n\t\t// persist last 100 item\n\t\tconst all = [...this._usages].slice(-100);\n\t\tthis._storageService.store(SnippetUsageTimestamps._key, JSON.stringify(all), StorageScope.PROFILE, StorageTarget.USER);\n\t}\n}\n\nexport class SnippetsService implements ISnippetsService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _pendingWork: Promise<any>[] = [];\n\tprivate readonly _files = new ResourceMap<SnippetFile>();\n\tprivate readonly _enablement: SnippetEnablement;\n\tprivate readonly _usageTimestamps: SnippetUsageTimestamps;\n\n\tconstructor(\n\t\t@IEnvironmentService private readonly _environmentService: IEnvironmentService,\n\t\t@IUserDataProfileService private readonly _userDataProfileService: IUserDataProfileService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@ITextFileService private readonly _textfileService: ITextFileService,\n\t\t@IExtensionResourceLoaderService private readonly _extensionResourceLoaderService: IExtensionResourceLoaderService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageConfigurationService languageConfigurationService: ILanguageConfigurationService,\n\t) {\n\t\tthis._pendingWork.push(Promise.resolve(lifecycleService.when(LifecyclePhase.Restored).then(() => {\n\t\t\tthis._initExtensionSnippets();\n\t\t\tthis._initUserSnippets();\n\t\t\tthis._initWorkspaceSnippets();\n\t\t})));\n\n\t\tsetSnippetSuggestSupport(new SnippetCompletionProvider(this._languageService, this, languageConfigurationService));\n\n\t\tthis._enablement = instantiationService.createInstance(SnippetEnablement);\n\t\tthis._usageTimestamps = instantiationService.createInstance(SnippetUsageTimestamps);\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n\n\tisEnabled(snippet: Snippet): boolean {\n\t\treturn !this._enablement.isIgnored(snippet.snippetIdentifier);\n\t}\n\n\tupdateEnablement(snippet: Snippet, enabled: boolean): void {\n\t\tthis._enablement.updateIgnored(snippet.snippetIdentifier, !enabled);\n\t}\n\n\tupdateUsageTimestamp(snippet: Snippet): void {\n\t\tthis._usageTimestamps.updateUsageTimestamp(snippet.snippetIdentifier);\n\t}\n\n\tprivate _joinSnippets(): Promise<any> {\n\t\tconst promises = this._pendingWork.slice(0);\n\t\tthis._pendingWork.length = 0;\n\t\treturn Promise.all(promises);\n\t}\n\n\tasync getSnippetFiles(): Promise<Iterable<SnippetFile>> {\n\t\tawait this._joinSnippets();\n\t\treturn this._files.values();\n\t}\n\n\tasync getSnippets(languageId: string | undefined, opts?: ISnippetGetOptions): Promise<Snippet[]> {\n\t\tawait this._joinSnippets();\n\n\t\tconst result: Snippet[] = [];\n\t\tconst promises: Promise<any>[] = [];\n\n\t\tif (languageId) {\n\t\t\tif (this._languageService.isRegisteredLanguageId(languageId)) {\n\t\t\t\tfor (const file of this._files.values()) {\n\t\t\t\t\tpromises.push(file.load()\n\t\t\t\t\t\t.then(file => file.select(languageId, result))\n\t\t\t\t\t\t.catch(err => this._logService.error(err, file.location.toString()))\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const file of this._files.values()) {\n\t\t\t\tpromises.push(file.load()\n\t\t\t\t\t.then(file => insertInto(result, result.length, file.data))\n\t\t\t\t\t.catch(err => this._logService.error(err, file.location.toString()))\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tawait Promise.all(promises);\n\t\treturn this._filterAndSortSnippets(result, opts);\n\t}\n\n\tgetSnippetsSync(languageId: string, opts?: ISnippetGetOptions): Snippet[] {\n\t\tconst result: Snippet[] = [];\n\t\tif (this._languageService.isRegisteredLanguageId(languageId)) {\n\t\t\tfor (const file of this._files.values()) {\n\t\t\t\t// kick off loading (which is a noop in case it's already loaded)\n\t\t\t\t// and optimistically collect snippets\n\t\t\t\tfile.load().catch(_err => { /*ignore*/ });\n\t\t\t\tfile.select(languageId, result);\n\t\t\t}\n\t\t}\n\t\treturn this._filterAndSortSnippets(result, opts);\n\t}\n\n\tprivate _filterAndSortSnippets(snippets: Snippet[], opts?: ISnippetGetOptions): Snippet[] {\n\n\t\tconst result: Snippet[] = [];\n\n\t\tfor (const snippet of snippets) {\n\t\t\tif (!snippet.prefix && !opts?.includeNoPrefixSnippets) {\n\t\t\t\t// prefix or no-prefix wanted\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!this.isEnabled(snippet) && !opts?.includeDisabledSnippets) {\n\t\t\t\t// enabled or disabled wanted\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (typeof opts?.fileTemplateSnippets === 'boolean' && opts.fileTemplateSnippets !== snippet.isFileTemplate) {\n\t\t\t\t// isTopLevel requested but mismatching\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult.push(snippet);\n\t\t}\n\n\n\t\treturn result.sort((a, b) => {\n\t\t\tlet result = 0;\n\t\t\tif (!opts?.noRecencySort) {\n\t\t\t\tconst val1 = this._usageTimestamps.getUsageTimestamp(a.snippetIdentifier) ?? -1;\n\t\t\t\tconst val2 = this._usageTimestamps.getUsageTimestamp(b.snippetIdentifier) ?? -1;\n\t\t\t\tresult = val2 - val1;\n\t\t\t}\n\t\t\tif (result === 0) {\n\t\t\t\tresult = this._compareSnippet(a, b);\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tprivate _compareSnippet(a: Snippet, b: Snippet): number {\n\t\tif (a.snippetSource < b.snippetSource) {\n\t\t\treturn -1;\n\t\t} else if (a.snippetSource > b.snippetSource) {\n\t\t\treturn 1;\n\t\t} else if (a.source < b.source) {\n\t\t\treturn -1;\n\t\t} else if (a.source > b.source) {\n\t\t\treturn 1;\n\t\t} else if (a.name > b.name) {\n\t\t\treturn 1;\n\t\t} else if (a.name < b.name) {\n\t\t\treturn -1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t// --- loading, watching\n\n\tprivate _initExtensionSnippets(): void {\n\t\tsnippetExt.point.setHandler(extensions => {\n\n\t\t\tfor (const [key, value] of this._files) {\n\t\t\t\tif (value.source === SnippetSource.Extension) {\n\t\t\t\t\tthis._files.delete(key);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const extension of extensions) {\n\t\t\t\tfor (const contribution of extension.value) {\n\t\t\t\t\tconst validContribution = snippetExt.toValidSnippet(extension, contribution, this._languageService);\n\t\t\t\t\tif (!validContribution) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst file = this._files.get(validContribution.location);\n\t\t\t\t\tif (file) {\n\t\t\t\t\t\tif (file.defaultScopes) {\n\t\t\t\t\t\t\tfile.defaultScopes.push(validContribution.language);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfile.defaultScopes = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst file = new SnippetFile(SnippetSource.Extension, validContribution.location, validContribution.language ? [validContribution.language] : undefined, extension.description, this._fileService, this._extensionResourceLoaderService);\n\t\t\t\t\t\tthis._files.set(file.location, file);\n\n\t\t\t\t\t\tif (this._environmentService.isExtensionDevelopment) {\n\t\t\t\t\t\t\tfile.load().then(file => {\n\t\t\t\t\t\t\t\t// warn about bad tabstop/variable usage\n\t\t\t\t\t\t\t\tif (file.data.some(snippet => snippet.isBogous)) {\n\t\t\t\t\t\t\t\t\textension.collector.warn(localize(\n\t\t\t\t\t\t\t\t\t\t'badVariableUse',\n\t\t\t\t\t\t\t\t\t\t\"One or more snippets from the extension '{0}' very likely confuse snippet-variables and snippet-placeholders (see https://code.visualstudio.com/docs/editor/userdefinedsnippets#_snippet-syntax for more details)\",\n\t\t\t\t\t\t\t\t\t\textension.description.name\n\t\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, err => {\n\t\t\t\t\t\t\t\t// generic error\n\t\t\t\t\t\t\t\textension.collector.warn(localize(\n\t\t\t\t\t\t\t\t\t'badFile',\n\t\t\t\t\t\t\t\t\t\"The snippet file \\\"{0}\\\" could not be read.\",\n\t\t\t\t\t\t\t\t\tfile.location.toString()\n\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _initWorkspaceSnippets(): void {\n\t\t// workspace stuff\n\t\tconst disposables = new DisposableStore();\n\t\tconst updateWorkspaceSnippets = () => {\n\t\t\tdisposables.clear();\n\t\t\tthis._pendingWork.push(this._initWorkspaceFolderSnippets(this._contextService.getWorkspace(), disposables));\n\t\t};\n\t\tthis._disposables.add(disposables);\n\t\tthis._disposables.add(this._contextService.onDidChangeWorkspaceFolders(updateWorkspaceSnippets));\n\t\tthis._disposables.add(this._contextService.onDidChangeWorkbenchState(updateWorkspaceSnippets));\n\t\tupdateWorkspaceSnippets();\n\t}\n\n\tprivate async _initWorkspaceFolderSnippets(workspace: IWorkspace, bucket: DisposableStore): Promise<any> {\n\t\tconst promises = workspace.folders.map(async folder => {\n\t\t\tconst snippetFolder = folder.toResource('.vscode');\n\t\t\tconst value = await this._fileService.exists(snippetFolder);\n\t\t\tif (value) {\n\t\t\t\tthis._initFolderSnippets(SnippetSource.Workspace, snippetFolder, bucket);\n\t\t\t} else {\n\t\t\t\t// watch\n\t\t\t\tbucket.add(this._fileService.onDidFilesChange(e => {\n\t\t\t\t\tif (e.contains(snippetFolder, FileChangeType.ADDED)) {\n\t\t\t\t\t\tthis._initFolderSnippets(SnippetSource.Workspace, snippetFolder, bucket);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\t\tawait Promise.all(promises);\n\t}\n\n\tprivate async _initUserSnippets(): Promise<any> {\n\t\tconst disposables = new DisposableStore();\n\t\tconst updateUserSnippets = async () => {\n\t\t\tdisposables.clear();\n\t\t\tconst userSnippetsFolder = this._userDataProfileService.currentProfile.snippetsHome;\n\t\t\tawait this._fileService.createFolder(userSnippetsFolder);\n\t\t\tawait this._initFolderSnippets(SnippetSource.User, userSnippetsFolder, disposables);\n\t\t};\n\t\tthis._disposables.add(disposables);\n\t\tthis._disposables.add(this._userDataProfileService.onDidChangeCurrentProfile(e => e.join((async () => {\n\t\t\tthis._pendingWork.push(updateUserSnippets());\n\t\t})())));\n\t\tawait updateUserSnippets();\n\t}\n\n\tprivate _initFolderSnippets(source: SnippetSource, folder: URI, bucket: DisposableStore): Promise<any> {\n\t\tconst disposables = new DisposableStore();\n\t\tconst addFolderSnippets = async () => {\n\t\t\tdisposables.clear();\n\t\t\tif (!await this._fileService.exists(folder)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst stat = await this._fileService.resolve(folder);\n\t\t\t\tfor (const entry of stat.children || []) {\n\t\t\t\t\tdisposables.add(this._addSnippetFile(entry.resource, source));\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tthis._logService.error(`Failed snippets from folder '${folder.toString()}'`, err);\n\t\t\t}\n\t\t};\n\n\t\tbucket.add(this._textfileService.files.onDidSave(e => {\n\t\t\tif (resources.isEqualOrParent(e.model.resource, folder)) {\n\t\t\t\taddFolderSnippets();\n\t\t\t}\n\t\t}));\n\t\tbucket.add(watch(this._fileService, folder, addFolderSnippets));\n\t\tbucket.add(disposables);\n\t\treturn addFolderSnippets();\n\t}\n\n\tprivate _addSnippetFile(uri: URI, source: SnippetSource): IDisposable {\n\t\tconst ext = resources.extname(uri);\n\t\tif (source === SnippetSource.User && ext === '.json') {\n\t\t\tconst langName = resources.basename(uri).replace(/\\.json/, '');\n\t\t\tthis._files.set(uri, new SnippetFile(source, uri, [langName], undefined, this._fileService, this._extensionResourceLoaderService));\n\t\t} else if (ext === '.code-snippets') {\n\t\t\tthis._files.set(uri, new SnippetFile(source, uri, undefined, undefined, this._fileService, this._extensionResourceLoaderService));\n\t\t}\n\t\treturn {\n\t\t\tdispose: () => this._files.delete(uri)\n\t\t};\n\t}\n}\n\n\nexport interface ISimpleModel {\n\tgetLineContent(lineNumber: number): string;\n}\n\nexport function getNonWhitespacePrefix(model: ISimpleModel, position: Position): string {\n\t/**\n\t * Do not analyze more characters\n\t */\n\tconst MAX_PREFIX_LENGTH = 100;\n\n\tconst line = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n\n\tconst minChIndex = Math.max(0, line.length - MAX_PREFIX_LENGTH);\n\tfor (let chIndex = line.length - 1; chIndex >= minChIndex; chIndex--) {\n\t\tconst ch = line.charAt(chIndex);\n\n\t\tif (/\\s/.test(ch)) {\n\t\t\treturn line.substr(chIndex + 1);\n\t\t}\n\t}\n\n\tif (minChIndex === 0) {\n\t\treturn line;\n\t}\n\n\treturn '';\n}\n"]}