{"version":3,"sources":["vs/workbench/contrib/snippets/browser/snippetCodeActionProvider.ts"],"names":[],"mappings":"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","file":"snippetCodeActionProvider.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IRange, Range } from '../../../../editor/common/core/range.js';\nimport { Selection } from '../../../../editor/common/core/selection.js';\nimport { CodeAction, CodeActionList, CodeActionProvider, WorkspaceEdit } from '../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { CodeActionKind } from '../../../../editor/contrib/codeAction/common/types.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ApplyFileSnippetAction } from './commands/fileTemplateSnippets.js';\nimport { getSurroundableSnippets, SurroundWithSnippetEditorAction } from './commands/surroundWithSnippet.js';\nimport { Snippet } from './snippetsFile.js';\nimport { ISnippetsService } from './snippets.js';\n\nclass SurroundWithSnippetCodeActionProvider implements CodeActionProvider {\n\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\ttitle: localize('more', \"More...\"),\n\t\tcommand: {\n\t\t\tid: SurroundWithSnippetEditorAction.options.id,\n\t\t\ttitle: SurroundWithSnippetEditorAction.options.title.value,\n\t\t},\n\t};\n\n\tconstructor(@ISnippetsService private readonly _snippetService: ISnippetsService) { }\n\n\tasync provideCodeActions(model: ITextModel, range: Range | Selection): Promise<CodeActionList | undefined> {\n\n\t\tif (range.isEmpty()) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst position = Selection.isISelection(range) ? range.getPosition() : range.getStartPosition();\n\t\tconst snippets = await getSurroundableSnippets(this._snippetService, model, position, false);\n\t\tif (!snippets.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (actions.length >= SurroundWithSnippetCodeActionProvider._MAX_CODE_ACTIONS) {\n\t\t\t\tactions.push(SurroundWithSnippetCodeActionProvider._overflowCommandCodeAction);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize('codeAction', \"{0}\", snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(model, range, snippet)\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() { }\n\t\t};\n\t}\n}\n\nclass FileTemplateCodeActionProvider implements CodeActionProvider {\n\n\tprivate static readonly _MAX_CODE_ACTIONS = 4;\n\n\tprivate static readonly _overflowCommandCodeAction: CodeAction = {\n\t\ttitle: localize('overflow.start.title', 'Start with Snippet'),\n\t\tkind: CodeActionKind.SurroundWith.value,\n\t\tcommand: {\n\t\t\tid: ApplyFileSnippetAction.Id,\n\t\t\ttitle: ''\n\t\t}\n\t};\n\n\treadonly providedCodeActionKinds?: readonly string[] = [CodeActionKind.SurroundWith.value];\n\n\tconstructor(@ISnippetsService private readonly _snippetService: ISnippetsService) { }\n\n\tasync provideCodeActions(model: ITextModel) {\n\t\tif (model.getValueLength() !== 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst snippets = await this._snippetService.getSnippets(model.getLanguageId(), { fileTemplateSnippets: true, includeNoPrefixSnippets: true });\n\t\tconst actions: CodeAction[] = [];\n\t\tfor (const snippet of snippets) {\n\t\t\tif (actions.length >= FileTemplateCodeActionProvider._MAX_CODE_ACTIONS) {\n\t\t\t\tactions.push(FileTemplateCodeActionProvider._overflowCommandCodeAction);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\ttitle: localize('title', 'Start with: {0}', snippet.name),\n\t\t\t\tkind: CodeActionKind.SurroundWith.value,\n\t\t\t\tedit: asWorkspaceEdit(model, model.getFullModelRange(), snippet)\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tactions,\n\t\t\tdispose() { }\n\t\t};\n\t}\n}\n\nfunction asWorkspaceEdit(model: ITextModel, range: IRange, snippet: Snippet): WorkspaceEdit {\n\treturn {\n\t\tedits: [{\n\t\t\tversionId: model.getVersionId(),\n\t\t\tresource: model.uri,\n\t\t\ttextEdit: {\n\t\t\t\trange,\n\t\t\t\ttext: snippet.body,\n\t\t\t\tinsertAsSnippet: true,\n\t\t\t}\n\t\t}]\n\t};\n}\n\nexport class SnippetCodeActions implements IWorkbenchContribution {\n\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@IConfigurationService configService: IConfigurationService,\n\t) {\n\n\t\tconst setting = 'editor.snippets.codeActions.enabled';\n\t\tconst sessionStore = new DisposableStore();\n\t\tconst update = () => {\n\t\t\tsessionStore.clear();\n\t\t\tif (configService.getValue(setting)) {\n\t\t\t\tsessionStore.add(languageFeaturesService.codeActionProvider.register('*', instantiationService.createInstance(SurroundWithSnippetCodeActionProvider)));\n\t\t\t\tsessionStore.add(languageFeaturesService.codeActionProvider.register('*', instantiationService.createInstance(FileTemplateCodeActionProvider)));\n\t\t\t}\n\t\t};\n\n\t\tupdate();\n\t\tthis._store.add(configService.onDidChangeConfiguration(e => e.affectsConfiguration(setting) && update()));\n\t\tthis._store.add(sessionStore);\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n"]}