{"version":3,"sources":["vs/workbench/contrib/files/browser/editors/textFileSaveErrorHandler.ts"],"names":[],"mappings":"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","file":"textFileSaveErrorHandler.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../../nls.js';\nimport { toErrorMessage } from '../../../../../base/common/errorMessage.js';\nimport { basename, isEqual } from '../../../../../base/common/resources.js';\nimport { Action } from '../../../../../base/common/actions.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { FileOperationError, FileOperationResult, IWriteFileOptions } from '../../../../../platform/files/common/files.js';\nimport { ITextFileService, ISaveErrorHandler, ITextFileEditorModel, ITextFileSaveAsOptions, ITextFileSaveOptions } from '../../../../services/textfile/common/textfiles.js';\nimport { ServicesAccessor, IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IDisposable, dispose, Disposable } from '../../../../../base/common/lifecycle.js';\nimport { IWorkbenchContribution } from '../../../../common/contributions.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { DiffEditorInput } from '../../../../common/editor/diffEditorInput.js';\nimport { IContextKey, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { TextFileContentProvider } from '../../common/files.js';\nimport { FileEditorInput } from './fileEditorInput.js';\nimport { SAVE_FILE_AS_LABEL } from '../fileConstants.js';\nimport { INotificationService, INotificationHandle, INotificationActions, Severity } from '../../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { IPreferencesService } from '../../../../services/preferences/common/preferences.js';\nimport { IEditorIdentifier, SaveReason, SideBySideEditor } from '../../../../common/editor.js';\nimport { hash } from '../../../../../base/common/hash.js';\n\nexport const CONFLICT_RESOLUTION_CONTEXT = 'saveConflictResolutionContext';\nexport const CONFLICT_RESOLUTION_SCHEME = 'conflictResolution';\n\nconst LEARN_MORE_DIRTY_WRITE_IGNORE_KEY = 'learnMoreDirtyWriteError';\n\nconst conflictEditorHelp = localize('userGuide', \"Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes.\");\n\n// A handler for text file save error happening with conflict resolution actions\nexport class TextFileSaveErrorHandler extends Disposable implements ISaveErrorHandler, IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.textFileSaveErrorHandler';\n\n\tprivate readonly messages = new ResourceMap<INotificationHandle>();\n\tprivate readonly conflictResolutionContext: IContextKey<boolean>;\n\tprivate activeConflictResolutionResource: URI | undefined = undefined;\n\n\tconstructor(\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tsuper();\n\n\t\tthis.conflictResolutionContext = new RawContextKey<boolean>(CONFLICT_RESOLUTION_CONTEXT, false, true).bindTo(contextKeyService);\n\n\t\tconst provider = this._register(instantiationService.createInstance(TextFileContentProvider));\n\t\tthis._register(textModelService.registerTextModelContentProvider(CONFLICT_RESOLUTION_SCHEME, provider));\n\n\t\t// Set as save error handler to service for text files\n\t\tthis.textFileService.files.saveErrorHandler = this;\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(this.textFileService.files.onDidSave(e => this.onFileSavedOrReverted(e.model.resource)));\n\t\tthis._register(this.textFileService.files.onDidRevert(model => this.onFileSavedOrReverted(model.resource)));\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => this.onActiveEditorChanged()));\n\t}\n\n\tprivate onActiveEditorChanged(): void {\n\t\tlet isActiveEditorSaveConflictResolution = false;\n\t\tlet activeConflictResolutionResource: URI | undefined;\n\n\t\tconst activeInput = this.editorService.activeEditor;\n\t\tif (activeInput instanceof DiffEditorInput) {\n\t\t\tconst resource = activeInput.original.resource;\n\t\t\tif (resource?.scheme === CONFLICT_RESOLUTION_SCHEME) {\n\t\t\t\tisActiveEditorSaveConflictResolution = true;\n\t\t\t\tactiveConflictResolutionResource = activeInput.modified.resource;\n\t\t\t}\n\t\t}\n\n\t\tthis.conflictResolutionContext.set(isActiveEditorSaveConflictResolution);\n\t\tthis.activeConflictResolutionResource = activeConflictResolutionResource;\n\t}\n\n\tprivate onFileSavedOrReverted(resource: URI): void {\n\t\tconst messageHandle = this.messages.get(resource);\n\t\tif (messageHandle) {\n\t\t\tmessageHandle.close();\n\t\t\tthis.messages.delete(resource);\n\t\t}\n\t}\n\n\tonSaveError(error: unknown, model: ITextFileEditorModel, options: ITextFileSaveOptions): void {\n\t\tconst fileOperationError = error as FileOperationError;\n\t\tconst resource = model.resource;\n\n\t\tlet message: string;\n\t\tconst primaryActions: Action[] = [];\n\t\tconst secondaryActions: Action[] = [];\n\n\t\t// Dirty write prevention\n\t\tif (fileOperationError.fileOperationResult === FileOperationResult.FILE_MODIFIED_SINCE) {\n\n\t\t\t// If the user tried to save from the opened conflict editor, show its message again\n\t\t\tif (this.activeConflictResolutionResource && isEqual(this.activeConflictResolutionResource, model.resource)) {\n\t\t\t\tif (this.storageService.getBoolean(LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, StorageScope.APPLICATION)) {\n\t\t\t\t\treturn; // return if this message is ignored\n\t\t\t\t}\n\n\t\t\t\tmessage = conflictEditorHelp;\n\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(ResolveConflictLearnMoreAction));\n\t\t\t\tsecondaryActions.push(this.instantiationService.createInstance(DoNotShowResolveConflictLearnMoreAction));\n\t\t\t}\n\n\t\t\t// Otherwise show the message that will lead the user into the save conflict editor.\n\t\t\telse {\n\t\t\t\tmessage = localize('staleSaveError', \"Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.\", basename(resource));\n\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(ResolveSaveConflictAction, model));\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelIgnoreModifiedSinceAction, model, options));\n\n\t\t\t\tsecondaryActions.push(this.instantiationService.createInstance(ConfigureSaveConflictAction));\n\t\t\t}\n\t\t}\n\n\t\t// Any other save error\n\t\telse {\n\t\t\tconst isWriteLocked = fileOperationError.fileOperationResult === FileOperationResult.FILE_WRITE_LOCKED;\n\t\t\tconst triedToUnlock = isWriteLocked && (fileOperationError.options as IWriteFileOptions | undefined)?.unlock;\n\t\t\tconst isPermissionDenied = fileOperationError.fileOperationResult === FileOperationResult.FILE_PERMISSION_DENIED;\n\t\t\tconst canSaveElevated = resource.scheme === Schemas.file; // currently only supported for local schemes (https://github.com/microsoft/vscode/issues/48659)\n\n\t\t\t// Save Elevated\n\t\t\tif (canSaveElevated && (isPermissionDenied || triedToUnlock)) {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelElevatedAction, model, options, !!triedToUnlock));\n\t\t\t}\n\n\t\t\t// Unlock\n\t\t\telse if (isWriteLocked) {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(UnlockModelAction, model, options));\n\t\t\t}\n\n\t\t\t// Retry\n\t\t\telse {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(RetrySaveModelAction, model, options));\n\t\t\t}\n\n\t\t\t// Save As\n\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelAsAction, model));\n\n\t\t\t// Revert\n\t\t\tprimaryActions.push(this.instantiationService.createInstance(RevertModelAction, model));\n\n\t\t\t// Message\n\t\t\tif (isWriteLocked) {\n\t\t\t\tif (triedToUnlock && canSaveElevated) {\n\t\t\t\t\tmessage = isWindows ? localize('readonlySaveErrorAdmin', \"Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.\", basename(resource)) : localize('readonlySaveErrorSudo', \"Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.\", basename(resource));\n\t\t\t\t} else {\n\t\t\t\t\tmessage = localize('readonlySaveError', \"Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.\", basename(resource));\n\t\t\t\t}\n\t\t\t} else if (canSaveElevated && isPermissionDenied) {\n\t\t\t\tmessage = isWindows ? localize('permissionDeniedSaveError', \"Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.\", basename(resource)) : localize('permissionDeniedSaveErrorSudo', \"Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.\", basename(resource));\n\t\t\t} else {\n\t\t\t\tmessage = localize({ key: 'genericSaveError', comment: ['{0} is the resource that failed to save and {1} the error message'] }, \"Failed to save '{0}': {1}\", basename(resource), toErrorMessage(error, false));\n\t\t\t}\n\t\t}\n\n\t\t// Show message and keep function to hide in case the file gets saved/reverted\n\t\tconst actions: INotificationActions = { primary: primaryActions, secondary: secondaryActions };\n\t\tconst handle = this.notificationService.notify({\n\t\t\tid: `${hash(model.resource.toString())}`, // unique per model (https://github.com/microsoft/vscode/issues/121539)\n\t\t\tseverity: Severity.Error,\n\t\t\tmessage,\n\t\t\tactions\n\t\t});\n\t\tEvent.once(handle.onDidClose)(() => { dispose(primaryActions); dispose(secondaryActions); });\n\t\tthis.messages.set(model.resource, handle);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.messages.clear();\n\t}\n}\n\nconst pendingResolveSaveConflictMessages: INotificationHandle[] = [];\nfunction clearPendingResolveSaveConflictMessages(): void {\n\twhile (pendingResolveSaveConflictMessages.length > 0) {\n\t\tconst item = pendingResolveSaveConflictMessages.pop();\n\t\titem?.close();\n\t}\n}\n\nclass ResolveConflictLearnMoreAction extends Action {\n\n\tconstructor(\n\t\t@IOpenerService private readonly openerService: IOpenerService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflictLearnMore', localize('learnMore', \"Learn More\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tawait this.openerService.open(URI.parse('https://go.microsoft.com/fwlink/?linkid=868264'));\n\t}\n}\n\nclass DoNotShowResolveConflictLearnMoreAction extends Action {\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflictLearnMoreDoNotShowAgain', localize('dontShowAgain', \"Don't Show Again\"));\n\t}\n\n\toverride async run(notification: IDisposable): Promise<void> {\n\n\t\t// Remember this as application state\n\t\tthis.storageService.store(LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, true, StorageScope.APPLICATION, StorageTarget.USER);\n\n\t\t// Hide notification\n\t\tnotification.dispose();\n\t}\n}\n\nclass ResolveSaveConflictAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IProductService private readonly productService: IProductService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflict', localize('compareChanges', \"Compare\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tconst resource = this.model.resource;\n\t\t\tconst name = basename(resource);\n\t\t\tconst editorLabel = localize('saveConflictDiffLabel', \"{0} (in file) â†” {1} (in {2}) - Resolve save conflict\", name, name, this.productService.nameLong);\n\n\t\t\tawait TextFileContentProvider.open(resource, CONFLICT_RESOLUTION_SCHEME, editorLabel, this.editorService, { pinned: true });\n\n\t\t\t// Show additional help how to resolve the save conflict\n\t\t\tconst actions = { primary: [this.instantiationService.createInstance(ResolveConflictLearnMoreAction)] };\n\t\t\tconst handle = this.notificationService.notify({\n\t\t\t\tid: `${hash(resource.toString())}`, // unique per model\n\t\t\t\tseverity: Severity.Info,\n\t\t\t\tmessage: conflictEditorHelp,\n\t\t\t\tactions,\n\t\t\t\tneverShowAgain: { id: LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, isSecondary: true }\n\t\t\t});\n\t\t\tEvent.once(handle.onDidClose)(() => dispose(actions.primary));\n\t\t\tpendingResolveSaveConflictMessages.push(handle);\n\t\t}\n\t}\n}\n\nclass SaveModelElevatedAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\tprivate options: ITextFileSaveOptions,\n\t\tprivate triedToUnlock: boolean\n\t) {\n\t\tsuper('workbench.files.action.saveModelElevated', triedToUnlock ? isWindows ? localize('overwriteElevated', \"Overwrite as Admin...\") : localize('overwriteElevatedSudo', \"Overwrite as Sudo...\") : isWindows ? localize('saveElevated', \"Retry as Admin...\") : localize('saveElevatedSudo', \"Retry as Sudo...\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({\n\t\t\t\t...this.options,\n\t\t\t\twriteElevated: true,\n\t\t\t\twriteUnlock: this.triedToUnlock,\n\t\t\t\treason: SaveReason.EXPLICIT\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass RetrySaveModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\tprivate options: ITextFileSaveOptions\n\t) {\n\t\tsuper('workbench.files.action.saveModel', localize('retry', \"Retry\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ ...this.options, reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass RevertModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel\n\t) {\n\t\tsuper('workbench.files.action.revertModel', localize('revert', \"Revert\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.revert();\n\t\t}\n\t}\n}\n\nclass SaveModelAsAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\t@IEditorService private editorService: IEditorService\n\t) {\n\t\tsuper('workbench.files.action.saveModelAs', SAVE_FILE_AS_LABEL.value);\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tconst editor = this.findEditor();\n\t\t\tif (editor) {\n\t\t\t\tawait this.editorService.save(editor, { saveAs: true, reason: SaveReason.EXPLICIT });\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate findEditor(): IEditorIdentifier | undefined {\n\t\tlet preferredMatchingEditor: IEditorIdentifier | undefined;\n\n\t\tconst editors = this.editorService.findEditors(this.model.resource, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\tfor (const identifier of editors) {\n\t\t\tif (identifier.editor instanceof FileEditorInput) {\n\t\t\t\t// We prefer a `FileEditorInput` for \"Save As\", but it is possible\n\t\t\t\t// that a custom editor is leveraging the text file model and as\n\t\t\t\t// such we need to fallback to any other editor having the resource\n\t\t\t\t// opened for running the save.\n\t\t\t\tpreferredMatchingEditor = identifier;\n\t\t\t\tbreak;\n\t\t\t} else if (!preferredMatchingEditor) {\n\t\t\t\tpreferredMatchingEditor = identifier;\n\t\t\t}\n\t\t}\n\n\t\treturn preferredMatchingEditor;\n\t}\n}\n\nclass UnlockModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\tprivate options: ITextFileSaveOptions\n\t) {\n\t\tsuper('workbench.files.action.unlock', localize('overwrite', \"Overwrite\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ ...this.options, writeUnlock: true, reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass SaveModelIgnoreModifiedSinceAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\tprivate options: ITextFileSaveOptions\n\t) {\n\t\tsuper('workbench.files.action.saveIgnoreModifiedSince', localize('overwrite', \"Overwrite\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ ...this.options, ignoreModifiedSince: true, reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass ConfigureSaveConflictAction extends Action {\n\n\tconstructor(\n\t\t@IPreferencesService private readonly preferencesService: IPreferencesService\n\t) {\n\t\tsuper('workbench.files.action.configureSaveConflict', localize('configure', \"Configure\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tthis.preferencesService.openSettings({ query: 'files.saveConflictResolution' });\n\t}\n}\n\nexport const acceptLocalChangesCommand = (accessor: ServicesAccessor, resource: unknown) => {\n\treturn acceptOrRevertLocalChangesCommand(accessor, resource, true);\n};\n\nexport const revertLocalChangesCommand = (accessor: ServicesAccessor, resource: unknown) => {\n\treturn acceptOrRevertLocalChangesCommand(accessor, resource, false);\n};\n\nasync function acceptOrRevertLocalChangesCommand(accessor: ServicesAccessor, resource: unknown, accept: boolean) {\n\tconst editorService = accessor.get(IEditorService);\n\n\tif (!URI.isUri(resource)) {\n\t\treturn;\n\t}\n\n\tconst editorPane = editorService.activeEditorPane;\n\tif (!editorPane) {\n\t\treturn;\n\t}\n\n\tconst editor = editorPane.input;\n\tconst group = editorPane.group;\n\n\t// Hide any previously shown message about how to use these actions\n\tclearPendingResolveSaveConflictMessages();\n\n\t// Accept or revert\n\tif (accept) {\n\t\tconst options: ITextFileSaveAsOptions = { ignoreModifiedSince: true, reason: SaveReason.EXPLICIT };\n\t\tawait editorService.save({ editor, groupId: group.id }, options);\n\t} else {\n\t\tawait editorService.revert({ editor, groupId: group.id });\n\t}\n\n\t// Reopen original editor\n\tawait editorService.openEditor({ resource }, group);\n\n\t// Clean up\n\treturn group.closeEditor(editor);\n}\n"]}