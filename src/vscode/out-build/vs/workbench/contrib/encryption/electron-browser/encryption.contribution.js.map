{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/encryption/electron-browser/encryption.contribution.ts","vs/workbench/contrib/encryption/electron-browser/encryption.contribution.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,OAAO,EAAE,MAAM,qCAAqC,CAAC;AAC9D,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AACzD,OAAO,EAAE,mBAAmB,EAAE,MAAM,wDAAwD,CAAC;AAC7F,OAAO,EAAE,YAAY,EAAE,MAAM,4CAA4C,CAAC;AAC1E,OAAO,EAAE,QAAQ,EAAE,MAAM,kDAAkD,CAAC;AAC5E,OAAO,EAAE,eAAe,EAA+B,MAAM,gDAAgD,CAAC;AAC9G,OAAO,EAA2D,UAAU,IAAI,mBAAmB,EAAE,MAAM,kCAAkC,CAAC;AAC9I,OAAO,EAAE,mBAAmB,EAAE,MAAM,uDAAuD,CAAC;AAG5F,IAAM,sBAAsB,GAA5B,MAAM,sBAAsB;IAC3B,YACuC,kBAAuC,EACvC,kBAAuC,EAC9C,WAAyB,EACtB,cAA+B;QAH3B,uBAAkB,GAAlB,kBAAkB,CAAqB;QACvC,uBAAkB,GAAlB,kBAAkB,CAAqB;QAC9C,gBAAW,GAAX,WAAW,CAAc;QACtB,mBAAc,GAAd,cAAc,CAAiB;QAEjE,IAAI,CAAC,uBAAuB,EAAE,CAAC;IAChC,CAAC;IAED;;;;OAIG;IACK,KAAK,CAAC,uBAAuB;QACpC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,qCAAqC,qCAA4B,KAAK,CAAC,EAAE,CAAC;YACxH,OAAO;QACR,CAAC;QACD,IAAI,CAAC;YACJ,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;YACtF,MAAM,IAAI,GAAG,KAAK,CAAgC,OAAO,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC5E,IAAI,IAAI,CAAC,gBAAgB,CAAC,KAAK,OAAO,IAAI,IAAI,CAAC,gBAAgB,CAAC,KAAK,eAAe,EAAE,CAAC;gBACtF,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,gBAAgB,CAAC,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;YACrI,CAAC;YACD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,qCAAqC,EAAE,IAAI,gEAA+C,CAAC;QACtH,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YAChB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACtB,CAAC;IACF,CAAC;CACD,CAAA;AA9BK,sBAAsB;IAEzB,WAAA,mBAAmB,CAAA;IACnB,WAAA,mBAAmB,CAAA;IACnB,WAAA,YAAY,CAAA;IACZ,WAAA,eAAe,CAAA;GALZ,sBAAsB,CA8B3B;AAED,QAAQ,CAAC,EAAE,CAAkC,mBAAmB,CAAC,SAAS,CAAC,CAAC,6BAA6B,CAAC,sBAAsB,oCAA4B,CAAC","file":"encryption.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isLinux } from '../../../../base/common/platform.js';\nimport { parse } from '../../../../base/common/jsonc.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { IWorkbenchContribution, IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from '../../../common/contributions.js';\nimport { IJSONEditingService } from '../../../services/configuration/common/jsonEditing.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\n\nclass EncryptionContribution implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IJSONEditingService private readonly jsonEditingService: IJSONEditingService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tthis.migrateToGnomeLibsecret();\n\t}\n\n\t/**\n\t * Migrate the user from using the gnome or gnome-keyring password-store to gnome-libsecret.\n\t * TODO@TylerLeonhardt: This migration can be removed in 3 months or so and then storage\n\t * can be cleaned up.\n\t */\n\tprivate async migrateToGnomeLibsecret(): Promise<void> {\n\t\tif (!isLinux || this.storageService.getBoolean('encryption.migratedToGnomeLibsecret', StorageScope.APPLICATION, false)) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst content = await this.fileService.readFile(this.environmentService.argvResource);\n\t\t\tconst argv = parse<{ 'password-store'?: string }>(content.value.toString());\n\t\t\tif (argv['password-store'] === 'gnome' || argv['password-store'] === 'gnome-keyring') {\n\t\t\t\tthis.jsonEditingService.write(this.environmentService.argvResource, [{ path: ['password-store'], value: 'gnome-libsecret' }], true);\n\t\t\t}\n\t\t\tthis.storageService.store('encryption.migratedToGnomeLibsecret', true, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n}\n\nRegistry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).registerWorkbenchContribution(EncryptionContribution, LifecyclePhase.Eventually);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isLinux } from '../../../../base/common/platform.js';\nimport { parse } from '../../../../base/common/jsonc.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { IWorkbenchContribution, IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from '../../../common/contributions.js';\nimport { IJSONEditingService } from '../../../services/configuration/common/jsonEditing.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\n\nclass EncryptionContribution implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IJSONEditingService private readonly jsonEditingService: IJSONEditingService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tthis.migrateToGnomeLibsecret();\n\t}\n\n\t/**\n\t * Migrate the user from using the gnome or gnome-keyring password-store to gnome-libsecret.\n\t * TODO@TylerLeonhardt: This migration can be removed in 3 months or so and then storage\n\t * can be cleaned up.\n\t */\n\tprivate async migrateToGnomeLibsecret(): Promise<void> {\n\t\tif (!isLinux || this.storageService.getBoolean('encryption.migratedToGnomeLibsecret', StorageScope.APPLICATION, false)) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst content = await this.fileService.readFile(this.environmentService.argvResource);\n\t\t\tconst argv = parse<{ 'password-store'?: string }>(content.value.toString());\n\t\t\tif (argv['password-store'] === 'gnome' || argv['password-store'] === 'gnome-keyring') {\n\t\t\t\tthis.jsonEditingService.write(this.environmentService.argvResource, [{ path: ['password-store'], value: 'gnome-libsecret' }], true);\n\t\t\t}\n\t\t\tthis.storageService.store('encryption.migratedToGnomeLibsecret', true, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n}\n\nRegistry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).registerWorkbenchContribution(EncryptionContribution, LifecyclePhase.Eventually);\n"]}