{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/chatAgentTools/test/electron-browser/commandLinePwshChainOperatorRewriter.test.ts","vs/workbench/contrib/terminalContrib/chatAgentTools/test/electron-browser/commandLinePwshChainOperatorRewriter.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,WAAW,EAAE,MAAM,QAAQ,CAAC;AACrC,OAAO,EAAE,OAAO,EAAE,MAAM,0CAA0C,CAAC;AAEnE,OAAO,EAAE,uCAAuC,EAAE,MAAM,6CAA6C,CAAC;AACtG,OAAO,EAAE,yBAAyB,EAAE,MAAM,iFAAiF,CAAC;AAC5H,OAAO,EAAE,WAAW,EAAE,MAAM,wDAAwD,CAAC;AAErF,OAAO,EAAE,cAAc,EAAE,MAAM,8CAA8C,CAAC;AAC9E,OAAO,EAAE,wBAAwB,EAAE,MAAM,wEAAwE,CAAC;AAClH,OAAO,EAAE,6BAA6B,EAAE,MAAM,sDAAsD,CAAC;AACrG,OAAO,EAAE,yBAAyB,EAAE,MAAM,+DAA+D,CAAC;AAC1G,OAAO,EAAE,oCAAoC,EAAE,MAAM,iFAAiF,CAAC;AAEvI,OAAO,EAAE,uBAAuB,EAAE,MAAM,0CAA0C,CAAC;AAEnF,KAAK,CAAC,sCAAsC,EAAE,GAAG,EAAE;IAClD,MAAM,KAAK,GAAG,uCAAuC,EAAE,CAAC;IAExD,IAAI,oBAA8C,CAAC;IACnD,IAAI,MAA+B,CAAC;IACpC,IAAI,QAA8C,CAAC;IAEnD,SAAS,oBAAoB,CAAC,OAAe,EAAE,KAAa,EAAE,EAAmB;QAChF,OAAO;YACN,WAAW,EAAE,OAAO;YACpB,GAAG,EAAE,SAAS;YACd,KAAK;YACL,EAAE;SACF,CAAC;IACH,CAAC;IAED,KAAK,CAAC,GAAG,EAAE;QACV,MAAM,WAAW,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,WAAW,CAAC,IAAI,cAAc,EAAE,CAAC,CAAC,CAAC;QACrE,MAAM,kBAAkB,GAAG,IAAI,yBAAyB,EAAE,CAAC;QAC3D,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC,CAAC;QAE1E,oBAAoB,GAAG,6BAA6B,CAAC;YACpD,WAAW,EAAE,GAAG,EAAE,CAAC,WAAW;SAC9B,EAAE,KAAK,CAAC,CAAC;QAEV,MAAM,wBAAwB,GAAG,KAAK,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAC1G,wBAAwB,CAAC,MAAM,GAAG,IAAI,CAAC;QACvC,oBAAoB,CAAC,IAAI,CAAC,yBAAyB,EAAE,wBAAwB,CAAC,CAAC;QAE/E,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAC,CAAC;QACjF,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,oCAAoC,EAAE,MAAM,CAAC,CAAC,CAAC;IACzG,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,qBAAqB,EAAE,GAAG,EAAE;QACjC,KAAK,UAAU,CAAC,CAAC,mBAA2B,EAAE,cAAkC;YAC/E,MAAM,OAAO,GAAG,oBAAoB,CAAC,mBAAmB,EAAE,MAAM,kCAA0B,CAAC;YAC3F,MAAM,MAAM,GAAG,MAAM,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAC/C,WAAW,CAAC,MAAM,EAAE,SAAS,EAAE,cAAc,CAAC,CAAC;YAC/C,IAAI,cAAc,KAAK,SAAS,EAAE,CAAC;gBAClC,WAAW,CAAC,MAAM,EAAE,SAAS,EAAE,oBAAoB,CAAC,CAAC;YACtD,CAAC;QACF,CAAC;QAED,IAAI,CAAC,+CAA+C,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,0BAA0B,EAAE,yBAAyB,CAAC,CAAC,CAAC;QACtH,IAAI,CAAC,wDAAwD,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,yCAAyC,EAAE,uCAAuC,CAAC,CAAC,CAAC;QAC5J,IAAI,CAAC,kDAAkD,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,kDAAkD,EAAE,gDAAgD,CAAC,CAAC,CAAC;QACxK,IAAI,CAAC,sDAAsD,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,6BAA6B,EAAE,4BAA4B,CAAC,CAAC,CAAC;QACnI,IAAI,CAAC,qCAAqC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,sCAAsC,EAAE,qCAAqC,CAAC,CAAC,CAAC;QACpI,IAAI,CAAC,4BAA4B,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,yCAAyC,EAAE,uCAAuC,CAAC,CAAC,CAAC;IACjI,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"commandLinePwshChainOperatorRewriter.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { Schemas } from '../../../../../../base/common/network.js';\nimport { OperatingSystem } from '../../../../../../base/common/platform.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ITreeSitterLibraryService } from '../../../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { FileService } from '../../../../../../platform/files/common/fileService.js';\nimport type { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { NullLogService } from '../../../../../../platform/log/common/log.js';\nimport { TreeSitterLibraryService } from '../../../../../services/treeSitter/browser/treeSitterLibraryService.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { TestIPCFileSystemProvider } from '../../../../../test/electron-browser/workbenchTestServices.js';\nimport { CommandLinePwshChainOperatorRewriter } from '../../browser/tools/commandLineRewriter/commandLinePwshChainOperatorRewriter.js';\nimport type { ICommandLineRewriterOptions } from '../../browser/tools/commandLineRewriter/commandLineRewriter.js';\nimport { TreeSitterCommandParser } from '../../browser/treeSitterCommandParser.js';\n\nsuite('CommandLinePwshChainOperatorRewriter', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet parser: TreeSitterCommandParser;\n\tlet rewriter: CommandLinePwshChainOperatorRewriter;\n\n\tfunction createRewriteOptions(command: string, shell: string, os: OperatingSystem): ICommandLineRewriterOptions {\n\t\treturn {\n\t\t\tcommandLine: command,\n\t\t\tcwd: undefined,\n\t\t\tshell,\n\t\t\tos\n\t\t};\n\t}\n\n\tsetup(() => {\n\t\tconst fileService = store.add(new FileService(new NullLogService()));\n\t\tconst fileSystemProvider = new TestIPCFileSystemProvider();\n\t\tstore.add(fileService.registerProvider(Schemas.file, fileSystemProvider));\n\n\t\tinstantiationService = workbenchInstantiationService({\n\t\t\tfileService: () => fileService,\n\t\t}, store);\n\n\t\tconst treeSitterLibraryService = store.add(instantiationService.createInstance(TreeSitterLibraryService));\n\t\ttreeSitterLibraryService.isTest = true;\n\t\tinstantiationService.stub(ITreeSitterLibraryService, treeSitterLibraryService);\n\n\t\tparser = store.add(instantiationService.createInstance(TreeSitterCommandParser));\n\t\trewriter = store.add(instantiationService.createInstance(CommandLinePwshChainOperatorRewriter, parser));\n\t});\n\n\tsuite('PowerShell: && -> ;', () => {\n\t\tasync function t(originalCommandLine: string, expectedResult: string | undefined) {\n\t\t\tconst options = createRewriteOptions(originalCommandLine, 'pwsh', OperatingSystem.Windows);\n\t\t\tconst result = await rewriter.rewrite(options);\n\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\tif (expectedResult !== undefined) {\n\t\t\t\tstrictEqual(result?.reasoning, '&& re-written to ;');\n\t\t\t}\n\t\t}\n\n\t\ttest('should rewrite && to ; in PowerShell commands', () => t('echo hello && echo world', 'echo hello ; echo world'));\n\t\ttest('should rewrite multiple && to ; in PowerShell commands', () => t('echo first && echo second && echo third', 'echo first ; echo second ; echo third'));\n\t\ttest('should handle complex commands with && operators', () => t('npm install && npm test && echo \"build complete\"', 'npm install ; npm test ; echo \"build complete\"'));\n\t\ttest('should work with Windows PowerShell shell identifier', () => t('Get-Process && Stop-Process', 'Get-Process ; Stop-Process'));\n\t\ttest('should preserve existing semicolons', () => t('echo hello; echo world && echo final', 'echo hello; echo world ; echo final'));\n\t\ttest('should not rewrite strings', () => t('echo \"&&\" && Write-Host \"&& &&\" && \"&&\"', 'echo \"&&\" ; Write-Host \"&& &&\" ; \"&&\"'));\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { Schemas } from '../../../../../../base/common/network.js';\nimport { OperatingSystem } from '../../../../../../base/common/platform.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ITreeSitterLibraryService } from '../../../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { FileService } from '../../../../../../platform/files/common/fileService.js';\nimport type { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { NullLogService } from '../../../../../../platform/log/common/log.js';\nimport { TreeSitterLibraryService } from '../../../../../services/treeSitter/browser/treeSitterLibraryService.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { TestIPCFileSystemProvider } from '../../../../../test/electron-browser/workbenchTestServices.js';\nimport { CommandLinePwshChainOperatorRewriter } from '../../browser/tools/commandLineRewriter/commandLinePwshChainOperatorRewriter.js';\nimport type { ICommandLineRewriterOptions } from '../../browser/tools/commandLineRewriter/commandLineRewriter.js';\nimport { TreeSitterCommandParser } from '../../browser/treeSitterCommandParser.js';\n\nsuite('CommandLinePwshChainOperatorRewriter', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet parser: TreeSitterCommandParser;\n\tlet rewriter: CommandLinePwshChainOperatorRewriter;\n\n\tfunction createRewriteOptions(command: string, shell: string, os: OperatingSystem): ICommandLineRewriterOptions {\n\t\treturn {\n\t\t\tcommandLine: command,\n\t\t\tcwd: undefined,\n\t\t\tshell,\n\t\t\tos\n\t\t};\n\t}\n\n\tsetup(() => {\n\t\tconst fileService = store.add(new FileService(new NullLogService()));\n\t\tconst fileSystemProvider = new TestIPCFileSystemProvider();\n\t\tstore.add(fileService.registerProvider(Schemas.file, fileSystemProvider));\n\n\t\tinstantiationService = workbenchInstantiationService({\n\t\t\tfileService: () => fileService,\n\t\t}, store);\n\n\t\tconst treeSitterLibraryService = store.add(instantiationService.createInstance(TreeSitterLibraryService));\n\t\ttreeSitterLibraryService.isTest = true;\n\t\tinstantiationService.stub(ITreeSitterLibraryService, treeSitterLibraryService);\n\n\t\tparser = store.add(instantiationService.createInstance(TreeSitterCommandParser));\n\t\trewriter = store.add(instantiationService.createInstance(CommandLinePwshChainOperatorRewriter, parser));\n\t});\n\n\tsuite('PowerShell: && -> ;', () => {\n\t\tasync function t(originalCommandLine: string, expectedResult: string | undefined) {\n\t\t\tconst options = createRewriteOptions(originalCommandLine, 'pwsh', OperatingSystem.Windows);\n\t\t\tconst result = await rewriter.rewrite(options);\n\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\tif (expectedResult !== undefined) {\n\t\t\t\tstrictEqual(result?.reasoning, '&& re-written to ;');\n\t\t\t}\n\t\t}\n\n\t\ttest('should rewrite && to ; in PowerShell commands', () => t('echo hello && echo world', 'echo hello ; echo world'));\n\t\ttest('should rewrite multiple && to ; in PowerShell commands', () => t('echo first && echo second && echo third', 'echo first ; echo second ; echo third'));\n\t\ttest('should handle complex commands with && operators', () => t('npm install && npm test && echo \"build complete\"', 'npm install ; npm test ; echo \"build complete\"'));\n\t\ttest('should work with Windows PowerShell shell identifier', () => t('Get-Process && Stop-Process', 'Get-Process ; Stop-Process'));\n\t\ttest('should preserve existing semicolons', () => t('echo hello; echo world && echo final', 'echo hello; echo world ; echo final'));\n\t\ttest('should not rewrite strings', () => t('echo \"&&\" && Write-Host \"&& &&\" && \"&&\"', 'echo \"&&\" ; Write-Host \"&& &&\" ; \"&&\"'));\n\t});\n});\n"]}