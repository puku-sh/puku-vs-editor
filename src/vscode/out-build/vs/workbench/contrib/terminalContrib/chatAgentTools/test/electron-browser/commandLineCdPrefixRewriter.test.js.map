{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/chatAgentTools/test/electron-browser/commandLineCdPrefixRewriter.test.ts","vs/workbench/contrib/terminalContrib/chatAgentTools/test/electron-browser/commandLineCdPrefixRewriter.test.ts"],"names":[],"mappings":"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","file":"commandLineCdPrefixRewriter.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { isWindows, OperatingSystem } from '../../../../../../base/common/platform.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport type { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { CommandLineCdPrefixRewriter } from '../../browser/tools/commandLineRewriter/commandLineCdPrefixRewriter.js';\nimport type { ICommandLineRewriterOptions } from '../../browser/tools/commandLineRewriter/commandLineRewriter.js';\n\nsuite('CommandLineCdPrefixRewriter', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet rewriter: CommandLineCdPrefixRewriter;\n\n\tfunction createRewriteOptions(command: string, cwd: URI | undefined, shell: string, os: OperatingSystem): ICommandLineRewriterOptions {\n\t\treturn {\n\t\t\tcommandLine: command,\n\t\t\tcwd,\n\t\t\tshell,\n\t\t\tos\n\t\t};\n\t}\n\n\tsetup(() => {\n\t\tinstantiationService = workbenchInstantiationService({}, store);\n\t\trewriter = store.add(instantiationService.createInstance(CommandLineCdPrefixRewriter));\n\t});\n\n\tsuite('cd <cwd> && <suffix> -> <suffix>', () => {\n\t\t(!isWindows ? suite : suite.skip)('Posix', () => {\n\t\t\tconst cwd = URI.file('/test/workspace');\n\n\t\t\tfunction t(commandLine: string, shell: string, expectedResult: string | undefined) {\n\t\t\t\tconst options = createRewriteOptions(commandLine, cwd, shell, OperatingSystem.Linux);\n\t\t\t\tconst result = rewriter.rewrite(options);\n\t\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\t\tif (expectedResult !== undefined) {\n\t\t\t\t\tstrictEqual(result?.reasoning, 'Removed redundant cd command');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttest('should return undefined when no cd prefix pattern matches', () => t('echo hello world', 'bash', undefined));\n\t\t\ttest('should return undefined when cd pattern does not have suffix', () => t('cd /some/path', 'bash', undefined));\n\t\t\ttest('should rewrite command with ; separator when directory matches cwd', () => t('cd /test/workspace; npm test', 'pwsh', 'npm test'));\n\t\t\ttest('should rewrite command with && separator when directory matches cwd', () => t('cd /test/workspace && npm install', 'bash', 'npm install'));\n\t\t\ttest('should rewrite command when the path is wrapped in double quotes', () => t('cd \"/test/workspace\" && npm install', 'bash', 'npm install'));\n\t\t\ttest('should not rewrite command when directory does not match cwd', () => t('cd /different/path && npm install', 'bash', undefined));\n\t\t\ttest('should handle commands with complex suffixes', () => t('cd /test/workspace && npm install && npm test && echo \"done\"', 'bash', 'npm install && npm test && echo \"done\"'));\n\t\t\ttest('should ignore any trailing forward slash', () => t('cd /test/workspace/ && npm install', 'bash', 'npm install'));\n\t\t});\n\n\t\t(isWindows ? suite : suite.skip)('Windows', () => {\n\t\t\tconst cwd = URI.file('C:\\\\test\\\\workspace');\n\n\t\t\tfunction t(commandLine: string, shell: string, expectedResult: string | undefined) {\n\t\t\t\tconst options = createRewriteOptions(commandLine, cwd, shell, OperatingSystem.Windows);\n\t\t\t\tconst result = rewriter.rewrite(options);\n\t\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\t\tif (expectedResult !== undefined) {\n\t\t\t\t\tstrictEqual(result?.reasoning, 'Removed redundant cd command');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttest('should ignore any trailing back slash', () => t('cd c:\\\\test\\\\workspace\\\\ && npm install', 'cmd', 'npm install'));\n\t\t\ttest('should rewrite command with && separator when directory matches cwd', () => t('cd C:\\\\test\\\\workspace && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should rewrite command with ; separator when directory matches cwd - PowerShell style', () => t('cd C:\\\\test\\\\workspace; npm test', 'pwsh', 'npm test'));\n\t\t\ttest('should not rewrite when cwd differs from cd path', () => t('cd C:\\\\different\\\\path && npm test', 'cmd', undefined));\n\t\t\ttest('should handle case-insensitive comparison on Windows', () => t('cd c:\\\\test\\\\workspace && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should handle quoted paths', () => t('cd \"C:\\\\test\\\\workspace\" && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should handle cd /d flag when directory matches cwd', () => t('cd /d C:\\\\test\\\\workspace && echo hello', 'pwsh', 'echo hello'));\n\t\t\ttest('should handle cd /d flag with quoted paths when directory matches cwd', () => t('cd /d \"C:\\\\test\\\\workspace\" && echo hello', 'pwsh', 'echo hello'));\n\t\t\ttest('should not rewrite cd /d when directory does not match cwd', () => t('cd /d C:\\\\different\\\\path ; echo hello', 'pwsh', undefined));\n\t\t\ttest('should handle cd /d flag with semicolon separator', () => t('cd /d C:\\\\test\\\\workspace; echo hello', 'pwsh', 'echo hello'));\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { isWindows, OperatingSystem } from '../../../../../../base/common/platform.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport type { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { CommandLineCdPrefixRewriter } from '../../browser/tools/commandLineRewriter/commandLineCdPrefixRewriter.js';\nimport type { ICommandLineRewriterOptions } from '../../browser/tools/commandLineRewriter/commandLineRewriter.js';\n\nsuite('CommandLineCdPrefixRewriter', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet rewriter: CommandLineCdPrefixRewriter;\n\n\tfunction createRewriteOptions(command: string, cwd: URI | undefined, shell: string, os: OperatingSystem): ICommandLineRewriterOptions {\n\t\treturn {\n\t\t\tcommandLine: command,\n\t\t\tcwd,\n\t\t\tshell,\n\t\t\tos\n\t\t};\n\t}\n\n\tsetup(() => {\n\t\tinstantiationService = workbenchInstantiationService({}, store);\n\t\trewriter = store.add(instantiationService.createInstance(CommandLineCdPrefixRewriter));\n\t});\n\n\tsuite('cd <cwd> && <suffix> -> <suffix>', () => {\n\t\t(!isWindows ? suite : suite.skip)('Posix', () => {\n\t\t\tconst cwd = URI.file('/test/workspace');\n\n\t\t\tfunction t(commandLine: string, shell: string, expectedResult: string | undefined) {\n\t\t\t\tconst options = createRewriteOptions(commandLine, cwd, shell, OperatingSystem.Linux);\n\t\t\t\tconst result = rewriter.rewrite(options);\n\t\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\t\tif (expectedResult !== undefined) {\n\t\t\t\t\tstrictEqual(result?.reasoning, 'Removed redundant cd command');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttest('should return undefined when no cd prefix pattern matches', () => t('echo hello world', 'bash', undefined));\n\t\t\ttest('should return undefined when cd pattern does not have suffix', () => t('cd /some/path', 'bash', undefined));\n\t\t\ttest('should rewrite command with ; separator when directory matches cwd', () => t('cd /test/workspace; npm test', 'pwsh', 'npm test'));\n\t\t\ttest('should rewrite command with && separator when directory matches cwd', () => t('cd /test/workspace && npm install', 'bash', 'npm install'));\n\t\t\ttest('should rewrite command when the path is wrapped in double quotes', () => t('cd \"/test/workspace\" && npm install', 'bash', 'npm install'));\n\t\t\ttest('should not rewrite command when directory does not match cwd', () => t('cd /different/path && npm install', 'bash', undefined));\n\t\t\ttest('should handle commands with complex suffixes', () => t('cd /test/workspace && npm install && npm test && echo \"done\"', 'bash', 'npm install && npm test && echo \"done\"'));\n\t\t\ttest('should ignore any trailing forward slash', () => t('cd /test/workspace/ && npm install', 'bash', 'npm install'));\n\t\t});\n\n\t\t(isWindows ? suite : suite.skip)('Windows', () => {\n\t\t\tconst cwd = URI.file('C:\\\\test\\\\workspace');\n\n\t\t\tfunction t(commandLine: string, shell: string, expectedResult: string | undefined) {\n\t\t\t\tconst options = createRewriteOptions(commandLine, cwd, shell, OperatingSystem.Windows);\n\t\t\t\tconst result = rewriter.rewrite(options);\n\t\t\t\tstrictEqual(result?.rewritten, expectedResult);\n\t\t\t\tif (expectedResult !== undefined) {\n\t\t\t\t\tstrictEqual(result?.reasoning, 'Removed redundant cd command');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttest('should ignore any trailing back slash', () => t('cd c:\\\\test\\\\workspace\\\\ && npm install', 'cmd', 'npm install'));\n\t\t\ttest('should rewrite command with && separator when directory matches cwd', () => t('cd C:\\\\test\\\\workspace && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should rewrite command with ; separator when directory matches cwd - PowerShell style', () => t('cd C:\\\\test\\\\workspace; npm test', 'pwsh', 'npm test'));\n\t\t\ttest('should not rewrite when cwd differs from cd path', () => t('cd C:\\\\different\\\\path && npm test', 'cmd', undefined));\n\t\t\ttest('should handle case-insensitive comparison on Windows', () => t('cd c:\\\\test\\\\workspace && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should handle quoted paths', () => t('cd \"C:\\\\test\\\\workspace\" && npm test', 'cmd', 'npm test'));\n\t\t\ttest('should handle cd /d flag when directory matches cwd', () => t('cd /d C:\\\\test\\\\workspace && echo hello', 'pwsh', 'echo hello'));\n\t\t\ttest('should handle cd /d flag with quoted paths when directory matches cwd', () => t('cd /d \"C:\\\\test\\\\workspace\" && echo hello', 'pwsh', 'echo hello'));\n\t\t\ttest('should not rewrite cd /d when directory does not match cwd', () => t('cd /d C:\\\\different\\\\path ; echo hello', 'pwsh', undefined));\n\t\t\ttest('should handle cd /d flag with semicolon separator', () => t('cd /d C:\\\\test\\\\workspace; echo hello', 'pwsh', 'echo hello'));\n\t\t});\n\t});\n});\n"]}