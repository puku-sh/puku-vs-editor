{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/chatAgentTools/test/browser/outputMonitor.test.ts","vs/workbench/contrib/terminalContrib/chatAgentTools/test/browser/outputMonitor.test.ts"],"names":[],"mappings":"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","file":"outputMonitor.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { detectsInputRequiredPattern, OutputMonitor } from '../../browser/tools/monitoring/outputMonitor.js';\nimport { CancellationTokenSource } from '../../../../../../base/common/cancellation.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ITerminalInstance } from '../../../../terminal/browser/terminal.js';\nimport { IPollingResult, OutputMonitorState } from '../../browser/tools/monitoring/types.js';\nimport { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILanguageModelsService } from '../../../../chat/common/languageModels.js';\nimport { IChatService } from '../../../../chat/common/chatService.js';\nimport { Emitter, Event } from '../../../../../../base/common/event.js';\nimport { ChatModel } from '../../../../chat/common/chatModel.js';\nimport { ILogService, NullLogService } from '../../../../../../platform/log/common/log.js';\nimport { runWithFakedTimers } from '../../../../../../base/test/common/timeTravelScheduler.js';\nimport { IToolInvocationContext } from '../../../../chat/common/languageModelToolsService.js';\nimport { LocalChatSessionUri } from '../../../../chat/common/chatUri.js';\nimport { isNumber } from '../../../../../../base/common/types.js';\n\nsuite('OutputMonitor', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\tlet monitor: OutputMonitor;\n\tlet execution: { getOutput: () => string; isActive?: () => Promise<boolean>; instance: Pick<ITerminalInstance, 'instanceId' | 'sendText' | 'onData' | 'onDidInputData' | 'focus' | 'registerMarker'>; sessionId: string };\n\tlet cts: CancellationTokenSource;\n\tlet instantiationService: TestInstantiationService;\n\tlet sendTextCalled: boolean;\n\tlet dataEmitter: Emitter<string>;\n\n\tsetup(() => {\n\t\tsendTextCalled = false;\n\t\tdataEmitter = new Emitter<string>();\n\t\texecution = {\n\t\t\tgetOutput: () => 'test output',\n\t\t\tisActive: async () => false,\n\t\t\tinstance: {\n\t\t\t\tinstanceId: 1,\n\t\t\t\tsendText: async () => { sendTextCalled = true; },\n\t\t\t\tonDidInputData: dataEmitter.event,\n\t\t\t\tonData: dataEmitter.event,\n\t\t\t\tfocus: () => { },\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tregisterMarker: () => ({ id: 1 } as any)\n\t\t\t},\n\t\t\tsessionId: '1'\n\t\t};\n\t\tinstantiationService = new TestInstantiationService();\n\n\t\tinstantiationService.stub(\n\t\t\tILanguageModelsService,\n\t\t\t{\n\t\t\t\tselectLanguageModels: async () => []\n\t\t\t}\n\t\t);\n\t\tinstantiationService.stub(\n\t\t\tIChatService,\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tgetSession: () => ({\n\t\t\t\t\tsessionId: '1',\n\t\t\t\t\tonDidDispose: { event: () => { }, dispose: () => { } },\n\t\t\t\t\tonDidChange: { event: () => { }, dispose: () => { } },\n\t\t\t\t\tinitialLocation: undefined,\n\t\t\t\t\trequests: [],\n\t\t\t\t\tresponses: [],\n\t\t\t\t\taddRequest: () => { },\n\t\t\t\t\taddResponse: () => { },\n\t\t\t\t\tdispose: () => { }\n\t\t\t\t} as any)\n\t\t\t}\n\t\t);\n\t\tinstantiationService.stub(ILogService, new NullLogService());\n\t\tcts = new CancellationTokenSource();\n\t});\n\n\tteardown(() => {\n\t\tcts.dispose();\n\t});\n\n\ttest('startMonitoring returns immediately when polling succeeds', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t\tassert.strictEqual(pollingResult.output, 'changed output');\n\t\t\tassert.strictEqual(sendTextCalled, false, 'sendText should not be called');\n\t\t});\n\t});\n\n\ttest('startMonitoring returns cancelled when token is cancelled', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tcts.cancel();\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Cancelled);\n\t\t});\n\t});\n\ttest('startMonitoring returns idle when isActive is false', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\texecution.isActive = async () => false;\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t});\n\t});\n\n\ttest('startMonitoring works when isActive is undefined', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tdelete execution.isActive;\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t});\n\t});\n\n\ttest('monitor can be disposed twice without error', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t\tmonitor.dispose();\n\t\t\tmonitor.dispose();\n\t\t});\n\t});\n\ttest('timeout prompt unanswered → continues polling and completes when idle', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Fake a ChatModel enough to pass instanceof and the two methods used\n\t\t\tconst fakeChatModel: any = {\n\t\t\t\tgetRequests: () => [{}],\n\t\t\t\tacceptResponseProgress: () => { }\n\t\t\t};\n\t\t\tObject.setPrototypeOf(fakeChatModel, ChatModel.prototype);\n\t\t\tinstantiationService.stub(IChatService, { getSession: () => fakeChatModel });\n\n\t\t\t// Poller: first pass times out (to show the prompt), second pass goes idle\n\t\t\tlet pass = 0;\n\t\t\tconst timeoutThenIdle = async (): Promise<IPollingResult> => {\n\t\t\t\tpass++;\n\t\t\t\treturn pass === 1\n\t\t\t\t\t? { state: OutputMonitorState.Timeout, output: execution.getOutput(), modelOutputEvalResponse: 'Timed out' }\n\t\t\t\t\t: { state: OutputMonitorState.Idle, output: execution.getOutput(), modelOutputEvalResponse: 'Done' };\n\t\t\t};\n\n\t\t\tmonitor = store.add(\n\t\t\t\tinstantiationService.createInstance(\n\t\t\t\t\tOutputMonitor,\n\t\t\t\t\texecution,\n\t\t\t\t\ttimeoutThenIdle,\n\t\t\t\t\tcreateTestContext('1'),\n\t\t\t\t\tcts.token,\n\t\t\t\t\t'test command'\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\n\t\t\tconst res = monitor.pollingResult!;\n\t\t\tassert.strictEqual(res.state, OutputMonitorState.Idle);\n\t\t\tassert.strictEqual(res.output, 'test output');\n\t\t\tassert.ok(isNumber(res.pollDurationMs));\n\t\t});\n\t});\n\n\tsuite('detectsInputRequiredPattern', () => {\n\t\ttest('detects yes/no confirmation prompts (pairs and variants)', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/N) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/n) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite file? [Y/n] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure? (Y/N) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Delete files? [y/N] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed? (yes/no) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed? [no/yes] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? y/n '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite: yes/no '), true);\n\n\t\t\t// No match if there's a response already\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/N) y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/n) n'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite file? [Y/n] N'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure? (Y/N) Y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Delete files? [y/N] y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? y/n y\\/n'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite: yes/no yes\\/n'), false);\n\t\t});\n\n\t\ttest('detects PowerShell multi-option confirmation line', () => {\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"Y\"): '),\n\t\t\t\ttrue\n\t\t\t);\n\t\t\t// also matches without default suffix\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [N] No '),\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\t// No match if there's a response already\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"Y\"): Y'),\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [N] No N'),\n\t\t\t\tfalse\n\t\t\t);\n\t\t});\n\t\ttest('Line ends with colon', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Enter your name: '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Password: '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('File to overwrite: '), true);\n\t\t});\n\n\t\ttest('detects trailing questions', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue?'), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed?   '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure?'), true);\n\t\t});\n\n\t\ttest('detects press any key prompts', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Press any key to continue...'), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Press a key'), true);\n\t\t});\n\t});\n\n});\nfunction createTestContext(id: string): IToolInvocationContext {\n\treturn { sessionId: id, sessionResource: LocalChatSessionUri.forSession(id) };\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { detectsInputRequiredPattern, OutputMonitor } from '../../browser/tools/monitoring/outputMonitor.js';\nimport { CancellationTokenSource } from '../../../../../../base/common/cancellation.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ITerminalInstance } from '../../../../terminal/browser/terminal.js';\nimport { IPollingResult, OutputMonitorState } from '../../browser/tools/monitoring/types.js';\nimport { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILanguageModelsService } from '../../../../chat/common/languageModels.js';\nimport { IChatService } from '../../../../chat/common/chatService.js';\nimport { Emitter, Event } from '../../../../../../base/common/event.js';\nimport { ChatModel } from '../../../../chat/common/chatModel.js';\nimport { ILogService, NullLogService } from '../../../../../../platform/log/common/log.js';\nimport { runWithFakedTimers } from '../../../../../../base/test/common/timeTravelScheduler.js';\nimport { IToolInvocationContext } from '../../../../chat/common/languageModelToolsService.js';\nimport { LocalChatSessionUri } from '../../../../chat/common/chatUri.js';\nimport { isNumber } from '../../../../../../base/common/types.js';\n\nsuite('OutputMonitor', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\tlet monitor: OutputMonitor;\n\tlet execution: { getOutput: () => string; isActive?: () => Promise<boolean>; instance: Pick<ITerminalInstance, 'instanceId' | 'sendText' | 'onData' | 'onDidInputData' | 'focus' | 'registerMarker'>; sessionId: string };\n\tlet cts: CancellationTokenSource;\n\tlet instantiationService: TestInstantiationService;\n\tlet sendTextCalled: boolean;\n\tlet dataEmitter: Emitter<string>;\n\n\tsetup(() => {\n\t\tsendTextCalled = false;\n\t\tdataEmitter = new Emitter<string>();\n\t\texecution = {\n\t\t\tgetOutput: () => 'test output',\n\t\t\tisActive: async () => false,\n\t\t\tinstance: {\n\t\t\t\tinstanceId: 1,\n\t\t\t\tsendText: async () => { sendTextCalled = true; },\n\t\t\t\tonDidInputData: dataEmitter.event,\n\t\t\t\tonData: dataEmitter.event,\n\t\t\t\tfocus: () => { },\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tregisterMarker: () => ({ id: 1 } as any)\n\t\t\t},\n\t\t\tsessionId: '1'\n\t\t};\n\t\tinstantiationService = new TestInstantiationService();\n\n\t\tinstantiationService.stub(\n\t\t\tILanguageModelsService,\n\t\t\t{\n\t\t\t\tselectLanguageModels: async () => []\n\t\t\t}\n\t\t);\n\t\tinstantiationService.stub(\n\t\t\tIChatService,\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tgetSession: () => ({\n\t\t\t\t\tsessionId: '1',\n\t\t\t\t\tonDidDispose: { event: () => { }, dispose: () => { } },\n\t\t\t\t\tonDidChange: { event: () => { }, dispose: () => { } },\n\t\t\t\t\tinitialLocation: undefined,\n\t\t\t\t\trequests: [],\n\t\t\t\t\tresponses: [],\n\t\t\t\t\taddRequest: () => { },\n\t\t\t\t\taddResponse: () => { },\n\t\t\t\t\tdispose: () => { }\n\t\t\t\t} as any)\n\t\t\t}\n\t\t);\n\t\tinstantiationService.stub(ILogService, new NullLogService());\n\t\tcts = new CancellationTokenSource();\n\t});\n\n\tteardown(() => {\n\t\tcts.dispose();\n\t});\n\n\ttest('startMonitoring returns immediately when polling succeeds', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t\tassert.strictEqual(pollingResult.output, 'changed output');\n\t\t\tassert.strictEqual(sendTextCalled, false, 'sendText should not be called');\n\t\t});\n\t});\n\n\ttest('startMonitoring returns cancelled when token is cancelled', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tcts.cancel();\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Cancelled);\n\t\t});\n\t});\n\ttest('startMonitoring returns idle when isActive is false', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\texecution.isActive = async () => false;\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t});\n\t});\n\n\ttest('startMonitoring works when isActive is undefined', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tdelete execution.isActive;\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t});\n\t});\n\n\ttest('monitor can be disposed twice without error', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Simulate output change after first poll\n\t\t\tlet callCount = 0;\n\t\t\texecution.getOutput = () => {\n\t\t\t\tcallCount++;\n\t\t\t\treturn callCount > 1 ? 'changed output' : 'test output';\n\t\t\t};\n\t\t\tmonitor = store.add(instantiationService.createInstance(OutputMonitor, execution, undefined, createTestContext('1'), cts.token, 'test command'));\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\t\t\tconst pollingResult = monitor.pollingResult;\n\t\t\tassert.strictEqual(pollingResult?.state, OutputMonitorState.Idle);\n\t\t\tmonitor.dispose();\n\t\t\tmonitor.dispose();\n\t\t});\n\t});\n\ttest('timeout prompt unanswered → continues polling and completes when idle', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\t// Fake a ChatModel enough to pass instanceof and the two methods used\n\t\t\tconst fakeChatModel: any = {\n\t\t\t\tgetRequests: () => [{}],\n\t\t\t\tacceptResponseProgress: () => { }\n\t\t\t};\n\t\t\tObject.setPrototypeOf(fakeChatModel, ChatModel.prototype);\n\t\t\tinstantiationService.stub(IChatService, { getSession: () => fakeChatModel });\n\n\t\t\t// Poller: first pass times out (to show the prompt), second pass goes idle\n\t\t\tlet pass = 0;\n\t\t\tconst timeoutThenIdle = async (): Promise<IPollingResult> => {\n\t\t\t\tpass++;\n\t\t\t\treturn pass === 1\n\t\t\t\t\t? { state: OutputMonitorState.Timeout, output: execution.getOutput(), modelOutputEvalResponse: 'Timed out' }\n\t\t\t\t\t: { state: OutputMonitorState.Idle, output: execution.getOutput(), modelOutputEvalResponse: 'Done' };\n\t\t\t};\n\n\t\t\tmonitor = store.add(\n\t\t\t\tinstantiationService.createInstance(\n\t\t\t\t\tOutputMonitor,\n\t\t\t\t\texecution,\n\t\t\t\t\ttimeoutThenIdle,\n\t\t\t\t\tcreateTestContext('1'),\n\t\t\t\t\tcts.token,\n\t\t\t\t\t'test command'\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tawait Event.toPromise(monitor.onDidFinishCommand);\n\n\t\t\tconst res = monitor.pollingResult!;\n\t\t\tassert.strictEqual(res.state, OutputMonitorState.Idle);\n\t\t\tassert.strictEqual(res.output, 'test output');\n\t\t\tassert.ok(isNumber(res.pollDurationMs));\n\t\t});\n\t});\n\n\tsuite('detectsInputRequiredPattern', () => {\n\t\ttest('detects yes/no confirmation prompts (pairs and variants)', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/N) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/n) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite file? [Y/n] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure? (Y/N) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Delete files? [y/N] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed? (yes/no) '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed? [no/yes] '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? y/n '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite: yes/no '), true);\n\n\t\t\t// No match if there's a response already\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/N) y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? (y/n) n'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite file? [Y/n] N'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure? (Y/N) Y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Delete files? [y/N] y'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue? y/n y\\/n'), false);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Overwrite: yes/no yes\\/n'), false);\n\t\t});\n\n\t\ttest('detects PowerShell multi-option confirmation line', () => {\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"Y\"): '),\n\t\t\t\ttrue\n\t\t\t);\n\t\t\t// also matches without default suffix\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [N] No '),\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\t// No match if there's a response already\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"Y\"): Y'),\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tassert.strictEqual(\n\t\t\t\tdetectsInputRequiredPattern('[Y] Yes  [N] No N'),\n\t\t\t\tfalse\n\t\t\t);\n\t\t});\n\t\ttest('Line ends with colon', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Enter your name: '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Password: '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('File to overwrite: '), true);\n\t\t});\n\n\t\ttest('detects trailing questions', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Continue?'), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Proceed?   '), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Are you sure?'), true);\n\t\t});\n\n\t\ttest('detects press any key prompts', () => {\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Press any key to continue...'), true);\n\t\t\tassert.strictEqual(detectsInputRequiredPattern('Press a key'), true);\n\t\t});\n\t});\n\n});\nfunction createTestContext(id: string): IToolInvocationContext {\n\treturn { sessionId: id, sessionResource: LocalChatSessionUri.forSession(id) };\n}\n\n"]}