{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/chatAgentTools/browser/tools/commandLineRewriter/commandLinePwshChainOperatorRewriter.ts","vs/workbench/contrib/terminalContrib/chatAgentTools/browser/tools/commandLineRewriter/commandLinePwshChainOperatorRewriter.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAGhG,OAAO,EAAE,UAAU,EAAE,MAAM,+CAA+C,CAAC;AAC3E,OAAO,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAC;AAI7D,MAAM,OAAO,oCAAqC,SAAQ,UAAU;IACnE,YACkB,wBAAiD;QAElE,KAAK,EAAE,CAAC;QAFS,6BAAwB,GAAxB,wBAAwB,CAAyB;IAGnE,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,OAAoC;QACjD,yFAAyF;QACzF,2FAA2F;QAC3F,IAAI,YAAY,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YAC7C,IAAI,uBAAmD,CAAC;YACxD,IAAI,CAAC;gBACJ,uBAAuB,GAAG,MAAM,IAAI,CAAC,wBAAwB,CAAC,wCAAwC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC7H,CAAC;YAAC,MAAM,CAAC;gBACR,+BAA+B;YAChC,CAAC;YAED,IAAI,uBAAuB,IAAI,uBAAuB,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBACnE,IAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC;gBACpC,KAAK,MAAM,OAAO,IAAI,uBAAuB,CAAC,OAAO,EAAE,EAAE,CAAC;oBACzD,SAAS,GAAG,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC,EAAE,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;gBAChH,CAAC;gBACD,OAAO;oBACN,SAAS;oBACT,SAAS,EAAE,oBAAoB;iBAC/B,CAAC;YACH,CAAC;QACF,CAAC;QAED,OAAO,SAAS,CAAC;IAClB,CAAC;CACD","file":"commandLinePwshChainOperatorRewriter.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { QueryCapture } from '@vscode/tree-sitter-wasm';\nimport { Disposable } from '../../../../../../../base/common/lifecycle.js';\nimport { isPowerShell } from '../../runInTerminalHelpers.js';\nimport type { TreeSitterCommandParser } from '../../treeSitterCommandParser.js';\nimport type { ICommandLineRewriter, ICommandLineRewriterOptions, ICommandLineRewriterResult } from './commandLineRewriter.js';\n\nexport class CommandLinePwshChainOperatorRewriter extends Disposable implements ICommandLineRewriter {\n\tconstructor(\n\t\tprivate readonly _treeSitterCommandParser: TreeSitterCommandParser,\n\t) {\n\t\tsuper();\n\t}\n\n\tasync rewrite(options: ICommandLineRewriterOptions): Promise<ICommandLineRewriterResult | undefined> {\n\t\t// TODO: This should just be Windows PowerShell in the future when the powershell grammar\n\t\t// supports chain operators https://github.com/airbus-cert/tree-sitter-powershell/issues/27\n\t\tif (isPowerShell(options.shell, options.os)) {\n\t\t\tlet doubleAmpersandCaptures: QueryCapture[] | undefined;\n\t\t\ttry {\n\t\t\t\tdoubleAmpersandCaptures = await this._treeSitterCommandParser.extractPwshDoubleAmpersandChainOperators(options.commandLine);\n\t\t\t} catch {\n\t\t\t\t// Swallow tree sitter failures\n\t\t\t}\n\n\t\t\tif (doubleAmpersandCaptures && doubleAmpersandCaptures.length > 0) {\n\t\t\t\tlet rewritten = options.commandLine;\n\t\t\t\tfor (const capture of doubleAmpersandCaptures.reverse()) {\n\t\t\t\t\trewritten = `${rewritten.substring(0, capture.node.startIndex)};${rewritten.substring(capture.node.endIndex)}`;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\trewritten,\n\t\t\t\t\treasoning: '&& re-written to ;'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { QueryCapture } from '@vscode/tree-sitter-wasm';\nimport { Disposable } from '../../../../../../../base/common/lifecycle.js';\nimport { isPowerShell } from '../../runInTerminalHelpers.js';\nimport type { TreeSitterCommandParser } from '../../treeSitterCommandParser.js';\nimport type { ICommandLineRewriter, ICommandLineRewriterOptions, ICommandLineRewriterResult } from './commandLineRewriter.js';\n\nexport class CommandLinePwshChainOperatorRewriter extends Disposable implements ICommandLineRewriter {\n\tconstructor(\n\t\tprivate readonly _treeSitterCommandParser: TreeSitterCommandParser,\n\t) {\n\t\tsuper();\n\t}\n\n\tasync rewrite(options: ICommandLineRewriterOptions): Promise<ICommandLineRewriterResult | undefined> {\n\t\t// TODO: This should just be Windows PowerShell in the future when the powershell grammar\n\t\t// supports chain operators https://github.com/airbus-cert/tree-sitter-powershell/issues/27\n\t\tif (isPowerShell(options.shell, options.os)) {\n\t\t\tlet doubleAmpersandCaptures: QueryCapture[] | undefined;\n\t\t\ttry {\n\t\t\t\tdoubleAmpersandCaptures = await this._treeSitterCommandParser.extractPwshDoubleAmpersandChainOperators(options.commandLine);\n\t\t\t} catch {\n\t\t\t\t// Swallow tree sitter failures\n\t\t\t}\n\n\t\t\tif (doubleAmpersandCaptures && doubleAmpersandCaptures.length > 0) {\n\t\t\t\tlet rewritten = options.commandLine;\n\t\t\t\tfor (const capture of doubleAmpersandCaptures.reverse()) {\n\t\t\t\t\trewritten = `${rewritten.substring(0, capture.node.startIndex)};${rewritten.substring(capture.node.endIndex)}`;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\trewritten,\n\t\t\t\t\treasoning: '&& re-written to ;'\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n"]}