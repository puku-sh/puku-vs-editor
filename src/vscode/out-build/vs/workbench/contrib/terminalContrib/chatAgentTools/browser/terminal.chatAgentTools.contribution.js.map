{"version":3,"sources":["vs/workbench/contrib/terminalContrib/chatAgentTools/browser/terminal.chatAgentTools.contribution.ts"],"names":[],"mappings":"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","file":"terminal.chatAgentTools.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { isNumber } from '../../../../../base/common/types.js';\nimport { localize } from '../../../../../nls.js';\nimport { MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { TerminalSettingId } from '../../../../../platform/terminal/common/terminal.js';\nimport { registerWorkbenchContribution2, WorkbenchPhase, type IWorkbenchContribution } from '../../../../common/contributions.js';\nimport { IChatWidgetService } from '../../../chat/browser/chat.js';\nimport { ChatContextKeys } from '../../../chat/common/chatContextKeys.js';\nimport { ILanguageModelToolsService, ToolDataSource, VSCodeToolReference } from '../../../chat/common/languageModelToolsService.js';\nimport { registerActiveInstanceAction, sharedWhenClause } from '../../../terminal/browser/terminalActions.js';\nimport { TerminalContextMenuGroup } from '../../../terminal/browser/terminalMenus.js';\nimport { TerminalContextKeys } from '../../../terminal/common/terminalContextKey.js';\nimport { TerminalChatAgentToolsCommandId } from '../common/terminal.chatAgentTools.js';\nimport { TerminalChatAgentToolsSettingId } from '../common/terminalChatAgentToolsConfiguration.js';\nimport { GetTerminalLastCommandTool, GetTerminalLastCommandToolData } from './tools/getTerminalLastCommandTool.js';\nimport { GetTerminalOutputTool, GetTerminalOutputToolData } from './tools/getTerminalOutputTool.js';\nimport { GetTerminalSelectionTool, GetTerminalSelectionToolData } from './tools/getTerminalSelectionTool.js';\nimport { ConfirmTerminalCommandTool, ConfirmTerminalCommandToolData } from './tools/runInTerminalConfirmationTool.js';\nimport { RunInTerminalTool, createRunInTerminalToolData } from './tools/runInTerminalTool.js';\nimport { CreateAndRunTaskTool, CreateAndRunTaskToolData } from './tools/task/createAndRunTaskTool.js';\nimport { GetTaskOutputTool, GetTaskOutputToolData } from './tools/task/getTaskOutputTool.js';\nimport { RunTaskTool, RunTaskToolData } from './tools/task/runTaskTool.js';\n\nclass ShellIntegrationTimeoutMigrationContribution extends Disposable implements IWorkbenchContribution {\n\tstatic readonly ID = 'terminal.shellIntegrationTimeoutMigration';\n\n\tconstructor(\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t) {\n\t\tsuper();\n\t\tconst deprecatedSettingValue = configurationService.getValue<unknown>(TerminalChatAgentToolsSettingId.ShellIntegrationTimeout);\n\t\tif (!isNumber(deprecatedSettingValue)) {\n\t\t\treturn;\n\t\t}\n\t\tconst newSettingValue = configurationService.getValue<unknown>(TerminalSettingId.ShellIntegrationTimeout);\n\t\tif (!isNumber(newSettingValue)) {\n\t\t\tconfigurationService.updateValue(TerminalSettingId.ShellIntegrationTimeout, deprecatedSettingValue);\n\t\t}\n\t}\n}\nregisterWorkbenchContribution2(ShellIntegrationTimeoutMigrationContribution.ID, ShellIntegrationTimeoutMigrationContribution, WorkbenchPhase.Eventually);\n\nclass ChatAgentToolsContribution extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'terminal.chatAgentTools';\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageModelToolsService toolsService: ILanguageModelToolsService,\n\t) {\n\t\tsuper();\n\n\t\t// #region Terminal\n\n\t\tconst confirmTerminalCommandTool = instantiationService.createInstance(ConfirmTerminalCommandTool);\n\t\tthis._register(toolsService.registerTool(ConfirmTerminalCommandToolData, confirmTerminalCommandTool));\n\t\tconst getTerminalOutputTool = instantiationService.createInstance(GetTerminalOutputTool);\n\t\tthis._register(toolsService.registerTool(GetTerminalOutputToolData, getTerminalOutputTool));\n\n\t\tconst shellToolSet = this._register(toolsService.createToolSet(ToolDataSource.Internal, 'shell', VSCodeToolReference.shell, {\n\t\t\ticon: ThemeIcon.fromId(Codicon.terminal.id),\n\t\t\tdescription: localize('toolset.shell', 'Run commands in the terminal'),\n\t\t\tlegacyFullNames: ['runCommands']\n\t\t}));\n\t\tthis._register(shellToolSet.addTool(GetTerminalOutputToolData));\n\n\t\tinstantiationService.invokeFunction(createRunInTerminalToolData).then(runInTerminalToolData => {\n\t\t\tconst runInTerminalTool = instantiationService.createInstance(RunInTerminalTool);\n\t\t\tthis._register(toolsService.registerTool(runInTerminalToolData, runInTerminalTool));\n\t\t\tthis._register(shellToolSet.addTool(runInTerminalToolData));\n\t\t});\n\n\t\tconst getTerminalSelectionTool = instantiationService.createInstance(GetTerminalSelectionTool);\n\t\tthis._register(toolsService.registerTool(GetTerminalSelectionToolData, getTerminalSelectionTool));\n\n\t\tconst getTerminalLastCommandTool = instantiationService.createInstance(GetTerminalLastCommandTool);\n\t\tthis._register(toolsService.registerTool(GetTerminalLastCommandToolData, getTerminalLastCommandTool));\n\n\t\tthis._register(shellToolSet.addTool(GetTerminalSelectionToolData));\n\t\tthis._register(shellToolSet.addTool(GetTerminalLastCommandToolData));\n\n\t\t// #endregion\n\n\t\t// #region Tasks\n\n\t\tconst runTaskTool = instantiationService.createInstance(RunTaskTool);\n\t\tthis._register(toolsService.registerTool(RunTaskToolData, runTaskTool));\n\n\t\tconst getTaskOutputTool = instantiationService.createInstance(GetTaskOutputTool);\n\t\tthis._register(toolsService.registerTool(GetTaskOutputToolData, getTaskOutputTool));\n\n\t\tconst createAndRunTaskTool = instantiationService.createInstance(CreateAndRunTaskTool);\n\t\tthis._register(toolsService.registerTool(CreateAndRunTaskToolData, createAndRunTaskTool));\n\t\tthis._register(toolsService.launchToolSet.addTool(RunTaskToolData));\n\t\tthis._register(toolsService.launchToolSet.addTool(GetTaskOutputToolData));\n\t\tthis._register(toolsService.launchToolSet.addTool(CreateAndRunTaskToolData));\n\n\t\t// #endregion\n\t}\n}\nregisterWorkbenchContribution2(ChatAgentToolsContribution.ID, ChatAgentToolsContribution, WorkbenchPhase.AfterRestored);\n\n// #endregion Contributions\n\n// #region Actions\n\nregisterActiveInstanceAction({\n\tid: TerminalChatAgentToolsCommandId.ChatAddTerminalSelection,\n\ttitle: localize('addTerminalSelection', 'Add Terminal Selection to Chat'),\n\tprecondition: ContextKeyExpr.and(ChatContextKeys.enabled, sharedWhenClause.terminalAvailable),\n\tmenu: [\n\t\t{\n\t\t\tid: MenuId.TerminalInstanceContext,\n\t\t\tgroup: TerminalContextMenuGroup.Chat,\n\t\t\torder: 1,\n\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.enabled, TerminalContextKeys.textSelected)\n\t\t},\n\t],\n\trun: async (activeInstance, _c, accessor) => {\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\n\t\tconst selection = activeInstance.selection;\n\t\tif (!selection) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatView = chatWidgetService.lastFocusedWidget ?? await chatWidgetService.revealWidget();\n\t\tif (!chatView) {\n\t\t\treturn;\n\t\t}\n\n\t\tchatView.attachmentModel.addContext({\n\t\t\tid: `terminal-selection-${Date.now()}`,\n\t\t\tkind: 'generic' as const,\n\t\t\tname: localize('terminalSelection', 'Terminal Selection'),\n\t\t\tfullName: localize('terminalSelection', 'Terminal Selection'),\n\t\t\tvalue: selection,\n\t\t\ticon: Codicon.terminal\n\t\t});\n\t\tchatView.focusInput();\n\t}\n});\n\n// #endregion Actions\n"]}