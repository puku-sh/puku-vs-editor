{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/suggest/browser/lspTerminalModelContentProvider.ts","vs/workbench/contrib/terminalContrib/suggest/browser/lspTerminalModelContentProvider.ts"],"names":[],"mappings":"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","file":"lspTerminalModelContentProvider.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { ITextModelContentProvider, ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { ICommandDetectionCapability, ITerminalCapabilityStore, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalShellType } from '../../../../../platform/terminal/common/terminal.js';\nimport { VSCODE_LSP_TERMINAL_PROMPT_TRACKER } from './lspTerminalUtil.js';\n\nexport interface ILspTerminalModelContentProvider extends ITextModelContentProvider {\n\tsetContent(content: string): void;\n\tdispose(): void;\n}\n\nexport class LspTerminalModelContentProvider extends Disposable implements ILspTerminalModelContentProvider, ITextModelContentProvider {\n\tstatic readonly scheme = Schemas.vscodeTerminal;\n\tprivate _commandDetection: ICommandDetectionCapability | undefined;\n\tprivate _capabilitiesStore: ITerminalCapabilityStore;\n\tprivate readonly _virtualTerminalDocumentUri: URI;\n\tprivate _shellType: TerminalShellType | undefined;\n\tprivate readonly _onCommandFinishedListener = this._register(new MutableDisposable());\n\n\tconstructor(\n\t\tcapabilityStore: ITerminalCapabilityStore,\n\t\tterminalId: number,\n\t\tvirtualTerminalDocument: URI,\n\t\tshellType: TerminalShellType | undefined,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(LspTerminalModelContentProvider.scheme, this));\n\t\tthis._capabilitiesStore = capabilityStore;\n\t\tthis._commandDetection = this._capabilitiesStore.get(TerminalCapability.CommandDetection);\n\t\tthis._registerTerminalCommandFinishedListener();\n\t\tthis._virtualTerminalDocumentUri = virtualTerminalDocument;\n\t\tthis._shellType = shellType;\n\t}\n\n\t// Listens to onDidChangeShellType event from `terminal.suggest.contribution.ts`\n\tshellTypeChanged(shellType: TerminalShellType | undefined): void {\n\t\tthis._shellType = shellType;\n\t}\n\n\t/**\n\t * Sets or updates content for a terminal virtual document.\n\t * This is when user has executed succesful command in terminal.\n\t * Transfer the content to virtual document, and relocate delimiter to get terminal prompt ready for next prompt.\n\t */\n\tsetContent(content: string): void {\n\t\tconst model = this._modelService.getModel(this._virtualTerminalDocumentUri);\n\t\tif (this._shellType) {\n\t\t\tif (model) {\n\t\t\t\tconst existingContent = model.getValue();\n\t\t\t\tif (existingContent === '') {\n\t\t\t\t\tmodel.setValue(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\t\t\t\t} else {\n\t\t\t\t\t// If we are appending to existing content, remove delimiter, attach new content, and re-add delimiter\n\t\t\t\t\tconst delimiterIndex = existingContent.lastIndexOf(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\t\t\t\t\tconst sanitizedExistingContent = delimiterIndex !== -1 ?\n\t\t\t\t\t\texistingContent.substring(0, delimiterIndex) :\n\t\t\t\t\t\texistingContent;\n\n\t\t\t\t\tconst newContent = sanitizedExistingContent + '\\n' + content + '\\n' + VSCODE_LSP_TERMINAL_PROMPT_TRACKER;\n\t\t\t\t\tmodel.setValue(newContent);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Real-time conversion of terminal input to virtual document happens here.\n\t * This is when user types in terminal, and we want to track the input.\n\t * We want to track the input and update the virtual document.\n\t * Note: This is for non-executed command.\n\t*/\n\ttrackPromptInputToVirtualFile(content: string): void {\n\t\tthis._commandDetection = this._capabilitiesStore.get(TerminalCapability.CommandDetection);\n\t\tconst model = this._modelService.getModel(this._virtualTerminalDocumentUri);\n\t\tif (this._shellType) {\n\t\t\tif (model) {\n\t\t\t\tconst existingContent = model.getValue();\n\t\t\t\tconst delimiterIndex = existingContent.lastIndexOf(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\n\t\t\t\t// Keep content only up to delimiter\n\t\t\t\tconst sanitizedExistingContent = delimiterIndex !== -1 ?\n\t\t\t\t\texistingContent.substring(0, delimiterIndex) :\n\t\t\t\t\texistingContent;\n\n\t\t\t\t// Combine base content with new content\n\t\t\t\tconst newContent = sanitizedExistingContent + VSCODE_LSP_TERMINAL_PROMPT_TRACKER + content;\n\n\t\t\t\tmodel.setValue(newContent);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerTerminalCommandFinishedListener(): void {\n\t\tconst attachListener = () => {\n\t\t\tif (this._onCommandFinishedListener.value) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Inconsistent repro: Covering case where commandDetection is available but onCommandFinished becomes available later\n\t\t\tif (this._commandDetection && this._commandDetection.onCommandFinished) {\n\t\t\t\tthis._onCommandFinishedListener.value = this._register(this._commandDetection.onCommandFinished((e) => {\n\t\t\t\t\tif (e.exitCode === 0 && this._shellType) {\n\t\t\t\t\t\tthis.setContent(e.command);\n\t\t\t\t\t}\n\n\t\t\t\t}));\n\t\t\t}\n\t\t};\n\t\tattachListener();\n\n\t\t// Listen to onDidAddCapabilityType because command detection is not available until later\n\t\tthis._register(this._capabilitiesStore.onDidAddCommandDetectionCapability(e => {\n\t\t\tthis._commandDetection = e;\n\t\t\tattachListener();\n\t\t}));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst languageId = this._languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\n\t\tconst languageSelection = languageId ?\n\t\t\tthis._languageService.createById(languageId) :\n\t\t\tthis._languageService.createById('plaintext');\n\n\t\treturn this._modelService.createModel('', languageSelection, resource, false);\n\t}\n\n}\n\n/**\n * Creates a terminal language virtual URI.\n */\n// TODO: Make this [OS generic](https://github.com/microsoft/vscode/issues/249477)\nexport function createTerminalLanguageVirtualUri(terminalId: number, languageExtension: string): URI {\n\treturn URI.from({\n\t\tscheme: Schemas.vscodeTerminal,\n\t\tpath: `/terminal${terminalId}.${languageExtension}`,\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { ITextModelContentProvider, ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { ICommandDetectionCapability, ITerminalCapabilityStore, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalShellType } from '../../../../../platform/terminal/common/terminal.js';\nimport { VSCODE_LSP_TERMINAL_PROMPT_TRACKER } from './lspTerminalUtil.js';\n\nexport interface ILspTerminalModelContentProvider extends ITextModelContentProvider {\n\tsetContent(content: string): void;\n\tdispose(): void;\n}\n\nexport class LspTerminalModelContentProvider extends Disposable implements ILspTerminalModelContentProvider, ITextModelContentProvider {\n\tstatic readonly scheme = Schemas.vscodeTerminal;\n\tprivate _commandDetection: ICommandDetectionCapability | undefined;\n\tprivate _capabilitiesStore: ITerminalCapabilityStore;\n\tprivate readonly _virtualTerminalDocumentUri: URI;\n\tprivate _shellType: TerminalShellType | undefined;\n\tprivate readonly _onCommandFinishedListener = this._register(new MutableDisposable());\n\n\tconstructor(\n\t\tcapabilityStore: ITerminalCapabilityStore,\n\t\tterminalId: number,\n\t\tvirtualTerminalDocument: URI,\n\t\tshellType: TerminalShellType | undefined,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(LspTerminalModelContentProvider.scheme, this));\n\t\tthis._capabilitiesStore = capabilityStore;\n\t\tthis._commandDetection = this._capabilitiesStore.get(TerminalCapability.CommandDetection);\n\t\tthis._registerTerminalCommandFinishedListener();\n\t\tthis._virtualTerminalDocumentUri = virtualTerminalDocument;\n\t\tthis._shellType = shellType;\n\t}\n\n\t// Listens to onDidChangeShellType event from `terminal.suggest.contribution.ts`\n\tshellTypeChanged(shellType: TerminalShellType | undefined): void {\n\t\tthis._shellType = shellType;\n\t}\n\n\t/**\n\t * Sets or updates content for a terminal virtual document.\n\t * This is when user has executed succesful command in terminal.\n\t * Transfer the content to virtual document, and relocate delimiter to get terminal prompt ready for next prompt.\n\t */\n\tsetContent(content: string): void {\n\t\tconst model = this._modelService.getModel(this._virtualTerminalDocumentUri);\n\t\tif (this._shellType) {\n\t\t\tif (model) {\n\t\t\t\tconst existingContent = model.getValue();\n\t\t\t\tif (existingContent === '') {\n\t\t\t\t\tmodel.setValue(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\t\t\t\t} else {\n\t\t\t\t\t// If we are appending to existing content, remove delimiter, attach new content, and re-add delimiter\n\t\t\t\t\tconst delimiterIndex = existingContent.lastIndexOf(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\t\t\t\t\tconst sanitizedExistingContent = delimiterIndex !== -1 ?\n\t\t\t\t\t\texistingContent.substring(0, delimiterIndex) :\n\t\t\t\t\t\texistingContent;\n\n\t\t\t\t\tconst newContent = sanitizedExistingContent + '\\n' + content + '\\n' + VSCODE_LSP_TERMINAL_PROMPT_TRACKER;\n\t\t\t\t\tmodel.setValue(newContent);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Real-time conversion of terminal input to virtual document happens here.\n\t * This is when user types in terminal, and we want to track the input.\n\t * We want to track the input and update the virtual document.\n\t * Note: This is for non-executed command.\n\t*/\n\ttrackPromptInputToVirtualFile(content: string): void {\n\t\tthis._commandDetection = this._capabilitiesStore.get(TerminalCapability.CommandDetection);\n\t\tconst model = this._modelService.getModel(this._virtualTerminalDocumentUri);\n\t\tif (this._shellType) {\n\t\t\tif (model) {\n\t\t\t\tconst existingContent = model.getValue();\n\t\t\t\tconst delimiterIndex = existingContent.lastIndexOf(VSCODE_LSP_TERMINAL_PROMPT_TRACKER);\n\n\t\t\t\t// Keep content only up to delimiter\n\t\t\t\tconst sanitizedExistingContent = delimiterIndex !== -1 ?\n\t\t\t\t\texistingContent.substring(0, delimiterIndex) :\n\t\t\t\t\texistingContent;\n\n\t\t\t\t// Combine base content with new content\n\t\t\t\tconst newContent = sanitizedExistingContent + VSCODE_LSP_TERMINAL_PROMPT_TRACKER + content;\n\n\t\t\t\tmodel.setValue(newContent);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerTerminalCommandFinishedListener(): void {\n\t\tconst attachListener = () => {\n\t\t\tif (this._onCommandFinishedListener.value) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Inconsistent repro: Covering case where commandDetection is available but onCommandFinished becomes available later\n\t\t\tif (this._commandDetection && this._commandDetection.onCommandFinished) {\n\t\t\t\tthis._onCommandFinishedListener.value = this._register(this._commandDetection.onCommandFinished((e) => {\n\t\t\t\t\tif (e.exitCode === 0 && this._shellType) {\n\t\t\t\t\t\tthis.setContent(e.command);\n\t\t\t\t\t}\n\n\t\t\t\t}));\n\t\t\t}\n\t\t};\n\t\tattachListener();\n\n\t\t// Listen to onDidAddCapabilityType because command detection is not available until later\n\t\tthis._register(this._capabilitiesStore.onDidAddCommandDetectionCapability(e => {\n\t\t\tthis._commandDetection = e;\n\t\t\tattachListener();\n\t\t}));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst languageId = this._languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\n\t\tconst languageSelection = languageId ?\n\t\t\tthis._languageService.createById(languageId) :\n\t\t\tthis._languageService.createById('plaintext');\n\n\t\treturn this._modelService.createModel('', languageSelection, resource, false);\n\t}\n\n}\n\n/**\n * Creates a terminal language virtual URI.\n */\n// TODO: Make this [OS generic](https://github.com/microsoft/vscode/issues/249477)\nexport function createTerminalLanguageVirtualUri(terminalId: number, languageExtension: string): URI {\n\treturn URI.from({\n\t\tscheme: Schemas.vscodeTerminal,\n\t\tpath: `/terminal${terminalId}.${languageExtension}`,\n\t});\n}\n"]}