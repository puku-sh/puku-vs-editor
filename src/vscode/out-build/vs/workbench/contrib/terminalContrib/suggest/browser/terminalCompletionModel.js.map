{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/suggest/browser/terminalCompletionModel.ts","vs/workbench/contrib/terminalContrib/suggest/browser/terminalCompletionModel.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,SAAS,EAAE,MAAM,wCAAwC,CAAC;AACnE,OAAO,EAAE,KAAK,EAAE,MAAM,uCAAuC,CAAC;AAC9D,OAAO,EAAE,QAAQ,EAAE,MAAM,qCAAqC,CAAC;AAC/D,OAAO,EAAE,qBAAqB,EAAoB,MAAM,+DAA+D,CAAC;AACxH,OAAO,EAAE,0BAA0B,EAA+B,MAAM,6BAA6B,CAAC;AAEtG,MAAM,OAAO,uBAAwB,SAAQ,qBAA6C;IACzF,YACC,KAA+B,EAC/B,WAAwB;QAExB,KAAK,CAAC,KAAK,EAAE,WAAW,EAAE,oBAAoB,CAAC,CAAC;IACjD,CAAC;CACD;AAED,MAAM,oBAAoB,GAAG,CAAC,kBAA0B,EAAE,CAAyB,EAAE,CAAyB,EAAE,EAAE;IACjH,yCAAyC;IACzC,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,2BAA2B,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QAC7H,OAAO,CAAC,CAAC,CAAC;IACX,CAAC;IACD,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,2BAA2B,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QAC7H,OAAO,CAAC,CAAC;IACV,CAAC;IAED,oBAAoB;IACpB,IAAI,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACpC,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;QACjB,OAAO,KAAK,CAAC;IACd,CAAC;IAED,2BAA2B;IAC3B,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,gBAAgB,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QAClH,OAAO,CAAC,CAAC,CAAC;IACX,CAAC;IACD,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,gBAAgB,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QAClH,OAAO,CAAC,CAAC;IACV,CAAC;IAED,IAAI,CAAC,CAAC,kBAAkB,KAAK,CAAC,CAAC,kBAAkB,EAAE,CAAC;QACnD,mEAAmE;QACnE,4DAA4D;QAC5D,OAAO,CAAC,CAAC,kBAAkB,GAAG,CAAC,CAAC,kBAAkB,CAAC;IACpD,CAAC;IAED,2CAA2C;IAC3C,MAAM,KAAK,GAAG,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;IAC/C,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,IAAI,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,IAAI,EAAE,CAAC;QAC9H,gFAAgF;QAChF,IAAI,CAAC,CAAC,sBAAsB,KAAK,CAAC,CAAC,sBAAsB,EAAE,CAAC;YAC3D,OAAO,CAAC,CAAC,sBAAsB,CAAC,aAAa,CAAC,CAAC,CAAC,sBAAsB,EAAE,SAAS,EAAE,EAAE,iBAAiB,EAAE,IAAI,EAAE,CAAC,CAAC;QACjH,CAAC;QACD,2EAA2E;QAC3E,KAAK,GAAG,CAAC,CAAC,sBAAsB,CAAC,MAAM,GAAG,CAAC,CAAC,sBAAsB,CAAC,MAAM,CAAC;QAC1E,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;YACjB,OAAO,KAAK,CAAC;QACd,CAAC;QACD,wGAAwG;QACxG,KAAK,GAAG,YAAY,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;QAChE,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;YACjB,OAAO,KAAK,CAAC;QACd,CAAC;QACD,0CAA0C;QAC1C,KAAK,GAAG,CAAC,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC;QAClD,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;YACjB,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC;IAED,kDAAkD;IAClD,yFAAyF;IACzF,oCAAoC;IACpC,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,IAAI,WAAW,CAAC,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC;QACpK,MAAM,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC;QAC5F,MAAM,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC;QAC5F,MAAM,eAAe,GAAG,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,QAAQ,CAAC;QACjE,MAAM,eAAe,GAAG,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,QAAQ,CAAC;QAEjE,IAAI,eAAe,IAAI,CAAC,eAAe,EAAE,CAAC;YACzC,OAAO,CAAC,CAAC,CAAC;QACX,CAAC;QACD,IAAI,eAAe,IAAI,CAAC,eAAe,EAAE,CAAC;YACzC,OAAO,CAAC,CAAC;QACV,CAAC;IACF,CAAC;IAED,oCAAoC;IACpC,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,EAAE,CAAC;QACxH,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YACxI,KAAK,GAAG,CAAC,CAAC;QACX,CAAC;aAAM,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YAC5E,KAAK,GAAG,CAAC,CAAC,CAAC;QACZ,CAAC;aAAM,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YAC5E,KAAK,GAAG,CAAC,CAAC;QACX,CAAC;QACD,KAAK,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrJ,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;YACjB,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC;IAED,wEAAwE;IACxE,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,EAAE,CAAC;QACxH,IAAI,CAAC,CAAC,sBAAsB,IAAI,CAAC,CAAC,sBAAsB,EAAE,CAAC;YAC1D,cAAc;YACd,qDAAqD;YACrD,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,sBAAsB,EAAE,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,sBAAsB,EAAE,GAAG,CAAC,CAAC;YACpF,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;gBACjB,OAAO,KAAK,CAAC;YACd,CAAC;YAED,uCAAuC;YACvC,IAAI,CAAC,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,EAAE,CAAC;gBACnE,OAAO,CAAC,CAAC,CAAC,CAAC,mDAAmD;YAC/D,CAAC;YACD,IAAI,CAAC,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,EAAE,CAAC;gBACnE,OAAO,CAAC,CAAC,CAAC,mDAAmD;YAC9D,CAAC;QACF,CAAC;IACF,CAAC;IAED,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QAC7C,eAAe;QACf,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,KAAK,CAAC,EAAE,CAAC;YAChP,OAAO,CAAC,CAAC,CAAC,CAAC,wCAAwC;QACpD,CAAC;QACD,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,KAAK,CAAC,EAAE,CAAC;YAChP,OAAO,CAAC,CAAC,CAAC,wCAAwC;QACnD,CAAC;QACD,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,EAAE,CAAC;YAC5H,OAAO,CAAC,CAAC,CAAC,CAAC,2CAA2C;QACvD,CAAC;QACD,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,KAAK,0BAA0B,CAAC,QAAQ,EAAE,CAAC;YAC5H,OAAO,CAAC,CAAC,CAAC,2CAA2C;QACtD,CAAC;QACD,IAAI,cAAc,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;YAC7E,OAAO,CAAC,CAAC,CAAC,6BAA6B;QACxC,CAAC;QACD,IAAI,cAAc,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;YAC7E,OAAO,CAAC,CAAC,CAAC,CAAC,6BAA6B;QACzC,CAAC;IACF,CAAC;IAED,wFAAwF;IACxF,iBAAiB;IACjB,OAAO,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,iBAAiB,EAAE,IAAI,EAAE,CAAC,CAAC;AACrF,CAAC,CAAC;AAEF,MAAM,cAAc,GAAG,CAAC,IAA4C,EAAE,EAAE,CACvE,IAAI,KAAK,0BAA0B,CAAC,IAAI;IACxC,IAAI,KAAK,0BAA0B,CAAC,MAAM;IAC1C,IAAI,KAAK,0BAA0B,CAAC,gBAAgB;IACpD,IAAI,KAAK,0BAA0B,CAAC,kBAAkB,CAAC;AAExD,iEAAiE;AACjE,oGAAoG;AACpG,oCAAoC;AACpC,MAAM,aAAa,GAAG,IAAI,GAAG,CAAiB,SAAS,CAAC,CAAC,CAAC;IACzD,6FAA6F;IAC7F,iEAAiE;IACjE,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,cAAc;IACd,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;IACb,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;IACf,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;IACd,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;IACf,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,EAAE,UAAU;IAC1B,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,EAAE,aAAa;IAC7B,gGAAgG;IAChG,8CAA8C;CAC9C,CAAC,CAAC,CAAC;IACH,OAAO;IACP,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,UAAU;IACV,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;IACd,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;IACd,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;IACd,cAAc;IACd,CAAC,IAAI,EAAE,IAAI,CAAC;IACZ,CAAC,MAAM,EAAE,IAAI,CAAC;IACd,CAAC,KAAK,EAAE,IAAI,CAAC;IACb,CAAC,MAAM,EAAE,IAAI,CAAC;IACd,CAAC,KAAK,EAAE,IAAI,CAAC,EAAE,UAAU;IACzB,CAAC,KAAK,EAAE,IAAI,CAAC,EAAE,aAAa;IAC5B,sBAAsB;IACtB,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,SAAS;IACvB,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,OAAO;CACrB,CAAC,CAAC;AAEH,SAAS,YAAY,CAAC,GAAW;IAChC,OAAO,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACpC,CAAC","file":"terminalCompletionModel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { count } from '../../../../../base/common/strings.js';\nimport { isString } from '../../../../../base/common/types.js';\nimport { SimpleCompletionModel, type LineContext } from '../../../../services/suggest/browser/simpleCompletionModel.js';\nimport { TerminalCompletionItemKind, type TerminalCompletionItem } from './terminalCompletionItem.js';\n\nexport class TerminalCompletionModel extends SimpleCompletionModel<TerminalCompletionItem> {\n\tconstructor(\n\t\titems: TerminalCompletionItem[],\n\t\tlineContext: LineContext\n\t) {\n\t\tsuper(items, lineContext, compareCompletionsFn);\n\t}\n}\n\nconst compareCompletionsFn = (leadingLineContent: string, a: TerminalCompletionItem, b: TerminalCompletionItem) => {\n\t// Boost always on top inline completions\n\tif (a.completion.kind === TerminalCompletionItemKind.InlineSuggestionAlwaysOnTop && a.completion.kind !== b.completion.kind) {\n\t\treturn -1;\n\t}\n\tif (b.completion.kind === TerminalCompletionItemKind.InlineSuggestionAlwaysOnTop && a.completion.kind !== b.completion.kind) {\n\t\treturn 1;\n\t}\n\n\t// Sort by the score\n\tlet score = b.score[0] - a.score[0];\n\tif (score !== 0) {\n\t\treturn score;\n\t}\n\n\t// Boost inline completions\n\tif (a.completion.kind === TerminalCompletionItemKind.InlineSuggestion && a.completion.kind !== b.completion.kind) {\n\t\treturn -1;\n\t}\n\tif (b.completion.kind === TerminalCompletionItemKind.InlineSuggestion && a.completion.kind !== b.completion.kind) {\n\t\treturn 1;\n\t}\n\n\tif (a.punctuationPenalty !== b.punctuationPenalty) {\n\t\t// Sort by underscore penalty (eg. `__init__/` should be penalized)\n\t\t// Sort by punctuation penalty (eg. `;` should be penalized)\n\t\treturn a.punctuationPenalty - b.punctuationPenalty;\n\t}\n\n\t// Sort files of the same name by extension\n\tconst isArg = leadingLineContent.includes(' ');\n\tif (!isArg && a.completion.kind === TerminalCompletionItemKind.File && b.completion.kind === TerminalCompletionItemKind.File) {\n\t\t// If the file name excluding the extension is different, just do a regular sort\n\t\tif (a.labelLowExcludeFileExt !== b.labelLowExcludeFileExt) {\n\t\t\treturn a.labelLowExcludeFileExt.localeCompare(b.labelLowExcludeFileExt, undefined, { ignorePunctuation: true });\n\t\t}\n\t\t// Then by label length ascending (excluding file extension if it's a file)\n\t\tscore = a.labelLowExcludeFileExt.length - b.labelLowExcludeFileExt.length;\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t\t// If they're files at the start of the command line, boost extensions depending on the operating system\n\t\tscore = fileExtScore(b.fileExtLow) - fileExtScore(a.fileExtLow);\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t\t// Then by file extension length ascending\n\t\tscore = a.fileExtLow.length - b.fileExtLow.length;\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t}\n\n\t// Boost main and master branches for git commands\n\t// HACK: Currently this just matches leading line content, it should eventually check the\n\t//       completion type is a branch\n\tif (a.completion.kind === TerminalCompletionItemKind.Argument && b.completion.kind === TerminalCompletionItemKind.Argument && /^\\s*git\\b/.test(leadingLineContent)) {\n\t\tconst aLabel = isString(a.completion.label) ? a.completion.label : a.completion.label.label;\n\t\tconst bLabel = isString(b.completion.label) ? b.completion.label : b.completion.label.label;\n\t\tconst aIsMainOrMaster = aLabel === 'main' || aLabel === 'master';\n\t\tconst bIsMainOrMaster = bLabel === 'main' || bLabel === 'master';\n\n\t\tif (aIsMainOrMaster && !bIsMainOrMaster) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (bIsMainOrMaster && !aIsMainOrMaster) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\t// Sort by more detailed completions\n\tif (a.completion.kind === TerminalCompletionItemKind.Method && b.completion.kind === TerminalCompletionItemKind.Method) {\n\t\tif (!isString(a.completion.label) && a.completion.label.description && !isString(b.completion.label) && b.completion.label.description) {\n\t\t\tscore = 0;\n\t\t} else if (!isString(a.completion.label) && a.completion.label.description) {\n\t\t\tscore = -2;\n\t\t} else if (!isString(b.completion.label) && b.completion.label.description) {\n\t\t\tscore = 2;\n\t\t}\n\t\tscore += (b.completion.detail ? 1 : 0) + (b.completion.documentation ? 2 : 0) - (a.completion.detail ? 1 : 0) - (a.completion.documentation ? 2 : 0);\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t}\n\n\t// Sort by folder depth (eg. `vscode/` should come before `vscode-.../`)\n\tif (a.completion.kind === TerminalCompletionItemKind.Folder && b.completion.kind === TerminalCompletionItemKind.Folder) {\n\t\tif (a.labelLowNormalizedPath && b.labelLowNormalizedPath) {\n\t\t\t// Directories\n\t\t\t// Count depth of path (number of / or \\ occurrences)\n\t\t\tscore = count(a.labelLowNormalizedPath, '/') - count(b.labelLowNormalizedPath, '/');\n\t\t\tif (score !== 0) {\n\t\t\t\treturn score;\n\t\t\t}\n\n\t\t\t// Ensure shorter prefixes appear first\n\t\t\tif (b.labelLowNormalizedPath.startsWith(a.labelLowNormalizedPath)) {\n\t\t\t\treturn -1; // `a` is a prefix of `b`, so `a` should come first\n\t\t\t}\n\t\t\tif (a.labelLowNormalizedPath.startsWith(b.labelLowNormalizedPath)) {\n\t\t\t\treturn 1; // `b` is a prefix of `a`, so `b` should come first\n\t\t\t}\n\t\t}\n\t}\n\n\tif (a.completion.kind !== b.completion.kind) {\n\t\t// Sort by kind\n\t\tif ((a.completion.kind === TerminalCompletionItemKind.Method || a.completion.kind === TerminalCompletionItemKind.Alias) && (b.completion.kind !== TerminalCompletionItemKind.Method && b.completion.kind !== TerminalCompletionItemKind.Alias)) {\n\t\t\treturn -1; // Methods and aliases should come first\n\t\t}\n\t\tif ((b.completion.kind === TerminalCompletionItemKind.Method || b.completion.kind === TerminalCompletionItemKind.Alias) && (a.completion.kind !== TerminalCompletionItemKind.Method && a.completion.kind !== TerminalCompletionItemKind.Alias)) {\n\t\t\treturn 1; // Methods and aliases should come first\n\t\t}\n\t\tif (a.completion.kind === TerminalCompletionItemKind.Argument && b.completion.kind !== TerminalCompletionItemKind.Argument) {\n\t\t\treturn -1; // Arguments should come before other kinds\n\t\t}\n\t\tif (b.completion.kind === TerminalCompletionItemKind.Argument && a.completion.kind !== TerminalCompletionItemKind.Argument) {\n\t\t\treturn 1; // Arguments should come before other kinds\n\t\t}\n\t\tif (isResourceKind(a.completion.kind) && !isResourceKind(b.completion.kind)) {\n\t\t\treturn 1; // Resources should come last\n\t\t}\n\t\tif (isResourceKind(b.completion.kind) && !isResourceKind(a.completion.kind)) {\n\t\t\treturn -1; // Resources should come last\n\t\t}\n\t}\n\n\t// Sort alphabetically, ignoring punctuation causes dot files to be mixed in rather than\n\t// all at the top\n\treturn a.labelLow.localeCompare(b.labelLow, undefined, { ignorePunctuation: true });\n};\n\nconst isResourceKind = (kind: TerminalCompletionItemKind | undefined) =>\n\tkind === TerminalCompletionItemKind.File ||\n\tkind === TerminalCompletionItemKind.Folder ||\n\tkind === TerminalCompletionItemKind.SymbolicLinkFile ||\n\tkind === TerminalCompletionItemKind.SymbolicLinkFolder;\n\n// TODO: This should be based on the process OS, not the local OS\n// File score boosts for specific file extensions on Windows. This only applies when the file is the\n// _first_ part of the command line.\nconst fileExtScores = new Map<string, number>(isWindows ? [\n\t// Windows - .ps1 > .exe > .bat > .cmd. This is the command precedence when running the files\n\t//           without an extension, tested manually in pwsh v7.4.4\n\t['ps1', 0.09],\n\t['exe', 0.08],\n\t['bat', 0.07],\n\t['cmd', 0.07],\n\t['msi', 0.06],\n\t['com', 0.06],\n\t// Non-Windows\n\t['sh', -0.05],\n\t['bash', -0.05],\n\t['zsh', -0.05],\n\t['fish', -0.05],\n\t['csh', -0.06], // C shell\n\t['ksh', -0.06], // Korn shell\n\t// Scripting language files are excluded here as the standard behavior on Windows will just open\n\t// the file in a text editor, not run the file\n] : [\n\t// Pwsh\n\t['ps1', 0.05],\n\t// Windows\n\t['bat', -0.05],\n\t['cmd', -0.05],\n\t['exe', -0.05],\n\t// Non-Windows\n\t['sh', 0.05],\n\t['bash', 0.05],\n\t['zsh', 0.05],\n\t['fish', 0.05],\n\t['csh', 0.04], // C shell\n\t['ksh', 0.04], // Korn shell\n\t// Scripting languages\n\t['py', 0.05], // Python\n\t['pl', 0.05], // Perl\n]);\n\nfunction fileExtScore(ext: string): number {\n\treturn fileExtScores.get(ext) || 0;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { count } from '../../../../../base/common/strings.js';\nimport { isString } from '../../../../../base/common/types.js';\nimport { SimpleCompletionModel, type LineContext } from '../../../../services/suggest/browser/simpleCompletionModel.js';\nimport { TerminalCompletionItemKind, type TerminalCompletionItem } from './terminalCompletionItem.js';\n\nexport class TerminalCompletionModel extends SimpleCompletionModel<TerminalCompletionItem> {\n\tconstructor(\n\t\titems: TerminalCompletionItem[],\n\t\tlineContext: LineContext\n\t) {\n\t\tsuper(items, lineContext, compareCompletionsFn);\n\t}\n}\n\nconst compareCompletionsFn = (leadingLineContent: string, a: TerminalCompletionItem, b: TerminalCompletionItem) => {\n\t// Boost always on top inline completions\n\tif (a.completion.kind === TerminalCompletionItemKind.InlineSuggestionAlwaysOnTop && a.completion.kind !== b.completion.kind) {\n\t\treturn -1;\n\t}\n\tif (b.completion.kind === TerminalCompletionItemKind.InlineSuggestionAlwaysOnTop && a.completion.kind !== b.completion.kind) {\n\t\treturn 1;\n\t}\n\n\t// Sort by the score\n\tlet score = b.score[0] - a.score[0];\n\tif (score !== 0) {\n\t\treturn score;\n\t}\n\n\t// Boost inline completions\n\tif (a.completion.kind === TerminalCompletionItemKind.InlineSuggestion && a.completion.kind !== b.completion.kind) {\n\t\treturn -1;\n\t}\n\tif (b.completion.kind === TerminalCompletionItemKind.InlineSuggestion && a.completion.kind !== b.completion.kind) {\n\t\treturn 1;\n\t}\n\n\tif (a.punctuationPenalty !== b.punctuationPenalty) {\n\t\t// Sort by underscore penalty (eg. `__init__/` should be penalized)\n\t\t// Sort by punctuation penalty (eg. `;` should be penalized)\n\t\treturn a.punctuationPenalty - b.punctuationPenalty;\n\t}\n\n\t// Sort files of the same name by extension\n\tconst isArg = leadingLineContent.includes(' ');\n\tif (!isArg && a.completion.kind === TerminalCompletionItemKind.File && b.completion.kind === TerminalCompletionItemKind.File) {\n\t\t// If the file name excluding the extension is different, just do a regular sort\n\t\tif (a.labelLowExcludeFileExt !== b.labelLowExcludeFileExt) {\n\t\t\treturn a.labelLowExcludeFileExt.localeCompare(b.labelLowExcludeFileExt, undefined, { ignorePunctuation: true });\n\t\t}\n\t\t// Then by label length ascending (excluding file extension if it's a file)\n\t\tscore = a.labelLowExcludeFileExt.length - b.labelLowExcludeFileExt.length;\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t\t// If they're files at the start of the command line, boost extensions depending on the operating system\n\t\tscore = fileExtScore(b.fileExtLow) - fileExtScore(a.fileExtLow);\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t\t// Then by file extension length ascending\n\t\tscore = a.fileExtLow.length - b.fileExtLow.length;\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t}\n\n\t// Boost main and master branches for git commands\n\t// HACK: Currently this just matches leading line content, it should eventually check the\n\t//       completion type is a branch\n\tif (a.completion.kind === TerminalCompletionItemKind.Argument && b.completion.kind === TerminalCompletionItemKind.Argument && /^\\s*git\\b/.test(leadingLineContent)) {\n\t\tconst aLabel = isString(a.completion.label) ? a.completion.label : a.completion.label.label;\n\t\tconst bLabel = isString(b.completion.label) ? b.completion.label : b.completion.label.label;\n\t\tconst aIsMainOrMaster = aLabel === 'main' || aLabel === 'master';\n\t\tconst bIsMainOrMaster = bLabel === 'main' || bLabel === 'master';\n\n\t\tif (aIsMainOrMaster && !bIsMainOrMaster) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (bIsMainOrMaster && !aIsMainOrMaster) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\t// Sort by more detailed completions\n\tif (a.completion.kind === TerminalCompletionItemKind.Method && b.completion.kind === TerminalCompletionItemKind.Method) {\n\t\tif (!isString(a.completion.label) && a.completion.label.description && !isString(b.completion.label) && b.completion.label.description) {\n\t\t\tscore = 0;\n\t\t} else if (!isString(a.completion.label) && a.completion.label.description) {\n\t\t\tscore = -2;\n\t\t} else if (!isString(b.completion.label) && b.completion.label.description) {\n\t\t\tscore = 2;\n\t\t}\n\t\tscore += (b.completion.detail ? 1 : 0) + (b.completion.documentation ? 2 : 0) - (a.completion.detail ? 1 : 0) - (a.completion.documentation ? 2 : 0);\n\t\tif (score !== 0) {\n\t\t\treturn score;\n\t\t}\n\t}\n\n\t// Sort by folder depth (eg. `vscode/` should come before `vscode-.../`)\n\tif (a.completion.kind === TerminalCompletionItemKind.Folder && b.completion.kind === TerminalCompletionItemKind.Folder) {\n\t\tif (a.labelLowNormalizedPath && b.labelLowNormalizedPath) {\n\t\t\t// Directories\n\t\t\t// Count depth of path (number of / or \\ occurrences)\n\t\t\tscore = count(a.labelLowNormalizedPath, '/') - count(b.labelLowNormalizedPath, '/');\n\t\t\tif (score !== 0) {\n\t\t\t\treturn score;\n\t\t\t}\n\n\t\t\t// Ensure shorter prefixes appear first\n\t\t\tif (b.labelLowNormalizedPath.startsWith(a.labelLowNormalizedPath)) {\n\t\t\t\treturn -1; // `a` is a prefix of `b`, so `a` should come first\n\t\t\t}\n\t\t\tif (a.labelLowNormalizedPath.startsWith(b.labelLowNormalizedPath)) {\n\t\t\t\treturn 1; // `b` is a prefix of `a`, so `b` should come first\n\t\t\t}\n\t\t}\n\t}\n\n\tif (a.completion.kind !== b.completion.kind) {\n\t\t// Sort by kind\n\t\tif ((a.completion.kind === TerminalCompletionItemKind.Method || a.completion.kind === TerminalCompletionItemKind.Alias) && (b.completion.kind !== TerminalCompletionItemKind.Method && b.completion.kind !== TerminalCompletionItemKind.Alias)) {\n\t\t\treturn -1; // Methods and aliases should come first\n\t\t}\n\t\tif ((b.completion.kind === TerminalCompletionItemKind.Method || b.completion.kind === TerminalCompletionItemKind.Alias) && (a.completion.kind !== TerminalCompletionItemKind.Method && a.completion.kind !== TerminalCompletionItemKind.Alias)) {\n\t\t\treturn 1; // Methods and aliases should come first\n\t\t}\n\t\tif (a.completion.kind === TerminalCompletionItemKind.Argument && b.completion.kind !== TerminalCompletionItemKind.Argument) {\n\t\t\treturn -1; // Arguments should come before other kinds\n\t\t}\n\t\tif (b.completion.kind === TerminalCompletionItemKind.Argument && a.completion.kind !== TerminalCompletionItemKind.Argument) {\n\t\t\treturn 1; // Arguments should come before other kinds\n\t\t}\n\t\tif (isResourceKind(a.completion.kind) && !isResourceKind(b.completion.kind)) {\n\t\t\treturn 1; // Resources should come last\n\t\t}\n\t\tif (isResourceKind(b.completion.kind) && !isResourceKind(a.completion.kind)) {\n\t\t\treturn -1; // Resources should come last\n\t\t}\n\t}\n\n\t// Sort alphabetically, ignoring punctuation causes dot files to be mixed in rather than\n\t// all at the top\n\treturn a.labelLow.localeCompare(b.labelLow, undefined, { ignorePunctuation: true });\n};\n\nconst isResourceKind = (kind: TerminalCompletionItemKind | undefined) =>\n\tkind === TerminalCompletionItemKind.File ||\n\tkind === TerminalCompletionItemKind.Folder ||\n\tkind === TerminalCompletionItemKind.SymbolicLinkFile ||\n\tkind === TerminalCompletionItemKind.SymbolicLinkFolder;\n\n// TODO: This should be based on the process OS, not the local OS\n// File score boosts for specific file extensions on Windows. This only applies when the file is the\n// _first_ part of the command line.\nconst fileExtScores = new Map<string, number>(isWindows ? [\n\t// Windows - .ps1 > .exe > .bat > .cmd. This is the command precedence when running the files\n\t//           without an extension, tested manually in pwsh v7.4.4\n\t['ps1', 0.09],\n\t['exe', 0.08],\n\t['bat', 0.07],\n\t['cmd', 0.07],\n\t['msi', 0.06],\n\t['com', 0.06],\n\t// Non-Windows\n\t['sh', -0.05],\n\t['bash', -0.05],\n\t['zsh', -0.05],\n\t['fish', -0.05],\n\t['csh', -0.06], // C shell\n\t['ksh', -0.06], // Korn shell\n\t// Scripting language files are excluded here as the standard behavior on Windows will just open\n\t// the file in a text editor, not run the file\n] : [\n\t// Pwsh\n\t['ps1', 0.05],\n\t// Windows\n\t['bat', -0.05],\n\t['cmd', -0.05],\n\t['exe', -0.05],\n\t// Non-Windows\n\t['sh', 0.05],\n\t['bash', 0.05],\n\t['zsh', 0.05],\n\t['fish', 0.05],\n\t['csh', 0.04], // C shell\n\t['ksh', 0.04], // Korn shell\n\t// Scripting languages\n\t['py', 0.05], // Python\n\t['pl', 0.05], // Perl\n]);\n\nfunction fileExtScore(ext: string): number {\n\treturn fileExtScores.get(ext) || 0;\n}\n"]}