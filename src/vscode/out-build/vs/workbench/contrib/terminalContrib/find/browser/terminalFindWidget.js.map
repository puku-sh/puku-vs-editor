{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/terminalContrib/find/browser/terminalFindWidget.ts","vs/workbench/contrib/terminalContrib/find/browser/terminalFindWidget.ts"],"names":[],"mappings":"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","file":"terminalFindWidget.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { SimpleFindWidget } from '../../../codeEditor/browser/find/simpleFindWidget.js';\nimport { IContextMenuService, IContextViewService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IContextKeyService, IContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IDetachedTerminalInstance, ITerminalInstance, IXtermTerminal, XtermTerminalConstants } from '../../../terminal/browser/terminal.js';\nimport { TerminalContextKeys } from '../../../terminal/common/terminalContextKey.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport type { ISearchOptions } from '@xterm/addon-search';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { TerminalFindCommandId } from '../common/terminal.find.js';\nimport { TerminalClipboardContribution } from '../../clipboard/browser/terminal.clipboard.contribution.js';\nimport { StandardMouseEvent } from '../../../../../base/browser/mouseEvent.js';\nimport { createTextInputActions } from '../../../../browser/actions/textInputActions.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\n\nconst TERMINAL_FIND_WIDGET_INITIAL_WIDTH = 419;\n\nexport class TerminalFindWidget extends SimpleFindWidget {\n\tprivate _findInputFocused: IContextKey<boolean>;\n\tprivate _findWidgetFocused: IContextKey<boolean>;\n\tprivate _findWidgetVisible: IContextKey<boolean>;\n\n\tprivate _overrideCopyOnSelectionDisposable: IDisposable | undefined;\n\n\tconstructor(\n\t\tprivate _instance: ITerminalInstance | IDetachedTerminalInstance,\n\t\t@IClipboardService clipboardService: IClipboardService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IContextViewService contextViewService: IContextViewService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\tsuper({\n\t\t\tshowCommonFindToggles: true,\n\t\t\tcheckImeCompletionState: true,\n\t\t\tshowResultCount: true,\n\t\t\tinitialWidth: TERMINAL_FIND_WIDGET_INITIAL_WIDTH,\n\t\t\tenableSash: true,\n\t\t\tappendCaseSensitiveActionId: TerminalFindCommandId.ToggleFindCaseSensitive,\n\t\t\tappendRegexActionId: TerminalFindCommandId.ToggleFindRegex,\n\t\t\tappendWholeWordsActionId: TerminalFindCommandId.ToggleFindWholeWord,\n\t\t\tpreviousMatchActionId: TerminalFindCommandId.FindPrevious,\n\t\t\tnextMatchActionId: TerminalFindCommandId.FindNext,\n\t\t\tcloseWidgetActionId: TerminalFindCommandId.FindHide,\n\t\t\ttype: 'Terminal',\n\t\t\tmatchesLimit: XtermTerminalConstants.SearchHighlightLimit\n\t\t}, contextViewService, contextKeyService, hoverService, keybindingService);\n\n\t\tthis._register(this.state.onFindReplaceStateChange(() => {\n\t\t\tthis.show();\n\t\t}));\n\t\tthis._findInputFocused = TerminalContextKeys.findInputFocus.bindTo(contextKeyService);\n\t\tthis._findWidgetFocused = TerminalContextKeys.findFocus.bindTo(contextKeyService);\n\t\tthis._findWidgetVisible = TerminalContextKeys.findVisible.bindTo(contextKeyService);\n\t\tconst innerDom = this.getDomNode().firstChild;\n\t\tif (innerDom) {\n\t\t\tthis._register(dom.addDisposableListener(innerDom, 'mousedown', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}));\n\t\t\tthis._register(dom.addDisposableListener(innerDom, 'contextmenu', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}));\n\t\t}\n\t\tconst findInputDomNode = this.getFindInputDomNode();\n\t\tthis._register(dom.addDisposableListener(findInputDomNode, 'contextmenu', (event) => {\n\t\t\tconst targetWindow = dom.getWindow(findInputDomNode);\n\t\t\tconst standardEvent = new StandardMouseEvent(targetWindow, event);\n\t\t\tconst actions = createTextInputActions(clipboardService, logService);\n\n\t\t\tcontextMenuService.showContextMenu({\n\t\t\t\tgetAnchor: () => standardEvent,\n\t\t\t\tgetActions: () => actions,\n\t\t\t\tgetActionsContext: () => event.target,\n\t\t\t});\n\t\t\tevent.stopPropagation();\n\t\t}));\n\t\tthis._register(themeService.onDidColorThemeChange(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis.find(true, true);\n\t\t\t}\n\t\t}));\n\t\tthis._register(configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectsConfiguration('workbench.colorCustomizations') && this.isVisible()) {\n\t\t\t\tthis.find(true, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis.updateResultCount();\n\t}\n\n\tfind(previous: boolean, update?: boolean) {\n\t\tconst xterm = this._instance.xterm;\n\t\tif (!xterm) {\n\t\t\treturn;\n\t\t}\n\t\tif (previous) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue(), incremental: update });\n\t\t} else {\n\t\t\tthis._findNextWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() });\n\t\t}\n\t}\n\n\toverride reveal(): void {\n\t\tconst initialInput = this._instance.hasSelection() && !this._instance.selection!.includes('\\n') ? this._instance.selection : undefined;\n\t\tconst inputValue = initialInput ?? this.inputValue;\n\t\tconst xterm = this._instance.xterm;\n\t\tif (xterm && inputValue && inputValue !== '') {\n\t\t\t// trigger highlight all matches\n\t\t\tthis._findPreviousWithEvent(xterm, inputValue, { incremental: true, regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() }).then(foundMatch => {\n\t\t\t\tthis.updateButtons(foundMatch);\n\t\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\t});\n\t\t}\n\t\tthis.updateButtons(false);\n\n\t\tsuper.reveal(inputValue);\n\t\tthis._findWidgetVisible.set(true);\n\t}\n\n\toverride show() {\n\t\tconst initialInput = this._instance.hasSelection() && !this._instance.selection!.includes('\\n') ? this._instance.selection : undefined;\n\t\tsuper.show(initialInput);\n\t\tthis._findWidgetVisible.set(true);\n\t}\n\n\toverride hide() {\n\t\tsuper.hide();\n\t\tthis._findWidgetVisible.reset();\n\t\tthis._instance.focus(true);\n\t\tthis._instance.xterm?.clearSearchDecorations();\n\t}\n\n\tprotected async _getResultCount(): Promise<{ resultIndex: number; resultCount: number } | undefined> {\n\t\treturn this._instance.xterm?.findResult;\n\t}\n\n\tprotected _onInputChanged() {\n\t\t// Ignore input changes for now\n\t\tconst xterm = this._instance.xterm;\n\t\tif (xterm) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue(), incremental: true }).then(foundMatch => {\n\t\t\t\tthis.updateButtons(foundMatch);\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected _onFocusTrackerFocus() {\n\t\tif (TerminalClipboardContribution.get(this._instance)?.overrideCopyOnSelection) {\n\t\t\tthis._overrideCopyOnSelectionDisposable = TerminalClipboardContribution.get(this._instance)?.overrideCopyOnSelection(false);\n\t\t}\n\t\tthis._findWidgetFocused.set(true);\n\t}\n\n\tprotected _onFocusTrackerBlur() {\n\t\tthis._overrideCopyOnSelectionDisposable?.dispose();\n\t\tthis._instance.xterm?.clearActiveSearchDecoration();\n\t\tthis._findWidgetFocused.reset();\n\t}\n\n\tprotected _onFindInputFocusTrackerFocus() {\n\t\tthis._findInputFocused.set(true);\n\t}\n\n\tprotected _onFindInputFocusTrackerBlur() {\n\t\tthis._findInputFocused.reset();\n\t}\n\n\tfindFirst() {\n\t\tconst instance = this._instance;\n\t\tif (instance.hasSelection()) {\n\t\t\tinstance.clearSelection();\n\t\t}\n\t\tconst xterm = instance.xterm;\n\t\tif (xterm) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() });\n\t\t}\n\t}\n\n\tprivate async _findNextWithEvent(xterm: IXtermTerminal, term: string, options: ISearchOptions): Promise<boolean> {\n\t\treturn xterm.findNext(term, options).then(foundMatch => {\n\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\treturn foundMatch;\n\t\t});\n\t}\n\n\tprivate async _findPreviousWithEvent(xterm: IXtermTerminal, term: string, options: ISearchOptions): Promise<boolean> {\n\t\treturn xterm.findPrevious(term, options).then(foundMatch => {\n\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\treturn foundMatch;\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { SimpleFindWidget } from '../../../codeEditor/browser/find/simpleFindWidget.js';\nimport { IContextMenuService, IContextViewService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IContextKeyService, IContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IDetachedTerminalInstance, ITerminalInstance, IXtermTerminal, XtermTerminalConstants } from '../../../terminal/browser/terminal.js';\nimport { TerminalContextKeys } from '../../../terminal/common/terminalContextKey.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport type { ISearchOptions } from '@xterm/addon-search';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { TerminalFindCommandId } from '../common/terminal.find.js';\nimport { TerminalClipboardContribution } from '../../clipboard/browser/terminal.clipboard.contribution.js';\nimport { StandardMouseEvent } from '../../../../../base/browser/mouseEvent.js';\nimport { createTextInputActions } from '../../../../browser/actions/textInputActions.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\n\nconst TERMINAL_FIND_WIDGET_INITIAL_WIDTH = 419;\n\nexport class TerminalFindWidget extends SimpleFindWidget {\n\tprivate _findInputFocused: IContextKey<boolean>;\n\tprivate _findWidgetFocused: IContextKey<boolean>;\n\tprivate _findWidgetVisible: IContextKey<boolean>;\n\n\tprivate _overrideCopyOnSelectionDisposable: IDisposable | undefined;\n\n\tconstructor(\n\t\tprivate _instance: ITerminalInstance | IDetachedTerminalInstance,\n\t\t@IClipboardService clipboardService: IClipboardService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IContextViewService contextViewService: IContextViewService,\n\t\t@IHoverService hoverService: IHoverService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\tsuper({\n\t\t\tshowCommonFindToggles: true,\n\t\t\tcheckImeCompletionState: true,\n\t\t\tshowResultCount: true,\n\t\t\tinitialWidth: TERMINAL_FIND_WIDGET_INITIAL_WIDTH,\n\t\t\tenableSash: true,\n\t\t\tappendCaseSensitiveActionId: TerminalFindCommandId.ToggleFindCaseSensitive,\n\t\t\tappendRegexActionId: TerminalFindCommandId.ToggleFindRegex,\n\t\t\tappendWholeWordsActionId: TerminalFindCommandId.ToggleFindWholeWord,\n\t\t\tpreviousMatchActionId: TerminalFindCommandId.FindPrevious,\n\t\t\tnextMatchActionId: TerminalFindCommandId.FindNext,\n\t\t\tcloseWidgetActionId: TerminalFindCommandId.FindHide,\n\t\t\ttype: 'Terminal',\n\t\t\tmatchesLimit: XtermTerminalConstants.SearchHighlightLimit\n\t\t}, contextViewService, contextKeyService, hoverService, keybindingService);\n\n\t\tthis._register(this.state.onFindReplaceStateChange(() => {\n\t\t\tthis.show();\n\t\t}));\n\t\tthis._findInputFocused = TerminalContextKeys.findInputFocus.bindTo(contextKeyService);\n\t\tthis._findWidgetFocused = TerminalContextKeys.findFocus.bindTo(contextKeyService);\n\t\tthis._findWidgetVisible = TerminalContextKeys.findVisible.bindTo(contextKeyService);\n\t\tconst innerDom = this.getDomNode().firstChild;\n\t\tif (innerDom) {\n\t\t\tthis._register(dom.addDisposableListener(innerDom, 'mousedown', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}));\n\t\t\tthis._register(dom.addDisposableListener(innerDom, 'contextmenu', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}));\n\t\t}\n\t\tconst findInputDomNode = this.getFindInputDomNode();\n\t\tthis._register(dom.addDisposableListener(findInputDomNode, 'contextmenu', (event) => {\n\t\t\tconst targetWindow = dom.getWindow(findInputDomNode);\n\t\t\tconst standardEvent = new StandardMouseEvent(targetWindow, event);\n\t\t\tconst actions = createTextInputActions(clipboardService, logService);\n\n\t\t\tcontextMenuService.showContextMenu({\n\t\t\t\tgetAnchor: () => standardEvent,\n\t\t\t\tgetActions: () => actions,\n\t\t\t\tgetActionsContext: () => event.target,\n\t\t\t});\n\t\t\tevent.stopPropagation();\n\t\t}));\n\t\tthis._register(themeService.onDidColorThemeChange(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis.find(true, true);\n\t\t\t}\n\t\t}));\n\t\tthis._register(configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectsConfiguration('workbench.colorCustomizations') && this.isVisible()) {\n\t\t\t\tthis.find(true, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis.updateResultCount();\n\t}\n\n\tfind(previous: boolean, update?: boolean) {\n\t\tconst xterm = this._instance.xterm;\n\t\tif (!xterm) {\n\t\t\treturn;\n\t\t}\n\t\tif (previous) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue(), incremental: update });\n\t\t} else {\n\t\t\tthis._findNextWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() });\n\t\t}\n\t}\n\n\toverride reveal(): void {\n\t\tconst initialInput = this._instance.hasSelection() && !this._instance.selection!.includes('\\n') ? this._instance.selection : undefined;\n\t\tconst inputValue = initialInput ?? this.inputValue;\n\t\tconst xterm = this._instance.xterm;\n\t\tif (xterm && inputValue && inputValue !== '') {\n\t\t\t// trigger highlight all matches\n\t\t\tthis._findPreviousWithEvent(xterm, inputValue, { incremental: true, regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() }).then(foundMatch => {\n\t\t\t\tthis.updateButtons(foundMatch);\n\t\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\t});\n\t\t}\n\t\tthis.updateButtons(false);\n\n\t\tsuper.reveal(inputValue);\n\t\tthis._findWidgetVisible.set(true);\n\t}\n\n\toverride show() {\n\t\tconst initialInput = this._instance.hasSelection() && !this._instance.selection!.includes('\\n') ? this._instance.selection : undefined;\n\t\tsuper.show(initialInput);\n\t\tthis._findWidgetVisible.set(true);\n\t}\n\n\toverride hide() {\n\t\tsuper.hide();\n\t\tthis._findWidgetVisible.reset();\n\t\tthis._instance.focus(true);\n\t\tthis._instance.xterm?.clearSearchDecorations();\n\t}\n\n\tprotected async _getResultCount(): Promise<{ resultIndex: number; resultCount: number } | undefined> {\n\t\treturn this._instance.xterm?.findResult;\n\t}\n\n\tprotected _onInputChanged() {\n\t\t// Ignore input changes for now\n\t\tconst xterm = this._instance.xterm;\n\t\tif (xterm) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue(), incremental: true }).then(foundMatch => {\n\t\t\t\tthis.updateButtons(foundMatch);\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected _onFocusTrackerFocus() {\n\t\tif (TerminalClipboardContribution.get(this._instance)?.overrideCopyOnSelection) {\n\t\t\tthis._overrideCopyOnSelectionDisposable = TerminalClipboardContribution.get(this._instance)?.overrideCopyOnSelection(false);\n\t\t}\n\t\tthis._findWidgetFocused.set(true);\n\t}\n\n\tprotected _onFocusTrackerBlur() {\n\t\tthis._overrideCopyOnSelectionDisposable?.dispose();\n\t\tthis._instance.xterm?.clearActiveSearchDecoration();\n\t\tthis._findWidgetFocused.reset();\n\t}\n\n\tprotected _onFindInputFocusTrackerFocus() {\n\t\tthis._findInputFocused.set(true);\n\t}\n\n\tprotected _onFindInputFocusTrackerBlur() {\n\t\tthis._findInputFocused.reset();\n\t}\n\n\tfindFirst() {\n\t\tconst instance = this._instance;\n\t\tif (instance.hasSelection()) {\n\t\t\tinstance.clearSelection();\n\t\t}\n\t\tconst xterm = instance.xterm;\n\t\tif (xterm) {\n\t\t\tthis._findPreviousWithEvent(xterm, this.inputValue, { regex: this._getRegexValue(), wholeWord: this._getWholeWordValue(), caseSensitive: this._getCaseSensitiveValue() });\n\t\t}\n\t}\n\n\tprivate async _findNextWithEvent(xterm: IXtermTerminal, term: string, options: ISearchOptions): Promise<boolean> {\n\t\treturn xterm.findNext(term, options).then(foundMatch => {\n\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\treturn foundMatch;\n\t\t});\n\t}\n\n\tprivate async _findPreviousWithEvent(xterm: IXtermTerminal, term: string, options: ISearchOptions): Promise<boolean> {\n\t\treturn xterm.findPrevious(term, options).then(foundMatch => {\n\t\t\tthis._register(Event.once(xterm.onDidChangeSelection)(() => xterm.clearActiveSearchDecoration()));\n\t\t\treturn foundMatch;\n\t\t});\n\t}\n}\n"]}