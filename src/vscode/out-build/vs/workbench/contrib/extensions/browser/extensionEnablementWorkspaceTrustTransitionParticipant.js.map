{"version":3,"sources":["vs/workbench/contrib/extensions/browser/extensionEnablementWorkspaceTrustTransitionParticipant.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,QAAQ,EAAE,MAAM,oBAAoB,CAAC;AAC9C,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAClE,OAAO,EAAE,gCAAgC,EAAE,gCAAgC,EAAwC,MAAM,yDAAyD,CAAC;AAEnL,OAAO,EAAE,4BAA4B,EAAE,MAAM,4DAA4D,CAAC;AAC1G,OAAO,EAAE,oCAAoC,EAAE,MAAM,qEAAqE,CAAC;AAC3H,OAAO,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACtF,OAAO,EAAE,YAAY,EAAE,MAAM,wCAAwC,CAAC;AAE/D,IAAM,sDAAsD,GAA5D,MAAM,sDAAuD,SAAQ,UAAU;IACrF,YACoB,gBAAmC,EACxC,WAAyB,EACT,kBAAgD,EACxC,0BAAgE,EACpE,+BAAiE,EACjE,+BAAiE;QAEnG,KAAK,EAAE,CAAC;QAER,IAAI,+BAA+B,CAAC,uBAAuB,EAAE,EAAE,CAAC;YAC/D,yEAAyE;YACzE,0EAA0E;YAC1E,0EAA0E;YAC1E,iEAAiE;YACjE,+BAA+B,CAAC,yBAAyB,CAAC,IAAI,CAAC,GAAG,EAAE;gBACnE,MAAM,mCAAmC,GAAG,IAAI;oBAC/C,KAAK,CAAC,WAAW,CAAC,OAAgB;wBACjC,IAAI,OAAO,EAAE,CAAC;4BACb,uBAAuB;4BACvB,MAAM,0BAA0B,CAAC,oDAAoD,EAAE,CAAC;wBACzF,CAAC;6BAAM,CAAC;4BACP,uBAAuB;4BACvB,IAAI,kBAAkB,CAAC,eAAe,EAAE,CAAC;gCACxC,WAAW,CAAC,MAAM,EAAE,CAAC;4BACtB,CAAC;iCAAM,CAAC;gCACP,MAAM,OAAO,GAAG,MAAM,gBAAgB,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAA6B,EAAE,IAA0B,CAAC,CAAC,CAAC;gCAC/H,MAAM,0BAA0B,CAAC,oDAAoD,EAAE,CAAC;gCACxF,IAAI,OAAO,EAAE,CAAC;oCACb,gBAAgB,CAAC,mBAAmB,EAAE,CAAC;gCACxC,CAAC;4BACF,CAAC;wBACF,CAAC;oBACF,CAAC;iBACD,CAAC;gBAEF,0DAA0D;gBAC1D,IAAI,CAAC,SAAS,CAAC,+BAA+B,CAAC,sCAAsC,CAAC,mCAAmC,CAAC,CAAC,CAAC;YAC7H,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;CACD,CAAA;AA1CY,sDAAsD;IAEhE,WAAA,iBAAiB,CAAA;IACjB,WAAA,YAAY,CAAA;IACZ,WAAA,4BAA4B,CAAA;IAC5B,WAAA,oCAAoC,CAAA;IACpC,WAAA,gCAAgC,CAAA;IAChC,WAAA,gCAAgC,CAAA;GAPtB,sDAAsD,CA0ClE","file":"extensionEnablementWorkspaceTrustTransitionParticipant.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IWorkspaceTrustEnablementService, IWorkspaceTrustManagementService, IWorkspaceTrustTransitionParticipant } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { IWorkbenchExtensionEnablementService } from '../../../services/extensionManagement/common/extensionManagement.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\nimport { IHostService } from '../../../services/host/browser/host.js';\n\nexport class ExtensionEnablementWorkspaceTrustTransitionParticipant extends Disposable implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IHostService hostService: IHostService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t\t@IWorkbenchExtensionEnablementService extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IWorkspaceTrustEnablementService workspaceTrustEnablementService: IWorkspaceTrustEnablementService,\n\t\t@IWorkspaceTrustManagementService workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t) {\n\t\tsuper();\n\n\t\tif (workspaceTrustEnablementService.isWorkspaceTrustEnabled()) {\n\t\t\t// The extension enablement participant will be registered only after the\n\t\t\t// workspace trust state has been initialized. There is no need to execute\n\t\t\t// the participant as part of the initialization process, as the workspace\n\t\t\t// trust state is initialized before starting the extension host.\n\t\t\tworkspaceTrustManagementService.workspaceTrustInitialized.then(() => {\n\t\t\t\tconst workspaceTrustTransitionParticipant = new class implements IWorkspaceTrustTransitionParticipant {\n\t\t\t\t\tasync participate(trusted: boolean): Promise<void> {\n\t\t\t\t\t\tif (trusted) {\n\t\t\t\t\t\t\t// Untrusted -> Trusted\n\t\t\t\t\t\t\tawait extensionEnablementService.updateExtensionsEnablementsWhenWorkspaceTrustChanges();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Trusted -> Untrusted\n\t\t\t\t\t\t\tif (environmentService.remoteAuthority) {\n\t\t\t\t\t\t\t\thostService.reload();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst stopped = await extensionService.stopExtensionHosts(localize('restartExtensionHost.reason', \"Changing workspace trust\"));\n\t\t\t\t\t\t\t\tawait extensionEnablementService.updateExtensionsEnablementsWhenWorkspaceTrustChanges();\n\t\t\t\t\t\t\t\tif (stopped) {\n\t\t\t\t\t\t\t\t\textensionService.startExtensionHosts();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Execute BEFORE the workspace trust transition completes\n\t\t\t\tthis._register(workspaceTrustManagementService.addWorkspaceTrustTransitionParticipant(workspaceTrustTransitionParticipant));\n\t\t\t});\n\t\t}\n\t}\n}\n"]}