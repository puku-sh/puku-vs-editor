{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/extensions/browser/extensionRecommendationsService.ts","vs/workbench/contrib/extensions/browser/extensionRecommendationsService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,MAAM,sCAAsC,CAAC;AAChF,OAAO,EAAE,2BAA2B,EAAE,wBAAwB,EAA4C,MAAM,wEAAwE,CAAC;AACzL,OAAO,EAAmE,uCAAuC,EAAE,MAAM,+EAA+E,CAAC;AACzM,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAE,iBAAiB,EAAE,MAAM,oDAAoD,CAAC;AACvF,OAAO,EAAE,OAAO,EAAE,MAAM,mCAAmC,CAAC;AAC5D,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AAClE,OAAO,EAAE,mBAAmB,EAAE,MAAM,wDAAwD,CAAC;AAC7F,OAAO,EAAkB,iBAAiB,EAAE,MAAM,iDAAiD,CAAC;AACpG,OAAO,EAAE,uBAAuB,EAAE,MAAM,8BAA8B,CAAC;AACvE,OAAO,EAAE,wBAAwB,EAAE,MAAM,+BAA+B,CAAC;AACzE,OAAO,EAAE,wBAAwB,EAAE,MAAM,+BAA+B,CAAC;AACzE,OAAO,EAAE,qBAAqB,EAAE,MAAM,4BAA4B,CAAC;AACnE,OAAO,EAAE,uBAAuB,EAAE,MAAM,8BAA8B,CAAC;AAEvE,OAAO,EAAE,0BAA0B,EAAE,MAAM,iCAAiC,CAAC;AAC7E,OAAO,EAAE,2CAA2C,EAAE,MAAM,kFAAkF,CAAC;AAC/I,OAAO,EAAqB,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAC9E,OAAO,EAAE,GAAG,EAAE,MAAM,gCAAgC,CAAC;AACrD,OAAO,EAAE,kBAAkB,EAAE,MAAM,yBAAyB,CAAC;AAC7D,OAAO,EAAE,2BAA2B,EAAE,MAAM,yBAAyB,CAAC;AACtE,OAAO,EAAE,iBAAiB,EAAE,MAAM,4EAA4E,CAAC;AAC/G,OAAO,EAAE,qBAAqB,EAAE,MAAM,4BAA4B,CAAC;AACnE,OAAO,EAAE,+BAA+B,EAAE,MAAM,+DAA+D,CAAC;AAChH,OAAO,EAAE,8BAA8B,EAAE,MAAM,oDAAoD,CAAC;AACpG,OAAO,EAAE,QAAQ,EAAE,MAAM,kCAAkC,CAAC;AAErD,IAAM,+BAA+B,GAArC,MAAM,+BAAgC,SAAQ,UAAU;IAoB9D,YACwB,oBAA2C,EAC/C,gBAAoD,EAC7C,cAAyD,EAChE,gBAAoD,EAClD,kBAAwD,EAChD,0BAAwE,EAC5D,yCAAmG,EAC/F,0CAAwG,EACxH,0BAAwE,EACpE,8BAAgF,EACjF,6BAA8E;QAE9G,KAAK,EAAE,CAAC;QAX4B,qBAAgB,GAAhB,gBAAgB,CAAmB;QAC5B,mBAAc,GAAd,cAAc,CAA0B;QAC/C,qBAAgB,GAAhB,gBAAgB,CAAmB;QACjC,uBAAkB,GAAlB,kBAAkB,CAAqB;QAC/B,+BAA0B,GAA1B,0BAA0B,CAA6B;QAC3C,8CAAyC,GAAzC,yCAAyC,CAAyC;QAC9E,+CAA0C,GAA1C,0CAA0C,CAA6C;QACvG,+BAA0B,GAA1B,0BAA0B,CAA6B;QACnD,mCAA8B,GAA9B,8BAA8B,CAAiC;QAChE,kCAA6B,GAA7B,6BAA6B,CAAgC;QAdvG,gCAA2B,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAQ,CAAC,CAAC;QACjE,+BAA0B,GAAG,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC;QAiB5E,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAC9G,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAC9G,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC;QAClH,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAC,CAAC;QAC5G,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,CAAC;QACxG,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC,CAAC;QAClG,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAC,CAAC;QAC5G,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAExG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,CAAC;YACvB,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;YACrB,IAAI,CAAC,iBAAiB,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC;YAC3C,OAAO;QACR,CAAC;QAED,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;QAE/B,aAAa;QACb,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAEzC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,0BAA0B,CAAC,sBAAsB,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7G,CAAC;IAEO,KAAK,CAAC,QAAQ;QACrB,IAAI,CAAC;YACJ,MAAM,OAAO,CAAC,UAAU,CAAC;gBACxB,IAAI,CAAC,8BAA8B,CAAC,mBAAmB,EAAE;gBACzD,IAAI,CAAC,6BAA6B,CAAC,0BAA0B,EAAE;gBAC/D,IAAI,CAAC,gBAAgB,CAAC,IAAI,iCAAyB;aAAC,CAAC,CAAC;QACxD,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC,CAAC,YAAY,CAAC,CAAC;QAEhC,+BAA+B;QAC/B,MAAM,OAAO,CAAC,GAAG,CAAC;YACjB,IAAI,CAAC,wBAAwB,CAAC,QAAQ,EAAE;YACxC,IAAI,CAAC,0BAA0B,CAAC,QAAQ,EAAE;YAC1C,IAAI,CAAC,wBAAwB,CAAC,QAAQ,EAAE;YACxC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,EAAE;YACrC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,EAAE;YACvC,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE;YAClC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,EAAE;SACrC,CAAC,CAAC;QAEH,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,wBAAwB,CAAC,0BAA0B,EAAE,IAAI,CAAC,0BAA0B,CAAC,0BAA0B,EAAE,IAAI,CAAC,yCAAyC,CAAC,iCAAiC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,2BAA2B,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAEjR,IAAI,CAAC,8BAA8B,EAAE,CAAC;IACvC,CAAC;IAEO,SAAS;QAChB,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,sBAAsB,CAAC;IAC3F,CAAC;IAEO,KAAK,CAAC,gCAAgC;QAC7C,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,0BAA0B,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;IAC1G,CAAC;IAED,+BAA+B;QAC9B,wCAAwC;QACxC,IAAI,CAAC,gCAAgC,EAAE,CAAC;QAExC,MAAM,MAAM,GAAsF,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEtH,MAAM,kBAAkB,GAAG;YAC1B,GAAG,IAAI,CAAC,0BAA0B,CAAC,eAAe;YAClD,GAAG,IAAI,CAAC,uBAAuB,CAAC,eAAe;YAC/C,GAAG,IAAI,CAAC,wBAAwB,CAAC,eAAe;YAChD,GAAG,IAAI,CAAC,wBAAwB,CAAC,eAAe;YAChD,GAAG,IAAI,CAAC,qBAAqB,CAAC,eAAe;YAC7C,GAAG,IAAI,CAAC,uBAAuB,CAAC,eAAe;YAC/C,GAAG,IAAI,CAAC,kBAAkB,CAAC,eAAe;SAC1C,CAAC;QAEF,KAAK,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,kBAAkB,EAAE,CAAC;YACxD,IAAI,QAAQ,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,iCAAiC,CAAC,SAAS,CAAC,EAAE,CAAC;gBAC9E,MAAM,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,GAAG,MAAM,CAAC;YAC1C,CAAC;QACF,CAAC;QAED,OAAO,MAAM,CAAC;IACf,CAAC;IAED,KAAK,CAAC,6BAA6B;QAClC,MAAM,IAAI,CAAC,0BAA0B,CAAC,QAAQ,EAAE,CAAC;QACjD,OAAO;YACN,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,0BAA0B,CAAC,wBAAwB,CAAC;YACxF,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,0BAA0B,CAAC,oBAAoB,CAAC;SACjF,CAAC;IACH,CAAC;IAED,KAAK,CAAC,uBAAuB;QAC5B,MAAM,IAAI,CAAC,iBAAiB,CAAC;QAC7B,MAAM,IAAI,CAAC,gCAAgC,EAAE,CAAC;QAE9C,MAAM,eAAe,GAAG;YACvB,GAAG,IAAI,CAAC,0BAA0B,CAAC,oBAAoB;YACvD,GAAG,IAAI,CAAC,uBAAuB,CAAC,oBAAoB;YACpD,GAAG,IAAI,CAAC,kBAAkB,CAAC,eAAe;SAC1C,CAAC;QAEF,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;QAC1D,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACxC,OAAO,YAAY,CAAC;IACrB,CAAC;IAED,KAAK,CAAC,2BAA2B;QAChC,MAAM,IAAI,CAAC,gCAAgC,EAAE,CAAC;QAE9C,MAAM,eAAe,GAAG;YACvB,GAAG,IAAI,CAAC,wBAAwB,CAAC,wBAAwB;YACzD,GAAG,IAAI,CAAC,0BAA0B,CAAC,wBAAwB;YAC3D,GAAG,IAAI,CAAC,uBAAuB,CAAC,wBAAwB;SACxD,CAAC;QAEF,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;QAC1D,OAAO,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACxC,OAAO,YAAY,CAAC;IACrB,CAAC;IAED,wBAAwB;QACvB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,qBAAqB,CAAC,eAAe,CAAC,CAAC;IACxE,CAAC;IAED,0BAA0B;QACzB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,uBAAuB,CAAC,eAAe,CAAC,CAAC;IAC1E,CAAC;IAED,wBAAwB;QACvB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,qBAAqB,CAAC,eAAe,CAAC,CAAC;IACxE,CAAC;IAED,KAAK,CAAC,2BAA2B;QAChC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,CAAC;YACvB,OAAO,EAAE,CAAC;QACX,CAAC;QACD,MAAM,IAAI,CAAC,wBAAwB,CAAC,QAAQ,EAAE,CAAC;QAC/C,MAAM,MAAM,GAAwB,EAAE,CAAC;QACvC,KAAK,MAAM,EAAE,SAAS,EAAE,IAAI,IAAI,CAAC,wBAAwB,CAAC,eAAe,EAAE,CAAC;YAC3E,IAAI,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC;gBACzB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,IAAI,CAAC,iCAAiC,CAAC,SAAS,CAAC,EAAE,CAAC;oBACpG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;gBACtC,CAAC;YACF,CAAC;iBAAM,CAAC;gBACP,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACxB,CAAC;QACF,CAAC;QACD,OAAO,MAAM,CAAC;IACf,CAAC;IAED,KAAK,CAAC,0BAA0B,CAAC,GAAY;QAC5C,MAAM,IAAI,CAAC,uBAAuB,CAAC,QAAQ,EAAE,CAAC;QAC9C,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,GAAG,CAAC;YACvF,CAAC,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,uBAAuB,CAAC,wBAAwB,EAAE,MAAM,EAAE,IAAI,CAAC,uBAAuB,CAAC,oBAAoB,EAAE,CAAC;QACnI,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC;IAC3F,CAAC;IAED,2BAA2B;QAC1B,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,wBAAwB,CAAC,eAAe,CAAC,CAAC;IAC3E,CAAC;IAEO,sBAAsB,CAAC,OAA0C;QACxE,KAAK,MAAM,CAAC,IAAI,OAAO,EAAE,CAAC;YACzB,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,SAAS,qCAA6B,EAAE,CAAC;gBAClF,MAAM,kBAAkB,GAAG,IAAI,CAAC,+BAA+B,EAAE,IAAI,EAAE,CAAC;gBACxE,MAAM,oBAAoB,GAAG,kBAAkB,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC;gBACtF,IAAI,oBAAoB,EAAE,CAAC;oBAC1B;;;;;;;;sBAQE;oBACF,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,0CAA0C,EAAE,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,aAAa,EAAE,oBAAoB,EAAE,oBAAoB,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACjK,CAAC;YACF,CAAC;QACF,CAAC;IACF,CAAC;IAEO,cAAc,CAAC,eAAuD;QAC7E,MAAM,YAAY,GAAa,EAAE,CAAC;QAClC,KAAK,MAAM,EAAE,SAAS,EAAE,IAAI,eAAe,EAAE,CAAC;YAC7C,IAAI,QAAQ,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,iCAAiC,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,EAAE,CAAC;gBACjI,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,CAAC;YAC5C,CAAC;QACF,CAAC;QACD,OAAO,YAAY,CAAC;IACrB,CAAC;IAEO,iCAAiC,CAAC,WAAmB;QAC5D,OAAO,CAAC,IAAI,CAAC,yCAAyC,CAAC,sBAAsB,CAAC,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC;IACnH,CAAC;IAEO,KAAK,CAAC,8BAA8B;QAC3C,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,0BAA0B,CAAC,UAAU,EAAE,CAAC;QACrE,MAAM,sBAAsB,GAAG;YAC9B,GAAG,IAAI,CAAC,wBAAwB,CAAC,eAAe;YAChD,GAAG,IAAI,CAAC,0BAA0B,CAAC,wBAAwB,CAAC,MAAM,CACjE,cAAc,CAAC,EAAE,CAAC,CAAC,cAAc,CAAC,gBAAgB,IAAI,cAAc,CAAC,gBAAgB,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,iBAAiB,CAAC,KAAK,CAAC,UAAU,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;SAC3K;aACC,GAAG,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC;aACjC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,iCAAiC,CAAC,SAAS,CAAC,CAAC,CAAC;QAEjG,IAAI,sBAAsB,CAAC,MAAM,EAAE,CAAC;YACnC,MAAM,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;YACrC,MAAM,IAAI,CAAC,0CAA0C,CAAC,8BAA8B,CAAC,sBAAsB,CAAC,CAAC;QAC9G,CAAC;IACF,CAAC;IAEO,UAAU,CAAI,CAAuB;QAC5C,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC/C,OAAO,CAAC,CAAC;IACV,CAAC;CACD,CAAA;AAxPY,+BAA+B;IAqBzC,WAAA,qBAAqB,CAAA;IACrB,WAAA,iBAAiB,CAAA;IACjB,WAAA,wBAAwB,CAAA;IACxB,WAAA,iBAAiB,CAAA;IACjB,WAAA,mBAAmB,CAAA;IACnB,WAAA,2BAA2B,CAAA;IAC3B,WAAA,uCAAuC,CAAA;IACvC,WAAA,2CAA2C,CAAA;IAC3C,WAAA,2BAA2B,CAAA;IAC3B,WAAA,+BAA+B,CAAA;IAC/B,YAAA,8BAA8B,CAAA;GA/BpB,+BAA+B,CAwP3C","file":"extensionRecommendationsService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IExtensionManagementService, IExtensionGalleryService, InstallOperation, InstallExtensionResult } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { IExtensionRecommendationsService, ExtensionRecommendationReason, IExtensionIgnoredRecommendationsService } from '../../../services/extensionRecommendations/common/extensionRecommendations.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { shuffle } from '../../../../base/common/arrays.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { LifecyclePhase, ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ExeBasedRecommendations } from './exeBasedRecommendations.js';\nimport { WorkspaceRecommendations } from './workspaceRecommendations.js';\nimport { FileBasedRecommendations } from './fileBasedRecommendations.js';\nimport { KeymapRecommendations } from './keymapRecommendations.js';\nimport { LanguageRecommendations } from './languageRecommendations.js';\nimport { ExtensionRecommendation } from './extensionRecommendations.js';\nimport { ConfigBasedRecommendations } from './configBasedRecommendations.js';\nimport { IExtensionRecommendationNotificationService } from '../../../../platform/extensionRecommendations/common/extensionRecommendations.js';\nimport { CancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { WebRecommendations } from './webRecommendations.js';\nimport { IExtensionsWorkbenchService } from '../common/extensions.js';\nimport { areSameExtensions } from '../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { RemoteRecommendations } from './remoteRecommendations.js';\nimport { IRemoteExtensionsScannerService } from '../../../../platform/remote/common/remoteExtensionsScanner.js';\nimport { IUserDataInitializationService } from '../../../services/userData/browser/userDataInit.js';\nimport { isString } from '../../../../base/common/types.js';\n\nexport class ExtensionRecommendationsService extends Disposable implements IExtensionRecommendationsService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\t// Recommendations\n\tprivate readonly fileBasedRecommendations: FileBasedRecommendations;\n\tprivate readonly workspaceRecommendations: WorkspaceRecommendations;\n\tprivate readonly configBasedRecommendations: ConfigBasedRecommendations;\n\tprivate readonly exeBasedRecommendations: ExeBasedRecommendations;\n\tprivate readonly keymapRecommendations: KeymapRecommendations;\n\tprivate readonly webRecommendations: WebRecommendations;\n\tprivate readonly languageRecommendations: LanguageRecommendations;\n\tprivate readonly remoteRecommendations: RemoteRecommendations;\n\n\tpublic readonly activationPromise: Promise<void>;\n\tprivate sessionSeed: number;\n\n\tprivate _onDidChangeRecommendations = this._register(new Emitter<void>());\n\treadonly onDidChangeRecommendations = this._onDidChangeRecommendations.event;\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IExtensionManagementService private readonly extensionManagementService: IExtensionManagementService,\n\t\t@IExtensionIgnoredRecommendationsService private readonly extensionRecommendationsManagementService: IExtensionIgnoredRecommendationsService,\n\t\t@IExtensionRecommendationNotificationService private readonly extensionRecommendationNotificationService: IExtensionRecommendationNotificationService,\n\t\t@IExtensionsWorkbenchService private readonly extensionsWorkbenchService: IExtensionsWorkbenchService,\n\t\t@IRemoteExtensionsScannerService private readonly remoteExtensionsScannerService: IRemoteExtensionsScannerService,\n\t\t@IUserDataInitializationService private readonly userDataInitializationService: IUserDataInitializationService,\n\t) {\n\t\tsuper();\n\n\t\tthis.workspaceRecommendations = this._register(instantiationService.createInstance(WorkspaceRecommendations));\n\t\tthis.fileBasedRecommendations = this._register(instantiationService.createInstance(FileBasedRecommendations));\n\t\tthis.configBasedRecommendations = this._register(instantiationService.createInstance(ConfigBasedRecommendations));\n\t\tthis.exeBasedRecommendations = this._register(instantiationService.createInstance(ExeBasedRecommendations));\n\t\tthis.keymapRecommendations = this._register(instantiationService.createInstance(KeymapRecommendations));\n\t\tthis.webRecommendations = this._register(instantiationService.createInstance(WebRecommendations));\n\t\tthis.languageRecommendations = this._register(instantiationService.createInstance(LanguageRecommendations));\n\t\tthis.remoteRecommendations = this._register(instantiationService.createInstance(RemoteRecommendations));\n\n\t\tif (!this.isEnabled()) {\n\t\t\tthis.sessionSeed = 0;\n\t\t\tthis.activationPromise = Promise.resolve();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sessionSeed = +new Date();\n\n\t\t// Activation\n\t\tthis.activationPromise = this.activate();\n\n\t\tthis._register(this.extensionManagementService.onDidInstallExtensions(e => this.onDidInstallExtensions(e)));\n\t}\n\n\tprivate async activate(): Promise<void> {\n\t\ttry {\n\t\t\tawait Promise.allSettled([\n\t\t\t\tthis.remoteExtensionsScannerService.whenExtensionsReady(),\n\t\t\t\tthis.userDataInitializationService.whenInitializationFinished(),\n\t\t\t\tthis.lifecycleService.when(LifecyclePhase.Restored)]);\n\t\t} catch (error) { /* ignore */ }\n\n\t\t// activate all recommendations\n\t\tawait Promise.all([\n\t\t\tthis.workspaceRecommendations.activate(),\n\t\t\tthis.configBasedRecommendations.activate(),\n\t\t\tthis.fileBasedRecommendations.activate(),\n\t\t\tthis.keymapRecommendations.activate(),\n\t\t\tthis.languageRecommendations.activate(),\n\t\t\tthis.webRecommendations.activate(),\n\t\t\tthis.remoteRecommendations.activate()\n\t\t]);\n\n\t\tthis._register(Event.any(this.workspaceRecommendations.onDidChangeRecommendations, this.configBasedRecommendations.onDidChangeRecommendations, this.extensionRecommendationsManagementService.onDidChangeIgnoredRecommendations)(() => this._onDidChangeRecommendations.fire()));\n\n\t\tthis.promptWorkspaceRecommendations();\n\t}\n\n\tprivate isEnabled(): boolean {\n\t\treturn this.galleryService.isEnabled() && !this.environmentService.isExtensionDevelopment;\n\t}\n\n\tprivate async activateProactiveRecommendations(): Promise<void> {\n\t\tawait Promise.all([this.exeBasedRecommendations.activate(), this.configBasedRecommendations.activate()]);\n\t}\n\n\tgetAllRecommendationsWithReason(): { [id: string]: { reasonId: ExtensionRecommendationReason; reasonText: string } } {\n\t\t/* Activate proactive recommendations */\n\t\tthis.activateProactiveRecommendations();\n\n\t\tconst output: { [id: string]: { reasonId: ExtensionRecommendationReason; reasonText: string } } = Object.create(null);\n\n\t\tconst allRecommendations = [\n\t\t\t...this.configBasedRecommendations.recommendations,\n\t\t\t...this.exeBasedRecommendations.recommendations,\n\t\t\t...this.fileBasedRecommendations.recommendations,\n\t\t\t...this.workspaceRecommendations.recommendations,\n\t\t\t...this.keymapRecommendations.recommendations,\n\t\t\t...this.languageRecommendations.recommendations,\n\t\t\t...this.webRecommendations.recommendations,\n\t\t];\n\n\t\tfor (const { extension, reason } of allRecommendations) {\n\t\t\tif (isString(extension) && this.isExtensionAllowedToBeRecommended(extension)) {\n\t\t\t\toutput[extension.toLowerCase()] = reason;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tasync getConfigBasedRecommendations(): Promise<{ important: string[]; others: string[] }> {\n\t\tawait this.configBasedRecommendations.activate();\n\t\treturn {\n\t\t\timportant: this.toExtensionIds(this.configBasedRecommendations.importantRecommendations),\n\t\t\tothers: this.toExtensionIds(this.configBasedRecommendations.otherRecommendations)\n\t\t};\n\t}\n\n\tasync getOtherRecommendations(): Promise<string[]> {\n\t\tawait this.activationPromise;\n\t\tawait this.activateProactiveRecommendations();\n\n\t\tconst recommendations = [\n\t\t\t...this.configBasedRecommendations.otherRecommendations,\n\t\t\t...this.exeBasedRecommendations.otherRecommendations,\n\t\t\t...this.webRecommendations.recommendations\n\t\t];\n\n\t\tconst extensionIds = this.toExtensionIds(recommendations);\n\t\tshuffle(extensionIds, this.sessionSeed);\n\t\treturn extensionIds;\n\t}\n\n\tasync getImportantRecommendations(): Promise<string[]> {\n\t\tawait this.activateProactiveRecommendations();\n\n\t\tconst recommendations = [\n\t\t\t...this.fileBasedRecommendations.importantRecommendations,\n\t\t\t...this.configBasedRecommendations.importantRecommendations,\n\t\t\t...this.exeBasedRecommendations.importantRecommendations,\n\t\t];\n\n\t\tconst extensionIds = this.toExtensionIds(recommendations);\n\t\tshuffle(extensionIds, this.sessionSeed);\n\t\treturn extensionIds;\n\t}\n\n\tgetKeymapRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.keymapRecommendations.recommendations);\n\t}\n\n\tgetLanguageRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.languageRecommendations.recommendations);\n\t}\n\n\tgetRemoteRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.remoteRecommendations.recommendations);\n\t}\n\n\tasync getWorkspaceRecommendations(): Promise<Array<string | URI>> {\n\t\tif (!this.isEnabled()) {\n\t\t\treturn [];\n\t\t}\n\t\tawait this.workspaceRecommendations.activate();\n\t\tconst result: Array<string | URI> = [];\n\t\tfor (const { extension } of this.workspaceRecommendations.recommendations) {\n\t\t\tif (isString(extension)) {\n\t\t\t\tif (!result.includes(extension.toLowerCase()) && this.isExtensionAllowedToBeRecommended(extension)) {\n\t\t\t\t\tresult.push(extension.toLowerCase());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.push(extension);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync getExeBasedRecommendations(exe?: string): Promise<{ important: string[]; others: string[] }> {\n\t\tawait this.exeBasedRecommendations.activate();\n\t\tconst { important, others } = exe ? this.exeBasedRecommendations.getRecommendations(exe)\n\t\t\t: { important: this.exeBasedRecommendations.importantRecommendations, others: this.exeBasedRecommendations.otherRecommendations };\n\t\treturn { important: this.toExtensionIds(important), others: this.toExtensionIds(others) };\n\t}\n\n\tgetFileBasedRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.fileBasedRecommendations.recommendations);\n\t}\n\n\tprivate onDidInstallExtensions(results: readonly InstallExtensionResult[]): void {\n\t\tfor (const e of results) {\n\t\t\tif (e.source && !URI.isUri(e.source) && e.operation === InstallOperation.Install) {\n\t\t\t\tconst extRecommendations = this.getAllRecommendationsWithReason() || {};\n\t\t\t\tconst recommendationReason = extRecommendations[e.source.identifier.id.toLowerCase()];\n\t\t\t\tif (recommendationReason) {\n\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\"extensionGallery:install:recommendations\" : {\n\t\t\t\t\t\t\t\"owner\": \"sandy081\",\n\t\t\t\t\t\t\t\"recommendationReason\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\"${GalleryExtensionTelemetryData}\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\tthis.telemetryService.publicLog('extensionGallery:install:recommendations', { ...e.source.telemetryData, recommendationReason: recommendationReason.reasonId });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate toExtensionIds(recommendations: ReadonlyArray<ExtensionRecommendation>): string[] {\n\t\tconst extensionIds: string[] = [];\n\t\tfor (const { extension } of recommendations) {\n\t\t\tif (isString(extension) && this.isExtensionAllowedToBeRecommended(extension) && !extensionIds.includes(extension.toLowerCase())) {\n\t\t\t\textensionIds.push(extension.toLowerCase());\n\t\t\t}\n\t\t}\n\t\treturn extensionIds;\n\t}\n\n\tprivate isExtensionAllowedToBeRecommended(extensionId: string): boolean {\n\t\treturn !this.extensionRecommendationsManagementService.ignoredRecommendations.includes(extensionId.toLowerCase());\n\t}\n\n\tprivate async promptWorkspaceRecommendations(): Promise<void> {\n\t\tconst installed = await this.extensionsWorkbenchService.queryLocal();\n\t\tconst allowedRecommendations = [\n\t\t\t...this.workspaceRecommendations.recommendations,\n\t\t\t...this.configBasedRecommendations.importantRecommendations.filter(\n\t\t\t\trecommendation => !recommendation.whenNotInstalled || recommendation.whenNotInstalled.every(id => installed.every(local => !areSameExtensions(local.identifier, { id }))))\n\t\t]\n\t\t\t.map(({ extension }) => extension)\n\t\t\t.filter(extension => !isString(extension) || this.isExtensionAllowedToBeRecommended(extension));\n\n\t\tif (allowedRecommendations.length) {\n\t\t\tawait this._registerP(timeout(5000));\n\t\t\tawait this.extensionRecommendationNotificationService.promptWorkspaceRecommendations(allowedRecommendations);\n\t\t}\n\t}\n\n\tprivate _registerP<T>(o: CancelablePromise<T>): CancelablePromise<T> {\n\t\tthis._register(toDisposable(() => o.cancel()));\n\t\treturn o;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IExtensionManagementService, IExtensionGalleryService, InstallOperation, InstallExtensionResult } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { IExtensionRecommendationsService, ExtensionRecommendationReason, IExtensionIgnoredRecommendationsService } from '../../../services/extensionRecommendations/common/extensionRecommendations.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { shuffle } from '../../../../base/common/arrays.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { LifecyclePhase, ILifecycleService } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ExeBasedRecommendations } from './exeBasedRecommendations.js';\nimport { WorkspaceRecommendations } from './workspaceRecommendations.js';\nimport { FileBasedRecommendations } from './fileBasedRecommendations.js';\nimport { KeymapRecommendations } from './keymapRecommendations.js';\nimport { LanguageRecommendations } from './languageRecommendations.js';\nimport { ExtensionRecommendation } from './extensionRecommendations.js';\nimport { ConfigBasedRecommendations } from './configBasedRecommendations.js';\nimport { IExtensionRecommendationNotificationService } from '../../../../platform/extensionRecommendations/common/extensionRecommendations.js';\nimport { CancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { WebRecommendations } from './webRecommendations.js';\nimport { IExtensionsWorkbenchService } from '../common/extensions.js';\nimport { areSameExtensions } from '../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { RemoteRecommendations } from './remoteRecommendations.js';\nimport { IRemoteExtensionsScannerService } from '../../../../platform/remote/common/remoteExtensionsScanner.js';\nimport { IUserDataInitializationService } from '../../../services/userData/browser/userDataInit.js';\nimport { isString } from '../../../../base/common/types.js';\n\nexport class ExtensionRecommendationsService extends Disposable implements IExtensionRecommendationsService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\t// Recommendations\n\tprivate readonly fileBasedRecommendations: FileBasedRecommendations;\n\tprivate readonly workspaceRecommendations: WorkspaceRecommendations;\n\tprivate readonly configBasedRecommendations: ConfigBasedRecommendations;\n\tprivate readonly exeBasedRecommendations: ExeBasedRecommendations;\n\tprivate readonly keymapRecommendations: KeymapRecommendations;\n\tprivate readonly webRecommendations: WebRecommendations;\n\tprivate readonly languageRecommendations: LanguageRecommendations;\n\tprivate readonly remoteRecommendations: RemoteRecommendations;\n\n\tpublic readonly activationPromise: Promise<void>;\n\tprivate sessionSeed: number;\n\n\tprivate _onDidChangeRecommendations = this._register(new Emitter<void>());\n\treadonly onDidChangeRecommendations = this._onDidChangeRecommendations.event;\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IExtensionManagementService private readonly extensionManagementService: IExtensionManagementService,\n\t\t@IExtensionIgnoredRecommendationsService private readonly extensionRecommendationsManagementService: IExtensionIgnoredRecommendationsService,\n\t\t@IExtensionRecommendationNotificationService private readonly extensionRecommendationNotificationService: IExtensionRecommendationNotificationService,\n\t\t@IExtensionsWorkbenchService private readonly extensionsWorkbenchService: IExtensionsWorkbenchService,\n\t\t@IRemoteExtensionsScannerService private readonly remoteExtensionsScannerService: IRemoteExtensionsScannerService,\n\t\t@IUserDataInitializationService private readonly userDataInitializationService: IUserDataInitializationService,\n\t) {\n\t\tsuper();\n\n\t\tthis.workspaceRecommendations = this._register(instantiationService.createInstance(WorkspaceRecommendations));\n\t\tthis.fileBasedRecommendations = this._register(instantiationService.createInstance(FileBasedRecommendations));\n\t\tthis.configBasedRecommendations = this._register(instantiationService.createInstance(ConfigBasedRecommendations));\n\t\tthis.exeBasedRecommendations = this._register(instantiationService.createInstance(ExeBasedRecommendations));\n\t\tthis.keymapRecommendations = this._register(instantiationService.createInstance(KeymapRecommendations));\n\t\tthis.webRecommendations = this._register(instantiationService.createInstance(WebRecommendations));\n\t\tthis.languageRecommendations = this._register(instantiationService.createInstance(LanguageRecommendations));\n\t\tthis.remoteRecommendations = this._register(instantiationService.createInstance(RemoteRecommendations));\n\n\t\tif (!this.isEnabled()) {\n\t\t\tthis.sessionSeed = 0;\n\t\t\tthis.activationPromise = Promise.resolve();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.sessionSeed = +new Date();\n\n\t\t// Activation\n\t\tthis.activationPromise = this.activate();\n\n\t\tthis._register(this.extensionManagementService.onDidInstallExtensions(e => this.onDidInstallExtensions(e)));\n\t}\n\n\tprivate async activate(): Promise<void> {\n\t\ttry {\n\t\t\tawait Promise.allSettled([\n\t\t\t\tthis.remoteExtensionsScannerService.whenExtensionsReady(),\n\t\t\t\tthis.userDataInitializationService.whenInitializationFinished(),\n\t\t\t\tthis.lifecycleService.when(LifecyclePhase.Restored)]);\n\t\t} catch (error) { /* ignore */ }\n\n\t\t// activate all recommendations\n\t\tawait Promise.all([\n\t\t\tthis.workspaceRecommendations.activate(),\n\t\t\tthis.configBasedRecommendations.activate(),\n\t\t\tthis.fileBasedRecommendations.activate(),\n\t\t\tthis.keymapRecommendations.activate(),\n\t\t\tthis.languageRecommendations.activate(),\n\t\t\tthis.webRecommendations.activate(),\n\t\t\tthis.remoteRecommendations.activate()\n\t\t]);\n\n\t\tthis._register(Event.any(this.workspaceRecommendations.onDidChangeRecommendations, this.configBasedRecommendations.onDidChangeRecommendations, this.extensionRecommendationsManagementService.onDidChangeIgnoredRecommendations)(() => this._onDidChangeRecommendations.fire()));\n\n\t\tthis.promptWorkspaceRecommendations();\n\t}\n\n\tprivate isEnabled(): boolean {\n\t\treturn this.galleryService.isEnabled() && !this.environmentService.isExtensionDevelopment;\n\t}\n\n\tprivate async activateProactiveRecommendations(): Promise<void> {\n\t\tawait Promise.all([this.exeBasedRecommendations.activate(), this.configBasedRecommendations.activate()]);\n\t}\n\n\tgetAllRecommendationsWithReason(): { [id: string]: { reasonId: ExtensionRecommendationReason; reasonText: string } } {\n\t\t/* Activate proactive recommendations */\n\t\tthis.activateProactiveRecommendations();\n\n\t\tconst output: { [id: string]: { reasonId: ExtensionRecommendationReason; reasonText: string } } = Object.create(null);\n\n\t\tconst allRecommendations = [\n\t\t\t...this.configBasedRecommendations.recommendations,\n\t\t\t...this.exeBasedRecommendations.recommendations,\n\t\t\t...this.fileBasedRecommendations.recommendations,\n\t\t\t...this.workspaceRecommendations.recommendations,\n\t\t\t...this.keymapRecommendations.recommendations,\n\t\t\t...this.languageRecommendations.recommendations,\n\t\t\t...this.webRecommendations.recommendations,\n\t\t];\n\n\t\tfor (const { extension, reason } of allRecommendations) {\n\t\t\tif (isString(extension) && this.isExtensionAllowedToBeRecommended(extension)) {\n\t\t\t\toutput[extension.toLowerCase()] = reason;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tasync getConfigBasedRecommendations(): Promise<{ important: string[]; others: string[] }> {\n\t\tawait this.configBasedRecommendations.activate();\n\t\treturn {\n\t\t\timportant: this.toExtensionIds(this.configBasedRecommendations.importantRecommendations),\n\t\t\tothers: this.toExtensionIds(this.configBasedRecommendations.otherRecommendations)\n\t\t};\n\t}\n\n\tasync getOtherRecommendations(): Promise<string[]> {\n\t\tawait this.activationPromise;\n\t\tawait this.activateProactiveRecommendations();\n\n\t\tconst recommendations = [\n\t\t\t...this.configBasedRecommendations.otherRecommendations,\n\t\t\t...this.exeBasedRecommendations.otherRecommendations,\n\t\t\t...this.webRecommendations.recommendations\n\t\t];\n\n\t\tconst extensionIds = this.toExtensionIds(recommendations);\n\t\tshuffle(extensionIds, this.sessionSeed);\n\t\treturn extensionIds;\n\t}\n\n\tasync getImportantRecommendations(): Promise<string[]> {\n\t\tawait this.activateProactiveRecommendations();\n\n\t\tconst recommendations = [\n\t\t\t...this.fileBasedRecommendations.importantRecommendations,\n\t\t\t...this.configBasedRecommendations.importantRecommendations,\n\t\t\t...this.exeBasedRecommendations.importantRecommendations,\n\t\t];\n\n\t\tconst extensionIds = this.toExtensionIds(recommendations);\n\t\tshuffle(extensionIds, this.sessionSeed);\n\t\treturn extensionIds;\n\t}\n\n\tgetKeymapRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.keymapRecommendations.recommendations);\n\t}\n\n\tgetLanguageRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.languageRecommendations.recommendations);\n\t}\n\n\tgetRemoteRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.remoteRecommendations.recommendations);\n\t}\n\n\tasync getWorkspaceRecommendations(): Promise<Array<string | URI>> {\n\t\tif (!this.isEnabled()) {\n\t\t\treturn [];\n\t\t}\n\t\tawait this.workspaceRecommendations.activate();\n\t\tconst result: Array<string | URI> = [];\n\t\tfor (const { extension } of this.workspaceRecommendations.recommendations) {\n\t\t\tif (isString(extension)) {\n\t\t\t\tif (!result.includes(extension.toLowerCase()) && this.isExtensionAllowedToBeRecommended(extension)) {\n\t\t\t\t\tresult.push(extension.toLowerCase());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.push(extension);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync getExeBasedRecommendations(exe?: string): Promise<{ important: string[]; others: string[] }> {\n\t\tawait this.exeBasedRecommendations.activate();\n\t\tconst { important, others } = exe ? this.exeBasedRecommendations.getRecommendations(exe)\n\t\t\t: { important: this.exeBasedRecommendations.importantRecommendations, others: this.exeBasedRecommendations.otherRecommendations };\n\t\treturn { important: this.toExtensionIds(important), others: this.toExtensionIds(others) };\n\t}\n\n\tgetFileBasedRecommendations(): string[] {\n\t\treturn this.toExtensionIds(this.fileBasedRecommendations.recommendations);\n\t}\n\n\tprivate onDidInstallExtensions(results: readonly InstallExtensionResult[]): void {\n\t\tfor (const e of results) {\n\t\t\tif (e.source && !URI.isUri(e.source) && e.operation === InstallOperation.Install) {\n\t\t\t\tconst extRecommendations = this.getAllRecommendationsWithReason() || {};\n\t\t\t\tconst recommendationReason = extRecommendations[e.source.identifier.id.toLowerCase()];\n\t\t\t\tif (recommendationReason) {\n\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\"extensionGallery:install:recommendations\" : {\n\t\t\t\t\t\t\t\"owner\": \"sandy081\",\n\t\t\t\t\t\t\t\"recommendationReason\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\"${GalleryExtensionTelemetryData}\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\tthis.telemetryService.publicLog('extensionGallery:install:recommendations', { ...e.source.telemetryData, recommendationReason: recommendationReason.reasonId });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate toExtensionIds(recommendations: ReadonlyArray<ExtensionRecommendation>): string[] {\n\t\tconst extensionIds: string[] = [];\n\t\tfor (const { extension } of recommendations) {\n\t\t\tif (isString(extension) && this.isExtensionAllowedToBeRecommended(extension) && !extensionIds.includes(extension.toLowerCase())) {\n\t\t\t\textensionIds.push(extension.toLowerCase());\n\t\t\t}\n\t\t}\n\t\treturn extensionIds;\n\t}\n\n\tprivate isExtensionAllowedToBeRecommended(extensionId: string): boolean {\n\t\treturn !this.extensionRecommendationsManagementService.ignoredRecommendations.includes(extensionId.toLowerCase());\n\t}\n\n\tprivate async promptWorkspaceRecommendations(): Promise<void> {\n\t\tconst installed = await this.extensionsWorkbenchService.queryLocal();\n\t\tconst allowedRecommendations = [\n\t\t\t...this.workspaceRecommendations.recommendations,\n\t\t\t...this.configBasedRecommendations.importantRecommendations.filter(\n\t\t\t\trecommendation => !recommendation.whenNotInstalled || recommendation.whenNotInstalled.every(id => installed.every(local => !areSameExtensions(local.identifier, { id }))))\n\t\t]\n\t\t\t.map(({ extension }) => extension)\n\t\t\t.filter(extension => !isString(extension) || this.isExtensionAllowedToBeRecommended(extension));\n\n\t\tif (allowedRecommendations.length) {\n\t\t\tawait this._registerP(timeout(5000));\n\t\t\tawait this.extensionRecommendationNotificationService.promptWorkspaceRecommendations(allowedRecommendations);\n\t\t}\n\t}\n\n\tprivate _registerP<T>(o: CancelablePromise<T>): CancelablePromise<T> {\n\t\tthis._register(toDisposable(() => o.cancel()));\n\t\treturn o;\n\t}\n}\n"]}