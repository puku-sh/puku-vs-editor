{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/webview/electron-browser/webviewElement.ts","vs/workbench/contrib/webview/electron-browser/webviewElement.ts"],"names":[],"mappings":"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","file":"webviewElement.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Delayer } from '../../../../base/common/async.js';\nimport { VSBuffer, VSBufferReadableStream } from '../../../../base/common/buffer.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { consumeStream } from '../../../../base/common/stream.js';\nimport { ProxyChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMainProcessService } from '../../../../platform/ipc/common/mainProcessService.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IRemoteAuthorityResolverService } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { ITunnelService } from '../../../../platform/tunnel/common/tunnel.js';\nimport { FindInFrameOptions, IWebviewManagerService } from '../../../../platform/webview/common/webviewManagerService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { WebviewThemeDataProvider } from '../browser/themeing.js';\nimport { WebviewInitInfo } from '../browser/webview.js';\nimport { WebviewElement } from '../browser/webviewElement.js';\nimport { WindowIgnoreMenuShortcutsManager } from './windowIgnoreMenuShortcutsManager.js';\n\n/**\n * Webview backed by an iframe but that uses Electron APIs to power the webview.\n */\nexport class ElectronWebviewElement extends WebviewElement {\n\n\tprivate readonly _webviewKeyboardHandler: WindowIgnoreMenuShortcutsManager;\n\n\tprivate _findStarted: boolean = false;\n\tprivate _cachedHtmlContent: string | undefined;\n\n\tprivate readonly _webviewMainService: IWebviewManagerService;\n\tprivate readonly _iframeDelayer = this._register(new Delayer<void>(200));\n\n\tprotected override get platform() { return 'electron'; }\n\n\tconstructor(\n\t\tinitInfo: WebviewInitInfo,\n\t\twebviewThemeDataProvider: WebviewThemeDataProvider,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ITunnelService tunnelService: ITunnelService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t\t@IRemoteAuthorityResolverService remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@ILogService logService: ILogService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IMainProcessService mainProcessService: IMainProcessService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@INativeHostService private readonly _nativeHostService: INativeHostService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper(initInfo, webviewThemeDataProvider,\n\t\t\tconfigurationService, contextMenuService, notificationService, environmentService,\n\t\t\tfileService, logService, remoteAuthorityResolverService, tunnelService, instantiationService, accessibilityService);\n\n\t\tthis._webviewKeyboardHandler = new WindowIgnoreMenuShortcutsManager(configurationService, mainProcessService, _nativeHostService);\n\n\t\tthis._webviewMainService = ProxyChannel.toService<IWebviewManagerService>(mainProcessService.getChannel('webview'));\n\n\t\tif (initInfo.options.enableFindWidget) {\n\t\t\tthis._register(this.onDidHtmlChange((newContent) => {\n\t\t\t\tif (this._findStarted && this._cachedHtmlContent !== newContent) {\n\t\t\t\t\tthis.stopFind(false);\n\t\t\t\t\tthis._cachedHtmlContent = newContent;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._register(this._webviewMainService.onFoundInFrame((result) => {\n\t\t\t\tthis._hasFindResult.fire(result.matches > 0);\n\t\t\t}));\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\t// Make sure keyboard handler knows it closed (#71800)\n\t\tthis._webviewKeyboardHandler.didBlur();\n\n\t\tsuper.dispose();\n\t}\n\n\tprotected override webviewContentEndpoint(iframeId: string): string {\n\t\treturn `${Schemas.vscodeWebview}://${iframeId}`;\n\t}\n\n\tprotected override streamToBuffer(stream: VSBufferReadableStream): Promise<ArrayBufferLike> {\n\t\t// Join buffers from stream without using the Node.js backing pool.\n\t\t// This lets us transfer the resulting buffer to the webview.\n\t\treturn consumeStream<VSBuffer, ArrayBufferLike>(stream, (buffers: readonly VSBuffer[]) => {\n\t\t\tconst totalLength = buffers.reduce((prev, curr) => prev + curr.byteLength, 0);\n\t\t\tconst ret = new ArrayBuffer(totalLength);\n\t\t\tconst view = new Uint8Array(ret);\n\t\t\tlet offset = 0;\n\t\t\tfor (const element of buffers) {\n\t\t\t\tview.set(element.buffer, offset);\n\t\t\t\toffset += element.byteLength;\n\t\t\t}\n\t\t\treturn ret;\n\t\t});\n\t}\n\n\t/**\n\t * Webviews expose a stateful find API.\n\t * Successive calls to find will move forward or backward through onFindResults\n\t * depending on the supplied options.\n\t *\n\t * @param value The string to search for. Empty strings are ignored.\n\t */\n\tpublic override find(value: string, previous: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._findStarted) {\n\t\t\tthis.updateFind(value);\n\t\t} else {\n\t\t\t// continuing the find, so set findNext to false\n\t\t\tconst options: FindInFrameOptions = { forward: !previous, findNext: false, matchCase: false };\n\t\t\tthis._webviewMainService.findInFrame({ windowId: this._nativeHostService.windowId }, this.id, value, options);\n\t\t}\n\t}\n\n\tpublic override updateFind(value: string) {\n\t\tif (!value || !this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\t// FindNext must be true for a first request\n\t\tconst options: FindInFrameOptions = {\n\t\t\tforward: true,\n\t\t\tfindNext: true,\n\t\t\tmatchCase: false\n\t\t};\n\n\t\tthis._iframeDelayer.trigger(() => {\n\t\t\tthis._findStarted = true;\n\t\t\tthis._webviewMainService.findInFrame({ windowId: this._nativeHostService.windowId }, this.id, value, options);\n\t\t});\n\t}\n\n\tpublic override stopFind(keepSelection?: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\t\tthis._iframeDelayer.cancel();\n\t\tthis._findStarted = false;\n\t\tthis._webviewMainService.stopFindInFrame({ windowId: this._nativeHostService.windowId }, this.id, {\n\t\t\tkeepSelection\n\t\t});\n\t\tthis._onDidStopFind.fire();\n\t}\n\n\tprotected override handleFocusChange(isFocused: boolean): void {\n\t\tsuper.handleFocusChange(isFocused);\n\t\tif (isFocused) {\n\t\t\tthis._webviewKeyboardHandler.didFocus();\n\t\t} else {\n\t\t\tthis._webviewKeyboardHandler.didBlur();\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Delayer } from '../../../../base/common/async.js';\nimport { VSBuffer, VSBufferReadableStream } from '../../../../base/common/buffer.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { consumeStream } from '../../../../base/common/stream.js';\nimport { ProxyChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMainProcessService } from '../../../../platform/ipc/common/mainProcessService.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IRemoteAuthorityResolverService } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { ITunnelService } from '../../../../platform/tunnel/common/tunnel.js';\nimport { FindInFrameOptions, IWebviewManagerService } from '../../../../platform/webview/common/webviewManagerService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { WebviewThemeDataProvider } from '../browser/themeing.js';\nimport { WebviewInitInfo } from '../browser/webview.js';\nimport { WebviewElement } from '../browser/webviewElement.js';\nimport { WindowIgnoreMenuShortcutsManager } from './windowIgnoreMenuShortcutsManager.js';\n\n/**\n * Webview backed by an iframe but that uses Electron APIs to power the webview.\n */\nexport class ElectronWebviewElement extends WebviewElement {\n\n\tprivate readonly _webviewKeyboardHandler: WindowIgnoreMenuShortcutsManager;\n\n\tprivate _findStarted: boolean = false;\n\tprivate _cachedHtmlContent: string | undefined;\n\n\tprivate readonly _webviewMainService: IWebviewManagerService;\n\tprivate readonly _iframeDelayer = this._register(new Delayer<void>(200));\n\n\tprotected override get platform() { return 'electron'; }\n\n\tconstructor(\n\t\tinitInfo: WebviewInitInfo,\n\t\twebviewThemeDataProvider: WebviewThemeDataProvider,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ITunnelService tunnelService: ITunnelService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t\t@IRemoteAuthorityResolverService remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@ILogService logService: ILogService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IMainProcessService mainProcessService: IMainProcessService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@INativeHostService private readonly _nativeHostService: INativeHostService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper(initInfo, webviewThemeDataProvider,\n\t\t\tconfigurationService, contextMenuService, notificationService, environmentService,\n\t\t\tfileService, logService, remoteAuthorityResolverService, tunnelService, instantiationService, accessibilityService);\n\n\t\tthis._webviewKeyboardHandler = new WindowIgnoreMenuShortcutsManager(configurationService, mainProcessService, _nativeHostService);\n\n\t\tthis._webviewMainService = ProxyChannel.toService<IWebviewManagerService>(mainProcessService.getChannel('webview'));\n\n\t\tif (initInfo.options.enableFindWidget) {\n\t\t\tthis._register(this.onDidHtmlChange((newContent) => {\n\t\t\t\tif (this._findStarted && this._cachedHtmlContent !== newContent) {\n\t\t\t\t\tthis.stopFind(false);\n\t\t\t\t\tthis._cachedHtmlContent = newContent;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._register(this._webviewMainService.onFoundInFrame((result) => {\n\t\t\t\tthis._hasFindResult.fire(result.matches > 0);\n\t\t\t}));\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\t// Make sure keyboard handler knows it closed (#71800)\n\t\tthis._webviewKeyboardHandler.didBlur();\n\n\t\tsuper.dispose();\n\t}\n\n\tprotected override webviewContentEndpoint(iframeId: string): string {\n\t\treturn `${Schemas.vscodeWebview}://${iframeId}`;\n\t}\n\n\tprotected override streamToBuffer(stream: VSBufferReadableStream): Promise<ArrayBufferLike> {\n\t\t// Join buffers from stream without using the Node.js backing pool.\n\t\t// This lets us transfer the resulting buffer to the webview.\n\t\treturn consumeStream<VSBuffer, ArrayBufferLike>(stream, (buffers: readonly VSBuffer[]) => {\n\t\t\tconst totalLength = buffers.reduce((prev, curr) => prev + curr.byteLength, 0);\n\t\t\tconst ret = new ArrayBuffer(totalLength);\n\t\t\tconst view = new Uint8Array(ret);\n\t\t\tlet offset = 0;\n\t\t\tfor (const element of buffers) {\n\t\t\t\tview.set(element.buffer, offset);\n\t\t\t\toffset += element.byteLength;\n\t\t\t}\n\t\t\treturn ret;\n\t\t});\n\t}\n\n\t/**\n\t * Webviews expose a stateful find API.\n\t * Successive calls to find will move forward or backward through onFindResults\n\t * depending on the supplied options.\n\t *\n\t * @param value The string to search for. Empty strings are ignored.\n\t */\n\tpublic override find(value: string, previous: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._findStarted) {\n\t\t\tthis.updateFind(value);\n\t\t} else {\n\t\t\t// continuing the find, so set findNext to false\n\t\t\tconst options: FindInFrameOptions = { forward: !previous, findNext: false, matchCase: false };\n\t\t\tthis._webviewMainService.findInFrame({ windowId: this._nativeHostService.windowId }, this.id, value, options);\n\t\t}\n\t}\n\n\tpublic override updateFind(value: string) {\n\t\tif (!value || !this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\t// FindNext must be true for a first request\n\t\tconst options: FindInFrameOptions = {\n\t\t\tforward: true,\n\t\t\tfindNext: true,\n\t\t\tmatchCase: false\n\t\t};\n\n\t\tthis._iframeDelayer.trigger(() => {\n\t\t\tthis._findStarted = true;\n\t\t\tthis._webviewMainService.findInFrame({ windowId: this._nativeHostService.windowId }, this.id, value, options);\n\t\t});\n\t}\n\n\tpublic override stopFind(keepSelection?: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\t\tthis._iframeDelayer.cancel();\n\t\tthis._findStarted = false;\n\t\tthis._webviewMainService.stopFindInFrame({ windowId: this._nativeHostService.windowId }, this.id, {\n\t\t\tkeepSelection\n\t\t});\n\t\tthis._onDidStopFind.fire();\n\t}\n\n\tprotected override handleFocusChange(isFocused: boolean): void {\n\t\tsuper.handleFocusChange(isFocused);\n\t\tif (isFocused) {\n\t\t\tthis._webviewKeyboardHandler.didFocus();\n\t\t} else {\n\t\t\tthis._webviewKeyboardHandler.didBlur();\n\t\t}\n\t}\n}\n"]}