{"version":3,"sources":["vs/workbench/contrib/webview/browser/webviewElement.ts"],"names":[],"mappings":"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","file":"webviewElement.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isFirefox } from '../../../../base/browser/browser.js';\nimport { addDisposableListener, EventType, getWindow, getWindowById } from '../../../../base/browser/dom.js';\nimport { parentOriginHash } from '../../../../base/browser/iframe.js';\nimport { IMouseWheelEvent } from '../../../../base/browser/mouseEvent.js';\nimport { CodeWindow } from '../../../../base/browser/window.js';\nimport { promiseWithResolvers, ThrottledDelayer } from '../../../../base/common/async.js';\nimport { streamToBuffer, VSBufferReadableStream } from '../../../../base/common/buffer.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { COI } from '../../../../base/common/network.js';\nimport { observableValue } from '../../../../base/common/observable.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { localize } from '../../../../nls.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IRemoteAuthorityResolverService } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { ITunnelService } from '../../../../platform/tunnel/common/tunnel.js';\nimport { WebviewPortMappingManager } from '../../../../platform/webview/common/webviewPortMapping.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { decodeAuthority, webviewGenericCspSource, webviewRootResourceAuthority } from '../common/webview.js';\nimport { loadLocalResource, WebviewResourceResponse } from './resourceLoading.js';\nimport { WebviewThemeDataProvider } from './themeing.js';\nimport { areWebviewContentOptionsEqual, IWebviewElement, WebviewContentOptions, WebviewExtensionDescription, WebviewInitInfo, WebviewMessageReceivedEvent, WebviewOptions } from './webview.js';\nimport { WebviewFindDelegate, WebviewFindWidget } from './webviewFindWidget.js';\nimport { FromWebviewMessage, KeyEvent, ToWebviewMessage, WebViewDragEvent } from './webviewMessages.js';\n\ninterface WebviewContent {\n\treadonly html: string;\n\treadonly title: string | undefined;\n\treadonly options: WebviewContentOptions;\n\treadonly state: string | undefined;\n}\n\nnamespace WebviewState {\n\texport const enum Type { Initializing, Ready }\n\n\texport class Initializing {\n\t\treadonly type = Type.Initializing;\n\n\t\tconstructor(\n\t\t\tpublic pendingMessages: Array<{\n\t\t\t\treadonly channel: string;\n\t\t\t\treadonly data?: any;\n\t\t\t\treadonly transferable: Transferable[];\n\t\t\t\treadonly resolve: (posted: boolean) => void;\n\t\t\t}>\n\t\t) { }\n\t}\n\n\texport const Ready = { type: Type.Ready } as const;\n\n\texport type State = typeof Ready | Initializing;\n}\n\ninterface WebviewActionContext {\n\treadonly webview?: string;\n\treadonly [key: string]: unknown;\n}\n\nconst webviewIdContext = 'webviewId';\n\nexport class WebviewElement extends Disposable implements IWebviewElement, WebviewFindDelegate {\n\n\tprotected readonly id = generateUuid();\n\n\t/**\n\t * The provided identifier of this webview.\n\t */\n\tpublic readonly providedViewType?: string;\n\n\t/**\n\t * The origin this webview itself is loaded from. May not be unique\n\t */\n\tpublic readonly origin: string;\n\n\tprivate _windowId: number | undefined = undefined;\n\tprivate get window() { return typeof this._windowId === 'number' ? getWindowById(this._windowId)?.window : undefined; }\n\n\tprivate _encodedWebviewOriginPromise?: Promise<string>;\n\tprivate _encodedWebviewOrigin: string | undefined;\n\n\tprotected get platform(): string { return 'browser'; }\n\n\tprivate readonly _expectedServiceWorkerVersion = 4; // Keep this in sync with the version in service-worker.js\n\n\tprivate _element: HTMLIFrameElement | undefined;\n\tprotected get element(): HTMLIFrameElement | undefined { return this._element; }\n\n\tprivate _focused: boolean | undefined;\n\tpublic get isFocused(): boolean {\n\t\tif (!this._focused) {\n\t\t\treturn false;\n\t\t}\n\t\t// code window is only available after the webview is mounted.\n\t\tif (!this.window) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.window.document.activeElement && this.window.document.activeElement !== this.element) {\n\t\t\t// looks like https://github.com/microsoft/vscode/issues/132641\n\t\t\t// where the focus is actually not in the `<iframe>`\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _state: WebviewState.State = new WebviewState.Initializing([]);\n\n\tprivate _content: WebviewContent;\n\n\tprivate readonly _portMappingManager: WebviewPortMappingManager;\n\n\tprivate readonly _resourceLoadingCts = this._register(new CancellationTokenSource());\n\n\tprivate _contextKeyService: IContextKeyService | undefined;\n\n\tprivate _confirmBeforeClose: string;\n\n\tprivate readonly _focusDelayer = this._register(new ThrottledDelayer(50));\n\n\tprivate readonly _onDidHtmlChange: Emitter<string> = this._register(new Emitter<string>());\n\tprotected readonly onDidHtmlChange = this._onDidHtmlChange.event;\n\n\tprivate _messagePort?: MessagePort;\n\tprivate readonly _messageHandlers = new Map<string, Set<(data: any, e: MessageEvent) => void>>();\n\n\tprotected readonly _webviewFindWidget: WebviewFindWidget | undefined;\n\tpublic readonly checkImeCompletionState = true;\n\n\tpublic readonly intrinsicContentSize = observableValue<{ readonly width: number; readonly height: number } | undefined>('WebviewIntrinsicContentSize', undefined);\n\n\tprivate _disposed = false;\n\n\n\tpublic extension: WebviewExtensionDescription | undefined;\n\tprivate readonly _options: WebviewOptions;\n\n\tconstructor(\n\t\tinitInfo: WebviewInitInfo,\n\t\tprotected readonly webviewThemeDataProvider: WebviewThemeDataProvider,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IRemoteAuthorityResolverService private readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@ITunnelService private readonly _tunnelService: ITunnelService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper();\n\n\t\tthis.providedViewType = initInfo.providedViewType;\n\t\tthis.origin = initInfo.origin ?? this.id;\n\n\t\tthis._options = initInfo.options;\n\t\tthis.extension = initInfo.extension;\n\n\t\tthis._content = {\n\t\t\thtml: '',\n\t\t\ttitle: initInfo.title,\n\t\t\toptions: initInfo.contentOptions,\n\t\t\tstate: undefined\n\t\t};\n\n\t\tthis._portMappingManager = this._register(new WebviewPortMappingManager(\n\t\t\t() => this.extension?.location,\n\t\t\t() => this._content.options.portMapping || [],\n\t\t\tthis._tunnelService\n\t\t));\n\n\t\tthis._element = this._createElement(initInfo.options, initInfo.contentOptions);\n\n\t\tthis._register(this.on('no-csp-found', () => {\n\t\t\tthis.handleNoCspFound();\n\t\t}));\n\n\t\tthis._register(this.on('did-click-link', ({ uri }) => {\n\t\t\tthis._onDidClickLink.fire(uri);\n\t\t}));\n\n\t\tthis._register(this.on('onmessage', ({ message, transfer }) => {\n\t\t\tthis._onMessage.fire({ message, transfer });\n\t\t}));\n\n\t\tthis._register(this.on('did-scroll', ({ scrollYPercentage }) => {\n\t\t\tthis._onDidScroll.fire({ scrollYPercentage });\n\t\t}));\n\n\t\tthis._register(this.on('do-reload', () => {\n\t\t\tthis.reload();\n\t\t}));\n\n\t\tthis._register(this.on('do-update-state', (state) => {\n\t\t\tthis.state = state;\n\t\t\tthis._onDidUpdateState.fire(state);\n\t\t}));\n\n\t\tthis._register(this.on('did-focus', () => {\n\t\t\tthis.handleFocusChange(true);\n\t\t}));\n\n\t\tthis._register(this.on('did-blur', () => {\n\t\t\tthis.handleFocusChange(false);\n\t\t}));\n\n\t\tthis._register(this.on('did-scroll-wheel', (event) => {\n\t\t\tthis._onDidWheel.fire(event);\n\t\t}));\n\n\t\tthis._register(this.on('did-find', ({ didFind }) => {\n\t\t\tthis._hasFindResult.fire(didFind);\n\t\t}));\n\n\t\tthis._register(this.on('fatal-error', (e) => {\n\t\t\tnotificationService.error(localize('fatalErrorMessage', \"Error loading webview: {0}\", e.message));\n\t\t\tthis._onFatalError.fire({ message: e.message });\n\t\t}));\n\n\t\tthis._register(this.on('did-keydown', (data) => {\n\t\t\t// Electron: workaround for https://github.com/electron/electron/issues/14258\n\t\t\t// We have to detect keyboard events in the <webview> and dispatch them to our\n\t\t\t// keybinding service because these events do not bubble to the parent window anymore.\n\t\t\tthis.handleKeyEvent('keydown', data);\n\t\t}));\n\n\t\tthis._register(this.on('did-keyup', (data) => {\n\t\t\tthis.handleKeyEvent('keyup', data);\n\t\t}));\n\n\t\tthis._register(this.on('did-context-menu', (data) => {\n\t\t\tif (!this.element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._contextKeyService) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst elementBox = this.element.getBoundingClientRect();\n\t\t\tconst contextKeyService = this._contextKeyService.createOverlay([\n\t\t\t\t...Object.entries(data.context),\n\t\t\t\t[webviewIdContext, this.providedViewType],\n\t\t\t]);\n\t\t\tcontextMenuService.showContextMenu({\n\t\t\t\tmenuId: MenuId.WebviewContext,\n\t\t\t\tmenuActionOptions: { shouldForwardArgs: true },\n\t\t\t\tcontextKeyService,\n\t\t\t\tgetActionsContext: (): WebviewActionContext => ({ ...data.context, webview: this.providedViewType }),\n\t\t\t\tgetAnchor: () => ({\n\t\t\t\t\tx: elementBox.x + data.clientX,\n\t\t\t\t\ty: elementBox.y + data.clientY\n\t\t\t\t})\n\t\t\t});\n\t\t\tthis._send('set-context-menu-visible', { visible: true });\n\t\t}));\n\n\t\tthis._register(this.on('load-resource', async (entry) => {\n\t\t\ttry {\n\t\t\t\t// Restore the authority we previously encoded\n\t\t\t\tconst authority = decodeAuthority(entry.authority);\n\t\t\t\tconst uri = URI.from({\n\t\t\t\t\tscheme: entry.scheme,\n\t\t\t\t\tauthority: authority,\n\t\t\t\t\tpath: decodeURIComponent(entry.path), // This gets re-encoded\n\t\t\t\t\tquery: entry.query ? decodeURIComponent(entry.query) : entry.query,\n\t\t\t\t});\n\t\t\t\tthis.loadResource(entry.id, uri, entry.ifNoneMatch);\n\t\t\t} catch (e) {\n\t\t\t\tthis._send('did-load-resource', {\n\t\t\t\t\tid: entry.id,\n\t\t\t\t\tstatus: 404,\n\t\t\t\t\tpath: entry.path,\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.on('load-localhost', (entry) => {\n\t\t\tthis.localLocalhost(entry.id, entry.origin);\n\t\t}));\n\n\t\tthis._register(Event.runAndSubscribe(webviewThemeDataProvider.onThemeDataChanged, () => this.style()));\n\t\tthis._register(_accessibilityService.onDidChangeReducedMotion(() => this.style()));\n\t\tthis._register(_accessibilityService.onDidChangeScreenReaderOptimized(() => this.style()));\n\t\tthis._register(contextMenuService.onDidHideContextMenu(() => this._send('set-context-menu-visible', { visible: false })));\n\n\t\tthis._confirmBeforeClose = configurationService.getValue<string>('window.confirmBeforeClose');\n\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('window.confirmBeforeClose')) {\n\t\t\t\tthis._confirmBeforeClose = configurationService.getValue('window.confirmBeforeClose');\n\t\t\t\tthis._send('set-confirm-before-close', this._confirmBeforeClose);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.on('drag-start', () => {\n\t\t\tthis._startBlockingIframeDragEvents();\n\t\t}));\n\n\t\tthis._register(this.on('drag', (event) => {\n\t\t\tthis.handleDragEvent('drag', event);\n\t\t}));\n\n\t\tthis._register(this.on('updated-intrinsic-content-size', (event) => {\n\t\t\tthis.intrinsicContentSize.set({ width: event.width, height: event.height }, undefined, undefined);\n\t\t}));\n\n\t\tif (initInfo.options.enableFindWidget) {\n\t\t\tthis._webviewFindWidget = this._register(instantiationService.createInstance(WebviewFindWidget, this));\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tthis._disposed = true;\n\n\t\tthis.element?.remove();\n\t\tthis._element = undefined;\n\n\t\tthis._messagePort = undefined;\n\n\t\tif (this._state.type === WebviewState.Type.Initializing) {\n\t\t\tfor (const message of this._state.pendingMessages) {\n\t\t\t\tmessage.resolve(false);\n\t\t\t}\n\t\t\tthis._state.pendingMessages = [];\n\t\t}\n\n\t\tthis._onDidDispose.fire();\n\n\t\tthis._resourceLoadingCts.dispose(true);\n\n\t\tsuper.dispose();\n\t}\n\n\tsetContextKeyService(contextKeyService: IContextKeyService) {\n\t\tthis._contextKeyService = contextKeyService;\n\t}\n\n\tprivate readonly _onMissingCsp = this._register(new Emitter<ExtensionIdentifier>());\n\tpublic readonly onMissingCsp = this._onMissingCsp.event;\n\n\tprivate readonly _onDidClickLink = this._register(new Emitter<string>());\n\tpublic readonly onDidClickLink = this._onDidClickLink.event;\n\n\tprivate readonly _onMessage = this._register(new Emitter<WebviewMessageReceivedEvent>());\n\tpublic readonly onMessage = this._onMessage.event;\n\n\tprivate readonly _onDidScroll = this._register(new Emitter<{ readonly scrollYPercentage: number }>());\n\tpublic readonly onDidScroll = this._onDidScroll.event;\n\n\tprivate readonly _onDidWheel = this._register(new Emitter<IMouseWheelEvent>());\n\tpublic readonly onDidWheel = this._onDidWheel.event;\n\n\tprivate readonly _onDidUpdateState = this._register(new Emitter<string | undefined>());\n\tpublic readonly onDidUpdateState = this._onDidUpdateState.event;\n\n\tprivate readonly _onDidFocus = this._register(new Emitter<void>());\n\tpublic readonly onDidFocus = this._onDidFocus.event;\n\n\tprivate readonly _onDidBlur = this._register(new Emitter<void>());\n\tpublic readonly onDidBlur = this._onDidBlur.event;\n\n\tprivate readonly _onFatalError = this._register(new Emitter<{ readonly message: string }>());\n\tpublic readonly onFatalError = this._onFatalError.event;\n\n\tprivate readonly _onDidDispose = this._register(new Emitter<void>());\n\tpublic readonly onDidDispose = this._onDidDispose.event;\n\n\tpublic postMessage(message: any, transfer?: ArrayBuffer[]): Promise<boolean> {\n\t\treturn this._send('message', { message, transfer });\n\t}\n\n\tprivate async _send<K extends keyof ToWebviewMessage>(channel: K, data: ToWebviewMessage[K], _createElement: Transferable[] = []): Promise<boolean> {\n\t\tif (this._state.type === WebviewState.Type.Initializing) {\n\t\t\tconst { promise, resolve } = promiseWithResolvers<boolean>();\n\t\t\tthis._state.pendingMessages.push({ channel, data, transferable: _createElement, resolve });\n\t\t\treturn promise;\n\t\t} else {\n\t\t\treturn this.doPostMessage(channel, data, _createElement);\n\t\t}\n\t}\n\n\tprivate _createElement(options: WebviewOptions, _contentOptions: WebviewContentOptions) {\n\t\t// Do not start loading the webview yet.\n\t\t// Wait the end of the ctor when all listeners have been hooked up.\n\t\tconst element = document.createElement('iframe');\n\t\telement.name = this.id;\n\t\telement.className = `webview ${options.customClasses || ''}`;\n\t\telement.sandbox.add('allow-scripts', 'allow-same-origin', 'allow-forms', 'allow-pointer-lock', 'allow-downloads');\n\n\t\tconst allowRules = ['cross-origin-isolated', 'autoplay'];\n\t\tif (!isFirefox) {\n\t\t\tallowRules.push('clipboard-read', 'clipboard-write');\n\t\t}\n\t\telement.setAttribute('allow', allowRules.join('; '));\n\n\t\telement.style.border = 'none';\n\t\telement.style.width = '100%';\n\t\telement.style.height = '100%';\n\n\t\telement.focus = () => {\n\t\t\tthis._doFocus();\n\t\t};\n\n\t\treturn element;\n\t}\n\n\tprivate _initElement(encodedWebviewOrigin: string, extension: WebviewExtensionDescription | undefined, options: WebviewOptions, targetWindow: CodeWindow) {\n\t\t// The extensionId and purpose in the URL are used for filtering in js-debug:\n\t\tconst params: { [key: string]: string } = {\n\t\t\tid: this.id,\n\t\t\tparentId: targetWindow.vscodeWindowId.toString(),\n\t\t\torigin: this.origin,\n\t\t\tswVersion: String(this._expectedServiceWorkerVersion),\n\t\t\textensionId: extension?.id.value ?? '',\n\t\t\tplatform: this.platform,\n\t\t\t'vscode-resource-base-authority': webviewRootResourceAuthority,\n\t\t\tparentOrigin: targetWindow.origin,\n\t\t};\n\n\t\tif (this._options.disableServiceWorker) {\n\t\t\tparams.disableServiceWorker = 'true';\n\t\t}\n\n\t\tif (this._environmentService.remoteAuthority) {\n\t\t\tparams.remoteAuthority = this._environmentService.remoteAuthority;\n\t\t}\n\n\t\tif (options.purpose) {\n\t\t\tparams.purpose = options.purpose;\n\t\t}\n\n\t\tCOI.addSearchParam(params, true, true);\n\n\t\tconst queryString = new URLSearchParams(params).toString();\n\n\t\tthis.perfMark('init/set-src');\n\t\tconst fileName = 'index.html';\n\t\tthis.element!.setAttribute('src', `${this.webviewContentEndpoint(encodedWebviewOrigin)}/${fileName}?${queryString}`);\n\t}\n\n\tpublic mountTo(element: HTMLElement, targetWindow: CodeWindow) {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._windowId = targetWindow.vscodeWindowId;\n\t\tthis._encodedWebviewOriginPromise = parentOriginHash(targetWindow.origin, this.origin).then(id => this._encodedWebviewOrigin = id);\n\t\tthis._encodedWebviewOriginPromise.then(encodedWebviewOrigin => {\n\t\t\tif (!this._disposed) {\n\t\t\t\tthis._initElement(encodedWebviewOrigin, this.extension, this._options, targetWindow);\n\t\t\t}\n\t\t});\n\t\tthis._registerMessageHandler(targetWindow);\n\n\t\tif (this._webviewFindWidget) {\n\t\t\telement.appendChild(this._webviewFindWidget.getDomNode());\n\t\t}\n\n\t\tfor (const eventName of [EventType.MOUSE_DOWN, EventType.MOUSE_MOVE, EventType.DROP]) {\n\t\t\tthis._register(addDisposableListener(element, eventName, () => {\n\t\t\t\tthis._stopBlockingIframeDragEvents();\n\t\t\t}));\n\t\t}\n\n\t\tfor (const node of [element, targetWindow]) {\n\t\t\tthis._register(addDisposableListener(node, EventType.DRAG_END, () => {\n\t\t\t\tthis._stopBlockingIframeDragEvents();\n\t\t\t}));\n\t\t}\n\n\t\telement.id = this.id; // This is used by aria-flow for accessibility order\n\n\t\tthis.perfMark('mounted');\n\t\telement.appendChild(this.element);\n\t}\n\n\tprivate _registerMessageHandler(targetWindow: CodeWindow) {\n\t\tconst subscription = this._register(addDisposableListener(targetWindow, 'message', (e: MessageEvent) => {\n\t\t\tif (!this._encodedWebviewOrigin || e?.data?.target !== this.id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (e.origin !== this._webviewContentOrigin(this._encodedWebviewOrigin)) {\n\t\t\t\tconsole.log(`Skipped renderer receiving message due to mismatched origins: ${e.origin} ${this._webviewContentOrigin}`);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (e.data.channel === 'webview-ready') {\n\t\t\t\tif (this._messagePort) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.perfMark('webview-ready');\n\t\t\t\tthis._logService.trace(`Webview(${this.id}): webview ready`);\n\n\t\t\t\tthis._messagePort = e.ports[0];\n\t\t\t\tthis._messagePort.onmessage = (e) => {\n\t\t\t\t\tconst handlers = this._messageHandlers.get(e.data.channel);\n\t\t\t\t\tif (!handlers) {\n\t\t\t\t\t\tconsole.log(`No handlers found for '${e.data.channel}'`);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\thandlers?.forEach(handler => handler(e.data.data, e));\n\t\t\t\t};\n\n\t\t\t\tthis.element?.classList.add('ready');\n\n\t\t\t\tif (this._state.type === WebviewState.Type.Initializing) {\n\t\t\t\t\tthis._state.pendingMessages.forEach(({ channel, data, resolve }) => resolve(this.doPostMessage(channel, data)));\n\t\t\t\t}\n\t\t\t\tthis._state = WebviewState.Ready;\n\n\t\t\t\tsubscription.dispose();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate perfMark(name: string) {\n\t\tperformance.mark(`webview/webviewElement/${name}`, {\n\t\t\tdetail: {\n\t\t\t\tid: this.id\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _startBlockingIframeDragEvents() {\n\t\tif (this.element) {\n\t\t\tthis.element.style.pointerEvents = 'none';\n\t\t}\n\t}\n\n\tprivate _stopBlockingIframeDragEvents() {\n\t\tif (this.element) {\n\t\t\tthis.element.style.pointerEvents = 'auto';\n\t\t}\n\t}\n\n\tprotected webviewContentEndpoint(encodedWebviewOrigin: string): string {\n\t\tconst webviewExternalEndpoint = this._environmentService.webviewExternalEndpoint;\n\t\tif (!webviewExternalEndpoint) {\n\t\t\tthrow new Error(`'webviewExternalEndpoint' has not been configured. Webviews will not work!`);\n\t\t}\n\n\t\tconst endpoint = webviewExternalEndpoint.replace('{{uuid}}', encodedWebviewOrigin);\n\t\tif (endpoint[endpoint.length - 1] === '/') {\n\t\t\treturn endpoint.slice(0, endpoint.length - 1);\n\t\t}\n\t\treturn endpoint;\n\t}\n\n\tprivate _webviewContentOrigin(encodedWebviewOrigin: string): string {\n\t\tconst uri = URI.parse(this.webviewContentEndpoint(encodedWebviewOrigin));\n\t\treturn uri.scheme + '://' + uri.authority.toLowerCase();\n\t}\n\n\tprivate doPostMessage(channel: string, data?: any, transferable: Transferable[] = []): boolean {\n\t\tif (this.element && this._messagePort) {\n\t\t\tthis._messagePort.postMessage({ channel, args: data }, transferable);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate on<K extends keyof FromWebviewMessage>(channel: K, handler: (data: FromWebviewMessage[K], e: MessageEvent) => void): IDisposable {\n\t\tlet handlers = this._messageHandlers.get(channel);\n\t\tif (!handlers) {\n\t\t\thandlers = new Set();\n\t\t\tthis._messageHandlers.set(channel, handlers);\n\t\t}\n\n\t\thandlers.add(handler);\n\t\treturn toDisposable(() => {\n\t\t\tthis._messageHandlers.get(channel)?.delete(handler);\n\t\t});\n\t}\n\n\tprivate _hasAlertedAboutMissingCsp = false;\n\tprivate handleNoCspFound(): void {\n\t\tif (this._hasAlertedAboutMissingCsp) {\n\t\t\treturn;\n\t\t}\n\t\tthis._hasAlertedAboutMissingCsp = true;\n\n\t\tif (this.extension?.id) {\n\t\t\tif (this._environmentService.isExtensionDevelopment) {\n\t\t\t\tthis._onMissingCsp.fire(this.extension.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic reload(): void {\n\t\tthis.doUpdateContent(this._content);\n\t}\n\n\tpublic reinitializeAfterDismount(): void {\n\t\tthis._state = new WebviewState.Initializing([]);\n\t\tthis._messagePort = undefined;\n\n\t\tthis.mountTo(this.element!.parentElement!, getWindow(this.element));\n\t\tthis.reload();\n\t}\n\n\tpublic setHtml(html: string) {\n\t\tthis.doUpdateContent({ ...this._content, html });\n\t\tthis._onDidHtmlChange.fire(html);\n\t}\n\n\tpublic setTitle(title: string) {\n\t\tthis._content = { ...this._content, title };\n\t\tthis._send('set-title', title);\n\t}\n\n\tpublic set contentOptions(options: WebviewContentOptions) {\n\t\tthis._logService.debug(`Webview(${this.id}): will update content options`);\n\n\t\tif (areWebviewContentOptionsEqual(options, this._content.options)) {\n\t\t\tthis._logService.debug(`Webview(${this.id}): skipping content options update`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.doUpdateContent({ ...this._content, options });\n\t}\n\n\tpublic set localResourcesRoot(resources: readonly URI[]) {\n\t\tthis._content = {\n\t\t\t...this._content,\n\t\t\toptions: { ...this._content.options, localResourceRoots: resources }\n\t\t};\n\t}\n\n\tpublic set state(state: string | undefined) {\n\t\tthis._content = { ...this._content, state };\n\t}\n\n\tpublic set initialScrollProgress(value: number) {\n\t\tthis._send('initial-scroll-position', value);\n\t}\n\n\tprivate doUpdateContent(newContent: WebviewContent) {\n\t\tthis._logService.debug(`Webview(${this.id}): will update content`);\n\n\t\tthis._content = newContent;\n\n\t\tconst allowScripts = !!this._content.options.allowScripts;\n\t\tthis.perfMark('set-content');\n\t\tthis._send('content', {\n\t\t\tcontents: this._content.html,\n\t\t\ttitle: this._content.title,\n\t\t\toptions: {\n\t\t\t\tallowMultipleAPIAcquire: !!this._content.options.allowMultipleAPIAcquire,\n\t\t\t\tallowScripts: allowScripts,\n\t\t\t\tallowForms: this._content.options.allowForms ?? allowScripts, // For back compat, we allow forms by default when scripts are enabled\n\t\t\t},\n\t\t\tstate: this._content.state,\n\t\t\tcspSource: webviewGenericCspSource,\n\t\t\tconfirmBeforeClose: this._confirmBeforeClose,\n\t\t});\n\t}\n\n\tprotected style(): void {\n\t\tlet { styles, activeTheme, themeLabel, themeId } = this.webviewThemeDataProvider.getWebviewThemeData();\n\t\tif (this._options.transformCssVariables) {\n\t\t\tstyles = this._options.transformCssVariables(styles);\n\t\t}\n\n\t\tconst reduceMotion = this._accessibilityService.isMotionReduced();\n\t\tconst screenReader = this._accessibilityService.isScreenReaderOptimized();\n\n\t\tthis._send('styles', { styles, activeTheme, themeId, themeLabel, reduceMotion, screenReader });\n\t}\n\n\n\tprotected handleFocusChange(isFocused: boolean): void {\n\t\tthis._focused = isFocused;\n\t\tif (isFocused) {\n\t\t\tthis._onDidFocus.fire();\n\t\t} else {\n\t\t\tthis._onDidBlur.fire();\n\t\t}\n\t}\n\n\tprivate handleKeyEvent(type: 'keydown' | 'keyup', event: KeyEvent) {\n\t\t// Create a fake KeyboardEvent from the data provided\n\t\tconst emulatedKeyboardEvent = new KeyboardEvent(type, event);\n\t\t// Force override the target\n\t\tObject.defineProperty(emulatedKeyboardEvent, 'target', {\n\t\t\tget: () => this.element,\n\t\t});\n\t\t// And re-dispatch\n\t\tthis.window?.dispatchEvent(emulatedKeyboardEvent);\n\t}\n\n\tprivate handleDragEvent(type: 'drag', event: WebViewDragEvent) {\n\t\t// Create a fake DragEvent from the data provided\n\t\tconst emulatedDragEvent = new DragEvent(type, event);\n\t\t// Force override the target\n\t\tObject.defineProperty(emulatedDragEvent, 'target', {\n\t\t\tget: () => this.element,\n\t\t});\n\t\t// And re-dispatch\n\t\tthis.window?.dispatchEvent(emulatedDragEvent);\n\t}\n\n\twindowDidDragStart(): void {\n\t\t// Webview break drag and dropping around the main window (no events are generated when you are over them)\n\t\t// Work around this by disabling pointer events during the drag.\n\t\t// https://github.com/electron/electron/issues/18226\n\t\tthis._startBlockingIframeDragEvents();\n\t}\n\n\twindowDidDragEnd(): void {\n\t\tthis._stopBlockingIframeDragEvents();\n\t}\n\n\tpublic selectAll() {\n\t\tthis.execCommand('selectAll');\n\t}\n\n\tpublic copy() {\n\t\tthis.execCommand('copy');\n\t}\n\n\tpublic paste() {\n\t\tthis.execCommand('paste');\n\t}\n\n\tpublic cut() {\n\t\tthis.execCommand('cut');\n\t}\n\n\tpublic undo() {\n\t\tthis.execCommand('undo');\n\t}\n\n\tpublic redo() {\n\t\tthis.execCommand('redo');\n\t}\n\n\tprivate execCommand(command: string) {\n\t\tif (this.element) {\n\t\t\tthis._send('execCommand', command);\n\t\t}\n\t}\n\n\tprivate async loadResource(id: number, uri: URI, ifNoneMatch: string | undefined) {\n\t\ttry {\n\t\t\tconst result = await loadLocalResource(uri, {\n\t\t\t\tifNoneMatch,\n\t\t\t\troots: this._content.options.localResourceRoots || [],\n\t\t\t}, this._fileService, this._logService, this._resourceLoadingCts.token);\n\n\t\t\tswitch (result.type) {\n\t\t\t\tcase WebviewResourceResponse.Type.Success: {\n\t\t\t\t\tconst buffer = await this.streamToBuffer(result.stream);\n\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tstatus: 200,\n\t\t\t\t\t\tpath: uri.path,\n\t\t\t\t\t\tmime: result.mimeType,\n\t\t\t\t\t\tdata: buffer,\n\t\t\t\t\t\tetag: result.etag,\n\t\t\t\t\t\tmtime: result.mtime\n\t\t\t\t\t}, [buffer]);\n\t\t\t\t}\n\t\t\t\tcase WebviewResourceResponse.Type.NotModified: {\n\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tstatus: 304, // not modified\n\t\t\t\t\t\tpath: uri.path,\n\t\t\t\t\t\tmime: result.mimeType,\n\t\t\t\t\t\tmtime: result.mtime\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcase WebviewResourceResponse.Type.AccessDenied: {\n\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tstatus: 401, // unauthorized\n\t\t\t\t\t\tpath: uri.path,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {\n\t\t\t// noop\n\t\t}\n\n\t\treturn this._send('did-load-resource', {\n\t\t\tid,\n\t\t\tstatus: 404,\n\t\t\tpath: uri.path,\n\t\t});\n\t}\n\n\tprotected async streamToBuffer(stream: VSBufferReadableStream): Promise<ArrayBufferLike> {\n\t\tconst vsBuffer = await streamToBuffer(stream);\n\t\treturn vsBuffer.buffer.buffer;\n\t}\n\n\tprivate async localLocalhost(id: string, origin: string) {\n\t\tconst authority = this._environmentService.remoteAuthority;\n\t\tconst resolveAuthority = authority ? await this._remoteAuthorityResolverService.resolveAuthority(authority) : undefined;\n\t\tconst redirect = resolveAuthority ? await this._portMappingManager.getRedirect(resolveAuthority.authority, origin) : undefined;\n\t\treturn this._send('did-load-localhost', {\n\t\t\tid,\n\t\t\torigin,\n\t\t\tlocation: redirect\n\t\t});\n\t}\n\n\tpublic focus(): void {\n\t\tthis._doFocus();\n\n\t\t// Handle focus change programmatically (do not rely on event from <webview>)\n\t\tthis.handleFocusChange(true);\n\t}\n\n\tprivate _doFocus() {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis.element.contentWindow?.focus();\n\t\t} catch {\n\t\t\t// noop\n\t\t}\n\n\t\t// Workaround for https://github.com/microsoft/vscode/issues/75209\n\t\t// Focusing the inner webview is async so for a sequence of actions such as:\n\t\t//\n\t\t// 1. Open webview\n\t\t// 1. Show quick pick from command palette\n\t\t//\n\t\t// We end up focusing the webview after showing the quick pick, which causes\n\t\t// the quick pick to instantly dismiss.\n\t\t//\n\t\t// Workaround this by debouncing the focus and making sure we are not focused on an input\n\t\t// when we try to re-focus.\n\t\tthis._focusDelayer.trigger(async () => {\n\t\t\tif (!this.isFocused || !this.element) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.window?.document.activeElement && this.window.document.activeElement !== this.element && this.window.document.activeElement?.tagName !== 'BODY') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// It is possible for the webview to be contained in another window\n\t\t\t// that does not have focus. As such, also focus the body of the\n\t\t\t// webview's window to ensure it is properly receiving keyboard focus.\n\t\t\tthis.window?.document.body?.focus();\n\n\t\t\tthis._send('focus', undefined);\n\t\t});\n\t}\n\n\tprotected readonly _hasFindResult = this._register(new Emitter<boolean>());\n\tpublic readonly hasFindResult: Event<boolean> = this._hasFindResult.event;\n\n\tprotected readonly _onDidStopFind = this._register(new Emitter<void>());\n\tpublic readonly onDidStopFind: Event<void> = this._onDidStopFind.event;\n\n\t/**\n\t * Webviews expose a stateful find API.\n\t * Successive calls to find will move forward or backward through onFindResults\n\t * depending on the supplied options.\n\t *\n\t * @param value The string to search for. Empty strings are ignored.\n\t */\n\tpublic find(value: string, previous: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._send('find', { value, previous });\n\t}\n\n\tpublic updateFind(value: string) {\n\t\tif (!value || !this.element) {\n\t\t\treturn;\n\t\t}\n\t\tthis._send('find', { value });\n\t}\n\n\tpublic stopFind(keepSelection?: boolean): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\t\tthis._send('find-stop', { clearSelection: !keepSelection });\n\t\tthis._onDidStopFind.fire();\n\t}\n\n\tpublic showFind(animated = true) {\n\t\tthis._webviewFindWidget?.reveal(undefined, animated);\n\t}\n\n\tpublic hideFind(animated = true) {\n\t\tthis._webviewFindWidget?.hide(animated);\n\t}\n\n\tpublic runFindAction(previous: boolean) {\n\t\tthis._webviewFindWidget?.find(previous);\n\t}\n}\n"]}