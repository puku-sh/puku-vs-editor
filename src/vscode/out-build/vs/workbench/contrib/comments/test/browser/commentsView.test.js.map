{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/comments/test/browser/commentsView.test.ts","vs/workbench/contrib/comments/test/browser/commentsView.test.ts"],"names":[],"mappings":"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","file":"commentsView.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { IRange, Range } from '../../../../../editor/common/core/range.js';\nimport { CommentsPanel } from '../../browser/commentsView.js';\nimport { CommentService, ICommentController, ICommentInfo, ICommentService, INotebookCommentInfo } from '../../browser/commentService.js';\nimport { Comment, CommentInput, CommentReaction, CommentThread, CommentThreadCollapsibleState, CommentThreadState } from '../../../../../editor/common/languages.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IViewContainerModel, IViewDescriptor, IViewDescriptorService, IViewPaneContainer, ViewContainer, ViewContainerLocation } from '../../../../common/views.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IContextViewService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { NullHoverService } from '../../../../../platform/hover/test/browser/nullHoverService.js';\nimport { SyncDescriptor } from '../../../../../platform/instantiation/common/descriptors.js';\n\nclass TestCommentThread implements CommentThread<IRange> {\n\tisDocumentCommentThread(): this is CommentThread<IRange> {\n\t\treturn true;\n\t}\n\tconstructor(public readonly commentThreadHandle: number,\n\t\tpublic readonly controllerHandle: number,\n\t\tpublic readonly threadId: string,\n\t\tpublic readonly resource: string,\n\t\tpublic readonly range: IRange,\n\t\tpublic readonly comments: Comment[]) { }\n\n\treadonly onDidChangeComments: Event<readonly Comment[] | undefined> = new Emitter<readonly Comment[] | undefined>().event;\n\treadonly onDidChangeInitialCollapsibleState: Event<CommentThreadCollapsibleState | undefined> = new Emitter<CommentThreadCollapsibleState | undefined>().event;\n\tcanReply: boolean = false;\n\treadonly onDidChangeInput: Event<CommentInput | undefined> = new Emitter<CommentInput | undefined>().event;\n\treadonly onDidChangeRange: Event<IRange> = new Emitter<IRange>().event;\n\treadonly onDidChangeLabel: Event<string | undefined> = new Emitter<string | undefined>().event;\n\treadonly onDidChangeCollapsibleState: Event<CommentThreadCollapsibleState | undefined> = new Emitter<CommentThreadCollapsibleState | undefined>().event;\n\treadonly onDidChangeState: Event<CommentThreadState | undefined> = new Emitter<CommentThreadState | undefined>().event;\n\treadonly onDidChangeCanReply: Event<boolean> = new Emitter<boolean>().event;\n\tisDisposed: boolean = false;\n\tisTemplate: boolean = false;\n\tlabel: string | undefined = undefined;\n\tcontextValue: string | undefined = undefined;\n}\n\nclass TestCommentController implements ICommentController {\n\tactiveComment: { thread: CommentThread; comment?: Comment } | undefined;\n\tid: string = 'test';\n\tlabel: string = 'Test Comments';\n\towner: string = 'test';\n\tfeatures = {};\n\tcreateCommentThreadTemplate(resource: UriComponents, range: IRange | undefined): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tupdateCommentThreadTemplate(threadHandle: number, range: IRange): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tdeleteCommentThreadMain(commentThreadId: string): void {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\ttoggleReaction(uri: URI, thread: CommentThread<IRange>, comment: Comment, reaction: CommentReaction, token: CancellationToken): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tgetDocumentComments(resource: URI, token: CancellationToken): Promise<ICommentInfo> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tgetNotebookComments(resource: URI, token: CancellationToken): Promise<INotebookCommentInfo> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tsetActiveCommentAndThread(commentInfo: { thread: CommentThread; comment: Comment } | undefined): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n}\n\nexport class TestViewDescriptorService implements Partial<IViewDescriptorService> {\n\tgetViewLocationById(id: string): ViewContainerLocation | null {\n\t\treturn ViewContainerLocation.Panel;\n\t}\n\treadonly onDidChangeLocation: Event<{ views: IViewDescriptor[]; from: ViewContainerLocation; to: ViewContainerLocation }> = new Emitter<{ views: IViewDescriptor[]; from: ViewContainerLocation; to: ViewContainerLocation }>().event;\n\tgetViewDescriptorById(id: string): IViewDescriptor | null {\n\t\treturn null;\n\t}\n\tgetViewContainerByViewId(id: string): ViewContainer | null {\n\t\treturn {\n\t\t\tid: 'comments',\n\t\t\ttitle: { value: 'Comments', original: 'Comments' },\n\t\t\tctorDescriptor: {} as SyncDescriptor<IViewPaneContainer>\n\t\t};\n\t}\n\tgetViewContainerModel(viewContainer: ViewContainer): IViewContainerModel {\n\t\tconst partialViewContainerModel: Partial<IViewContainerModel> = {\n\t\t\tonDidChangeContainerInfo: new Emitter<{ title?: boolean; icon?: boolean; keybindingId?: boolean }>().event\n\t\t};\n\t\treturn partialViewContainerModel as IViewContainerModel;\n\t}\n\tgetDefaultContainerById(id: string): ViewContainer | null {\n\t\treturn null;\n\t}\n}\n\nsuite('Comments View', function () {\n\tteardown(() => {\n\t\tinstantiationService.dispose();\n\t\tcommentService.dispose();\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet commentService: CommentService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = workbenchInstantiationService({}, disposables);\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(IHoverService, NullHoverService);\n\t\tinstantiationService.stub(IContextViewService, {});\n\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\tcommentService = instantiationService.createInstance(CommentService);\n\t\tinstantiationService.stub(ICommentService, commentService);\n\t\tcommentService.registerCommentController('test', new TestCommentController());\n\t});\n\n\n\n\ttest('collapse all', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.areAllCommentsExpanded(), true);\n\t\tview.collapseAll();\n\t\tassert.strictEqual(view.isSomeCommentsExpanded(), false);\n\t\tview.dispose();\n\t});\n\n\ttest('expand all', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tview.collapseAll();\n\t\tassert.strictEqual(view.isSomeCommentsExpanded(), false);\n\t\tview.expandAll();\n\t\tassert.strictEqual(view.areAllCommentsExpanded(), true);\n\t\tview.dispose();\n\t});\n\n\ttest('filter by text', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.setVisible(true);\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'This comment is a cat.', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'This comment is a dog.', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 2);\n\t\tview.getFilterWidget().setFilterText('cat');\n\t\t// Setting showResolved causes the filter to trigger for the purposes of this test.\n\t\tview.filters.showResolved = false;\n\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 1);\n\t\tview.clearFilterText();\n\t\t// Setting showResolved causes the filter to trigger for the purposes of this test.\n\t\tview.filters.showResolved = true;\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 2);\n\t\tview.dispose();\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { IRange, Range } from '../../../../../editor/common/core/range.js';\nimport { CommentsPanel } from '../../browser/commentsView.js';\nimport { CommentService, ICommentController, ICommentInfo, ICommentService, INotebookCommentInfo } from '../../browser/commentService.js';\nimport { Comment, CommentInput, CommentReaction, CommentThread, CommentThreadCollapsibleState, CommentThreadState } from '../../../../../editor/common/languages.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IViewContainerModel, IViewDescriptor, IViewDescriptorService, IViewPaneContainer, ViewContainer, ViewContainerLocation } from '../../../../common/views.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IContextViewService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { NullHoverService } from '../../../../../platform/hover/test/browser/nullHoverService.js';\nimport { SyncDescriptor } from '../../../../../platform/instantiation/common/descriptors.js';\n\nclass TestCommentThread implements CommentThread<IRange> {\n\tisDocumentCommentThread(): this is CommentThread<IRange> {\n\t\treturn true;\n\t}\n\tconstructor(public readonly commentThreadHandle: number,\n\t\tpublic readonly controllerHandle: number,\n\t\tpublic readonly threadId: string,\n\t\tpublic readonly resource: string,\n\t\tpublic readonly range: IRange,\n\t\tpublic readonly comments: Comment[]) { }\n\n\treadonly onDidChangeComments: Event<readonly Comment[] | undefined> = new Emitter<readonly Comment[] | undefined>().event;\n\treadonly onDidChangeInitialCollapsibleState: Event<CommentThreadCollapsibleState | undefined> = new Emitter<CommentThreadCollapsibleState | undefined>().event;\n\tcanReply: boolean = false;\n\treadonly onDidChangeInput: Event<CommentInput | undefined> = new Emitter<CommentInput | undefined>().event;\n\treadonly onDidChangeRange: Event<IRange> = new Emitter<IRange>().event;\n\treadonly onDidChangeLabel: Event<string | undefined> = new Emitter<string | undefined>().event;\n\treadonly onDidChangeCollapsibleState: Event<CommentThreadCollapsibleState | undefined> = new Emitter<CommentThreadCollapsibleState | undefined>().event;\n\treadonly onDidChangeState: Event<CommentThreadState | undefined> = new Emitter<CommentThreadState | undefined>().event;\n\treadonly onDidChangeCanReply: Event<boolean> = new Emitter<boolean>().event;\n\tisDisposed: boolean = false;\n\tisTemplate: boolean = false;\n\tlabel: string | undefined = undefined;\n\tcontextValue: string | undefined = undefined;\n}\n\nclass TestCommentController implements ICommentController {\n\tactiveComment: { thread: CommentThread; comment?: Comment } | undefined;\n\tid: string = 'test';\n\tlabel: string = 'Test Comments';\n\towner: string = 'test';\n\tfeatures = {};\n\tcreateCommentThreadTemplate(resource: UriComponents, range: IRange | undefined): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tupdateCommentThreadTemplate(threadHandle: number, range: IRange): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tdeleteCommentThreadMain(commentThreadId: string): void {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\ttoggleReaction(uri: URI, thread: CommentThread<IRange>, comment: Comment, reaction: CommentReaction, token: CancellationToken): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tgetDocumentComments(resource: URI, token: CancellationToken): Promise<ICommentInfo> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tgetNotebookComments(resource: URI, token: CancellationToken): Promise<INotebookCommentInfo> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\tsetActiveCommentAndThread(commentInfo: { thread: CommentThread; comment: Comment } | undefined): Promise<void> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n}\n\nexport class TestViewDescriptorService implements Partial<IViewDescriptorService> {\n\tgetViewLocationById(id: string): ViewContainerLocation | null {\n\t\treturn ViewContainerLocation.Panel;\n\t}\n\treadonly onDidChangeLocation: Event<{ views: IViewDescriptor[]; from: ViewContainerLocation; to: ViewContainerLocation }> = new Emitter<{ views: IViewDescriptor[]; from: ViewContainerLocation; to: ViewContainerLocation }>().event;\n\tgetViewDescriptorById(id: string): IViewDescriptor | null {\n\t\treturn null;\n\t}\n\tgetViewContainerByViewId(id: string): ViewContainer | null {\n\t\treturn {\n\t\t\tid: 'comments',\n\t\t\ttitle: { value: 'Comments', original: 'Comments' },\n\t\t\tctorDescriptor: {} as SyncDescriptor<IViewPaneContainer>\n\t\t};\n\t}\n\tgetViewContainerModel(viewContainer: ViewContainer): IViewContainerModel {\n\t\tconst partialViewContainerModel: Partial<IViewContainerModel> = {\n\t\t\tonDidChangeContainerInfo: new Emitter<{ title?: boolean; icon?: boolean; keybindingId?: boolean }>().event\n\t\t};\n\t\treturn partialViewContainerModel as IViewContainerModel;\n\t}\n\tgetDefaultContainerById(id: string): ViewContainer | null {\n\t\treturn null;\n\t}\n}\n\nsuite('Comments View', function () {\n\tteardown(() => {\n\t\tinstantiationService.dispose();\n\t\tcommentService.dispose();\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet commentService: CommentService;\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = workbenchInstantiationService({}, disposables);\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(IHoverService, NullHoverService);\n\t\tinstantiationService.stub(IContextViewService, {});\n\t\tinstantiationService.stub(IViewDescriptorService, new TestViewDescriptorService());\n\t\tcommentService = instantiationService.createInstance(CommentService);\n\t\tinstantiationService.stub(ICommentService, commentService);\n\t\tcommentService.registerCommentController('test', new TestCommentController());\n\t});\n\n\n\n\ttest('collapse all', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.areAllCommentsExpanded(), true);\n\t\tview.collapseAll();\n\t\tassert.strictEqual(view.isSomeCommentsExpanded(), false);\n\t\tview.dispose();\n\t});\n\n\ttest('expand all', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'test', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tview.collapseAll();\n\t\tassert.strictEqual(view.isSomeCommentsExpanded(), false);\n\t\tview.expandAll();\n\t\tassert.strictEqual(view.areAllCommentsExpanded(), true);\n\t\tview.dispose();\n\t});\n\n\ttest('filter by text', async function () {\n\t\tconst view = instantiationService.createInstance(CommentsPanel, { id: 'comments', title: 'Comments' });\n\t\tview.setVisible(true);\n\t\tview.render();\n\t\tcommentService.setWorkspaceComments('test', [\n\t\t\tnew TestCommentThread(1, 1, '1', 'test1', new Range(1, 1, 1, 1), [{ body: 'This comment is a cat.', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t\tnew TestCommentThread(2, 1, '1', 'test2', new Range(1, 1, 1, 1), [{ body: 'This comment is a dog.', uniqueIdInThread: 1, userName: 'alex' }]),\n\t\t]);\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 2);\n\t\tview.getFilterWidget().setFilterText('cat');\n\t\t// Setting showResolved causes the filter to trigger for the purposes of this test.\n\t\tview.filters.showResolved = false;\n\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 1);\n\t\tview.clearFilterText();\n\t\t// Setting showResolved causes the filter to trigger for the purposes of this test.\n\t\tview.filters.showResolved = true;\n\t\tassert.strictEqual(view.getFilterStats().total, 2);\n\t\tassert.strictEqual(view.getFilterStats().filtered, 2);\n\t\tview.dispose();\n\t});\n});\n"]}