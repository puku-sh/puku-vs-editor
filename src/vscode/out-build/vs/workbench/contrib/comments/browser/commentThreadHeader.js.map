{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentThreadHeader.ts"],"names":[],"mappings":"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","file":"commentThreadHeader.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action, ActionRunner } from '../../../../base/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, IDisposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { IRange } from '../../../../editor/common/core/range.js';\nimport * as nls from '../../../../nls.js';\nimport { createActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenu, MenuItemAction, SubmenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { CommentMenus } from './commentMenus.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MarshalledId } from '../../../../base/common/marshallingIds.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { MarshalledCommentThread } from '../../../common/comments.js';\nimport { CommentCommandId } from '../common/commentCommandIds.js';\n\nconst collapseIcon = registerIcon('review-comment-collapse', Codicon.chevronUp, nls.localize('collapseIcon', 'Icon to collapse a review comment.'));\nconst COLLAPSE_ACTION_CLASS = 'expand-review-action ' + ThemeIcon.asClassName(collapseIcon);\nconst DELETE_ACTION_CLASS = 'expand-review-action ' + ThemeIcon.asClassName(Codicon.trashcan);\n\nfunction threadHasComments(comments: ReadonlyArray<languages.Comment> | undefined): comments is ReadonlyArray<languages.Comment> {\n\treturn !!comments && comments.length > 0;\n}\n\nexport class CommentThreadHeader<T = IRange> extends Disposable {\n\tprivate _headElement: HTMLElement;\n\tprivate _headingLabel!: HTMLElement;\n\tprivate _actionbarWidget!: ActionBar;\n\tprivate _collapseAction!: Action;\n\tprivate _contextMenuActionRunner: ActionRunner | undefined;\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate _delegate: { collapse: () => void },\n\t\tprivate _commentMenus: CommentMenus,\n\t\tprivate _commentThread: languages.CommentThread<T>,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService\n\t) {\n\t\tsuper();\n\t\tthis._headElement = dom.$('.head');\n\t\tcontainer.appendChild(this._headElement);\n\t\tthis._register(toDisposable(() => this._headElement.remove()));\n\t\tthis._fillHead();\n\t}\n\n\tprotected _fillHead(): void {\n\t\tconst titleElement = dom.append(this._headElement, dom.$('.review-title'));\n\n\t\tthis._headingLabel = dom.append(titleElement, dom.$('span.filename'));\n\t\tthis.createThreadLabel();\n\n\t\tconst actionsContainer = dom.append(this._headElement, dom.$('.review-actions'));\n\t\tthis._actionbarWidget = new ActionBar(actionsContainer, {\n\t\t\tactionViewItemProvider: createActionViewItem.bind(undefined, this._instantiationService)\n\t\t});\n\n\t\tthis._register(this._actionbarWidget);\n\n\t\tconst collapseClass = threadHasComments(this._commentThread.comments) ? COLLAPSE_ACTION_CLASS : DELETE_ACTION_CLASS;\n\t\tthis._collapseAction = new Action(CommentCommandId.Hide, nls.localize('label.collapse', \"Collapse\"), collapseClass, true, () => this._delegate.collapse());\n\t\tif (!threadHasComments(this._commentThread.comments)) {\n\t\t\tconst commentsChanged: MutableDisposable<IDisposable> = this._register(new MutableDisposable());\n\t\t\tcommentsChanged.value = this._commentThread.onDidChangeComments(() => {\n\t\t\t\tif (threadHasComments(this._commentThread.comments)) {\n\t\t\t\t\tthis._collapseAction.class = COLLAPSE_ACTION_CLASS;\n\t\t\t\t\tcommentsChanged.clear();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst menu = this._commentMenus.getCommentThreadTitleActions(this._contextKeyService);\n\t\tthis._register(menu);\n\t\tthis.setActionBarActions(menu);\n\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(e => {\n\t\t\tthis.setActionBarActions(menu);\n\t\t}));\n\n\t\tthis._register(dom.addDisposableListener(this._headElement, dom.EventType.CONTEXT_MENU, e => {\n\t\t\treturn this.onContextMenu(e);\n\t\t}));\n\n\t\tthis._actionbarWidget.context = this._commentThread;\n\t}\n\n\tprivate setActionBarActions(menu: IMenu): void {\n\t\tconst groups = menu.getActions({ shouldForwardArgs: true }).reduce((r, [, actions]) => [...r, ...actions], <(MenuItemAction | SubmenuItemAction)[]>[]);\n\t\tthis._actionbarWidget.clear();\n\t\tthis._actionbarWidget.push([...groups, this._collapseAction], { label: false, icon: true });\n\t}\n\n\tupdateCommentThread(commentThread: languages.CommentThread<T>) {\n\t\tthis._commentThread = commentThread;\n\n\t\tthis._actionbarWidget.context = this._commentThread;\n\t\tthis.createThreadLabel();\n\t}\n\n\tcreateThreadLabel() {\n\t\tlet label: string | undefined;\n\t\tlabel = this._commentThread.label;\n\n\t\tif (label === undefined) {\n\t\t\tif (!(this._commentThread.comments && this._commentThread.comments.length)) {\n\t\t\t\tlabel = nls.localize('startThread', \"Start discussion\");\n\t\t\t}\n\t\t}\n\n\t\tif (label) {\n\t\t\tthis._headingLabel.textContent = strings.escape(label);\n\t\t\tthis._headingLabel.setAttribute('aria-label', label);\n\t\t}\n\t}\n\n\tupdateHeight(headHeight: number) {\n\t\tthis._headElement.style.height = `${headHeight}px`;\n\t\tthis._headElement.style.lineHeight = this._headElement.style.height;\n\t}\n\n\tprivate onContextMenu(e: MouseEvent) {\n\t\tconst actions = this._commentMenus.getCommentThreadTitleContextActions(this._contextKeyService);\n\t\tif (!actions.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst event = new StandardMouseEvent(dom.getWindow(this._headElement), e);\n\t\tif (!this._contextMenuActionRunner) {\n\t\t\tthis._contextMenuActionRunner = this._register(new ActionRunner());\n\t\t}\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => event,\n\t\t\tgetActions: () => actions,\n\t\t\tactionRunner: this._contextMenuActionRunner,\n\t\t\tgetActionsContext: (): MarshalledCommentThread => {\n\t\t\t\treturn {\n\t\t\t\t\tcommentControlHandle: this._commentThread.controllerHandle,\n\t\t\t\t\tcommentThreadHandle: this._commentThread.commentThreadHandle,\n\t\t\t\t\t$mid: MarshalledId.CommentThread\n\t\t\t\t};\n\t\t\t},\n\t\t});\n\t}\n}\n"]}