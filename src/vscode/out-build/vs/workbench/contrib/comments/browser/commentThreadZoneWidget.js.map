{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentThreadZoneWidget.ts"],"names":[],"mappings":"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","file":"commentThreadZoneWidget.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IDisposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditor, IEditorMouseEvent, isCodeEditor, MouseTargetType } from '../../../../editor/browser/editorBrowser.js';\nimport { IPosition } from '../../../../editor/common/core/position.js';\nimport { IRange, Range } from '../../../../editor/common/core/range.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { ZoneWidget } from '../../../../editor/contrib/zoneWidget/browser/zoneWidget.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IColorTheme, IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { CommentGlyphWidget } from './commentGlyphWidget.js';\nimport { ICommentService } from './commentService.js';\nimport { ICommentThreadWidget } from '../common/commentThreadWidget.js';\nimport { EditorOption } from '../../../../editor/common/config/editorOptions.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { CommentThreadWidget } from './commentThreadWidget.js';\nimport { commentThreadStateBackgroundColorVar, commentThreadStateColorVar, getCommentThreadStateBorderColor } from './commentColors.js';\nimport { peekViewBorder } from '../../../../editor/contrib/peekView/browser/peekView.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { StableEditorScrollState } from '../../../../editor/browser/stableEditorScroll.js';\nimport Severity from '../../../../base/common/severity.js';\nimport * as nls from '../../../../nls.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\n\nfunction getCommentThreadWidgetStateColor(thread: languages.CommentThreadState | undefined, theme: IColorTheme): Color | undefined {\n\treturn getCommentThreadStateBorderColor(thread, theme) ?? theme.getColor(peekViewBorder);\n}\n\n/**\n * Check if a comment thread has any draft comments\n */\nfunction commentThreadHasDraft(commentThread: languages.CommentThread): boolean {\n\tconst comments = commentThread.comments;\n\tif (!comments) {\n\t\treturn false;\n\t}\n\treturn comments.some(comment => comment.state === languages.CommentState.Draft);\n}\n\nexport enum CommentWidgetFocus {\n\tNone = 0,\n\tWidget = 1,\n\tEditor = 2\n}\n\nexport function parseMouseDownInfoFromEvent(e: IEditorMouseEvent) {\n\tconst range = e.target.range;\n\n\tif (!range) {\n\t\treturn null;\n\t}\n\n\tif (!e.event.leftButton) {\n\t\treturn null;\n\t}\n\n\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\treturn null;\n\t}\n\n\tconst data = e.target.detail;\n\tconst gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n\n\t// don't collide with folding and git decorations\n\tif (gutterOffsetX > 20) {\n\t\treturn null;\n\t}\n\n\treturn { lineNumber: range.startLineNumber };\n}\n\nexport function isMouseUpEventDragFromMouseDown(mouseDownInfo: { lineNumber: number } | null, e: IEditorMouseEvent) {\n\tif (!mouseDownInfo) {\n\t\treturn null;\n\t}\n\n\tconst { lineNumber } = mouseDownInfo;\n\n\tconst range = e.target.range;\n\n\tif (!range) {\n\t\treturn null;\n\t}\n\n\treturn lineNumber;\n}\n\nexport function isMouseUpEventMatchMouseDown(mouseDownInfo: { lineNumber: number } | null, e: IEditorMouseEvent) {\n\tif (!mouseDownInfo) {\n\t\treturn null;\n\t}\n\n\tconst { lineNumber } = mouseDownInfo;\n\n\tconst range = e.target.range;\n\n\tif (!range || range.startLineNumber !== lineNumber) {\n\t\treturn null;\n\t}\n\n\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\treturn null;\n\t}\n\n\treturn lineNumber;\n}\n\nexport class ReviewZoneWidget extends ZoneWidget implements ICommentThreadWidget {\n\tprivate _commentThreadWidget!: CommentThreadWidget;\n\tprivate readonly _onDidClose = new Emitter<ReviewZoneWidget | undefined>();\n\tprivate readonly _onDidCreateThread = new Emitter<ReviewZoneWidget>();\n\tprivate _isExpanded?: boolean;\n\tprivate _initialCollapsibleState?: languages.CommentThreadCollapsibleState;\n\tprivate _commentGlyph?: CommentGlyphWidget;\n\tprivate readonly _globalToDispose = new DisposableStore();\n\tprivate _commentThreadDisposables: IDisposable[] = [];\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _scopedInstantiationService: IInstantiationService;\n\n\tpublic get uniqueOwner(): string {\n\t\treturn this._uniqueOwner;\n\t}\n\tpublic get commentThread(): languages.CommentThread {\n\t\treturn this._commentThread;\n\t}\n\n\tpublic get expanded(): boolean | undefined {\n\t\treturn this._isExpanded;\n\t}\n\n\tprivate _commentOptions: languages.CommentOptions | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate _uniqueOwner: string,\n\t\tprivate _commentThread: languages.CommentThread,\n\t\tprivate _pendingComment: languages.PendingComment | undefined,\n\t\tprivate _pendingEdits: { [key: number]: languages.PendingComment } | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IThemeService private themeService: IThemeService,\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IDialogService private readonly dialogService: IDialogService\n\t) {\n\t\tsuper(editor, { keepEditorSelection: true, isAccessible: true, showArrow: !!_commentThread.range });\n\t\tthis._contextKeyService = contextKeyService.createScoped(this.domNode);\n\n\t\tthis._scopedInstantiationService = this._globalToDispose.add(instantiationService.createChild(new ServiceCollection(\n\t\t\t[IContextKeyService, this._contextKeyService]\n\t\t)));\n\n\t\tconst controller = this.commentService.getCommentController(this._uniqueOwner);\n\t\tif (controller) {\n\t\t\tthis._commentOptions = controller.options;\n\t\t}\n\n\t\tthis._initialCollapsibleState = _pendingComment ? languages.CommentThreadCollapsibleState.Expanded : _commentThread.initialCollapsibleState;\n\t\t_commentThread.initialCollapsibleState = this._initialCollapsibleState;\n\t\tthis._commentThreadDisposables = [];\n\t\tthis.create();\n\n\t\tthis._globalToDispose.add(this.themeService.onDidColorThemeChange(this._applyTheme, this));\n\t\tthis._globalToDispose.add(this.editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.fontInfo)) {\n\t\t\t\tthis._applyTheme();\n\t\t\t}\n\t\t}));\n\t\tthis._applyTheme();\n\n\t}\n\n\tpublic get onDidClose(): Event<ReviewZoneWidget | undefined> {\n\t\treturn this._onDidClose.event;\n\t}\n\n\tpublic get onDidCreateThread(): Event<ReviewZoneWidget> {\n\t\treturn this._onDidCreateThread.event;\n\t}\n\n\tpublic getPosition(): IPosition | undefined {\n\t\tif (this.position) {\n\t\t\treturn this.position;\n\t\t}\n\n\t\tif (this._commentGlyph) {\n\t\t\treturn this._commentGlyph.getPosition().position ?? undefined;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected override revealRange() {\n\t\t// we don't do anything here as we always do the reveal ourselves.\n\t}\n\n\tpublic reveal(commentUniqueId?: number, focus: CommentWidgetFocus = CommentWidgetFocus.None) {\n\t\tthis.makeVisible(commentUniqueId, focus);\n\t\tconst comment = this._commentThread.comments?.find(comment => comment.uniqueIdInThread === commentUniqueId) ?? this._commentThread.comments?.[0];\n\t\tthis.commentService.setActiveCommentAndThread(this.uniqueOwner, { thread: this._commentThread, comment });\n\t}\n\n\tprivate _expandAndShowZoneWidget() {\n\t\tif (!this._isExpanded) {\n\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t}\n\t}\n\n\tprivate _setFocus(commentUniqueId: number | undefined, focus: CommentWidgetFocus) {\n\t\tif (focus === CommentWidgetFocus.Widget) {\n\t\t\tthis._commentThreadWidget.focus(commentUniqueId);\n\t\t} else if (focus === CommentWidgetFocus.Editor) {\n\t\t\tthis._commentThreadWidget.focusCommentEditor();\n\t\t}\n\t}\n\n\tprivate _goToComment(commentUniqueId: number, focus: CommentWidgetFocus) {\n\t\tconst height = this.editor.getLayoutInfo().height;\n\t\tconst coords = this._commentThreadWidget.getCommentCoords(commentUniqueId);\n\t\tif (coords) {\n\t\t\tlet scrollTop: number = 1;\n\t\t\tif (this._commentThread.range) {\n\t\t\t\tconst commentThreadCoords = coords.thread;\n\t\t\t\tconst commentCoords = coords.comment;\n\t\t\t\tscrollTop = this.editor.getTopForLineNumber(this._commentThread.range.startLineNumber) - height / 2 + commentCoords.top - commentThreadCoords.top;\n\t\t\t}\n\t\t\tthis.editor.setScrollTop(scrollTop);\n\t\t\tthis._setFocus(commentUniqueId, focus);\n\t\t} else {\n\t\t\tthis._goToThread(focus);\n\t\t}\n\t}\n\n\tprivate _goToThread(focus: CommentWidgetFocus) {\n\t\tconst rangeToReveal = this._commentThread.range\n\t\t\t? new Range(this._commentThread.range.startLineNumber, this._commentThread.range.startColumn, this._commentThread.range.endLineNumber + 1, 1)\n\t\t\t: new Range(1, 1, 1, 1);\n\n\t\tthis.editor.revealRangeInCenter(rangeToReveal);\n\t\tthis._setFocus(undefined, focus);\n\t}\n\n\tpublic makeVisible(commentUniqueId?: number, focus: CommentWidgetFocus = CommentWidgetFocus.None) {\n\t\tthis._expandAndShowZoneWidget();\n\n\t\tif (commentUniqueId !== undefined) {\n\t\t\tthis._goToComment(commentUniqueId, focus);\n\t\t} else {\n\t\t\tthis._goToThread(focus);\n\t\t}\n\t}\n\n\tpublic getPendingComments(): { newComment: languages.PendingComment | undefined; edits: { [key: number]: languages.PendingComment } } {\n\t\treturn {\n\t\t\tnewComment: this._commentThreadWidget.getPendingComment(),\n\t\t\tedits: this._commentThreadWidget.getPendingEdits()\n\t\t};\n\t}\n\n\tpublic setPendingComment(pending: languages.PendingComment) {\n\t\tthis._pendingComment = pending;\n\t\tthis.expand();\n\t\tthis._commentThreadWidget.setPendingComment(pending);\n\t}\n\n\tprotected _fillContainer(container: HTMLElement): void {\n\t\tthis.setCssClass('review-widget');\n\t\tthis._commentThreadWidget = this._scopedInstantiationService.createInstance(\n\t\t\tCommentThreadWidget<IRange>,\n\t\t\tcontainer,\n\t\t\tthis.editor,\n\t\t\tthis._uniqueOwner,\n\t\t\tthis.editor.getModel()!.uri,\n\t\t\tthis._contextKeyService,\n\t\t\tthis._scopedInstantiationService,\n\t\t\tthis._commentThread,\n\t\t\tthis._pendingComment,\n\t\t\tthis._pendingEdits,\n\t\t\t{ context: this.editor, },\n\t\t\tthis._commentOptions,\n\t\t\t{\n\t\t\t\tactionRunner: async () => {\n\t\t\t\t\tif (!this._commentThread.comments || !this._commentThread.comments.length) {\n\t\t\t\t\t\tconst newPosition = this.getPosition();\n\n\t\t\t\t\t\tif (newPosition) {\n\t\t\t\t\t\t\tconst originalRange = this._commentThread.range;\n\t\t\t\t\t\t\tif (!originalRange) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet range: Range;\n\n\t\t\t\t\t\t\tif (newPosition.lineNumber !== originalRange.endLineNumber) {\n\t\t\t\t\t\t\t\t// The widget could have moved as a result of editor changes.\n\t\t\t\t\t\t\t\t// We need to try to calculate the new, more correct, range for the comment.\n\t\t\t\t\t\t\t\tconst distance = newPosition.lineNumber - originalRange.endLineNumber;\n\t\t\t\t\t\t\t\trange = new Range(originalRange.startLineNumber + distance, originalRange.startColumn, originalRange.endLineNumber + distance, originalRange.endColumn);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange = new Range(originalRange.startLineNumber, originalRange.startColumn, originalRange.endLineNumber, originalRange.endColumn);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tawait this.commentService.updateCommentThreadTemplate(this.uniqueOwner, this._commentThread.commentThreadHandle, range);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcollapse: () => {\n\t\t\t\t\treturn this.collapse(true);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._disposables.add(this._commentThreadWidget);\n\t}\n\n\tprivate arrowPosition(range: IRange | undefined): IPosition | undefined {\n\t\tif (!range) {\n\t\t\treturn undefined;\n\t\t}\n\t\t// Arrow on top edge of zone widget will be at the start of the line if range is multi-line, else at midpoint of range (rounding rightwards)\n\t\treturn { lineNumber: range.endLineNumber, column: range.endLineNumber === range.startLineNumber ? (range.startColumn + range.endColumn + 1) / 2 : 1 };\n\t}\n\n\tprivate deleteCommentThread(): void {\n\t\tthis.dispose();\n\t\tthis.commentService.disposeCommentThread(this.uniqueOwner, this._commentThread.threadId);\n\t}\n\n\tprivate doCollapse() {\n\t\tthis._commentThread.collapsibleState = languages.CommentThreadCollapsibleState.Collapsed;\n\t}\n\n\tpublic async collapse(confirm: boolean = false): Promise<boolean> {\n\t\tif (!confirm || (await this.confirmCollapse())) {\n\t\t\tthis.doCollapse();\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate async confirmCollapse(): Promise<boolean> {\n\t\tconst confirmSetting = this.configurationService.getValue<'whenHasUnsubmittedComments' | 'never'>('comments.thread.confirmOnCollapse');\n\n\t\tif (confirmSetting === 'whenHasUnsubmittedComments' && this._commentThreadWidget.hasUnsubmittedComments) {\n\t\t\tconst result = await this.dialogService.confirm({\n\t\t\t\tmessage: nls.localize('confirmCollapse', \"Collapsing this comment thread will discard unsubmitted comments. Are you sure you want to discard these comments?\"),\n\t\t\t\tprimaryButton: nls.localize('discard', \"Discard\"),\n\t\t\t\ttype: Severity.Warning,\n\t\t\t\tcheckbox: { label: nls.localize('neverAskAgain', \"Never ask me again\"), checked: false }\n\t\t\t});\n\t\t\tif (result.checkboxChecked) {\n\t\t\t\tawait this.configurationService.updateValue('comments.thread.confirmOnCollapse', 'never');\n\t\t\t}\n\t\t\treturn result.confirmed;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic expand(setActive?: boolean) {\n\t\tthis._commentThread.collapsibleState = languages.CommentThreadCollapsibleState.Expanded;\n\t\tif (setActive) {\n\t\t\tthis.commentService.setActiveCommentAndThread(this.uniqueOwner, { thread: this._commentThread });\n\t\t}\n\t}\n\n\tpublic getGlyphPosition(): number {\n\t\tif (this._commentGlyph) {\n\t\t\treturn this._commentGlyph.getPosition().position!.lineNumber;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tasync update(commentThread: languages.CommentThread<IRange>) {\n\t\tif (this._commentThread !== commentThread) {\n\t\t\tthis._commentThreadDisposables.forEach(disposable => disposable.dispose());\n\t\t\tthis._commentThread = commentThread;\n\t\t\tthis._commentThreadDisposables = [];\n\t\t\tthis.bindCommentThreadListeners();\n\t\t}\n\n\t\tawait this._commentThreadWidget.updateCommentThread(commentThread);\n\n\t\t// Move comment glyph widget and show position if the line has changed.\n\t\tconst lineNumber = this._commentThread.range?.endLineNumber ?? 1;\n\t\tlet shouldMoveWidget = false;\n\t\tif (this._commentGlyph) {\n\t\t\tconst hasDraft = commentThreadHasDraft(commentThread);\n\t\t\tthis._commentGlyph.setThreadState(commentThread.state, hasDraft);\n\t\t\tif (this._commentGlyph.getPosition().position!.lineNumber !== lineNumber) {\n\t\t\t\tshouldMoveWidget = true;\n\t\t\t\tthis._commentGlyph.setLineNumber(lineNumber);\n\t\t\t}\n\t\t}\n\n\t\tif ((shouldMoveWidget && this._isExpanded) || (this._commentThread.collapsibleState === languages.CommentThreadCollapsibleState.Expanded && !this._isExpanded)) {\n\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t} else if (this._commentThread.collapsibleState !== languages.CommentThreadCollapsibleState.Expanded) {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\tprotected override _onWidth(widthInPixel: number): void {\n\t\tthis._commentThreadWidget.layout(widthInPixel);\n\t}\n\n\tprotected override _doLayout(heightInPixel: number, widthInPixel: number): void {\n\t\tthis._commentThreadWidget.layout(widthInPixel);\n\t}\n\n\tasync display(range: IRange | undefined, shouldReveal: boolean) {\n\t\tif (range) {\n\t\t\tthis._commentGlyph = new CommentGlyphWidget(this.editor, range?.endLineNumber ?? -1);\n\t\t\tconst hasDraft = commentThreadHasDraft(this._commentThread);\n\t\t\tthis._commentGlyph.setThreadState(this._commentThread.state, hasDraft);\n\t\t\tthis._globalToDispose.add(this._commentGlyph.onDidChangeLineNumber(async e => {\n\t\t\t\tif (!this._commentThread.range) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst shift = e - (this._commentThread.range.endLineNumber);\n\t\t\t\tconst newRange = new Range(this._commentThread.range.startLineNumber + shift, this._commentThread.range.startColumn, this._commentThread.range.endLineNumber + shift, this._commentThread.range.endColumn);\n\t\t\t\tthis._commentThread.range = newRange;\n\t\t\t}));\n\t\t}\n\n\t\tawait this._commentThreadWidget.display(this.editor.getOption(EditorOption.lineHeight), shouldReveal);\n\t\tthis._disposables.add(this._commentThreadWidget.onDidResize(dimension => {\n\t\t\tthis._refresh(dimension);\n\t\t}));\n\t\tif (this._commentThread.collapsibleState === languages.CommentThreadCollapsibleState.Expanded) {\n\t\t\tthis.show(this.arrowPosition(range), 2);\n\t\t}\n\n\t\t// If this is a new comment thread awaiting user input then we need to reveal it.\n\t\tif (shouldReveal) {\n\t\t\tthis.makeVisible();\n\t\t}\n\n\t\tthis.bindCommentThreadListeners();\n\t}\n\n\tprivate bindCommentThreadListeners() {\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeComments(async _ => {\n\t\t\tawait this.update(this._commentThread);\n\t\t}));\n\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeCollapsibleState(state => {\n\t\t\tif (state === languages.CommentThreadCollapsibleState.Expanded && !this._isExpanded) {\n\t\t\t\tthis.show(this.arrowPosition(this._commentThread.range), 2);\n\t\t\t\tthis._commentThreadWidget.ensureFocusIntoNewEditingComment();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (state === languages.CommentThreadCollapsibleState.Collapsed && this._isExpanded) {\n\t\t\t\tthis.hide();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}));\n\n\t\tif (this._initialCollapsibleState === undefined) {\n\t\t\tconst onDidChangeInitialCollapsibleState = this._commentThread.onDidChangeInitialCollapsibleState(state => {\n\t\t\t\t// File comments always start expanded\n\t\t\t\tthis._initialCollapsibleState = state;\n\t\t\t\tthis._commentThread.collapsibleState = this._initialCollapsibleState;\n\t\t\t\tonDidChangeInitialCollapsibleState.dispose();\n\t\t\t});\n\t\t\tthis._commentThreadDisposables.push(onDidChangeInitialCollapsibleState);\n\t\t}\n\n\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeState(() => {\n\t\t\tconst borderColor =\n\t\t\t\tgetCommentThreadWidgetStateColor(this._commentThread.state, this.themeService.getColorTheme()) || Color.transparent;\n\t\t\tthis.style({\n\t\t\t\tframeColor: borderColor,\n\t\t\t\tarrowColor: borderColor,\n\t\t\t});\n\t\t\tthis.container?.style.setProperty(commentThreadStateColorVar, `${borderColor}`);\n\t\t\tthis.container?.style.setProperty(commentThreadStateBackgroundColorVar, `${borderColor.transparent(.1)}`);\n\t\t}));\n\t}\n\n\tasync submitComment(): Promise<void> {\n\t\treturn this._commentThreadWidget.submitComment();\n\t}\n\n\t_refresh(dimensions: dom.Dimension) {\n\t\tif ((this._isExpanded === undefined) && (dimensions.height === 0) && (dimensions.width === 0)) {\n\t\t\tthis.commentThread.collapsibleState = languages.CommentThreadCollapsibleState.Collapsed;\n\t\t\treturn;\n\t\t}\n\t\tif (this._isExpanded) {\n\t\t\tthis._commentThreadWidget.layout();\n\n\t\t\tconst headHeight = Math.ceil(this.editor.getOption(EditorOption.lineHeight) * 1.2);\n\t\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\t\tconst arrowHeight = Math.round(lineHeight / 3);\n\t\t\tconst frameThickness = Math.round(lineHeight / 9) * 2;\n\n\t\t\tconst computedLinesNumber = Math.ceil((headHeight + dimensions.height + arrowHeight + frameThickness + 8 /** margin bottom to avoid margin collapse */) / lineHeight);\n\n\t\t\tif (this._viewZone?.heightInLines === computedLinesNumber) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentPosition = this.getPosition();\n\n\t\t\tif (this._viewZone && currentPosition && currentPosition.lineNumber !== this._viewZone.afterLineNumber && this._viewZone.afterLineNumber !== 0) {\n\t\t\t\tthis._viewZone.afterLineNumber = currentPosition.lineNumber;\n\t\t\t}\n\n\t\t\tconst capture = StableEditorScrollState.capture(this.editor);\n\t\t\tthis._relayout(computedLinesNumber);\n\t\t\tcapture.restore(this.editor);\n\t\t}\n\t}\n\n\tprivate _applyTheme() {\n\t\tconst borderColor = getCommentThreadWidgetStateColor(this._commentThread.state, this.themeService.getColorTheme()) || Color.transparent;\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor\n\t\t});\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\n\t\tthis._commentThreadWidget.applyTheme(fontInfo);\n\t}\n\n\toverride show(rangeOrPos: IRange | IPosition | undefined, heightInLines: number): void {\n\t\tconst glyphPosition = this._commentGlyph?.getPosition();\n\t\tlet range = Range.isIRange(rangeOrPos) ? rangeOrPos : (rangeOrPos ? Range.fromPositions(rangeOrPos) : undefined);\n\t\tif (glyphPosition?.position && range && glyphPosition.position.lineNumber !== range.endLineNumber) {\n\t\t\t// The widget could have moved as a result of editor changes.\n\t\t\t// We need to try to calculate the new, more correct, range for the comment.\n\t\t\tconst distance = glyphPosition.position.lineNumber - range.endLineNumber;\n\t\t\trange = new Range(range.startLineNumber + distance, range.startColumn, range.endLineNumber + distance, range.endColumn);\n\t\t}\n\n\t\tthis._isExpanded = true;\n\t\tsuper.show(range ?? new Range(0, 0, 0, 0), heightInLines);\n\t\tthis._commentThread.collapsibleState = languages.CommentThreadCollapsibleState.Expanded;\n\t\tthis._refresh(this._commentThreadWidget.getDimensions());\n\t}\n\n\tasync collapseAndFocusRange() {\n\t\tif (await this.collapse(true) && Range.isIRange(this.commentThread.range) && isCodeEditor(this.editor)) {\n\t\t\tthis.editor.setSelection(this.commentThread.range);\n\t\t}\n\t}\n\n\toverride hide() {\n\t\tif (this._isExpanded) {\n\t\t\tthis._isExpanded = false;\n\t\t\t// Focus the container so that the comment editor will be blurred before it is hidden\n\t\t\tif (this.editor.hasWidgetFocus()) {\n\t\t\t\tthis.editor.focus();\n\t\t\t}\n\n\t\t\tif (!this._commentThread.comments || !this._commentThread.comments.length) {\n\t\t\t\tthis.deleteCommentThread();\n\t\t\t}\n\t\t}\n\t\tsuper.hide();\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this._commentGlyph) {\n\t\t\tthis._commentGlyph.dispose();\n\t\t\tthis._commentGlyph = undefined;\n\t\t}\n\n\t\tthis._globalToDispose.dispose();\n\t\tthis._commentThreadDisposables.forEach(global => global.dispose());\n\t\tthis._onDidClose.fire(undefined);\n\t}\n}\n"]}