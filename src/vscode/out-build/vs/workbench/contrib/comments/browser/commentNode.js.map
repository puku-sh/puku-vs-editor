{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentNode.ts"],"names":[],"mappings":"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","file":"commentNode.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { ActionsOrientation, ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action, IAction, Separator, ActionRunner } from '../../../../base/common/actions.js';\nimport { Disposable, DisposableStore, IReference, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IMarkdownRendererExtraOptions, IMarkdownRendererService } from '../../../../platform/markdown/browser/markdownRenderer.js';\nimport { IRenderedMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ICommentService } from './commentService.js';\nimport { LayoutableEditor, MIN_EDITOR_HEIGHT, SimpleCommentEditor, calculateEditorHeight } from './simpleCommentEditor.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ToolBar } from '../../../../base/browser/ui/toolbar/toolbar.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { AnchorAlignment } from '../../../../base/browser/ui/contextview/contextview.js';\nimport { ToggleReactionsAction, ReactionAction, ReactionActionViewItem } from './reactionsAction.js';\nimport { ICommentThreadWidget } from '../common/commentThreadWidget.js';\nimport { MenuItemAction, SubmenuItemAction, IMenu, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { MenuEntryActionViewItem, SubmenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IContextKeyService, IContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CommentFormActions } from './commentFormActions.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nimport { ActionViewItem, IActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { DropdownMenuActionViewItem } from '../../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { MarshalledId } from '../../../../base/common/marshallingIds.js';\nimport { TimestampWidget } from './timestamp.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { IRange } from '../../../../editor/common/core/range.js';\nimport { ICellRange } from '../../notebook/common/notebookRange.js';\nimport { CommentMenus } from './commentMenus.js';\nimport { Scrollable, ScrollbarVisibility } from '../../../../base/common/scrollable.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { DomEmitter } from '../../../../base/browser/event.js';\nimport { CommentContextKeys } from '../common/commentContextKeys.js';\nimport { FileAccess, Schemas } from '../../../../base/common/network.js';\nimport { COMMENTS_SECTION, ICommentsConfiguration } from '../common/commentsConfiguration.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { MarshalledCommentThread } from '../../../common/comments.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IResolvedTextEditorModel, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { Position } from '../../../../editor/common/core/position.js';\n\nclass CommentsActionRunner extends ActionRunner {\n\tprotected override async runAction(action: IAction, context: any[]): Promise<void> {\n\t\tawait action.run(...context);\n\t}\n}\n\nexport class CommentNode<T extends IRange | ICellRange> extends Disposable {\n\tprivate _domNode: HTMLElement;\n\tprivate _body: HTMLElement;\n\tprivate _avatar: HTMLElement;\n\tprivate readonly _md: MutableDisposable<IRenderedMarkdown> = this._register(new MutableDisposable());\n\tprivate _plainText: HTMLElement | undefined;\n\tprivate _clearTimeout: Timeout | null;\n\n\tprivate _editAction: Action | null = null;\n\tprivate _commentEditContainer: HTMLElement | null = null;\n\tprivate _commentDetailsContainer: HTMLElement;\n\tprivate _actionsToolbarContainer!: HTMLElement;\n\tprivate readonly _reactionsActionBar: MutableDisposable<ActionBar> = this._register(new MutableDisposable());\n\tprivate readonly _reactionActions: DisposableStore = this._register(new DisposableStore());\n\tprivate _reactionActionsContainer?: HTMLElement;\n\tprivate _commentEditor: SimpleCommentEditor | null = null;\n\tprivate _commentEditorModel: IReference<IResolvedTextEditorModel> | null = null;\n\tprivate _editorHeight = MIN_EDITOR_HEIGHT;\n\n\tprivate _isPendingLabel!: HTMLElement;\n\tprivate _timestamp: HTMLElement | undefined;\n\tprivate _timestampWidget: TimestampWidget | undefined;\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _commentContextValue: IContextKey<string>;\n\tprivate _commentMenus: CommentMenus;\n\n\tprivate _scrollable!: Scrollable;\n\tprivate _scrollableElement!: SmoothScrollableElement;\n\n\tprivate readonly _actionRunner: CommentsActionRunner = this._register(new CommentsActionRunner());\n\tprivate readonly toolbar: MutableDisposable<ToolBar> = this._register(new MutableDisposable());\n\tprivate _commentFormActions: CommentFormActions | null = null;\n\tprivate _commentEditorActions: CommentFormActions | null = null;\n\n\tprivate readonly _onDidClick = new Emitter<CommentNode<T>>();\n\n\tpublic get domNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic isEditing: boolean = false;\n\n\tconstructor(\n\t\tprivate readonly parentEditor: LayoutableEditor,\n\t\tprivate commentThread: languages.CommentThread<T>,\n\t\tpublic comment: languages.Comment,\n\t\tprivate pendingEdit: languages.PendingComment | undefined,\n\t\tprivate owner: string,\n\t\tprivate resource: URI,\n\t\tprivate parentThread: ICommentThreadWidget,\n\t\tprivate readonly markdownRendererOptions: IMarkdownRendererExtraOptions,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@INotificationService private notificationService: INotificationService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@IHoverService private hoverService: IHoverService,\n\t\t@IKeybindingService private keybindingService: IKeybindingService,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t\t@IMarkdownRendererService private readonly markdownRendererService: IMarkdownRendererService,\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = dom.$('div.review-comment');\n\t\tthis._contextKeyService = this._register(contextKeyService.createScoped(this._domNode));\n\t\tthis._commentContextValue = CommentContextKeys.commentContext.bindTo(this._contextKeyService);\n\t\tif (this.comment.contextValue) {\n\t\t\tthis._commentContextValue.set(this.comment.contextValue);\n\t\t}\n\t\tthis._commentMenus = this.commentService.getCommentMenus(this.owner);\n\n\t\tthis._domNode.tabIndex = -1;\n\t\tthis._avatar = dom.append(this._domNode, dom.$('div.avatar-container'));\n\t\tthis.updateCommentUserIcon(this.comment.userIconPath);\n\n\t\tthis._commentDetailsContainer = dom.append(this._domNode, dom.$('.review-comment-contents'));\n\n\t\tthis.createHeader(this._commentDetailsContainer);\n\t\tthis._body = document.createElement(`div`);\n\t\tthis._body.classList.add('comment-body', MOUSE_CURSOR_TEXT_CSS_CLASS_NAME);\n\t\tif (configurationService.getValue<ICommentsConfiguration | undefined>(COMMENTS_SECTION)?.maxHeight !== false) {\n\t\t\tthis._body.classList.add('comment-body-max-height');\n\t\t}\n\n\t\tthis.createScroll(this._commentDetailsContainer, this._body);\n\t\tthis.updateCommentBody(this.comment.body);\n\n\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\n\t\tthis._domNode.setAttribute('aria-label', `${comment.userName}, ${this.commentBodyValue}`);\n\t\tthis._domNode.setAttribute('role', 'treeitem');\n\t\tthis._clearTimeout = null;\n\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.CLICK, () => this.isEditing || this._onDidClick.fire(this)));\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.CONTEXT_MENU, e => {\n\t\t\treturn this.onContextMenu(e);\n\t\t}));\n\n\t\tif (pendingEdit) {\n\t\t\tthis.switchToEditMode();\n\t\t}\n\n\t\tthis.activeCommentListeners();\n\t}\n\n\tprivate activeCommentListeners() {\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.FOCUS_IN, () => {\n\t\t\tthis.commentService.setActiveCommentAndThread(this.owner, { thread: this.commentThread, comment: this.comment });\n\t\t}, true));\n\t}\n\n\tprivate createScroll(container: HTMLElement, body: HTMLElement) {\n\t\tthis._scrollable = this._register(new Scrollable({\n\t\t\tforceIntegerValues: true,\n\t\t\tsmoothScrollDuration: 125,\n\t\t\tscheduleAtNextAnimationFrame: cb => dom.scheduleAtNextAnimationFrame(dom.getWindow(container), cb)\n\t\t}));\n\t\tthis._scrollableElement = this._register(new SmoothScrollableElement(body, {\n\t\t\thorizontal: ScrollbarVisibility.Visible,\n\t\t\tvertical: ScrollbarVisibility.Visible\n\t\t}, this._scrollable));\n\n\t\tthis._register(this._scrollableElement.onScroll(e => {\n\t\t\tif (e.scrollLeftChanged) {\n\t\t\t\tbody.scrollLeft = e.scrollLeft;\n\t\t\t}\n\t\t\tif (e.scrollTopChanged) {\n\t\t\t\tbody.scrollTop = e.scrollTop;\n\t\t\t}\n\t\t}));\n\n\t\tconst onDidScrollViewContainer = this._register(new DomEmitter(body, 'scroll')).event;\n\t\tthis._register(onDidScrollViewContainer(_ => {\n\t\t\tconst position = this._scrollableElement.getScrollPosition();\n\t\t\tconst scrollLeft = Math.abs(body.scrollLeft - position.scrollLeft) <= 1 ? undefined : body.scrollLeft;\n\t\t\tconst scrollTop = Math.abs(body.scrollTop - position.scrollTop) <= 1 ? undefined : body.scrollTop;\n\n\t\t\tif (scrollLeft !== undefined || scrollTop !== undefined) {\n\t\t\t\tthis._scrollableElement.setScrollPosition({ scrollLeft, scrollTop });\n\t\t\t}\n\t\t}));\n\n\t\tcontainer.appendChild(this._scrollableElement.getDomNode());\n\t}\n\n\tprivate updateCommentBody(body: string | IMarkdownString) {\n\t\tthis._body.innerText = '';\n\t\tthis._md.clear();\n\t\tthis._plainText = undefined;\n\t\tif (typeof body === 'string') {\n\t\t\tthis._plainText = dom.append(this._body, dom.$('.comment-body-plainstring'));\n\t\t\tthis._plainText.innerText = body;\n\t\t} else {\n\t\t\tthis._md.value = this.markdownRendererService.render(body, this.markdownRendererOptions);\n\t\t\tthis._body.appendChild(this._md.value.element);\n\t\t}\n\t}\n\n\tprivate updateCommentUserIcon(userIconPath: UriComponents | undefined) {\n\t\tthis._avatar.textContent = '';\n\t\tif (userIconPath) {\n\t\t\tconst img = dom.append(this._avatar, dom.$('img.avatar')) as HTMLImageElement;\n\t\t\timg.src = FileAccess.uriToBrowserUri(URI.revive(userIconPath)).toString(true);\n\t\t\timg.onerror = _ => img.remove();\n\t\t}\n\t}\n\n\tpublic get onDidClick(): Event<CommentNode<T>> {\n\t\treturn this._onDidClick.event;\n\t}\n\n\tprivate createTimestamp(container: HTMLElement) {\n\t\tthis._timestamp = dom.append(container, dom.$('span.timestamp-container'));\n\t\tthis.updateTimestamp(this.comment.timestamp);\n\t}\n\n\tprivate updateTimestamp(raw?: string) {\n\t\tif (!this._timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst timestamp = raw !== undefined ? new Date(raw) : undefined;\n\t\tif (!timestamp) {\n\t\t\tthis._timestampWidget?.dispose();\n\t\t} else {\n\t\t\tif (!this._timestampWidget) {\n\t\t\t\tthis._timestampWidget = new TimestampWidget(this.configurationService, this.hoverService, this._timestamp, timestamp);\n\t\t\t\tthis._register(this._timestampWidget);\n\t\t\t} else {\n\t\t\t\tthis._timestampWidget.setTimestamp(timestamp);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate createHeader(commentDetailsContainer: HTMLElement): void {\n\t\tconst header = dom.append(commentDetailsContainer, dom.$(`div.comment-title.${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`));\n\t\tconst infoContainer = dom.append(header, dom.$('comment-header-info'));\n\t\tconst author = dom.append(infoContainer, dom.$('strong.author'));\n\t\tauthor.innerText = this.comment.userName;\n\t\tthis.createTimestamp(infoContainer);\n\t\tthis._isPendingLabel = dom.append(infoContainer, dom.$('span.isPending'));\n\n\t\tif (this.comment.label) {\n\t\t\tthis._isPendingLabel.innerText = this.comment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = '';\n\t\t}\n\n\t\tthis._actionsToolbarContainer = dom.append(header, dom.$('.comment-actions'));\n\t\tthis.createActionsToolbar();\n\t}\n\n\tprivate getToolbarActions(menu: IMenu): { primary: IAction[]; secondary: IAction[] } {\n\t\tconst contributedActions = menu.getActions({ shouldForwardArgs: true });\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\t\tconst result = { primary, secondary };\n\t\tfillInActions(contributedActions, result, false, g => /^inline/.test(g));\n\t\treturn result;\n\t}\n\n\tprivate get commentNodeContext(): [any, MarshalledCommentThread] {\n\t\treturn [{\n\t\t\tthread: this.commentThread,\n\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t$mid: MarshalledId.CommentNode\n\t\t},\n\t\t{\n\t\t\tcommentControlHandle: this.commentThread.controllerHandle,\n\t\t\tcommentThreadHandle: this.commentThread.commentThreadHandle,\n\t\t\t$mid: MarshalledId.CommentThread\n\t\t}];\n\t}\n\n\tprivate createToolbar() {\n\t\tthis.toolbar.value = new ToolBar(this._actionsToolbarContainer, this.contextMenuService, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\taction,\n\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\tactionViewItemProvider: (action, options) => this.actionViewItemProvider(action as Action, options),\n\t\t\t\t\t\t\tclassNames: ['toolbar-toggle-pickReactions', ...ThemeIcon.asClassNameArray(Codicon.reactions)],\n\t\t\t\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn this.actionViewItemProvider(action as Action, options);\n\t\t\t},\n\t\t\torientation: ActionsOrientation.HORIZONTAL\n\t\t});\n\n\t\tthis.toolbar.value.context = this.commentNodeContext;\n\t\tthis.toolbar.value.actionRunner = this._actionRunner;\n\t}\n\n\tprivate createActionsToolbar() {\n\t\tconst actions: IAction[] = [];\n\n\t\tconst menu = this._commentMenus.getCommentTitleActions(this.comment, this._contextKeyService);\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(e => {\n\t\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\t\tif (!this.toolbar && (primary.length || secondary.length)) {\n\t\t\t\tthis.createToolbar();\n\t\t\t}\n\t\t\tthis.toolbar.value!.setActions(primary, secondary);\n\t\t}));\n\n\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\tactions.push(...primary);\n\n\t\tif (actions.length || secondary.length) {\n\t\t\tthis.createToolbar();\n\t\t\tthis.toolbar.value!.setActions(actions, secondary);\n\t\t}\n\t}\n\n\tactionViewItemProvider(action: Action, options: IActionViewItemOptions) {\n\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\toptions = { label: false, icon: true };\n\t\t} else {\n\t\t\toptions = { label: false, icon: true };\n\t\t}\n\n\t\tif (action.id === ReactionAction.ID) {\n\t\t\tconst item = new ReactionActionViewItem(action);\n\t\t\treturn item;\n\t\t} else if (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t} else if (action instanceof SubmenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action, options);\n\t\t} else {\n\t\t\tconst item = new ActionViewItem({}, action, options);\n\t\t\treturn item;\n\t\t}\n\t}\n\n\tasync submitComment(): Promise<void> {\n\t\tif (this._commentEditor && this._commentFormActions) {\n\t\t\tawait this._commentFormActions.triggerDefaultAction();\n\t\t\tthis.pendingEdit = undefined;\n\t\t}\n\t}\n\n\tprivate createReactionPicker(reactionGroup: languages.CommentReaction[]): ToggleReactionsAction {\n\t\tconst toggleReactionAction = this._reactionActions.add(new ToggleReactionsAction(() => {\n\t\t\ttoggleReactionActionViewItem?.show();\n\t\t}, nls.localize('commentToggleReaction', \"Toggle Reaction\")));\n\n\t\tlet reactionMenuActions: Action[] = [];\n\t\tif (reactionGroup && reactionGroup.length) {\n\t\t\treactionMenuActions = reactionGroup.map((reaction) => {\n\t\t\t\treturn this._reactionActions.add(new Action(`reaction.command.${reaction.label}`, `${reaction.label}`, '', true, async () => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.commentService.toggleReaction(this.owner, this.resource, this.commentThread, this.comment, reaction);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconst error = e.message\n\t\t\t\t\t\t\t? nls.localize('commentToggleReactionError', \"Toggling the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentToggleReactionDefaultError', \"Toggling the comment reaction failed\");\n\t\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t});\n\t\t}\n\n\t\ttoggleReactionAction.menuActions = reactionMenuActions;\n\n\t\tconst toggleReactionActionViewItem: DropdownMenuActionViewItem = this._reactionActions.add(new DropdownMenuActionViewItem(\n\t\t\ttoggleReactionAction,\n\t\t\t(<ToggleReactionsAction>toggleReactionAction).menuActions,\n\t\t\tthis.contextMenuService,\n\t\t\t{\n\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\t\treturn toggleReactionActionViewItem;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.actionViewItemProvider(action as Action, options);\n\t\t\t\t},\n\t\t\t\tclassNames: 'toolbar-toggle-pickReactions',\n\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t}\n\t\t));\n\n\t\treturn toggleReactionAction;\n\t}\n\n\tprivate createReactionsContainer(commentDetailsContainer: HTMLElement): void {\n\t\tthis._reactionActionsContainer?.remove();\n\t\tthis._reactionsActionBar.clear();\n\t\tthis._reactionActions.clear();\n\n\t\tthis._reactionActionsContainer = dom.append(commentDetailsContainer, dom.$('div.comment-reactions'));\n\t\tthis._reactionsActionBar.value = new ActionBar(this._reactionActionsContainer, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\taction,\n\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactionViewItemProvider: (action, options) => this.actionViewItemProvider(action as Action, options),\n\t\t\t\t\t\t\tclassNames: ['toolbar-toggle-pickReactions', ...ThemeIcon.asClassNameArray(Codicon.reactions)],\n\t\t\t\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn this.actionViewItemProvider(action as Action, options);\n\t\t\t}\n\t\t});\n\n\t\tconst hasReactionHandler = this.commentService.hasReactionHandler(this.owner);\n\t\tthis.comment.commentReactions?.filter(reaction => !!reaction.count).map(reaction => {\n\t\t\tconst action = this._reactionActions.add(new ReactionAction(`reaction.${reaction.label}`, `${reaction.label}`, reaction.hasReacted && (reaction.canEdit || hasReactionHandler) ? 'active' : '', (reaction.canEdit || hasReactionHandler), async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait this.commentService.toggleReaction(this.owner, this.resource, this.commentThread, this.comment, reaction);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlet error: string;\n\n\t\t\t\t\tif (reaction.hasReacted) {\n\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t? nls.localize('commentDeleteReactionError', \"Deleting the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentDeleteReactionDefaultError', \"Deleting the comment reaction failed\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t? nls.localize('commentAddReactionError', \"Deleting the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentAddReactionDefaultError', \"Deleting the comment reaction failed\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t}\n\t\t\t}, reaction.reactors, reaction.iconPath, reaction.count));\n\n\t\t\tthis._reactionsActionBar.value?.push(action, { label: true, icon: true });\n\t\t});\n\n\t\tif (hasReactionHandler) {\n\t\t\tconst toggleReactionAction = this.createReactionPicker(this.comment.commentReactions || []);\n\t\t\tthis._reactionsActionBar.value?.push(toggleReactionAction, { label: false, icon: true });\n\t\t}\n\t}\n\n\tget commentBodyValue(): string {\n\t\treturn (typeof this.comment.body === 'string') ? this.comment.body : this.comment.body.value;\n\t}\n\n\tprivate async createCommentEditor(editContainer: HTMLElement): Promise<void> {\n\t\tthis._editModeDisposables.clear();\n\t\tconst container = dom.append(editContainer, dom.$('.edit-textarea'));\n\t\tthis._commentEditor = this.instantiationService.createInstance(SimpleCommentEditor, container, SimpleCommentEditor.getEditorOptions(this.configurationService), this._contextKeyService, this.parentThread);\n\t\tthis._editModeDisposables.add(this._commentEditor);\n\n\t\tconst resource = URI.from({\n\t\t\tscheme: Schemas.commentsInput,\n\t\t\tpath: `/commentinput-${this.comment.uniqueIdInThread}-${Date.now()}.md`\n\t\t});\n\t\tconst modelRef = await this.textModelService.createModelReference(resource);\n\t\tthis._commentEditorModel = modelRef;\n\t\tthis._editModeDisposables.add(this._commentEditorModel);\n\n\t\tthis._commentEditor.setModel(this._commentEditorModel.object.textEditorModel);\n\t\tthis._commentEditor.setValue(this.pendingEdit?.body ?? this.commentBodyValue);\n\t\tif (this.pendingEdit) {\n\t\t\tthis._commentEditor.setPosition(this.pendingEdit.cursor);\n\t\t} else {\n\t\t\tconst lastLine = this._commentEditorModel.object.textEditorModel.getLineCount();\n\t\t\tconst lastColumn = this._commentEditorModel.object.textEditorModel.getLineLength(lastLine) + 1;\n\t\t\tthis._commentEditor.setPosition(new Position(lastLine, lastColumn));\n\t\t}\n\t\tthis.pendingEdit = undefined;\n\t\tthis._commentEditor.layout({ width: container.clientWidth - 14, height: this._editorHeight });\n\t\tthis._commentEditor.focus();\n\n\t\tdom.scheduleAtNextAnimationFrame(dom.getWindow(editContainer), () => {\n\t\t\tthis._commentEditor!.layout({ width: container.clientWidth - 14, height: this._editorHeight });\n\t\t\tthis._commentEditor!.focus();\n\t\t});\n\n\t\tconst commentThread = this.commentThread;\n\t\tcommentThread.input = {\n\t\t\turi: this._commentEditor.getModel()!.uri,\n\t\t\tvalue: this.commentBodyValue\n\t\t};\n\t\tthis.commentService.setActiveEditingCommentThread(commentThread);\n\t\tthis.commentService.setActiveCommentAndThread(this.owner, { thread: commentThread, comment: this.comment });\n\n\t\tthis._editModeDisposables.add(this._commentEditor.onDidFocusEditorWidget(() => {\n\t\t\tcommentThread.input = {\n\t\t\t\turi: this._commentEditor!.getModel()!.uri,\n\t\t\t\tvalue: this.commentBodyValue\n\t\t\t};\n\t\t\tthis.commentService.setActiveEditingCommentThread(commentThread);\n\t\t\tthis.commentService.setActiveCommentAndThread(this.owner, { thread: commentThread, comment: this.comment });\n\t\t}));\n\n\t\tthis._editModeDisposables.add(this._commentEditor.onDidChangeModelContent(e => {\n\t\t\tif (commentThread.input && this._commentEditor && this._commentEditor.getModel()!.uri === commentThread.input.uri) {\n\t\t\t\tconst newVal = this._commentEditor.getValue();\n\t\t\t\tif (newVal !== commentThread.input.value) {\n\t\t\t\t\tconst input = commentThread.input;\n\t\t\t\t\tinput.value = newVal;\n\t\t\t\t\tcommentThread.input = input;\n\t\t\t\t\tthis.commentService.setActiveEditingCommentThread(commentThread);\n\t\t\t\t\tthis.commentService.setActiveCommentAndThread(this.owner, { thread: commentThread, comment: this.comment });\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.calculateEditorHeight();\n\n\t\tthis._editModeDisposables.add((this._commentEditorModel.object.textEditorModel.onDidChangeContent(() => {\n\t\t\tif (this._commentEditor && this.calculateEditorHeight()) {\n\t\t\t\tthis._commentEditor.layout({ height: this._editorHeight, width: this._commentEditor.getLayoutInfo().width });\n\t\t\t\tthis._commentEditor.render(true);\n\t\t\t}\n\t\t})));\n\n\t}\n\n\tprivate calculateEditorHeight(): boolean {\n\t\tif (this._commentEditor) {\n\t\t\tconst newEditorHeight = calculateEditorHeight(this.parentEditor, this._commentEditor, this._editorHeight);\n\t\t\tif (newEditorHeight !== this._editorHeight) {\n\t\t\t\tthis._editorHeight = newEditorHeight;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetPendingEdit(): languages.PendingComment | undefined {\n\t\tconst model = this._commentEditor?.getModel();\n\t\tif (this._commentEditor && model && model.getValueLength() > 0) {\n\t\t\treturn { body: model.getValue(), cursor: this._commentEditor.getPosition()! };\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate removeCommentEditor() {\n\t\tthis.isEditing = false;\n\t\tif (this._editAction) {\n\t\t\tthis._editAction.enabled = true;\n\t\t}\n\t\tthis._body.classList.remove('hidden');\n\t\tthis._editModeDisposables.clear();\n\t\tthis._commentEditor = null;\n\t\tthis._commentEditContainer!.remove();\n\t}\n\n\tlayout(widthInPixel?: number) {\n\t\tconst editorWidth = widthInPixel !== undefined ? widthInPixel - 72 /* - margin and scrollbar*/ : (this._commentEditor?.getLayoutInfo().width ?? 0);\n\t\tthis._commentEditor?.layout({ width: editorWidth, height: this._editorHeight });\n\t\tconst scrollWidth = this._body.scrollWidth;\n\t\tconst width = dom.getContentWidth(this._body);\n\t\tconst scrollHeight = this._body.scrollHeight;\n\t\tconst height = dom.getContentHeight(this._body) + 4;\n\t\tthis._scrollableElement.setScrollDimensions({ width, scrollWidth, height, scrollHeight });\n\t}\n\n\tpublic async switchToEditMode() {\n\t\tif (this.isEditing) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isEditing = true;\n\t\tthis._body.classList.add('hidden');\n\t\tthis._commentEditContainer = dom.append(this._commentDetailsContainer, dom.$('.edit-container'));\n\t\tawait this.createCommentEditor(this._commentEditContainer);\n\n\t\tconst formActions = dom.append(this._commentEditContainer, dom.$('.form-actions'));\n\t\tconst otherActions = dom.append(formActions, dom.$('.other-actions'));\n\t\tthis.createCommentWidgetFormActions(otherActions);\n\t\tconst editorActions = dom.append(formActions, dom.$('.editor-actions'));\n\t\tthis.createCommentWidgetEditorActions(editorActions);\n\t}\n\n\tprivate readonly _editModeDisposables: DisposableStore = this._register(new DisposableStore());\n\tprivate createCommentWidgetFormActions(container: HTMLElement) {\n\t\tconst menus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = menus.getCommentActions(this.comment, this._contextKeyService);\n\n\t\tthis._editModeDisposables.add(menu);\n\t\tthis._editModeDisposables.add(menu.onDidChange(() => {\n\t\t\tthis._commentFormActions?.setActions(menu);\n\t\t}));\n\n\t\tthis._commentFormActions = new CommentFormActions(this.keybindingService, this._contextKeyService, this.contextMenuService, container, (action: IAction): void => {\n\t\t\tconst text = this._commentEditor!.getValue();\n\n\t\t\taction.run({\n\t\t\t\tthread: this.commentThread,\n\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\ttext: text,\n\t\t\t\t$mid: MarshalledId.CommentThreadNode\n\t\t\t});\n\n\t\t\tthis.removeCommentEditor();\n\t\t});\n\n\t\tthis._editModeDisposables.add(this._commentFormActions);\n\t\tthis._commentFormActions.setActions(menu);\n\t}\n\n\tprivate createCommentWidgetEditorActions(container: HTMLElement) {\n\t\tconst menus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = menus.getCommentEditorActions(this._contextKeyService);\n\n\t\tthis._editModeDisposables.add(menu);\n\t\tthis._editModeDisposables.add(menu.onDidChange(() => {\n\t\t\tthis._commentEditorActions?.setActions(menu, true);\n\t\t}));\n\n\t\tthis._commentEditorActions = new CommentFormActions(this.keybindingService, this._contextKeyService, this.contextMenuService, container, (action: IAction): void => {\n\t\t\tconst text = this._commentEditor!.getValue();\n\n\t\t\taction.run({\n\t\t\t\tthread: this.commentThread,\n\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\ttext: text,\n\t\t\t\t$mid: MarshalledId.CommentThreadNode\n\t\t\t});\n\n\t\t\tthis._commentEditor?.focus();\n\t\t});\n\n\t\tthis._editModeDisposables.add(this._commentEditorActions);\n\t\tthis._commentEditorActions.setActions(menu, true);\n\t}\n\n\tsetFocus(focused: boolean, visible: boolean = false) {\n\t\tif (focused) {\n\t\t\tthis._domNode.focus();\n\t\t\tthis._actionsToolbarContainer.classList.add('tabfocused');\n\t\t\tthis._domNode.tabIndex = 0;\n\t\t\tif (this.comment.mode === languages.CommentMode.Editing) {\n\t\t\t\tthis._commentEditor?.focus();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._actionsToolbarContainer.classList.contains('tabfocused') && !this._actionsToolbarContainer.classList.contains('mouseover')) {\n\t\t\t\tthis._domNode.tabIndex = -1;\n\t\t\t}\n\t\t\tthis._actionsToolbarContainer.classList.remove('tabfocused');\n\t\t}\n\t}\n\n\tasync update(newComment: languages.Comment) {\n\n\t\tif (newComment.body !== this.comment.body) {\n\t\t\tthis.updateCommentBody(newComment.body);\n\t\t}\n\n\t\tif (this.comment.userIconPath && newComment.userIconPath && (URI.from(this.comment.userIconPath).toString() !== URI.from(newComment.userIconPath).toString())) {\n\t\t\tthis.updateCommentUserIcon(newComment.userIconPath);\n\t\t}\n\n\t\tconst isChangingMode: boolean = newComment.mode !== undefined && newComment.mode !== this.comment.mode;\n\n\t\tthis.comment = newComment;\n\n\t\tif (isChangingMode) {\n\t\t\tif (newComment.mode === languages.CommentMode.Editing) {\n\t\t\t\tawait this.switchToEditMode();\n\t\t\t} else {\n\t\t\t\tthis.removeCommentEditor();\n\t\t\t}\n\t\t}\n\n\t\tif (newComment.label) {\n\t\t\tthis._isPendingLabel.innerText = newComment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = '';\n\t\t}\n\n\t\t// update comment reactions\n\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\n\t\tif (this.comment.contextValue) {\n\t\t\tthis._commentContextValue.set(this.comment.contextValue);\n\t\t} else {\n\t\t\tthis._commentContextValue.reset();\n\t\t}\n\n\t\tif (this.comment.timestamp) {\n\t\t\tthis.updateTimestamp(this.comment.timestamp);\n\t\t}\n\t}\n\n\tprivate onContextMenu(e: MouseEvent) {\n\t\tconst event = new StandardMouseEvent(dom.getWindow(this._domNode), e);\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => event,\n\t\t\tmenuId: MenuId.CommentThreadCommentContext,\n\t\t\tmenuActionOptions: { shouldForwardArgs: true },\n\t\t\tcontextKeyService: this._contextKeyService,\n\t\t\tactionRunner: this._actionRunner,\n\t\t\tgetActionsContext: () => {\n\t\t\t\treturn this.commentNodeContext;\n\t\t\t},\n\t\t});\n\t}\n\n\tfocus() {\n\t\tthis.domNode.focus();\n\t\tif (!this._clearTimeout) {\n\t\t\tthis.domNode.classList.add('focus');\n\t\t\tthis._clearTimeout = setTimeout(() => {\n\t\t\t\tthis.domNode.classList.remove('focus');\n\t\t\t}, 3000);\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t}\n}\n\nfunction fillInActions(groups: [string, Array<MenuItemAction | SubmenuItemAction>][], target: IAction[] | { primary: IAction[]; secondary: IAction[] }, useAlternativeActions: boolean, isPrimaryGroup: (group: string) => boolean = group => group === 'navigation'): void {\n\tfor (const tuple of groups) {\n\t\tlet [group, actions] = tuple;\n\t\tif (useAlternativeActions) {\n\t\t\tactions = actions.map(a => (a instanceof MenuItemAction) && !!a.alt ? a.alt : a);\n\t\t}\n\n\t\tif (isPrimaryGroup(group)) {\n\t\t\tconst to = Array.isArray(target) ? target : target.primary;\n\n\t\t\tto.unshift(...actions);\n\t\t} else {\n\t\t\tconst to = Array.isArray(target) ? target : target.secondary;\n\n\t\t\tif (to.length > 0) {\n\t\t\t\tto.push(new Separator());\n\t\t\t}\n\n\t\t\tto.push(...actions);\n\t\t}\n\t}\n}\n"]}