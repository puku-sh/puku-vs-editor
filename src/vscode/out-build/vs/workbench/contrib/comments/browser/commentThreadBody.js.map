{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentThreadBody.ts"],"names":[],"mappings":"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","file":"commentThreadBody.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport * as nls from '../../../../nls.js';\nimport { Disposable, DisposableMap, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as languages from '../../../../editor/common/languages.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ICommentService } from './commentService.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { KeyCode } from '../../../../base/common/keyCodes.js';\nimport { CommentNode } from './commentNode.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ICommentThreadWidget } from '../common/commentThreadWidget.js';\nimport { IMarkdownRendererExtraOptions } from '../../../../platform/markdown/browser/markdownRenderer.js';\nimport { ICellRange } from '../../notebook/common/notebookRange.js';\nimport { IRange } from '../../../../editor/common/core/range.js';\nimport { LayoutableEditor } from './simpleCommentEditor.js';\n\nexport class CommentThreadBody<T extends IRange | ICellRange = IRange> extends Disposable {\n\tprivate _commentsElement!: HTMLElement;\n\tprivate _commentElements: CommentNode<T>[] = [];\n\tprivate _resizeObserver: MutationObserver | null = null;\n\tprivate _focusedComment: number | undefined = undefined;\n\tprivate _onDidResize = new Emitter<dom.Dimension>();\n\tonDidResize = this._onDidResize.event;\n\n\tprivate _commentDisposable = new DisposableMap<CommentNode<T>, DisposableStore>();\n\n\tget length() {\n\t\treturn this._commentThread.comments ? this._commentThread.comments.length : 0;\n\t}\n\n\tget activeComment() {\n\t\treturn this._commentElements.filter(node => node.isEditing)[0];\n\t}\n\n\tconstructor(\n\t\tprivate readonly _parentEditor: LayoutableEditor,\n\t\treadonly owner: string,\n\t\treadonly parentResourceUri: URI,\n\t\treadonly container: HTMLElement,\n\t\tprivate _markdownRendererOptions: IMarkdownRendererExtraOptions,\n\t\tprivate _commentThread: languages.CommentThread<T>,\n\t\tprivate _pendingEdits: { [key: number]: languages.PendingComment } | undefined,\n\t\tprivate _scopedInstatiationService: IInstantiationService,\n\t\tprivate _parentCommentThreadWidget: ICommentThreadWidget,\n\t\t@ICommentService private readonly commentService: ICommentService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(dom.addDisposableListener(container, dom.EventType.FOCUS_IN, e => {\n\t\t\t// TODO @rebornix, limit T to IRange | ICellRange\n\t\t\tthis.commentService.setActiveEditingCommentThread(this._commentThread);\n\t\t}));\n\t}\n\n\tfocus(commentUniqueId?: number) {\n\t\tif (commentUniqueId !== undefined) {\n\t\t\tconst comment = this._commentElements.find(commentNode => commentNode.comment.uniqueIdInThread === commentUniqueId);\n\t\t\tif (comment) {\n\t\t\t\tcomment.focus();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._commentsElement.focus();\n\t}\n\n\thasCommentsInEditMode() {\n\t\treturn this._commentElements.some(commentNode => commentNode.isEditing);\n\t}\n\n\tensureFocusIntoNewEditingComment() {\n\t\tif (this._commentElements.length === 1 && this._commentElements[0].isEditing) {\n\t\t\tthis._commentElements[0].setFocus(true);\n\t\t}\n\t}\n\n\tasync display() {\n\t\tthis._commentsElement = dom.append(this.container, dom.$('div.comments-container'));\n\t\tthis._commentsElement.setAttribute('role', 'presentation');\n\t\tthis._commentsElement.tabIndex = 0;\n\t\tthis._updateAriaLabel();\n\n\t\tthis._register(dom.addDisposableListener(this._commentsElement, dom.EventType.KEY_DOWN, (e) => {\n\t\t\tconst event = new StandardKeyboardEvent(e as KeyboardEvent);\n\t\t\tif ((event.equals(KeyCode.UpArrow) || event.equals(KeyCode.DownArrow)) && (!this._focusedComment || !this._commentElements[this._focusedComment].isEditing)) {\n\t\t\t\tconst moveFocusWithinBounds = (change: number): number => {\n\t\t\t\t\tif (this._focusedComment === undefined && change >= 0) { return 0; }\n\t\t\t\t\tif (this._focusedComment === undefined && change < 0) { return this._commentElements.length - 1; }\n\t\t\t\t\tconst newIndex = this._focusedComment! + change;\n\t\t\t\t\treturn Math.min(Math.max(0, newIndex), this._commentElements.length - 1);\n\t\t\t\t};\n\n\t\t\t\tthis._setFocusedComment(event.equals(KeyCode.UpArrow) ? moveFocusWithinBounds(-1) : moveFocusWithinBounds(1));\n\t\t\t}\n\t\t}));\n\n\t\tthis._commentDisposable.clearAndDisposeAll();\n\t\tthis._commentElements = [];\n\t\tif (this._commentThread.comments) {\n\t\t\tfor (const comment of this._commentThread.comments) {\n\t\t\t\tconst newCommentNode = this.createNewCommentNode(comment);\n\n\t\t\t\tthis._commentElements.push(newCommentNode);\n\t\t\t\tthis._commentsElement.appendChild(newCommentNode.domNode);\n\t\t\t\tif (comment.mode === languages.CommentMode.Editing) {\n\t\t\t\t\tawait newCommentNode.switchToEditMode();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._resizeObserver = new MutationObserver(this._refresh.bind(this));\n\n\t\tthis._resizeObserver.observe(this.container, {\n\t\t\tattributes: true,\n\t\t\tchildList: true,\n\t\t\tcharacterData: true,\n\t\t\tsubtree: true\n\t\t});\n\t}\n\n\tprivate _containerClientArea: dom.Dimension | undefined = undefined;\n\tprivate _refresh() {\n\t\tconst dimensions = dom.getClientArea(this.container);\n\t\tif ((dimensions.height === 0 && dimensions.width === 0) || (dom.Dimension.equals(this._containerClientArea, dimensions))) {\n\t\t\treturn;\n\t\t}\n\t\tthis._containerClientArea = dimensions;\n\t\tthis._onDidResize.fire(dimensions);\n\t}\n\n\tgetDimensions() {\n\t\treturn dom.getClientArea(this.container);\n\t}\n\n\tlayout(widthInPixel?: number) {\n\t\tthis._commentElements.forEach(element => {\n\t\t\telement.layout(widthInPixel);\n\t\t});\n\t}\n\n\tgetPendingEdits(): { [key: number]: languages.PendingComment } {\n\t\tconst pendingEdits: { [key: number]: languages.PendingComment } = {};\n\t\tthis._commentElements.forEach(element => {\n\t\t\tif (element.isEditing) {\n\t\t\t\tconst pendingEdit = element.getPendingEdit();\n\t\t\t\tif (pendingEdit) {\n\t\t\t\t\tpendingEdits[element.comment.uniqueIdInThread] = pendingEdit;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn pendingEdits;\n\t}\n\n\tgetCommentCoords(commentUniqueId: number): { thread: dom.IDomNodePagePosition; comment: dom.IDomNodePagePosition } | undefined {\n\t\tconst matchedNode = this._commentElements.filter(commentNode => commentNode.comment.uniqueIdInThread === commentUniqueId);\n\t\tif (matchedNode && matchedNode.length) {\n\t\t\tconst commentThreadCoords = dom.getDomNodePagePosition(this._commentElements[0].domNode);\n\t\t\tconst commentCoords = dom.getDomNodePagePosition(matchedNode[0].domNode);\n\t\t\treturn {\n\t\t\t\tthread: commentThreadCoords,\n\t\t\t\tcomment: commentCoords\n\t\t\t};\n\t\t}\n\n\t\treturn;\n\t}\n\n\tasync updateCommentThread(commentThread: languages.CommentThread<T>, preserveFocus: boolean) {\n\t\tconst oldCommentsLen = this._commentElements.length;\n\t\tconst newCommentsLen = commentThread.comments ? commentThread.comments.length : 0;\n\n\t\tconst commentElementsToDel: CommentNode<T>[] = [];\n\t\tconst commentElementsToDelIndex: number[] = [];\n\t\tfor (let i = 0; i < oldCommentsLen; i++) {\n\t\t\tconst comment = this._commentElements[i].comment;\n\t\t\tconst newComment = commentThread.comments ? commentThread.comments.filter(c => c.uniqueIdInThread === comment.uniqueIdInThread) : [];\n\n\t\t\tif (newComment.length) {\n\t\t\t\tthis._commentElements[i].update(newComment[0]);\n\t\t\t} else {\n\t\t\t\tcommentElementsToDelIndex.push(i);\n\t\t\t\tcommentElementsToDel.push(this._commentElements[i]);\n\t\t\t}\n\t\t}\n\n\t\t// del removed elements\n\t\tfor (let i = commentElementsToDel.length - 1; i >= 0; i--) {\n\t\t\tconst commentToDelete = commentElementsToDel[i];\n\t\t\tthis._commentDisposable.deleteAndDispose(commentToDelete);\n\n\t\t\tthis._commentElements.splice(commentElementsToDelIndex[i], 1);\n\t\t\tcommentToDelete.domNode.remove();\n\t\t}\n\n\n\t\tlet lastCommentElement: HTMLElement | null = null;\n\t\tconst newCommentNodeList: CommentNode<T>[] = [];\n\t\tconst newCommentsInEditMode: CommentNode<T>[] = [];\n\t\tconst startEditing: Promise<void>[] = [];\n\n\t\tfor (let i = newCommentsLen - 1; i >= 0; i--) {\n\t\t\tconst currentComment = commentThread.comments![i];\n\t\t\tconst oldCommentNode = this._commentElements.filter(commentNode => commentNode.comment.uniqueIdInThread === currentComment.uniqueIdInThread);\n\t\t\tif (oldCommentNode.length) {\n\t\t\t\tlastCommentElement = oldCommentNode[0].domNode;\n\t\t\t\tnewCommentNodeList.unshift(oldCommentNode[0]);\n\t\t\t} else {\n\t\t\t\tconst newElement = this.createNewCommentNode(currentComment);\n\n\t\t\t\tnewCommentNodeList.unshift(newElement);\n\t\t\t\tif (lastCommentElement) {\n\t\t\t\t\tthis._commentsElement.insertBefore(newElement.domNode, lastCommentElement);\n\t\t\t\t\tlastCommentElement = newElement.domNode;\n\t\t\t\t} else {\n\t\t\t\t\tthis._commentsElement.appendChild(newElement.domNode);\n\t\t\t\t\tlastCommentElement = newElement.domNode;\n\t\t\t\t}\n\n\t\t\t\tif (currentComment.mode === languages.CommentMode.Editing) {\n\t\t\t\t\tstartEditing.push(newElement.switchToEditMode());\n\t\t\t\t\tnewCommentsInEditMode.push(newElement);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._commentThread = commentThread;\n\t\tthis._commentElements = newCommentNodeList;\n\t\t// Start editing *after* updating the thread and elements to avoid a sequencing issue https://github.com/microsoft/vscode/issues/239191\n\t\tawait Promise.all(startEditing);\n\n\t\tif (newCommentsInEditMode.length) {\n\t\t\tconst lastIndex = this._commentElements.indexOf(newCommentsInEditMode[newCommentsInEditMode.length - 1]);\n\t\t\tthis._focusedComment = lastIndex;\n\t\t}\n\n\t\tthis._updateAriaLabel();\n\t\tif (!preserveFocus) {\n\t\t\tthis._setFocusedComment(this._focusedComment);\n\t\t}\n\t}\n\n\tprivate _updateAriaLabel() {\n\t\tif (this._commentThread.isDocumentCommentThread()) {\n\t\t\tif (this._commentThread.range) {\n\t\t\t\tthis._commentsElement.ariaLabel = nls.localize('commentThreadAria.withRange', \"Comment thread with {0} comments on lines {1} through {2}. {3}.\",\n\t\t\t\t\tthis._commentThread.comments?.length, this._commentThread.range.startLineNumber, this._commentThread.range.endLineNumber,\n\t\t\t\t\tthis._commentThread.label);\n\t\t\t} else {\n\t\t\t\tthis._commentsElement.ariaLabel = nls.localize('commentThreadAria.document', \"Comment thread with {0} comments on the entire document. {1}.\",\n\t\t\t\t\tthis._commentThread.comments?.length, this._commentThread.label);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._commentsElement.ariaLabel = nls.localize('commentThreadAria', \"Comment thread with {0} comments. {1}.\",\n\t\t\t\tthis._commentThread.comments?.length, this._commentThread.label);\n\t\t}\n\t}\n\n\tprivate _setFocusedComment(value: number | undefined) {\n\t\tif (this._focusedComment !== undefined) {\n\t\t\tthis._commentElements[this._focusedComment]?.setFocus(false);\n\t\t}\n\n\t\tif (this._commentElements.length === 0 || value === undefined) {\n\t\t\tthis._focusedComment = undefined;\n\t\t} else {\n\t\t\tthis._focusedComment = Math.min(value, this._commentElements.length - 1);\n\t\t\tthis._commentElements[this._focusedComment].setFocus(true);\n\t\t}\n\t}\n\n\tprivate createNewCommentNode(comment: languages.Comment): CommentNode<T> {\n\t\tconst newCommentNode = this._scopedInstatiationService.createInstance(CommentNode,\n\t\t\tthis._parentEditor,\n\t\t\tthis._commentThread,\n\t\t\tcomment,\n\t\t\tthis._pendingEdits ? this._pendingEdits[comment.uniqueIdInThread] : undefined,\n\t\t\tthis.owner,\n\t\t\tthis.parentResourceUri,\n\t\t\tthis._parentCommentThreadWidget,\n\t\t\tthis._markdownRendererOptions) as unknown as CommentNode<T>;\n\n\t\tconst disposables: DisposableStore = new DisposableStore();\n\t\tdisposables.add(newCommentNode.onDidClick(clickedNode =>\n\t\t\tthis._setFocusedComment(this._commentElements.findIndex(commentNode => commentNode.comment.uniqueIdInThread === clickedNode.comment.uniqueIdInThread))\n\t\t));\n\t\tdisposables.add(newCommentNode);\n\t\tthis._commentDisposable.set(newCommentNode, disposables);\n\n\t\treturn newCommentNode;\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tif (this._resizeObserver) {\n\t\t\tthis._resizeObserver.disconnect();\n\t\t\tthis._resizeObserver = null;\n\t\t}\n\n\t\tthis._commentDisposable.dispose();\n\t}\n}\n"]}