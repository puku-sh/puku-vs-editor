{"version":3,"sources":["vs/workbench/contrib/limitIndicator/browser/limitIndicator.contribution.ts"],"names":[],"mappings":"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","file":"limitIndicator.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, IDisposable } from '../../../../base/common/lifecycle.js';\nimport Severity from '../../../../base/common/severity.js';\nimport { ICodeEditor, getCodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { ILanguageStatus, ILanguageStatusService } from '../../../services/languageStatus/common/languageStatusService.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { Extensions as WorkbenchExtensions, IWorkbenchContributionsRegistry, IWorkbenchContribution } from '../../../common/contributions.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { Event } from '../../../../base/common/event.js';\nimport * as nls from '../../../../nls.js';\n\nimport { FoldingController } from '../../../../editor/contrib/folding/browser/folding.js';\nimport { ColorDetector } from '../../../../editor/contrib/colorPicker/browser/colorDetector.js';\n\nconst openSettingsCommand = 'workbench.action.openSettings';\nconst configureSettingsLabel = nls.localize('status.button.configure', \"Configure\");\n\n/**\n * Uses that language status indicator to show information which language features have been limited for performance reasons.\n * Currently this is used for folding ranges and for color decorators.\n */\nexport class LimitIndicatorContribution extends Disposable implements IWorkbenchContribution {\n\n\tconstructor(\n\t\t@IEditorService editorService: IEditorService,\n\t\t@ILanguageStatusService languageStatusService: ILanguageStatusService\n\t) {\n\t\tsuper();\n\n\t\tconst accessors = [new ColorDecorationAccessor(), new FoldingRangeAccessor()];\n\t\tconst statusEntries = accessors.map(indicator => new LanguageStatusEntry(languageStatusService, indicator));\n\t\tstatusEntries.forEach(entry => this._register(entry));\n\n\t\tlet control: unknown;\n\n\t\tconst onActiveEditorChanged = () => {\n\t\t\tconst activeControl = editorService.activeTextEditorControl;\n\t\t\tif (activeControl === control) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcontrol = activeControl;\n\t\t\tconst editor = getCodeEditor(activeControl);\n\n\t\t\tstatusEntries.forEach(statusEntry => statusEntry.onActiveEditorChanged(editor));\n\t\t};\n\t\tthis._register(editorService.onDidActiveEditorChange(onActiveEditorChanged));\n\n\t\tonActiveEditorChanged();\n\t}\n\n}\n\n\nexport interface LimitInfo {\n\treadonly onDidChange: Event<void>;\n\n\treadonly computed: number;\n\treadonly limited: number | false;\n}\n\ninterface LanguageFeatureAccessor {\n\treadonly id: string;\n\treadonly name: string;\n\treadonly label: string;\n\treadonly source: string;\n\treadonly settingsId: string;\n\tgetLimitReporter(editor: ICodeEditor): LimitInfo | undefined;\n}\n\nclass ColorDecorationAccessor implements LanguageFeatureAccessor {\n\treadonly id = 'decoratorsLimitInfo';\n\treadonly name = nls.localize('colorDecoratorsStatusItem.name', 'Color Decorator Status');\n\treadonly label = nls.localize('status.limitedColorDecorators.short', 'Color decorators');\n\treadonly source = nls.localize('colorDecoratorsStatusItem.source', 'Color Decorators');\n\treadonly settingsId = 'editor.colorDecoratorsLimit';\n\n\tgetLimitReporter(editor: ICodeEditor): LimitInfo | undefined {\n\t\treturn ColorDetector.get(editor)?.limitReporter;\n\t}\n}\n\nclass FoldingRangeAccessor implements LanguageFeatureAccessor {\n\treadonly id = 'foldingLimitInfo';\n\treadonly name = nls.localize('foldingRangesStatusItem.name', 'Folding Status');\n\treadonly label = nls.localize('status.limitedFoldingRanges.short', 'Folding ranges');\n\treadonly source = nls.localize('foldingRangesStatusItem.source', 'Folding');\n\treadonly settingsId = 'editor.foldingMaximumRegions';\n\n\tgetLimitReporter(editor: ICodeEditor): LimitInfo | undefined {\n\t\treturn FoldingController.get(editor)?.limitReporter;\n\t}\n}\n\nclass LanguageStatusEntry implements IDisposable {\n\n\tprivate _limitStatusItem: IDisposable | undefined;\n\tprivate _indicatorChangeListener: IDisposable | undefined;\n\n\tconstructor(private languageStatusService: ILanguageStatusService, private accessor: LanguageFeatureAccessor) {\n\t}\n\n\tonActiveEditorChanged(editor: ICodeEditor | null): boolean {\n\t\tif (this._indicatorChangeListener) {\n\t\t\tthis._indicatorChangeListener.dispose();\n\t\t\tthis._indicatorChangeListener = undefined;\n\t\t}\n\n\t\tlet info: LimitInfo | undefined;\n\t\tif (editor) {\n\t\t\tinfo = this.accessor.getLimitReporter(editor);\n\t\t}\n\t\tthis.updateStatusItem(info);\n\t\tif (info) {\n\t\t\tthis._indicatorChangeListener = info.onDidChange(_ => {\n\t\t\t\tthis.updateStatusItem(info);\n\t\t\t});\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\n\tprivate updateStatusItem(info: LimitInfo | undefined) {\n\t\tif (this._limitStatusItem) {\n\t\t\tthis._limitStatusItem.dispose();\n\t\t\tthis._limitStatusItem = undefined;\n\t\t}\n\t\tif (info && info.limited !== false) {\n\t\t\tconst status: ILanguageStatus = {\n\t\t\t\tid: this.accessor.id,\n\t\t\t\tselector: '*',\n\t\t\t\tname: this.accessor.name,\n\t\t\t\tseverity: Severity.Warning,\n\t\t\t\tlabel: this.accessor.label,\n\t\t\t\tdetail: nls.localize('status.limited.details', 'only {0} shown for performance reasons', info.limited),\n\t\t\t\tcommand: { id: openSettingsCommand, arguments: [this.accessor.settingsId], title: configureSettingsLabel },\n\t\t\t\taccessibilityInfo: undefined,\n\t\t\t\tsource: this.accessor.source,\n\t\t\t\tbusy: false\n\t\t\t};\n\t\t\tthis._limitStatusItem = this.languageStatusService.addStatus(status);\n\t\t}\n\t}\n\n\tpublic dispose() {\n\t\tthis._limitStatusItem?.dispose();\n\t\tthis._limitStatusItem = undefined;\n\t\tthis._indicatorChangeListener?.dispose();\n\t\tthis._indicatorChangeListener = undefined;\n\t}\n}\n\nRegistry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).registerWorkbenchContribution(\n\tLimitIndicatorContribution,\n\tLifecyclePhase.Restored\n);\n"]}