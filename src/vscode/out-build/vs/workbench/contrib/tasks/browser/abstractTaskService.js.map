{"version":3,"sources":["vs/workbench/contrib/tasks/browser/abstractTaskService.ts"],"names":[],"mappings":"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","file":"abstractTaskService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Action } from '../../../../base/common/actions.js';\nimport { IStringDictionary } from '../../../../base/common/collections.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport * as glob from '../../../../base/common/glob.js';\nimport * as json from '../../../../base/common/json.js';\nimport { Disposable, DisposableStore, dispose, IDisposable, IReference, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache, Touch } from '../../../../base/common/map.js';\nimport * as Objects from '../../../../base/common/objects.js';\nimport { ValidationState, ValidationStatus } from '../../../../base/common/parsers.js';\nimport * as Platform from '../../../../base/common/platform.js';\nimport { TerminateResponseCode } from '../../../../base/common/processes.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport Severity from '../../../../base/common/severity.js';\nimport * as Types from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as UUID from '../../../../base/common/uuid.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ConfigurationTarget, IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IFileService, IFileStatWithPartialMetadata } from '../../../../platform/files/common/files.js';\nimport { IMarkerData, IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IProgressOptions, IProgressService, ProgressLocation } from '../../../../platform/progress/common/progress.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\nimport { INamedProblemMatcher, ProblemMatcherRegistry } from '../common/problemMatcher.js';\n\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\n\nimport { IModelService } from '../../../../editor/common/services/model.js';\n\nimport { IWorkspace, IWorkspaceContextService, IWorkspaceFolder, WorkbenchState, WorkspaceFolder } from '../../../../platform/workspace/common/workspace.js';\nimport { IConfigurationResolverService } from '../../../services/configurationResolver/common/configurationResolver.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { Markers } from '../../markers/common/markers.js';\n\nimport { IOutputChannel, IOutputService } from '../../../services/output/common/output.js';\nimport { ITextFileService } from '../../../services/textfile/common/textfiles.js';\n\nimport { ITerminalGroupService, ITerminalService } from '../../terminal/browser/terminal.js';\nimport { ITerminalProfileResolverService } from '../../terminal/common/terminal.js';\n\nimport { ConfiguringTask, ContributedTask, CustomTask, ExecutionEngine, InMemoryTask, InstancePolicy, ITaskConfig, ITaskEvent, ITaskIdentifier, ITaskInactiveEvent, ITaskProcessEndedEvent, ITaskSet, JsonSchemaVersion, KeyedTaskIdentifier, RerunAllRunningTasksCommandId, RuntimeType, Task, TASK_RUNNING_STATE, TaskDefinition, TaskEventKind, TaskGroup, TaskRunSource, TaskSettingId, TaskSorter, TaskSourceKind, TasksSchemaProperties, USER_TASKS_GROUP_KEY } from '../common/tasks.js';\nimport { ChatAgentLocation, ChatModeKind } from '../../chat/common/constants.js';\nimport { CustomExecutionSupportedContext, ICustomizationProperties, IProblemMatcherRunOptions, ITaskFilter, ITaskProvider, ITaskService, IWorkspaceFolderTaskResult, ProcessExecutionSupportedContext, ServerlessWebContext, ShellExecutionSupportedContext, TaskCommandsRegistered, TaskExecutionSupportedContext, TasksAvailableContext } from '../common/taskService.js';\nimport { ITaskExecuteResult, ITaskResolver, ITaskSummary, ITaskSystem, ITaskSystemInfo, ITaskTerminateResponse, TaskError, TaskErrors, TaskExecuteKind, Triggers, VerifiedTask } from '../common/taskSystem.js';\nimport { getTemplates as getTaskTemplates } from '../common/taskTemplates.js';\n\nimport * as TaskConfig from '../common/taskConfiguration.js';\nimport { TerminalTaskSystem } from './terminalTaskSystem.js';\n\nimport { IQuickInputService, IQuickPickItem, IQuickPickSeparator, QuickPickInput } from '../../../../platform/quickinput/common/quickInput.js';\n\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { TaskDefinitionRegistry } from '../common/taskDefinitionRegistry.js';\n\nimport { getActiveElement } from '../../../../base/browser/dom.js';\nimport { raceTimeout } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { toFormattedString } from '../../../../base/common/jsonFormatter.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { IResolvedTextEditorModel, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { TextEditorSelectionRevealType } from '../../../../platform/editor/common/editor.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { TerminalExitReason } from '../../../../platform/terminal/common/terminal.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IWorkspaceTrustManagementService, IWorkspaceTrustRequestService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { VirtualWorkspaceContext } from '../../../common/contextkeys.js';\nimport { EditorResourceAccessor, SaveReason } from '../../../common/editor.js';\nimport { IViewDescriptorService } from '../../../common/views.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { ILifecycleService, ShutdownReason, StartupKind } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IPaneCompositePartService } from '../../../services/panecomposite/browser/panecomposite.js';\nimport { IPathService } from '../../../services/path/common/pathService.js';\nimport { IPreferencesService } from '../../../services/preferences/common/preferences.js';\nimport { IRemoteAgentService } from '../../../services/remote/common/remoteAgentService.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { CHAT_OPEN_ACTION_ID } from '../../chat/browser/actions/chatActions.js';\nimport { IChatAgentService } from '../../chat/common/chatAgents.js';\nimport { IChatService } from '../../chat/common/chatService.js';\nimport { configureTaskIcon, isWorkspaceFolder, ITaskQuickPickEntry, QUICKOPEN_DETAIL_CONFIG, QUICKOPEN_SKIP_CONFIG, TaskQuickPick } from './taskQuickPick.js';\nimport { IHostService } from '../../../services/host/browser/host.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { FocusMode } from '../../../../platform/native/common/native.js';\n\nconst QUICKOPEN_HISTORY_LIMIT_CONFIG = 'task.quickOpen.history';\nconst PROBLEM_MATCHER_NEVER_CONFIG = 'task.problemMatchers.neverPrompt';\nconst USE_SLOW_PICKER = 'task.quickOpen.showAll';\n\nconst TaskTerminalType = 'Task';\n\nexport namespace ConfigureTaskAction {\n\texport const ID = 'workbench.action.tasks.configureTaskRunner';\n\texport const TEXT = nls.localize2('ConfigureTaskRunnerAction.label', \"Configure Task\");\n}\n\nexport type TaskQuickPickEntryType = (IQuickPickItem & { task: Task }) | (IQuickPickItem & { folder: IWorkspaceFolder }) | (IQuickPickItem & { settingType: string });\n\nclass ProblemReporter implements TaskConfig.IProblemReporter {\n\n\tprivate _validationStatus: ValidationStatus;\n\tprivate readonly _onDidError: Emitter<string> = new Emitter<string>();\n\tpublic readonly onDidError: Event<string> = this._onDidError.event;\n\n\tconstructor(private _outputChannel: IOutputChannel) {\n\t\tthis._validationStatus = new ValidationStatus();\n\t}\n\n\tpublic info(message: string): void {\n\t\tthis._validationStatus.state = ValidationState.Info;\n\t\tthis._outputChannel.append(message + '\\n');\n\t}\n\n\tpublic warn(message: string): void {\n\t\tthis._validationStatus.state = ValidationState.Warning;\n\t\tthis._outputChannel.append(message + '\\n');\n\t}\n\n\tpublic error(message: string): void {\n\t\tthis._validationStatus.state = ValidationState.Error;\n\t\tthis._outputChannel.append(message + '\\n');\n\t\tthis._onDidError.fire(message);\n\t}\n\n\tpublic fatal(message: string): void {\n\t\tthis._validationStatus.state = ValidationState.Fatal;\n\t\tthis._outputChannel.append(message + '\\n');\n\t\tthis._onDidError.fire(message);\n\t}\n\n\tpublic get status(): ValidationStatus {\n\t\treturn this._validationStatus;\n\t}\n}\n\nexport interface IWorkspaceFolderConfigurationResult {\n\tworkspaceFolder: IWorkspaceFolder;\n\tconfig: TaskConfig.IExternalTaskRunnerConfiguration | undefined;\n\thasErrors: boolean;\n}\n\ninterface ICommandUpgrade {\n\tcommand?: string;\n\targs?: string[];\n}\n\nclass TaskMap {\n\tprivate _store: Map<string, Task[]> = new Map();\n\n\tpublic forEach(callback: (value: Task[], folder: string) => void): void {\n\t\tthis._store.forEach(callback);\n\t}\n\n\tpublic static getKey(workspaceFolder: IWorkspace | IWorkspaceFolder | string): string {\n\t\tlet key: string | undefined;\n\t\tif (Types.isString(workspaceFolder)) {\n\t\t\tkey = workspaceFolder;\n\t\t} else {\n\t\t\tconst uri: URI | null | undefined = isWorkspaceFolder(workspaceFolder) ? workspaceFolder.uri : workspaceFolder.configuration;\n\t\t\tkey = uri ? uri.toString() : '';\n\t\t}\n\t\treturn key;\n\t}\n\n\tpublic get(workspaceFolder: IWorkspace | IWorkspaceFolder | string): Task[] {\n\t\tconst key = TaskMap.getKey(workspaceFolder);\n\t\tlet result: Task[] | undefined = this._store.get(key);\n\t\tif (!result) {\n\t\t\tresult = [];\n\t\t\tthis._store.set(key, result);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic add(workspaceFolder: IWorkspace | IWorkspaceFolder | string, ...task: Task[]): void {\n\t\tconst key = TaskMap.getKey(workspaceFolder);\n\t\tlet values = this._store.get(key);\n\t\tif (!values) {\n\t\t\tvalues = [];\n\t\t\tthis._store.set(key, values);\n\t\t}\n\t\tvalues.push(...task);\n\t}\n\n\tpublic all(): Task[] {\n\t\tconst result: Task[] = [];\n\t\tthis._store.forEach((values) => result.push(...values));\n\t\treturn result;\n\t}\n}\n\nexport abstract class AbstractTaskService extends Disposable implements ITaskService {\n\n\t// private static autoDetectTelemetryName: string = 'taskServer.autoDetect';\n\tprivate static readonly RecentlyUsedTasks_Key = 'workbench.tasks.recentlyUsedTasks';\n\tprivate static readonly RecentlyUsedTasks_KeyV2 = 'workbench.tasks.recentlyUsedTasks2';\n\tprivate static readonly PersistentTasks_Key = 'workbench.tasks.persistentTasks';\n\tprivate static readonly IgnoreTask010DonotShowAgain_key = 'workbench.tasks.ignoreTask010Shown';\n\n\tpublic _serviceBrand: undefined;\n\tpublic static OutputChannelId: string = 'tasks';\n\tpublic static OutputChannelLabel: string = nls.localize('tasks', \"Tasks\");\n\n\tprivate static _nextHandle: number = 0;\n\n\tprivate _tasksReconnected: boolean = false;\n\tprivate _schemaVersion: JsonSchemaVersion | undefined;\n\tprivate _executionEngine: ExecutionEngine | undefined;\n\tprivate _workspaceFolders: IWorkspaceFolder[] | undefined;\n\tprivate _workspace: IWorkspace | undefined;\n\tprivate _ignoredWorkspaceFolders: IWorkspaceFolder[] | undefined;\n\tprivate _showIgnoreMessage?: boolean;\n\tprivate _providers: Map<number, ITaskProvider>;\n\tprivate _providerTypes: Map<number, string>;\n\tprotected _taskSystemInfos: Map<string, ITaskSystemInfo[]>;\n\n\tprotected _workspaceTasksPromise?: Promise<Map<string, IWorkspaceFolderTaskResult>>;\n\tprotected readonly _whenTaskSystemReady: Promise<void>;\n\n\tprotected _taskSystem?: ITaskSystem;\n\tprotected _taskSystemListeners?: IDisposable[] = [];\n\tprivate _recentlyUsedTasksV1: LRUCache<string, string> | undefined;\n\tprivate _recentlyUsedTasks: LRUCache<string, string> | undefined;\n\n\tprivate _persistentTasks: LRUCache<string, string> | undefined;\n\n\tprotected _taskRunningState: IContextKey<boolean>;\n\tprotected _tasksAvailableState: IContextKey<boolean>;\n\n\tprotected _outputChannel: IOutputChannel;\n\tprotected readonly _onDidStateChange: Emitter<ITaskEvent>;\n\tprivate _waitForAllSupportedExecutions: Promise<void>;\n\tprivate _onDidRegisterSupportedExecutions: Emitter<void> = new Emitter();\n\tprivate _onDidRegisterAllSupportedExecutions: Emitter<void> = new Emitter();\n\tprivate _onDidChangeTaskSystemInfo: Emitter<void> = new Emitter();\n\tprivate _willRestart: boolean = false;\n\tpublic onDidChangeTaskSystemInfo: Event<void> = this._onDidChangeTaskSystemInfo.event;\n\tprivate _onDidReconnectToTasks: Emitter<void> = new Emitter();\n\tpublic onDidReconnectToTasks: Event<void> = this._onDidReconnectToTasks.event;\n\tprivate _onDidChangeTaskConfig: Emitter<void> = new Emitter();\n\tpublic onDidChangeTaskConfig: Event<void> = this._onDidChangeTaskConfig.event;\n\tpublic get isReconnected(): boolean { return this._tasksReconnected; }\n\tprivate _onDidChangeTaskProviders = this._register(new Emitter<void>());\n\tpublic onDidChangeTaskProviders = this._onDidChangeTaskProviders.event;\n\tprivate readonly _taskRunStartTimes = new Map<string, number>();\n\tprivate readonly _taskRunSources = new Map<string, TaskRunSource>();\n\n\tprivate _activatedTaskProviders: Set<string> = new Set();\n\n\tprivate readonly notification = this._register(new MutableDisposable<DisposableStore>());\n\n\tconstructor(\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IMarkerService protected readonly _markerService: IMarkerService,\n\t\t@IOutputService protected readonly _outputService: IOutputService,\n\t\t@IPaneCompositePartService private readonly _paneCompositeService: IPaneCompositePartService,\n\t\t@IViewsService private readonly _viewsService: IViewsService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IFileService protected readonly _fileService: IFileService,\n\t\t@IWorkspaceContextService protected readonly _contextService: IWorkspaceContextService,\n\t\t@ITelemetryService protected readonly _telemetryService: ITelemetryService,\n\t\t@ITextFileService private readonly _textFileService: ITextFileService,\n\t\t@IModelService protected readonly _modelService: IModelService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@IConfigurationResolverService protected readonly _configurationResolverService: IConfigurationResolverService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IProgressService private readonly _progressService: IProgressService,\n\t\t@IOpenerService private readonly _openerService: IOpenerService,\n\t\t@IDialogService protected readonly _dialogService: IDialogService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@IContextKeyService protected readonly _contextKeyService: IContextKeyService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@ITerminalProfileResolverService private readonly _terminalProfileResolverService: ITerminalProfileResolverService,\n\t\t@IPathService private readonly _pathService: IPathService,\n\t\t@ITextModelService private readonly _textModelResolverService: ITextModelService,\n\t\t@IPreferencesService private readonly _preferencesService: IPreferencesService,\n\t\t@IViewDescriptorService private readonly _viewDescriptorService: IViewDescriptorService,\n\t\t@IWorkspaceTrustRequestService private readonly _workspaceTrustRequestService: IWorkspaceTrustRequestService,\n\t\t@IWorkspaceTrustManagementService private readonly _workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@ILifecycleService private readonly _lifecycleService: ILifecycleService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IChatService private readonly _chatService: IChatService,\n\t\t@IChatAgentService private readonly _chatAgentService: IChatAgentService,\n\t\t@IHostService private readonly _hostService: IHostService\n\t) {\n\t\tsuper();\n\t\tthis._whenTaskSystemReady = Event.toPromise(this.onDidChangeTaskSystemInfo);\n\t\tthis._workspaceTasksPromise = undefined;\n\t\tthis._taskSystem = undefined;\n\t\tthis._taskSystemListeners = undefined;\n\t\tthis._outputChannel = this._outputService.getChannel(AbstractTaskService.OutputChannelId)!;\n\t\tthis._providers = new Map<number, ITaskProvider>();\n\t\tthis._providerTypes = new Map<number, string>();\n\t\tthis._taskSystemInfos = new Map<string, ITaskSystemInfo[]>();\n\t\tthis._register(this._contextService.onDidChangeWorkspaceFolders(() => {\n\t\t\tconst folderSetup = this._computeWorkspaceFolderSetup();\n\t\t\tif (this.executionEngine !== folderSetup[2]) {\n\t\t\t\tthis._disposeTaskSystemListeners();\n\t\t\t\tthis._taskSystem = undefined;\n\t\t\t}\n\t\t\tthis._updateSetup(folderSetup);\n\t\t\treturn this._updateWorkspaceTasks(TaskRunSource.FolderOpen);\n\t\t}));\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(async (e) => {\n\t\t\tif (!e.affectsConfiguration('tasks') || (!this._taskSystem && !this._workspaceTasksPromise)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._taskSystem || this._taskSystem instanceof TerminalTaskSystem) {\n\t\t\t\tthis._outputChannel.clear();\n\t\t\t}\n\n\t\t\tif (e.affectsConfiguration(TaskSettingId.Reconnection)) {\n\t\t\t\tif (!this._configurationService.getValue(TaskSettingId.Reconnection)) {\n\t\t\t\t\tthis._persistentTasks?.clear();\n\t\t\t\t\tthis._storageService.remove(AbstractTaskService.PersistentTasks_Key, StorageScope.WORKSPACE);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._setTaskLRUCacheLimit();\n\t\t\tconst mapStringToFolderTasks: Map<string, IWorkspaceFolderTaskResult> = await this._updateWorkspaceTasks(TaskRunSource.ConfigurationChange);\n\t\t\tthis._onDidChangeTaskConfig.fire();\n\n\t\t\t// Loop through all workspaceFolderTask result\n\t\t\tfor (const [folderUri, folderResult] of mapStringToFolderTasks) {\n\t\t\t\tif (!folderResult.set?.tasks?.length) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (const task of folderResult.set.tasks) {\n\t\t\t\t\tconst realUniqueId = task._id;\n\t\t\t\t\tconst lastTask = this._taskSystem?.lastTask?.task._id;\n\n\t\t\t\t\tif (lastTask && lastTask === realUniqueId && folderUri !== 'setting') {\n\t\t\t\t\t\tconst verifiedLastTask = new VerifiedTask(task, this._taskSystem!.lastTask!.resolver, Triggers.command);\n\t\t\t\t\t\tthis._taskSystem!.lastTask = verifiedLastTask;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}));\n\t\tthis._taskRunningState = TASK_RUNNING_STATE.bindTo(_contextKeyService);\n\t\tthis._tasksAvailableState = TasksAvailableContext.bindTo(_contextKeyService);\n\t\tthis._onDidStateChange = this._register(new Emitter());\n\t\tthis._registerCommands().then(() => TaskCommandsRegistered.bindTo(this._contextKeyService).set(true));\n\t\tServerlessWebContext.bindTo(this._contextKeyService).set(Platform.isWeb && !remoteAgentService.getConnection()?.remoteAuthority);\n\t\tthis._configurationResolverService.contributeVariable('defaultBuildTask', async (): Promise<string | undefined> => {\n\t\t\t// delay provider activation, we might find a single default build task in the tasks.json file\n\t\t\tlet tasks = await this._getTasksForGroup(TaskGroup.Build, true);\n\t\t\tif (tasks.length > 0) {\n\t\t\t\tconst defaults = this._getDefaultTasks(tasks);\n\t\t\t\tif (defaults.length === 1) {\n\t\t\t\t\treturn defaults[0]._label;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// activate all providers, we haven't found the default build task in the tasks.json file\n\t\t\ttasks = await this._getTasksForGroup(TaskGroup.Build);\n\t\t\tconst defaults = this._getDefaultTasks(tasks);\n\t\t\tif (defaults.length === 1) {\n\t\t\t\treturn defaults[0]._label;\n\t\t\t} else if (defaults.length) {\n\t\t\t\ttasks = defaults;\n\t\t\t}\n\n\t\t\tlet entry: ITaskQuickPickEntry | null | undefined;\n\t\t\tif (tasks && tasks.length > 0) {\n\t\t\t\tentry = await this._showQuickPick(tasks, nls.localize('TaskService.pickBuildTaskForLabel', 'Select the build task (there is no default build task defined)'));\n\t\t\t}\n\n\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\tif (!task) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn task._label;\n\t\t});\n\t\tthis._register(this._lifecycleService.onBeforeShutdown(e => {\n\t\t\tthis._willRestart = e.reason !== ShutdownReason.RELOAD;\n\t\t}));\n\t\tthis._register(this.onDidStateChange(async e => {\n\t\t\tthis._log(nls.localize('taskEvent', 'Task Event kind: {0}', e.kind), true);\n\t\t\tswitch (e.kind) {\n\t\t\t\tcase TaskEventKind.Start:\n\t\t\t\t\tthis._taskRunStartTimes.set(e.taskId, Date.now());\n\t\t\t\t\tbreak;\n\t\t\t\tcase TaskEventKind.ProcessEnded: {\n\t\t\t\t\tconst processEndedEvent = e as ITaskProcessEndedEvent;\n\t\t\t\t\tconst startTime = this._taskRunStartTimes.get(e.taskId);\n\t\t\t\t\tif (!startTime) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst durationMs = processEndedEvent.durationMs ?? (Date.now() - startTime);\n\t\t\t\t\tif (durationMs !== undefined) {\n\t\t\t\t\t\tthis._handleLongRunningTaskCompletion(processEndedEvent, durationMs);\n\t\t\t\t\t}\n\t\t\t\t\tthis._taskRunStartTimes.delete(e.taskId);\n\t\t\t\t\tthis._taskRunSources.delete(e.taskId);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase TaskEventKind.Inactive: {\n\t\t\t\t\tconst processEndedEvent = e as ITaskInactiveEvent;\n\t\t\t\t\tconst startTime = this._taskRunStartTimes.get(e.taskId);\n\t\t\t\t\tif (!startTime) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst durationMs = processEndedEvent.durationMs ?? (Date.now() - startTime);\n\t\t\t\t\tif (durationMs !== undefined) {\n\t\t\t\t\t\tthis._handleLongRunningTaskCompletion(processEndedEvent, durationMs);\n\t\t\t\t\t}\n\t\t\t\t\tthis._taskRunStartTimes.delete(e.taskId);\n\t\t\t\t\tthis._taskRunSources.delete(e.taskId);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase TaskEventKind.Terminated:\n\t\t\t\t\tthis._taskRunStartTimes.delete(e.taskId);\n\t\t\t\t\tthis._taskRunSources.delete(e.taskId);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (e.kind === TaskEventKind.Changed) {\n\t\t\t\t// no-op\n\t\t\t} else if ((this._willRestart || (e.kind === TaskEventKind.Terminated && e.exitReason === TerminalExitReason.User)) && e.taskId) {\n\t\t\t\tconst key = e.__task.getKey();\n\t\t\t\tif (key) {\n\t\t\t\t\tthis.removePersistentTask(key);\n\t\t\t\t}\n\t\t\t} else if (e.kind === TaskEventKind.Start && e.__task && e.__task.getWorkspaceFolder()) {\n\t\t\t\tthis._setPersistentTask(e.__task);\n\t\t\t}\n\t\t}));\n\t\tthis._waitForAllSupportedExecutions = new Promise(resolve => {\n\t\t\tEvent.once(this._onDidRegisterAllSupportedExecutions.event)(() => resolve());\n\t\t});\n\n\t\tthis._terminalService.whenConnected.then(() => {\n\t\t\tconst reconnectedInstances = this._terminalService.instances.filter(e => e.reconnectionProperties?.ownerId === TaskTerminalType);\n\t\t\tif (reconnectedInstances.length) {\n\t\t\t\tthis._attemptTaskReconnection();\n\t\t\t} else {\n\t\t\t\tthis._tasksReconnected = true;\n\t\t\t\tthis._onDidReconnectToTasks.fire();\n\t\t\t}\n\t\t});\n\n\t\tthis._upgrade();\n\t}\n\n\tpublic registerSupportedExecutions(custom?: boolean, shell?: boolean, process?: boolean) {\n\t\tif (custom !== undefined) {\n\t\t\tconst customContext = CustomExecutionSupportedContext.bindTo(this._contextKeyService);\n\t\t\tcustomContext.set(custom);\n\t\t}\n\t\tconst isVirtual = !!VirtualWorkspaceContext.getValue(this._contextKeyService);\n\t\tif (shell !== undefined) {\n\t\t\tconst shellContext = ShellExecutionSupportedContext.bindTo(this._contextKeyService);\n\t\t\tshellContext.set(shell && !isVirtual);\n\t\t}\n\t\tif (process !== undefined) {\n\t\t\tconst processContext = ProcessExecutionSupportedContext.bindTo(this._contextKeyService);\n\t\t\tprocessContext.set(process && !isVirtual);\n\t\t}\n\t\t// update tasks so an incomplete list isn't returned when getWorkspaceTasks is called\n\t\tthis._workspaceTasksPromise = undefined;\n\t\tthis._onDidRegisterSupportedExecutions.fire();\n\t\tif (ServerlessWebContext.getValue(this._contextKeyService) || (custom && shell && process)) {\n\t\t\tthis._onDidRegisterAllSupportedExecutions.fire();\n\t\t}\n\t}\n\n\tprivate _attemptTaskReconnection(): void {\n\t\tif (this._lifecycleService.startupKind !== StartupKind.ReloadedWindow) {\n\t\t\tthis._log(nls.localize('TaskService.skippingReconnection', 'Startup kind not window reload, setting connected and removing persistent tasks'), true);\n\t\t\tthis._tasksReconnected = true;\n\t\t\tthis._storageService.remove(AbstractTaskService.PersistentTasks_Key, StorageScope.WORKSPACE);\n\t\t}\n\t\tif (!this._configurationService.getValue(TaskSettingId.Reconnection) || this._tasksReconnected) {\n\t\t\tthis._log(nls.localize('TaskService.notConnecting', 'Setting tasks connected configured value {0}, tasks were already reconnected {1}', this._configurationService.getValue(TaskSettingId.Reconnection), this._tasksReconnected), true);\n\t\t\tthis._tasksReconnected = true;\n\t\t\treturn;\n\t\t}\n\t\tthis._log(nls.localize('TaskService.reconnecting', 'Reconnecting to running tasks...'), true);\n\t\tthis.getWorkspaceTasks(TaskRunSource.Reconnect).then(async () => {\n\t\t\tthis._tasksReconnected = await this._reconnectTasks();\n\t\t\tthis._log(nls.localize('TaskService.reconnected', 'Reconnected to running tasks.'), true);\n\t\t\tthis._onDidReconnectToTasks.fire();\n\t\t});\n\t}\n\n\tprivate async _handleLongRunningTaskCompletion(event: ITaskProcessEndedEvent | ITaskInactiveEvent, durationMs: number): Promise<void> {\n\t\tconst notificationThreshold = this._configurationService.getValue<number>(TaskSettingId.NotifyWindowOnTaskCompletion);\n\t\t// If threshold is -1, notifications are disabled\n\t\t// If threshold is 0, always show notifications (no minimum duration)\n\t\t// Otherwise, only show if duration meets or exceeds the threshold\n\t\tif (notificationThreshold === -1 || (notificationThreshold > 0 && durationMs < notificationThreshold)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskRunSource = this._taskRunSources.get(event.taskId);\n\t\tif (taskRunSource === TaskRunSource.ChatAgent) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst terminalForTask = this._terminalService.instances.find(i => i.instanceId === event.terminalId);\n\t\tif (!terminalForTask) {\n\t\t\treturn;\n\t\t}\n\t\tconst taskLabel = terminalForTask.title;\n\t\tconst targetWindow = dom.getWindow(terminalForTask.domElement);\n\t\tif (targetWindow.document.hasFocus()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst durationText = this._formatTaskDuration(durationMs);\n\t\tconst message = taskLabel\n\t\t\t? nls.localize('task.longRunningTaskCompletedWithLabel', 'Task \"{0}\" finished in {1}.', taskLabel, durationText)\n\t\t\t: nls.localize('task.longRunningTaskCompleted', 'Task finished in {0}.', durationText);\n\t\tthis._hostService.focus(targetWindow, { mode: FocusMode.Notify });\n\t\tconst notification = await dom.triggerNotification(message);\n\t\tif (notification) {\n\t\t\tconst disposables = this.notification.value = new DisposableStore();\n\t\t\tdisposables.add(notification);\n\n\t\t\tdisposables.add(Event.once(notification.onClick)(() => {\n\t\t\t\tthis._hostService.focus(targetWindow, { mode: FocusMode.Force });\n\t\t\t}));\n\n\t\t\tdisposables.add(this._hostService.onDidChangeFocus(focus => {\n\t\t\t\tif (focus) {\n\t\t\t\t\tdisposables.dispose();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _formatTaskDuration(durationMs: number): string {\n\t\tconst totalSeconds = Math.max(1, Math.round(durationMs / 1000));\n\t\tconst minutes = Math.floor(totalSeconds / 60);\n\t\tconst seconds = totalSeconds % 60;\n\t\tif (minutes > 0) {\n\t\t\treturn seconds > 0\n\t\t\t\t? nls.localize('task.longRunningTaskDurationMinutesSeconds', '{0}m {1}s', minutes, seconds)\n\t\t\t\t: nls.localize('task.longRunningTaskDurationMinutes', '{0}m', minutes);\n\t\t}\n\t\treturn nls.localize('task.longRunningTaskDurationSeconds', '{0}s', seconds);\n\t}\n\n\tprivate async _reconnectTasks(): Promise<boolean> {\n\t\tconst tasks = await this.getSavedTasks('persistent');\n\t\tif (!tasks.length) {\n\t\t\tthis._log(nls.localize('TaskService.noTasks', 'No persistent tasks to reconnect.'), true);\n\t\t\treturn true;\n\t\t}\n\t\tconst taskLabels = tasks.map(task => task._label).join(', ');\n\t\tthis._log(nls.localize('TaskService.reconnectingTasks', 'Reconnecting to {0} tasks...', taskLabels), true);\n\t\tfor (const task of tasks) {\n\t\t\tif (ConfiguringTask.is(task)) {\n\t\t\t\tconst resolved = await this.tryResolveTask(task);\n\t\t\t\tif (resolved) {\n\t\t\t\t\tthis.run(resolved, undefined, TaskRunSource.Reconnect);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.run(task, undefined, TaskRunSource.Reconnect);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic get onDidStateChange(): Event<ITaskEvent> {\n\t\treturn this._onDidStateChange.event;\n\t}\n\n\tpublic get supportsMultipleTaskExecutions(): boolean {\n\t\treturn this.inTerminal();\n\t}\n\n\tprivate async _registerCommands(): Promise<void> {\n\t\tCommandsRegistry.registerCommand({\n\t\t\tid: 'workbench.action.tasks.runTask',\n\t\t\thandler: async (accessor, arg?: string | ITaskIdentifier) => {\n\t\t\t\tif (await this._trust()) {\n\t\t\t\t\tawait this._runTaskCommand(arg);\n\t\t\t\t}\n\t\t\t},\n\t\t\tmetadata: {\n\t\t\t\tdescription: 'Run Task',\n\t\t\t\targs: [{\n\t\t\t\t\tname: 'args',\n\t\t\t\t\tisOptional: true,\n\t\t\t\t\tdescription: nls.localize('runTask.arg', \"Filters the tasks shown in the quickpick\"),\n\t\t\t\t\tschema: {\n\t\t\t\t\t\tanyOf: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\tdescription: nls.localize('runTask.label', \"The task's label or a term to filter by\")\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\t\t\tdescription: nls.localize('runTask.type', \"The contributed task type\")\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttask: {\n\t\t\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\t\t\tdescription: nls.localize('runTask.task', \"The task's label or a term to filter by\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.reRunTask', async (accessor) => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._reRunTaskCommand();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.restartTask', async (accessor, arg?: string | ITaskIdentifier) => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runRestartTaskCommand(arg);\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand(RerunAllRunningTasksCommandId, async (accessor) => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runRerunAllRunningTasksCommand();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.terminate', async (accessor, arg?: string | ITaskIdentifier) => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runTerminateCommand(arg);\n\t\t\t}\n\t\t});\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.showLog', () => {\n\t\t\tthis._showOutput(undefined, true);\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.build', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runBuildCommand();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.test', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runTestCommand();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.configureTaskRunner', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runConfigureTasks();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.configureDefaultBuildTask', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runConfigureDefaultBuildTask();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.configureDefaultTestTask', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\tthis._runConfigureDefaultTestTask();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.showTasks', async () => {\n\t\t\tif (await this._trust()) {\n\t\t\t\treturn this.runShowTasks();\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.toggleProblems', () => this._commandService.executeCommand(Markers.TOGGLE_MARKERS_VIEW_ACTION_ID));\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.openUserTasks', async () => {\n\t\t\tconst resource = this._getResourceForKind(TaskSourceKind.User);\n\t\t\tif (resource) {\n\t\t\t\tthis._openTaskFile(resource, TaskSourceKind.User);\n\t\t\t}\n\t\t});\n\n\t\tCommandsRegistry.registerCommand('workbench.action.tasks.openWorkspaceFileTasks', async () => {\n\t\t\tconst resource = this._getResourceForKind(TaskSourceKind.WorkspaceFile);\n\t\t\tif (resource) {\n\t\t\t\tthis._openTaskFile(resource, TaskSourceKind.WorkspaceFile);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get workspaceFolders(): IWorkspaceFolder[] {\n\t\tif (!this._workspaceFolders) {\n\t\t\tthis._updateSetup();\n\t\t}\n\t\treturn this._workspaceFolders!;\n\t}\n\n\tprivate get ignoredWorkspaceFolders(): IWorkspaceFolder[] {\n\t\tif (!this._ignoredWorkspaceFolders) {\n\t\t\tthis._updateSetup();\n\t\t}\n\t\treturn this._ignoredWorkspaceFolders!;\n\t}\n\n\tprotected get executionEngine(): ExecutionEngine {\n\t\tif (this._executionEngine === undefined) {\n\t\t\tthis._updateSetup();\n\t\t}\n\t\treturn this._executionEngine!;\n\t}\n\n\tprivate get schemaVersion(): JsonSchemaVersion {\n\t\tif (this._schemaVersion === undefined) {\n\t\t\tthis._updateSetup();\n\t\t}\n\t\treturn this._schemaVersion!;\n\t}\n\n\tprivate get showIgnoreMessage(): boolean {\n\t\tif (this._showIgnoreMessage === undefined) {\n\t\t\tthis._showIgnoreMessage = !this._storageService.getBoolean(AbstractTaskService.IgnoreTask010DonotShowAgain_key, StorageScope.WORKSPACE, false);\n\t\t}\n\t\treturn this._showIgnoreMessage;\n\t}\n\n\tprivate _getActivationEvents(type: string | undefined): string[] {\n\t\tconst result: string[] = [];\n\t\tresult.push('onCommand:workbench.action.tasks.runTask');\n\t\tif (type) {\n\t\t\t// send a specific activation event for this task type\n\t\t\tresult.push(`onTaskType:${type}`);\n\t\t} else {\n\t\t\t// send activation events for all task types\n\t\t\tfor (const definition of TaskDefinitionRegistry.all()) {\n\t\t\t\tresult.push(`onTaskType:${definition.taskType}`);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate async _activateTaskProviders(type: string | undefined): Promise<void> {\n\t\t// We need to first wait for extensions to be registered because we might read\n\t\t// the `TaskDefinitionRegistry` in case `type` is `undefined`\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tconst hasLoggedActivation = this._activatedTaskProviders.has(type ?? 'all');\n\t\tif (!hasLoggedActivation) {\n\t\t\tthis._log('Activating task providers ' + (type ?? 'all'));\n\t\t}\n\t\tconst result = await raceTimeout(\n\t\t\tPromise.all(this._getActivationEvents(type).map(activationEvent => this._extensionService.activateByEvent(activationEvent))),\n\t\t\t5000,\n\t\t\t() => this._logService.warn('Timed out activating extensions for task providers')\n\t\t);\n\t\tif (result) {\n\t\t\tthis._activatedTaskProviders.add(type ?? 'all');\n\t\t}\n\t}\n\n\tprivate _updateSetup(setup?: [IWorkspaceFolder[], IWorkspaceFolder[], ExecutionEngine, JsonSchemaVersion, IWorkspace | undefined]): void {\n\t\tif (!setup) {\n\t\t\tsetup = this._computeWorkspaceFolderSetup();\n\t\t}\n\t\tthis._workspaceFolders = setup[0];\n\t\tif (this._ignoredWorkspaceFolders) {\n\t\t\tif (this._ignoredWorkspaceFolders.length !== setup[1].length) {\n\t\t\t\tthis._showIgnoreMessage = undefined;\n\t\t\t} else {\n\t\t\t\tconst set: Set<string> = new Set();\n\t\t\t\tthis._ignoredWorkspaceFolders.forEach(folder => set.add(folder.uri.toString()));\n\t\t\t\tfor (const folder of setup[1]) {\n\t\t\t\t\tif (!set.has(folder.uri.toString())) {\n\t\t\t\t\t\tthis._showIgnoreMessage = undefined;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._ignoredWorkspaceFolders = setup[1];\n\t\tthis._executionEngine = setup[2];\n\t\tthis._schemaVersion = setup[3];\n\t\tthis._workspace = setup[4];\n\t}\n\n\tprotected _showOutput(runSource: TaskRunSource = TaskRunSource.User, userRequested?: boolean, errorMessage?: string): void {\n\t\tif (!VirtualWorkspaceContext.getValue(this._contextKeyService) && ((runSource === TaskRunSource.User) || (runSource === TaskRunSource.ConfigurationChange))) {\n\t\t\tif (userRequested) {\n\t\t\t\tthis._outputService.showChannel(this._outputChannel.id, true);\n\t\t\t} else {\n\t\t\t\tconst chatEnabled = this._chatService.isEnabled(ChatAgentLocation.Chat);\n\t\t\t\tconst actions = [];\n\t\t\t\tif (chatEnabled && errorMessage) {\n\t\t\t\t\tconst beforeJSONregex = /^(.*?)\\s*\\{[\\s\\S]*$/;\n\t\t\t\t\tconst matches = errorMessage.match(beforeJSONregex);\n\t\t\t\t\tif (matches && matches.length > 1) {\n\t\t\t\t\t\tconst message = matches[1];\n\t\t\t\t\t\tconst customMessage = message === errorMessage\n\t\t\t\t\t\t\t? `\\`${message}\\``\n\t\t\t\t\t\t\t: `\\`${message}\\`\\n\\`\\`\\`json${errorMessage}\\`\\`\\``;\n\n\n\t\t\t\t\t\tconst defaultAgent = this._chatAgentService.getDefaultAgent(ChatAgentLocation.Chat);\n\t\t\t\t\t\tif (defaultAgent) {\n\t\t\t\t\t\t\tactions.push({\n\t\t\t\t\t\t\t\tlabel: nls.localize('troubleshootWithChat', \"Fix with AI\"),\n\t\t\t\t\t\t\t\trun: async () => {\n\t\t\t\t\t\t\t\t\tthis._commandService.executeCommand(CHAT_OPEN_ACTION_ID, {\n\t\t\t\t\t\t\t\t\t\tmode: ChatModeKind.Agent,\n\t\t\t\t\t\t\t\t\t\tquery: `Fix this task configuration error: ${customMessage}`\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tactions.push({\n\t\t\t\t\tlabel: nls.localize('showOutput', \"Show Output\"),\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tthis._outputService.showChannel(this._outputChannel.id, true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (chatEnabled && actions.length > 1) {\n\t\t\t\t\tthis._notificationService.prompt(Severity.Warning, nls.localize('taskServiceOutputPromptChat', 'There are task errors. Use chat to fix them or view the output for details.'), actions);\n\t\t\t\t} else {\n\t\t\t\t\tthis._notificationService.prompt(Severity.Warning, nls.localize('taskServiceOutputPrompt', 'There are task errors. See the output for details.'), actions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _disposeTaskSystemListeners(): void {\n\t\tif (this._taskSystemListeners) {\n\t\t\tdispose(this._taskSystemListeners);\n\t\t\tthis._taskSystemListeners = undefined;\n\t\t}\n\t}\n\n\tpublic registerTaskProvider(provider: ITaskProvider, type: string): IDisposable {\n\t\tif (!provider) {\n\t\t\treturn {\n\t\t\t\tdispose: () => { }\n\t\t\t};\n\t\t}\n\t\tconst handle = AbstractTaskService._nextHandle++;\n\t\tthis._providers.set(handle, provider);\n\t\tthis._providerTypes.set(handle, type);\n\t\tthis._onDidChangeTaskProviders.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis._providers.delete(handle);\n\t\t\t\tthis._providerTypes.delete(handle);\n\t\t\t\tthis._onDidChangeTaskProviders.fire();\n\t\t\t}\n\t\t};\n\t}\n\n\tget hasTaskSystemInfo(): boolean {\n\t\tconst infosCount = Array.from(this._taskSystemInfos.values()).flat().length;\n\t\t// If there's a remoteAuthority, then we end up with 2 taskSystemInfos,\n\t\t// one for each extension host.\n\t\tif (this._environmentService.remoteAuthority) {\n\t\t\treturn infosCount > 1;\n\t\t}\n\t\treturn infosCount > 0;\n\t}\n\n\tpublic registerTaskSystem(key: string, info: ITaskSystemInfo): void {\n\t\t// Ideally the Web caller of registerRegisterTaskSystem would use the correct key.\n\t\t// However, the caller doesn't know about the workspace folders at the time of the call, even though we know about them here.\n\t\tif (info.platform === Platform.Platform.Web) {\n\t\t\tkey = this.workspaceFolders.length ? this.workspaceFolders[0].uri.scheme : key;\n\t\t}\n\t\tif (!this._taskSystemInfos.has(key)) {\n\t\t\tthis._taskSystemInfos.set(key, [info]);\n\t\t} else {\n\t\t\tconst infos = this._taskSystemInfos.get(key)!;\n\t\t\tif (info.platform === Platform.Platform.Web) {\n\t\t\t\t// Web infos should be pushed last.\n\t\t\t\tinfos.push(info);\n\t\t\t} else {\n\t\t\t\tinfos.unshift(info);\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasTaskSystemInfo) {\n\t\t\tthis._onDidChangeTaskSystemInfo.fire();\n\t\t}\n\t}\n\n\tprivate _getTaskSystemInfo(key: string): ITaskSystemInfo | undefined {\n\t\tconst infos = this._taskSystemInfos.get(key);\n\t\treturn (infos && infos.length) ? infos[0] : undefined;\n\t}\n\n\tpublic extensionCallbackTaskComplete(task: Task, result: number): Promise<void> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this._taskSystem.customExecutionComplete(task, result);\n\t}\n\n\t/**\n\t * Get a subset of workspace tasks that match a certain predicate.\n\t */\n\tprivate async _findWorkspaceTasks(predicate: (task: ConfiguringTask | Task, workspaceFolder: IWorkspaceFolder) => boolean): Promise<(ConfiguringTask | Task)[]> {\n\t\tconst result: (ConfiguringTask | Task)[] = [];\n\n\t\tconst tasks = await this.getWorkspaceTasks();\n\t\tfor (const [, workspaceTasks] of tasks) {\n\t\t\tif (workspaceTasks.configurations) {\n\t\t\t\tfor (const taskName in workspaceTasks.configurations.byIdentifier) {\n\t\t\t\t\tconst task = workspaceTasks.configurations.byIdentifier[taskName];\n\t\t\t\t\tif (predicate(task, workspaceTasks.workspaceFolder)) {\n\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (workspaceTasks.set) {\n\t\t\t\tfor (const task of workspaceTasks.set.tasks) {\n\t\t\t\t\tif (predicate(task, workspaceTasks.workspaceFolder)) {\n\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate async _findWorkspaceTasksInGroup(group: TaskGroup, isDefault: boolean): Promise<(ConfiguringTask | Task)[]> {\n\t\treturn this._findWorkspaceTasks((task) => {\n\t\t\tconst taskGroup = task.configurationProperties.group;\n\t\t\tif (taskGroup && typeof taskGroup !== 'string') {\n\t\t\t\treturn (taskGroup._id === group._id && (!isDefault || !!taskGroup.isDefault));\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tpublic async getTask(folder: IWorkspace | IWorkspaceFolder | string, identifier: string | ITaskIdentifier, compareId: boolean = false, type: string | undefined = undefined): Promise<Task | undefined> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn;\n\t\t}\n\t\tconst name = Types.isString(folder) ? folder : isWorkspaceFolder(folder) ? folder.name : folder.configuration ? resources.basename(folder.configuration) : undefined;\n\t\tif (this.ignoredWorkspaceFolders.some(ignored => ignored.name === name)) {\n\t\t\treturn Promise.reject(new Error(nls.localize('TaskServer.folderIgnored', 'The folder {0} is ignored since it uses task version 0.1.0', name)));\n\t\t}\n\t\tconst key: string | KeyedTaskIdentifier | undefined = !Types.isString(identifier)\n\t\t\t? TaskDefinition.createTaskIdentifier(identifier, console)\n\t\t\t: identifier;\n\n\t\tif (key === undefined) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\t// Try to find the task in the workspace\n\t\tconst requestedFolder = TaskMap.getKey(folder);\n\t\tconst matchedTasks = await this._findWorkspaceTasks((task, workspaceFolder) => {\n\t\t\tconst taskFolder = TaskMap.getKey(workspaceFolder);\n\t\t\tif (taskFolder !== requestedFolder && taskFolder !== USER_TASKS_GROUP_KEY) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn task.matches(key, compareId);\n\t\t});\n\t\tmatchedTasks.sort(task => task._source.kind === TaskSourceKind.Extension ? 1 : -1);\n\t\tif (matchedTasks.length > 0) {\n\t\t\t// Nice, we found a configured task!\n\t\t\tconst task = matchedTasks[0];\n\t\t\tif (ConfiguringTask.is(task)) {\n\t\t\t\treturn this.tryResolveTask(task);\n\t\t\t} else {\n\t\t\t\treturn task;\n\t\t\t}\n\t\t}\n\n\t\t// We didn't find the task, so we need to ask all resolvers about it\n\t\tconst map = await this._getGroupedTasks({ type });\n\t\tlet values = map.get(folder);\n\t\tvalues = values.concat(map.get(USER_TASKS_GROUP_KEY));\n\n\t\tif (!values) {\n\t\t\treturn undefined;\n\t\t}\n\t\tvalues = values.filter(task => task.matches(key, compareId)).sort(task => task._source.kind === TaskSourceKind.Extension ? 1 : -1);\n\t\treturn values.length > 0 ? values[0] : undefined;\n\t}\n\n\tpublic async tryResolveTask(configuringTask: ConfiguringTask): Promise<Task | undefined> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn;\n\t\t}\n\t\tawait this._activateTaskProviders(configuringTask.type);\n\t\tlet matchingProvider: ITaskProvider | undefined;\n\t\tlet matchingProviderUnavailable: boolean = false;\n\t\tfor (const [handle, provider] of this._providers) {\n\t\t\tconst providerType = this._providerTypes.get(handle);\n\t\t\tif (configuringTask.type === providerType) {\n\t\t\t\tif (providerType && !this._isTaskProviderEnabled(providerType)) {\n\t\t\t\t\tmatchingProviderUnavailable = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tmatchingProvider = provider;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!matchingProvider) {\n\t\t\tif (matchingProviderUnavailable) {\n\t\t\t\tthis._log(nls.localize(\n\t\t\t\t\t'TaskService.providerUnavailable',\n\t\t\t\t\t'Warning: {0} tasks are unavailable in the current environment.',\n\t\t\t\t\tconfiguringTask.configures.type\n\t\t\t\t));\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Try to resolve the task first\n\t\ttry {\n\t\t\tconst resolvedTask = await matchingProvider.resolveTask(configuringTask);\n\t\t\tif (resolvedTask && (resolvedTask._id === configuringTask._id)) {\n\t\t\t\treturn TaskConfig.createCustomTask(resolvedTask, configuringTask);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// Ignore errors. The task could not be provided by any of the providers.\n\t\t}\n\n\t\t// The task couldn't be resolved. Instead, use the less efficient provideTask.\n\t\tconst tasks = await this.tasks({ type: configuringTask.type });\n\t\tfor (const task of tasks) {\n\t\t\tif (task._id === configuringTask._id) {\n\t\t\t\treturn TaskConfig.createCustomTask(<ContributedTask>task, configuringTask);\n\t\t\t}\n\t\t}\n\n\t\treturn;\n\t}\n\n\tprotected abstract _versionAndEngineCompatible(filter?: ITaskFilter): boolean;\n\n\tpublic async tasks(filter?: ITaskFilter): Promise<Task[]> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this._versionAndEngineCompatible(filter)) {\n\t\t\treturn Promise.resolve<Task[]>([]);\n\t\t}\n\t\treturn this._getGroupedTasks(filter).then((map) => this.applyFilterToTaskMap(filter, map));\n\t}\n\n\tpublic async getKnownTasks(filter?: ITaskFilter): Promise<Task[]> {\n\t\tif (!this._versionAndEngineCompatible(filter)) {\n\t\t\treturn Promise.resolve<Task[]>([]);\n\t\t}\n\n\t\treturn this._getGroupedTasks(filter, true, true).then((map) => this.applyFilterToTaskMap(filter, map));\n\t}\n\n\tpublic taskTypes(): string[] {\n\t\tconst types: string[] = [];\n\t\tif (this._isProvideTasksEnabled()) {\n\t\t\tfor (const definition of TaskDefinitionRegistry.all()) {\n\t\t\t\tif (this._isTaskProviderEnabled(definition.taskType)) {\n\t\t\t\t\ttypes.push(definition.taskType);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn types;\n\t}\n\n\tpublic createSorter(): TaskSorter {\n\t\treturn new TaskSorter(this._contextService.getWorkspace() ? this._contextService.getWorkspace().folders : []);\n\t}\n\n\tprivate _isActive(): Promise<boolean> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\t\treturn this._taskSystem.isActive();\n\t}\n\n\tpublic async getActiveTasks(): Promise<Task[]> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._taskSystem.getActiveTasks();\n\t}\n\n\tpublic async getBusyTasks(): Promise<Task[]> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._taskSystem.getBusyTasks();\n\t}\n\n\tpublic getRecentlyUsedTasksV1(): LRUCache<string, string> {\n\t\tif (this._recentlyUsedTasksV1) {\n\t\t\treturn this._recentlyUsedTasksV1;\n\t\t}\n\t\tconst quickOpenHistoryLimit = this._configurationService.getValue<number>(QUICKOPEN_HISTORY_LIMIT_CONFIG);\n\t\tthis._recentlyUsedTasksV1 = new LRUCache<string, string>(quickOpenHistoryLimit);\n\n\t\tconst storageValue = this._storageService.get(AbstractTaskService.RecentlyUsedTasks_Key, StorageScope.WORKSPACE);\n\t\tif (storageValue) {\n\t\t\ttry {\n\t\t\t\tconst values: string[] = JSON.parse(storageValue);\n\t\t\t\tif (Array.isArray(values)) {\n\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\tthis._recentlyUsedTasksV1.set(value, value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Ignore. We use the empty result\n\t\t\t}\n\t\t}\n\t\treturn this._recentlyUsedTasksV1;\n\t}\n\n\tprivate applyFilterToTaskMap(filter: ITaskFilter | undefined, map: TaskMap): Task[] {\n\t\tif (!filter || !filter.type) {\n\t\t\treturn map.all();\n\t\t}\n\t\tconst result: Task[] = [];\n\t\tmap.forEach((tasks) => {\n\t\t\tfor (const task of tasks) {\n\t\t\t\tif (ContributedTask.is(task) && ((task.defines.type === filter.type) || (task._source.label === filter.type))) {\n\t\t\t\t\tresult.push(task);\n\t\t\t\t} else if (CustomTask.is(task)) {\n\t\t\t\t\tif (task.type === filter.type) {\n\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst customizes = task.customizes();\n\t\t\t\t\t\tif (customizes && customizes.type === filter.type) {\n\t\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tprivate _getTasksFromStorage(type: 'persistent' | 'historical'): LRUCache<string, string> {\n\t\treturn type === 'persistent' ? this._getPersistentTasks() : this._getRecentTasks();\n\t}\n\n\tprivate _getRecentTasks(): LRUCache<string, string> {\n\t\tif (this._recentlyUsedTasks) {\n\t\t\treturn this._recentlyUsedTasks;\n\t\t}\n\t\tconst quickOpenHistoryLimit = this._configurationService.getValue<number>(QUICKOPEN_HISTORY_LIMIT_CONFIG);\n\t\tthis._recentlyUsedTasks = new LRUCache<string, string>(quickOpenHistoryLimit);\n\n\t\tconst storageValue = this._storageService.get(AbstractTaskService.RecentlyUsedTasks_KeyV2, StorageScope.WORKSPACE);\n\t\tif (storageValue) {\n\t\t\ttry {\n\t\t\t\tconst values: [string, string][] = JSON.parse(storageValue);\n\t\t\t\tif (Array.isArray(values)) {\n\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\tthis._recentlyUsedTasks.set(value[0], value[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Ignore. We use the empty result\n\t\t\t}\n\t\t}\n\t\treturn this._recentlyUsedTasks;\n\t}\n\n\tprivate _getPersistentTasks(): LRUCache<string, string> {\n\t\tif (this._persistentTasks) {\n\t\t\tthis._log(nls.localize('taskService.gettingCachedTasks', 'Returning cached tasks {0}', this._persistentTasks.size), true);\n\t\t\treturn this._persistentTasks;\n\t\t}\n\t\t//TODO: should this # be configurable?\n\t\tthis._persistentTasks = new LRUCache<string, string>(10);\n\t\tconst storageValue = this._storageService.get(AbstractTaskService.PersistentTasks_Key, StorageScope.WORKSPACE);\n\t\tif (storageValue) {\n\t\t\ttry {\n\t\t\t\tconst values: [string, string][] = JSON.parse(storageValue);\n\t\t\t\tif (Array.isArray(values)) {\n\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\tthis._persistentTasks.set(value[0], value[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\t// Ignore. We use the empty result\n\t\t\t}\n\t\t}\n\t\treturn this._persistentTasks;\n\t}\n\n\tprivate _getFolderFromTaskKey(key: string): { folder: string | undefined; isWorkspaceFile: boolean | undefined } {\n\t\tconst keyValue: { folder: string | undefined; id: string | undefined } = JSON.parse(key);\n\t\treturn {\n\t\t\tfolder: keyValue.folder, isWorkspaceFile: keyValue.id?.endsWith(TaskSourceKind.WorkspaceFile)\n\t\t};\n\t}\n\n\tpublic async getSavedTasks(type: 'persistent' | 'historical'): Promise<(Task | ConfiguringTask)[]> {\n\t\tconst folderMap: IStringDictionary<IWorkspaceFolder> = Object.create(null);\n\t\tthis.workspaceFolders.forEach(folder => {\n\t\t\tfolderMap[folder.uri.toString()] = folder;\n\t\t});\n\t\tconst folderToTasksMap: Map<string, any> = new Map();\n\t\tconst workspaceToTaskMap: Map<string, any> = new Map();\n\t\tconst storedTasks = this._getTasksFromStorage(type);\n\t\tconst tasks: (Task | ConfiguringTask)[] = [];\n\t\tthis._log(nls.localize('taskService.getSavedTasks', 'Fetching tasks from task storage.'), true);\n\t\tfunction addTaskToMap(map: Map<string, any>, folder: string | undefined, task: any) {\n\t\t\tif (folder && !map.has(folder)) {\n\t\t\t\tmap.set(folder, []);\n\t\t\t}\n\t\t\tif (folder && (folderMap[folder] || (folder === USER_TASKS_GROUP_KEY)) && task) {\n\t\t\t\tmap.get(folder).push(task);\n\t\t\t}\n\t\t}\n\t\tfor (const entry of storedTasks.entries()) {\n\t\t\ttry {\n\t\t\t\tconst key = entry[0];\n\t\t\t\tconst task = JSON.parse(entry[1]);\n\t\t\t\tconst folderInfo = this._getFolderFromTaskKey(key);\n\t\t\t\tthis._log(nls.localize('taskService.getSavedTasks.reading', 'Reading tasks from task storage, {0}, {1}, {2}', key, task, folderInfo.folder), true);\n\t\t\t\taddTaskToMap(folderInfo.isWorkspaceFile ? workspaceToTaskMap : folderToTasksMap, folderInfo.folder, task);\n\t\t\t} catch (error) {\n\t\t\t\tthis._log(nls.localize('taskService.getSavedTasks.error', 'Fetching a task from task storage failed: {0}.', error), true);\n\t\t\t}\n\t\t}\n\n\t\tconst readTasksMap: Map<string, (Task | ConfiguringTask)> = new Map();\n\n\t\tasync function readTasks(that: AbstractTaskService, map: Map<string, any>, isWorkspaceFile: boolean) {\n\t\t\tfor (const key of map.keys()) {\n\t\t\t\tconst custom: CustomTask[] = [];\n\t\t\t\tconst customized: IStringDictionary<ConfiguringTask> = Object.create(null);\n\t\t\t\tconst taskConfigSource = (folderMap[key]\n\t\t\t\t\t? (isWorkspaceFile\n\t\t\t\t\t\t? TaskConfig.TaskConfigSource.WorkspaceFile : TaskConfig.TaskConfigSource.TasksJson)\n\t\t\t\t\t: TaskConfig.TaskConfigSource.User);\n\t\t\t\tawait that._computeTasksForSingleConfig(folderMap[key] ?? await that._getAFolder(), {\n\t\t\t\t\tversion: '2.0.0',\n\t\t\t\t\ttasks: map.get(key)\n\t\t\t\t}, TaskRunSource.System, custom, customized, taskConfigSource, true);\n\t\t\t\tcustom.forEach(task => {\n\t\t\t\t\tconst taskKey = task.getKey();\n\t\t\t\t\tif (taskKey) {\n\t\t\t\t\t\treadTasksMap.set(taskKey, task);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfor (const configuration in customized) {\n\t\t\t\t\tconst taskKey = customized[configuration].getKey();\n\t\t\t\t\tif (taskKey) {\n\t\t\t\t\t\treadTasksMap.set(taskKey, customized[configuration]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tawait readTasks(this, folderToTasksMap, false);\n\t\tawait readTasks(this, workspaceToTaskMap, true);\n\t\tfor (const key of storedTasks.keys()) {\n\t\t\tif (readTasksMap.has(key)) {\n\t\t\t\ttasks.push(readTasksMap.get(key)!);\n\t\t\t\tthis._log(nls.localize('taskService.getSavedTasks.resolved', 'Resolved task {0}', key), true);\n\t\t\t} else {\n\t\t\t\tthis._log(nls.localize('taskService.getSavedTasks.unresolved', 'Unable to resolve task {0} ', key), true);\n\t\t\t}\n\t\t}\n\t\treturn tasks;\n\t}\n\n\tpublic removeRecentlyUsedTask(taskRecentlyUsedKey: string) {\n\t\tif (this._getTasksFromStorage('historical').has(taskRecentlyUsedKey)) {\n\t\t\tthis._getTasksFromStorage('historical').delete(taskRecentlyUsedKey);\n\t\t\tthis._saveRecentlyUsedTasks();\n\t\t}\n\t}\n\n\tpublic removePersistentTask(key: string) {\n\t\tthis._log(nls.localize('taskService.removePersistentTask', 'Removing persistent task {0}', key), true);\n\t\tif (this._getTasksFromStorage('persistent').has(key)) {\n\t\t\tthis._getTasksFromStorage('persistent').delete(key);\n\t\t\tthis._savePersistentTasks();\n\t\t}\n\t}\n\n\tprivate _setTaskLRUCacheLimit() {\n\t\tconst quickOpenHistoryLimit = this._configurationService.getValue<number>(QUICKOPEN_HISTORY_LIMIT_CONFIG);\n\t\tif (this._recentlyUsedTasks) {\n\t\t\tthis._recentlyUsedTasks.limit = quickOpenHistoryLimit;\n\t\t}\n\t}\n\n\tprivate async _setRecentlyUsedTask(task: Task): Promise<void> {\n\t\tlet key = task.getKey();\n\t\tif (!InMemoryTask.is(task) && key) {\n\t\t\tconst customizations = this._createCustomizableTask(task);\n\t\t\tif (ContributedTask.is(task) && customizations) {\n\t\t\t\tconst custom: CustomTask[] = [];\n\t\t\t\tconst customized: IStringDictionary<ConfiguringTask> = Object.create(null);\n\t\t\t\tawait this._computeTasksForSingleConfig(task._source.workspaceFolder ?? this.workspaceFolders[0], {\n\t\t\t\t\tversion: '2.0.0',\n\t\t\t\t\ttasks: [customizations]\n\t\t\t\t}, TaskRunSource.System, custom, customized, TaskConfig.TaskConfigSource.TasksJson, true);\n\t\t\t\tfor (const configuration in customized) {\n\t\t\t\t\tkey = customized[configuration].getKey()!;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._getTasksFromStorage('historical').set(key, JSON.stringify(customizations));\n\t\t\tthis._saveRecentlyUsedTasks();\n\t\t}\n\t}\n\n\tprivate _saveRecentlyUsedTasks(): void {\n\t\tif (!this._recentlyUsedTasks) {\n\t\t\treturn;\n\t\t}\n\t\tconst quickOpenHistoryLimit = this._configurationService.getValue<number>(QUICKOPEN_HISTORY_LIMIT_CONFIG);\n\t\t// setting history limit to 0 means no LRU sorting\n\t\tif (quickOpenHistoryLimit === 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet keys = [...this._recentlyUsedTasks.keys()];\n\t\tif (keys.length > quickOpenHistoryLimit) {\n\t\t\tkeys = keys.slice(0, quickOpenHistoryLimit);\n\t\t}\n\t\tconst keyValues: [string, string][] = [];\n\t\tfor (const key of keys) {\n\t\t\tkeyValues.push([key, this._recentlyUsedTasks.get(key, Touch.None)!]);\n\t\t}\n\t\tthis._storageService.store(AbstractTaskService.RecentlyUsedTasks_KeyV2, JSON.stringify(keyValues), StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t}\n\n\tprivate async _setPersistentTask(task: Task): Promise<void> {\n\t\tif (!this._configurationService.getValue(TaskSettingId.Reconnection)) {\n\t\t\treturn;\n\t\t}\n\t\tlet key = task.getKey();\n\t\tif (!InMemoryTask.is(task) && key) {\n\t\t\tconst customizations = this._createCustomizableTask(task);\n\t\t\tif (ContributedTask.is(task) && customizations) {\n\t\t\t\tconst custom: CustomTask[] = [];\n\t\t\t\tconst customized: IStringDictionary<ConfiguringTask> = Object.create(null);\n\t\t\t\tawait this._computeTasksForSingleConfig(task._source.workspaceFolder ?? this.workspaceFolders[0], {\n\t\t\t\t\tversion: '2.0.0',\n\t\t\t\t\ttasks: [customizations]\n\t\t\t\t}, TaskRunSource.System, custom, customized, TaskConfig.TaskConfigSource.TasksJson, true);\n\t\t\t\tfor (const configuration in customized) {\n\t\t\t\t\tkey = customized[configuration].getKey()!;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!task.configurationProperties.isBackground) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._log(nls.localize('taskService.setPersistentTask', 'Setting persistent task {0}', key), true);\n\t\t\tthis._getTasksFromStorage('persistent').set(key, JSON.stringify(customizations));\n\t\t\tthis._savePersistentTasks();\n\t\t}\n\t}\n\n\tprivate _savePersistentTasks(): void {\n\t\tthis._persistentTasks = this._getTasksFromStorage('persistent');\n\t\tconst keys = [...this._persistentTasks.keys()];\n\t\tconst keyValues: [string, string][] = [];\n\t\tfor (const key of keys) {\n\t\t\tkeyValues.push([key, this._persistentTasks.get(key, Touch.None)!]);\n\t\t}\n\t\tthis._log(nls.localize('savePersistentTask', 'Saving persistent tasks: {0}', keys.join(', ')), true);\n\t\tthis._storageService.store(AbstractTaskService.PersistentTasks_Key, JSON.stringify(keyValues), StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t}\n\n\tprivate _openDocumentation(): void {\n\t\tthis._openerService.open(URI.parse('https://code.visualstudio.com/docs/editor/tasks#_defining-a-problem-matcher'));\n\t}\n\n\tprivate async _findSingleWorkspaceTaskOfGroup(group: TaskGroup): Promise<ITaskSummary | undefined> {\n\t\tconst tasksOfGroup = await this._findWorkspaceTasksInGroup(group, true);\n\t\tif ((tasksOfGroup.length === 1) && (typeof tasksOfGroup[0].configurationProperties.group !== 'string') && tasksOfGroup[0].configurationProperties.group?.isDefault) {\n\t\t\tlet resolvedTask: Task | undefined;\n\t\t\tif (ConfiguringTask.is(tasksOfGroup[0])) {\n\t\t\t\tresolvedTask = await this.tryResolveTask(tasksOfGroup[0]);\n\t\t\t} else {\n\t\t\t\tresolvedTask = tasksOfGroup[0];\n\t\t\t}\n\t\t\tif (resolvedTask) {\n\t\t\t\treturn this.run(resolvedTask, undefined, TaskRunSource.User);\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async _build(): Promise<ITaskSummary> {\n\t\tconst tryBuildShortcut = await this._findSingleWorkspaceTaskOfGroup(TaskGroup.Build);\n\t\tif (tryBuildShortcut) {\n\t\t\treturn tryBuildShortcut;\n\t\t}\n\t\treturn this._getGroupedTasksAndExecute();\n\t}\n\n\tprivate async _runTest(): Promise<ITaskSummary> {\n\t\tconst tryTestShortcut = await this._findSingleWorkspaceTaskOfGroup(TaskGroup.Test);\n\t\tif (tryTestShortcut) {\n\t\t\treturn tryTestShortcut;\n\t\t}\n\n\t\treturn this._getGroupedTasksAndExecute(true);\n\t}\n\n\tprivate async _getGroupedTasksAndExecute(test?: boolean): Promise<ITaskSummary> {\n\t\tconst tasks = await this._getGroupedTasks();\n\t\tconst runnable = this._createRunnableTask(tasks, test ? TaskGroup.Test : TaskGroup.Build);\n\t\tif (!runnable || !runnable.task) {\n\t\t\tif (test) {\n\t\t\t\tif (this.schemaVersion === JsonSchemaVersion.V0_1_0) {\n\t\t\t\t\tthrow new TaskError(Severity.Info, nls.localize('TaskService.noTestTask1', 'No test task defined. Mark a task with \\'isTestCommand\\' in the tasks.json file.'), TaskErrors.NoTestTask);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new TaskError(Severity.Info, nls.localize('TaskService.noTestTask2', 'No test task defined. Mark a task with as a \\'test\\' group in the tasks.json file.'), TaskErrors.NoTestTask);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.schemaVersion === JsonSchemaVersion.V0_1_0) {\n\t\t\t\t\tthrow new TaskError(Severity.Info, nls.localize('TaskService.noBuildTask1', 'No build task defined. Mark a task with \\'isBuildCommand\\' in the tasks.json file.'), TaskErrors.NoBuildTask);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new TaskError(Severity.Info, nls.localize('TaskService.noBuildTask2', 'No build task defined. Mark a task with as a \\'build\\' group in the tasks.json file.'), TaskErrors.NoBuildTask);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet executeTaskResult: ITaskSummary;\n\t\ttry {\n\t\t\texecuteTaskResult = await this._executeTask(runnable.task, runnable.resolver, TaskRunSource.User);\n\t\t} catch (error) {\n\t\t\tthis._handleError(error);\n\t\t\treturn Promise.reject(error);\n\t\t}\n\t\treturn executeTaskResult;\n\t}\n\n\tpublic async run(task: Task | undefined, options?: IProblemMatcherRunOptions, runSource: TaskRunSource = TaskRunSource.System): Promise<ITaskSummary | undefined> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn;\n\t\t}\n\t\tif (!task) {\n\t\t\tthrow new TaskError(Severity.Info, nls.localize('TaskServer.noTask', 'Task to execute is undefined'), TaskErrors.TaskNotFound);\n\t\t}\n\t\tconst resolver = this._createResolver();\n\t\tlet executeTaskResult: ITaskSummary | undefined;\n\t\ttry {\n\t\t\tif (options && options.attachProblemMatcher && this._shouldAttachProblemMatcher(task) && !InMemoryTask.is(task)) {\n\t\t\t\tconst taskToExecute = await this._attachProblemMatcher(task);\n\t\t\t\tif (taskToExecute) {\n\t\t\t\t\texecuteTaskResult = await this._executeTask(taskToExecute, resolver, runSource);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\texecuteTaskResult = await this._executeTask(task, resolver, runSource);\n\t\t\t}\n\t\t\treturn executeTaskResult;\n\t\t} catch (error) {\n\t\t\tthis._handleError(error);\n\t\t\treturn Promise.reject(error);\n\t\t}\n\t}\n\n\tprivate _isProvideTasksEnabled(): boolean {\n\t\tconst settingValue = this._configurationService.getValue(TaskSettingId.AutoDetect);\n\t\treturn settingValue === 'on';\n\t}\n\n\tprivate _isProblemMatcherPromptEnabled(type?: string): boolean {\n\t\tconst settingValue = this._configurationService.getValue(PROBLEM_MATCHER_NEVER_CONFIG);\n\t\tif (Types.isBoolean(settingValue)) {\n\t\t\treturn !settingValue;\n\t\t}\n\t\tif (type === undefined) {\n\t\t\treturn true;\n\t\t}\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tconst settingValueMap: IStringDictionary<boolean> = settingValue as any;\n\t\treturn !settingValueMap[type];\n\t}\n\n\tprivate _getTypeForTask(task: Task): string {\n\t\tlet type: string;\n\t\tif (CustomTask.is(task)) {\n\t\t\tconst configProperties: TaskConfig.IConfigurationProperties = task._source.config.element;\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\ttype = (<any>configProperties).type;\n\t\t} else {\n\t\t\ttype = task.getDefinition()!.type;\n\t\t}\n\t\treturn type;\n\t}\n\n\tprivate _shouldAttachProblemMatcher(task: Task): boolean {\n\t\tconst enabled = this._isProblemMatcherPromptEnabled(this._getTypeForTask(task));\n\t\tif (enabled === false) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this._canCustomize(task)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (task.configurationProperties.group !== undefined && task.configurationProperties.group !== TaskGroup.Build) {\n\t\t\treturn false;\n\t\t}\n\t\tif (task.configurationProperties.problemMatchers !== undefined && task.configurationProperties.problemMatchers.length > 0) {\n\t\t\treturn false;\n\t\t}\n\t\tif (ContributedTask.is(task)) {\n\t\t\treturn !task.hasDefinedMatchers && !!task.configurationProperties.problemMatchers && (task.configurationProperties.problemMatchers.length === 0);\n\t\t}\n\t\tif (CustomTask.is(task)) {\n\t\t\tconst configProperties: TaskConfig.IConfigurationProperties = task._source.config.element;\n\t\t\treturn configProperties.problemMatcher === undefined && !task.hasDefinedMatchers;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate async _updateNeverProblemMatcherSetting(type: string): Promise<void> {\n\t\tconst current = this._configurationService.getValue(PROBLEM_MATCHER_NEVER_CONFIG);\n\t\tif (current === true) {\n\t\t\treturn;\n\t\t}\n\t\tlet newValue: IStringDictionary<boolean>;\n\t\tif (current !== false) {\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\tnewValue = <any>current;\n\t\t} else {\n\t\t\tnewValue = Object.create(null);\n\t\t}\n\t\tnewValue[type] = true;\n\t\treturn this._configurationService.updateValue(PROBLEM_MATCHER_NEVER_CONFIG, newValue);\n\t}\n\n\tprivate async _attachProblemMatcher(task: ContributedTask | CustomTask): Promise<Task | undefined> {\n\t\tinterface IProblemMatcherPickEntry extends IQuickPickItem {\n\t\t\tmatcher: INamedProblemMatcher | undefined;\n\t\t\tnever?: boolean;\n\t\t\tlearnMore?: boolean;\n\t\t\tsetting?: string;\n\t\t}\n\t\tlet entries: QuickPickInput<IProblemMatcherPickEntry>[] = [];\n\t\tfor (const key of ProblemMatcherRegistry.keys()) {\n\t\t\tconst matcher = ProblemMatcherRegistry.get(key);\n\t\t\tif (matcher.deprecated) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (matcher.name === matcher.label) {\n\t\t\t\tentries.push({ label: matcher.name, matcher: matcher });\n\t\t\t} else {\n\t\t\t\tentries.push({\n\t\t\t\t\tlabel: matcher.label,\n\t\t\t\t\tdescription: `$${matcher.name}`,\n\t\t\t\t\tmatcher: matcher\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (entries.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tentries = entries.sort((a, b) => {\n\t\t\tif (a.label && b.label) {\n\t\t\t\treturn a.label.localeCompare(b.label);\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tentries.unshift({ type: 'separator', label: nls.localize('TaskService.associate', 'associate') });\n\t\tlet taskType: string;\n\t\tif (CustomTask.is(task)) {\n\t\t\tconst configProperties: TaskConfig.IConfigurationProperties = task._source.config.element;\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\ttaskType = (<any>configProperties).type;\n\t\t} else {\n\t\t\ttaskType = task.getDefinition().type;\n\t\t}\n\t\tentries.unshift(\n\t\t\t{ label: nls.localize('TaskService.attachProblemMatcher.continueWithout', 'Continue without scanning the task output'), matcher: undefined },\n\t\t\t{ label: nls.localize('TaskService.attachProblemMatcher.never', 'Never scan the task output for this task'), matcher: undefined, never: true },\n\t\t\t{ label: nls.localize('TaskService.attachProblemMatcher.neverType', 'Never scan the task output for {0} tasks', taskType), matcher: undefined, setting: taskType },\n\t\t\t{ label: nls.localize('TaskService.attachProblemMatcher.learnMoreAbout', 'Learn more about scanning the task output'), matcher: undefined, learnMore: true }\n\t\t);\n\t\tconst problemMatcher = await this._quickInputService.pick(entries, { placeHolder: nls.localize('selectProblemMatcher', 'Select for which kind of errors and warnings to scan the task output') });\n\t\tif (!problemMatcher) {\n\t\t\treturn task;\n\t\t}\n\t\tif (problemMatcher.learnMore) {\n\t\t\tthis._openDocumentation();\n\t\t\treturn undefined;\n\t\t}\n\t\tif (problemMatcher.never) {\n\t\t\tthis.customize(task, { problemMatcher: [] }, true);\n\t\t\treturn task;\n\t\t}\n\t\tif (problemMatcher.matcher) {\n\t\t\tconst newTask = task.clone();\n\t\t\tconst matcherReference = `$${problemMatcher.matcher.name}`;\n\t\t\tconst properties: ICustomizationProperties = { problemMatcher: [matcherReference] };\n\t\t\tnewTask.configurationProperties.problemMatchers = [matcherReference];\n\t\t\tconst matcher = ProblemMatcherRegistry.get(problemMatcher.matcher.name);\n\t\t\tif (matcher && matcher.watching !== undefined) {\n\t\t\t\tproperties.isBackground = true;\n\t\t\t\tnewTask.configurationProperties.isBackground = true;\n\t\t\t}\n\t\t\tthis.customize(task, properties, true);\n\t\t\treturn newTask;\n\t\t}\n\t\tif (problemMatcher.setting) {\n\t\t\tawait this._updateNeverProblemMatcherSetting(problemMatcher.setting);\n\t\t}\n\t\treturn task;\n\t}\n\n\tprivate async _getTasksForGroup(group: TaskGroup, waitToActivate?: boolean): Promise<Task[]> {\n\t\tconst groups = await this._getGroupedTasks(undefined, waitToActivate);\n\t\tconst result: Task[] = [];\n\t\tgroups.forEach(tasks => {\n\t\t\tfor (const task of tasks) {\n\t\t\t\tconst configTaskGroup = TaskGroup.from(task.configurationProperties.group);\n\t\t\t\tif (configTaskGroup?._id === group._id) {\n\t\t\t\t\tresult.push(task);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tpublic needsFolderQualification(): boolean {\n\t\treturn this._contextService.getWorkbenchState() === WorkbenchState.WORKSPACE;\n\t}\n\n\tprivate _canCustomize(task: Task): boolean {\n\t\tif (this.schemaVersion !== JsonSchemaVersion.V2_0_0) {\n\t\t\treturn false;\n\t\t}\n\t\tif (CustomTask.is(task)) {\n\t\t\treturn true;\n\t\t}\n\t\tif (ContributedTask.is(task)) {\n\t\t\treturn !!task.getWorkspaceFolder();\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate async _formatTaskForJson(resource: URI, task: TaskConfig.ICustomTask | TaskConfig.IConfiguringTask): Promise<string> {\n\t\tlet reference: IReference<IResolvedTextEditorModel> | undefined;\n\t\tlet stringValue: string = '';\n\t\ttry {\n\t\t\treference = await this._textModelResolverService.createModelReference(resource);\n\t\t\tconst model = reference.object.textEditorModel;\n\t\t\tconst { tabSize, insertSpaces } = model.getOptions();\n\t\t\tconst eol = model.getEOL();\n\t\t\tlet stringified = toFormattedString(task, { eol, tabSize, insertSpaces });\n\t\t\tconst regex = new RegExp(eol + (insertSpaces ? ' '.repeat(tabSize) : '\\\\t'), 'g');\n\t\t\tstringified = stringified.replace(regex, eol + (insertSpaces ? ' '.repeat(tabSize * 3) : '\\t\\t\\t'));\n\t\t\tconst twoTabs = insertSpaces ? ' '.repeat(tabSize * 2) : '\\t\\t';\n\t\t\tstringValue = twoTabs + stringified.slice(0, stringified.length - 1) + twoTabs + stringified.slice(stringified.length - 1);\n\t\t} finally {\n\t\t\treference?.dispose();\n\t\t}\n\t\treturn stringValue;\n\t}\n\n\tprivate async _openEditorAtTask(resource: URI | undefined, task: TaskConfig.ICustomTask | TaskConfig.IConfiguringTask | string | undefined, configIndex: number = -1): Promise<boolean> {\n\t\tif (resource === undefined) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\t\tconst fileContent = await this._fileService.readFile(resource);\n\t\tconst content = fileContent.value;\n\t\tif (!content || !task) {\n\t\t\treturn false;\n\t\t}\n\t\tconst contentValue = content.toString();\n\t\tlet stringValue: string | undefined;\n\t\tif (configIndex !== -1) {\n\t\t\tconst json: TaskConfig.IExternalTaskRunnerConfiguration = this._configurationService.getValue<TaskConfig.IExternalTaskRunnerConfiguration>('tasks', { resource });\n\t\t\tif (json.tasks && (json.tasks.length > configIndex)) {\n\t\t\t\tstringValue = await this._formatTaskForJson(resource, json.tasks[configIndex]);\n\t\t\t}\n\t\t}\n\t\tif (!stringValue) {\n\t\t\tif (typeof task === 'string') {\n\t\t\t\tstringValue = task;\n\t\t\t} else {\n\t\t\t\tstringValue = await this._formatTaskForJson(resource, task);\n\t\t\t}\n\t\t}\n\n\t\tconst index = contentValue.indexOf(stringValue);\n\t\tlet startLineNumber = 1;\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tif (contentValue.charAt(i) === '\\n') {\n\t\t\t\tstartLineNumber++;\n\t\t\t}\n\t\t}\n\t\tlet endLineNumber = startLineNumber;\n\t\tfor (let i = 0; i < stringValue.length; i++) {\n\t\t\tif (stringValue.charAt(i) === '\\n') {\n\t\t\t\tendLineNumber++;\n\t\t\t}\n\t\t}\n\t\tconst selection = startLineNumber > 1 ? { startLineNumber, startColumn: startLineNumber === endLineNumber ? 4 : 3, endLineNumber, endColumn: startLineNumber === endLineNumber ? undefined : 4 } : undefined;\n\n\t\tawait this._editorService.openEditor({\n\t\t\tresource,\n\t\t\toptions: {\n\t\t\t\tpinned: false,\n\t\t\t\tforceReload: true, // because content might have changed\n\t\t\t\tselection,\n\t\t\t\tselectionRevealType: TextEditorSelectionRevealType.CenterIfOutsideViewport\n\t\t\t}\n\t\t});\n\t\treturn !!selection;\n\t}\n\n\tprivate _createCustomizableTask(task: ContributedTask | CustomTask | ConfiguringTask): TaskConfig.ICustomTask | TaskConfig.IConfiguringTask | undefined {\n\t\tlet toCustomize: TaskConfig.ICustomTask | TaskConfig.IConfiguringTask | undefined;\n\t\tconst taskConfig = CustomTask.is(task) || ConfiguringTask.is(task) ? task._source.config : undefined;\n\t\tif (taskConfig && taskConfig.element) {\n\t\t\ttoCustomize = { ...(taskConfig.element) };\n\t\t} else if (ContributedTask.is(task)) {\n\t\t\ttoCustomize = {\n\t\t\t};\n\t\t\tconst identifier: TaskConfig.ITaskIdentifier = Object.assign(Object.create(null), task.defines);\n\t\t\tdelete identifier['_key'];\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\tObject.keys(identifier).forEach(key => (<any>toCustomize)![key] = identifier[key]);\n\t\t\tif (task.configurationProperties.problemMatchers && task.configurationProperties.problemMatchers.length > 0 && Types.isStringArray(task.configurationProperties.problemMatchers)) {\n\t\t\t\ttoCustomize.problemMatcher = task.configurationProperties.problemMatchers;\n\t\t\t}\n\t\t\tif (task.configurationProperties.group) {\n\t\t\t\ttoCustomize.group = TaskConfig.GroupKind.to(task.configurationProperties.group);\n\t\t\t}\n\t\t}\n\t\tif (!toCustomize) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (toCustomize.problemMatcher === undefined && task.configurationProperties.problemMatchers === undefined || (task.configurationProperties.problemMatchers && task.configurationProperties.problemMatchers.length === 0)) {\n\t\t\ttoCustomize.problemMatcher = [];\n\t\t}\n\t\tif (task._source.label !== 'Workspace') {\n\t\t\ttoCustomize.label = task.configurationProperties.identifier;\n\t\t} else {\n\t\t\ttoCustomize.label = task._label;\n\t\t}\n\t\ttoCustomize.detail = task.configurationProperties.detail;\n\t\treturn toCustomize;\n\t}\n\n\tpublic async customize(task: ContributedTask | CustomTask | ConfiguringTask, properties?: ICustomizationProperties, openConfig?: boolean): Promise<void> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst workspaceFolder = task.getWorkspaceFolder();\n\t\tif (!workspaceFolder) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\tconst configuration = this._getConfiguration(workspaceFolder, task._source.kind);\n\t\tif (configuration.hasParseErrors) {\n\t\t\tthis._notificationService.warn(nls.localize('customizeParseErrors', 'The current task configuration has errors. Please fix the errors first before customizing a task.'));\n\t\t\treturn Promise.resolve<void>(undefined);\n\t\t}\n\n\t\tconst fileConfig = configuration.config;\n\t\tconst toCustomize = this._createCustomizableTask(task);\n\t\tif (!toCustomize) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\tconst index: number | undefined = CustomTask.is(task) ? task._source.config.index : undefined;\n\t\tif (properties) {\n\t\t\tfor (const property of Object.getOwnPropertyNames(properties)) {\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tconst value = (<any>properties)[property];\n\t\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t(<any>toCustomize)[property] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!fileConfig) {\n\t\t\tconst value = {\n\t\t\t\tversion: '2.0.0',\n\t\t\t\ttasks: [toCustomize]\n\t\t\t};\n\t\t\tlet content = [\n\t\t\t\t'{',\n\t\t\t\tnls.localize('tasksJsonComment', '\\t// See https://go.microsoft.com/fwlink/?LinkId=733558 \\n\\t// for the documentation about the tasks.json format'),\n\t\t\t].join('\\n') + JSON.stringify(value, null, '\\t').substr(1);\n\t\t\tconst editorConfig = this._configurationService.getValue<any>();\n\t\t\tif (editorConfig.editor.insertSpaces) {\n\t\t\t\tcontent = content.replace(/(\\n)(\\t+)/g, (_, s1, s2) => s1 + ' '.repeat(s2.length * editorConfig.editor.tabSize));\n\t\t\t}\n\t\t\tawait this._textFileService.create([{ resource: workspaceFolder.toResource('.vscode/tasks.json'), value: content }]);\n\t\t} else {\n\t\t\t// We have a global task configuration\n\t\t\tif ((index === -1) && properties) {\n\t\t\t\tif (properties.problemMatcher !== undefined) {\n\t\t\t\t\tfileConfig.problemMatcher = properties.problemMatcher;\n\t\t\t\t\tawait this._writeConfiguration(workspaceFolder, 'tasks.problemMatchers', fileConfig.problemMatcher, task._source.kind);\n\t\t\t\t} else if (properties.group !== undefined) {\n\t\t\t\t\tfileConfig.group = properties.group;\n\t\t\t\t\tawait this._writeConfiguration(workspaceFolder, 'tasks.group', fileConfig.group, task._source.kind);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!Array.isArray(fileConfig.tasks)) {\n\t\t\t\t\tfileConfig.tasks = [];\n\t\t\t\t}\n\t\t\t\tif (index === undefined) {\n\t\t\t\t\tfileConfig.tasks.push(toCustomize);\n\t\t\t\t} else {\n\t\t\t\t\tfileConfig.tasks[index] = toCustomize;\n\t\t\t\t}\n\t\t\t\tawait this._writeConfiguration(workspaceFolder, 'tasks.tasks', fileConfig.tasks, task._source.kind);\n\t\t\t}\n\t\t}\n\n\t\tif (openConfig) {\n\t\t\tthis._openEditorAtTask(this._getResourceForTask(task), toCustomize);\n\t\t}\n\t}\n\n\tprivate _writeConfiguration(workspaceFolder: IWorkspaceFolder, key: string, value: any, source?: string): Promise<void> | undefined {\n\t\tlet target: ConfigurationTarget | undefined = undefined;\n\t\tswitch (source) {\n\t\t\tcase TaskSourceKind.User: target = ConfigurationTarget.USER; break;\n\t\t\tcase TaskSourceKind.WorkspaceFile: target = ConfigurationTarget.WORKSPACE; break;\n\t\t\tdefault: if (this._contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\t\ttarget = ConfigurationTarget.WORKSPACE;\n\t\t\t} else if (this._contextService.getWorkbenchState() === WorkbenchState.WORKSPACE) {\n\t\t\t\ttarget = ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t}\n\t\tif (target) {\n\t\t\treturn this._configurationService.updateValue(key, value, { resource: workspaceFolder.uri }, target);\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate _getResourceForKind(kind: string): URI | undefined {\n\t\tthis._updateSetup();\n\t\tswitch (kind) {\n\t\t\tcase TaskSourceKind.User: {\n\t\t\t\treturn resources.joinPath(resources.dirname(this._preferencesService.userSettingsResource), 'tasks.json');\n\t\t\t}\n\t\t\tcase TaskSourceKind.WorkspaceFile: {\n\t\t\t\tif (this._workspace && this._workspace.configuration) {\n\t\t\t\t\treturn this._workspace.configuration;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _getResourceForTask(task: CustomTask | ConfiguringTask | ContributedTask): URI {\n\t\tif (CustomTask.is(task)) {\n\t\t\tlet uri = this._getResourceForKind(task._source.kind);\n\t\t\tif (!uri) {\n\t\t\t\tconst taskFolder = task.getWorkspaceFolder();\n\t\t\t\tif (taskFolder) {\n\t\t\t\t\turi = taskFolder.toResource(task._source.config.file);\n\t\t\t\t} else {\n\t\t\t\t\turi = this.workspaceFolders[0].uri;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn uri;\n\t\t} else {\n\t\t\treturn task.getWorkspaceFolder()!.toResource('.vscode/tasks.json');\n\t\t}\n\t}\n\n\tpublic async openConfig(task: CustomTask | ConfiguringTask | undefined): Promise<boolean> {\n\t\tlet resource: URI | undefined;\n\t\tif (task) {\n\t\t\tresource = this._getResourceForTask(task);\n\t\t} else {\n\t\t\tresource = (this._workspaceFolders && (this._workspaceFolders.length > 0)) ? this._workspaceFolders[0].toResource('.vscode/tasks.json') : undefined;\n\t\t}\n\t\treturn this._openEditorAtTask(resource, task ? task._label : undefined, task ? task._source.config.index : -1);\n\t}\n\n\tprivate _createRunnableTask(tasks: TaskMap, group: TaskGroup): { task: Task; resolver: ITaskResolver } | undefined {\n\t\tinterface IResolverData {\n\t\t\tid: Map<string, Task>;\n\t\t\tlabel: Map<string, Task>;\n\t\t\tidentifier: Map<string, Task>;\n\t\t}\n\n\t\tconst resolverData: Map<string, IResolverData> = new Map();\n\t\tconst workspaceTasks: Task[] = [];\n\t\tconst extensionTasks: Task[] = [];\n\t\ttasks.forEach((tasks, folder) => {\n\t\t\tlet data = resolverData.get(folder);\n\t\t\tif (!data) {\n\t\t\t\tdata = {\n\t\t\t\t\tid: new Map<string, Task>(),\n\t\t\t\t\tlabel: new Map<string, Task>(),\n\t\t\t\t\tidentifier: new Map<string, Task>()\n\t\t\t\t};\n\t\t\t\tresolverData.set(folder, data);\n\t\t\t}\n\t\t\tfor (const task of tasks) {\n\t\t\t\tdata.id.set(task._id, task);\n\t\t\t\tdata.label.set(task._label, task);\n\t\t\t\tif (task.configurationProperties.identifier) {\n\t\t\t\t\tdata.identifier.set(task.configurationProperties.identifier, task);\n\t\t\t\t}\n\t\t\t\tif (group && task.configurationProperties.group === group) {\n\t\t\t\t\tif (task._source.kind === TaskSourceKind.Workspace) {\n\t\t\t\t\t\tworkspaceTasks.push(task);\n\t\t\t\t\t} else {\n\t\t\t\t\t\textensionTasks.push(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst resolver: ITaskResolver = {\n\t\t\tresolve: async (uri: URI | string, alias: string) => {\n\t\t\t\tconst data = resolverData.get(typeof uri === 'string' ? uri : uri.toString());\n\t\t\t\tif (!data) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn data.id.get(alias) || data.label.get(alias) || data.identifier.get(alias);\n\t\t\t}\n\t\t};\n\t\tif (workspaceTasks.length > 0) {\n\t\t\tif (workspaceTasks.length > 1) {\n\t\t\t\tthis._log(nls.localize('moreThanOneBuildTask', 'There are many build tasks defined in the tasks.json. Executing the first one.'));\n\t\t\t}\n\t\t\treturn { task: workspaceTasks[0], resolver };\n\t\t}\n\t\tif (extensionTasks.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// We can only have extension tasks if we are in version 2.0.0. Then we can even run\n\t\t// multiple build tasks.\n\t\tif (extensionTasks.length === 1) {\n\t\t\treturn { task: extensionTasks[0], resolver };\n\t\t} else {\n\t\t\tconst id: string = UUID.generateUuid();\n\t\t\tconst task: InMemoryTask = new InMemoryTask(\n\t\t\t\tid,\n\t\t\t\t{ kind: TaskSourceKind.InMemory, label: 'inMemory' },\n\t\t\t\tid,\n\t\t\t\t'inMemory',\n\t\t\t\t{ reevaluateOnRerun: true },\n\t\t\t\t{\n\t\t\t\t\tidentifier: id,\n\t\t\t\t\tdependsOn: extensionTasks.map((extensionTask) => { return { uri: extensionTask.getWorkspaceFolder()!.uri, task: extensionTask._id }; }),\n\t\t\t\t\tname: id\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn { task, resolver };\n\t\t}\n\t}\n\n\tprivate _createResolver(grouped?: TaskMap): ITaskResolver {\n\t\tinterface ResolverData {\n\t\t\tlabel: Map<string, Task>;\n\t\t\tidentifier: Map<string, Task>;\n\t\t\ttaskIdentifier: Map<string, Task>;\n\t\t}\n\n\t\tlet resolverData: Map<string, ResolverData> | undefined;\n\n\t\tasync function quickResolve(that: AbstractTaskService, uri: URI | string, identifier: string | ITaskIdentifier) {\n\t\t\tconst foundTasks = await that._findWorkspaceTasks((task: Task | ConfiguringTask): boolean => {\n\t\t\t\tconst taskUri = ((ConfiguringTask.is(task) || CustomTask.is(task)) ? task._source.config.workspaceFolder?.uri : undefined);\n\t\t\t\tconst originalUri = (typeof uri === 'string' ? uri : uri.toString());\n\t\t\t\tif (taskUri?.toString() !== originalUri) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (Types.isString(identifier)) {\n\t\t\t\t\treturn ((task._label === identifier) || (task.configurationProperties.identifier === identifier));\n\t\t\t\t} else {\n\t\t\t\t\tconst keyedIdentifier = task.getDefinition(true);\n\t\t\t\t\tconst searchIdentifier = TaskDefinition.createTaskIdentifier(identifier, console);\n\t\t\t\t\treturn (searchIdentifier && keyedIdentifier) ? (searchIdentifier._key === keyedIdentifier._key) : false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (foundTasks.length === 0) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tconst task = foundTasks[0];\n\t\t\tif (ConfiguringTask.is(task)) {\n\t\t\t\treturn that.tryResolveTask(task);\n\t\t\t}\n\t\t\treturn task;\n\t\t}\n\n\t\tasync function getResolverData(that: AbstractTaskService) {\n\t\t\tif (resolverData === undefined) {\n\t\t\t\tresolverData = new Map();\n\t\t\t\t(grouped || await that._getGroupedTasks()).forEach((tasks, folder) => {\n\t\t\t\t\tlet data = resolverData!.get(folder);\n\t\t\t\t\tif (!data) {\n\t\t\t\t\t\tdata = { label: new Map<string, Task>(), identifier: new Map<string, Task>(), taskIdentifier: new Map<string, Task>() };\n\t\t\t\t\t\tresolverData!.set(folder, data);\n\t\t\t\t\t}\n\t\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\t\tdata.label.set(task._label, task);\n\t\t\t\t\t\tif (task.configurationProperties.identifier) {\n\t\t\t\t\t\t\tdata.identifier.set(task.configurationProperties.identifier, task);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst keyedIdentifier = task.getDefinition(true);\n\t\t\t\t\t\tif (keyedIdentifier !== undefined) {\n\t\t\t\t\t\t\tdata.taskIdentifier.set(keyedIdentifier._key, task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn resolverData;\n\t\t}\n\n\t\tasync function fullResolve(that: AbstractTaskService, uri: URI | string, identifier: string | ITaskIdentifier) {\n\t\t\tconst allResolverData = await getResolverData(that);\n\t\t\tconst data = allResolverData.get(typeof uri === 'string' ? uri : uri.toString());\n\t\t\tif (!data) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (Types.isString(identifier)) {\n\t\t\t\treturn data.label.get(identifier) || data.identifier.get(identifier);\n\t\t\t} else {\n\t\t\t\tconst key = TaskDefinition.createTaskIdentifier(identifier, console);\n\t\t\t\treturn key !== undefined ? data.taskIdentifier.get(key._key) : undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tresolve: async (uri: URI | string, identifier: string | ITaskIdentifier | undefined) => {\n\t\t\t\tif (!identifier) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tif ((resolverData === undefined) && (grouped === undefined)) {\n\t\t\t\t\treturn (await quickResolve(this, uri, identifier)) ?? fullResolve(this, uri, identifier);\n\t\t\t\t} else {\n\t\t\t\t\treturn fullResolve(this, uri, identifier);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate async _saveBeforeRun(): Promise<boolean> {\n\t\tenum SaveBeforeRunConfigOptions {\n\t\t\tAlways = 'always',\n\t\t\tNever = 'never',\n\t\t\tPrompt = 'prompt'\n\t\t}\n\n\t\tconst saveBeforeRunTaskConfig: SaveBeforeRunConfigOptions = this._configurationService.getValue(TaskSettingId.SaveBeforeRun);\n\n\t\tif (saveBeforeRunTaskConfig === SaveBeforeRunConfigOptions.Never) {\n\t\t\treturn false;\n\t\t} else if (saveBeforeRunTaskConfig === SaveBeforeRunConfigOptions.Prompt && this._editorService.editors.some(e => e.isDirty())) {\n\t\t\tconst { confirmed } = await this._dialogService.confirm({\n\t\t\t\tmessage: nls.localize('TaskSystem.saveBeforeRun.prompt.title', \"Save all editors?\"),\n\t\t\t\tdetail: nls.localize('detail', \"Do you want to save all editors before running the task?\"),\n\t\t\t\tprimaryButton: nls.localize({ key: 'saveBeforeRun.save', comment: ['&& denotes a mnemonic'] }, '&&Save'),\n\t\t\t\tcancelButton: nls.localize({ key: 'saveBeforeRun.dontSave', comment: ['&& denotes a mnemonic'] }, \"Do&&n't Save\"),\n\t\t\t});\n\n\t\t\tif (!confirmed) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tawait this._editorService.saveAll({ reason: SaveReason.AUTO });\n\t\treturn true;\n\t}\n\n\tprivate async _executeTask(task: Task, resolver: ITaskResolver, runSource: TaskRunSource): Promise<ITaskSummary> {\n\t\tlet taskToRun: Task = task;\n\t\tif (await this._saveBeforeRun()) {\n\t\t\tawait this._configurationService.reloadConfiguration();\n\t\t\tawait this._updateWorkspaceTasks();\n\t\t\tconst taskFolder = task.getWorkspaceFolder();\n\t\t\tconst taskIdentifier = task.configurationProperties.identifier;\n\t\t\tconst taskType = CustomTask.is(task) ? task.customizes()?.type : (ContributedTask.is(task) ? task.type : undefined);\n\t\t\t// Since we save before running tasks, the task may have changed as part of the save.\n\t\t\t// However, if the TaskRunSource is not User, then we shouldn't try to fetch the task again\n\t\t\t// since this can cause a new'd task to get overwritten with a provided task.\n\t\t\ttaskToRun = ((taskFolder && taskIdentifier && (runSource === TaskRunSource.User))\n\t\t\t\t? await this.getTask(taskFolder, taskIdentifier, false, taskType) : task) ?? task;\n\t\t}\n\t\tawait ProblemMatcherRegistry.onReady();\n\t\tconst executeResult = runSource === TaskRunSource.Reconnect ? this._getTaskSystem().reconnect(taskToRun, resolver) : this._getTaskSystem().run(taskToRun, resolver);\n\t\tif (executeResult) {\n\t\t\treturn this._handleExecuteResult(executeResult, runSource);\n\t\t}\n\t\treturn { exitCode: 0 };\n\t}\n\n\tprivate async _handleExecuteResult(executeResult: ITaskExecuteResult, runSource?: TaskRunSource): Promise<ITaskSummary> {\n\t\tif (runSource && executeResult.task._id) {\n\t\t\tthis._taskRunSources.set(executeResult.task._id, runSource);\n\t\t}\n\n\t\tif (runSource === TaskRunSource.User) {\n\t\t\tawait this._setRecentlyUsedTask(executeResult.task);\n\t\t}\n\t\tif (executeResult.kind === TaskExecuteKind.Active) {\n\t\t\tconst active = executeResult.active;\n\t\t\tif (active && active.same && runSource === TaskRunSource.FolderOpen || runSource === TaskRunSource.Reconnect) {\n\t\t\t\t// ignore, the task is already active, likely from being reconnected or from folder open.\n\t\t\t\tthis._logService.debug('Ignoring task that is already active', executeResult.task);\n\t\t\t\treturn executeResult.promise;\n\t\t\t}\n\t\t\tif (active && active.same) {\n\t\t\t\tthis._handleInstancePolicy(executeResult.task, executeResult.task.runOptions!.instancePolicy);\n\t\t\t} else {\n\t\t\t\tthrow new TaskError(Severity.Warning, nls.localize('TaskSystem.active', 'There is already a task running. Terminate it first before executing another task.'), TaskErrors.RunningTask);\n\t\t\t}\n\t\t}\n\t\tthis._setRecentlyUsedTask(executeResult.task);\n\t\treturn executeResult.promise;\n\t}\n\n\tprivate _handleInstancePolicy(task: Task, policy?: InstancePolicy): void {\n\t\tif (!this._taskSystem?.isTaskVisible(task)) {\n\t\t\tthis._taskSystem?.revealTask(task);\n\t\t}\n\t\tswitch (policy) {\n\t\t\tcase InstancePolicy.terminateNewest:\n\t\t\t\tthis._restart(this._getTaskSystem().getLastInstance(task) ?? task);\n\t\t\t\tbreak;\n\t\t\tcase InstancePolicy.terminateOldest:\n\t\t\t\tthis._restart(this._getTaskSystem().getFirstInstance(task) ?? task);\n\t\t\t\tbreak;\n\t\t\tcase InstancePolicy.silent:\n\t\t\t\tbreak;\n\t\t\tcase InstancePolicy.warn:\n\t\t\t\tthis._notificationService.warn(nls.localize('TaskSystem.InstancePolicy.warn', 'The instance limit for this task has been reached.'));\n\t\t\t\tbreak;\n\t\t\tcase InstancePolicy.prompt:\n\t\t\tdefault:\n\t\t\t\tthis._showQuickPick(this._taskSystem!.getActiveTasks().filter(t => task._id === t._id),\n\t\t\t\t\tnls.localize('TaskService.instanceToTerminate', 'Select an instance to terminate'),\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: nls.localize('TaskService.noInstanceRunning', 'No instance is currently running'),\n\t\t\t\t\t\ttask: undefined\n\t\t\t\t\t},\n\t\t\t\t\tfalse, true,\n\t\t\t\t\tundefined\n\t\t\t\t).then(entry => {\n\t\t\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\t\t\tif (task === undefined || task === null) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._restart(task);\n\t\t\t\t});\n\t\t}\n\t}\n\n\tprivate async _restart(task: Task): Promise<void> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check if the task is currently running\n\t\tconst isTaskRunning = await this.getActiveTasks().then(tasks => tasks.some(t => t.getMapKey() === task.getMapKey()));\n\n\t\tif (isTaskRunning) {\n\t\t\t// Task is running, terminate it first\n\t\t\tconst response = await this._taskSystem.terminate(task);\n\t\t\tif (!response.success) {\n\t\t\t\tthis._notificationService.warn(nls.localize('TaskSystem.restartFailed', 'Failed to terminate and restart task {0}', Types.isString(task) ? task : task.configurationProperties.name));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Task is not running or was successfully terminated, now run it\n\t\ttry {\n\t\t\t// Before restarting, check if the task still exists and get updated version\n\t\t\tconst updatedTask = await this._findUpdatedTask(task);\n\t\t\tif (updatedTask) {\n\t\t\t\tawait this.run(updatedTask);\n\t\t\t} else {\n\t\t\t\t// Task no longer exists, show warning\n\t\t\t\tthis._notificationService.warn(nls.localize('TaskSystem.taskNoLongerExists', 'Task {0} no longer exists or has been modified. Cannot restart.', task.configurationProperties.name));\n\t\t\t}\n\t\t} catch {\n\t\t\t// eat the error, we don't care about it here\n\t\t}\n\t}\n\n\tprivate async _findUpdatedTask(originalTask: Task): Promise<Task | undefined> {\n\t\tconst mapStringToFolderTasks = await this._updateWorkspaceTasks(TaskRunSource.System);\n\n\t\t// Look for the task in current workspace configuration\n\t\tfor (const [_, folderResult] of mapStringToFolderTasks) {\n\t\t\tif (!folderResult.set?.tasks?.length && !folderResult.configurations?.byIdentifier) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// There are two ways where Task lives:\n\t\t\t// 1. folderResult.set.tasks\n\t\t\tif (folderResult.set?.tasks) {\n\t\t\t\tfor (const task of folderResult.set.tasks) {\n\t\t\t\t\t// Check if this is the same task by ID\n\t\t\t\t\tif (task._id === originalTask._id) {\n\t\t\t\t\t\treturn task;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// 2. folderResult.configurations.byIdentifier\n\t\t\tif (folderResult.configurations?.byIdentifier) {\n\t\t\t\tfor (const [_, configuringTask] of Object.entries(folderResult.configurations.byIdentifier)) {\n\t\t\t\t\t// Check if this is the same task by ID\n\t\t\t\t\tif (configuringTask._id === originalTask._id) {\n\t\t\t\t\t\treturn this.tryResolveTask(configuringTask);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If task wasn't found in workspace configuration, check contributed tasks from providers\n\t\t// This is important for tasks from extensions like npm, which are ContributedTasks\n\t\tif (ContributedTask.is(originalTask)) {\n\t\t\t// The type filter ensures only the matching provider is called (e.g., only npm provider for npm tasks)\n\t\t\t// This is the same pattern used in tryResolveTask as a fallback\n\t\t\tconst allTasks = await this.tasks({ type: originalTask.type });\n\t\t\tfor (const task of allTasks) {\n\t\t\t\tif (task._id === originalTask._id) {\n\t\t\t\t\treturn task;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tpublic async terminate(task: Task): Promise<ITaskTerminateResponse> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn { success: true, task: undefined };\n\t\t}\n\n\t\tif (!this._taskSystem) {\n\t\t\treturn { success: true, task: undefined };\n\t\t}\n\t\treturn this._taskSystem.terminate(task);\n\t}\n\n\tprivate _terminateAll(): Promise<ITaskTerminateResponse[]> {\n\t\tif (!this._taskSystem) {\n\t\t\treturn Promise.resolve<ITaskTerminateResponse[]>([]);\n\t\t}\n\t\treturn this._taskSystem.terminateAll();\n\t}\n\n\tprotected _createTerminalTaskSystem(): ITaskSystem {\n\t\treturn new TerminalTaskSystem(\n\t\t\tthis._terminalService, this._terminalGroupService, this._outputService, this._paneCompositeService, this._viewsService, this._markerService,\n\t\t\tthis._modelService, this._configurationResolverService,\n\t\t\tthis._contextService, this._environmentService,\n\t\t\tAbstractTaskService.OutputChannelId, this._fileService, this._terminalProfileResolverService,\n\t\t\tthis._pathService, this._viewDescriptorService, this._logService, this._notificationService,\n\t\t\tthis._contextKeyService, this._instantiationService,\n\t\t\t(workspaceFolder: IWorkspaceFolder | undefined) => {\n\t\t\t\tif (workspaceFolder) {\n\t\t\t\t\treturn this._getTaskSystemInfo(workspaceFolder.uri.scheme);\n\t\t\t\t} else if (this._taskSystemInfos.size > 0) {\n\t\t\t\t\tconst infos = Array.from(this._taskSystemInfos.entries());\n\t\t\t\t\tconst notFile = infos.filter(info => info[0] !== Schemas.file);\n\t\t\t\t\tif (notFile.length > 0) {\n\t\t\t\t\t\treturn notFile[0][1][0];\n\t\t\t\t\t}\n\t\t\t\t\treturn infos[0][1][0];\n\t\t\t\t} else {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync (taskKey: string) => {\n\t\t\t\t// Look up task by its map key across all workspace tasks\n\t\t\t\tconst taskMap = await this._getGroupedTasks();\n\t\t\t\tconst allTasks = taskMap.all();\n\t\t\t\tfor (const task of allTasks) {\n\t\t\t\t\tif (task.getMapKey() === taskKey) {\n\t\t\t\t\t\treturn task;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t);\n\t}\n\n\tprotected abstract _getTaskSystem(): ITaskSystem;\n\n\tprivate _isTaskProviderEnabled(type: string) {\n\t\tconst definition = TaskDefinitionRegistry.get(type);\n\t\treturn !definition || !definition.when || this._contextKeyService.contextMatchesRules(definition.when);\n\t}\n\n\tprivate async _getGroupedTasks(filter?: ITaskFilter, waitToActivate?: boolean, knownOnlyOrTrusted?: boolean): Promise<TaskMap> {\n\t\tawait this._waitForAllSupportedExecutions;\n\t\tconst type = filter?.type;\n\t\tconst needsRecentTasksMigration = this._needsRecentTasksMigration();\n\t\tif (!waitToActivate) {\n\t\t\tawait this._activateTaskProviders(filter?.type);\n\t\t}\n\t\tconst validTypes: IStringDictionary<boolean> = Object.create(null);\n\t\tTaskDefinitionRegistry.all().forEach(definition => validTypes[definition.taskType] = true);\n\t\tvalidTypes['shell'] = true;\n\t\tvalidTypes['process'] = true;\n\t\tconst contributedTaskSets = await new Promise<ITaskSet[]>(resolve => {\n\t\t\tconst result: ITaskSet[] = [];\n\t\t\tlet counter: number = 0;\n\t\t\tconst done = (value: ITaskSet | undefined) => {\n\t\t\t\tif (value) {\n\t\t\t\t\tresult.push(value);\n\t\t\t\t}\n\t\t\t\tif (--counter === 0) {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst error = (error: any) => {\n\t\t\t\ttry {\n\t\t\t\t\tif (!isCancellationError(error)) {\n\t\t\t\t\t\tif (error && Types.isString(error.message)) {\n\t\t\t\t\t\t\tthis._log(`Error: ${error.message}\\n`);\n\t\t\t\t\t\t\tthis._showOutput(error.message);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._log('Unknown error received while collecting tasks from providers.');\n\t\t\t\t\t\t\tthis._showOutput();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} finally {\n\t\t\t\t\tif (--counter === 0) {\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (this._isProvideTasksEnabled() && (this.schemaVersion === JsonSchemaVersion.V2_0_0) && (this._providers.size > 0)) {\n\t\t\t\tlet foundAnyProviders = false;\n\t\t\t\tfor (const [handle, provider] of this._providers) {\n\t\t\t\t\tconst providerType = this._providerTypes.get(handle);\n\t\t\t\t\tif ((type === undefined) || (type === providerType)) {\n\t\t\t\t\t\tif (providerType && !this._isTaskProviderEnabled(providerType)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfoundAnyProviders = true;\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t\traceTimeout(provider.provideTasks(validTypes).then((taskSet: ITaskSet) => {\n\t\t\t\t\t\t\t// Check that the tasks provided are of the correct type\n\t\t\t\t\t\t\tfor (const task of taskSet.tasks) {\n\t\t\t\t\t\t\t\tif (task.type !== this._providerTypes.get(handle)) {\n\t\t\t\t\t\t\t\t\tthis._log(nls.localize('unexpectedTaskType', \"The task provider for \\\"{0}\\\" tasks unexpectedly provided a task of type \\\"{1}\\\".\\n\", this._providerTypes.get(handle), task.type));\n\t\t\t\t\t\t\t\t\tif ((task.type !== 'shell') && (task.type !== 'process')) {\n\t\t\t\t\t\t\t\t\t\tthis._showOutput();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn done(taskSet);\n\t\t\t\t\t\t}, error), 5000, () => {\n\t\t\t\t\t\t\t// onTimeout\n\t\t\t\t\t\t\tdone(undefined);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!foundAnyProviders) {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(result);\n\t\t\t}\n\t\t});\n\n\t\tconst result: TaskMap = new TaskMap();\n\t\tconst contributedTasks: TaskMap = new TaskMap();\n\n\t\tfor (const set of contributedTaskSets) {\n\t\t\tfor (const task of set.tasks) {\n\t\t\t\tconst workspaceFolder = task.getWorkspaceFolder();\n\t\t\t\tif (workspaceFolder) {\n\t\t\t\t\tcontributedTasks.add(workspaceFolder, task);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tlet tasks: [string, IWorkspaceFolderTaskResult][] = [];\n\t\t\t// prevent workspace trust dialog from being shown in unexpected cases #224881\n\t\t\tif (!knownOnlyOrTrusted || this._workspaceTrustManagementService.isWorkspaceTrusted()) {\n\t\t\t\ttasks = Array.from(await this.getWorkspaceTasks());\n\t\t\t}\n\t\t\tawait Promise.all(this._getCustomTaskPromises(tasks, filter, result, contributedTasks, waitToActivate));\n\t\t\tif (needsRecentTasksMigration) {\n\t\t\t\t// At this point we have all the tasks and can migrate the recently used tasks.\n\t\t\t\tawait this._migrateRecentTasks(result.all());\n\t\t\t}\n\t\t\treturn result;\n\t\t} catch {\n\t\t\t// If we can't read the tasks.json file provide at least the contributed tasks\n\t\t\tconst result: TaskMap = new TaskMap();\n\t\t\tfor (const set of contributedTaskSets) {\n\t\t\t\tfor (const task of set.tasks) {\n\t\t\t\t\tconst folder = task.getWorkspaceFolder();\n\t\t\t\t\tif (folder) {\n\t\t\t\t\t\tresult.add(folder, task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\tprivate _getCustomTaskPromises(customTasksKeyValuePairs: [string, IWorkspaceFolderTaskResult][], filter: ITaskFilter | undefined, result: TaskMap, contributedTasks: TaskMap, waitToActivate: boolean | undefined) {\n\t\treturn customTasksKeyValuePairs.map(async ([key, folderTasks]) => {\n\t\t\tconst contributed = contributedTasks.get(key);\n\t\t\tif (!folderTasks.set) {\n\t\t\t\tif (contributed) {\n\t\t\t\t\tresult.add(key, ...contributed);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._contextService.getWorkbenchState() === WorkbenchState.EMPTY) {\n\t\t\t\tresult.add(key, ...folderTasks.set.tasks);\n\t\t\t} else {\n\t\t\t\tconst configurations = folderTasks.configurations;\n\t\t\t\tconst legacyTaskConfigurations = folderTasks.set ? this._getLegacyTaskConfigurations(folderTasks.set) : undefined;\n\t\t\t\tconst customTasksToDelete: Task[] = [];\n\t\t\t\tif (configurations || legacyTaskConfigurations) {\n\t\t\t\t\tconst unUsedConfigurations: Set<string> = new Set<string>();\n\t\t\t\t\tif (configurations) {\n\t\t\t\t\t\tObject.keys(configurations.byIdentifier).forEach(key => unUsedConfigurations.add(key));\n\t\t\t\t\t}\n\t\t\t\t\tfor (const task of contributed) {\n\t\t\t\t\t\tif (!ContributedTask.is(task)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (configurations) {\n\t\t\t\t\t\t\tconst configuringTask = configurations.byIdentifier[task.defines._key];\n\t\t\t\t\t\t\tif (configuringTask) {\n\t\t\t\t\t\t\t\tunUsedConfigurations.delete(task.defines._key);\n\t\t\t\t\t\t\t\tresult.add(key, TaskConfig.createCustomTask(task, configuringTask));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresult.add(key, task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (legacyTaskConfigurations) {\n\t\t\t\t\t\t\tconst configuringTask = legacyTaskConfigurations[task.defines._key];\n\t\t\t\t\t\t\tif (configuringTask) {\n\t\t\t\t\t\t\t\tresult.add(key, TaskConfig.createCustomTask(task, configuringTask));\n\t\t\t\t\t\t\t\tcustomTasksToDelete.push(configuringTask);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresult.add(key, task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.add(key, task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (customTasksToDelete.length > 0) {\n\t\t\t\t\t\tconst toDelete = customTasksToDelete.reduce<IStringDictionary<boolean>>((map, task) => {\n\t\t\t\t\t\t\tmap[task._id] = true;\n\t\t\t\t\t\t\treturn map;\n\t\t\t\t\t\t}, Object.create(null));\n\t\t\t\t\t\tfor (const task of folderTasks.set.tasks) {\n\t\t\t\t\t\t\tif (toDelete[task._id]) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult.add(key, task);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.add(key, ...folderTasks.set.tasks);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst unUsedConfigurationsAsArray = Array.from(unUsedConfigurations);\n\n\t\t\t\t\tconst unUsedConfigurationPromises = unUsedConfigurationsAsArray.map(async (value) => {\n\t\t\t\t\t\tconst configuringTask = configurations!.byIdentifier[value];\n\t\t\t\t\t\tif (filter?.type && (filter.type !== configuringTask.configures.type)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet requiredTaskProviderUnavailable: boolean = false;\n\n\t\t\t\t\t\tfor (const [handle, provider] of this._providers) {\n\t\t\t\t\t\t\tconst providerType = this._providerTypes.get(handle);\n\t\t\t\t\t\t\tif (configuringTask.type === providerType) {\n\t\t\t\t\t\t\t\tif (providerType && !this._isTaskProviderEnabled(providerType)) {\n\t\t\t\t\t\t\t\t\trequiredTaskProviderUnavailable = true;\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst resolvedTask = await provider.resolveTask(configuringTask);\n\t\t\t\t\t\t\t\t\tif (resolvedTask && (resolvedTask._id === configuringTask._id)) {\n\t\t\t\t\t\t\t\t\t\tresult.add(key, TaskConfig.createCustomTask(resolvedTask, configuringTask));\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\t// Ignore errors. The task could not be provided by any of the providers.\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (requiredTaskProviderUnavailable) {\n\t\t\t\t\t\t\tthis._log(nls.localize(\n\t\t\t\t\t\t\t\t'TaskService.providerUnavailable',\n\t\t\t\t\t\t\t\t'Warning: {0} tasks are unavailable in the current environment.',\n\t\t\t\t\t\t\t\tconfiguringTask.configures.type\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t} else if (!waitToActivate) {\n\t\t\t\t\t\t\tthis._log(nls.localize(\n\t\t\t\t\t\t\t\t'TaskService.noConfiguration',\n\t\t\t\t\t\t\t\t'Error: The {0} task detection didn\\'t contribute a task for the following configuration:\\n{1}\\nThe task will be ignored.',\n\t\t\t\t\t\t\t\tconfiguringTask.configures.type,\n\t\t\t\t\t\t\t\tJSON.stringify(configuringTask._source.config.element, undefined, 4)\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tawait Promise.all(unUsedConfigurationPromises);\n\t\t\t\t} else {\n\t\t\t\t\tresult.add(key, ...folderTasks.set.tasks);\n\t\t\t\t\tresult.add(key, ...contributed);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _getLegacyTaskConfigurations(workspaceTasks: ITaskSet): IStringDictionary<CustomTask> | undefined {\n\t\tlet result: IStringDictionary<CustomTask> | undefined;\n\t\tfunction getResult(): IStringDictionary<CustomTask> {\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tresult = Object.create(null);\n\t\t\treturn result!;\n\t\t}\n\t\tfor (const task of workspaceTasks.tasks) {\n\t\t\tif (CustomTask.is(task)) {\n\t\t\t\tconst commandName = task.command && task.command.name;\n\t\t\t\t// This is for backwards compatibility with the 0.1.0 task annotation code\n\t\t\t\t// if we had a gulp, jake or grunt command a task specification was a annotation\n\t\t\t\tif (commandName === 'gulp' || commandName === 'grunt' || commandName === 'jake') {\n\t\t\t\t\tconst identifier = KeyedTaskIdentifier.create({\n\t\t\t\t\t\ttype: commandName,\n\t\t\t\t\t\ttask: task.configurationProperties.name\n\t\t\t\t\t});\n\t\t\t\t\tgetResult()[identifier._key] = task;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic async getWorkspaceTasks(runSource: TaskRunSource = TaskRunSource.User): Promise<Map<string, IWorkspaceFolderTaskResult>> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn new Map();\n\t\t}\n\t\tawait raceTimeout(this._waitForAllSupportedExecutions, 2000, () => {\n\t\t\tthis._logService.warn('Timed out waiting for all supported executions');\n\t\t});\n\t\tawait this._whenTaskSystemReady;\n\t\tif (this._workspaceTasksPromise) {\n\t\t\treturn this._workspaceTasksPromise;\n\t\t}\n\t\treturn this._updateWorkspaceTasks(runSource);\n\t}\n\n\tpublic getTaskProblems(instanceId: number): Map<string, { resources: URI[]; markers: IMarkerData[] }> | undefined {\n\t\treturn this._taskSystem?.getTaskProblems(instanceId);\n\t}\n\n\tprivate _updateWorkspaceTasks(runSource: TaskRunSource = TaskRunSource.User): Promise<Map<string, IWorkspaceFolderTaskResult>> {\n\t\tthis._workspaceTasksPromise = this._computeWorkspaceTasks(runSource);\n\t\treturn this._workspaceTasksPromise;\n\t}\n\n\tprivate async _getAFolder(): Promise<IWorkspaceFolder> {\n\t\tlet folder = this.workspaceFolders.length > 0 ? this.workspaceFolders[0] : undefined;\n\t\tif (!folder) {\n\t\t\tconst userhome = await this._pathService.userHome();\n\t\t\tfolder = new WorkspaceFolder({ uri: userhome, name: resources.basename(userhome), index: 0 });\n\t\t}\n\t\treturn folder;\n\t}\n\n\tgetTerminalsForTasks(task: Types.SingleOrMany<Task>): URI[] | undefined {\n\t\treturn this._taskSystem?.getTerminalsForTasks(task);\n\t}\n\n\tprotected async _computeWorkspaceTasks(runSource: TaskRunSource = TaskRunSource.User): Promise<Map<string, IWorkspaceFolderTaskResult>> {\n\t\tconst promises: Promise<IWorkspaceFolderTaskResult | undefined>[] = [];\n\t\tfor (const folder of this.workspaceFolders) {\n\t\t\tpromises.push(this._computeWorkspaceFolderTasks(folder, runSource));\n\t\t}\n\t\tconst values = await Promise.all(promises);\n\t\tconst result = new Map<string, IWorkspaceFolderTaskResult>();\n\t\tfor (const value of values) {\n\t\t\tif (value) {\n\t\t\t\tresult.set(value.workspaceFolder.uri.toString(), value);\n\t\t\t}\n\t\t}\n\n\t\tconst folder = await this._getAFolder();\n\t\tif (this._contextService.getWorkbenchState() !== WorkbenchState.EMPTY) {\n\t\t\tconst workspaceFileTasks = await this._computeWorkspaceFileTasks(folder, runSource);\n\t\t\tif (workspaceFileTasks && this._workspace && this._workspace.configuration) {\n\t\t\t\tresult.set(this._workspace.configuration.toString(), workspaceFileTasks);\n\t\t\t}\n\t\t}\n\n\t\tconst userTasks = await this._computeUserTasks(folder, runSource);\n\t\tif (userTasks) {\n\t\t\tresult.set(USER_TASKS_GROUP_KEY, userTasks);\n\t\t}\n\n\t\t// Update tasks available context key\n\t\tconst hasAnyTasks = Array.from(result.values()).some(folderResult =>\n\t\t\t(folderResult.set?.tasks && folderResult.set.tasks.length > 0) ||\n\t\t\t(folderResult.configurations?.byIdentifier && Object.keys(folderResult.configurations.byIdentifier).length > 0)\n\t\t);\n\t\tthis._tasksAvailableState.set(hasAnyTasks);\n\n\t\treturn result;\n\t}\n\n\tprivate get _jsonTasksSupported(): boolean {\n\t\treturn ShellExecutionSupportedContext.getValue(this._contextKeyService) === true && ProcessExecutionSupportedContext.getValue(this._contextKeyService) === true;\n\t}\n\n\tprivate async _computeWorkspaceFolderTasks(workspaceFolder: IWorkspaceFolder, runSource: TaskRunSource = TaskRunSource.User): Promise<IWorkspaceFolderTaskResult> {\n\t\tconst workspaceFolderConfiguration = (this._executionEngine === ExecutionEngine.Process ? await this._computeLegacyConfiguration(workspaceFolder) : await this._computeConfiguration(workspaceFolder));\n\t\tif (!workspaceFolderConfiguration || !workspaceFolderConfiguration.config || workspaceFolderConfiguration.hasErrors) {\n\t\t\treturn Promise.resolve({ workspaceFolder, set: undefined, configurations: undefined, hasErrors: workspaceFolderConfiguration ? workspaceFolderConfiguration.hasErrors : false });\n\t\t}\n\t\tawait ProblemMatcherRegistry.onReady();\n\t\tconst taskSystemInfo: ITaskSystemInfo | undefined = this._getTaskSystemInfo(workspaceFolder.uri.scheme);\n\t\tconst problemReporter = new ProblemReporter(this._outputChannel);\n\t\tthis._register(problemReporter.onDidError(error => this._showOutput(runSource, undefined, error)));\n\t\tconst parseResult = TaskConfig.parse(workspaceFolder, undefined, taskSystemInfo ? taskSystemInfo.platform : Platform.platform, workspaceFolderConfiguration.config, problemReporter, TaskConfig.TaskConfigSource.TasksJson, this._contextKeyService);\n\t\tlet hasErrors = false;\n\t\tif (!parseResult.validationStatus.isOK() && (parseResult.validationStatus.state !== ValidationState.Info)) {\n\t\t\thasErrors = true;\n\t\t}\n\t\tif (problemReporter.status.isFatal()) {\n\t\t\tproblemReporter.fatal(nls.localize('TaskSystem.configurationErrors', 'Error: the provided task configuration has validation errors and can\\'t not be used. Please correct the errors first.'));\n\t\t\treturn { workspaceFolder, set: undefined, configurations: undefined, hasErrors };\n\t\t}\n\t\tlet customizedTasks: { byIdentifier: IStringDictionary<ConfiguringTask> } | undefined;\n\t\tif (parseResult.configured && parseResult.configured.length > 0) {\n\t\t\tcustomizedTasks = {\n\t\t\t\tbyIdentifier: Object.create(null)\n\t\t\t};\n\t\t\tfor (const task of parseResult.configured) {\n\t\t\t\tcustomizedTasks.byIdentifier[task.configures._key] = task;\n\t\t\t}\n\t\t}\n\t\tif (!this._jsonTasksSupported && (parseResult.custom.length > 0)) {\n\t\t\tthis._logService.warn('Custom workspace tasks are not supported.');\n\t\t}\n\t\treturn { workspaceFolder, set: { tasks: this._jsonTasksSupported ? parseResult.custom : [] }, configurations: customizedTasks, hasErrors };\n\t}\n\n\tprivate _testParseExternalConfig(config: TaskConfig.IExternalTaskRunnerConfiguration | undefined, location: string): { config: TaskConfig.IExternalTaskRunnerConfiguration | undefined; hasParseErrors: boolean } {\n\t\tif (!config) {\n\t\t\treturn { config: undefined, hasParseErrors: false };\n\t\t}\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tconst parseErrors: string[] = (config as any).$parseErrors;\n\t\tif (parseErrors) {\n\t\t\tlet isAffected = false;\n\t\t\tfor (const parseError of parseErrors) {\n\t\t\t\tif (/tasks\\.json$/.test(parseError)) {\n\t\t\t\t\tisAffected = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isAffected) {\n\t\t\t\tthis._log(nls.localize({ key: 'TaskSystem.invalidTaskJsonOther', comment: ['Message notifies of an error in one of several places there is tasks related json, not necessarily in a file named tasks.json'] }, 'Error: The content of the tasks json in {0} has syntax errors. Please correct them before executing a task.', location));\n\t\t\t\tthis._showOutput(undefined, undefined, nls.localize({ key: 'TaskSystem.invalidTaskJsonOther', comment: ['Message notifies of an error in one of several places there is tasks related json, not necessarily in a file named tasks.json'] }, 'Error: The content of the tasks json in {0} has syntax errors. Please correct them before executing a task.', location));\n\t\t\t\treturn { config, hasParseErrors: true };\n\t\t\t}\n\t\t}\n\t\treturn { config, hasParseErrors: false };\n\t}\n\n\tprivate _log(value: string, verbose?: boolean): void {\n\t\tif (!verbose || this._configurationService.getValue(TaskSettingId.VerboseLogging)) {\n\t\t\tthis._outputChannel.append(value + '\\n');\n\t\t}\n\t}\n\n\tprivate async _computeWorkspaceFileTasks(workspaceFolder: IWorkspaceFolder, runSource: TaskRunSource = TaskRunSource.User): Promise<IWorkspaceFolderTaskResult> {\n\t\tif (this._executionEngine === ExecutionEngine.Process) {\n\t\t\treturn this._emptyWorkspaceTaskResults(workspaceFolder);\n\t\t}\n\t\tconst workspaceFileConfig = this._getConfiguration(workspaceFolder, TaskSourceKind.WorkspaceFile);\n\t\tconst configuration = this._testParseExternalConfig(workspaceFileConfig.config, nls.localize('TasksSystem.locationWorkspaceConfig', 'workspace file'));\n\t\tconst customizedTasks: { byIdentifier: IStringDictionary<ConfiguringTask> } = {\n\t\t\tbyIdentifier: Object.create(null)\n\t\t};\n\n\t\tconst custom: CustomTask[] = [];\n\t\tawait this._computeTasksForSingleConfig(workspaceFolder, configuration.config, runSource, custom, customizedTasks.byIdentifier, TaskConfig.TaskConfigSource.WorkspaceFile);\n\t\tconst engine = configuration.config ? TaskConfig.ExecutionEngine.from(configuration.config) : ExecutionEngine.Terminal;\n\t\tif (engine === ExecutionEngine.Process) {\n\t\t\tthis._notificationService.warn(nls.localize('TaskSystem.versionWorkspaceFile', 'Only tasks version 2.0.0 permitted in workspace configuration files.'));\n\t\t\treturn this._emptyWorkspaceTaskResults(workspaceFolder);\n\t\t}\n\t\treturn { workspaceFolder, set: { tasks: custom }, configurations: customizedTasks, hasErrors: configuration.hasParseErrors };\n\t}\n\n\tprivate async _computeUserTasks(workspaceFolder: IWorkspaceFolder, runSource: TaskRunSource = TaskRunSource.User): Promise<IWorkspaceFolderTaskResult> {\n\t\tif (this._executionEngine === ExecutionEngine.Process) {\n\t\t\treturn this._emptyWorkspaceTaskResults(workspaceFolder);\n\t\t}\n\t\tconst userTasksConfig = this._getConfiguration(workspaceFolder, TaskSourceKind.User);\n\t\tconst configuration = this._testParseExternalConfig(userTasksConfig.config, nls.localize('TasksSystem.locationUserConfig', 'user settings'));\n\t\tconst customizedTasks: { byIdentifier: IStringDictionary<ConfiguringTask> } = {\n\t\t\tbyIdentifier: Object.create(null)\n\t\t};\n\n\t\tconst custom: CustomTask[] = [];\n\t\tawait this._computeTasksForSingleConfig(workspaceFolder, configuration.config, runSource, custom, customizedTasks.byIdentifier, TaskConfig.TaskConfigSource.User);\n\t\tconst engine = configuration.config ? TaskConfig.ExecutionEngine.from(configuration.config) : ExecutionEngine.Terminal;\n\t\tif (engine === ExecutionEngine.Process) {\n\t\t\tthis._notificationService.warn(nls.localize('TaskSystem.versionSettings', 'Only tasks version 2.0.0 permitted in user settings.'));\n\t\t\treturn this._emptyWorkspaceTaskResults(workspaceFolder);\n\t\t}\n\t\treturn { workspaceFolder, set: { tasks: custom }, configurations: customizedTasks, hasErrors: configuration.hasParseErrors };\n\t}\n\n\tprivate _emptyWorkspaceTaskResults(workspaceFolder: IWorkspaceFolder): IWorkspaceFolderTaskResult {\n\t\treturn { workspaceFolder, set: undefined, configurations: undefined, hasErrors: false };\n\t}\n\n\tprivate async _computeTasksForSingleConfig(workspaceFolder: IWorkspaceFolder, config: TaskConfig.IExternalTaskRunnerConfiguration | undefined, runSource: TaskRunSource, custom: CustomTask[], customized: IStringDictionary<ConfiguringTask>, source: TaskConfig.TaskConfigSource, isRecentTask: boolean = false): Promise<boolean> {\n\t\tif (!config) {\n\t\t\treturn false;\n\t\t} else if (!workspaceFolder) {\n\t\t\tthis._logService.trace('TaskService.computeTasksForSingleConfig: no workspace folder for worskspace', this._workspace?.id);\n\t\t\treturn false;\n\t\t}\n\t\tconst taskSystemInfo: ITaskSystemInfo | undefined = this._getTaskSystemInfo(workspaceFolder.uri.scheme);\n\t\tconst problemReporter = new ProblemReporter(this._outputChannel);\n\t\tconst parseResult = TaskConfig.parse(workspaceFolder, this._workspace, taskSystemInfo ? taskSystemInfo.platform : Platform.platform, config, problemReporter, source, this._contextKeyService, isRecentTask);\n\t\tlet hasErrors = false;\n\t\tif (!parseResult.validationStatus.isOK() && (parseResult.validationStatus.state !== ValidationState.Info)) {\n\t\t\tthis._showOutput(runSource);\n\t\t\thasErrors = true;\n\t\t}\n\t\tif (problemReporter.status.isFatal()) {\n\t\t\tproblemReporter.fatal(nls.localize('TaskSystem.configurationErrors', 'Error: the provided task configuration has validation errors and can\\'t not be used. Please correct the errors first.'));\n\t\t\treturn hasErrors;\n\t\t}\n\t\tif (parseResult.configured && parseResult.configured.length > 0) {\n\t\t\tfor (const task of parseResult.configured) {\n\t\t\t\tcustomized[task.configures._key] = task;\n\t\t\t}\n\t\t}\n\t\tif (!this._jsonTasksSupported && (parseResult.custom.length > 0)) {\n\t\t\tthis._logService.warn('Custom workspace tasks are not supported.');\n\t\t} else {\n\t\t\tfor (const task of parseResult.custom) {\n\t\t\t\tcustom.push(task);\n\t\t\t}\n\t\t}\n\t\treturn hasErrors;\n\t}\n\n\tprivate _computeConfiguration(workspaceFolder: IWorkspaceFolder): Promise<IWorkspaceFolderConfigurationResult> {\n\t\tconst { config, hasParseErrors } = this._getConfiguration(workspaceFolder);\n\t\treturn Promise.resolve<IWorkspaceFolderConfigurationResult>({ workspaceFolder, config, hasErrors: hasParseErrors });\n\t}\n\n\tprotected abstract _computeLegacyConfiguration(workspaceFolder: IWorkspaceFolder): Promise<IWorkspaceFolderConfigurationResult>;\n\n\tprivate _computeWorkspaceFolderSetup(): [IWorkspaceFolder[], IWorkspaceFolder[], ExecutionEngine, JsonSchemaVersion, IWorkspace | undefined] {\n\t\tconst workspaceFolders: IWorkspaceFolder[] = [];\n\t\tconst ignoredWorkspaceFolders: IWorkspaceFolder[] = [];\n\t\tlet executionEngine = ExecutionEngine.Terminal;\n\t\tlet schemaVersion = JsonSchemaVersion.V2_0_0;\n\t\tlet workspace: IWorkspace | undefined;\n\t\tif (this._contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\tconst workspaceFolder: IWorkspaceFolder = this._contextService.getWorkspace().folders[0];\n\t\t\tworkspaceFolders.push(workspaceFolder);\n\t\t\texecutionEngine = this._computeExecutionEngine(workspaceFolder);\n\t\t\tschemaVersion = this._computeJsonSchemaVersion(workspaceFolder);\n\t\t} else if (this._contextService.getWorkbenchState() === WorkbenchState.WORKSPACE) {\n\t\t\tworkspace = this._contextService.getWorkspace();\n\t\t\tfor (const workspaceFolder of this._contextService.getWorkspace().folders) {\n\t\t\t\tif (schemaVersion === this._computeJsonSchemaVersion(workspaceFolder)) {\n\t\t\t\t\tworkspaceFolders.push(workspaceFolder);\n\t\t\t\t} else {\n\t\t\t\t\tignoredWorkspaceFolders.push(workspaceFolder);\n\t\t\t\t\tthis._log(nls.localize(\n\t\t\t\t\t\t'taskService.ignoringFolder',\n\t\t\t\t\t\t'Ignoring task configurations for workspace folder {0}. Multi folder workspace task support requires that all folders use task version 2.0.0',\n\t\t\t\t\t\tworkspaceFolder.uri.fsPath));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn [workspaceFolders, ignoredWorkspaceFolders, executionEngine, schemaVersion, workspace];\n\t}\n\n\tprivate _computeExecutionEngine(workspaceFolder: IWorkspaceFolder): ExecutionEngine {\n\t\tconst { config } = this._getConfiguration(workspaceFolder);\n\t\tif (!config) {\n\t\t\treturn ExecutionEngine._default;\n\t\t}\n\t\treturn TaskConfig.ExecutionEngine.from(config);\n\t}\n\n\tprivate _computeJsonSchemaVersion(workspaceFolder: IWorkspaceFolder): JsonSchemaVersion {\n\t\tconst { config } = this._getConfiguration(workspaceFolder);\n\t\tif (!config) {\n\t\t\treturn JsonSchemaVersion.V2_0_0;\n\t\t}\n\t\treturn TaskConfig.JsonSchemaVersion.from(config);\n\t}\n\n\tprotected _getConfiguration(workspaceFolder: IWorkspaceFolder, source?: string): { config: TaskConfig.IExternalTaskRunnerConfiguration | undefined; hasParseErrors: boolean } {\n\t\tlet result;\n\t\tif ((source !== TaskSourceKind.User) && (this._contextService.getWorkbenchState() === WorkbenchState.EMPTY)) {\n\t\t\tresult = undefined;\n\t\t} else {\n\t\t\tconst wholeConfig = this._configurationService.inspect<TaskConfig.IExternalTaskRunnerConfiguration>('tasks', { resource: workspaceFolder.uri });\n\t\t\tswitch (source) {\n\t\t\t\tcase TaskSourceKind.User: {\n\t\t\t\t\tif (wholeConfig.userValue !== wholeConfig.workspaceFolderValue) {\n\t\t\t\t\t\tresult = Objects.deepClone(wholeConfig.userValue);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase TaskSourceKind.Workspace: result = Objects.deepClone(wholeConfig.workspaceFolderValue); break;\n\t\t\t\tcase TaskSourceKind.WorkspaceFile: {\n\t\t\t\t\tif ((this._contextService.getWorkbenchState() === WorkbenchState.WORKSPACE)\n\t\t\t\t\t\t&& (wholeConfig.workspaceFolderValue !== wholeConfig.workspaceValue)) {\n\t\t\t\t\t\tresult = Objects.deepClone(wholeConfig.workspaceValue);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault: result = Objects.deepClone(wholeConfig.workspaceFolderValue);\n\t\t\t}\n\t\t}\n\t\tif (!result) {\n\t\t\treturn { config: undefined, hasParseErrors: false };\n\t\t}\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tconst parseErrors: string[] = (result as any).$parseErrors;\n\t\tif (parseErrors) {\n\t\t\tlet isAffected = false;\n\t\t\tfor (const parseError of parseErrors) {\n\t\t\t\tif (/tasks\\.json$/.test(parseError)) {\n\t\t\t\t\tisAffected = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isAffected) {\n\t\t\t\tthis._log(nls.localize('TaskSystem.invalidTaskJson', 'Error: The content of the tasks.json file has syntax errors. Please correct them before executing a task.'));\n\t\t\t\tthis._showOutput(undefined, undefined, nls.localize('TaskSystem.invalidTaskJson', 'Error: The content of the tasks.json file has syntax errors. Please correct them before executing a task.'));\n\t\t\t\treturn { config: undefined, hasParseErrors: true };\n\t\t\t}\n\t\t}\n\t\treturn { config: result, hasParseErrors: false };\n\t}\n\n\tpublic inTerminal(): boolean {\n\t\tif (this._taskSystem) {\n\t\t\treturn this._taskSystem instanceof TerminalTaskSystem;\n\t\t}\n\t\treturn this._executionEngine === ExecutionEngine.Terminal;\n\t}\n\n\tpublic configureAction(): Action {\n\t\tconst thisCapture: AbstractTaskService = this;\n\t\treturn new class extends Action {\n\t\t\tconstructor() {\n\t\t\t\tsuper(ConfigureTaskAction.ID, ConfigureTaskAction.TEXT.value, undefined, true, () => { thisCapture._runConfigureTasks(); return Promise.resolve(undefined); });\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _handleError(err: any): void {\n\t\tlet showOutput = true;\n\t\tif (err instanceof TaskError) {\n\t\t\tconst buildError = err;\n\t\t\tconst needsConfig = buildError.code === TaskErrors.NotConfigured || buildError.code === TaskErrors.NoBuildTask || buildError.code === TaskErrors.NoTestTask;\n\t\t\tconst needsTerminate = buildError.code === TaskErrors.RunningTask;\n\t\t\tif (needsConfig || needsTerminate) {\n\t\t\t\tthis._notificationService.prompt(buildError.severity, buildError.message, [{\n\t\t\t\t\tlabel: needsConfig ? ConfigureTaskAction.TEXT.value : nls.localize('TerminateAction.label', \"Terminate Task\"),\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tif (needsConfig) {\n\t\t\t\t\t\t\tthis._runConfigureTasks();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._runTerminateCommand();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]);\n\t\t\t} else {\n\t\t\t\tthis._notificationService.notify({ severity: buildError.severity, message: buildError.message });\n\t\t\t}\n\t\t} else if (err instanceof Error) {\n\t\t\tconst error = err;\n\t\t\tthis._notificationService.error(error.message);\n\t\t\tshowOutput = false;\n\t\t} else if (Types.isString(err)) {\n\t\t\tthis._notificationService.error(<string>err);\n\t\t} else {\n\t\t\tthis._notificationService.error(nls.localize('TaskSystem.unknownError', 'An error has occurred while running a task. See task log for details.'));\n\t\t}\n\t\tif (showOutput) {\n\t\t\tthis._showOutput(undefined, undefined, err);\n\t\t}\n\t}\n\n\tprivate _showDetail(): boolean {\n\t\treturn this._configurationService.getValue<boolean>(QUICKOPEN_DETAIL_CONFIG);\n\t}\n\n\tprivate async _createTaskQuickPickEntries(tasks: Task[], group: boolean = false, sort: boolean = false, selectedEntry?: ITaskQuickPickEntry, includeRecents: boolean = true): Promise<ITaskQuickPickEntry[]> {\n\t\tlet encounteredTasks: { [key: string]: ITaskQuickPickEntry[] } = {};\n\t\tif (tasks === undefined || tasks === null || tasks.length === 0) {\n\t\t\treturn [];\n\t\t}\n\t\tconst TaskQuickPickEntry = (task: Task): ITaskQuickPickEntry => {\n\t\t\tconst newEntry = { label: task._label, description: this.getTaskDescription(task), task, detail: this._showDetail() ? task.configurationProperties.detail : undefined };\n\t\t\tif (encounteredTasks[task._id]) {\n\t\t\t\tif (encounteredTasks[task._id].length === 1) {\n\t\t\t\t\tencounteredTasks[task._id][0].label += ' (1)';\n\t\t\t\t}\n\t\t\t\tnewEntry.label = newEntry.label + ' (' + (encounteredTasks[task._id].length + 1).toString() + ')';\n\t\t\t} else {\n\t\t\t\tencounteredTasks[task._id] = [];\n\t\t\t}\n\t\t\tencounteredTasks[task._id].push(newEntry);\n\t\t\treturn newEntry;\n\n\t\t};\n\t\tfunction fillEntries(entries: QuickPickInput<ITaskQuickPickEntry>[], tasks: Task[], groupLabel: string): void {\n\t\t\tif (tasks.length) {\n\t\t\t\tentries.push({ type: 'separator', label: groupLabel });\n\t\t\t}\n\t\t\tfor (const task of tasks) {\n\t\t\t\tconst entry: ITaskQuickPickEntry = TaskQuickPickEntry(task);\n\t\t\t\tentry.buttons = [{ iconClass: ThemeIcon.asClassName(configureTaskIcon), tooltip: nls.localize('configureTask', \"Configure Task\") }];\n\t\t\t\tif (selectedEntry && (task === selectedEntry.task)) {\n\t\t\t\t\tentries.unshift(selectedEntry);\n\t\t\t\t} else {\n\t\t\t\t\tentries.push(entry);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet entries: ITaskQuickPickEntry[];\n\t\tif (group) {\n\t\t\tentries = [];\n\t\t\tif (tasks.length === 1) {\n\t\t\t\tentries.push(TaskQuickPickEntry(tasks[0]));\n\t\t\t} else {\n\t\t\t\tconst recentlyUsedTasks = await this.getSavedTasks('historical');\n\t\t\t\tconst recent: Task[] = [];\n\t\t\t\tconst recentSet: Set<string> = new Set();\n\t\t\t\tlet configured: Task[] = [];\n\t\t\t\tlet detected: Task[] = [];\n\t\t\t\tconst taskMap: IStringDictionary<Task> = Object.create(null);\n\t\t\t\ttasks.forEach(task => {\n\t\t\t\t\tconst key = task.getCommonTaskId();\n\t\t\t\t\tif (key) {\n\t\t\t\t\t\ttaskMap[key] = task;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\trecentlyUsedTasks.reverse().forEach(recentTask => {\n\t\t\t\t\tconst key = recentTask.getCommonTaskId();\n\t\t\t\t\tif (key) {\n\t\t\t\t\t\trecentSet.add(key);\n\t\t\t\t\t\tconst task = taskMap[key];\n\t\t\t\t\t\tif (task) {\n\t\t\t\t\t\t\trecent.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\tconst key = task.getCommonTaskId();\n\t\t\t\t\tif (!key || !recentSet.has(key)) {\n\t\t\t\t\t\tif ((task._source.kind === TaskSourceKind.Workspace) || (task._source.kind === TaskSourceKind.User)) {\n\t\t\t\t\t\t\tconfigured.push(task);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdetected.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst sorter = this.createSorter();\n\t\t\t\tif (includeRecents) {\n\t\t\t\t\tfillEntries(entries, recent, nls.localize('recentlyUsed', 'recently used tasks'));\n\t\t\t\t}\n\t\t\t\tconfigured = configured.sort((a, b) => sorter.compare(a, b));\n\t\t\t\tfillEntries(entries, configured, nls.localize('configured', 'configured tasks'));\n\t\t\t\tdetected = detected.sort((a, b) => sorter.compare(a, b));\n\t\t\t\tfillEntries(entries, detected, nls.localize('detected', 'detected tasks'));\n\t\t\t}\n\t\t} else {\n\t\t\tif (sort) {\n\t\t\t\tconst sorter = this.createSorter();\n\t\t\t\ttasks = tasks.sort((a, b) => sorter.compare(a, b));\n\t\t\t}\n\t\t\tentries = tasks.map<ITaskQuickPickEntry>(task => TaskQuickPickEntry(task));\n\t\t}\n\t\tencounteredTasks = {};\n\t\treturn entries;\n\t}\n\tprivate async _showTwoLevelQuickPick(placeHolder: string, defaultEntry?: ITaskQuickPickEntry, type?: string, name?: string) {\n\t\treturn this._instantiationService.createInstance(TaskQuickPick).show(placeHolder, defaultEntry, type, name);\n\t}\n\n\tprivate async _showQuickPick(tasks: Promise<Task[]> | Task[], placeHolder: string, defaultEntry?: ITaskQuickPickEntry, group: boolean = false, sort: boolean = false, selectedEntry?: ITaskQuickPickEntry, additionalEntries?: ITaskQuickPickEntry[], name?: string): Promise<ITaskQuickPickEntry | undefined | null> {\n\t\tconst resolvedTasks = await tasks;\n\t\tconst entries: (ITaskQuickPickEntry | IQuickPickSeparator)[] | undefined = await raceTimeout(this._createTaskQuickPickEntries(resolvedTasks, group, sort, selectedEntry), 200, () => undefined);\n\t\tif (!entries) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (entries.length === 1 && this._configurationService.getValue<boolean>(QUICKOPEN_SKIP_CONFIG)) {\n\t\t\treturn (<ITaskQuickPickEntry>entries[0]);\n\t\t} else if ((entries.length === 0) && defaultEntry) {\n\t\t\tentries.push(defaultEntry);\n\t\t} else if (entries.length > 1 && additionalEntries && additionalEntries.length > 0) {\n\t\t\tentries.push({ type: 'separator', label: '' });\n\t\t\tentries.push(additionalEntries[0]);\n\t\t}\n\n\t\treturn this._quickInputService.pick<ITaskQuickPickEntry>(\n\t\t\tentries,\n\t\t\t{\n\t\t\t\tvalue: name,\n\t\t\t\tplaceHolder,\n\t\t\t\tmatchOnDescription: true,\n\t\t\t\tonDidTriggerItemButton: context => {\n\t\t\t\t\tconst task = context.item.task;\n\t\t\t\t\tthis._quickInputService.cancel();\n\t\t\t\t\tif (ContributedTask.is(task)) {\n\t\t\t\t\t\tthis.customize(task, undefined, true);\n\t\t\t\t\t} else if (CustomTask.is(task)) {\n\t\t\t\t\t\tthis.openConfig(task);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tprivate _needsRecentTasksMigration(): boolean {\n\t\treturn (this.getRecentlyUsedTasksV1().size > 0) && (this._getTasksFromStorage('historical').size === 0);\n\t}\n\n\tprivate async _migrateRecentTasks(tasks: Task[]) {\n\t\tif (!this._needsRecentTasksMigration()) {\n\t\t\treturn;\n\t\t}\n\t\tconst recentlyUsedTasks = this.getRecentlyUsedTasksV1();\n\t\tconst taskMap: IStringDictionary<Task> = Object.create(null);\n\t\ttasks.forEach(task => {\n\t\t\tconst key = task.getKey();\n\t\t\tif (key) {\n\t\t\t\ttaskMap[key] = task;\n\t\t\t}\n\t\t});\n\t\tconst reversed = [...recentlyUsedTasks.keys()].reverse();\n\t\tfor (const key in reversed) {\n\t\t\tconst task = taskMap[key];\n\t\t\tif (task) {\n\t\t\t\tawait this._setRecentlyUsedTask(task);\n\t\t\t}\n\t\t}\n\t\tthis._storageService.remove(AbstractTaskService.RecentlyUsedTasks_Key, StorageScope.WORKSPACE);\n\t}\n\n\tprivate _showIgnoredFoldersMessage(): Promise<void> {\n\t\tif (this.ignoredWorkspaceFolders.length === 0 || !this.showIgnoreMessage) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tthis._notificationService.prompt(\n\t\t\tSeverity.Info,\n\t\t\tnls.localize('TaskService.ignoredFolder', 'The following workspace folders are ignored since they use task version 0.1.0: {0}', this.ignoredWorkspaceFolders.map(f => f.name).join(', ')),\n\t\t\t[{\n\t\t\t\tlabel: nls.localize('TaskService.notAgain', \"Don't Show Again\"),\n\t\t\t\tisSecondary: true,\n\t\t\t\trun: () => {\n\t\t\t\t\tthis._storageService.store(AbstractTaskService.IgnoreTask010DonotShowAgain_key, true, StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t\t\t\t\tthis._showIgnoreMessage = false;\n\t\t\t\t}\n\t\t\t}]\n\t\t);\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tprivate async _trust(): Promise<boolean> {\n\t\tconst context = this._contextKeyService.getContext(getActiveElement());\n\t\tif (ServerlessWebContext.getValue(this._contextKeyService) && !TaskExecutionSupportedContext?.evaluate(context)) {\n\t\t\treturn false;\n\t\t}\n\t\tawait this._workspaceTrustManagementService.workspaceTrustInitialized;\n\t\tif (!this._workspaceTrustManagementService.isWorkspaceTrusted()) {\n\t\t\treturn (await this._workspaceTrustRequestService.requestWorkspaceTrust(\n\t\t\t\t{\n\t\t\t\t\tmessage: nls.localize('TaskService.requestTrust', \"Listing and running tasks requires that some of the files in this workspace be executed as code.\")\n\t\t\t\t})) === true;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate async _runTaskCommand(filter?: string | ITaskIdentifier): Promise<void> {\n\t\tif (!this._tasksReconnected) {\n\t\t\treturn;\n\t\t}\n\t\tif (!filter) {\n\t\t\treturn this._doRunTaskCommand();\n\t\t}\n\t\tconst type = typeof filter === 'string' ? undefined : filter.type;\n\t\tconst taskName = typeof filter === 'string' ? filter : filter.task;\n\t\tconst grouped = await this._getGroupedTasks({ type });\n\t\tconst identifier = this._getTaskIdentifier(filter);\n\t\tconst tasks = grouped.all();\n\t\tconst resolver = this._createResolver(grouped);\n\t\tconst folderURIs: (URI | string)[] = this._contextService.getWorkspace().folders.map(folder => folder.uri);\n\t\tif (this._contextService.getWorkbenchState() === WorkbenchState.WORKSPACE) {\n\t\t\tfolderURIs.push(this._contextService.getWorkspace().configuration!);\n\t\t}\n\t\tfolderURIs.push(USER_TASKS_GROUP_KEY);\n\t\tif (identifier) {\n\t\t\tfor (const uri of folderURIs) {\n\t\t\t\tconst task = await resolver.resolve(uri, identifier);\n\t\t\t\tif (task) {\n\t\t\t\t\tthis.run(task);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst exactMatchTask = !taskName ? undefined : tasks.find(t => t.configurationProperties.identifier === taskName || t.getDefinition(true)?.configurationProperties?.identifier === taskName);\n\t\tif (!exactMatchTask) {\n\t\t\treturn this._doRunTaskCommand(tasks, type, taskName);\n\t\t}\n\t\tfor (const uri of folderURIs) {\n\t\t\tconst task = await resolver.resolve(uri, taskName);\n\t\t\tif (task) {\n\t\t\t\tawait this.run(task, { attachProblemMatcher: true }, TaskRunSource.User);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _tasksAndGroupedTasks(filter?: ITaskFilter): { tasks: Promise<Task[]>; grouped: Promise<TaskMap> } {\n\t\tif (!this._versionAndEngineCompatible(filter)) {\n\t\t\treturn { tasks: Promise.resolve<Task[]>([]), grouped: Promise.resolve(new TaskMap()) };\n\t\t}\n\t\tconst grouped = this._getGroupedTasks(filter);\n\t\tconst tasks = grouped.then((map) => {\n\t\t\tif (!filter || !filter.type) {\n\t\t\t\treturn map.all();\n\t\t\t}\n\t\t\tconst result: Task[] = [];\n\t\t\tmap.forEach((tasks) => {\n\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\tif (ContributedTask.is(task) && task.defines.type === filter.type) {\n\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t} else if (CustomTask.is(task)) {\n\t\t\t\t\t\tif (task.type === filter.type) {\n\t\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst customizes = task.customizes();\n\t\t\t\t\t\t\tif (customizes && customizes.type === filter.type) {\n\t\t\t\t\t\t\t\tresult.push(task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t});\n\t\treturn { tasks, grouped };\n\t}\n\n\tprivate _doRunTaskCommand(tasks?: Task[], type?: string, name?: string): void {\n\t\tconst pickThen = (task: Task | undefined | null) => {\n\t\t\tif (task === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (task === null) {\n\t\t\t\tthis._runConfigureTasks();\n\t\t\t} else {\n\t\t\t\tthis.run(task, { attachProblemMatcher: true }, TaskRunSource.User).then(undefined, reason => {\n\t\t\t\t\t// eat the error, it has already been surfaced to the user and we don't care about it here\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst placeholder = nls.localize('TaskService.pickRunTask', 'Select the task to run');\n\n\t\tthis._showIgnoredFoldersMessage().then(() => {\n\t\t\tif (this._configurationService.getValue(USE_SLOW_PICKER)) {\n\t\t\t\tlet taskResult: { tasks: Promise<Task[]>; grouped: Promise<TaskMap> } | undefined = undefined;\n\t\t\t\tif (!tasks) {\n\t\t\t\t\ttaskResult = this._tasksAndGroupedTasks();\n\t\t\t\t}\n\t\t\t\tthis._showQuickPick(tasks ? tasks : taskResult!.tasks, placeholder,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(plus) ' + nls.localize('TaskService.noEntryToRun', 'Configure a Task'),\n\t\t\t\t\t\ttask: null\n\t\t\t\t\t},\n\t\t\t\t\ttrue, undefined, undefined, undefined, name).\n\t\t\t\t\tthen((entry) => {\n\t\t\t\t\t\treturn pickThen(entry ? entry.task : undefined);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis._showTwoLevelQuickPick(placeholder,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(plus) ' + nls.localize('TaskService.noEntryToRun', 'Configure a Task'),\n\t\t\t\t\t\ttask: null\n\t\t\t\t\t}, type, name).\n\t\t\t\t\tthen(pickThen);\n\t\t\t}\n\t\t});\n\t}\n\n\n\tasync rerun(terminalInstanceId: number): Promise<void> {\n\t\tconst task = await this._taskSystem?.getTaskForTerminal(terminalInstanceId);\n\t\tif (task) {\n\t\t\tthis._restart(task);\n\t\t} else {\n\t\t\tthis._reRunTaskCommand(true);\n\t\t}\n\t}\n\n\tprivate _reRunTaskCommand(onlyRerun?: boolean): void {\n\n\t\tProblemMatcherRegistry.onReady().then(() => {\n\t\t\treturn this._editorService.saveAll({ reason: SaveReason.AUTO }).then(() => { // make sure all dirty editors are saved\n\t\t\t\tconst executeResult = this._getTaskSystem().rerun();\n\t\t\t\tif (executeResult) {\n\t\t\t\t\treturn this._handleExecuteResult(executeResult);\n\t\t\t\t} else {\n\t\t\t\t\tif (!onlyRerun && !this._taskRunningState.get()) {\n\t\t\t\t\t\t// No task running, prompt to ask which to run\n\t\t\t\t\t\tthis._doRunTaskCommand();\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param tasks - The tasks which need to be filtered\n\t * @param tasksInList - This tells splitPerGroupType to filter out globbed tasks (into defaults)\n\t * @returns\n\t */\n\tprivate _getDefaultTasks(tasks: Task[], taskGlobsInList: boolean = false): Task[] {\n\t\tconst defaults: Task[] = [];\n\t\tfor (const task of tasks.filter(t => !!t.configurationProperties.group)) {\n\t\t\t// At this point (assuming taskGlobsInList is true) there are tasks with matching globs, so only put those in defaults\n\t\t\tif (taskGlobsInList && typeof (task.configurationProperties.group as TaskGroup).isDefault === 'string') {\n\t\t\t\tdefaults.push(task);\n\t\t\t} else if (!taskGlobsInList && (task.configurationProperties.group as TaskGroup).isDefault === true) {\n\t\t\t\tdefaults.push(task);\n\t\t\t}\n\t\t}\n\t\treturn defaults;\n\t}\n\n\tprivate _runTaskGroupCommand(taskGroup: TaskGroup, strings: {\n\t\tfetching: string;\n\t\tselect: string;\n\t\tnotFoundConfigure: string;\n\t}, configure: () => void, legacyCommand: () => void): void {\n\t\tif (this.schemaVersion === JsonSchemaVersion.V0_1_0) {\n\t\t\tlegacyCommand();\n\t\t\treturn;\n\t\t}\n\t\tconst options: IProgressOptions = {\n\t\t\tlocation: ProgressLocation.Window,\n\t\t\ttitle: strings.fetching\n\t\t};\n\t\tconst promise = (async () => {\n\n\t\t\tasync function runSingleTask(task: Task | undefined, problemMatcherOptions: IProblemMatcherRunOptions | undefined, that: AbstractTaskService) {\n\t\t\t\tthat.run(task, problemMatcherOptions, TaskRunSource.User).then(undefined, reason => {\n\t\t\t\t\t// eat the error, it has already been surfaced to the user and we don't care about it here\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst chooseAndRunTask = (tasks: Task[]) => {\n\t\t\t\tthis._showIgnoredFoldersMessage().then(() => {\n\t\t\t\t\tthis._showQuickPick(tasks,\n\t\t\t\t\t\tstrings.select,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: strings.notFoundConfigure,\n\t\t\t\t\t\t\ttask: null\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue).then((entry) => {\n\t\t\t\t\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\t\t\t\t\tif (task === undefined) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (task === null) {\n\t\t\t\t\t\t\t\tconfigure.apply(this);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trunSingleTask(task, { attachProblemMatcher: true }, this);\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\t\t\tlet groupTasks: (Task | ConfiguringTask)[] = [];\n\t\t\tconst { globGroupTasks, globTasksDetected } = await this._getGlobTasks(taskGroup._id);\n\t\t\tgroupTasks = [...globGroupTasks];\n\t\t\tif (!globTasksDetected && groupTasks.length === 0) {\n\t\t\t\tgroupTasks = await this._findWorkspaceTasksInGroup(taskGroup, true);\n\t\t\t}\n\n\t\t\tconst handleMultipleTasks = (areGlobTasks: boolean) => {\n\t\t\t\treturn this._getTasksForGroup(taskGroup).then((tasks) => {\n\t\t\t\t\tif (tasks.length > 0) {\n\t\t\t\t\t\t// If we're dealing with tasks that were chosen because of a glob match,\n\t\t\t\t\t\t// then put globs in the defaults and everything else in none\n\t\t\t\t\t\tconst defaults = this._getDefaultTasks(tasks, areGlobTasks);\n\t\t\t\t\t\tif (defaults.length === 1) {\n\t\t\t\t\t\t\trunSingleTask(defaults[0], undefined, this);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if (defaults.length > 0) {\n\t\t\t\t\t\t\ttasks = defaults;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// At this this point there are multiple tasks.\n\t\t\t\t\tchooseAndRunTask(tasks);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst resolveTaskAndRun = (taskGroupTask: Task | ConfiguringTask) => {\n\t\t\t\tif (ConfiguringTask.is(taskGroupTask)) {\n\t\t\t\t\tthis.tryResolveTask(taskGroupTask).then(resolvedTask => {\n\t\t\t\t\t\trunSingleTask(resolvedTask, undefined, this);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\trunSingleTask(taskGroupTask, undefined, this);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// A single default glob task was returned, just run it directly\n\t\t\tif (groupTasks.length === 1) {\n\t\t\t\treturn resolveTaskAndRun(groupTasks[0]);\n\t\t\t}\n\n\t\t\t// If there's multiple globs that match we want to show the quick picker for those tasks\n\t\t\t// We will need to call splitPerGroupType putting globs in defaults and the remaining tasks in none.\n\t\t\t// We don't need to carry on after here\n\t\t\tif (globTasksDetected && groupTasks.length > 1) {\n\t\t\t\treturn handleMultipleTasks(true);\n\t\t\t}\n\n\t\t\t// If no globs are found or matched fallback to checking for default tasks of the task group\n\t\t\tif (!groupTasks.length) {\n\t\t\t\tgroupTasks = await this._findWorkspaceTasksInGroup(taskGroup, true);\n\t\t\t}\n\n\t\t\tif (groupTasks.length === 1) {\n\t\t\t\t// A single default task was returned, just run it directly\n\t\t\t\treturn resolveTaskAndRun(groupTasks[0]);\n\t\t\t}\n\t\t\t// Multiple default tasks returned, show the quickPicker\n\t\t\treturn handleMultipleTasks(false);\n\t\t})();\n\t\tthis._progressService.withProgress(options, () => promise);\n\t}\n\n\tprivate async _getGlobTasks(taskGroupId: string): Promise<{ globGroupTasks: (Task | ConfiguringTask)[]; globTasksDetected: boolean }> {\n\t\tlet globTasksDetected = false;\n\t\t// First check for globs before checking for the default tasks of the task group\n\t\tconst absoluteURI = EditorResourceAccessor.getOriginalUri(this._editorService.activeEditor);\n\t\tif (absoluteURI) {\n\t\t\tconst workspaceFolder = this._contextService.getWorkspaceFolder(absoluteURI);\n\t\t\tif (workspaceFolder) {\n\t\t\t\tconst configuredTasks = this._getConfiguration(workspaceFolder)?.config?.tasks;\n\t\t\t\tif (configuredTasks) {\n\t\t\t\t\tglobTasksDetected = configuredTasks.filter(task => task.group && typeof task.group !== 'string' && typeof task.group.isDefault === 'string').length > 0;\n\t\t\t\t\t// This will activate extensions, so only do so if necessary #185960\n\t\t\t\t\tif (globTasksDetected) {\n\t\t\t\t\t\t// Fallback to absolute path of the file if it is not in a workspace or relative path cannot be found\n\t\t\t\t\t\tconst relativePath = workspaceFolder?.uri ? (resources.relativePath(workspaceFolder.uri, absoluteURI) ?? absoluteURI.path) : absoluteURI.path;\n\n\t\t\t\t\t\tconst globGroupTasks = await this._findWorkspaceTasks((task) => {\n\t\t\t\t\t\t\tconst currentTaskGroup = task.configurationProperties.group;\n\t\t\t\t\t\t\tif (currentTaskGroup && typeof currentTaskGroup !== 'string' && typeof currentTaskGroup.isDefault === 'string') {\n\t\t\t\t\t\t\t\treturn (currentTaskGroup._id === taskGroupId && glob.match(currentTaskGroup.isDefault, relativePath, { ignoreCase: true }));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tglobTasksDetected = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn { globGroupTasks, globTasksDetected };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn { globGroupTasks: [], globTasksDetected };\n\n\t}\n\n\tprivate _runBuildCommand(): void {\n\t\tif (!this._tasksReconnected) {\n\t\t\treturn;\n\t\t}\n\t\treturn this._runTaskGroupCommand(TaskGroup.Build, {\n\t\t\tfetching: nls.localize('TaskService.fetchingBuildTasks', 'Fetching build tasks...'),\n\t\t\tselect: nls.localize('TaskService.pickBuildTask', 'Select the build task to run'),\n\t\t\tnotFoundConfigure: nls.localize('TaskService.noBuildTask', 'No build task to run found. Configure Build Task...')\n\t\t}, this._runConfigureDefaultBuildTask, this._build);\n\t}\n\n\tprivate _runTestCommand(): void {\n\t\treturn this._runTaskGroupCommand(TaskGroup.Test, {\n\t\t\tfetching: nls.localize('TaskService.fetchingTestTasks', 'Fetching test tasks...'),\n\t\t\tselect: nls.localize('TaskService.pickTestTask', 'Select the test task to run'),\n\t\t\tnotFoundConfigure: nls.localize('TaskService.noTestTaskTerminal', 'No test task to run found. Configure Tasks...')\n\t\t}, this._runConfigureDefaultTestTask, this._runTest);\n\t}\n\n\tprivate _runTerminateCommand(arg?: string | ITaskIdentifier): void {\n\t\tif (arg === 'terminateAll') {\n\t\t\tthis._terminateAll();\n\t\t\treturn;\n\t\t}\n\t\tconst runQuickPick = (promise?: Promise<Task[]>) => {\n\t\t\tthis._showQuickPick(promise || this.getActiveTasks(),\n\t\t\t\tnls.localize('TaskService.taskToTerminate', 'Select a task to terminate'),\n\t\t\t\t{\n\t\t\t\t\tlabel: nls.localize('TaskService.noTaskRunning', 'No task is currently running'),\n\t\t\t\t\ttask: undefined\n\t\t\t\t},\n\t\t\t\tfalse, true,\n\t\t\t\tundefined,\n\t\t\t\t[{\n\t\t\t\t\tlabel: nls.localize('TaskService.terminateAllRunningTasks', 'All Running Tasks'),\n\t\t\t\t\tid: 'terminateAll',\n\t\t\t\t\ttask: undefined\n\t\t\t\t}]\n\t\t\t).then(entry => {\n\t\t\t\tif (entry && entry.id === 'terminateAll') {\n\t\t\t\t\tthis._terminateAll();\n\t\t\t\t}\n\t\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\t\tif (task === undefined || task === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.terminate(task);\n\t\t\t});\n\t\t};\n\t\tif (this.inTerminal()) {\n\t\t\tconst identifier = this._getTaskIdentifier(arg);\n\t\t\tlet promise: Promise<Task[]>;\n\t\t\tif (identifier !== undefined) {\n\t\t\t\tpromise = this.getActiveTasks();\n\t\t\t\tpromise.then((tasks) => {\n\t\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\t\tif (task.matches(identifier)) {\n\t\t\t\t\t\t\tthis.terminate(task);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trunQuickPick(promise);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\trunQuickPick();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isActive().then((active) => {\n\t\t\t\tif (active) {\n\t\t\t\t\tthis._terminateAll().then((responses) => {\n\t\t\t\t\t\t// the output runner has only one task\n\t\t\t\t\t\tconst response = responses[0];\n\t\t\t\t\t\tif (response.success) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (response.code && response.code === TerminateResponseCode.ProcessNotFound) {\n\t\t\t\t\t\t\tthis._notificationService.error(nls.localize('TerminateAction.noProcess', 'The launched process doesn\\'t exist anymore. If the task spawned background tasks exiting VS Code might result in orphaned processes.'));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._notificationService.error(nls.localize('TerminateAction.failed', 'Failed to terminate running task'));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async _runRestartTaskCommand(arg?: string | ITaskIdentifier): Promise<void> {\n\n\t\tconst activeTasks = await this.getActiveTasks();\n\n\t\tif (activeTasks.length === 1) {\n\t\t\tthis._restart(activeTasks[0]);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.inTerminal()) {\n\t\t\t// try dispatching using task identifier\n\t\t\tconst identifier = this._getTaskIdentifier(arg);\n\t\t\tif (identifier !== undefined) {\n\t\t\t\tfor (const task of activeTasks) {\n\t\t\t\t\tif (task.matches(identifier)) {\n\t\t\t\t\t\tthis._restart(task);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// show quick pick with active tasks\n\t\t\tconst entry = await this._showQuickPick(\n\t\t\t\tactiveTasks,\n\t\t\t\tnls.localize('TaskService.taskToRestart', 'Select the task to restart'),\n\t\t\t\t{\n\t\t\t\t\tlabel: nls.localize('TaskService.noTaskToRestart', 'No task to restart'),\n\t\t\t\t\ttask: null\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tif (entry && entry.task) {\n\t\t\t\tthis._restart(entry.task);\n\t\t\t}\n\t\t} else {\n\t\t\tif (activeTasks.length > 0) {\n\t\t\t\tthis._restart(activeTasks[0]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async _runRerunAllRunningTasksCommand(): Promise<void> {\n\t\tconst activeTasks = await this.getActiveTasks();\n\n\t\tif (activeTasks.length === 0) {\n\t\t\tthis._notificationService.info(nls.localize('TaskService.noRunningTasks', 'No running tasks to restart'));\n\t\t\treturn;\n\t\t}\n\n\t\t// Restart all active tasks\n\t\tconst restartPromises = activeTasks.map(task => this._restart(task));\n\t\tawait Promise.allSettled(restartPromises);\n\t}\n\n\tprivate _getTaskIdentifier(filter?: string | ITaskIdentifier): string | KeyedTaskIdentifier | undefined {\n\t\tlet result: string | KeyedTaskIdentifier | undefined = undefined;\n\t\tif (Types.isString(filter)) {\n\t\t\tresult = filter;\n\t\t} else if (filter && Types.isString(filter.type)) {\n\t\t\tresult = TaskDefinition.createTaskIdentifier(filter, console);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _configHasTasks(taskConfig?: TaskConfig.IExternalTaskRunnerConfiguration): boolean {\n\t\treturn !!taskConfig && !!taskConfig.tasks && taskConfig.tasks.length > 0;\n\t}\n\n\tprivate _openTaskFile(resource: URI, taskSource: string) {\n\t\tlet configFileCreated = false;\n\t\tthis._fileService.stat(resource).then((stat) => stat, () => undefined).then(async (stat) => {\n\t\t\tconst fileExists: boolean = !!stat;\n\t\t\tconst configValue = this._configurationService.inspect<TaskConfig.IExternalTaskRunnerConfiguration>('tasks', { resource });\n\t\t\tlet tasksExistInFile: boolean;\n\t\t\tlet target: ConfigurationTarget;\n\t\t\tswitch (taskSource) {\n\t\t\t\tcase TaskSourceKind.User: tasksExistInFile = this._configHasTasks(configValue.userValue); target = ConfigurationTarget.USER; break;\n\t\t\t\tcase TaskSourceKind.WorkspaceFile: tasksExistInFile = this._configHasTasks(configValue.workspaceValue); target = ConfigurationTarget.WORKSPACE; break;\n\t\t\t\tdefault: tasksExistInFile = this._configHasTasks(configValue.workspaceFolderValue); target = ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t\tlet content;\n\t\t\tif (!tasksExistInFile) {\n\t\t\t\tconst pickTemplateResult = await this._quickInputService.pick(getTaskTemplates(), { placeHolder: nls.localize('TaskService.template', 'Select a Task Template') });\n\t\t\t\tif (!pickTemplateResult) {\n\t\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t\t}\n\t\t\t\tcontent = pickTemplateResult.content;\n\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\tconst editorConfig = this._configurationService.getValue() as any;\n\t\t\t\tif (editorConfig.editor.insertSpaces) {\n\t\t\t\t\tcontent = content.replace(/(\\n)(\\t+)/g, (_, s1, s2) => s1 + ' '.repeat(s2.length * editorConfig.editor.tabSize));\n\t\t\t\t}\n\t\t\t\tconfigFileCreated = true;\n\t\t\t}\n\n\t\t\tif (!fileExists && content) {\n\t\t\t\treturn this._textFileService.create([{ resource, value: content }]).then(result => {\n\t\t\t\t\treturn result[0].resource;\n\t\t\t\t});\n\t\t\t} else if (fileExists && (tasksExistInFile || content)) {\n\t\t\t\tconst statResource = stat?.resource;\n\t\t\t\tif (content && statResource) {\n\t\t\t\t\tthis._configurationService.updateValue('tasks', json.parse(content), { resource: statResource }, target);\n\t\t\t\t}\n\t\t\t\treturn statResource;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}).then((resource) => {\n\t\t\tif (!resource) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._editorService.openEditor({\n\t\t\t\tresource,\n\t\t\t\toptions: {\n\t\t\t\t\tpinned: configFileCreated // pin only if config file is created #8727\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _isTaskEntry(value: IQuickPickItem): value is IQuickPickItem & { task: Task } {\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tconst candidate: IQuickPickItem & { task: Task } = value as any;\n\t\treturn candidate && !!candidate.task;\n\t}\n\n\tprivate _isSettingEntry(value: IQuickPickItem): value is IQuickPickItem & { settingType: string } {\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tconst candidate: IQuickPickItem & { settingType: string } = value as any;\n\t\treturn candidate && !!candidate.settingType;\n\t}\n\n\tprivate _configureTask(task: Task) {\n\t\tif (ContributedTask.is(task)) {\n\t\t\tthis.customize(task, undefined, true);\n\t\t} else if (CustomTask.is(task)) {\n\t\t\tthis.openConfig(task);\n\t\t} else if (ConfiguringTask.is(task)) {\n\t\t\t// Do nothing.\n\t\t}\n\t}\n\n\tprivate _handleSelection(selection: TaskQuickPickEntryType | undefined) {\n\t\tif (!selection) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._isTaskEntry(selection)) {\n\t\t\tthis._configureTask(selection.task);\n\t\t} else if (this._isSettingEntry(selection)) {\n\t\t\tconst taskQuickPick = this._instantiationService.createInstance(TaskQuickPick);\n\t\t\ttaskQuickPick.handleSettingOption(selection.settingType);\n\t\t} else if (selection.folder && (this._contextService.getWorkbenchState() !== WorkbenchState.EMPTY)) {\n\t\t\tthis._openTaskFile(selection.folder.toResource('.vscode/tasks.json'), TaskSourceKind.Workspace);\n\t\t} else {\n\t\t\tconst resource = this._getResourceForKind(TaskSourceKind.User);\n\t\t\tif (resource) {\n\t\t\t\tthis._openTaskFile(resource, TaskSourceKind.User);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic getTaskDescription(task: Task | ConfiguringTask): string | undefined {\n\t\tlet description: string | undefined;\n\t\tif (task._source.kind === TaskSourceKind.User) {\n\t\t\tdescription = nls.localize('taskQuickPick.userSettings', 'User');\n\t\t} else if (task._source.kind === TaskSourceKind.WorkspaceFile) {\n\t\t\tdescription = task.getWorkspaceFileName();\n\t\t} else if (this.needsFolderQualification()) {\n\t\t\tconst workspaceFolder = task.getWorkspaceFolder();\n\t\t\tif (workspaceFolder) {\n\t\t\t\tdescription = workspaceFolder.name;\n\t\t\t}\n\t\t}\n\t\treturn description;\n\t}\n\n\tprivate async _runConfigureTasks(): Promise<void> {\n\t\tif (!(await this._trust())) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet taskPromise: Promise<TaskMap>;\n\t\tif (this.schemaVersion === JsonSchemaVersion.V2_0_0) {\n\t\t\ttaskPromise = this._getGroupedTasks();\n\t\t} else {\n\t\t\ttaskPromise = Promise.resolve(new TaskMap());\n\t\t}\n\n\t\tconst stats = this._contextService.getWorkspace().folders.map<Promise<IFileStatWithPartialMetadata | undefined>>((folder) => {\n\t\t\treturn this._fileService.stat(folder.toResource('.vscode/tasks.json')).then(stat => stat, () => undefined);\n\t\t});\n\n\t\tconst createLabel = nls.localize('TaskService.createJsonFile', 'Create tasks.json file from template');\n\t\tconst openLabel = nls.localize('TaskService.openJsonFile', 'Open tasks.json file');\n\t\tconst tokenSource = new CancellationTokenSource();\n\t\tconst cancellationToken: CancellationToken = tokenSource.token;\n\t\tconst entries = Promise.all(stats).then((stats) => {\n\t\t\treturn taskPromise.then((taskMap) => {\n\t\t\t\tconst entries: QuickPickInput<TaskQuickPickEntryType>[] = [];\n\t\t\t\tlet configuredCount = 0;\n\t\t\t\tlet tasks = taskMap.all();\n\t\t\t\tif (tasks.length > 0) {\n\t\t\t\t\ttasks = tasks.sort((a, b) => a._label.localeCompare(b._label));\n\t\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\t\tconst entry = { label: TaskQuickPick.getTaskLabelWithIcon(task), task, description: this.getTaskDescription(task), detail: this._showDetail() ? task.configurationProperties.detail : undefined };\n\t\t\t\t\t\tTaskQuickPick.applyColorStyles(task, entry, this._themeService);\n\t\t\t\t\t\tentries.push(entry);\n\t\t\t\t\t\tif (!ContributedTask.is(task)) {\n\t\t\t\t\t\t\tconfiguredCount++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst needsCreateOrOpen = (configuredCount === 0);\n\t\t\t\t// If the only configured tasks are user tasks, then we should also show the option to create from a template.\n\t\t\t\tif (needsCreateOrOpen || (taskMap.get(USER_TASKS_GROUP_KEY).length === configuredCount)) {\n\t\t\t\t\tconst label = stats[0] !== undefined ? openLabel : createLabel;\n\t\t\t\t\tif (entries.length) {\n\t\t\t\t\t\tentries.push({ type: 'separator' });\n\t\t\t\t\t}\n\t\t\t\t\tentries.push({ label, folder: this._contextService.getWorkspace().folders[0] });\n\t\t\t\t}\n\t\t\t\tif ((entries.length === 1) && !needsCreateOrOpen) {\n\t\t\t\t\ttokenSource.cancel();\n\t\t\t\t}\n\t\t\t\treturn entries;\n\t\t\t});\n\t\t});\n\n\t\tconst timeout: boolean = await Promise.race([new Promise<boolean>((resolve) => {\n\t\t\tentries.then(() => resolve(false));\n\t\t}), new Promise<boolean>((resolve) => {\n\t\t\tconst timer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tresolve(true);\n\t\t\t}, 200);\n\t\t})]);\n\n\t\tif (!timeout && ((await entries).length === 1) && this._configurationService.getValue<boolean>(QUICKOPEN_SKIP_CONFIG)) {\n\t\t\tconst entry: any = (await entries)[0];\n\t\t\tif (entry.task) {\n\t\t\t\tthis._handleSelection(entry);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst entriesWithSettings = entries.then(resolvedEntries => {\n\t\t\tresolvedEntries.push(...TaskQuickPick.allSettingEntries(this._configurationService));\n\t\t\treturn resolvedEntries;\n\t\t});\n\n\t\tthis._quickInputService.pick(entriesWithSettings,\n\t\t\t{ placeHolder: nls.localize('TaskService.pickTask', 'Select a task to configure') }, cancellationToken).\n\t\t\tthen(async (selection) => {\n\t\t\t\tif (cancellationToken.isCancellationRequested) {\n\t\t\t\t\t// canceled when there's only one task\n\t\t\t\t\tconst task = (await entries)[0];\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\tif ((<any>task).task) {\n\t\t\t\t\t\tselection = <TaskQuickPickEntryType>task;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._handleSelection(selection);\n\t\t\t});\n\t}\n\n\tprivate _runConfigureDefaultBuildTask(): void {\n\t\tif (this.schemaVersion === JsonSchemaVersion.V2_0_0) {\n\t\t\tthis.tasks().then((tasks => {\n\t\t\t\tif (tasks.length === 0) {\n\t\t\t\t\tthis._runConfigureTasks();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst entries: QuickPickInput<TaskQuickPickEntryType>[] = [];\n\t\t\t\tlet selectedTask: Task | undefined;\n\t\t\t\tlet selectedEntry: TaskQuickPickEntryType | undefined;\n\t\t\t\tthis._showIgnoredFoldersMessage().then(async () => {\n\t\t\t\t\tconst { globGroupTasks } = await this._getGlobTasks(TaskGroup.Build._id);\n\t\t\t\t\tlet defaultTasks = globGroupTasks;\n\t\t\t\t\tif (!defaultTasks?.length) {\n\t\t\t\t\t\tdefaultTasks = this._getDefaultTasks(tasks, false);\n\t\t\t\t\t}\n\t\t\t\t\tlet defaultBuildTask;\n\t\t\t\t\tif (defaultTasks.length === 1) {\n\t\t\t\t\t\tconst group: string | TaskGroup | undefined = defaultTasks[0].configurationProperties.group;\n\t\t\t\t\t\tif (group) {\n\t\t\t\t\t\t\tif (typeof group === 'string' && group === TaskGroup.Build._id) {\n\t\t\t\t\t\t\t\tdefaultBuildTask = defaultTasks[0];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdefaultBuildTask = defaultTasks[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\t\tif (task === defaultBuildTask) {\n\t\t\t\t\t\t\tconst label = nls.localize('TaskService.defaultBuildTaskExists', '{0} is already marked as the default build task', TaskQuickPick.getTaskLabelWithIcon(task, task.getQualifiedLabel()));\n\t\t\t\t\t\t\tselectedTask = task;\n\t\t\t\t\t\t\tselectedEntry = { label, task, description: this.getTaskDescription(task), detail: this._showDetail() ? task.configurationProperties.detail : undefined };\n\t\t\t\t\t\t\tTaskQuickPick.applyColorStyles(task, selectedEntry, this._themeService);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst entry = { label: TaskQuickPick.getTaskLabelWithIcon(task), task, description: this.getTaskDescription(task), detail: this._showDetail() ? task.configurationProperties.detail : undefined };\n\t\t\t\t\t\t\tTaskQuickPick.applyColorStyles(task, entry, this._themeService);\n\t\t\t\t\t\t\tentries.push(entry);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (selectedEntry) {\n\t\t\t\t\t\tentries.unshift(selectedEntry);\n\t\t\t\t\t}\n\t\t\t\t\tconst tokenSource = new CancellationTokenSource();\n\t\t\t\t\tconst cancellationToken: CancellationToken = tokenSource.token;\n\t\t\t\t\tthis._quickInputService.pick(entries,\n\t\t\t\t\t\t{ placeHolder: nls.localize('TaskService.pickTask', 'Select a task to configure') }, cancellationToken).\n\t\t\t\t\t\tthen(async (entry) => {\n\t\t\t\t\t\t\tif (cancellationToken.isCancellationRequested) {\n\t\t\t\t\t\t\t\t// canceled when there's only one task\n\t\t\t\t\t\t\t\tconst task = (await entries)[0];\n\t\t\t\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t\t\t\tif ((<any>task).task) {\n\t\t\t\t\t\t\t\t\tentry = <TaskQuickPickEntryType>task;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst task: Task | undefined | null = entry && 'task' in entry ? entry.task : undefined;\n\t\t\t\t\t\t\tif ((task === undefined) || (task === null)) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (task === selectedTask && CustomTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.openConfig(task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!InMemoryTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.customize(task, { group: { kind: 'build', isDefault: true } }, true).then(() => {\n\t\t\t\t\t\t\t\t\tif (selectedTask && (task !== selectedTask) && !InMemoryTask.is(selectedTask)) {\n\t\t\t\t\t\t\t\t\t\tthis.customize(selectedTask, { group: 'build' }, false);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\tthis._quickInputService.pick(entries, {\n\t\t\t\t\t\tplaceHolder: nls.localize('TaskService.pickDefaultBuildTask', 'Select the task to be used as the default build task')\n\t\t\t\t\t}).\n\t\t\t\t\t\tthen((entry) => {\n\t\t\t\t\t\t\tconst task: Task | undefined | null = entry && 'task' in entry ? entry.task : undefined;\n\t\t\t\t\t\t\tif ((task === undefined) || (task === null)) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (task === selectedTask && CustomTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.openConfig(task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!InMemoryTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.customize(task, { group: { kind: 'build', isDefault: true } }, true).then(() => {\n\t\t\t\t\t\t\t\t\tif (selectedTask && (task !== selectedTask) && !InMemoryTask.is(selectedTask)) {\n\t\t\t\t\t\t\t\t\t\tthis.customize(selectedTask, { group: 'build' }, false);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}));\n\t\t} else {\n\t\t\tthis._runConfigureTasks();\n\t\t}\n\t}\n\n\tprivate _runConfigureDefaultTestTask(): void {\n\t\tif (this.schemaVersion === JsonSchemaVersion.V2_0_0) {\n\t\t\tthis.tasks().then((tasks => {\n\t\t\t\tif (tasks.length === 0) {\n\t\t\t\t\tthis._runConfigureTasks();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet selectedTask: Task | undefined;\n\t\t\t\tlet selectedEntry: ITaskQuickPickEntry;\n\n\t\t\t\tfor (const task of tasks) {\n\t\t\t\t\tconst taskGroup: TaskGroup | undefined = TaskGroup.from(task.configurationProperties.group);\n\t\t\t\t\tif (taskGroup && taskGroup.isDefault && taskGroup._id === TaskGroup.Test._id) {\n\t\t\t\t\t\tselectedTask = task;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (selectedTask) {\n\t\t\t\t\tselectedEntry = {\n\t\t\t\t\t\tlabel: nls.localize('TaskService.defaultTestTaskExists', '{0} is already marked as the default test task.', selectedTask.getQualifiedLabel()),\n\t\t\t\t\t\ttask: selectedTask,\n\t\t\t\t\t\tdetail: this._showDetail() ? selectedTask.configurationProperties.detail : undefined\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis._showIgnoredFoldersMessage().then(() => {\n\t\t\t\t\tthis._showQuickPick(tasks,\n\t\t\t\t\t\tnls.localize('TaskService.pickDefaultTestTask', 'Select the task to be used as the default test task'), undefined, true, false, selectedEntry).then((entry) => {\n\t\t\t\t\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\t\t\t\t\tif (!task) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (task === selectedTask && CustomTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.openConfig(task);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!InMemoryTask.is(task)) {\n\t\t\t\t\t\t\t\tthis.customize(task, { group: { kind: 'test', isDefault: true } }, true).then(() => {\n\t\t\t\t\t\t\t\t\tif (selectedTask && (task !== selectedTask) && !InMemoryTask.is(selectedTask)) {\n\t\t\t\t\t\t\t\t\t\tthis.customize(selectedTask, { group: 'test' }, false);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}));\n\t\t} else {\n\t\t\tthis._runConfigureTasks();\n\t\t}\n\t}\n\n\tpublic async runShowTasks(): Promise<void> {\n\t\tconst activeTasksPromise: Promise<Task[]> = this.getActiveTasks();\n\t\tconst activeTasks: Task[] = await activeTasksPromise;\n\t\tlet group: string | undefined;\n\t\tif (activeTasks.length === 1) {\n\t\t\tthis._taskSystem!.revealTask(activeTasks[0]);\n\t\t} else if (activeTasks.length && activeTasks.every((task) => {\n\t\t\tif (InMemoryTask.is(task)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!group) {\n\t\t\t\tgroup = task.command.presentation?.group;\n\t\t\t}\n\t\t\treturn task.command.presentation?.group && (task.command.presentation.group === group);\n\t\t})) {\n\t\t\tthis._taskSystem!.revealTask(activeTasks[0]);\n\t\t} else {\n\t\t\tthis._showQuickPick(activeTasksPromise,\n\t\t\t\tnls.localize('TaskService.pickShowTask', 'Select the task to show its output'),\n\t\t\t\t{\n\t\t\t\t\tlabel: nls.localize('TaskService.noTaskIsRunning', 'No task is running'),\n\t\t\t\t\ttask: null\n\t\t\t\t},\n\t\t\t\tfalse, true\n\t\t\t).then((entry) => {\n\t\t\t\tconst task: Task | undefined | null = entry ? entry.task : undefined;\n\t\t\t\tif (task === undefined || task === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._taskSystem!.revealTask(task);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async _createTasksDotOld(folder: IWorkspaceFolder): Promise<[URI, URI] | undefined> {\n\t\tconst tasksFile = folder.toResource('.vscode/tasks.json');\n\t\tif (await this._fileService.exists(tasksFile)) {\n\t\t\tconst oldFile = tasksFile.with({ path: `${tasksFile.path}.old` });\n\t\t\tawait this._fileService.copy(tasksFile, oldFile, true);\n\t\t\treturn [oldFile, tasksFile];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate _upgradeTask(task: Task, suppressTaskName: boolean, globalConfig: { windows?: ICommandUpgrade; osx?: ICommandUpgrade; linux?: ICommandUpgrade }): TaskConfig.ICustomTask | TaskConfig.IConfiguringTask | undefined {\n\t\tif (!CustomTask.is(task)) {\n\t\t\treturn;\n\t\t}\n\t\tconst configElement: ITaskConfig = {\n\t\t\tlabel: task._label\n\t\t};\n\t\tconst oldTaskTypes = new Set(['gulp', 'jake', 'grunt']);\n\t\tif (Types.isString(task.command.name) && oldTaskTypes.has(task.command.name)) {\n\t\t\tconfigElement.type = task.command.name;\n\t\t\tconfigElement.task = task.command.args![0];\n\t\t} else {\n\t\t\tif (task.command.runtime === RuntimeType.Shell) {\n\t\t\t\tconfigElement.type = RuntimeType.toString(RuntimeType.Shell);\n\t\t\t}\n\t\t\tif (task.command.name && !suppressTaskName && !globalConfig.windows?.command && !globalConfig.osx?.command && !globalConfig.linux?.command) {\n\t\t\t\tconfigElement.command = task.command.name;\n\t\t\t} else if (suppressTaskName) {\n\t\t\t\tconfigElement.command = task._source.config.element.command;\n\t\t\t}\n\t\t\tif (task.command.args && (!Array.isArray(task.command.args) || (task.command.args.length > 0))) {\n\t\t\t\tif (!globalConfig.windows?.args && !globalConfig.osx?.args && !globalConfig.linux?.args) {\n\t\t\t\t\tconfigElement.args = task.command.args;\n\t\t\t\t} else {\n\t\t\t\t\tconfigElement.args = task._source.config.element.args;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (task.configurationProperties.presentation) {\n\t\t\tconfigElement.presentation = task.configurationProperties.presentation;\n\t\t}\n\t\tif (task.configurationProperties.isBackground) {\n\t\t\tconfigElement.isBackground = task.configurationProperties.isBackground;\n\t\t}\n\t\tif (task.configurationProperties.problemMatchers) {\n\t\t\tconfigElement.problemMatcher = task._source.config.element.problemMatcher;\n\t\t}\n\t\tif (task.configurationProperties.group) {\n\t\t\tconfigElement.group = task.configurationProperties.group;\n\t\t}\n\n\t\ttask._source.config.element = configElement;\n\t\tconst tempTask = new CustomTask(task._id, task._source, task._label, task.type, task.command, task.hasDefinedMatchers, task.runOptions, task.configurationProperties);\n\t\tconst configTask = this._createCustomizableTask(tempTask);\n\t\tif (configTask) {\n\t\t\treturn configTask;\n\t\t}\n\t\treturn;\n\t}\n\n\tprivate async _upgrade(): Promise<void> {\n\t\tif (this.schemaVersion === JsonSchemaVersion.V2_0_0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._workspaceTrustManagementService.isWorkspaceTrusted()) {\n\t\t\tthis._register(Event.once(this._workspaceTrustManagementService.onDidChangeTrust)(isTrusted => {\n\t\t\t\tif (isTrusted) {\n\t\t\t\t\tthis._upgrade();\n\t\t\t\t}\n\t\t\t}));\n\t\t\treturn;\n\t\t}\n\n\t\tconst tasks = await this._getGroupedTasks();\n\t\tconst fileDiffs: [URI, URI][] = [];\n\t\tfor (const folder of this.workspaceFolders) {\n\t\t\tconst diff = await this._createTasksDotOld(folder);\n\t\t\tif (diff) {\n\t\t\t\tfileDiffs.push(diff);\n\t\t\t}\n\t\t\tif (!diff) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst configTasks: (TaskConfig.ICustomTask | TaskConfig.IConfiguringTask)[] = [];\n\t\t\tconst suppressTaskName = !!this._configurationService.getValue(TasksSchemaProperties.SuppressTaskName, { resource: folder.uri });\n\t\t\tconst globalConfig = {\n\t\t\t\twindows: <ICommandUpgrade>this._configurationService.getValue(TasksSchemaProperties.Windows, { resource: folder.uri }),\n\t\t\t\tosx: <ICommandUpgrade>this._configurationService.getValue(TasksSchemaProperties.Osx, { resource: folder.uri }),\n\t\t\t\tlinux: <ICommandUpgrade>this._configurationService.getValue(TasksSchemaProperties.Linux, { resource: folder.uri })\n\t\t\t};\n\t\t\ttasks.get(folder).forEach(task => {\n\t\t\t\tconst configTask = this._upgradeTask(task, suppressTaskName, globalConfig);\n\t\t\t\tif (configTask) {\n\t\t\t\t\tconfigTasks.push(configTask);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._taskSystem = undefined;\n\t\t\tthis._workspaceTasksPromise = undefined;\n\t\t\tawait this._writeConfiguration(folder, 'tasks.tasks', configTasks);\n\t\t\tawait this._writeConfiguration(folder, 'tasks.version', '2.0.0');\n\t\t\tif (this._configurationService.getValue(TasksSchemaProperties.ShowOutput, { resource: folder.uri })) {\n\t\t\t\tawait this._configurationService.updateValue(TasksSchemaProperties.ShowOutput, undefined, { resource: folder.uri });\n\t\t\t}\n\t\t\tif (this._configurationService.getValue(TasksSchemaProperties.IsShellCommand, { resource: folder.uri })) {\n\t\t\t\tawait this._configurationService.updateValue(TasksSchemaProperties.IsShellCommand, undefined, { resource: folder.uri });\n\t\t\t}\n\t\t\tif (this._configurationService.getValue(TasksSchemaProperties.SuppressTaskName, { resource: folder.uri })) {\n\t\t\t\tawait this._configurationService.updateValue(TasksSchemaProperties.SuppressTaskName, undefined, { resource: folder.uri });\n\t\t\t}\n\t\t}\n\t\tthis._updateSetup();\n\n\t\tthis._notificationService.prompt(Severity.Warning,\n\t\t\tfileDiffs.length === 1 ?\n\t\t\t\tnls.localize('taskService.upgradeVersion', \"The deprecated tasks version 0.1.0 has been removed. Your tasks have been upgraded to version 2.0.0. Open the diff to review the upgrade.\")\n\t\t\t\t: nls.localize('taskService.upgradeVersionPlural', \"The deprecated tasks version 0.1.0 has been removed. Your tasks have been upgraded to version 2.0.0. Open the diffs to review the upgrade.\"),\n\t\t\t[{\n\t\t\t\tlabel: fileDiffs.length === 1 ? nls.localize('taskService.openDiff', \"Open diff\") : nls.localize('taskService.openDiffs', \"Open diffs\"),\n\t\t\t\trun: async () => {\n\t\t\t\t\tfor (const upgrade of fileDiffs) {\n\t\t\t\t\t\tawait this._editorService.openEditor({\n\t\t\t\t\t\t\toriginal: { resource: upgrade[0] },\n\t\t\t\t\t\t\tmodified: { resource: upgrade[1] }\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t);\n\t}\n}\n"]}