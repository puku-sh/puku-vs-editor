{"version":3,"sources":["vs/workbench/contrib/codeEditor/browser/inspectEditorTokens/inspectEditorTokens.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;AAEhG,OAAO,2BAA2B,CAAC;AACnC,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAC7C,OAAO,KAAK,GAAG,MAAM,oCAAoC,CAAC;AAE1D,OAAO,EAAE,KAAK,EAAE,MAAM,qCAAqC,CAAC;AAE5D,OAAO,EAAE,UAAU,EAAE,MAAM,yCAAyC,CAAC;AAErE,OAAO,EAAE,YAAY,EAAoB,oBAAoB,EAAE,0BAA0B,EAAmC,MAAM,mDAAmD,CAAC;AAEtL,OAAO,EAAE,KAAK,EAAE,MAAM,4CAA4C,CAAC;AAInE,OAAO,EAAyC,aAAa,EAAE,MAAM,wDAAwD,CAAC;AAC9H,OAAO,EAAE,gBAAgB,EAAE,MAAM,oDAAoD,CAAC;AACtF,OAAO,EAAE,oBAAoB,EAAE,MAAM,6DAA6D,CAAC;AACnG,OAAO,EAAE,qBAAqB,EAAE,MAAM,kDAAkD,CAAC;AACzF,OAAO,EAAE,4BAA4B,EAAE,MAAM,sEAAsE,CAAC;AAEpH,OAAO,EAAE,sBAAsB,EAAE,MAAM,6DAA6D,CAAC;AACrG,OAAO,EAAE,uBAAuB,EAAE,MAAM,4CAA4C,CAAC;AAErF,OAAO,EAAE,iBAAiB,EAA8B,MAAM,qEAAqE,CAAC;AACpI,OAAO,EAAE,qBAAqB,EAAE,MAAM,+DAA+D,CAAC;AACtG,OAAO,EAAE,gCAAgC,EAAsC,MAAM,6EAA6E,CAAC;AACnK,OAAO,EAAE,OAAO,EAAE,MAAM,uCAAuC,CAAC;AAChE,OAAO,EAAE,wBAAwB,EAAE,MAAM,2DAA2D,CAAC;AAErG,OAAO,EAAE,4BAA4B,EAAE,MAAM,sFAAsF,CAAC;AAIpI,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;AAET,IAAM,6BAA6B,GAAnC,MAAM,6BAA8B,SAAQ,UAAU;;aAErC,OAAE,GAAG,oCAAH,AAAuC,CAAC;IAE1D,MAAM,CAAC,GAAG,CAAC,MAAmB;QACpC,OAAO,MAAM,CAAC,eAAe,CAAgC,+BAA6B,CAAC,EAAE,CAAC,CAAC;IAChG,CAAC;IAWD,YACC,MAAmB,EACW,eAA6C,EACzD,eAAiC,EAC3B,YAAoC,EACtC,mBAAyC,EACxC,oBAA2C,EACxC,uBAAiD;QAE3E,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,gBAAgB,GAAG,eAAe,CAAC;QACxC,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;QAClC,IAAI,CAAC,gBAAgB,GAAG,eAAe,CAAC;QACxC,IAAI,CAAC,oBAAoB,GAAG,mBAAmB,CAAC;QAChD,IAAI,CAAC,qBAAqB,GAAG,oBAAoB,CAAC;QAClD,IAAI,CAAC,wBAAwB,GAAG,uBAAuB,CAAC;QACxD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QAEpB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAClE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,2BAAmB,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IAC1F,CAAC;IAEe,OAAO;QACtB,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,KAAK,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IAEM,MAAM;QACZ,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YAClB,OAAO;QACR,CAAC;QACD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;YAC9B,OAAO;QACR,CAAC;QACD,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,MAAM,KAAK,OAAO,CAAC,kBAAkB,EAAE,CAAC;YACvE,uBAAuB;YACvB,OAAO;QACR,CAAC;QACD,IAAI,CAAC,OAAO,GAAG,IAAI,yBAAyB,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;IACpN,CAAC;IAEM,IAAI;QACV,IAAI,IAAI,CAAC,OAAO,EAAE,CAAC;YAClB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;YACvB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACrB,CAAC;IACF,CAAC;IAEM,MAAM;QACZ,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACnB,IAAI,CAAC,MAAM,EAAE,CAAC;QACf,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,IAAI,EAAE,CAAC;QACb,CAAC;IACF,CAAC;;AAzEW,6BAA6B;IAmBvC,WAAA,4BAA4B,CAAA;IAC5B,WAAA,gBAAgB,CAAA;IAChB,WAAA,sBAAsB,CAAA;IACtB,WAAA,oBAAoB,CAAA;IACpB,WAAA,qBAAqB,CAAA;IACrB,WAAA,wBAAwB,CAAA;GAxBd,6BAA6B,CA0EzC;;AAED,MAAM,mBAAoB,SAAQ,YAAY;IAE7C;QACC,KAAK,CAAC;YACL,EAAE,EAAE,+BAA+B;YACnC,KAAK,EAAE,GAAG,CAAC,SAAS,CAAC,IAAqB,EAAE,6CAA6C,CAAC;YAC1F,YAAY,EAAE,SAAS;SACvB,CAAC,CAAC;IACJ,CAAC;IAEM,GAAG,CAAC,QAA0B,EAAE,MAAmB;QACzD,MAAM,UAAU,GAAG,6BAA6B,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAC7D,UAAU,EAAE,MAAM,EAAE,CAAC;IACtB,CAAC;CACD;AA0BD,SAAS,eAAe,CAAC,SAAiB;IACzC,IAAI,SAAS,CAAC,MAAM,GAAG,EAAE,EAAE,CAAC;QAC3B,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;IACrF,CAAC;IACD,IAAI,MAAM,GAAW,EAAE,CAAC;IACxB,KAAK,IAAI,SAAS,GAAG,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,MAAM,EAAE,SAAS,GAAG,GAAG,EAAE,SAAS,EAAE,EAAE,CAAC;QAC9E,MAAM,QAAQ,GAAG,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QACjD,QAAQ,QAAQ,EAAE,CAAC;YAClB;gBACC,MAAM,IAAI,QAAQ,CAAC,CAAC,SAAS;gBAC7B,MAAM;YAEP;gBACC,MAAM,IAAI,QAAQ,CAAC,CAAC,WAAW;gBAC/B,MAAM;YAEP;gBACC,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC1C,CAAC;IACF,CAAC;IACD,OAAO,MAAM,CAAC;AACf,CAAC;AAID,MAAM,yBAA0B,SAAQ,UAAU;aAEzB,QAAG,GAAG,0CAAH,AAA6C,CAAC;IAiBzE,YACC,MAAyB,EACzB,eAA6C,EAC7C,eAAiC,EACjC,YAAoC,EACpC,mBAAyC,EACzC,oBAA2C,EAC3C,uBAAiD;QAEjD,KAAK,EAAE,CAAC;QAxBT,4CAA4C;QAC5B,wBAAmB,GAAG,IAAI,CAAC;QAwB1C,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,gBAAgB,GAAG,eAAe,CAAC;QACxC,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;QAClC,IAAI,CAAC,gBAAgB,GAAG,eAAe,CAAC;QACxC,IAAI,CAAC,oBAAoB,GAAG,mBAAmB,CAAC;QAChD,IAAI,CAAC,qBAAqB,GAAG,oBAAoB,CAAC;QAClD,IAAI,CAAC,wBAAwB,GAAG,uBAAuB,CAAC;QACxD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;QACtC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC9C,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,sBAAsB,CAAC;QACjD,IAAI,CAAC,sCAAsC,GAAG,IAAI,uBAAuB,EAAE,CAAC;QAC5E,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC;QAC/C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;QAC9G,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;QACxG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,oBAAoB,CAAC,qCAAqC,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;QACpL,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;IACrC,CAAC;IAEe,OAAO;QACtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,sCAAsC,CAAC,MAAM,EAAE,CAAC;QACrD,KAAK,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IAEM,KAAK;QACX,OAAO,yBAAyB,CAAC,GAAG,CAAC;IACtC,CAAC;IAEO,aAAa,CAAC,QAAkB;QACvC,MAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC;QACnF,MAAM,cAAc,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC;QAC7D,MAAM,OAAO,GAAI,IAAI,CAAC,MAAM,CAAC,YAA0C,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;QACrF,MAAM,mBAAmB,GAAG,OAAO,YAAY,4BAA4B,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC;QAElG,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC7B,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,IAA+B,EAAE,IAAY,CAAC,CAAC,CAAC,CAAC;QAEhH,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,cAAc,CAAC,EAAE,EAAE;YACzE,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;gBACtB,OAAO;YACR,CAAC;YACD,MAAM,cAAc,GAAG,mBAAmB,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;YACvD,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,cAAc,EAAE,cAAc,EAAE,QAAQ,CAAC,CAAC;YACjE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC,KAAK,GAAG,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC;YAC/F,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QACxC,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;YACV,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAEpC,UAAU,CAAC,GAAG,EAAE;gBACf,6BAA6B,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,CAAC;YACzD,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IAEJ,CAAC;IAEO,0BAA0B;QACjC,MAAM,OAAO,GAAG,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAqC,gCAAgC,EAAE,EAAE,kBAAkB,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,EAAE,OAAO,CAAC;QACnN,IAAI,OAAO,OAAO,KAAK,SAAS,EAAE,CAAC;YAClC,OAAO,OAAO,CAAC;QAChB,CAAC;QACD,OAAO,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC,oBAAoB,CAAC;IAChE,CAAC;IAEO,QAAQ,CAAC,OAAwB,EAAE,cAA2C,EAAE,IAAgC,EAAE,QAAkB;QAC3I,MAAM,iBAAiB,GAAG,OAAO,IAAI,IAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;QAClF,MAAM,iBAAiB,GAAG,cAAc,IAAI,IAAI,CAAC,2BAA2B,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;QACvG,MAAM,mBAAmB,GAAG,IAAI,IAAI,IAAI,CAAC,6BAA6B,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QACvF,IAAI,CAAC,iBAAiB,IAAI,CAAC,iBAAiB,IAAI,CAAC,mBAAmB,EAAE,CAAC;YACtE,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,0CAA0C,CAAC,CAAC;YACrE,OAAO;QACR,CAAC;QAED,MAAM,UAAU,GAAG,iBAAiB,EAAE,QAAQ,CAAC;QAC/C,MAAM,WAAW,GAAG,iBAAiB,EAAE,QAAQ,CAAC;QAEhD,MAAM,YAAY,GAAG,iBAAiB,IAAI,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAC;QAChH,MAAM,WAAW,GAAG,iBAAiB,IAAI,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,iBAAiB,CAAC,KAAK,CAAC,UAAU,EAAE,iBAAiB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC1L,MAAM,cAAc,GAAG,iBAAiB,IAAI,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;QACvG,MAAM,aAAa,GAAG,iBAAiB,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,QAAQ,GAAG,iBAAiB,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAEnH,MAAM,SAAS,GAAG,YAAY,IAAI,WAAW,IAAI,EAAE,CAAC;QACpD,MAAM,WAAW,GAAG,cAAc,IAAI,aAAa,IAAI,CAAC,CAAC;QAEzD,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EACtB,CAAC,CAAC,cAAc,EAAE,SAAS,EAC1B,SAAS,EACT,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,WAAW,IAAI,WAAW,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;QACpG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,2BAA2B,EAAE,EAAE,OAAO,EAAE,YAAY,EAAE,CAAC,CAAC,CAAC;QACrF,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,0BAA0B,EAAE,SAAS,EAChE,CAAC,CAAC,OAAO,EAAE,SAAS,EACnB,CAAC,CAAC,IAAI,EAAE,SAAS,EAChB,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,UAAU,CAAC,EAC/C,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,IAAI,EAAE,CAAC,CACnE,EACD,CAAC,CAAC,IAAI,EAAE,SAAS,EAChB,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,qBAA+B,CAAC,EACpE,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,SAAS,mCAA2B,CAAC,CAAC,CAChH,EACD,GAAG,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,UAAU,CAAC,CAChD,CACD,CAAC,CAAC;QAEH,IAAI,iBAAiB,EAAE,CAAC;YACvB,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAAC;YAC1D,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,0BAA0B,EAAE,SAAS,CAAC,CAAC,CAAC;YAClF,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,SAAS,EACnD,CAAC,CAAC,IAAI,EAAE,SAAS,EAChB,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,qBAA+B,CAAC,EACpE,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAC7D,CACD,CAAC,CAAC;YACH,IAAI,iBAAiB,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;gBACxC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,WAAW,CAAC,EAChD,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,iBAAiB,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAC5E,CAAC,CAAC;YACJ,CAAC;YACD,IAAI,iBAAiB,CAAC,QAAQ,EAAE,CAAC;gBAChC,MAAM,UAAU,GAA6B,CAAC,YAAY,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,eAAe,CAAC,CAAC;gBAC5G,MAAM,oBAAoB,GAAiC,EAAE,CAAC;gBAC9D,MAAM,YAAY,GAAG,IAAI,KAAK,EAAyC,CAAC,CAAC,qBAAqB;gBAC9F,6EAA6E;gBAC7E,KAAK,MAAM,QAAQ,IAAI,UAAU,EAAE,CAAC;oBACnC,IAAI,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE,CAAC;wBACxD,MAAM,UAAU,GAAG,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;wBAC3D,MAAM,QAAQ,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;wBACxE,MAAM,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;wBACzF,IAAI,UAAU,GAAG,oBAAoB,CAAC,WAAW,CAAC,CAAC;wBACnD,IAAI,CAAC,UAAU,EAAE,CAAC;4BACjB,oBAAoB,CAAC,WAAW,CAAC,GAAG,UAAU,GAAG,EAAE,CAAC;4BACpD,YAAY,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC,CAAC;wBAC5C,CAAC;wBACD,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAC3B,CAAC;gBACF,CAAC;gBACD,KAAK,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,IAAI,YAAY,EAAE,CAAC;oBACpD,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,oBAAoB,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EACjF,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,QAAQ,CAAC,CAClD,CAAC,CAAC;gBACJ,CAAC;YACF,CAAC;QACF,CAAC;QAED,IAAI,iBAAiB,EAAE,CAAC;YACvB,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC;YACjD,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAAC;YAC1D,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC;YACvE,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAE5C,IAAI,WAAW,IAAI,WAAW,KAAK,SAAS,EAAE,CAAC;gBAC9C,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,gBAA0B,CAAC,EAC/D,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,WAAW,KAAK,WAAW,CAAC,MAAM,GAAG,CAAC,CAC/E,CAAC,CAAC;YACJ,CAAC;YACD,MAAM,MAAM,GAAG,IAAI,KAAK,EAAwB,CAAC;YACjD,KAAK,IAAI,CAAC,GAAG,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACrE,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC/C,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;oBACX,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBACtB,CAAC;YACF,CAAC;YACD,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,iBAA2B,CAAC,EAChE,CAAC,CAAC,2CAA2C,EAAE,SAAS,EAAE,GAAG,MAAM,CAAC,CACpE,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,qBAAqB,CAAC,KAAK,EAAE,iBAAiB,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YACzF,MAAM,aAAa,GAAG,iBAAiB,EAAE,QAAQ,EAAE,UAAU,CAAC;YAC9D,IAAI,YAAY,EAAE,CAAC;gBAClB,IAAI,aAAa,KAAK,iBAAiB,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;oBAC7D,IAAI,QAAQ,GAAG,CAAC,CAAC,yBAAyB,EAAE,SAAS,EACpD,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;oBACvF,IAAI,aAAa,EAAE,CAAC;wBACnB,QAAQ,GAAG,CAAC,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;oBACxC,CAAC;oBACD,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,YAAY,CAAC,EACjD,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,QAAQ,CAAC,CAC/C,CAAC,CAAC;gBACJ,CAAC;YACF,CAAC;iBAAM,IAAI,CAAC,aAAa,EAAE,CAAC;gBAC3B,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,YAAY,CAAC,EACjD,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,mBAA6B,CAAC,CACpE,CAAC,CAAC;YACJ,CAAC;QACF,CAAC;QAED,IAAI,mBAAmB,EAAE,CAAC;YACzB,MAAM,aAAa,GAAG,mBAAmB,CAAC,mBAAmB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAC1E,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAAC;YAC1D,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC;YACvE,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAE5C,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,qBAAqB,aAAa,CAAC,EAAE,EAAY,CAAC,EACtF,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,aAAa,CAAC,IAAI,EAAE,CAAC,CAC9D,CAAC,CAAC;YACH,MAAM,MAAM,GAAG,IAAI,KAAK,EAAwB,CAAC;YACjD,IAAI,CAAC,GAAG,mBAAmB,CAAC,MAAM,GAAG,CAAC,CAAC;YACvC,IAAI,IAAI,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC;YAClC,OAAO,IAAI,CAAC,MAAM,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC7B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACvB,IAAI,GAAG,IAAI,CAAC,MAAM,IAAI,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC/C,IAAI,IAAI,EAAE,CAAC;oBACV,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBACtB,CAAC;YACF,CAAC;YAED,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,kBAA4B,CAAC,EACjE,CAAC,CAAC,2CAA2C,EAAE,SAAS,EAAE,GAAG,MAAM,CAAC,CACpE,CAAC,CAAC;YAEH,MAAM,mBAAmB,GAAK,IAAI,CAAC,MAAM,CAAC,YAA0C,CAAC,MAAM,CAAC,GAAG,EAAmC,CAAC,gBAAgB,CAAC,GAAG,EAAE,CAAC;YAC1J,MAAM,QAAQ,GAAG,mBAAmB,EAAE,iBAAiB,CAAC,QAAQ,CAAC,UAAU,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC9F,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBACrC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,SAAS,EAClC,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,YAAY,CAAC,EACjD,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAC9E,CAAC,CAAC;YACJ,CAAC;QACF,CAAC;IACF,CAAC;IAEO,eAAe,CAAC,QAA2B,EAAE,EAAqB;QACzE,MAAM,QAAQ,GAAG,IAAI,KAAK,EAAwB,CAAC;QAEnD,SAAS,MAAM,CAAC,QAAqC;YACpD,MAAM,KAAK,GAAG,QAAQ,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;YACrD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;gBACzB,MAAM,aAAa,GAAG,QAAQ,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAC,EAAE,CAAC;gBAC1E,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,SAAS,EAC9B,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,QAAQ,CAAC,EAC7C,CAAC,CAAC,yBAAyB,aAAa,EAAE,EAAE,SAAS,EAAE,KAAK,CAAC,CAC7D,CAAC,CAAC;YACJ,CAAC;YACD,OAAO,KAAK,CAAC;QACd,CAAC;QAED,MAAM,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;QACxC,MAAM,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;QACxC,IAAI,UAAU,IAAI,UAAU,EAAE,CAAC;YAC9B,MAAM,eAAe,GAAG,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,eAAe,GAAG,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;YAC/F,IAAI,eAAe,CAAC,QAAQ,EAAE,EAAE,CAAC;gBAChC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,SAAS,EAC9B,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,gBAA0B,CAAC,EAC/D,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,eAAe,CAAC,gBAAgB,CAAC,eAAe,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAC/H,CAAC,CAAC;YACJ,CAAC;iBAAM,CAAC;gBACP,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,SAAS,EAC9B,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,8EAAwF,CAAC,EAC7H,CAAC,CAAC,uBAAuB,CAAC,CAC1B,CAAC,CAAC;YACJ,CAAC;QACF,CAAC;QAED,MAAM,eAAe,GAAG,IAAI,KAAK,EAAwB,CAAC;QAE1D,SAAS,QAAQ,CAAC,GAAsD;YACvE,IAAI,KAAuC,CAAC;YAC5C,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC/B,KAAK,GAAG,CAAC,CAAC,4BAA4B,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;YACzD,CAAC;iBAAM,IAAI,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC1B,KAAK,GAAG,GAAG,CAAC;YACb,CAAC;YACD,IAAI,KAAK,EAAE,CAAC;gBACX,IAAI,eAAe,CAAC,MAAM,EAAE,CAAC;oBAC5B,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC3B,CAAC;gBACD,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC7B,CAAC;QACF,CAAC;QACD,QAAQ,CAAC,MAAM,CAAC,CAAC;QACjB,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACnB,QAAQ,CAAC,WAAW,CAAC,CAAC;QACtB,QAAQ,CAAC,eAAe,CAAC,CAAC;QAC1B,IAAI,eAAe,CAAC,MAAM,EAAE,CAAC;YAC5B,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,SAAS,EAC9B,CAAC,CAAC,qBAAqB,EAAE,SAAS,EAAE,YAAsB,CAAC,EAC3D,CAAC,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,eAAe,CAAC,CACzD,CAAC,CAAC;QACJ,CAAC;QACD,OAAO,QAAQ,CAAC;IACjB,CAAC;IAEO,eAAe,CAAC,QAAgB;QACvC,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC,aAAa,CAAC;QAClE,MAAM,UAAU,GAAG,aAAa,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACzD,MAAM,SAAS,GAAG,aAAa,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QACvD,MAAM,SAAS,GAAG,aAAa,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QACvD,MAAM,UAAU,GAAG,aAAa,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACzD,MAAM,UAAU,GAAG,aAAa,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACzD,OAAO;YACN,UAAU,EAAE,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,gBAAgB,CAAC,UAAU,CAAC;YAC9E,SAAS,EAAE,SAAS;YACpB,IAAI,EAAE,CAAC,SAAS,yBAAiB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS;YACrD,MAAM,EAAE,CAAC,SAAS,2BAAmB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS;YACzD,SAAS,EAAE,CAAC,SAAS,8BAAsB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS;YAC/D,aAAa,EAAE,CAAC,SAAS,kCAA0B,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS;YACvE,UAAU,EAAE,QAAQ,CAAC,UAAU,CAAC;YAChC,UAAU,EAAE,QAAQ,CAAC,UAAU,CAAC;SAChC,CAAC;IACH,CAAC;IAEO,kBAAkB,CAAC,SAA4B;QACtD,QAAQ,SAAS,EAAE,CAAC;YACnB,oCAA4B,CAAC,CAAC,OAAO,OAAO,CAAC;YAC7C,sCAA8B,CAAC,CAAC,OAAO,SAAS,CAAC;YACjD,qCAA6B,CAAC,CAAC,OAAO,QAAQ,CAAC;YAC/C,oCAA4B,CAAC,CAAC,OAAO,OAAO,CAAC;YAC7C,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC;QACtB,CAAC;IACF,CAAC;IAEO,oBAAoB,CAAC,OAAiB,EAAE,QAAkB;QACjE,MAAM,UAAU,GAAG,QAAQ,CAAC,UAAU,CAAC;QACvC,MAAM,eAAe,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;QAEtE,MAAM,mBAAmB,GAAG,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE,eAAe,CAAC,CAAC;QAC1G,MAAM,mBAAmB,GAAG,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE,eAAe,CAAC,CAAC;QAE3G,IAAI,WAAW,GAAG,CAAC,CAAC;QACpB,KAAK,IAAI,CAAC,GAAG,mBAAmB,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;YACjE,MAAM,CAAC,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACxC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,CAAC;gBACzC,WAAW,GAAG,CAAC,CAAC;gBAChB,MAAM;YACP,CAAC;QACF,CAAC;QAED,IAAI,WAAW,GAAG,CAAC,CAAC;QACpB,KAAK,IAAI,CAAC,GAAG,CAAC,mBAAmB,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;YACrE,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;gBACjE,WAAW,GAAG,CAAC,CAAC;gBAChB,MAAM;YACP,CAAC;QACF,CAAC;QAED,OAAO;YACN,KAAK,EAAE,mBAAmB,CAAC,MAAM,CAAC,WAAW,CAAC;YAC9C,QAAQ,EAAE,IAAI,CAAC,eAAe,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;SAClF,CAAC;IACH,CAAC;IAEO,mBAAmB,CAAC,OAAiB,EAAE,UAAkB;QAChE,IAAI,KAAK,GAAsB,IAAI,CAAC;QAEpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE,CAAC;YACrC,MAAM,kBAAkB,GAAG,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;YACtF,KAAK,GAAG,kBAAkB,CAAC,SAAS,CAAC;QACtC,CAAC;QAED,OAAO,KAAK,CAAC;IACd,CAAC;IAEO,gBAAgB,CAAC,KAAU;QAClC,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,CAAC;IAC5B,CAAC;IAEO,KAAK,CAAC,sBAAsB,CAAC,QAAkB;QACtD,IAAI,CAAC,IAAI,CAAC,0BAA0B,EAAE,EAAE,CAAC;YACxC,OAAO,IAAI,CAAC;QACb,CAAC;QAED,MAAM,cAAc,GAAG,IAAI,CAAC,wBAAwB,CAAC,8BAA8B,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACzG,IAAI,cAAc,CAAC,MAAM,EAAE,CAAC;YAC3B,MAAM,QAAQ,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC;YACnC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,6BAA6B,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,sCAAsC,CAAC,KAAK,CAAC,CAAC,CAAC;YACnJ,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;gBACnC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC;YACjD,CAAC;QACF,CAAC;QACD,MAAM,mBAAmB,GAAG,IAAI,CAAC,wBAAwB,CAAC,mCAAmC,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACnH,IAAI,mBAAmB,CAAC,MAAM,EAAE,CAAC;YAChC,MAAM,QAAQ,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC;YACxC,MAAM,UAAU,GAAG,QAAQ,CAAC,UAAU,CAAC;YACvC,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,UAAU,EAAE,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC;YAC7F,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,kCAAkC,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,sCAAsC,CAAC,KAAK,CAAC,CAAC,CAAC;YACzJ,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;gBACnC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC;YACjD,CAAC;QACF,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAEO,2BAA2B,CAAC,cAAoC,EAAE,GAAa;QACtF,MAAM,SAAS,GAAG,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC;QAC7C,MAAM,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC;QACpD,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAI,aAAa,GAAG,CAAC,CAAC;QACtB,MAAM,OAAO,GAAG,GAAG,CAAC,UAAU,GAAG,CAAC,EAAE,YAAY,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,sBAAsB;QACzF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC;YAC9C,MAAM,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAC5I,MAAM,IAAI,GAAG,QAAQ,GAAG,SAAS,CAAC,CAAC,UAAU;YAC7C,MAAM,SAAS,GAAG,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,UAAU;YACrF,IAAI,OAAO,KAAK,IAAI,IAAI,SAAS,IAAI,YAAY,IAAI,YAAY,GAAG,SAAS,GAAG,GAAG,EAAE,CAAC;gBACrF,MAAM,IAAI,GAAG,cAAc,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,yBAAyB,CAAC;gBACpF,MAAM,SAAS,GAAG,EAAE,CAAC;gBACrB,IAAI,WAAW,GAAG,MAAM,CAAC;gBACzB,KAAK,IAAI,aAAa,GAAG,CAAC,EAAE,WAAW,GAAG,CAAC,IAAI,aAAa,GAAG,cAAc,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,aAAa,EAAE,EAAE,CAAC;oBAC7H,IAAI,WAAW,GAAG,CAAC,EAAE,CAAC;wBACrB,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC;oBACrE,CAAC;oBACD,WAAW,GAAG,WAAW,IAAI,CAAC,CAAC;gBAChC,CAAC;gBACD,IAAI,WAAW,GAAG,CAAC,EAAE,CAAC;oBACrB,SAAS,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;gBAC3C,CAAC;gBACD,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,GAAG,CAAC,EAAE,SAAS,GAAG,CAAC,EAAE,IAAI,GAAG,CAAC,EAAE,SAAS,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;gBAChF,MAAM,WAAW,GAAG,EAAE,CAAC;gBACvB,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC,aAAa,CAAC;gBAClE,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,EAAoB,CAAC;gBACnE,MAAM,UAAU,GAAG,KAAK,CAAC,qBAAqB,CAAC,IAAI,EAAE,SAAS,EAAE,eAAe,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;gBAEpG,IAAI,QAAQ,GAAiC,SAAS,CAAC;gBACvD,IAAI,UAAU,EAAE,CAAC;oBAChB,QAAQ,GAAG;wBACV,UAAU,EAAE,SAAS;wBACrB,SAAS,iCAAyB;wBAClC,IAAI,EAAE,UAAU,EAAE,IAAI;wBACtB,MAAM,EAAE,UAAU,EAAE,MAAM;wBAC1B,SAAS,EAAE,UAAU,EAAE,SAAS;wBAChC,aAAa,EAAE,UAAU,EAAE,aAAa;wBACxC,UAAU,EAAE,QAAQ,CAAC,UAAU,EAAE,UAAU,wBAAgB,CAAC;wBAC5D,UAAU,EAAE,SAAS;qBACrB,CAAC;gBACH,CAAC;gBAED,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,EAAE,CAAC;YAC1D,CAAC;YACD,QAAQ,GAAG,IAAI,CAAC;YAChB,aAAa,GAAG,SAAS,CAAC;QAC3B,CAAC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAEO,oBAAoB,CAAC,MAA6B,EAAE,GAAa;QACxE,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAC5C,MAAM,CAAC,cAAc,EAAE,CAAC;QACxB,IAAI,OAAO,GAAY,KAAK,CAAC;QAC7B,IAAI,YAAY,GAA2B,IAAI,CAAC;QAChD,GAAG,CAAC;YACH,IAAI,MAAM,CAAC,WAAW,CAAC,UAAU,IAAI,MAAM,IAAI,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;gBACrF,OAAO,GAAG,IAAI,CAAC;gBACf,YAAY,GAAG,MAAM,CAAC,WAAW,CAAC;YACnC,CAAC;iBAAM,CAAC;gBACP,OAAO,GAAG,KAAK,CAAC;YACjB,CAAC;QACF,CAAC,QAAQ,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE;QACvE,OAAO,YAAY,CAAC;IACrB,CAAC;IAEO,6BAA6B,CAAC,cAA0C,EAAE,GAAa;QAC9F,MAAM,KAAK,GAAsB,EAAE,CAAC;QAEpC,IAAI,IAAI,GAAG,cAAc,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;QACtC,OAAO,IAAI,EAAE,CAAC;YACb,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAC3B,MAAM,IAAI,GAAG,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;YACpD,MAAM,CAAC,MAAM,EAAE,CAAC;YAChB,IAAI,IAAI,EAAE,CAAC;gBACV,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACjB,cAAc,GAAG,cAAc,EAAE,iBAAiB,CAAC,IAAI,CAAC,UAAU,EAAE,cAAc,CAAC,UAAU,CAAC,CAAC;gBAC/F,IAAI,GAAG,cAAc,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;YACnC,CAAC;iBAAM,CAAC;gBACP,IAAI,GAAG,SAAS,CAAC;YAClB,CAAC;QACF,CAAC;QACD,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;IACxC,CAAC;IAEO,2BAA2B,CAAC,UAA4C,EAAE,QAA8B;QAC/G,MAAM,QAAQ,GAAG,IAAI,KAAK,EAAwB,CAAC;QACnD,IAAI,UAAU,KAAK,SAAS,EAAE,CAAC;YAC9B,OAAO,QAAQ,CAAC;QACjB,CAAC;QACD,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,EAAoB,CAAC;QAEnE,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC;YAC/B,MAAM,gBAAgB,GAAmC,EAAE,CAAC;YAC5D,KAAK,CAAC,aAAa,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;YAClD,MAAM,YAAY,GAAG,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YAChD,IAAI,YAAY,IAAI,gBAAgB,CAAC,KAAK,EAAE,CAAC;gBAC5C,MAAM,MAAM,GAAG,CAAC,CAAC,wBAAwB,CAAC,CAAC;gBAC3C,MAAM,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;gBAExG,KAAK,MAAM,QAAQ,IAAI,SAAS,EAAE,CAAC;oBAClC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,2CAA2C,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;gBACzF,CAAC;gBAED,QAAQ,CAAC,IAAI,CACZ,gBAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,EAChC,MAAM,EACN,CAAC,CAAC,yBAAyB,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC7F,OAAO,QAAQ,CAAC;YACjB,CAAC;YACD,OAAO,QAAQ,CAAC;QACjB,CAAC;aAAM,IAAI,iBAAiB,CAAC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC;YAC7C,MAAM,KAAK,GAAG,KAAK,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YACzD,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;gBACzB,QAAQ,CAAC,IAAI,CAAC,kBAAkB,UAAU,CAAC,QAAQ,CAAC,EAAE,MAAM,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACrH,OAAO,QAAQ,CAAC;YACjB,CAAC;iBAAM,IAAI,KAAK,KAAK,OAAO,EAAE,CAAC;gBAC9B,QAAQ,CAAC,IAAI,CAAC,gBAAgB,UAAU,CAAC,QAAQ,CAAC,EAAE,MAAM,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACnH,OAAO,QAAQ,CAAC;YACjB,CAAC;YACD,OAAO,QAAQ,CAAC;QACjB,CAAC;aAAM,CAAC;YACP,MAAM,KAAK,GAAG,KAAK,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC;YACvD,QAAQ,CAAC,IAAI,CAAC,YAAY,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;YACrF,OAAO,QAAQ,CAAC;QACjB,CAAC;IACF,CAAC;IAEO,oBAAoB,CAAC,KAAiB,EAAE,QAA8B;QAC7E,QAAQ,QAAQ,EAAE,CAAC;YAClB,KAAK,YAAY,CAAC,CAAC,OAAO,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YACtG,OAAO,CAAC,CAAC,OAAO,KAAK,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC9E,CAAC;IACF,CAAC;IAEM,UAAU;QAChB,OAAO,IAAI,CAAC,QAAQ,CAAC;IACtB,CAAC;IAEM,WAAW;QACjB,OAAO;YACN,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;YACpC,UAAU,EAAE,8FAA8E;SAC1F,CAAC;IACH,CAAC;;AAGF,0BAA0B,CAAC,6BAA6B,CAAC,EAAE,EAAE,6BAA6B,+CAAuC,CAAC;AAClI,oBAAoB,CAAC,mBAAmB,CAAC,CAAC","file":"inspectEditorTokens.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './inspectEditorTokens.css';\nimport * as nls from '../../../../../nls.js';\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CharCode } from '../../../../../base/common/charCode.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { KeyCode } from '../../../../../base/common/keyCodes.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { ContentWidgetPositionPreference, IActiveCodeEditor, ICodeEditor, IContentWidget, IContentWidgetPosition } from '../../../../../editor/browser/editorBrowser.js';\nimport { EditorAction, ServicesAccessor, registerEditorAction, registerEditorContribution, EditorContributionInstantiation } from '../../../../../editor/browser/editorExtensions.js';\nimport { Position } from '../../../../../editor/common/core/position.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IEditorContribution } from '../../../../../editor/common/editorCommon.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { SemanticTokensLegend, SemanticTokens } from '../../../../../editor/common/languages.js';\nimport { FontStyle, ColorId, StandardTokenType, TokenMetadata } from '../../../../../editor/common/encodedTokenAttributes.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { findMatchingThemeRule } from '../../../../services/textMate/common/TMHelper.js';\nimport { ITextMateTokenizationService } from '../../../../services/textMate/browser/textMateTokenizationFeature.js';\nimport type { IGrammar, IToken, StateStack } from 'vscode-textmate';\nimport { IWorkbenchThemeService } from '../../../../services/themes/common/workbenchThemeService.js';\nimport { CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { ColorThemeData, TokenStyleDefinitions, TokenStyleDefinition, TextMateThemingRuleDefinitions } from '../../../../services/themes/common/colorThemeData.js';\nimport { SemanticTokenRule, TokenStyleData, TokenStyle } from '../../../../../platform/theme/common/tokenClassificationRegistry.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { SEMANTIC_HIGHLIGHTING_SETTING_ID, IEditorSemanticHighlightingOptions } from '../../../../../editor/contrib/semanticTokens/common/semanticTokensConfig.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { ILanguageFeaturesService } from '../../../../../editor/common/services/languageFeatures.js';\nimport type * as TreeSitter from '@vscode/tree-sitter-wasm';\nimport { TreeSitterSyntaxTokenBackend } from '../../../../../editor/common/model/tokens/treeSitter/treeSitterSyntaxTokenBackend.js';\nimport { TokenizationTextModelPart } from '../../../../../editor/common/model/tokens/tokenizationTextModelPart.js';\nimport { TreeSitterTree } from '../../../../../editor/common/model/tokens/treeSitter/treeSitterTree.js';\n\nconst $ = dom.$;\n\nexport class InspectEditorTokensController extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.inspectEditorTokens';\n\n\tpublic static get(editor: ICodeEditor): InspectEditorTokensController | null {\n\t\treturn editor.getContribution<InspectEditorTokensController>(InspectEditorTokensController.ID);\n\t}\n\n\tprivate _editor: ICodeEditor;\n\tprivate _textMateService: ITextMateTokenizationService;\n\tprivate _themeService: IWorkbenchThemeService;\n\tprivate _languageService: ILanguageService;\n\tprivate _notificationService: INotificationService;\n\tprivate _configurationService: IConfigurationService;\n\tprivate _languageFeaturesService: ILanguageFeaturesService;\n\tprivate _widget: InspectEditorTokensWidget | null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ITextMateTokenizationService textMateService: ITextMateTokenizationService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IWorkbenchThemeService themeService: IWorkbenchThemeService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._textMateService = textMateService;\n\t\tthis._themeService = themeService;\n\t\tthis._languageService = languageService;\n\t\tthis._notificationService = notificationService;\n\t\tthis._configurationService = configurationService;\n\t\tthis._languageFeaturesService = languageFeaturesService;\n\t\tthis._widget = null;\n\n\t\tthis._register(this._editor.onDidChangeModel((e) => this.stop()));\n\t\tthis._register(this._editor.onDidChangeModelLanguage((e) => this.stop()));\n\t\tthis._register(this._editor.onKeyUp((e) => e.keyCode === KeyCode.Escape && this.stop()));\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis.stop();\n\t\tsuper.dispose();\n\t}\n\n\tpublic launch(): void {\n\t\tif (this._widget) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._editor.getModel().uri.scheme === Schemas.vscodeNotebookCell) {\n\t\t\t// disable in notebooks\n\t\t\treturn;\n\t\t}\n\t\tthis._widget = new InspectEditorTokensWidget(this._editor, this._textMateService, this._languageService, this._themeService, this._notificationService, this._configurationService, this._languageFeaturesService);\n\t}\n\n\tpublic stop(): void {\n\t\tif (this._widget) {\n\t\t\tthis._widget.dispose();\n\t\t\tthis._widget = null;\n\t\t}\n\t}\n\n\tpublic toggle(): void {\n\t\tif (!this._widget) {\n\t\t\tthis.launch();\n\t\t} else {\n\t\t\tthis.stop();\n\t\t}\n\t}\n}\n\nclass InspectEditorTokens extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.inspectTMScopes',\n\t\t\tlabel: nls.localize2('inspectEditorTokens', \"Developer: Inspect Editor Tokens and Scopes\"),\n\t\t\tprecondition: undefined\n\t\t});\n\t}\n\n\tpublic run(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tconst controller = InspectEditorTokensController.get(editor);\n\t\tcontroller?.toggle();\n\t}\n}\n\ninterface ITextMateTokenInfo {\n\ttoken: IToken;\n\tmetadata: IDecodedMetadata;\n}\n\ninterface ISemanticTokenInfo {\n\ttype: string;\n\tmodifiers: string[];\n\trange: Range;\n\tmetadata?: IDecodedMetadata;\n\tdefinitions: TokenStyleDefinitions;\n}\n\ninterface IDecodedMetadata {\n\tlanguageId: string | undefined;\n\ttokenType: StandardTokenType;\n\tbold: boolean | undefined;\n\titalic: boolean | undefined;\n\tunderline: boolean | undefined;\n\tstrikethrough: boolean | undefined;\n\tforeground: string | undefined;\n\tbackground: string | undefined;\n}\n\nfunction renderTokenText(tokenText: string): string {\n\tif (tokenText.length > 40) {\n\t\ttokenText = tokenText.substr(0, 20) + 'â€¦' + tokenText.substr(tokenText.length - 20);\n\t}\n\tlet result: string = '';\n\tfor (let charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\n\t\tconst charCode = tokenText.charCodeAt(charIndex);\n\t\tswitch (charCode) {\n\t\t\tcase CharCode.Tab:\n\t\t\t\tresult += '\\u2192'; // &rarr;\n\t\t\t\tbreak;\n\n\t\t\tcase CharCode.Space:\n\t\t\t\tresult += '\\u00B7'; // &middot;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tresult += String.fromCharCode(charCode);\n\t\t}\n\t}\n\treturn result;\n}\n\ntype SemanticTokensResult = { tokens: SemanticTokens; legend: SemanticTokensLegend };\n\nclass InspectEditorTokensWidget extends Disposable implements IContentWidget {\n\n\tprivate static readonly _ID = 'editor.contrib.inspectEditorTokensWidget';\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\tpublic readonly allowEditorOverflow = true;\n\n\tprivate _isDisposed: boolean;\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate readonly _languageService: ILanguageService;\n\tprivate readonly _themeService: IWorkbenchThemeService;\n\tprivate readonly _textMateService: ITextMateTokenizationService;\n\tprivate readonly _notificationService: INotificationService;\n\tprivate readonly _configurationService: IConfigurationService;\n\tprivate readonly _languageFeaturesService: ILanguageFeaturesService;\n\tprivate readonly _model: ITextModel;\n\tprivate readonly _domNode: HTMLElement;\n\tprivate readonly _currentRequestCancellationTokenSource: CancellationTokenSource;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\ttextMateService: ITextMateTokenizationService,\n\t\tlanguageService: ILanguageService,\n\t\tthemeService: IWorkbenchThemeService,\n\t\tnotificationService: INotificationService,\n\t\tconfigurationService: IConfigurationService,\n\t\tlanguageFeaturesService: ILanguageFeaturesService\n\t) {\n\t\tsuper();\n\t\tthis._isDisposed = false;\n\t\tthis._editor = editor;\n\t\tthis._languageService = languageService;\n\t\tthis._themeService = themeService;\n\t\tthis._textMateService = textMateService;\n\t\tthis._notificationService = notificationService;\n\t\tthis._configurationService = configurationService;\n\t\tthis._languageFeaturesService = languageFeaturesService;\n\t\tthis._model = this._editor.getModel();\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'token-inspect-widget';\n\t\tthis._currentRequestCancellationTokenSource = new CancellationTokenSource();\n\t\tthis._beginCompute(this._editor.getPosition());\n\t\tthis._register(this._editor.onDidChangeCursorPosition((e) => this._beginCompute(this._editor.getPosition())));\n\t\tthis._register(themeService.onDidColorThemeChange(_ => this._beginCompute(this._editor.getPosition())));\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => e.affectsConfiguration('editor.semanticHighlighting.enabled') && this._beginCompute(this._editor.getPosition())));\n\t\tthis._editor.addContentWidget(this);\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._isDisposed = true;\n\t\tthis._editor.removeContentWidget(this);\n\t\tthis._currentRequestCancellationTokenSource.cancel();\n\t\tsuper.dispose();\n\t}\n\n\tpublic getId(): string {\n\t\treturn InspectEditorTokensWidget._ID;\n\t}\n\n\tprivate _beginCompute(position: Position): void {\n\t\tconst grammar = this._textMateService.createTokenizer(this._model.getLanguageId());\n\t\tconst semanticTokens = this._computeSemanticTokens(position);\n\t\tconst backend = (this._model.tokenization as TokenizationTextModelPart).tokens.get();\n\t\tconst asTreeSitterBackend = backend instanceof TreeSitterSyntaxTokenBackend ? backend : undefined;\n\n\t\tdom.clearNode(this._domNode);\n\t\tthis._domNode.appendChild(document.createTextNode(nls.localize('inspectTMScopesWidget.loading', \"Loading...\")));\n\n\t\tPromise.all([grammar, semanticTokens]).then(([grammar, semanticTokens]) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst treeSitterTree = asTreeSitterBackend?.tree.get();\n\t\t\tthis._compute(grammar, semanticTokens, treeSitterTree, position);\n\t\t\tthis._domNode.style.maxWidth = `${Math.max(this._editor.getLayoutInfo().width * 0.66, 500)}px`;\n\t\t\tthis._editor.layoutContentWidget(this);\n\t\t}, (err) => {\n\t\t\tthis._notificationService.warn(err);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tInspectEditorTokensController.get(this._editor)?.stop();\n\t\t\t});\n\t\t});\n\n\t}\n\n\tprivate _isSemanticColoringEnabled() {\n\t\tconst setting = this._configurationService.getValue<IEditorSemanticHighlightingOptions>(SEMANTIC_HIGHLIGHTING_SETTING_ID, { overrideIdentifier: this._model.getLanguageId(), resource: this._model.uri })?.enabled;\n\t\tif (typeof setting === 'boolean') {\n\t\t\treturn setting;\n\t\t}\n\t\treturn this._themeService.getColorTheme().semanticHighlighting;\n\t}\n\n\tprivate _compute(grammar: IGrammar | null, semanticTokens: SemanticTokensResult | null, tree: TreeSitterTree | undefined, position: Position) {\n\t\tconst textMateTokenInfo = grammar && this._getTokensAtPosition(grammar, position);\n\t\tconst semanticTokenInfo = semanticTokens && this._getSemanticTokenAtPosition(semanticTokens, position);\n\t\tconst treeSitterTokenInfo = tree && this._getTreeSitterTokenAtPosition(tree, position);\n\t\tif (!textMateTokenInfo && !semanticTokenInfo && !treeSitterTokenInfo) {\n\t\t\tdom.reset(this._domNode, 'No grammar or semantic tokens available.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst tmMetadata = textMateTokenInfo?.metadata;\n\t\tconst semMetadata = semanticTokenInfo?.metadata;\n\n\t\tconst semTokenText = semanticTokenInfo && renderTokenText(this._model.getValueInRange(semanticTokenInfo.range));\n\t\tconst tmTokenText = textMateTokenInfo && renderTokenText(this._model.getLineContent(position.lineNumber).substring(textMateTokenInfo.token.startIndex, textMateTokenInfo.token.endIndex));\n\t\tconst semTokenLength = semanticTokenInfo && this._model.getValueLengthInRange(semanticTokenInfo.range);\n\t\tconst tmTokenLength = textMateTokenInfo && (textMateTokenInfo.token.endIndex - textMateTokenInfo.token.startIndex);\n\n\t\tconst tokenText = semTokenText || tmTokenText || '';\n\t\tconst tokenLength = semTokenLength || tmTokenLength || 0;\n\n\t\tdom.reset(this._domNode,\n\t\t\t$('h2.tiw-token', undefined,\n\t\t\t\ttokenText,\n\t\t\t\t$('span.tiw-token-length', undefined, `${tokenLength} ${tokenLength === 1 ? 'char' : 'chars'}`)));\n\t\tdom.append(this._domNode, $('hr.tiw-metadata-separator', { 'style': 'clear:both' }));\n\t\tdom.append(this._domNode, $('table.tiw-metadata-table', undefined,\n\t\t\t$('tbody', undefined,\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'language'),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, tmMetadata?.languageId || '')\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'standard token type' as string),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, this._tokenTypeToString(tmMetadata?.tokenType || StandardTokenType.Other))\n\t\t\t\t),\n\t\t\t\t...this._formatMetadata(semMetadata, tmMetadata)\n\t\t\t)\n\t\t));\n\n\t\tif (semanticTokenInfo) {\n\t\t\tdom.append(this._domNode, $('hr.tiw-metadata-separator'));\n\t\t\tconst table = dom.append(this._domNode, $('table.tiw-metadata-table', undefined));\n\t\t\tconst tbody = dom.append(table, $('tbody', undefined,\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'semantic token type' as string),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, semanticTokenInfo.type)\n\t\t\t\t)\n\t\t\t));\n\t\t\tif (semanticTokenInfo.modifiers.length) {\n\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'modifiers'),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, semanticTokenInfo.modifiers.join(' ')),\n\t\t\t\t));\n\t\t\t}\n\t\t\tif (semanticTokenInfo.metadata) {\n\t\t\t\tconst properties: (keyof TokenStyleData)[] = ['foreground', 'bold', 'italic', 'underline', 'strikethrough'];\n\t\t\t\tconst propertiesByDefValue: { [rule: string]: string[] } = {};\n\t\t\t\tconst allDefValues = new Array<[Array<HTMLElement | string>, string]>(); // remember the order\n\t\t\t\t// first collect to detect when the same rule is used for multiple properties\n\t\t\t\tfor (const property of properties) {\n\t\t\t\t\tif (semanticTokenInfo.metadata[property] !== undefined) {\n\t\t\t\t\t\tconst definition = semanticTokenInfo.definitions[property];\n\t\t\t\t\t\tconst defValue = this._renderTokenStyleDefinition(definition, property);\n\t\t\t\t\t\tconst defValueStr = defValue.map(el => dom.isHTMLElement(el) ? el.outerHTML : el).join();\n\t\t\t\t\t\tlet properties = propertiesByDefValue[defValueStr];\n\t\t\t\t\t\tif (!properties) {\n\t\t\t\t\t\t\tpropertiesByDefValue[defValueStr] = properties = [];\n\t\t\t\t\t\t\tallDefValues.push([defValue, defValueStr]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tproperties.push(property);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const [defValue, defValueStr] of allDefValues) {\n\t\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t\t$('td.tiw-metadata-key', undefined, propertiesByDefValue[defValueStr].join(', ')),\n\t\t\t\t\t\t$('td.tiw-metadata-value', undefined, ...defValue)\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (textMateTokenInfo) {\n\t\t\tconst theme = this._themeService.getColorTheme();\n\t\t\tdom.append(this._domNode, $('hr.tiw-metadata-separator'));\n\t\t\tconst table = dom.append(this._domNode, $('table.tiw-metadata-table'));\n\t\t\tconst tbody = dom.append(table, $('tbody'));\n\n\t\t\tif (tmTokenText && tmTokenText !== tokenText) {\n\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'textmate token' as string),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, `${tmTokenText} (${tmTokenText.length})`)\n\t\t\t\t));\n\t\t\t}\n\t\t\tconst scopes = new Array<HTMLElement | string>();\n\t\t\tfor (let i = textMateTokenInfo.token.scopes.length - 1; i >= 0; i--) {\n\t\t\t\tscopes.push(textMateTokenInfo.token.scopes[i]);\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tscopes.push($('br'));\n\t\t\t\t}\n\t\t\t}\n\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t$('td.tiw-metadata-key', undefined, 'textmate scopes' as string),\n\t\t\t\t$('td.tiw-metadata-value.tiw-metadata-scopes', undefined, ...scopes),\n\t\t\t));\n\n\t\t\tconst matchingRule = findMatchingThemeRule(theme, textMateTokenInfo.token.scopes, false);\n\t\t\tconst semForeground = semanticTokenInfo?.metadata?.foreground;\n\t\t\tif (matchingRule) {\n\t\t\t\tif (semForeground !== textMateTokenInfo.metadata.foreground) {\n\t\t\t\t\tlet defValue = $('code.tiw-theme-selector', undefined,\n\t\t\t\t\t\tmatchingRule.rawSelector, $('br'), JSON.stringify(matchingRule.settings, null, '\\t'));\n\t\t\t\t\tif (semForeground) {\n\t\t\t\t\t\tdefValue = $('s', undefined, defValue);\n\t\t\t\t\t}\n\t\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'foreground'),\n\t\t\t\t\t\t$('td.tiw-metadata-value', undefined, defValue),\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t} else if (!semForeground) {\n\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'foreground'),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, 'No theme selector' as string),\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\n\t\tif (treeSitterTokenInfo) {\n\t\t\tconst lastTokenInfo = treeSitterTokenInfo[treeSitterTokenInfo.length - 1];\n\t\t\tdom.append(this._domNode, $('hr.tiw-metadata-separator'));\n\t\t\tconst table = dom.append(this._domNode, $('table.tiw-metadata-table'));\n\t\t\tconst tbody = dom.append(table, $('tbody'));\n\n\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t$('td.tiw-metadata-key', undefined, `tree-sitter token ${lastTokenInfo.id}` as string),\n\t\t\t\t$('td.tiw-metadata-value', undefined, `${lastTokenInfo.text}`)\n\t\t\t));\n\t\t\tconst scopes = new Array<HTMLElement | string>();\n\t\t\tlet i = treeSitterTokenInfo.length - 1;\n\t\t\tlet node = treeSitterTokenInfo[i];\n\t\t\twhile (node.parent || i > 0) {\n\t\t\t\tscopes.push(node.type);\n\t\t\t\tnode = node.parent ?? treeSitterTokenInfo[--i];\n\t\t\t\tif (node) {\n\t\t\t\t\tscopes.push($('br'));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t$('td.tiw-metadata-key', undefined, 'tree-sitter tree' as string),\n\t\t\t\t$('td.tiw-metadata-value.tiw-metadata-scopes', undefined, ...scopes),\n\t\t\t));\n\n\t\t\tconst tokenizationSupport = ((this._model.tokenization as TokenizationTextModelPart).tokens.get() as TreeSitterSyntaxTokenBackend).tokenizationImpl.get();\n\t\t\tconst captures = tokenizationSupport?.captureAtPosition(position.lineNumber, position.column);\n\t\t\tif (captures && captures.length > 0) {\n\t\t\t\tdom.append(tbody, $('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'foreground'),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, captures.map(cap => cap.name).join(' ')),\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _formatMetadata(semantic?: IDecodedMetadata, tm?: IDecodedMetadata): Array<HTMLElement | string> {\n\t\tconst elements = new Array<HTMLElement | string>();\n\n\t\tfunction render(property: 'foreground' | 'background') {\n\t\t\tconst value = semantic?.[property] || tm?.[property];\n\t\t\tif (value !== undefined) {\n\t\t\t\tconst semanticStyle = semantic?.[property] ? 'tiw-metadata-semantic' : '';\n\t\t\t\telements.push($('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, property),\n\t\t\t\t\t$(`td.tiw-metadata-value.${semanticStyle}`, undefined, value)\n\t\t\t\t));\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tconst foreground = render('foreground');\n\t\tconst background = render('background');\n\t\tif (foreground && background) {\n\t\t\tconst backgroundColor = Color.fromHex(background), foregroundColor = Color.fromHex(foreground);\n\t\t\tif (backgroundColor.isOpaque()) {\n\t\t\t\telements.push($('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'contrast ratio' as string),\n\t\t\t\t\t$('td.tiw-metadata-value', undefined, backgroundColor.getContrastRatio(foregroundColor.makeOpaque(backgroundColor)).toFixed(2))\n\t\t\t\t));\n\t\t\t} else {\n\t\t\t\telements.push($('tr', undefined,\n\t\t\t\t\t$('td.tiw-metadata-key', undefined, 'Contrast ratio cannot be precise for background colors that use transparency' as string),\n\t\t\t\t\t$('td.tiw-metadata-value')\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\n\t\tconst fontStyleLabels = new Array<HTMLElement | string>();\n\n\t\tfunction addStyle(key: 'bold' | 'italic' | 'underline' | 'strikethrough') {\n\t\t\tlet label: HTMLElement | string | undefined;\n\t\t\tif (semantic && semantic[key]) {\n\t\t\t\tlabel = $('span.tiw-metadata-semantic', undefined, key);\n\t\t\t} else if (tm && tm[key]) {\n\t\t\t\tlabel = key;\n\t\t\t}\n\t\t\tif (label) {\n\t\t\t\tif (fontStyleLabels.length) {\n\t\t\t\t\tfontStyleLabels.push(' ');\n\t\t\t\t}\n\t\t\t\tfontStyleLabels.push(label);\n\t\t\t}\n\t\t}\n\t\taddStyle('bold');\n\t\taddStyle('italic');\n\t\taddStyle('underline');\n\t\taddStyle('strikethrough');\n\t\tif (fontStyleLabels.length) {\n\t\t\telements.push($('tr', undefined,\n\t\t\t\t$('td.tiw-metadata-key', undefined, 'font style' as string),\n\t\t\t\t$('td.tiw-metadata-value', undefined, ...fontStyleLabels)\n\t\t\t));\n\t\t}\n\t\treturn elements;\n\t}\n\n\tprivate _decodeMetadata(metadata: number): IDecodedMetadata {\n\t\tconst colorMap = this._themeService.getColorTheme().tokenColorMap;\n\t\tconst languageId = TokenMetadata.getLanguageId(metadata);\n\t\tconst tokenType = TokenMetadata.getTokenType(metadata);\n\t\tconst fontStyle = TokenMetadata.getFontStyle(metadata);\n\t\tconst foreground = TokenMetadata.getForeground(metadata);\n\t\tconst background = TokenMetadata.getBackground(metadata);\n\t\treturn {\n\t\t\tlanguageId: this._languageService.languageIdCodec.decodeLanguageId(languageId),\n\t\t\ttokenType: tokenType,\n\t\t\tbold: (fontStyle & FontStyle.Bold) ? true : undefined,\n\t\t\titalic: (fontStyle & FontStyle.Italic) ? true : undefined,\n\t\t\tunderline: (fontStyle & FontStyle.Underline) ? true : undefined,\n\t\t\tstrikethrough: (fontStyle & FontStyle.Strikethrough) ? true : undefined,\n\t\t\tforeground: colorMap[foreground],\n\t\t\tbackground: colorMap[background]\n\t\t};\n\t}\n\n\tprivate _tokenTypeToString(tokenType: StandardTokenType): string {\n\t\tswitch (tokenType) {\n\t\t\tcase StandardTokenType.Other: return 'Other';\n\t\t\tcase StandardTokenType.Comment: return 'Comment';\n\t\t\tcase StandardTokenType.String: return 'String';\n\t\t\tcase StandardTokenType.RegEx: return 'RegEx';\n\t\t\tdefault: return '??';\n\t\t}\n\t}\n\n\tprivate _getTokensAtPosition(grammar: IGrammar, position: Position): ITextMateTokenInfo {\n\t\tconst lineNumber = position.lineNumber;\n\t\tconst stateBeforeLine = this._getStateBeforeLine(grammar, lineNumber);\n\n\t\tconst tokenizationResult1 = grammar.tokenizeLine(this._model.getLineContent(lineNumber), stateBeforeLine);\n\t\tconst tokenizationResult2 = grammar.tokenizeLine2(this._model.getLineContent(lineNumber), stateBeforeLine);\n\n\t\tlet token1Index = 0;\n\t\tfor (let i = tokenizationResult1.tokens.length - 1; i >= 0; i--) {\n\t\t\tconst t = tokenizationResult1.tokens[i];\n\t\t\tif (position.column - 1 >= t.startIndex) {\n\t\t\t\ttoken1Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet token2Index = 0;\n\t\tfor (let i = (tokenizationResult2.tokens.length >>> 1); i >= 0; i--) {\n\t\t\tif (position.column - 1 >= tokenizationResult2.tokens[(i << 1)]) {\n\t\t\t\ttoken2Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttoken: tokenizationResult1.tokens[token1Index],\n\t\t\tmetadata: this._decodeMetadata(tokenizationResult2.tokens[(token2Index << 1) + 1])\n\t\t};\n\t}\n\n\tprivate _getStateBeforeLine(grammar: IGrammar, lineNumber: number): StateStack | null {\n\t\tlet state: StateStack | null = null;\n\n\t\tfor (let i = 1; i < lineNumber; i++) {\n\t\t\tconst tokenizationResult = grammar.tokenizeLine(this._model.getLineContent(i), state);\n\t\t\tstate = tokenizationResult.ruleStack;\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tprivate isSemanticTokens(token: any): token is SemanticTokens {\n\t\treturn token && token.data;\n\t}\n\n\tprivate async _computeSemanticTokens(position: Position): Promise<SemanticTokensResult | null> {\n\t\tif (!this._isSemanticColoringEnabled()) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst tokenProviders = this._languageFeaturesService.documentSemanticTokensProvider.ordered(this._model);\n\t\tif (tokenProviders.length) {\n\t\t\tconst provider = tokenProviders[0];\n\t\t\tconst tokens = await Promise.resolve(provider.provideDocumentSemanticTokens(this._model, null, this._currentRequestCancellationTokenSource.token));\n\t\t\tif (this.isSemanticTokens(tokens)) {\n\t\t\t\treturn { tokens, legend: provider.getLegend() };\n\t\t\t}\n\t\t}\n\t\tconst rangeTokenProviders = this._languageFeaturesService.documentRangeSemanticTokensProvider.ordered(this._model);\n\t\tif (rangeTokenProviders.length) {\n\t\t\tconst provider = rangeTokenProviders[0];\n\t\t\tconst lineNumber = position.lineNumber;\n\t\t\tconst range = new Range(lineNumber, 1, lineNumber, this._model.getLineMaxColumn(lineNumber));\n\t\t\tconst tokens = await Promise.resolve(provider.provideDocumentRangeSemanticTokens(this._model, range, this._currentRequestCancellationTokenSource.token));\n\t\t\tif (this.isSemanticTokens(tokens)) {\n\t\t\t\treturn { tokens, legend: provider.getLegend() };\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _getSemanticTokenAtPosition(semanticTokens: SemanticTokensResult, pos: Position): ISemanticTokenInfo | null {\n\t\tconst tokenData = semanticTokens.tokens.data;\n\t\tconst defaultLanguage = this._model.getLanguageId();\n\t\tlet lastLine = 0;\n\t\tlet lastCharacter = 0;\n\t\tconst posLine = pos.lineNumber - 1, posCharacter = pos.column - 1; // to 0-based position\n\t\tfor (let i = 0; i < tokenData.length; i += 5) {\n\t\t\tconst lineDelta = tokenData[i], charDelta = tokenData[i + 1], len = tokenData[i + 2], typeIdx = tokenData[i + 3], modSet = tokenData[i + 4];\n\t\t\tconst line = lastLine + lineDelta; // 0-based\n\t\t\tconst character = lineDelta === 0 ? lastCharacter + charDelta : charDelta; // 0-based\n\t\t\tif (posLine === line && character <= posCharacter && posCharacter < character + len) {\n\t\t\t\tconst type = semanticTokens.legend.tokenTypes[typeIdx] || 'not in legend (ignored)';\n\t\t\t\tconst modifiers = [];\n\t\t\t\tlet modifierSet = modSet;\n\t\t\t\tfor (let modifierIndex = 0; modifierSet > 0 && modifierIndex < semanticTokens.legend.tokenModifiers.length; modifierIndex++) {\n\t\t\t\t\tif (modifierSet & 1) {\n\t\t\t\t\t\tmodifiers.push(semanticTokens.legend.tokenModifiers[modifierIndex]);\n\t\t\t\t\t}\n\t\t\t\t\tmodifierSet = modifierSet >> 1;\n\t\t\t\t}\n\t\t\t\tif (modifierSet > 0) {\n\t\t\t\t\tmodifiers.push('not in legend (ignored)');\n\t\t\t\t}\n\t\t\t\tconst range = new Range(line + 1, character + 1, line + 1, character + 1 + len);\n\t\t\t\tconst definitions = {};\n\t\t\t\tconst colorMap = this._themeService.getColorTheme().tokenColorMap;\n\t\t\t\tconst theme = this._themeService.getColorTheme() as ColorThemeData;\n\t\t\t\tconst tokenStyle = theme.getTokenStyleMetadata(type, modifiers, defaultLanguage, true, definitions);\n\n\t\t\t\tlet metadata: IDecodedMetadata | undefined = undefined;\n\t\t\t\tif (tokenStyle) {\n\t\t\t\t\tmetadata = {\n\t\t\t\t\t\tlanguageId: undefined,\n\t\t\t\t\t\ttokenType: StandardTokenType.Other,\n\t\t\t\t\t\tbold: tokenStyle?.bold,\n\t\t\t\t\t\titalic: tokenStyle?.italic,\n\t\t\t\t\t\tunderline: tokenStyle?.underline,\n\t\t\t\t\t\tstrikethrough: tokenStyle?.strikethrough,\n\t\t\t\t\t\tforeground: colorMap[tokenStyle?.foreground || ColorId.None],\n\t\t\t\t\t\tbackground: undefined\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn { type, modifiers, range, metadata, definitions };\n\t\t\t}\n\t\t\tlastLine = line;\n\t\t\tlastCharacter = character;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _walkTreeforPosition(cursor: TreeSitter.TreeCursor, pos: Position): TreeSitter.Node | null {\n\t\tconst offset = this._model.getOffsetAt(pos);\n\t\tcursor.gotoFirstChild();\n\t\tlet goChild: boolean = false;\n\t\tlet lastGoodNode: TreeSitter.Node | null = null;\n\t\tdo {\n\t\t\tif (cursor.currentNode.startIndex <= offset && offset < cursor.currentNode.endIndex) {\n\t\t\t\tgoChild = true;\n\t\t\t\tlastGoodNode = cursor.currentNode;\n\t\t\t} else {\n\t\t\t\tgoChild = false;\n\t\t\t}\n\t\t} while (goChild ? cursor.gotoFirstChild() : cursor.gotoNextSibling());\n\t\treturn lastGoodNode;\n\t}\n\n\tprivate _getTreeSitterTokenAtPosition(treeSitterTree: TreeSitterTree | undefined, pos: Position): TreeSitter.Node[] | null {\n\t\tconst nodes: TreeSitter.Node[] = [];\n\n\t\tlet tree = treeSitterTree?.tree.get();\n\t\twhile (tree) {\n\t\t\tconst cursor = tree.walk();\n\t\t\tconst node = this._walkTreeforPosition(cursor, pos);\n\t\t\tcursor.delete();\n\t\t\tif (node) {\n\t\t\t\tnodes.push(node);\n\t\t\t\ttreeSitterTree = treeSitterTree?.getInjectionTrees(node.startIndex, treeSitterTree.languageId);\n\t\t\t\ttree = treeSitterTree?.tree.get();\n\t\t\t} else {\n\t\t\t\ttree = undefined;\n\t\t\t}\n\t\t}\n\t\treturn nodes.length > 0 ? nodes : null;\n\t}\n\n\tprivate _renderTokenStyleDefinition(definition: TokenStyleDefinition | undefined, property: keyof TokenStyleData): Array<HTMLElement | string> {\n\t\tconst elements = new Array<HTMLElement | string>();\n\t\tif (definition === undefined) {\n\t\t\treturn elements;\n\t\t}\n\t\tconst theme = this._themeService.getColorTheme() as ColorThemeData;\n\n\t\tif (Array.isArray(definition)) {\n\t\t\tconst scopesDefinition: TextMateThemingRuleDefinitions = {};\n\t\t\ttheme.resolveScopes(definition, scopesDefinition);\n\t\t\tconst matchingRule = scopesDefinition[property];\n\t\t\tif (matchingRule && scopesDefinition.scope) {\n\t\t\t\tconst scopes = $('ul.tiw-metadata-values');\n\t\t\t\tconst strScopes = Array.isArray(matchingRule.scope) ? matchingRule.scope : [String(matchingRule.scope)];\n\n\t\t\t\tfor (const strScope of strScopes) {\n\t\t\t\t\tscopes.appendChild($('li.tiw-metadata-value.tiw-metadata-scopes', undefined, strScope));\n\t\t\t\t}\n\n\t\t\t\telements.push(\n\t\t\t\t\tscopesDefinition.scope.join(' '),\n\t\t\t\t\tscopes,\n\t\t\t\t\t$('code.tiw-theme-selector', undefined, JSON.stringify(matchingRule.settings, null, '\\t')));\n\t\t\t\treturn elements;\n\t\t\t}\n\t\t\treturn elements;\n\t\t} else if (SemanticTokenRule.is(definition)) {\n\t\t\tconst scope = theme.getTokenStylingRuleScope(definition);\n\t\t\tif (scope === 'setting') {\n\t\t\t\telements.push(`User settings: ${definition.selector.id} - ${this._renderStyleProperty(definition.style, property)}`);\n\t\t\t\treturn elements;\n\t\t\t} else if (scope === 'theme') {\n\t\t\t\telements.push(`Color theme: ${definition.selector.id} - ${this._renderStyleProperty(definition.style, property)}`);\n\t\t\t\treturn elements;\n\t\t\t}\n\t\t\treturn elements;\n\t\t} else {\n\t\t\tconst style = theme.resolveTokenStyleValue(definition);\n\t\t\telements.push(`Default: ${style ? this._renderStyleProperty(style, property) : ''}`);\n\t\t\treturn elements;\n\t\t}\n\t}\n\n\tprivate _renderStyleProperty(style: TokenStyle, property: keyof TokenStyleData) {\n\t\tswitch (property) {\n\t\t\tcase 'foreground': return style.foreground ? Color.Format.CSS.formatHexA(style.foreground, true) : '';\n\t\t\tdefault: return style[property] !== undefined ? String(style[property]) : '';\n\t\t}\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IContentWidgetPosition {\n\t\treturn {\n\t\t\tposition: this._editor.getPosition(),\n\t\t\tpreference: [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE]\n\t\t};\n\t}\n}\n\nregisterEditorContribution(InspectEditorTokensController.ID, InspectEditorTokensController, EditorContributionInstantiation.Lazy);\nregisterEditorAction(InspectEditorTokens);\n"]}