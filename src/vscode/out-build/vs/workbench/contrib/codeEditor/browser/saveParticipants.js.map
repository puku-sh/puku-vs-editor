{"version":3,"sources":["vs/workbench/contrib/codeEditor/browser/saveParticipants.ts"],"names":[],"mappings":"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","file":"saveParticipants.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { createCommandUri } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { IActiveCodeEditor, isCodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { trimTrailingWhitespace } from '../../../../editor/common/commands/trimTrailingWhitespaceCommand.js';\nimport { EditOperation } from '../../../../editor/common/core/editOperation.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { Selection } from '../../../../editor/common/core/selection.js';\nimport { CodeActionProvider, CodeActionTriggerType } from '../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction, getCodeActions } from '../../../../editor/contrib/codeAction/browser/codeAction.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../../../editor/contrib/codeAction/common/types.js';\nimport { FormattingMode, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider } from '../../../../editor/contrib/format/browser/format.js';\nimport { SnippetController2 } from '../../../../editor/contrib/snippet/browser/snippetController2.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IProgress, IProgressStep, Progress } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkbenchContribution, IWorkbenchContributionsRegistry, Extensions as WorkbenchContributionsExtensions } from '../../../common/contributions.js';\nimport { SaveReason } from '../../../common/editor.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IHostService } from '../../../services/host/browser/host.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ITextFileEditorModel, ITextFileSaveParticipant, ITextFileSaveParticipantContext, ITextFileService } from '../../../services/textfile/common/textfiles.js';\nimport { getModifiedRanges } from '../../format/browser/formatModified.js';\n\nexport class TrimWhitespaceParticipant implements ITextFileSaveParticipant {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService\n\t) {\n\t\t// Nothing\n\t}\n\n\tasync participate(model: ITextFileEditorModel, context: ITextFileSaveParticipantContext): Promise<void> {\n\t\tif (!model.textEditorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst trimTrailingWhitespaceOption = this.configurationService.getValue<boolean>('files.trimTrailingWhitespace', { overrideIdentifier: model.textEditorModel.getLanguageId(), resource: model.resource });\n\t\tconst trimInRegexAndStrings = this.configurationService.getValue<boolean>('files.trimTrailingWhitespaceInRegexAndStrings', { overrideIdentifier: model.textEditorModel.getLanguageId(), resource: model.resource });\n\t\tif (trimTrailingWhitespaceOption) {\n\t\t\tthis.doTrimTrailingWhitespace(model.textEditorModel, context.reason === SaveReason.AUTO, trimInRegexAndStrings);\n\t\t}\n\t}\n\n\tprivate doTrimTrailingWhitespace(model: ITextModel, isAutoSaved: boolean, trimInRegexesAndStrings: boolean): void {\n\t\tlet prevSelection: Selection[] = [];\n\t\tlet cursors: Position[] = [];\n\n\t\tconst editor = findEditor(model, this.codeEditorService);\n\t\tif (editor) {\n\t\t\t// Find `prevSelection` in any case do ensure a good undo stack when pushing the edit\n\t\t\t// Collect active cursors in `cursors` only if `isAutoSaved` to avoid having the cursors jump\n\t\t\tprevSelection = editor.getSelections();\n\t\t\tif (isAutoSaved) {\n\t\t\t\tcursors = prevSelection.map(s => s.getPosition());\n\t\t\t\tconst snippetsRange = SnippetController2.get(editor)?.getSessionEnclosingRange();\n\t\t\t\tif (snippetsRange) {\n\t\t\t\t\tfor (let lineNumber = snippetsRange.startLineNumber; lineNumber <= snippetsRange.endLineNumber; lineNumber++) {\n\t\t\t\t\t\tcursors.push(new Position(lineNumber, model.getLineMaxColumn(lineNumber)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst ops = trimTrailingWhitespace(model, cursors, trimInRegexesAndStrings);\n\t\tif (!ops.length) {\n\t\t\treturn; // Nothing to do\n\t\t}\n\n\t\tmodel.pushEditOperations(prevSelection, ops, (_edits) => prevSelection);\n\t}\n}\n\nfunction findEditor(model: ITextModel, codeEditorService: ICodeEditorService): IActiveCodeEditor | null {\n\tlet candidate: IActiveCodeEditor | null = null;\n\n\tif (model.isAttachedToEditor()) {\n\t\tfor (const editor of codeEditorService.listCodeEditors()) {\n\t\t\tif (editor.hasModel() && editor.getModel() === model) {\n\t\t\t\tif (editor.hasTextFocus()) {\n\t\t\t\t\treturn editor; // favour focused editor if there are multiple\n\t\t\t\t}\n\n\t\t\t\tcandidate = editor;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn candidate;\n}\n\nexport class FinalNewLineParticipant implements ITextFileSaveParticipant {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService\n\t) {\n\t\t// Nothing\n\t}\n\n\tasync participate(model: ITextFileEditorModel, context: ITextFileSaveParticipantContext): Promise<void> {\n\t\tif (!model.textEditorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.configurationService.getValue('files.insertFinalNewline', { overrideIdentifier: model.textEditorModel.getLanguageId(), resource: model.resource })) {\n\t\t\tthis.doInsertFinalNewLine(model.textEditorModel);\n\t\t}\n\t}\n\n\tprivate doInsertFinalNewLine(model: ITextModel): void {\n\t\tconst lineCount = model.getLineCount();\n\t\tconst lastLine = model.getLineContent(lineCount);\n\t\tconst lastLineIsEmptyOrWhitespace = strings.lastNonWhitespaceIndex(lastLine) === -1;\n\n\t\tif (!lineCount || lastLineIsEmptyOrWhitespace) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst edits = [EditOperation.insert(new Position(lineCount, model.getLineMaxColumn(lineCount)), model.getEOL())];\n\t\tconst editor = findEditor(model, this.codeEditorService);\n\t\tif (editor) {\n\t\t\teditor.executeEdits('insertFinalNewLine', edits, editor.getSelections());\n\t\t} else {\n\t\t\tmodel.pushEditOperations([], edits, () => null);\n\t\t}\n\t}\n}\n\nexport class TrimFinalNewLinesParticipant implements ITextFileSaveParticipant {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService\n\t) {\n\t\t// Nothing\n\t}\n\n\tasync participate(model: ITextFileEditorModel, context: ITextFileSaveParticipantContext): Promise<void> {\n\t\tif (!model.textEditorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.configurationService.getValue('files.trimFinalNewlines', { overrideIdentifier: model.textEditorModel.getLanguageId(), resource: model.resource })) {\n\t\t\tthis.doTrimFinalNewLines(model.textEditorModel, context.reason === SaveReason.AUTO);\n\t\t}\n\t}\n\n\t/**\n\t * returns 0 if the entire file is empty\n\t */\n\tprivate findLastNonEmptyLine(model: ITextModel): number {\n\t\tfor (let lineNumber = model.getLineCount(); lineNumber >= 1; lineNumber--) {\n\t\t\tconst lineLength = model.getLineLength(lineNumber);\n\t\t\tif (lineLength > 0) {\n\t\t\t\t// this line has content\n\t\t\t\treturn lineNumber;\n\t\t\t}\n\t\t}\n\t\t// no line has content\n\t\treturn 0;\n\t}\n\n\tprivate doTrimFinalNewLines(model: ITextModel, isAutoSaved: boolean): void {\n\t\tconst lineCount = model.getLineCount();\n\n\t\t// Do not insert new line if file does not end with new line\n\t\tif (lineCount === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet prevSelection: Selection[] = [];\n\t\tlet cannotTouchLineNumber = 0;\n\t\tconst editor = findEditor(model, this.codeEditorService);\n\t\tif (editor) {\n\t\t\tprevSelection = editor.getSelections();\n\t\t\tif (isAutoSaved) {\n\t\t\t\tfor (let i = 0, len = prevSelection.length; i < len; i++) {\n\t\t\t\t\tconst positionLineNumber = prevSelection[i].positionLineNumber;\n\t\t\t\t\tif (positionLineNumber > cannotTouchLineNumber) {\n\t\t\t\t\t\tcannotTouchLineNumber = positionLineNumber;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst lastNonEmptyLine = this.findLastNonEmptyLine(model);\n\t\tconst deleteFromLineNumber = Math.max(lastNonEmptyLine + 1, cannotTouchLineNumber + 1);\n\t\tconst deletionRange = model.validateRange(new Range(deleteFromLineNumber, 1, lineCount, model.getLineMaxColumn(lineCount)));\n\n\t\tif (deletionRange.isEmpty()) {\n\t\t\treturn;\n\t\t}\n\n\t\tmodel.pushEditOperations(prevSelection, [EditOperation.delete(deletionRange)], _edits => prevSelection);\n\n\t\teditor?.setSelections(prevSelection);\n\t}\n}\n\nclass FormatOnSaveParticipant implements ITextFileSaveParticipant {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\t// Nothing\n\t}\n\n\tasync participate(model: ITextFileEditorModel, context: ITextFileSaveParticipantContext, progress: IProgress<IProgressStep>, token: CancellationToken): Promise<void> {\n\t\tif (!model.textEditorModel) {\n\t\t\treturn;\n\t\t}\n\t\tif (context.reason === SaveReason.AUTO) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst textEditorModel = model.textEditorModel;\n\t\tconst overrides = { overrideIdentifier: textEditorModel.getLanguageId(), resource: textEditorModel.uri };\n\n\t\tconst nestedProgress = new Progress<{ displayName?: string; extensionId?: ExtensionIdentifier }>(provider => {\n\t\t\tprogress.report({\n\t\t\t\tmessage: localize(\n\t\t\t\t\t{ key: 'formatting2', comment: ['[configure]({1}) is a link. Only translate `configure`. Do not change brackets and parentheses or {1}'] },\n\t\t\t\t\t\"Running '{0}' Formatter ([configure]({1})).\",\n\t\t\t\t\tprovider.displayName || provider.extensionId && provider.extensionId.value || '???',\n\t\t\t\t\tcreateCommandUri('workbench.action.openSettings', 'editor.formatOnSave').toString(),\n\t\t\t\t)\n\t\t\t});\n\t\t});\n\n\t\tconst enabled = this.configurationService.getValue<boolean>('editor.formatOnSave', overrides);\n\t\tif (!enabled) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst editorOrModel = findEditor(textEditorModel, this.codeEditorService) || textEditorModel;\n\t\tconst mode = this.configurationService.getValue<'file' | 'modifications' | 'modificationsIfAvailable'>('editor.formatOnSaveMode', overrides);\n\n\t\tif (mode === 'file') {\n\t\t\tawait this.instantiationService.invokeFunction(formatDocumentWithSelectedProvider, editorOrModel, FormattingMode.Silent, nestedProgress, token);\n\n\t\t} else {\n\t\t\tconst ranges = await this.instantiationService.invokeFunction(getModifiedRanges, isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel);\n\t\t\tif (ranges === null && mode === 'modificationsIfAvailable') {\n\t\t\t\t// no SCM, fallback to formatting the whole file iff wanted\n\t\t\t\tawait this.instantiationService.invokeFunction(formatDocumentWithSelectedProvider, editorOrModel, FormattingMode.Silent, nestedProgress, token);\n\n\t\t\t} else if (ranges) {\n\t\t\t\t// formatted modified ranges\n\t\t\t\tawait this.instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, editorOrModel, ranges, FormattingMode.Silent, nestedProgress, token, false);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass CodeActionOnSaveParticipant extends Disposable implements ITextFileSaveParticipant {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ILanguageFeaturesService private readonly languageFeaturesService: ILanguageFeaturesService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(this.hostService.onDidChangeFocus(() => { this.triggerCodeActionsCommand(); }));\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => { this.triggerCodeActionsCommand(); }));\n\t}\n\n\tprivate async triggerCodeActionsCommand() {\n\t\tif (this.configurationService.getValue<boolean>('editor.codeActions.triggerOnFocusChange') && this.configurationService.getValue<string>('files.autoSave') === 'afterDelay') {\n\t\t\tconst model = this.codeEditorService.getActiveCodeEditor()?.getModel();\n\t\t\tif (!model) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst settingsOverrides = { overrideIdentifier: model.getLanguageId(), resource: model.uri };\n\t\t\tconst setting = this.configurationService.getValue<{ [kind: string]: string | boolean } | string[]>('editor.codeActionsOnSave', settingsOverrides);\n\n\t\t\tif (!setting) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (Array.isArray(setting)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst settingItems: string[] = Object.keys(setting).filter(x => setting[x] && setting[x] === 'always' && CodeActionKind.Source.contains(new HierarchicalKind(x)));\n\n\t\t\tconst cancellationTokenSource = new CancellationTokenSource();\n\n\t\t\tconst codeActionKindList = [];\n\t\t\tfor (const item of settingItems) {\n\t\t\t\tcodeActionKindList.push(new HierarchicalKind(item));\n\t\t\t}\n\n\t\t\t// run code actions based on what is found from setting === 'always', no exclusions.\n\t\t\tawait this.applyOnSaveActions(model, codeActionKindList, [], Progress.None, cancellationTokenSource.token);\n\t\t}\n\t}\n\n\tasync participate(model: ITextFileEditorModel, context: ITextFileSaveParticipantContext, progress: IProgress<IProgressStep>, token: CancellationToken): Promise<void> {\n\t\tif (!model.textEditorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst textEditorModel = model.textEditorModel;\n\t\tconst settingsOverrides = { overrideIdentifier: textEditorModel.getLanguageId(), resource: textEditorModel.uri };\n\n\t\t// Convert boolean values to strings\n\t\tconst setting = this.configurationService.getValue<{ [kind: string]: string | boolean } | string[]>('editor.codeActionsOnSave', settingsOverrides);\n\t\tif (!setting) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (context.reason === SaveReason.AUTO) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (context.reason !== SaveReason.EXPLICIT && Array.isArray(setting)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst settingItems: string[] = Array.isArray(setting)\n\t\t\t? setting\n\t\t\t: Object.keys(setting).filter(x => setting[x] && setting[x] !== 'never');\n\n\t\tconst codeActionsOnSave = this.createCodeActionsOnSave(settingItems);\n\n\t\tif (!Array.isArray(setting)) {\n\t\t\tcodeActionsOnSave.sort((a, b) => {\n\t\t\t\tif (CodeActionKind.SourceFixAll.contains(a)) {\n\t\t\t\t\tif (CodeActionKind.SourceFixAll.contains(b)) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\tif (CodeActionKind.SourceFixAll.contains(b)) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t}\n\n\t\tif (!codeActionsOnSave.length) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst excludedActions = Array.isArray(setting)\n\t\t\t? []\n\t\t\t: Object.keys(setting)\n\t\t\t\t.filter(x => setting[x] === 'never' || false)\n\t\t\t\t.map(x => new HierarchicalKind(x));\n\n\t\tprogress.report({ message: localize('codeaction', \"Quick Fixes\") });\n\n\t\tconst filteredSaveList = Array.isArray(setting) ? codeActionsOnSave : codeActionsOnSave.filter(x => setting[x.value] === 'always' || ((setting[x.value] === 'explicit' || setting[x.value] === true) && context.reason === SaveReason.EXPLICIT));\n\n\t\tawait this.applyOnSaveActions(textEditorModel, filteredSaveList, excludedActions, progress, token);\n\t}\n\n\tprivate createCodeActionsOnSave(settingItems: readonly string[]): HierarchicalKind[] {\n\t\tconst kinds = settingItems.map(x => new HierarchicalKind(x));\n\n\t\t// Remove subsets\n\t\treturn kinds.filter(kind => {\n\t\t\treturn kinds.every(otherKind => otherKind.equals(kind) || !otherKind.contains(kind));\n\t\t});\n\t}\n\n\tprivate async applyOnSaveActions(model: ITextModel, codeActionsOnSave: readonly HierarchicalKind[], excludes: readonly HierarchicalKind[], progress: IProgress<IProgressStep>, token: CancellationToken): Promise<void> {\n\n\t\tconst getActionProgress = new class implements IProgress<CodeActionProvider> {\n\t\t\tprivate _names = new Set<string>();\n\t\t\tprivate _report(): void {\n\t\t\t\tprogress.report({\n\t\t\t\t\tmessage: localize(\n\t\t\t\t\t\t{ key: 'codeaction.get2', comment: ['[configure]({1}) is a link. Only translate `configure`. Do not change brackets and parentheses or {1}'] },\n\t\t\t\t\t\t\"Getting code actions from {0} ([configure]({1})).\",\n\t\t\t\t\t\t[...this._names].map(name => `'${name}'`).join(', '),\n\t\t\t\t\t\tcreateCommandUri('workbench.action.openSettings', 'editor.codeActionsOnSave').toString()\n\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t}\n\t\t\treport(provider: CodeActionProvider) {\n\t\t\t\tif (provider.displayName && !this._names.has(provider.displayName)) {\n\t\t\t\t\tthis._names.add(provider.displayName);\n\t\t\t\t\tthis._report();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfor (const codeActionKind of codeActionsOnSave) {\n\t\t\tconst actionsToRun = await this.getActionsToRun(model, codeActionKind, excludes, getActionProgress, token);\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\tactionsToRun.dispose();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tfor (const action of actionsToRun.validActions) {\n\t\t\t\t\tprogress.report({ message: localize('codeAction.apply', \"Applying code action '{0}'.\", action.action.title) });\n\t\t\t\t\tawait this.instantiationService.invokeFunction(applyCodeAction, action, ApplyCodeActionReason.OnSave, {}, token);\n\t\t\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// Failure to apply a code action should not block other on save actions\n\t\t\t} finally {\n\t\t\t\tactionsToRun.dispose();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getActionsToRun(model: ITextModel, codeActionKind: HierarchicalKind, excludes: readonly HierarchicalKind[], progress: IProgress<CodeActionProvider>, token: CancellationToken) {\n\t\treturn getCodeActions(this.languageFeaturesService.codeActionProvider, model, model.getFullModelRange(), {\n\t\t\ttype: CodeActionTriggerType.Auto,\n\t\t\ttriggerAction: CodeActionTriggerSource.OnSave,\n\t\t\tfilter: { include: codeActionKind, excludes: excludes, includeSourceActions: true },\n\t\t}, progress, token);\n\t}\n}\n\nexport class SaveParticipantsContribution extends Disposable implements IWorkbenchContribution {\n\n\tconstructor(\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService\n\t) {\n\t\tsuper();\n\n\t\tthis.registerSaveParticipants();\n\t}\n\n\tprivate registerSaveParticipants(): void {\n\t\tthis._register(this.textFileService.files.addSaveParticipant(this.instantiationService.createInstance(TrimWhitespaceParticipant)));\n\t\tthis._register(this.textFileService.files.addSaveParticipant(this.instantiationService.createInstance(CodeActionOnSaveParticipant)));\n\t\tthis._register(this.textFileService.files.addSaveParticipant(this.instantiationService.createInstance(FormatOnSaveParticipant)));\n\t\tthis._register(this.textFileService.files.addSaveParticipant(this.instantiationService.createInstance(FinalNewLineParticipant)));\n\t\tthis._register(this.textFileService.files.addSaveParticipant(this.instantiationService.createInstance(TrimFinalNewLinesParticipant)));\n\t}\n}\n\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(WorkbenchContributionsExtensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(SaveParticipantsContribution, LifecyclePhase.Restored);\n"]}