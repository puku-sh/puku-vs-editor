{"version":3,"sources":["vs/workbench/contrib/codeEditor/browser/diffEditorHelper.ts"],"names":[],"mappings":"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","file":"diffEditorHelper.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorunWithStore, observableFromEvent } from '../../../../base/common/observable.js';\nimport { IDiffEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { registerDiffEditorContribution } from '../../../../editor/browser/editorExtensions.js';\nimport { EmbeddedDiffEditorWidget } from '../../../../editor/browser/widget/diffEditor/embeddedDiffEditorWidget.js';\nimport { IDiffEditorContribution } from '../../../../editor/common/editorCommon.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { localize } from '../../../../nls.js';\nimport { AccessibleViewRegistry } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { FloatingEditorClickWidget } from '../../../browser/codeeditor.js';\nimport { Extensions, IConfigurationMigrationRegistry } from '../../../common/configuration.js';\nimport { DiffEditorAccessibilityHelp } from './diffEditorAccessibilityHelp.js';\n\nclass DiffEditorHelperContribution extends Disposable implements IDiffEditorContribution {\n\tpublic static readonly ID = 'editor.contrib.diffEditorHelper';\n\n\tconstructor(\n\t\tprivate readonly _diffEditor: IDiffEditor,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ITextResourceConfigurationService private readonly _textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t) {\n\t\tsuper();\n\n\t\tconst isEmbeddedDiffEditor = this._diffEditor instanceof EmbeddedDiffEditorWidget;\n\n\t\tif (!isEmbeddedDiffEditor) {\n\t\t\tconst computationResult = observableFromEvent(this, e => this._diffEditor.onDidUpdateDiff(e), () => /** @description diffEditor.diffComputationResult */ this._diffEditor.getDiffComputationResult());\n\t\t\tconst onlyWhiteSpaceChange = computationResult.map(r => r && !r.identical && r.changes2.length === 0);\n\n\t\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t\t/** @description update state */\n\t\t\t\tif (onlyWhiteSpaceChange.read(reader)) {\n\t\t\t\t\tconst helperWidget = store.add(this._instantiationService.createInstance(\n\t\t\t\t\t\tFloatingEditorClickWidget,\n\t\t\t\t\t\tthis._diffEditor.getModifiedEditor(),\n\t\t\t\t\t\tlocalize('hintWhitespace', \"Show Whitespace Differences\"),\n\t\t\t\t\t\tnull\n\t\t\t\t\t));\n\t\t\t\t\tstore.add(helperWidget.onClick(() => {\n\t\t\t\t\t\tthis._textResourceConfigurationService.updateValue(this._diffEditor.getModel()!.modified.uri, 'diffEditor.ignoreTrimWhitespace', false);\n\t\t\t\t\t}));\n\t\t\t\t\thelperWidget.render();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis._register(this._diffEditor.onDidUpdateDiff(() => {\n\t\t\t\tconst diffComputationResult = this._diffEditor.getDiffComputationResult();\n\n\t\t\t\tif (diffComputationResult && diffComputationResult.quitEarly) {\n\t\t\t\t\tthis._notificationService.prompt(\n\t\t\t\t\t\tSeverity.Warning,\n\t\t\t\t\t\tlocalize('hintTimeout', \"The diff algorithm was stopped early (after {0} ms.)\", this._diffEditor.maxComputationTime),\n\t\t\t\t\t\t[{\n\t\t\t\t\t\t\tlabel: localize('removeTimeout', \"Remove Limit\"),\n\t\t\t\t\t\t\trun: () => {\n\t\t\t\t\t\t\t\tthis._textResourceConfigurationService.updateValue(this._diffEditor.getModel()!.modified.uri, 'diffEditor.maxComputationTime', 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}],\n\t\t\t\t\t\t{}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n}\n\nregisterDiffEditorContribution(DiffEditorHelperContribution.ID, DiffEditorHelperContribution);\n\nRegistry.as<IConfigurationMigrationRegistry>(Extensions.ConfigurationMigration)\n\t.registerConfigurationMigrations([{\n\t\tkey: 'diffEditor.experimental.collapseUnchangedRegions',\n\t\tmigrateFn: (value, accessor) => {\n\t\t\treturn [\n\t\t\t\t['diffEditor.hideUnchangedRegions.enabled', { value }],\n\t\t\t\t['diffEditor.experimental.collapseUnchangedRegions', { value: undefined }]\n\t\t\t];\n\t\t}\n\t}]);\nAccessibleViewRegistry.register(new DiffEditorAccessibilityHelp());\n"]}