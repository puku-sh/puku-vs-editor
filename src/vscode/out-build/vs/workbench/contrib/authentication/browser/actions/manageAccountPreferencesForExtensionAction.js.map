{"version":3,"sources":["vs/workbench/contrib/authentication/browser/actions/manageAccountPreferencesForExtensionAction.ts"],"names":[],"mappings":"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","file":"manageAccountPreferencesForExtensionAction.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\nimport { IQuickInputService, IQuickPick, IQuickPickItem, QuickPickInput } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { AuthenticationSessionAccount, IAuthenticationService } from '../../../../services/authentication/common/authentication.js';\nimport { IAuthenticationQueryService } from '../../../../services/authentication/common/authenticationQuery.js';\nimport { IExtensionService } from '../../../../services/extensions/common/extensions.js';\n\nexport class ManageAccountPreferencesForExtensionAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: '_manageAccountPreferencesForExtension',\n\t\t\ttitle: localize2('manageAccountPreferenceForExtension', \"Manage Extension Account Preferences...\"),\n\t\t\tcategory: localize2('accounts', \"Accounts\"),\n\t\t\tf1: true,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.AccountsContext,\n\t\t\t\torder: 100,\n\t\t\t}],\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, extensionId?: string, providerId?: string): Promise<void> {\n\t\treturn accessor.get(IInstantiationService).createInstance(ManageAccountPreferenceForExtensionActionImpl).run(extensionId, providerId);\n\t}\n}\n\ntype AccountPreferenceQuickPickItem = NewAccountQuickPickItem | ExistingAccountQuickPickItem;\n\ninterface NewAccountQuickPickItem extends IQuickPickItem {\n\taccount?: undefined;\n\tscopes: readonly string[];\n\tproviderId: string;\n}\n\ninterface ExistingAccountQuickPickItem extends IQuickPickItem {\n\taccount: AuthenticationSessionAccount;\n\tscopes?: undefined;\n\tproviderId: string;\n}\n\nclass ManageAccountPreferenceForExtensionActionImpl {\n\tconstructor(\n\t\t@IAuthenticationService private readonly _authenticationService: IAuthenticationService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@IDialogService private readonly _dialogService: IDialogService,\n\t\t@IAuthenticationQueryService private readonly _authenticationQueryService: IAuthenticationQueryService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@ILogService private readonly _logService: ILogService\n\t) { }\n\n\tasync run(extensionId?: string, providerId?: string) {\n\t\tif (!extensionId) {\n\t\t\tconst extensions = this._extensionService.extensions\n\t\t\t\t.filter(ext => this._authenticationQueryService.extension(ext.identifier.value).getAllAccountPreferences().size > 0)\n\t\t\t\t.sort((a, b) => (a.displayName ?? a.name).localeCompare((b.displayName ?? b.name)));\n\n\t\t\tconst result = await this._quickInputService.pick(extensions.map(ext => ({\n\t\t\t\tlabel: ext.displayName ?? ext.name,\n\t\t\t\tid: ext.identifier.value\n\t\t\t})), {\n\t\t\t\tplaceHolder: localize('selectExtension', \"Select an extension to manage account preferences for\"),\n\t\t\t\ttitle: localize('pickAProviderTitle', \"Manage Extension Account Preferences\")\n\t\t\t});\n\t\t\textensionId = result?.id;\n\t\t}\n\t\tif (!extensionId) {\n\t\t\treturn;\n\t\t}\n\t\tconst extension = await this._extensionService.getExtension(extensionId);\n\t\tif (!extension) {\n\t\t\tthrow new Error(`No extension with id ${extensionId}`);\n\t\t}\n\n\t\tif (!providerId) {\n\t\t\t// Use the query service's extension-centric approach to find providers that have been used\n\t\t\tconst extensionQuery = this._authenticationQueryService.extension(extensionId);\n\t\t\tconst providersWithAccess = await extensionQuery.getProvidersWithAccess();\n\t\t\tif (!providersWithAccess.length) {\n\t\t\t\tawait this._dialogService.info(localize('noAccountUsage', \"This extension has not used any accounts yet.\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tproviderId = providersWithAccess[0]; // Default to the first provider\n\t\t\tif (providersWithAccess.length > 1) {\n\t\t\t\tconst result = await this._quickInputService.pick(\n\t\t\t\t\tprovidersWithAccess.map(providerId => ({\n\t\t\t\t\t\tlabel: this._authenticationService.getProvider(providerId).label,\n\t\t\t\t\t\tid: providerId,\n\t\t\t\t\t})),\n\t\t\t\t\t{\n\t\t\t\t\t\tplaceHolder: localize('selectProvider', \"Select an authentication provider to manage account preferences for\"),\n\t\t\t\t\t\ttitle: localize('pickAProviderTitle', \"Manage Extension Account Preferences\")\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn; // User cancelled\n\t\t\t\t}\n\t\t\t\tproviderId = result.id;\n\t\t\t}\n\t\t}\n\n\t\t// Only fetch accounts for the chosen provider\n\t\tconst accounts = await this._authenticationService.getAccounts(providerId);\n\t\tconst currentAccountNamePreference = this._authenticationQueryService.provider(providerId).extension(extensionId).getPreferredAccount();\n\t\tconst items: Array<QuickPickInput<AccountPreferenceQuickPickItem>> = this._getItems(accounts, providerId, currentAccountNamePreference);\n\n\t\t// If the provider supports multiple accounts, add an option to use a new account\n\t\tconst provider = this._authenticationService.getProvider(providerId);\n\t\tif (provider.supportsMultipleAccounts) {\n\t\t\t// Get the last used scopes for the last used account. This will be used to pre-fill the scopes when adding a new account.\n\t\t\t// If there's no scopes, then don't add this option.\n\t\t\tconst lastUsedScopes = accounts\n\t\t\t\t.flatMap(account => this._authenticationQueryService.provider(providerId).account(account.label).extension(extensionId).getUsage())\n\t\t\t\t.sort((a, b) => b.lastUsed - a.lastUsed)[0]?.scopes; // Sort by timestamp and take the most recent\n\t\t\tif (lastUsedScopes) {\n\t\t\t\titems.push({ type: 'separator' });\n\t\t\t\titems.push({\n\t\t\t\t\tproviderId,\n\t\t\t\t\tscopes: lastUsedScopes,\n\t\t\t\t\tlabel: localize('use new account', \"Use a new account...\"),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst picker = this._createQuickPick(disposables, extensionId, extension.displayName ?? extension.name, provider.label);\n\t\tif (items.length === 0) {\n\t\t\t// We would only get here if we went through the Command Palette\n\t\t\tdisposables.add(this._handleNoAccounts(picker));\n\t\t\treturn;\n\t\t}\n\t\tpicker.items = items;\n\t\tpicker.show();\n\t}\n\n\tprivate _createQuickPick(disposableStore: DisposableStore, extensionId: string, extensionLabel: string, providerLabel: string) {\n\t\tconst picker = disposableStore.add(this._quickInputService.createQuickPick<AccountPreferenceQuickPickItem>({ useSeparators: true }));\n\t\tdisposableStore.add(picker.onDidHide(() => {\n\t\t\tdisposableStore.dispose();\n\t\t}));\n\t\tpicker.placeholder = localize('placeholder v2', \"Manage '{0}' account preferences for {1}...\", extensionLabel, providerLabel);\n\t\tpicker.title = localize('title', \"'{0}' Account Preferences For This Workspace\", extensionLabel);\n\t\tpicker.sortByLabel = false;\n\t\tdisposableStore.add(picker.onDidAccept(async () => {\n\t\t\tpicker.hide();\n\t\t\tawait this._accept(extensionId, picker.selectedItems);\n\t\t}));\n\t\treturn picker;\n\t}\n\n\tprivate _getItems(accounts: ReadonlyArray<AuthenticationSessionAccount>, providerId: string, currentAccountNamePreference: string | undefined): Array<QuickPickInput<AccountPreferenceQuickPickItem>> {\n\t\treturn accounts.map<QuickPickInput<AccountPreferenceQuickPickItem>>(a => currentAccountNamePreference === a.label\n\t\t\t? {\n\t\t\t\tlabel: a.label,\n\t\t\t\taccount: a,\n\t\t\t\tproviderId,\n\t\t\t\tdescription: localize('currentAccount', \"Current account\"),\n\t\t\t\tpicked: true\n\t\t\t}\n\t\t\t: {\n\t\t\t\tlabel: a.label,\n\t\t\t\taccount: a,\n\t\t\t\tproviderId,\n\t\t\t}\n\t\t);\n\t}\n\n\tprivate _handleNoAccounts(picker: IQuickPick<IQuickPickItem, { useSeparators: true }>): IDisposable {\n\t\tpicker.validationMessage = localize('noAccounts', \"No accounts are currently used by this extension.\");\n\t\tpicker.buttons = [this._quickInputService.backButton];\n\t\tpicker.show();\n\t\treturn Event.filter(picker.onDidTriggerButton, (e) => e === this._quickInputService.backButton)(() => this.run());\n\t}\n\n\tprivate async _accept(extensionId: string, selectedItems: ReadonlyArray<AccountPreferenceQuickPickItem>) {\n\t\tfor (const item of selectedItems) {\n\t\t\tlet account: AuthenticationSessionAccount;\n\t\t\tif (!item.account) {\n\t\t\t\ttry {\n\t\t\t\t\tconst session = await this._authenticationService.createSession(item.providerId, [...item.scopes]);\n\t\t\t\t\taccount = session.account;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis._logService.error(e);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\taccount = item.account;\n\t\t\t}\n\t\t\tconst providerId = item.providerId;\n\t\t\tconst extensionQuery = this._authenticationQueryService.provider(providerId).extension(extensionId);\n\t\t\tconst currentAccountName = extensionQuery.getPreferredAccount();\n\t\t\tif (currentAccountName === account.label) {\n\t\t\t\t// This account is already the preferred account\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\textensionQuery.setPreferredAccount(account);\n\t\t}\n\t}\n}\n"]}