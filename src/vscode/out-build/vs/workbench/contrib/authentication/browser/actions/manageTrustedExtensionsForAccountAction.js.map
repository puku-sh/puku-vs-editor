{"version":3,"sources":["vs/workbench/contrib/authentication/browser/actions/manageTrustedExtensionsForAccountAction.ts"],"names":[],"mappings":"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","file":"manageTrustedExtensionsForAccountAction.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { fromNow } from '../../../../../base/common/date.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2 } from '../../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickInputService, IQuickPickItem, IQuickPickSeparator } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { AllowedExtension, IAuthenticationService } from '../../../../services/authentication/common/authentication.js';\nimport { IAuthenticationQueryService, IAccountQuery } from '../../../../services/authentication/common/authenticationQuery.js';\nimport { IExtensionService } from '../../../../services/extensions/common/extensions.js';\nimport { IExtensionsWorkbenchService } from '../../../extensions/common/extensions.js';\n\nexport class ManageTrustedExtensionsForAccountAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: '_manageTrustedExtensionsForAccount',\n\t\t\ttitle: localize2('manageTrustedExtensionsForAccount', \"Manage Trusted Extensions For Account\"),\n\t\t\tcategory: localize2('accounts', \"Accounts\"),\n\t\t\tf1: true\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, options?: { providerId: string; accountLabel: string }): Promise<void> {\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\treturn instantiationService.createInstance(ManageTrustedExtensionsForAccountActionImpl).run(options);\n\t}\n}\n\ninterface TrustedExtensionsQuickPickItem extends IQuickPickItem {\n\textension: AllowedExtension;\n\tlastUsed?: number;\n}\n\nclass ManageTrustedExtensionsForAccountActionImpl {\n\tprivate readonly _viewDetailsButton = {\n\t\ttooltip: localize('viewExtensionDetails', \"View extension details\"),\n\t\ticonClass: ThemeIcon.asClassName(Codicon.info),\n\t};\n\n\tprivate readonly _managePreferencesButton = {\n\t\ttooltip: localize('accountPreferences', \"Manage account preferences for this extension\"),\n\t\ticonClass: ThemeIcon.asClassName(Codicon.settingsGear),\n\t};\n\n\tconstructor(\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@IDialogService private readonly _dialogService: IDialogService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@IAuthenticationService private readonly _authenticationService: IAuthenticationService,\n\t\t@IAuthenticationQueryService private readonly _authenticationQueryService: IAuthenticationQueryService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IExtensionsWorkbenchService private readonly _extensionsWorkbenchService: IExtensionsWorkbenchService\n\t) { }\n\n\tasync run(options?: { providerId: string; accountLabel: string }) {\n\t\tconst accountQuery = await this._resolveAccountQuery(options?.providerId, options?.accountLabel);\n\t\tif (!accountQuery) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = await this._getItems(accountQuery);\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst picker = this._createQuickPick(accountQuery);\n\t\tpicker.items = items;\n\t\tpicker.selectedItems = items.filter((i): i is TrustedExtensionsQuickPickItem => i.type !== 'separator' && !!i.picked);\n\t\tpicker.show();\n\t}\n\n\t//#region Account Query Resolution\n\n\tprivate async _resolveAccountQuery(providerId: string | undefined, accountLabel: string | undefined): Promise<IAccountQuery | undefined> {\n\t\tif (providerId && accountLabel) {\n\t\t\treturn this._authenticationQueryService.provider(providerId).account(accountLabel);\n\t\t}\n\n\t\tconst accounts = await this._getAllAvailableAccounts();\n\t\tconst pick = await this._quickInputService.pick(accounts, {\n\t\t\tplaceHolder: localize('pickAccount', \"Pick an account to manage trusted extensions for\"),\n\t\t\tmatchOnDescription: true,\n\t\t});\n\n\t\treturn pick ? this._authenticationQueryService.provider(pick.providerId).account(pick.label) : undefined;\n\t}\n\n\tprivate async _getAllAvailableAccounts() {\n\t\tconst accounts = [];\n\t\tfor (const providerId of this._authenticationService.getProviderIds()) {\n\t\t\tconst provider = this._authenticationService.getProvider(providerId);\n\t\t\tconst sessions = await this._authenticationService.getSessions(providerId);\n\t\t\tconst uniqueLabels = new Set<string>();\n\n\t\t\tfor (const session of sessions) {\n\t\t\t\tif (!uniqueLabels.has(session.account.label)) {\n\t\t\t\t\tuniqueLabels.add(session.account.label);\n\t\t\t\t\taccounts.push({\n\t\t\t\t\t\tproviderId,\n\t\t\t\t\t\tlabel: session.account.label,\n\t\t\t\t\t\tdescription: provider.label\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn accounts;\n\t}\n\n\t//#endregion\n\n\t//#region Item Retrieval and Quick Pick Creation\n\n\tprivate async _getItems(accountQuery: IAccountQuery) {\n\t\tconst allowedExtensions = accountQuery.extensions().getAllowedExtensions();\n\t\tconst extensionIdToDisplayName = new Map<string, string>();\n\n\t\t// Get display names for all allowed extensions\n\t\tconst resolvedExtensions = await Promise.all(allowedExtensions.map(ext => this._extensionService.getExtension(ext.id)));\n\t\tresolvedExtensions.forEach((resolved, i) => {\n\t\t\tif (resolved) {\n\t\t\t\textensionIdToDisplayName.set(allowedExtensions[i].id, resolved.displayName || resolved.name);\n\t\t\t}\n\t\t});\n\n\t\t// Filter out extensions that are not currently installed and enrich with display names\n\t\tconst filteredExtensions = allowedExtensions\n\t\t\t.filter(ext => extensionIdToDisplayName.has(ext.id))\n\t\t\t.map(ext => {\n\t\t\t\tconst usage = accountQuery.extension(ext.id).getUsage();\n\t\t\t\treturn {\n\t\t\t\t\t...ext,\n\t\t\t\t\t// Use the extension display name from the extension service\n\t\t\t\t\tname: extensionIdToDisplayName.get(ext.id)!,\n\t\t\t\t\tlastUsed: usage.length > 0 ? Math.max(...usage.map(u => u.lastUsed)) : ext.lastUsed\n\t\t\t\t};\n\t\t\t});\n\n\t\tif (!filteredExtensions.length) {\n\t\t\tthis._dialogService.info(localize('noTrustedExtensions', \"This account has not been used by any extensions.\"));\n\t\t\treturn [];\n\t\t}\n\n\t\tconst trustedExtensions = filteredExtensions.filter(e => e.trusted);\n\t\tconst otherExtensions = filteredExtensions.filter(e => !e.trusted);\n\t\tconst sortByLastUsed = (a: AllowedExtension, b: AllowedExtension) => (b.lastUsed || 0) - (a.lastUsed || 0);\n\n\t\tconst _toQuickPickItem = this._toQuickPickItem.bind(this);\n\t\treturn [\n\t\t\t...otherExtensions.sort(sortByLastUsed).map(_toQuickPickItem),\n\t\t\t{ type: 'separator', label: localize('trustedExtensions', \"Trusted by Microsoft\") } satisfies IQuickPickSeparator,\n\t\t\t...trustedExtensions.sort(sortByLastUsed).map(_toQuickPickItem)\n\t\t];\n\t}\n\n\tprivate _toQuickPickItem(extension: AllowedExtension): TrustedExtensionsQuickPickItem {\n\t\tconst lastUsed = extension.lastUsed;\n\t\tconst description = lastUsed\n\t\t\t? localize({ key: 'accountLastUsedDate', comment: ['The placeholder {0} is a string with time information, such as \"3 days ago\"'] }, \"Last used this account {0}\", fromNow(lastUsed, true))\n\t\t\t: localize('notUsed', \"Has not used this account\");\n\t\tlet tooltip: string | undefined;\n\t\tlet disabled: boolean | undefined;\n\t\tif (extension.trusted) {\n\t\t\ttooltip = localize('trustedExtensionTooltip', \"This extension is trusted by Microsoft and\\nalways has access to this account\");\n\t\t\tdisabled = true;\n\t\t}\n\t\treturn {\n\t\t\tlabel: extension.name,\n\t\t\textension,\n\t\t\tdescription,\n\t\t\ttooltip,\n\t\t\tdisabled,\n\t\t\tbuttons: [this._viewDetailsButton, this._managePreferencesButton],\n\t\t\tpicked: extension.allowed === undefined || extension.allowed\n\t\t};\n\t}\n\n\tprivate _createQuickPick(accountQuery: IAccountQuery) {\n\t\tconst disposableStore = new DisposableStore();\n\t\tconst quickPick = disposableStore.add(this._quickInputService.createQuickPick<TrustedExtensionsQuickPickItem>({ useSeparators: true }));\n\n\t\t// Configure quick pick\n\t\tquickPick.canSelectMany = true;\n\t\tquickPick.customButton = true;\n\t\tquickPick.customLabel = localize('manageTrustedExtensions.cancel', 'Cancel');\n\t\tquickPick.title = localize('manageTrustedExtensions', \"Manage Trusted Extensions\");\n\t\tquickPick.placeholder = localize('manageExtensions', \"Choose which extensions can access this account\");\n\n\t\t// Set up event handlers\n\t\tdisposableStore.add(quickPick.onDidAccept(() => {\n\t\t\tconst updatedAllowedList = quickPick.items\n\t\t\t\t.filter((item): item is TrustedExtensionsQuickPickItem => item.type !== 'separator')\n\t\t\t\t.map(i => i.extension);\n\n\t\t\tconst allowedExtensionsSet = new Set(quickPick.selectedItems.map(i => i.extension));\n\t\t\tfor (const extension of updatedAllowedList) {\n\t\t\t\tconst allowed = allowedExtensionsSet.has(extension);\n\t\t\t\taccountQuery.extension(extension.id).setAccessAllowed(allowed, extension.name);\n\t\t\t}\n\t\t\tquickPick.hide();\n\t\t}));\n\n\t\tdisposableStore.add(quickPick.onDidHide(() => disposableStore.dispose()));\n\t\tdisposableStore.add(quickPick.onDidCustom(() => quickPick.hide()));\n\t\tdisposableStore.add(quickPick.onDidTriggerItemButton(e => {\n\t\t\tif (e.button === this._managePreferencesButton) {\n\t\t\t\tthis._commandService.executeCommand('_manageAccountPreferencesForExtension', e.item.extension.id, accountQuery.providerId);\n\t\t\t} else if (e.button === this._viewDetailsButton) {\n\t\t\t\tthis._extensionsWorkbenchService.open(e.item.extension.id);\n\t\t\t}\n\t\t}));\n\n\t\treturn quickPick;\n\t}\n\n\t//#endregion\n}\n"]}