{"version":3,"sources":["vs/workbench/contrib/typeHierarchy/browser/typeHierarchy.contribution.ts"],"names":[],"mappings":"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","file":"typeHierarchy.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { EditorAction2, EditorContributionInstantiation, registerEditorContribution, ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { IEditorContribution } from '../../../../editor/common/editorCommon.js';\nimport { PeekContext } from '../../../../editor/contrib/peekView/browser/peekView.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { MenuId, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr, IContextKey, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { TypeHierarchyTreePeekWidget } from './typeHierarchyPeek.js';\nimport { TypeHierarchyDirection, TypeHierarchyModel, TypeHierarchyProviderRegistry } from '../common/typeHierarchy.js';\n\n\nconst _ctxHasTypeHierarchyProvider = new RawContextKey<boolean>('editorHasTypeHierarchyProvider', false, localize('editorHasTypeHierarchyProvider', 'Whether a type hierarchy provider is available'));\nconst _ctxTypeHierarchyVisible = new RawContextKey<boolean>('typeHierarchyVisible', false, localize('typeHierarchyVisible', 'Whether type hierarchy peek is currently showing'));\nconst _ctxTypeHierarchyDirection = new RawContextKey<string>('typeHierarchyDirection', undefined, { type: 'string', description: localize('typeHierarchyDirection', 'whether type hierarchy shows super types or subtypes') });\n\nfunction sanitizedDirection(candidate: string): TypeHierarchyDirection {\n\treturn candidate === TypeHierarchyDirection.Subtypes || candidate === TypeHierarchyDirection.Supertypes\n\t\t? candidate\n\t\t: TypeHierarchyDirection.Subtypes;\n}\n\nclass TypeHierarchyController implements IEditorContribution {\n\tstatic readonly Id = 'typeHierarchy';\n\n\tstatic get(editor: ICodeEditor): TypeHierarchyController | null {\n\t\treturn editor.getContribution<TypeHierarchyController>(TypeHierarchyController.Id);\n\t}\n\n\tprivate static readonly _storageDirectionKey = 'typeHierarchy/defaultDirection';\n\n\tprivate readonly _ctxHasProvider: IContextKey<boolean>;\n\tprivate readonly _ctxIsVisible: IContextKey<boolean>;\n\tprivate readonly _ctxDirection: IContextKey<string>;\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _sessionDisposables = new DisposableStore();\n\n\tprivate _widget?: TypeHierarchyTreePeekWidget;\n\n\tconstructor(\n\t\treadonly _editor: ICodeEditor,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@ICodeEditorService private readonly _editorService: ICodeEditorService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) {\n\t\tthis._ctxHasProvider = _ctxHasTypeHierarchyProvider.bindTo(this._contextKeyService);\n\t\tthis._ctxIsVisible = _ctxTypeHierarchyVisible.bindTo(this._contextKeyService);\n\t\tthis._ctxDirection = _ctxTypeHierarchyDirection.bindTo(this._contextKeyService);\n\t\tthis._disposables.add(Event.any<any>(_editor.onDidChangeModel, _editor.onDidChangeModelLanguage, TypeHierarchyProviderRegistry.onDidChange)(() => {\n\t\t\tthis._ctxHasProvider.set(_editor.hasModel() && TypeHierarchyProviderRegistry.has(_editor.getModel()));\n\t\t}));\n\t\tthis._disposables.add(this._sessionDisposables);\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n\n\t// Peek\n\tasync startTypeHierarchyFromEditor(): Promise<void> {\n\t\tthis._sessionDisposables.clear();\n\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst document = this._editor.getModel();\n\t\tconst position = this._editor.getPosition();\n\t\tif (!TypeHierarchyProviderRegistry.has(document)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tconst model = TypeHierarchyModel.create(document, position, cts.token);\n\t\tconst direction = sanitizedDirection(this._storageService.get(TypeHierarchyController._storageDirectionKey, StorageScope.PROFILE, TypeHierarchyDirection.Subtypes));\n\n\t\tthis._showTypeHierarchyWidget(position, direction, model, cts);\n\t}\n\n\tprivate _showTypeHierarchyWidget(position: Position, direction: TypeHierarchyDirection, model: Promise<TypeHierarchyModel | undefined>, cts: CancellationTokenSource) {\n\n\t\tthis._ctxIsVisible.set(true);\n\t\tthis._ctxDirection.set(direction);\n\t\tEvent.any<any>(this._editor.onDidChangeModel, this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy, this, this._sessionDisposables);\n\t\tthis._widget = this._instantiationService.createInstance(TypeHierarchyTreePeekWidget, this._editor, position, direction);\n\t\tthis._widget.showLoading();\n\t\tthis._sessionDisposables.add(this._widget.onDidClose(() => {\n\t\t\tthis.endTypeHierarchy();\n\t\t\tthis._storageService.store(TypeHierarchyController._storageDirectionKey, this._widget!.direction, StorageScope.PROFILE, StorageTarget.USER);\n\t\t}));\n\t\tthis._sessionDisposables.add({ dispose() { cts.dispose(true); } });\n\t\tthis._sessionDisposables.add(this._widget);\n\n\t\tmodel.then(model => {\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\treturn; // nothing\n\t\t\t}\n\t\t\tif (model) {\n\t\t\t\tthis._sessionDisposables.add(model);\n\t\t\t\tthis._widget!.showModel(model);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._widget!.showMessage(localize('no.item', \"No results\"));\n\t\t\t}\n\t\t}).catch(err => {\n\t\t\tif (isCancellationError(err)) {\n\t\t\t\tthis.endTypeHierarchy();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._widget!.showMessage(localize('error', \"Failed to show type hierarchy\"));\n\t\t});\n\t}\n\n\tasync startTypeHierarchyFromTypeHierarchy(): Promise<void> {\n\t\tif (!this._widget) {\n\t\t\treturn;\n\t\t}\n\t\tconst model = this._widget.getModel();\n\t\tconst typeItem = this._widget.getFocused();\n\t\tif (!typeItem || !model) {\n\t\t\treturn;\n\t\t}\n\t\tconst newEditor = await this._editorService.openCodeEditor({ resource: typeItem.item.uri }, this._editor);\n\t\tif (!newEditor) {\n\t\t\treturn;\n\t\t}\n\t\tconst newModel = model.fork(typeItem.item);\n\t\tthis._sessionDisposables.clear();\n\n\t\tTypeHierarchyController.get(newEditor)?._showTypeHierarchyWidget(\n\t\t\tRange.lift(newModel.root.selectionRange).getStartPosition(),\n\t\t\tthis._widget.direction,\n\t\t\tPromise.resolve(newModel),\n\t\t\tnew CancellationTokenSource()\n\t\t);\n\t}\n\n\tshowSupertypes(): void {\n\t\tthis._widget?.updateDirection(TypeHierarchyDirection.Supertypes);\n\t\tthis._ctxDirection.set(TypeHierarchyDirection.Supertypes);\n\t}\n\n\tshowSubtypes(): void {\n\t\tthis._widget?.updateDirection(TypeHierarchyDirection.Subtypes);\n\t\tthis._ctxDirection.set(TypeHierarchyDirection.Subtypes);\n\t}\n\n\tendTypeHierarchy(): void {\n\t\tthis._sessionDisposables.clear();\n\t\tthis._ctxIsVisible.set(false);\n\t\tthis._editor.focus();\n\t}\n}\n\nregisterEditorContribution(TypeHierarchyController.Id, TypeHierarchyController, EditorContributionInstantiation.Eager); // eager because it needs to define a context key\n\n// Peek\nregisterAction2(class PeekTypeHierarchyAction extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showTypeHierarchy',\n\t\t\ttitle: localize2('title', 'Peek Type Hierarchy'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorContextPeek,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1000,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t_ctxHasTypeHierarchyProvider,\n\t\t\t\t\tPeekContext.notInPeekEditor\n\t\t\t\t),\n\t\t\t},\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\t_ctxHasTypeHierarchyProvider,\n\t\t\t\tPeekContext.notInPeekEditor\n\t\t\t),\n\t\t\tf1: true\n\t\t});\n\t}\n\n\tasync runEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\treturn TypeHierarchyController.get(editor)?.startTypeHierarchyFromEditor();\n\t}\n});\n\n// actions for peek widget\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showSupertypes',\n\t\t\ttitle: localize2('title.supertypes', 'Show Supertypes'),\n\t\t\ticon: Codicon.typeHierarchySuper,\n\t\t\tprecondition: ContextKeyExpr.and(_ctxTypeHierarchyVisible, _ctxTypeHierarchyDirection.isEqualTo(TypeHierarchyDirection.Subtypes)),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyMod.Alt + KeyCode.KeyH,\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: TypeHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\twhen: _ctxTypeHierarchyDirection.isEqualTo(TypeHierarchyDirection.Subtypes),\n\t\t\t\torder: 1,\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\treturn TypeHierarchyController.get(editor)?.showSupertypes();\n\t}\n});\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showSubtypes',\n\t\t\ttitle: localize2('title.subtypes', 'Show Subtypes'),\n\t\t\ticon: Codicon.typeHierarchySub,\n\t\t\tprecondition: ContextKeyExpr.and(_ctxTypeHierarchyVisible, _ctxTypeHierarchyDirection.isEqualTo(TypeHierarchyDirection.Supertypes)),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyMod.Alt + KeyCode.KeyH,\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: TypeHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\twhen: _ctxTypeHierarchyDirection.isEqualTo(TypeHierarchyDirection.Supertypes),\n\t\t\t\torder: 1,\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\treturn TypeHierarchyController.get(editor)?.showSubtypes();\n\t}\n});\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.refocusTypeHierarchy',\n\t\t\ttitle: localize2('title.refocusTypeHierarchy', 'Refocus Type Hierarchy'),\n\t\t\tprecondition: _ctxTypeHierarchyVisible,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyCode.Enter\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\treturn TypeHierarchyController.get(editor)?.startTypeHierarchyFromTypeHierarchy();\n\t}\n});\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.closeTypeHierarchy',\n\t\t\ttitle: localize('close', 'Close'),\n\t\t\ticon: Codicon.close,\n\t\t\tprecondition: _ctxTypeHierarchyVisible,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib + 10,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\twhen: ContextKeyExpr.not('config.editor.stablePeek')\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: TypeHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\torder: 1000\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\treturn TypeHierarchyController.get(editor)?.endTypeHierarchy();\n\t}\n});\n"]}