{"version":3,"sources":["vs/workbench/contrib/multiDiffEditor/browser/scmMultiDiffSourceResolver.ts"],"names":[],"mappings":"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","file":"scmMultiDiffSourceResolver.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ValueWithChangeEvent } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { observableFromEvent, ValueWithChangeEventFromObservable, waitForState } from '../../../../base/common/observable.js';\nimport { basename } from '../../../../base/common/path.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IMultiDiffEditorOptions } from '../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.js';\nimport { localize2 } from '../../../../nls.js';\nimport { Action2 } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyValue } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IActivityService, ProgressBadge } from '../../../services/activity/common/activity.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { ISCMProvider, ISCMRepository, ISCMResourceGroup, ISCMService } from '../../scm/common/scm.js';\nimport { IMultiDiffSourceResolver, IMultiDiffSourceResolverService, IResolvedMultiDiffSource, MultiDiffEditorItem } from './multiDiffSourceResolverService.js';\n\nexport class ScmMultiDiffSourceResolver implements IMultiDiffSourceResolver {\n\tprivate static readonly _scheme = 'scm-multi-diff-source';\n\n\tpublic static getMultiDiffSourceUri(repositoryUri: string, groupId: string): URI {\n\t\treturn URI.from({\n\t\t\tscheme: ScmMultiDiffSourceResolver._scheme,\n\t\t\tquery: JSON.stringify({ repositoryUri, groupId } satisfies UriFields),\n\t\t});\n\t}\n\n\tprivate static parseUri(uri: URI): { repositoryUri: URI; groupId: string } | undefined {\n\t\tif (uri.scheme !== ScmMultiDiffSourceResolver._scheme) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet query: UriFields;\n\t\ttry {\n\t\t\tquery = JSON.parse(uri.query) as UriFields;\n\t\t} catch (e) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (typeof query !== 'object' || query === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { repositoryUri, groupId } = query;\n\t\tif (typeof repositoryUri !== 'string' || typeof groupId !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn { repositoryUri: URI.parse(repositoryUri), groupId };\n\t}\n\n\tconstructor(\n\t\t@ISCMService private readonly _scmService: ISCMService,\n\t\t@IActivityService private readonly _activityService: IActivityService,\n\t) {\n\t}\n\n\tcanHandleUri(uri: URI): boolean {\n\t\treturn ScmMultiDiffSourceResolver.parseUri(uri) !== undefined;\n\t}\n\n\tasync resolveDiffSource(uri: URI): Promise<IResolvedMultiDiffSource> {\n\t\tconst { repositoryUri, groupId } = ScmMultiDiffSourceResolver.parseUri(uri)!;\n\n\t\tconst repository = await waitForState(observableFromEvent(this,\n\t\t\tthis._scmService.onDidAddRepository,\n\t\t\t() => [...this._scmService.repositories].find(r => r.provider.rootUri?.toString() === repositoryUri.toString()))\n\t\t);\n\t\tconst group = await waitForState(observableFromEvent(this,\n\t\t\trepository.provider.onDidChangeResourceGroups,\n\t\t\t() => repository.provider.groups.find(g => g.id === groupId)\n\t\t));\n\n\t\tconst scmActivities = observableFromEvent(\n\t\t\tthis._activityService.onDidChangeActivity,\n\t\t\t() => [...this._activityService.getViewContainerActivities('workbench.view.scm')],\n\t\t);\n\t\tconst scmViewHasNoProgressBadge = scmActivities.map(activities => !activities.some(a => a.badge instanceof ProgressBadge));\n\t\tawait waitForState(scmViewHasNoProgressBadge, v => v);\n\n\t\treturn new ScmResolvedMultiDiffSource(group, repository);\n\t}\n}\n\ninterface ScmHistoryItemUriFields {\n\treadonly repositoryId: string;\n\treadonly historyItemId: string;\n\treadonly historyItemParentId?: string;\n\treadonly historyItemDisplayId?: string;\n}\n\nexport class ScmHistoryItemResolver implements IMultiDiffSourceResolver {\n\tstatic readonly scheme = 'scm-history-item';\n\n\tpublic static getMultiDiffSourceUri(provider: ISCMProvider, historyItemId: string, historyItemParentId: string | undefined, historyItemDisplayId: string | undefined): URI {\n\t\treturn URI.from({\n\t\t\tscheme: ScmHistoryItemResolver.scheme,\n\t\t\tpath: provider.rootUri?.fsPath,\n\t\t\tquery: JSON.stringify({\n\t\t\t\trepositoryId: provider.id,\n\t\t\t\thistoryItemId,\n\t\t\t\thistoryItemParentId,\n\t\t\t\thistoryItemDisplayId\n\t\t\t} satisfies ScmHistoryItemUriFields)\n\t\t}, true);\n\t}\n\n\tpublic static parseUri(uri: URI): ScmHistoryItemUriFields | undefined {\n\t\tif (uri.scheme !== ScmHistoryItemResolver.scheme) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet query: ScmHistoryItemUriFields;\n\t\ttry {\n\t\t\tquery = JSON.parse(uri.query) as ScmHistoryItemUriFields;\n\t\t} catch (e) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (typeof query !== 'object' || query === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { repositoryId, historyItemId, historyItemParentId, historyItemDisplayId } = query;\n\t\tif (typeof repositoryId !== 'string' || typeof historyItemId !== 'string' ||\n\t\t\t(typeof historyItemParentId !== 'string' && historyItemParentId !== undefined) ||\n\t\t\t(typeof historyItemDisplayId !== 'string' && historyItemDisplayId !== undefined)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn { repositoryId, historyItemId, historyItemParentId, historyItemDisplayId };\n\t}\n\n\tconstructor(@ISCMService private readonly _scmService: ISCMService) { }\n\n\tcanHandleUri(uri: URI): boolean {\n\t\treturn ScmHistoryItemResolver.parseUri(uri) !== undefined;\n\t}\n\n\tasync resolveDiffSource(uri: URI): Promise<IResolvedMultiDiffSource> {\n\t\tconst { repositoryId, historyItemId, historyItemParentId, historyItemDisplayId } = ScmHistoryItemResolver.parseUri(uri)!;\n\n\t\tconst repository = this._scmService.getRepository(repositoryId);\n\t\tconst historyProvider = repository?.provider.historyProvider.get();\n\t\tconst historyItemChanges = await historyProvider?.provideHistoryItemChanges(historyItemId, historyItemParentId) ?? [];\n\n\t\tconst resources = ValueWithChangeEvent.const<readonly MultiDiffEditorItem[]>(\n\t\t\thistoryItemChanges.map(change => {\n\t\t\t\tconst goToFileEditorTitle = change.modifiedUri\n\t\t\t\t\t? `${basename(change.modifiedUri.fsPath)} (${historyItemDisplayId ?? historyItemId})`\n\t\t\t\t\t: undefined;\n\n\t\t\t\treturn new MultiDiffEditorItem(change.originalUri, change.modifiedUri, change.modifiedUri, goToFileEditorTitle);\n\t\t\t})\n\t\t);\n\n\t\treturn { resources };\n\t}\n}\n\nclass ScmResolvedMultiDiffSource implements IResolvedMultiDiffSource {\n\tprivate readonly _resources;\n\treadonly resources;\n\n\tpublic readonly contextKeys: Record<string, ContextKeyValue>;\n\n\tconstructor(\n\t\tprivate readonly _group: ISCMResourceGroup,\n\t\tprivate readonly _repository: ISCMRepository,\n\t) {\n\t\tthis._resources = observableFromEvent<MultiDiffEditorItem[]>(\n\t\t\tthis._group.onDidChangeResources,\n\t\t\t() => /** @description resources */ this._group.resources.map(e => new MultiDiffEditorItem(e.multiDiffEditorOriginalUri, e.multiDiffEditorModifiedUri, e.sourceUri))\n\t\t);\n\t\tthis.resources = new ValueWithChangeEventFromObservable(this._resources);\n\t\tthis.contextKeys = {\n\t\t\tscmResourceGroup: this._group.id,\n\t\t\tscmProvider: this._repository.provider.providerId,\n\t\t};\n\t}\n}\n\ninterface UriFields {\n\trepositoryUri: string;\n\tgroupId: string;\n}\n\nexport class ScmMultiDiffSourceResolverContribution extends Disposable {\n\n\tstatic readonly ID = 'workbench.contrib.scmMultiDiffSourceResolver';\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IMultiDiffSourceResolverService multiDiffSourceResolverService: IMultiDiffSourceResolverService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(multiDiffSourceResolverService.registerResolver(instantiationService.createInstance(ScmHistoryItemResolver)));\n\t\tthis._register(multiDiffSourceResolverService.registerResolver(instantiationService.createInstance(ScmMultiDiffSourceResolver)));\n\t}\n}\n\ninterface OpenScmGroupActionOptions {\n\ttitle: string;\n\trepositoryUri: UriComponents;\n\tresourceGroupId: string;\n}\n\nexport class OpenScmGroupAction extends Action2 {\n\tpublic static async openMultiFileDiffEditor(editorService: IEditorService, label: string, repositoryRootUri: URI | undefined, resourceGroupId: string, options?: IMultiDiffEditorOptions) {\n\t\tif (!repositoryRootUri) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst multiDiffSource = ScmMultiDiffSourceResolver.getMultiDiffSourceUri(repositoryRootUri.toString(), resourceGroupId);\n\t\treturn await editorService.openEditor({ label, multiDiffSource, options });\n\t}\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: '_workbench.openScmMultiDiffEditor',\n\t\t\ttitle: localize2('openChanges', 'Open Changes'),\n\t\t\tf1: false\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, options: OpenScmGroupActionOptions): Promise<void> {\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tawait OpenScmGroupAction.openMultiFileDiffEditor(editorService, options.title, URI.revive(options.repositoryUri), options.resourceGroupId);\n\t}\n}\n"]}