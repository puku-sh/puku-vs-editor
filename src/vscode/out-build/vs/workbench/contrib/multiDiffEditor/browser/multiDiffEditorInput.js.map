{"version":3,"sources":["vs/workbench/contrib/multiDiffEditor/browser/multiDiffEditorInput.ts"],"names":[],"mappings":"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","file":"multiDiffEditorInput.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { LazyStatefulPromise, raceTimeout } from '../../../../base/common/async.js';\nimport { BugIndicatingError, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Event, ValueWithChangeEvent } from '../../../../base/common/event.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore, IDisposable, IReference } from '../../../../base/common/lifecycle.js';\nimport { parse } from '../../../../base/common/marshalling.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { deepClone } from '../../../../base/common/objects.js';\nimport { ObservableLazyPromise, ValueWithChangeEventFromObservable, autorun, constObservable, derived, mapObservableArrayCached, observableFromEvent, observableFromValueWithChangeEvent, observableValue, recomputeInitiallyAndOnChange } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isDefined, isObject } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { RefCounted } from '../../../../editor/browser/widget/diffEditor/utils.js';\nimport { IDocumentDiffItem, IMultiDiffEditorModel } from '../../../../editor/browser/widget/multiDiffEditor/model.js';\nimport { MultiDiffEditorViewModel } from '../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorViewModel.js';\nimport { IDiffEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { IResolvedTextEditorModel, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { localize } from '../../../../nls.js';\nimport { ConfirmResult } from '../../../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorConfiguration } from '../../../browser/parts/editor/textEditor.js';\nimport { DEFAULT_EDITOR_ASSOCIATION, EditorInputCapabilities, EditorInputWithOptions, GroupIdentifier, IEditorSerializer, IResourceMultiDiffEditorInput, IRevertOptions, ISaveOptions, IUntypedEditorInput } from '../../../common/editor.js';\nimport { EditorInput, IEditorCloseHandler } from '../../../common/editor/editorInput.js';\nimport { IEditorResolverService, RegisteredEditorPriority } from '../../../services/editor/common/editorResolverService.js';\nimport { ILanguageSupport, ITextFileEditorModel, ITextFileService } from '../../../services/textfile/common/textfiles.js';\nimport { MultiDiffEditorIcon } from './icons.contribution.js';\nimport { IMultiDiffSourceResolverService, IResolvedMultiDiffSource, MultiDiffEditorItem } from './multiDiffSourceResolverService.js';\n\nexport class MultiDiffEditorInput extends EditorInput implements ILanguageSupport {\n\tpublic static fromResourceMultiDiffEditorInput(input: IResourceMultiDiffEditorInput, instantiationService: IInstantiationService): MultiDiffEditorInput {\n\t\tif (!input.multiDiffSource && !input.resources) {\n\t\t\tthrow new BugIndicatingError('MultiDiffEditorInput requires either multiDiffSource or resources');\n\t\t}\n\t\tconst multiDiffSource = input.multiDiffSource ?? URI.parse(`multi-diff-editor:${new Date().getMilliseconds().toString() + Math.random().toString()}`);\n\t\treturn instantiationService.createInstance(\n\t\t\tMultiDiffEditorInput,\n\t\t\tmultiDiffSource,\n\t\t\tinput.label,\n\t\t\tinput.resources?.map(resource => {\n\t\t\t\treturn new MultiDiffEditorItem(\n\t\t\t\t\tresource.original.resource,\n\t\t\t\t\tresource.modified.resource,\n\t\t\t\t\tresource.goToFileResource,\n\t\t\t\t);\n\t\t\t}),\n\t\t\tinput.isTransient ?? false\n\t\t);\n\t}\n\n\tpublic static fromSerialized(data: ISerializedMultiDiffEditorInput, instantiationService: IInstantiationService): MultiDiffEditorInput {\n\t\treturn instantiationService.createInstance(\n\t\t\tMultiDiffEditorInput,\n\t\t\tURI.parse(data.multiDiffSourceUri),\n\t\t\tdata.label,\n\t\t\tdata.resources?.map(resource => new MultiDiffEditorItem(\n\t\t\t\tresource.originalUri ? URI.parse(resource.originalUri) : undefined,\n\t\t\t\tresource.modifiedUri ? URI.parse(resource.modifiedUri) : undefined,\n\t\t\t\tresource.goToFileUri ? URI.parse(resource.goToFileUri) : undefined,\n\t\t\t)),\n\t\t\tfalse\n\t\t);\n\t}\n\n\tstatic readonly ID: string = 'workbench.input.multiDiffEditor';\n\n\tget resource(): URI | undefined { return this.multiDiffSource; }\n\n\toverride get capabilities(): EditorInputCapabilities { return EditorInputCapabilities.Readonly; }\n\toverride get typeId(): string { return MultiDiffEditorInput.ID; }\n\n\tprivate _name: string;\n\toverride getName(): string { return this._name; }\n\n\toverride get editorId(): string { return DEFAULT_EDITOR_ASSOCIATION.id; }\n\toverride getIcon(): ThemeIcon { return MultiDiffEditorIcon; }\n\n\tconstructor(\n\t\tpublic readonly multiDiffSource: URI,\n\t\tpublic readonly label: string | undefined,\n\t\tpublic readonly initialResources: readonly MultiDiffEditorItem[] | undefined,\n\t\tpublic readonly isTransient: boolean = false,\n\t\t@ITextModelService private readonly _textModelService: ITextModelService,\n\t\t@ITextResourceConfigurationService private readonly _textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IMultiDiffSourceResolverService private readonly _multiDiffSourceResolverService: IMultiDiffSourceResolverService,\n\t\t@ITextFileService private readonly _textFileService: ITextFileService,\n\t) {\n\t\tsuper();\n\t\tthis._name = '';\n\t\tthis._viewModel = new LazyStatefulPromise(async () => {\n\t\t\tconst model = await this._createModel();\n\t\t\tthis._register(model);\n\t\t\tconst vm = new MultiDiffEditorViewModel(model, this._instantiationService);\n\t\t\tthis._register(vm);\n\t\t\tawait raceTimeout(vm.waitForDiffs(), 1000);\n\t\t\treturn vm;\n\t\t});\n\t\tthis._resolvedSource = new ObservableLazyPromise(async () => {\n\t\t\tconst source: IResolvedMultiDiffSource | undefined = this.initialResources\n\t\t\t\t? { resources: ValueWithChangeEvent.const(this.initialResources) }\n\t\t\t\t: await this._multiDiffSourceResolverService.resolve(this.multiDiffSource);\n\t\t\treturn {\n\t\t\t\tsource,\n\t\t\t\tresources: source ? observableFromValueWithChangeEvent(this, source.resources) : constObservable([]),\n\t\t\t};\n\t\t});\n\t\tthis.resources = derived(this, reader => this._resolvedSource.cachedPromiseResult.read(reader)?.data?.resources.read(reader));\n\t\tthis.textFileServiceOnDidChange = new FastEventDispatcher<ITextFileEditorModel, URI>(\n\t\t\tthis._textFileService.files.onDidChangeDirty,\n\t\t\titem => item.resource.toString(),\n\t\t\turi => uri.toString()\n\t\t);\n\t\tthis._isDirtyObservables = mapObservableArrayCached(this, this.resources.map(r => r ?? []), res => {\n\t\t\tconst isModifiedDirty = res.modifiedUri ? isUriDirty(this.textFileServiceOnDidChange, this._textFileService, res.modifiedUri) : constObservable(false);\n\t\t\tconst isOriginalDirty = res.originalUri ? isUriDirty(this.textFileServiceOnDidChange, this._textFileService, res.originalUri) : constObservable(false);\n\t\t\treturn derived(reader => /** @description modifiedDirty||originalDirty */ isModifiedDirty.read(reader) || isOriginalDirty.read(reader));\n\t\t}, i => i.getKey());\n\t\tthis._isDirtyObservable = derived(this, reader => this._isDirtyObservables.read(reader).some(isDirty => isDirty.read(reader)))\n\t\t\t.keepObserved(this._store);\n\t\tthis.onDidChangeDirty = Event.fromObservableLight(this._isDirtyObservable);\n\t\tthis.closeHandler = {\n\n\t\t\t// This is a workaround for not having a better way\n\t\t\t// to figure out if the editors this input wraps\n\t\t\t// around are opened or not\n\n\t\t\tasync confirm() {\n\t\t\t\treturn ConfirmResult.DONT_SAVE;\n\t\t\t},\n\t\t\tshowConfirm() {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tthis._register(autorun((reader) => {\n\t\t\t/** @description Updates name */\n\t\t\tconst resources = this.resources.read(reader);\n\t\t\tconst label = this.label ?? localize('name', \"Multi Diff Editor\");\n\t\t\tif (resources && resources.length === 1) {\n\t\t\t\tthis._name = localize({ key: 'nameWithOneFile', comment: ['{0} is the name of the editor'] }, \"{0} (1 file)\", label);\n\t\t\t} else if (resources) {\n\t\t\t\tthis._name = localize({ key: 'nameWithFiles', comment: ['{0} is the name of the editor', '{1} is the number of files being shown'] }, \"{0} ({1} files)\", label, resources.length);\n\t\t\t} else {\n\t\t\t\tthis._name = label;\n\t\t\t}\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}));\n\t}\n\n\tpublic serialize(): ISerializedMultiDiffEditorInput {\n\t\treturn {\n\t\t\tlabel: this.label,\n\t\t\tmultiDiffSourceUri: this.multiDiffSource.toString(),\n\t\t\tresources: this.initialResources?.map(resource => ({\n\t\t\t\toriginalUri: resource.originalUri?.toString(),\n\t\t\t\tmodifiedUri: resource.modifiedUri?.toString(),\n\t\t\t\tgoToFileUri: resource.goToFileUri?.toString(),\n\t\t\t})),\n\t\t};\n\t}\n\n\tpublic setLanguageId(languageId: string, source?: string | undefined): void {\n\t\tconst activeDiffItem = this._viewModel.requireValue().activeDiffItem.get();\n\t\tconst value = activeDiffItem?.documentDiffItem;\n\t\tif (!value) { return; }\n\t\tconst target = value.modified ?? value.original;\n\t\tif (!target) { return; }\n\t\ttarget.setLanguage(languageId, source);\n\t}\n\n\tpublic async getViewModel(): Promise<MultiDiffEditorViewModel> {\n\t\treturn this._viewModel.getPromise();\n\t}\n\n\tprivate readonly _viewModel;\n\n\tprivate async _createModel(): Promise<IMultiDiffEditorModel & IDisposable> {\n\t\tconst source = await this._resolvedSource.getPromise();\n\t\tconst textResourceConfigurationService = this._textResourceConfigurationService;\n\n\t\tconst documentsWithPromises = mapObservableArrayCached(this, source.resources, async (r, store) => {\n\t\t\t/** @description documentsWithPromises */\n\t\t\tlet original: IReference<IResolvedTextEditorModel> | undefined;\n\t\t\tlet modified: IReference<IResolvedTextEditorModel> | undefined;\n\n\t\t\tconst multiDiffItemStore = new DisposableStore();\n\n\t\t\ttry {\n\t\t\t\t[original, modified] = await Promise.all([\n\t\t\t\t\tr.originalUri ? this._textModelService.createModelReference(r.originalUri) : undefined,\n\t\t\t\t\tr.modifiedUri ? this._textModelService.createModelReference(r.modifiedUri) : undefined,\n\t\t\t\t]);\n\t\t\t\tif (original) { multiDiffItemStore.add(original); }\n\t\t\t\tif (modified) { multiDiffItemStore.add(modified); }\n\t\t\t} catch (e) {\n\t\t\t\t// e.g. \"File seems to be binary and cannot be opened as text\"\n\t\t\t\tconsole.error(e);\n\t\t\t\tonUnexpectedError(e);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst uri = (r.modifiedUri ?? r.originalUri)!;\n\t\t\tconst result: IDocumentDiffItemWithMultiDiffEditorItem = {\n\t\t\t\tmultiDiffEditorItem: r,\n\t\t\t\toriginal: original?.object.textEditorModel,\n\t\t\t\tmodified: modified?.object.textEditorModel,\n\t\t\t\tcontextKeys: r.contextKeys,\n\t\t\t\tget options() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...getReadonlyConfiguration(modified?.object.isReadonly() ?? true),\n\t\t\t\t\t\t...computeOptions(textResourceConfigurationService.getValue(uri)),\n\t\t\t\t\t} satisfies IDiffEditorOptions;\n\t\t\t\t},\n\t\t\t\tonOptionsDidChange: h => this._textResourceConfigurationService.onDidChangeConfiguration(e => {\n\t\t\t\t\tif (e.affectsConfiguration(uri, 'editor') || e.affectsConfiguration(uri, 'diffEditor')) {\n\t\t\t\t\t\th();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t};\n\t\t\treturn store.add(RefCounted.createOfNonDisposable(result, multiDiffItemStore, this));\n\t\t}, i => JSON.stringify([i.modifiedUri?.toString(), i.originalUri?.toString()]));\n\n\t\tconst documents = observableValue<readonly RefCounted<IDocumentDiffItem>[] | 'loading'>('documents', 'loading');\n\n\t\tconst updateDocuments = derived(async reader => {\n\t\t\t/** @description Update documents */\n\t\t\tconst docsPromises = documentsWithPromises.read(reader);\n\t\t\tconst docs = await Promise.all(docsPromises);\n\t\t\tconst newDocuments = docs.filter(isDefined);\n\t\t\tdocuments.set(newDocuments, undefined);\n\t\t});\n\n\t\tconst a = recomputeInitiallyAndOnChange(updateDocuments);\n\t\tawait updateDocuments.get();\n\n\t\tconst result: IMultiDiffEditorModel & IDisposable = {\n\t\t\tdispose: () => a.dispose(),\n\t\t\tdocuments: new ValueWithChangeEventFromObservable(documents),\n\t\t\tcontextKeys: source.source?.contextKeys,\n\t\t};\n\t\treturn result;\n\t}\n\n\tprivate readonly _resolvedSource;\n\n\toverride matches(otherInput: EditorInput | IUntypedEditorInput): boolean {\n\t\tif (super.matches(otherInput)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (otherInput instanceof MultiDiffEditorInput) {\n\t\t\treturn this.multiDiffSource.toString() === otherInput.multiDiffSource.toString();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic readonly resources;\n\n\tprivate readonly textFileServiceOnDidChange;\n\n\tprivate readonly _isDirtyObservables;\n\tprivate readonly _isDirtyObservable;\n\n\toverride readonly onDidChangeDirty;\n\toverride isDirty() { return this._isDirtyObservable.get(); }\n\n\toverride async save(group: number, options?: ISaveOptions | undefined): Promise<EditorInput> {\n\t\tawait this.doSaveOrRevert('save', group, options);\n\t\treturn this;\n\t}\n\n\toverride  revert(group: GroupIdentifier, options?: IRevertOptions): Promise<void> {\n\t\treturn this.doSaveOrRevert('revert', group, options);\n\t}\n\n\tprivate async doSaveOrRevert(mode: 'save', group: GroupIdentifier, options?: ISaveOptions): Promise<void>;\n\tprivate async doSaveOrRevert(mode: 'revert', group: GroupIdentifier, options?: IRevertOptions): Promise<void>;\n\tprivate async doSaveOrRevert(mode: 'save' | 'revert', group: GroupIdentifier, options?: ISaveOptions | IRevertOptions): Promise<void> {\n\t\tconst items = this._viewModel.currentValue?.items.get();\n\t\tif (items) {\n\t\t\tawait Promise.all(items.map(async item => {\n\t\t\t\tconst model = item.diffEditorViewModel.model;\n\t\t\t\tconst handleOriginal = model.original.uri.scheme !== Schemas.untitled && this._textFileService.isDirty(model.original.uri); // match diff editor behaviour\n\n\t\t\t\tawait Promise.all([\n\t\t\t\t\thandleOriginal ? mode === 'save' ? this._textFileService.save(model.original.uri, options) : this._textFileService.revert(model.original.uri, options) : Promise.resolve(),\n\t\t\t\t\tmode === 'save' ? this._textFileService.save(model.modified.uri, options) : this._textFileService.revert(model.modified.uri, options),\n\t\t\t\t]);\n\t\t\t}));\n\t\t}\n\t\treturn undefined;\n\t}\n\n\toverride readonly closeHandler: IEditorCloseHandler;\n}\n\nexport interface IDocumentDiffItemWithMultiDiffEditorItem extends IDocumentDiffItem {\n\tmultiDiffEditorItem: MultiDiffEditorItem;\n}\n\n/**\n * Uses a map to efficiently dispatch events to listeners that are interested in a specific key.\n*/\nclass FastEventDispatcher<T, TKey> {\n\tprivate _count = 0;\n\tprivate readonly _buckets = new Map<string, Set<(value: T) => void>>();\n\n\tprivate _eventSubscription: IDisposable | undefined;\n\n\tconstructor(\n\t\tprivate readonly _event: Event<T>,\n\t\tprivate readonly _getEventArgsKey: (item: T) => string,\n\t\tprivate readonly _keyToString: (key: TKey) => string,\n\t) {\n\t}\n\n\tpublic filteredEvent(filter: TKey): (listener: (e: T) => unknown) => IDisposable {\n\t\treturn listener => {\n\t\t\tconst key = this._keyToString(filter);\n\t\t\tlet bucket = this._buckets.get(key);\n\t\t\tif (!bucket) {\n\t\t\t\tbucket = new Set();\n\t\t\t\tthis._buckets.set(key, bucket);\n\t\t\t}\n\t\t\tbucket.add(listener);\n\n\t\t\tthis._count++;\n\t\t\tif (this._count === 1) {\n\t\t\t\tthis._eventSubscription = this._event(this._handleEventChange);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdispose: () => {\n\t\t\t\t\tbucket!.delete(listener);\n\t\t\t\t\tif (bucket!.size === 0) {\n\t\t\t\t\t\tthis._buckets.delete(key);\n\t\t\t\t\t}\n\t\t\t\t\tthis._count--;\n\n\t\t\t\t\tif (this._count === 0) {\n\t\t\t\t\t\tthis._eventSubscription?.dispose();\n\t\t\t\t\t\tthis._eventSubscription = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}\n\n\tprivate readonly _handleEventChange = (e: T) => {\n\t\tconst key = this._getEventArgsKey(e);\n\t\tconst bucket = this._buckets.get(key);\n\t\tif (bucket) {\n\t\t\tfor (const listener of bucket) {\n\t\t\t\tlistener(e);\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction isUriDirty(onDidChangeDirty: FastEventDispatcher<ITextFileEditorModel, URI>, textFileService: ITextFileService, uri: URI) {\n\treturn observableFromEvent(onDidChangeDirty.filteredEvent(uri), () => textFileService.isDirty(uri));\n}\n\nfunction getReadonlyConfiguration(isReadonly: boolean | IMarkdownString | undefined): { readOnly: boolean; readOnlyMessage: IMarkdownString | undefined } {\n\treturn {\n\t\treadOnly: !!isReadonly,\n\t\treadOnlyMessage: typeof isReadonly !== 'boolean' ? isReadonly : undefined\n\t};\n}\n\nfunction computeOptions(configuration: IEditorConfiguration): IDiffEditorOptions {\n\tconst editorConfiguration = deepClone(configuration.editor);\n\n\t// Handle diff editor specially by merging in diffEditor configuration\n\tif (isObject(configuration.diffEditor)) {\n\t\tconst diffEditorConfiguration: IDiffEditorOptions = deepClone(configuration.diffEditor);\n\n\t\t// User settings defines `diffEditor.codeLens`, but here we rename that to `diffEditor.diffCodeLens` to avoid collisions with `editor.codeLens`.\n\t\tdiffEditorConfiguration.diffCodeLens = diffEditorConfiguration.codeLens;\n\t\tdelete diffEditorConfiguration.codeLens;\n\n\t\t// User settings defines `diffEditor.wordWrap`, but here we rename that to `diffEditor.diffWordWrap` to avoid collisions with `editor.wordWrap`.\n\t\tdiffEditorConfiguration.diffWordWrap = <'off' | 'on' | 'inherit' | undefined>diffEditorConfiguration.wordWrap;\n\t\tdelete diffEditorConfiguration.wordWrap;\n\n\t\tObject.assign(editorConfiguration, diffEditorConfiguration);\n\t}\n\treturn editorConfiguration;\n}\n\nexport class MultiDiffEditorResolverContribution extends Disposable {\n\n\tstatic readonly ID = 'workbench.contrib.multiDiffEditorResolver';\n\n\tconstructor(\n\t\t@IEditorResolverService editorResolverService: IEditorResolverService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(editorResolverService.registerEditor(\n\t\t\t`*`,\n\t\t\t{\n\t\t\t\tid: DEFAULT_EDITOR_ASSOCIATION.id,\n\t\t\t\tlabel: DEFAULT_EDITOR_ASSOCIATION.displayName,\n\t\t\t\tdetail: DEFAULT_EDITOR_ASSOCIATION.providerDisplayName,\n\t\t\t\tpriority: RegisteredEditorPriority.builtin\n\t\t\t},\n\t\t\t{},\n\t\t\t{\n\t\t\t\tcreateMultiDiffEditorInput: (multiDiffEditor: IResourceMultiDiffEditorInput): EditorInputWithOptions => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\teditor: MultiDiffEditorInput.fromResourceMultiDiffEditorInput(multiDiffEditor, instantiationService),\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t}\n\t\t));\n\t}\n}\n\ninterface ISerializedMultiDiffEditorInput {\n\tmultiDiffSourceUri: string;\n\tlabel: string | undefined;\n\tresources: {\n\t\toriginalUri: string | undefined;\n\t\tmodifiedUri: string | undefined;\n\t\tgoToFileUri: string | undefined;\n\t}[] | undefined;\n}\n\nexport class MultiDiffEditorSerializer implements IEditorSerializer {\n\n\tcanSerialize(editor: EditorInput): editor is MultiDiffEditorInput {\n\t\treturn editor instanceof MultiDiffEditorInput && !editor.isTransient;\n\t}\n\n\tserialize(editor: MultiDiffEditorInput): string | undefined {\n\t\tif (!this.canSerialize(editor)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn JSON.stringify(editor.serialize());\n\t}\n\n\tdeserialize(instantiationService: IInstantiationService, serializedEditor: string): EditorInput | undefined {\n\t\ttry {\n\t\t\tconst data = parse(serializedEditor) as ISerializedMultiDiffEditorInput;\n\t\t\treturn MultiDiffEditorInput.fromSerialized(data, instantiationService);\n\t\t} catch (err) {\n\t\t\tonUnexpectedError(err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n"]}