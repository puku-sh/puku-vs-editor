{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/browser/searchTreeModel/searchTreeCommon.ts","vs/workbench/contrib/search/browser/searchTreeModel/searchTreeCommon.ts"],"names":[],"mappings":"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","file":"searchTreeCommon.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IFileMatch, ISearchComplete, ISearchProgressItem, ISearchRange, ITextQuery, ITextSearchQuery, ITextSearchResult } from '../../../../services/search/common/search.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IFileStatWithPartialMetadata, IFileService } from '../../../../../platform/files/common/files.js';\nimport { IProgress, IProgressStep } from '../../../../../platform/progress/common/progress.js';\nimport { ReplacePattern } from '../../../../services/search/common/replace.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { RangeHighlightDecorations } from './rangeDecorations.js';\nimport { Event } from '../../../../../base/common/event.js';\n\nexport type FileMatchOrMatch = ISearchTreeFileMatch | ISearchTreeMatch;\n\nexport type RenderableMatch = ITextSearchHeading | ISearchTreeFolderMatch | ISearchTreeFileMatch | ISearchTreeMatch;\nexport function arrayContainsElementOrParent(element: RenderableMatch, testArray: RenderableMatch[]): boolean {\n\tdo {\n\t\tif (testArray.includes(element)) {\n\t\t\treturn true;\n\t\t}\n\t} while (!isSearchResult(element.parent()) && (element = <RenderableMatch>element.parent()));\n\n\treturn false;\n}\n\n\nexport interface IChangeEvent {\n\telements: ISearchTreeFileMatch[];\n\tadded?: boolean;\n\tremoved?: boolean;\n\tclearingAll?: boolean;\n}\nexport enum SearchModelLocation {\n\tPANEL,\n\tQUICK_ACCESS\n}\n\n\nexport const PLAIN_TEXT_SEARCH__RESULT_ID = 'plainTextSearch';\nexport const AI_TEXT_SEARCH_RESULT_ID = 'aiTextSearch';\n\nexport function createParentList(element: RenderableMatch): RenderableMatch[] {\n\tconst parentArray: RenderableMatch[] = [];\n\tlet currElement: RenderableMatch | ITextSearchHeading = element;\n\n\twhile (!isTextSearchHeading(currElement)) {\n\t\tparentArray.push(currElement);\n\t\tcurrElement = currElement.parent();\n\t}\n\n\treturn parentArray;\n}\n\nexport const SEARCH_MODEL_PREFIX = 'SEARCH_MODEL_';\nexport const SEARCH_RESULT_PREFIX = 'SEARCH_RESULT_';\nexport const TEXT_SEARCH_HEADING_PREFIX = 'TEXT_SEARCH_HEADING_';\nexport const FOLDER_MATCH_PREFIX = 'FOLDER_MATCH_';\nexport const FILE_MATCH_PREFIX = 'FILE_MATCH_';\nexport const MATCH_PREFIX = 'MATCH_';\n\nexport function mergeSearchResultEvents(events: IChangeEvent[]): IChangeEvent {\n\tconst retEvent: IChangeEvent = {\n\t\telements: [],\n\t\tadded: false,\n\t\tremoved: false,\n\t};\n\tevents.forEach((e) => {\n\t\tif (e.added) {\n\t\t\tretEvent.added = true;\n\t\t}\n\n\t\tif (e.removed) {\n\t\t\tretEvent.removed = true;\n\t\t}\n\n\t\tretEvent.elements = retEvent.elements.concat(e.elements);\n\t});\n\n\treturn retEvent;\n}\n\nexport interface ISearchModel {\n\treadonly onReplaceTermChanged: Event<void>;\n\treadonly onSearchResultChanged: Event<IChangeEvent>;\n\tlocation: SearchModelLocation;\n\tid(): string;\n\n\tgetAITextResultProviderName(): Promise<string>;\n\tisReplaceActive(): boolean;\n\treplaceActive: boolean;\n\treplacePattern: ReplacePattern | null;\n\treplaceString: string;\n\tpreserveCase: boolean;\n\tsearchResult: ISearchResult;\n\taiSearch(onResultReported: (result: ISearchProgressItem | undefined) => void): Promise<ISearchComplete>;\n\thasAIResults: boolean;\n\thasPlainResults: boolean;\n\tsearch(query: ITextQuery, onProgress?: (result: ISearchProgressItem) => void, callerToken?: CancellationToken): {\n\t\tasyncResults: Promise<ISearchComplete>;\n\t\tsyncResults: IFileMatch<URI>[];\n\t};\n\tcancelSearch(cancelledForNewSearch?: boolean): boolean;\n\tcancelAISearch(cancelledForNewSearch?: boolean): boolean;\n\tclearAiSearchResults(): void;\n\tdispose(): void;\n}\n\n\nexport interface ISearchResult {\n\treadonly onChange: Event<IChangeEvent>;\n\treadonly searchModel: ISearchModel;\n\treadonly plainTextSearchResult: IPlainTextSearchHeading;\n\treadonly aiTextSearchResult: ITextSearchHeading;\n\treadonly children: ITextSearchHeading[];\n\treadonly hasChildren: boolean;\n\treadonly isDirty: boolean;\n\tquery: ITextQuery | null;\n\n\tbatchReplace(elementsToReplace: RenderableMatch[]): Promise<void>;\n\tbatchRemove(elementsToRemove: RenderableMatch[]): void;\n\tfolderMatches(ai?: boolean): ISearchTreeFolderMatch[];\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent?: boolean): void;\n\tclear(): void;\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai?: boolean): void;\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\tmatches(ai?: boolean): ISearchTreeFileMatch[];\n\tisEmpty(): boolean;\n\tfileCount(ignoreSemanticSearchResults?: boolean): number;\n\tcount(ignoreSemanticSearchResults?: boolean): number;\n\tid(): string;\n\tsetCachedSearchComplete(cachedSearchComplete: ISearchComplete | undefined, ai: boolean): void;\n\tgetCachedSearchComplete(ai: boolean): ISearchComplete | undefined;\n\ttoggleHighlights(value: boolean, ai?: boolean): void;\n\tgetRangeHighlightDecorations(ai?: boolean): RangeHighlightDecorations;\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any>;\n\tsetAIQueryUsingTextQuery(query?: ITextQuery | null): void;\n\tdispose(): void;\n}\n\nexport interface ITextSearchHeading {\n\treadonly onChange: Event<IChangeEvent>;\n\tresource: URI | null;\n\thidden: boolean;\n\tcachedSearchComplete: ISearchComplete | undefined;\n\thide(): void;\n\treadonly isAIContributed: boolean;\n\tid(): string;\n\tparent(): ISearchResult;\n\treadonly hasChildren: boolean;\n\tname(): string;\n\treadonly isDirty: boolean;\n\tgetFolderMatch(resource: URI): ISearchTreeFolderMatch | undefined;\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent?: boolean): void;\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai?: boolean): void;\n\tgroupFilesByFolder(fileMatches: ISearchTreeFileMatch[]): { byFolder: Map<URI, ISearchTreeFileMatch[]>; other: ISearchTreeFileMatch[] };\n\tisEmpty(): boolean;\n\tfindFolderSubstr(resource: URI): ISearchTreeFolderMatch | undefined;\n\tquery: ITextSearchQuery | null;\n\tfolderMatches(): ISearchTreeFolderMatch[];\n\tmatches(): ISearchTreeFileMatch[];\n\tshowHighlights: boolean;\n\ttoggleHighlights(value: boolean): void;\n\trangeHighlightDecorations: RangeHighlightDecorations;\n\tfileCount(): number;\n\tcount(): number;\n\tclear(clearAll: boolean): void;\n\tdispose(): void;\n}\n\nexport interface IPlainTextSearchHeading extends ITextSearchHeading {\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any>;\n}\n\nexport interface ISearchTreeFolderMatch {\n\treadonly onChange: Event<IChangeEvent>;\n\treadonly onDispose: Event<void>;\n\tid(): string;\n\tresource: URI | null;\n\tindex(): number;\n\tname(): string;\n\tcount(): number;\n\thasChildren: boolean;\n\tparent(): ISearchTreeFolderMatch | ITextSearchHeading;\n\tmatches(): (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[];\n\tallDownstreamFileMatches(): ISearchTreeFileMatch[];\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource | (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): void;\n\taddFileMatch(raw: IFileMatch[], silent: boolean, searchInstanceID: string): void;\n\tisEmpty(): boolean;\n\tclear(clearingAll?: boolean): void;\n\tshowHighlights: boolean;\n\tsearchModel: ISearchModel;\n\tquery: ITextSearchQuery | null;\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\treplacingAll: boolean;\n\tbindModel(model: ITextModel): void;\n\tgetDownstreamFileMatch(uri: URI): ISearchTreeFileMatch | null;\n\treplaceAll(): Promise<any>;\n\trecursiveFileCount(): number;\n\tdoRemoveFile(fileMatches: ISearchTreeFileMatch[], dispose?: boolean, trigger?: boolean, keepReadonly?: boolean): void;\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): void;\n\tbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): Promise<void>;\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): void;\n\thasOnlyReadOnlyMatches(): boolean;\n\tfileMatchesIterator(): IterableIterator<ISearchTreeFileMatch>;\n\tfolderMatchesIterator(): IterableIterator<ISearchTreeFolderMatchWithResource>;\n\trecursiveFileCount(): number;\n\trecursiveMatchCount(): number;\n\tdispose(): void;\n\tisAIContributed(): boolean;\n}\n\nexport interface ISearchTreeFolderMatchWithResource extends ISearchTreeFolderMatch {\n\tresource: URI;\n}\n\nexport interface ISearchTreeFolderMatchWorkspaceRoot extends ISearchTreeFolderMatchWithResource {\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): ISearchTreeFileMatch;\n}\n\nexport interface ISearchTreeFolderMatchNoRoot extends ISearchTreeFolderMatch {\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): ISearchTreeFileMatch;\n}\n\nexport interface ISearchTreeFileMatch {\n\tid(): string;\n\tresource: URI;\n\tonChange: Event<{\n\t\tdidRemove?: boolean;\n\t\tforceUpdateModel?: boolean;\n\t}>;\n\thasChildren: boolean;\n\treadonly onDispose: Event<void>;\n\tname(): string;\n\tcount(): number;\n\thasOnlyReadOnlyMatches(): boolean;\n\tmatches(): ISearchTreeMatch[];\n\tupdateHighlights(): void;\n\tgetSelectedMatch(): ISearchTreeMatch | null;\n\tparent(): ISearchTreeFolderMatch;\n\tbindModel(model: ITextModel): void;\n\thasReadonlyMatches(): boolean;\n\taddContext(results: ITextSearchResult[] | undefined): void;\n\tadd(match: ISearchTreeMatch, trigger?: boolean): void;\n\treplace(toReplace: ISearchTreeMatch): Promise<void>;\n\tremove(matches: ISearchTreeMatch | (ISearchTreeMatch[])): void;\n\tsetSelectedMatch(match: ISearchTreeMatch | null): void;\n\tfileStat: IFileStatWithPartialMetadata | undefined;\n\tresolveFileStat(fileService: IFileService): Promise<void>;\n\ttextMatches(): ISearchTreeMatch[];\n\treadonly context: Map<number, string>;\n\treadonly closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null;\n\tisMatchSelected(match: ISearchTreeMatch): boolean;\n\tdispose(): void;\n}\n\nexport interface ISearchTreeMatch {\n\tid(): string;\n\tparent(): ISearchTreeFileMatch;\n\ttext(): string;\n\trange(): Range;\n\tpreview(): { before: string; fullBefore: string; inside: string; after: string };\n\treplaceString: string;\n\tfullMatchText(includeSurrounding?: boolean): string;\n\trangeInPreview(): ISearchRange;\n\tfullPreviewLines(): string[];\n\tgetMatchString(): string;\n\tisReadonly: boolean;\n}\n\nexport function isSearchModel(obj: any): obj is ISearchModel {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(SEARCH_MODEL_PREFIX);\n}\n\nexport function isSearchResult(obj: any): obj is ISearchResult {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(SEARCH_RESULT_PREFIX);\n}\n\nexport function isTextSearchHeading(obj: any): obj is ITextSearchHeading {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(TEXT_SEARCH_HEADING_PREFIX);\n}\n\nexport function isPlainTextSearchHeading(obj: any): obj is IPlainTextSearchHeading {\n\treturn isTextSearchHeading(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).replace === 'function' &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).replaceAll === 'function';\n}\n\nexport function isSearchTreeFolderMatch(obj: any): obj is ISearchTreeFolderMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(FOLDER_MATCH_PREFIX);\n}\n\nexport function isSearchTreeFolderMatchWithResource(obj: any): obj is ISearchTreeFolderMatchWithResource {\n\treturn isSearchTreeFolderMatch(obj) && obj.resource instanceof URI;\n}\n\nexport function isSearchTreeFolderMatchWorkspaceRoot(obj: any): obj is ISearchTreeFolderMatchWorkspaceRoot {\n\treturn isSearchTreeFolderMatchWithResource(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).createAndConfigureFileMatch === 'function';\n}\n\nexport function isSearchTreeFolderMatchNoRoot(obj: any): obj is ISearchTreeFolderMatchNoRoot {\n\treturn isSearchTreeFolderMatch(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).createAndConfigureFileMatch === 'function';\n}\n\nexport function isSearchTreeFileMatch(obj: any): obj is ISearchTreeFileMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(FILE_MATCH_PREFIX);\n}\n\nexport function isSearchTreeMatch(obj: any): obj is ISearchTreeMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(MATCH_PREFIX);\n}\n\nexport function isSearchHeader(obj: any): boolean {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(TEXT_SEARCH_HEADING_PREFIX);\n}\n\nexport function getFileMatches(matches: (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): ISearchTreeFileMatch[] {\n\n\tconst folderMatches: ISearchTreeFolderMatchWithResource[] = [];\n\tconst fileMatches: ISearchTreeFileMatch[] = [];\n\tmatches.forEach((e) => {\n\t\tif (isSearchTreeFileMatch(e)) {\n\t\t\tfileMatches.push(e);\n\t\t} else {\n\t\t\tfolderMatches.push(e);\n\t\t}\n\t});\n\n\treturn fileMatches.concat(folderMatches.map(e => e.allDownstreamFileMatches()).flat());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IFileMatch, ISearchComplete, ISearchProgressItem, ISearchRange, ITextQuery, ITextSearchQuery, ITextSearchResult } from '../../../../services/search/common/search.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IFileStatWithPartialMetadata, IFileService } from '../../../../../platform/files/common/files.js';\nimport { IProgress, IProgressStep } from '../../../../../platform/progress/common/progress.js';\nimport { ReplacePattern } from '../../../../services/search/common/replace.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { RangeHighlightDecorations } from './rangeDecorations.js';\nimport { Event } from '../../../../../base/common/event.js';\n\nexport type FileMatchOrMatch = ISearchTreeFileMatch | ISearchTreeMatch;\n\nexport type RenderableMatch = ITextSearchHeading | ISearchTreeFolderMatch | ISearchTreeFileMatch | ISearchTreeMatch;\nexport function arrayContainsElementOrParent(element: RenderableMatch, testArray: RenderableMatch[]): boolean {\n\tdo {\n\t\tif (testArray.includes(element)) {\n\t\t\treturn true;\n\t\t}\n\t} while (!isSearchResult(element.parent()) && (element = <RenderableMatch>element.parent()));\n\n\treturn false;\n}\n\n\nexport interface IChangeEvent {\n\telements: ISearchTreeFileMatch[];\n\tadded?: boolean;\n\tremoved?: boolean;\n\tclearingAll?: boolean;\n}\nexport enum SearchModelLocation {\n\tPANEL,\n\tQUICK_ACCESS\n}\n\n\nexport const PLAIN_TEXT_SEARCH__RESULT_ID = 'plainTextSearch';\nexport const AI_TEXT_SEARCH_RESULT_ID = 'aiTextSearch';\n\nexport function createParentList(element: RenderableMatch): RenderableMatch[] {\n\tconst parentArray: RenderableMatch[] = [];\n\tlet currElement: RenderableMatch | ITextSearchHeading = element;\n\n\twhile (!isTextSearchHeading(currElement)) {\n\t\tparentArray.push(currElement);\n\t\tcurrElement = currElement.parent();\n\t}\n\n\treturn parentArray;\n}\n\nexport const SEARCH_MODEL_PREFIX = 'SEARCH_MODEL_';\nexport const SEARCH_RESULT_PREFIX = 'SEARCH_RESULT_';\nexport const TEXT_SEARCH_HEADING_PREFIX = 'TEXT_SEARCH_HEADING_';\nexport const FOLDER_MATCH_PREFIX = 'FOLDER_MATCH_';\nexport const FILE_MATCH_PREFIX = 'FILE_MATCH_';\nexport const MATCH_PREFIX = 'MATCH_';\n\nexport function mergeSearchResultEvents(events: IChangeEvent[]): IChangeEvent {\n\tconst retEvent: IChangeEvent = {\n\t\telements: [],\n\t\tadded: false,\n\t\tremoved: false,\n\t};\n\tevents.forEach((e) => {\n\t\tif (e.added) {\n\t\t\tretEvent.added = true;\n\t\t}\n\n\t\tif (e.removed) {\n\t\t\tretEvent.removed = true;\n\t\t}\n\n\t\tretEvent.elements = retEvent.elements.concat(e.elements);\n\t});\n\n\treturn retEvent;\n}\n\nexport interface ISearchModel {\n\treadonly onReplaceTermChanged: Event<void>;\n\treadonly onSearchResultChanged: Event<IChangeEvent>;\n\tlocation: SearchModelLocation;\n\tid(): string;\n\n\tgetAITextResultProviderName(): Promise<string>;\n\tisReplaceActive(): boolean;\n\treplaceActive: boolean;\n\treplacePattern: ReplacePattern | null;\n\treplaceString: string;\n\tpreserveCase: boolean;\n\tsearchResult: ISearchResult;\n\taiSearch(onResultReported: (result: ISearchProgressItem | undefined) => void): Promise<ISearchComplete>;\n\thasAIResults: boolean;\n\thasPlainResults: boolean;\n\tsearch(query: ITextQuery, onProgress?: (result: ISearchProgressItem) => void, callerToken?: CancellationToken): {\n\t\tasyncResults: Promise<ISearchComplete>;\n\t\tsyncResults: IFileMatch<URI>[];\n\t};\n\tcancelSearch(cancelledForNewSearch?: boolean): boolean;\n\tcancelAISearch(cancelledForNewSearch?: boolean): boolean;\n\tclearAiSearchResults(): void;\n\tdispose(): void;\n}\n\n\nexport interface ISearchResult {\n\treadonly onChange: Event<IChangeEvent>;\n\treadonly searchModel: ISearchModel;\n\treadonly plainTextSearchResult: IPlainTextSearchHeading;\n\treadonly aiTextSearchResult: ITextSearchHeading;\n\treadonly children: ITextSearchHeading[];\n\treadonly hasChildren: boolean;\n\treadonly isDirty: boolean;\n\tquery: ITextQuery | null;\n\n\tbatchReplace(elementsToReplace: RenderableMatch[]): Promise<void>;\n\tbatchRemove(elementsToRemove: RenderableMatch[]): void;\n\tfolderMatches(ai?: boolean): ISearchTreeFolderMatch[];\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent?: boolean): void;\n\tclear(): void;\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai?: boolean): void;\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\tmatches(ai?: boolean): ISearchTreeFileMatch[];\n\tisEmpty(): boolean;\n\tfileCount(ignoreSemanticSearchResults?: boolean): number;\n\tcount(ignoreSemanticSearchResults?: boolean): number;\n\tid(): string;\n\tsetCachedSearchComplete(cachedSearchComplete: ISearchComplete | undefined, ai: boolean): void;\n\tgetCachedSearchComplete(ai: boolean): ISearchComplete | undefined;\n\ttoggleHighlights(value: boolean, ai?: boolean): void;\n\tgetRangeHighlightDecorations(ai?: boolean): RangeHighlightDecorations;\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any>;\n\tsetAIQueryUsingTextQuery(query?: ITextQuery | null): void;\n\tdispose(): void;\n}\n\nexport interface ITextSearchHeading {\n\treadonly onChange: Event<IChangeEvent>;\n\tresource: URI | null;\n\thidden: boolean;\n\tcachedSearchComplete: ISearchComplete | undefined;\n\thide(): void;\n\treadonly isAIContributed: boolean;\n\tid(): string;\n\tparent(): ISearchResult;\n\treadonly hasChildren: boolean;\n\tname(): string;\n\treadonly isDirty: boolean;\n\tgetFolderMatch(resource: URI): ISearchTreeFolderMatch | undefined;\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent?: boolean): void;\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai?: boolean): void;\n\tgroupFilesByFolder(fileMatches: ISearchTreeFileMatch[]): { byFolder: Map<URI, ISearchTreeFileMatch[]>; other: ISearchTreeFileMatch[] };\n\tisEmpty(): boolean;\n\tfindFolderSubstr(resource: URI): ISearchTreeFolderMatch | undefined;\n\tquery: ITextSearchQuery | null;\n\tfolderMatches(): ISearchTreeFolderMatch[];\n\tmatches(): ISearchTreeFileMatch[];\n\tshowHighlights: boolean;\n\ttoggleHighlights(value: boolean): void;\n\trangeHighlightDecorations: RangeHighlightDecorations;\n\tfileCount(): number;\n\tcount(): number;\n\tclear(clearAll: boolean): void;\n\tdispose(): void;\n}\n\nexport interface IPlainTextSearchHeading extends ITextSearchHeading {\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any>;\n}\n\nexport interface ISearchTreeFolderMatch {\n\treadonly onChange: Event<IChangeEvent>;\n\treadonly onDispose: Event<void>;\n\tid(): string;\n\tresource: URI | null;\n\tindex(): number;\n\tname(): string;\n\tcount(): number;\n\thasChildren: boolean;\n\tparent(): ISearchTreeFolderMatch | ITextSearchHeading;\n\tmatches(): (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[];\n\tallDownstreamFileMatches(): ISearchTreeFileMatch[];\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource | (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): void;\n\taddFileMatch(raw: IFileMatch[], silent: boolean, searchInstanceID: string): void;\n\tisEmpty(): boolean;\n\tclear(clearingAll?: boolean): void;\n\tshowHighlights: boolean;\n\tsearchModel: ISearchModel;\n\tquery: ITextSearchQuery | null;\n\treplace(match: ISearchTreeFileMatch): Promise<any>;\n\treplacingAll: boolean;\n\tbindModel(model: ITextModel): void;\n\tgetDownstreamFileMatch(uri: URI): ISearchTreeFileMatch | null;\n\treplaceAll(): Promise<any>;\n\trecursiveFileCount(): number;\n\tdoRemoveFile(fileMatches: ISearchTreeFileMatch[], dispose?: boolean, trigger?: boolean, keepReadonly?: boolean): void;\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): void;\n\tbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): Promise<void>;\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI): void;\n\thasOnlyReadOnlyMatches(): boolean;\n\tfileMatchesIterator(): IterableIterator<ISearchTreeFileMatch>;\n\tfolderMatchesIterator(): IterableIterator<ISearchTreeFolderMatchWithResource>;\n\trecursiveFileCount(): number;\n\trecursiveMatchCount(): number;\n\tdispose(): void;\n\tisAIContributed(): boolean;\n}\n\nexport interface ISearchTreeFolderMatchWithResource extends ISearchTreeFolderMatch {\n\tresource: URI;\n}\n\nexport interface ISearchTreeFolderMatchWorkspaceRoot extends ISearchTreeFolderMatchWithResource {\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): ISearchTreeFileMatch;\n}\n\nexport interface ISearchTreeFolderMatchNoRoot extends ISearchTreeFolderMatch {\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): ISearchTreeFileMatch;\n}\n\nexport interface ISearchTreeFileMatch {\n\tid(): string;\n\tresource: URI;\n\tonChange: Event<{\n\t\tdidRemove?: boolean;\n\t\tforceUpdateModel?: boolean;\n\t}>;\n\thasChildren: boolean;\n\treadonly onDispose: Event<void>;\n\tname(): string;\n\tcount(): number;\n\thasOnlyReadOnlyMatches(): boolean;\n\tmatches(): ISearchTreeMatch[];\n\tupdateHighlights(): void;\n\tgetSelectedMatch(): ISearchTreeMatch | null;\n\tparent(): ISearchTreeFolderMatch;\n\tbindModel(model: ITextModel): void;\n\thasReadonlyMatches(): boolean;\n\taddContext(results: ITextSearchResult[] | undefined): void;\n\tadd(match: ISearchTreeMatch, trigger?: boolean): void;\n\treplace(toReplace: ISearchTreeMatch): Promise<void>;\n\tremove(matches: ISearchTreeMatch | (ISearchTreeMatch[])): void;\n\tsetSelectedMatch(match: ISearchTreeMatch | null): void;\n\tfileStat: IFileStatWithPartialMetadata | undefined;\n\tresolveFileStat(fileService: IFileService): Promise<void>;\n\ttextMatches(): ISearchTreeMatch[];\n\treadonly context: Map<number, string>;\n\treadonly closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null;\n\tisMatchSelected(match: ISearchTreeMatch): boolean;\n\tdispose(): void;\n}\n\nexport interface ISearchTreeMatch {\n\tid(): string;\n\tparent(): ISearchTreeFileMatch;\n\ttext(): string;\n\trange(): Range;\n\tpreview(): { before: string; fullBefore: string; inside: string; after: string };\n\treplaceString: string;\n\tfullMatchText(includeSurrounding?: boolean): string;\n\trangeInPreview(): ISearchRange;\n\tfullPreviewLines(): string[];\n\tgetMatchString(): string;\n\tisReadonly: boolean;\n}\n\nexport function isSearchModel(obj: any): obj is ISearchModel {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(SEARCH_MODEL_PREFIX);\n}\n\nexport function isSearchResult(obj: any): obj is ISearchResult {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(SEARCH_RESULT_PREFIX);\n}\n\nexport function isTextSearchHeading(obj: any): obj is ITextSearchHeading {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(TEXT_SEARCH_HEADING_PREFIX);\n}\n\nexport function isPlainTextSearchHeading(obj: any): obj is IPlainTextSearchHeading {\n\treturn isTextSearchHeading(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).replace === 'function' &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).replaceAll === 'function';\n}\n\nexport function isSearchTreeFolderMatch(obj: any): obj is ISearchTreeFolderMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(FOLDER_MATCH_PREFIX);\n}\n\nexport function isSearchTreeFolderMatchWithResource(obj: any): obj is ISearchTreeFolderMatchWithResource {\n\treturn isSearchTreeFolderMatch(obj) && obj.resource instanceof URI;\n}\n\nexport function isSearchTreeFolderMatchWorkspaceRoot(obj: any): obj is ISearchTreeFolderMatchWorkspaceRoot {\n\treturn isSearchTreeFolderMatchWithResource(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).createAndConfigureFileMatch === 'function';\n}\n\nexport function isSearchTreeFolderMatchNoRoot(obj: any): obj is ISearchTreeFolderMatchNoRoot {\n\treturn isSearchTreeFolderMatch(obj) &&\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\ttypeof (<any>obj).createAndConfigureFileMatch === 'function';\n}\n\nexport function isSearchTreeFileMatch(obj: any): obj is ISearchTreeFileMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(FILE_MATCH_PREFIX);\n}\n\nexport function isSearchTreeMatch(obj: any): obj is ISearchTreeMatch {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(MATCH_PREFIX);\n}\n\nexport function isSearchHeader(obj: any): boolean {\n\treturn typeof obj === 'object' &&\n\t\tobj !== null &&\n\t\ttypeof obj.id === 'function' &&\n\t\tobj.id().startsWith(TEXT_SEARCH_HEADING_PREFIX);\n}\n\nexport function getFileMatches(matches: (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): ISearchTreeFileMatch[] {\n\n\tconst folderMatches: ISearchTreeFolderMatchWithResource[] = [];\n\tconst fileMatches: ISearchTreeFileMatch[] = [];\n\tmatches.forEach((e) => {\n\t\tif (isSearchTreeFileMatch(e)) {\n\t\t\tfileMatches.push(e);\n\t\t} else {\n\t\t\tfolderMatches.push(e);\n\t\t}\n\t});\n\n\treturn fileMatches.concat(folderMatches.map(e => e.allDownstreamFileMatches()).flat());\n}\n"]}