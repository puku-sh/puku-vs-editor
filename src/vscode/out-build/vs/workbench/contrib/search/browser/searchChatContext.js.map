{"version":3,"sources":["vs/workbench/contrib/search/browser/searchChatContext.ts"],"names":[],"mappings":"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","file":"searchChatContext.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { getExcludes, IFileQuery, ISearchComplete, ISearchConfiguration, ISearchService, QueryType, VIEW_ID } from '../../../services/search/common/search.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { IChatContextPickerItem, IChatContextPickerPickItem, IChatContextPickService, IChatContextValueItem, picksWithPromiseFn } from '../../chat/browser/chatContextPickService.js';\nimport { IChatRequestVariableEntry, ISymbolVariableEntry } from '../../chat/common/chatVariableEntries.js';\nimport { SearchContext } from '../common/constants.js';\nimport { SearchView } from './searchView.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { basename, dirname, joinPath, relativePath } from '../../../../base/common/resources.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { getIconClasses } from '../../../../editor/common/services/getIconClasses.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { FileKind, FileType, IFileService } from '../../../../platform/files/common/files.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IHistoryService } from '../../../services/history/common/history.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport * as glob from '../../../../base/common/glob.js';\nimport { ResourceSet } from '../../../../base/common/map.js';\nimport { SymbolsQuickAccessProvider } from './symbolsQuickAccess.js';\nimport { SymbolKinds } from '../../../../editor/common/languages.js';\nimport { isSupportedChatFileScheme } from '../../chat/common/constants.js';\nimport { IChatWidget } from '../../chat/browser/chat.js';\n\nexport class SearchChatContextContribution extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contributions.searchChatContextContribution';\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IChatContextPickService chatContextPickService: IChatContextPickService\n\t) {\n\t\tsuper();\n\t\tthis._store.add(chatContextPickService.registerChatContextItem(instantiationService.createInstance(SearchViewResultChatContextPick)));\n\t\tthis._store.add(chatContextPickService.registerChatContextItem(instantiationService.createInstance(FilesAndFoldersPickerPick)));\n\t\tthis._store.add(chatContextPickService.registerChatContextItem(this._store.add(instantiationService.createInstance(SymbolsContextPickerPick))));\n\t}\n}\n\nclass SearchViewResultChatContextPick implements IChatContextValueItem {\n\n\treadonly type = 'valuePick';\n\treadonly label: string = localize('chatContext.searchResults', 'Search Results');\n\treadonly icon: ThemeIcon = Codicon.search;\n\treadonly ordinal = 500;\n\n\tconstructor(\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IViewsService private readonly _viewsService: IViewsService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t) { }\n\n\tisEnabled(widget: IChatWidget): Promise<boolean> | boolean {\n\t\treturn !!SearchContext.HasSearchResults.getValue(this._contextKeyService) && !!widget.attachmentCapabilities.supportsSearchResultAttachments;\n\t}\n\n\tasync asAttachment(): Promise<IChatRequestVariableEntry[]> {\n\t\tconst searchView = this._viewsService.getViewWithId(VIEW_ID);\n\t\tif (!(searchView instanceof SearchView)) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn searchView.model.searchResult.matches().map(result => ({\n\t\t\tkind: 'file',\n\t\t\tid: result.resource.toString(),\n\t\t\tvalue: result.resource,\n\t\t\tname: this._labelService.getUriBasenameLabel(result.resource),\n\t\t}));\n\t}\n}\n\nclass SymbolsContextPickerPick implements IChatContextPickerItem {\n\n\treadonly type = 'pickerPick';\n\n\treadonly label: string = localize('symbols', 'Symbols...');\n\treadonly icon: ThemeIcon = Codicon.symbolField;\n\treadonly ordinal = -200;\n\n\tprivate _provider: SymbolsQuickAccessProvider | undefined;\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) { }\n\n\tdispose(): void {\n\t\tthis._provider?.dispose();\n\t}\n\n\tisEnabled(widget: IChatWidget): boolean {\n\t\treturn !!widget.attachmentCapabilities.supportsSymbolAttachments;\n\t}\n\tasPicker() {\n\n\t\treturn {\n\t\t\tplaceholder: localize('select.symb', \"Select a symbol\"),\n\t\t\tpicks: picksWithPromiseFn((query: string, token: CancellationToken) => {\n\n\t\t\t\tthis._provider ??= this._instantiationService.createInstance(SymbolsQuickAccessProvider);\n\n\t\t\t\treturn this._provider.getSymbolPicks(query, undefined, token).then(symbolItems => {\n\t\t\t\t\tconst result: IChatContextPickerPickItem[] = [];\n\t\t\t\t\tfor (const item of symbolItems) {\n\t\t\t\t\t\tif (!item.symbol) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst attachment: ISymbolVariableEntry = {\n\t\t\t\t\t\t\tkind: 'symbol',\n\t\t\t\t\t\t\tid: JSON.stringify(item.symbol.location),\n\t\t\t\t\t\t\tvalue: item.symbol.location,\n\t\t\t\t\t\t\tsymbolKind: item.symbol.kind,\n\t\t\t\t\t\t\ticon: SymbolKinds.toIcon(item.symbol.kind),\n\t\t\t\t\t\t\tfullName: item.label,\n\t\t\t\t\t\t\tname: item.symbol.name,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tlabel: item.symbol.name,\n\t\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(SymbolKinds.toIcon(item.symbol.kind)),\n\t\t\t\t\t\t\tasAttachment() {\n\t\t\t\t\t\t\t\treturn attachment;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t}),\n\t\t};\n\t}\n}\n\nclass FilesAndFoldersPickerPick implements IChatContextPickerItem {\n\n\treadonly type = 'pickerPick';\n\treadonly label = localize('chatContext.folder', 'Files & Folders...');\n\treadonly icon = Codicon.folder;\n\treadonly ordinal = 600;\n\n\tconstructor(\n\t\t@ISearchService private readonly _searchService: ISearchService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IWorkspaceContextService private readonly _workspaceService: IWorkspaceContextService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@IHistoryService private readonly _historyService: IHistoryService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) { }\n\n\tasPicker() {\n\n\t\treturn {\n\t\t\tplaceholder: localize('chatContext.attach.files.placeholder', \"Search file or folder by name\"),\n\t\t\tpicks: picksWithPromiseFn(async (value, token) => {\n\n\t\t\t\tconst workspaces = this._workspaceService.getWorkspace().folders.map(folder => folder.uri);\n\n\t\t\t\tconst defaultItems: IChatContextPickerPickItem[] = [];\n\t\t\t\t(await getTopLevelFolders(workspaces, this._fileService)).forEach(uri => defaultItems.push(this._createPickItem(uri, FileKind.FOLDER)));\n\t\t\t\tthis._historyService.getHistory()\n\t\t\t\t\t.filter(a => a.resource && this._instantiationService.invokeFunction(accessor => isSupportedChatFileScheme(accessor, a.resource!.scheme)))\n\t\t\t\t\t.slice(0, 30)\n\t\t\t\t\t.forEach(uri => defaultItems.push(this._createPickItem(uri.resource!, FileKind.FILE)));\n\n\t\t\t\tif (value === '') {\n\t\t\t\t\treturn defaultItems;\n\t\t\t\t}\n\n\t\t\t\tconst result: IChatContextPickerPickItem[] = [];\n\n\t\t\t\tawait Promise.all(workspaces.map(async workspace => {\n\t\t\t\t\tconst { folders, files } = await searchFilesAndFolders(\n\t\t\t\t\t\tworkspace,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tthis._configurationService,\n\t\t\t\t\t\tthis._searchService\n\t\t\t\t\t);\n\n\t\t\t\t\tfor (const folder of folders) {\n\t\t\t\t\t\tresult.push(this._createPickItem(folder, FileKind.FOLDER));\n\t\t\t\t\t}\n\t\t\t\t\tfor (const file of files) {\n\t\t\t\t\t\tresult.push(this._createPickItem(file, FileKind.FILE));\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tresult.sort((a, b) => compare(a.label, b.label));\n\n\t\t\t\treturn result;\n\t\t\t}),\n\t\t};\n\t}\n\n\tprivate _createPickItem(resource: URI, kind: FileKind): IChatContextPickerPickItem {\n\t\treturn {\n\t\t\tlabel: basename(resource),\n\t\t\tdescription: this._labelService.getUriLabel(dirname(resource), { relative: true }),\n\t\t\ticonClasses: getIconClasses(this._modelService, this._languageService, resource, kind),\n\t\t\tasAttachment: () => {\n\t\t\t\treturn {\n\t\t\t\t\tkind: kind === FileKind.FILE ? 'file' : 'directory',\n\t\t\t\t\tid: resource.toString(),\n\t\t\t\t\tvalue: resource,\n\t\t\t\t\tname: basename(resource),\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n\n}\nexport async function searchFilesAndFolders(\n\tworkspace: URI,\n\tpattern: string,\n\tfuzzyMatch: boolean,\n\ttoken: CancellationToken | undefined,\n\tcacheKey: string | undefined,\n\tconfigurationService: IConfigurationService,\n\tsearchService: ISearchService\n): Promise<{ folders: URI[]; files: URI[] }> {\n\tconst segmentMatchPattern = caseInsensitiveGlobPattern(fuzzyMatch ? fuzzyMatchingGlobPattern(pattern) : continousMatchingGlobPattern(pattern));\n\n\tconst searchExcludePattern = getExcludes(configurationService.getValue<ISearchConfiguration>({ resource: workspace })) || {};\n\tconst searchOptions: IFileQuery = {\n\t\tfolderQueries: [{\n\t\t\tfolder: workspace,\n\t\t\tdisregardIgnoreFiles: configurationService.getValue<boolean>('explorer.excludeGitIgnore'),\n\t\t}],\n\t\ttype: QueryType.File,\n\t\tshouldGlobMatchFilePattern: true,\n\t\tcacheKey,\n\t\texcludePattern: searchExcludePattern,\n\t\tsortByScore: true,\n\t};\n\n\tlet searchResult: ISearchComplete | undefined;\n\ttry {\n\t\tsearchResult = await searchService.fileSearch({ ...searchOptions, filePattern: `{**/${segmentMatchPattern}/**,${pattern}}` }, token);\n\t} catch (e) {\n\t\tif (!isCancellationError(e)) {\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tif (!searchResult || token?.isCancellationRequested) {\n\t\treturn { files: [], folders: [] };\n\t}\n\n\tconst fileResources = searchResult.results.map(result => result.resource);\n\tconst folderResources = getMatchingFoldersFromFiles(fileResources, workspace, segmentMatchPattern);\n\n\treturn { folders: folderResources, files: fileResources };\n}\n\nfunction fuzzyMatchingGlobPattern(pattern: string): string {\n\tif (!pattern) {\n\t\treturn '*';\n\t}\n\treturn '*' + pattern.split('').join('*') + '*';\n}\n\nfunction continousMatchingGlobPattern(pattern: string): string {\n\tif (!pattern) {\n\t\treturn '*';\n\t}\n\treturn '*' + pattern + '*';\n}\n\nfunction caseInsensitiveGlobPattern(pattern: string): string {\n\tlet caseInsensitiveFilePattern = '';\n\tfor (let i = 0; i < pattern.length; i++) {\n\t\tconst char = pattern[i];\n\t\tif (/[a-zA-Z]/.test(char)) {\n\t\t\tcaseInsensitiveFilePattern += `[${char.toLowerCase()}${char.toUpperCase()}]`;\n\t\t} else {\n\t\t\tcaseInsensitiveFilePattern += char;\n\t\t}\n\t}\n\treturn caseInsensitiveFilePattern;\n}\n\n// TODO: remove this and have support from the search service\nfunction getMatchingFoldersFromFiles(resources: URI[], workspace: URI, segmentMatchPattern: string): URI[] {\n\tconst uniqueFolders = new ResourceSet();\n\tfor (const resource of resources) {\n\t\tconst relativePathToRoot = relativePath(workspace, resource);\n\t\tif (!relativePathToRoot) {\n\t\t\tthrow new Error('Resource is not a child of the workspace');\n\t\t}\n\n\t\tlet dirResource = workspace;\n\t\tconst stats = relativePathToRoot.split('/').slice(0, -1);\n\t\tfor (const stat of stats) {\n\t\t\tdirResource = dirResource.with({ path: `${dirResource.path}/${stat}` });\n\t\t\tuniqueFolders.add(dirResource);\n\t\t}\n\t}\n\n\tconst matchingFolders: URI[] = [];\n\tfor (const folderResource of uniqueFolders) {\n\t\tconst stats = folderResource.path.split('/');\n\t\tconst dirStat = stats[stats.length - 1];\n\t\tif (!dirStat || !glob.match(segmentMatchPattern, dirStat)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tmatchingFolders.push(folderResource);\n\t}\n\n\treturn matchingFolders;\n}\n\nexport async function getTopLevelFolders(workspaces: URI[], fileService: IFileService): Promise<URI[]> {\n\tconst folders: URI[] = [];\n\tfor (const workspace of workspaces) {\n\t\tconst fileSystemProvider = fileService.getProvider(workspace.scheme);\n\t\tif (!fileSystemProvider) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst entries = await fileSystemProvider.readdir(workspace);\n\t\tfor (const [name, type] of entries) {\n\t\t\tconst entryResource = joinPath(workspace, name);\n\t\t\tif (type === FileType.Directory) {\n\t\t\t\tfolders.push(entryResource);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn folders;\n}\n"]}