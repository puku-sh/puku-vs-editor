{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/browser/searchTreeModel/folderMatch.ts","vs/workbench/contrib/search/browser/searchTreeModel/folderMatch.ts"],"names":[],"mappings":"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","file":"folderMatch.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Lazy } from '../../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../../base/common/ternarySearchTree.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IUriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IReplaceService } from './../replace.js';\nimport { IFileMatch, IPatternInfo, ITextQuery, ITextSearchPreviewOptions, resultIsMatch } from '../../../../services/search/common/search.js';\n\nimport { FileMatchImpl } from './fileMatch.js';\nimport { IChangeEvent, ISearchTreeFileMatch, ISearchTreeFolderMatch, ISearchTreeFolderMatchWithResource, ISearchTreeFolderMatchNoRoot, ISearchTreeFolderMatchWorkspaceRoot, ISearchModel, ISearchResult, isSearchTreeFolderMatchWorkspaceRoot, ITextSearchHeading, isSearchTreeFolderMatchNoRoot, FOLDER_MATCH_PREFIX, getFileMatches } from './searchTreeCommon.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { isINotebookFileMatchNoModel } from '../../common/searchNotebookHelpers.js';\nimport { NotebookCompatibleFileMatch } from '../notebookSearch/notebookSearchModel.js';\nimport { isINotebookFileMatchWithModel, getIDFromINotebookCellMatch } from '../notebookSearch/searchNotebookHelpers.js';\nimport { isNotebookFileMatch } from '../notebookSearch/notebookSearchModelBase.js';\nimport { textSearchResultToMatches } from './match.js';\n\nexport class FolderMatchImpl extends Disposable implements ISearchTreeFolderMatch {\n\n\tprotected _onChange = this._register(new Emitter<IChangeEvent>());\n\treadonly onChange: Event<IChangeEvent> = this._onChange.event;\n\n\tprivate _onDispose = this._register(new Emitter<void>());\n\treadonly onDispose: Event<void> = this._onDispose.event;\n\n\tprotected _fileMatches: ResourceMap<ISearchTreeFileMatch>;\n\tprotected _folderMatches: ResourceMap<FolderMatchWithResourceImpl>;\n\tprotected _folderMatchesMap: TernarySearchTree<URI, FolderMatchWithResourceImpl>;\n\tprotected _unDisposedFileMatches: ResourceMap<ISearchTreeFileMatch>;\n\tprotected _unDisposedFolderMatches: ResourceMap<FolderMatchWithResourceImpl>;\n\tprivate _replacingAll: boolean = false;\n\tprivate _name: Lazy<string>;\n\tprivate readonly _id: string;\n\n\tconstructor(\n\t\tprotected _resource: URI | null,\n\t\t_id: string,\n\t\tprotected _index: number,\n\t\tprotected _query: ITextQuery,\n\t\tprivate _parent: ITextSearchHeading | FolderMatchImpl,\n\t\tprivate _searchResult: ISearchResult,\n\t\tprivate _closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null,\n\t\t@IReplaceService private readonly replaceService: IReplaceService,\n\t\t@IInstantiationService protected readonly instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService protected readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper();\n\t\tthis._fileMatches = new ResourceMap<ISearchTreeFileMatch>();\n\t\tthis._folderMatches = new ResourceMap<FolderMatchWithResourceImpl>();\n\t\tthis._folderMatchesMap = TernarySearchTree.forUris<FolderMatchWithResourceImpl>(key => this.uriIdentityService.extUri.ignorePathCasing(key));\n\t\tthis._unDisposedFileMatches = new ResourceMap<ISearchTreeFileMatch>();\n\t\tthis._unDisposedFolderMatches = new ResourceMap<FolderMatchWithResourceImpl>();\n\t\tthis._name = new Lazy(() => this.resource ? labelService.getUriBasenameLabel(this.resource) : '');\n\t\tthis._id = FOLDER_MATCH_PREFIX + _id;\n\t}\n\n\tget searchModel(): ISearchModel {\n\t\treturn this._searchResult.searchModel;\n\t}\n\n\tget showHighlights(): boolean {\n\t\treturn this._parent.showHighlights;\n\t}\n\n\tget closestRoot(): ISearchTreeFolderMatchWorkspaceRoot | null {\n\t\treturn this._closestRoot;\n\t}\n\n\tset replacingAll(b: boolean) {\n\t\tthis._replacingAll = b;\n\t}\n\n\tid(): string {\n\t\treturn this._id;\n\t}\n\n\tget resource(): URI | null {\n\t\treturn this._resource;\n\t}\n\n\tindex(): number {\n\t\treturn this._index;\n\t}\n\n\tname(): string {\n\t\treturn this._name.value;\n\t}\n\n\tparent(): ITextSearchHeading | FolderMatchImpl {\n\t\treturn this._parent;\n\t}\n\n\tisAIContributed(): boolean {\n\t\treturn false;\n\t}\n\n\tget hasChildren(): boolean {\n\t\treturn this._fileMatches.size > 0 || this._folderMatches.size > 0;\n\t}\n\n\tbindModel(model: ITextModel): void {\n\t\tconst fileMatch = this._fileMatches.get(model.uri);\n\n\t\tif (fileMatch) {\n\t\t\tfileMatch.bindModel(model);\n\t\t} else {\n\t\t\tconst folderMatch = this.getFolderMatch(model.uri);\n\t\t\tconst match = folderMatch?.getDownstreamFileMatch(model.uri);\n\t\t\tmatch?.bindModel(model);\n\t\t}\n\t}\n\n\tpublic createIntermediateFolderMatch(resource: URI, id: string, index: number, query: ITextQuery, baseWorkspaceFolder: ISearchTreeFolderMatchWorkspaceRoot): FolderMatchWithResourceImpl {\n\t\tconst folderMatch = this._register(this.instantiationService.createInstance(FolderMatchWithResourceImpl, resource, id, index, query, this, this._searchResult, baseWorkspaceFolder));\n\t\tthis.configureIntermediateMatch(folderMatch);\n\t\tthis.doAddFolder(folderMatch);\n\t\treturn folderMatch;\n\t}\n\n\tpublic configureIntermediateMatch(folderMatch: FolderMatchWithResourceImpl) {\n\t\tconst disposable = folderMatch.onChange((event) => this.onFolderChange(folderMatch, event));\n\t\tthis._register(folderMatch.onDispose(() => disposable.dispose()));\n\t}\n\n\tclear(clearingAll = false): void {\n\t\tconst changed: ISearchTreeFileMatch[] = this.allDownstreamFileMatches();\n\t\tthis.disposeMatches();\n\t\tthis._onChange.fire({ elements: changed, removed: true, added: false, clearingAll });\n\t}\n\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource | (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): void {\n\t\tif (!Array.isArray(matches)) {\n\t\t\tmatches = [matches];\n\t\t}\n\t\tconst allMatches = getFileMatches(matches);\n\t\tthis.doRemoveFile(allMatches);\n\t}\n\n\tasync replace(match: FileMatchImpl): Promise<any> {\n\t\treturn this.replaceService.replace([match]).then(() => {\n\t\t\tthis.doRemoveFile([match], true, true, true);\n\t\t});\n\t}\n\n\treplaceAll(): Promise<any> {\n\t\tconst matches = this.matches();\n\t\treturn this.batchReplace(matches);\n\t}\n\n\tmatches(): (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[] {\n\t\treturn [...this.fileMatchesIterator(), ...this.folderMatchesIterator()];\n\t}\n\n\tfileMatchesIterator(): IterableIterator<ISearchTreeFileMatch> {\n\t\treturn this._fileMatches.values();\n\t}\n\n\tfolderMatchesIterator(): IterableIterator<ISearchTreeFolderMatchWithResource> {\n\t\treturn this._folderMatches.values();\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn (this.fileCount() + this.folderCount()) === 0;\n\t}\n\n\tgetDownstreamFileMatch(uri: URI): ISearchTreeFileMatch | null {\n\t\tconst directChildFileMatch = this._fileMatches.get(uri);\n\t\tif (directChildFileMatch) {\n\t\t\treturn directChildFileMatch;\n\t\t}\n\n\t\tconst folderMatch = this.getFolderMatch(uri);\n\t\tconst match = folderMatch?.getDownstreamFileMatch(uri);\n\t\tif (match) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tallDownstreamFileMatches(): ISearchTreeFileMatch[] {\n\t\tlet recursiveChildren: ISearchTreeFileMatch[] = [];\n\t\tconst iterator = this.folderMatchesIterator();\n\t\tfor (const elem of iterator) {\n\t\t\trecursiveChildren = recursiveChildren.concat(elem.allDownstreamFileMatches());\n\t\t}\n\n\t\treturn [...this.fileMatchesIterator(), ...recursiveChildren];\n\t}\n\n\tprivate fileCount(): number {\n\t\treturn this._fileMatches.size;\n\t}\n\n\tprivate folderCount(): number {\n\t\treturn this._folderMatches.size;\n\t}\n\n\tcount(): number {\n\t\treturn this.fileCount() + this.folderCount();\n\t}\n\n\trecursiveFileCount(): number {\n\t\treturn this.allDownstreamFileMatches().length;\n\t}\n\n\trecursiveMatchCount(): number {\n\t\treturn this.allDownstreamFileMatches().reduce<number>((prev, match) => prev + match.count(), 0);\n\t}\n\n\tget query(): ITextQuery | null {\n\t\treturn this._query;\n\t}\n\n\tdoAddFile(fileMatch: ISearchTreeFileMatch): void {\n\t\tthis._fileMatches.set(fileMatch.resource, fileMatch);\n\t\tif (this._unDisposedFileMatches.has(fileMatch.resource)) {\n\t\t\tthis._unDisposedFileMatches.delete(fileMatch.resource);\n\t\t}\n\t}\n\n\thasOnlyReadOnlyMatches(): boolean {\n\t\treturn Array.from(this._fileMatches.values()).every(fm => fm.hasOnlyReadOnlyMatches());\n\t}\n\n\tprotected uriHasParent(parent: URI, child: URI) {\n\t\treturn this.uriIdentityService.extUri.isEqualOrParent(child, parent) && !this.uriIdentityService.extUri.isEqual(child, parent);\n\t}\n\n\tprivate isInParentChain(folderMatch: FolderMatchWithResourceImpl) {\n\n\t\tlet matchItem: FolderMatchImpl | ITextSearchHeading = this;\n\t\twhile (matchItem instanceof FolderMatchImpl) {\n\t\t\tif (matchItem.id() === folderMatch.id()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tmatchItem = matchItem.parent();\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic getFolderMatch(resource: URI): FolderMatchWithResourceImpl | undefined {\n\t\tconst folderMatch = this._folderMatchesMap.findSubstr(resource);\n\t\treturn folderMatch;\n\t}\n\n\tdoAddFolder(folderMatch: FolderMatchWithResourceImpl) {\n\t\tif (this.resource && !this.uriHasParent(this.resource, folderMatch.resource)) {\n\t\t\tthrow Error(`${folderMatch.resource} does not belong as a child of ${this.resource}`);\n\t\t} else if (this.isInParentChain(folderMatch)) {\n\t\t\tthrow Error(`${folderMatch.resource} is a parent of ${this.resource}`);\n\t\t}\n\n\t\tthis._folderMatches.set(folderMatch.resource, folderMatch);\n\t\tthis._folderMatchesMap.set(folderMatch.resource, folderMatch);\n\t\tif (this._unDisposedFolderMatches.has(folderMatch.resource)) {\n\t\t\tthis._unDisposedFolderMatches.delete(folderMatch.resource);\n\t\t}\n\t}\n\n\tprivate async batchReplace(matches: (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): Promise<any> {\n\t\tconst allMatches = getFileMatches(matches);\n\n\t\tawait this.replaceService.replace(allMatches);\n\t\tthis.doRemoveFile(allMatches, true, true, true);\n\t}\n\n\tpublic onFileChange(fileMatch: ISearchTreeFileMatch, removed = false): void {\n\t\tlet added = false;\n\t\tif (!this._fileMatches.has(fileMatch.resource)) {\n\t\t\tthis.doAddFile(fileMatch);\n\t\t\tadded = true;\n\t\t}\n\t\tif (fileMatch.count() === 0) {\n\t\t\tthis.doRemoveFile([fileMatch], false, false);\n\t\t\tadded = false;\n\t\t\tremoved = true;\n\t\t}\n\t\tif (!this._replacingAll) {\n\t\t\tthis._onChange.fire({ elements: [fileMatch], added: added, removed: removed });\n\t\t}\n\t}\n\n\tpublic onFolderChange(folderMatch: FolderMatchWithResourceImpl, event: IChangeEvent): void {\n\t\tif (!this._folderMatches.has(folderMatch.resource)) {\n\t\t\tthis.doAddFolder(folderMatch);\n\t\t}\n\t\tif (folderMatch.isEmpty()) {\n\t\t\tthis._folderMatches.delete(folderMatch.resource);\n\t\t\tfolderMatch.dispose();\n\t\t}\n\n\t\tthis._onChange.fire(event);\n\t}\n\n\tdoRemoveFile(fileMatches: ISearchTreeFileMatch[], dispose: boolean = true, trigger: boolean = true, keepReadonly = false): void {\n\n\t\tconst removed = [];\n\t\tfor (const match of fileMatches as ISearchTreeFileMatch[]) {\n\t\t\tif (this._fileMatches.get(match.resource)) {\n\t\t\t\tif (keepReadonly && match.hasReadonlyMatches()) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis._fileMatches.delete(match.resource);\n\t\t\t\tif (dispose) {\n\t\t\t\t\tmatch.dispose();\n\t\t\t\t} else {\n\t\t\t\t\tthis._unDisposedFileMatches.set(match.resource, match);\n\t\t\t\t}\n\t\t\t\tremoved.push(match);\n\t\t\t} else {\n\t\t\t\tconst folder = this.getFolderMatch(match.resource);\n\t\t\t\tif (folder) {\n\t\t\t\t\tfolder.doRemoveFile([match], dispose, trigger);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(`FileMatch ${match.resource} is not located within FolderMatch ${this.resource}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (trigger) {\n\t\t\tthis._onChange.fire({ elements: removed, removed: true });\n\t\t}\n\t}\n\n\tasync bindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI) {\n\t\tconst fileMatch = this._fileMatches.get(resource);\n\t\tif (isNotebookFileMatch(fileMatch)) {\n\t\t\tif (fileMatch) {\n\t\t\t\tfileMatch.bindNotebookEditorWidget(editor);\n\t\t\t\tawait fileMatch.updateMatchesForEditorWidget();\n\t\t\t} else {\n\t\t\t\tconst folderMatches = this.folderMatchesIterator();\n\t\t\t\tfor (const elem of folderMatches) {\n\t\t\t\t\tawait elem.bindNotebookEditorWidget(editor, resource);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddFileMatch(raw: IFileMatch[], silent: boolean, searchInstanceID: string): void {\n\t\t// when adding a fileMatch that has intermediate directories\n\t\tconst added: ISearchTreeFileMatch[] = [];\n\t\tconst updated: ISearchTreeFileMatch[] = [];\n\n\t\traw.forEach(rawFileMatch => {\n\t\t\tconst existingFileMatch = this.getDownstreamFileMatch(rawFileMatch.resource);\n\t\t\tif (existingFileMatch) {\n\n\t\t\t\tif (rawFileMatch.results) {\n\t\t\t\t\trawFileMatch\n\t\t\t\t\t\t.results\n\t\t\t\t\t\t.filter(resultIsMatch)\n\t\t\t\t\t\t.forEach(m => {\n\t\t\t\t\t\t\ttextSearchResultToMatches(m, existingFileMatch, false)\n\t\t\t\t\t\t\t\t.forEach(m => existingFileMatch.add(m));\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// add cell matches\n\t\t\t\tif (isINotebookFileMatchWithModel(rawFileMatch) || isINotebookFileMatchNoModel(rawFileMatch)) {\n\t\t\t\t\trawFileMatch.cellResults?.forEach(rawCellMatch => {\n\t\t\t\t\t\tif (isNotebookFileMatch(existingFileMatch)) {\n\t\t\t\t\t\t\tconst existingCellMatch = existingFileMatch.getCellMatch(getIDFromINotebookCellMatch(rawCellMatch));\n\t\t\t\t\t\t\tif (existingCellMatch) {\n\t\t\t\t\t\t\t\texistingCellMatch.addContentMatches(rawCellMatch.contentResults);\n\t\t\t\t\t\t\t\texistingCellMatch.addWebviewMatches(rawCellMatch.webviewResults);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\texistingFileMatch.addCellMatch(rawCellMatch);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tupdated.push(existingFileMatch);\n\n\t\t\t\tif (rawFileMatch.results && rawFileMatch.results.length > 0) {\n\t\t\t\t\texistingFileMatch.addContext(rawFileMatch.results);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (isSearchTreeFolderMatchWorkspaceRoot(this) || isSearchTreeFolderMatchNoRoot(this)) {\n\t\t\t\t\tconst fileMatch = this.createAndConfigureFileMatch(rawFileMatch, searchInstanceID);\n\t\t\t\t\tadded.push(fileMatch);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst elements = [...added, ...updated];\n\t\tif (!silent && elements.length) {\n\t\t\tthis._onChange.fire({ elements, added: !!added.length });\n\t\t}\n\t}\n\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI) {\n\t\tconst fileMatch = this._fileMatches.get(resource);\n\n\t\tif (isNotebookFileMatch(fileMatch)) {\n\t\t\tif (fileMatch) {\n\t\t\t\tfileMatch.unbindNotebookEditorWidget(editor);\n\t\t\t} else {\n\t\t\t\tconst folderMatches = this.folderMatchesIterator();\n\t\t\t\tfor (const elem of folderMatches) {\n\t\t\t\t\telem.unbindNotebookEditorWidget(editor, resource);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\tdisposeMatches(): void {\n\t\t[...this._fileMatches.values()].forEach((fileMatch: ISearchTreeFileMatch) => fileMatch.dispose());\n\t\t[...this._folderMatches.values()].forEach((folderMatch: FolderMatchImpl) => folderMatch.disposeMatches());\n\t\t[...this._unDisposedFileMatches.values()].forEach((fileMatch: ISearchTreeFileMatch) => fileMatch.dispose());\n\t\t[...this._unDisposedFolderMatches.values()].forEach((folderMatch: FolderMatchImpl) => folderMatch.disposeMatches());\n\t\tthis._fileMatches.clear();\n\t\tthis._folderMatches.clear();\n\t\tthis._unDisposedFileMatches.clear();\n\t\tthis._unDisposedFolderMatches.clear();\n\t}\n\n\toverride dispose(): void {\n\t\tthis.disposeMatches();\n\t\tthis._onDispose.fire();\n\t\tsuper.dispose();\n\t}\n}\n\nexport class FolderMatchWithResourceImpl extends FolderMatchImpl implements ISearchTreeFolderMatchWithResource {\n\n\tprotected _normalizedResource: Lazy<URI>;\n\n\tconstructor(_resource: URI,\n\t\t_id: string,\n\t\t_index: number,\n\t\t_query: ITextQuery,\n\t\t_parent: ITextSearchHeading | FolderMatchImpl,\n\t\t_searchResult: ISearchResult,\n\t\t_closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper(_resource, _id, _index, _query, _parent, _searchResult, _closestRoot, replaceService, instantiationService, labelService, uriIdentityService);\n\t\tthis._normalizedResource = new Lazy(() => this.uriIdentityService.extUri.removeTrailingPathSeparator(this.uriIdentityService.extUri.normalizePath(\n\t\t\tthis.resource)));\n\t}\n\n\toverride get resource(): URI {\n\t\treturn this._resource!;\n\t}\n\n\tget normalizedResource(): URI {\n\t\treturn this._normalizedResource.value;\n\t}\n}\n\n/**\n * FolderMatchWorkspaceRoot => folder for workspace root\n */\nexport class FolderMatchWorkspaceRootImpl extends FolderMatchWithResourceImpl implements ISearchTreeFolderMatchWorkspaceRoot {\n\tconstructor(_resource: URI, _id: string, _index: number, _query: ITextQuery, _parent: ITextSearchHeading,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper(_resource, _id, _index, _query, _parent, _parent.parent(), null, replaceService, instantiationService, labelService, uriIdentityService);\n\t}\n\n\tprivate normalizedUriParent(uri: URI): URI {\n\t\treturn this.uriIdentityService.extUri.normalizePath(this.uriIdentityService.extUri.dirname(uri));\n\t}\n\n\tprivate uriEquals(uri1: URI, ur2: URI): boolean {\n\t\treturn this.uriIdentityService.extUri.isEqual(uri1, ur2);\n\t}\n\n\tprivate createFileMatch(query: IPatternInfo, previewOptions: ITextSearchPreviewOptions | undefined, maxResults: number | undefined, parent: FolderMatchImpl, rawFileMatch: IFileMatch, closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null, searchInstanceID: string): FileMatchImpl {\n\t\t// TODO: can probably just create FileMatchImpl if we don't expect cell results from the file.\n\t\tconst fileMatch =\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tNotebookCompatibleFileMatch,\n\t\t\t\tquery,\n\t\t\t\tpreviewOptions,\n\t\t\t\tmaxResults,\n\t\t\t\tparent,\n\t\t\t\trawFileMatch,\n\t\t\t\tclosestRoot,\n\t\t\t\tsearchInstanceID,\n\t\t\t);\n\t\tfileMatch.createMatches();\n\t\tparent.doAddFile(fileMatch);\n\t\tconst disposable = fileMatch.onChange(({ didRemove }) => parent.onFileChange(fileMatch, didRemove));\n\t\tthis._register(fileMatch.onDispose(() => disposable.dispose()));\n\t\treturn fileMatch;\n\t}\n\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): FileMatchImpl {\n\n\t\tif (!this.uriHasParent(this.resource, rawFileMatch.resource)) {\n\t\t\tthrow Error(`${rawFileMatch.resource} is not a descendant of ${this.resource}`);\n\t\t}\n\n\t\tconst fileMatchParentParts: URI[] = [];\n\t\tlet uri = this.normalizedUriParent(rawFileMatch.resource);\n\n\t\twhile (!this.uriEquals(this.normalizedResource, uri)) {\n\t\t\tfileMatchParentParts.unshift(uri);\n\t\t\tconst prevUri = uri;\n\t\t\turi = this.uriIdentityService.extUri.removeTrailingPathSeparator(this.normalizedUriParent(uri));\n\t\t\tif (this.uriEquals(prevUri, uri)) {\n\t\t\t\tthrow Error(`${rawFileMatch.resource} is not correctly configured as a child of ${this.normalizedResource}`);\n\t\t\t}\n\t\t}\n\n\t\tconst root = this.closestRoot ?? this;\n\t\tlet parent: FolderMatchWithResourceImpl = this;\n\t\tfor (let i = 0; i < fileMatchParentParts.length; i++) {\n\t\t\tlet folderMatch: FolderMatchWithResourceImpl | undefined = parent.getFolderMatch(fileMatchParentParts[i]);\n\t\t\tif (!folderMatch) {\n\t\t\t\tfolderMatch = parent.createIntermediateFolderMatch(fileMatchParentParts[i], fileMatchParentParts[i].toString(), -1, this._query, root);\n\t\t\t}\n\t\t\tparent = folderMatch;\n\t\t}\n\t\tconst contentPatternToUse = typeof (this._query.contentPattern) === 'string' ? { pattern: this._query.contentPattern } : this._query.contentPattern;\n\t\treturn this.createFileMatch(contentPatternToUse, this._query.previewOptions, this._query.maxResults, parent, rawFileMatch, root, searchInstanceID);\n\t}\n}\n\n// currently, no support for AI results in out-of-workspace files\nexport class FolderMatchNoRootImpl extends FolderMatchImpl implements ISearchTreeFolderMatchNoRoot {\n\tconstructor(_id: string, _index: number, _query: ITextQuery, _parent: ITextSearchHeading,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\n\t) {\n\t\tsuper(null, _id, _index, _query, _parent, _parent.parent(), null, replaceService, instantiationService, labelService, uriIdentityService);\n\t}\n\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch, searchInstanceID: string): ISearchTreeFileMatch {\n\t\tconst contentPatternToUse = typeof (this._query.contentPattern) === 'string' ? { pattern: this._query.contentPattern } : this._query.contentPattern;\n\t\t// TODO: can probably just create FileMatchImpl if we don't expect cell results from the file.\n\t\tconst fileMatch = this._register(this.instantiationService.createInstance(\n\t\t\tNotebookCompatibleFileMatch,\n\t\t\tcontentPatternToUse,\n\t\t\tthis._query.previewOptions,\n\t\t\tthis._query.maxResults,\n\t\t\tthis, rawFileMatch,\n\t\t\tnull,\n\t\t\tsearchInstanceID,\n\t\t));\n\t\tfileMatch.createMatches();\n\t\tthis.doAddFile(fileMatch);\n\t\tconst disposable = fileMatch.onChange(({ didRemove }) => this.onFileChange(fileMatch, didRemove));\n\t\tthis._register(fileMatch.onDispose(() => disposable.dispose()));\n\t\treturn fileMatch;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Lazy } from '../../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../../base/common/ternarySearchTree.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IUriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IReplaceService } from './../replace.js';\nimport { IFileMatch, IPatternInfo, ITextQuery, ITextSearchPreviewOptions, resultIsMatch } from '../../../../services/search/common/search.js';\n\nimport { FileMatchImpl } from './fileMatch.js';\nimport { IChangeEvent, ISearchTreeFileMatch, ISearchTreeFolderMatch, ISearchTreeFolderMatchWithResource, ISearchTreeFolderMatchNoRoot, ISearchTreeFolderMatchWorkspaceRoot, ISearchModel, ISearchResult, isSearchTreeFolderMatchWorkspaceRoot, ITextSearchHeading, isSearchTreeFolderMatchNoRoot, FOLDER_MATCH_PREFIX, getFileMatches } from './searchTreeCommon.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { isINotebookFileMatchNoModel } from '../../common/searchNotebookHelpers.js';\nimport { NotebookCompatibleFileMatch } from '../notebookSearch/notebookSearchModel.js';\nimport { isINotebookFileMatchWithModel, getIDFromINotebookCellMatch } from '../notebookSearch/searchNotebookHelpers.js';\nimport { isNotebookFileMatch } from '../notebookSearch/notebookSearchModelBase.js';\nimport { textSearchResultToMatches } from './match.js';\n\nexport class FolderMatchImpl extends Disposable implements ISearchTreeFolderMatch {\n\n\tprotected _onChange = this._register(new Emitter<IChangeEvent>());\n\treadonly onChange: Event<IChangeEvent> = this._onChange.event;\n\n\tprivate _onDispose = this._register(new Emitter<void>());\n\treadonly onDispose: Event<void> = this._onDispose.event;\n\n\tprotected _fileMatches: ResourceMap<ISearchTreeFileMatch>;\n\tprotected _folderMatches: ResourceMap<FolderMatchWithResourceImpl>;\n\tprotected _folderMatchesMap: TernarySearchTree<URI, FolderMatchWithResourceImpl>;\n\tprotected _unDisposedFileMatches: ResourceMap<ISearchTreeFileMatch>;\n\tprotected _unDisposedFolderMatches: ResourceMap<FolderMatchWithResourceImpl>;\n\tprivate _replacingAll: boolean = false;\n\tprivate _name: Lazy<string>;\n\tprivate readonly _id: string;\n\n\tconstructor(\n\t\tprotected _resource: URI | null,\n\t\t_id: string,\n\t\tprotected _index: number,\n\t\tprotected _query: ITextQuery,\n\t\tprivate _parent: ITextSearchHeading | FolderMatchImpl,\n\t\tprivate _searchResult: ISearchResult,\n\t\tprivate _closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null,\n\t\t@IReplaceService private readonly replaceService: IReplaceService,\n\t\t@IInstantiationService protected readonly instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService protected readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper();\n\t\tthis._fileMatches = new ResourceMap<ISearchTreeFileMatch>();\n\t\tthis._folderMatches = new ResourceMap<FolderMatchWithResourceImpl>();\n\t\tthis._folderMatchesMap = TernarySearchTree.forUris<FolderMatchWithResourceImpl>(key => this.uriIdentityService.extUri.ignorePathCasing(key));\n\t\tthis._unDisposedFileMatches = new ResourceMap<ISearchTreeFileMatch>();\n\t\tthis._unDisposedFolderMatches = new ResourceMap<FolderMatchWithResourceImpl>();\n\t\tthis._name = new Lazy(() => this.resource ? labelService.getUriBasenameLabel(this.resource) : '');\n\t\tthis._id = FOLDER_MATCH_PREFIX + _id;\n\t}\n\n\tget searchModel(): ISearchModel {\n\t\treturn this._searchResult.searchModel;\n\t}\n\n\tget showHighlights(): boolean {\n\t\treturn this._parent.showHighlights;\n\t}\n\n\tget closestRoot(): ISearchTreeFolderMatchWorkspaceRoot | null {\n\t\treturn this._closestRoot;\n\t}\n\n\tset replacingAll(b: boolean) {\n\t\tthis._replacingAll = b;\n\t}\n\n\tid(): string {\n\t\treturn this._id;\n\t}\n\n\tget resource(): URI | null {\n\t\treturn this._resource;\n\t}\n\n\tindex(): number {\n\t\treturn this._index;\n\t}\n\n\tname(): string {\n\t\treturn this._name.value;\n\t}\n\n\tparent(): ITextSearchHeading | FolderMatchImpl {\n\t\treturn this._parent;\n\t}\n\n\tisAIContributed(): boolean {\n\t\treturn false;\n\t}\n\n\tget hasChildren(): boolean {\n\t\treturn this._fileMatches.size > 0 || this._folderMatches.size > 0;\n\t}\n\n\tbindModel(model: ITextModel): void {\n\t\tconst fileMatch = this._fileMatches.get(model.uri);\n\n\t\tif (fileMatch) {\n\t\t\tfileMatch.bindModel(model);\n\t\t} else {\n\t\t\tconst folderMatch = this.getFolderMatch(model.uri);\n\t\t\tconst match = folderMatch?.getDownstreamFileMatch(model.uri);\n\t\t\tmatch?.bindModel(model);\n\t\t}\n\t}\n\n\tpublic createIntermediateFolderMatch(resource: URI, id: string, index: number, query: ITextQuery, baseWorkspaceFolder: ISearchTreeFolderMatchWorkspaceRoot): FolderMatchWithResourceImpl {\n\t\tconst folderMatch = this._register(this.instantiationService.createInstance(FolderMatchWithResourceImpl, resource, id, index, query, this, this._searchResult, baseWorkspaceFolder));\n\t\tthis.configureIntermediateMatch(folderMatch);\n\t\tthis.doAddFolder(folderMatch);\n\t\treturn folderMatch;\n\t}\n\n\tpublic configureIntermediateMatch(folderMatch: FolderMatchWithResourceImpl) {\n\t\tconst disposable = folderMatch.onChange((event) => this.onFolderChange(folderMatch, event));\n\t\tthis._register(folderMatch.onDispose(() => disposable.dispose()));\n\t}\n\n\tclear(clearingAll = false): void {\n\t\tconst changed: ISearchTreeFileMatch[] = this.allDownstreamFileMatches();\n\t\tthis.disposeMatches();\n\t\tthis._onChange.fire({ elements: changed, removed: true, added: false, clearingAll });\n\t}\n\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource | (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): void {\n\t\tif (!Array.isArray(matches)) {\n\t\t\tmatches = [matches];\n\t\t}\n\t\tconst allMatches = getFileMatches(matches);\n\t\tthis.doRemoveFile(allMatches);\n\t}\n\n\tasync replace(match: FileMatchImpl): Promise<any> {\n\t\treturn this.replaceService.replace([match]).then(() => {\n\t\t\tthis.doRemoveFile([match], true, true, true);\n\t\t});\n\t}\n\n\treplaceAll(): Promise<any> {\n\t\tconst matches = this.matches();\n\t\treturn this.batchReplace(matches);\n\t}\n\n\tmatches(): (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[] {\n\t\treturn [...this.fileMatchesIterator(), ...this.folderMatchesIterator()];\n\t}\n\n\tfileMatchesIterator(): IterableIterator<ISearchTreeFileMatch> {\n\t\treturn this._fileMatches.values();\n\t}\n\n\tfolderMatchesIterator(): IterableIterator<ISearchTreeFolderMatchWithResource> {\n\t\treturn this._folderMatches.values();\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn (this.fileCount() + this.folderCount()) === 0;\n\t}\n\n\tgetDownstreamFileMatch(uri: URI): ISearchTreeFileMatch | null {\n\t\tconst directChildFileMatch = this._fileMatches.get(uri);\n\t\tif (directChildFileMatch) {\n\t\t\treturn directChildFileMatch;\n\t\t}\n\n\t\tconst folderMatch = this.getFolderMatch(uri);\n\t\tconst match = folderMatch?.getDownstreamFileMatch(uri);\n\t\tif (match) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tallDownstreamFileMatches(): ISearchTreeFileMatch[] {\n\t\tlet recursiveChildren: ISearchTreeFileMatch[] = [];\n\t\tconst iterator = this.folderMatchesIterator();\n\t\tfor (const elem of iterator) {\n\t\t\trecursiveChildren = recursiveChildren.concat(elem.allDownstreamFileMatches());\n\t\t}\n\n\t\treturn [...this.fileMatchesIterator(), ...recursiveChildren];\n\t}\n\n\tprivate fileCount(): number {\n\t\treturn this._fileMatches.size;\n\t}\n\n\tprivate folderCount(): number {\n\t\treturn this._folderMatches.size;\n\t}\n\n\tcount(): number {\n\t\treturn this.fileCount() + this.folderCount();\n\t}\n\n\trecursiveFileCount(): number {\n\t\treturn this.allDownstreamFileMatches().length;\n\t}\n\n\trecursiveMatchCount(): number {\n\t\treturn this.allDownstreamFileMatches().reduce<number>((prev, match) => prev + match.count(), 0);\n\t}\n\n\tget query(): ITextQuery | null {\n\t\treturn this._query;\n\t}\n\n\tdoAddFile(fileMatch: ISearchTreeFileMatch): void {\n\t\tthis._fileMatches.set(fileMatch.resource, fileMatch);\n\t\tif (this._unDisposedFileMatches.has(fileMatch.resource)) {\n\t\t\tthis._unDisposedFileMatches.delete(fileMatch.resource);\n\t\t}\n\t}\n\n\thasOnlyReadOnlyMatches(): boolean {\n\t\treturn Array.from(this._fileMatches.values()).every(fm => fm.hasOnlyReadOnlyMatches());\n\t}\n\n\tprotected uriHasParent(parent: URI, child: URI) {\n\t\treturn this.uriIdentityService.extUri.isEqualOrParent(child, parent) && !this.uriIdentityService.extUri.isEqual(child, parent);\n\t}\n\n\tprivate isInParentChain(folderMatch: FolderMatchWithResourceImpl) {\n\n\t\tlet matchItem: FolderMatchImpl | ITextSearchHeading = this;\n\t\twhile (matchItem instanceof FolderMatchImpl) {\n\t\t\tif (matchItem.id() === folderMatch.id()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tmatchItem = matchItem.parent();\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic getFolderMatch(resource: URI): FolderMatchWithResourceImpl | undefined {\n\t\tconst folderMatch = this._folderMatchesMap.findSubstr(resource);\n\t\treturn folderMatch;\n\t}\n\n\tdoAddFolder(folderMatch: FolderMatchWithResourceImpl) {\n\t\tif (this.resource && !this.uriHasParent(this.resource, folderMatch.resource)) {\n\t\t\tthrow Error(`${folderMatch.resource} does not belong as a child of ${this.resource}`);\n\t\t} else if (this.isInParentChain(folderMatch)) {\n\t\t\tthrow Error(`${folderMatch.resource} is a parent of ${this.resource}`);\n\t\t}\n\n\t\tthis._folderMatches.set(folderMatch.resource, folderMatch);\n\t\tthis._folderMatchesMap.set(folderMatch.resource, folderMatch);\n\t\tif (this._unDisposedFolderMatches.has(folderMatch.resource)) {\n\t\t\tthis._unDisposedFolderMatches.delete(folderMatch.resource);\n\t\t}\n\t}\n\n\tprivate async batchReplace(matches: (ISearchTreeFileMatch | ISearchTreeFolderMatchWithResource)[]): Promise<any> {\n\t\tconst allMatches = getFileMatches(matches);\n\n\t\tawait this.replaceService.replace(allMatches);\n\t\tthis.doRemoveFile(allMatches, true, true, true);\n\t}\n\n\tpublic onFileChange(fileMatch: ISearchTreeFileMatch, removed = false): void {\n\t\tlet added = false;\n\t\tif (!this._fileMatches.has(fileMatch.resource)) {\n\t\t\tthis.doAddFile(fileMatch);\n\t\t\tadded = true;\n\t\t}\n\t\tif (fileMatch.count() === 0) {\n\t\t\tthis.doRemoveFile([fileMatch], false, false);\n\t\t\tadded = false;\n\t\t\tremoved = true;\n\t\t}\n\t\tif (!this._replacingAll) {\n\t\t\tthis._onChange.fire({ elements: [fileMatch], added: added, removed: removed });\n\t\t}\n\t}\n\n\tpublic onFolderChange(folderMatch: FolderMatchWithResourceImpl, event: IChangeEvent): void {\n\t\tif (!this._folderMatches.has(folderMatch.resource)) {\n\t\t\tthis.doAddFolder(folderMatch);\n\t\t}\n\t\tif (folderMatch.isEmpty()) {\n\t\t\tthis._folderMatches.delete(folderMatch.resource);\n\t\t\tfolderMatch.dispose();\n\t\t}\n\n\t\tthis._onChange.fire(event);\n\t}\n\n\tdoRemoveFile(fileMatches: ISearchTreeFileMatch[], dispose: boolean = true, trigger: boolean = true, keepReadonly = false): void {\n\n\t\tconst removed = [];\n\t\tfor (const match of fileMatches as ISearchTreeFileMatch[]) {\n\t\t\tif (this._fileMatches.get(match.resource)) {\n\t\t\t\tif (keepReadonly && match.hasReadonlyMatches()) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis._fileMatches.delete(match.resource);\n\t\t\t\tif (dispose) {\n\t\t\t\t\tmatch.dispose();\n\t\t\t\t} else {\n\t\t\t\t\tthis._unDisposedFileMatches.set(match.resource, match);\n\t\t\t\t}\n\t\t\t\tremoved.push(match);\n\t\t\t} else {\n\t\t\t\tconst folder = this.getFolderMatch(match.resource);\n\t\t\t\tif (folder) {\n\t\t\t\t\tfolder.doRemoveFile([match], dispose, trigger);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(`FileMatch ${match.resource} is not located within FolderMatch ${this.resource}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (trigger) {\n\t\t\tthis._onChange.fire({ elements: removed, removed: true });\n\t\t}\n\t}\n\n\tasync bindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI) {\n\t\tconst fileMatch = this._fileMatches.get(resource);\n\t\tif (isNotebookFileMatch(fileMatch)) {\n\t\t\tif (fileMatch) {\n\t\t\t\tfileMatch.bindNotebookEditorWidget(editor);\n\t\t\t\tawait fileMatch.updateMatchesForEditorWidget();\n\t\t\t} else {\n\t\t\t\tconst folderMatches = this.folderMatchesIterator();\n\t\t\t\tfor (const elem of folderMatches) {\n\t\t\t\t\tawait elem.bindNotebookEditorWidget(editor, resource);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddFileMatch(raw: IFileMatch[], silent: boolean, searchInstanceID: string): void {\n\t\t// when adding a fileMatch that has intermediate directories\n\t\tconst added: ISearchTreeFileMatch[] = [];\n\t\tconst updated: ISearchTreeFileMatch[] = [];\n\n\t\traw.forEach(rawFileMatch => {\n\t\t\tconst existingFileMatch = this.getDownstreamFileMatch(rawFileMatch.resource);\n\t\t\tif (existingFileMatch) {\n\n\t\t\t\tif (rawFileMatch.results) {\n\t\t\t\t\trawFileMatch\n\t\t\t\t\t\t.results\n\t\t\t\t\t\t.filter(resultIsMatch)\n\t\t\t\t\t\t.forEach(m => {\n\t\t\t\t\t\t\ttextSearchResultToMatches(m, existingFileMatch, false)\n\t\t\t\t\t\t\t\t.forEach(m => existingFileMatch.add(m));\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// add cell matches\n\t\t\t\tif (isINotebookFileMatchWithModel(rawFileMatch) || isINotebookFileMatchNoModel(rawFileMatch)) {\n\t\t\t\t\trawFileMatch.cellResults?.forEach(rawCellMatch => {\n\t\t\t\t\t\tif (isNotebookFileMatch(existingFileMatch)) {\n\t\t\t\t\t\t\tconst existingCellMatch = existingFileMatch.getCellMatch(getIDFromINotebookCellMatch(rawCellMatch));\n\t\t\t\t\t\t\tif (existingCellMatch) {\n\t\t\t\t\t\t\t\texistingCellMatch.addContentMatches(rawCellMatch.contentResults);\n\t\t\t\t\t\t\t\texistingCellMatch.addWebviewMatches(rawCellMatch.webviewResults);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\texistingFileMatch.addCellMatch(rawCellMatch);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tupdated.push(existingFileMatch);\n\n\t\t\t\tif (rawFileMatch.results && rawFileMatch.results.length > 0) {\n\t\t\t\t\texistingFileMatch.addContext(rawFileMatch.results);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (isSearchTreeFolderMatchWorkspaceRoot(this) || isSearchTreeFolderMatchNoRoot(this)) {\n\t\t\t\t\tconst fileMatch = this.createAndConfigureFileMatch(rawFileMatch, searchInstanceID);\n\t\t\t\t\tadded.push(fileMatch);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst elements = [...added, ...updated];\n\t\tif (!silent && elements.length) {\n\t\t\tthis._onChange.fire({ elements, added: !!added.length });\n\t\t}\n\t}\n\n\tunbindNotebookEditorWidget(editor: NotebookEditorWidget, resource: URI) {\n\t\tconst fileMatch = this._fileMatches.get(resource);\n\n\t\tif (isNotebookFileMatch(fileMatch)) {\n\t\t\tif (fileMatch) {\n\t\t\t\tfileMatch.unbindNotebookEditorWidget(editor);\n\t\t\t} else {\n\t\t\t\tconst folderMatches = this.folderMatchesIterator();\n\t\t\t\tfor (const elem of folderMatches) {\n\t\t\t\t\telem.unbindNotebookEditorWidget(editor, resource);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\tdisposeMatches(): void {\n\t\t[...this._fileMatches.values()].forEach((fileMatch: ISearchTreeFileMatch) => fileMatch.dispose());\n\t\t[...this._folderMatches.values()].forEach((folderMatch: FolderMatchImpl) => folderMatch.disposeMatches());\n\t\t[...this._unDisposedFileMatches.values()].forEach((fileMatch: ISearchTreeFileMatch) => fileMatch.dispose());\n\t\t[...this._unDisposedFolderMatches.values()].forEach((folderMatch: FolderMatchImpl) => folderMatch.disposeMatches());\n\t\tthis._fileMatches.clear();\n\t\tthis._folderMatches.clear();\n\t\tthis._unDisposedFileMatches.clear();\n\t\tthis._unDisposedFolderMatches.clear();\n\t}\n\n\toverride dispose(): void {\n\t\tthis.disposeMatches();\n\t\tthis._onDispose.fire();\n\t\tsuper.dispose();\n\t}\n}\n\nexport class FolderMatchWithResourceImpl extends FolderMatchImpl implements ISearchTreeFolderMatchWithResource {\n\n\tprotected _normalizedResource: Lazy<URI>;\n\n\tconstructor(_resource: URI,\n\t\t_id: string,\n\t\t_index: number,\n\t\t_query: ITextQuery,\n\t\t_parent: ITextSearchHeading | FolderMatchImpl,\n\t\t_searchResult: ISearchResult,\n\t\t_closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper(_resource, _id, _index, _query, _parent, _searchResult, _closestRoot, replaceService, instantiationService, labelService, uriIdentityService);\n\t\tthis._normalizedResource = new Lazy(() => this.uriIdentityService.extUri.removeTrailingPathSeparator(this.uriIdentityService.extUri.normalizePath(\n\t\t\tthis.resource)));\n\t}\n\n\toverride get resource(): URI {\n\t\treturn this._resource!;\n\t}\n\n\tget normalizedResource(): URI {\n\t\treturn this._normalizedResource.value;\n\t}\n}\n\n/**\n * FolderMatchWorkspaceRoot => folder for workspace root\n */\nexport class FolderMatchWorkspaceRootImpl extends FolderMatchWithResourceImpl implements ISearchTreeFolderMatchWorkspaceRoot {\n\tconstructor(_resource: URI, _id: string, _index: number, _query: ITextQuery, _parent: ITextSearchHeading,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper(_resource, _id, _index, _query, _parent, _parent.parent(), null, replaceService, instantiationService, labelService, uriIdentityService);\n\t}\n\n\tprivate normalizedUriParent(uri: URI): URI {\n\t\treturn this.uriIdentityService.extUri.normalizePath(this.uriIdentityService.extUri.dirname(uri));\n\t}\n\n\tprivate uriEquals(uri1: URI, ur2: URI): boolean {\n\t\treturn this.uriIdentityService.extUri.isEqual(uri1, ur2);\n\t}\n\n\tprivate createFileMatch(query: IPatternInfo, previewOptions: ITextSearchPreviewOptions | undefined, maxResults: number | undefined, parent: FolderMatchImpl, rawFileMatch: IFileMatch, closestRoot: ISearchTreeFolderMatchWorkspaceRoot | null, searchInstanceID: string): FileMatchImpl {\n\t\t// TODO: can probably just create FileMatchImpl if we don't expect cell results from the file.\n\t\tconst fileMatch =\n\t\t\tthis.instantiationService.createInstance(\n\t\t\t\tNotebookCompatibleFileMatch,\n\t\t\t\tquery,\n\t\t\t\tpreviewOptions,\n\t\t\t\tmaxResults,\n\t\t\t\tparent,\n\t\t\t\trawFileMatch,\n\t\t\t\tclosestRoot,\n\t\t\t\tsearchInstanceID,\n\t\t\t);\n\t\tfileMatch.createMatches();\n\t\tparent.doAddFile(fileMatch);\n\t\tconst disposable = fileMatch.onChange(({ didRemove }) => parent.onFileChange(fileMatch, didRemove));\n\t\tthis._register(fileMatch.onDispose(() => disposable.dispose()));\n\t\treturn fileMatch;\n\t}\n\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch<URI>, searchInstanceID: string): FileMatchImpl {\n\n\t\tif (!this.uriHasParent(this.resource, rawFileMatch.resource)) {\n\t\t\tthrow Error(`${rawFileMatch.resource} is not a descendant of ${this.resource}`);\n\t\t}\n\n\t\tconst fileMatchParentParts: URI[] = [];\n\t\tlet uri = this.normalizedUriParent(rawFileMatch.resource);\n\n\t\twhile (!this.uriEquals(this.normalizedResource, uri)) {\n\t\t\tfileMatchParentParts.unshift(uri);\n\t\t\tconst prevUri = uri;\n\t\t\turi = this.uriIdentityService.extUri.removeTrailingPathSeparator(this.normalizedUriParent(uri));\n\t\t\tif (this.uriEquals(prevUri, uri)) {\n\t\t\t\tthrow Error(`${rawFileMatch.resource} is not correctly configured as a child of ${this.normalizedResource}`);\n\t\t\t}\n\t\t}\n\n\t\tconst root = this.closestRoot ?? this;\n\t\tlet parent: FolderMatchWithResourceImpl = this;\n\t\tfor (let i = 0; i < fileMatchParentParts.length; i++) {\n\t\t\tlet folderMatch: FolderMatchWithResourceImpl | undefined = parent.getFolderMatch(fileMatchParentParts[i]);\n\t\t\tif (!folderMatch) {\n\t\t\t\tfolderMatch = parent.createIntermediateFolderMatch(fileMatchParentParts[i], fileMatchParentParts[i].toString(), -1, this._query, root);\n\t\t\t}\n\t\t\tparent = folderMatch;\n\t\t}\n\t\tconst contentPatternToUse = typeof (this._query.contentPattern) === 'string' ? { pattern: this._query.contentPattern } : this._query.contentPattern;\n\t\treturn this.createFileMatch(contentPatternToUse, this._query.previewOptions, this._query.maxResults, parent, rawFileMatch, root, searchInstanceID);\n\t}\n}\n\n// currently, no support for AI results in out-of-workspace files\nexport class FolderMatchNoRootImpl extends FolderMatchImpl implements ISearchTreeFolderMatchNoRoot {\n\tconstructor(_id: string, _index: number, _query: ITextQuery, _parent: ITextSearchHeading,\n\t\t@IReplaceService replaceService: IReplaceService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\n\t) {\n\t\tsuper(null, _id, _index, _query, _parent, _parent.parent(), null, replaceService, instantiationService, labelService, uriIdentityService);\n\t}\n\n\tcreateAndConfigureFileMatch(rawFileMatch: IFileMatch, searchInstanceID: string): ISearchTreeFileMatch {\n\t\tconst contentPatternToUse = typeof (this._query.contentPattern) === 'string' ? { pattern: this._query.contentPattern } : this._query.contentPattern;\n\t\t// TODO: can probably just create FileMatchImpl if we don't expect cell results from the file.\n\t\tconst fileMatch = this._register(this.instantiationService.createInstance(\n\t\t\tNotebookCompatibleFileMatch,\n\t\t\tcontentPatternToUse,\n\t\t\tthis._query.previewOptions,\n\t\t\tthis._query.maxResults,\n\t\t\tthis, rawFileMatch,\n\t\t\tnull,\n\t\t\tsearchInstanceID,\n\t\t));\n\t\tfileMatch.createMatches();\n\t\tthis.doAddFile(fileMatch);\n\t\tconst disposable = fileMatch.onChange(({ didRemove }) => this.onFileChange(fileMatch, didRemove));\n\t\tthis._register(fileMatch.onDispose(() => disposable.dispose()));\n\t\treturn fileMatch;\n\t}\n}\n"]}