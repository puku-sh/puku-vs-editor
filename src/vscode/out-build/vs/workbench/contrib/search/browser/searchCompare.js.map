{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/browser/searchCompare.ts","vs/workbench/contrib/search/browser/searchCompare.ts"],"names":[],"mappings":"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","file":"searchCompare.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMatchInNotebook, isIMatchInNotebook } from './notebookSearch/notebookSearchModelBase.js';\nimport { compareFileExtensions, compareFileNames, comparePaths } from '../../../../base/common/comparers.js';\nimport { SearchSortOrder } from '../../../services/search/common/search.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { createParentList, isSearchTreeFileMatch, isSearchTreeFolderMatch, isSearchTreeMatch, RenderableMatch } from './searchTreeModel/searchTreeCommon.js';\nimport { isSearchTreeAIFileMatch } from './AISearch/aiSearchModelBase.js';\n\n\nlet elemAIndex: number = -1;\nlet elemBIndex: number = -1;\n\n/**\n * Compares instances of the same match type. Different match types should not be siblings\n * and their sort order is undefined.\n */\nexport function searchMatchComparer(elementA: RenderableMatch, elementB: RenderableMatch, sortOrder: SearchSortOrder = SearchSortOrder.Default): number {\n\tif (isSearchTreeFileMatch(elementA) && isSearchTreeFolderMatch(elementB)) {\n\t\treturn 1;\n\t}\n\n\tif (isSearchTreeFileMatch(elementB) && isSearchTreeFolderMatch(elementA)) {\n\t\treturn -1;\n\t}\n\n\tif (isSearchTreeFolderMatch(elementA) && isSearchTreeFolderMatch(elementB)) {\n\t\telemAIndex = elementA.index();\n\t\telemBIndex = elementB.index();\n\t\tif (elemAIndex !== -1 && elemBIndex !== -1) {\n\t\t\treturn elemAIndex - elemBIndex;\n\t\t}\n\n\t\tif (isSearchTreeAIFileMatch(elementA) && isSearchTreeAIFileMatch(elementB)) {\n\t\t\treturn elementA.rank - elementB.rank;\n\t\t}\n\t\tswitch (sortOrder) {\n\t\t\tcase SearchSortOrder.CountDescending:\n\t\t\t\treturn elementB.count() - elementA.count();\n\t\t\tcase SearchSortOrder.CountAscending:\n\t\t\t\treturn elementA.count() - elementB.count();\n\t\t\tcase SearchSortOrder.Type:\n\t\t\t\treturn compareFileExtensions(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.FileNames:\n\t\t\t\treturn compareFileNames(elementA.name(), elementB.name());\n\t\t\t// Fall through otherwise\n\t\t\tdefault:\n\t\t\t\tif (!elementA.resource || !elementB.resource) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn comparePaths(elementA.resource.fsPath, elementB.resource.fsPath) || compareFileNames(elementA.name(), elementB.name());\n\t\t}\n\t}\n\n\tif (isSearchTreeFileMatch(elementA) && isSearchTreeFileMatch(elementB)) {\n\t\tswitch (sortOrder) {\n\t\t\tcase SearchSortOrder.CountDescending:\n\t\t\t\treturn elementB.count() - elementA.count();\n\t\t\tcase SearchSortOrder.CountAscending:\n\t\t\t\treturn elementA.count() - elementB.count();\n\t\t\tcase SearchSortOrder.Type:\n\t\t\t\treturn compareFileExtensions(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.FileNames:\n\t\t\t\treturn compareFileNames(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.Modified: {\n\t\t\t\tconst fileStatA = elementA.fileStat;\n\t\t\t\tconst fileStatB = elementB.fileStat;\n\t\t\t\tif (fileStatA && fileStatB) {\n\t\t\t\t\treturn fileStatB.mtime - fileStatA.mtime;\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Fall through otherwise\n\t\t\tdefault:\n\t\t\t\treturn comparePaths(elementA.resource.fsPath, elementB.resource.fsPath) || compareFileNames(elementA.name(), elementB.name());\n\t\t}\n\t}\n\n\tif (isIMatchInNotebook(elementA) && isIMatchInNotebook(elementB)) {\n\t\treturn compareNotebookPos(elementA, elementB);\n\t}\n\n\tif (isSearchTreeMatch(elementA) && isSearchTreeMatch(elementB)) {\n\t\treturn Range.compareRangesUsingStarts(elementA.range(), elementB.range());\n\t}\n\n\treturn 0;\n}\n\nfunction compareNotebookPos(match1: IMatchInNotebook, match2: IMatchInNotebook): number {\n\tif (match1.cellIndex === match2.cellIndex) {\n\n\t\tif (match1.webviewIndex !== undefined && match2.webviewIndex !== undefined) {\n\t\t\treturn match1.webviewIndex - match2.webviewIndex;\n\t\t} else if (match1.webviewIndex === undefined && match2.webviewIndex === undefined) {\n\t\t\treturn Range.compareRangesUsingStarts(match1.range(), match2.range());\n\t\t} else {\n\t\t\t// webview matches should always be after content matches\n\t\t\tif (match1.webviewIndex !== undefined) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t} else if (match1.cellIndex < match2.cellIndex) {\n\t\treturn -1;\n\t} else {\n\t\treturn 1;\n\t}\n}\n\nexport function searchComparer(elementA: RenderableMatch, elementB: RenderableMatch, sortOrder: SearchSortOrder = SearchSortOrder.Default): number {\n\tconst elemAParents = createParentList(elementA);\n\tconst elemBParents = createParentList(elementB);\n\n\tlet i = elemAParents.length - 1;\n\tlet j = elemBParents.length - 1;\n\twhile (i >= 0 && j >= 0) {\n\t\tif (elemAParents[i].id() !== elemBParents[j].id()) {\n\t\t\treturn searchMatchComparer(elemAParents[i], elemBParents[j], sortOrder);\n\t\t}\n\t\ti--;\n\t\tj--;\n\t}\n\tconst elemAAtEnd = i === 0;\n\tconst elemBAtEnd = j === 0;\n\n\tif (elemAAtEnd && !elemBAtEnd) {\n\t\treturn 1;\n\t} else if (!elemAAtEnd && elemBAtEnd) {\n\t\treturn -1;\n\t}\n\treturn 0;\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMatchInNotebook, isIMatchInNotebook } from './notebookSearch/notebookSearchModelBase.js';\nimport { compareFileExtensions, compareFileNames, comparePaths } from '../../../../base/common/comparers.js';\nimport { SearchSortOrder } from '../../../services/search/common/search.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { createParentList, isSearchTreeFileMatch, isSearchTreeFolderMatch, isSearchTreeMatch, RenderableMatch } from './searchTreeModel/searchTreeCommon.js';\nimport { isSearchTreeAIFileMatch } from './AISearch/aiSearchModelBase.js';\n\n\nlet elemAIndex: number = -1;\nlet elemBIndex: number = -1;\n\n/**\n * Compares instances of the same match type. Different match types should not be siblings\n * and their sort order is undefined.\n */\nexport function searchMatchComparer(elementA: RenderableMatch, elementB: RenderableMatch, sortOrder: SearchSortOrder = SearchSortOrder.Default): number {\n\tif (isSearchTreeFileMatch(elementA) && isSearchTreeFolderMatch(elementB)) {\n\t\treturn 1;\n\t}\n\n\tif (isSearchTreeFileMatch(elementB) && isSearchTreeFolderMatch(elementA)) {\n\t\treturn -1;\n\t}\n\n\tif (isSearchTreeFolderMatch(elementA) && isSearchTreeFolderMatch(elementB)) {\n\t\telemAIndex = elementA.index();\n\t\telemBIndex = elementB.index();\n\t\tif (elemAIndex !== -1 && elemBIndex !== -1) {\n\t\t\treturn elemAIndex - elemBIndex;\n\t\t}\n\n\t\tif (isSearchTreeAIFileMatch(elementA) && isSearchTreeAIFileMatch(elementB)) {\n\t\t\treturn elementA.rank - elementB.rank;\n\t\t}\n\t\tswitch (sortOrder) {\n\t\t\tcase SearchSortOrder.CountDescending:\n\t\t\t\treturn elementB.count() - elementA.count();\n\t\t\tcase SearchSortOrder.CountAscending:\n\t\t\t\treturn elementA.count() - elementB.count();\n\t\t\tcase SearchSortOrder.Type:\n\t\t\t\treturn compareFileExtensions(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.FileNames:\n\t\t\t\treturn compareFileNames(elementA.name(), elementB.name());\n\t\t\t// Fall through otherwise\n\t\t\tdefault:\n\t\t\t\tif (!elementA.resource || !elementB.resource) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn comparePaths(elementA.resource.fsPath, elementB.resource.fsPath) || compareFileNames(elementA.name(), elementB.name());\n\t\t}\n\t}\n\n\tif (isSearchTreeFileMatch(elementA) && isSearchTreeFileMatch(elementB)) {\n\t\tswitch (sortOrder) {\n\t\t\tcase SearchSortOrder.CountDescending:\n\t\t\t\treturn elementB.count() - elementA.count();\n\t\t\tcase SearchSortOrder.CountAscending:\n\t\t\t\treturn elementA.count() - elementB.count();\n\t\t\tcase SearchSortOrder.Type:\n\t\t\t\treturn compareFileExtensions(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.FileNames:\n\t\t\t\treturn compareFileNames(elementA.name(), elementB.name());\n\t\t\tcase SearchSortOrder.Modified: {\n\t\t\t\tconst fileStatA = elementA.fileStat;\n\t\t\t\tconst fileStatB = elementB.fileStat;\n\t\t\t\tif (fileStatA && fileStatB) {\n\t\t\t\t\treturn fileStatB.mtime - fileStatA.mtime;\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Fall through otherwise\n\t\t\tdefault:\n\t\t\t\treturn comparePaths(elementA.resource.fsPath, elementB.resource.fsPath) || compareFileNames(elementA.name(), elementB.name());\n\t\t}\n\t}\n\n\tif (isIMatchInNotebook(elementA) && isIMatchInNotebook(elementB)) {\n\t\treturn compareNotebookPos(elementA, elementB);\n\t}\n\n\tif (isSearchTreeMatch(elementA) && isSearchTreeMatch(elementB)) {\n\t\treturn Range.compareRangesUsingStarts(elementA.range(), elementB.range());\n\t}\n\n\treturn 0;\n}\n\nfunction compareNotebookPos(match1: IMatchInNotebook, match2: IMatchInNotebook): number {\n\tif (match1.cellIndex === match2.cellIndex) {\n\n\t\tif (match1.webviewIndex !== undefined && match2.webviewIndex !== undefined) {\n\t\t\treturn match1.webviewIndex - match2.webviewIndex;\n\t\t} else if (match1.webviewIndex === undefined && match2.webviewIndex === undefined) {\n\t\t\treturn Range.compareRangesUsingStarts(match1.range(), match2.range());\n\t\t} else {\n\t\t\t// webview matches should always be after content matches\n\t\t\tif (match1.webviewIndex !== undefined) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t} else if (match1.cellIndex < match2.cellIndex) {\n\t\treturn -1;\n\t} else {\n\t\treturn 1;\n\t}\n}\n\nexport function searchComparer(elementA: RenderableMatch, elementB: RenderableMatch, sortOrder: SearchSortOrder = SearchSortOrder.Default): number {\n\tconst elemAParents = createParentList(elementA);\n\tconst elemBParents = createParentList(elementB);\n\n\tlet i = elemAParents.length - 1;\n\tlet j = elemBParents.length - 1;\n\twhile (i >= 0 && j >= 0) {\n\t\tif (elemAParents[i].id() !== elemBParents[j].id()) {\n\t\t\treturn searchMatchComparer(elemAParents[i], elemBParents[j], sortOrder);\n\t\t}\n\t\ti--;\n\t\tj--;\n\t}\n\tconst elemAAtEnd = i === 0;\n\tconst elemBAtEnd = j === 0;\n\n\tif (elemAAtEnd && !elemBAtEnd) {\n\t\treturn 1;\n\t} else if (!elemAAtEnd && elemBAtEnd) {\n\t\treturn -1;\n\t}\n\treturn 0;\n}\n\n"]}