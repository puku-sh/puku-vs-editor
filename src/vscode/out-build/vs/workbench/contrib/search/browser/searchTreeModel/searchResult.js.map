{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/browser/searchTreeModel/searchResult.ts","vs/workbench/contrib/search/browser/searchTreeModel/searchResult.ts"],"names":[],"mappings":"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","file":"searchResult.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, PauseableEmitter } from '../../../../../base/common/event.js';\nimport { Disposable, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IProgress, IProgressStep } from '../../../../../platform/progress/common/progress.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { IAITextQuery, IFileMatch, ISearchComplete, ITextQuery, QueryType } from '../../../../services/search/common/search.js';\nimport { arrayContainsElementOrParent, IChangeEvent, ISearchTreeFileMatch, ISearchTreeFolderMatch, IPlainTextSearchHeading, ISearchModel, ISearchResult, isSearchTreeFileMatch, isSearchTreeFolderMatch, isSearchTreeFolderMatchWithResource, isSearchTreeMatch, isTextSearchHeading, ITextSearchHeading, mergeSearchResultEvents, RenderableMatch, SEARCH_RESULT_PREFIX } from './searchTreeCommon.js';\n\nimport { RangeHighlightDecorations } from './rangeDecorations.js';\nimport { PlainTextSearchHeadingImpl } from './textSearchHeading.js';\nimport { AITextSearchHeadingImpl } from '../AISearch/aiSearchModel.js';\n\nexport class SearchResultImpl extends Disposable implements ISearchResult {\n\n\tprivate _onChange = this._register(new PauseableEmitter<IChangeEvent>({\n\t\tmerge: mergeSearchResultEvents\n\t}));\n\treadonly onChange: Event<IChangeEvent> = this._onChange.event;\n\tprivate _onWillChangeModelListener: IDisposable | undefined;\n\tprivate _onDidChangeModelListener: IDisposable | undefined;\n\tprivate _plainTextSearchResult: PlainTextSearchHeadingImpl;\n\tprivate _aiTextSearchResult: AITextSearchHeadingImpl;\n\n\tprivate readonly _id: string;\n\tconstructor(\n\t\tpublic readonly searchModel: ISearchModel,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@INotebookEditorService private readonly notebookEditorService: INotebookEditorService,\n\t) {\n\t\tsuper();\n\t\tthis._plainTextSearchResult = this._register(this.instantiationService.createInstance(PlainTextSearchHeadingImpl, this));\n\t\tthis._aiTextSearchResult = this._register(this.instantiationService.createInstance(AITextSearchHeadingImpl, this));\n\n\t\tthis._register(this._plainTextSearchResult.onChange((e) => this._onChange.fire(e)));\n\t\tthis._register(this._aiTextSearchResult.onChange((e) => this._onChange.fire(e)));\n\n\t\tthis.modelService.getModels().forEach(model => this.onModelAdded(model));\n\t\tthis._register(this.modelService.onModelAdded(model => this.onModelAdded(model)));\n\n\t\tthis._register(this.notebookEditorService.onDidAddNotebookEditor(widget => {\n\t\t\tif (widget instanceof NotebookEditorWidget) {\n\t\t\t\tthis.onDidAddNotebookEditorWidget(<NotebookEditorWidget>widget);\n\t\t\t}\n\t\t}));\n\n\t\tthis._id = SEARCH_RESULT_PREFIX + Date.now().toString();\n\t}\n\n\tid(): string {\n\t\treturn this._id;\n\t}\n\n\tget plainTextSearchResult(): IPlainTextSearchHeading {\n\t\treturn this._plainTextSearchResult;\n\t}\n\n\tget aiTextSearchResult(): ITextSearchHeading {\n\t\treturn this._aiTextSearchResult;\n\t}\n\n\tget children() {\n\t\treturn this.textSearchResults;\n\t}\n\n\tget hasChildren(): boolean {\n\t\treturn true; // should always have a Text Search Result for plain results.\n\t}\n\tget textSearchResults(): ITextSearchHeading[] {\n\t\treturn [this._plainTextSearchResult, this._aiTextSearchResult];\n\t}\n\n\tasync batchReplace(elementsToReplace: RenderableMatch[]) {\n\t\ttry {\n\t\t\tthis._onChange.pause();\n\t\t\tawait Promise.all(elementsToReplace.map(async (elem) => {\n\t\t\t\tconst parent = elem.parent();\n\n\t\t\t\tif ((isSearchTreeFolderMatch(parent) || isSearchTreeFileMatch(parent)) && arrayContainsElementOrParent(parent, elementsToReplace)) {\n\t\t\t\t\t// skip any children who have parents in the array\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (isSearchTreeFileMatch(elem)) {\n\t\t\t\t\tawait elem.parent().replace(elem);\n\t\t\t\t} else if (isSearchTreeMatch(elem)) {\n\t\t\t\t\tawait elem.parent().replace(elem);\n\t\t\t\t} else if (isSearchTreeFolderMatch(elem)) {\n\t\t\t\t\tawait elem.replaceAll();\n\t\t\t\t}\n\t\t\t}));\n\t\t} finally {\n\t\t\tthis._onChange.resume();\n\t\t}\n\t}\n\n\tbatchRemove(elementsToRemove: RenderableMatch[]) {\n\t\t// need to check that we aren't trying to remove elements twice\n\t\tconst removedElems: RenderableMatch[] = [];\n\n\t\ttry {\n\t\t\tthis._onChange.pause();\n\t\t\telementsToRemove.forEach((currentElement) => {\n\t\t\t\tif (!arrayContainsElementOrParent(currentElement, removedElems)) {\n\t\t\t\t\tif (isTextSearchHeading(currentElement)) {\n\t\t\t\t\t\tcurrentElement.hide();\n\t\t\t\t\t} else if (!isSearchTreeFolderMatch(currentElement) || isSearchTreeFolderMatchWithResource(currentElement)) {\n\t\t\t\t\t\tif (isSearchTreeFileMatch(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t} else if (isSearchTreeMatch(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t} else if (isSearchTreeFolderMatchWithResource(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tremovedElems.push(currentElement);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t} finally {\n\t\t\tthis._onChange.resume();\n\t\t}\n\t}\n\n\tget isDirty(): boolean {\n\t\treturn this._aiTextSearchResult.isDirty || this._plainTextSearchResult.isDirty;\n\t}\n\n\tget query(): ITextQuery | null {\n\t\treturn this._plainTextSearchResult.query;\n\t}\n\n\tset query(query: ITextQuery | null) {\n\t\tthis._plainTextSearchResult.query = query;\n\t}\n\n\tsetAIQueryUsingTextQuery(query?: ITextQuery | null) {\n\t\tif (!query) {\n\t\t\tquery = this.query;\n\t\t}\n\t\tthis.aiTextSearchResult.query = aiTextQueryFromTextQuery(query);\n\t}\n\n\tprivate onDidAddNotebookEditorWidget(widget: NotebookEditorWidget): void {\n\n\t\tthis._onWillChangeModelListener?.dispose();\n\t\tthis._onWillChangeModelListener = widget.onWillChangeModel(\n\t\t\t(model) => {\n\t\t\t\tif (model) {\n\t\t\t\t\tthis.onNotebookEditorWidgetRemoved(widget, model?.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._onDidChangeModelListener?.dispose();\n\t\t// listen to view model change as we are searching on both inputs and outputs\n\t\tthis._onDidChangeModelListener = widget.onDidAttachViewModel(\n\t\t\t() => {\n\t\t\t\tif (widget.hasModel()) {\n\t\t\t\t\tthis.onNotebookEditorWidgetAdded(widget, widget.textModel.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tfolderMatches(ai: boolean = false): ISearchTreeFolderMatch[] {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.folderMatches();\n\t\t}\n\t\treturn this._plainTextSearchResult.folderMatches();\n\t}\n\n\tprivate onModelAdded(model: ITextModel): void {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(model.uri);\n\t\tfolderMatch?.bindModel(model);\n\t}\n\n\tprivate async onNotebookEditorWidgetAdded(editor: NotebookEditorWidget, resource: URI): Promise<void> {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(resource);\n\t\tawait folderMatch?.bindNotebookEditorWidget(editor, resource);\n\t}\n\n\tprivate onNotebookEditorWidgetRemoved(editor: NotebookEditorWidget, resource: URI): void {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(resource);\n\t\tfolderMatch?.unbindNotebookEditorWidget(editor, resource);\n\t}\n\n\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent: boolean = false): void {\n\t\tthis._plainTextSearchResult.hidden = false;\n\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.add(allRaw, searchInstanceID, silent);\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.add(allRaw, searchInstanceID, silent);\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tthis._plainTextSearchResult.clear();\n\t\tthis._aiTextSearchResult.clear();\n\t}\n\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai = false): void {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.remove(matches, ai);\n\t\t}\n\t\tthis._plainTextSearchResult.remove(matches, ai);\n\n\t}\n\n\treplace(match: ISearchTreeFileMatch): Promise<any> {\n\t\treturn this._plainTextSearchResult.replace(match);\n\t}\n\n\tmatches(ai?: boolean): ISearchTreeFileMatch[] {\n\t\tif (ai === undefined) {\n\t\t\treturn this._plainTextSearchResult.matches().concat(this._aiTextSearchResult.matches());\n\t\t} else if (ai === true) {\n\t\t\treturn this._aiTextSearchResult.matches();\n\t\t}\n\t\treturn this._plainTextSearchResult.matches();\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._plainTextSearchResult.isEmpty() && this._aiTextSearchResult.isEmpty();\n\t}\n\n\tfileCount(ignoreSemanticSearchResults: boolean = false): number {\n\t\tif (ignoreSemanticSearchResults) {\n\t\t\treturn this._plainTextSearchResult.fileCount();\n\t\t}\n\t\treturn this._plainTextSearchResult.fileCount() + this._aiTextSearchResult.fileCount();\n\t}\n\n\tcount(ignoreSemanticSearchResults: boolean = false): number {\n\t\tif (ignoreSemanticSearchResults) {\n\t\t\treturn this._plainTextSearchResult.count();\n\t\t}\n\t\treturn this._plainTextSearchResult.count() + this._aiTextSearchResult.count();\n\t}\n\n\tsetCachedSearchComplete(cachedSearchComplete: ISearchComplete | undefined, ai: boolean) {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.cachedSearchComplete = cachedSearchComplete;\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.cachedSearchComplete = cachedSearchComplete;\n\t\t}\n\t}\n\n\tgetCachedSearchComplete(ai: boolean): ISearchComplete | undefined {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.cachedSearchComplete;\n\t\t}\n\t\treturn this._plainTextSearchResult.cachedSearchComplete;\n\t}\n\n\ttoggleHighlights(value: boolean, ai: boolean = false): void {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.toggleHighlights(value);\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.toggleHighlights(value);\n\t\t}\n\t}\n\n\tgetRangeHighlightDecorations(ai: boolean = false): RangeHighlightDecorations {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.rangeHighlightDecorations;\n\t\t}\n\t\treturn this._plainTextSearchResult.rangeHighlightDecorations;\n\t}\n\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any> {\n\t\treturn this._plainTextSearchResult.replaceAll(progress);\n\t}\n\n\toverride async dispose(): Promise<void> {\n\t\tthis._aiTextSearchResult?.dispose();\n\t\tthis._plainTextSearchResult?.dispose();\n\t\tthis._onWillChangeModelListener?.dispose();\n\t\tthis._onDidChangeModelListener?.dispose();\n\t\tsuper.dispose();\n\t}\n}\n\nfunction aiTextQueryFromTextQuery(query: ITextQuery | null): IAITextQuery | null {\n\treturn query === null ? null : { ...query, contentPattern: query.contentPattern.pattern, type: QueryType.aiText };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, PauseableEmitter } from '../../../../../base/common/event.js';\nimport { Disposable, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IProgress, IProgressStep } from '../../../../../platform/progress/common/progress.js';\nimport { NotebookEditorWidget } from '../../../notebook/browser/notebookEditorWidget.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { IAITextQuery, IFileMatch, ISearchComplete, ITextQuery, QueryType } from '../../../../services/search/common/search.js';\nimport { arrayContainsElementOrParent, IChangeEvent, ISearchTreeFileMatch, ISearchTreeFolderMatch, IPlainTextSearchHeading, ISearchModel, ISearchResult, isSearchTreeFileMatch, isSearchTreeFolderMatch, isSearchTreeFolderMatchWithResource, isSearchTreeMatch, isTextSearchHeading, ITextSearchHeading, mergeSearchResultEvents, RenderableMatch, SEARCH_RESULT_PREFIX } from './searchTreeCommon.js';\n\nimport { RangeHighlightDecorations } from './rangeDecorations.js';\nimport { PlainTextSearchHeadingImpl } from './textSearchHeading.js';\nimport { AITextSearchHeadingImpl } from '../AISearch/aiSearchModel.js';\n\nexport class SearchResultImpl extends Disposable implements ISearchResult {\n\n\tprivate _onChange = this._register(new PauseableEmitter<IChangeEvent>({\n\t\tmerge: mergeSearchResultEvents\n\t}));\n\treadonly onChange: Event<IChangeEvent> = this._onChange.event;\n\tprivate _onWillChangeModelListener: IDisposable | undefined;\n\tprivate _onDidChangeModelListener: IDisposable | undefined;\n\tprivate _plainTextSearchResult: PlainTextSearchHeadingImpl;\n\tprivate _aiTextSearchResult: AITextSearchHeadingImpl;\n\n\tprivate readonly _id: string;\n\tconstructor(\n\t\tpublic readonly searchModel: ISearchModel,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@INotebookEditorService private readonly notebookEditorService: INotebookEditorService,\n\t) {\n\t\tsuper();\n\t\tthis._plainTextSearchResult = this._register(this.instantiationService.createInstance(PlainTextSearchHeadingImpl, this));\n\t\tthis._aiTextSearchResult = this._register(this.instantiationService.createInstance(AITextSearchHeadingImpl, this));\n\n\t\tthis._register(this._plainTextSearchResult.onChange((e) => this._onChange.fire(e)));\n\t\tthis._register(this._aiTextSearchResult.onChange((e) => this._onChange.fire(e)));\n\n\t\tthis.modelService.getModels().forEach(model => this.onModelAdded(model));\n\t\tthis._register(this.modelService.onModelAdded(model => this.onModelAdded(model)));\n\n\t\tthis._register(this.notebookEditorService.onDidAddNotebookEditor(widget => {\n\t\t\tif (widget instanceof NotebookEditorWidget) {\n\t\t\t\tthis.onDidAddNotebookEditorWidget(<NotebookEditorWidget>widget);\n\t\t\t}\n\t\t}));\n\n\t\tthis._id = SEARCH_RESULT_PREFIX + Date.now().toString();\n\t}\n\n\tid(): string {\n\t\treturn this._id;\n\t}\n\n\tget plainTextSearchResult(): IPlainTextSearchHeading {\n\t\treturn this._plainTextSearchResult;\n\t}\n\n\tget aiTextSearchResult(): ITextSearchHeading {\n\t\treturn this._aiTextSearchResult;\n\t}\n\n\tget children() {\n\t\treturn this.textSearchResults;\n\t}\n\n\tget hasChildren(): boolean {\n\t\treturn true; // should always have a Text Search Result for plain results.\n\t}\n\tget textSearchResults(): ITextSearchHeading[] {\n\t\treturn [this._plainTextSearchResult, this._aiTextSearchResult];\n\t}\n\n\tasync batchReplace(elementsToReplace: RenderableMatch[]) {\n\t\ttry {\n\t\t\tthis._onChange.pause();\n\t\t\tawait Promise.all(elementsToReplace.map(async (elem) => {\n\t\t\t\tconst parent = elem.parent();\n\n\t\t\t\tif ((isSearchTreeFolderMatch(parent) || isSearchTreeFileMatch(parent)) && arrayContainsElementOrParent(parent, elementsToReplace)) {\n\t\t\t\t\t// skip any children who have parents in the array\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (isSearchTreeFileMatch(elem)) {\n\t\t\t\t\tawait elem.parent().replace(elem);\n\t\t\t\t} else if (isSearchTreeMatch(elem)) {\n\t\t\t\t\tawait elem.parent().replace(elem);\n\t\t\t\t} else if (isSearchTreeFolderMatch(elem)) {\n\t\t\t\t\tawait elem.replaceAll();\n\t\t\t\t}\n\t\t\t}));\n\t\t} finally {\n\t\t\tthis._onChange.resume();\n\t\t}\n\t}\n\n\tbatchRemove(elementsToRemove: RenderableMatch[]) {\n\t\t// need to check that we aren't trying to remove elements twice\n\t\tconst removedElems: RenderableMatch[] = [];\n\n\t\ttry {\n\t\t\tthis._onChange.pause();\n\t\t\telementsToRemove.forEach((currentElement) => {\n\t\t\t\tif (!arrayContainsElementOrParent(currentElement, removedElems)) {\n\t\t\t\t\tif (isTextSearchHeading(currentElement)) {\n\t\t\t\t\t\tcurrentElement.hide();\n\t\t\t\t\t} else if (!isSearchTreeFolderMatch(currentElement) || isSearchTreeFolderMatchWithResource(currentElement)) {\n\t\t\t\t\t\tif (isSearchTreeFileMatch(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t} else if (isSearchTreeMatch(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t} else if (isSearchTreeFolderMatchWithResource(currentElement)) {\n\t\t\t\t\t\t\tcurrentElement.parent().remove(currentElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tremovedElems.push(currentElement);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t);\n\t\t} finally {\n\t\t\tthis._onChange.resume();\n\t\t}\n\t}\n\n\tget isDirty(): boolean {\n\t\treturn this._aiTextSearchResult.isDirty || this._plainTextSearchResult.isDirty;\n\t}\n\n\tget query(): ITextQuery | null {\n\t\treturn this._plainTextSearchResult.query;\n\t}\n\n\tset query(query: ITextQuery | null) {\n\t\tthis._plainTextSearchResult.query = query;\n\t}\n\n\tsetAIQueryUsingTextQuery(query?: ITextQuery | null) {\n\t\tif (!query) {\n\t\t\tquery = this.query;\n\t\t}\n\t\tthis.aiTextSearchResult.query = aiTextQueryFromTextQuery(query);\n\t}\n\n\tprivate onDidAddNotebookEditorWidget(widget: NotebookEditorWidget): void {\n\n\t\tthis._onWillChangeModelListener?.dispose();\n\t\tthis._onWillChangeModelListener = widget.onWillChangeModel(\n\t\t\t(model) => {\n\t\t\t\tif (model) {\n\t\t\t\t\tthis.onNotebookEditorWidgetRemoved(widget, model?.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._onDidChangeModelListener?.dispose();\n\t\t// listen to view model change as we are searching on both inputs and outputs\n\t\tthis._onDidChangeModelListener = widget.onDidAttachViewModel(\n\t\t\t() => {\n\t\t\t\tif (widget.hasModel()) {\n\t\t\t\t\tthis.onNotebookEditorWidgetAdded(widget, widget.textModel.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tfolderMatches(ai: boolean = false): ISearchTreeFolderMatch[] {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.folderMatches();\n\t\t}\n\t\treturn this._plainTextSearchResult.folderMatches();\n\t}\n\n\tprivate onModelAdded(model: ITextModel): void {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(model.uri);\n\t\tfolderMatch?.bindModel(model);\n\t}\n\n\tprivate async onNotebookEditorWidgetAdded(editor: NotebookEditorWidget, resource: URI): Promise<void> {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(resource);\n\t\tawait folderMatch?.bindNotebookEditorWidget(editor, resource);\n\t}\n\n\tprivate onNotebookEditorWidgetRemoved(editor: NotebookEditorWidget, resource: URI): void {\n\t\tconst folderMatch = this._plainTextSearchResult.findFolderSubstr(resource);\n\t\tfolderMatch?.unbindNotebookEditorWidget(editor, resource);\n\t}\n\n\n\tadd(allRaw: IFileMatch[], searchInstanceID: string, ai: boolean, silent: boolean = false): void {\n\t\tthis._plainTextSearchResult.hidden = false;\n\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.add(allRaw, searchInstanceID, silent);\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.add(allRaw, searchInstanceID, silent);\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tthis._plainTextSearchResult.clear();\n\t\tthis._aiTextSearchResult.clear();\n\t}\n\n\tremove(matches: ISearchTreeFileMatch | ISearchTreeFolderMatch | (ISearchTreeFileMatch | ISearchTreeFolderMatch)[], ai = false): void {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.remove(matches, ai);\n\t\t}\n\t\tthis._plainTextSearchResult.remove(matches, ai);\n\n\t}\n\n\treplace(match: ISearchTreeFileMatch): Promise<any> {\n\t\treturn this._plainTextSearchResult.replace(match);\n\t}\n\n\tmatches(ai?: boolean): ISearchTreeFileMatch[] {\n\t\tif (ai === undefined) {\n\t\t\treturn this._plainTextSearchResult.matches().concat(this._aiTextSearchResult.matches());\n\t\t} else if (ai === true) {\n\t\t\treturn this._aiTextSearchResult.matches();\n\t\t}\n\t\treturn this._plainTextSearchResult.matches();\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._plainTextSearchResult.isEmpty() && this._aiTextSearchResult.isEmpty();\n\t}\n\n\tfileCount(ignoreSemanticSearchResults: boolean = false): number {\n\t\tif (ignoreSemanticSearchResults) {\n\t\t\treturn this._plainTextSearchResult.fileCount();\n\t\t}\n\t\treturn this._plainTextSearchResult.fileCount() + this._aiTextSearchResult.fileCount();\n\t}\n\n\tcount(ignoreSemanticSearchResults: boolean = false): number {\n\t\tif (ignoreSemanticSearchResults) {\n\t\t\treturn this._plainTextSearchResult.count();\n\t\t}\n\t\treturn this._plainTextSearchResult.count() + this._aiTextSearchResult.count();\n\t}\n\n\tsetCachedSearchComplete(cachedSearchComplete: ISearchComplete | undefined, ai: boolean) {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.cachedSearchComplete = cachedSearchComplete;\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.cachedSearchComplete = cachedSearchComplete;\n\t\t}\n\t}\n\n\tgetCachedSearchComplete(ai: boolean): ISearchComplete | undefined {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.cachedSearchComplete;\n\t\t}\n\t\treturn this._plainTextSearchResult.cachedSearchComplete;\n\t}\n\n\ttoggleHighlights(value: boolean, ai: boolean = false): void {\n\t\tif (ai) {\n\t\t\tthis._aiTextSearchResult.toggleHighlights(value);\n\t\t} else {\n\t\t\tthis._plainTextSearchResult.toggleHighlights(value);\n\t\t}\n\t}\n\n\tgetRangeHighlightDecorations(ai: boolean = false): RangeHighlightDecorations {\n\t\tif (ai) {\n\t\t\treturn this._aiTextSearchResult.rangeHighlightDecorations;\n\t\t}\n\t\treturn this._plainTextSearchResult.rangeHighlightDecorations;\n\t}\n\n\treplaceAll(progress: IProgress<IProgressStep>): Promise<any> {\n\t\treturn this._plainTextSearchResult.replaceAll(progress);\n\t}\n\n\toverride async dispose(): Promise<void> {\n\t\tthis._aiTextSearchResult?.dispose();\n\t\tthis._plainTextSearchResult?.dispose();\n\t\tthis._onWillChangeModelListener?.dispose();\n\t\tthis._onDidChangeModelListener?.dispose();\n\t\tsuper.dispose();\n\t}\n}\n\nfunction aiTextQueryFromTextQuery(query: ITextQuery | null): IAITextQuery | null {\n\treturn query === null ? null : { ...query, contentPattern: query.contentPattern.pattern, type: QueryType.aiText };\n}\n"]}