{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/test/browser/searchViewlet.test.ts","vs/workbench/contrib/search/test/browser/searchViewlet.test.ts"],"names":[],"mappings":"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","file":"searchViewlet.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IUriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { TestWorkspace } from '../../../../../platform/workspace/test/common/testWorkspace.js';\nimport { SearchModelImpl } from '../../browser/searchTreeModel/searchModel.js';\nimport { MockLabelService } from '../../../../services/label/test/common/mockLabelService.js';\nimport { IFileMatch, ITextSearchMatch, OneLineRange, QueryType, SearchSortOrder } from '../../../../services/search/common/search.js';\nimport { TestContextService } from '../../../../test/common/workbenchTestServices.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { createFileUriFromPathFromRoot, getRootName, stubModelService, stubNotebookEditorService } from './searchTestCommon.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ISearchTreeFolderMatch, ISearchResult, ITextSearchHeading, FILE_MATCH_PREFIX, MATCH_PREFIX } from '../../browser/searchTreeModel/searchTreeCommon.js';\nimport { NotebookCompatibleFileMatch } from '../../browser/notebookSearch/notebookSearchModel.js';\nimport { INotebookFileInstanceMatch } from '../../browser/notebookSearch/notebookSearchModelBase.js';\nimport { FolderMatchImpl } from '../../browser/searchTreeModel/folderMatch.js';\nimport { searchComparer, searchMatchComparer } from '../../browser/searchCompare.js';\nimport { MatchImpl } from '../../browser/searchTreeModel/match.js';\n\nsuite('Search - Viewlet', () => {\n\tlet instantiation: TestInstantiationService;\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tinstantiation = new TestInstantiationService();\n\t\tinstantiation.stub(ILanguageConfigurationService, TestLanguageConfigurationService);\n\t\tinstantiation.stub(IModelService, stubModelService(instantiation, (e) => store.add(e)));\n\t\tinstantiation.stub(INotebookEditorService, stubNotebookEditorService(instantiation, (e) => store.add(e)));\n\n\t\tinstantiation.set(IWorkspaceContextService, new TestContextService(TestWorkspace));\n\t\tconst fileService = new FileService(new NullLogService());\n\t\tstore.add(fileService);\n\t\tconst uriIdentityService = new UriIdentityService(fileService);\n\t\tstore.add(uriIdentityService);\n\t\tinstantiation.stub(IUriIdentityService, uriIdentityService);\n\t\tinstantiation.stub(ILabelService, new MockLabelService());\n\t\tinstantiation.stub(ILogService, new NullLogService());\n\t});\n\n\tteardown(() => {\n\t\tinstantiation.dispose();\n\t});\n\n\ttest('Data Source', function () {\n\t\tconst result: ISearchResult = aSearchResult();\n\t\tresult.query = {\n\t\t\ttype: QueryType.Text,\n\t\t\tcontentPattern: { pattern: 'foo' },\n\t\t\tfolderQueries: [{\n\t\t\t\tfolder: createFileUriFromPathFromRoot()\n\t\t\t}]\n\t\t};\n\n\t\tresult.add([{\n\t\t\tresource: createFileUriFromPathFromRoot('/foo'),\n\t\t\tresults: [{\n\n\t\t\t\tpreviewText: 'bar',\n\t\t\t\trangeLocations: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpreview: {\n\t\t\t\t\t\t\tstartLineNumber: 0,\n\t\t\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\t\t\tendLineNumber: 0,\n\t\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsource: {\n\t\t\t\t\t\t\tstartLineNumber: 1,\n\t\t\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\t\t\tendLineNumber: 1,\n\t\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}]\n\t\t}], '', false);\n\n\t\tconst fileMatch = result.matches()[0];\n\t\tconst lineMatch = fileMatch.matches()[0];\n\n\t\tassert.strictEqual(fileMatch.id(), FILE_MATCH_PREFIX + URI.file(`${getRootName()}/foo`).toString());\n\t\tassert.strictEqual(lineMatch.id(), `${MATCH_PREFIX}${URI.file(`${getRootName()}/foo`).toString()}>[2,1 -> 2,2]b`);\n\t});\n\n\ttest('Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch('/foo');\n\t\tconst fileMatch2 = aFileMatch('/with/path');\n\t\tconst fileMatch3 = aFileMatch('/with/path/foo');\n\t\tconst lineMatch1 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch2 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\t\tconst lineMatch3 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch1) > 0);\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch1) === 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch3) < 0);\n\n\t\tassert(searchMatchComparer(lineMatch1, lineMatch2) < 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch1) > 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch3) === 0);\n\t});\n\n\ttest('Advanced Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch('/with/path/foo10');\n\t\tconst fileMatch2 = aFileMatch('/with/path2/foo1');\n\t\tconst fileMatch3 = aFileMatch('/with/path/bar.a');\n\t\tconst fileMatch4 = aFileMatch('/with/path/bar.b');\n\n\t\t// By default, path < path2\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\t// By filenames, foo10 > foo1\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2, SearchSortOrder.FileNames) > 0);\n\t\t// By type, bar.a < bar.b\n\t\tassert(searchMatchComparer(fileMatch3, fileMatch4, SearchSortOrder.Type) < 0);\n\t});\n\n\ttest('Cross-type Comparer', () => {\n\n\t\tconst searchResult = aSearchResult();\n\t\tconst folderMatch1 = aFolderMatch('/voo', 0, searchResult.plainTextSearchResult);\n\t\tconst folderMatch2 = aFolderMatch('/with', 1, searchResult.plainTextSearchResult);\n\n\t\tconst fileMatch1 = aFileMatch('/voo/foo.a', folderMatch1);\n\t\tconst fileMatch2 = aFileMatch('/with/path.c', folderMatch2);\n\t\tconst fileMatch3 = aFileMatch('/with/path/bar.b', folderMatch2);\n\n\t\tconst lineMatch1 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch2 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tconst lineMatch3 = new MatchImpl(fileMatch2, ['barfoo'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch4 = new MatchImpl(fileMatch2, ['fooooo'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tconst lineMatch5 = new MatchImpl(fileMatch3, ['foobar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\t/***\n\t\t * Structure would take the following form:\n\t\t *\n\t\t *\tfolderMatch1 (voo)\n\t\t *\t\t> fileMatch1 (/foo.a)\n\t\t *\t\t\t>> lineMatch1\n\t\t *\t\t\t>> lineMatch2\n\t\t *\tfolderMatch2 (with)\n\t\t *\t\t> fileMatch2 (/path.c)\n\t\t *\t\t\t>> lineMatch4\n\t\t *\t\t\t>> lineMatch5\n\t\t *\t\t> fileMatch3 (/path/bar.b)\n\t\t *\t\t\t>> lineMatch3\n\t\t *\n\t\t */\n\n\t\t// for these, refer to diagram above\n\t\tassert(searchComparer(fileMatch1, fileMatch3) < 0);\n\t\tassert(searchComparer(fileMatch2, fileMatch3) < 0);\n\t\tassert(searchComparer(folderMatch2, fileMatch2) < 0);\n\t\tassert(searchComparer(lineMatch4, lineMatch5) < 0);\n\t\tassert(searchComparer(lineMatch1, lineMatch3) < 0);\n\t\tassert(searchComparer(lineMatch2, folderMatch2) < 0);\n\n\t\t// travel up hierarchy and order of folders take precedence. \"voo < with\" in indices\n\t\tassert(searchComparer(fileMatch1, fileMatch3, SearchSortOrder.FileNames) < 0);\n\t\t// bar.b < path.c\n\t\tassert(searchComparer(fileMatch3, fileMatch2, SearchSortOrder.FileNames) < 0);\n\t\t// lineMatch4's parent is fileMatch2, \"bar.b < path.c\"\n\t\tassert(searchComparer(fileMatch3, lineMatch4, SearchSortOrder.FileNames) < 0);\n\n\t\t// bar.b < path.c\n\t\tassert(searchComparer(fileMatch3, fileMatch2, SearchSortOrder.Type) < 0);\n\t\t// lineMatch4's parent is fileMatch2, \"bar.b < path.c\"\n\t\tassert(searchComparer(fileMatch3, lineMatch4, SearchSortOrder.Type) < 0);\n\t});\n\n\tfunction aFileMatch(path: string, parentFolder?: ISearchTreeFolderMatch, ...lineMatches: ITextSearchMatch[]): INotebookFileInstanceMatch {\n\t\tconst rawMatch: IFileMatch = {\n\t\t\tresource: URI.file('/' + path),\n\t\t\tresults: lineMatches\n\t\t};\n\t\tconst fileMatch = instantiation.createInstance(NotebookCompatibleFileMatch, {\n\t\t\tpattern: ''\n\t\t}, undefined, undefined, parentFolder ?? aFolderMatch('', 0), rawMatch, null, '');\n\t\tfileMatch.createMatches();\n\t\tstore.add(fileMatch);\n\t\treturn fileMatch;\n\t}\n\n\tfunction aFolderMatch(path: string, index: number, parent?: ITextSearchHeading): ISearchTreeFolderMatch {\n\t\tconst searchModel = instantiation.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\t\tconst folderMatch = instantiation.createInstance(FolderMatchImpl, createFileUriFromPathFromRoot(path), path, index, {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t}, (parent ?? aSearchResult().folderMatches()[0]) as FolderMatchImpl, searchModel.searchResult, null);\n\t\tstore.add(folderMatch);\n\t\treturn folderMatch;\n\t}\n\n\tfunction aSearchResult(): ISearchResult {\n\t\tconst searchModel = instantiation.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\n\t\tsearchModel.searchResult.query = {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t};\n\t\treturn searchModel.searchResult;\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IUriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { IWorkspaceContextService } from '../../../../../platform/workspace/common/workspace.js';\nimport { TestWorkspace } from '../../../../../platform/workspace/test/common/testWorkspace.js';\nimport { SearchModelImpl } from '../../browser/searchTreeModel/searchModel.js';\nimport { MockLabelService } from '../../../../services/label/test/common/mockLabelService.js';\nimport { IFileMatch, ITextSearchMatch, OneLineRange, QueryType, SearchSortOrder } from '../../../../services/search/common/search.js';\nimport { TestContextService } from '../../../../test/common/workbenchTestServices.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { createFileUriFromPathFromRoot, getRootName, stubModelService, stubNotebookEditorService } from './searchTestCommon.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ISearchTreeFolderMatch, ISearchResult, ITextSearchHeading, FILE_MATCH_PREFIX, MATCH_PREFIX } from '../../browser/searchTreeModel/searchTreeCommon.js';\nimport { NotebookCompatibleFileMatch } from '../../browser/notebookSearch/notebookSearchModel.js';\nimport { INotebookFileInstanceMatch } from '../../browser/notebookSearch/notebookSearchModelBase.js';\nimport { FolderMatchImpl } from '../../browser/searchTreeModel/folderMatch.js';\nimport { searchComparer, searchMatchComparer } from '../../browser/searchCompare.js';\nimport { MatchImpl } from '../../browser/searchTreeModel/match.js';\n\nsuite('Search - Viewlet', () => {\n\tlet instantiation: TestInstantiationService;\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tinstantiation = new TestInstantiationService();\n\t\tinstantiation.stub(ILanguageConfigurationService, TestLanguageConfigurationService);\n\t\tinstantiation.stub(IModelService, stubModelService(instantiation, (e) => store.add(e)));\n\t\tinstantiation.stub(INotebookEditorService, stubNotebookEditorService(instantiation, (e) => store.add(e)));\n\n\t\tinstantiation.set(IWorkspaceContextService, new TestContextService(TestWorkspace));\n\t\tconst fileService = new FileService(new NullLogService());\n\t\tstore.add(fileService);\n\t\tconst uriIdentityService = new UriIdentityService(fileService);\n\t\tstore.add(uriIdentityService);\n\t\tinstantiation.stub(IUriIdentityService, uriIdentityService);\n\t\tinstantiation.stub(ILabelService, new MockLabelService());\n\t\tinstantiation.stub(ILogService, new NullLogService());\n\t});\n\n\tteardown(() => {\n\t\tinstantiation.dispose();\n\t});\n\n\ttest('Data Source', function () {\n\t\tconst result: ISearchResult = aSearchResult();\n\t\tresult.query = {\n\t\t\ttype: QueryType.Text,\n\t\t\tcontentPattern: { pattern: 'foo' },\n\t\t\tfolderQueries: [{\n\t\t\t\tfolder: createFileUriFromPathFromRoot()\n\t\t\t}]\n\t\t};\n\n\t\tresult.add([{\n\t\t\tresource: createFileUriFromPathFromRoot('/foo'),\n\t\t\tresults: [{\n\n\t\t\t\tpreviewText: 'bar',\n\t\t\t\trangeLocations: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpreview: {\n\t\t\t\t\t\t\tstartLineNumber: 0,\n\t\t\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\t\t\tendLineNumber: 0,\n\t\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsource: {\n\t\t\t\t\t\t\tstartLineNumber: 1,\n\t\t\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\t\t\tendLineNumber: 1,\n\t\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}]\n\t\t}], '', false);\n\n\t\tconst fileMatch = result.matches()[0];\n\t\tconst lineMatch = fileMatch.matches()[0];\n\n\t\tassert.strictEqual(fileMatch.id(), FILE_MATCH_PREFIX + URI.file(`${getRootName()}/foo`).toString());\n\t\tassert.strictEqual(lineMatch.id(), `${MATCH_PREFIX}${URI.file(`${getRootName()}/foo`).toString()}>[2,1 -> 2,2]b`);\n\t});\n\n\ttest('Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch('/foo');\n\t\tconst fileMatch2 = aFileMatch('/with/path');\n\t\tconst fileMatch3 = aFileMatch('/with/path/foo');\n\t\tconst lineMatch1 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch2 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\t\tconst lineMatch3 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch1) > 0);\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch1) === 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch3) < 0);\n\n\t\tassert(searchMatchComparer(lineMatch1, lineMatch2) < 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch1) > 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch3) === 0);\n\t});\n\n\ttest('Advanced Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch('/with/path/foo10');\n\t\tconst fileMatch2 = aFileMatch('/with/path2/foo1');\n\t\tconst fileMatch3 = aFileMatch('/with/path/bar.a');\n\t\tconst fileMatch4 = aFileMatch('/with/path/bar.b');\n\n\t\t// By default, path < path2\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\t// By filenames, foo10 > foo1\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2, SearchSortOrder.FileNames) > 0);\n\t\t// By type, bar.a < bar.b\n\t\tassert(searchMatchComparer(fileMatch3, fileMatch4, SearchSortOrder.Type) < 0);\n\t});\n\n\ttest('Cross-type Comparer', () => {\n\n\t\tconst searchResult = aSearchResult();\n\t\tconst folderMatch1 = aFolderMatch('/voo', 0, searchResult.plainTextSearchResult);\n\t\tconst folderMatch2 = aFolderMatch('/with', 1, searchResult.plainTextSearchResult);\n\n\t\tconst fileMatch1 = aFileMatch('/voo/foo.a', folderMatch1);\n\t\tconst fileMatch2 = aFileMatch('/with/path.c', folderMatch2);\n\t\tconst fileMatch3 = aFileMatch('/with/path/bar.b', folderMatch2);\n\n\t\tconst lineMatch1 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch2 = new MatchImpl(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tconst lineMatch3 = new MatchImpl(fileMatch2, ['barfoo'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1), false);\n\t\tconst lineMatch4 = new MatchImpl(fileMatch2, ['fooooo'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\tconst lineMatch5 = new MatchImpl(fileMatch3, ['foobar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1), false);\n\n\t\t/***\n\t\t * Structure would take the following form:\n\t\t *\n\t\t *\tfolderMatch1 (voo)\n\t\t *\t\t> fileMatch1 (/foo.a)\n\t\t *\t\t\t>> lineMatch1\n\t\t *\t\t\t>> lineMatch2\n\t\t *\tfolderMatch2 (with)\n\t\t *\t\t> fileMatch2 (/path.c)\n\t\t *\t\t\t>> lineMatch4\n\t\t *\t\t\t>> lineMatch5\n\t\t *\t\t> fileMatch3 (/path/bar.b)\n\t\t *\t\t\t>> lineMatch3\n\t\t *\n\t\t */\n\n\t\t// for these, refer to diagram above\n\t\tassert(searchComparer(fileMatch1, fileMatch3) < 0);\n\t\tassert(searchComparer(fileMatch2, fileMatch3) < 0);\n\t\tassert(searchComparer(folderMatch2, fileMatch2) < 0);\n\t\tassert(searchComparer(lineMatch4, lineMatch5) < 0);\n\t\tassert(searchComparer(lineMatch1, lineMatch3) < 0);\n\t\tassert(searchComparer(lineMatch2, folderMatch2) < 0);\n\n\t\t// travel up hierarchy and order of folders take precedence. \"voo < with\" in indices\n\t\tassert(searchComparer(fileMatch1, fileMatch3, SearchSortOrder.FileNames) < 0);\n\t\t// bar.b < path.c\n\t\tassert(searchComparer(fileMatch3, fileMatch2, SearchSortOrder.FileNames) < 0);\n\t\t// lineMatch4's parent is fileMatch2, \"bar.b < path.c\"\n\t\tassert(searchComparer(fileMatch3, lineMatch4, SearchSortOrder.FileNames) < 0);\n\n\t\t// bar.b < path.c\n\t\tassert(searchComparer(fileMatch3, fileMatch2, SearchSortOrder.Type) < 0);\n\t\t// lineMatch4's parent is fileMatch2, \"bar.b < path.c\"\n\t\tassert(searchComparer(fileMatch3, lineMatch4, SearchSortOrder.Type) < 0);\n\t});\n\n\tfunction aFileMatch(path: string, parentFolder?: ISearchTreeFolderMatch, ...lineMatches: ITextSearchMatch[]): INotebookFileInstanceMatch {\n\t\tconst rawMatch: IFileMatch = {\n\t\t\tresource: URI.file('/' + path),\n\t\t\tresults: lineMatches\n\t\t};\n\t\tconst fileMatch = instantiation.createInstance(NotebookCompatibleFileMatch, {\n\t\t\tpattern: ''\n\t\t}, undefined, undefined, parentFolder ?? aFolderMatch('', 0), rawMatch, null, '');\n\t\tfileMatch.createMatches();\n\t\tstore.add(fileMatch);\n\t\treturn fileMatch;\n\t}\n\n\tfunction aFolderMatch(path: string, index: number, parent?: ITextSearchHeading): ISearchTreeFolderMatch {\n\t\tconst searchModel = instantiation.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\t\tconst folderMatch = instantiation.createInstance(FolderMatchImpl, createFileUriFromPathFromRoot(path), path, index, {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t}, (parent ?? aSearchResult().folderMatches()[0]) as FolderMatchImpl, searchModel.searchResult, null);\n\t\tstore.add(folderMatch);\n\t\treturn folderMatch;\n\t}\n\n\tfunction aSearchResult(): ISearchResult {\n\t\tconst searchModel = instantiation.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\n\t\tsearchModel.searchResult.query = {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t};\n\t\treturn searchModel.searchResult;\n\t}\n});\n"]}