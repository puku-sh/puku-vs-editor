{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/search/test/browser/searchActions.test.ts","vs/workbench/contrib/search/test/browser/searchActions.test.ts"],"names":[],"mappings":"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","file":"searchActions.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Keybinding } from '../../../../../base/common/keybindings.js';\nimport { OS } from '../../../../../base/common/platform.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { USLayoutResolvedKeybinding } from '../../../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\nimport { IFileMatch, QueryType } from '../../../../services/search/common/search.js';\nimport { getElementToFocusAfterRemoved, getLastNodeFromSameType } from '../../browser/searchActionsRemoveReplace.js';\nimport { SearchModelImpl } from '../../browser/searchTreeModel/searchModel.js';\nimport { MockObjectTree } from './mockSearchTree.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { createFileUriFromPathFromRoot, stubModelService, stubNotebookEditorService } from './searchTestCommon.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { FolderMatchImpl } from '../../browser/searchTreeModel/folderMatch.js';\nimport { ISearchTreeFileMatch, ISearchTreeMatch, FileMatchOrMatch } from '../../browser/searchTreeModel/searchTreeCommon.js';\nimport { NotebookCompatibleFileMatch } from '../../browser/notebookSearch/notebookSearchModel.js';\nimport { INotebookFileInstanceMatch } from '../../browser/notebookSearch/notebookSearchModelBase.js';\nimport { MatchImpl } from '../../browser/searchTreeModel/match.js';\n\nsuite('Search Actions', () => {\n\n\tlet instantiationService: TestInstantiationService;\n\tlet counter: number;\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tinstantiationService = new TestInstantiationService();\n\t\tinstantiationService.stub(IModelService, stubModelService(instantiationService, (e) => store.add(e)));\n\t\tinstantiationService.stub(INotebookEditorService, stubNotebookEditorService(instantiationService, (e) => store.add(e)));\n\t\tinstantiationService.stub(IKeybindingService, {});\n\t\tinstantiationService.stub(ILabelService, { getUriBasenameLabel: (uri: URI) => '' });\n\t\tinstantiationService.stub(IKeybindingService, 'resolveKeybinding', (keybinding: Keybinding) => USLayoutResolvedKeybinding.resolveKeybinding(keybinding, OS));\n\t\tinstantiationService.stub(IKeybindingService, 'lookupKeybinding', (id: string) => null);\n\t\tinstantiationService.stub(IKeybindingService, 'lookupKeybinding', (id: string) => null);\n\t\tcounter = 0;\n\t});\n\n\tteardown(() => {\n\t\tinstantiationService.dispose();\n\t});\n\n\ttest('get next element to focus after removing a match when it has next sibling file', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), aMatch(fileMatch2)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[2];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, [target]);\n\t\tassert.strictEqual(data[4], actual);\n\t});\n\n\ttest('get next element to focus after removing a match when it is the only match', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[1];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, [target]);\n\t\tassert.strictEqual(undefined, actual);\n\t});\n\n\ttest('get next element to focus after removing a file match when it has next sibling', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[2];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, []);\n\t\tassert.strictEqual(data[4], actual);\n\t});\n\n\ttest('Find last FileMatch in Tree', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\n\t\tconst actual = await getLastNodeFromSameType(tree, fileMatch1);\n\t\tassert.strictEqual(fileMatch3, actual);\n\t});\n\n\ttest('Find last Match in Tree', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\n\t\tconst actual = await getLastNodeFromSameType(tree, aMatch(fileMatch1));\n\t\tassert.strictEqual(data[5], actual);\n\t});\n\n\ttest('get next element to focus after removing a file match when it is only match', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[0];\n\t\t// const testObject: ReplaceAction = instantiationService.createInstance(ReplaceAction, tree, target, null);\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, []);\n\t\tassert.strictEqual(undefined, actual);\n\t});\n\n\tfunction aFileMatch(): INotebookFileInstanceMatch {\n\t\tconst uri = URI.file('somepath' + ++counter);\n\t\tconst rawMatch: IFileMatch = {\n\t\t\tresource: uri,\n\t\t\tresults: []\n\t\t};\n\n\t\tconst searchModel = instantiationService.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\t\tconst folderMatch = instantiationService.createInstance(FolderMatchImpl, URI.file('somepath'), '', 0, {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t}, searchModel.searchResult.plainTextSearchResult, searchModel.searchResult, null);\n\t\tstore.add(folderMatch);\n\t\tconst fileMatch = instantiationService.createInstance(NotebookCompatibleFileMatch, {\n\t\t\tpattern: ''\n\t\t}, undefined, undefined, folderMatch, rawMatch, null, '');\n\t\tfileMatch.createMatches();\n\t\tstore.add(fileMatch);\n\t\treturn fileMatch;\n\t}\n\n\tfunction aMatch(fileMatch: ISearchTreeFileMatch): ISearchTreeMatch {\n\t\tconst line = ++counter;\n\t\tconst match = new MatchImpl(\n\t\t\tfileMatch,\n\t\t\t['some match'],\n\t\t\t{\n\t\t\t\tstartLineNumber: 0,\n\t\t\t\tstartColumn: 0,\n\t\t\t\tendLineNumber: 0,\n\t\t\t\tendColumn: 2\n\t\t\t},\n\t\t\t{\n\t\t\t\tstartLineNumber: line,\n\t\t\t\tstartColumn: 0,\n\t\t\t\tendLineNumber: line,\n\t\t\t\tendColumn: 2\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\t\tfileMatch.add(match);\n\t\treturn match;\n\t}\n\n\tfunction aTree(elements: FileMatchOrMatch[]): any {\n\t\treturn new MockObjectTree(elements);\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Keybinding } from '../../../../../base/common/keybindings.js';\nimport { OS } from '../../../../../base/common/platform.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { USLayoutResolvedKeybinding } from '../../../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\nimport { IFileMatch, QueryType } from '../../../../services/search/common/search.js';\nimport { getElementToFocusAfterRemoved, getLastNodeFromSameType } from '../../browser/searchActionsRemoveReplace.js';\nimport { SearchModelImpl } from '../../browser/searchTreeModel/searchModel.js';\nimport { MockObjectTree } from './mockSearchTree.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { INotebookEditorService } from '../../../notebook/browser/services/notebookEditorService.js';\nimport { createFileUriFromPathFromRoot, stubModelService, stubNotebookEditorService } from './searchTestCommon.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { FolderMatchImpl } from '../../browser/searchTreeModel/folderMatch.js';\nimport { ISearchTreeFileMatch, ISearchTreeMatch, FileMatchOrMatch } from '../../browser/searchTreeModel/searchTreeCommon.js';\nimport { NotebookCompatibleFileMatch } from '../../browser/notebookSearch/notebookSearchModel.js';\nimport { INotebookFileInstanceMatch } from '../../browser/notebookSearch/notebookSearchModelBase.js';\nimport { MatchImpl } from '../../browser/searchTreeModel/match.js';\n\nsuite('Search Actions', () => {\n\n\tlet instantiationService: TestInstantiationService;\n\tlet counter: number;\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tinstantiationService = new TestInstantiationService();\n\t\tinstantiationService.stub(IModelService, stubModelService(instantiationService, (e) => store.add(e)));\n\t\tinstantiationService.stub(INotebookEditorService, stubNotebookEditorService(instantiationService, (e) => store.add(e)));\n\t\tinstantiationService.stub(IKeybindingService, {});\n\t\tinstantiationService.stub(ILabelService, { getUriBasenameLabel: (uri: URI) => '' });\n\t\tinstantiationService.stub(IKeybindingService, 'resolveKeybinding', (keybinding: Keybinding) => USLayoutResolvedKeybinding.resolveKeybinding(keybinding, OS));\n\t\tinstantiationService.stub(IKeybindingService, 'lookupKeybinding', (id: string) => null);\n\t\tinstantiationService.stub(IKeybindingService, 'lookupKeybinding', (id: string) => null);\n\t\tcounter = 0;\n\t});\n\n\tteardown(() => {\n\t\tinstantiationService.dispose();\n\t});\n\n\ttest('get next element to focus after removing a match when it has next sibling file', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), aMatch(fileMatch2)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[2];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, [target]);\n\t\tassert.strictEqual(data[4], actual);\n\t});\n\n\ttest('get next element to focus after removing a match when it is the only match', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[1];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, [target]);\n\t\tassert.strictEqual(undefined, actual);\n\t});\n\n\ttest('get next element to focus after removing a file match when it has next sibling', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[2];\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, []);\n\t\tassert.strictEqual(data[4], actual);\n\t});\n\n\ttest('Find last FileMatch in Tree', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\n\t\tconst actual = await getLastNodeFromSameType(tree, fileMatch1);\n\t\tassert.strictEqual(fileMatch3, actual);\n\t});\n\n\ttest('Find last Match in Tree', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst fileMatch2 = aFileMatch();\n\t\tconst fileMatch3 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1), fileMatch2, aMatch(fileMatch2), fileMatch3, aMatch(fileMatch3)];\n\t\tconst tree = aTree(data);\n\n\t\tconst actual = await getLastNodeFromSameType(tree, aMatch(fileMatch1));\n\t\tassert.strictEqual(data[5], actual);\n\t});\n\n\ttest('get next element to focus after removing a file match when it is only match', async function () {\n\t\tconst fileMatch1 = aFileMatch();\n\t\tconst data = [fileMatch1, aMatch(fileMatch1)];\n\t\tconst tree = aTree(data);\n\t\tconst target = data[0];\n\t\t// const testObject: ReplaceAction = instantiationService.createInstance(ReplaceAction, tree, target, null);\n\n\t\tconst actual = await getElementToFocusAfterRemoved(tree, target, []);\n\t\tassert.strictEqual(undefined, actual);\n\t});\n\n\tfunction aFileMatch(): INotebookFileInstanceMatch {\n\t\tconst uri = URI.file('somepath' + ++counter);\n\t\tconst rawMatch: IFileMatch = {\n\t\t\tresource: uri,\n\t\t\tresults: []\n\t\t};\n\n\t\tconst searchModel = instantiationService.createInstance(SearchModelImpl);\n\t\tstore.add(searchModel);\n\t\tconst folderMatch = instantiationService.createInstance(FolderMatchImpl, URI.file('somepath'), '', 0, {\n\t\t\ttype: QueryType.Text, folderQueries: [{ folder: createFileUriFromPathFromRoot() }], contentPattern: {\n\t\t\t\tpattern: ''\n\t\t\t}\n\t\t}, searchModel.searchResult.plainTextSearchResult, searchModel.searchResult, null);\n\t\tstore.add(folderMatch);\n\t\tconst fileMatch = instantiationService.createInstance(NotebookCompatibleFileMatch, {\n\t\t\tpattern: ''\n\t\t}, undefined, undefined, folderMatch, rawMatch, null, '');\n\t\tfileMatch.createMatches();\n\t\tstore.add(fileMatch);\n\t\treturn fileMatch;\n\t}\n\n\tfunction aMatch(fileMatch: ISearchTreeFileMatch): ISearchTreeMatch {\n\t\tconst line = ++counter;\n\t\tconst match = new MatchImpl(\n\t\t\tfileMatch,\n\t\t\t['some match'],\n\t\t\t{\n\t\t\t\tstartLineNumber: 0,\n\t\t\t\tstartColumn: 0,\n\t\t\t\tendLineNumber: 0,\n\t\t\t\tendColumn: 2\n\t\t\t},\n\t\t\t{\n\t\t\t\tstartLineNumber: line,\n\t\t\t\tstartColumn: 0,\n\t\t\t\tendLineNumber: line,\n\t\t\t\tendColumn: 2\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\t\tfileMatch.add(match);\n\t\treturn match;\n\t}\n\n\tfunction aTree(elements: FileMatchOrMatch[]): any {\n\t\treturn new MockObjectTree(elements);\n\t}\n});\n"]}