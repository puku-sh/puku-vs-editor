{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/debug/browser/debugExpressionRenderer.ts","vs/workbench/contrib/debug/browser/debugExpressionRenderer.ts"],"names":[],"mappings":"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","file":"debugExpressionRenderer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IHighlight } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable } from '../../../../base/common/observable.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { observableConfigValue } from '../../../../platform/observable/common/platformObservableUtils.js';\nimport { IDebugSession, IExpressionValue } from '../common/debug.js';\nimport { Expression, ExpressionContainer, Variable } from '../common/debugModel.js';\nimport { ReplEvaluationResult } from '../common/replModel.js';\nimport { IVariableTemplateData, splitExpressionOrScopeHighlights } from './baseDebugView.js';\nimport { handleANSIOutput } from './debugANSIHandling.js';\nimport { COPY_EVALUATE_PATH_ID, COPY_VALUE_ID } from './debugCommands.js';\nimport { DebugLinkHoverBehavior, DebugLinkHoverBehaviorTypeData, ILinkDetector, LinkDetector } from './linkDetector.js';\n\nexport interface IValueHoverOptions {\n\t/** Commands to show in the hover footer. */\n\tcommands?: { id: string; args: unknown[] }[];\n}\n\nexport interface IRenderValueOptions {\n\tshowChanged?: boolean;\n\tmaxValueLength?: number;\n\t/** If not false, a rich hover will be shown on the element. */\n\thover?: false | IValueHoverOptions;\n\tcolorize?: boolean;\n\thighlights?: IHighlight[];\n\n\t/**\n\t * Indicates areas where VS Code implicitly always supported ANSI escape\n\t * sequences. These should be rendered as ANSI when the DA does not specify\n\t * any value of `supportsANSIStyling`.\n\t * @deprecated\n\t */\n\twasANSI?: boolean;\n\tsession?: IDebugSession;\n\tlocationReference?: number;\n}\n\nexport interface IRenderVariableOptions {\n\tshowChanged?: boolean;\n\thighlights?: IHighlight[];\n}\n\n\nconst MAX_VALUE_RENDER_LENGTH_IN_VIEWLET = 1024;\nconst booleanRegex = /^(true|false)$/i;\nconst stringRegex = /^(['\"]).*\\1$/;\n\nconst enum Cls {\n\tValue = 'value',\n\tUnavailable = 'unavailable',\n\tError = 'error',\n\tChanged = 'changed',\n\tBoolean = 'boolean',\n\tString = 'string',\n\tNumber = 'number',\n}\n\nconst allClasses: readonly Cls[] = Object.keys({\n\t[Cls.Value]: 0,\n\t[Cls.Unavailable]: 0,\n\t[Cls.Error]: 0,\n\t[Cls.Changed]: 0,\n\t[Cls.Boolean]: 0,\n\t[Cls.String]: 0,\n\t[Cls.Number]: 0,\n} satisfies { [key in Cls]: unknown }) as Cls[];\n\nexport class DebugExpressionRenderer {\n\tprivate displayType: IObservable<boolean>;\n\tprivate readonly linkDetector: LinkDetector;\n\n\tconstructor(\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t) {\n\t\tthis.linkDetector = instantiationService.createInstance(LinkDetector);\n\t\tthis.displayType = observableConfigValue('debug.showVariableTypes', false, configurationService);\n\t}\n\n\trenderVariable(data: IVariableTemplateData, variable: Variable, options: IRenderVariableOptions = {}): IDisposable {\n\t\tconst displayType = this.displayType.get();\n\t\tconst highlights = splitExpressionOrScopeHighlights(variable, options.highlights || []);\n\n\t\tif (variable.available) {\n\t\t\tdata.type.textContent = '';\n\t\t\tlet text = variable.name;\n\t\t\tif (variable.value && typeof variable.name === 'string') {\n\t\t\t\tif (variable.type && displayType) {\n\t\t\t\t\ttext += ': ';\n\t\t\t\t\tdata.type.textContent = variable.type + ' =';\n\t\t\t\t} else {\n\t\t\t\t\ttext += ' =';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.label.set(text, highlights.name, variable.type && !displayType ? variable.type : variable.name);\n\t\t\tdata.name.classList.toggle('virtual', variable.presentationHint?.kind === 'virtual');\n\t\t\tdata.name.classList.toggle('internal', variable.presentationHint?.visibility === 'internal');\n\t\t} else if (variable.value && typeof variable.name === 'string' && variable.name) {\n\t\t\tdata.label.set(':');\n\t\t}\n\n\t\tdata.expression.classList.toggle('lazy', !!variable.presentationHint?.lazy);\n\t\tconst commands = [\n\t\t\t{ id: COPY_VALUE_ID, args: [variable, [variable]] as unknown[] }\n\t\t];\n\t\tif (variable.evaluateName) {\n\t\t\tcommands.push({ id: COPY_EVALUATE_PATH_ID, args: [{ variable }] });\n\t\t}\n\n\t\treturn this.renderValue(data.value, variable, {\n\t\t\tshowChanged: options.showChanged,\n\t\t\tmaxValueLength: MAX_VALUE_RENDER_LENGTH_IN_VIEWLET,\n\t\t\thover: { commands },\n\t\t\thighlights: highlights.value,\n\t\t\tcolorize: true,\n\t\t\tsession: variable.getSession(),\n\t\t});\n\t}\n\n\trenderValue(container: HTMLElement, expressionOrValue: IExpressionValue | string, options: IRenderValueOptions = {}): IDisposable {\n\t\tconst store = new DisposableStore();\n\t\t// Use remembered capabilities so REPL elements can render even once a session ends\n\t\tconst supportsANSI: boolean = options.session?.rememberedCapabilities?.supportsANSIStyling ?? options.wasANSI ?? false;\n\n\t\tlet value = typeof expressionOrValue === 'string' ? expressionOrValue : expressionOrValue.value;\n\n\t\t// remove stale classes\n\t\tfor (const cls of allClasses) {\n\t\t\tcontainer.classList.remove(cls);\n\t\t}\n\t\tcontainer.classList.add(Cls.Value);\n\t\t// when resolving expressions we represent errors from the server as a variable with name === null.\n\t\tif (value === null || ((expressionOrValue instanceof Expression || expressionOrValue instanceof Variable || expressionOrValue instanceof ReplEvaluationResult) && !expressionOrValue.available)) {\n\t\t\tcontainer.classList.add(Cls.Unavailable);\n\t\t\tif (value !== Expression.DEFAULT_VALUE) {\n\t\t\t\tcontainer.classList.add(Cls.Error);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof expressionOrValue !== 'string' && options.showChanged && expressionOrValue.valueChanged && value !== Expression.DEFAULT_VALUE) {\n\t\t\t\t// value changed color has priority over other colors.\n\t\t\t\tcontainer.classList.add(Cls.Changed);\n\t\t\t\texpressionOrValue.valueChanged = false;\n\t\t\t}\n\n\t\t\tif (options.colorize && typeof expressionOrValue !== 'string') {\n\t\t\t\tif (expressionOrValue.type === 'number' || expressionOrValue.type === 'boolean' || expressionOrValue.type === 'string') {\n\t\t\t\t\tcontainer.classList.add(expressionOrValue.type);\n\t\t\t\t} else if (!isNaN(+value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.Number);\n\t\t\t\t} else if (booleanRegex.test(value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.Boolean);\n\t\t\t\t} else if (stringRegex.test(value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.String);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxValueLength && value && value.length > options.maxValueLength) {\n\t\t\tvalue = value.substring(0, options.maxValueLength) + '...';\n\t\t}\n\t\tif (!value) {\n\t\t\tvalue = '';\n\t\t}\n\n\t\tconst session = options.session ?? ((expressionOrValue instanceof ExpressionContainer) ? expressionOrValue.getSession() : undefined);\n\t\t// Only use hovers for links if thre's not going to be a hover for the value.\n\t\tconst hoverBehavior: DebugLinkHoverBehaviorTypeData = options.hover === false ? { type: DebugLinkHoverBehavior.Rich, store } : { type: DebugLinkHoverBehavior.None };\n\t\tdom.clearNode(container);\n\t\tconst locationReference = options.locationReference ?? (expressionOrValue instanceof ExpressionContainer && expressionOrValue.valueLocationReference);\n\n\t\tlet linkDetector: ILinkDetector = this.linkDetector;\n\t\tif (locationReference && session) {\n\t\t\tlinkDetector = this.linkDetector.makeReferencedLinkDetector(locationReference, session);\n\t\t}\n\n\t\tif (supportsANSI) {\n\t\t\tcontainer.appendChild(handleANSIOutput(value, linkDetector, session ? session.root : undefined, options.highlights));\n\t\t} else {\n\t\t\tcontainer.appendChild(linkDetector.linkify(value, false, session?.root, true, hoverBehavior, options.highlights));\n\t\t}\n\n\t\tif (options.hover !== false) {\n\t\t\tconst { commands = [] } = options.hover || {};\n\t\t\tstore.add(this.hoverService.setupManagedHover(getDefaultHoverDelegate('mouse'), container, () => {\n\t\t\t\tconst container = dom.$('div');\n\t\t\t\tconst markdownHoverElement = dom.$('div.hover-row');\n\t\t\t\tconst hoverContentsElement = dom.append(markdownHoverElement, dom.$('div.hover-contents'));\n\t\t\t\tconst hoverContentsPre = dom.append(hoverContentsElement, dom.$('pre.debug-var-hover-pre'));\n\t\t\t\tif (supportsANSI) {\n\t\t\t\t\t// note: intentionally using `this.linkDetector` so we don't blindly linkify the\n\t\t\t\t\t// entire contents and instead only link file paths that it contains.\n\t\t\t\t\thoverContentsPre.appendChild(handleANSIOutput(value, this.linkDetector, session ? session.root : undefined, options.highlights));\n\t\t\t\t} else {\n\t\t\t\t\thoverContentsPre.textContent = value;\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(markdownHoverElement);\n\t\t\t\treturn container;\n\t\t\t}, {\n\t\t\t\tactions: commands.map(({ id, args }) => {\n\t\t\t\t\tconst description = CommandsRegistry.getCommand(id)?.metadata?.description;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: typeof description === 'string' ? description : description ? description.value : id,\n\t\t\t\t\t\tcommandId: id,\n\t\t\t\t\t\trun: () => this.commandService.executeCommand(id, ...args),\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t}));\n\t\t}\n\n\t\treturn store;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IHighlight } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable } from '../../../../base/common/observable.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { observableConfigValue } from '../../../../platform/observable/common/platformObservableUtils.js';\nimport { IDebugSession, IExpressionValue } from '../common/debug.js';\nimport { Expression, ExpressionContainer, Variable } from '../common/debugModel.js';\nimport { ReplEvaluationResult } from '../common/replModel.js';\nimport { IVariableTemplateData, splitExpressionOrScopeHighlights } from './baseDebugView.js';\nimport { handleANSIOutput } from './debugANSIHandling.js';\nimport { COPY_EVALUATE_PATH_ID, COPY_VALUE_ID } from './debugCommands.js';\nimport { DebugLinkHoverBehavior, DebugLinkHoverBehaviorTypeData, ILinkDetector, LinkDetector } from './linkDetector.js';\n\nexport interface IValueHoverOptions {\n\t/** Commands to show in the hover footer. */\n\tcommands?: { id: string; args: unknown[] }[];\n}\n\nexport interface IRenderValueOptions {\n\tshowChanged?: boolean;\n\tmaxValueLength?: number;\n\t/** If not false, a rich hover will be shown on the element. */\n\thover?: false | IValueHoverOptions;\n\tcolorize?: boolean;\n\thighlights?: IHighlight[];\n\n\t/**\n\t * Indicates areas where VS Code implicitly always supported ANSI escape\n\t * sequences. These should be rendered as ANSI when the DA does not specify\n\t * any value of `supportsANSIStyling`.\n\t * @deprecated\n\t */\n\twasANSI?: boolean;\n\tsession?: IDebugSession;\n\tlocationReference?: number;\n}\n\nexport interface IRenderVariableOptions {\n\tshowChanged?: boolean;\n\thighlights?: IHighlight[];\n}\n\n\nconst MAX_VALUE_RENDER_LENGTH_IN_VIEWLET = 1024;\nconst booleanRegex = /^(true|false)$/i;\nconst stringRegex = /^(['\"]).*\\1$/;\n\nconst enum Cls {\n\tValue = 'value',\n\tUnavailable = 'unavailable',\n\tError = 'error',\n\tChanged = 'changed',\n\tBoolean = 'boolean',\n\tString = 'string',\n\tNumber = 'number',\n}\n\nconst allClasses: readonly Cls[] = Object.keys({\n\t[Cls.Value]: 0,\n\t[Cls.Unavailable]: 0,\n\t[Cls.Error]: 0,\n\t[Cls.Changed]: 0,\n\t[Cls.Boolean]: 0,\n\t[Cls.String]: 0,\n\t[Cls.Number]: 0,\n} satisfies { [key in Cls]: unknown }) as Cls[];\n\nexport class DebugExpressionRenderer {\n\tprivate displayType: IObservable<boolean>;\n\tprivate readonly linkDetector: LinkDetector;\n\n\tconstructor(\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t) {\n\t\tthis.linkDetector = instantiationService.createInstance(LinkDetector);\n\t\tthis.displayType = observableConfigValue('debug.showVariableTypes', false, configurationService);\n\t}\n\n\trenderVariable(data: IVariableTemplateData, variable: Variable, options: IRenderVariableOptions = {}): IDisposable {\n\t\tconst displayType = this.displayType.get();\n\t\tconst highlights = splitExpressionOrScopeHighlights(variable, options.highlights || []);\n\n\t\tif (variable.available) {\n\t\t\tdata.type.textContent = '';\n\t\t\tlet text = variable.name;\n\t\t\tif (variable.value && typeof variable.name === 'string') {\n\t\t\t\tif (variable.type && displayType) {\n\t\t\t\t\ttext += ': ';\n\t\t\t\t\tdata.type.textContent = variable.type + ' =';\n\t\t\t\t} else {\n\t\t\t\t\ttext += ' =';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.label.set(text, highlights.name, variable.type && !displayType ? variable.type : variable.name);\n\t\t\tdata.name.classList.toggle('virtual', variable.presentationHint?.kind === 'virtual');\n\t\t\tdata.name.classList.toggle('internal', variable.presentationHint?.visibility === 'internal');\n\t\t} else if (variable.value && typeof variable.name === 'string' && variable.name) {\n\t\t\tdata.label.set(':');\n\t\t}\n\n\t\tdata.expression.classList.toggle('lazy', !!variable.presentationHint?.lazy);\n\t\tconst commands = [\n\t\t\t{ id: COPY_VALUE_ID, args: [variable, [variable]] as unknown[] }\n\t\t];\n\t\tif (variable.evaluateName) {\n\t\t\tcommands.push({ id: COPY_EVALUATE_PATH_ID, args: [{ variable }] });\n\t\t}\n\n\t\treturn this.renderValue(data.value, variable, {\n\t\t\tshowChanged: options.showChanged,\n\t\t\tmaxValueLength: MAX_VALUE_RENDER_LENGTH_IN_VIEWLET,\n\t\t\thover: { commands },\n\t\t\thighlights: highlights.value,\n\t\t\tcolorize: true,\n\t\t\tsession: variable.getSession(),\n\t\t});\n\t}\n\n\trenderValue(container: HTMLElement, expressionOrValue: IExpressionValue | string, options: IRenderValueOptions = {}): IDisposable {\n\t\tconst store = new DisposableStore();\n\t\t// Use remembered capabilities so REPL elements can render even once a session ends\n\t\tconst supportsANSI: boolean = options.session?.rememberedCapabilities?.supportsANSIStyling ?? options.wasANSI ?? false;\n\n\t\tlet value = typeof expressionOrValue === 'string' ? expressionOrValue : expressionOrValue.value;\n\n\t\t// remove stale classes\n\t\tfor (const cls of allClasses) {\n\t\t\tcontainer.classList.remove(cls);\n\t\t}\n\t\tcontainer.classList.add(Cls.Value);\n\t\t// when resolving expressions we represent errors from the server as a variable with name === null.\n\t\tif (value === null || ((expressionOrValue instanceof Expression || expressionOrValue instanceof Variable || expressionOrValue instanceof ReplEvaluationResult) && !expressionOrValue.available)) {\n\t\t\tcontainer.classList.add(Cls.Unavailable);\n\t\t\tif (value !== Expression.DEFAULT_VALUE) {\n\t\t\t\tcontainer.classList.add(Cls.Error);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof expressionOrValue !== 'string' && options.showChanged && expressionOrValue.valueChanged && value !== Expression.DEFAULT_VALUE) {\n\t\t\t\t// value changed color has priority over other colors.\n\t\t\t\tcontainer.classList.add(Cls.Changed);\n\t\t\t\texpressionOrValue.valueChanged = false;\n\t\t\t}\n\n\t\t\tif (options.colorize && typeof expressionOrValue !== 'string') {\n\t\t\t\tif (expressionOrValue.type === 'number' || expressionOrValue.type === 'boolean' || expressionOrValue.type === 'string') {\n\t\t\t\t\tcontainer.classList.add(expressionOrValue.type);\n\t\t\t\t} else if (!isNaN(+value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.Number);\n\t\t\t\t} else if (booleanRegex.test(value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.Boolean);\n\t\t\t\t} else if (stringRegex.test(value)) {\n\t\t\t\t\tcontainer.classList.add(Cls.String);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxValueLength && value && value.length > options.maxValueLength) {\n\t\t\tvalue = value.substring(0, options.maxValueLength) + '...';\n\t\t}\n\t\tif (!value) {\n\t\t\tvalue = '';\n\t\t}\n\n\t\tconst session = options.session ?? ((expressionOrValue instanceof ExpressionContainer) ? expressionOrValue.getSession() : undefined);\n\t\t// Only use hovers for links if thre's not going to be a hover for the value.\n\t\tconst hoverBehavior: DebugLinkHoverBehaviorTypeData = options.hover === false ? { type: DebugLinkHoverBehavior.Rich, store } : { type: DebugLinkHoverBehavior.None };\n\t\tdom.clearNode(container);\n\t\tconst locationReference = options.locationReference ?? (expressionOrValue instanceof ExpressionContainer && expressionOrValue.valueLocationReference);\n\n\t\tlet linkDetector: ILinkDetector = this.linkDetector;\n\t\tif (locationReference && session) {\n\t\t\tlinkDetector = this.linkDetector.makeReferencedLinkDetector(locationReference, session);\n\t\t}\n\n\t\tif (supportsANSI) {\n\t\t\tcontainer.appendChild(handleANSIOutput(value, linkDetector, session ? session.root : undefined, options.highlights));\n\t\t} else {\n\t\t\tcontainer.appendChild(linkDetector.linkify(value, false, session?.root, true, hoverBehavior, options.highlights));\n\t\t}\n\n\t\tif (options.hover !== false) {\n\t\t\tconst { commands = [] } = options.hover || {};\n\t\t\tstore.add(this.hoverService.setupManagedHover(getDefaultHoverDelegate('mouse'), container, () => {\n\t\t\t\tconst container = dom.$('div');\n\t\t\t\tconst markdownHoverElement = dom.$('div.hover-row');\n\t\t\t\tconst hoverContentsElement = dom.append(markdownHoverElement, dom.$('div.hover-contents'));\n\t\t\t\tconst hoverContentsPre = dom.append(hoverContentsElement, dom.$('pre.debug-var-hover-pre'));\n\t\t\t\tif (supportsANSI) {\n\t\t\t\t\t// note: intentionally using `this.linkDetector` so we don't blindly linkify the\n\t\t\t\t\t// entire contents and instead only link file paths that it contains.\n\t\t\t\t\thoverContentsPre.appendChild(handleANSIOutput(value, this.linkDetector, session ? session.root : undefined, options.highlights));\n\t\t\t\t} else {\n\t\t\t\t\thoverContentsPre.textContent = value;\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(markdownHoverElement);\n\t\t\t\treturn container;\n\t\t\t}, {\n\t\t\t\tactions: commands.map(({ id, args }) => {\n\t\t\t\t\tconst description = CommandsRegistry.getCommand(id)?.metadata?.description;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: typeof description === 'string' ? description : description ? description.value : id,\n\t\t\t\t\t\tcommandId: id,\n\t\t\t\t\t\trun: () => this.commandService.executeCommand(id, ...args),\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t}));\n\t\t}\n\n\t\treturn store;\n\t}\n}\n"]}