{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/debug/common/debugViewModel.ts","vs/workbench/contrib/debug/common/debugViewModel.ts"],"names":[],"mappings":"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","file":"debugViewModel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CONTEXT_DISASSEMBLE_REQUEST_SUPPORTED, CONTEXT_EXPRESSION_SELECTED, CONTEXT_FOCUSED_SESSION_IS_ATTACH, CONTEXT_FOCUSED_SESSION_IS_NO_DEBUG, CONTEXT_FOCUSED_STACK_FRAME_HAS_INSTRUCTION_POINTER_REFERENCE, CONTEXT_JUMP_TO_CURSOR_SUPPORTED, CONTEXT_LOADED_SCRIPTS_SUPPORTED, CONTEXT_MULTI_SESSION_DEBUG, CONTEXT_RESTART_FRAME_SUPPORTED, CONTEXT_SET_DATA_BREAKPOINT_BYTES_SUPPORTED, CONTEXT_SET_EXPRESSION_SUPPORTED, CONTEXT_SET_VARIABLE_SUPPORTED, CONTEXT_STEP_BACK_SUPPORTED, CONTEXT_STEP_INTO_TARGETS_SUPPORTED, CONTEXT_SUSPEND_DEBUGGEE_SUPPORTED, CONTEXT_TERMINATE_DEBUGGEE_SUPPORTED, CONTEXT_TERMINATE_THREADS_SUPPORTED, IDebugSession, IExpression, IExpressionContainer, IStackFrame, IThread, IViewModel } from './debug.js';\nimport { isSessionAttach } from './debugUtils.js';\n\nexport class ViewModel implements IViewModel {\n\n\tfirstSessionStart = true;\n\n\tprivate _focusedStackFrame: IStackFrame | undefined;\n\tprivate _focusedSession: IDebugSession | undefined;\n\tprivate _focusedThread: IThread | undefined;\n\tprivate selectedExpression: { expression: IExpression; settingWatch: boolean } | undefined;\n\tprivate readonly _onDidFocusSession = new Emitter<IDebugSession | undefined>();\n\tprivate readonly _onDidFocusThread = new Emitter<{ thread: IThread | undefined; explicit: boolean; session: IDebugSession | undefined }>();\n\tprivate readonly _onDidFocusStackFrame = new Emitter<{ stackFrame: IStackFrame | undefined; explicit: boolean; session: IDebugSession | undefined }>();\n\tprivate readonly _onDidSelectExpression = new Emitter<{ expression: IExpression; settingWatch: boolean } | undefined>();\n\tprivate readonly _onDidEvaluateLazyExpression = new Emitter<IExpressionContainer>();\n\tprivate readonly _onWillUpdateViews = new Emitter<void>();\n\tprivate readonly _onDidChangeVisualization = new Emitter<{ original: IExpression; replacement: IExpression }>();\n\tprivate readonly visualized = new WeakMap<IExpression, IExpression>();\n\tprivate readonly preferredVisualizers = new Map</** cache key */ string, /* tree ID */ string>();\n\tprivate expressionSelectedContextKey!: IContextKey<boolean>;\n\tprivate loadedScriptsSupportedContextKey!: IContextKey<boolean>;\n\tprivate stepBackSupportedContextKey!: IContextKey<boolean>;\n\tprivate focusedSessionIsAttach!: IContextKey<boolean>;\n\tprivate focusedSessionIsNoDebug!: IContextKey<boolean>;\n\tprivate restartFrameSupportedContextKey!: IContextKey<boolean>;\n\tprivate stepIntoTargetsSupported!: IContextKey<boolean>;\n\tprivate jumpToCursorSupported!: IContextKey<boolean>;\n\tprivate setVariableSupported!: IContextKey<boolean>;\n\tprivate setDataBreakpointAtByteSupported!: IContextKey<boolean>;\n\tprivate setExpressionSupported!: IContextKey<boolean>;\n\tprivate multiSessionDebug!: IContextKey<boolean>;\n\tprivate terminateDebuggeeSupported!: IContextKey<boolean>;\n\tprivate suspendDebuggeeSupported!: IContextKey<boolean>;\n\tprivate terminateThreadsSupported!: IContextKey<boolean>;\n\tprivate disassembleRequestSupported!: IContextKey<boolean>;\n\tprivate focusedStackFrameHasInstructionPointerReference!: IContextKey<boolean>;\n\n\tconstructor(private contextKeyService: IContextKeyService) {\n\t\tcontextKeyService.bufferChangeEvents(() => {\n\t\t\tthis.expressionSelectedContextKey = CONTEXT_EXPRESSION_SELECTED.bindTo(contextKeyService);\n\t\t\tthis.loadedScriptsSupportedContextKey = CONTEXT_LOADED_SCRIPTS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.stepBackSupportedContextKey = CONTEXT_STEP_BACK_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.focusedSessionIsAttach = CONTEXT_FOCUSED_SESSION_IS_ATTACH.bindTo(contextKeyService);\n\t\t\tthis.focusedSessionIsNoDebug = CONTEXT_FOCUSED_SESSION_IS_NO_DEBUG.bindTo(contextKeyService);\n\t\t\tthis.restartFrameSupportedContextKey = CONTEXT_RESTART_FRAME_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.stepIntoTargetsSupported = CONTEXT_STEP_INTO_TARGETS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.jumpToCursorSupported = CONTEXT_JUMP_TO_CURSOR_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setVariableSupported = CONTEXT_SET_VARIABLE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setDataBreakpointAtByteSupported = CONTEXT_SET_DATA_BREAKPOINT_BYTES_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setExpressionSupported = CONTEXT_SET_EXPRESSION_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.multiSessionDebug = CONTEXT_MULTI_SESSION_DEBUG.bindTo(contextKeyService);\n\t\t\tthis.terminateDebuggeeSupported = CONTEXT_TERMINATE_DEBUGGEE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.suspendDebuggeeSupported = CONTEXT_SUSPEND_DEBUGGEE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.terminateThreadsSupported = CONTEXT_TERMINATE_THREADS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.disassembleRequestSupported = CONTEXT_DISASSEMBLE_REQUEST_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.focusedStackFrameHasInstructionPointerReference = CONTEXT_FOCUSED_STACK_FRAME_HAS_INSTRUCTION_POINTER_REFERENCE.bindTo(contextKeyService);\n\t\t});\n\t}\n\n\tgetId(): string {\n\t\treturn 'root';\n\t}\n\n\tget focusedSession(): IDebugSession | undefined {\n\t\treturn this._focusedSession;\n\t}\n\n\tget focusedThread(): IThread | undefined {\n\t\treturn this._focusedThread;\n\t}\n\n\tget focusedStackFrame(): IStackFrame | undefined {\n\t\treturn this._focusedStackFrame;\n\t}\n\n\tsetFocus(stackFrame: IStackFrame | undefined, thread: IThread | undefined, session: IDebugSession | undefined, explicit: boolean): void {\n\t\tconst shouldEmitForStackFrame = this._focusedStackFrame !== stackFrame;\n\t\tconst shouldEmitForSession = this._focusedSession !== session;\n\t\tconst shouldEmitForThread = this._focusedThread !== thread;\n\n\n\t\tthis._focusedStackFrame = stackFrame;\n\t\tthis._focusedThread = thread;\n\t\tthis._focusedSession = session;\n\n\t\tthis.contextKeyService.bufferChangeEvents(() => {\n\t\t\tthis.loadedScriptsSupportedContextKey.set(!!session?.capabilities.supportsLoadedSourcesRequest);\n\t\t\tthis.stepBackSupportedContextKey.set(!!session?.capabilities.supportsStepBack);\n\t\t\tthis.restartFrameSupportedContextKey.set(!!session?.capabilities.supportsRestartFrame);\n\t\t\tthis.stepIntoTargetsSupported.set(!!session?.capabilities.supportsStepInTargetsRequest);\n\t\t\tthis.jumpToCursorSupported.set(!!session?.capabilities.supportsGotoTargetsRequest);\n\t\t\tthis.setVariableSupported.set(!!session?.capabilities.supportsSetVariable);\n\t\t\tthis.setDataBreakpointAtByteSupported.set(!!session?.capabilities.supportsDataBreakpointBytes);\n\t\t\tthis.setExpressionSupported.set(!!session?.capabilities.supportsSetExpression);\n\t\t\tthis.terminateDebuggeeSupported.set(!!session?.capabilities.supportTerminateDebuggee);\n\t\t\tthis.suspendDebuggeeSupported.set(!!session?.capabilities.supportSuspendDebuggee);\n\t\t\tthis.terminateThreadsSupported.set(!!session?.capabilities.supportsTerminateThreadsRequest);\n\t\t\tthis.disassembleRequestSupported.set(!!session?.capabilities.supportsDisassembleRequest);\n\t\t\tthis.focusedStackFrameHasInstructionPointerReference.set(!!stackFrame?.instructionPointerReference);\n\t\t\tconst attach = !!session && isSessionAttach(session);\n\t\t\tthis.focusedSessionIsAttach.set(attach);\n\t\t\tthis.focusedSessionIsNoDebug.set(!!session && !!session.configuration.noDebug);\n\t\t});\n\n\t\tif (shouldEmitForSession) {\n\t\t\tthis._onDidFocusSession.fire(session);\n\t\t}\n\n\t\t// should not call onDidFocusThread if onDidFocusStackFrame is called.\n\t\tif (shouldEmitForStackFrame) {\n\t\t\tthis._onDidFocusStackFrame.fire({ stackFrame, explicit, session });\n\t\t} else if (shouldEmitForThread) {\n\t\t\tthis._onDidFocusThread.fire({ thread, explicit, session });\n\t\t}\n\t}\n\n\tget onDidFocusSession(): Event<IDebugSession | undefined> {\n\t\treturn this._onDidFocusSession.event;\n\t}\n\n\tget onDidFocusThread(): Event<{ thread: IThread | undefined; explicit: boolean; session: IDebugSession | undefined }> {\n\t\treturn this._onDidFocusThread.event;\n\t}\n\n\tget onDidFocusStackFrame(): Event<{ stackFrame: IStackFrame | undefined; explicit: boolean; session: IDebugSession | undefined }> {\n\t\treturn this._onDidFocusStackFrame.event;\n\t}\n\n\tget onDidChangeVisualization() {\n\t\treturn this._onDidChangeVisualization.event;\n\t}\n\n\tgetSelectedExpression(): { expression: IExpression; settingWatch: boolean } | undefined {\n\t\treturn this.selectedExpression;\n\t}\n\n\tsetSelectedExpression(expression: IExpression | undefined, settingWatch: boolean) {\n\t\tthis.selectedExpression = expression ? { expression, settingWatch: settingWatch } : undefined;\n\t\tthis.expressionSelectedContextKey.set(!!expression);\n\t\tthis._onDidSelectExpression.fire(this.selectedExpression);\n\t}\n\n\tget onDidSelectExpression(): Event<{ expression: IExpression; settingWatch: boolean } | undefined> {\n\t\treturn this._onDidSelectExpression.event;\n\t}\n\n\tget onDidEvaluateLazyExpression(): Event<IExpressionContainer> {\n\t\treturn this._onDidEvaluateLazyExpression.event;\n\t}\n\n\tupdateViews(): void {\n\t\tthis._onWillUpdateViews.fire();\n\t}\n\n\tget onWillUpdateViews(): Event<void> {\n\t\treturn this._onWillUpdateViews.event;\n\t}\n\n\tisMultiSessionView(): boolean {\n\t\treturn !!this.multiSessionDebug.get();\n\t}\n\n\tsetMultiSessionView(isMultiSessionView: boolean): void {\n\t\tthis.multiSessionDebug.set(isMultiSessionView);\n\t}\n\n\tsetVisualizedExpression(original: IExpression, visualized: IExpression & { treeId: string } | undefined): void {\n\t\tconst current = this.visualized.get(original) || original;\n\t\tconst key = this.getPreferredVisualizedKey(original);\n\t\tif (visualized) {\n\t\t\tthis.visualized.set(original, visualized);\n\t\t\tthis.preferredVisualizers.set(key, visualized.treeId);\n\t\t} else {\n\t\t\tthis.visualized.delete(original);\n\t\t\tthis.preferredVisualizers.delete(key);\n\t\t}\n\t\tthis._onDidChangeVisualization.fire({ original: current, replacement: visualized || original });\n\t}\n\n\tgetVisualizedExpression(expression: IExpression): IExpression | string | undefined {\n\t\treturn this.visualized.get(expression) || this.preferredVisualizers.get(this.getPreferredVisualizedKey(expression));\n\t}\n\n\tasync evaluateLazyExpression(expression: IExpressionContainer): Promise<void> {\n\t\tawait expression.evaluateLazy();\n\t\tthis._onDidEvaluateLazyExpression.fire(expression);\n\t}\n\n\tprivate getPreferredVisualizedKey(expr: IExpression) {\n\t\treturn JSON.stringify([\n\t\t\texpr.name,\n\t\t\texpr.type,\n\t\t\t!!expr.memoryReference,\n\t\t].join('\\0'));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CONTEXT_DISASSEMBLE_REQUEST_SUPPORTED, CONTEXT_EXPRESSION_SELECTED, CONTEXT_FOCUSED_SESSION_IS_ATTACH, CONTEXT_FOCUSED_SESSION_IS_NO_DEBUG, CONTEXT_FOCUSED_STACK_FRAME_HAS_INSTRUCTION_POINTER_REFERENCE, CONTEXT_JUMP_TO_CURSOR_SUPPORTED, CONTEXT_LOADED_SCRIPTS_SUPPORTED, CONTEXT_MULTI_SESSION_DEBUG, CONTEXT_RESTART_FRAME_SUPPORTED, CONTEXT_SET_DATA_BREAKPOINT_BYTES_SUPPORTED, CONTEXT_SET_EXPRESSION_SUPPORTED, CONTEXT_SET_VARIABLE_SUPPORTED, CONTEXT_STEP_BACK_SUPPORTED, CONTEXT_STEP_INTO_TARGETS_SUPPORTED, CONTEXT_SUSPEND_DEBUGGEE_SUPPORTED, CONTEXT_TERMINATE_DEBUGGEE_SUPPORTED, CONTEXT_TERMINATE_THREADS_SUPPORTED, IDebugSession, IExpression, IExpressionContainer, IStackFrame, IThread, IViewModel } from './debug.js';\nimport { isSessionAttach } from './debugUtils.js';\n\nexport class ViewModel implements IViewModel {\n\n\tfirstSessionStart = true;\n\n\tprivate _focusedStackFrame: IStackFrame | undefined;\n\tprivate _focusedSession: IDebugSession | undefined;\n\tprivate _focusedThread: IThread | undefined;\n\tprivate selectedExpression: { expression: IExpression; settingWatch: boolean } | undefined;\n\tprivate readonly _onDidFocusSession = new Emitter<IDebugSession | undefined>();\n\tprivate readonly _onDidFocusThread = new Emitter<{ thread: IThread | undefined; explicit: boolean; session: IDebugSession | undefined }>();\n\tprivate readonly _onDidFocusStackFrame = new Emitter<{ stackFrame: IStackFrame | undefined; explicit: boolean; session: IDebugSession | undefined }>();\n\tprivate readonly _onDidSelectExpression = new Emitter<{ expression: IExpression; settingWatch: boolean } | undefined>();\n\tprivate readonly _onDidEvaluateLazyExpression = new Emitter<IExpressionContainer>();\n\tprivate readonly _onWillUpdateViews = new Emitter<void>();\n\tprivate readonly _onDidChangeVisualization = new Emitter<{ original: IExpression; replacement: IExpression }>();\n\tprivate readonly visualized = new WeakMap<IExpression, IExpression>();\n\tprivate readonly preferredVisualizers = new Map</** cache key */ string, /* tree ID */ string>();\n\tprivate expressionSelectedContextKey!: IContextKey<boolean>;\n\tprivate loadedScriptsSupportedContextKey!: IContextKey<boolean>;\n\tprivate stepBackSupportedContextKey!: IContextKey<boolean>;\n\tprivate focusedSessionIsAttach!: IContextKey<boolean>;\n\tprivate focusedSessionIsNoDebug!: IContextKey<boolean>;\n\tprivate restartFrameSupportedContextKey!: IContextKey<boolean>;\n\tprivate stepIntoTargetsSupported!: IContextKey<boolean>;\n\tprivate jumpToCursorSupported!: IContextKey<boolean>;\n\tprivate setVariableSupported!: IContextKey<boolean>;\n\tprivate setDataBreakpointAtByteSupported!: IContextKey<boolean>;\n\tprivate setExpressionSupported!: IContextKey<boolean>;\n\tprivate multiSessionDebug!: IContextKey<boolean>;\n\tprivate terminateDebuggeeSupported!: IContextKey<boolean>;\n\tprivate suspendDebuggeeSupported!: IContextKey<boolean>;\n\tprivate terminateThreadsSupported!: IContextKey<boolean>;\n\tprivate disassembleRequestSupported!: IContextKey<boolean>;\n\tprivate focusedStackFrameHasInstructionPointerReference!: IContextKey<boolean>;\n\n\tconstructor(private contextKeyService: IContextKeyService) {\n\t\tcontextKeyService.bufferChangeEvents(() => {\n\t\t\tthis.expressionSelectedContextKey = CONTEXT_EXPRESSION_SELECTED.bindTo(contextKeyService);\n\t\t\tthis.loadedScriptsSupportedContextKey = CONTEXT_LOADED_SCRIPTS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.stepBackSupportedContextKey = CONTEXT_STEP_BACK_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.focusedSessionIsAttach = CONTEXT_FOCUSED_SESSION_IS_ATTACH.bindTo(contextKeyService);\n\t\t\tthis.focusedSessionIsNoDebug = CONTEXT_FOCUSED_SESSION_IS_NO_DEBUG.bindTo(contextKeyService);\n\t\t\tthis.restartFrameSupportedContextKey = CONTEXT_RESTART_FRAME_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.stepIntoTargetsSupported = CONTEXT_STEP_INTO_TARGETS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.jumpToCursorSupported = CONTEXT_JUMP_TO_CURSOR_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setVariableSupported = CONTEXT_SET_VARIABLE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setDataBreakpointAtByteSupported = CONTEXT_SET_DATA_BREAKPOINT_BYTES_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.setExpressionSupported = CONTEXT_SET_EXPRESSION_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.multiSessionDebug = CONTEXT_MULTI_SESSION_DEBUG.bindTo(contextKeyService);\n\t\t\tthis.terminateDebuggeeSupported = CONTEXT_TERMINATE_DEBUGGEE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.suspendDebuggeeSupported = CONTEXT_SUSPEND_DEBUGGEE_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.terminateThreadsSupported = CONTEXT_TERMINATE_THREADS_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.disassembleRequestSupported = CONTEXT_DISASSEMBLE_REQUEST_SUPPORTED.bindTo(contextKeyService);\n\t\t\tthis.focusedStackFrameHasInstructionPointerReference = CONTEXT_FOCUSED_STACK_FRAME_HAS_INSTRUCTION_POINTER_REFERENCE.bindTo(contextKeyService);\n\t\t});\n\t}\n\n\tgetId(): string {\n\t\treturn 'root';\n\t}\n\n\tget focusedSession(): IDebugSession | undefined {\n\t\treturn this._focusedSession;\n\t}\n\n\tget focusedThread(): IThread | undefined {\n\t\treturn this._focusedThread;\n\t}\n\n\tget focusedStackFrame(): IStackFrame | undefined {\n\t\treturn this._focusedStackFrame;\n\t}\n\n\tsetFocus(stackFrame: IStackFrame | undefined, thread: IThread | undefined, session: IDebugSession | undefined, explicit: boolean): void {\n\t\tconst shouldEmitForStackFrame = this._focusedStackFrame !== stackFrame;\n\t\tconst shouldEmitForSession = this._focusedSession !== session;\n\t\tconst shouldEmitForThread = this._focusedThread !== thread;\n\n\n\t\tthis._focusedStackFrame = stackFrame;\n\t\tthis._focusedThread = thread;\n\t\tthis._focusedSession = session;\n\n\t\tthis.contextKeyService.bufferChangeEvents(() => {\n\t\t\tthis.loadedScriptsSupportedContextKey.set(!!session?.capabilities.supportsLoadedSourcesRequest);\n\t\t\tthis.stepBackSupportedContextKey.set(!!session?.capabilities.supportsStepBack);\n\t\t\tthis.restartFrameSupportedContextKey.set(!!session?.capabilities.supportsRestartFrame);\n\t\t\tthis.stepIntoTargetsSupported.set(!!session?.capabilities.supportsStepInTargetsRequest);\n\t\t\tthis.jumpToCursorSupported.set(!!session?.capabilities.supportsGotoTargetsRequest);\n\t\t\tthis.setVariableSupported.set(!!session?.capabilities.supportsSetVariable);\n\t\t\tthis.setDataBreakpointAtByteSupported.set(!!session?.capabilities.supportsDataBreakpointBytes);\n\t\t\tthis.setExpressionSupported.set(!!session?.capabilities.supportsSetExpression);\n\t\t\tthis.terminateDebuggeeSupported.set(!!session?.capabilities.supportTerminateDebuggee);\n\t\t\tthis.suspendDebuggeeSupported.set(!!session?.capabilities.supportSuspendDebuggee);\n\t\t\tthis.terminateThreadsSupported.set(!!session?.capabilities.supportsTerminateThreadsRequest);\n\t\t\tthis.disassembleRequestSupported.set(!!session?.capabilities.supportsDisassembleRequest);\n\t\t\tthis.focusedStackFrameHasInstructionPointerReference.set(!!stackFrame?.instructionPointerReference);\n\t\t\tconst attach = !!session && isSessionAttach(session);\n\t\t\tthis.focusedSessionIsAttach.set(attach);\n\t\t\tthis.focusedSessionIsNoDebug.set(!!session && !!session.configuration.noDebug);\n\t\t});\n\n\t\tif (shouldEmitForSession) {\n\t\t\tthis._onDidFocusSession.fire(session);\n\t\t}\n\n\t\t// should not call onDidFocusThread if onDidFocusStackFrame is called.\n\t\tif (shouldEmitForStackFrame) {\n\t\t\tthis._onDidFocusStackFrame.fire({ stackFrame, explicit, session });\n\t\t} else if (shouldEmitForThread) {\n\t\t\tthis._onDidFocusThread.fire({ thread, explicit, session });\n\t\t}\n\t}\n\n\tget onDidFocusSession(): Event<IDebugSession | undefined> {\n\t\treturn this._onDidFocusSession.event;\n\t}\n\n\tget onDidFocusThread(): Event<{ thread: IThread | undefined; explicit: boolean; session: IDebugSession | undefined }> {\n\t\treturn this._onDidFocusThread.event;\n\t}\n\n\tget onDidFocusStackFrame(): Event<{ stackFrame: IStackFrame | undefined; explicit: boolean; session: IDebugSession | undefined }> {\n\t\treturn this._onDidFocusStackFrame.event;\n\t}\n\n\tget onDidChangeVisualization() {\n\t\treturn this._onDidChangeVisualization.event;\n\t}\n\n\tgetSelectedExpression(): { expression: IExpression; settingWatch: boolean } | undefined {\n\t\treturn this.selectedExpression;\n\t}\n\n\tsetSelectedExpression(expression: IExpression | undefined, settingWatch: boolean) {\n\t\tthis.selectedExpression = expression ? { expression, settingWatch: settingWatch } : undefined;\n\t\tthis.expressionSelectedContextKey.set(!!expression);\n\t\tthis._onDidSelectExpression.fire(this.selectedExpression);\n\t}\n\n\tget onDidSelectExpression(): Event<{ expression: IExpression; settingWatch: boolean } | undefined> {\n\t\treturn this._onDidSelectExpression.event;\n\t}\n\n\tget onDidEvaluateLazyExpression(): Event<IExpressionContainer> {\n\t\treturn this._onDidEvaluateLazyExpression.event;\n\t}\n\n\tupdateViews(): void {\n\t\tthis._onWillUpdateViews.fire();\n\t}\n\n\tget onWillUpdateViews(): Event<void> {\n\t\treturn this._onWillUpdateViews.event;\n\t}\n\n\tisMultiSessionView(): boolean {\n\t\treturn !!this.multiSessionDebug.get();\n\t}\n\n\tsetMultiSessionView(isMultiSessionView: boolean): void {\n\t\tthis.multiSessionDebug.set(isMultiSessionView);\n\t}\n\n\tsetVisualizedExpression(original: IExpression, visualized: IExpression & { treeId: string } | undefined): void {\n\t\tconst current = this.visualized.get(original) || original;\n\t\tconst key = this.getPreferredVisualizedKey(original);\n\t\tif (visualized) {\n\t\t\tthis.visualized.set(original, visualized);\n\t\t\tthis.preferredVisualizers.set(key, visualized.treeId);\n\t\t} else {\n\t\t\tthis.visualized.delete(original);\n\t\t\tthis.preferredVisualizers.delete(key);\n\t\t}\n\t\tthis._onDidChangeVisualization.fire({ original: current, replacement: visualized || original });\n\t}\n\n\tgetVisualizedExpression(expression: IExpression): IExpression | string | undefined {\n\t\treturn this.visualized.get(expression) || this.preferredVisualizers.get(this.getPreferredVisualizedKey(expression));\n\t}\n\n\tasync evaluateLazyExpression(expression: IExpressionContainer): Promise<void> {\n\t\tawait expression.evaluateLazy();\n\t\tthis._onDidEvaluateLazyExpression.fire(expression);\n\t}\n\n\tprivate getPreferredVisualizedKey(expr: IExpression) {\n\t\treturn JSON.stringify([\n\t\t\texpr.name,\n\t\t\texpr.type,\n\t\t\t!!expr.memoryReference,\n\t\t].join('\\0'));\n\t}\n}\n"]}