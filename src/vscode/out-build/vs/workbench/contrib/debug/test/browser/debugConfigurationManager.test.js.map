{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/debug/test/browser/debugConfigurationManager.test.ts","vs/workbench/contrib/debug/test/browser/debugConfigurationManager.test.ts"],"names":[],"mappings":"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","file":"debugConfigurationManager.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ContextKeyService } from '../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { UriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { ConfigurationManager } from '../../browser/debugConfigurationManager.js';\nimport { DebugConfigurationProviderTriggerKind, IAdapterManager, IConfig, IDebugAdapterExecutable, IDebugSession } from '../../common/debug.js';\nimport { IPreferencesService } from '../../../../services/preferences/common/preferences.js';\nimport { TestQuickInputService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestHistoryService, TestContextService, TestExtensionService, TestStorageService } from '../../../../test/common/workbenchTestServices.js';\n\nsuite('debugConfigurationManager', () => {\n\tconst configurationProviderType = 'custom-type';\n\tlet _debugConfigurationManager: ConfigurationManager;\n\tlet disposables: DisposableStore;\n\n\tconst adapterManager = <IAdapterManager>{\n\t\tgetDebugAdapterDescriptor(session: IDebugSession, config: IConfig): Promise<IDebugAdapterExecutable | undefined> {\n\t\t\treturn Promise.resolve(undefined);\n\t\t},\n\n\t\tactivateDebuggers(activationEvent: string, debugType?: string): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t},\n\n\t\tget onDidDebuggersExtPointRead(): Event<void> {\n\t\t\treturn Event.None;\n\t\t}\n\t};\n\n\tconst preferencesService = <IPreferencesService>{\n\t\tuserSettingsResource: URI.file('/tmp/settings.json')\n\t};\n\n\tconst configurationService = new TestConfigurationService();\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tconst fileService = disposables.add(new FileService(new NullLogService()));\n\t\tconst instantiationService = disposables.add(new TestInstantiationService(new ServiceCollection([IPreferencesService, preferencesService], [IConfigurationService, configurationService])));\n\t\t_debugConfigurationManager = new ConfigurationManager(\n\t\t\tadapterManager,\n\t\t\tnew TestContextService(),\n\t\t\tconfigurationService,\n\t\t\tnew TestQuickInputService(),\n\t\t\tinstantiationService,\n\t\t\tnew TestStorageService(),\n\t\t\tnew TestExtensionService(),\n\t\t\tnew TestHistoryService(),\n\t\t\tnew UriIdentityService(fileService),\n\t\t\tdisposables.add(new ContextKeyService(configurationService)),\n\t\t\tnew NullLogService());\n\t});\n\n\tteardown(() => disposables.dispose());\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('resolves configuration based on type', async () => {\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: configurationProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, configurationProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\tconfigurationResolved: true\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\n\t\tconst initialConfig: IConfig = {\n\t\t\ttype: configurationProviderType,\n\t\t\trequest: 'launch',\n\t\t\tname: 'configName',\n\t\t};\n\n\t\tconst resultConfig = await _debugConfigurationManager.resolveConfigurationByProviders(undefined, configurationProviderType, initialConfig, CancellationToken.None);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tassert.strictEqual((resultConfig as any).configurationResolved, true, 'Configuration should be updated by test provider');\n\t});\n\n\ttest('resolves configuration from second provider if type changes', async () => {\n\t\tconst secondProviderType = 'second-provider';\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: configurationProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, configurationProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\ttype: secondProviderType\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: secondProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, secondProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\tconfigurationResolved: true\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\n\t\tconst initialConfig: IConfig = {\n\t\t\ttype: configurationProviderType,\n\t\t\trequest: 'launch',\n\t\t\tname: 'configName',\n\t\t};\n\n\t\tconst resultConfig = await _debugConfigurationManager.resolveConfigurationByProviders(undefined, configurationProviderType, initialConfig, CancellationToken.None);\n\t\tassert.strictEqual(resultConfig!.type, secondProviderType);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tassert.strictEqual((resultConfig as any).configurationResolved, true, 'Configuration should be updated by test provider');\n\t});\n\n\tteardown(() => disposables.clear());\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ContextKeyService } from '../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { UriIdentityService } from '../../../../../platform/uriIdentity/common/uriIdentityService.js';\nimport { ConfigurationManager } from '../../browser/debugConfigurationManager.js';\nimport { DebugConfigurationProviderTriggerKind, IAdapterManager, IConfig, IDebugAdapterExecutable, IDebugSession } from '../../common/debug.js';\nimport { IPreferencesService } from '../../../../services/preferences/common/preferences.js';\nimport { TestQuickInputService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestHistoryService, TestContextService, TestExtensionService, TestStorageService } from '../../../../test/common/workbenchTestServices.js';\n\nsuite('debugConfigurationManager', () => {\n\tconst configurationProviderType = 'custom-type';\n\tlet _debugConfigurationManager: ConfigurationManager;\n\tlet disposables: DisposableStore;\n\n\tconst adapterManager = <IAdapterManager>{\n\t\tgetDebugAdapterDescriptor(session: IDebugSession, config: IConfig): Promise<IDebugAdapterExecutable | undefined> {\n\t\t\treturn Promise.resolve(undefined);\n\t\t},\n\n\t\tactivateDebuggers(activationEvent: string, debugType?: string): Promise<void> {\n\t\t\treturn Promise.resolve();\n\t\t},\n\n\t\tget onDidDebuggersExtPointRead(): Event<void> {\n\t\t\treturn Event.None;\n\t\t}\n\t};\n\n\tconst preferencesService = <IPreferencesService>{\n\t\tuserSettingsResource: URI.file('/tmp/settings.json')\n\t};\n\n\tconst configurationService = new TestConfigurationService();\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tconst fileService = disposables.add(new FileService(new NullLogService()));\n\t\tconst instantiationService = disposables.add(new TestInstantiationService(new ServiceCollection([IPreferencesService, preferencesService], [IConfigurationService, configurationService])));\n\t\t_debugConfigurationManager = new ConfigurationManager(\n\t\t\tadapterManager,\n\t\t\tnew TestContextService(),\n\t\t\tconfigurationService,\n\t\t\tnew TestQuickInputService(),\n\t\t\tinstantiationService,\n\t\t\tnew TestStorageService(),\n\t\t\tnew TestExtensionService(),\n\t\t\tnew TestHistoryService(),\n\t\t\tnew UriIdentityService(fileService),\n\t\t\tdisposables.add(new ContextKeyService(configurationService)),\n\t\t\tnew NullLogService());\n\t});\n\n\tteardown(() => disposables.dispose());\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('resolves configuration based on type', async () => {\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: configurationProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, configurationProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\tconfigurationResolved: true\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\n\t\tconst initialConfig: IConfig = {\n\t\t\ttype: configurationProviderType,\n\t\t\trequest: 'launch',\n\t\t\tname: 'configName',\n\t\t};\n\n\t\tconst resultConfig = await _debugConfigurationManager.resolveConfigurationByProviders(undefined, configurationProviderType, initialConfig, CancellationToken.None);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tassert.strictEqual((resultConfig as any).configurationResolved, true, 'Configuration should be updated by test provider');\n\t});\n\n\ttest('resolves configuration from second provider if type changes', async () => {\n\t\tconst secondProviderType = 'second-provider';\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: configurationProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, configurationProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\ttype: secondProviderType\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\t\tdisposables.add(_debugConfigurationManager.registerDebugConfigurationProvider({\n\t\t\ttype: secondProviderType,\n\t\t\tresolveDebugConfiguration: (folderUri, config, token) => {\n\t\t\t\tassert.strictEqual(config.type, secondProviderType);\n\t\t\t\treturn Promise.resolve({\n\t\t\t\t\t...config,\n\t\t\t\t\tconfigurationResolved: true\n\t\t\t\t});\n\t\t\t},\n\t\t\ttriggerKind: DebugConfigurationProviderTriggerKind.Initial\n\t\t}));\n\n\t\tconst initialConfig: IConfig = {\n\t\t\ttype: configurationProviderType,\n\t\t\trequest: 'launch',\n\t\t\tname: 'configName',\n\t\t};\n\n\t\tconst resultConfig = await _debugConfigurationManager.resolveConfigurationByProviders(undefined, configurationProviderType, initialConfig, CancellationToken.None);\n\t\tassert.strictEqual(resultConfig!.type, secondProviderType);\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tassert.strictEqual((resultConfig as any).configurationResolved, true, 'Configuration should be updated by test provider');\n\t});\n\n\tteardown(() => disposables.clear());\n});\n"]}