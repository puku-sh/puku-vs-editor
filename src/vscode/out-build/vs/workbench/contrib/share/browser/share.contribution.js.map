{"version":3,"sources":["vs/workbench/contrib/share/browser/share.contribution.ts"],"names":[],"mappings":"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","file":"share.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './share.css';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Action2, MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorResourceAccessor, SideBySideEditor } from '../../../common/editor.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { Severity } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { WorkspaceFolderCountContext } from '../../../common/contextkeys.js';\nimport { Extensions, IWorkbenchContributionsRegistry } from '../../../common/contributions.js';\nimport { ShareProviderCountContext, ShareService } from './shareService.js';\nimport { IShareService } from '../common/share.js';\nimport { LifecyclePhase } from '../../../services/lifecycle/common/lifecycle.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IProgressService, ProgressLocation } from '../../../../platform/progress/common/progress.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { IConfigurationRegistry, Extensions as ConfigurationExtensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { workbenchConfigurationNodeBase } from '../../../common/configuration.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\n\nconst targetMenus = [\n\tMenuId.EditorContextShare,\n\tMenuId.SCMResourceContextShare,\n\tMenuId.OpenEditorsContextShare,\n\tMenuId.EditorTitleContextShare,\n\tMenuId.MenubarShare,\n\t// MenuId.EditorLineNumberContext, // todo@joyceerhl add share\n\tMenuId.ExplorerContextShare\n];\n\nclass ShareWorkbenchContribution extends Disposable {\n\tprivate static SHARE_ENABLED_SETTING = 'workbench.experimental.share.enabled';\n\n\tprivate _disposables: DisposableStore | undefined;\n\n\tconstructor(\n\t\t@IShareService private readonly shareService: IShareService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\n\t\tif (this.configurationService.getValue<boolean>(ShareWorkbenchContribution.SHARE_ENABLED_SETTING)) {\n\t\t\tthis.registerActions();\n\t\t}\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(ShareWorkbenchContribution.SHARE_ENABLED_SETTING)) {\n\t\t\t\tconst settingValue = this.configurationService.getValue<boolean>(ShareWorkbenchContribution.SHARE_ENABLED_SETTING);\n\t\t\t\tif (settingValue === true && this._disposables === undefined) {\n\t\t\t\t\tthis.registerActions();\n\t\t\t\t} else if (settingValue === false && this._disposables !== undefined) {\n\t\t\t\t\tthis._disposables?.clear();\n\t\t\t\t\tthis._disposables = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._disposables?.dispose();\n\t}\n\n\tprivate registerActions() {\n\t\tif (!this._disposables) {\n\t\t\tthis._disposables = new DisposableStore();\n\t\t}\n\n\t\tthis._disposables.add(\n\t\t\tregisterAction2(class ShareAction extends Action2 {\n\t\t\t\tstatic readonly ID = 'workbench.action.share';\n\t\t\t\tstatic readonly LABEL = localize2('share', 'Share...');\n\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper({\n\t\t\t\t\t\tid: ShareAction.ID,\n\t\t\t\t\t\ttitle: ShareAction.LABEL,\n\t\t\t\t\t\tf1: true,\n\t\t\t\t\t\ticon: Codicon.linkExternal,\n\t\t\t\t\t\tprecondition: ContextKeyExpr.and(ShareProviderCountContext.notEqualsTo(0), WorkspaceFolderCountContext.notEqualsTo(0)),\n\t\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\t\tprimary: KeyMod.Alt | KeyMod.CtrlCmd | KeyCode.KeyS,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmenu: [\n\t\t\t\t\t\t\t{ id: MenuId.CommandCenter, order: 1000 }\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\toverride async run(accessor: ServicesAccessor, ...args: unknown[]): Promise<void> {\n\t\t\t\t\tconst shareService = accessor.get(IShareService);\n\t\t\t\t\tconst activeEditor = accessor.get(IEditorService)?.activeEditor;\n\t\t\t\t\tconst resourceUri = (activeEditor && EditorResourceAccessor.getOriginalUri(activeEditor, { supportSideBySide: SideBySideEditor.PRIMARY }))\n\t\t\t\t\t\t?? accessor.get(IWorkspaceContextService).getWorkspace().folders[0].uri;\n\t\t\t\t\tconst clipboardService = accessor.get(IClipboardService);\n\t\t\t\t\tconst dialogService = accessor.get(IDialogService);\n\t\t\t\t\tconst urlService = accessor.get(IOpenerService);\n\t\t\t\t\tconst progressService = accessor.get(IProgressService);\n\t\t\t\t\tconst selection = accessor.get(ICodeEditorService).getActiveCodeEditor()?.getSelection() ?? undefined;\n\n\t\t\t\t\tconst result = await progressService.withProgress({\n\t\t\t\t\t\tlocation: ProgressLocation.Window,\n\t\t\t\t\t\tdetail: localize('generating link', 'Generating link...')\n\t\t\t\t\t}, async () => shareService.provideShare({ resourceUri, selection }, CancellationToken.None));\n\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tconst uriText = result.toString();\n\t\t\t\t\t\tconst isResultText = typeof result === 'string';\n\t\t\t\t\t\tawait clipboardService.writeText(uriText);\n\n\t\t\t\t\t\tdialogService.prompt(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: Severity.Info,\n\t\t\t\t\t\t\t\tmessage: isResultText ? localize('shareTextSuccess', 'Copied text to clipboard!') : localize('shareSuccess', 'Copied link to clipboard!'),\n\t\t\t\t\t\t\t\tcustom: {\n\t\t\t\t\t\t\t\t\ticon: Codicon.check,\n\t\t\t\t\t\t\t\t\tmarkdownDetails: [{\n\t\t\t\t\t\t\t\t\t\tmarkdown: new MarkdownString(`<div aria-label='${uriText}'>${uriText}</div>`, { supportHtml: true }),\n\t\t\t\t\t\t\t\t\t\tclasses: [isResultText ? 'share-dialog-input-text' : 'share-dialog-input-link']\n\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcancelButton: localize('close', 'Close'),\n\t\t\t\t\t\t\t\tbuttons: isResultText ? [] : [{ label: localize('open link', 'Open Link'), run: () => { urlService.open(result, { openExternal: true }); } }]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\n\t\tconst actions = this.shareService.getShareActions();\n\t\tfor (const menuId of targetMenus) {\n\t\t\tfor (const action of actions) {\n\t\t\t\t// todo@joyceerhl avoid duplicates\n\t\t\t\tthis._disposables.add(MenuRegistry.appendMenuItem(menuId, action));\n\t\t\t}\n\t\t}\n\t}\n}\n\nregisterSingleton(IShareService, ShareService, InstantiationType.Delayed);\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(Extensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(ShareWorkbenchContribution, LifecyclePhase.Eventually);\n\nRegistry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration).registerConfiguration({\n\t...workbenchConfigurationNodeBase,\n\tproperties: {\n\t\t'workbench.experimental.share.enabled': {\n\t\t\ttype: 'boolean',\n\t\t\tdefault: false,\n\t\t\ttags: ['experimental'],\n\t\t\tmarkdownDescription: localize('experimental.share.enabled', \"Controls whether to render the Share action next to the command center when {0} is {1}.\", '`#window.commandCenter#`', '`true`'),\n\t\t\trestricted: false,\n\t\t}\n\t}\n});\n"]}