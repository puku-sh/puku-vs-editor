{"version":3,"sources":["vs/workbench/contrib/editSessions/common/editSessions.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,YAAY,EAAE,QAAQ,EAAE,MAAM,mCAAmC,CAAC;AAC3E,OAAO,EAAE,OAAO,EAAE,MAAM,qCAAqC,CAAC;AAC9D,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAC;AAEzD,OAAO,EAAE,aAAa,EAAE,MAAM,sDAAsD,CAAC;AACrF,OAAO,EAAE,eAAe,EAAE,MAAM,4DAA4D,CAAC;AAE7F,OAAO,EAAE,YAAY,EAAE,MAAM,mDAAmD,CAAC;AAGjF,OAAO,EAAE,UAAU,EAAE,MAAM,iCAAiC,CAAC;AAG7D,MAAM,CAAC,MAAM,0BAA0B,GAAG,SAAS,CAAC,IAAe,EAAE,eAAe,CAAC,CAAC;AAItF,MAAM,CAAC,MAAM,2BAA2B,GAAG,eAAe,CAA8B,6BAA6B,CAAC,CAAC;AAuBvH,MAAM,CAAC,MAAM,uBAAuB,GAAG,eAAe,CAA0B,yBAAyB,CAAC,CAAC;AAG3G,MAAM,CAAN,IAAY,UAGX;AAHD,WAAY,UAAU;IACrB,mDAAY,CAAA;IACZ,mDAAY,CAAA;AACb,CAAC,EAHW,UAAU,KAAV,UAAU,QAGrB;AAED,MAAM,CAAN,IAAY,QAEX;AAFD,WAAY,QAAQ;IACnB,uCAAQ,CAAA;AACT,CAAC,EAFW,QAAQ,KAAR,QAAQ,QAEnB;AAyBD,MAAM,CAAC,MAAM,wBAAwB,GAAG,CAAC,CAAC;AAS1C,MAAM,CAAC,MAAM,2BAA2B,GAAG,sBAAsB,CAAC;AAClE,MAAM,CAAC,MAAM,uBAAuB,GAAG,IAAI,aAAa,CAAU,2BAA2B,EAAE,KAAK,CAAC,CAAC;AAEtG,MAAM,CAAC,MAAM,yBAAyB,GAAG,qBAAqB,CAAC;AAC/D,MAAM,CAAC,MAAM,qBAAqB,GAAG,IAAI,aAAa,CAAU,yBAAyB,EAAE,KAAK,CAAC,CAAC;AAElG,MAAM,CAAC,MAAM,0BAA0B,GAAG,6BAA6B,CAAC;AACxE,MAAM,CAAC,MAAM,0BAA0B,GAAG,mCAAmC,CAAC;AAC9E,MAAM,CAAC,MAAM,mBAAmB,GAAqB,SAAS,CAAC,IAAe,EAAE,eAAe,CAAC,CAAC;AAEjG,MAAM,CAAC,MAAM,uBAAuB,GAAG,YAAY,CAAC,yBAAyB,EAAE,OAAO,CAAC,aAAa,EAAE,QAAQ,CAAC,IAAqB,EAAE,IAAsC,CAAC,CAAC,CAAC;AAE/K,MAAM,CAAC,MAAM,uBAAuB,GAAG,IAAI,aAAa,CAAU,sBAAsB,EAAE,KAAK,CAAC,CAAC;AAEjG,MAAM,CAAC,MAAM,oBAAoB,GAAG,sBAAsB,CAAC;AAE3D,MAAM,UAAU,4BAA4B,CAAC,OAAe,EAAE,OAAe;IAC5E,QAAQ,OAAO,EAAE,CAAC;QACjB,KAAK,CAAC;YACL,OAAO,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QACrC,KAAK,CAAC;YACL,OAAO,YAAY,CAAC,OAAO,CAAC,CAAC;QAC9B;YACC,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;IACxE,CAAC;AACF,CAAC;AAED,MAAM,UAAU,mBAAmB,CAAC,aAAqB;IACxD,MAAM,IAAI,GAAG,IAAI,UAAU,EAAE,CAAC;IAC9B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IAC3B,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC;AACtB,CAAC;AAED,MAAM,CAAC,MAAM,iBAAiB,GAAG,cAAc,CAAC","file":"editSessions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64, VSBuffer } from '../../../../base/common/buffer.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { ILocalizedString } from '../../../../platform/action/common/action.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IResourceRefHandle } from '../../../../platform/userDataSync/common/userDataSync.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { StringSHA1 } from '../../../../base/common/hash.js';\nimport { EditSessionsStoreClient } from './editSessionsStorageClient.js';\n\nexport const EDIT_SESSION_SYNC_CATEGORY = localize2('cloud changes', 'Cloud Changes');\n\nexport type SyncResource = 'editSessions' | 'workspaceState';\n\nexport const IEditSessionsStorageService = createDecorator<IEditSessionsStorageService>('IEditSessionsStorageService');\nexport interface IEditSessionsStorageService {\n\t_serviceBrand: undefined;\n\n\treadonly SIZE_LIMIT: number;\n\n\treadonly isSignedIn: boolean;\n\treadonly onDidSignIn: Event<void>;\n\treadonly onDidSignOut: Event<void>;\n\n\tstoreClient: EditSessionsStoreClient | undefined;\n\n\tlastReadResources: Map<SyncResource, { ref: string; content: string }>;\n\tlastWrittenResources: Map<SyncResource, { ref: string; content: string }>;\n\n\tinitialize(reason: 'read' | 'write', silent?: boolean): Promise<boolean>;\n\tread(resource: SyncResource, ref: string | undefined): Promise<{ ref: string; content: string } | undefined>;\n\twrite(resource: SyncResource, content: string | EditSession): Promise<string>;\n\tdelete(resource: SyncResource, ref: string | null): Promise<void>;\n\tlist(resource: SyncResource): Promise<IResourceRefHandle[]>;\n\tgetMachineById(machineId: string): Promise<string | undefined>;\n}\n\nexport const IEditSessionsLogService = createDecorator<IEditSessionsLogService>('IEditSessionsLogService');\nexport interface IEditSessionsLogService extends ILogService { }\n\nexport enum ChangeType {\n\tAddition = 1,\n\tDeletion = 2,\n}\n\nexport enum FileType {\n\tFile = 1,\n}\n\ninterface Addition {\n\trelativeFilePath: string;\n\tfileType: FileType.File;\n\tcontents: string;\n\ttype: ChangeType.Addition;\n}\n\ninterface Deletion {\n\trelativeFilePath: string;\n\tfileType: FileType.File;\n\tcontents: undefined;\n\ttype: ChangeType.Deletion;\n}\n\nexport type Change = Addition | Deletion;\n\nexport interface Folder {\n\tname: string;\n\tcanonicalIdentity: string | undefined;\n\tworkingChanges: Change[];\n\tabsoluteUri: string | undefined;\n}\n\nexport const EditSessionSchemaVersion = 3;\n\nexport interface EditSession {\n\tversion: number;\n\tworkspaceStateId?: string;\n\tmachine?: string;\n\tfolders: Folder[];\n}\n\nexport const EDIT_SESSIONS_SIGNED_IN_KEY = 'editSessionsSignedIn';\nexport const EDIT_SESSIONS_SIGNED_IN = new RawContextKey<boolean>(EDIT_SESSIONS_SIGNED_IN_KEY, false);\n\nexport const EDIT_SESSIONS_PENDING_KEY = 'editSessionsPending';\nexport const EDIT_SESSIONS_PENDING = new RawContextKey<boolean>(EDIT_SESSIONS_PENDING_KEY, false);\n\nexport const EDIT_SESSIONS_CONTAINER_ID = 'workbench.view.editSessions';\nexport const EDIT_SESSIONS_DATA_VIEW_ID = 'workbench.views.editSessions.data';\nexport const EDIT_SESSIONS_TITLE: ILocalizedString = localize2('cloud changes', 'Cloud Changes');\n\nexport const EDIT_SESSIONS_VIEW_ICON = registerIcon('edit-sessions-view-icon', Codicon.cloudDownload, localize('editSessionViewIcon', 'View icon of the cloud changes view.'));\n\nexport const EDIT_SESSIONS_SHOW_VIEW = new RawContextKey<boolean>('editSessionsShowView', false);\n\nexport const EDIT_SESSIONS_SCHEME = 'vscode-edit-sessions';\n\nexport function decodeEditSessionFileContent(version: number, content: string): VSBuffer {\n\tswitch (version) {\n\t\tcase 1:\n\t\t\treturn VSBuffer.fromString(content);\n\t\tcase 2:\n\t\t\treturn decodeBase64(content);\n\t\tdefault:\n\t\t\tthrow new Error('Upgrade to a newer version to decode this content.');\n\t}\n}\n\nexport function hashedEditSessionId(editSessionId: string) {\n\tconst sha1 = new StringSHA1();\n\tsha1.update(editSessionId);\n\treturn sha1.digest();\n}\n\nexport const editSessionsLogId = 'editSessions';\n"]}