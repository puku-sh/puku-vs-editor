{"version":3,"sources":["vs/workbench/contrib/callHierarchy/browser/callHierarchy.contribution.ts"],"names":[],"mappings":"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","file":"callHierarchy.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize, localize2 } from '../../../../nls.js';\nimport { CallHierarchyProviderRegistry, CallHierarchyDirection, CallHierarchyModel } from '../common/callHierarchy.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { CallHierarchyTreePeekWidget } from './callHierarchyPeek.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { registerEditorContribution, EditorAction2, EditorContributionInstantiation } from '../../../../editor/browser/editorExtensions.js';\nimport { IEditorContribution } from '../../../../editor/common/editorCommon.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { IContextKeyService, RawContextKey, IContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { EditorContextKeys } from '../../../../editor/common/editorContextKeys.js';\nimport { PeekContext } from '../../../../editor/contrib/peekView/browser/peekView.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { IPosition } from '../../../../editor/common/core/position.js';\nimport { MenuId, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\n\nconst _ctxHasCallHierarchyProvider = new RawContextKey<boolean>('editorHasCallHierarchyProvider', false, localize('editorHasCallHierarchyProvider', 'Whether a call hierarchy provider is available'));\nconst _ctxCallHierarchyVisible = new RawContextKey<boolean>('callHierarchyVisible', false, localize('callHierarchyVisible', 'Whether call hierarchy peek is currently showing'));\nconst _ctxCallHierarchyDirection = new RawContextKey<string>('callHierarchyDirection', undefined, { type: 'string', description: localize('callHierarchyDirection', 'Whether call hierarchy shows incoming or outgoing calls') });\n\nfunction sanitizedDirection(candidate: string): CallHierarchyDirection {\n\treturn candidate === CallHierarchyDirection.CallsFrom || candidate === CallHierarchyDirection.CallsTo\n\t\t? candidate\n\t\t: CallHierarchyDirection.CallsTo;\n}\n\nclass CallHierarchyController implements IEditorContribution {\n\n\tstatic readonly Id = 'callHierarchy';\n\n\tstatic get(editor: ICodeEditor): CallHierarchyController | null {\n\t\treturn editor.getContribution<CallHierarchyController>(CallHierarchyController.Id);\n\t}\n\n\tprivate static readonly _StorageDirection = 'callHierarchy/defaultDirection';\n\n\tprivate readonly _ctxHasProvider: IContextKey<boolean>;\n\tprivate readonly _ctxIsVisible: IContextKey<boolean>;\n\tprivate readonly _ctxDirection: IContextKey<string>;\n\tprivate readonly _dispoables = new DisposableStore();\n\tprivate readonly _sessionDisposables = new DisposableStore();\n\n\tprivate _widget?: CallHierarchyTreePeekWidget;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@ICodeEditorService private readonly _editorService: ICodeEditorService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t) {\n\t\tthis._ctxIsVisible = _ctxCallHierarchyVisible.bindTo(this._contextKeyService);\n\t\tthis._ctxHasProvider = _ctxHasCallHierarchyProvider.bindTo(this._contextKeyService);\n\t\tthis._ctxDirection = _ctxCallHierarchyDirection.bindTo(this._contextKeyService);\n\t\tthis._dispoables.add(Event.any<unknown>(_editor.onDidChangeModel, _editor.onDidChangeModelLanguage, CallHierarchyProviderRegistry.onDidChange)(() => {\n\t\t\tthis._ctxHasProvider.set(_editor.hasModel() && CallHierarchyProviderRegistry.has(_editor.getModel()));\n\t\t}));\n\t\tthis._dispoables.add(this._sessionDisposables);\n\t}\n\n\tdispose(): void {\n\t\tthis._ctxHasProvider.reset();\n\t\tthis._ctxIsVisible.reset();\n\t\tthis._dispoables.dispose();\n\t}\n\n\tasync startCallHierarchyFromEditor(): Promise<void> {\n\t\tthis._sessionDisposables.clear();\n\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst document = this._editor.getModel();\n\t\tconst position = this._editor.getPosition();\n\t\tif (!CallHierarchyProviderRegistry.has(document)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tconst model = CallHierarchyModel.create(document, position, cts.token);\n\t\tconst direction = sanitizedDirection(this._storageService.get(CallHierarchyController._StorageDirection, StorageScope.PROFILE, CallHierarchyDirection.CallsTo));\n\n\t\tthis._showCallHierarchyWidget(position, direction, model, cts);\n\t}\n\n\tasync startCallHierarchyFromCallHierarchy(): Promise<void> {\n\t\tif (!this._widget) {\n\t\t\treturn;\n\t\t}\n\t\tconst model = this._widget.getModel();\n\t\tconst call = this._widget.getFocused();\n\t\tif (!call || !model) {\n\t\t\treturn;\n\t\t}\n\t\tconst newEditor = await this._editorService.openCodeEditor({ resource: call.item.uri }, this._editor);\n\t\tif (!newEditor) {\n\t\t\treturn;\n\t\t}\n\t\tconst newModel = model.fork(call.item);\n\t\tthis._sessionDisposables.clear();\n\n\t\tCallHierarchyController.get(newEditor)?._showCallHierarchyWidget(\n\t\t\tRange.lift(newModel.root.selectionRange).getStartPosition(),\n\t\t\tthis._widget.direction,\n\t\t\tPromise.resolve(newModel),\n\t\t\tnew CancellationTokenSource()\n\t\t);\n\t}\n\n\tprivate _showCallHierarchyWidget(position: IPosition, direction: CallHierarchyDirection, model: Promise<CallHierarchyModel | undefined>, cts: CancellationTokenSource) {\n\n\t\tthis._ctxIsVisible.set(true);\n\t\tthis._ctxDirection.set(direction);\n\t\tEvent.any<unknown>(this._editor.onDidChangeModel, this._editor.onDidChangeModelLanguage)(this.endCallHierarchy, this, this._sessionDisposables);\n\t\tthis._widget = this._instantiationService.createInstance(CallHierarchyTreePeekWidget, this._editor, position, direction);\n\t\tthis._widget.showLoading();\n\t\tthis._sessionDisposables.add(this._widget.onDidClose(() => {\n\t\t\tthis.endCallHierarchy();\n\t\t\tthis._storageService.store(CallHierarchyController._StorageDirection, this._widget!.direction, StorageScope.PROFILE, StorageTarget.USER);\n\t\t}));\n\t\tthis._sessionDisposables.add({ dispose() { cts.dispose(true); } });\n\t\tthis._sessionDisposables.add(this._widget);\n\n\t\tmodel.then(model => {\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\treturn; // nothing\n\t\t\t}\n\t\t\tif (model) {\n\t\t\t\tthis._sessionDisposables.add(model);\n\t\t\t\tthis._widget!.showModel(model);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._widget!.showMessage(localize('no.item', \"No results\"));\n\t\t\t}\n\t\t}).catch(err => {\n\t\t\tif (isCancellationError(err)) {\n\t\t\t\tthis.endCallHierarchy();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._widget!.showMessage(localize('error', \"Failed to show call hierarchy\"));\n\t\t});\n\t}\n\n\tshowOutgoingCalls(): void {\n\t\tthis._widget?.updateDirection(CallHierarchyDirection.CallsFrom);\n\t\tthis._ctxDirection.set(CallHierarchyDirection.CallsFrom);\n\t}\n\n\tshowIncomingCalls(): void {\n\t\tthis._widget?.updateDirection(CallHierarchyDirection.CallsTo);\n\t\tthis._ctxDirection.set(CallHierarchyDirection.CallsTo);\n\t}\n\n\tendCallHierarchy(): void {\n\t\tthis._sessionDisposables.clear();\n\t\tthis._ctxIsVisible.set(false);\n\t\tthis._editor.focus();\n\t}\n}\n\nregisterEditorContribution(CallHierarchyController.Id, CallHierarchyController, EditorContributionInstantiation.Eager); // eager because it needs to define a context key\n\nregisterAction2(class PeekCallHierarchyAction extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showCallHierarchy',\n\t\t\ttitle: localize2('title', 'Peek Call Hierarchy'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorContextPeek,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1000,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t_ctxHasCallHierarchyProvider,\n\t\t\t\t\tPeekContext.notInPeekEditor,\n\t\t\t\t\tEditorContextKeys.isInEmbeddedEditor.toNegated(),\n\t\t\t\t),\n\t\t\t},\n\t\t\tkeybinding: {\n\t\t\t\twhen: EditorContextKeys.editorTextFocus,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyMod.Alt + KeyCode.KeyH\n\t\t\t},\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\t_ctxHasCallHierarchyProvider,\n\t\t\t\tPeekContext.notInPeekEditor\n\t\t\t),\n\t\t\tf1: true\n\t\t});\n\t}\n\n\tasync runEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\treturn CallHierarchyController.get(editor)?.startCallHierarchyFromEditor();\n\t}\n});\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showIncomingCalls',\n\t\t\ttitle: localize2('title.incoming', 'Show Incoming Calls'),\n\t\t\ticon: registerIcon('callhierarchy-incoming', Codicon.callIncoming, localize('showIncomingCallsIcons', 'Icon for incoming calls in the call hierarchy view.')),\n\t\t\tprecondition: ContextKeyExpr.and(_ctxCallHierarchyVisible, _ctxCallHierarchyDirection.isEqualTo(CallHierarchyDirection.CallsFrom)),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyMod.Alt + KeyCode.KeyH,\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: CallHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\twhen: _ctxCallHierarchyDirection.isEqualTo(CallHierarchyDirection.CallsFrom),\n\t\t\t\torder: 1,\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\treturn CallHierarchyController.get(editor)?.showIncomingCalls();\n\t}\n});\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.showOutgoingCalls',\n\t\t\ttitle: localize2('title.outgoing', 'Show Outgoing Calls'),\n\t\t\ticon: registerIcon('callhierarchy-outgoing', Codicon.callOutgoing, localize('showOutgoingCallsIcon', 'Icon for outgoing calls in the call hierarchy view.')),\n\t\t\tprecondition: ContextKeyExpr.and(_ctxCallHierarchyVisible, _ctxCallHierarchyDirection.isEqualTo(CallHierarchyDirection.CallsTo)),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyMod.Alt + KeyCode.KeyH,\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: CallHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\twhen: _ctxCallHierarchyDirection.isEqualTo(CallHierarchyDirection.CallsTo),\n\t\t\t\torder: 1\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\treturn CallHierarchyController.get(editor)?.showOutgoingCalls();\n\t}\n});\n\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.refocusCallHierarchy',\n\t\t\ttitle: localize2('title.refocus', 'Refocus Call Hierarchy'),\n\t\t\tprecondition: _ctxCallHierarchyVisible,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.Shift + KeyCode.Enter\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\treturn CallHierarchyController.get(editor)?.startCallHierarchyFromCallHierarchy();\n\t}\n});\n\n\nregisterAction2(class extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.closeCallHierarchy',\n\t\t\ttitle: localize('close', 'Close'),\n\t\t\ticon: Codicon.close,\n\t\t\tprecondition: _ctxCallHierarchyVisible,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib + 10,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\twhen: ContextKeyExpr.not('config.editor.stablePeek')\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: CallHierarchyTreePeekWidget.TitleMenu,\n\t\t\t\torder: 1000\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\treturn CallHierarchyController.get(editor)?.endCallHierarchy();\n\t}\n});\n"]}