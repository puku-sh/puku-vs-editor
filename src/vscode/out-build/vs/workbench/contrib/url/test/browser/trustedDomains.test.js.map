{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/url/test/browser/trustedDomains.test.ts","vs/workbench/contrib/url/test/browser/trustedDomains.test.ts"],"names":[],"mappings":"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","file":"trustedDomains.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\n\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { isURLDomainTrusted } from '../../common/trustedDomains.js';\n\nfunction linkAllowedByRules(link: string, rules: string[]) {\n\tassert.ok(isURLDomainTrusted(URI.parse(link), rules), `Link\\n${link}\\n should be allowed by rules\\n${JSON.stringify(rules)}`);\n}\nfunction linkNotAllowedByRules(link: string, rules: string[]) {\n\tassert.ok(!isURLDomainTrusted(URI.parse(link), rules), `Link\\n${link}\\n should NOT be allowed by rules\\n${JSON.stringify(rules)}`);\n}\n\nsuite('Link protection domain matching', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\ttest('simple', () => {\n\t\tlinkNotAllowedByRules('https://x.org', []);\n\n\t\tlinkAllowedByRules('https://x.org', ['https://x.org']);\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org']);\n\n\t\tlinkNotAllowedByRules('https://x.org', ['http://x.org']);\n\t\tlinkNotAllowedByRules('http://x.org', ['https://x.org']);\n\n\t\tlinkNotAllowedByRules('https://www.x.org', ['https://x.org']);\n\n\t\tlinkAllowedByRules('https://www.x.org', ['https://www.x.org', 'https://y.org']);\n\t});\n\n\ttest('localhost', () => {\n\t\tlinkAllowedByRules('https://127.0.0.1', []);\n\t\tlinkAllowedByRules('https://127.0.0.1:3000', []);\n\t\tlinkAllowedByRules('https://localhost', []);\n\t\tlinkAllowedByRules('https://localhost:3000', []);\n\t\tlinkAllowedByRules('https://dev.localhost', []);\n\t\tlinkAllowedByRules('https://dev.localhost:3000', []);\n\t\tlinkAllowedByRules('https://app.localhost', []);\n\t\tlinkAllowedByRules('https://api.localhost:8080', []);\n\t\tlinkAllowedByRules('https://myapp.dev.localhost:8080', []);\n\t});\n\n\ttest('* star', () => {\n\t\tlinkAllowedByRules('https://a.x.org', ['https://*.x.org']);\n\t\tlinkAllowedByRules('https://a.b.x.org', ['https://*.x.org']);\n\t});\n\n\ttest('no scheme', () => {\n\t\tlinkAllowedByRules('https://a.x.org', ['a.x.org']);\n\t\tlinkAllowedByRules('https://a.x.org', ['*.x.org']);\n\t\tlinkAllowedByRules('https://a.b.x.org', ['*.x.org']);\n\t\tlinkAllowedByRules('https://x.org', ['*.x.org']);\n\t\t// https://github.com/microsoft/vscode/issues/249353\n\t\tlinkAllowedByRules('https://x.org:3000', ['*.x.org:3000']);\n\t});\n\n\ttest('sub paths', () => {\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo']);\n\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org/foo/']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo/']);\n\n\t\tlinkAllowedByRules('https://x.org/foo', ['x.org/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo', ['*.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['https://x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['*.org/foo']);\n\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/foo2', ['https://x.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://www.x.org/foo', ['https://x.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://a.x.org/bar', ['https://*.x.org/foo']);\n\t\tlinkNotAllowedByRules('https://a.b.x.org/bar', ['https://*.x.org/foo']);\n\n\t\tlinkAllowedByRules('https://github.com', ['https://github.com/foo/bar', 'https://github.com']);\n\t});\n\n\ttest('ports', () => {\n\t\tlinkNotAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:8081/foo']);\n\t\tlinkAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:*/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org:*/foo']);\n\t\tlinkAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:8080/foo']);\n\t});\n\n\ttest('ip addresses', () => {\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.7/']);\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.7']);\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.*']);\n\n\t\tlinkNotAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.*.6:*']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.7:3000/']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.7:*']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.*:*']);\n\t\tlinkNotAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.*.6:*']);\n\t});\n\n\ttest('scheme match', () => {\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://*']);\n\t\tlinkAllowedByRules('http://twitter.com', ['http://*']);\n\t\tlinkAllowedByRules('http://twitter.com/hello', ['http://*']);\n\t\tlinkNotAllowedByRules('https://192.168.1.7/', ['http://*']);\n\t\tlinkNotAllowedByRules('https://twitter.com/', ['http://*']);\n\t});\n\n\ttest('case normalization', () => {\n\t\t// https://github.com/microsoft/vscode/issues/99294\n\t\tlinkAllowedByRules('https://github.com/microsoft/vscode/issues/new', ['https://github.com/microsoft']);\n\t\tlinkAllowedByRules('https://github.com/microsoft/vscode/issues/new', ['https://github.com/microsoft']);\n\t});\n\n\ttest('ignore query & fragment - https://github.com/microsoft/vscode/issues/156839', () => {\n\t\tlinkAllowedByRules('https://github.com/login/oauth/authorize?foo=4', ['https://github.com/login/oauth/authorize']);\n\t\tlinkAllowedByRules('https://github.com/login/oauth/authorize#foo', ['https://github.com/login/oauth/authorize']);\n\t});\n\n\ttest('ensure individual parts of url are compared and wildcard does not leak out', () => {\n\t\tlinkNotAllowedByRules('https://x.org/github.com', ['https://*.github.com']);\n\t\tlinkNotAllowedByRules('https://x.org/y.github.com', ['https://*.github.com']);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\n\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { isURLDomainTrusted } from '../../common/trustedDomains.js';\n\nfunction linkAllowedByRules(link: string, rules: string[]) {\n\tassert.ok(isURLDomainTrusted(URI.parse(link), rules), `Link\\n${link}\\n should be allowed by rules\\n${JSON.stringify(rules)}`);\n}\nfunction linkNotAllowedByRules(link: string, rules: string[]) {\n\tassert.ok(!isURLDomainTrusted(URI.parse(link), rules), `Link\\n${link}\\n should NOT be allowed by rules\\n${JSON.stringify(rules)}`);\n}\n\nsuite('Link protection domain matching', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\ttest('simple', () => {\n\t\tlinkNotAllowedByRules('https://x.org', []);\n\n\t\tlinkAllowedByRules('https://x.org', ['https://x.org']);\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org']);\n\n\t\tlinkNotAllowedByRules('https://x.org', ['http://x.org']);\n\t\tlinkNotAllowedByRules('http://x.org', ['https://x.org']);\n\n\t\tlinkNotAllowedByRules('https://www.x.org', ['https://x.org']);\n\n\t\tlinkAllowedByRules('https://www.x.org', ['https://www.x.org', 'https://y.org']);\n\t});\n\n\ttest('localhost', () => {\n\t\tlinkAllowedByRules('https://127.0.0.1', []);\n\t\tlinkAllowedByRules('https://127.0.0.1:3000', []);\n\t\tlinkAllowedByRules('https://localhost', []);\n\t\tlinkAllowedByRules('https://localhost:3000', []);\n\t\tlinkAllowedByRules('https://dev.localhost', []);\n\t\tlinkAllowedByRules('https://dev.localhost:3000', []);\n\t\tlinkAllowedByRules('https://app.localhost', []);\n\t\tlinkAllowedByRules('https://api.localhost:8080', []);\n\t\tlinkAllowedByRules('https://myapp.dev.localhost:8080', []);\n\t});\n\n\ttest('* star', () => {\n\t\tlinkAllowedByRules('https://a.x.org', ['https://*.x.org']);\n\t\tlinkAllowedByRules('https://a.b.x.org', ['https://*.x.org']);\n\t});\n\n\ttest('no scheme', () => {\n\t\tlinkAllowedByRules('https://a.x.org', ['a.x.org']);\n\t\tlinkAllowedByRules('https://a.x.org', ['*.x.org']);\n\t\tlinkAllowedByRules('https://a.b.x.org', ['*.x.org']);\n\t\tlinkAllowedByRules('https://x.org', ['*.x.org']);\n\t\t// https://github.com/microsoft/vscode/issues/249353\n\t\tlinkAllowedByRules('https://x.org:3000', ['*.x.org:3000']);\n\t});\n\n\ttest('sub paths', () => {\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo']);\n\n\t\tlinkAllowedByRules('https://x.org/foo', ['https://x.org/foo/']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo/']);\n\n\t\tlinkAllowedByRules('https://x.org/foo', ['x.org/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo', ['*.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['https://x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/bar', ['*.org/foo']);\n\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org/foo']);\n\t\tlinkNotAllowedByRules('https://x.org/foo2', ['https://x.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://www.x.org/foo', ['https://x.org/foo']);\n\n\t\tlinkNotAllowedByRules('https://a.x.org/bar', ['https://*.x.org/foo']);\n\t\tlinkNotAllowedByRules('https://a.b.x.org/bar', ['https://*.x.org/foo']);\n\n\t\tlinkAllowedByRules('https://github.com', ['https://github.com/foo/bar', 'https://github.com']);\n\t});\n\n\ttest('ports', () => {\n\t\tlinkNotAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:8081/foo']);\n\t\tlinkAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:*/foo']);\n\t\tlinkAllowedByRules('https://x.org/foo/bar', ['https://x.org:*/foo']);\n\t\tlinkAllowedByRules('https://x.org:8080/foo/bar', ['https://x.org:8080/foo']);\n\t});\n\n\ttest('ip addresses', () => {\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.7/']);\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.7']);\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://192.168.1.*']);\n\n\t\tlinkNotAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.*.6:*']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.7:3000/']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.7:*']);\n\t\tlinkAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.1.*:*']);\n\t\tlinkNotAllowedByRules('http://192.168.1.7:3000/', ['http://192.168.*.6:*']);\n\t});\n\n\ttest('scheme match', () => {\n\t\tlinkAllowedByRules('http://192.168.1.7/', ['http://*']);\n\t\tlinkAllowedByRules('http://twitter.com', ['http://*']);\n\t\tlinkAllowedByRules('http://twitter.com/hello', ['http://*']);\n\t\tlinkNotAllowedByRules('https://192.168.1.7/', ['http://*']);\n\t\tlinkNotAllowedByRules('https://twitter.com/', ['http://*']);\n\t});\n\n\ttest('case normalization', () => {\n\t\t// https://github.com/microsoft/vscode/issues/99294\n\t\tlinkAllowedByRules('https://github.com/microsoft/vscode/issues/new', ['https://github.com/microsoft']);\n\t\tlinkAllowedByRules('https://github.com/microsoft/vscode/issues/new', ['https://github.com/microsoft']);\n\t});\n\n\ttest('ignore query & fragment - https://github.com/microsoft/vscode/issues/156839', () => {\n\t\tlinkAllowedByRules('https://github.com/login/oauth/authorize?foo=4', ['https://github.com/login/oauth/authorize']);\n\t\tlinkAllowedByRules('https://github.com/login/oauth/authorize#foo', ['https://github.com/login/oauth/authorize']);\n\t});\n\n\ttest('ensure individual parts of url are compared and wildcard does not leak out', () => {\n\t\tlinkNotAllowedByRules('https://x.org/github.com', ['https://*.github.com']);\n\t\tlinkNotAllowedByRules('https://x.org/y.github.com', ['https://*.github.com']);\n\t});\n});\n"]}