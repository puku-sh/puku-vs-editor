{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/url/browser/trustedDomainService.ts","vs/workbench/contrib/url/browser/trustedDomainService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,eAAe,EAAE,MAAM,iCAAiC,CAAC;AAClE,OAAO,EAAE,UAAU,EAAE,MAAM,oCAAoC,CAAC;AAChE,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAElE,OAAO,EAAE,qBAAqB,EAAE,eAAe,EAAE,MAAM,4DAA4D,CAAC;AACpH,OAAO,EAAE,eAAe,EAAgB,MAAM,gDAAgD,CAAC;AAC/F,OAAO,EAAE,2BAA2B,EAAE,wBAAwB,EAAE,MAAM,qBAAqB,CAAC;AAC5F,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AACjE,OAAO,EAAS,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAElE,MAAM,CAAC,MAAM,qBAAqB,GAAG,eAAe,CAAwB,uBAAuB,CAAC,CAAC;AAQ9F,IAAM,oBAAoB,GAA1B,MAAM,oBAAqB,SAAQ,UAAU;IAQnD,YACwB,qBAA6D,EACnE,eAAiD;QAElE,KAAK,EAAE,CAAC;QAHgC,0BAAqB,GAArB,qBAAqB,CAAuB;QAClD,oBAAe,GAAf,eAAe,CAAiB;QAL3D,+BAA0B,GAAkB,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAQ,CAAC,CAAC;QAC/E,8BAAyB,GAAgB,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC;QAQvF,MAAM,uBAAuB,GAAG,GAAG,EAAE;YACpC,OAAO,IAAI,eAAe,CAAC,UAAU,EAAE,GAAG,EAAE;gBAC3C,MAAM,EAAE,qBAAqB,EAAE,cAAc,GAAG,GAAG,IAAI,CAAC,qBAAqB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC;gBACvH,OAAO;oBACN,GAAG,qBAAqB;oBACxB,GAAG,cAAc;iBACjB,CAAC;YACH,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC;QACF,IAAI,CAAC,2BAA2B,GAAG,uBAAuB,EAAE,CAAC;QAC7D,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,gBAAgB,oCAA2B,2BAA2B,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE;YAC7H,IAAI,CAAC,2BAA2B,EAAE,OAAO,EAAE,CAAC;YAC5C,IAAI,CAAC,2BAA2B,GAAG,uBAAuB,EAAE,CAAC;YAC7D,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC;QACxC,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CAAC,QAAa;QACpB,MAAM,EAAE,qBAAqB,EAAE,cAAc,GAAG,GAAG,IAAI,CAAC,qBAAqB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC;QACvH,MAAM,iBAAiB,GAAG,CAAC,GAAG,qBAAqB,EAAE,GAAG,cAAc,CAAC,CAAC;QAExE,OAAO,kBAAkB,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;IACxD,CAAC;CACD,CAAA;AArCY,oBAAoB;IAS9B,WAAA,qBAAqB,CAAA;IACrB,WAAA,eAAe,CAAA;GAVL,oBAAoB,CAqChC","file":"trustedDomainService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { WindowIdleValue } from '../../../../base/browser/dom.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IInstantiationService, createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, StorageScope } from '../../../../platform/storage/common/storage.js';\nimport { TRUSTED_DOMAINS_STORAGE_KEY, readStaticTrustedDomains } from './trustedDomains.js';\nimport { isURLDomainTrusted } from '../common/trustedDomains.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\n\nexport const ITrustedDomainService = createDecorator<ITrustedDomainService>('ITrustedDomainService');\n\nexport interface ITrustedDomainService {\n\t_serviceBrand: undefined;\n\treadonly onDidChangeTrustedDomains: Event<void>;\n\tisValid(resource: URI): boolean;\n}\n\nexport class TrustedDomainService extends Disposable implements ITrustedDomainService {\n\t_serviceBrand: undefined;\n\n\tprivate _staticTrustedDomainsResult!: WindowIdleValue<string[]>;\n\n\tprivate _onDidChangeTrustedDomains: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onDidChangeTrustedDomains: Event<void> = this._onDidChangeTrustedDomains.event;\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\tconst initStaticDomainsResult = () => {\n\t\t\treturn new WindowIdleValue(mainWindow, () => {\n\t\t\t\tconst { defaultTrustedDomains, trustedDomains, } = this._instantiationService.invokeFunction(readStaticTrustedDomains);\n\t\t\t\treturn [\n\t\t\t\t\t...defaultTrustedDomains,\n\t\t\t\t\t...trustedDomains\n\t\t\t\t];\n\t\t\t});\n\t\t};\n\t\tthis._staticTrustedDomainsResult = initStaticDomainsResult();\n\t\tthis._register(this._storageService.onDidChangeValue(StorageScope.APPLICATION, TRUSTED_DOMAINS_STORAGE_KEY, this._store)(() => {\n\t\t\tthis._staticTrustedDomainsResult?.dispose();\n\t\t\tthis._staticTrustedDomainsResult = initStaticDomainsResult();\n\t\t\tthis._onDidChangeTrustedDomains.fire();\n\t\t}));\n\t}\n\n\tisValid(resource: URI): boolean {\n\t\tconst { defaultTrustedDomains, trustedDomains, } = this._instantiationService.invokeFunction(readStaticTrustedDomains);\n\t\tconst allTrustedDomains = [...defaultTrustedDomains, ...trustedDomains];\n\n\t\treturn isURLDomainTrusted(resource, allTrustedDomains);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { WindowIdleValue } from '../../../../base/browser/dom.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IInstantiationService, createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, StorageScope } from '../../../../platform/storage/common/storage.js';\nimport { TRUSTED_DOMAINS_STORAGE_KEY, readStaticTrustedDomains } from './trustedDomains.js';\nimport { isURLDomainTrusted } from '../common/trustedDomains.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\n\nexport const ITrustedDomainService = createDecorator<ITrustedDomainService>('ITrustedDomainService');\n\nexport interface ITrustedDomainService {\n\t_serviceBrand: undefined;\n\treadonly onDidChangeTrustedDomains: Event<void>;\n\tisValid(resource: URI): boolean;\n}\n\nexport class TrustedDomainService extends Disposable implements ITrustedDomainService {\n\t_serviceBrand: undefined;\n\n\tprivate _staticTrustedDomainsResult!: WindowIdleValue<string[]>;\n\n\tprivate _onDidChangeTrustedDomains: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onDidChangeTrustedDomains: Event<void> = this._onDidChangeTrustedDomains.event;\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\tconst initStaticDomainsResult = () => {\n\t\t\treturn new WindowIdleValue(mainWindow, () => {\n\t\t\t\tconst { defaultTrustedDomains, trustedDomains, } = this._instantiationService.invokeFunction(readStaticTrustedDomains);\n\t\t\t\treturn [\n\t\t\t\t\t...defaultTrustedDomains,\n\t\t\t\t\t...trustedDomains\n\t\t\t\t];\n\t\t\t});\n\t\t};\n\t\tthis._staticTrustedDomainsResult = initStaticDomainsResult();\n\t\tthis._register(this._storageService.onDidChangeValue(StorageScope.APPLICATION, TRUSTED_DOMAINS_STORAGE_KEY, this._store)(() => {\n\t\t\tthis._staticTrustedDomainsResult?.dispose();\n\t\t\tthis._staticTrustedDomainsResult = initStaticDomainsResult();\n\t\t\tthis._onDidChangeTrustedDomains.fire();\n\t\t}));\n\t}\n\n\tisValid(resource: URI): boolean {\n\t\tconst { defaultTrustedDomains, trustedDomains, } = this._instantiationService.invokeFunction(readStaticTrustedDomains);\n\t\tconst allTrustedDomains = [...defaultTrustedDomains, ...trustedDomains];\n\n\t\treturn isURLDomainTrusted(resource, allTrustedDomains);\n\t}\n}\n"]}