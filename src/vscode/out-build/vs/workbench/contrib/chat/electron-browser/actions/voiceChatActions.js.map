{"version":3,"sources":["vs/workbench/contrib/chat/electron-browser/actions/voiceChatActions.ts"],"names":[],"mappings":"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","file":"voiceChatActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { renderAsPlaintext } from '../../../../../base/browser/markdownRenderer.js';\nimport { RunOnceScheduler, disposableTimeout, raceCancellation } from '../../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { KeyCode, KeyMod } from '../../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore, MutableDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { isNumber } from '../../../../../base/common/types.js';\nimport { getCodeEditor } from '../../../../../editor/browser/editorBrowser.js';\nimport { EditorContextKeys } from '../../../../../editor/common/editorContextKeys.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { Action2, IAction2Options, MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { Extensions, IConfigurationRegistry } from '../../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr, ContextKeyExpression, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingWeight } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { Registry } from '../../../../../platform/registry/common/platform.js';\nimport { contrastBorder, focusBorder } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { spinningLoading, syncing } from '../../../../../platform/theme/common/iconRegistry.js';\nimport { isHighContrast } from '../../../../../platform/theme/common/theme.js';\nimport { registerThemingParticipant } from '../../../../../platform/theme/common/themeService.js';\nimport { ActiveEditorContext } from '../../../../common/contextkeys.js';\nimport { IWorkbenchContribution } from '../../../../common/contributions.js';\nimport { ACTIVITY_BAR_BADGE_BACKGROUND } from '../../../../common/theme.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IHostService } from '../../../../services/host/browser/host.js';\nimport { IWorkbenchLayoutService, Parts } from '../../../../services/layout/browser/layoutService.js';\nimport { IStatusbarEntry, IStatusbarEntryAccessor, IStatusbarService, StatusbarAlignment } from '../../../../services/statusbar/browser/statusbar.js';\nimport { AccessibilityVoiceSettingId, SpeechTimeoutDefault, accessibilityConfigurationNodeBase } from '../../../accessibility/browser/accessibilityConfiguration.js';\nimport { InlineChatController } from '../../../inlineChat/browser/inlineChatController.js';\nimport { CTX_INLINE_CHAT_FOCUSED, MENU_INLINE_CHAT_WIDGET_SECONDARY } from '../../../inlineChat/common/inlineChat.js';\nimport { NOTEBOOK_EDITOR_FOCUSED } from '../../../notebook/common/notebookContextKeys.js';\nimport { CONTEXT_SETTINGS_EDITOR } from '../../../preferences/common/preferences.js';\nimport { SearchContext } from '../../../search/common/constants.js';\nimport { TextToSpeechInProgress as GlobalTextToSpeechInProgress, HasSpeechProvider, ISpeechService, KeywordRecognitionStatus, SpeechToTextInProgress, SpeechToTextStatus, TextToSpeechStatus } from '../../../speech/common/speechService.js';\nimport { CHAT_CATEGORY } from '../../browser/actions/chatActions.js';\nimport { IChatExecuteActionContext } from '../../browser/actions/chatExecuteActions.js';\nimport { IChatWidget, IChatWidgetService, IQuickChatService } from '../../browser/chat.js';\nimport { IChatAgentService } from '../../common/chatAgents.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { IChatResponseModel } from '../../common/chatModel.js';\nimport { KEYWORD_ACTIVIATION_SETTING_ID } from '../../common/chatService.js';\nimport { ChatResponseViewModel, IChatResponseViewModel, isResponseVM } from '../../common/chatViewModel.js';\nimport { ChatAgentLocation } from '../../common/constants.js';\nimport { VoiceChatInProgress as GlobalVoiceChatInProgress, IVoiceChatService } from '../../common/voiceChatService.js';\nimport './media/voiceChatActions.css';\n\n//#region Speech to Text\n\ntype VoiceChatSessionContext = 'view' | 'inline' | 'quick' | 'editor';\nconst VoiceChatSessionContexts: VoiceChatSessionContext[] = ['view', 'inline', 'quick', 'editor'];\n\n// Global Context Keys (set on global context key service)\nconst CanVoiceChat = ContextKeyExpr.and(ChatContextKeys.enabled, HasSpeechProvider);\nconst FocusInChatInput = ContextKeyExpr.or(CTX_INLINE_CHAT_FOCUSED, ChatContextKeys.inChatInput);\nconst AnyChatRequestInProgress = ChatContextKeys.requestInProgress;\n\n// Scoped Context Keys (set on per-chat-context scoped context key service)\nconst ScopedVoiceChatGettingReady = new RawContextKey<boolean>('scopedVoiceChatGettingReady', false, { type: 'boolean', description: localize('scopedVoiceChatGettingReady', \"True when getting ready for receiving voice input from the microphone for voice chat. This key is only defined scoped, per chat context.\") });\nconst ScopedVoiceChatInProgress = new RawContextKey<VoiceChatSessionContext | undefined>('scopedVoiceChatInProgress', undefined, { type: 'string', description: localize('scopedVoiceChatInProgress', \"Defined as a location where voice recording from microphone is in progress for voice chat. This key is only defined scoped, per chat context.\") });\nconst AnyScopedVoiceChatInProgress = ContextKeyExpr.or(...VoiceChatSessionContexts.map(context => ScopedVoiceChatInProgress.isEqualTo(context)));\n\nenum VoiceChatSessionState {\n\tStopped = 1,\n\tGettingReady,\n\tStarted\n}\n\ninterface IVoiceChatSessionController {\n\n\treadonly onDidAcceptInput: Event<unknown>;\n\treadonly onDidHideInput: Event<unknown>;\n\n\treadonly context: VoiceChatSessionContext;\n\treadonly scopedContextKeyService: IContextKeyService;\n\n\tupdateState(state: VoiceChatSessionState): void;\n\n\tfocusInput(): void;\n\tacceptInput(): Promise<IChatResponseModel | undefined>;\n\tupdateInput(text: string): void;\n\tgetInput(): string;\n\n\tsetInputPlaceholder(text: string): void;\n\tclearInputPlaceholder(): void;\n}\n\nclass VoiceChatSessionControllerFactory {\n\n\tstatic async create(accessor: ServicesAccessor, context: 'view' | 'inline' | 'quick' | 'focused'): Promise<IVoiceChatSessionController | undefined> {\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst quickChatService = accessor.get(IQuickChatService);\n\t\tconst layoutService = accessor.get(IWorkbenchLayoutService);\n\t\tconst editorService = accessor.get(IEditorService);\n\n\t\tswitch (context) {\n\t\t\tcase 'focused': {\n\t\t\t\tconst controller = VoiceChatSessionControllerFactory.doCreateForFocusedChat(chatWidgetService, layoutService);\n\t\t\t\treturn controller ?? VoiceChatSessionControllerFactory.create(accessor, 'view'); // fallback to 'view'\n\t\t\t}\n\t\t\tcase 'view': {\n\t\t\t\tconst chatWidget = await chatWidgetService.revealWidget();\n\t\t\t\tif (chatWidget) {\n\t\t\t\t\treturn VoiceChatSessionControllerFactory.doCreateForChatWidget('view', chatWidget);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'inline': {\n\t\t\t\tconst activeCodeEditor = getCodeEditor(editorService.activeTextEditorControl);\n\t\t\t\tif (activeCodeEditor) {\n\t\t\t\t\tconst inlineChat = InlineChatController.get(activeCodeEditor);\n\t\t\t\t\tif (inlineChat) {\n\t\t\t\t\t\tif (!inlineChat.isActive) {\n\t\t\t\t\t\t\tinlineChat.run();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn VoiceChatSessionControllerFactory.doCreateForChatWidget('inline', inlineChat.widget.chatWidget);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'quick': {\n\t\t\t\tquickChatService.open(); // this will populate focused chat widget in the chat widget service\n\t\t\t\treturn VoiceChatSessionControllerFactory.create(accessor, 'focused');\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate static doCreateForFocusedChat(chatWidgetService: IChatWidgetService, layoutService: IWorkbenchLayoutService): IVoiceChatSessionController | undefined {\n\t\tconst chatWidget = chatWidgetService.lastFocusedWidget;\n\t\tif (chatWidget?.hasInputFocus()) {\n\n\t\t\t// Figure out the context of the chat widget by asking\n\t\t\t// layout service for the part that has focus. Unfortunately\n\t\t\t// there is no better way because the widget does not know\n\t\t\t// its location.\n\n\t\t\tlet context: VoiceChatSessionContext;\n\t\t\tif (layoutService.hasFocus(Parts.EDITOR_PART)) {\n\t\t\t\tcontext = chatWidget.location === ChatAgentLocation.Chat ? 'editor' : 'inline';\n\t\t\t} else if (\n\t\t\t\t[Parts.SIDEBAR_PART, Parts.PANEL_PART, Parts.AUXILIARYBAR_PART, Parts.TITLEBAR_PART, Parts.STATUSBAR_PART, Parts.BANNER_PART, Parts.ACTIVITYBAR_PART].some(part => layoutService.hasFocus(part))\n\t\t\t) {\n\t\t\t\tcontext = 'view';\n\t\t\t} else {\n\t\t\t\tcontext = 'quick';\n\t\t\t}\n\n\t\t\treturn VoiceChatSessionControllerFactory.doCreateForChatWidget(context, chatWidget);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate static createChatContextKeyController(contextKeyService: IContextKeyService, context: VoiceChatSessionContext): (state: VoiceChatSessionState) => void {\n\t\tconst contextVoiceChatGettingReady = ScopedVoiceChatGettingReady.bindTo(contextKeyService);\n\t\tconst contextVoiceChatInProgress = ScopedVoiceChatInProgress.bindTo(contextKeyService);\n\n\t\treturn (state: VoiceChatSessionState) => {\n\t\t\tswitch (state) {\n\t\t\t\tcase VoiceChatSessionState.GettingReady:\n\t\t\t\t\tcontextVoiceChatGettingReady.set(true);\n\t\t\t\t\tcontextVoiceChatInProgress.reset();\n\t\t\t\t\tbreak;\n\t\t\t\tcase VoiceChatSessionState.Started:\n\t\t\t\t\tcontextVoiceChatGettingReady.reset();\n\t\t\t\t\tcontextVoiceChatInProgress.set(context);\n\t\t\t\t\tbreak;\n\t\t\t\tcase VoiceChatSessionState.Stopped:\n\t\t\t\t\tcontextVoiceChatGettingReady.reset();\n\t\t\t\t\tcontextVoiceChatInProgress.reset();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate static doCreateForChatWidget(context: VoiceChatSessionContext, chatWidget: IChatWidget): IVoiceChatSessionController {\n\t\treturn {\n\t\t\tcontext,\n\t\t\tscopedContextKeyService: chatWidget.scopedContextKeyService,\n\t\t\tonDidAcceptInput: chatWidget.onDidAcceptInput,\n\t\t\tonDidHideInput: chatWidget.onDidHide,\n\t\t\tfocusInput: () => chatWidget.focusInput(),\n\t\t\tacceptInput: () => chatWidget.acceptInput(undefined, { isVoiceInput: true }),\n\t\t\tupdateInput: text => chatWidget.setInput(text),\n\t\t\tgetInput: () => chatWidget.getInput(),\n\t\t\tsetInputPlaceholder: text => chatWidget.setInputPlaceholder(text),\n\t\t\tclearInputPlaceholder: () => chatWidget.resetInputPlaceholder(),\n\t\t\tupdateState: VoiceChatSessionControllerFactory.createChatContextKeyController(chatWidget.scopedContextKeyService, context)\n\t\t};\n\t}\n}\n\ninterface IVoiceChatSession {\n\tsetTimeoutDisabled(disabled: boolean): void;\n\n\taccept(): void;\n\tstop(): void;\n}\n\ninterface IActiveVoiceChatSession extends IVoiceChatSession {\n\treadonly id: number;\n\treadonly controller: IVoiceChatSessionController;\n\treadonly disposables: DisposableStore;\n\n\thasRecognizedInput: boolean;\n}\n\nclass VoiceChatSessions {\n\n\tprivate static instance: VoiceChatSessions | undefined = undefined;\n\tstatic getInstance(instantiationService: IInstantiationService): VoiceChatSessions {\n\t\tif (!VoiceChatSessions.instance) {\n\t\t\tVoiceChatSessions.instance = instantiationService.createInstance(VoiceChatSessions);\n\t\t}\n\n\t\treturn VoiceChatSessions.instance;\n\t}\n\n\tprivate currentVoiceChatSession: IActiveVoiceChatSession | undefined = undefined;\n\tprivate voiceChatSessionIds = 0;\n\n\tconstructor(\n\t\t@IVoiceChatService private readonly voiceChatService: IVoiceChatService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService\n\t) { }\n\n\tasync start(controller: IVoiceChatSessionController, context?: IChatExecuteActionContext): Promise<IVoiceChatSession> {\n\n\t\t// Stop running text-to-speech or speech-to-text sessions in chats\n\t\tthis.stop();\n\t\tChatSynthesizerSessions.getInstance(this.instantiationService).stop();\n\n\t\tlet disableTimeout = false;\n\n\t\tconst sessionId = ++this.voiceChatSessionIds;\n\t\tconst session: IActiveVoiceChatSession = this.currentVoiceChatSession = {\n\t\t\tid: sessionId,\n\t\t\tcontroller,\n\t\t\thasRecognizedInput: false,\n\t\t\tdisposables: new DisposableStore(),\n\t\t\tsetTimeoutDisabled: (disabled: boolean) => { disableTimeout = disabled; },\n\t\t\taccept: () => this.accept(sessionId),\n\t\t\tstop: () => this.stop(sessionId, controller.context)\n\t\t};\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tsession.disposables.add(toDisposable(() => cts.dispose(true)));\n\n\t\tsession.disposables.add(controller.onDidAcceptInput(() => this.stop(sessionId, controller.context)));\n\t\tsession.disposables.add(controller.onDidHideInput(() => this.stop(sessionId, controller.context)));\n\n\t\tcontroller.focusInput();\n\n\t\tcontroller.updateState(VoiceChatSessionState.GettingReady);\n\n\t\tconst voiceChatSession = await this.voiceChatService.createVoiceChatSession(cts.token, { usesAgents: controller.context !== 'inline', model: context?.widget?.viewModel?.model });\n\n\t\tlet inputValue = controller.getInput();\n\n\t\tlet voiceChatTimeout = this.configurationService.getValue<number>(AccessibilityVoiceSettingId.SpeechTimeout);\n\t\tif (!isNumber(voiceChatTimeout) || voiceChatTimeout < 0) {\n\t\t\tvoiceChatTimeout = SpeechTimeoutDefault;\n\t\t}\n\n\t\tconst acceptTranscriptionScheduler = session.disposables.add(new RunOnceScheduler(() => this.accept(sessionId), voiceChatTimeout));\n\t\tsession.disposables.add(voiceChatSession.onDidChange(({ status, text, waitingForInput }) => {\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (status) {\n\t\t\t\tcase SpeechToTextStatus.Started:\n\t\t\t\t\tthis.onDidSpeechToTextSessionStart(controller, session.disposables);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SpeechToTextStatus.Recognizing:\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\tsession.hasRecognizedInput = true;\n\t\t\t\t\t\tsession.controller.updateInput(inputValue ? [inputValue, text].join(' ') : text);\n\t\t\t\t\t\tif (voiceChatTimeout > 0 && context?.voice?.disableTimeout !== true && !disableTimeout) {\n\t\t\t\t\t\t\tacceptTranscriptionScheduler.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SpeechToTextStatus.Recognized:\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\tsession.hasRecognizedInput = true;\n\t\t\t\t\t\tinputValue = inputValue ? [inputValue, text].join(' ') : text;\n\t\t\t\t\t\tsession.controller.updateInput(inputValue);\n\t\t\t\t\t\tif (voiceChatTimeout > 0 && context?.voice?.disableTimeout !== true && !waitingForInput && !disableTimeout) {\n\t\t\t\t\t\t\tacceptTranscriptionScheduler.schedule();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SpeechToTextStatus.Stopped:\n\t\t\t\t\tthis.stop(session.id, controller.context);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}));\n\n\t\treturn session;\n\t}\n\n\tprivate onDidSpeechToTextSessionStart(controller: IVoiceChatSessionController, disposables: DisposableStore): void {\n\t\tcontroller.updateState(VoiceChatSessionState.Started);\n\n\t\tlet dotCount = 0;\n\n\t\tconst updatePlaceholder = () => {\n\t\t\tdotCount = (dotCount + 1) % 4;\n\t\t\tcontroller.setInputPlaceholder(`${localize('listening', \"I'm listening\")}${'.'.repeat(dotCount)}`);\n\t\t\tplaceholderScheduler.schedule();\n\t\t};\n\n\t\tconst placeholderScheduler = disposables.add(new RunOnceScheduler(updatePlaceholder, 500));\n\t\tupdatePlaceholder();\n\t}\n\n\tstop(voiceChatSessionId = this.voiceChatSessionIds, context?: VoiceChatSessionContext): void {\n\t\tif (\n\t\t\t!this.currentVoiceChatSession ||\n\t\t\tthis.voiceChatSessionIds !== voiceChatSessionId ||\n\t\t\t(context && this.currentVoiceChatSession.controller.context !== context)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentVoiceChatSession.controller.clearInputPlaceholder();\n\n\t\tthis.currentVoiceChatSession.controller.updateState(VoiceChatSessionState.Stopped);\n\n\t\tthis.currentVoiceChatSession.disposables.dispose();\n\t\tthis.currentVoiceChatSession = undefined;\n\t}\n\n\tasync accept(voiceChatSessionId = this.voiceChatSessionIds): Promise<void> {\n\t\tif (\n\t\t\t!this.currentVoiceChatSession ||\n\t\t\tthis.voiceChatSessionIds !== voiceChatSessionId\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.currentVoiceChatSession.hasRecognizedInput) {\n\t\t\t// If we have an active session but without recognized\n\t\t\t// input, we do not want to just accept the input that\n\t\t\t// was maybe typed before. But we still want to stop the\n\t\t\t// voice session because `acceptInput` would do that.\n\t\t\tthis.stop(voiceChatSessionId, this.currentVoiceChatSession.controller.context);\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = this.currentVoiceChatSession.controller;\n\t\tconst response = await controller.acceptInput();\n\t\tif (!response) {\n\t\t\treturn;\n\t\t}\n\t\tconst autoSynthesize = this.configurationService.getValue<'on' | 'off'>(AccessibilityVoiceSettingId.AutoSynthesize);\n\t\tif (autoSynthesize === 'on' || (autoSynthesize !== 'off' && !this.accessibilityService.isScreenReaderOptimized())) {\n\t\t\tlet context: IVoiceChatSessionController | 'focused';\n\t\t\tif (controller.context === 'inline') {\n\t\t\t\t// This is ugly, but the lightweight inline chat turns into\n\t\t\t\t// a different widget as soon as a response comes in, so we fallback to\n\t\t\t\t// picking up from the focused chat widget\n\t\t\t\tcontext = 'focused';\n\t\t\t} else {\n\t\t\t\tcontext = controller;\n\t\t\t}\n\t\t\tChatSynthesizerSessions.getInstance(this.instantiationService).start(this.instantiationService.invokeFunction(accessor => ChatSynthesizerSessionController.create(accessor, context, response)));\n\t\t}\n\t}\n}\n\nexport const VOICE_KEY_HOLD_THRESHOLD = 500;\n\nasync function startVoiceChatWithHoldMode(id: string, accessor: ServicesAccessor, target: 'view' | 'inline' | 'quick' | 'focused', context?: IChatExecuteActionContext): Promise<void> {\n\tconst instantiationService = accessor.get(IInstantiationService);\n\tconst keybindingService = accessor.get(IKeybindingService);\n\n\tconst holdMode = keybindingService.enableKeybindingHoldMode(id);\n\n\tconst controller = await VoiceChatSessionControllerFactory.create(accessor, target);\n\tif (!controller) {\n\t\treturn;\n\t}\n\n\tconst session = await VoiceChatSessions.getInstance(instantiationService).start(controller, context);\n\n\tlet acceptVoice = false;\n\tconst handle = disposableTimeout(() => {\n\t\tacceptVoice = true;\n\t\tsession?.setTimeoutDisabled(true); // disable accept on timeout when hold mode runs for VOICE_KEY_HOLD_THRESHOLD\n\t}, VOICE_KEY_HOLD_THRESHOLD);\n\tawait holdMode;\n\thandle.dispose();\n\n\tif (acceptVoice) {\n\t\tsession.accept();\n\t}\n}\n\nclass VoiceChatWithHoldModeAction extends Action2 {\n\n\tconstructor(desc: Readonly<IAction2Options>, private readonly target: 'view' | 'inline' | 'quick') {\n\t\tsuper(desc);\n\t}\n\n\trun(accessor: ServicesAccessor, context?: IChatExecuteActionContext): Promise<void> {\n\t\treturn startVoiceChatWithHoldMode(this.desc.id, accessor, this.target, context);\n\t}\n}\n\nexport class VoiceChatInChatViewAction extends VoiceChatWithHoldModeAction {\n\n\tstatic readonly ID = 'workbench.action.chat.voiceChatInChatView';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: VoiceChatInChatViewAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.voiceChatInView.label', \"Voice Chat in Chat View\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tCanVoiceChat,\n\t\t\t\tChatContextKeys.requestInProgress.negate() // disable when a chat request is in progress\n\t\t\t),\n\t\t\tf1: true\n\t\t}, 'view');\n\t}\n}\n\nexport class HoldToVoiceChatInChatViewAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.holdToVoiceChatInChatView';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: HoldToVoiceChatInChatViewAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.holdToVoiceChatInChatView.label', \"Hold to Voice Chat in Chat View\"),\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tCanVoiceChat,\n\t\t\t\t\tChatContextKeys.requestInProgress.negate(), \t// disable when a chat request is in progress\n\t\t\t\t\tFocusInChatInput?.negate(),\t\t\t\t\t\t// when already in chat input, disable this action and prefer to start voice chat directly\n\t\t\t\t\tEditorContextKeys.focus.negate(), \t\t\t\t// do not steal the inline-chat keybinding\n\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED.negate(),\t\t\t\t// do not steal the notebook keybinding\n\t\t\t\t\tSearchContext.SearchViewFocusedKey.negate(),\t// do not steal the search keybinding\n\t\t\t\t\tCONTEXT_SETTINGS_EDITOR.negate(),\t\t\t\t// do not steal the settings editor keybinding\n\t\t\t\t),\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyI\n\t\t\t}\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context?: IChatExecuteActionContext): Promise<void> {\n\n\t\t// The intent of this action is to provide 2 modes to align with what `Ctrlcmd+I` in inline chat:\n\t\t// - if the user press and holds, we start voice chat in the chat view\n\t\t// - if the user press and releases quickly enough, we just open the chat view without voice chat\n\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\tconst keybindingService = accessor.get(IKeybindingService);\n\t\tconst widgetService = accessor.get(IChatWidgetService);\n\n\t\tconst holdMode = keybindingService.enableKeybindingHoldMode(HoldToVoiceChatInChatViewAction.ID);\n\n\t\tlet session: IVoiceChatSession | undefined;\n\t\tconst handle = disposableTimeout(async () => {\n\t\t\tconst controller = await VoiceChatSessionControllerFactory.create(accessor, 'view');\n\t\t\tif (controller) {\n\t\t\t\tsession = await VoiceChatSessions.getInstance(instantiationService).start(controller, context);\n\t\t\t\tsession.setTimeoutDisabled(true);\n\t\t\t}\n\t\t}, VOICE_KEY_HOLD_THRESHOLD);\n\n\t\t(await widgetService.revealWidget())?.focusInput();\n\n\t\tawait holdMode;\n\t\thandle.dispose();\n\n\t\tif (session) {\n\t\t\tsession.accept();\n\t\t}\n\t}\n}\n\nexport class InlineVoiceChatAction extends VoiceChatWithHoldModeAction {\n\n\tstatic readonly ID = 'workbench.action.chat.inlineVoiceChat';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: InlineVoiceChatAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.inlineVoiceChat', \"Inline Voice Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tCanVoiceChat,\n\t\t\t\tActiveEditorContext,\n\t\t\t\tChatContextKeys.requestInProgress.negate() // disable when a chat request is in progress\n\t\t\t),\n\t\t\tf1: true\n\t\t}, 'inline');\n\t}\n}\n\nexport class QuickVoiceChatAction extends VoiceChatWithHoldModeAction {\n\n\tstatic readonly ID = 'workbench.action.chat.quickVoiceChat';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: QuickVoiceChatAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.quickVoiceChat.label', \"Quick Voice Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tCanVoiceChat,\n\t\t\t\tChatContextKeys.requestInProgress.negate() // disable when a chat request is in progress\n\t\t\t),\n\t\t\tf1: true\n\t\t}, 'quick');\n\t}\n}\n\nconst primaryVoiceActionMenu = (when: ContextKeyExpression | undefined) => {\n\treturn [\n\t\t{\n\t\t\tid: MenuId.ChatExecute,\n\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.location.isEqualTo(ChatAgentLocation.Chat), when),\n\t\t\tgroup: 'navigation',\n\t\t\torder: 3\n\t\t},\n\t\t{\n\t\t\tid: MenuId.ChatExecute,\n\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.location.isEqualTo(ChatAgentLocation.Chat).negate(), when),\n\t\t\tgroup: 'navigation',\n\t\t\torder: 2\n\t\t}\n\t];\n};\n\nexport class StartVoiceChatAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.startVoiceChat';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: StartVoiceChatAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.startVoiceChat.label', \"Start Voice Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: true,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tFocusInChatInput,\t\t\t\t\t// scope this action to chat input fields only\n\t\t\t\t\tEditorContextKeys.focus.negate(), \t// do not steal the editor inline-chat keybinding\n\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED.negate()\t// do not steal the notebook inline-chat keybinding\n\t\t\t\t),\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyI\n\t\t\t},\n\t\t\ticon: Codicon.mic,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tCanVoiceChat,\n\t\t\t\tScopedVoiceChatGettingReady.negate(),\t// disable when voice chat is getting ready\n\t\t\t\tAnyChatRequestInProgress?.negate(),\t\t// disable when any chat request is in progress\n\t\t\t\tSpeechToTextInProgress.negate()\t\t\t// disable when speech to text is in progress\n\t\t\t),\n\t\t\tmenu: primaryVoiceActionMenu(ContextKeyExpr.and(\n\t\t\t\tHasSpeechProvider,\n\t\t\t\tScopedChatSynthesisInProgress.negate(),\t// hide when text to speech is in progress\n\t\t\t\tAnyScopedVoiceChatInProgress?.negate(),\t// hide when voice chat is in progress\n\t\t\t))\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, context?: IChatExecuteActionContext): Promise<void> {\n\t\tconst widget = context?.widget;\n\t\tif (widget) {\n\t\t\t// if we already get a context when the action is executed\n\t\t\t// from a toolbar within the chat widget, then make sure\n\t\t\t// to move focus into the input field so that the controller\n\t\t\t// is properly retrieved\n\t\t\twidget.focusInput();\n\t\t}\n\n\t\treturn startVoiceChatWithHoldMode(this.desc.id, accessor, 'focused', context);\n\t}\n}\n\nexport class StopListeningAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.stopListening';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: StopListeningAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.stopListening.label', \"Stop Listening\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: true,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib + 100,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\twhen: AnyScopedVoiceChatInProgress\n\t\t\t},\n\t\t\ticon: spinningLoading,\n\t\t\tprecondition: GlobalVoiceChatInProgress, // need global context here because of `f1: true`\n\t\t\tmenu: primaryVoiceActionMenu(AnyScopedVoiceChatInProgress)\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tVoiceChatSessions.getInstance(accessor.get(IInstantiationService)).stop();\n\t}\n}\n\nexport class StopListeningAndSubmitAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.stopListeningAndSubmit';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: StopListeningAndSubmitAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.stopListeningAndSubmit.label', \"Stop Listening and Submit\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: true,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tFocusInChatInput,\n\t\t\t\t\tAnyScopedVoiceChatInProgress\n\t\t\t\t),\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KeyI\n\t\t\t},\n\t\t\tprecondition: GlobalVoiceChatInProgress // need global context here because of `f1: true`\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tVoiceChatSessions.getInstance(accessor.get(IInstantiationService)).accept();\n\t}\n}\n\n//#endregion\n\n//#region Text to Speech\n\nconst ScopedChatSynthesisInProgress = new RawContextKey<boolean>('scopedChatSynthesisInProgress', false, { type: 'boolean', description: localize('scopedChatSynthesisInProgress', \"Defined as a location where voice recording from microphone is in progress for voice chat. This key is only defined scoped, per chat context.\") });\n\ninterface IChatSynthesizerSessionController {\n\n\treadonly onDidHideChat: Event<unknown>;\n\n\treadonly contextKeyService: IContextKeyService;\n\treadonly response: IChatResponseModel;\n}\n\nclass ChatSynthesizerSessionController {\n\n\tstatic create(accessor: ServicesAccessor, context: IVoiceChatSessionController | 'focused', response: IChatResponseModel): IChatSynthesizerSessionController {\n\t\tif (context === 'focused') {\n\t\t\treturn ChatSynthesizerSessionController.doCreateForFocusedChat(accessor, response);\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tonDidHideChat: context.onDidHideInput,\n\t\t\t\tcontextKeyService: context.scopedContextKeyService,\n\t\t\t\tresponse\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate static doCreateForFocusedChat(accessor: ServicesAccessor, response: IChatResponseModel): IChatSynthesizerSessionController {\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst contextKeyService = accessor.get(IContextKeyService);\n\t\tlet chatWidget = chatWidgetService.getWidgetBySessionResource(response.session.sessionResource);\n\t\tif (chatWidget?.location === ChatAgentLocation.EditorInline) {\n\t\t\t// workaround for https://github.com/microsoft/vscode/issues/212785\n\t\t\tchatWidget = chatWidgetService.lastFocusedWidget;\n\t\t}\n\n\t\treturn {\n\t\t\tonDidHideChat: chatWidget?.onDidHide ?? Event.None,\n\t\t\tcontextKeyService: chatWidget?.scopedContextKeyService ?? contextKeyService,\n\t\t\tresponse\n\t\t};\n\t}\n}\n\ninterface IChatSynthesizerContext {\n\treadonly ignoreCodeBlocks: boolean;\n\tinsideCodeBlock: boolean;\n}\n\nclass ChatSynthesizerSessions {\n\n\tprivate static instance: ChatSynthesizerSessions | undefined = undefined;\n\tstatic getInstance(instantiationService: IInstantiationService): ChatSynthesizerSessions {\n\t\tif (!ChatSynthesizerSessions.instance) {\n\t\t\tChatSynthesizerSessions.instance = instantiationService.createInstance(ChatSynthesizerSessions);\n\t\t}\n\n\t\treturn ChatSynthesizerSessions.instance;\n\t}\n\n\tprivate activeSession: CancellationTokenSource | undefined = undefined;\n\n\tconstructor(\n\t\t@ISpeechService private readonly speechService: ISpeechService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) { }\n\n\tasync start(controller: IChatSynthesizerSessionController): Promise<void> {\n\n\t\t// Stop running text-to-speech or speech-to-text sessions in chats\n\t\tthis.stop();\n\t\tVoiceChatSessions.getInstance(this.instantiationService).stop();\n\n\t\tconst activeSession = this.activeSession = new CancellationTokenSource();\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(activeSession.token.onCancellationRequested(() => disposables.dispose()));\n\n\t\tconst session = await this.speechService.createTextToSpeechSession(activeSession.token, 'chat');\n\n\t\tif (activeSession.token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tdisposables.add(controller.onDidHideChat(() => this.stop()));\n\n\t\tconst scopedChatToSpeechInProgress = ScopedChatSynthesisInProgress.bindTo(controller.contextKeyService);\n\t\tdisposables.add(toDisposable(() => scopedChatToSpeechInProgress.reset()));\n\n\t\tdisposables.add(session.onDidChange(e => {\n\t\t\tswitch (e.status) {\n\t\t\t\tcase TextToSpeechStatus.Started:\n\t\t\t\t\tscopedChatToSpeechInProgress.set(true);\n\t\t\t\t\tbreak;\n\t\t\t\tcase TextToSpeechStatus.Stopped:\n\t\t\t\t\tscopedChatToSpeechInProgress.reset();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}));\n\n\t\tfor await (const chunk of this.nextChatResponseChunk(controller.response, activeSession.token)) {\n\t\t\tif (activeSession.token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait raceCancellation(session.synthesize(chunk), activeSession.token);\n\t\t}\n\t}\n\n\tprivate async *nextChatResponseChunk(response: IChatResponseModel, token: CancellationToken): AsyncIterable<string> {\n\t\tconst context: IChatSynthesizerContext = {\n\t\t\tignoreCodeBlocks: this.configurationService.getValue<boolean>(AccessibilityVoiceSettingId.IgnoreCodeBlocks),\n\t\t\tinsideCodeBlock: false\n\t\t};\n\n\t\tlet totalOffset = 0;\n\t\tlet complete = false;\n\t\tdo {\n\t\t\tconst responseLength = response.response.toString().length;\n\t\t\tconst { chunk, offset } = this.parseNextChatResponseChunk(response, totalOffset, context);\n\t\t\ttotalOffset = offset;\n\t\t\tcomplete = response.isComplete;\n\n\t\t\tif (chunk) {\n\t\t\t\tyield chunk;\n\t\t\t}\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!complete && responseLength === response.response.toString().length) {\n\t\t\t\tawait raceCancellation(Event.toPromise(response.onDidChange), token); // wait for the response to change\n\t\t\t}\n\t\t} while (!token.isCancellationRequested && !complete);\n\t}\n\n\tprivate parseNextChatResponseChunk(response: IChatResponseModel, offset: number, context: IChatSynthesizerContext): { readonly chunk: string | undefined; readonly offset: number } {\n\t\tlet chunk: string | undefined = undefined;\n\n\t\tconst text = response.response.toString();\n\n\t\tif (response.isComplete) {\n\t\t\tchunk = text.substring(offset);\n\t\t\toffset = text.length + 1;\n\t\t} else {\n\t\t\tconst res = parseNextChatResponseChunk(text, offset);\n\t\t\tchunk = res.chunk;\n\t\t\toffset = res.offset;\n\t\t}\n\n\t\tif (chunk && context.ignoreCodeBlocks) {\n\t\t\tchunk = this.filterCodeBlocks(chunk, context);\n\t\t}\n\n\t\treturn {\n\t\t\tchunk: chunk ? renderAsPlaintext({ value: chunk }) : chunk, // convert markdown to plain text\n\t\t\toffset\n\t\t};\n\t}\n\n\tprivate filterCodeBlocks(chunk: string, context: IChatSynthesizerContext): string {\n\t\treturn chunk.split('\\n')\n\t\t\t.filter(line => {\n\t\t\t\tif (line.trimStart().startsWith('```')) {\n\t\t\t\t\tcontext.insideCodeBlock = !context.insideCodeBlock;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !context.insideCodeBlock;\n\t\t\t})\n\t\t\t.join('\\n');\n\t}\n\n\tstop(): void {\n\t\tthis.activeSession?.dispose(true);\n\t\tthis.activeSession = undefined;\n\t}\n}\n\nconst sentenceDelimiter = ['.', '!', '?', ':'];\nconst lineDelimiter = '\\n';\nconst wordDelimiter = ' ';\n\nexport function parseNextChatResponseChunk(text: string, offset: number): { readonly chunk: string | undefined; readonly offset: number } {\n\tlet chunk: string | undefined = undefined;\n\n\tfor (let i = text.length - 1; i >= offset; i--) { // going from end to start to produce largest chunks\n\t\tconst cur = text[i];\n\t\tconst next = text[i + 1];\n\t\tif (\n\t\t\tsentenceDelimiter.includes(cur) && next === wordDelimiter ||\t// end of sentence\n\t\t\tlineDelimiter === cur\t\t\t\t\t\t\t\t\t\t\t// end of line\n\t\t) {\n\t\t\tchunk = text.substring(offset, i + 1).trim();\n\t\t\toffset = i + 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn { chunk, offset };\n}\n\nexport class ReadChatResponseAloud extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.chat.readChatResponseAloud',\n\t\t\ttitle: localize2('workbench.action.chat.readChatResponseAloud', \"Read Aloud\"),\n\t\t\ticon: Codicon.unmute,\n\t\t\tprecondition: CanVoiceChat,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ChatMessageFooter,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tCanVoiceChat,\n\t\t\t\t\tChatContextKeys.isResponse,\t\t\t\t\t\t// only for responses\n\t\t\t\t\tScopedChatSynthesisInProgress.negate(),\t// but not when already in progress\n\t\t\t\t\tChatContextKeys.responseIsFiltered.negate(),\t\t// and not when response is filtered\n\t\t\t\t),\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: -10 // first\n\t\t\t}, {\n\t\t\t\tid: MENU_INLINE_CHAT_WIDGET_SECONDARY,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tCanVoiceChat,\n\t\t\t\t\tChatContextKeys.isResponse,\t\t\t\t\t\t// only for responses\n\t\t\t\t\tScopedChatSynthesisInProgress.negate(),\t// but not when already in progress\n\t\t\t\t\tChatContextKeys.responseIsFiltered.negate()\t\t// and not when response is filtered\n\t\t\t\t),\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: -10 // first\n\t\t\t}]\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\n\t\tlet response: IChatResponseViewModel | undefined = undefined;\n\t\tif (args.length > 0) {\n\t\t\tconst responseArg = args[0];\n\t\t\tif (isResponseVM(responseArg)) {\n\t\t\t\tresponse = responseArg;\n\t\t\t}\n\t\t} else {\n\t\t\tconst chatWidget = chatWidgetService.lastFocusedWidget;\n\t\t\tif (chatWidget) {\n\n\t\t\t\t// pick focused response\n\t\t\t\tconst focus = chatWidget.getFocus();\n\t\t\t\tif (focus instanceof ChatResponseViewModel) {\n\t\t\t\t\tresponse = focus;\n\t\t\t\t}\n\n\t\t\t\t// pick the last response\n\t\t\t\telse {\n\t\t\t\t\tconst chatViewModel = chatWidget.viewModel;\n\t\t\t\t\tif (chatViewModel) {\n\t\t\t\t\t\tconst items = chatViewModel.getItems();\n\t\t\t\t\t\tfor (let i = items.length - 1; i >= 0; i--) {\n\t\t\t\t\t\t\tconst item = items[i];\n\t\t\t\t\t\t\tif (isResponseVM(item)) {\n\t\t\t\t\t\t\t\tresponse = item;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!response) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = ChatSynthesizerSessionController.create(accessor, 'focused', response.model);\n\t\tChatSynthesizerSessions.getInstance(instantiationService).start(controller);\n\t}\n}\n\nexport class StopReadAloud extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.speech.stopReadAloud';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: StopReadAloud.ID,\n\t\t\ticon: syncing,\n\t\t\ttitle: localize2('workbench.action.speech.stopReadAloud', \"Stop Reading Aloud\"),\n\t\t\tf1: true,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: GlobalTextToSpeechInProgress, // need global context here because of `f1: true`\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib + 100,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\twhen: ScopedChatSynthesisInProgress\n\t\t\t},\n\t\t\tmenu: primaryVoiceActionMenu(ScopedChatSynthesisInProgress)\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tChatSynthesizerSessions.getInstance(accessor.get(IInstantiationService)).stop();\n\t}\n}\n\nexport class StopReadChatItemAloud extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.stopReadChatItemAloud';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: StopReadChatItemAloud.ID,\n\t\t\ticon: Codicon.mute,\n\t\t\ttitle: localize2('workbench.action.chat.stopReadChatItemAloud', \"Stop Reading Aloud\"),\n\t\t\tprecondition: ScopedChatSynthesisInProgress,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib + 100,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatMessageFooter,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tScopedChatSynthesisInProgress,\t\t// only when in progress\n\t\t\t\t\t\tChatContextKeys.isResponse,\t\t\t\t\t// only for responses\n\t\t\t\t\t\tChatContextKeys.responseIsFiltered.negate()\t// but not when response is filtered\n\t\t\t\t\t),\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: -10 // first\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MENU_INLINE_CHAT_WIDGET_SECONDARY,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tScopedChatSynthesisInProgress,\t\t// only when in progress\n\t\t\t\t\t\tChatContextKeys.isResponse,\t\t\t\t\t// only for responses\n\t\t\t\t\t\tChatContextKeys.responseIsFiltered.negate()\t// but not when response is filtered\n\t\t\t\t\t),\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: -10 // first\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tChatSynthesizerSessions.getInstance(accessor.get(IInstantiationService)).stop();\n\t}\n}\n\n//#endregion\n\n//#region Keyword Recognition\n\nfunction supportsKeywordActivation(configurationService: IConfigurationService, speechService: ISpeechService, chatAgentService: IChatAgentService): boolean {\n\tif (!speechService.hasSpeechProvider || !chatAgentService.getDefaultAgent(ChatAgentLocation.Chat)) {\n\t\treturn false;\n\t}\n\n\tconst value = configurationService.getValue(KEYWORD_ACTIVIATION_SETTING_ID);\n\n\treturn typeof value === 'string' && value !== KeywordActivationContribution.SETTINGS_VALUE.OFF;\n}\n\nexport class KeywordActivationContribution extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.keywordActivation';\n\n\tstatic SETTINGS_VALUE = {\n\t\tOFF: 'off',\n\t\tINLINE_CHAT: 'inlineChat',\n\t\tQUICK_CHAT: 'quickChat',\n\t\tVIEW_CHAT: 'chatInView',\n\t\tCHAT_IN_CONTEXT: 'chatInContext'\n\t};\n\n\tprivate activeSession: CancellationTokenSource | undefined = undefined;\n\n\tconstructor(\n\t\t@ISpeechService private readonly speechService: ISpeechService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IChatAgentService private readonly chatAgentService: IChatAgentService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(instantiationService.createInstance(KeywordActivationStatusEntry));\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(Event.runAndSubscribe(this.speechService.onDidChangeHasSpeechProvider, () => {\n\t\t\tthis.updateConfiguration();\n\t\t\tthis.handleKeywordActivation();\n\t\t}));\n\n\t\tconst onDidAddDefaultAgent = this._register(this.chatAgentService.onDidChangeAgents(() => {\n\t\t\tif (this.chatAgentService.getDefaultAgent(ChatAgentLocation.Chat)) {\n\t\t\t\tthis.updateConfiguration();\n\t\t\t\tthis.handleKeywordActivation();\n\n\t\t\t\tonDidAddDefaultAgent.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.speechService.onDidStartSpeechToTextSession(() => this.handleKeywordActivation()));\n\t\tthis._register(this.speechService.onDidEndSpeechToTextSession(() => this.handleKeywordActivation()));\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(KEYWORD_ACTIVIATION_SETTING_ID)) {\n\t\t\t\tthis.handleKeywordActivation();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateConfiguration(): void {\n\t\tif (!this.speechService.hasSpeechProvider || !this.chatAgentService.getDefaultAgent(ChatAgentLocation.Chat)) {\n\t\t\treturn; // these settings require a speech and chat provider\n\t\t}\n\n\t\tconst registry = Registry.as<IConfigurationRegistry>(Extensions.Configuration);\n\t\tregistry.registerConfiguration({\n\t\t\t...accessibilityConfigurationNodeBase,\n\t\t\tproperties: {\n\t\t\t\t[KEYWORD_ACTIVIATION_SETTING_ID]: {\n\t\t\t\t\t'type': 'string',\n\t\t\t\t\t'enum': [\n\t\t\t\t\t\tKeywordActivationContribution.SETTINGS_VALUE.OFF,\n\t\t\t\t\t\tKeywordActivationContribution.SETTINGS_VALUE.VIEW_CHAT,\n\t\t\t\t\t\tKeywordActivationContribution.SETTINGS_VALUE.QUICK_CHAT,\n\t\t\t\t\t\tKeywordActivationContribution.SETTINGS_VALUE.INLINE_CHAT,\n\t\t\t\t\t\tKeywordActivationContribution.SETTINGS_VALUE.CHAT_IN_CONTEXT\n\t\t\t\t\t],\n\t\t\t\t\t'enumDescriptions': [\n\t\t\t\t\t\tlocalize('voice.keywordActivation.off', \"Keyword activation is disabled.\"),\n\t\t\t\t\t\tlocalize('voice.keywordActivation.chatInView', \"Keyword activation is enabled and listening for 'Hey Code' to start a voice chat session in the chat view.\"),\n\t\t\t\t\t\tlocalize('voice.keywordActivation.quickChat', \"Keyword activation is enabled and listening for 'Hey Code' to start a voice chat session in the quick chat.\"),\n\t\t\t\t\t\tlocalize('voice.keywordActivation.inlineChat', \"Keyword activation is enabled and listening for 'Hey Code' to start a voice chat session in the active editor if possible.\"),\n\t\t\t\t\t\tlocalize('voice.keywordActivation.chatInContext', \"Keyword activation is enabled and listening for 'Hey Code' to start a voice chat session in the active editor or view depending on keyboard focus.\")\n\t\t\t\t\t],\n\t\t\t\t\t'description': localize('voice.keywordActivation', \"Controls whether the keyword phrase 'Hey Code' is recognized to start a voice chat session. Enabling this will start recording from the microphone but the audio is processed locally and never sent to a server.\"),\n\t\t\t\t\t'default': 'off',\n\t\t\t\t\t'tags': ['accessibility']\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handleKeywordActivation(): void {\n\t\tconst enabled =\n\t\t\tsupportsKeywordActivation(this.configurationService, this.speechService, this.chatAgentService) &&\n\t\t\t!this.speechService.hasActiveSpeechToTextSession;\n\t\tif (\n\t\t\t(enabled && this.activeSession) ||\n\t\t\t(!enabled && !this.activeSession)\n\t\t) {\n\t\t\treturn; // already running or stopped\n\t\t}\n\n\t\t// Start keyword activation\n\t\tif (enabled) {\n\t\t\tthis.enableKeywordActivation();\n\t\t}\n\n\t\t// Stop keyword activation\n\t\telse {\n\t\t\tthis.disableKeywordActivation();\n\t\t}\n\t}\n\n\tprivate async enableKeywordActivation(): Promise<void> {\n\t\tconst session = this.activeSession = new CancellationTokenSource();\n\t\tconst result = await this.speechService.recognizeKeyword(session.token);\n\t\tif (session.token.isCancellationRequested || session !== this.activeSession) {\n\t\t\treturn; // cancelled\n\t\t}\n\n\t\tthis.activeSession = undefined;\n\n\t\tif (result === KeywordRecognitionStatus.Recognized) {\n\t\t\tif (this.hostService.hasFocus) {\n\t\t\t\tthis.commandService.executeCommand(this.getKeywordCommand());\n\t\t\t}\n\n\t\t\t// Immediately start another keyboard activation session\n\t\t\t// because we cannot assume that the command we execute\n\t\t\t// will trigger a speech recognition session.\n\n\t\t\tthis.handleKeywordActivation();\n\t\t}\n\t}\n\n\tprivate getKeywordCommand(): string {\n\t\tconst setting = this.configurationService.getValue(KEYWORD_ACTIVIATION_SETTING_ID);\n\t\tswitch (setting) {\n\t\t\tcase KeywordActivationContribution.SETTINGS_VALUE.INLINE_CHAT:\n\t\t\t\treturn InlineVoiceChatAction.ID;\n\t\t\tcase KeywordActivationContribution.SETTINGS_VALUE.QUICK_CHAT:\n\t\t\t\treturn QuickVoiceChatAction.ID;\n\t\t\tcase KeywordActivationContribution.SETTINGS_VALUE.CHAT_IN_CONTEXT: {\n\t\t\t\tconst activeCodeEditor = getCodeEditor(this.editorService.activeTextEditorControl);\n\t\t\t\tif (activeCodeEditor?.hasWidgetFocus()) {\n\t\t\t\t\treturn InlineVoiceChatAction.ID;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn VoiceChatInChatViewAction.ID;\n\t\t}\n\t}\n\n\tprivate disableKeywordActivation(): void {\n\t\tthis.activeSession?.dispose(true);\n\t\tthis.activeSession = undefined;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.activeSession?.dispose();\n\n\t\tsuper.dispose();\n\t}\n}\n\nclass KeywordActivationStatusEntry extends Disposable {\n\n\tprivate readonly entry = this._register(new MutableDisposable<IStatusbarEntryAccessor>());\n\n\tprivate static STATUS_NAME = localize('keywordActivation.status.name', \"Voice Keyword Activation\");\n\tprivate static STATUS_COMMAND = 'keywordActivation.status.command';\n\tprivate static STATUS_ACTIVE = localize('keywordActivation.status.active', \"Listening to 'Hey Code'...\");\n\tprivate static STATUS_INACTIVE = localize('keywordActivation.status.inactive', \"Waiting for voice chat to end...\");\n\n\tconstructor(\n\t\t@ISpeechService private readonly speechService: ISpeechService,\n\t\t@IStatusbarService private readonly statusbarService: IStatusbarService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IChatAgentService private readonly chatAgentService: IChatAgentService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(CommandsRegistry.registerCommand(KeywordActivationStatusEntry.STATUS_COMMAND, () => this.commandService.executeCommand('workbench.action.openSettings', KEYWORD_ACTIVIATION_SETTING_ID)));\n\n\t\tthis.registerListeners();\n\t\tthis.updateStatusEntry();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(this.speechService.onDidStartKeywordRecognition(() => this.updateStatusEntry()));\n\t\tthis._register(this.speechService.onDidEndKeywordRecognition(() => this.updateStatusEntry()));\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(KEYWORD_ACTIVIATION_SETTING_ID)) {\n\t\t\t\tthis.updateStatusEntry();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateStatusEntry(): void {\n\t\tconst visible = supportsKeywordActivation(this.configurationService, this.speechService, this.chatAgentService);\n\t\tif (visible) {\n\t\t\tif (!this.entry.value) {\n\t\t\t\tthis.createStatusEntry();\n\t\t\t}\n\n\t\t\tthis.updateStatusLabel();\n\t\t} else {\n\t\t\tthis.entry.clear();\n\t\t}\n\t}\n\n\tprivate createStatusEntry() {\n\t\tthis.entry.value = this.statusbarService.addEntry(this.getStatusEntryProperties(), 'status.voiceKeywordActivation', StatusbarAlignment.RIGHT, 103);\n\t}\n\n\tprivate getStatusEntryProperties(): IStatusbarEntry {\n\t\treturn {\n\t\t\tname: KeywordActivationStatusEntry.STATUS_NAME,\n\t\t\ttext: this.speechService.hasActiveKeywordRecognition ? '$(mic-filled)' : '$(mic)',\n\t\t\ttooltip: this.speechService.hasActiveKeywordRecognition ? KeywordActivationStatusEntry.STATUS_ACTIVE : KeywordActivationStatusEntry.STATUS_INACTIVE,\n\t\t\tariaLabel: this.speechService.hasActiveKeywordRecognition ? KeywordActivationStatusEntry.STATUS_ACTIVE : KeywordActivationStatusEntry.STATUS_INACTIVE,\n\t\t\tcommand: KeywordActivationStatusEntry.STATUS_COMMAND,\n\t\t\tkind: 'prominent',\n\t\t\tshowInAllWindows: true\n\t\t};\n\t}\n\n\tprivate updateStatusLabel(): void {\n\t\tthis.entry.value?.update(this.getStatusEntryProperties());\n\t}\n}\n\n//#endregion\n\nregisterThemingParticipant((theme, collector) => {\n\tlet activeRecordingColor: Color | undefined;\n\tlet activeRecordingDimmedColor: Color | undefined;\n\tif (!isHighContrast(theme.type)) {\n\t\tactiveRecordingColor = theme.getColor(ACTIVITY_BAR_BADGE_BACKGROUND) ?? theme.getColor(focusBorder);\n\t\tactiveRecordingDimmedColor = activeRecordingColor?.transparent(0.38);\n\t} else {\n\t\tactiveRecordingColor = theme.getColor(contrastBorder);\n\t\tactiveRecordingDimmedColor = theme.getColor(contrastBorder);\n\t}\n\n\t// Show a \"microphone\" or \"pulse\" icon when speech-to-text or text-to-speech is in progress that glows via outline.\n\tcollector.addRule(`\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-sync.codicon-modifier-spin:not(.disabled),\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-loading.codicon-modifier-spin:not(.disabled) {\n\t\t\tcolor: ${activeRecordingColor};\n\t\t\toutline: 1px solid ${activeRecordingColor};\n\t\t\toutline-offset: -1px;\n\t\t\tanimation: pulseAnimation 1s infinite;\n\t\t\tborder-radius: 50%;\n\t\t}\n\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-sync.codicon-modifier-spin:not(.disabled)::before,\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-loading.codicon-modifier-spin:not(.disabled)::before {\n\t\t\tposition: absolute;\n\t\t\toutline: 1px solid ${activeRecordingColor};\n\t\t\toutline-offset: 2px;\n\t\t\tborder-radius: 50%;\n\t\t\twidth: 16px;\n\t\t\theight: 16px;\n\t\t}\n\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-sync.codicon-modifier-spin:not(.disabled)::after,\n\t\t.monaco-workbench.monaco-enable-motion .interactive-input-part .monaco-action-bar .action-label.codicon-loading.codicon-modifier-spin:not(.disabled)::after {\n\t\t\toutline: 2px solid ${activeRecordingColor};\n\t\t\toutline-offset: -1px;\n\t\t\tanimation: pulseAnimation 1500ms cubic-bezier(0.75, 0, 0.25, 1) infinite;\n\t\t}\n\n\t\t@keyframes pulseAnimation {\n\t\t\t0% {\n\t\t\t\toutline-width: 2px;\n\t\t\t}\n\t\t\t62% {\n\t\t\t\toutline-width: 5px;\n\t\t\t\toutline-color: ${activeRecordingDimmedColor};\n\t\t\t}\n\t\t\t100% {\n\t\t\t\toutline-width: 2px;\n\t\t\t}\n\t\t}\n\t`);\n});\n"]}