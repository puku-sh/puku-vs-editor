{"version":3,"sources":["vs/workbench/contrib/chat/electron-browser/chat.contribution.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAClE,OAAO,EAAE,OAAO,EAAE,MAAM,uCAAuC,CAAC;AAChE,OAAO,EAAE,OAAO,EAAE,MAAM,iCAAiC,CAAC;AAC1D,OAAO,EAAE,WAAW,EAAE,MAAM,qCAAqC,CAAC;AAClE,OAAO,EAAE,GAAG,EAAE,MAAM,gCAAgC,CAAC;AACrD,OAAO,EAAE,WAAW,EAAE,MAAM,4DAA4D,CAAC;AACzF,OAAO,EAAE,QAAQ,EAAE,MAAM,oBAAoB,CAAC;AAC9C,OAAO,EAAE,eAAe,EAAE,MAAM,gDAAgD,CAAC;AACjF,OAAO,EAAE,eAAe,EAAE,MAAM,kDAAkD,CAAC;AACnF,OAAO,EAAE,kBAAkB,EAAE,MAAM,sDAAsD,CAAC;AAC1F,OAAO,EAAE,cAAc,EAAE,MAAM,gDAAgD,CAAC;AAChF,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,kBAAkB,EAAE,MAAM,8CAA8C,CAAC;AAClF,OAAO,EAAE,6BAA6B,EAAE,MAAM,yDAAyD,CAAC;AACxG,OAAO,EAA0C,8BAA8B,EAAE,MAAM,kCAAkC,CAAC;AAE1H,OAAO,EAAE,kCAAkC,EAAE,MAAM,sEAAsE,CAAC;AAC1H,OAAO,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACtF,OAAO,EAAE,uBAAuB,EAAE,MAAM,mDAAmD,CAAC;AAC5F,OAAO,EAAE,iBAAiB,EAAkB,MAAM,iDAAiD,CAAC;AACpG,OAAO,EAAE,kBAAkB,EAAE,mBAAmB,EAAwB,MAAM,mCAAmC,CAAC;AAClH,OAAO,EAAE,kBAAkB,EAAE,MAAM,oBAAoB,CAAC;AACxD,OAAO,EAAE,eAAe,EAAE,MAAM,8BAA8B,CAAC;AAC/D,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AACxD,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AACnG,OAAO,EAAE,YAAY,EAAE,MAAM,wBAAwB,CAAC;AACtD,OAAO,EAAE,sCAAsC,EAAE,MAAM,oDAAoD,CAAC;AAC5G,OAAO,EAAE,0BAA0B,EAAE,MAAM,wCAAwC,CAAC;AACpF,OAAO,EAAE,0BAA0B,EAAE,MAAM,0BAA0B,CAAC;AACtE,OAAO,EAAE,4BAA4B,EAAE,MAAM,mCAAmC,CAAC;AACjF,OAAO,EAAE,+BAA+B,EAAE,qBAAqB,EAAE,6BAA6B,EAAE,oBAAoB,EAAE,qBAAqB,EAAE,oBAAoB,EAAE,mBAAmB,EAAE,4BAA4B,EAAE,aAAa,EAAE,qBAAqB,EAAE,yBAAyB,EAAE,MAAM,+BAA+B,CAAC;AAC7T,OAAO,EAAE,gBAAgB,EAAE,oBAAoB,EAA2B,MAAM,0BAA0B,CAAC;AAE3G,IAAM,8BAA8B,GAApC,MAAM,8BAA+B,SAAQ,UAAU;aAEtC,OAAE,GAAG,yBAAH,AAA4B,CAAC;IAE/C,YAC6B,YAAwC,EAC7C,oBAA2C,EAC1B,mBAA2D;QAEnG,KAAK,EAAE,CAAC;QAER,MAAM,QAAQ,GAAG,oBAAoB,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC;QACvE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,oBAAoB,EAAE,QAAQ,CAAC,CAAC,CAAC;QAE1E,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,gCAAgC,CAClE,0BAA0B,EAC1B,oBAAoB,CAAC,cAAc,CAClC,uCAAuC,EACvC,MAAM,CAAC,EAAE,CAAE,MAAkC,CAAC,IAAI,CAClD,CACD,CAAC,CAAC;IACJ,CAAC;;AArBI,8BAA8B;IAKjC,WAAA,0BAA0B,CAAA;IAC1B,WAAA,qBAAqB,CAAA;IACrB,WAAA,sCAAsC,CAAA;GAPnC,8BAA8B,CAsBnC;AAED,IAAM,sBAAsB,GAA5B,MAAM,sBAAuB,SAAQ,UAAU;aAE9B,OAAE,GAAG,0CAAH,AAA6C,CAAC;IAEhE,YACsD,kBAAsD,EACzE,cAA+B,EACjB,4BAA2D,EAC7E,UAAuB,EACX,aAAsC,EAC3C,iBAAqC;QAE1E,KAAK,EAAE,CAAC;QAP6C,uBAAkB,GAAlB,kBAAkB,CAAoC;QACzE,mBAAc,GAAd,cAAc,CAAiB;QACjB,iCAA4B,GAA5B,4BAA4B,CAA+B;QAC7E,eAAU,GAAV,UAAU,CAAa;QACX,kBAAa,GAAb,aAAa,CAAyB;QAC3C,sBAAiB,GAAjB,iBAAiB,CAAoB;QAI1E,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC1B,CAAC;IAEO,iBAAiB;QACxB,WAAW,CAAC,EAAE,CAAC,0BAA0B,EAAE,CAAC,CAAC,EAAE,GAAG,IAAe,EAAE,EAAE;YACpE,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAA6C,CAAC;YACrE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,0BAA0B,EAAE,QAAQ,CAAC,CAAC;YAE5D,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,KAAK,CAAC,MAAM,CAAC,IAA8C;QAClE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC;YAC7B,OAAO;QACR,CAAC;QAED,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,4BAA4B,CAAC,qBAAqB,CAAC;YAC7E,OAAO,EAAE,QAAQ,CAAC,IAAuB,EAAE,IAAiE,CAAC;SAC7G,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,OAAO;QACR,CAAC;QAED,MAAM,IAAI,GAAyB;YAClC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;YAChD,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,YAAY,CAAC,KAAK;YACrC,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,qDAAqD;SAC1H,CAAC;QAEF,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YACnB,MAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,CAAwB,eAAe,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;YACrH,IAAI,QAAQ,+CAAuC,EAAE,CAAC;gBACrD,IAAI,CAAC,aAAa,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;YACnD,CAAC;iBAAM,IAAI,QAAQ,wCAAgC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,gBAAgB,EAAE,EAAE,CAAC;gBAC/F,IAAI,CAAC,aAAa,CAAC,oBAAoB,EAAE,CAAC;YAC3C,CAAC;QACF,CAAC;QAED,MAAM,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC;QAC7D,MAAM,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;IACrE,CAAC;;AAxDI,sBAAsB;IAKzB,WAAA,kCAAkC,CAAA;IAClC,WAAA,eAAe,CAAA;IACf,WAAA,6BAA6B,CAAA;IAC7B,WAAA,WAAW,CAAA;IACX,WAAA,uBAAuB,CAAA;IACvB,WAAA,kBAAkB,CAAA;GAVf,sBAAsB,CAyD3B;AAED,IAAM,4BAA4B,GAAlC,MAAM,4BAA6B,SAAQ,UAAU;aAEpC,OAAE,GAAG,gDAAH,AAAmD,CAAC;IAEtE,YACqB,iBAAqC,EAC3C,WAAyB;QAEvC,KAAK,EAAE,CAAC;QAER,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YAC/B,MAAM,OAAO,GAAG,WAAW,CAAC,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAE9D,qEAAqE;YACrE,kEAAkE;YAClE,wCAAwC;YACxC,iBAAiB,CAAC,uBAAuB,CAAC,CAAC,OAAO,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;;AAlBI,4BAA4B;IAK/B,WAAA,kBAAkB,CAAA;IAClB,WAAA,YAAY,CAAA;GANT,4BAA4B,CAmBjC;AAED,IAAM,oBAAoB,GAA1B,MAAM,oBAAqB,SAAQ,UAAU;aAE5B,OAAE,GAAG,wCAAH,AAA2C,CAAC;IAE9D,YACoB,gBAAmC,EACvB,WAAyB,EACvB,aAA6B,EACzB,aAAiC,EACjC,iBAAqC,EACvD,gBAAmC;QAEtD,KAAK,EAAE,CAAC;QANuB,gBAAW,GAAX,WAAW,CAAc;QACvB,kBAAa,GAAb,aAAa,CAAgB;QACzB,kBAAa,GAAb,aAAa,CAAoB;QACjC,sBAAiB,GAAjB,iBAAiB,CAAoB;QAK1E,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE;YACpD,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,WAAW,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC,CAAC;QAEJ,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YAC9C,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,EAAE,EAAE,QAAQ,CAAC,IAAuB,EAAE,IAAgC,CAAC,CAAC,CAAC;QAC1H,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,kBAAkB,CAAC,MAAsB;QAChD,MAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACtE,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,OAAO,KAAK,CAAC;QACd,CAAC;QAED,IAAI,eAAe,CAAC,gCAAgC,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,KAAK,IAAI,EAAE,CAAC;YAChG,OAAO,KAAK,CAAC;QACd,CAAC;QAED,OAAO,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;IAC1C,CAAC;IAEO,KAAK,CAAC,oBAAoB,CAAC,MAAsB;QAExD,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC;QAElC,IAAI,OAAe,CAAC;QACpB,IAAI,MAAc,CAAC;QACnB,QAAQ,MAAM,EAAE,CAAC;YAChB;gBACC,OAAO,GAAG,QAAQ,CAAC,IAAwB,EAAE,IAA2E,CAAC,CAAC;gBAC1H,MAAM,GAAG,QAAQ,CAAC,IAAuB,EAAE,IAAqD,CAAC,CAAC;gBAClG,MAAM;YACP;gBACC,OAAO,GAAG,QAAQ,CAAC,IAAyB,EAAE,IAA+E,CAAC,CAAC;gBAC/H,MAAM,GAAG,QAAQ,CAAC,IAAwB,EAAE,IAAyD,CAAC,CAAC;gBACvG,MAAM;YACP;gBACC,OAAO,GAAG,QAAQ,CAAC,IAAyB,EAAE,IAA4E,CAAC,CAAC;gBAC5H,MAAM,GAAG,QAAQ,CAAC,IAAwB,EAAE,IAAsD,CAAC,CAAC;gBACpG,MAAM;YACP;gBACC,OAAO,GAAG,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAc,EAAE,IAA+D,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAc,EAAE,IAA+D,CAAC,CAAC;gBAC9M,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAa,EAAE,IAAyC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAa,EAAE,IAAyC,CAAC,CAAC;gBAC/J,MAAM;QACR,CAAC;QAED,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;QAErE,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC;IAC1B,CAAC;;AAhEI,oBAAoB;IAKvB,WAAA,iBAAiB,CAAA;IACjB,WAAA,YAAY,CAAA;IACZ,WAAA,cAAc,CAAA;IACd,WAAA,kBAAkB,CAAA;IAClB,WAAA,kBAAkB,CAAA;IAClB,WAAA,iBAAiB,CAAA;GAVd,oBAAoB,CAiEzB;AAED,eAAe,CAAC,oBAAoB,CAAC,CAAC;AAEtC,eAAe,CAAC,yBAAyB,CAAC,CAAC;AAC3C,eAAe,CAAC,+BAA+B,CAAC,CAAC;AACjD,eAAe,CAAC,oBAAoB,CAAC,CAAC;AACtC,eAAe,CAAC,qBAAqB,CAAC,CAAC;AAEvC,eAAe,CAAC,mBAAmB,CAAC,CAAC;AACrC,eAAe,CAAC,4BAA4B,CAAC,CAAC;AAE9C,eAAe,CAAC,qBAAqB,CAAC,CAAC;AACvC,eAAe,CAAC,qBAAqB,CAAC,CAAC;AACvC,eAAe,CAAC,aAAa,CAAC,CAAC;AAE/B,4BAA4B,EAAE,CAAC;AAE/B,8BAA8B,CAAC,6BAA6B,CAAC,EAAE,EAAE,6BAA6B,uCAA+B,CAAC;AAC9H,8BAA8B,CAAC,8BAA8B,CAAC,EAAE,EAAE,8BAA8B,uCAA+B,CAAC;AAChI,8BAA8B,CAAC,sBAAsB,CAAC,EAAE,EAAE,sBAAsB,sCAA8B,CAAC;AAC/G,8BAA8B,CAAC,4BAA4B,CAAC,EAAE,EAAE,4BAA4B,uCAA+B,CAAC;AAC5H,8BAA8B,CAAC,oBAAoB,CAAC,EAAE,EAAE,oBAAoB,uCAA+B,CAAC","file":"chat.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun } from '../../../../base/common/observable.js';\nimport { resolve } from '../../../../base/common/path.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ipcRenderer } from '../../../../base/parts/sandbox/electron-browser/globals.js';\nimport { localize } from '../../../../nls.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { IWorkspaceTrustRequestService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { IWorkbenchContribution, WorkbenchPhase, registerWorkbenchContribution2 } from '../../../common/contributions.js';\nimport { ViewContainerLocation } from '../../../common/views.js';\nimport { INativeWorkbenchEnvironmentService } from '../../../services/environment/electron-browser/environmentService.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\nimport { IWorkbenchLayoutService } from '../../../services/layout/browser/layoutService.js';\nimport { ILifecycleService, ShutdownReason } from '../../../services/lifecycle/common/lifecycle.js';\nimport { ACTION_ID_NEW_CHAT, CHAT_OPEN_ACTION_ID, IChatViewOpenOptions } from '../browser/actions/chatActions.js';\nimport { IChatWidgetService } from '../browser/chat.js';\nimport { ChatContextKeys } from '../common/chatContextKeys.js';\nimport { IChatService } from '../common/chatService.js';\nimport { ChatUrlFetchingConfirmationContribution } from '../common/chatUrlFetchingConfirmation.js';\nimport { ChatModeKind } from '../common/constants.js';\nimport { ILanguageModelToolsConfirmationService } from '../common/languageModelToolsConfirmationService.js';\nimport { ILanguageModelToolsService } from '../common/languageModelToolsService.js';\nimport { InternalFetchWebPageToolId } from '../common/tools/tools.js';\nimport { registerChatDeveloperActions } from './actions/chatDeveloperActions.js';\nimport { HoldToVoiceChatInChatViewAction, InlineVoiceChatAction, KeywordActivationContribution, QuickVoiceChatAction, ReadChatResponseAloud, StartVoiceChatAction, StopListeningAction, StopListeningAndSubmitAction, StopReadAloud, StopReadChatItemAloud, VoiceChatInChatViewAction } from './actions/voiceChatActions.js';\nimport { FetchWebPageTool, FetchWebPageToolData, IFetchWebPageToolParams } from './tools/fetchPageTool.js';\n\nclass NativeBuiltinToolsContribution extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'chat.nativeBuiltinTools';\n\n\tconstructor(\n\t\t@ILanguageModelToolsService toolsService: ILanguageModelToolsService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ILanguageModelToolsConfirmationService confirmationService: ILanguageModelToolsConfirmationService,\n\t) {\n\t\tsuper();\n\n\t\tconst editTool = instantiationService.createInstance(FetchWebPageTool);\n\t\tthis._register(toolsService.registerTool(FetchWebPageToolData, editTool));\n\n\t\tthis._register(confirmationService.registerConfirmationContribution(\n\t\t\tInternalFetchWebPageToolId,\n\t\t\tinstantiationService.createInstance(\n\t\t\t\tChatUrlFetchingConfirmationContribution,\n\t\t\t\tparams => (params as IFetchWebPageToolParams).urls\n\t\t\t)\n\t\t));\n\t}\n}\n\nclass ChatCommandLineHandler extends Disposable {\n\n\tstatic readonly ID = 'workbench.contrib.chatCommandLineHandler';\n\n\tconstructor(\n\t\t@INativeWorkbenchEnvironmentService private readonly environmentService: INativeWorkbenchEnvironmentService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IWorkspaceTrustRequestService private readonly workspaceTrustRequestService: IWorkspaceTrustRequestService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners() {\n\t\tipcRenderer.on('vscode:handleChatRequest', (_, ...args: unknown[]) => {\n\t\t\tconst chatArgs = args[0] as typeof this.environmentService.args.chat;\n\t\t\tthis.logService.trace('vscode:handleChatRequest', chatArgs);\n\n\t\t\tthis.prompt(chatArgs);\n\t\t});\n\t}\n\n\tprivate async prompt(args: typeof this.environmentService.args.chat): Promise<void> {\n\t\tif (!Array.isArray(args?._)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst trusted = await this.workspaceTrustRequestService.requestWorkspaceTrust({\n\t\t\tmessage: localize('copilotWorkspaceTrust', \"AI features are currently only supported in trusted workspaces.\")\n\t\t});\n\n\t\tif (!trusted) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst opts: IChatViewOpenOptions = {\n\t\t\tquery: args._.length > 0 ? args._.join(' ') : '',\n\t\t\tmode: args.mode ?? ChatModeKind.Agent,\n\t\t\tattachFiles: args['add-file']?.map(file => URI.file(resolve(file))), // use `resolve` to deal with relative paths properly\n\t\t};\n\n\t\tif (args.maximize) {\n\t\t\tconst location = this.contextKeyService.getContextKeyValue<ViewContainerLocation>(ChatContextKeys.panelLocation.key);\n\t\t\tif (location === ViewContainerLocation.AuxiliaryBar) {\n\t\t\t\tthis.layoutService.setAuxiliaryBarMaximized(true);\n\t\t\t} else if (location === ViewContainerLocation.Panel && !this.layoutService.isPanelMaximized()) {\n\t\t\t\tthis.layoutService.toggleMaximizedPanel();\n\t\t\t}\n\t\t}\n\n\t\tawait this.commandService.executeCommand(ACTION_ID_NEW_CHAT);\n\t\tawait this.commandService.executeCommand(CHAT_OPEN_ACTION_ID, opts);\n\t}\n}\n\nclass ChatSuspendThrottlingHandler extends Disposable {\n\n\tstatic readonly ID = 'workbench.contrib.chatSuspendThrottlingHandler';\n\n\tconstructor(\n\t\t@INativeHostService nativeHostService: INativeHostService,\n\t\t@IChatService chatService: IChatService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(autorun(reader => {\n\t\t\tconst running = chatService.requestInProgressObs.read(reader);\n\n\t\t\t// When a chat request is in progress, we must ensure that background\n\t\t\t// throttling is not applied so that the chat session can continue\n\t\t\t// even when the window is not in focus.\n\t\t\tnativeHostService.setBackgroundThrottling(!running);\n\t\t}));\n\t}\n}\n\nclass ChatLifecycleHandler extends Disposable {\n\n\tstatic readonly ID = 'workbench.contrib.chatLifecycleHandler';\n\n\tconstructor(\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IChatService private readonly chatService: IChatService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IChatWidgetService private readonly widgetService: IChatWidgetService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(lifecycleService.onBeforeShutdown(e => {\n\t\t\te.veto(this.shouldVetoShutdown(e.reason), 'veto.chat');\n\t\t}));\n\n\t\tthis._register(extensionService.onWillStop(e => {\n\t\t\te.veto(this.chatService.requestInProgressObs.get(), localize('chatRequestInProgress', \"A chat request is in progress.\"));\n\t\t}));\n\t}\n\n\tprivate shouldVetoShutdown(reason: ShutdownReason): boolean | Promise<boolean> {\n\t\tconst running = this.chatService.requestInProgressObs.read(undefined);\n\t\tif (!running) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (ChatContextKeys.skipChatRequestInProgressMessage.getValue(this.contextKeyService) === true) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.doShouldVetoShutdown(reason);\n\t}\n\n\tprivate async doShouldVetoShutdown(reason: ShutdownReason): Promise<boolean> {\n\n\t\tthis.widgetService.revealWidget();\n\n\t\tlet message: string;\n\t\tlet detail: string;\n\t\tswitch (reason) {\n\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\tmessage = localize('closeTheWindow.message', \"A chat request is in progress. Are you sure you want to close the window?\");\n\t\t\t\tdetail = localize('closeTheWindow.detail', \"The chat request will stop if you close the window.\");\n\t\t\t\tbreak;\n\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\tmessage = localize('changeWorkspace.message', \"A chat request is in progress. Are you sure you want to change the workspace?\");\n\t\t\t\tdetail = localize('changeWorkspace.detail', \"The chat request will stop if you change the workspace.\");\n\t\t\t\tbreak;\n\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\tmessage = localize('reloadTheWindow.message', \"A chat request is in progress. Are you sure you want to reload the window?\");\n\t\t\t\tdetail = localize('reloadTheWindow.detail', \"The chat request will stop if you reload the window.\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmessage = isMacintosh ? localize('quit.message', \"A chat request is in progress. Are you sure you want to quit?\") : localize('exit.message', \"A chat request is in progress. Are you sure you want to exit?\");\n\t\t\t\tdetail = isMacintosh ? localize('quit.detail', \"The chat request will stop if you quit.\") : localize('exit.detail', \"The chat request will stop if you exit.\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst result = await this.dialogService.confirm({ message, detail });\n\n\t\treturn !result.confirmed;\n\t}\n}\n\nregisterAction2(StartVoiceChatAction);\n\nregisterAction2(VoiceChatInChatViewAction);\nregisterAction2(HoldToVoiceChatInChatViewAction);\nregisterAction2(QuickVoiceChatAction);\nregisterAction2(InlineVoiceChatAction);\n\nregisterAction2(StopListeningAction);\nregisterAction2(StopListeningAndSubmitAction);\n\nregisterAction2(ReadChatResponseAloud);\nregisterAction2(StopReadChatItemAloud);\nregisterAction2(StopReadAloud);\n\nregisterChatDeveloperActions();\n\nregisterWorkbenchContribution2(KeywordActivationContribution.ID, KeywordActivationContribution, WorkbenchPhase.AfterRestored);\nregisterWorkbenchContribution2(NativeBuiltinToolsContribution.ID, NativeBuiltinToolsContribution, WorkbenchPhase.AfterRestored);\nregisterWorkbenchContribution2(ChatCommandLineHandler.ID, ChatCommandLineHandler, WorkbenchPhase.BlockRestore);\nregisterWorkbenchContribution2(ChatSuspendThrottlingHandler.ID, ChatSuspendThrottlingHandler, WorkbenchPhase.AfterRestored);\nregisterWorkbenchContribution2(ChatLifecycleHandler.ID, ChatLifecycleHandler, WorkbenchPhase.AfterRestored);\n"]}