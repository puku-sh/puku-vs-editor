{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatSessions.contribution.ts"],"names":[],"mappings":"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","file":"chatSessions.contribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { sep } from '../../../../base/common/path.js';\nimport { raceCancellationError } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableMap, DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Action2, IMenuService, MenuId, MenuItemAction, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IRelaxedExtensionDescription } from '../../../../platform/extensions/common/extensions.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { isDark } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IEditableData } from '../../../common/views.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IExtensionService, isProposedApiEnabled } from '../../../services/extensions/common/extensions.js';\nimport { ExtensionsRegistry } from '../../../services/extensions/common/extensionsRegistry.js';\nimport { ChatEditorInput } from '../browser/chatEditorInput.js';\nimport { IChatAgentAttachmentCapabilities, IChatAgentData, IChatAgentRequest, IChatAgentService } from '../common/chatAgents.js';\nimport { ChatContextKeys } from '../common/chatContextKeys.js';\nimport { ChatSessionStatus, IChatSession, IChatSessionContentProvider, IChatSessionItem, IChatSessionItemProvider, IChatSessionProviderOptionGroup, IChatSessionProviderOptionItem, IChatSessionsExtensionPoint, IChatSessionsService, localChatSessionType, SessionOptionsChangedCallback } from '../common/chatSessionsService.js';\nimport { LEGACY_AGENT_SESSIONS_VIEW_ID, ChatAgentLocation, ChatModeKind } from '../common/constants.js';\nimport { CHAT_CATEGORY } from './actions/chatActions.js';\nimport { IChatEditorOptions } from './chatEditor.js';\nimport { NEW_CHAT_SESSION_ACTION_ID } from './chatSessions/common.js';\n\nconst extensionPoint = ExtensionsRegistry.registerExtensionPoint<IChatSessionsExtensionPoint[]>({\n\textensionPoint: 'chatSessions',\n\tjsonSchema: {\n\t\tdescription: localize('chatSessionsExtPoint', 'Contributes chat session integrations to the chat widget.'),\n\t\ttype: 'array',\n\t\titems: {\n\t\t\ttype: 'object',\n\t\t\tadditionalProperties: false,\n\t\t\tproperties: {\n\t\t\t\ttype: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.chatSessionType', 'Unique identifier for the type of chat session.'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\tname: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.name', 'Name of the dynamically registered chat participant (eg: @agent). Must not contain whitespace.'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tpattern: '^[\\\\w-]+$'\n\t\t\t\t},\n\t\t\t\tdisplayName: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.displayName', 'A longer name for this item which is used for display in menus.'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\tdescription: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.description', 'Description of the chat session for use in menus and tooltips.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\twhen: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.when', 'Condition which must be true to show this item.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\ticon: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.icon', 'Icon identifier (codicon ID) for the chat session editor tab. For example, \"$(github)\" or \"$(cloud)\".'),\n\t\t\t\t\tanyOf: [{\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tlight: {\n\t\t\t\t\t\t\t\tdescription: localize('icon.light', 'Icon path when a light theme is used'),\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdark: {\n\t\t\t\t\t\t\t\tdescription: localize('icon.dark', 'Icon path when a dark theme is used'),\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\torder: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.order', 'Order in which this item should be displayed.'),\n\t\t\t\t\ttype: 'integer'\n\t\t\t\t},\n\t\t\t\talternativeIds: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.alternativeIds', 'Alternative identifiers for backward compatibility.'),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\twelcomeTitle: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.welcomeTitle', 'Title text to display in the chat welcome view for this session type.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\twelcomeMessage: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.welcomeMessage', 'Message text (supports markdown) to display in the chat welcome view for this session type.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\twelcomeTips: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.welcomeTips', 'Tips text (supports markdown and theme icons) to display in the chat welcome view for this session type.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\tinputPlaceholder: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.inputPlaceholder', 'Placeholder text to display in the chat input box for this session type.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\tcapabilities: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.capabilities', 'Optional capabilities for this chat session.'),\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tadditionalProperties: false,\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tsupportsFileAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsFileAttachments', 'Whether this chat session supports attaching files or file references.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsToolAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsToolAttachments', 'Whether this chat session supports attaching tools or tool references.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsMCPAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsMCPAttachments', 'Whether this chat session supports attaching MCP resources.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsImageAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsImageAttachments', 'Whether this chat session supports attaching images.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsSearchResultAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsSearchResultAttachments', 'Whether this chat session supports attaching search results.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsInstructionAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsInstructionAttachments', 'Whether this chat session supports attaching instructions.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsSourceControlAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsSourceControlAttachments', 'Whether this chat session supports attaching source control changes.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsProblemAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsProblemAttachments', 'Whether this chat session supports attaching problems.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupportsSymbolAttachments: {\n\t\t\t\t\t\t\tdescription: localize('chatSessionsExtPoint.supportsSymbolAttachments', 'Whether this chat session supports attaching symbols.'),\n\t\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\tmarkdownDescription: localize('chatCommandsDescription', \"Commands available for this chat session, which the user can invoke with a `/`.\"),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\tadditionalProperties: false,\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tdefaultSnippets: [{ body: { name: '', description: '' } }],\n\t\t\t\t\t\trequired: ['name'],\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tname: {\n\t\t\t\t\t\t\t\tdescription: localize('chatCommand', \"A short name by which this command is referred to in the UI, e.g. `fix` or `explain` for commands that fix an issue or explain code. The name should be unique among the commands provided by this participant.\"),\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdescription: {\n\t\t\t\t\t\t\t\tdescription: localize('chatCommandDescription', \"A description of this command.\"),\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twhen: {\n\t\t\t\t\t\t\t\tdescription: localize('chatCommandWhen', \"A condition which must be true to enable this command.\"),\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcanDelegate: {\n\t\t\t\t\tdescription: localize('chatSessionsExtPoint.canDelegate', 'Whether delegation is supported. Defaults to true.'),\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true\n\t\t\t\t}\n\t\t\t},\n\t\t\trequired: ['type', 'name', 'displayName', 'description'],\n\t\t}\n\t},\n\tactivationEventsGenerator: function* (contribs) {\n\t\tfor (const contrib of contribs) {\n\t\t\tyield `onChatSession:${contrib.type}`;\n\t\t}\n\t}\n});\n\nclass ContributedChatSessionData extends Disposable {\n\n\tprivate readonly _optionsCache: Map<string /* 'models' */, string | IChatSessionProviderOptionItem>;\n\tpublic getOption(optionId: string): string | IChatSessionProviderOptionItem | undefined {\n\t\treturn this._optionsCache.get(optionId);\n\t}\n\tpublic setOption(optionId: string, value: string | IChatSessionProviderOptionItem): void {\n\t\tthis._optionsCache.set(optionId, value);\n\t}\n\n\tconstructor(\n\t\treadonly session: IChatSession,\n\t\treadonly chatSessionType: string,\n\t\treadonly resource: URI,\n\t\treadonly options: Record<string, string | IChatSessionProviderOptionItem> | undefined,\n\t\tprivate readonly onWillDispose: (resource: URI) => void\n\t) {\n\t\tsuper();\n\n\t\tthis._optionsCache = new Map<string, string | IChatSessionProviderOptionItem>();\n\t\tif (options) {\n\t\t\tfor (const [key, value] of Object.entries(options)) {\n\t\t\t\tthis._optionsCache.set(key, value);\n\t\t\t}\n\t\t}\n\n\t\tthis._register(this.session.onWillDispose(() => {\n\t\t\tthis.onWillDispose(this.resource);\n\t\t}));\n\t}\n}\n\n\nexport class ChatSessionsService extends Disposable implements IChatSessionsService {\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _itemsProviders: Map</* type */ string, IChatSessionItemProvider> = new Map();\n\n\tprivate readonly _contributions: Map</* type */ string, { readonly contribution: IChatSessionsExtensionPoint; readonly extension: IRelaxedExtensionDescription }> = new Map();\n\tprivate readonly _contributionDisposables = this._register(new DisposableMap</* type */ string>());\n\n\tprivate readonly _contentProviders: Map</* scheme */ string, IChatSessionContentProvider> = new Map();\n\tprivate readonly _alternativeIdMap: Map</* alternativeId */ string, /* primaryType */ string> = new Map();\n\tprivate readonly _contextKeys = new Set<string>();\n\n\tprivate readonly _onDidChangeItemsProviders = this._register(new Emitter<IChatSessionItemProvider>());\n\treadonly onDidChangeItemsProviders: Event<IChatSessionItemProvider> = this._onDidChangeItemsProviders.event;\n\n\tprivate readonly _onDidChangeSessionItems = this._register(new Emitter<string>());\n\treadonly onDidChangeSessionItems: Event<string> = this._onDidChangeSessionItems.event;\n\n\tprivate readonly _onDidChangeAvailability = this._register(new Emitter<void>());\n\treadonly onDidChangeAvailability: Event<void> = this._onDidChangeAvailability.event;\n\n\tprivate readonly _onDidChangeInProgress = this._register(new Emitter<void>());\n\tpublic get onDidChangeInProgress() { return this._onDidChangeInProgress.event; }\n\n\tprivate readonly _onDidChangeContentProviderSchemes = this._register(new Emitter<{ readonly added: string[]; readonly removed: string[] }>());\n\tpublic get onDidChangeContentProviderSchemes() { return this._onDidChangeContentProviderSchemes.event; }\n\n\tprivate readonly inProgressMap: Map<string, number> = new Map();\n\tprivate readonly _sessionTypeOptions: Map<string, IChatSessionProviderOptionGroup[]> = new Map();\n\tprivate readonly _sessionTypeIcons: Map<string, ThemeIcon | { light: URI; dark: URI }> = new Map();\n\tprivate readonly _sessionTypeWelcomeTitles: Map<string, string> = new Map();\n\tprivate readonly _sessionTypeWelcomeMessages: Map<string, string> = new Map();\n\tprivate readonly _sessionTypeWelcomeTips: Map<string, string> = new Map();\n\tprivate readonly _sessionTypeInputPlaceholders: Map<string, string> = new Map();\n\n\tprivate readonly _sessions = new ResourceMap<ContributedChatSessionData>();\n\tprivate readonly _editableSessions = new ResourceMap<IEditableData>();\n\n\tconstructor(\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IChatAgentService private readonly _chatAgentService: IChatAgentService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IMenuService private readonly _menuService: IMenuService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@ILabelService private readonly _labelService: ILabelService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(extensionPoint.setHandler(extensions => {\n\t\t\tfor (const ext of extensions) {\n\t\t\t\tif (!isProposedApiEnabled(ext.description, 'chatSessionsProvider')) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (!Array.isArray(ext.value)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfor (const contribution of ext.value) {\n\t\t\t\t\tthis._register(this.registerContribution(contribution, ext.description));\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\t// Listen for context changes and re-evaluate contributions\n\t\tthis._register(Event.filter(this._contextKeyService.onDidChangeContext, e => e.affectsSome(this._contextKeys))(() => {\n\t\t\tthis._evaluateAvailability();\n\t\t}));\n\n\t\tthis._register(this.onDidChangeSessionItems(chatSessionType => {\n\t\t\tthis.updateInProgressStatus(chatSessionType).catch(error => {\n\t\t\t\tthis._logService.warn(`Failed to update progress status for '${chatSessionType}':`, error);\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(this._labelService.registerFormatter({\n\t\t\tscheme: Schemas.copilotPr,\n\t\t\tformatting: {\n\t\t\t\tlabel: '${authority}${path}',\n\t\t\t\tseparator: sep,\n\t\t\t\tstripPathStartingSeparator: true,\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic reportInProgress(chatSessionType: string, count: number): void {\n\t\tlet displayName: string | undefined;\n\n\t\tif (chatSessionType === localChatSessionType) {\n\t\t\tdisplayName = 'Local Chat Agent';\n\t\t} else {\n\t\t\tdisplayName = this._contributions.get(chatSessionType)?.contribution.displayName;\n\t\t}\n\n\t\tif (displayName) {\n\t\t\tthis.inProgressMap.set(displayName, count);\n\t\t}\n\t\tthis._onDidChangeInProgress.fire();\n\t}\n\n\tpublic getInProgress(): { displayName: string; count: number }[] {\n\t\treturn Array.from(this.inProgressMap.entries()).map(([displayName, count]) => ({ displayName, count }));\n\t}\n\n\tprivate async updateInProgressStatus(chatSessionType: string): Promise<void> {\n\t\ttry {\n\t\t\tconst items = await this.getChatSessionItems(chatSessionType, CancellationToken.None);\n\t\t\tconst inProgress = items.filter(item => item.status === ChatSessionStatus.InProgress);\n\t\t\tthis.reportInProgress(chatSessionType, inProgress.length);\n\t\t} catch (error) {\n\t\t\tthis._logService.warn(`Failed to update in-progress status for chat session type '${chatSessionType}':`, error);\n\t\t}\n\t}\n\n\tprivate registerContribution(contribution: IChatSessionsExtensionPoint, ext: IRelaxedExtensionDescription): IDisposable {\n\t\tif (this._contributions.has(contribution.type)) {\n\t\t\treturn { dispose: () => { } };\n\t\t}\n\n\t\t// Track context keys from the when condition\n\t\tif (contribution.when) {\n\t\t\tconst whenExpr = ContextKeyExpr.deserialize(contribution.when);\n\t\t\tif (whenExpr) {\n\t\t\t\tfor (const key of whenExpr.keys()) {\n\t\t\t\t\tthis._contextKeys.add(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._contributions.set(contribution.type, { contribution, extension: ext });\n\n\t\t// Register alternative IDs if provided\n\t\tif (contribution.alternativeIds) {\n\t\t\tfor (const altId of contribution.alternativeIds) {\n\t\t\t\tif (this._alternativeIdMap.has(altId)) {\n\t\t\t\t\tthis._logService.warn(`Alternative ID '${altId}' is already mapped to '${this._alternativeIdMap.get(altId)}'. Remapping to '${contribution.type}'.`);\n\t\t\t\t}\n\t\t\t\tthis._alternativeIdMap.set(altId, contribution.type);\n\t\t\t}\n\t\t}\n\n\t\t// Store icon mapping if provided\n\t\tlet icon: ThemeIcon | { dark: URI; light: URI } | undefined;\n\n\t\tif (contribution.icon) {\n\t\t\t// Parse icon string - support ThemeIcon format or file path from extension\n\t\t\tif (typeof contribution.icon === 'string') {\n\t\t\t\ticon = contribution.icon.startsWith('$(') && contribution.icon.endsWith(')')\n\t\t\t\t\t? ThemeIcon.fromString(contribution.icon)\n\t\t\t\t\t: ThemeIcon.fromId(contribution.icon);\n\t\t\t} else {\n\t\t\t\ticon = {\n\t\t\t\t\tdark: resources.joinPath(ext.extensionLocation, contribution.icon.dark),\n\t\t\t\t\tlight: resources.joinPath(ext.extensionLocation, contribution.icon.light)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (icon) {\n\t\t\tthis._sessionTypeIcons.set(contribution.type, icon);\n\t\t}\n\n\t\t// Store welcome title, message, tips, and input placeholder if provided\n\t\tif (contribution.welcomeTitle) {\n\t\t\tthis._sessionTypeWelcomeTitles.set(contribution.type, contribution.welcomeTitle);\n\t\t}\n\t\tif (contribution.welcomeMessage) {\n\t\t\tthis._sessionTypeWelcomeMessages.set(contribution.type, contribution.welcomeMessage);\n\t\t}\n\t\tif (contribution.welcomeTips) {\n\t\t\tthis._sessionTypeWelcomeTips.set(contribution.type, contribution.welcomeTips);\n\t\t}\n\t\tif (contribution.inputPlaceholder) {\n\t\t\tthis._sessionTypeInputPlaceholders.set(contribution.type, contribution.inputPlaceholder);\n\t\t}\n\n\t\tthis._evaluateAvailability();\n\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis._contributions.delete(contribution.type);\n\t\t\t\t// Remove alternative ID mappings\n\t\t\t\tif (contribution.alternativeIds) {\n\t\t\t\t\tfor (const altId of contribution.alternativeIds) {\n\t\t\t\t\t\tif (this._alternativeIdMap.get(altId) === contribution.type) {\n\t\t\t\t\t\t\tthis._alternativeIdMap.delete(altId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._sessionTypeIcons.delete(contribution.type);\n\t\t\t\tthis._sessionTypeWelcomeTitles.delete(contribution.type);\n\t\t\t\tthis._sessionTypeWelcomeMessages.delete(contribution.type);\n\t\t\t\tthis._sessionTypeWelcomeTips.delete(contribution.type);\n\t\t\t\tthis._sessionTypeInputPlaceholders.delete(contribution.type);\n\t\t\t\tthis._contributionDisposables.deleteAndDispose(contribution.type);\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _isContributionAvailable(contribution: IChatSessionsExtensionPoint): boolean {\n\t\tif (!contribution.when) {\n\t\t\treturn true;\n\t\t}\n\t\tconst whenExpr = ContextKeyExpr.deserialize(contribution.when);\n\t\treturn !whenExpr || this._contextKeyService.contextMatchesRules(whenExpr);\n\t}\n\n\t/**\n\t * Resolves a session type to its primary type, checking for alternative IDs.\n\t * @param sessionType The session type or alternative ID to resolve\n\t * @returns The primary session type, or undefined if not found or not available\n\t */\n\tprivate _resolveToPrimaryType(sessionType: string): string | undefined {\n\t\t// Try to find the primary type first\n\t\tconst contribution = this._contributions.get(sessionType)?.contribution;\n\t\tif (contribution) {\n\t\t\t// If the contribution is available, use it\n\t\t\tif (this._isContributionAvailable(contribution)) {\n\t\t\t\treturn sessionType;\n\t\t\t}\n\t\t\t// If not available, fall through to check for alternatives\n\t\t}\n\n\t\t// Check if this is an alternative ID, or if the primary type is not available\n\t\tconst primaryType = this._alternativeIdMap.get(sessionType);\n\t\tif (primaryType) {\n\t\t\tconst altContribution = this._contributions.get(primaryType)?.contribution;\n\t\t\tif (altContribution && this._isContributionAvailable(altContribution)) {\n\t\t\t\tthis._logService.trace(`Resolving chat session type '${sessionType}' to alternative type '${primaryType}'`);\n\t\t\t\treturn primaryType;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate _registerMenuItems(contribution: IChatSessionsExtensionPoint, extensionDescription: IRelaxedExtensionDescription): IDisposable {\n\t\t// If provider registers anything for the create submenu, let it fully control the creation\n\t\tconst contextKeyService = this._contextKeyService.createOverlay([\n\t\t\t['chatSessionType', contribution.type]\n\t\t]);\n\n\t\tconst rawMenuActions = this._menuService.getMenuActions(MenuId.ChatSessionsCreateSubMenu, contextKeyService);\n\t\tconst menuActions = rawMenuActions.map(value => value[1]).flat();\n\n\t\tconst whenClause = ContextKeyExpr.and(\n\t\t\tContextKeyExpr.equals('view', `${LEGACY_AGENT_SESSIONS_VIEW_ID}.${contribution.type}`)\n\t\t);\n\n\t\t// If there's exactly one action, inline it\n\t\tif (menuActions.length === 1) {\n\t\t\tconst first = menuActions[0];\n\t\t\tif (first instanceof MenuItemAction) {\n\t\t\t\treturn MenuRegistry.appendMenuItem(MenuId.ViewTitle, {\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ttitle: first.label,\n\t\t\t\t\ticon: Codicon.plus,\n\t\t\t\t\torder: 1,\n\t\t\t\t\twhen: whenClause,\n\t\t\t\t\tcommand: first.item,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (menuActions.length) {\n\t\t\treturn MenuRegistry.appendMenuItem(MenuId.ViewTitle, {\n\t\t\t\tgroup: 'navigation',\n\t\t\t\ttitle: localize('interactiveSession.chatSessionSubMenuTitle', \"Create chat session\"),\n\t\t\t\ticon: Codicon.plus,\n\t\t\t\torder: 1,\n\t\t\t\twhen: whenClause,\n\t\t\t\tsubmenu: MenuId.ChatSessionsCreateSubMenu,\n\t\t\t\tisSplitButton: menuActions.length > 1\n\t\t\t});\n\t\t} else {\n\t\t\t// We control creation instead\n\t\t\treturn MenuRegistry.appendMenuItem(MenuId.ViewTitle, {\n\t\t\t\tcommand: {\n\t\t\t\t\tid: `${NEW_CHAT_SESSION_ACTION_ID}.${contribution.type}`,\n\t\t\t\t\ttitle: localize('interactiveSession.openNewSessionEditor', \"New {0}\", contribution.displayName),\n\t\t\t\t\ticon: Codicon.plus,\n\t\t\t\t\tsource: {\n\t\t\t\t\t\tid: extensionDescription.identifier.value,\n\t\t\t\t\t\ttitle: extensionDescription.displayName || extensionDescription.name,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1,\n\t\t\t\twhen: whenClause,\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _registerCommands(contribution: IChatSessionsExtensionPoint): IDisposable {\n\t\treturn registerAction2(class OpenNewChatSessionEditorAction extends Action2 {\n\t\t\tconstructor() {\n\t\t\t\tsuper({\n\t\t\t\t\tid: `workbench.action.chat.openNewSessionEditor.${contribution.type}`,\n\t\t\t\t\ttitle: localize2('interactiveSession.openNewSessionEditor', \"New {0}\", contribution.displayName),\n\t\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\t\ticon: Codicon.plus,\n\t\t\t\t\tf1: true, // Show in command palette\n\t\t\t\t\tprecondition: ChatContextKeys.enabled\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tasync run(accessor: ServicesAccessor) {\n\t\t\t\tconst editorService = accessor.get(IEditorService);\n\t\t\t\tconst logService = accessor.get(ILogService);\n\n\t\t\t\tconst { type } = contribution;\n\n\t\t\t\ttry {\n\t\t\t\t\tconst options: IChatEditorOptions = {\n\t\t\t\t\t\toverride: ChatEditorInput.EditorID,\n\t\t\t\t\t\tpinned: true,\n\t\t\t\t\t\ttitle: {\n\t\t\t\t\t\t\tfallback: localize('chatEditorContributionName', \"{0}\", contribution.displayName),\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst resource = URI.from({\n\t\t\t\t\t\tscheme: type,\n\t\t\t\t\t\tpath: `/untitled-${generateUuid()}`,\n\t\t\t\t\t});\n\t\t\t\t\tawait editorService.openEditor({ resource, options });\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlogService.error(`Failed to open new '${type}' chat session editor`, e);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _evaluateAvailability(): void {\n\t\tlet hasChanges = false;\n\t\tfor (const { contribution, extension } of this._contributions.values()) {\n\t\t\tconst isCurrentlyRegistered = this._contributionDisposables.has(contribution.type);\n\t\t\tconst shouldBeRegistered = this._isContributionAvailable(contribution);\n\t\t\tif (isCurrentlyRegistered && !shouldBeRegistered) {\n\t\t\t\t// Disable the contribution by disposing its disposable store\n\t\t\t\tthis._contributionDisposables.deleteAndDispose(contribution.type);\n\n\t\t\t\t// Also dispose any cached sessions for this contribution\n\t\t\t\tthis._disposeSessionsForContribution(contribution.type);\n\t\t\t\thasChanges = true;\n\t\t\t} else if (!isCurrentlyRegistered && shouldBeRegistered) {\n\t\t\t\t// Enable the contribution by registering it\n\t\t\t\tthis._enableContribution(contribution, extension);\n\t\t\t\thasChanges = true;\n\t\t\t}\n\t\t}\n\t\tif (hasChanges) {\n\t\t\tthis._onDidChangeAvailability.fire();\n\t\t\tfor (const provider of this._itemsProviders.values()) {\n\t\t\t\tthis._onDidChangeItemsProviders.fire(provider);\n\t\t\t}\n\t\t\tfor (const { contribution } of this._contributions.values()) {\n\t\t\t\tthis._onDidChangeSessionItems.fire(contribution.type);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _enableContribution(contribution: IChatSessionsExtensionPoint, ext: IRelaxedExtensionDescription): void {\n\t\tconst disposableStore = new DisposableStore();\n\t\tthis._contributionDisposables.set(contribution.type, disposableStore);\n\n\t\tdisposableStore.add(this._registerAgent(contribution, ext));\n\t\tdisposableStore.add(this._registerCommands(contribution));\n\t\tdisposableStore.add(this._registerMenuItems(contribution, ext));\n\t}\n\n\tprivate _disposeSessionsForContribution(contributionId: string): void {\n\t\t// Find and dispose all sessions that belong to this contribution\n\t\tconst sessionsToDispose: URI[] = [];\n\t\tfor (const [sessionResource, sessionData] of this._sessions) {\n\t\t\tif (sessionData.chatSessionType === contributionId) {\n\t\t\t\tsessionsToDispose.push(sessionResource);\n\t\t\t}\n\t\t}\n\n\t\tif (sessionsToDispose.length > 0) {\n\t\t\tthis._logService.info(`Disposing ${sessionsToDispose.length} cached sessions for contribution '${contributionId}' due to when clause change`);\n\t\t}\n\n\t\tfor (const sessionKey of sessionsToDispose) {\n\t\t\tconst sessionData = this._sessions.get(sessionKey);\n\t\t\tif (sessionData) {\n\t\t\t\tsessionData.dispose(); // This will call _onWillDisposeSession and clean up\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerAgent(contribution: IChatSessionsExtensionPoint, ext: IRelaxedExtensionDescription): IDisposable {\n\t\tconst { type: id, name, displayName, description } = contribution;\n\t\tconst agentData: IChatAgentData = {\n\t\t\tid,\n\t\t\tname,\n\t\t\tfullName: displayName,\n\t\t\tdescription: description,\n\t\t\tisDefault: false,\n\t\t\tisCore: false,\n\t\t\tisDynamic: true,\n\t\t\tslashCommands: contribution.commands ?? [],\n\t\t\tlocations: [ChatAgentLocation.Chat],\n\t\t\tmodes: [ChatModeKind.Agent, ChatModeKind.Ask],\n\t\t\tdisambiguation: [],\n\t\t\tmetadata: {\n\t\t\t\tthemeIcon: Codicon.sendToRemoteAgent,\n\t\t\t\tisSticky: false,\n\t\t\t},\n\t\t\tcapabilities: contribution.capabilities,\n\t\t\tcanAccessPreviousChatHistory: true,\n\t\t\textensionId: ext.identifier,\n\t\t\textensionVersion: ext.version,\n\t\t\textensionDisplayName: ext.displayName || ext.name,\n\t\t\textensionPublisherId: ext.publisher,\n\t\t};\n\n\t\treturn this._chatAgentService.registerAgent(id, agentData);\n\t}\n\n\tgetAllChatSessionContributions(): IChatSessionsExtensionPoint[] {\n\t\treturn Array.from(this._contributions.values(), x => x.contribution)\n\t\t\t.filter(contribution => this._isContributionAvailable(contribution));\n\t}\n\n\tgetAllChatSessionItemProviders(): IChatSessionItemProvider[] {\n\t\treturn [...this._itemsProviders.values()].filter(provider => {\n\t\t\t// Check if the provider's corresponding contribution is available\n\t\t\tconst contribution = this._contributions.get(provider.chatSessionType)?.contribution;\n\t\t\treturn !contribution || this._isContributionAvailable(contribution);\n\t\t});\n\t}\n\n\tasync activateChatSessionItemProvider(chatViewType: string): Promise<IChatSessionItemProvider | undefined> {\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tconst resolvedType = this._resolveToPrimaryType(chatViewType);\n\t\tif (resolvedType) {\n\t\t\tchatViewType = resolvedType;\n\t\t}\n\n\t\tconst contribution = this._contributions.get(chatViewType)?.contribution;\n\t\tif (contribution && !this._isContributionAvailable(contribution)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (this._itemsProviders.has(chatViewType)) {\n\t\t\treturn this._itemsProviders.get(chatViewType);\n\t\t}\n\n\t\tawait this._extensionService.activateByEvent(`onChatSession:${chatViewType}`);\n\n\t\treturn this._itemsProviders.get(chatViewType);\n\t}\n\n\tasync canResolveChatSession(chatSessionResource: URI) {\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tconst resolvedType = this._resolveToPrimaryType(chatSessionResource.scheme) || chatSessionResource.scheme;\n\t\tconst contribution = this._contributions.get(resolvedType)?.contribution;\n\t\tif (contribution && !this._isContributionAvailable(contribution)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._contentProviders.has(chatSessionResource.scheme)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tawait this._extensionService.activateByEvent(`onChatSession:${chatSessionResource.scheme}`);\n\t\treturn this._contentProviders.has(chatSessionResource.scheme);\n\t}\n\n\tasync getAllChatSessionItems(token: CancellationToken): Promise<Array<{ readonly chatSessionType: string; readonly items: IChatSessionItem[] }>> {\n\t\treturn Promise.all(Array.from(this.getAllChatSessionContributions(), async contrib => {\n\t\t\treturn {\n\t\t\t\tchatSessionType: contrib.type,\n\t\t\t\titems: await this.getChatSessionItems(contrib.type, token)\n\t\t\t};\n\t\t}));\n\t}\n\n\tprivate async getChatSessionItems(chatSessionType: string, token: CancellationToken): Promise<IChatSessionItem[]> {\n\t\tif (!(await this.activateChatSessionItemProvider(chatSessionType))) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst resolvedType = this._resolveToPrimaryType(chatSessionType);\n\t\tif (resolvedType) {\n\t\t\tchatSessionType = resolvedType;\n\t\t}\n\n\t\tconst provider = this._itemsProviders.get(chatSessionType);\n\t\tif (provider?.provideChatSessionItems) {\n\t\t\tconst sessions = await provider.provideChatSessionItems(token);\n\t\t\treturn sessions;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tpublic registerChatSessionItemProvider(provider: IChatSessionItemProvider): IDisposable {\n\t\tconst chatSessionType = provider.chatSessionType;\n\t\tthis._itemsProviders.set(chatSessionType, provider);\n\t\tthis._onDidChangeItemsProviders.fire(provider);\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(provider.onDidChangeChatSessionItems(() => {\n\t\t\tthis._onDidChangeSessionItems.fire(chatSessionType);\n\t\t}));\n\n\t\tthis.updateInProgressStatus(chatSessionType).catch(error => {\n\t\t\tthis._logService.warn(`Failed to update initial progress status for '${chatSessionType}':`, error);\n\t\t});\n\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tdisposables.dispose();\n\n\t\t\t\tconst provider = this._itemsProviders.get(chatSessionType);\n\t\t\t\tif (provider) {\n\t\t\t\t\tthis._itemsProviders.delete(chatSessionType);\n\t\t\t\t\tthis._onDidChangeItemsProviders.fire(provider);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tregisterChatSessionContentProvider(chatSessionType: string, provider: IChatSessionContentProvider): IDisposable {\n\t\tif (this._contentProviders.has(chatSessionType)) {\n\t\t\tthrow new Error(`Content provider for ${chatSessionType} is already registered.`);\n\t\t}\n\n\t\tthis._contentProviders.set(chatSessionType, provider);\n\t\tthis._onDidChangeContentProviderSchemes.fire({ added: [chatSessionType], removed: [] });\n\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis._contentProviders.delete(chatSessionType);\n\n\t\t\t\tthis._onDidChangeContentProviderSchemes.fire({ added: [], removed: [chatSessionType] });\n\n\t\t\t\t// Remove all sessions that were created by this provider\n\t\t\t\tfor (const [key, session] of this._sessions) {\n\t\t\t\t\tif (session.chatSessionType === chatSessionType) {\n\t\t\t\t\t\tsession.dispose();\n\t\t\t\t\t\tthis._sessions.delete(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Creates a new chat session by delegating to the appropriate provider\n\t * @param chatSessionType The type of chat session provider to use\n\t * @param options Options for the new session including the request\n\t * @param token A cancellation token\n\t * @returns A session ID for the newly created session\n\t */\n\tpublic async getNewChatSessionItem(chatSessionType: string, options: {\n\t\trequest: IChatAgentRequest;\n\t\tmetadata?: any;\n\t}, token: CancellationToken): Promise<IChatSessionItem> {\n\t\tif (!(await this.activateChatSessionItemProvider(chatSessionType))) {\n\t\t\tthrow Error(`Cannot find provider for ${chatSessionType}`);\n\t\t}\n\n\t\tconst resolvedType = this._resolveToPrimaryType(chatSessionType);\n\t\tif (resolvedType) {\n\t\t\tchatSessionType = resolvedType;\n\t\t}\n\n\n\t\tconst provider = this._itemsProviders.get(chatSessionType);\n\t\tif (!provider?.provideNewChatSessionItem) {\n\t\t\tthrow Error(`Provider for ${chatSessionType} does not support creating sessions`);\n\t\t}\n\t\tconst chatSessionItem = await provider.provideNewChatSessionItem(options, token);\n\t\tthis._onDidChangeSessionItems.fire(chatSessionType);\n\t\treturn chatSessionItem;\n\t}\n\n\tpublic async getOrCreateChatSession(sessionResource: URI, token: CancellationToken): Promise<IChatSession> {\n\t\tconst existingSessionData = this._sessions.get(sessionResource);\n\t\tif (existingSessionData) {\n\t\t\treturn existingSessionData.session;\n\t\t}\n\n\t\tif (!(await raceCancellationError(this.canResolveChatSession(sessionResource), token))) {\n\t\t\tthrow Error(`Can not find provider for ${sessionResource}`);\n\t\t}\n\n\t\tconst resolvedType = this._resolveToPrimaryType(sessionResource.scheme) || sessionResource.scheme;\n\t\tconst provider = this._contentProviders.get(resolvedType);\n\t\tif (!provider) {\n\t\t\tthrow Error(`Can not find provider for ${sessionResource}`);\n\t\t}\n\n\t\tconst session = await raceCancellationError(provider.provideChatSessionContent(sessionResource, token), token);\n\t\tconst sessionData = new ContributedChatSessionData(session, sessionResource.scheme, sessionResource, session.options, resource => {\n\t\t\tsessionData.dispose();\n\t\t\tthis._sessions.delete(resource);\n\t\t});\n\n\t\tthis._sessions.set(sessionResource, sessionData);\n\n\t\treturn session;\n\t}\n\n\n\tpublic hasAnySessionOptions(sessionResource: URI): boolean {\n\t\tconst session = this._sessions.get(sessionResource);\n\t\treturn !!session && !!session.options && Object.keys(session.options).length > 0;\n\t}\n\n\tpublic getSessionOption(sessionResource: URI, optionId: string): string | IChatSessionProviderOptionItem | undefined {\n\t\tconst session = this._sessions.get(sessionResource);\n\t\treturn session?.getOption(optionId);\n\t}\n\n\tpublic setSessionOption(sessionResource: URI, optionId: string, value: string | IChatSessionProviderOptionItem): boolean {\n\t\tconst session = this._sessions.get(sessionResource);\n\t\treturn !!session?.setOption(optionId, value);\n\t}\n\n\t// Implementation of editable session methods\n\tpublic async setEditableSession(sessionResource: URI, data: IEditableData | null): Promise<void> {\n\t\tif (!data) {\n\t\t\tthis._editableSessions.delete(sessionResource);\n\t\t} else {\n\t\t\tthis._editableSessions.set(sessionResource, data);\n\t\t}\n\t\t// Trigger refresh of the session views that might need to update their rendering\n\t\tthis._onDidChangeSessionItems.fire(localChatSessionType);\n\t}\n\n\tpublic getEditableData(sessionResource: URI): IEditableData | undefined {\n\t\treturn this._editableSessions.get(sessionResource);\n\t}\n\n\tpublic isEditable(sessionResource: URI): boolean {\n\t\treturn this._editableSessions.has(sessionResource);\n\t}\n\n\tpublic notifySessionItemsChanged(chatSessionType: string): void {\n\t\tthis._onDidChangeSessionItems.fire(chatSessionType);\n\t}\n\n\t/**\n\t * Store option groups for a session type\n\t */\n\tpublic setOptionGroupsForSessionType(chatSessionType: string, handle: number, optionGroups?: IChatSessionProviderOptionGroup[]): void {\n\t\tif (optionGroups) {\n\t\t\tthis._sessionTypeOptions.set(chatSessionType, optionGroups);\n\t\t} else {\n\t\t\tthis._sessionTypeOptions.delete(chatSessionType);\n\t\t}\n\t}\n\n\t/**\n\t * Get available option groups for a session type\n\t */\n\tpublic getOptionGroupsForSessionType(chatSessionType: string): IChatSessionProviderOptionGroup[] | undefined {\n\t\treturn this._sessionTypeOptions.get(chatSessionType);\n\t}\n\n\tprivate _optionsChangeCallback?: SessionOptionsChangedCallback;\n\n\t/**\n\t * Set the callback for notifying extensions about option changes\n\t */\n\tpublic setOptionsChangeCallback(callback: SessionOptionsChangedCallback): void {\n\t\tthis._optionsChangeCallback = callback;\n\t}\n\n\t/**\n\t * Notify extension about option changes for a session\n\t */\n\tpublic async notifySessionOptionsChange(sessionResource: URI, updates: ReadonlyArray<{ optionId: string; value: string }>): Promise<void> {\n\t\tif (!updates.length) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._optionsChangeCallback) {\n\t\t\tawait this._optionsChangeCallback(sessionResource, updates);\n\t\t}\n\t\tfor (const u of updates) {\n\t\t\tthis.setSessionOption(sessionResource, u.optionId, u.value);\n\t\t}\n\t}\n\n\t/**\n\t * Get the icon for a specific session type\n\t */\n\tpublic getIconForSessionType(chatSessionType: string): ThemeIcon | URI | undefined {\n\t\tconst sessionTypeIcon = this._sessionTypeIcons.get(chatSessionType);\n\n\t\tif (ThemeIcon.isThemeIcon(sessionTypeIcon)) {\n\t\t\treturn sessionTypeIcon;\n\t\t}\n\n\t\tif (isDark(this._themeService.getColorTheme().type)) {\n\t\t\treturn sessionTypeIcon?.dark;\n\t\t} else {\n\t\t\treturn sessionTypeIcon?.light;\n\t\t}\n\t}\n\n\t/**\n\t * Get the welcome title for a specific session type\n\t */\n\tpublic getWelcomeTitleForSessionType(chatSessionType: string): string | undefined {\n\t\treturn this._sessionTypeWelcomeTitles.get(chatSessionType);\n\t}\n\n\t/**\n\t * Get the welcome message for a specific session type\n\t */\n\tpublic getWelcomeMessageForSessionType(chatSessionType: string): string | undefined {\n\t\treturn this._sessionTypeWelcomeMessages.get(chatSessionType);\n\t}\n\n\t/**\n\t * Get the input placeholder for a specific session type\n\t */\n\tpublic getInputPlaceholderForSessionType(chatSessionType: string): string | undefined {\n\t\treturn this._sessionTypeInputPlaceholders.get(chatSessionType);\n\t}\n\n\t/**\n\t * Get the capabilities for a specific session type\n\t */\n\tpublic getCapabilitiesForSessionType(chatSessionType: string): IChatAgentAttachmentCapabilities | undefined {\n\t\tconst contribution = this._contributions.get(chatSessionType)?.contribution;\n\t\treturn contribution?.capabilities;\n\t}\n\n\tpublic getContentProviderSchemes(): string[] {\n\t\treturn Array.from(this._contentProviders.keys());\n\t}\n}\n\nregisterSingleton(IChatSessionsService, ChatSessionsService, InstantiationType.Delayed);\n"]}