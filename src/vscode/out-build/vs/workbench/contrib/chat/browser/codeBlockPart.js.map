{"version":3,"sources":["vs/workbench/contrib/chat/browser/codeBlockPart.ts"],"names":[],"mappings":"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","file":"codeBlockPart.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './codeBlockPart.css';\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderFormattedText } from '../../../../base/browser/formattedTextRenderer.js';\nimport { Button } from '../../../../base/browser/ui/button/button.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { combinedDisposable, Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IEditorConstructionOptions } from '../../../../editor/browser/config/editorConfiguration.js';\nimport { IDiffEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { EditorExtensionsRegistry } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { DiffEditorWidget } from '../../../../editor/browser/widget/diffEditor/diffEditorWidget.js';\nimport { EditorOption, IEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../../editor/common/config/fontInfo.js';\nimport { IRange, Range } from '../../../../editor/common/core/range.js';\nimport { ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { TextEdit } from '../../../../editor/common/languages.js';\nimport { EndOfLinePreference, ITextModel } from '../../../../editor/common/model.js';\nimport { TextModelText } from '../../../../editor/common/model/textModelText.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { DefaultModelSHA1Computer } from '../../../../editor/common/services/modelService.js';\nimport { ITextModelContentProvider, ITextModelService } from '../../../../editor/common/services/resolverService.js';\nimport { BracketMatchingController } from '../../../../editor/contrib/bracketMatching/browser/bracketMatching.js';\nimport { ColorDetector } from '../../../../editor/contrib/colorPicker/browser/colorDetector.js';\nimport { ContextMenuController } from '../../../../editor/contrib/contextmenu/browser/contextmenu.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../../../editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverController } from '../../../../editor/contrib/hover/browser/contentHoverController.js';\nimport { GlyphHoverController } from '../../../../editor/contrib/hover/browser/glyphHoverController.js';\nimport { LinkDetector } from '../../../../editor/contrib/links/browser/links.js';\nimport { MessageController } from '../../../../editor/contrib/message/browser/messageController.js';\nimport { ViewportSemanticTokensContribution } from '../../../../editor/contrib/semanticTokens/browser/viewportSemanticTokens.js';\nimport { SmartSelectController } from '../../../../editor/contrib/smartSelect/browser/smartSelect.js';\nimport { WordHighlighterContribution } from '../../../../editor/contrib/wordHighlighter/browser/wordHighlighter.js';\nimport { localize } from '../../../../nls.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { MenuWorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ResourceLabel } from '../../../browser/labels.js';\nimport { ResourceContextKey } from '../../../common/contextkeys.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { InspectEditorTokensController } from '../../codeEditor/browser/inspectEditorTokens/inspectEditorTokens.js';\nimport { MenuPreventer } from '../../codeEditor/browser/menuPreventer.js';\nimport { SelectionClipboardContributionID } from '../../codeEditor/browser/selectionClipboard.js';\nimport { getSimpleEditorOptions } from '../../codeEditor/browser/simpleEditorOptions.js';\nimport { IMarkdownVulnerability } from '../common/annotations.js';\nimport { ChatContextKeys } from '../common/chatContextKeys.js';\nimport { IChatResponseModel, IChatTextEditGroup } from '../common/chatModel.js';\nimport { IChatResponseViewModel, isRequestVM, isResponseVM } from '../common/chatViewModel.js';\nimport { ChatTreeItem } from './chat.js';\nimport { IChatRendererDelegate } from './chatListRenderer.js';\nimport { ChatEditorOptions } from './chatOptions.js';\nimport { emptyProgressRunner, IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { SuggestController } from '../../../../editor/contrib/suggest/browser/suggestController.js';\nimport { SnippetController2 } from '../../../../editor/contrib/snippet/browser/snippetController2.js';\n\nconst $ = dom.$;\n\nexport interface ICodeBlockData {\n\treadonly codeBlockIndex: number;\n\treadonly codeBlockPartIndex: number;\n\treadonly element: unknown;\n\n\treadonly textModel: Promise<ITextModel> | undefined;\n\treadonly languageId: string;\n\n\treadonly codemapperUri?: URI;\n\treadonly fromSubagent?: boolean;\n\n\treadonly vulns?: readonly IMarkdownVulnerability[];\n\treadonly range?: Range;\n\n\treadonly parentContextKeyService?: IContextKeyService;\n\treadonly renderOptions?: ICodeBlockRenderOptions;\n\n\treadonly chatSessionResource: URI;\n}\n\n/**\n * Special markdown code block language id used to render a local file.\n *\n * The text of the code path should be a {@link LocalFileCodeBlockData} json object.\n */\nexport const localFileLanguageId = 'vscode-local-file';\n\n\nexport function parseLocalFileData(text: string) {\n\n\tinterface RawLocalFileCodeBlockData {\n\t\treadonly uri: UriComponents;\n\t\treadonly range?: IRange;\n\t}\n\n\tlet data: RawLocalFileCodeBlockData;\n\ttry {\n\t\tdata = JSON.parse(text);\n\t} catch (e) {\n\t\tthrow new Error('Could not parse code block local file data');\n\t}\n\n\tlet uri: URI;\n\ttry {\n\t\turi = URI.revive(data?.uri);\n\t} catch (e) {\n\t\tthrow new Error('Invalid code block local file data URI');\n\t}\n\n\tlet range: IRange | undefined;\n\tif (data.range) {\n\t\t// Note that since this is coming from extensions, position are actually zero based and must be converted.\n\t\trange = new Range(data.range.startLineNumber + 1, data.range.startColumn + 1, data.range.endLineNumber + 1, data.range.endColumn + 1);\n\t}\n\n\treturn { uri, range };\n}\n\nexport interface ICodeBlockActionContext {\n\treadonly code: string;\n\treadonly codemapperUri?: URI;\n\treadonly languageId?: string;\n\treadonly codeBlockIndex: number;\n\treadonly element: unknown;\n\n\treadonly chatSessionResource: URI | undefined;\n}\n\nexport interface ICodeBlockRenderOptions {\n\thideToolbar?: boolean;\n\tverticalPadding?: number;\n\treserveWidth?: number;\n\teditorOptions?: IEditorOptions;\n\tmaxHeightInLines?: number;\n}\n\nconst defaultCodeblockPadding = 10;\nexport class CodeBlockPart extends Disposable {\n\tprotected readonly _onDidChangeContentHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContentHeight = this._onDidChangeContentHeight.event;\n\n\tpublic readonly editor: CodeEditorWidget;\n\tprotected readonly toolbar: MenuWorkbenchToolBar;\n\tprivate readonly contextKeyService: IContextKeyService;\n\n\tpublic readonly element: HTMLElement;\n\n\tprivate readonly vulnsButton: Button;\n\tprivate readonly vulnsListElement: HTMLElement;\n\n\tprivate currentCodeBlockData: ICodeBlockData | undefined;\n\tprivate currentScrollWidth = 0;\n\n\tprivate isDisposed = false;\n\n\tprivate resourceContextKey: ResourceContextKey;\n\n\tprivate get verticalPadding(): number {\n\t\treturn this.currentCodeBlockData?.renderOptions?.verticalPadding ?? defaultCodeblockPadding;\n\t}\n\n\tconstructor(\n\t\tprivate readonly editorOptions: ChatEditorOptions,\n\t\treadonly menuId: MenuId,\n\t\tdelegate: IChatRendererDelegate,\n\t\toverflowWidgetsDomNode: HTMLElement | undefined,\n\t\tprivate readonly isSimpleWidget: boolean = false,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IModelService protected readonly modelService: IModelService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService,\n\t) {\n\t\tsuper();\n\t\tthis.element = $('.interactive-result-code-block');\n\n\t\tthis.resourceContextKey = this._register(instantiationService.createInstance(ResourceContextKey));\n\t\tthis.contextKeyService = this._register(contextKeyService.createScoped(this.element));\n\t\tconst scopedInstantiationService = this._register(instantiationService.createChild(new ServiceCollection([IContextKeyService, this.contextKeyService])));\n\t\tconst editorElement = dom.append(this.element, $('.interactive-result-editor'));\n\t\tthis.editor = this.createEditor(scopedInstantiationService, editorElement, {\n\t\t\t...getSimpleEditorOptions(this.configurationService),\n\t\t\treadOnly: true,\n\t\t\tlineNumbers: 'off',\n\t\t\tselectOnLineNumbers: true,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tlineDecorationsWidth: 8,\n\t\t\tdragAndDrop: false,\n\t\t\tpadding: { top: this.verticalPadding, bottom: this.verticalPadding },\n\t\t\tmouseWheelZoom: false,\n\t\t\tscrollbar: {\n\t\t\t\tvertical: 'hidden',\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\tdefinitionLinkOpensInPeek: false,\n\t\t\tgotoLocation: {\n\t\t\t\tmultiple: 'goto',\n\t\t\t\tmultipleDeclarations: 'goto',\n\t\t\t\tmultipleDefinitions: 'goto',\n\t\t\t\tmultipleImplementations: 'goto',\n\t\t\t},\n\t\t\tariaLabel: localize('chat.codeBlockHelp', 'Code block'),\n\t\t\toverflowWidgetsDomNode,\n\t\t\ttabFocusMode: true,\n\t\t\t...this.getEditorOptionsFromConfig(),\n\t\t});\n\n\t\tconst toolbarElement = dom.append(this.element, $('.interactive-result-code-block-toolbar'));\n\t\tconst editorScopedService = this.editor.contextKeyService.createScoped(toolbarElement);\n\t\tconst editorScopedInstantiationService = this._register(scopedInstantiationService.createChild(new ServiceCollection([IContextKeyService, editorScopedService])));\n\t\tthis.toolbar = this._register(editorScopedInstantiationService.createInstance(MenuWorkbenchToolBar, toolbarElement, menuId, {\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t}\n\t\t}));\n\n\t\tconst vulnsContainer = dom.append(this.element, $('.interactive-result-vulns'));\n\t\tconst vulnsHeaderElement = dom.append(vulnsContainer, $('.interactive-result-vulns-header', undefined));\n\t\tthis.vulnsButton = this._register(new Button(vulnsHeaderElement, {\n\t\t\tbuttonBackground: undefined,\n\t\t\tbuttonBorder: undefined,\n\t\t\tbuttonForeground: undefined,\n\t\t\tbuttonHoverBackground: undefined,\n\t\t\tbuttonSecondaryBackground: undefined,\n\t\t\tbuttonSecondaryForeground: undefined,\n\t\t\tbuttonSecondaryHoverBackground: undefined,\n\t\t\tbuttonSeparator: undefined,\n\t\t\tsupportIcons: true\n\t\t}));\n\n\t\tthis.vulnsListElement = dom.append(vulnsContainer, $('ul.interactive-result-vulns-list'));\n\n\t\tthis._register(this.vulnsButton.onDidClick(() => {\n\t\t\tconst element = this.currentCodeBlockData!.element as IChatResponseViewModel;\n\t\t\telement.vulnerabilitiesListExpanded = !element.vulnerabilitiesListExpanded;\n\t\t\tthis.vulnsButton.label = this.getVulnerabilitiesLabel();\n\t\t\tthis.element.classList.toggle('chat-vulnerabilities-collapsed', !element.vulnerabilitiesListExpanded);\n\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t// this.updateAriaLabel(collapseButton.element, referencesLabel, element.usedReferencesExpanded);\n\t\t}));\n\n\t\tthis._register(this.toolbar.onDidChangeDropdownVisibility(e => {\n\t\t\ttoolbarElement.classList.toggle('force-visibility', e);\n\t\t}));\n\n\t\tthis._configureForScreenReader();\n\t\tthis._register(this.accessibilityService.onDidChangeScreenReaderOptimized(() => this._configureForScreenReader()));\n\t\tthis._register(this.configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectedKeys.has(AccessibilityVerbositySettingId.Chat)) {\n\t\t\t\tthis._configureForScreenReader();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.editorOptions.onDidChange(() => {\n\t\t\tthis.editor.updateOptions(this.getEditorOptionsFromConfig());\n\t\t}));\n\n\t\tthis._register(this.editor.onDidScrollChange(e => {\n\t\t\tthis.currentScrollWidth = e.scrollWidth;\n\t\t}));\n\t\tthis._register(this.editor.onDidContentSizeChange(e => {\n\t\t\tif (e.contentHeightChanged) {\n\t\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.editor.onDidBlurEditorWidget(() => {\n\t\t\tthis.element.classList.remove('focused');\n\t\t\tWordHighlighterContribution.get(this.editor)?.stopHighlighting();\n\t\t\tthis.clearWidgets();\n\t\t}));\n\t\tthis._register(this.editor.onDidFocusEditorWidget(() => {\n\t\t\tthis.element.classList.add('focused');\n\t\t\tWordHighlighterContribution.get(this.editor)?.restoreViewState(true);\n\t\t}));\n\t\tthis._register(Event.any(\n\t\t\tthis.editor.onDidChangeModel,\n\t\t\tthis.editor.onDidChangeModelContent\n\t\t)(() => {\n\t\t\tif (this.currentCodeBlockData) {\n\t\t\t\tthis.updateContexts(this.currentCodeBlockData);\n\t\t\t}\n\t\t}));\n\n\t\t// Parent list scrolled\n\t\tif (delegate.onDidScroll) {\n\t\t\tthis._register(delegate.onDidScroll(e => {\n\t\t\t\tthis.clearWidgets();\n\t\t\t}));\n\t\t}\n\t}\n\n\toverride dispose() {\n\t\tthis.isDisposed = true;\n\t\tsuper.dispose();\n\t}\n\n\tget uri(): URI | undefined {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n\n\tprivate createEditor(instantiationService: IInstantiationService, parent: HTMLElement, options: Readonly<IEditorConstructionOptions>): CodeEditorWidget {\n\t\treturn this._register(instantiationService.createInstance(CodeEditorWidget, parent, options, {\n\t\t\tisSimpleWidget: this.isSimpleWidget,\n\t\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tMenuPreventer.ID,\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\n\t\t\t\tWordHighlighterContribution.ID,\n\t\t\t\tViewportSemanticTokensContribution.ID,\n\t\t\t\tBracketMatchingController.ID,\n\t\t\t\tSmartSelectController.ID,\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t\tMessageController.ID,\n\t\t\t\tGotoDefinitionAtPositionEditorContribution.ID,\n\t\t\t\tSuggestController.ID,\n\t\t\t\tSnippetController2.ID,\n\t\t\t\tColorDetector.ID,\n\t\t\t\tLinkDetector.ID,\n\n\t\t\t\tInspectEditorTokensController.ID,\n\t\t\t])\n\t\t}));\n\t}\n\n\tfocus(): void {\n\t\tthis.editor.focus();\n\t}\n\n\tprivate updatePaddingForLayout() {\n\t\t// scrollWidth = \"the width of the content that needs to be scrolled\"\n\t\t// contentWidth = \"the width of the area where content is displayed\"\n\t\tconst horizontalScrollbarVisible = this.currentScrollWidth > this.editor.getLayoutInfo().contentWidth;\n\t\tconst scrollbarHeight = this.editor.getLayoutInfo().horizontalScrollbarHeight;\n\t\tconst bottomPadding = horizontalScrollbarVisible ?\n\t\t\tMath.max(this.verticalPadding - scrollbarHeight, 2) :\n\t\t\tthis.verticalPadding;\n\t\tthis.editor.updateOptions({ padding: { top: this.verticalPadding, bottom: bottomPadding } });\n\t}\n\n\tprivate _configureForScreenReader(): void {\n\t\tconst toolbarElt = this.toolbar.getElement();\n\t\tif (this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\ttoolbarElt.style.display = 'block';\n\t\t} else {\n\t\t\ttoolbarElt.style.display = '';\n\t\t}\n\t}\n\n\tprivate getEditorOptionsFromConfig(): IEditorOptions {\n\t\treturn {\n\t\t\twordWrap: this.editorOptions.configuration.resultEditor.wordWrap,\n\t\t\tfontLigatures: this.editorOptions.configuration.resultEditor.fontLigatures,\n\t\t\tbracketPairColorization: this.editorOptions.configuration.resultEditor.bracketPairColorization,\n\t\t\tfontFamily: this.editorOptions.configuration.resultEditor.fontFamily === 'default' ?\n\t\t\t\tEDITOR_FONT_DEFAULTS.fontFamily :\n\t\t\t\tthis.editorOptions.configuration.resultEditor.fontFamily,\n\t\t\tfontSize: this.editorOptions.configuration.resultEditor.fontSize,\n\t\t\tfontWeight: this.editorOptions.configuration.resultEditor.fontWeight,\n\t\t\tlineHeight: this.editorOptions.configuration.resultEditor.lineHeight,\n\t\t\t...this.currentCodeBlockData?.renderOptions?.editorOptions,\n\t\t};\n\t}\n\n\tlayout(width: number): void {\n\t\tconst contentHeight = this.getContentHeight();\n\n\t\tlet height = contentHeight;\n\t\tif (this.currentCodeBlockData?.renderOptions?.maxHeightInLines) {\n\t\t\theight = Math.min(contentHeight, this.editor.getOption(EditorOption.lineHeight) * this.currentCodeBlockData?.renderOptions?.maxHeightInLines);\n\t\t}\n\n\t\tconst editorBorder = 2;\n\t\twidth = width - editorBorder - (this.currentCodeBlockData?.renderOptions?.reserveWidth ?? 0);\n\t\tthis.editor.layout({ width: isRequestVM(this.currentCodeBlockData?.element) ? width * 0.9 : width, height });\n\t\tthis.updatePaddingForLayout();\n\t}\n\n\tprivate getContentHeight() {\n\t\tif (this.currentCodeBlockData?.range) {\n\t\t\tconst lineCount = this.currentCodeBlockData.range.endLineNumber - this.currentCodeBlockData.range.startLineNumber + 1;\n\t\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\t\treturn lineCount * lineHeight;\n\t\t}\n\t\treturn this.editor.getContentHeight();\n\t}\n\n\tasync render(data: ICodeBlockData, width: number) {\n\t\tthis.currentCodeBlockData = data;\n\t\tif (data.parentContextKeyService) {\n\t\t\tthis.contextKeyService.updateParent(data.parentContextKeyService);\n\t\t}\n\n\t\tif (this.getEditorOptionsFromConfig().wordWrap === 'on') {\n\t\t\t// Initialize the editor with the new proper width so that getContentHeight\n\t\t\t// will be computed correctly in the next call to layout()\n\t\t\tthis.layout(width);\n\t\t}\n\n\t\tconst didUpdate = await this.updateEditor(data);\n\t\tif (!didUpdate || this.isDisposed || this.currentCodeBlockData !== data) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.editor.updateOptions({\n\t\t\t...this.getEditorOptionsFromConfig(),\n\t\t});\n\t\tif (!this.editor.getOption(EditorOption.ariaLabel)) {\n\t\t\t// Don't override the ariaLabel if it was set by the editor options\n\t\t\tthis.editor.updateOptions({\n\t\t\t\tariaLabel: localize('chat.codeBlockLabel', \"Code block {0}\", data.codeBlockIndex + 1),\n\t\t\t});\n\t\t}\n\t\tthis.layout(width);\n\t\tthis.toolbar.setAriaLabel(localize('chat.codeBlockToolbarLabel', \"Code block {0}\", data.codeBlockIndex + 1));\n\t\tif (data.renderOptions?.hideToolbar) {\n\t\t\tdom.hide(this.toolbar.getElement());\n\t\t} else {\n\t\t\tdom.show(this.toolbar.getElement());\n\t\t}\n\n\t\tif (data.vulns?.length && isResponseVM(data.element)) {\n\t\t\tdom.clearNode(this.vulnsListElement);\n\t\t\tthis.element.classList.remove('no-vulns');\n\t\t\tthis.element.classList.toggle('chat-vulnerabilities-collapsed', !data.element.vulnerabilitiesListExpanded);\n\t\t\tdom.append(this.vulnsListElement, ...data.vulns.map(v => $('li', undefined, $('span.chat-vuln-title', undefined, v.title), ' ' + v.description)));\n\t\t\tthis.vulnsButton.label = this.getVulnerabilitiesLabel();\n\t\t} else {\n\t\t\tthis.element.classList.add('no-vulns');\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.clearWidgets();\n\t\tthis.currentCodeBlockData = undefined;\n\t}\n\n\tprivate clearWidgets() {\n\t\tContentHoverController.get(this.editor)?.hideContentHover();\n\t\tGlyphHoverController.get(this.editor)?.hideGlyphHover();\n\t}\n\n\tprivate async updateEditor(data: ICodeBlockData): Promise<boolean> {\n\t\tconst textModel = await data.textModel;\n\t\tif (this.isDisposed || this.currentCodeBlockData !== data || !textModel || textModel.isDisposed()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.editor.setModel(textModel);\n\t\tif (data.range) {\n\t\t\tthis.editor.setSelection(data.range);\n\t\t\tthis.editor.revealRangeInCenter(data.range, ScrollType.Immediate);\n\t\t}\n\n\t\tthis.updateContexts(data);\n\n\t\treturn true;\n\t}\n\n\tprivate getVulnerabilitiesLabel(): string {\n\t\tif (!this.currentCodeBlockData || !this.currentCodeBlockData.vulns) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst referencesLabel = this.currentCodeBlockData.vulns.length > 1 ?\n\t\t\tlocalize('vulnerabilitiesPlural', \"{0} vulnerabilities\", this.currentCodeBlockData.vulns.length) :\n\t\t\tlocalize('vulnerabilitiesSingular', \"{0} vulnerability\", 1);\n\t\tconst icon = (element: IChatResponseViewModel) => element.vulnerabilitiesListExpanded ? Codicon.chevronDown : Codicon.chevronRight;\n\t\treturn `${referencesLabel} $(${icon(this.currentCodeBlockData.element as IChatResponseViewModel).id})`;\n\t}\n\n\tprivate updateContexts(data: ICodeBlockData) {\n\t\tconst textModel = this.editor.getModel();\n\t\tif (!textModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toolbar.context = {\n\t\t\tcode: textModel.getTextBuffer().getValueInRange(data.range ?? textModel.getFullModelRange(), EndOfLinePreference.TextDefined),\n\t\t\tcodeBlockIndex: data.codeBlockIndex,\n\t\t\telement: data.element,\n\t\t\tlanguageId: textModel.getLanguageId(),\n\t\t\tcodemapperUri: data.codemapperUri,\n\t\t\tchatSessionResource: data.chatSessionResource\n\t\t} satisfies ICodeBlockActionContext;\n\t\tthis.resourceContextKey.set(textModel.uri);\n\t}\n}\n\nexport class ChatCodeBlockContentProvider extends Disposable implements ITextModelContentProvider {\n\n\tconstructor(\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) {\n\t\tsuper();\n\t\tthis._register(textModelService.registerTextModelContentProvider(Schemas.vscodeChatCodeBlock, this));\n\t}\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing) {\n\t\t\treturn existing;\n\t\t}\n\t\treturn this._modelService.createModel('', null, resource);\n\t}\n}\n\n//\n\nexport interface ICodeCompareBlockActionContext {\n\treadonly element: IChatResponseViewModel;\n\treadonly diffEditor: IDiffEditor;\n\treadonly edit: IChatTextEditGroup;\n}\n\nexport interface ICodeCompareBlockDiffData {\n\tmodified: ITextModel;\n\toriginal: ITextModel;\n\toriginalSha1: string;\n}\n\nexport interface ICodeCompareBlockData {\n\treadonly element: ChatTreeItem;\n\n\treadonly edit: IChatTextEditGroup;\n\n\treadonly diffData: Promise<ICodeCompareBlockDiffData | undefined>;\n\n\treadonly parentContextKeyService?: IContextKeyService;\n\n\treadonly horizontalPadding?: number;\n\treadonly isReadOnly?: boolean;\n\t// readonly hideToolbar?: boolean;\n}\n\n\n// long-lived object that sits in the DiffPool and that gets reused\nexport class CodeCompareBlockPart extends Disposable {\n\tprotected readonly _onDidChangeContentHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeContentHeight = this._onDidChangeContentHeight.event;\n\n\tprivate readonly contextKeyService: IContextKeyService;\n\tprivate readonly diffEditor: DiffEditorWidget;\n\tprivate readonly resourceLabel: ResourceLabel;\n\tprivate readonly toolbar: MenuWorkbenchToolBar;\n\treadonly element: HTMLElement;\n\tprivate readonly messageElement: HTMLElement;\n\tprivate readonly editorHeader: HTMLElement;\n\n\tprivate readonly _lastDiffEditorViewModel = this._store.add(new MutableDisposable());\n\tprivate currentScrollWidth = 0;\n\tprivate currentHorizontalPadding = 0;\n\n\tconstructor(\n\t\tprivate readonly options: ChatEditorOptions,\n\t\treadonly menuId: MenuId,\n\t\tdelegate: IChatRendererDelegate,\n\t\toverflowWidgetsDomNode: HTMLElement | undefined,\n\t\tprivate readonly isSimpleWidget: boolean = false,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IModelService protected readonly modelService: IModelService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t) {\n\t\tsuper();\n\t\tthis.element = $('.interactive-result-code-block');\n\t\tthis.element.classList.add('compare');\n\n\t\tthis.messageElement = dom.append(this.element, $('.message'));\n\t\tthis.messageElement.setAttribute('role', 'status');\n\t\tthis.messageElement.tabIndex = 0;\n\n\t\tthis.contextKeyService = this._register(contextKeyService.createScoped(this.element));\n\t\tconst scopedInstantiationService = this._register(instantiationService.createChild(new ServiceCollection(\n\t\t\t[IContextKeyService, this.contextKeyService],\n\t\t\t[IEditorProgressService, new class implements IEditorProgressService {\n\t\t\t\t_serviceBrand: undefined;\n\t\t\t\tshow(_total: unknown, _delay?: unknown) {\n\t\t\t\t\treturn emptyProgressRunner;\n\t\t\t\t}\n\t\t\t\tasync showWhile(promise: Promise<unknown>, _delay?: number): Promise<void> {\n\t\t\t\t\tawait promise;\n\t\t\t\t}\n\t\t\t}],\n\t\t)));\n\t\tconst editorHeader = this.editorHeader = dom.append(this.element, $('.interactive-result-header.show-file-icons'));\n\t\tconst editorElement = dom.append(this.element, $('.interactive-result-editor'));\n\t\tthis.diffEditor = this.createDiffEditor(scopedInstantiationService, editorElement, {\n\t\t\t...getSimpleEditorOptions(this.configurationService),\n\t\t\tlineNumbers: 'on',\n\t\t\tselectOnLineNumbers: true,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tlineDecorationsWidth: 12,\n\t\t\tdragAndDrop: false,\n\t\t\tpadding: { top: defaultCodeblockPadding, bottom: defaultCodeblockPadding },\n\t\t\tmouseWheelZoom: false,\n\t\t\tscrollbar: {\n\t\t\t\tvertical: 'hidden',\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\tdefinitionLinkOpensInPeek: false,\n\t\t\tgotoLocation: {\n\t\t\t\tmultiple: 'goto',\n\t\t\t\tmultipleDeclarations: 'goto',\n\t\t\t\tmultipleDefinitions: 'goto',\n\t\t\t\tmultipleImplementations: 'goto',\n\t\t\t},\n\t\t\tariaLabel: localize('chat.codeBlockHelp', 'Code block'),\n\t\t\toverflowWidgetsDomNode,\n\t\t\t...this.getEditorOptionsFromConfig(),\n\t\t});\n\n\t\tthis.resourceLabel = this._register(scopedInstantiationService.createInstance(ResourceLabel, editorHeader, { supportIcons: true }));\n\n\t\tconst editorScopedService = this.diffEditor.getModifiedEditor().contextKeyService.createScoped(editorHeader);\n\t\tconst editorScopedInstantiationService = this._register(scopedInstantiationService.createChild(new ServiceCollection([IContextKeyService, editorScopedService])));\n\t\tthis.toolbar = this._register(editorScopedInstantiationService.createInstance(MenuWorkbenchToolBar, editorHeader, menuId, {\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t}\n\t\t}));\n\n\t\tthis._configureForScreenReader();\n\t\tthis._register(this.accessibilityService.onDidChangeScreenReaderOptimized(() => this._configureForScreenReader()));\n\t\tthis._register(this.configurationService.onDidChangeConfiguration((e) => {\n\t\t\tif (e.affectedKeys.has(AccessibilityVerbositySettingId.Chat)) {\n\t\t\t\tthis._configureForScreenReader();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.options.onDidChange(() => {\n\t\t\tthis.diffEditor.updateOptions(this.getEditorOptionsFromConfig());\n\t\t}));\n\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidScrollChange(e => {\n\t\t\tthis.currentScrollWidth = e.scrollWidth;\n\t\t}));\n\t\tthis._register(this.diffEditor.onDidContentSizeChange(e => {\n\t\t\tif (e.contentHeightChanged) {\n\t\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidBlurEditorWidget(() => {\n\t\t\tthis.element.classList.remove('focused');\n\t\t\tWordHighlighterContribution.get(this.diffEditor.getModifiedEditor())?.stopHighlighting();\n\t\t\tthis.clearWidgets();\n\t\t}));\n\t\tthis._register(this.diffEditor.getModifiedEditor().onDidFocusEditorWidget(() => {\n\t\t\tthis.element.classList.add('focused');\n\t\t\tWordHighlighterContribution.get(this.diffEditor.getModifiedEditor())?.restoreViewState(true);\n\t\t}));\n\n\n\t\t// Parent list scrolled\n\t\tif (delegate.onDidScroll) {\n\t\t\tthis._register(delegate.onDidScroll(e => {\n\t\t\t\tthis.clearWidgets();\n\t\t\t}));\n\t\t}\n\t}\n\n\tget uri(): URI | undefined {\n\t\treturn this.diffEditor.getModifiedEditor().getModel()?.uri;\n\t}\n\n\tprivate createDiffEditor(instantiationService: IInstantiationService, parent: HTMLElement, options: Readonly<IEditorConstructionOptions>): DiffEditorWidget {\n\t\tconst widgetOptions: ICodeEditorWidgetOptions = {\n\t\t\tisSimpleWidget: this.isSimpleWidget,\n\t\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tMenuPreventer.ID,\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\n\t\t\t\tWordHighlighterContribution.ID,\n\t\t\t\tViewportSemanticTokensContribution.ID,\n\t\t\t\tBracketMatchingController.ID,\n\t\t\t\tSmartSelectController.ID,\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t\tGotoDefinitionAtPositionEditorContribution.ID,\n\t\t\t])\n\t\t};\n\n\t\treturn this._register(instantiationService.createInstance(DiffEditorWidget, parent, {\n\t\t\tscrollbar: { useShadows: false, alwaysConsumeMouseWheel: false, ignoreHorizontalScrollbarInContentHeight: true, },\n\t\t\trenderMarginRevertIcon: false,\n\t\t\tdiffCodeLens: false,\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tstickyScroll: { enabled: false },\n\t\t\toriginalAriaLabel: localize('original', 'Original'),\n\t\t\tmodifiedAriaLabel: localize('modified', 'Modified'),\n\t\t\tdiffAlgorithm: 'advanced',\n\t\t\treadOnly: false,\n\t\t\tisInEmbeddedEditor: true,\n\t\t\tuseInlineViewWhenSpaceIsLimited: true,\n\t\t\texperimental: {\n\t\t\t\tuseTrueInlineView: true,\n\t\t\t},\n\t\t\trenderSideBySideInlineBreakpoint: 300,\n\t\t\trenderOverviewRuler: false,\n\t\t\tcompactMode: true,\n\t\t\thideUnchangedRegions: { enabled: true, contextLineCount: 1 },\n\t\t\trenderGutterMenu: false,\n\t\t\tlineNumbersMinChars: 1,\n\t\t\t...options\n\t\t}, { originalEditor: widgetOptions, modifiedEditor: widgetOptions }));\n\t}\n\n\tfocus(): void {\n\t\tthis.diffEditor.focus();\n\t}\n\n\tprivate updatePaddingForLayout() {\n\t\t// scrollWidth = \"the width of the content that needs to be scrolled\"\n\t\t// contentWidth = \"the width of the area where content is displayed\"\n\t\tconst horizontalScrollbarVisible = this.currentScrollWidth > this.diffEditor.getModifiedEditor().getLayoutInfo().contentWidth;\n\t\tconst scrollbarHeight = this.diffEditor.getModifiedEditor().getLayoutInfo().horizontalScrollbarHeight;\n\t\tconst bottomPadding = horizontalScrollbarVisible ?\n\t\t\tMath.max(defaultCodeblockPadding - scrollbarHeight, 2) :\n\t\t\tdefaultCodeblockPadding;\n\t\tthis.diffEditor.updateOptions({ padding: { top: defaultCodeblockPadding, bottom: bottomPadding } });\n\t}\n\n\tprivate _configureForScreenReader(): void {\n\t\tconst toolbarElt = this.toolbar.getElement();\n\t\tif (this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\ttoolbarElt.style.display = 'block';\n\t\t\ttoolbarElt.ariaLabel = localize('chat.codeBlock.toolbar', 'Code block toolbar');\n\t\t} else {\n\t\t\ttoolbarElt.style.display = '';\n\t\t}\n\t}\n\n\tprivate getEditorOptionsFromConfig(): IEditorOptions {\n\t\treturn {\n\t\t\twordWrap: this.options.configuration.resultEditor.wordWrap,\n\t\t\tfontLigatures: this.options.configuration.resultEditor.fontLigatures,\n\t\t\tbracketPairColorization: this.options.configuration.resultEditor.bracketPairColorization,\n\t\t\tfontFamily: this.options.configuration.resultEditor.fontFamily === 'default' ?\n\t\t\t\tEDITOR_FONT_DEFAULTS.fontFamily :\n\t\t\t\tthis.options.configuration.resultEditor.fontFamily,\n\t\t\tfontSize: this.options.configuration.resultEditor.fontSize,\n\t\t\tfontWeight: this.options.configuration.resultEditor.fontWeight,\n\t\t\tlineHeight: this.options.configuration.resultEditor.lineHeight,\n\t\t};\n\t}\n\n\tlayout(width: number): void {\n\t\tconst editorBorder = 2;\n\n\t\tconst toolbar = dom.getTotalHeight(this.editorHeader);\n\t\tconst content = this.diffEditor.getModel()\n\t\t\t? this.diffEditor.getContentHeight()\n\t\t\t: dom.getTotalHeight(this.messageElement);\n\n\t\tconst dimension = new dom.Dimension(width - editorBorder - this.currentHorizontalPadding * 2, toolbar + content);\n\t\tthis.element.style.height = `${dimension.height}px`;\n\t\tthis.element.style.width = `${dimension.width}px`;\n\t\tthis.diffEditor.layout(dimension.with(undefined, content - editorBorder));\n\t\tthis.updatePaddingForLayout();\n\t}\n\n\n\tasync render(data: ICodeCompareBlockData, width: number, token: CancellationToken) {\n\t\tthis.currentHorizontalPadding = data.horizontalPadding || 0;\n\n\t\tif (data.parentContextKeyService) {\n\t\t\tthis.contextKeyService.updateParent(data.parentContextKeyService);\n\t\t}\n\n\t\tif (this.options.configuration.resultEditor.wordWrap === 'on') {\n\t\t\t// Initialize the editor with the new proper width so that getContentHeight\n\t\t\t// will be computed correctly in the next call to layout()\n\t\t\tthis.layout(width);\n\t\t}\n\n\t\tawait this.updateEditor(data, token);\n\n\t\tthis.layout(width);\n\t\tthis.diffEditor.updateOptions({\n\t\t\tariaLabel: localize('chat.compareCodeBlockLabel', \"Code Edits\"),\n\t\t\treadOnly: !!data.isReadOnly,\n\t\t});\n\n\t\tthis.resourceLabel.element.setFile(data.edit.uri, {\n\t\t\tfileKind: FileKind.FILE,\n\t\t\tfileDecorations: { colors: true, badges: false }\n\t\t});\n\n\t\tthis._onDidChangeContentHeight.fire();\n\t}\n\n\treset() {\n\t\tthis.clearWidgets();\n\t}\n\n\tprivate clearWidgets() {\n\t\tContentHoverController.get(this.diffEditor.getOriginalEditor())?.hideContentHover();\n\t\tContentHoverController.get(this.diffEditor.getModifiedEditor())?.hideContentHover();\n\t\tGlyphHoverController.get(this.diffEditor.getOriginalEditor())?.hideGlyphHover();\n\t\tGlyphHoverController.get(this.diffEditor.getModifiedEditor())?.hideGlyphHover();\n\t}\n\n\tprivate async updateEditor(data: ICodeCompareBlockData, token: CancellationToken): Promise<void> {\n\n\t\tif (!isResponseVM(data.element)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isEditApplied = Boolean(data.edit.state?.applied ?? 0);\n\n\t\tChatContextKeys.editApplied.bindTo(this.contextKeyService).set(isEditApplied);\n\n\t\tthis.element.classList.toggle('no-diff', isEditApplied);\n\n\t\tif (isEditApplied) {\n\t\t\tassertType(data.edit.state?.applied);\n\n\t\t\tconst uriLabel = this.labelService.getUriLabel(data.edit.uri, { relative: true, noPrefix: true });\n\n\t\t\tlet template: string;\n\t\t\tif (data.edit.state.applied === 1) {\n\t\t\t\ttemplate = localize('chat.edits.1', \"Applied 1 change in [[``{0}``]]\", uriLabel);\n\t\t\t} else if (data.edit.state.applied < 0) {\n\t\t\t\ttemplate = localize('chat.edits.rejected', \"Edits in [[``{0}``]] have been rejected\", uriLabel);\n\t\t\t} else {\n\t\t\t\ttemplate = localize('chat.edits.N', \"Applied {0} changes in [[``{1}``]]\", data.edit.state.applied, uriLabel);\n\t\t\t}\n\n\t\t\tconst message = renderFormattedText(template, {\n\t\t\t\trenderCodeSegments: true,\n\t\t\t\tactionHandler: {\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.openerService.open(data.edit.uri, { fromUserGesture: true, allowCommands: false });\n\t\t\t\t\t},\n\t\t\t\t\tdisposables: this._store,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdom.reset(this.messageElement, message);\n\t\t}\n\n\t\tconst diffData = await data.diffData;\n\n\t\tif (!isEditApplied && diffData) {\n\t\t\tconst viewModel = this.diffEditor.createViewModel({\n\t\t\t\toriginal: diffData.original,\n\t\t\t\tmodified: diffData.modified\n\t\t\t});\n\n\t\t\tawait viewModel.waitForDiff();\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst listener = Event.any(diffData.original.onWillDispose, diffData.modified.onWillDispose)(() => {\n\t\t\t\t// this a bit weird and basically duplicates https://github.com/microsoft/vscode/blob/7cbcafcbcc88298cfdcd0238018fbbba8eb6853e/src/vs/editor/browser/widget/diffEditor/diffEditorWidget.ts#L328\n\t\t\t\t// which cannot call `setModel(null)` without first complaining\n\t\t\t\tthis.diffEditor.setModel(null);\n\t\t\t});\n\t\t\tthis.diffEditor.setModel(viewModel);\n\t\t\tthis._lastDiffEditorViewModel.value = combinedDisposable(listener, viewModel);\n\n\t\t} else {\n\t\t\tthis.diffEditor.setModel(null);\n\t\t\tthis._lastDiffEditorViewModel.value = undefined;\n\t\t\tthis._onDidChangeContentHeight.fire();\n\t\t}\n\n\t\tthis.toolbar.context = {\n\t\t\tedit: data.edit,\n\t\t\telement: data.element,\n\t\t\tdiffEditor: this.diffEditor,\n\t\t} satisfies ICodeCompareBlockActionContext;\n\t}\n}\n\nexport class DefaultChatTextEditor {\n\n\tprivate readonly _sha1 = new DefaultModelSHA1Computer();\n\n\tconstructor(\n\t\t@ITextModelService private readonly modelService: ITextModelService,\n\t\t@ICodeEditorService private readonly editorService: ICodeEditorService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t) { }\n\n\tasync apply(response: IChatResponseModel | IChatResponseViewModel, item: IChatTextEditGroup, diffEditor: IDiffEditor | undefined): Promise<void> {\n\n\t\tif (!response.response.value.includes(item)) {\n\t\t\t// bogous item\n\t\t\treturn;\n\t\t}\n\n\t\tif (item.state?.applied) {\n\t\t\t// already applied\n\t\t\treturn;\n\t\t}\n\n\t\tif (!diffEditor) {\n\t\t\tfor (const candidate of this.editorService.listDiffEditors()) {\n\t\t\t\tif (!candidate.getContainerDomNode().isConnected) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst model = candidate.getModel();\n\t\t\t\tif (!model || !isEqual(model.original.uri, item.uri) || model.modified.uri.scheme !== Schemas.vscodeChatCodeCompareBlock) {\n\t\t\t\t\tdiffEditor = candidate;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst edits = diffEditor\n\t\t\t? await this._applyWithDiffEditor(diffEditor, item)\n\t\t\t: await this._apply(item);\n\n\t\tresponse.setEditApplied(item, edits);\n\t}\n\n\tprivate async _applyWithDiffEditor(diffEditor: IDiffEditor, item: IChatTextEditGroup) {\n\t\tconst model = diffEditor.getModel();\n\t\tif (!model) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst diff = diffEditor.getDiffComputationResult();\n\t\tif (!diff || diff.identical) {\n\t\t\treturn 0;\n\t\t}\n\n\n\t\tif (!await this._checkSha1(model.original, item)) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst modified = new TextModelText(model.modified);\n\t\tconst edits = diff.changes2.map(i => i.toRangeMapping().toTextEdit(modified).toSingleEditOperation());\n\n\t\tmodel.original.pushStackElement();\n\t\tmodel.original.pushEditOperations(null, edits, () => null);\n\t\tmodel.original.pushStackElement();\n\n\t\treturn edits.length;\n\t}\n\n\tprivate async _apply(item: IChatTextEditGroup) {\n\t\tconst ref = await this.modelService.createModelReference(item.uri);\n\t\ttry {\n\n\t\t\tif (!await this._checkSha1(ref.object.textEditorModel, item)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tref.object.textEditorModel.pushStackElement();\n\t\t\tlet total = 0;\n\t\t\tfor (const group of item.edits) {\n\t\t\t\tconst edits = group.map(TextEdit.asEditOperation);\n\t\t\t\tref.object.textEditorModel.pushEditOperations(null, edits, () => null);\n\t\t\t\ttotal += edits.length;\n\t\t\t}\n\t\t\tref.object.textEditorModel.pushStackElement();\n\t\t\treturn total;\n\n\t\t} finally {\n\t\t\tref.dispose();\n\t\t}\n\t}\n\n\tprivate async _checkSha1(model: ITextModel, item: IChatTextEditGroup) {\n\t\tif (item.state?.sha1 && this._sha1.computeSHA1(model) && this._sha1.computeSHA1(model) !== item.state.sha1) {\n\t\t\tconst result = await this.dialogService.confirm({\n\t\t\t\tmessage: localize('interactive.compare.apply.confirm', \"The original file has been modified.\"),\n\t\t\t\tdetail: localize('interactive.compare.apply.confirm.detail', \"Do you want to apply the changes anyway?\"),\n\t\t\t});\n\n\t\t\tif (!result.confirmed) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tdiscard(response: IChatResponseModel | IChatResponseViewModel, item: IChatTextEditGroup) {\n\t\tif (!response.response.value.includes(item)) {\n\t\t\t// bogous item\n\t\t\treturn;\n\t\t}\n\n\t\tif (item.state?.applied) {\n\t\t\t// already applied\n\t\t\treturn;\n\t\t}\n\n\t\tresponse.setEditApplied(item, -1);\n\t}\n\n\n}\n"]}