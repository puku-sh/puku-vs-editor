{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatEditing/simpleBrowserEditorOverlay.ts"],"names":[],"mappings":"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","file":"simpleBrowserEditorOverlay.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport '../media/simpleBrowserOverlay.css';\nimport { combinedDisposable, DisposableMap, DisposableStore, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, derivedOpts, observableFromEvent, observableSignalFromEvent } from '../../../../../base/common/observable.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { localize } from '../../../../../nls.js';\nimport { IWorkbenchContribution } from '../../../../common/contributions.js';\nimport { IEditorGroup, IEditorGroupsService } from '../../../../services/editor/common/editorGroupsService.js';\nimport { EditorGroupView } from '../../../../browser/parts/editor/editorGroupView.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { ServiceCollection } from '../../../../../platform/instantiation/common/serviceCollection.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { EditorResourceAccessor, SideBySideEditor } from '../../../../common/editor.js';\nimport { isEqual, joinPath } from '../../../../../base/common/resources.js';\nimport { CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { IHostService } from '../../../../services/host/browser/host.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { Button, ButtonWithDropdown } from '../../../../../base/browser/ui/button/button.js';\nimport { defaultButtonStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { addDisposableListener } from '../../../../../base/browser/dom.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { cleanupOldImages, createFileForMedia } from '../imageUtils.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { IEnvironmentService } from '../../../../../platform/environment/common/environment.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\nimport { IChatRequestVariableEntry } from '../../common/chatVariableEntries.js';\nimport { IPreferencesService } from '../../../../services/preferences/common/preferences.js';\nimport { IBrowserElementsService } from '../../../../services/browserElements/browser/browserElementsService.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IAction, toAction } from '../../../../../base/common/actions.js';\nimport { BrowserType } from '../../../../../platform/browserElements/common/browserElements.js';\n\nclass SimpleBrowserOverlayWidget {\n\n\tprivate readonly _domNode: HTMLElement;\n\n\tprivate readonly imagesFolder: URI;\n\n\tprivate readonly _showStore = new DisposableStore();\n\n\tprivate _timeout: Timeout | undefined = undefined;\n\n\tprivate _activeBrowserType: BrowserType | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly _editor: IEditorGroup,\n\t\tprivate readonly _container: HTMLElement,\n\t\t@IHostService private readonly _hostService: IHostService,\n\t\t@IChatWidgetService private readonly _chatWidgetService: IChatWidgetService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IPreferencesService private readonly _preferencesService: IPreferencesService,\n\t\t@IBrowserElementsService private readonly _browserElementsService: IBrowserElementsService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t) {\n\t\tthis._showStore.add(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('chat.sendElementsToChat.enabled')) {\n\t\t\t\tif (this.configurationService.getValue('chat.sendElementsToChat.enabled')) {\n\t\t\t\t\tthis.showElement(this._domNode);\n\t\t\t\t} else {\n\t\t\t\t\tthis.hideElement(this._domNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.imagesFolder = joinPath(this.environmentService.workspaceStorageHome, 'vscode-chat-images');\n\t\tcleanupOldImages(this.fileService, this.logService, this.imagesFolder);\n\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'element-selection-message';\n\n\t\tconst mainContent = document.createElement('div');\n\t\tmainContent.className = 'element-selection-main-content';\n\n\t\tconst message = document.createElement('span');\n\t\tconst startSelectionMessage = localize('elementSelectionMessage', 'Add element to chat');\n\t\tmessage.textContent = startSelectionMessage;\n\t\tmainContent.appendChild(message);\n\n\t\tlet cts: CancellationTokenSource;\n\t\tconst actions: IAction[] = [];\n\t\tactions.push(\n\t\t\ttoAction({\n\t\t\t\tid: 'singleSelection',\n\t\t\t\tlabel: localize('selectElementDropdown', 'Select an Element'),\n\t\t\t\tenabled: true,\n\t\t\t\trun: async () => { await startElementSelection(); }\n\t\t\t}),\n\t\t\ttoAction({\n\t\t\t\tid: 'continuousSelection',\n\t\t\t\tlabel: localize('continuousSelectionDropdown', 'Continuous Selection'),\n\t\t\t\tenabled: true,\n\t\t\t\trun: async () => {\n\t\t\t\t\tthis._editor.focus();\n\t\t\t\t\tcts = new CancellationTokenSource();\n\t\t\t\t\t// start selection\n\t\t\t\t\tmessage.textContent = localize('elementSelectionInProgress', 'Selecting element...');\n\t\t\t\t\tthis.hideElement(startButton.element);\n\t\t\t\t\tthis.showElement(cancelButton.element);\n\t\t\t\t\tcancelButton.label = localize('finishSelectionLabel', 'Done');\n\t\t\t\t\twhile (!cts.token.isCancellationRequested) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.addElementToChat(cts);\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tthis.logService.error('Failed to select this element.', err);\n\t\t\t\t\t\t\tcts.cancel();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// stop selection\n\t\t\t\t\tmessage.textContent = localize('elementSelectionComplete', 'Element added to chat');\n\t\t\t\t\tfinishedSelecting();\n\t\t\t\t}\n\t\t\t}));\n\n\t\tconst startButton = this._showStore.add(new ButtonWithDropdown(mainContent, {\n\t\t\tactions: actions,\n\t\t\taddPrimaryActionToDropdown: false,\n\t\t\tcontextMenuProvider: this.contextMenuService,\n\t\t\tsupportShortLabel: true,\n\t\t\ttitle: localize('selectAnElement', 'Click to select an element.'),\n\t\t\tsupportIcons: true,\n\t\t\t...defaultButtonStyles\n\t\t}));\n\n\t\tstartButton.primaryButton.label = localize('startSelection', 'Start');\n\t\tstartButton.element.classList.add('element-selection-start');\n\n\t\tconst cancelButton = this._showStore.add(new Button(mainContent, { ...defaultButtonStyles, supportIcons: true, title: localize('cancelSelection', 'Click to cancel selection.') }));\n\t\tcancelButton.element.className = 'element-selection-cancel hidden';\n\t\tconst cancelButtonLabel = localize('cancelSelectionLabel', 'Cancel');\n\t\tcancelButton.label = cancelButtonLabel;\n\n\t\tconst configure = this._showStore.add(new Button(mainContent, { supportIcons: true, title: localize('chat.configureElements', \"Configure Attachments Sent\") }));\n\t\tconfigure.icon = Codicon.gear;\n\n\t\tconst collapseOverlay = this._showStore.add(new Button(mainContent, { supportIcons: true, title: localize('chat.hideOverlay', \"Collapse Overlay\") }));\n\t\tcollapseOverlay.icon = Codicon.chevronRight;\n\n\t\tconst nextSelection = this._showStore.add(new Button(mainContent, { supportIcons: true, title: localize('chat.nextSelection', \"Select Again\") }));\n\t\tnextSelection.icon = Codicon.close;\n\t\tnextSelection.element.classList.add('hidden');\n\n\t\t// shown if the overlay is collapsed\n\t\tconst expandContainer = document.createElement('div');\n\t\texpandContainer.className = 'element-expand-container hidden';\n\t\tconst expandOverlay = this._showStore.add(new Button(expandContainer, { supportIcons: true, title: localize('chat.expandOverlay', \"Expand Overlay\") }));\n\t\texpandOverlay.icon = Codicon.layout;\n\n\t\tthis._domNode.appendChild(mainContent);\n\t\tthis._domNode.appendChild(expandContainer);\n\n\t\tconst resetButtons = () => {\n\t\t\tthis.hideElement(nextSelection.element);\n\t\t\tthis.showElement(startButton.element);\n\t\t\tthis.showElement(collapseOverlay.element);\n\t\t};\n\n\t\tconst finishedSelecting = () => {\n\t\t\t// stop selection\n\t\t\tthis.hideElement(cancelButton.element);\n\t\t\tcancelButton.label = cancelButtonLabel;\n\t\t\tthis.hideElement(collapseOverlay.element);\n\t\t\tthis.showElement(nextSelection.element);\n\n\t\t\t// wait 3 seconds before showing the start button again unless cancelled out.\n\t\t\tthis._timeout = setTimeout(() => {\n\t\t\t\tmessage.textContent = startSelectionMessage;\n\t\t\t\tresetButtons();\n\t\t\t}, 3000);\n\t\t};\n\n\t\tconst startElementSelection = async () => {\n\t\t\tcts = new CancellationTokenSource();\n\t\t\tthis._editor.focus();\n\n\t\t\t// start selection\n\t\t\tmessage.textContent = localize('elementSelectionInProgress', 'Selecting element...');\n\t\t\tthis.hideElement(startButton.element);\n\t\t\tthis.showElement(cancelButton.element);\n\t\t\tawait this.addElementToChat(cts);\n\n\t\t\t// stop selection\n\t\t\tmessage.textContent = localize('elementSelectionComplete', 'Element added to chat');\n\t\t\tfinishedSelecting();\n\t\t};\n\n\t\tthis._showStore.add(addDisposableListener(startButton.primaryButton.element, 'click', async () => {\n\t\t\tawait startElementSelection();\n\t\t}));\n\n\t\tthis._showStore.add(addDisposableListener(cancelButton.element, 'click', () => {\n\t\t\tcts.cancel();\n\t\t\tmessage.textContent = localize('elementCancelMessage', 'Selection canceled');\n\t\t\tfinishedSelecting();\n\t\t}));\n\n\t\tthis._showStore.add(addDisposableListener(collapseOverlay.element, 'click', () => {\n\t\t\tthis.hideElement(mainContent);\n\t\t\tthis.showElement(expandContainer);\n\t\t}));\n\n\t\tthis._showStore.add(addDisposableListener(expandOverlay.element, 'click', () => {\n\t\t\tthis.showElement(mainContent);\n\t\t\tthis.hideElement(expandContainer);\n\t\t}));\n\n\t\tthis._showStore.add(addDisposableListener(nextSelection.element, 'click', () => {\n\t\t\tclearTimeout(this._timeout);\n\t\t\tmessage.textContent = startSelectionMessage;\n\t\t\tresetButtons();\n\t\t}));\n\n\t\tthis._showStore.add(addDisposableListener(configure.element, 'click', () => {\n\t\t\tthis._preferencesService.openSettings({ jsonEditor: false, query: '@id:chat.sendElementsToChat.enabled,chat.sendElementsToChat.attachCSS,chat.sendElementsToChat.attachImages' });\n\t\t}));\n\t}\n\n\tsetActiveBrowserType(type: BrowserType | undefined) {\n\t\tthis._activeBrowserType = type;\n\t}\n\n\thideElement(element: HTMLElement) {\n\t\tif (element.classList.contains('hidden')) {\n\t\t\treturn;\n\t\t}\n\t\telement.classList.add('hidden');\n\t}\n\n\tshowElement(element: HTMLElement) {\n\t\tif (!element.classList.contains('hidden')) {\n\t\t\treturn;\n\t\t}\n\t\telement.classList.remove('hidden');\n\t}\n\n\tasync addElementToChat(cts: CancellationTokenSource) {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst editorContainer = this._container.querySelector('.editor-container') as HTMLDivElement;\n\t\tconst editorContainerPosition = editorContainer ? editorContainer.getBoundingClientRect() : this._container.getBoundingClientRect();\n\n\t\tconst elementData = await this._browserElementsService.getElementData(editorContainerPosition, cts.token, this._activeBrowserType);\n\t\tif (!elementData) {\n\t\t\tthrow new Error('Element data not found');\n\t\t}\n\t\tconst bounds = elementData.bounds;\n\t\tconst toAttach: IChatRequestVariableEntry[] = [];\n\n\t\tconst widget = await this._chatWidgetService.revealWidget() ?? this._chatWidgetService.lastFocusedWidget;\n\t\tlet value = 'Attached HTML and CSS Context\\n\\n' + elementData.outerHTML;\n\t\tif (this.configurationService.getValue('chat.sendElementsToChat.attachCSS')) {\n\t\t\tvalue += '\\n\\n' + elementData.computedStyle;\n\t\t}\n\t\ttoAttach.push({\n\t\t\tid: 'element-' + Date.now(),\n\t\t\tname: this.getDisplayNameFromOuterHTML(elementData.outerHTML),\n\t\t\tfullName: this.getDisplayNameFromOuterHTML(elementData.outerHTML),\n\t\t\tvalue: value,\n\t\t\tkind: 'element',\n\t\t\ticon: ThemeIcon.fromId(Codicon.layout.id),\n\t\t});\n\n\t\tif (this.configurationService.getValue('chat.sendElementsToChat.attachImages')) {\n\t\t\t// remove container so we don't block anything on screenshot\n\t\t\tthis._domNode.style.display = 'none';\n\n\t\t\t// Wait 1 extra frame to make sure overlay is gone\n\t\t\tawait new Promise(resolve => setTimeout(resolve, 100));\n\n\t\t\tconst screenshot = await this._hostService.getScreenshot(bounds);\n\t\t\tif (!screenshot) {\n\t\t\t\tthrow new Error('Screenshot failed');\n\t\t\t}\n\t\t\tconst fileReference = await createFileForMedia(this.fileService, this.imagesFolder, screenshot.buffer, 'image/png');\n\t\t\ttoAttach.push({\n\t\t\t\tid: 'element-screenshot-' + Date.now(),\n\t\t\t\tname: 'Element Screenshot',\n\t\t\t\tfullName: 'Element Screenshot',\n\t\t\t\tkind: 'image',\n\t\t\t\tvalue: screenshot.buffer,\n\t\t\t\treferences: fileReference ? [{ reference: fileReference, kind: 'reference' }] : [],\n\t\t\t});\n\n\t\t\tthis._domNode.style.display = '';\n\t\t}\n\n\t\twidget?.attachmentModel?.addContext(...toAttach);\n\t}\n\n\n\tgetDisplayNameFromOuterHTML(outerHTML: string): string {\n\t\tconst firstElementMatch = outerHTML.match(/^<(\\w+)([^>]*?)>/);\n\t\tif (!firstElementMatch) {\n\t\t\tthrow new Error('No outer element found');\n\t\t}\n\n\t\tconst tagName = firstElementMatch[1];\n\t\tconst idMatch = firstElementMatch[2].match(/\\s+id\\s*=\\s*[\"']([^\"']+)[\"']/i);\n\t\tconst id = idMatch ? `#${idMatch[1]}` : '';\n\t\tconst classMatch = firstElementMatch[2].match(/\\s+class\\s*=\\s*[\"']([^\"']+)[\"']/i);\n\t\tconst className = classMatch ? `.${classMatch[1].replace(/\\s+/g, '.')}` : '';\n\t\treturn `${tagName}${id}${className}`;\n\t}\n\n\tdispose() {\n\t\tthis._showStore.dispose();\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n}\n\nclass SimpleBrowserOverlayController {\n\n\tprivate readonly _store = new DisposableStore();\n\n\tprivate readonly _domNode = document.createElement('div');\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tgroup: IEditorGroup,\n\t\t@IInstantiationService instaService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IBrowserElementsService private readonly _browserElementsService: IBrowserElementsService,\n\t) {\n\n\t\tif (!this.configurationService.getValue('chat.sendElementsToChat.enabled')) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domNode.classList.add('chat-simple-browser-overlay');\n\t\tthis._domNode.style.position = 'absolute';\n\t\tthis._domNode.style.bottom = `5px`;\n\t\tthis._domNode.style.right = `5px`;\n\t\tthis._domNode.style.zIndex = `100`;\n\n\t\tconst widget = instaService.createInstance(SimpleBrowserOverlayWidget, group, container);\n\t\tthis._domNode.appendChild(widget.getDomNode());\n\t\tthis._store.add(toDisposable(() => this._domNode.remove()));\n\t\tthis._store.add(widget);\n\n\t\tconst connectingWebviewElement = document.createElement('div');\n\t\tconnectingWebviewElement.className = 'connecting-webview-element';\n\n\n\t\tconst getActiveBrowserType = () => {\n\t\t\tconst editor = group.activeEditorPane;\n\t\t\tconst isSimpleBrowser = editor?.input.editorId === 'mainThreadWebview-simpleBrowser.view';\n\t\t\tconst isLiveServer = editor?.input.editorId === 'mainThreadWebview-browserPreview';\n\t\t\treturn isSimpleBrowser ? BrowserType.SimpleBrowser : isLiveServer ? BrowserType.LiveServer : undefined;\n\t\t};\n\n\t\tlet cts = new CancellationTokenSource();\n\t\tconst show = async () => {\n\t\t\t// Show the connecting indicator while establishing the session\n\t\t\tconnectingWebviewElement.textContent = localize('connectingWebviewElement', 'Connecting to webview...');\n\t\t\tif (!container.contains(connectingWebviewElement)) {\n\t\t\t\tcontainer.appendChild(connectingWebviewElement);\n\t\t\t}\n\n\t\t\tcts = new CancellationTokenSource();\n\t\t\tconst activeBrowserType = getActiveBrowserType();\n\t\t\tif (activeBrowserType) {\n\t\t\t\ttry {\n\t\t\t\t\tawait this._browserElementsService.startDebugSession(cts.token, activeBrowserType);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconnectingWebviewElement.textContent = localize('reopenErrorWebviewElement', 'Please reopen the preview.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!container.contains(this._domNode)) {\n\t\t\t\tcontainer.appendChild(this._domNode);\n\t\t\t}\n\t\t\tconnectingWebviewElement.remove();\n\t\t};\n\n\t\tconst hide = () => {\n\t\t\tif (container.contains(this._domNode)) {\n\t\t\t\tcts.cancel();\n\t\t\t\tthis._domNode.remove();\n\t\t\t}\n\t\t\tconnectingWebviewElement.remove();\n\t\t};\n\n\t\tconst activeEditorSignal = observableSignalFromEvent(this, Event.any(group.onDidActiveEditorChange, group.onDidModelChange));\n\n\t\tconst activeUriObs = derivedOpts({ equalsFn: isEqual }, r => {\n\n\t\t\tactiveEditorSignal.read(r); // signal\n\n\t\t\tconst editor = group.activeEditorPane;\n\n\t\t\tconst activeBrowser = getActiveBrowserType();\n\t\t\twidget.setActiveBrowserType(activeBrowser);\n\n\t\t\tif (activeBrowser) {\n\t\t\t\tconst uri = EditorResourceAccessor.getOriginalUri(editor?.input, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\n\t\tthis._store.add(autorun(r => {\n\n\t\t\tconst data = activeUriObs.read(r);\n\n\t\t\tif (!data) {\n\t\t\t\thide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshow();\n\t\t}));\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n\nexport class SimpleBrowserOverlay implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'chat.simpleBrowser.overlay';\n\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IEditorGroupsService editorGroupsService: IEditorGroupsService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tconst editorGroups = observableFromEvent(\n\t\t\tthis,\n\t\t\tEvent.any(editorGroupsService.onDidAddGroup, editorGroupsService.onDidRemoveGroup),\n\t\t\t() => editorGroupsService.groups\n\t\t);\n\n\t\tconst overlayWidgets = new DisposableMap<IEditorGroup>();\n\n\t\tthis._store.add(autorun(r => {\n\n\t\t\tconst toDelete = new Set(overlayWidgets.keys());\n\t\t\tconst groups = editorGroups.read(r);\n\n\n\t\t\tfor (const group of groups) {\n\n\t\t\t\tif (!(group instanceof EditorGroupView)) {\n\t\t\t\t\t// TODO@jrieken better with https://github.com/microsoft/vscode/tree/ben/layout-group-container\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttoDelete.delete(group); // we keep the widget for this group!\n\n\t\t\t\tif (!overlayWidgets.has(group)) {\n\n\t\t\t\t\tconst scopedInstaService = instantiationService.createChild(\n\t\t\t\t\t\tnew ServiceCollection([IContextKeyService, group.scopedContextKeyService])\n\t\t\t\t\t);\n\n\t\t\t\t\tconst container = group.element;\n\n\n\t\t\t\t\tconst ctrl = scopedInstaService.createInstance(SimpleBrowserOverlayController, container, group);\n\t\t\t\t\toverlayWidgets.set(group, combinedDisposable(ctrl, scopedInstaService));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const group of toDelete) {\n\t\t\t\toverlayWidgets.deleteAndDispose(group);\n\t\t\t}\n\t\t}));\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n"]}