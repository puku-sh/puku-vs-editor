{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatListRenderer.ts"],"names":[],"mappings":"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","file":"chatListRenderer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './chatContentParts/media/chatMcpServersInteractionContent.css';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderFormattedText } from '../../../../base/browser/formattedTextRenderer.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IActionViewItemOptions } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { DropdownMenuActionViewItem, IDropdownMenuActionViewItemOptions } from '../../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { IListElementRenderDetails, IListVirtualDelegate } from '../../../../base/browser/ui/list/list.js';\nimport { ITreeNode, ITreeRenderer } from '../../../../base/browser/ui/tree/tree.js';\nimport { IAction } from '../../../../base/common/actions.js';\nimport { coalesce, distinct } from '../../../../base/common/arrays.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { toErrorMessage } from '../../../../base/common/errorMessage.js';\nimport { canceledName } from '../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { IMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { KeyCode } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore, IDisposable, dispose, thenIfNotDisposed, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { FileAccess } from '../../../../base/common/network.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IMarkdownRenderer } from '../../../../platform/markdown/browser/markdownRenderer.js';\nimport { localize } from '../../../../nls.js';\nimport { IMenuEntryActionViewItemOptions, createActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { MenuWorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { isDark } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IWorkbenchIssueService } from '../../issue/common/issue.js';\nimport { CodiconActionViewItem } from '../../notebook/browser/view/cellParts/cellActionView.js';\nimport { annotateSpecialMarkdownContent } from '../common/annotations.js';\nimport { checkModeOption } from '../common/chat.js';\nimport { IChatAgentMetadata } from '../common/chatAgents.js';\nimport { ChatContextKeys } from '../common/chatContextKeys.js';\nimport { IChatTextEditGroup } from '../common/chatModel.js';\nimport { chatSubcommandLeader } from '../common/chatParserTypes.js';\nimport { ChatAgentVoteDirection, ChatAgentVoteDownReason, ChatErrorLevel, IChatChangesSummary, IChatConfirmation, IChatContentReference, IChatElicitationRequest, IChatElicitationRequestSerialized, IChatExtensionsContent, IChatFollowup, IChatMarkdownContent, IChatMcpServersStarting, IChatMultiDiffData, IChatPullRequestContent, IChatTask, IChatTaskSerialized, IChatThinkingPart, IChatToolInvocation, IChatToolInvocationSerialized, IChatTreeData, IChatUndoStop, isChatFollowup } from '../common/chatService.js';\nimport { IChatRequestVariableEntry } from '../common/chatVariableEntries.js';\nimport { IChatChangesSummaryPart, IChatCodeCitations, IChatErrorDetailsPart, IChatReferences, IChatRendererContent, IChatRequestViewModel, IChatResponseViewModel, IChatViewModel, isRequestVM, isResponseVM } from '../common/chatViewModel.js';\nimport { getNWords } from '../common/chatWordCounter.js';\nimport { CodeBlockModelCollection } from '../common/codeBlockModelCollection.js';\nimport { ChatAgentLocation, ChatConfiguration, ChatModeKind, ThinkingDisplayMode } from '../common/constants.js';\nimport { MarkUnhelpfulActionId } from './actions/chatTitleActions.js';\nimport { ChatTreeItem, IChatCodeBlockInfo, IChatFileTreeInfo, IChatListItemRendererOptions, IChatWidgetService } from './chat.js';\nimport { ChatAgentHover, getChatAgentHoverOptions } from './chatAgentHover.js';\nimport { ChatAgentCommandContentPart } from './chatContentParts/chatAgentCommandContentPart.js';\nimport { ChatAttachmentsContentPart } from './chatContentParts/chatAttachmentsContentPart.js';\nimport { ChatCheckpointFileChangesSummaryContentPart } from './chatContentParts/chatChangesSummaryPart.js';\nimport { ChatCodeCitationContentPart } from './chatContentParts/chatCodeCitationContentPart.js';\nimport { ChatCommandButtonContentPart } from './chatContentParts/chatCommandContentPart.js';\nimport { ChatConfirmationContentPart } from './chatContentParts/chatConfirmationContentPart.js';\nimport { IChatContentPart, IChatContentPartRenderContext } from './chatContentParts/chatContentParts.js';\nimport { ChatElicitationContentPart } from './chatContentParts/chatElicitationContentPart.js';\nimport { ChatErrorConfirmationContentPart } from './chatContentParts/chatErrorConfirmationPart.js';\nimport { ChatErrorContentPart } from './chatContentParts/chatErrorContentPart.js';\nimport { ChatExtensionsContentPart } from './chatContentParts/chatExtensionsContentPart.js';\nimport { ChatMarkdownContentPart } from './chatContentParts/chatMarkdownContentPart.js';\nimport { ChatMcpServersInteractionContentPart } from './chatContentParts/chatMcpServersInteractionContentPart.js';\nimport { ChatMultiDiffContentPart } from './chatContentParts/chatMultiDiffContentPart.js';\nimport { ChatProgressContentPart, ChatWorkingProgressContentPart } from './chatContentParts/chatProgressContentPart.js';\nimport { ChatPullRequestContentPart } from './chatContentParts/chatPullRequestContentPart.js';\nimport { ChatQuotaExceededPart } from './chatContentParts/chatQuotaExceededPart.js';\nimport { ChatCollapsibleListContentPart, ChatUsedReferencesListContentPart, CollapsibleListPool } from './chatContentParts/chatReferencesContentPart.js';\nimport { ChatTaskContentPart } from './chatContentParts/chatTaskContentPart.js';\nimport { ChatTextEditContentPart } from './chatContentParts/chatTextEditContentPart.js';\nimport { ChatThinkingContentPart } from './chatContentParts/chatThinkingContentPart.js';\nimport { ChatTreeContentPart, TreePool } from './chatContentParts/chatTreeContentPart.js';\nimport { ChatToolInvocationPart } from './chatContentParts/toolInvocationParts/chatToolInvocationPart.js';\nimport { ChatMarkdownDecorationsRenderer } from './chatMarkdownDecorationsRenderer.js';\nimport { ChatContentMarkdownRenderer } from './chatContentMarkdownRenderer.js';\nimport { ChatEditorOptions } from './chatOptions.js';\nimport { ChatCodeBlockContentProvider, CodeBlockPart } from './codeBlockPart.js';\nimport { ChatAnonymousRateLimitedPart } from './chatContentParts/chatAnonymousRateLimitedPart.js';\nimport { IChatEntitlementService } from '../../../services/chat/common/chatEntitlementService.js';\nimport { EditorPool, DiffEditorPool } from './chatContentParts/chatContentCodePools.js';\n\nconst $ = dom.$;\n\nconst COPILOT_USERNAME = 'Puku AI';\n\nexport interface IChatListItemTemplate {\n\tcurrentElement?: ChatTreeItem;\n\t/**\n\t * The parts that are currently rendered in the template. Note that these are purposely not added to elementDisposables-\n\t * they are disposed in a separate cycle after diffing with the next content to render.\n\t */\n\trenderedParts?: IChatContentPart[];\n\treadonly rowContainer: HTMLElement;\n\treadonly titleToolbar?: MenuWorkbenchToolBar;\n\treadonly header?: HTMLElement;\n\treadonly footerToolbar: MenuWorkbenchToolBar;\n\treadonly footerDetailsContainer: HTMLElement;\n\treadonly avatarContainer: HTMLElement;\n\treadonly username: HTMLElement;\n\treadonly detail: HTMLElement;\n\treadonly value: HTMLElement;\n\treadonly contextKeyService: IContextKeyService;\n\treadonly instantiationService: IInstantiationService;\n\treadonly templateDisposables: IDisposable;\n\treadonly elementDisposables: DisposableStore;\n\treadonly agentHover: ChatAgentHover;\n\treadonly requestHover: HTMLElement;\n\treadonly disabledOverlay: HTMLElement;\n\treadonly checkpointToolbar: MenuWorkbenchToolBar;\n\treadonly checkpointRestoreToolbar: MenuWorkbenchToolBar;\n\treadonly checkpointContainer: HTMLElement;\n\treadonly checkpointRestoreContainer: HTMLElement;\n}\n\ninterface IItemHeightChangeParams {\n\telement: ChatTreeItem;\n\theight: number;\n}\n\nconst forceVerboseLayoutTracing = false\n\t// || Boolean(\"TRUE\") // causes a linter warning so that it cannot be pushed\n\t;\n\nexport interface IChatRendererDelegate {\n\tcontainer: HTMLElement;\n\tgetListLength(): number;\n\tcurrentChatMode(): ChatModeKind;\n\n\treadonly onDidScroll?: Event<void>;\n}\n\nconst mostRecentResponseClassName = 'chat-most-recent-response';\n\nexport class ChatListItemRenderer extends Disposable implements ITreeRenderer<ChatTreeItem, FuzzyScore, IChatListItemTemplate> {\n\tstatic readonly ID = 'item';\n\n\tprivate readonly codeBlocksByResponseId = new Map<string, IChatCodeBlockInfo[]>();\n\tprivate readonly codeBlocksByEditorUri = new ResourceMap<IChatCodeBlockInfo>();\n\n\tprivate readonly fileTreesByResponseId = new Map<string, IChatFileTreeInfo[]>();\n\tprivate readonly focusedFileTreesByResponseId = new Map<string, number>();\n\n\tprivate readonly templateDataByRequestId = new Map<string, IChatListItemTemplate>();\n\n\tprivate readonly chatContentMarkdownRenderer: IMarkdownRenderer;\n\tprivate readonly markdownDecorationsRenderer: ChatMarkdownDecorationsRenderer;\n\tprotected readonly _onDidClickFollowup = this._register(new Emitter<IChatFollowup>());\n\treadonly onDidClickFollowup: Event<IChatFollowup> = this._onDidClickFollowup.event;\n\n\tprivate readonly _onDidClickRerunWithAgentOrCommandDetection = new Emitter<{ readonly sessionResource: URI; readonly requestId: string }>();\n\treadonly onDidClickRerunWithAgentOrCommandDetection = this._onDidClickRerunWithAgentOrCommandDetection.event;\n\n\n\tprivate readonly _onDidClickRequest = this._register(new Emitter<IChatListItemTemplate>());\n\treadonly onDidClickRequest: Event<IChatListItemTemplate> = this._onDidClickRequest.event;\n\n\tprivate readonly _onDidRerender = this._register(new Emitter<IChatListItemTemplate>());\n\treadonly onDidRerender: Event<IChatListItemTemplate> = this._onDidRerender.event;\n\n\tprivate readonly _onDidDispose = this._register(new Emitter<IChatListItemTemplate>());\n\treadonly onDidDispose: Event<IChatListItemTemplate> = this._onDidDispose.event;\n\n\tprivate readonly _onDidFocusOutside = this._register(new Emitter<void>());\n\treadonly onDidFocusOutside: Event<void> = this._onDidFocusOutside.event;\n\n\tprotected readonly _onDidChangeItemHeight = this._register(new Emitter<IItemHeightChangeParams>());\n\treadonly onDidChangeItemHeight: Event<IItemHeightChangeParams> = this._onDidChangeItemHeight.event;\n\n\tprivate readonly _editorPool: EditorPool;\n\tprivate readonly _toolEditorPool: EditorPool;\n\tprivate readonly _diffEditorPool: DiffEditorPool;\n\tprivate readonly _treePool: TreePool;\n\tprivate readonly _contentReferencesListPool: CollapsibleListPool;\n\tprivate _currentThinkingPart: ChatThinkingContentPart | undefined;\n\tprivate _streamingThinking: boolean = false;\n\n\tprivate _currentLayoutWidth: number = 0;\n\tprivate _isVisible = true;\n\tprivate _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\n\t/**\n\t * Tool invocations get their own so that the ChatViewModel doesn't overwrite it.\n\t * TODO@roblourens shouldn't use the CodeBlockModelCollection at all\n\t */\n\tprivate readonly _toolInvocationCodeBlockCollection: CodeBlockModelCollection;\n\n\t/**\n\t * Prevents re-announcement of already rendered chat progress\n\t * by screen readers\n\t */\n\tprivate readonly _announcedToolProgressKeys = new Set<string>();\n\n\tconstructor(\n\t\teditorOptions: ChatEditorOptions,\n\t\tprivate rendererOptions: IChatListItemRendererOptions,\n\t\tprivate readonly delegate: IChatRendererDelegate,\n\t\tprivate readonly codeBlockModelCollection: CodeBlockModelCollection,\n\t\toverflowWidgetsDomNode: HTMLElement | undefined,\n\t\tprivate viewModel: IChatViewModel | undefined,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configService: IConfigurationService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IHoverService private readonly hoverService: IHoverService,\n\t\t@IChatWidgetService private readonly chatWidgetService: IChatWidgetService,\n\t\t@IChatEntitlementService private readonly chatEntitlementService: IChatEntitlementService\n\t) {\n\t\tsuper();\n\n\t\tthis.chatContentMarkdownRenderer = this.instantiationService.createInstance(ChatContentMarkdownRenderer);\n\t\tthis.markdownDecorationsRenderer = this.instantiationService.createInstance(ChatMarkdownDecorationsRenderer);\n\t\tthis._editorPool = this._register(this.instantiationService.createInstance(EditorPool, editorOptions, delegate, overflowWidgetsDomNode, false));\n\t\tthis._toolEditorPool = this._register(this.instantiationService.createInstance(EditorPool, editorOptions, delegate, overflowWidgetsDomNode, true));\n\t\tthis._diffEditorPool = this._register(this.instantiationService.createInstance(DiffEditorPool, editorOptions, delegate, overflowWidgetsDomNode, false));\n\t\tthis._treePool = this._register(this.instantiationService.createInstance(TreePool, this._onDidChangeVisibility.event));\n\t\tthis._contentReferencesListPool = this._register(this.instantiationService.createInstance(CollapsibleListPool, this._onDidChangeVisibility.event, undefined, undefined));\n\n\t\tthis._register(this.instantiationService.createInstance(ChatCodeBlockContentProvider));\n\t\tthis._toolInvocationCodeBlockCollection = this._register(this.instantiationService.createInstance(CodeBlockModelCollection, 'tools'));\n\t}\n\n\tpublic updateOptions(options: IChatListItemRendererOptions): void {\n\t\tthis.rendererOptions = { ...this.rendererOptions, ...options };\n\t}\n\n\tget templateId(): string {\n\t\treturn ChatListItemRenderer.ID;\n\t}\n\n\teditorsInUse(): Iterable<CodeBlockPart> {\n\t\treturn Iterable.concat(this._editorPool.inUse(), this._toolEditorPool.inUse());\n\t}\n\n\tprivate traceLayout(method: string, message: string) {\n\t\tif (forceVerboseLayoutTracing) {\n\t\t\tthis.logService.info(`ChatListItemRenderer#${method}: ${message}`);\n\t\t} else {\n\t\t\tthis.logService.trace(`ChatListItemRenderer#${method}: ${message}`);\n\t\t}\n\t}\n\n\t/**\n\t * Compute a rate to render at in words/s.\n\t */\n\tprivate getProgressiveRenderRate(element: IChatResponseViewModel): number {\n\t\tconst enum Rate {\n\t\t\tMin = 5,\n\t\t\tMax = 2000,\n\t\t}\n\n\t\tconst minAfterComplete = 80;\n\n\t\tconst rate = element.contentUpdateTimings?.impliedWordLoadRate;\n\t\tif (element.isComplete) {\n\t\t\tif (typeof rate === 'number') {\n\t\t\t\treturn clamp(rate, minAfterComplete, Rate.Max);\n\t\t\t} else {\n\t\t\t\treturn minAfterComplete;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof rate === 'number') {\n\t\t\treturn clamp(rate, Rate.Min, Rate.Max);\n\t\t}\n\n\t\treturn 8;\n\t}\n\n\tgetCodeBlockInfosForResponse(response: IChatResponseViewModel): IChatCodeBlockInfo[] {\n\t\tconst codeBlocks = this.codeBlocksByResponseId.get(response.id);\n\t\treturn codeBlocks ?? [];\n\t}\n\n\tupdateViewModel(viewModel: IChatViewModel | undefined): void {\n\t\tthis.viewModel = viewModel;\n\t\tthis._announcedToolProgressKeys.clear();\n\n\t\tif (this._currentThinkingPart) {\n\t\t\tthis._currentThinkingPart.dispose();\n\t\t\tthis._currentThinkingPart = undefined;\n\t\t}\n\t\tthis._streamingThinking = false;\n\t}\n\n\tgetCodeBlockInfoForEditor(uri: URI): IChatCodeBlockInfo | undefined {\n\t\treturn this.codeBlocksByEditorUri.get(uri);\n\t}\n\n\tgetFileTreeInfosForResponse(response: IChatResponseViewModel): IChatFileTreeInfo[] {\n\t\tconst fileTrees = this.fileTreesByResponseId.get(response.id);\n\t\treturn fileTrees ?? [];\n\t}\n\n\tgetLastFocusedFileTreeForResponse(response: IChatResponseViewModel): IChatFileTreeInfo | undefined {\n\t\tconst fileTrees = this.fileTreesByResponseId.get(response.id);\n\t\tconst lastFocusedFileTreeIndex = this.focusedFileTreesByResponseId.get(response.id);\n\t\tif (fileTrees?.length && lastFocusedFileTreeIndex !== undefined && lastFocusedFileTreeIndex < fileTrees.length) {\n\t\t\treturn fileTrees[lastFocusedFileTreeIndex];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tgetTemplateDataForRequestId(requestId?: string): IChatListItemTemplate | undefined {\n\t\tif (!requestId) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst templateData = this.templateDataByRequestId.get(requestId);\n\t\tif (templateData && templateData.currentElement?.id === requestId) {\n\t\t\treturn templateData;\n\t\t}\n\t\tif (templateData) {\n\t\t\tthis.templateDataByRequestId.delete(requestId);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tsetVisible(visible: boolean): void {\n\t\tthis._isVisible = visible;\n\t\tthis._onDidChangeVisibility.fire(visible);\n\t}\n\n\tlayout(width: number): void {\n\t\tconst newWidth = width - 40; // padding\n\t\tif (newWidth !== this._currentLayoutWidth) {\n\t\t\tthis._currentLayoutWidth = newWidth;\n\t\t\tfor (const editor of this._editorPool.inUse()) {\n\t\t\t\teditor.layout(this._currentLayoutWidth);\n\t\t\t}\n\t\t\tfor (const toolEditor of this._toolEditorPool.inUse()) {\n\t\t\t\ttoolEditor.layout(this._currentLayoutWidth);\n\t\t\t}\n\t\t\tfor (const diffEditor of this._diffEditorPool.inUse()) {\n\t\t\t\tdiffEditor.layout(this._currentLayoutWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\trenderTemplate(container: HTMLElement): IChatListItemTemplate {\n\t\tconst templateDisposables = new DisposableStore();\n\t\tconst disabledOverlay = dom.append(container, $('.chat-row-disabled-overlay'));\n\t\tconst rowContainer = dom.append(container, $('.interactive-item-container'));\n\t\tif (this.rendererOptions.renderStyle === 'compact') {\n\t\t\trowContainer.classList.add('interactive-item-compact');\n\t\t}\n\n\t\tlet headerParent = rowContainer;\n\t\tlet valueParent = rowContainer;\n\t\tlet detailContainerParent: HTMLElement | undefined;\n\n\t\tif (this.rendererOptions.renderStyle === 'minimal') {\n\t\t\trowContainer.classList.add('interactive-item-compact');\n\t\t\trowContainer.classList.add('minimal');\n\t\t\t// -----------------------------------------------------\n\t\t\t//  icon | details\n\t\t\t//       | references\n\t\t\t//       | value\n\t\t\t// -----------------------------------------------------\n\t\t\tconst lhsContainer = dom.append(rowContainer, $('.column.left'));\n\t\t\tconst rhsContainer = dom.append(rowContainer, $('.column.right'));\n\n\t\t\theaderParent = lhsContainer;\n\t\t\tdetailContainerParent = rhsContainer;\n\t\t\tvalueParent = rhsContainer;\n\t\t}\n\n\t\tconst header = dom.append(headerParent, $('.header'));\n\t\tconst contextKeyService = templateDisposables.add(this.contextKeyService.createScoped(rowContainer));\n\t\tconst scopedInstantiationService = templateDisposables.add(this.instantiationService.createChild(new ServiceCollection([IContextKeyService, contextKeyService])));\n\n\t\tconst requestHover = dom.append(rowContainer, $('.request-hover'));\n\t\tlet titleToolbar: MenuWorkbenchToolBar | undefined;\n\t\tif (this.rendererOptions.noHeader) {\n\t\t\theader.classList.add('hidden');\n\t\t} else {\n\t\t\ttitleToolbar = templateDisposables.add(scopedInstantiationService.createInstance(MenuWorkbenchToolBar, requestHover, MenuId.ChatMessageTitle, {\n\t\t\t\tmenuOptions: {\n\t\t\t\t\tshouldForwardArgs: true\n\t\t\t\t},\n\t\t\t\ttoolbarOptions: {\n\t\t\t\t\tshouldInlineSubmenu: submenu => submenu.actions.length <= 1\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\t\tthis.hoverHidden(requestHover);\n\n\t\tconst checkpointContainer = dom.append(rowContainer, $('.checkpoint-container'));\n\t\tconst codiconContainer = dom.append(checkpointContainer, $('.codicon-container'));\n\t\tdom.append(codiconContainer, $('span.codicon.codicon-bookmark'));\n\n\t\tconst checkpointToolbar = templateDisposables.add(scopedInstantiationService.createInstance(MenuWorkbenchToolBar, checkpointContainer, MenuId.ChatMessageCheckpoint, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\treturn this.instantiationService.createInstance(CodiconActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t},\n\t\t\ttoolbarOptions: {\n\t\t\t\tshouldInlineSubmenu: submenu => submenu.actions.length <= 1\n\t\t\t},\n\t\t}));\n\n\t\tdom.append(checkpointContainer, $('.checkpoint-divider'));\n\n\t\tconst user = dom.append(header, $('.user'));\n\t\tconst avatarContainer = dom.append(user, $('.avatar-container'));\n\t\tconst username = dom.append(user, $('h3.username'));\n\t\tusername.tabIndex = 0;\n\t\tconst detailContainer = dom.append(detailContainerParent ?? user, $('span.detail-container'));\n\t\tconst detail = dom.append(detailContainer, $('span.detail'));\n\t\tdom.append(detailContainer, $('span.chat-animated-ellipsis'));\n\t\tconst value = dom.append(valueParent, $('.value'));\n\t\tconst elementDisposables = new DisposableStore();\n\n\t\tconst footerToolbarContainer = dom.append(rowContainer, $('.chat-footer-toolbar'));\n\t\tif (this.rendererOptions.noFooter) {\n\t\t\tfooterToolbarContainer.classList.add('hidden');\n\t\t}\n\n\t\tconst footerToolbar = templateDisposables.add(scopedInstantiationService.createInstance(MenuWorkbenchToolBar, footerToolbarContainer, MenuId.ChatMessageFooter, {\n\t\t\teventDebounceDelay: 0,\n\t\t\tmenuOptions: { shouldForwardArgs: true, renderShortTitle: true },\n\t\t\ttoolbarOptions: { shouldInlineSubmenu: submenu => submenu.actions.length <= 1 },\n\t\t\tactionViewItemProvider: (action: IAction, options: IActionViewItemOptions) => {\n\t\t\t\tif (action instanceof MenuItemAction && action.item.id === MarkUnhelpfulActionId) {\n\t\t\t\t\treturn scopedInstantiationService.createInstance(ChatVoteDownButton, action, options as IMenuEntryActionViewItemOptions);\n\t\t\t\t}\n\t\t\t\treturn createActionViewItem(scopedInstantiationService, action, options);\n\t\t\t}\n\t\t}));\n\n\t\t// Insert the details container into the toolbar's internal element structure\n\t\tconst footerDetailsContainer = dom.append(footerToolbar.getElement(), $('.chat-footer-details'));\n\t\tfooterDetailsContainer.tabIndex = 0;\n\n\t\tconst checkpointRestoreContainer = dom.append(rowContainer, $('.checkpoint-restore-container'));\n\t\tconst codiconRestoreContainer = dom.append(checkpointRestoreContainer, $('.codicon-container'));\n\t\tdom.append(codiconRestoreContainer, $('span.codicon.codicon-bookmark'));\n\t\tconst label = dom.append(checkpointRestoreContainer, $('span.checkpoint-label-text'));\n\t\tlabel.textContent = localize('checkpointRestore', 'Checkpoint Restored');\n\t\tconst checkpointRestoreToolbar = templateDisposables.add(scopedInstantiationService.createInstance(MenuWorkbenchToolBar, checkpointRestoreContainer, MenuId.ChatMessageRestoreCheckpoint, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\treturn this.instantiationService.createInstance(CodiconActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\tmenuOptions: {\n\t\t\t\tshouldForwardArgs: true\n\t\t\t},\n\t\t\ttoolbarOptions: {\n\t\t\t\tshouldInlineSubmenu: submenu => submenu.actions.length <= 1\n\t\t\t},\n\t\t}));\n\n\t\tdom.append(checkpointRestoreContainer, $('.checkpoint-divider'));\n\n\n\t\tconst agentHover = templateDisposables.add(this.instantiationService.createInstance(ChatAgentHover));\n\t\tconst hoverContent = () => {\n\t\t\tif (isResponseVM(template.currentElement) && template.currentElement.agent && !template.currentElement.agent.isDefault) {\n\t\t\t\tagentHover.setAgent(template.currentElement.agent.id);\n\t\t\t\treturn agentHover.domNode;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t};\n\t\tconst hoverOptions = getChatAgentHoverOptions(() => isResponseVM(template.currentElement) ? template.currentElement.agent : undefined, this.commandService);\n\t\ttemplateDisposables.add(this.hoverService.setupManagedHover(getDefaultHoverDelegate('element'), user, hoverContent, hoverOptions));\n\t\ttemplateDisposables.add(dom.addDisposableListener(user, dom.EventType.KEY_DOWN, e => {\n\t\t\tconst ev = new StandardKeyboardEvent(e);\n\t\t\tif (ev.equals(KeyCode.Space) || ev.equals(KeyCode.Enter)) {\n\t\t\t\tconst content = hoverContent();\n\t\t\t\tif (content) {\n\t\t\t\t\tthis.hoverService.showInstantHover({ content, target: user, trapFocus: true, actions: hoverOptions.actions }, true);\n\t\t\t\t}\n\t\t\t} else if (ev.equals(KeyCode.Escape)) {\n\t\t\t\tthis.hoverService.hideHover();\n\t\t\t}\n\t\t}));\n\t\tconst template: IChatListItemTemplate = { header, avatarContainer, requestHover, username, detail, value, rowContainer, elementDisposables, templateDisposables, contextKeyService, instantiationService: scopedInstantiationService, agentHover, titleToolbar, footerToolbar, footerDetailsContainer, disabledOverlay, checkpointToolbar, checkpointRestoreToolbar, checkpointContainer, checkpointRestoreContainer };\n\n\t\ttemplateDisposables.add(dom.addDisposableListener(disabledOverlay, dom.EventType.CLICK, e => {\n\t\t\tif (!this.viewModel?.editing) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst current = template.currentElement;\n\t\t\tif (!current || current.id === this.viewModel.editing.id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (disabledOverlay.classList.contains('disabled')) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis._onDidFocusOutside.fire();\n\t\t\t}\n\t\t}));\n\t\treturn template;\n\t}\n\n\trenderElement(node: ITreeNode<ChatTreeItem, FuzzyScore>, index: number, templateData: IChatListItemTemplate): void {\n\t\tthis.renderChatTreeItem(node.element, index, templateData);\n\t}\n\n\tprivate clearRenderedParts(templateData: IChatListItemTemplate): void {\n\t\tif (templateData.renderedParts) {\n\t\t\tdispose(coalesce(templateData.renderedParts));\n\t\t\ttemplateData.renderedParts = undefined;\n\t\t\tdom.clearNode(templateData.value);\n\t\t}\n\t}\n\n\trenderChatTreeItem(element: ChatTreeItem, index: number, templateData: IChatListItemTemplate): void {\n\t\tif (templateData.currentElement && templateData.currentElement.id !== element.id) {\n\t\t\tthis.traceLayout('renderChatTreeItem', `Rendering a different element into the template, index=${index}`);\n\t\t\tthis.clearRenderedParts(templateData);\n\n\t\t\tconst mappedTemplateData = this.templateDataByRequestId.get(templateData.currentElement.id);\n\t\t\tif (mappedTemplateData && (mappedTemplateData.currentElement?.id !== templateData.currentElement.id)) {\n\t\t\t\tthis.templateDataByRequestId.delete(templateData.currentElement.id);\n\t\t\t}\n\t\t}\n\n\t\ttemplateData.currentElement = element;\n\t\tthis.templateDataByRequestId.set(element.id, templateData);\n\t\tconst kind = isRequestVM(element) ? 'request' :\n\t\t\tisResponseVM(element) ? 'response' :\n\t\t\t\t'welcome';\n\t\tthis.traceLayout('renderElement', `${kind}, index=${index}`);\n\n\t\tChatContextKeys.isResponse.bindTo(templateData.contextKeyService).set(isResponseVM(element));\n\t\tChatContextKeys.itemId.bindTo(templateData.contextKeyService).set(element.id);\n\t\tChatContextKeys.isRequest.bindTo(templateData.contextKeyService).set(isRequestVM(element));\n\t\tChatContextKeys.responseDetectedAgentCommand.bindTo(templateData.contextKeyService).set(isResponseVM(element) && element.agentOrSlashCommandDetected);\n\t\tif (isResponseVM(element)) {\n\t\t\tChatContextKeys.responseSupportsIssueReporting.bindTo(templateData.contextKeyService).set(!!element.agent?.metadata.supportIssueReporting);\n\t\t\tChatContextKeys.responseVote.bindTo(templateData.contextKeyService).set(element.vote === ChatAgentVoteDirection.Up ? 'up' : element.vote === ChatAgentVoteDirection.Down ? 'down' : '');\n\t\t} else {\n\t\t\tChatContextKeys.responseVote.bindTo(templateData.contextKeyService).set('');\n\t\t}\n\n\t\tif (templateData.titleToolbar) {\n\t\t\ttemplateData.titleToolbar.context = element;\n\t\t}\n\t\ttemplateData.footerToolbar.context = element;\n\n\t\t// Render result details in footer if available\n\t\tif (isResponseVM(element) && element.result?.details) {\n\t\t\ttemplateData.footerDetailsContainer.textContent = element.result.details;\n\t\t\ttemplateData.footerDetailsContainer.classList.remove('hidden');\n\t\t} else {\n\t\t\ttemplateData.footerDetailsContainer.classList.add('hidden');\n\t\t}\n\n\t\tChatContextKeys.responseHasError.bindTo(templateData.contextKeyService).set(isResponseVM(element) && !!element.errorDetails);\n\t\tconst isFiltered = !!(isResponseVM(element) && element.errorDetails?.responseIsFiltered);\n\t\tChatContextKeys.responseIsFiltered.bindTo(templateData.contextKeyService).set(isFiltered);\n\n\t\tconst location = this.chatWidgetService.getWidgetBySessionResource(element.sessionResource)?.location;\n\t\ttemplateData.rowContainer.classList.toggle('editing-session', location === ChatAgentLocation.Chat);\n\t\ttemplateData.rowContainer.classList.toggle('interactive-request', isRequestVM(element));\n\t\ttemplateData.rowContainer.classList.toggle('interactive-response', isResponseVM(element));\n\t\tconst progressMessageAtBottomOfResponse = checkModeOption(this.delegate.currentChatMode(), this.rendererOptions.progressMessageAtBottomOfResponse);\n\t\ttemplateData.rowContainer.classList.toggle('show-detail-progress', isResponseVM(element) && !element.isComplete && !element.progressMessages.length && !progressMessageAtBottomOfResponse);\n\t\tif (!this.rendererOptions.noHeader) {\n\t\t\tthis.renderAvatar(element, templateData);\n\t\t}\n\n\t\ttemplateData.username.textContent = element.username;\n\t\ttemplateData.username.classList.toggle('hidden', element.username === COPILOT_USERNAME);\n\t\ttemplateData.avatarContainer.classList.toggle('hidden', element.username === COPILOT_USERNAME);\n\n\t\tthis.hoverHidden(templateData.requestHover);\n\t\tdom.clearNode(templateData.detail);\n\t\tif (isResponseVM(element)) {\n\t\t\tthis.renderDetail(element, templateData);\n\t\t}\n\n\t\ttemplateData.checkpointToolbar.context = element;\n\t\tconst checkpointEnabled = this.configService.getValue<boolean>(ChatConfiguration.CheckpointsEnabled)\n\t\t\t&& (this.rendererOptions.restorable ?? true);\n\n\t\ttemplateData.checkpointContainer.classList.toggle('hidden', isResponseVM(element) || !(checkpointEnabled));\n\n\t\t// Only show restore container when we have a checkpoint and not editing\n\t\tconst shouldShowRestore = this.viewModel?.model.checkpoint && !this.viewModel?.editing && (index === this.delegate.getListLength() - 1);\n\t\ttemplateData.checkpointRestoreContainer.classList.toggle('hidden', !(shouldShowRestore && checkpointEnabled));\n\n\t\tconst editing = element.id === this.viewModel?.editing?.id;\n\t\tconst isInput = this.configService.getValue<string>('chat.editRequests') === 'input';\n\n\t\ttemplateData.disabledOverlay.classList.toggle('disabled', element.shouldBeBlocked && !editing && this.viewModel?.editing !== undefined);\n\t\ttemplateData.rowContainer.classList.toggle('editing', editing && !isInput);\n\t\ttemplateData.rowContainer.classList.toggle('editing-input', editing && isInput);\n\t\ttemplateData.requestHover.classList.toggle('editing', editing && isInput);\n\t\ttemplateData.requestHover.classList.toggle('hidden', (!!this.viewModel?.editing && !editing) || isResponseVM(element));\n\t\ttemplateData.requestHover.classList.toggle('expanded', this.configService.getValue<string>('chat.editRequests') === 'hover');\n\t\ttemplateData.requestHover.classList.toggle('checkpoints-enabled', checkpointEnabled);\n\t\ttemplateData.elementDisposables.add(dom.addStandardDisposableListener(templateData.rowContainer, dom.EventType.CLICK, (e) => {\n\t\t\tconst current = templateData.currentElement;\n\t\t\tif (current && this.viewModel?.editing && current.id !== this.viewModel.editing.id) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\tthis._onDidFocusOutside.fire();\n\t\t\t}\n\t\t}));\n\n\t\t// Overlay click listener removed: overlay is non-interactive in cancel-on-any-row mode.\n\n\t\t// hack @joaomoreno\n\t\ttemplateData.rowContainer.parentElement?.parentElement?.parentElement?.classList.toggle('request', isRequestVM(element));\n\t\ttemplateData.rowContainer.classList.toggle(mostRecentResponseClassName, index === this.delegate.getListLength() - 1);\n\t\ttemplateData.rowContainer.classList.toggle('confirmation-message', isRequestVM(element) && !!element.confirmation);\n\n\t\t// TODO: @justschen decide if we want to hide the header for requests or not\n\t\tconst shouldShowHeader = isResponseVM(element) && !this.rendererOptions.noHeader;\n\t\ttemplateData.header?.classList.toggle('header-disabled', !shouldShowHeader);\n\n\t\tif (isRequestVM(element) && element.confirmation) {\n\t\t\tthis.renderConfirmationAction(element, templateData);\n\t\t}\n\n\t\t// Do a progressive render if\n\t\t// - This the last response in the list\n\t\t// - And it has some content\n\t\t// - And the response is not complete\n\t\t//   - Or, we previously started a progressive rendering of this element (if the element is complete, we will finish progressive rendering with a very fast rate)\n\t\tif (isResponseVM(element) && index === this.delegate.getListLength() - 1 && (!element.isComplete || element.renderData)) {\n\t\t\tthis.traceLayout('renderElement', `start progressive render, index=${index}`);\n\n\t\t\tconst timer = templateData.elementDisposables.add(new dom.WindowIntervalTimer());\n\t\t\tconst runProgressiveRender = (initial?: boolean) => {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.doNextProgressiveRender(element, index, templateData, !!initial)) {\n\t\t\t\t\t\ttimer.cancel();\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\t// Kill the timer if anything went wrong, avoid getting stuck in a nasty rendering loop.\n\t\t\t\t\ttimer.cancel();\n\t\t\t\t\tthis.logService.error(err);\n\t\t\t\t}\n\t\t\t};\n\t\t\ttimer.cancelAndSet(runProgressiveRender, 50, dom.getWindow(templateData.rowContainer));\n\t\t\trunProgressiveRender(true);\n\t\t} else {\n\t\t\tif (isResponseVM(element)) {\n\t\t\t\tthis.renderChatResponseBasic(element, index, templateData);\n\t\t\t} else if (isRequestVM(element)) {\n\t\t\t\tthis.renderChatRequest(element, index, templateData);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate renderDetail(element: IChatResponseViewModel, templateData: IChatListItemTemplate): void {\n\t\tdom.clearNode(templateData.detail);\n\n\t\tif (element.agentOrSlashCommandDetected) {\n\t\t\tconst msg = element.slashCommand ? localize('usedAgentSlashCommand', \"used {0} [[(rerun without)]]\", `${chatSubcommandLeader}${element.slashCommand.name}`) : localize('usedAgent', \"[[(rerun without)]]\");\n\t\t\tdom.reset(templateData.detail, renderFormattedText(msg, {\n\t\t\t\tactionHandler: {\n\t\t\t\t\tdisposables: templateData.elementDisposables,\n\t\t\t\t\tcallback: (content) => {\n\t\t\t\t\t\tthis._onDidClickRerunWithAgentOrCommandDetection.fire(element);\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}, $('span.agentOrSlashCommandDetected')));\n\n\t\t} else if (this.rendererOptions.renderStyle !== 'minimal' && !element.isComplete && !checkModeOption(this.delegate.currentChatMode(), this.rendererOptions.progressMessageAtBottomOfResponse)) {\n\t\t\ttemplateData.detail.textContent = localize('working', \"Working\");\n\t\t}\n\t}\n\n\tprivate renderConfirmationAction(element: IChatRequestViewModel, templateData: IChatListItemTemplate) {\n\t\tdom.clearNode(templateData.detail);\n\t\tif (element.confirmation) {\n\t\t\tdom.append(templateData.detail, $('span.codicon.codicon-check', { 'aria-hidden': 'true' }));\n\t\t\tdom.append(templateData.detail, $('span.confirmation-text', undefined, localize('chatConfirmationAction', 'Selected \"{0}\"', element.confirmation)));\n\t\t\ttemplateData.header?.classList.remove('header-disabled');\n\t\t\ttemplateData.header?.classList.add('partially-disabled');\n\t\t}\n\t}\n\n\tprivate renderAvatar(element: ChatTreeItem, templateData: IChatListItemTemplate): void {\n\t\tconst icon = isResponseVM(element) ?\n\t\t\tthis.getAgentIcon(element.agent?.metadata) :\n\t\t\t(element.avatarIcon ?? Codicon.account);\n\t\tif (icon instanceof URI) {\n\t\t\tconst avatarIcon = dom.$<HTMLImageElement>('img.icon');\n\t\t\tavatarIcon.src = FileAccess.uriToBrowserUri(icon).toString(true);\n\t\t\ttemplateData.avatarContainer.replaceChildren(dom.$('.avatar', undefined, avatarIcon));\n\t\t} else {\n\t\t\tconst avatarIcon = dom.$(ThemeIcon.asCSSSelector(icon));\n\t\t\ttemplateData.avatarContainer.replaceChildren(dom.$('.avatar.codicon-avatar', undefined, avatarIcon));\n\t\t}\n\t}\n\n\tprivate getAgentIcon(agent: IChatAgentMetadata | undefined): URI | ThemeIcon {\n\t\tif (agent?.themeIcon) {\n\t\t\treturn agent.themeIcon;\n\t\t} else if (agent?.iconDark && isDark(this.themeService.getColorTheme().type)) {\n\t\t\treturn agent.iconDark;\n\t\t} else if (agent?.icon) {\n\t\t\treturn agent.icon;\n\t\t} else {\n\t\t\treturn Codicon.chatSparkle;\n\t\t}\n\t}\n\n\tprivate renderChatResponseBasic(element: IChatResponseViewModel, index: number, templateData: IChatListItemTemplate) {\n\t\ttemplateData.rowContainer.classList.toggle('chat-response-loading', (isResponseVM(element) && !element.isComplete));\n\n\t\tif (element.isCanceled) {\n\t\t\tif (this._currentThinkingPart?.domNode) {\n\t\t\t\tthis._currentThinkingPart.finalizeTitleIfDefault();\n\t\t\t\tthis._currentThinkingPart = undefined;\n\t\t\t\tthis._streamingThinking = false;\n\t\t\t\tthis.updateItemHeight(templateData);\n\t\t\t}\n\t\t}\n\n\t\tconst content: IChatRendererContent[] = [];\n\t\tconst isFiltered = !!element.errorDetails?.responseIsFiltered;\n\t\tif (!isFiltered) {\n\t\t\t// Always add the references to avoid shifting the content parts when a reference is added, and having to re-diff all the content.\n\t\t\t// The part will hide itself if the list is empty.\n\t\t\tcontent.push({ kind: 'references', references: element.contentReferences });\n\t\t\tcontent.push(...annotateSpecialMarkdownContent(element.response.value));\n\t\t\tif (element.codeCitations.length) {\n\t\t\t\tcontent.push({ kind: 'codeCitations', citations: element.codeCitations });\n\t\t\t}\n\t\t}\n\n\t\tif (element.model.response === element.model.entireResponse && element.errorDetails?.message && element.errorDetails.message !== canceledName) {\n\t\t\tcontent.push({ kind: 'errorDetails', errorDetails: element.errorDetails, isLast: index === this.delegate.getListLength() - 1 });\n\t\t}\n\n\t\tconst fileChangesSummaryPart = this.getChatFileChangesSummaryPart(element);\n\t\tif (fileChangesSummaryPart) {\n\t\t\tcontent.push(fileChangesSummaryPart);\n\t\t}\n\n\t\tconst diff = this.diff(templateData.renderedParts ?? [], content, element);\n\t\tthis.renderChatContentDiff(diff, content, element, index, templateData);\n\n\t\tthis.updateItemHeightOnRender(element, templateData);\n\t}\n\n\tprivate shouldShowWorkingProgress(element: IChatResponseViewModel, partsToRender: IChatRendererContent[]): boolean {\n\t\tif (element.agentOrSlashCommandDetected || this.rendererOptions.renderStyle === 'minimal' || element.isComplete || !checkModeOption(this.delegate.currentChatMode(), this.rendererOptions.progressMessageAtBottomOfResponse)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Show if no content, only \"used references\", ends with a complete tool call, or ends with complete text edits and there is no incomplete tool call (edits are still being applied some time after they are all generated)\n\t\tconst lastPart = findLast(partsToRender, part => part.kind !== 'markdownContent' || part.content.value.trim().length > 0);\n\n\t\tconst thinkingStyle = this.configService.getValue<ThinkingDisplayMode>('chat.agent.thinkingStyle');\n\n\t\tif (thinkingStyle === ThinkingDisplayMode.FixedScrolling && this.configService.getValue<string>('chat.agent.thinking.collapsedTools') !== 'none' && this._currentThinkingPart) {\n\t\t\treturn lastPart?.kind !== 'thinking' && lastPart?.kind !== 'toolInvocation' && lastPart?.kind !== 'prepareToolInvocation';\n\t\t}\n\n\t\tif (\n\t\t\t!lastPart ||\n\t\t\tlastPart.kind === 'references' || (lastPart.kind === 'thinking' && thinkingStyle !== ThinkingDisplayMode.FixedScrolling) ||\n\t\t\t((lastPart.kind === 'toolInvocation' || lastPart.kind === 'toolInvocationSerialized') && (IChatToolInvocation.isComplete(lastPart) || lastPart.presentation === 'hidden')) ||\n\t\t\t((lastPart.kind === 'textEditGroup' || lastPart.kind === 'notebookEditGroup') && lastPart.done && !partsToRender.some(part => part.kind === 'toolInvocation' && !IChatToolInvocation.isComplete(part))) ||\n\t\t\t(lastPart.kind === 'progressTask' && lastPart.deferred.isSettled) ||\n\t\t\tlastPart.kind === 'prepareToolInvocation' || lastPart.kind === 'mcpServersStarting'\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\n\tprivate getChatFileChangesSummaryPart(element: IChatResponseViewModel): IChatChangesSummaryPart | undefined {\n\t\tif (!this.shouldShowFileChangesSummary(element)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst consideredFiles: Set<string> = new Set();\n\t\tconst fileChanges: IChatChangesSummary[] = [];\n\t\tfor (const part of element.model.entireResponse.value) {\n\t\t\tif ((part.kind === 'textEditGroup' || part.kind === 'notebookEditGroup') && !consideredFiles.has(part.uri.toString(true))) {\n\t\t\t\tfileChanges.push({\n\t\t\t\t\tkind: 'changesSummary',\n\t\t\t\t\treference: part.uri,\n\t\t\t\t\tsessionId: element.sessionId,\n\t\t\t\t\trequestId: element.requestId,\n\t\t\t\t});\n\t\t\t\tconsideredFiles.add(part.uri.toString(true));\n\t\t\t}\n\t\t}\n\t\tif (!fileChanges.length) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn { kind: 'changesSummary', fileChanges };\n\t}\n\n\tprivate renderChatRequest(element: IChatRequestViewModel, index: number, templateData: IChatListItemTemplate) {\n\t\ttemplateData.rowContainer.classList.toggle('chat-response-loading', false);\n\t\tif (element.id === this.viewModel?.editing?.id) {\n\t\t\tthis._onDidRerender.fire(templateData);\n\t\t}\n\n\t\tif (this.configService.getValue<string>('chat.editRequests') !== 'none' && this.rendererOptions.editable) {\n\t\t\ttemplateData.elementDisposables.add(dom.addDisposableListener(templateData.rowContainer, dom.EventType.KEY_DOWN, e => {\n\t\t\t\tconst ev = new StandardKeyboardEvent(e);\n\t\t\t\tif (ev.equals(KeyCode.Space) || ev.equals(KeyCode.Enter)) {\n\t\t\t\t\tif (this.viewModel?.editing?.id !== element.id) {\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\t\tthis._onDidClickRequest.fire(templateData);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tlet content: IChatRendererContent[] = [];\n\t\tif (!element.confirmation) {\n\t\t\tconst markdown = isChatFollowup(element.message) ?\n\t\t\t\telement.message.message :\n\t\t\t\tthis.markdownDecorationsRenderer.convertParsedRequestToMarkdown(element.message);\n\t\t\tcontent = [{ content: new MarkdownString(markdown), kind: 'markdownContent' }];\n\n\t\t\tif (this.rendererOptions.renderStyle === 'minimal' && !element.isComplete) {\n\t\t\t\ttemplateData.value.classList.add('inline-progress');\n\t\t\t\ttemplateData.elementDisposables.add(toDisposable(() => templateData.value.classList.remove('inline-progress')));\n\t\t\t\tcontent.push({ content: new MarkdownString('<span></span>', { supportHtml: true }), kind: 'markdownContent' });\n\t\t\t} else {\n\t\t\t\ttemplateData.value.classList.remove('inline-progress');\n\t\t\t}\n\t\t}\n\n\t\tdom.clearNode(templateData.value);\n\t\tconst parts: IChatContentPart[] = [];\n\n\t\tlet inlineSlashCommandRendered = false;\n\t\tcontent.forEach((data, contentIndex) => {\n\t\t\tconst context: IChatContentPartRenderContext = {\n\t\t\t\telement,\n\t\t\t\telementIndex: index,\n\t\t\t\tcontentIndex: contentIndex,\n\t\t\t\tcontent: content,\n\t\t\t\tpreceedingContentParts: parts,\n\t\t\t\tcontainer: templateData.rowContainer,\n\t\t\t\teditorPool: this._editorPool,\n\t\t\t\tdiffEditorPool: this._diffEditorPool,\n\t\t\t\tcodeBlockModelCollection: this.codeBlockModelCollection,\n\t\t\t\tcurrentWidth: () => this._currentLayoutWidth,\n\t\t\t\tget codeBlockStartIndex() {\n\t\t\t\t\treturn context.preceedingContentParts.reduce((acc, part) => acc + (part.codeblocks?.length ?? 0), 0);\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst newPart = this.renderChatContentPart(data, templateData, context);\n\t\t\tif (newPart) {\n\n\t\t\t\tif (this.rendererOptions.renderDetectedCommandsWithRequest\n\t\t\t\t\t&& !inlineSlashCommandRendered\n\t\t\t\t\t&& element.agentOrSlashCommandDetected && element.slashCommand\n\t\t\t\t\t&& data.kind === 'markdownContent' // TODO this is fishy but I didn't find a better way to render on the same inline as the MD request part\n\t\t\t\t) {\n\t\t\t\t\tif (newPart.domNode) {\n\t\t\t\t\t\tnewPart.domNode.style.display = 'inline-flex';\n\t\t\t\t\t}\n\t\t\t\t\tconst cmdPart = this.instantiationService.createInstance(ChatAgentCommandContentPart, element.slashCommand, () => this._onDidClickRerunWithAgentOrCommandDetection.fire({ sessionResource: element.sessionResource, requestId: element.id }));\n\t\t\t\t\ttemplateData.value.appendChild(cmdPart.domNode);\n\t\t\t\t\tparts.push(cmdPart);\n\t\t\t\t\tinlineSlashCommandRendered = true;\n\t\t\t\t}\n\n\t\t\t\tif (newPart.domNode) {\n\t\t\t\t\ttemplateData.value.appendChild(newPart.domNode);\n\t\t\t\t}\n\t\t\t\tparts.push(newPart);\n\t\t\t}\n\t\t});\n\n\t\tif (templateData.renderedParts) {\n\t\t\tdispose(templateData.renderedParts);\n\t\t}\n\t\ttemplateData.renderedParts = parts;\n\n\t\tif (element.variables.length) {\n\t\t\tconst newPart = this.renderAttachments(element.variables, element.contentReferences, templateData);\n\t\t\tif (newPart.domNode) {\n\t\t\t\t// p has a :last-child rule for margin\n\t\t\t\ttemplateData.value.appendChild(newPart.domNode);\n\t\t\t}\n\t\t\ttemplateData.elementDisposables.add(newPart);\n\t\t}\n\n\t\tthis.updateItemHeightOnRender(element, templateData);\n\t}\n\n\tupdateItemHeightOnRender(element: ChatTreeItem, templateData: IChatListItemTemplate) {\n\t\tconst newHeight = templateData.rowContainer.offsetHeight;\n\t\tconst fireEvent = !element.currentRenderedHeight || element.currentRenderedHeight !== newHeight;\n\t\telement.currentRenderedHeight = newHeight;\n\t\tif (fireEvent) {\n\t\t\tconst disposable = templateData.elementDisposables.add(dom.scheduleAtNextAnimationFrame(dom.getWindow(templateData.value), () => {\n\t\t\t\t// Have to recompute the height here because codeblock rendering is currently async and it may have changed.\n\t\t\t\t// If it becomes properly sync, then this could be removed.\n\t\t\t\telement.currentRenderedHeight = templateData.rowContainer.offsetHeight;\n\t\t\t\tdisposable.dispose();\n\t\t\t\tthis._onDidChangeItemHeight.fire({ element, height: element.currentRenderedHeight });\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate updateItemHeight(templateData: IChatListItemTemplate): void {\n\t\tif (!templateData.currentElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newHeight = Math.max(templateData.rowContainer.offsetHeight, 1);\n\t\ttemplateData.currentElement.currentRenderedHeight = newHeight;\n\t\tthis._onDidChangeItemHeight.fire({ element: templateData.currentElement, height: newHeight });\n\t}\n\n\t/**\n\t *\t@returns true if progressive rendering should be considered complete- the element's data is fully rendered or the view is not visible\n\t */\n\tprivate doNextProgressiveRender(element: IChatResponseViewModel, index: number, templateData: IChatListItemTemplate, isInRenderElement: boolean): boolean {\n\t\tif (!this._isVisible) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (element.isCanceled) {\n\t\t\tthis.traceLayout('doNextProgressiveRender', `canceled, index=${index}`);\n\t\t\telement.renderData = undefined;\n\t\t\tthis.renderChatResponseBasic(element, index, templateData);\n\t\t\treturn true;\n\t\t}\n\n\t\ttemplateData.rowContainer.classList.toggle('chat-response-loading', true);\n\t\tthis.traceLayout('doNextProgressiveRender', `START progressive render, index=${index}, renderData=${JSON.stringify(element.renderData)}`);\n\t\tconst contentForThisTurn = this.getNextProgressiveRenderContent(element);\n\t\tconst partsToRender = this.diff(templateData.renderedParts ?? [], contentForThisTurn.content, element);\n\n\t\tconst contentIsAlreadyRendered = partsToRender.every(part => part === null);\n\t\tif (contentIsAlreadyRendered) {\n\t\t\tif (contentForThisTurn.moreContentAvailable) {\n\t\t\t\t// The content that we want to render in this turn is already rendered, but there is more content to render on the next tick\n\t\t\t\tthis.traceLayout('doNextProgressiveRender', 'not rendering any new content this tick, but more available');\n\t\t\t\treturn false;\n\t\t\t} else if (element.isComplete) {\n\t\t\t\t// All content is rendered, and response is done, so do a normal render\n\t\t\t\tthis.traceLayout('doNextProgressiveRender', `END progressive render, index=${index} and clearing renderData, response is complete`);\n\t\t\t\telement.renderData = undefined;\n\t\t\t\tthis.renderChatResponseBasic(element, index, templateData);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\t// Nothing new to render, stop rendering until next model update\n\t\t\t\tthis.traceLayout('doNextProgressiveRender', 'caught up with the stream- no new content to render');\n\n\t\t\t\tif (!templateData.renderedParts) {\n\t\t\t\t\t// First render? Initialize currentRenderedHeight. https://github.com/microsoft/vscode/issues/232096\n\t\t\t\t\tconst height = templateData.rowContainer.offsetHeight;\n\t\t\t\t\telement.currentRenderedHeight = height;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Do an actual progressive render\n\t\tthis.traceLayout('doNextProgressiveRender', `doing progressive render, ${partsToRender.length} parts to render`);\n\t\tthis.renderChatContentDiff(partsToRender, contentForThisTurn.content, element, index, templateData);\n\n\t\tconst height = templateData.rowContainer.offsetHeight;\n\t\telement.currentRenderedHeight = height;\n\t\tif (!isInRenderElement) {\n\t\t\tthis._onDidChangeItemHeight.fire({ element, height });\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate renderChatContentDiff(partsToRender: ReadonlyArray<IChatRendererContent | null>, contentForThisTurn: ReadonlyArray<IChatRendererContent>, element: IChatResponseViewModel, elementIndex: number, templateData: IChatListItemTemplate): void {\n\t\tconst renderedParts = templateData.renderedParts ?? [];\n\t\ttemplateData.renderedParts = renderedParts;\n\t\tpartsToRender.forEach((partToRender, contentIndex) => {\n\t\t\tif (!partToRender) {\n\t\t\t\t// null=no change\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst alreadyRenderedPart = templateData.renderedParts?.[contentIndex];\n\n\t\t\t// keep existing thinking part instance during streaming and update it in place\n\t\t\tif (alreadyRenderedPart) {\n\t\t\t\tif (partToRender.kind === 'thinking' && alreadyRenderedPart instanceof ChatThinkingContentPart) {\n\t\t\t\t\tif (!Array.isArray(partToRender.value)) {\n\t\t\t\t\t\talreadyRenderedPart.updateThinking(partToRender);\n\t\t\t\t\t}\n\t\t\t\t\trenderedParts[contentIndex] = alreadyRenderedPart;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talreadyRenderedPart.dispose();\n\t\t\t}\n\n\t\t\tconst preceedingContentParts = renderedParts.slice(0, contentIndex);\n\t\t\tconst context: IChatContentPartRenderContext = {\n\t\t\t\telement,\n\t\t\t\telementIndex: elementIndex,\n\t\t\t\tcontent: contentForThisTurn,\n\t\t\t\tpreceedingContentParts,\n\t\t\t\tcontentIndex: contentIndex,\n\t\t\t\tcontainer: templateData.rowContainer,\n\t\t\t\teditorPool: this._editorPool,\n\t\t\t\tdiffEditorPool: this._diffEditorPool,\n\t\t\t\tcodeBlockModelCollection: this.codeBlockModelCollection,\n\t\t\t\tcurrentWidth: () => this._currentLayoutWidth,\n\t\t\t\tget codeBlockStartIndex() {\n\t\t\t\t\treturn context.preceedingContentParts.reduce((acc, part) => acc + (part.codeblocks?.length ?? 0), 0);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// combine tool invocations into thinking part if needed. render the tool, but do not replace the working spinner with the new part's dom node since it is already inside the thinking part.\n\t\t\tif (this._currentThinkingPart && (partToRender.kind === 'toolInvocation' || partToRender.kind === 'toolInvocationSerialized') && this.shouldPinPart(partToRender, element)) {\n\t\t\t\tconst newPart = this.renderChatContentPart(partToRender, templateData, context);\n\t\t\t\tif (newPart) {\n\t\t\t\t\trenderedParts[contentIndex] = newPart;\n\t\t\t\t\tif (alreadyRenderedPart instanceof ChatWorkingProgressContentPart && alreadyRenderedPart?.domNode) {\n\t\t\t\t\t\talreadyRenderedPart.domNode.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newPart = this.renderChatContentPart(partToRender, templateData, context);\n\t\t\tif (newPart) {\n\t\t\t\trenderedParts[contentIndex] = newPart;\n\t\t\t\t// Maybe the part can't be rendered in this context, but this shouldn't really happen\n\t\t\t\ttry {\n\t\t\t\t\tif (alreadyRenderedPart?.domNode) {\n\t\t\t\t\t\tif (newPart.domNode) {\n\t\t\t\t\t\t\talreadyRenderedPart.domNode.replaceWith(newPart.domNode);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\talreadyRenderedPart.domNode.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (newPart.domNode && !newPart.domNode.parentElement) {\n\t\t\t\t\t\t// Only append if not already attached somewhere else (e.g. inside a thinking wrapper)\n\t\t\t\t\t\ttemplateData.value.appendChild(newPart.domNode);\n\t\t\t\t\t}\n\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthis.logService.error('ChatListItemRenderer#renderChatContentDiff: error replacing part', err);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\talreadyRenderedPart?.domNode?.remove();\n\t\t\t}\n\t\t});\n\n\t\t// Delete previously rendered parts that are removed\n\t\tfor (let i = partsToRender.length; i < renderedParts.length; i++) {\n\t\t\tconst part = renderedParts[i];\n\t\t\tif (part) {\n\t\t\t\tpart.dispose();\n\t\t\t\tpart.domNode?.remove();\n\t\t\t\tdelete renderedParts[i];\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns all content parts that should be rendered, and trimmed markdown content. We will diff this with the current rendered set.\n\t */\n\tprivate getNextProgressiveRenderContent(element: IChatResponseViewModel): { content: IChatRendererContent[]; moreContentAvailable: boolean } {\n\t\tconst data = this.getDataForProgressiveRender(element);\n\n\t\t// An unregistered setting for development- skip the word counting and smoothing, just render content as it comes in\n\t\tconst renderImmediately = this.configService.getValue<boolean>('chat.experimental.renderMarkdownImmediately') === true;\n\n\t\tconst renderableResponse = annotateSpecialMarkdownContent(element.response.value);\n\n\t\tthis.traceLayout('getNextProgressiveRenderContent', `Want to render ${data.numWordsToRender} at ${data.rate} words/s, counting...`);\n\t\tlet numNeededWords = data.numWordsToRender;\n\t\tconst partsToRender: IChatRendererContent[] = [];\n\n\t\t// Always add the references to avoid shifting the content parts when a reference is added, and having to re-diff all the content.\n\t\t// The part will hide itself if the list is empty.\n\t\tpartsToRender.push({ kind: 'references', references: element.contentReferences });\n\n\t\tlet moreContentAvailable = false;\n\t\tfor (let i = 0; i < renderableResponse.length; i++) {\n\t\t\tconst part = renderableResponse[i];\n\t\t\tif (part.kind === 'markdownContent' && !renderImmediately) {\n\t\t\t\tconst wordCountResult = getNWords(part.content.value, numNeededWords);\n\t\t\t\tthis.traceLayout('getNextProgressiveRenderContent', `  Chunk ${i}: Want to render ${numNeededWords} words and found ${wordCountResult.returnedWordCount} words. Total words in chunk: ${wordCountResult.totalWordCount}`);\n\t\t\t\tnumNeededWords -= wordCountResult.returnedWordCount;\n\n\t\t\t\tif (wordCountResult.isFullString) {\n\t\t\t\t\tpartsToRender.push(part);\n\n\t\t\t\t\t// Consumed full markdown chunk- need to ensure that all following non-markdown parts are rendered\n\t\t\t\t\tfor (const nextPart of renderableResponse.slice(i + 1)) {\n\t\t\t\t\t\tif (nextPart.kind !== 'markdownContent') {\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\tpartsToRender.push(nextPart);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Only taking part of this markdown part\n\t\t\t\t\tmoreContentAvailable = true;\n\t\t\t\t\tpartsToRender.push({ ...part, content: new MarkdownString(wordCountResult.value, part.content) });\n\t\t\t\t}\n\n\t\t\t\tif (numNeededWords <= 0) {\n\t\t\t\t\t// Collected all words and following non-markdown parts if needed, done\n\t\t\t\t\tif (renderableResponse.slice(i + 1).some(part => part.kind === 'markdownContent')) {\n\t\t\t\t\t\tmoreContentAvailable = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpartsToRender.push(part);\n\t\t\t}\n\t\t}\n\n\t\tconst lastWordCount = element.contentUpdateTimings?.lastWordCount ?? 0;\n\t\tconst newRenderedWordCount = data.numWordsToRender - numNeededWords;\n\t\tconst bufferWords = lastWordCount - newRenderedWordCount;\n\t\tthis.traceLayout('getNextProgressiveRenderContent', `Want to render ${data.numWordsToRender} words. Rendering ${newRenderedWordCount} words. Buffer: ${bufferWords} words`);\n\t\tif (newRenderedWordCount > 0 && newRenderedWordCount !== element.renderData?.renderedWordCount) {\n\t\t\t// Only update lastRenderTime when we actually render new content\n\t\t\telement.renderData = { lastRenderTime: Date.now(), renderedWordCount: newRenderedWordCount, renderedParts: partsToRender };\n\t\t}\n\n\t\tif (this.shouldShowWorkingProgress(element, partsToRender)) {\n\t\t\tpartsToRender.push({ kind: 'working' });\n\t\t}\n\n\t\tconst fileChangesSummaryPart = this.getChatFileChangesSummaryPart(element);\n\t\tif (fileChangesSummaryPart) {\n\t\t\tpartsToRender.push(fileChangesSummaryPart);\n\t\t}\n\n\t\treturn { content: partsToRender, moreContentAvailable };\n\t}\n\n\tprivate shouldShowFileChangesSummary(element: IChatResponseViewModel): boolean {\n\t\treturn element.isComplete && this.configService.getValue<boolean>('chat.checkpoints.showFileChanges');\n\t}\n\n\tprivate getDataForProgressiveRender(element: IChatResponseViewModel) {\n\t\tif (!element.isComplete && element.response.value.length > 0 && (element.contentUpdateTimings ? element.contentUpdateTimings.lastWordCount : 0) === 0) {\n\t\t\t/**\n\t\t\t * None of the content parts in the ongoing response have been rendered yet,\n\t\t\t * so we should render all existing parts without animation.\n\t\t\t */\n\t\t\treturn {\n\t\t\t\tnumWordsToRender: Number.MAX_SAFE_INTEGER,\n\t\t\t\trate: Number.MAX_SAFE_INTEGER\n\t\t\t};\n\t\t}\n\n\t\tconst renderData = element.renderData ?? { lastRenderTime: 0, renderedWordCount: 0 };\n\n\t\tconst rate = this.getProgressiveRenderRate(element);\n\t\tconst numWordsToRender = renderData.lastRenderTime === 0 ?\n\t\t\t1 :\n\t\t\trenderData.renderedWordCount +\n\t\t\t// Additional words to render beyond what's already rendered\n\t\t\tMath.floor((Date.now() - renderData.lastRenderTime) / 1000 * rate);\n\n\t\treturn {\n\t\t\tnumWordsToRender,\n\t\t\trate\n\t\t};\n\t}\n\n\tprivate diff(renderedParts: ReadonlyArray<IChatContentPart>, contentToRender: ReadonlyArray<IChatRendererContent>, element: ChatTreeItem): ReadonlyArray<IChatRendererContent | null> {\n\t\tconst diff: (IChatRendererContent | null)[] = [];\n\t\tfor (let i = 0; i < contentToRender.length; i++) {\n\t\t\tconst content = contentToRender[i];\n\t\t\tconst renderedPart = renderedParts[i];\n\n\t\t\tif (!renderedPart || !renderedPart.hasSameContent(content, contentToRender.slice(i + 1), element)) {\n\t\t\t\tdiff.push(content);\n\t\t\t} else {\n\t\t\t\t// null -> no change\n\t\t\t\tdiff.push(null);\n\t\t\t}\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\t// put thinking parts inside a pinned part. commented out for now.\n\tprivate shouldPinPart(part: IChatRendererContent, element?: IChatResponseViewModel): boolean {\n\t\tconst collapsedTools = this.configService.getValue<string>('chat.agent.thinking.collapsedTools');\n\n\t\tif (collapsedTools === 'none') {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (collapsedTools === 'all') {\n\t\t\tif (part.kind === 'toolInvocation') {\n\t\t\t\treturn !part.confirmationMessages;\n\t\t\t}\n\n\t\t\tif (part.kind === 'toolInvocationSerialized') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif ((part.kind === 'toolInvocation' || part.kind === 'toolInvocationSerialized') && element) {\n\t\t\t// Explicit set of tools that should be pinned when there has been thinking\n\t\t\tconst specialToolIds = new Set<string>([\n\t\t\t\t'copilot_searchCodebase',\n\t\t\t\t'copilot_searchWorkspaceSymbols',\n\t\t\t\t'copilot_listCodeUsages',\n\t\t\t\t'copilot_think',\n\t\t\t\t'copilot_findFiles',\n\t\t\t\t'copilot_findTextInFiles',\n\t\t\t\t'copilot_readFile',\n\t\t\t\t'copilot_listDirectory',\n\t\t\t\t'copilot_getChangedFiles',\n\t\t\t]);\n\t\t\tconst isSpecialTool = specialToolIds.has(part.toolId);\n\t\t\treturn isSpecialTool || part.presentation === 'hidden';\n\t\t}\n\n\t\treturn part.kind === 'prepareToolInvocation';\n\t}\n\n\tprivate isCreateToolInvocationContent(content: IChatRendererContent | undefined): content is IChatToolInvocation | IChatToolInvocationSerialized {\n\t\tif (!content || (content.kind !== 'toolInvocation' && content.kind !== 'toolInvocationSerialized')) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst containsCreate = (value: string | IMarkdownString | undefined) => {\n\t\t\tif (!value) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst text = typeof value === 'string' ? value : value.value;\n\t\t\treturn text.toLowerCase().includes('create');\n\t\t};\n\n\t\tif (containsCreate(content.invocationMessage) || containsCreate(content.pastTenseMessage)) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn content.toolId.toLowerCase().includes('create');\n\t}\n\n\tprivate finalizeCurrentThinkingPart(): void {\n\t\tif (!this._currentThinkingPart) {\n\t\t\treturn;\n\t\t}\n\t\tconst style = this.configService.getValue<ThinkingDisplayMode>('chat.agent.thinkingStyle');\n\t\tif (style === ThinkingDisplayMode.CollapsedPreview) {\n\t\t\tthis._currentThinkingPart.collapseContent();\n\t\t}\n\t\tthis._currentThinkingPart.finalizeTitleIfDefault();\n\t\tthis._currentThinkingPart.resetId();\n\t\tthis._currentThinkingPart = undefined;\n\t}\n\n\tprivate renderChatContentPart(content: IChatRendererContent, templateData: IChatListItemTemplate, context: IChatContentPartRenderContext): IChatContentPart | undefined {\n\t\ttry {\n\n\t\t\tconst collapsedTools = this.configService.getValue<string>('chat.agent.thinking.collapsedTools');\n\t\t\t// if we get an empty thinking part, mark thinking as finished\n\t\t\tif (content.kind === 'thinking' && (Array.isArray(content.value) ? content.value.length === 0 : !content.value)) {\n\t\t\t\tthis._currentThinkingPart?.resetId();\n\t\t\t\tthis._streamingThinking = false;\n\t\t\t\treturn this.renderNoContent(other => content.kind === other.kind);\n\t\t\t}\n\n\t\t\tconst lastRenderedPart = context.preceedingContentParts.length ? context.preceedingContentParts[context.preceedingContentParts.length - 1] : undefined;\n\t\t\tconst previousContent = context.contentIndex > 0 ? context.content[context.contentIndex - 1] : undefined;\n\n\t\t\t// Special handling for \"create\" tool invocations- do not end thinking if previous part is a create tool invocation and config is set.\n\t\t\tconst shouldKeepThinkingForCreateTool = collapsedTools !== 'none' && lastRenderedPart instanceof ChatToolInvocationPart && this.isCreateToolInvocationContent(previousContent);\n\n\t\t\tif (!shouldKeepThinkingForCreateTool && this._currentThinkingPart && !this._streamingThinking) {\n\t\t\t\tconst isResponseElement = isResponseVM(context.element);\n\t\t\t\tconst isThinkingContent = content.kind === 'working' || content.kind === 'thinking';\n\t\t\t\tconst isToolStreamingContent = isResponseElement && this.shouldPinPart(content, isResponseElement ? context.element : undefined);\n\n\t\t\t\tif (!isThinkingContent && !isToolStreamingContent) {\n\t\t\t\t\tconst followsThinkingPart = previousContent?.kind === 'thinking' || previousContent?.kind === 'toolInvocation' || previousContent?.kind === 'prepareToolInvocation' || previousContent?.kind === 'toolInvocationSerialized';\n\n\t\t\t\t\tif (context.element.isComplete || followsThinkingPart) {\n\t\t\t\t\t\tthis.finalizeCurrentThinkingPart();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (content.kind === 'treeData') {\n\t\t\t\treturn this.renderTreeData(content, templateData, context);\n\t\t\t} else if (content.kind === 'multiDiffData') {\n\t\t\t\treturn this.renderMultiDiffData(content, templateData, context);\n\t\t\t} else if (content.kind === 'progressMessage') {\n\t\t\t\treturn this.instantiationService.createInstance(ChatProgressContentPart, content, this.chatContentMarkdownRenderer, context, undefined, undefined, undefined, undefined);\n\t\t\t} else if (content.kind === 'working') {\n\t\t\t\treturn this.instantiationService.createInstance(ChatWorkingProgressContentPart, content, this.chatContentMarkdownRenderer, context);\n\t\t\t} else if (content.kind === 'progressTask' || content.kind === 'progressTaskSerialized') {\n\t\t\t\treturn this.renderProgressTask(content, templateData, context);\n\t\t\t} else if (content.kind === 'command') {\n\t\t\t\treturn this.instantiationService.createInstance(ChatCommandButtonContentPart, content, context);\n\t\t\t} else if (content.kind === 'textEditGroup') {\n\t\t\t\treturn this.renderTextEdit(context, content, templateData);\n\t\t\t} else if (content.kind === 'confirmation') {\n\t\t\t\treturn this.renderConfirmation(context, content, templateData);\n\t\t\t} else if (content.kind === 'warning') {\n\t\t\t\treturn this.instantiationService.createInstance(ChatErrorContentPart, ChatErrorLevel.Warning, content.content, content, this.chatContentMarkdownRenderer);\n\t\t\t} else if (content.kind === 'markdownContent') {\n\t\t\t\treturn this.renderMarkdown(content, templateData, context);\n\t\t\t} else if (content.kind === 'references') {\n\t\t\t\treturn this.renderContentReferencesListData(content, undefined, context, templateData);\n\t\t\t} else if (content.kind === 'codeCitations') {\n\t\t\t\treturn this.renderCodeCitations(content, context, templateData);\n\t\t\t} else if (content.kind === 'toolInvocation' || content.kind === 'toolInvocationSerialized') {\n\t\t\t\treturn this.renderToolInvocation(content, context, templateData);\n\t\t\t} else if (content.kind === 'extensions') {\n\t\t\t\treturn this.renderExtensionsContent(content, context, templateData);\n\t\t\t} else if (content.kind === 'pullRequest') {\n\t\t\t\treturn this.renderPullRequestContent(content, context, templateData);\n\t\t\t} else if (content.kind === 'undoStop') {\n\t\t\t\treturn this.renderUndoStop(content);\n\t\t\t} else if (content.kind === 'errorDetails') {\n\t\t\t\treturn this.renderChatErrorDetails(context, content, templateData);\n\t\t\t} else if (content.kind === 'elicitation2' || content.kind === 'elicitationSerialized') {\n\t\t\t\treturn this.renderElicitation(context, content, templateData);\n\t\t\t} else if (content.kind === 'changesSummary') {\n\t\t\t\treturn this.renderChangesSummary(content, context, templateData);\n\t\t\t} else if (content.kind === 'mcpServersStarting') {\n\t\t\t\treturn this.renderMcpServersInteractionRequired(content, context, templateData);\n\t\t\t} else if (content.kind === 'thinking') {\n\t\t\t\treturn this.renderThinkingPart(content, context, templateData);\n\t\t\t}\n\n\t\t\treturn this.renderNoContent(other => content.kind === other.kind);\n\t\t} catch (err) {\n\t\t\talert(`Chat error: ${toErrorMessage(err, false)}`);\n\t\t\tthis.logService.error('ChatListItemRenderer#renderChatContentPart: error rendering content', toErrorMessage(err, true));\n\t\t\tconst errorPart = this.instantiationService.createInstance(ChatErrorContentPart, ChatErrorLevel.Error, new MarkdownString(localize('renderFailMsg', \"Failed to render content\") + `: ${toErrorMessage(err, false)}`), content, this.chatContentMarkdownRenderer);\n\t\t\treturn {\n\t\t\t\tdispose: () => errorPart.dispose(),\n\t\t\t\tdomNode: errorPart.domNode,\n\t\t\t\thasSameContent: (other => content.kind === other.kind),\n\t\t\t};\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tthis._announcedToolProgressKeys.clear();\n\t\tsuper.dispose();\n\t}\n\n\n\tprivate renderChatErrorDetails(context: IChatContentPartRenderContext, content: IChatErrorDetailsPart, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tif (!isResponseVM(context.element)) {\n\t\t\treturn this.renderNoContent(other => content.kind === other.kind);\n\t\t}\n\n\t\tconst isLast = context.elementIndex === this.delegate.getListLength() - 1;\n\t\tif (content.errorDetails.isQuotaExceeded) {\n\t\t\tconst renderedError = this.instantiationService.createInstance(ChatQuotaExceededPart, context.element, content, this.chatContentMarkdownRenderer);\n\t\t\trenderedError.addDisposable(renderedError.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\t\treturn renderedError;\n\t\t} else if (content.errorDetails.isRateLimited && this.chatEntitlementService.anonymous) {\n\t\t\tconst renderedError = this.instantiationService.createInstance(ChatAnonymousRateLimitedPart, content);\n\t\t\treturn renderedError;\n\t\t} else if (content.errorDetails.confirmationButtons && isLast) {\n\t\t\tconst level = content.errorDetails.level ?? ChatErrorLevel.Error;\n\t\t\tconst errorConfirmation = this.instantiationService.createInstance(ChatErrorConfirmationContentPart, level, new MarkdownString(content.errorDetails.message), content, content.errorDetails.confirmationButtons, this.chatContentMarkdownRenderer, context);\n\t\t\terrorConfirmation.addDisposable(errorConfirmation.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\t\treturn errorConfirmation;\n\t\t} else {\n\t\t\tconst level = content.errorDetails.level ?? ChatErrorLevel.Error;\n\t\t\treturn this.instantiationService.createInstance(ChatErrorContentPart, level, new MarkdownString(content.errorDetails.message), content, this.chatContentMarkdownRenderer);\n\t\t}\n\t}\n\n\tprivate renderUndoStop(content: IChatUndoStop) {\n\t\treturn this.renderNoContent(other => other.kind === content.kind && other.id === content.id);\n\t}\n\n\tprivate renderNoContent(equals: (otherContent: IChatRendererContent) => boolean): IChatContentPart {\n\t\treturn {\n\t\t\tdispose: () => { },\n\t\t\tdomNode: undefined,\n\t\t\thasSameContent: equals,\n\t\t};\n\t}\n\n\tprivate renderTreeData(content: IChatTreeData, templateData: IChatListItemTemplate, context: IChatContentPartRenderContext): IChatContentPart {\n\t\tconst data = content.treeData;\n\t\tconst treeDataIndex = context.preceedingContentParts.filter(part => part instanceof ChatTreeContentPart).length;\n\t\tconst treePart = this.instantiationService.createInstance(ChatTreeContentPart, data, context.element, this._treePool, treeDataIndex);\n\n\t\ttreePart.addDisposable(treePart.onDidChangeHeight(() => {\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\n\t\tif (isResponseVM(context.element)) {\n\t\t\tconst fileTreeFocusInfo = {\n\t\t\t\ttreeDataId: data.uri.toString(),\n\t\t\t\ttreeIndex: treeDataIndex,\n\t\t\t\tfocus() {\n\t\t\t\t\ttreePart.domFocus();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// TODO@roblourens there's got to be a better way to navigate trees\n\t\t\ttreePart.addDisposable(treePart.onDidFocus(() => {\n\t\t\t\tthis.focusedFileTreesByResponseId.set(context.element.id, fileTreeFocusInfo.treeIndex);\n\t\t\t}));\n\n\t\t\tconst fileTrees = this.fileTreesByResponseId.get(context.element.id) ?? [];\n\t\t\tfileTrees.push(fileTreeFocusInfo);\n\t\t\tthis.fileTreesByResponseId.set(context.element.id, distinct(fileTrees, (v) => v.treeDataId));\n\t\t\ttreePart.addDisposable(toDisposable(() => this.fileTreesByResponseId.set(context.element.id, fileTrees.filter(v => v.treeDataId !== data.uri.toString()))));\n\t\t}\n\n\t\treturn treePart;\n\t}\n\n\tprivate renderMultiDiffData(content: IChatMultiDiffData, templateData: IChatListItemTemplate, context: IChatContentPartRenderContext): IChatContentPart {\n\t\tconst multiDiffPart = this.instantiationService.createInstance(ChatMultiDiffContentPart, content, context.element);\n\t\tmultiDiffPart.addDisposable(multiDiffPart.onDidChangeHeight(() => {\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\t\treturn multiDiffPart;\n\t}\n\n\tprivate renderContentReferencesListData(references: IChatReferences, labelOverride: string | undefined, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): ChatCollapsibleListContentPart {\n\t\tconst referencesPart = this.instantiationService.createInstance(ChatUsedReferencesListContentPart, references.references, labelOverride, context, this._contentReferencesListPool, { expandedWhenEmptyResponse: checkModeOption(this.delegate.currentChatMode(), this.rendererOptions.referencesExpandedWhenEmptyResponse) });\n\t\treferencesPart.addDisposable(referencesPart.onDidChangeHeight(() => {\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\n\t\treturn referencesPart;\n\t}\n\n\tprivate renderCodeCitations(citations: IChatCodeCitations, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): ChatCodeCitationContentPart {\n\t\tconst citationsPart = this.instantiationService.createInstance(ChatCodeCitationContentPart, citations, context);\n\t\treturn citationsPart;\n\t}\n\n\tprivate handleRenderedCodeblocks(element: ChatTreeItem, part: IChatContentPart, codeBlockStartIndex: number): void {\n\t\tif (!part.addDisposable || part.codeblocksPartId === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst codeBlocksByResponseId = this.codeBlocksByResponseId.get(element.id) ?? [];\n\t\tthis.codeBlocksByResponseId.set(element.id, codeBlocksByResponseId);\n\t\tpart.addDisposable(toDisposable(() => {\n\t\t\tconst codeBlocksByResponseId = this.codeBlocksByResponseId.get(element.id);\n\t\t\tif (codeBlocksByResponseId) {\n\t\t\t\t// Only delete if this is my code block\n\t\t\t\tpart.codeblocks?.forEach((info, i) => {\n\t\t\t\t\tconst codeblock = codeBlocksByResponseId[codeBlockStartIndex + i];\n\t\t\t\t\tif (codeblock?.ownerMarkdownPartId === part.codeblocksPartId) {\n\t\t\t\t\t\tdelete codeBlocksByResponseId[codeBlockStartIndex + i];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\tpart.codeblocks?.forEach((info, i) => {\n\t\t\tcodeBlocksByResponseId[codeBlockStartIndex + i] = info;\n\t\t\tpart.addDisposable!(thenIfNotDisposed(info.uriPromise, uri => {\n\t\t\t\tif (!uri) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.codeBlocksByEditorUri.set(uri, info);\n\t\t\t\tpart.addDisposable!(toDisposable(() => {\n\t\t\t\t\tconst codeblock = this.codeBlocksByEditorUri.get(uri);\n\t\t\t\t\tif (codeblock?.ownerMarkdownPartId === part.codeblocksPartId) {\n\t\t\t\t\t\tthis.codeBlocksByEditorUri.delete(uri);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}));\n\t\t});\n\n\t}\n\n\tprivate renderToolInvocation(toolInvocation: IChatToolInvocation | IChatToolInvocationSerialized, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart | undefined {\n\t\tconst codeBlockStartIndex = context.codeBlockStartIndex;\n\t\tconst part = this.instantiationService.createInstance(ChatToolInvocationPart, toolInvocation, context, this.chatContentMarkdownRenderer, this._contentReferencesListPool, this._toolEditorPool, () => this._currentLayoutWidth, this._toolInvocationCodeBlockCollection, this._announcedToolProgressKeys, codeBlockStartIndex);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => {\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\t\tthis.handleRenderedCodeblocks(context.element, part, codeBlockStartIndex);\n\n\t\t// handling for when we want to put tool invocations inside a thinking part\n\t\tif (isResponseVM(context.element) && this.configService.getValue<string>('chat.agent.thinking.collapsedTools') !== 'none') {\n\t\t\tif (this.shouldPinPart(toolInvocation, context.element)) {\n\t\t\t\tif (this._currentThinkingPart && part?.domNode && toolInvocation.presentation !== 'hidden') {\n\t\t\t\t\tthis._currentThinkingPart.appendItem(part?.domNode);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.finalizeCurrentThinkingPart();\n\t\t\t}\n\t\t}\n\n\t\treturn part;\n\t}\n\n\tprivate renderExtensionsContent(extensionsContent: IChatExtensionsContent, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart | undefined {\n\t\tconst part = this.instantiationService.createInstance(ChatExtensionsContentPart, extensionsContent);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\treturn part;\n\t}\n\n\tprivate renderPullRequestContent(pullRequestContent: IChatPullRequestContent, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart | undefined {\n\t\tconst part = this.instantiationService.createInstance(ChatPullRequestContentPart, pullRequestContent);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\treturn part;\n\t}\n\n\tprivate renderProgressTask(task: IChatTask | IChatTaskSerialized, templateData: IChatListItemTemplate, context: IChatContentPartRenderContext): IChatContentPart | undefined {\n\t\tif (!isResponseVM(context.element)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskPart = this.instantiationService.createInstance(ChatTaskContentPart, task, this._contentReferencesListPool, this.chatContentMarkdownRenderer, context);\n\t\ttaskPart.addDisposable(taskPart.onDidChangeHeight(() => {\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\t\treturn taskPart;\n\t}\n\n\n\tprivate renderConfirmation(context: IChatContentPartRenderContext, confirmation: IChatConfirmation, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tconst part = this.instantiationService.createInstance(ChatConfirmationContentPart, confirmation, context);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\treturn part;\n\t}\n\n\tprivate renderElicitation(context: IChatContentPartRenderContext, elicitation: IChatElicitationRequest | IChatElicitationRequestSerialized, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tif (elicitation.kind === 'elicitationSerialized' ? elicitation.isHidden : elicitation.isHidden?.get()) {\n\t\t\treturn this.renderNoContent(other => elicitation.kind === other.kind);\n\t\t}\n\n\t\tconst part = this.instantiationService.createInstance(ChatElicitationContentPart, elicitation, context);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\treturn part;\n\t}\n\n\tprivate renderChangesSummary(content: IChatChangesSummaryPart, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tconst part = this.instantiationService.createInstance(ChatCheckpointFileChangesSummaryContentPart, content, context);\n\t\tpart.addDisposable(part.onDidChangeHeight(() => { this.updateItemHeight(templateData); }));\n\t\treturn part;\n\t}\n\n\tprivate renderAttachments(variables: IChatRequestVariableEntry[], contentReferences: ReadonlyArray<IChatContentReference> | undefined, templateData: IChatListItemTemplate) {\n\t\treturn this.instantiationService.createInstance(ChatAttachmentsContentPart, {\n\t\t\tvariables,\n\t\t\tcontentReferences,\n\t\t\tdomNode: undefined\n\t\t});\n\t}\n\n\tprivate renderTextEdit(context: IChatContentPartRenderContext, chatTextEdit: IChatTextEditGroup, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tconst textEditPart = this.instantiationService.createInstance(ChatTextEditContentPart, chatTextEdit, context, this.rendererOptions, this._diffEditorPool, this._currentLayoutWidth);\n\t\ttextEditPart.addDisposable(textEditPart.onDidChangeHeight(() => {\n\t\t\ttextEditPart.layout(this._currentLayoutWidth);\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\n\t\treturn textEditPart;\n\t}\n\n\tprivate renderMarkdown(markdown: IChatMarkdownContent, templateData: IChatListItemTemplate, context: IChatContentPartRenderContext): IChatContentPart {\n\t\tconst element = context.element;\n\t\tconst fillInIncompleteTokens = isResponseVM(element) && (!element.isComplete || element.isCanceled || element.errorDetails?.responseIsFiltered || element.errorDetails?.responseIsIncomplete || !!element.renderData);\n\t\tconst codeBlockStartIndex = context.codeBlockStartIndex;\n\t\tconst markdownPart = templateData.instantiationService.createInstance(ChatMarkdownContentPart, markdown, context, this._editorPool, fillInIncompleteTokens, codeBlockStartIndex, this.chatContentMarkdownRenderer, undefined, this._currentLayoutWidth, this.codeBlockModelCollection, {});\n\t\tif (isRequestVM(element)) {\n\t\t\tmarkdownPart.domNode.tabIndex = 0;\n\t\t\tif (this.configService.getValue<string>('chat.editRequests') === 'inline' && this.rendererOptions.editable) {\n\t\t\t\tmarkdownPart.domNode.classList.add('clickable');\n\t\t\t\tmarkdownPart.addDisposable(dom.addDisposableListener(markdownPart.domNode, dom.EventType.CLICK, (e: MouseEvent) => {\n\t\t\t\t\tif (this.viewModel?.editing?.id === element.id) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Don't handle clicks on links\n\t\t\t\t\tconst clickedElement = e.target as HTMLElement;\n\t\t\t\t\tif (clickedElement.tagName === 'A') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Don't handle if there's a text selection in the window\n\t\t\t\t\tconst selection = dom.getWindow(templateData.rowContainer).getSelection();\n\t\t\t\t\tif (selection && !selection.isCollapsed && selection.toString().length > 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Don't handle if there's a selection in code block\n\t\t\t\t\tconst monacoEditor = dom.findParentWithClass(clickedElement, 'monaco-editor');\n\t\t\t\t\tif (monacoEditor) {\n\t\t\t\t\t\tconst editorPart = Array.from(this.editorsInUse()).find(editor =>\n\t\t\t\t\t\t\teditor.element.contains(monacoEditor));\n\n\t\t\t\t\t\tif (editorPart?.editor.getSelection()?.isEmpty() === false) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis._onDidClickRequest.fire(templateData);\n\t\t\t\t}));\n\t\t\t\tthis._register(this.hoverService.setupManagedHover(getDefaultHoverDelegate('element'), markdownPart.domNode, localize('requestMarkdownPartTitle', \"Click to Edit\"), { trapFocus: true }));\n\t\t\t}\n\t\t\tmarkdownPart.addDisposable(dom.addDisposableListener(markdownPart.domNode, dom.EventType.FOCUS, () => {\n\t\t\t\tthis.hoverVisible(templateData.requestHover);\n\t\t\t}));\n\t\t\tmarkdownPart.addDisposable(dom.addDisposableListener(markdownPart.domNode, dom.EventType.BLUR, () => {\n\t\t\t\tthis.hoverHidden(templateData.requestHover);\n\t\t\t}));\n\t\t}\n\n\t\tmarkdownPart.addDisposable(markdownPart.onDidChangeHeight(() => {\n\t\t\tmarkdownPart.layout(this._currentLayoutWidth);\n\t\t\tthis.updateItemHeight(templateData);\n\t\t}));\n\n\t\tthis.handleRenderedCodeblocks(element, markdownPart, codeBlockStartIndex);\n\n\t\treturn markdownPart;\n\t}\n\n\trenderThinkingPart(content: IChatThinkingPart, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart {\n\t\tthis._streamingThinking = true;\n\n\t\t// TODO @justschen @karthiknadig: remove this when OSWE moves off commentary channel\n\t\tif (!content.id) {\n\t\t\tcontent.id = Date.now().toString();\n\t\t}\n\n\t\t// if array, we do a naive part by part rendering for now\n\t\tif (Array.isArray(content.value)) {\n\t\t\tif (content.value.length < 1) {\n\t\t\t\tthis._currentThinkingPart?.finalizeTitleIfDefault();\n\t\t\t\treturn this.renderNoContent(other => content.kind === other.kind);\n\t\t\t}\n\t\t\tfor (const item of content.value) {\n\t\t\t\tif (item) {\n\t\t\t\t\tif (this._currentThinkingPart) {\n\t\t\t\t\t\tthis._currentThinkingPart.setupThinkingContainer({ ...content, value: item }, context);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst itemContent = { ...content, value: item };\n\t\t\t\t\t\tconst itemPart = templateData.instantiationService.createInstance(ChatThinkingContentPart, itemContent, context);\n\t\t\t\t\t\titemPart.addDisposable(itemPart.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\t\t\t\t\tthis._currentThinkingPart = itemPart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this._currentThinkingPart ?? this.renderNoContent(other => content.kind === other.kind);\n\t\t\t// non-array, handle case where we are currently thinking vs. starting a new thinking part\n\t\t} else {\n\t\t\tif (this._currentThinkingPart) {\n\t\t\t\tthis._currentThinkingPart.setupThinkingContainer(content, context);\n\t\t\t} else {\n\t\t\t\tconst part = templateData.instantiationService.createInstance(ChatThinkingContentPart, content, context);\n\t\t\t\tpart.addDisposable(part.onDidChangeHeight(() => this.updateItemHeight(templateData)));\n\t\t\t\tthis._currentThinkingPart = part;\n\t\t\t}\n\t\t\treturn this._currentThinkingPart;\n\n\t\t}\n\t}\n\n\tdisposeElement(node: ITreeNode<ChatTreeItem, FuzzyScore>, index: number, templateData: IChatListItemTemplate, details?: IListElementRenderDetails): void {\n\t\tthis.traceLayout('disposeElement', `Disposing element, index=${index}`);\n\t\ttemplateData.elementDisposables.clear();\n\n\t\tif (templateData.currentElement && !this.viewModel?.editing) {\n\t\t\tthis.templateDataByRequestId.delete(templateData.currentElement.id);\n\t\t}\n\n\t\tif (isRequestVM(node.element) && node.element.id === this.viewModel?.editing?.id && details?.onScroll) {\n\t\t\tthis._onDidDispose.fire(templateData);\n\t\t}\n\n\t\t// Don't retain the toolbar context which includes chat viewmodels\n\t\tif (templateData.titleToolbar) {\n\t\t\ttemplateData.titleToolbar.context = undefined;\n\t\t}\n\t\ttemplateData.footerToolbar.context = undefined;\n\t}\n\n\tprivate renderMcpServersInteractionRequired(content: IChatMcpServersStarting, context: IChatContentPartRenderContext, templateData: IChatListItemTemplate): IChatContentPart {\n\t\treturn this.instantiationService.createInstance(ChatMcpServersInteractionContentPart, content, context);\n\t}\n\n\tdisposeTemplate(templateData: IChatListItemTemplate): void {\n\t\ttemplateData.templateDisposables.dispose();\n\t}\n\n\tprivate hoverVisible(requestHover: HTMLElement) {\n\t\trequestHover.style.opacity = '1';\n\t}\n\n\tprivate hoverHidden(requestHover: HTMLElement) {\n\t\trequestHover.style.opacity = '0';\n\t}\n\n}\n\nexport class ChatListDelegate implements IListVirtualDelegate<ChatTreeItem> {\n\tconstructor(\n\t\tprivate readonly defaultElementHeight: number,\n\t\t@ILogService private readonly logService: ILogService\n\t) { }\n\n\tprivate _traceLayout(method: string, message: string) {\n\t\tif (forceVerboseLayoutTracing) {\n\t\t\tthis.logService.info(`ChatListDelegate#${method}: ${message}`);\n\t\t} else {\n\t\t\tthis.logService.trace(`ChatListDelegate#${method}: ${message}`);\n\t\t}\n\t}\n\n\tgetHeight(element: ChatTreeItem): number {\n\t\tconst kind = isRequestVM(element) ? 'request' : 'response';\n\t\tconst height = element.currentRenderedHeight ?? this.defaultElementHeight;\n\t\tthis._traceLayout('getHeight', `${kind}, height=${height}`);\n\t\treturn height;\n\t}\n\n\tgetTemplateId(element: ChatTreeItem): string {\n\t\treturn ChatListItemRenderer.ID;\n\t}\n\n\thasDynamicHeight(element: ChatTreeItem): boolean {\n\t\treturn true;\n\t}\n}\n\nconst voteDownDetailLabels: Record<ChatAgentVoteDownReason, string> = {\n\t[ChatAgentVoteDownReason.IncorrectCode]: localize('incorrectCode', \"Suggested incorrect code\"),\n\t[ChatAgentVoteDownReason.DidNotFollowInstructions]: localize('didNotFollowInstructions', \"Didn't follow instructions\"),\n\t[ChatAgentVoteDownReason.MissingContext]: localize('missingContext', \"Missing context\"),\n\t[ChatAgentVoteDownReason.OffensiveOrUnsafe]: localize('offensiveOrUnsafe', \"Offensive or unsafe\"),\n\t[ChatAgentVoteDownReason.PoorlyWrittenOrFormatted]: localize('poorlyWrittenOrFormatted', \"Poorly written or formatted\"),\n\t[ChatAgentVoteDownReason.RefusedAValidRequest]: localize('refusedAValidRequest', \"Refused a valid request\"),\n\t[ChatAgentVoteDownReason.IncompleteCode]: localize('incompleteCode', \"Incomplete code\"),\n\t[ChatAgentVoteDownReason.WillReportIssue]: localize('reportIssue', \"Report an issue\"),\n\t[ChatAgentVoteDownReason.Other]: localize('other', \"Other\"),\n};\n\nexport class ChatVoteDownButton extends DropdownMenuActionViewItem {\n\tconstructor(\n\t\taction: IAction,\n\t\toptions: IDropdownMenuActionViewItemOptions | undefined,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IWorkbenchIssueService private readonly issueService: IWorkbenchIssueService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t) {\n\t\tsuper(action,\n\t\t\t{ getActions: () => this.getActions(), },\n\t\t\tcontextMenuService,\n\t\t\t{\n\t\t\t\t...options,\n\t\t\t\tclassNames: ThemeIcon.asClassNameArray(Codicon.thumbsdown),\n\t\t\t});\n\t}\n\n\tgetActions(): readonly IAction[] {\n\t\treturn [\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.IncorrectCode),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.DidNotFollowInstructions),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.IncompleteCode),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.MissingContext),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.PoorlyWrittenOrFormatted),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.RefusedAValidRequest),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.OffensiveOrUnsafe),\n\t\t\tthis.getVoteDownDetailAction(ChatAgentVoteDownReason.Other),\n\t\t\t{\n\t\t\t\tid: 'reportIssue',\n\t\t\t\tlabel: voteDownDetailLabels[ChatAgentVoteDownReason.WillReportIssue],\n\t\t\t\ttooltip: '',\n\t\t\t\tenabled: true,\n\t\t\t\tclass: undefined,\n\t\t\t\trun: async (context: IChatResponseViewModel) => {\n\t\t\t\t\tif (!isResponseVM(context)) {\n\t\t\t\t\t\tthis.logService.error('ChatVoteDownButton#run: invalid context');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tawait this.commandService.executeCommand(MarkUnhelpfulActionId, context, ChatAgentVoteDownReason.WillReportIssue);\n\t\t\t\t\tawait this.issueService.openReporter({ extensionId: context.agent?.extensionId.value });\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\n\t\tthis.element?.classList.toggle('checked', this.action.checked);\n\t}\n\n\tprivate getVoteDownDetailAction(reason: ChatAgentVoteDownReason): IAction {\n\t\tconst label = voteDownDetailLabels[reason];\n\t\treturn {\n\t\t\tid: MarkUnhelpfulActionId,\n\t\t\tlabel,\n\t\t\ttooltip: '',\n\t\t\tenabled: true,\n\t\t\tchecked: (this._context as IChatResponseViewModel).voteDownReason === reason,\n\t\t\tclass: undefined,\n\t\t\trun: async (context: IChatResponseViewModel) => {\n\t\t\t\tif (!isResponseVM(context)) {\n\t\t\t\t\tthis.logService.error('ChatVoteDownButton#getVoteDownDetailAction: invalid context');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait this.commandService.executeCommand(MarkUnhelpfulActionId, context, reason);\n\t\t\t}\n\t\t};\n\t}\n}\n"]}