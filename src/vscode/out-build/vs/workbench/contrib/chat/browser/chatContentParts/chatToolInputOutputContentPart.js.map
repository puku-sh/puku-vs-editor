{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatContentParts/chatToolInputOutputContentPart.ts"],"names":[],"mappings":"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","file":"chatToolInputOutputContentPart.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { ButtonWithIcon } from '../../../../../base/browser/ui/button/button.js';\nimport { HoverStyle } from '../../../../../base/browser/ui/hover/hover.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { IMarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, ISettableObservable, observableValue } from '../../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { localize } from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IHoverService } from '../../../../../platform/hover/browser/hover.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IChatRendererContent } from '../../common/chatViewModel.js';\nimport { LanguageModelPartAudience } from '../../common/languageModels.js';\nimport { ChatTreeItem, IChatCodeBlockInfo } from '../chat.js';\nimport { CodeBlockPart, ICodeBlockData, ICodeBlockRenderOptions } from '../codeBlockPart.js';\nimport { IDisposableReference } from './chatCollections.js';\nimport { ChatQueryTitlePart } from './chatConfirmationWidget.js';\nimport { IChatContentPartRenderContext } from './chatContentParts.js';\nimport { ChatToolOutputContentSubPart } from './chatToolOutputContentSubPart.js';\n\nexport interface IChatCollapsibleIOCodePart {\n\tkind: 'code';\n\ttextModel: ITextModel;\n\tlanguageId: string;\n\toptions: ICodeBlockRenderOptions;\n\tcodeBlockInfo: IChatCodeBlockInfo;\n}\n\nexport interface IChatCollapsibleIODataPart {\n\tkind: 'data';\n\tvalue?: Uint8Array;\n\taudience?: LanguageModelPartAudience[];\n\tmimeType: string | undefined;\n\turi: URI;\n}\n\nexport type ChatCollapsibleIOPart = IChatCollapsibleIOCodePart | IChatCollapsibleIODataPart;\n\nexport interface IChatCollapsibleInputData extends IChatCollapsibleIOCodePart { }\nexport interface IChatCollapsibleOutputData {\n\tparts: ChatCollapsibleIOPart[];\n}\n\nexport class ChatCollapsibleInputOutputContentPart extends Disposable {\n\tprivate readonly _onDidChangeHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeHeight = this._onDidChangeHeight.event;\n\n\tprivate _currentWidth: number = 0;\n\tprivate readonly _editorReferences: IDisposableReference<CodeBlockPart>[] = [];\n\tprivate readonly _titlePart: ChatQueryTitlePart;\n\tprivate _outputSubPart: ChatToolOutputContentSubPart | undefined;\n\tpublic readonly domNode: HTMLElement;\n\n\tget codeblocks(): IChatCodeBlockInfo[] {\n\t\tconst inputCodeblocks = this._editorReferences.map(ref => {\n\t\t\tconst cbi = this.input.codeBlockInfo;\n\t\t\treturn cbi;\n\t\t});\n\t\tconst outputCodeblocks = this._outputSubPart?.codeblocks ?? [];\n\t\treturn [...inputCodeblocks, ...outputCodeblocks];\n\t}\n\n\tpublic set title(s: string | IMarkdownString) {\n\t\tthis._titlePart.title = s;\n\t}\n\n\tpublic get title(): string | IMarkdownString {\n\t\treturn this._titlePart.title;\n\t}\n\n\tprivate readonly _expanded: ISettableObservable<boolean>;\n\n\tpublic get expanded(): boolean {\n\t\treturn this._expanded.get();\n\t}\n\n\tconstructor(\n\t\ttitle: IMarkdownString | string,\n\t\tsubtitle: string | IMarkdownString | undefined,\n\t\tprogressTooltip: IMarkdownString | string | undefined,\n\t\tprivate readonly context: IChatContentPartRenderContext,\n\t\tprivate readonly input: IChatCollapsibleInputData,\n\t\tprivate readonly output: IChatCollapsibleOutputData | undefined,\n\t\tisError: boolean,\n\t\tinitiallyExpanded: boolean,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IHoverService hoverService: IHoverService,\n\t) {\n\t\tsuper();\n\t\tthis._currentWidth = context.currentWidth();\n\n\t\tconst container = dom.h('.chat-confirmation-widget-container');\n\t\tconst titleEl = dom.h('.chat-confirmation-widget-title-inner');\n\t\tconst elements = dom.h('.chat-confirmation-widget');\n\t\tthis.domNode = container.root;\n\t\tcontainer.root.appendChild(elements.root);\n\n\t\tconst titlePart = this._titlePart = this._register(_instantiationService.createInstance(\n\t\t\tChatQueryTitlePart,\n\t\t\ttitleEl.root,\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t));\n\t\tthis._register(titlePart.onDidChangeHeight(() => this._onDidChangeHeight.fire()));\n\n\t\tconst spacer = document.createElement('span');\n\t\tspacer.style.flexGrow = '1';\n\n\t\tconst btn = this._register(new ButtonWithIcon(elements.root, {}));\n\t\tbtn.element.classList.add('chat-confirmation-widget-title', 'monaco-text-button');\n\t\tbtn.labelElement.append(titleEl.root);\n\n\t\tconst check = dom.h(isError\n\t\t\t? ThemeIcon.asCSSSelector(Codicon.error)\n\t\t\t: output\n\t\t\t\t? ThemeIcon.asCSSSelector(Codicon.check)\n\t\t\t\t: ThemeIcon.asCSSSelector(ThemeIcon.modify(Codicon.loading, 'spin'))\n\t\t);\n\n\t\tif (progressTooltip) {\n\t\t\tthis._register(hoverService.setupDelayedHover(check.root, {\n\t\t\t\tcontent: progressTooltip,\n\t\t\t\tstyle: HoverStyle.Pointer,\n\t\t\t}));\n\t\t}\n\n\t\tconst expanded = this._expanded = observableValue(this, initiallyExpanded);\n\t\tthis._register(autorun(r => {\n\t\t\tconst value = expanded.read(r);\n\t\t\tbtn.icon = isError\n\t\t\t\t? Codicon.error\n\t\t\t\t: output\n\t\t\t\t\t? Codicon.check\n\t\t\t\t\t: ThemeIcon.modify(Codicon.loading, 'spin');\n\t\t\telements.root.classList.toggle('collapsed', !value);\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\n\t\tconst toggle = (e: Event) => {\n\t\t\tif (!e.defaultPrevented) {\n\t\t\t\tconst value = expanded.get();\n\t\t\t\texpanded.set(!value, undefined);\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\n\t\tthis._register(btn.onDidClick(toggle));\n\n\t\tconst message = dom.h('.chat-confirmation-widget-message');\n\t\tmessage.root.appendChild(this.createMessageContents());\n\t\telements.root.appendChild(message.root);\n\n\t\tconst topLevelResources = this.output?.parts\n\t\t\t.filter(p => p.kind === 'data')\n\t\t\t.filter(p => !p.audience || p.audience.includes(LanguageModelPartAudience.User));\n\t\tif (topLevelResources?.length) {\n\t\t\tconst resourceSubPart = this._register(this._instantiationService.createInstance(\n\t\t\t\tChatToolOutputContentSubPart,\n\t\t\t\tthis.context,\n\t\t\t\ttopLevelResources,\n\t\t\t));\n\t\t\tconst group = resourceSubPart.domNode;\n\t\t\tgroup.classList.add('chat-collapsible-top-level-resource-group');\n\t\t\tcontainer.root.appendChild(group);\n\t\t\tthis._register(autorun(r => {\n\t\t\t\tgroup.style.display = expanded.read(r) ? 'none' : '';\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate createMessageContents() {\n\t\tconst contents = dom.h('div', [\n\t\t\tdom.h('h3@inputTitle'),\n\t\t\tdom.h('div@input'),\n\t\t\tdom.h('h3@outputTitle'),\n\t\t\tdom.h('div@output'),\n\t\t]);\n\n\t\tconst { input, output } = this;\n\n\t\tcontents.inputTitle.textContent = localize('chat.input', \"Input\");\n\t\tthis.addCodeBlock(input, contents.input);\n\n\t\tif (!output) {\n\t\t\tcontents.output.remove();\n\t\t\tcontents.outputTitle.remove();\n\t\t} else {\n\t\t\tcontents.outputTitle.textContent = localize('chat.output', \"Output\");\n\t\t\tconst outputSubPart = this._register(this._instantiationService.createInstance(\n\t\t\t\tChatToolOutputContentSubPart,\n\t\t\t\tthis.context,\n\t\t\t\toutput.parts,\n\t\t\t));\n\t\t\tthis._outputSubPart = outputSubPart;\n\t\t\tthis._register(outputSubPart.onDidChangeHeight(() => this._onDidChangeHeight.fire()));\n\t\t\tcontents.output.appendChild(outputSubPart.domNode);\n\t\t}\n\n\t\treturn contents.root;\n\t}\n\n\tprivate addCodeBlock(part: IChatCollapsibleIOCodePart, container: HTMLElement) {\n\t\tconst data: ICodeBlockData = {\n\t\t\tlanguageId: part.languageId,\n\t\t\ttextModel: Promise.resolve(part.textModel),\n\t\t\tcodeBlockIndex: part.codeBlockInfo.codeBlockIndex,\n\t\t\tcodeBlockPartIndex: 0,\n\t\t\telement: this.context.element,\n\t\t\tparentContextKeyService: this.contextKeyService,\n\t\t\trenderOptions: part.options,\n\t\t\tchatSessionResource: this.context.element.sessionResource,\n\t\t};\n\t\tconst editorReference = this._register(this.context.editorPool.get());\n\t\teditorReference.object.render(data, this._currentWidth || 300);\n\t\tthis._register(editorReference.object.onDidChangeContentHeight(() => this._onDidChangeHeight.fire()));\n\t\tcontainer.appendChild(editorReference.object.element);\n\t\tthis._editorReferences.push(editorReference);\n\t}\n\n\thasSameContent(other: IChatRendererContent, followingContent: IChatRendererContent[], element: ChatTreeItem): boolean {\n\t\t// For now, we consider content different unless it's exactly the same instance\n\t\treturn false;\n\t}\n\n\tlayout(width: number): void {\n\t\tthis._currentWidth = width;\n\t\tthis._editorReferences.forEach(r => r.object.layout(width));\n\t\tthis._outputSubPart?.layout(width);\n\t}\n}\n"]}