{"version":3,"sources":["vs/workbench/contrib/chat/browser/modelPicker/modelPickerActionItem.ts"],"names":[],"mappings":"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","file":"modelPickerActionItem.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from '../../../../../base/common/actions.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { ILanguageModelChatMetadataAndIdentifier } from '../../common/languageModels.js';\nimport { localize } from '../../../../../nls.js';\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { renderLabelWithIcons } from '../../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ActionWidgetDropdownActionViewItem } from '../../../../../platform/actions/browser/actionWidgetDropdownActionViewItem.js';\nimport { IActionWidgetService } from '../../../../../platform/actionWidget/browser/actionWidget.js';\nimport { IActionWidgetDropdownAction, IActionWidgetDropdownActionProvider, IActionWidgetDropdownOptions } from '../../../../../platform/actionWidget/browser/actionWidgetDropdown.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { ChatEntitlement, IChatEntitlementService } from '../../../../services/chat/common/chatEntitlementService.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { DEFAULT_MODEL_PICKER_CATEGORY } from '../../common/modelPicker/modelPickerWidget.js';\nimport { ManageModelsAction } from '../actions/manageModelsActions.js';\nimport { IActionProvider } from '../../../../../base/browser/ui/dropdown/dropdown.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { MANAGE_CHAT_COMMAND_ID } from '../../common/constants.js';\nimport { TelemetryTrustedValue } from '../../../../../platform/telemetry/common/telemetryUtils.js';\n\nexport interface IModelPickerDelegate {\n\treadonly onDidChangeModel: Event<ILanguageModelChatMetadataAndIdentifier>;\n\tgetCurrentModel(): ILanguageModelChatMetadataAndIdentifier | undefined;\n\tsetModel(model: ILanguageModelChatMetadataAndIdentifier): void;\n\tgetModels(): ILanguageModelChatMetadataAndIdentifier[];\n}\n\ntype ChatModelChangeClassification = {\n\towner: 'lramos15';\n\tcomment: 'Reporting when the model picker is switched';\n\tfromModel?: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The previous chat model' };\n\ttoModel: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The new chat model' };\n};\n\ntype ChatModelChangeEvent = {\n\tfromModel: string | TelemetryTrustedValue<string> | undefined;\n\ttoModel: string | TelemetryTrustedValue<string>;\n};\n\n\nfunction modelDelegateToWidgetActionsProvider(delegate: IModelPickerDelegate, telemetryService: ITelemetryService): IActionWidgetDropdownActionProvider {\n\treturn {\n\t\tgetActions: () => {\n\t\t\treturn delegate.getModels().map(model => {\n\t\t\t\treturn {\n\t\t\t\t\tid: model.metadata.id,\n\t\t\t\t\tenabled: true,\n\t\t\t\t\ticon: model.metadata.statusIcon,\n\t\t\t\t\tchecked: model.identifier === delegate.getCurrentModel()?.identifier,\n\t\t\t\t\tcategory: model.metadata.modelPickerCategory || DEFAULT_MODEL_PICKER_CATEGORY,\n\t\t\t\t\tclass: undefined,\n\t\t\t\t\tdescription: model.metadata.detail,\n\t\t\t\t\ttooltip: model.metadata.tooltip ?? model.metadata.name,\n\t\t\t\t\tlabel: model.metadata.name,\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tconst previousModel = delegate.getCurrentModel();\n\t\t\t\t\t\ttelemetryService.publicLog2<ChatModelChangeEvent, ChatModelChangeClassification>('chat.modelChange', {\n\t\t\t\t\t\t\tfromModel: previousModel?.metadata.vendor === 'copilot' ? new TelemetryTrustedValue(previousModel.identifier) : 'unknown',\n\t\t\t\t\t\t\ttoModel: model.metadata.vendor === 'copilot' ? new TelemetryTrustedValue(model.identifier) : 'unknown'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdelegate.setModel(model);\n\t\t\t\t\t}\n\t\t\t\t} satisfies IActionWidgetDropdownAction;\n\t\t\t});\n\t\t}\n\t};\n}\n\nfunction getModelPickerActionBarActionProvider(commandService: ICommandService, chatEntitlementService: IChatEntitlementService, productService: IProductService): IActionProvider {\n\n\tconst actionProvider: IActionProvider = {\n\t\tgetActions: () => {\n\t\t\tconst additionalActions: IAction[] = [];\n\t\t\tif (\n\t\t\t\tchatEntitlementService.entitlement === ChatEntitlement.Free ||\n\t\t\t\tchatEntitlementService.entitlement === ChatEntitlement.Pro ||\n\t\t\t\tchatEntitlementService.entitlement === ChatEntitlement.ProPlus ||\n\t\t\t\tchatEntitlementService.isInternal\n\t\t\t) {\n\t\t\t\tadditionalActions.push({\n\t\t\t\t\tid: 'manageModels',\n\t\t\t\t\tlabel: localize('chat.manageModels', \"Manage Models...\"),\n\t\t\t\t\tenabled: true,\n\t\t\t\t\ttooltip: localize('chat.manageModels.tooltip', \"Manage Language Models\"),\n\t\t\t\t\tclass: undefined,\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tconst commandId = ManageModelsAction.ID;\n\t\t\t\t\t\tcommandService.executeCommand(productService.quality === 'stable' ? commandId : MANAGE_CHAT_COMMAND_ID);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Add sign-in / upgrade option if entitlement is anonymous / free / new user\n\t\t\tconst isNewOrAnonymousUser = !chatEntitlementService.sentiment.installed ||\n\t\t\t\tchatEntitlementService.entitlement === ChatEntitlement.Available ||\n\t\t\t\tchatEntitlementService.anonymous ||\n\t\t\t\tchatEntitlementService.entitlement === ChatEntitlement.Unknown;\n\t\t\tif (isNewOrAnonymousUser || chatEntitlementService.entitlement === ChatEntitlement.Free) {\n\t\t\t\tadditionalActions.push({\n\t\t\t\t\tid: 'moreModels',\n\t\t\t\t\tlabel: isNewOrAnonymousUser ? localize('chat.moreModels', \"Add Language Models\") : localize('chat.morePremiumModels', \"Add Premium Models\"),\n\t\t\t\t\tenabled: true,\n\t\t\t\t\ttooltip: isNewOrAnonymousUser ? localize('chat.moreModels.tooltip', \"Add Language Models\") : localize('chat.morePremiumModels.tooltip', \"Add Premium Models\"),\n\t\t\t\t\tclass: undefined,\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tconst commandId = isNewOrAnonymousUser ? 'workbench.action.chat.triggerSetup' : 'workbench.action.chat.upgradePlan';\n\t\t\t\t\t\tcommandService.executeCommand(commandId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn additionalActions;\n\t\t}\n\t};\n\treturn actionProvider;\n}\n\n/**\n * Action view item for selecting a language model in the chat interface.\n */\nexport class ModelPickerActionItem extends ActionWidgetDropdownActionViewItem {\n\tconstructor(\n\t\taction: IAction,\n\t\tprotected currentModel: ILanguageModelChatMetadataAndIdentifier | undefined,\n\t\twidgetOptions: Omit<IActionWidgetDropdownOptions, 'label' | 'labelRenderer'> | undefined,\n\t\tdelegate: IModelPickerDelegate,\n\t\t@IActionWidgetService actionWidgetService: IActionWidgetService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IChatEntitlementService chatEntitlementService: IChatEntitlementService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IProductService productService: IProductService,\n\t) {\n\t\t// Modify the original action with a different label and make it show the current model\n\t\tconst actionWithLabel: IAction = {\n\t\t\t...action,\n\t\t\tlabel: currentModel?.metadata.name ?? localize('chat.modelPicker.label', \"Pick Model\"),\n\t\t\ttooltip: localize('chat.modelPicker.label', \"Pick Model\"),\n\t\t\trun: () => { }\n\t\t};\n\n\t\tconst modelPickerActionWidgetOptions: Omit<IActionWidgetDropdownOptions, 'label' | 'labelRenderer'> = {\n\t\t\tactionProvider: modelDelegateToWidgetActionsProvider(delegate, telemetryService),\n\t\t\tactionBarActionProvider: getModelPickerActionBarActionProvider(commandService, chatEntitlementService, productService)\n\t\t};\n\n\t\tsuper(actionWithLabel, widgetOptions ?? modelPickerActionWidgetOptions, actionWidgetService, keybindingService, contextKeyService);\n\n\t\t// Listen for model changes from the delegate\n\t\tthis._register(delegate.onDidChangeModel(model => {\n\t\t\tthis.currentModel = model;\n\t\t\tif (this.element) {\n\t\t\t\tthis.renderLabel(this.element);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprotected override renderLabel(element: HTMLElement): IDisposable | null {\n\t\tconst domChildren = [];\n\t\tif (this.currentModel?.metadata.statusIcon) {\n\t\t\tdomChildren.push(...renderLabelWithIcons(`\\$(${this.currentModel.metadata.statusIcon.id})`));\n\t\t}\n\t\tdomChildren.push(dom.$('span.chat-model-label', undefined, this.currentModel?.metadata.name ?? localize('chat.modelPicker.label', \"Pick Model\")));\n\t\tdomChildren.push(...renderLabelWithIcons(`$(chevron-down)`));\n\n\t\tdom.reset(element, ...domChildren);\n\t\tthis.setAriaLabelAttributes(element);\n\t\treturn null;\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('chat-modelPicker-item');\n\t}\n}\n"]}