{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatEditorInput.ts"],"names":[],"mappings":"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","file":"chatEditorInput.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { truncate } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as nls from '../../../../nls.js';\nimport { ConfirmResult, IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { EditorInputCapabilities, IEditorIdentifier, IEditorSerializer, IUntypedEditorInput, Verbosity } from '../../../common/editor.js';\nimport { EditorInput, IEditorCloseHandler } from '../../../common/editor/editorInput.js';\nimport { IChatEditingSession, ModifiedFileEntryState } from '../common/chatEditingService.js';\nimport { IChatModel } from '../common/chatModel.js';\nimport { IChatService } from '../common/chatService.js';\nimport { IChatSessionsService, localChatSessionType } from '../common/chatSessionsService.js';\nimport { LocalChatSessionUri } from '../common/chatUri.js';\nimport { ChatAgentLocation, ChatEditorTitleMaxLength } from '../common/constants.js';\nimport { IClearEditingSessionConfirmationOptions } from './actions/chatActions.js';\nimport type { IChatEditorOptions } from './chatEditor.js';\n\nconst ChatEditorIcon = registerIcon('chat-editor-label-icon', Codicon.chatSparkle, nls.localize('chatEditorLabelIcon', 'Icon of the chat editor label.'));\n\nexport class ChatEditorInput extends EditorInput implements IEditorCloseHandler {\n\t/** Maps input name strings to sets of active editor counts */\n\tstatic readonly countsInUseMap = new Map<string, Set<number>>();\n\n\tstatic readonly TypeID: string = 'workbench.input.chatSession';\n\tstatic readonly EditorID: string = 'workbench.editor.chatSession';\n\n\tprivate readonly inputCount: number;\n\tprivate readonly inputName: string;\n\n\tprivate _sessionResource: URI | undefined;\n\n\t/**\n\t * Get the uri of the session this editor input is associated with.\n\t *\n\t * This should be preferred over using `resource` directly, as it handles cases where a chat editor becomes a session\n\t */\n\tpublic get sessionResource(): URI | undefined { return this._sessionResource; }\n\n\tprivate hasCustomTitle: boolean = false;\n\tprivate didTransferOutEditingSession = false;\n\tprivate cachedIcon: ThemeIcon | URI | undefined;\n\n\tprivate model: IChatModel | undefined;\n\n\tstatic getNewEditorUri(): URI {\n\t\treturn ChatEditorUri.getNewEditorUri();\n\t}\n\n\tprivate static getNextCount(inputName: string): number {\n\t\tlet count = 0;\n\t\twhile (ChatEditorInput.countsInUseMap.get(inputName)?.has(count)) {\n\t\t\tcount++;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\tconstructor(\n\t\treadonly resource: URI,\n\t\treadonly options: IChatEditorOptions,\n\t\t@IChatService private readonly chatService: IChatService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IChatSessionsService private readonly chatSessionsService: IChatSessionsService,\n\t) {\n\t\tsuper();\n\n\t\tif (resource.scheme === Schemas.vscodeChatEditor) {\n\t\t\tconst parsed = ChatEditorUri.parse(resource);\n\t\t\tif (!parsed || typeof parsed !== 'number') {\n\t\t\t\tthrow new Error('Invalid chat URI');\n\t\t\t}\n\t\t} else if (resource.scheme === Schemas.vscodeLocalChatSession) {\n\t\t\tconst localSessionId = LocalChatSessionUri.parseLocalSessionId(resource);\n\t\t\tif (!localSessionId) {\n\t\t\t\tthrow new Error('Invalid local chat session URI');\n\t\t\t}\n\t\t\tthis._sessionResource = resource;\n\t\t} else {\n\t\t\tthis._sessionResource = resource;\n\t\t}\n\n\t\t// Check if we already have a custom title for this session\n\t\tconst hasExistingCustomTitle = this._sessionResource && (\n\t\t\tthis.chatService.getSession(this._sessionResource)?.title ||\n\t\t\tthis.chatService.getPersistedSessionTitle(this._sessionResource)?.trim()\n\t\t);\n\n\t\tthis.hasCustomTitle = Boolean(hasExistingCustomTitle);\n\n\t\t// Input counts are unique to the displayed fallback title\n\t\tthis.inputName = options.title?.fallback ?? '';\n\t\tif (!ChatEditorInput.countsInUseMap.has(this.inputName)) {\n\t\t\tChatEditorInput.countsInUseMap.set(this.inputName, new Set());\n\t\t}\n\n\t\t// Only allocate a count if we don't already have a custom title\n\t\tif (!this.hasCustomTitle) {\n\t\t\tthis.inputCount = ChatEditorInput.getNextCount(this.inputName);\n\t\t\tChatEditorInput.countsInUseMap.get(this.inputName)?.add(this.inputCount);\n\t\t\tthis._register(toDisposable(() => {\n\t\t\t\t// Only remove if we haven't already removed it due to custom title\n\t\t\t\tif (!this.hasCustomTitle) {\n\t\t\t\t\tChatEditorInput.countsInUseMap.get(this.inputName)?.delete(this.inputCount);\n\t\t\t\t\tif (ChatEditorInput.countsInUseMap.get(this.inputName)?.size === 0) {\n\t\t\t\t\t\tChatEditorInput.countsInUseMap.delete(this.inputName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t} else {\n\t\t\tthis.inputCount = 0; // Not used when we have a custom title\n\t\t}\n\t}\n\n\toverride closeHandler = this;\n\n\tshowConfirm(): boolean {\n\t\treturn this.model?.editingSession ? shouldShowClearEditingSessionConfirmation(this.model.editingSession) : false;\n\t}\n\n\ttransferOutEditingSession(): IChatEditingSession | undefined {\n\t\tthis.didTransferOutEditingSession = true;\n\t\treturn this.model?.editingSession;\n\t}\n\n\tasync confirm(editors: ReadonlyArray<IEditorIdentifier>): Promise<ConfirmResult> {\n\t\tif (!this.model?.editingSession || this.didTransferOutEditingSession) {\n\t\t\treturn ConfirmResult.SAVE;\n\t\t}\n\n\t\tconst titleOverride = nls.localize('chatEditorConfirmTitle', \"Close Chat Editor\");\n\t\tconst messageOverride = nls.localize('chat.startEditing.confirmation.pending.message.default', \"Closing the chat editor will end your current edit session.\");\n\t\tconst result = await showClearEditingSessionConfirmation(this.model.editingSession, this.dialogService, { titleOverride, messageOverride });\n\t\treturn result ? ConfirmResult.SAVE : ConfirmResult.CANCEL;\n\t}\n\n\toverride get editorId(): string | undefined {\n\t\treturn ChatEditorInput.EditorID;\n\t}\n\n\toverride get capabilities(): EditorInputCapabilities {\n\t\treturn super.capabilities | EditorInputCapabilities.Singleton | EditorInputCapabilities.CanDropIntoEditor;\n\t}\n\n\toverride matches(otherInput: EditorInput | IUntypedEditorInput): boolean {\n\t\tif (!(otherInput instanceof ChatEditorInput)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn isEqual(this.sessionResource, otherInput.sessionResource);\n\t}\n\n\toverride get typeId(): string {\n\t\treturn ChatEditorInput.TypeID;\n\t}\n\n\toverride getName(): string {\n\t\t// If we have a resolved model, use its title\n\t\tif (this.model?.title) {\n\t\t\t// Only truncate if the default title is being used (don't truncate custom titles)\n\t\t\treturn this.model.hasCustomTitle ? this.model.title : truncate(this.model.title, ChatEditorTitleMaxLength);\n\t\t}\n\n\t\t// If we have a sessionId but no resolved model, try to get the title from persisted sessions\n\t\tif (this._sessionResource) {\n\t\t\t// First try the active session registry\n\t\t\tconst existingSession = this.chatService.getSession(this._sessionResource);\n\t\t\tif (existingSession?.title) {\n\t\t\t\treturn existingSession.title;\n\t\t\t}\n\n\t\t\t// If not in active registry, try persisted session data\n\t\t\tconst persistedTitle = this.chatService.getPersistedSessionTitle(this._sessionResource);\n\t\t\tif (persistedTitle && persistedTitle.trim()) { // Only use non-empty persisted titles\n\t\t\t\treturn persistedTitle;\n\t\t\t}\n\t\t}\n\n\t\t// If a preferred title was provided in options, use it\n\t\tif (this.options.title?.preferred) {\n\t\t\treturn this.options.title.preferred;\n\t\t}\n\n\t\t// Fall back to default naming pattern\n\t\tconst inputCountSuffix = (this.inputCount > 0 ? ` ${this.inputCount + 1}` : '');\n\t\tconst defaultName = this.options.title?.fallback ?? nls.localize('chatEditorName', \"Chat\");\n\t\treturn defaultName + inputCountSuffix;\n\t}\n\n\toverride getTitle(verbosity?: Verbosity): string {\n\t\tconst name = this.getName();\n\t\tif (verbosity === Verbosity.LONG) { // Verbosity LONG is used for tooltips\n\t\t\tconst sessionTypeDisplayName = this.getSessionTypeDisplayName();\n\t\t\tif (sessionTypeDisplayName) {\n\t\t\t\treturn `${name} | ${sessionTypeDisplayName}`;\n\t\t\t}\n\t\t}\n\t\treturn name;\n\t}\n\n\tprivate getSessionTypeDisplayName(): string | undefined {\n\t\tconst sessionType = this.getSessionType();\n\t\tif (sessionType === localChatSessionType) {\n\t\t\treturn;\n\t\t}\n\t\tconst contributions = this.chatSessionsService.getAllChatSessionContributions();\n\t\tconst contribution = contributions.find(c => c.type === sessionType);\n\t\treturn contribution?.displayName;\n\t}\n\n\toverride getIcon(): ThemeIcon | URI | undefined {\n\t\tconst resolvedIcon = this.resolveIcon();\n\t\tif (resolvedIcon) {\n\t\t\tthis.cachedIcon = resolvedIcon;\n\t\t\treturn resolvedIcon;\n\t\t}\n\n\t\t// Fall back to default icon\n\t\treturn ChatEditorIcon;\n\t}\n\n\tprivate resolveIcon(): ThemeIcon | URI | undefined {\n\t\t// TODO@osortega,@rebornix double check: Chat Session Item icon is reserved for chat session list and deprecated for chat session status. thus here we use session type icon. We may want to show status for the Editor Title.\n\t\tconst sessionType = this.getSessionType();\n\t\tif (sessionType !== localChatSessionType) {\n\t\t\tconst typeIcon = this.chatSessionsService.getIconForSessionType(sessionType);\n\t\t\tif (typeIcon) {\n\t\t\t\treturn typeIcon;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Returns chat session type from a URI, or {@linkcode localChatSessionType} if not specified or cannot be determined.\n\t */\n\tpublic getSessionType(): string {\n\t\tif (this.resource.scheme === Schemas.vscodeChatEditor || this.resource.scheme === Schemas.vscodeLocalChatSession) {\n\t\t\treturn localChatSessionType;\n\t\t}\n\n\t\treturn this.resource.scheme;\n\t}\n\n\toverride async resolve(): Promise<ChatEditorModel | null> {\n\t\tconst searchParams = new URLSearchParams(this.resource.query);\n\t\tconst chatSessionType = searchParams.get('chatSessionType');\n\t\tconst inputType = chatSessionType ?? this.resource.authority;\n\n\t\tif (this._sessionResource) {\n\t\t\tthis.model = await this.chatService.loadSessionForResource(this._sessionResource, ChatAgentLocation.Chat, CancellationToken.None);\n\n\t\t\t// For local session only, if we find no existing session, create a new one\n\t\t\tif (!this.model && LocalChatSessionUri.parseLocalSessionId(this._sessionResource)) {\n\t\t\t\tthis.model = this.chatService.startSession(ChatAgentLocation.Chat, CancellationToken.None, { canUseTools: true });\n\t\t\t}\n\t\t} else if (!this.options.target) {\n\t\t\tthis.model = this.chatService.startSession(ChatAgentLocation.Chat, CancellationToken.None, { canUseTools: !inputType });\n\t\t} else if (this.options.target.data) {\n\t\t\tthis.model = this.chatService.loadSessionFromContent(this.options.target.data);\n\t\t}\n\n\t\tif (!this.model || this.isDisposed()) {\n\t\t\treturn null;\n\t\t}\n\n\t\tthis._sessionResource = this.model.sessionResource;\n\n\t\tthis._register(this.model.onDidChange((e) => {\n\t\t\t// When a custom title is set, we no longer need the numeric count\n\t\t\tif (e && e.kind === 'setCustomTitle' && !this.hasCustomTitle) {\n\t\t\t\tthis.hasCustomTitle = true;\n\t\t\t\tChatEditorInput.countsInUseMap.get(this.inputName)?.delete(this.inputCount);\n\t\t\t\tif (ChatEditorInput.countsInUseMap.get(this.inputName)?.size === 0) {\n\t\t\t\t\tChatEditorInput.countsInUseMap.delete(this.inputName);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Invalidate icon cache when label changes\n\t\t\tthis.cachedIcon = undefined;\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}));\n\n\t\t// Check if icon has changed after model resolution\n\t\tconst newIcon = this.resolveIcon();\n\t\tif (newIcon && (!this.cachedIcon || !this.iconsEqual(this.cachedIcon, newIcon))) {\n\t\t\tthis.cachedIcon = newIcon;\n\t\t}\n\n\t\tthis._onDidChangeLabel.fire();\n\n\t\treturn this._register(new ChatEditorModel(this.model));\n\t}\n\n\tprivate iconsEqual(a: ThemeIcon | URI, b: ThemeIcon | URI): boolean {\n\t\tif (ThemeIcon.isThemeIcon(a) && ThemeIcon.isThemeIcon(b)) {\n\t\t\treturn a.id === b.id;\n\t\t}\n\t\tif (a instanceof URI && b instanceof URI) {\n\t\t\treturn a.toString() === b.toString();\n\t\t}\n\t\treturn false;\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tif (this._sessionResource) {\n\t\t\tthis.chatService.clearSession(this._sessionResource);\n\t\t}\n\t}\n}\n\nexport class ChatEditorModel extends Disposable {\n\tprivate _onWillDispose = this._register(new Emitter<void>());\n\treadonly onWillDispose = this._onWillDispose.event;\n\n\tprivate _isResolved = false;\n\n\tconstructor(\n\t\treadonly model: IChatModel\n\t) { super(); }\n\n\tasync resolve(): Promise<void> {\n\t\tthis._isResolved = true;\n\t}\n\n\tisResolved(): boolean {\n\t\treturn this._isResolved;\n\t}\n\n\tisDisposed(): boolean {\n\t\treturn this._store.isDisposed;\n\t}\n}\n\n\nnamespace ChatEditorUri {\n\n\tconst scheme = Schemas.vscodeChatEditor;\n\n\texport function getNewEditorUri(): URI {\n\t\tconst handle = Math.floor(Math.random() * 1e9);\n\t\treturn URI.from({ scheme, path: `chat-${handle}` });\n\t}\n\n\texport function parse(resource: URI): number | undefined {\n\t\tif (resource.scheme !== scheme) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst match = resource.path.match(/chat-(\\d+)/);\n\t\tconst handleStr = match?.[1];\n\t\tif (typeof handleStr !== 'string') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst handle = parseInt(handleStr);\n\t\tif (isNaN(handle)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn handle;\n\t}\n}\n\ninterface ISerializedChatEditorInput {\n\treadonly options: IChatEditorOptions;\n\treadonly resource: URI;\n\treadonly sessionResource: URI | undefined;\n}\n\nexport class ChatEditorInputSerializer implements IEditorSerializer {\n\tcanSerialize(input: EditorInput): input is ChatEditorInput {\n\t\treturn input instanceof ChatEditorInput && !!input.sessionResource;\n\t}\n\n\tserialize(input: EditorInput): string | undefined {\n\t\tif (!this.canSerialize(input)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst obj: ISerializedChatEditorInput = {\n\t\t\toptions: input.options,\n\t\t\tsessionResource: input.sessionResource,\n\t\t\tresource: input.resource,\n\n\t\t};\n\t\treturn JSON.stringify(obj);\n\t}\n\n\tdeserialize(instantiationService: IInstantiationService, serializedEditor: string): EditorInput | undefined {\n\t\ttry {\n\t\t\t// Old inputs have a session id for local session\n\t\t\tconst parsed: ISerializedChatEditorInput & { readonly sessionId: string | undefined } = JSON.parse(serializedEditor);\n\n\t\t\t// First if we have a modern session resource, use that\n\t\t\tif (parsed.sessionResource) {\n\t\t\t\tconst sessionResource = URI.revive(parsed.sessionResource);\n\t\t\t\treturn instantiationService.createInstance(ChatEditorInput, sessionResource, parsed.options);\n\t\t\t}\n\n\t\t\t// Otherwise check to see if we're a chat editor with a local session id\n\t\t\tlet resource = URI.revive(parsed.resource);\n\t\t\tif (resource.scheme === Schemas.vscodeChatEditor && parsed.sessionId) {\n\t\t\t\tresource = LocalChatSessionUri.forSession(parsed.sessionId);\n\t\t\t}\n\n\t\t\treturn instantiationService.createInstance(ChatEditorInput, resource, parsed.options);\n\t\t} catch (err) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nexport async function showClearEditingSessionConfirmation(editingSession: IChatEditingSession, dialogService: IDialogService, options?: IClearEditingSessionConfirmationOptions): Promise<boolean> {\n\tconst defaultPhrase = nls.localize('chat.startEditing.confirmation.pending.message.default1', \"Starting a new chat will end your current edit session.\");\n\tconst defaultTitle = nls.localize('chat.startEditing.confirmation.title', \"Start new chat?\");\n\tconst phrase = options?.messageOverride ?? defaultPhrase;\n\tconst title = options?.titleOverride ?? defaultTitle;\n\n\tconst currentEdits = editingSession.entries.get();\n\tconst undecidedEdits = currentEdits.filter((edit) => edit.state.get() === ModifiedFileEntryState.Modified);\n\n\tconst { result } = await dialogService.prompt({\n\t\ttitle,\n\t\tmessage: phrase + ' ' + nls.localize('chat.startEditing.confirmation.pending.message.2', \"Do you want to keep pending edits to {0} files?\", undecidedEdits.length),\n\t\ttype: 'info',\n\t\tcancelButton: true,\n\t\tbuttons: [\n\t\t\t{\n\t\t\t\tlabel: nls.localize('chat.startEditing.confirmation.acceptEdits', \"Keep & Continue\"),\n\t\t\t\trun: async () => {\n\t\t\t\t\tawait editingSession.accept();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: nls.localize('chat.startEditing.confirmation.discardEdits', \"Undo & Continue\"),\n\t\t\t\trun: async () => {\n\t\t\t\t\tawait editingSession.reject();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t});\n\n\treturn Boolean(result);\n}\n\nexport function shouldShowClearEditingSessionConfirmation(editingSession: IChatEditingSession): boolean {\n\tconst currentEdits = editingSession.entries.get();\n\tconst currentEditCount = currentEdits.length;\n\n\tif (currentEditCount) {\n\t\tconst undecidedEdits = currentEdits.filter((edit) => edit.state.get() === ModifiedFileEntryState.Modified);\n\t\treturn !!undecidedEdits.length;\n\t}\n\n\treturn false;\n}\n"]}