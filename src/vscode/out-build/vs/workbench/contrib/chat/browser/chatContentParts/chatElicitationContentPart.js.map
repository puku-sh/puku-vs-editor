{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatContentParts/chatElicitationContentPart.ts","vs/workbench/contrib/chat/browser/chatContentParts/chatElicitationContentPart.ts"],"names":[],"mappings":"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","file":"chatElicitationContentPart.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { IMarkdownString, isMarkdownString, MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { Disposable, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun } from '../../../../../base/common/observable.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { IChatProgressRenderableResponseContent } from '../../common/chatModel.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ElicitationState, IChatElicitationRequest, IChatElicitationRequestSerialized } from '../../common/chatService.js';\nimport { IChatAccessibilityService } from '../chat.js';\nimport { AcceptElicitationRequestActionId } from '../actions/chatElicitationActions.js';\nimport { ChatConfirmationWidget, IChatConfirmationButton } from './chatConfirmationWidget.js';\nimport { IChatContentPart, IChatContentPartRenderContext } from './chatContentParts.js';\nimport { IAction } from '../../../../../base/common/actions.js';\n\nexport class ChatElicitationContentPart extends Disposable implements IChatContentPart {\n\tpublic readonly domNode: HTMLElement;\n\n\tprivate readonly _onDidChangeHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeHeight = this._onDidChangeHeight.event;\n\n\tprivate readonly _confirmWidget: ChatConfirmationWidget<unknown>;\n\n\tpublic get codeblocks() {\n\t\treturn this._confirmWidget.codeblocks;\n\t}\n\n\tpublic get codeblocksPartId() {\n\t\treturn this._confirmWidget.codeblocksPartId;\n\t}\n\n\tconstructor(\n\t\tprivate readonly elicitation: IChatElicitationRequest | IChatElicitationRequestSerialized,\n\t\tcontext: IChatContentPartRenderContext,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IChatAccessibilityService private readonly chatAccessibilityService: IChatAccessibilityService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\n\t\tconst buttons: IChatConfirmationButton<unknown>[] = [];\n\t\tif (elicitation.kind === 'elicitation2') {\n\t\t\tconst acceptKeybinding = this.keybindingService.lookupKeybinding(AcceptElicitationRequestActionId);\n\t\t\tconst acceptTooltip = acceptKeybinding ? `${elicitation.acceptButtonLabel} (${acceptKeybinding.getLabel()})` : elicitation.acceptButtonLabel;\n\n\t\t\tbuttons.push({\n\t\t\t\tlabel: elicitation.acceptButtonLabel,\n\t\t\t\ttooltip: acceptTooltip,\n\t\t\t\tdata: true,\n\t\t\t\tmoreActions: elicitation.moreActions?.map((action: IAction) => ({\n\t\t\t\t\tlabel: action.label,\n\t\t\t\t\tdata: action,\n\t\t\t\t\trun: action.run\n\t\t\t\t}))\n\t\t\t});\n\t\t\tif (elicitation.rejectButtonLabel && elicitation.reject) {\n\t\t\t\tbuttons.push({ label: elicitation.rejectButtonLabel, data: false, isSecondary: true });\n\t\t\t}\n\n\t\t\tthis._register(autorun(reader => {\n\t\t\t\tif (elicitation.isHidden?.read(reader)) {\n\t\t\t\t\tthis.domNode.remove();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tconst hasElicitationKey = ChatContextKeys.Editing.hasElicitationRequest.bindTo(this.contextKeyService);\n\t\t\tthis._register(autorun(reader => {\n\t\t\t\thasElicitationKey.set(elicitation.state.read(reader) === ElicitationState.Pending);\n\t\t\t}));\n\t\t\tthis._register(toDisposable(() => hasElicitationKey.reset()));\n\n\t\t\tthis.chatAccessibilityService.acceptElicitation(elicitation);\n\t\t}\n\n\t\tconst confirmationWidget = this._register(this.instantiationService.createInstance(ChatConfirmationWidget, context, {\n\t\t\ttitle: elicitation.title,\n\t\t\tsubtitle: elicitation.subtitle,\n\t\t\tbuttons,\n\t\t\tmessage: this.getMessageToRender(elicitation),\n\t\t\ttoolbarData: { partType: 'elicitation', partSource: elicitation.source?.type, arg: elicitation },\n\t\t}));\n\t\tthis._confirmWidget = confirmationWidget;\n\t\tconfirmationWidget.setShowButtons(elicitation.kind === 'elicitation2' && elicitation.state.get() === ElicitationState.Pending);\n\n\t\tthis._register(confirmationWidget.onDidChangeHeight(() => this._onDidChangeHeight.fire()));\n\n\t\tthis._register(confirmationWidget.onDidClick(async e => {\n\t\t\tif (elicitation.kind !== 'elicitation2') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet result: boolean | IAction | undefined;\n\t\t\tif (typeof e.data === 'boolean' && e.data === true) {\n\t\t\t\tresult = e.data;\n\t\t\t} else if (e.data && typeof e.data === 'object' && 'run' in e.data && 'label' in e.data) {\n\t\t\t\tresult = e.data as IAction;\n\t\t\t} else {\n\t\t\t\tresult = undefined;\n\t\t\t}\n\t\t\tif (result !== undefined) {\n\t\t\t\tawait elicitation.accept(result);\n\t\t\t} else if (elicitation.reject) {\n\t\t\t\tawait elicitation.reject();\n\t\t\t}\n\n\t\t\tconfirmationWidget.setShowButtons(false);\n\t\t\tconfirmationWidget.updateMessage(this.getMessageToRender(elicitation));\n\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\n\t\tthis.domNode = confirmationWidget.domNode;\n\t\tthis.domNode.tabIndex = 0;\n\t\tconst messageToRender = this.getMessageToRender(elicitation);\n\t\tthis.domNode.ariaLabel = elicitation.title + ' ' + (typeof messageToRender === 'string' ? messageToRender : messageToRender.value || '');\n\t}\n\n\tprivate getMessageToRender(elicitation: IChatElicitationRequest | IChatElicitationRequestSerialized): IMarkdownString | string {\n\t\tif (!elicitation.acceptedResult) {\n\t\t\treturn elicitation.message;\n\t\t}\n\n\t\tconst messageMd = isMarkdownString(elicitation.message) ? MarkdownString.lift(elicitation.message) : new MarkdownString(elicitation.message);\n\t\tmessageMd.appendCodeblock('json', JSON.stringify(elicitation.acceptedResult, null, 2));\n\t\treturn messageMd;\n\t}\n\n\thasSameContent(other: IChatProgressRenderableResponseContent): boolean {\n\t\t// No other change allowed for this content type\n\t\treturn other === this.elicitation;\n\t}\n\n\taddDisposable(disposable: IDisposable): void {\n\t\tthis._register(disposable);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { IMarkdownString, isMarkdownString, MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { Disposable, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun } from '../../../../../base/common/observable.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { IChatProgressRenderableResponseContent } from '../../common/chatModel.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ElicitationState, IChatElicitationRequest, IChatElicitationRequestSerialized } from '../../common/chatService.js';\nimport { IChatAccessibilityService } from '../chat.js';\nimport { AcceptElicitationRequestActionId } from '../actions/chatElicitationActions.js';\nimport { ChatConfirmationWidget, IChatConfirmationButton } from './chatConfirmationWidget.js';\nimport { IChatContentPart, IChatContentPartRenderContext } from './chatContentParts.js';\nimport { IAction } from '../../../../../base/common/actions.js';\n\nexport class ChatElicitationContentPart extends Disposable implements IChatContentPart {\n\tpublic readonly domNode: HTMLElement;\n\n\tprivate readonly _onDidChangeHeight = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeHeight = this._onDidChangeHeight.event;\n\n\tprivate readonly _confirmWidget: ChatConfirmationWidget<unknown>;\n\n\tpublic get codeblocks() {\n\t\treturn this._confirmWidget.codeblocks;\n\t}\n\n\tpublic get codeblocksPartId() {\n\t\treturn this._confirmWidget.codeblocksPartId;\n\t}\n\n\tconstructor(\n\t\tprivate readonly elicitation: IChatElicitationRequest | IChatElicitationRequestSerialized,\n\t\tcontext: IChatContentPartRenderContext,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IChatAccessibilityService private readonly chatAccessibilityService: IChatAccessibilityService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\n\t\tconst buttons: IChatConfirmationButton<unknown>[] = [];\n\t\tif (elicitation.kind === 'elicitation2') {\n\t\t\tconst acceptKeybinding = this.keybindingService.lookupKeybinding(AcceptElicitationRequestActionId);\n\t\t\tconst acceptTooltip = acceptKeybinding ? `${elicitation.acceptButtonLabel} (${acceptKeybinding.getLabel()})` : elicitation.acceptButtonLabel;\n\n\t\t\tbuttons.push({\n\t\t\t\tlabel: elicitation.acceptButtonLabel,\n\t\t\t\ttooltip: acceptTooltip,\n\t\t\t\tdata: true,\n\t\t\t\tmoreActions: elicitation.moreActions?.map((action: IAction) => ({\n\t\t\t\t\tlabel: action.label,\n\t\t\t\t\tdata: action,\n\t\t\t\t\trun: action.run\n\t\t\t\t}))\n\t\t\t});\n\t\t\tif (elicitation.rejectButtonLabel && elicitation.reject) {\n\t\t\t\tbuttons.push({ label: elicitation.rejectButtonLabel, data: false, isSecondary: true });\n\t\t\t}\n\n\t\t\tthis._register(autorun(reader => {\n\t\t\t\tif (elicitation.isHidden?.read(reader)) {\n\t\t\t\t\tthis.domNode.remove();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tconst hasElicitationKey = ChatContextKeys.Editing.hasElicitationRequest.bindTo(this.contextKeyService);\n\t\t\tthis._register(autorun(reader => {\n\t\t\t\thasElicitationKey.set(elicitation.state.read(reader) === ElicitationState.Pending);\n\t\t\t}));\n\t\t\tthis._register(toDisposable(() => hasElicitationKey.reset()));\n\n\t\t\tthis.chatAccessibilityService.acceptElicitation(elicitation);\n\t\t}\n\n\t\tconst confirmationWidget = this._register(this.instantiationService.createInstance(ChatConfirmationWidget, context, {\n\t\t\ttitle: elicitation.title,\n\t\t\tsubtitle: elicitation.subtitle,\n\t\t\tbuttons,\n\t\t\tmessage: this.getMessageToRender(elicitation),\n\t\t\ttoolbarData: { partType: 'elicitation', partSource: elicitation.source?.type, arg: elicitation },\n\t\t}));\n\t\tthis._confirmWidget = confirmationWidget;\n\t\tconfirmationWidget.setShowButtons(elicitation.kind === 'elicitation2' && elicitation.state.get() === ElicitationState.Pending);\n\n\t\tthis._register(confirmationWidget.onDidChangeHeight(() => this._onDidChangeHeight.fire()));\n\n\t\tthis._register(confirmationWidget.onDidClick(async e => {\n\t\t\tif (elicitation.kind !== 'elicitation2') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet result: boolean | IAction | undefined;\n\t\t\tif (typeof e.data === 'boolean' && e.data === true) {\n\t\t\t\tresult = e.data;\n\t\t\t} else if (e.data && typeof e.data === 'object' && 'run' in e.data && 'label' in e.data) {\n\t\t\t\tresult = e.data as IAction;\n\t\t\t} else {\n\t\t\t\tresult = undefined;\n\t\t\t}\n\t\t\tif (result !== undefined) {\n\t\t\t\tawait elicitation.accept(result);\n\t\t\t} else if (elicitation.reject) {\n\t\t\t\tawait elicitation.reject();\n\t\t\t}\n\n\t\t\tconfirmationWidget.setShowButtons(false);\n\t\t\tconfirmationWidget.updateMessage(this.getMessageToRender(elicitation));\n\n\t\t\tthis._onDidChangeHeight.fire();\n\t\t}));\n\n\t\tthis.domNode = confirmationWidget.domNode;\n\t\tthis.domNode.tabIndex = 0;\n\t\tconst messageToRender = this.getMessageToRender(elicitation);\n\t\tthis.domNode.ariaLabel = elicitation.title + ' ' + (typeof messageToRender === 'string' ? messageToRender : messageToRender.value || '');\n\t}\n\n\tprivate getMessageToRender(elicitation: IChatElicitationRequest | IChatElicitationRequestSerialized): IMarkdownString | string {\n\t\tif (!elicitation.acceptedResult) {\n\t\t\treturn elicitation.message;\n\t\t}\n\n\t\tconst messageMd = isMarkdownString(elicitation.message) ? MarkdownString.lift(elicitation.message) : new MarkdownString(elicitation.message);\n\t\tmessageMd.appendCodeblock('json', JSON.stringify(elicitation.acceptedResult, null, 2));\n\t\treturn messageMd;\n\t}\n\n\thasSameContent(other: IChatProgressRenderableResponseContent): boolean {\n\t\t// No other change allowed for this content type\n\t\treturn other === this.elicitation;\n\t}\n\n\taddDisposable(disposable: IDisposable): void {\n\t\tthis._register(disposable);\n\t}\n}\n"]}