{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatImportExport.ts"],"names":[],"mappings":"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","file":"chatImportExport.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { IFileDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { IChatEditorOptions } from '../chatEditor.js';\nimport { ChatEditorInput } from '../chatEditorInput.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { isExportableSessionData } from '../../common/chatModel.js';\nimport { IChatService } from '../../common/chatService.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { URI } from '../../../../../base/common/uri.js';\n\nconst defaultFileName = 'chat.json';\nconst filters = [{ name: localize('chat.file.label', \"Chat Session\"), extensions: ['json'] }];\n\nexport function registerChatExportActions() {\n\tregisterAction2(class ExportChatAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.export',\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ttitle: localize2('chat.export.label', \"Export Chat...\"),\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t});\n\t\t}\n\t\tasync run(accessor: ServicesAccessor, outputPath?: URI) {\n\t\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\t\tconst fileDialogService = accessor.get(IFileDialogService);\n\t\t\tconst fileService = accessor.get(IFileService);\n\t\t\tconst chatService = accessor.get(IChatService);\n\n\t\t\tconst widget = widgetService.lastFocusedWidget;\n\t\t\tif (!widget || !widget.viewModel) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!outputPath) {\n\t\t\t\tconst defaultUri = joinPath(await fileDialogService.defaultFilePath(), defaultFileName);\n\t\t\t\tconst result = await fileDialogService.showSaveDialog({\n\t\t\t\t\tdefaultUri,\n\t\t\t\t\tfilters\n\t\t\t\t});\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\toutputPath = result;\n\t\t\t}\n\n\t\t\tconst model = chatService.getSession(widget.viewModel.sessionResource);\n\t\t\tif (!model) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Using toJSON on the model\n\t\t\tconst content = VSBuffer.fromString(JSON.stringify(model.toExport(), undefined, 2));\n\t\t\tawait fileService.writeFile(outputPath, content);\n\t\t}\n\t});\n\n\tregisterAction2(class ImportChatAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.import',\n\t\t\t\ttitle: localize2('chat.import.label', \"Import Chat...\"),\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t});\n\t\t}\n\t\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\tconst fileDialogService = accessor.get(IFileDialogService);\n\t\t\tconst fileService = accessor.get(IFileService);\n\t\t\tconst editorService = accessor.get(IEditorService);\n\n\t\t\tconst defaultUri = joinPath(await fileDialogService.defaultFilePath(), defaultFileName);\n\t\t\tconst result = await fileDialogService.showOpenDialog({\n\t\t\t\tdefaultUri,\n\t\t\t\tcanSelectFiles: true,\n\t\t\t\tfilters\n\t\t\t});\n\t\t\tif (!result) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst content = await fileService.readFile(result[0]);\n\t\t\ttry {\n\t\t\t\tconst data = JSON.parse(content.value.toString());\n\t\t\t\tif (!isExportableSessionData(data)) {\n\t\t\t\t\tthrow new Error('Invalid chat session data');\n\t\t\t\t}\n\n\t\t\t\tconst options: IChatEditorOptions = { target: { data }, pinned: true };\n\t\t\t\tawait editorService.openEditor({ resource: ChatEditorInput.getNewEditorUri(), options });\n\t\t\t} catch (err) {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\t});\n}\n"]}