{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatContextPickService.ts","vs/workbench/contrib/chat/browser/chatContextPickService.ts"],"names":[],"mappings":"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","file":"chatContextPickService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, IObservable, ObservablePromise } from '../../../../base/common/observable.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isObject } from '../../../../base/common/types.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IChatRequestVariableEntry } from '../common/chatVariableEntries.js';\nimport { IChatWidget } from './chat.js';\n\n\nexport interface IChatContextPickerPickItem extends Partial<IQuickItem> {\n\tlabel: string;\n\ticonClass?: string;\n\ticonClasses?: readonly string[];\n\tdescription?: string;\n\tdetail?: string;\n\tdisabled?: boolean;\n\tasAttachment(): ChatContextPickAttachment | Promise<ChatContextPickAttachment>;\n}\n\nexport type ChatContextPickAttachment = IChatRequestVariableEntry | 'noop';\n\nexport function isChatContextPickerPickItem(item: unknown): item is IChatContextPickerPickItem {\n\treturn isObject(item) && typeof (item as IChatContextPickerPickItem).asAttachment === 'function';\n}\n\ninterface IChatContextItem {\n\treadonly label: string;\n\treadonly icon: ThemeIcon;\n\treadonly commandId?: string;\n\treadonly ordinal?: number;\n\tisEnabled?(widget: IChatWidget): Promise<boolean> | boolean;\n}\n\nexport interface IChatContextValueItem extends IChatContextItem {\n\treadonly type: 'valuePick';\n\n\tasAttachment(widget: IChatWidget): Promise<IChatRequestVariableEntry | IChatRequestVariableEntry[] | undefined>;\n}\n\nexport type ChatContextPick = IChatContextPickerPickItem | IQuickPickSeparator;\n\nexport interface IChatContextPicker {\n\treadonly placeholder: string;\n\t/**\n\t * Picks that should either be:\n\t * - A promise that resolves to the picked items\n\t * - A function that maps input query into items to display.\n\t */\n\treadonly picks: Promise<ChatContextPick[]> | ((query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }>);\n\n\t/** Return true to cancel the default behavior */\n\treadonly goBack?: () => boolean;\n\n\treadonly configure?: {\n\t\tlabel: string;\n\t\tcommandId: string;\n\t};\n\n\treadonly dispose?: () => void;\n}\n\nexport interface IChatContextPickerItem extends IChatContextItem {\n\treadonly type: 'pickerPick';\n\n\tasPicker(widget: IChatWidget): IChatContextPicker;\n}\n\n/**\n * Helper for use in {@IChatContextPickerItem} that wraps a simple query->promise\n * function into the requisite observable.\n */\nexport function picksWithPromiseFn(fn: (query: string, token: CancellationToken) => Promise<ChatContextPick[]>): (query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }> {\n\treturn (query, token) => {\n\t\tconst promise = derived(reader => {\n\t\t\tconst queryValue = query.read(reader);\n\t\t\tconst cts = new CancellationTokenSource(token);\n\t\t\treader.store.add(toDisposable(() => cts.dispose(true)));\n\t\t\treturn new ObservablePromise(fn(queryValue, cts.token));\n\t\t});\n\n\t\treturn promise.map((value, reader) => {\n\t\t\tconst result = value.promiseResult.read(reader);\n\t\t\treturn { picks: result?.data || [], busy: result === undefined };\n\t\t});\n\t};\n}\n\nexport interface IChatContextPickService {\n\t_serviceBrand: undefined;\n\n\titems: Iterable<IChatContextValueItem | IChatContextPickerItem>;\n\n\t/**\n\t * Register a value or  picker to the \"Add Context\" flow. A value directly resolved to a\n\t * chat attachment and a picker first shows a list of items to pick from and then\n\t * resolves the selected item to a chat attachment.\n\t */\n\tregisterChatContextItem(item: IChatContextValueItem | IChatContextPickerItem): IDisposable;\n}\n\nexport const IChatContextPickService = createDecorator<IChatContextPickService>('IContextPickService');\n\nexport class ChatContextPickService implements IChatContextPickService {\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _picks: IChatContextValueItem[] = [];\n\n\treadonly items: Iterable<IChatContextValueItem> = this._picks;\n\n\tregisterChatContextItem(pick: IChatContextValueItem): IDisposable {\n\t\tthis._picks.push(pick);\n\n\t\tthis._picks.sort((a, b) => {\n\t\t\tconst valueA = a.ordinal ?? 0;\n\t\t\tconst valueB = b.ordinal ?? 0;\n\t\t\tif (valueA === valueB) {\n\t\t\t\treturn compare(a.label, b.label);\n\t\t\t} else if (valueA < valueB) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\treturn toDisposable(() => {\n\t\t\tconst index = this._picks.indexOf(pick);\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._picks.splice(index, 1);\n\t\t\t}\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, IObservable, ObservablePromise } from '../../../../base/common/observable.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isObject } from '../../../../base/common/types.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IChatRequestVariableEntry } from '../common/chatVariableEntries.js';\nimport { IChatWidget } from './chat.js';\n\n\nexport interface IChatContextPickerPickItem extends Partial<IQuickItem> {\n\tlabel: string;\n\ticonClass?: string;\n\ticonClasses?: readonly string[];\n\tdescription?: string;\n\tdetail?: string;\n\tdisabled?: boolean;\n\tasAttachment(): ChatContextPickAttachment | Promise<ChatContextPickAttachment>;\n}\n\nexport type ChatContextPickAttachment = IChatRequestVariableEntry | 'noop';\n\nexport function isChatContextPickerPickItem(item: unknown): item is IChatContextPickerPickItem {\n\treturn isObject(item) && typeof (item as IChatContextPickerPickItem).asAttachment === 'function';\n}\n\ninterface IChatContextItem {\n\treadonly label: string;\n\treadonly icon: ThemeIcon;\n\treadonly commandId?: string;\n\treadonly ordinal?: number;\n\tisEnabled?(widget: IChatWidget): Promise<boolean> | boolean;\n}\n\nexport interface IChatContextValueItem extends IChatContextItem {\n\treadonly type: 'valuePick';\n\n\tasAttachment(widget: IChatWidget): Promise<IChatRequestVariableEntry | IChatRequestVariableEntry[] | undefined>;\n}\n\nexport type ChatContextPick = IChatContextPickerPickItem | IQuickPickSeparator;\n\nexport interface IChatContextPicker {\n\treadonly placeholder: string;\n\t/**\n\t * Picks that should either be:\n\t * - A promise that resolves to the picked items\n\t * - A function that maps input query into items to display.\n\t */\n\treadonly picks: Promise<ChatContextPick[]> | ((query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }>);\n\n\t/** Return true to cancel the default behavior */\n\treadonly goBack?: () => boolean;\n\n\treadonly configure?: {\n\t\tlabel: string;\n\t\tcommandId: string;\n\t};\n\n\treadonly dispose?: () => void;\n}\n\nexport interface IChatContextPickerItem extends IChatContextItem {\n\treadonly type: 'pickerPick';\n\n\tasPicker(widget: IChatWidget): IChatContextPicker;\n}\n\n/**\n * Helper for use in {@IChatContextPickerItem} that wraps a simple query->promise\n * function into the requisite observable.\n */\nexport function picksWithPromiseFn(fn: (query: string, token: CancellationToken) => Promise<ChatContextPick[]>): (query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }> {\n\treturn (query, token) => {\n\t\tconst promise = derived(reader => {\n\t\t\tconst queryValue = query.read(reader);\n\t\t\tconst cts = new CancellationTokenSource(token);\n\t\t\treader.store.add(toDisposable(() => cts.dispose(true)));\n\t\t\treturn new ObservablePromise(fn(queryValue, cts.token));\n\t\t});\n\n\t\treturn promise.map((value, reader) => {\n\t\t\tconst result = value.promiseResult.read(reader);\n\t\t\treturn { picks: result?.data || [], busy: result === undefined };\n\t\t});\n\t};\n}\n\nexport interface IChatContextPickService {\n\t_serviceBrand: undefined;\n\n\titems: Iterable<IChatContextValueItem | IChatContextPickerItem>;\n\n\t/**\n\t * Register a value or  picker to the \"Add Context\" flow. A value directly resolved to a\n\t * chat attachment and a picker first shows a list of items to pick from and then\n\t * resolves the selected item to a chat attachment.\n\t */\n\tregisterChatContextItem(item: IChatContextValueItem | IChatContextPickerItem): IDisposable;\n}\n\nexport const IChatContextPickService = createDecorator<IChatContextPickService>('IContextPickService');\n\nexport class ChatContextPickService implements IChatContextPickService {\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _picks: IChatContextValueItem[] = [];\n\n\treadonly items: Iterable<IChatContextValueItem> = this._picks;\n\n\tregisterChatContextItem(pick: IChatContextValueItem): IDisposable {\n\t\tthis._picks.push(pick);\n\n\t\tthis._picks.sort((a, b) => {\n\t\t\tconst valueA = a.ordinal ?? 0;\n\t\t\tconst valueB = b.ordinal ?? 0;\n\t\t\tif (valueA === valueB) {\n\t\t\t\treturn compare(a.label, b.label);\n\t\t\t} else if (valueA < valueB) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\treturn toDisposable(() => {\n\t\t\tconst index = this._picks.indexOf(pick);\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._picks.splice(index, 1);\n\t\t\t}\n\t\t});\n\t}\n}\n"]}