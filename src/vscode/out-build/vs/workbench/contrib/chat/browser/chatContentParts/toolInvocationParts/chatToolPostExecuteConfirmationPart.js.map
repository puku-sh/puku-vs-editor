{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatContentParts/toolInvocationParts/chatToolPostExecuteConfirmationPart.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,KAAK,GAAG,MAAM,uCAAuC,CAAC;AAC7D,OAAO,EAAE,SAAS,EAAE,MAAM,0CAA0C,CAAC;AACrE,OAAO,EAAE,uBAAuB,EAAE,MAAM,uCAAuC,CAAC;AAChF,OAAO,EAAE,gBAAgB,EAAE,MAAM,uDAAuD,CAAC;AACzF,OAAO,EAAE,aAAa,EAAE,MAAM,mDAAmD,CAAC;AAClF,OAAO,EAAE,QAAQ,EAAE,MAAM,0BAA0B,CAAC;AACpD,OAAO,EAAE,kBAAkB,EAAE,MAAM,4DAA4D,CAAC;AAChG,OAAO,EAAE,qBAAqB,EAAE,MAAM,kEAAkE,CAAC;AACzG,OAAO,EAAE,kBAAkB,EAAE,MAAM,4DAA4D,CAAC;AAChG,OAAO,EAAE,oBAAoB,EAAE,MAAM,8BAA8B,CAAC;AAEpE,OAAO,EAAE,sCAAsC,EAAE,MAAM,0DAA0D,CAAC;AAClH,OAAO,EAAE,0BAA0B,EAAsE,sBAAsB,EAAE,MAAM,8CAA8C,CAAC;AACtL,OAAO,EAAE,kCAAkC,EAAE,gCAAgC,EAAE,MAAM,kCAAkC,CAAC;AACxH,OAAO,EAAsB,kBAAkB,EAAE,MAAM,eAAe,CAAC;AAGvE,OAAO,EAAE,4BAA4B,EAAE,MAAM,oCAAoC,CAAC;AAClF,OAAO,EAAE,+BAA+B,EAAE,MAAM,sCAAsC,CAAC;AAEhF,IAAM,mCAAmC,GAAzC,MAAM,mCAAoC,SAAQ,+BAA+B;IAEvF,IAAW,UAAU;QACpB,OAAO,IAAI,CAAC,WAAW,CAAC;IACzB,CAAC;IAED,YACC,cAAmC,EACnC,OAAsC,EACf,oBAA2C,EAC9C,iBAAqC,EAC1C,YAA4C,EACzC,eAAkD,EAChD,iBAAqC,EACrC,iBAAqC,EAC7B,yBAAqD,EACzC,mBAA4E;QAEpH,KAAK,CAAC,cAAc,EAAE,OAAO,EAAE,oBAAoB,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,yBAAyB,CAAC,CAAC;QAPzG,iBAAY,GAAZ,YAAY,CAAe;QACxB,oBAAe,GAAf,eAAe,CAAkB;QAIX,wBAAmB,GAAnB,mBAAmB,CAAwC;QAf7G,gBAAW,GAAyB,EAAE,CAAC;QAkB9C,MAAM,QAAQ,GAAG,cAAc,CAAC,gBAAgB,IAAI,cAAc,CAAC,iBAAiB,CAAC;QACrF,IAAI,CAAC,MAAM,CAAC;YACX,aAAa,EAAE,kCAAkC;YACjD,YAAY,EAAE,gCAAgC;YAC9C,UAAU,EAAE,QAAQ,CAAC,IAAO,EAAE,IAAO,CAAC;YACtC,SAAS,EAAE,QAAQ,CAAC,IAAW,EAAE,IAAc,CAAC;YAChD,QAAQ,EAAE,0BAA0B;YACpC,QAAQ,EAAE,OAAO,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,EAAE,KAAK;SACnE,CAAC,CAAC;IACJ,CAAC;IAES,oBAAoB;QAC7B,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,KAAK,gBAAgB,EAAE,CAAC;YACnD,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;QACpE,CAAC;QACD,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;QAC9C,IAAI,KAAK,CAAC,IAAI,iEAAyD,EAAE,CAAC;YACzE,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;QACrE,CAAC;QAED,OAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,cAAc,EAAE,KAAK,CAAC,eAAe,CAAC,CAAC;IAC9E,CAAC;IAES,QAAQ;QACjB,OAAO,QAAQ,CAAC,IAAmB,EAAE,IAAqB,CAAC,CAAC;IAC7D,CAAC;IAEkB,wBAAwB;QAC1C,MAAM,OAAO,GAAG,KAAK,CAAC,wBAAwB,EAAE,CAAC;QAEjD,wCAAwC;QACxC,MAAM,cAAc,GAAG,IAAI,CAAC,mBAAmB,CAAC,qBAAqB,CAAC;YACrE,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,MAAM;YAClC,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,MAAM;YAClC,UAAU,EAAE,IAAI,CAAC,cAAc,CAAC,UAAU;SAC1C,CAAC,CAAC;QAEH,KAAK,MAAM,MAAM,IAAI,cAAc,EAAE,CAAC;YACrC,IAAI,MAAM,CAAC,OAAO,EAAE,CAAC;gBACpB,OAAO,CAAC,IAAI,CAAC,IAAI,SAAS,EAAE,CAAC,CAAC;YAC/B,CAAC;YACD,OAAO,CAAC,IAAI,CAAC;gBACZ,KAAK,EAAE,MAAM,CAAC,KAAK;gBACnB,OAAO,EAAE,MAAM,CAAC,MAAM;gBACtB,IAAI,EAAE,KAAK,IAAI,EAAE;oBAChB,MAAM,aAAa,GAAG,MAAM,MAAM,CAAC,MAAM,EAAE,CAAC;oBAC5C,IAAI,aAAa,EAAE,CAAC;wBACnB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,EAAE,EAAE,IAAI,oCAA4B,EAAE,CAAC,CAAC;oBAC7E,CAAC;gBACF,CAAC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,OAAO,OAAO,CAAC;IAChB,CAAC;IAEO,oBAAoB,CAAC,cAAmC,EAAE,eAAyF;QAC1J,MAAM,SAAS,GAAG,GAAG,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC;QAErD,IAAI,CAAC,eAAe,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACtD,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAW,EAAE,IAAuB,CAAC,CAAC;YACvE,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,KAAK,GAA4B,EAAE,CAAC;QAE1C,KAAK,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,eAAe,CAAC,OAAO,EAAE,EAAE,CAAC;YACnD,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE,CAAC;gBAC1B,qBAAqB;gBACrB,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CACzD,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,WAAW,CAAC,EAC5C,SAAS,EACT,IAAI,CACJ,CAAC,CAAC;gBAEH,KAAK,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,MAAM;oBACZ,SAAS,EAAE,KAAK;oBAChB,UAAU,EAAE,KAAK,CAAC,aAAa,EAAE;oBACjC,OAAO,EAAE;wBACR,WAAW,EAAE,IAAI;wBACjB,YAAY,EAAE,EAAE;wBAChB,gBAAgB,EAAE,EAAE;wBACpB,eAAe,EAAE,CAAC;wBAClB,aAAa,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE;qBACjD;oBACD,aAAa,EAAE;wBACd,cAAc,EAAE,CAAC;wBACjB,aAAa,EAAE,SAAS;wBACxB,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;wBAClC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;wBAChB,mBAAmB,EAAE,IAAI,CAAC,gBAAgB;wBAC1C,GAAG,EAAE,KAAK,CAAC,GAAG;wBACd,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,eAAe;wBACzD,UAAU,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC;qBACtC;iBACD,CAAC,CAAC;YACJ,CAAC;iBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE,CAAC;gBACtC,wCAAwC;gBACxC,MAAM,WAAW,GAAG,sBAAsB,CAAC,IAAI,CAAC,CAAC;gBACjD,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CACzD,WAAW,EACX,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,MAAM,CAAC,EACvC,SAAS,EACT,IAAI,CACJ,CAAC,CAAC;gBAEH,KAAK,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,MAAM;oBACZ,SAAS,EAAE,KAAK;oBAChB,UAAU,EAAE,KAAK,CAAC,aAAa,EAAE;oBACjC,OAAO,EAAE;wBACR,WAAW,EAAE,IAAI;wBACjB,YAAY,EAAE,EAAE;wBAChB,gBAAgB,EAAE,EAAE;wBACpB,eAAe,EAAE,CAAC;wBAClB,aAAa,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE;qBACjD;oBACD,aAAa,EAAE;wBACd,cAAc,EAAE,CAAC;wBACjB,aAAa,EAAE,SAAS;wBACxB,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;wBAClC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;wBAChB,mBAAmB,EAAE,IAAI,CAAC,gBAAgB;wBAC1C,GAAG,EAAE,KAAK,CAAC,GAAG;wBACd,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,eAAe;wBACzD,UAAU,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC;qBACtC;iBACD,CAAC,CAAC;YACJ,CAAC;iBAAM,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE,CAAC;gBACjC,qBAAqB;gBACrB,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;gBACrC,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;gBAE7B,yBAAyB;gBACzB,IAAI,QAAQ,EAAE,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC;oBACpC,MAAM,iBAAiB,GAAG,uBAAuB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,uBAAuB,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC;oBACxH,MAAM,YAAY,GAAG,oBAAoB,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,EAAE,cAAc,CAAC,UAAU,EAAE,CAAC,EAAE,iBAAiB,CAAC,CAAC;oBACrI,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,GAAG,EAAE,YAAY,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACxG,CAAC;qBAAM,CAAC;oBACP,iDAAiD;oBACjD,MAAM,OAAO,GAAG,IAAI,WAAW,CAAC,OAAO,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;oBAC1D,IAAI,CAAC;wBACJ,MAAM,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;wBACzC,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CACzD,IAAI,EACJ,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,WAAW,CAAC,EAC5C,SAAS,EACT,IAAI,CACJ,CAAC,CAAC;wBAEH,KAAK,CAAC,IAAI,CAAC;4BACV,IAAI,EAAE,MAAM;4BACZ,SAAS,EAAE,KAAK;4BAChB,UAAU,EAAE,KAAK,CAAC,aAAa,EAAE;4BACjC,OAAO,EAAE;gCACR,WAAW,EAAE,IAAI;gCACjB,YAAY,EAAE,EAAE;gCAChB,gBAAgB,EAAE,EAAE;gCACpB,eAAe,EAAE,CAAC;gCAClB,aAAa,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE;6BACjD;4BACD,aAAa,EAAE;gCACd,cAAc,EAAE,CAAC;gCACjB,aAAa,EAAE,SAAS;gCACxB,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gCAClC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;gCAChB,mBAAmB,EAAE,IAAI,CAAC,gBAAgB;gCAC1C,GAAG,EAAE,KAAK,CAAC,GAAG;gCACd,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,eAAe;gCACzD,UAAU,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC;6BACtC;yBACD,CAAC,CAAC;oBACJ,CAAC;oBAAC,MAAM,CAAC;wBACR,+BAA+B;wBAC/B,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;wBAC/B,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CACzD,MAAM,EACN,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,WAAW,CAAC,EAC5C,SAAS,EACT,IAAI,CACJ,CAAC,CAAC;wBAEH,KAAK,CAAC,IAAI,CAAC;4BACV,IAAI,EAAE,MAAM;4BACZ,SAAS,EAAE,KAAK;4BAChB,UAAU,EAAE,KAAK,CAAC,aAAa,EAAE;4BACjC,OAAO,EAAE;gCACR,WAAW,EAAE,IAAI;gCACjB,YAAY,EAAE,EAAE;gCAChB,gBAAgB,EAAE,EAAE;gCACpB,eAAe,EAAE,CAAC;gCAClB,aAAa,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE;6BACjD;4BACD,aAAa,EAAE;gCACd,cAAc,EAAE,CAAC;gCACjB,aAAa,EAAE,SAAS;gCACxB,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gCAClC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC;gCAChB,mBAAmB,EAAE,IAAI,CAAC,gBAAgB;gCAC1C,GAAG,EAAE,KAAK,CAAC,GAAG;gCACd,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,eAAe;gCACzD,UAAU,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC;6BACtC;yBACD,CAAC,CAAC;oBACJ,CAAC;gBACF,CAAC;YACF,CAAC;QACF,CAAC;QAED,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACtB,MAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,oBAAoB,CAAC,cAAc,CAC5E,4BAA4B,EAC5B,IAAI,CAAC,OAAO,EACZ,KAAK,CACL,CAAC,CAAC;YAEH,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC;YACnD,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,iBAAiB,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YACtF,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;YAChE,OAAO,aAAa,CAAC,OAAO,CAAC;QAC9B,CAAC;QAED,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAsB,EAAE,IAAwB,CAAC,CAAC;QACnF,OAAO,SAAS,CAAC;IAClB,CAAC;CACD,CAAA;AAtPY,mCAAmC;IAS7C,WAAA,qBAAqB,CAAA;IACrB,WAAA,kBAAkB,CAAA;IAClB,WAAA,aAAa,CAAA;IACb,WAAA,gBAAgB,CAAA;IAChB,WAAA,kBAAkB,CAAA;IAClB,WAAA,kBAAkB,CAAA;IAClB,WAAA,0BAA0B,CAAA;IAC1B,WAAA,sCAAsC,CAAA;GAhB5B,mCAAmC,CAsP/C","file":"chatToolPostExecuteConfirmationPart.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../../base/browser/dom.js';\nimport { Separator } from '../../../../../../base/common/actions.js';\nimport { getExtensionForMimeType } from '../../../../../../base/common/mime.js';\nimport { ILanguageService } from '../../../../../../editor/common/languages/language.js';\nimport { IModelService } from '../../../../../../editor/common/services/model.js';\nimport { localize } from '../../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../../platform/keybinding/common/keybinding.js';\nimport { ChatResponseResource } from '../../../common/chatModel.js';\nimport { IChatToolInvocation, ToolConfirmKind } from '../../../common/chatService.js';\nimport { ILanguageModelToolsConfirmationService } from '../../../common/languageModelToolsConfirmationService.js';\nimport { ILanguageModelToolsService, IToolResultDataPart, IToolResultPromptTsxPart, IToolResultTextPart, stringifyPromptTsxPart } from '../../../common/languageModelToolsService.js';\nimport { AcceptToolPostConfirmationActionId, SkipToolPostConfirmationActionId } from '../../actions/chatToolActions.js';\nimport { IChatCodeBlockInfo, IChatWidgetService } from '../../chat.js';\nimport { IChatContentPartRenderContext } from '../chatContentParts.js';\nimport { ChatCollapsibleIOPart } from '../chatToolInputOutputContentPart.js';\nimport { ChatToolOutputContentSubPart } from '../chatToolOutputContentSubPart.js';\nimport { AbstractToolConfirmationSubPart } from './abstractToolConfirmationSubPart.js';\n\nexport class ChatToolPostExecuteConfirmationPart extends AbstractToolConfirmationSubPart {\n\tprivate _codeblocks: IChatCodeBlockInfo[] = [];\n\tpublic get codeblocks(): IChatCodeBlockInfo[] {\n\t\treturn this._codeblocks;\n\t}\n\n\tconstructor(\n\t\ttoolInvocation: IChatToolInvocation,\n\t\tcontext: IChatContentPartRenderContext,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IChatWidgetService chatWidgetService: IChatWidgetService,\n\t\t@ILanguageModelToolsService languageModelToolsService: ILanguageModelToolsService,\n\t\t@ILanguageModelToolsConfirmationService private readonly confirmationService: ILanguageModelToolsConfirmationService,\n\t) {\n\t\tsuper(toolInvocation, context, instantiationService, keybindingService, contextKeyService, chatWidgetService, languageModelToolsService);\n\t\tconst subtitle = toolInvocation.pastTenseMessage || toolInvocation.invocationMessage;\n\t\tthis.render({\n\t\t\tallowActionId: AcceptToolPostConfirmationActionId,\n\t\t\tskipActionId: SkipToolPostConfirmationActionId,\n\t\t\tallowLabel: localize('allow', \"Allow\"),\n\t\t\tskipLabel: localize('skip.post', 'Skip Results'),\n\t\t\tpartType: 'chatToolPostConfirmation',\n\t\t\tsubtitle: typeof subtitle === 'string' ? subtitle : subtitle?.value,\n\t\t});\n\t}\n\n\tprotected createContentElement(): HTMLElement {\n\t\tif (this.toolInvocation.kind !== 'toolInvocation') {\n\t\t\tthrow new Error('post-approval not supported for serialized data');\n\t\t}\n\t\tconst state = this.toolInvocation.state.get();\n\t\tif (state.type !== IChatToolInvocation.StateKind.WaitingForPostApproval) {\n\t\t\tthrow new Error('Tool invocation is not waiting for post-approval');\n\t\t}\n\n\t\treturn this.createResultsDisplay(this.toolInvocation, state.contentForModel);\n\t}\n\n\tprotected getTitle(): string {\n\t\treturn localize('approveToolResult', \"Approve Tool Result\");\n\t}\n\n\tprotected override additionalPrimaryActions() {\n\t\tconst actions = super.additionalPrimaryActions();\n\n\t\t// Get actions from confirmation service\n\t\tconst confirmActions = this.confirmationService.getPostConfirmActions({\n\t\t\ttoolId: this.toolInvocation.toolId,\n\t\t\tsource: this.toolInvocation.source,\n\t\t\tparameters: this.toolInvocation.parameters\n\t\t});\n\n\t\tfor (const action of confirmActions) {\n\t\t\tif (action.divider) {\n\t\t\t\tactions.push(new Separator());\n\t\t\t}\n\t\t\tactions.push({\n\t\t\t\tlabel: action.label,\n\t\t\t\ttooltip: action.detail,\n\t\t\t\tdata: async () => {\n\t\t\t\t\tconst shouldConfirm = await action.select();\n\t\t\t\t\tif (shouldConfirm) {\n\t\t\t\t\t\tthis.confirmWith(this.toolInvocation, { type: ToolConfirmKind.UserAction });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn actions;\n\t}\n\n\tprivate createResultsDisplay(toolInvocation: IChatToolInvocation, contentForModel: (IToolResultPromptTsxPart | IToolResultTextPart | IToolResultDataPart)[]): HTMLElement {\n\t\tconst container = dom.$('.tool-postconfirm-display');\n\n\t\tif (!contentForModel || contentForModel.length === 0) {\n\t\t\tcontainer.textContent = localize('noResults', 'No results to display');\n\t\t\treturn container;\n\t\t}\n\n\t\tconst parts: ChatCollapsibleIOPart[] = [];\n\n\t\tfor (const [i, part] of contentForModel.entries()) {\n\t\t\tif (part.kind === 'text') {\n\t\t\t\t// Display text parts\n\t\t\t\tconst model = this._register(this.modelService.createModel(\n\t\t\t\t\tpart.value,\n\t\t\t\t\tthis.languageService.createById('plaintext'),\n\t\t\t\t\tundefined,\n\t\t\t\t\ttrue\n\t\t\t\t));\n\n\t\t\t\tparts.push({\n\t\t\t\t\tkind: 'code',\n\t\t\t\t\ttextModel: model,\n\t\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\t\toptions: {\n\t\t\t\t\t\thideToolbar: true,\n\t\t\t\t\t\treserveWidth: 19,\n\t\t\t\t\t\tmaxHeightInLines: 13,\n\t\t\t\t\t\tverticalPadding: 5,\n\t\t\t\t\t\teditorOptions: { wordWrap: 'on', readOnly: true }\n\t\t\t\t\t},\n\t\t\t\t\tcodeBlockInfo: {\n\t\t\t\t\t\tcodeBlockIndex: i,\n\t\t\t\t\t\tcodemapperUri: undefined,\n\t\t\t\t\t\telementId: this.context.element.id,\n\t\t\t\t\t\tfocus: () => { },\n\t\t\t\t\t\townerMarkdownPartId: this.codeblocksPartId,\n\t\t\t\t\t\turi: model.uri,\n\t\t\t\t\t\tchatSessionResource: this.context.element.sessionResource,\n\t\t\t\t\t\turiPromise: Promise.resolve(model.uri)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (part.kind === 'promptTsx') {\n\t\t\t\t// Display TSX parts as JSON-stringified\n\t\t\t\tconst stringified = stringifyPromptTsxPart(part);\n\t\t\t\tconst model = this._register(this.modelService.createModel(\n\t\t\t\t\tstringified,\n\t\t\t\t\tthis.languageService.createById('json'),\n\t\t\t\t\tundefined,\n\t\t\t\t\ttrue\n\t\t\t\t));\n\n\t\t\t\tparts.push({\n\t\t\t\t\tkind: 'code',\n\t\t\t\t\ttextModel: model,\n\t\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\t\toptions: {\n\t\t\t\t\t\thideToolbar: true,\n\t\t\t\t\t\treserveWidth: 19,\n\t\t\t\t\t\tmaxHeightInLines: 13,\n\t\t\t\t\t\tverticalPadding: 5,\n\t\t\t\t\t\teditorOptions: { wordWrap: 'on', readOnly: true }\n\t\t\t\t\t},\n\t\t\t\t\tcodeBlockInfo: {\n\t\t\t\t\t\tcodeBlockIndex: i,\n\t\t\t\t\t\tcodemapperUri: undefined,\n\t\t\t\t\t\telementId: this.context.element.id,\n\t\t\t\t\t\tfocus: () => { },\n\t\t\t\t\t\townerMarkdownPartId: this.codeblocksPartId,\n\t\t\t\t\t\turi: model.uri,\n\t\t\t\t\t\tchatSessionResource: this.context.element.sessionResource,\n\t\t\t\t\t\turiPromise: Promise.resolve(model.uri)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (part.kind === 'data') {\n\t\t\t\t// Display data parts\n\t\t\t\tconst mimeType = part.value.mimeType;\n\t\t\t\tconst data = part.value.data;\n\n\t\t\t\t// Check if it's an image\n\t\t\t\tif (mimeType?.startsWith('image/')) {\n\t\t\t\t\tconst permalinkBasename = getExtensionForMimeType(mimeType) ? `image${getExtensionForMimeType(mimeType)}` : 'image.bin';\n\t\t\t\t\tconst permalinkUri = ChatResponseResource.createUri(this.context.element.sessionId, toolInvocation.toolCallId, i, permalinkBasename);\n\t\t\t\t\tparts.push({ kind: 'data', value: data.buffer, mimeType, uri: permalinkUri, audience: part.audience });\n\t\t\t\t} else {\n\t\t\t\t\t// Try to display as UTF-8 text, otherwise base64\n\t\t\t\t\tconst decoder = new TextDecoder('utf-8', { fatal: true });\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst text = decoder.decode(data.buffer);\n\t\t\t\t\t\tconst model = this._register(this.modelService.createModel(\n\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\tthis.languageService.createById('plaintext'),\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t));\n\n\t\t\t\t\t\tparts.push({\n\t\t\t\t\t\t\tkind: 'code',\n\t\t\t\t\t\t\ttextModel: model,\n\t\t\t\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\thideToolbar: true,\n\t\t\t\t\t\t\t\treserveWidth: 19,\n\t\t\t\t\t\t\t\tmaxHeightInLines: 13,\n\t\t\t\t\t\t\t\tverticalPadding: 5,\n\t\t\t\t\t\t\t\teditorOptions: { wordWrap: 'on', readOnly: true }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcodeBlockInfo: {\n\t\t\t\t\t\t\t\tcodeBlockIndex: i,\n\t\t\t\t\t\t\t\tcodemapperUri: undefined,\n\t\t\t\t\t\t\t\telementId: this.context.element.id,\n\t\t\t\t\t\t\t\tfocus: () => { },\n\t\t\t\t\t\t\t\townerMarkdownPartId: this.codeblocksPartId,\n\t\t\t\t\t\t\t\turi: model.uri,\n\t\t\t\t\t\t\t\tchatSessionResource: this.context.element.sessionResource,\n\t\t\t\t\t\t\t\turiPromise: Promise.resolve(model.uri)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch {\n\t\t\t\t\t\t// Not valid UTF-8, show base64\n\t\t\t\t\t\tconst base64 = data.toString();\n\t\t\t\t\t\tconst model = this._register(this.modelService.createModel(\n\t\t\t\t\t\t\tbase64,\n\t\t\t\t\t\t\tthis.languageService.createById('plaintext'),\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t));\n\n\t\t\t\t\t\tparts.push({\n\t\t\t\t\t\t\tkind: 'code',\n\t\t\t\t\t\t\ttextModel: model,\n\t\t\t\t\t\t\tlanguageId: model.getLanguageId(),\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\thideToolbar: true,\n\t\t\t\t\t\t\t\treserveWidth: 19,\n\t\t\t\t\t\t\t\tmaxHeightInLines: 13,\n\t\t\t\t\t\t\t\tverticalPadding: 5,\n\t\t\t\t\t\t\t\teditorOptions: { wordWrap: 'on', readOnly: true }\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcodeBlockInfo: {\n\t\t\t\t\t\t\t\tcodeBlockIndex: i,\n\t\t\t\t\t\t\t\tcodemapperUri: undefined,\n\t\t\t\t\t\t\t\telementId: this.context.element.id,\n\t\t\t\t\t\t\t\tfocus: () => { },\n\t\t\t\t\t\t\t\townerMarkdownPartId: this.codeblocksPartId,\n\t\t\t\t\t\t\t\turi: model.uri,\n\t\t\t\t\t\t\t\tchatSessionResource: this.context.element.sessionResource,\n\t\t\t\t\t\t\t\turiPromise: Promise.resolve(model.uri)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (parts.length > 0) {\n\t\t\tconst outputSubPart = this._register(this.instantiationService.createInstance(\n\t\t\t\tChatToolOutputContentSubPart,\n\t\t\t\tthis.context,\n\t\t\t\tparts,\n\t\t\t));\n\n\t\t\tthis._codeblocks.push(...outputSubPart.codeblocks);\n\t\t\tthis._register(outputSubPart.onDidChangeHeight(() => this._onDidChangeHeight.fire()));\n\t\t\toutputSubPart.domNode.classList.add('tool-postconfirm-display');\n\t\t\treturn outputSubPart.domNode;\n\t\t}\n\n\t\tcontainer.textContent = localize('noDisplayableResults', 'No displayable results');\n\t\treturn container;\n\t}\n}\n"]}