{"version":3,"sources":["vs/workbench/contrib/chat/browser/modelPicker/modePickerActionItem.ts"],"names":[],"mappings":"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","file":"modePickerActionItem.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { renderLabelWithIcons } from '../../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { IAction } from '../../../../../base/common/actions.js';\nimport { coalesce } from '../../../../../base/common/arrays.js';\nimport { groupBy } from '../../../../../base/common/collections.js';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, IObservable } from '../../../../../base/common/observable.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { localize } from '../../../../../nls.js';\nimport { ActionWidgetDropdownActionViewItem } from '../../../../../platform/actions/browser/actionWidgetDropdownActionViewItem.js';\nimport { getFlatActionBarActions } from '../../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IActionWidgetService } from '../../../../../platform/actionWidget/browser/actionWidget.js';\nimport { IActionWidgetDropdownAction, IActionWidgetDropdownActionProvider, IActionWidgetDropdownOptions } from '../../../../../platform/actionWidget/browser/actionWidgetDropdown.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { IChatAgentService } from '../../common/chatAgents.js';\nimport { ChatMode, IChatMode, IChatModeService } from '../../common/chatModes.js';\nimport { ChatAgentLocation } from '../../common/constants.js';\nimport { PromptsStorage } from '../../common/promptSyntax/service/promptsService.js';\nimport { getOpenChatActionIdForMode } from '../actions/chatActions.js';\nimport { IToggleChatModeArgs, ToggleAgentModeActionId } from '../actions/chatExecuteActions.js';\n\nexport interface IModePickerDelegate {\n\treadonly currentMode: IObservable<IChatMode>;\n\treadonly sessionResource: () => URI | undefined;\n}\n\nexport class ModePickerActionItem extends ActionWidgetDropdownActionViewItem {\n\tconstructor(\n\t\taction: MenuItemAction,\n\t\tprivate readonly delegate: IModePickerDelegate,\n\t\t@IActionWidgetService actionWidgetService: IActionWidgetService,\n\t\t@IChatAgentService chatAgentService: IChatAgentService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IChatModeService chatModeService: IChatModeService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IProductService productService: IProductService\n\t) {\n\t\tconst builtInCategory = { label: localize('built-in', \"Built-In\"), order: 0 };\n\t\tconst customCategory = { label: localize('custom', \"Custom\"), order: 1 };\n\t\tconst makeAction = (mode: IChatMode, currentMode: IChatMode): IActionWidgetDropdownAction => ({\n\t\t\t...action,\n\t\t\tid: getOpenChatActionIdForMode(mode),\n\t\t\tlabel: mode.label.get(),\n\t\t\tclass: undefined,\n\t\t\tenabled: true,\n\t\t\tchecked: currentMode.id === mode.id,\n\t\t\ttooltip: chatAgentService.getDefaultAgent(ChatAgentLocation.Chat, mode.kind)?.description ?? action.tooltip,\n\t\t\trun: async () => {\n\t\t\t\tconst result = await commandService.executeCommand(ToggleAgentModeActionId, { modeId: mode.id, sessionResource: this.delegate.sessionResource() } satisfies IToggleChatModeArgs);\n\t\t\t\tthis.renderLabel(this.element!);\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tcategory: builtInCategory\n\t\t});\n\n\t\tconst makeActionFromCustomMode = (mode: IChatMode, currentMode: IChatMode): IActionWidgetDropdownAction => ({\n\t\t\t...makeAction(mode, currentMode),\n\t\t\ttooltip: mode.description.get() ?? chatAgentService.getDefaultAgent(ChatAgentLocation.Chat, mode.kind)?.description ?? action.tooltip,\n\t\t\tcategory: customCategory\n\t\t});\n\n\t\tconst actionProvider: IActionWidgetDropdownActionProvider = {\n\t\t\tgetActions: () => {\n\t\t\t\tconst modes = chatModeService.getModes();\n\t\t\t\tconst currentMode = delegate.currentMode.get();\n\t\t\t\tconst agentMode = modes.builtin.find(mode => mode.id === ChatMode.Agent.id);\n\t\t\t\tconst otherBuiltinModes = modes.builtin.filter(mode => mode.id !== ChatMode.Agent.id);\n\t\t\t\tconst customModes = groupBy(\n\t\t\t\t\tmodes.custom,\n\t\t\t\t\tmode => mode.source?.storage === PromptsStorage.extension && mode.source.extensionId.value === productService.defaultChatAgent?.chatExtensionId ?\n\t\t\t\t\t\t'builtin' : 'custom');\n\n\t\t\t\tconst customBuiltinModeActions = customModes.builtin?.map(mode => {\n\t\t\t\t\tconst action = makeActionFromCustomMode(mode, currentMode);\n\t\t\t\t\taction.category = builtInCategory;\n\t\t\t\t\treturn action;\n\t\t\t\t}) ?? [];\n\n\t\t\t\tconst orderedModes = coalesce([\n\t\t\t\t\tagentMode && makeAction(agentMode, currentMode),\n\t\t\t\t\t...customBuiltinModeActions,\n\t\t\t\t\t...otherBuiltinModes.map(mode => mode && makeAction(mode, currentMode)),\n\t\t\t\t\t...customModes.custom?.map(mode => makeActionFromCustomMode(mode, currentMode)) ?? []\n\t\t\t\t]);\n\n\t\t\t\treturn orderedModes;\n\t\t\t}\n\t\t};\n\n\t\tconst modePickerActionWidgetOptions: Omit<IActionWidgetDropdownOptions, 'label' | 'labelRenderer'> = {\n\t\t\tactionProvider,\n\t\t\tactionBarActionProvider: {\n\t\t\t\tgetActions: () => this.getModePickerActionBarActions()\n\t\t\t},\n\t\t\tshowItemKeybindings: true\n\t\t};\n\n\t\tsuper(action, modePickerActionWidgetOptions, actionWidgetService, keybindingService, contextKeyService);\n\n\t\t// Listen to changes in the current mode and its properties\n\t\tthis._register(autorun(reader => {\n\t\t\tthis.delegate.currentMode.read(reader).label.read(reader); // use the reader so autorun tracks it\n\t\t\tif (this.element) {\n\t\t\t\tthis.renderLabel(this.element);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate getModePickerActionBarActions(): IAction[] {\n\t\tconst menuActions = this.menuService.createMenu(MenuId.ChatModePicker, this.contextKeyService);\n\t\tconst menuContributions = getFlatActionBarActions(menuActions.getActions({ renderShortTitle: true }));\n\t\tmenuActions.dispose();\n\n\t\treturn menuContributions;\n\t}\n\n\tprotected override renderLabel(element: HTMLElement): IDisposable | null {\n\t\tthis.setAriaLabelAttributes(element);\n\t\tconst state = this.delegate.currentMode.get().label.get();\n\t\tdom.reset(element, dom.$('span.chat-model-label', undefined, state), ...renderLabelWithIcons(`$(chevron-down)`));\n\t\treturn null;\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('chat-modelPicker-item');\n\t}\n}\n"]}