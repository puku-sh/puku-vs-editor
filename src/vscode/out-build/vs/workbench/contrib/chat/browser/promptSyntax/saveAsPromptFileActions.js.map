{"version":3,"sources":["vs/workbench/contrib/chat/browser/promptSyntax/saveAsPromptFileActions.ts"],"names":[],"mappings":"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","file":"saveAsPromptFileActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../../../editor/browser/services/codeEditorService.js';\nimport { ILocalizedString, localize2 } from '../../../../../nls.js';\nimport { ICommandActionTitle } from '../../../../../platform/action/common/action.js';\nimport { Action2, IAction2Options, MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ResourceContextKey } from '../../../../common/contextkeys.js';\nimport { ITextFileService } from '../../../../services/textfile/common/textfiles.js';\nimport { chatEditingWidgetFileStateContextKey, ModifiedFileEntryState } from '../../common/chatEditingService.js';\nimport { getCleanPromptName } from '../../common/promptSyntax/config/promptFileLocations.js';\nimport { AGENT_LANGUAGE_ID, INSTRUCTIONS_LANGUAGE_ID, PROMPT_LANGUAGE_ID, PromptsType } from '../../common/promptSyntax/promptTypes.js';\nimport { CHAT_CATEGORY } from '../actions/chatActions.js';\nimport { askForPromptFileName } from './pickers/askForPromptName.js';\nimport { askForPromptSourceFolder } from './pickers/askForPromptSourceFolder.js';\n\nclass BaseSaveAsPromptFileAction extends Action2 {\n\tconstructor(opts: Readonly<IAction2Options>, private readonly promptType: PromptsType) {\n\t\tsuper(opts);\n\t}\n\n\tasync run(accessor: ServicesAccessor, configUri?: string): Promise<void> {\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\t\tconst textFileService = accessor.get(ITextFileService);\n\t\tconst fileService = accessor.get(IFileService);\n\t\tconst activeCodeEditor = codeEditorService.getActiveCodeEditor();\n\t\tif (!activeCodeEditor) {\n\t\t\treturn;\n\t\t}\n\t\tconst model = activeCodeEditor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\t\tconst newFolder = await instantiationService.invokeFunction(askForPromptSourceFolder, this.promptType, undefined, true);\n\t\tif (!newFolder) {\n\t\t\treturn;\n\t\t}\n\t\tconst newName = await instantiationService.invokeFunction(askForPromptFileName, this.promptType, newFolder.uri, getCleanPromptName(model.uri));\n\t\tif (!newName) {\n\t\t\treturn;\n\t\t}\n\t\tconst newFile = joinPath(newFolder.uri, newName);\n\t\tif (model.uri.scheme === Schemas.untitled) {\n\t\t\tawait textFileService.saveAs(model.uri, newFile, { from: model.uri });\n\t\t} else {\n\t\t\tawait fileService.copy(model.uri, newFile);\n\t\t}\n\t\tawait codeEditorService.openCodeEditor({ resource: newFile }, activeCodeEditor);\n\t}\n}\n\nfunction createOptions(id: string, title: ICommandActionTitle, description: ILocalizedString, languageId: string): Readonly<IAction2Options> {\n\treturn {\n\t\tid: id,\n\t\ttitle: title,\n\t\tmetadata: {\n\t\t\tdescription: description,\n\t\t},\n\t\tcategory: CHAT_CATEGORY,\n\t\tf1: false,\n\t\tmenu: {\n\t\t\tid: MenuId.EditorContent,\n\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\tContextKeyExpr.equals(ResourceContextKey.Scheme.key, Schemas.untitled),\n\t\t\t\tContextKeyExpr.equals(ResourceContextKey.LangId.key, languageId),\n\t\t\t\tContextKeyExpr.notEquals(chatEditingWidgetFileStateContextKey.key, ModifiedFileEntryState.Modified),\n\t\t\t)\n\t\t}\n\t};\n}\n\nexport const SAVE_AS_PROMPT_FILE_ACTION_ID = 'workbench.action.chat.save-as-prompt';\n\nexport class SaveAsPromptFileAction extends BaseSaveAsPromptFileAction {\n\tconstructor() {\n\t\tsuper(createOptions(SAVE_AS_PROMPT_FILE_ACTION_ID, localize2('promptfile.savePromptFile', \"Save As Prompt File\"), localize2('promptfile.savePromptFile.description', \"Save as prompt file\"), PROMPT_LANGUAGE_ID), PromptsType.prompt);\n\t}\n}\n\nexport const SAVE_AS_AGENT_FILE_ACTION_ID = 'workbench.action.chat.save-as-agent';\n\nexport class SaveAsAgentFileAction extends BaseSaveAsPromptFileAction {\n\tconstructor() {\n\t\tsuper(createOptions(SAVE_AS_AGENT_FILE_ACTION_ID, localize2('promptfile.saveAgentFile', \"Save As Agent File\"), localize2('promptfile.saveAgentFile.description', \"Save as agent file\"), AGENT_LANGUAGE_ID), PromptsType.agent);\n\t}\n}\n\nexport const SAVE_AS_INSTRUCTIONS_FILE_ACTION_ID = 'workbench.action.chat.save-as-instructions';\n\nexport class SaveAsInstructionsFileAction extends BaseSaveAsPromptFileAction {\n\tconstructor() {\n\t\tsuper(createOptions(SAVE_AS_INSTRUCTIONS_FILE_ACTION_ID, localize2('promptfile.saveInstructionsFile', \"Save As Instructions File\"), localize2('promptfile.saveInstructionsFile.description', \"Save as instructions file\"), INSTRUCTIONS_LANGUAGE_ID), PromptsType.instructions);\n\t}\n}\n\n"]}