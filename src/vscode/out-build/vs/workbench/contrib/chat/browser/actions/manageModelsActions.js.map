{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/manageModelsActions.ts"],"names":[],"mappings":"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","file":"manageModelsActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { coalesce } from '../../../../../base/common/arrays.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { localize2 } from '../../../../../nls.js';\nimport { Action2 } from '../../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ProductQualityContext } from '../../../../../platform/contextkey/common/contextkeys.js';\nimport { ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickInputService, IQuickPickItem } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ILanguageModelChatMetadataAndIdentifier, ILanguageModelsService } from '../../common/languageModels.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\n\ninterface IVendorQuickPickItem extends IQuickPickItem {\n\tmanagementCommand?: string;\n\tvendor: string;\n}\n\ninterface IModelQuickPickItem extends IQuickPickItem {\n\tmodelId: string;\n\tvendor: string;\n}\n\nexport class ManageModelsAction extends Action2 {\n\tstatic readonly ID = 'workbench.action.chat.manageLanguageModels';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ManageModelsAction.ID,\n\t\t\ttitle: localize2('manageLanguageModels', 'Manage Language Models...'),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ContextKeyExpr.and(ProductQualityContext.isEqualTo('stable'), ChatContextKeys.enabled, ContextKeyExpr.or(\n\t\t\t\tChatContextKeys.Entitlement.planFree,\n\t\t\t\tChatContextKeys.Entitlement.planPro,\n\t\t\t\tChatContextKeys.Entitlement.planProPlus,\n\t\t\t\tChatContextKeys.Entitlement.internal\n\t\t\t)),\n\t\t\tf1: true\n\t\t});\n\t}\n\toverride async run(accessor: ServicesAccessor, ...args: unknown[]): Promise<void> {\n\t\tconst languageModelsService = accessor.get(ILanguageModelsService);\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst commandService = accessor.get(ICommandService);\n\n\t\tconst vendors = languageModelsService.getVendors();\n\t\tconst store = new DisposableStore();\n\n\t\tconst quickPickItems: IVendorQuickPickItem[] = vendors.sort((v1, v2) => v1.displayName.localeCompare(v2.displayName)).map(vendor => ({\n\t\t\tlabel: vendor.displayName,\n\t\t\tvendor: vendor.vendor,\n\t\t\tmanagementCommand: vendor.managementCommand,\n\t\t\tbuttons: vendor.managementCommand ? [{\n\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.settingsGear),\n\t\t\t\ttooltip: `Manage ${vendor.displayName}`\n\t\t\t}] : undefined\n\t\t}));\n\n\t\tconst quickPick = store.add(quickInputService.createQuickPick<IQuickPickItem>());\n\t\tquickPick.title = 'Manage Language Models';\n\t\tquickPick.placeholder = 'Select a provider...';\n\t\tquickPick.items = quickPickItems;\n\t\tquickPick.show();\n\n\t\tstore.add(quickPick.onDidAccept(async () => {\n\t\t\tquickPick.hide();\n\t\t\tconst selectedItem: IVendorQuickPickItem = quickPick.selectedItems[0] as IVendorQuickPickItem;\n\t\t\tif (selectedItem) {\n\t\t\t\tconst models: ILanguageModelChatMetadataAndIdentifier[] = coalesce((await languageModelsService.selectLanguageModels({ vendor: selectedItem.vendor }, true)).map(modelIdentifier => {\n\t\t\t\t\tconst modelMetadata = languageModelsService.lookupLanguageModel(modelIdentifier);\n\t\t\t\t\tif (!modelMetadata) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmetadata: modelMetadata,\n\t\t\t\t\t\tidentifier: modelIdentifier,\n\t\t\t\t\t};\n\t\t\t\t})).sort((m1, m2) => m1.metadata.name.localeCompare(m2.metadata.name));\n\t\t\t\tawait this.showModelSelectorQuickpick(models, quickInputService, languageModelsService);\n\t\t\t}\n\t\t}));\n\n\t\tstore.add(quickPick.onDidTriggerItemButton(async (event) => {\n\t\t\tconst selectedItem = event.item as IVendorQuickPickItem;\n\t\t\tconst managementCommand = selectedItem.managementCommand;\n\t\t\tif (managementCommand) {\n\t\t\t\tcommandService.executeCommand(managementCommand, selectedItem.vendor);\n\t\t\t}\n\t\t}));\n\n\t\tstore.add(quickPick.onDidHide(() => {\n\t\t\tstore.dispose();\n\t\t}));\n\t}\n\n\tprivate async showModelSelectorQuickpick(\n\t\tmodelsAndIdentifiers: ILanguageModelChatMetadataAndIdentifier[],\n\t\tquickInputService: IQuickInputService,\n\t\tlanguageModelsService: ILanguageModelsService\n\t): Promise<void> {\n\t\tconst store = new DisposableStore();\n\t\tconst modelItems: IModelQuickPickItem[] = modelsAndIdentifiers.map(model => ({\n\t\t\tlabel: model.metadata.name,\n\t\t\tdetail: model.metadata.id,\n\t\t\tmodelId: model.identifier,\n\t\t\tvendor: model.metadata.vendor,\n\t\t\tpicked: model.metadata.isUserSelectable\n\t\t}));\n\n\t\tif (modelItems.length === 0) {\n\t\t\tstore.dispose();\n\t\t\treturn;\n\t\t}\n\n\t\tconst quickPick = quickInputService.createQuickPick<IModelQuickPickItem>();\n\t\tquickPick.items = modelItems;\n\t\tquickPick.title = 'Manage Language Models';\n\t\tquickPick.placeholder = 'Select language models...';\n\t\tquickPick.selectedItems = modelItems.filter(item => item.picked);\n\t\tquickPick.canSelectMany = true;\n\t\tquickPick.show();\n\n\t\t// Handle selection\n\t\tstore.add(quickPick.onDidAccept(async () => {\n\t\t\tquickPick.hide();\n\t\t\tconst items: IModelQuickPickItem[] = quickPick.items as IModelQuickPickItem[];\n\t\t\titems.forEach(item => {\n\t\t\t\tlanguageModelsService.updateModelPickerPreference(item.modelId, quickPick.selectedItems.includes(item));\n\t\t\t});\n\t\t}));\n\n\t\tstore.add(quickPick.onDidHide(() => {\n\t\t\tstore.dispose();\n\t\t}));\n\t}\n}\n"]}