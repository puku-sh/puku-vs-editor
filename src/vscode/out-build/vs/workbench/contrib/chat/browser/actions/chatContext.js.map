{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatContext.ts"],"names":[],"mappings":";;;;;;;;;AAAA;;;gGAGgG;AAChG,OAAO,EAAE,iBAAiB,EAAE,MAAM,4CAA4C,CAAC;AAC/E,OAAO,EAAE,OAAO,EAAE,MAAM,wCAAwC,CAAC;AACjE,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE,MAAM,yCAAyC,CAAC;AACtF,OAAO,EAAE,UAAU,EAAE,MAAM,wCAAwC,CAAC;AACpE,OAAO,EAAE,OAAO,EAAE,MAAM,yCAAyC,CAAC;AAElE,OAAO,EAAE,QAAQ,EAAE,MAAM,uBAAuB,CAAC;AACjD,OAAO,EAAE,iBAAiB,EAAE,MAAM,8DAA8D,CAAC;AACjG,OAAO,EAAE,qBAAqB,EAAE,MAAM,+DAA+D,CAAC;AACtG,OAAO,EAAE,aAAa,EAAE,MAAM,+CAA+C,CAAC;AAG9E,OAAO,EAAE,sBAAsB,EAAE,gBAAgB,EAAE,MAAM,8BAA8B,CAAC;AACxF,OAAO,EAAE,eAAe,EAAE,MAAM,8CAA8C,CAAC;AAC/E,OAAO,EAAE,cAAc,EAAE,MAAM,qDAAqD,CAAC;AACrF,OAAO,EAAE,YAAY,EAAE,MAAM,2CAA2C,CAAC;AACzE,OAAO,EAAE,uBAAuB,EAAE,MAAM,iEAAiE,CAAC;AAC1G,OAAO,EAAE,eAAe,EAAE,MAAM,mDAAmD,CAAC;AACpF,OAAO,EAAE,mBAAmB,EAAE,MAAM,iDAAiD,CAAC;AACtF,OAAO,EAAE,uBAAuB,EAAiG,MAAM,8BAA8B,CAAC;AACtK,OAAO,EAAE,mBAAmB,EAAE,MAAM,oCAAoC,CAAC;AACzE,OAAO,EAAiH,sBAAsB,EAAE,mBAAmB,EAAE,MAAM,qCAAqC,CAAC;AACjN,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,MAAM,2CAA2C,CAAC;AAEpF,OAAO,EAAE,WAAW,EAAE,OAAO,EAAE,MAAM,0BAA0B,CAAC;AAChE,OAAO,EAAE,iCAAiC,EAAE,MAAM,0BAA0B,CAAC;AAC7E,OAAO,EAAE,0BAA0B,EAAE,MAAM,6CAA6C,CAAC;AACzF,OAAO,EAAE,gBAAgB,EAAE,MAAM,uCAAuC,CAAC;AAKlE,IAAM,wBAAwB,GAA9B,MAAM,wBAAyB,SAAQ,UAAU;aAEvC,OAAE,GAAG,2BAAH,AAA8B,CAAC;IAEjD,YACwB,oBAA2C,EACzC,kBAA2C;QAEpE,KAAK,EAAE,CAAC;QAER,kGAAkG;QAClG,EAAE;QACF,yFAAyF;QACzF,8FAA8F;QAC9F,uBAAuB;QACvB,EAAE;QACF,kGAAkG;QAElG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;QACzH,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC,CAAC;QAC7H,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC,CAAC;QAC7H,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,6BAA6B,CAAC,CAAC,CAAC,CAAC;QAChI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,8BAA8B,CAAC,CAAC,CAAC,CAAC;QACjI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC,CAAC;IAC9H,CAAC;;AAxBW,wBAAwB;IAKlC,WAAA,qBAAqB,CAAA;IACrB,WAAA,uBAAuB,CAAA;GANb,wBAAwB,CAyBpC;;AAED,MAAM,sBAAsB;IAA5B;QAEU,SAAI,GAAG,YAAY,CAAC;QACpB,UAAK,GAAW,QAAQ,CAAC,IAAmB,EAAE,IAAU,CAAC,CAAC;QAC1D,SAAI,GAAc,OAAO,CAAC,KAAK,CAAC;QAChC,YAAO,GAAG,CAAC,GAAG,CAAC;IA4DzB,CAAC;IA1DA,SAAS,CAAC,MAAmB;QAC5B,OAAO,CAAC,CAAC,MAAM,CAAC,sBAAsB,CAAC,uBAAuB,CAAC;IAChE,CAAC;IAED,QAAQ,CAAC,MAAmB;QAG3B,MAAM,KAAK,GAAW,EAAE,CAAC;QAEzB,KAAK,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,IAAI,MAAM,CAAC,KAAK,CAAC,kBAAkB,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC;YACjF,IAAI,OAAO,EAAE,CAAC;gBACb,IAAI,KAAK,YAAY,OAAO,EAAE,CAAC;oBAC9B,KAAK,CAAC,IAAI,CAAC;wBACV,QAAQ,EAAE,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;wBAC/C,KAAK,EAAE,KAAK,CAAC,aAAa;wBAC1B,WAAW,EAAE,KAAK,CAAC,WAAW;wBAC9B,YAAY,EAAE,GAA6B,EAAE,CAAC,sBAAsB,CAAC,KAAK,CAAC;qBAC3E,CAAC,CAAC;gBACJ,CAAC;qBAAM,CAAC;oBACP,KAAK,CAAC,IAAI,CAAC;wBACV,QAAQ,EAAE,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;wBAC/C,KAAK,EAAE,KAAK,CAAC,iBAAiB,IAAI,KAAK,CAAC,WAAW;wBACnD,WAAW,EAAE,KAAK,CAAC,eAAe,IAAI,KAAK,CAAC,gBAAgB;wBAC5D,YAAY,EAAE,GAA0B,EAAE,CAAC,mBAAmB,CAAC,KAAK,CAAC;qBACrE,CAAC,CAAC;gBACJ,CAAC;YACF,CAAC;QACF,CAAC;QAED,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACnB,IAAI,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC;YAClD,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC;gBACf,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACxD,CAAC;YACD,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC;gBACf,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YACtC,CAAC;YACD,OAAO,GAAG,CAAC;QACZ,CAAC,CAAC,CAAC;QAEH,IAAI,cAAkC,CAAC;QACvC,MAAM,KAAK,GAAmC,EAAE,CAAC;QAEjD,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;YAC1B,IAAI,cAAc,KAAK,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;gBAC5C,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;gBAC9D,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;YACtC,CAAC;YACD,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClB,CAAC;QAED,OAAO;YACN,WAAW,EAAE,QAAQ,CAAC,IAA+B,EAAE,IAAe,CAAC;YACvE,KAAK,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC;SAC7B,CAAC;IACH,CAAC;CAGD;AAID,IAAM,0BAA0B,GAAhC,MAAM,0BAA0B;IAO/B,YACiB,cAAsC,EACvC,aAAoC;QAD3B,mBAAc,GAAd,cAAc,CAAgB;QAC/B,kBAAa,GAAb,aAAa,CAAe;QAP3C,SAAI,GAAG,WAAW,CAAC;QACnB,UAAK,GAAW,QAAQ,CAAC,IAAqB,EAAE,IAAc,CAAC,CAAC;QAChE,SAAI,GAAc,OAAO,CAAC,IAAI,CAAC;QAC/B,YAAO,GAAG,GAAG,CAAC;IAKnB,CAAC;IAEL,SAAS;QACR,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,YAAY,eAAe,IAAI,CAAC,YAAY,eAAe,IAAI,CAAC,YAAY,uBAAuB,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;IACjK,CAAC;IAED,KAAK,CAAC,YAAY;QACjB,MAAM,MAAM,GAAgC,EAAE,CAAC;QAC/C,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;YAClD,IAAI,CAAC,CAAC,MAAM,YAAY,eAAe,IAAI,MAAM,YAAY,eAAe,IAAI,MAAM,YAAY,uBAAuB,IAAI,MAAM,YAAY,mBAAmB,CAAC,EAAE,CAAC;gBACrK,SAAS;YACV,CAAC;YACD,MAAM,GAAG,GAAG,sBAAsB,CAAC,cAAc,CAAC,MAAM,EAAE,EAAE,iBAAiB,EAAE,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAC;YAC3G,IAAI,CAAC,GAAG,EAAE,CAAC;gBACV,SAAS;YACV,CAAC;YACD,MAAM,CAAC,IAAI,CAAC;gBACX,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,GAAG,CAAC,QAAQ,EAAE;gBAClB,KAAK,EAAE,GAAG;gBACV,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,GAAG,CAAC;aACjD,CAAC,CAAC;QACJ,CAAC;QACD,OAAO,MAAM,CAAC;IACf,CAAC;CAED,CAAA;AApCK,0BAA0B;IAQ7B,WAAA,cAAc,CAAA;IACd,WAAA,aAAa,CAAA;GATV,0BAA0B,CAoC/B;AAED,IAAM,6BAA6B,GAAnC,MAAM,6BAA6B;IAQlC,YACsB,mBAAyD,EAC/D,aAA6C;QADtB,wBAAmB,GAAnB,mBAAmB,CAAqB;QAC9C,kBAAa,GAAb,aAAa,CAAe;QARpD,SAAI,GAAG,YAAY,CAAC;QAEpB,UAAK,GAAW,QAAQ,CAAC,IAA0B,EAAE,IAAe,CAAC,CAAC;QACtE,SAAI,GAAc,OAAO,CAAC,OAAO,CAAC;QAClC,YAAO,GAAG,GAAG,CAAC;IAKnB,CAAC;IAEL,SAAS,CAAC,MAAmB;QAC5B,OAAO,IAAI,CAAC,mBAAmB,CAAC,wBAAwB,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,IAAI,MAAM,CAAC,eAAe,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACjJ,CAAC;IAED,QAAQ,CAAC,MAAmB;QAE3B,MAAM,KAAK,GAAG,CAAC,KAAK,IAAI,EAAE;YACzB,MAAM,mBAAmB,GAAG,MAAM,CAAC,SAAS,EAAE,eAAe,CAAC;YAC9D,IAAI,CAAC,mBAAmB,EAAE,CAAC;gBAC1B,OAAO,EAAE,CAAC;YACX,CAAC;YACD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,mBAAmB,EAAE,MAAM,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,eAAe,CAAC,eAAe,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAC5K,IAAI,CAAC,YAAY,EAAE,CAAC;gBACnB,OAAO,EAAE,CAAC;YACX,CAAC;YACD,MAAM,WAAW,GAAG,MAAM,CAAC,eAAe,CAAC,gBAAgB,EAAE,CAAC;YAC9D,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,mBAAmB,EAAE,MAAM,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,eAAe,CAAC,eAAe,EAAE,iBAAiB,CAAC,IAAI,CAAC;iBACrJ,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,MAAM,CAAuD,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;gBACxG,GAAG,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC;gBAClD,KAAK,MAAM,IAAI,IAAI,GAAG,CAAC,KAAK,EAAE,CAAC;oBAC9B,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC/D,GAAG,CAAC,IAAI,CAAC;wBACR,KAAK,EAAE,KAAK;wBACZ,WAAW,EAAE,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;wBAClF,QAAQ,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;wBAC9C,YAAY,EAAE,GAAG,EAAE;4BAClB,OAAO;gCACN,IAAI,EAAE,MAAM;gCACZ,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE;gCACvB,KAAK,EAAE,IAAI,CAAC,GAAG;gCACf,IAAI,EAAE,KAAK;gCACX,YAAY,iCAAyB;6BACrC,CAAC;wBACH,CAAC;qBACD,CAAC,CAAC;gBACJ,CAAC;gBACD,OAAO,GAAG,CAAC;YACZ,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QACV,CAAC,CAAC,EAAE,CAAC;QAEL,OAAO;YACN,WAAW,EAAE,QAAQ,CAAC,IAAc,EAAE,IAAuC,CAAC;YAC9E,KAAK;SACL,CAAC;IACH,CAAC;CACD,CAAA;AA1DK,6BAA6B;IAShC,WAAA,mBAAmB,CAAA;IACnB,WAAA,aAAa,CAAA;GAVV,6BAA6B,CA0DlC;AAGD,IAAM,8BAA8B,GAApC,MAAM,8BAA8B;IAKnC,YACoB,iBAAqD;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;QALhE,SAAI,GAAG,WAAW,CAAC;QACnB,UAAK,GAAG,QAAQ,CAAC,IAAoB,EAAE,IAAsB,CAAC,CAAC;QAC/D,SAAI,GAAG,OAAO,CAAC,SAAS,CAAC;IAI9B,CAAC;IAEL,KAAK,CAAC,SAAS,CAAC,MAAmB;QAClC,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,wBAAwB,EAAE,CAAC;YAC7D,OAAO,KAAK,CAAC;QACd,CAAC;QACD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,EAAE,QAAQ,CAAC,YAAY,EAAE,MAAM,EAAE,CAAC;YACxE,OAAO,KAAK,CAAC;QACd,CAAC;QACD,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,CAAC;QAC3D,OAAO,OAAO,CAAC,SAAS,CAAC,CAAC;IAC3B,CAAC;IAED,KAAK,CAAC,YAAY;QACjB,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,CAAC;QAC5D,OAAO;YACN,EAAE,EAAE,MAAM,WAAW,CAAC,UAAU,CAAC;YACjC,IAAI,EAAE,QAAQ,CAAC,IAAa,EAAE,IAAc,CAAC;YAC7C,QAAQ,EAAE,QAAQ,CAAC,IAAa,EAAE,IAAc,CAAC;YACjD,KAAK,EAAE,UAAU;YACjB,IAAI,EAAE,OAAO;SACb,CAAC;IACH,CAAC;CACD,CAAA;AA9BK,8BAA8B;IAMjC,WAAA,iBAAiB,CAAA;GANd,8BAA8B,CA8BnC;AAEM,IAAM,eAAe,GAArB,MAAM,eAAe;IAK3B,YAA6B,SAAc,EAAoB,gBAAmD;QAArF,cAAS,GAAT,SAAS,CAAK;QAAqC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAHzG,SAAI,GAAG,WAAW,CAAC;QACnB,SAAI,GAAG,OAAO,CAAC,QAAQ,CAAC;QACxB,UAAK,GAAG,QAAQ,CAAC,IAAU,EAAE,IAAU,CAAC,CAAC;IAGlD,CAAC;IACD,SAAS,CAAC,MAAmB;QAC5B,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC/E,OAAO,CAAC,CAAC,MAAM,CAAC,sBAAsB,CAAC,2BAA2B,IAAI,QAAQ,EAAE,UAAU,KAAK,KAAK,CAAC;IACtG,CAAC;IACD,KAAK,CAAC,YAAY,CAAC,MAAmB;QACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC/E,IAAI,CAAC,QAAQ,EAAE,CAAC;YACf,OAAO;QACR,CAAC;QACD,MAAM,MAAM,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACzD,MAAM,OAAO,GAAG,QAAQ,CAAC,YAAY,CAAC,GAAG,6CAAqC,EAAE,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,KAAK,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;QACvI,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,OAAO;QACR,CAAC;QACD,MAAM,UAAU,GAA8B;YAC7C,IAAI,EAAE,iBAAiB;YACvB,EAAE,EAAE,mBAAmB,IAAI,CAAC,GAAG,EAAE,GAAG;YACpC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC;YAC5B,IAAI,EAAE,OAAO,CAAC,OAAO;YACrB,OAAO,EAAE,OAAO,CAAC,OAAO;YACxB,MAAM,EAAE,OAAO,CAAC,SAAS,EAAE;YAC3B,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,QAAQ,EAAE,IAAI,CAAC,SAAS;SACxB,CAAC;QACF,MAAM,OAAO,GAAG,IAAI,eAAe,EAAE,CAAC;QACtC,IAAI,QAAQ,GAAG,KAAK,CAAC;QACrB,MAAM,cAAc,GAAG,GAAG,EAAE;YAC3B,IAAI,QAAQ,EAAE,CAAC;gBACd,OAAO;YACR,CAAC;YACD,QAAQ,GAAG,IAAI,CAAC;YAChB,OAAO,CAAC,OAAO,EAAE,CAAC;QACnB,CAAC,CAAC;QACF,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE;YAClD,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC;gBACvC,cAAc,EAAE,CAAC;YAClB,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;QACJ,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,EAAE;YACpC,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;YAC7C,MAAM,CAAC,kBAAkB,EAAE,CAAC;YAC5B,cAAc,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC,CAAC;QACJ,OAAO,UAAU,CAAC;IACnB,CAAC;IAEO,OAAO,CAAC,OAAyB;QACxC,IAAI,KAAK,GAAG,YAAY,OAAO,CAAC,OAAO,EAAE,CAAC;QAC1C,MAAM,MAAM,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;QACnC,IAAI,MAAM,EAAE,CAAC;YACZ,KAAK,IAAI,cAAc,MAAM,EAAE,CAAC;QACjC,CAAC;QACD,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,QAAQ,EAAE,CAAC;YAC1C,KAAK,IAAI,gBAAgB,OAAO,CAAC,QAAQ,EAAE,CAAC;QAC7C,CAAC;QACD,OAAO,KAAK,CAAC;IACd,CAAC;CACD,CAAA;AAjEY,eAAe;IAKmB,WAAA,gBAAgB,CAAA;GALlD,eAAe,CAiE3B;;AAED,IAAM,0BAA0B,GAAhC,MAAM,0BAA0B;IAQ/B,YACe,YAA2C;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAPjD,SAAI,GAAG,WAAW,CAAC;QACnB,SAAI,GAAG,OAAO,CAAC,YAAY,CAAC;QAC5B,UAAK,GAAG,CAAC,UAAU;YAC3B,CAAC,CAAC,QAAQ,CAAC,IAAmD,EAAE,IAAmB,CAAC;YACpF,CAAC,CAAC,QAAQ,CAAC,IAAuC,EAAE,IAAY,CAAC,CAAC,CAAC;IAIhE,CAAC;IAEL,KAAK,CAAC,SAAS,CAAC,MAAmB;QAClC,OAAO,CAAC,CAAC,MAAM,CAAC,sBAAsB,CAAC,wBAAwB,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,EAAE,QAAQ,CAAC,YAAY,EAAE,MAAM,CAAC;IACxI,CAAC;IAED,KAAK,CAAC,YAAY;QACjB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,CAAC;QACrD,OAAO,IAAI,IAAI,iCAAiC,CAAC,IAAI,CAAC,CAAC;IACxD,CAAC;CACD,CAAA;AApBK,0BAA0B;IAS7B,WAAA,YAAY,CAAA;GATT,0BAA0B,CAoB/B","file":"chatContext.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { isElectron } from '../../../../../base/common/platform.js';\nimport { dirname } from '../../../../../base/common/resources.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { localize } from '../../../../../nls.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { IQuickPickSeparator } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { IWorkbenchContribution } from '../../../../common/contributions.js';\nimport { EditorResourceAccessor, SideBySideEditor } from '../../../../common/editor.js';\nimport { DiffEditorInput } from '../../../../common/editor/diffEditorInput.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IHostService } from '../../../../services/host/browser/host.js';\nimport { UntitledTextEditorInput } from '../../../../services/untitled/common/untitledTextEditorInput.js';\nimport { FileEditorInput } from '../../../files/browser/editors/fileEditorInput.js';\nimport { NotebookEditorInput } from '../../../notebook/common/notebookEditorInput.js';\nimport { IChatContextPickService, IChatContextValueItem, IChatContextPickerItem, IChatContextPickerPickItem, IChatContextPicker } from '../chatContextPickService.js';\nimport { IChatEditingService } from '../../common/chatEditingService.js';\nimport { IChatRequestToolEntry, IChatRequestToolSetEntry, IChatRequestVariableEntry, IImageVariableEntry, OmittedState, toToolSetVariableEntry, toToolVariableEntry } from '../../common/chatVariableEntries.js';\nimport { ToolDataSource, ToolSet } from '../../common/languageModelToolsService.js';\nimport { IChatWidget } from '../chat.js';\nimport { imageToHash, isImage } from '../chatPasteProviders.js';\nimport { convertBufferToScreenshotVariable } from '../contrib/screenshot.js';\nimport { ChatInstructionsPickerPick } from '../promptSyntax/attachInstructionsAction.js';\nimport { ITerminalService } from '../../../terminal/browser/terminal.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ITerminalCommand, TerminalCapability } from '../../../../../platform/terminal/common/capabilities/capabilities.js';\n\n\nexport class ChatContextContributions extends Disposable implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'chat.contextContributions';\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IChatContextPickService contextPickService: IChatContextPickService,\n\t) {\n\t\tsuper();\n\n\t\t// ###############################################################################################\n\t\t//\n\t\t// Default context picks/values which are \"native\" to chat. This is NOT the complete list\n\t\t// and feature area specific context, like for notebooks, problems, etc, should be contributed\n\t\t// by the feature area.\n\t\t//\n\t\t// ###############################################################################################\n\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(ToolsContextPickerPick)));\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(ChatInstructionsPickerPick)));\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(OpenEditorContextValuePick)));\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(RelatedFilesContextPickerPick)));\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(ClipboardImageContextValuePick)));\n\t\tthis._store.add(contextPickService.registerChatContextItem(instantiationService.createInstance(ScreenshotContextValuePick)));\n\t}\n}\n\nclass ToolsContextPickerPick implements IChatContextPickerItem {\n\n\treadonly type = 'pickerPick';\n\treadonly label: string = localize('chatContext.tools', 'Tools...');\n\treadonly icon: ThemeIcon = Codicon.tools;\n\treadonly ordinal = -500;\n\n\tisEnabled(widget: IChatWidget): boolean {\n\t\treturn !!widget.attachmentCapabilities.supportsToolAttachments;\n\t}\n\n\tasPicker(widget: IChatWidget): IChatContextPicker {\n\n\t\ttype Pick = IChatContextPickerPickItem & { toolInfo: { ordinal: number; label: string } };\n\t\tconst items: Pick[] = [];\n\n\t\tfor (const [entry, enabled] of widget.input.selectedToolsModel.entriesMap.get()) {\n\t\t\tif (enabled) {\n\t\t\t\tif (entry instanceof ToolSet) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttoolInfo: ToolDataSource.classify(entry.source),\n\t\t\t\t\t\tlabel: entry.referenceName,\n\t\t\t\t\t\tdescription: entry.description,\n\t\t\t\t\t\tasAttachment: (): IChatRequestToolSetEntry => toToolSetVariableEntry(entry)\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttoolInfo: ToolDataSource.classify(entry.source),\n\t\t\t\t\t\tlabel: entry.toolReferenceName ?? entry.displayName,\n\t\t\t\t\t\tdescription: entry.userDescription ?? entry.modelDescription,\n\t\t\t\t\t\tasAttachment: (): IChatRequestToolEntry => toToolVariableEntry(entry)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\titems.sort((a, b) => {\n\t\t\tlet res = a.toolInfo.ordinal - b.toolInfo.ordinal;\n\t\t\tif (res === 0) {\n\t\t\t\tres = a.toolInfo.label.localeCompare(b.toolInfo.label);\n\t\t\t}\n\t\t\tif (res === 0) {\n\t\t\t\tres = a.label.localeCompare(b.label);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\n\t\tlet lastGroupLabel: string | undefined;\n\t\tconst picks: (IQuickPickSeparator | Pick)[] = [];\n\n\t\tfor (const item of items) {\n\t\t\tif (lastGroupLabel !== item.toolInfo.label) {\n\t\t\t\tpicks.push({ type: 'separator', label: item.toolInfo.label });\n\t\t\t\tlastGroupLabel = item.toolInfo.label;\n\t\t\t}\n\t\t\tpicks.push(item);\n\t\t}\n\n\t\treturn {\n\t\t\tplaceholder: localize('chatContext.tools.placeholder', 'Select a tool'),\n\t\t\tpicks: Promise.resolve(picks)\n\t\t};\n\t}\n\n\n}\n\n\n\nclass OpenEditorContextValuePick implements IChatContextValueItem {\n\n\treadonly type = 'valuePick';\n\treadonly label: string = localize('chatContext.editors', 'Open Editors');\n\treadonly icon: ThemeIcon = Codicon.file;\n\treadonly ordinal = 800;\n\n\tconstructor(\n\t\t@IEditorService private _editorService: IEditorService,\n\t\t@ILabelService private _labelService: ILabelService,\n\t) { }\n\n\tisEnabled(): Promise<boolean> | boolean {\n\t\treturn this._editorService.editors.filter(e => e instanceof FileEditorInput || e instanceof DiffEditorInput || e instanceof UntitledTextEditorInput).length > 0;\n\t}\n\n\tasync asAttachment(): Promise<IChatRequestVariableEntry[]> {\n\t\tconst result: IChatRequestVariableEntry[] = [];\n\t\tfor (const editor of this._editorService.editors) {\n\t\t\tif (!(editor instanceof FileEditorInput || editor instanceof DiffEditorInput || editor instanceof UntitledTextEditorInput || editor instanceof NotebookEditorInput)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst uri = EditorResourceAccessor.getOriginalUri(editor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t\tif (!uri) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult.push({\n\t\t\t\tkind: 'file',\n\t\t\t\tid: uri.toString(),\n\t\t\t\tvalue: uri,\n\t\t\t\tname: this._labelService.getUriBasenameLabel(uri),\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n}\n\nclass RelatedFilesContextPickerPick implements IChatContextPickerItem {\n\n\treadonly type = 'pickerPick';\n\n\treadonly label: string = localize('chatContext.relatedFiles', 'Related Files');\n\treadonly icon: ThemeIcon = Codicon.sparkle;\n\treadonly ordinal = 300;\n\n\tconstructor(\n\t\t@IChatEditingService private readonly _chatEditingService: IChatEditingService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t) { }\n\n\tisEnabled(widget: IChatWidget): boolean {\n\t\treturn this._chatEditingService.hasRelatedFilesProviders() && (Boolean(widget.getInput()) || widget.attachmentModel.fileAttachments.length > 0);\n\t}\n\n\tasPicker(widget: IChatWidget): IChatContextPicker {\n\n\t\tconst picks = (async () => {\n\t\t\tconst chatSessionResource = widget.viewModel?.sessionResource;\n\t\t\tif (!chatSessionResource) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconst relatedFiles = await this._chatEditingService.getRelatedFiles(chatSessionResource, widget.getInput(), widget.attachmentModel.fileAttachments, CancellationToken.None);\n\t\t\tif (!relatedFiles) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconst attachments = widget.attachmentModel.getAttachmentIDs();\n\t\t\treturn this._chatEditingService.getRelatedFiles(chatSessionResource, widget.getInput(), widget.attachmentModel.fileAttachments, CancellationToken.None)\n\t\t\t\t.then((files) => (files ?? []).reduce<(IChatContextPickerPickItem | IQuickPickSeparator)[]>((acc, cur) => {\n\t\t\t\t\tacc.push({ type: 'separator', label: cur.group });\n\t\t\t\t\tfor (const file of cur.files) {\n\t\t\t\t\t\tconst label = this._labelService.getUriBasenameLabel(file.uri);\n\t\t\t\t\t\tacc.push({\n\t\t\t\t\t\t\tlabel: label,\n\t\t\t\t\t\t\tdescription: this._labelService.getUriLabel(dirname(file.uri), { relative: true }),\n\t\t\t\t\t\t\tdisabled: attachments.has(file.uri.toString()),\n\t\t\t\t\t\t\tasAttachment: () => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tkind: 'file',\n\t\t\t\t\t\t\t\t\tid: file.uri.toString(),\n\t\t\t\t\t\t\t\t\tvalue: file.uri,\n\t\t\t\t\t\t\t\t\tname: label,\n\t\t\t\t\t\t\t\t\tomittedState: OmittedState.NotOmitted\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn acc;\n\t\t\t\t}, []));\n\t\t})();\n\n\t\treturn {\n\t\t\tplaceholder: localize('relatedFiles', 'Add related files to your working set'),\n\t\t\tpicks,\n\t\t};\n\t}\n}\n\n\nclass ClipboardImageContextValuePick implements IChatContextValueItem {\n\treadonly type = 'valuePick';\n\treadonly label = localize('imageFromClipboard', 'Image from Clipboard');\n\treadonly icon = Codicon.fileMedia;\n\n\tconstructor(\n\t\t@IClipboardService private readonly _clipboardService: IClipboardService,\n\t) { }\n\n\tasync isEnabled(widget: IChatWidget) {\n\t\tif (!widget.attachmentCapabilities.supportsImageAttachments) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!widget.input.selectedLanguageModel?.metadata.capabilities?.vision) {\n\t\t\treturn false;\n\t\t}\n\t\tconst imageData = await this._clipboardService.readImage();\n\t\treturn isImage(imageData);\n\t}\n\n\tasync asAttachment(): Promise<IImageVariableEntry> {\n\t\tconst fileBuffer = await this._clipboardService.readImage();\n\t\treturn {\n\t\t\tid: await imageToHash(fileBuffer),\n\t\t\tname: localize('pastedImage', 'Pasted Image'),\n\t\t\tfullName: localize('pastedImage', 'Pasted Image'),\n\t\t\tvalue: fileBuffer,\n\t\t\tkind: 'image',\n\t\t};\n\t}\n}\n\nexport class TerminalContext implements IChatContextValueItem {\n\n\treadonly type = 'valuePick';\n\treadonly icon = Codicon.terminal;\n\treadonly label = localize('terminal', 'Terminal');\n\tconstructor(private readonly _resource: URI, @ITerminalService private readonly _terminalService: ITerminalService) {\n\n\t}\n\tisEnabled(widget: IChatWidget) {\n\t\tconst terminal = this._terminalService.getInstanceFromResource(this._resource);\n\t\treturn !!widget.attachmentCapabilities.supportsTerminalAttachments && terminal?.isDisposed === false;\n\t}\n\tasync asAttachment(widget: IChatWidget): Promise<IChatRequestVariableEntry | undefined> {\n\t\tconst terminal = this._terminalService.getInstanceFromResource(this._resource);\n\t\tif (!terminal) {\n\t\t\treturn;\n\t\t}\n\t\tconst params = new URLSearchParams(this._resource.query);\n\t\tconst command = terminal.capabilities.get(TerminalCapability.CommandDetection)?.commands.find(cmd => cmd.id === params.get('command'));\n\t\tif (!command) {\n\t\t\treturn;\n\t\t}\n\t\tconst attachment: IChatRequestVariableEntry = {\n\t\t\tkind: 'terminalCommand',\n\t\t\tid: `terminalCommand:${Date.now()}}`,\n\t\t\tvalue: this.asValue(command),\n\t\t\tname: command.command,\n\t\t\tcommand: command.command,\n\t\t\toutput: command.getOutput(),\n\t\t\texitCode: command.exitCode,\n\t\t\tresource: this._resource\n\t\t};\n\t\tconst cleanup = new DisposableStore();\n\t\tlet disposed = false;\n\t\tconst disposeCleanup = () => {\n\t\t\tif (disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdisposed = true;\n\t\t\tcleanup.dispose();\n\t\t};\n\t\tcleanup.add(widget.attachmentModel.onDidChange(e => {\n\t\t\tif (e.deleted.includes(attachment.id)) {\n\t\t\t\tdisposeCleanup();\n\t\t\t}\n\t\t}));\n\t\tcleanup.add(terminal.onDisposed(() => {\n\t\t\twidget.attachmentModel.delete(attachment.id);\n\t\t\twidget.refreshParsedInput();\n\t\t\tdisposeCleanup();\n\t\t}));\n\t\treturn attachment;\n\t}\n\n\tprivate asValue(command: ITerminalCommand): string {\n\t\tlet value = `Command: ${command.command}`;\n\t\tconst output = command.getOutput();\n\t\tif (output) {\n\t\t\tvalue += `\\nOutput:\\n${output}`;\n\t\t}\n\t\tif (typeof command.exitCode === 'number') {\n\t\t\tvalue += `\\nExit Code: ${command.exitCode}`;\n\t\t}\n\t\treturn value;\n\t}\n}\n\nclass ScreenshotContextValuePick implements IChatContextValueItem {\n\n\treadonly type = 'valuePick';\n\treadonly icon = Codicon.deviceCamera;\n\treadonly label = (isElectron\n\t\t? localize('chatContext.attachScreenshot.labelElectron.Window', 'Screenshot Window')\n\t\t: localize('chatContext.attachScreenshot.labelWeb', 'Screenshot'));\n\n\tconstructor(\n\t\t@IHostService private readonly _hostService: IHostService,\n\t) { }\n\n\tasync isEnabled(widget: IChatWidget) {\n\t\treturn !!widget.attachmentCapabilities.supportsImageAttachments && !!widget.input.selectedLanguageModel?.metadata.capabilities?.vision;\n\t}\n\n\tasync asAttachment(): Promise<IChatRequestVariableEntry | undefined> {\n\t\tconst blob = await this._hostService.getScreenshot();\n\t\treturn blob && convertBufferToScreenshotVariable(blob);\n\t}\n}\n"]}