{"version":3,"sources":["vs/workbench/contrib/chat/browser/languageModelToolsConfirmationService.ts"],"names":[],"mappings":"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","file":"languageModelToolsConfirmationService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Toggle } from '../../../../base/browser/ui/toggle/toggle.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { localize } from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickInputService, IQuickTreeItem } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { asCssVariable } from '../../../../platform/theme/common/colorUtils.js';\nimport { ConfirmedReason, ToolConfirmKind } from '../common/chatService.js';\nimport { ILanguageModelToolConfirmationActions, ILanguageModelToolConfirmationContribution, ILanguageModelToolConfirmationContributionQuickTreeItem, ILanguageModelToolConfirmationRef, ILanguageModelToolsConfirmationService } from '../common/languageModelToolsConfirmationService.js';\nimport { IToolData, ToolDataSource } from '../common/languageModelToolsService.js';\n\nconst RUN_WITHOUT_APPROVAL = localize('runWithoutApproval', \"without approval\");\nconst CONTINUE_WITHOUT_REVIEWING_RESULTS = localize('continueWithoutReviewingResults', \"without reviewing result\");\n\n\nclass GenericConfirmStore extends Disposable {\n\tprivate _workspaceStore: Lazy<ToolConfirmStore>;\n\tprivate _profileStore: Lazy<ToolConfirmStore>;\n\tprivate _memoryStore = new Set<string>();\n\n\tconstructor(\n\t\tprivate readonly _storageKey: string,\n\t\tprivate readonly _instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis._workspaceStore = new Lazy(() => this._register(this._instantiationService.createInstance(ToolConfirmStore, StorageScope.WORKSPACE, this._storageKey)));\n\t\tthis._profileStore = new Lazy(() => this._register(this._instantiationService.createInstance(ToolConfirmStore, StorageScope.PROFILE, this._storageKey)));\n\t}\n\n\tpublic setAutoConfirmation(id: string, scope: 'workspace' | 'profile' | 'session' | 'never'): void {\n\t\t// Clear from all scopes first\n\t\tthis._workspaceStore.value.setAutoConfirm(id, false);\n\t\tthis._profileStore.value.setAutoConfirm(id, false);\n\t\tthis._memoryStore.delete(id);\n\n\t\t// Set in the appropriate scope\n\t\tif (scope === 'workspace') {\n\t\t\tthis._workspaceStore.value.setAutoConfirm(id, true);\n\t\t} else if (scope === 'profile') {\n\t\t\tthis._profileStore.value.setAutoConfirm(id, true);\n\t\t} else if (scope === 'session') {\n\t\t\tthis._memoryStore.add(id);\n\t\t}\n\t}\n\n\tpublic getAutoConfirmation(id: string): 'workspace' | 'profile' | 'session' | 'never' {\n\t\tif (this._workspaceStore.value.getAutoConfirm(id)) {\n\t\t\treturn 'workspace';\n\t\t}\n\t\tif (this._profileStore.value.getAutoConfirm(id)) {\n\t\t\treturn 'profile';\n\t\t}\n\t\tif (this._memoryStore.has(id)) {\n\t\t\treturn 'session';\n\t\t}\n\t\treturn 'never';\n\t}\n\n\tpublic getAutoConfirmationIn(id: string, scope: 'workspace' | 'profile' | 'session'): boolean {\n\t\tif (scope === 'workspace') {\n\t\t\treturn this._workspaceStore.value.getAutoConfirm(id);\n\t\t} else if (scope === 'profile') {\n\t\t\treturn this._profileStore.value.getAutoConfirm(id);\n\t\t} else {\n\t\t\treturn this._memoryStore.has(id);\n\t\t}\n\t}\n\n\tpublic reset(): void {\n\t\tthis._workspaceStore.value.reset();\n\t\tthis._profileStore.value.reset();\n\t\tthis._memoryStore.clear();\n\t}\n\n\tpublic checkAutoConfirmation(id: string): ConfirmedReason | undefined {\n\t\tif (this._workspaceStore.value.getAutoConfirm(id)) {\n\t\t\treturn { type: ToolConfirmKind.LmServicePerTool, scope: 'workspace' };\n\t\t}\n\t\tif (this._profileStore.value.getAutoConfirm(id)) {\n\t\t\treturn { type: ToolConfirmKind.LmServicePerTool, scope: 'profile' };\n\t\t}\n\t\tif (this._memoryStore.has(id)) {\n\t\t\treturn { type: ToolConfirmKind.LmServicePerTool, scope: 'session' };\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getAllConfirmed(): Set<string> {\n\t\tconst all = new Set<string>();\n\t\tfor (const key of this._workspaceStore.value.getAll()) {\n\t\t\tall.add(key);\n\t\t}\n\t\tfor (const key of this._profileStore.value.getAll()) {\n\t\t\tall.add(key);\n\t\t}\n\t\tfor (const key of this._memoryStore) {\n\t\t\tall.add(key);\n\t\t}\n\t\treturn all;\n\t}\n}\n\nclass ToolConfirmStore extends Disposable {\n\tprivate _autoConfirmTools: LRUCache<string, boolean> = new LRUCache<string, boolean>(100);\n\tprivate _didChange = false;\n\n\tconstructor(\n\t\tprivate readonly _scope: StorageScope,\n\t\tprivate readonly _storageKey: string,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t) {\n\t\tsuper();\n\n\t\tconst stored = storageService.getObject<string[]>(this._storageKey, this._scope);\n\t\tif (stored) {\n\t\t\tfor (const key of stored) {\n\t\t\t\tthis._autoConfirmTools.set(key, true);\n\t\t\t}\n\t\t}\n\n\t\tthis._register(storageService.onWillSaveState(() => {\n\t\t\tif (this._didChange) {\n\t\t\t\tthis.storageService.store(this._storageKey, [...this._autoConfirmTools.keys()], this._scope, StorageTarget.MACHINE);\n\t\t\t\tthis._didChange = false;\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic reset() {\n\t\tthis._autoConfirmTools.clear();\n\t\tthis._didChange = true;\n\t}\n\n\tpublic getAutoConfirm(id: string): boolean {\n\t\tif (this._autoConfirmTools.get(id)) {\n\t\t\tthis._didChange = true;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic setAutoConfirm(id: string, autoConfirm: boolean): void {\n\t\tif (autoConfirm) {\n\t\t\tthis._autoConfirmTools.set(id, true);\n\t\t} else {\n\t\t\tthis._autoConfirmTools.delete(id);\n\t\t}\n\t\tthis._didChange = true;\n\t}\n\n\tpublic getAll(): string[] {\n\t\treturn [...this._autoConfirmTools.keys()];\n\t}\n}\n\nexport class LanguageModelToolsConfirmationService extends Disposable implements ILanguageModelToolsConfirmationService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _preExecutionToolConfirmStore: GenericConfirmStore;\n\tprivate _postExecutionToolConfirmStore: GenericConfirmStore;\n\tprivate _preExecutionServerConfirmStore: GenericConfirmStore;\n\tprivate _postExecutionServerConfirmStore: GenericConfirmStore;\n\n\tprivate _contributions = new Map<string, ILanguageModelToolConfirmationContribution>();\n\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t) {\n\t\tsuper();\n\n\t\tthis._preExecutionToolConfirmStore = this._register(new GenericConfirmStore('chat/autoconfirm', this._instantiationService));\n\t\tthis._postExecutionToolConfirmStore = this._register(new GenericConfirmStore('chat/autoconfirm-post', this._instantiationService));\n\t\tthis._preExecutionServerConfirmStore = this._register(new GenericConfirmStore('chat/servers/autoconfirm', this._instantiationService));\n\t\tthis._postExecutionServerConfirmStore = this._register(new GenericConfirmStore('chat/servers/autoconfirm-post', this._instantiationService));\n\t}\n\n\tgetPreConfirmAction(ref: ILanguageModelToolConfirmationRef): ConfirmedReason | undefined {\n\t\t// Check contribution first\n\t\tconst contribution = this._contributions.get(ref.toolId);\n\t\tif (contribution?.getPreConfirmAction) {\n\t\t\tconst result = contribution.getPreConfirmAction(ref);\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\t// If contribution disables default approvals, don't check default stores\n\t\tif (contribution && contribution.canUseDefaultApprovals === false) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Check tool-level confirmation\n\t\tconst toolResult = this._preExecutionToolConfirmStore.checkAutoConfirmation(ref.toolId);\n\t\tif (toolResult) {\n\t\t\treturn toolResult;\n\t\t}\n\n\t\t// Check server-level confirmation for MCP tools\n\t\tif (ref.source.type === 'mcp') {\n\t\t\tconst serverResult = this._preExecutionServerConfirmStore.checkAutoConfirmation(ref.source.definitionId);\n\t\t\tif (serverResult) {\n\t\t\t\treturn serverResult;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetPostConfirmAction(ref: ILanguageModelToolConfirmationRef): ConfirmedReason | undefined {\n\t\t// Check contribution first\n\t\tconst contribution = this._contributions.get(ref.toolId);\n\t\tif (contribution?.getPostConfirmAction) {\n\t\t\tconst result = contribution.getPostConfirmAction(ref);\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\t// If contribution disables default approvals, don't check default stores\n\t\tif (contribution && contribution.canUseDefaultApprovals === false) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Check tool-level confirmation\n\t\tconst toolResult = this._postExecutionToolConfirmStore.checkAutoConfirmation(ref.toolId);\n\t\tif (toolResult) {\n\t\t\treturn toolResult;\n\t\t}\n\n\t\t// Check server-level confirmation for MCP tools\n\t\tif (ref.source.type === 'mcp') {\n\t\t\tconst serverResult = this._postExecutionServerConfirmStore.checkAutoConfirmation(ref.source.definitionId);\n\t\t\tif (serverResult) {\n\t\t\t\treturn serverResult;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetPreConfirmActions(ref: ILanguageModelToolConfirmationRef): ILanguageModelToolConfirmationActions[] {\n\t\tconst actions: ILanguageModelToolConfirmationActions[] = [];\n\n\t\t// Add contribution actions first\n\t\tconst contribution = this._contributions.get(ref.toolId);\n\t\tif (contribution?.getPreConfirmActions) {\n\t\t\tactions.push(...contribution.getPreConfirmActions(ref));\n\t\t}\n\n\t\t// If contribution disables default approvals, only return contribution actions\n\t\tif (contribution && contribution.canUseDefaultApprovals === false) {\n\t\t\treturn actions;\n\t\t}\n\n\t\t// Add default tool-level actions\n\t\tactions.push(\n\t\t\t{\n\t\t\t\tlabel: localize('allowSession', 'Allow in this Session'),\n\t\t\t\tdetail: localize('allowSessionTooltip', 'Allow this tool to run in this session without confirmation.'),\n\t\t\t\tdivider: !!actions.length,\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._preExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'session');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize('allowWorkspace', 'Allow in this Workspace'),\n\t\t\t\tdetail: localize('allowWorkspaceTooltip', 'Allow this tool to run in this workspace without confirmation.'),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._preExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'workspace');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize('allowGlobally', 'Always Allow'),\n\t\t\t\tdetail: localize('allowGloballyTooltip', 'Always allow this tool to run without confirmation.'),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._preExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'profile');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\t// Add server-level actions for MCP tools\n\t\tif (ref.source.type === 'mcp') {\n\t\t\tconst { serverLabel, definitionId } = ref.source;\n\t\t\tactions.push(\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerSession', 'Allow Tools from {0} in this Session', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerSessionTooltip', 'Allow all tools from this server to run in this session without confirmation.'),\n\t\t\t\t\tdivider: true,\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._preExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'session');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerWorkspace', 'Allow Tools from {0} in this Workspace', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerWorkspaceTooltip', 'Allow all tools from this server to run in this workspace without confirmation.'),\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._preExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'workspace');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerGlobally', 'Always Allow Tools from {0}', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerGloballyTooltip', 'Always allow all tools from this server to run without confirmation.'),\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._preExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'profile');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn actions;\n\t}\n\n\tgetPostConfirmActions(ref: ILanguageModelToolConfirmationRef): ILanguageModelToolConfirmationActions[] {\n\t\tconst actions: ILanguageModelToolConfirmationActions[] = [];\n\n\t\t// Add contribution actions first\n\t\tconst contribution = this._contributions.get(ref.toolId);\n\t\tif (contribution?.getPostConfirmActions) {\n\t\t\tactions.push(...contribution.getPostConfirmActions(ref));\n\t\t}\n\n\t\t// If contribution disables default approvals, only return contribution actions\n\t\tif (contribution && contribution.canUseDefaultApprovals === false) {\n\t\t\treturn actions;\n\t\t}\n\n\t\t// Add default tool-level actions\n\t\tactions.push(\n\t\t\t{\n\t\t\t\tlabel: localize('allowSessionPost', 'Allow Without Review in this Session'),\n\t\t\t\tdetail: localize('allowSessionPostTooltip', 'Allow results from this tool to be sent without confirmation in this session.'),\n\t\t\t\tdivider: !!actions.length,\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._postExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'session');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize('allowWorkspacePost', 'Allow Without Review in this Workspace'),\n\t\t\t\tdetail: localize('allowWorkspacePostTooltip', 'Allow results from this tool to be sent without confirmation in this workspace.'),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._postExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'workspace');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize('allowGloballyPost', 'Always Allow Without Review'),\n\t\t\t\tdetail: localize('allowGloballyPostTooltip', 'Always allow results from this tool to be sent without confirmation.'),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tthis._postExecutionToolConfirmStore.setAutoConfirmation(ref.toolId, 'profile');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\t// Add server-level actions for MCP tools\n\t\tif (ref.source.type === 'mcp') {\n\t\t\tconst { serverLabel, definitionId } = ref.source;\n\t\t\tactions.push(\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerSessionPost', 'Allow Tools from {0} Without Review in this Session', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerSessionPostTooltip', 'Allow results from all tools from this server to be sent without confirmation in this session.'),\n\t\t\t\t\tdivider: true,\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._postExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'session');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerWorkspacePost', 'Allow Tools from {0} Without Review in this Workspace', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerWorkspacePostTooltip', 'Allow results from all tools from this server to be sent without confirmation in this workspace.'),\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._postExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'workspace');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('allowServerGloballyPost', 'Always Allow Tools from {0} Without Review', serverLabel),\n\t\t\t\t\tdetail: localize('allowServerGloballyPostTooltip', 'Always allow results from all tools from this server to be sent without confirmation.'),\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tthis._postExecutionServerConfirmStore.setAutoConfirmation(definitionId, 'profile');\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn actions;\n\t}\n\n\tregisterConfirmationContribution(toolName: string, contribution: ILanguageModelToolConfirmationContribution): IDisposable {\n\t\tthis._contributions.set(toolName, contribution);\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis._contributions.delete(toolName);\n\t\t\t}\n\t\t};\n\t}\n\n\tmanageConfirmationPreferences(tools: Readonly<IToolData>[], options?: { defaultScope?: 'workspace' | 'profile' | 'session' }): void {\n\t\tinterface IToolTreeItem extends IQuickTreeItem {\n\t\t\ttype: 'tool' | 'server' | 'tool-pre' | 'tool-post' | 'server-pre' | 'server-post' | 'manage';\n\t\t\ttoolId?: string;\n\t\t\tserverId?: string;\n\t\t\tscope?: 'workspace' | 'profile';\n\t\t}\n\n\t\t// Helper to track tools under servers\n\t\tconst trackServerTool = (serverId: string, label: string, toolId: string, serversWithTools: Map<string, { label: string; tools: Set<string> }>) => {\n\t\t\tif (!serversWithTools.has(serverId)) {\n\t\t\t\tserversWithTools.set(serverId, { label, tools: new Set() });\n\t\t\t}\n\t\t\tserversWithTools.get(serverId)!.tools.add(toolId);\n\t\t};\n\n\t\t// Helper to add server tool from source\n\t\tconst addServerToolFromSource = (source: ToolDataSource, toolId: string, serversWithTools: Map<string, { label: string; tools: Set<string> }>) => {\n\t\t\tif (source.type === 'mcp') {\n\t\t\t\ttrackServerTool(source.definitionId, source.serverLabel || source.label, toolId, serversWithTools);\n\t\t\t} else if (source.type === 'extension') {\n\t\t\t\ttrackServerTool(source.extensionId.value, source.label, toolId, serversWithTools);\n\t\t\t}\n\t\t};\n\n\t\t// Determine which tools should be shown\n\t\tconst relevantTools = new Set<string>();\n\t\tconst serversWithTools = new Map<string, { label: string; tools: Set<string> }>();\n\n\t\t// Add tools that request approval\n\t\tfor (const tool of tools) {\n\t\t\tif (tool.canRequestPreApproval || tool.canRequestPostApproval || this._contributions.has(tool.id)) {\n\t\t\t\trelevantTools.add(tool.id);\n\t\t\t\taddServerToolFromSource(tool.source, tool.id, serversWithTools);\n\t\t\t}\n\t\t}\n\n\t\t// Add tools that have stored approvals (but we can't display them without metadata)\n\t\tfor (const id of this._preExecutionToolConfirmStore.getAllConfirmed()) {\n\t\t\tif (!relevantTools.has(id)) {\n\t\t\t\t// Only add if we have the tool data\n\t\t\t\tconst tool = tools.find(t => t.id === id);\n\t\t\t\tif (tool) {\n\t\t\t\t\trelevantTools.add(id);\n\t\t\t\t\taddServerToolFromSource(tool.source, id, serversWithTools);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (const id of this._postExecutionToolConfirmStore.getAllConfirmed()) {\n\t\t\tif (!relevantTools.has(id)) {\n\t\t\t\t// Only add if we have the tool data\n\t\t\t\tconst tool = tools.find(t => t.id === id);\n\t\t\t\tif (tool) {\n\t\t\t\t\trelevantTools.add(id);\n\t\t\t\t\taddServerToolFromSource(tool.source, id, serversWithTools);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (relevantTools.size === 0) {\n\t\t\treturn; // Nothing to show\n\t\t}\n\n\t\t// Determine initial scope from options\n\t\tlet currentScope = options?.defaultScope ?? 'workspace';\n\n\t\t// Helper function to build tree items based on current scope\n\t\tconst buildTreeItems = (): IToolTreeItem[] => {\n\t\t\tconst treeItems: IToolTreeItem[] = [];\n\n\t\t\t// Add server nodes\n\t\t\tfor (const [serverId, serverInfo] of serversWithTools) {\n\t\t\t\tconst serverChildren: IToolTreeItem[] = [];\n\n\t\t\t\t// Add server-level controls as first children\n\t\t\t\tconst hasAnyPre = Array.from(serverInfo.tools).some(toolId => {\n\t\t\t\t\tconst tool = tools.find(t => t.id === toolId);\n\t\t\t\t\treturn tool?.canRequestPreApproval;\n\t\t\t\t});\n\t\t\t\tconst hasAnyPost = Array.from(serverInfo.tools).some(toolId => {\n\t\t\t\t\tconst tool = tools.find(t => t.id === toolId);\n\t\t\t\t\treturn tool?.canRequestPostApproval;\n\t\t\t\t});\n\n\t\t\t\tconst serverPreConfirmed = this._preExecutionServerConfirmStore.getAutoConfirmationIn(serverId, currentScope);\n\t\t\t\tconst serverPostConfirmed = this._postExecutionServerConfirmStore.getAutoConfirmationIn(serverId, currentScope);\n\n\t\t\t\t// Add individual tools from this server as children\n\t\t\t\tfor (const toolId of serverInfo.tools) {\n\t\t\t\t\tconst tool = tools.find(t => t.id === toolId);\n\t\t\t\t\tif (!tool) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst toolChildren: IToolTreeItem[] = [];\n\t\t\t\t\tconst hasPre = !serverPreConfirmed && (tool.canRequestPreApproval || this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope));\n\t\t\t\t\tconst hasPost = !serverPostConfirmed && (tool.canRequestPostApproval || this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope));\n\n\t\t\t\t\t// Add child items for granular control when both approval types exist\n\t\t\t\t\tif (hasPre && hasPost) {\n\t\t\t\t\t\ttoolChildren.push({\n\t\t\t\t\t\t\ttype: 'tool-pre',\n\t\t\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\t\t\tlabel: RUN_WITHOUT_APPROVAL,\n\t\t\t\t\t\t\tchecked: this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope)\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttoolChildren.push({\n\t\t\t\t\t\t\ttype: 'tool-post',\n\t\t\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\t\t\tlabel: CONTINUE_WITHOUT_REVIEWING_RESULTS,\n\t\t\t\t\t\t\tchecked: this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Tool item always has a checkbox\n\t\t\t\t\tconst preApproval = this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\t\t\t\t\tconst postApproval = this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\t\t\t\t\tlet checked: boolean | 'mixed';\n\t\t\t\t\tlet description: string | undefined;\n\n\t\t\t\t\tif (hasPre && hasPost) {\n\t\t\t\t\t\t// Both: checkbox is mixed if only one is enabled\n\t\t\t\t\t\tchecked = preApproval && postApproval ? true : (!preApproval && !postApproval ? false : 'mixed');\n\t\t\t\t\t} else if (hasPre) {\n\t\t\t\t\t\tchecked = preApproval;\n\t\t\t\t\t\tdescription = RUN_WITHOUT_APPROVAL;\n\t\t\t\t\t} else if (hasPost) {\n\t\t\t\t\t\tchecked = postApproval;\n\t\t\t\t\t\tdescription = CONTINUE_WITHOUT_REVIEWING_RESULTS;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tserverChildren.push({\n\t\t\t\t\t\ttype: 'tool',\n\t\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\t\tlabel: tool.displayName || tool.id,\n\t\t\t\t\t\tdescription,\n\t\t\t\t\t\tchecked,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tchildren: toolChildren.length > 0 ? toolChildren : undefined\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tserverChildren.sort((a, b) => a.label.localeCompare(b.label));\n\n\t\t\t\tif (hasAnyPost) {\n\t\t\t\t\tserverChildren.unshift({\n\t\t\t\t\t\ttype: 'server-post',\n\t\t\t\t\t\tserverId,\n\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.play),\n\t\t\t\t\t\tlabel: localize('continueWithoutReviewing', \"Continue without reviewing any tool results\"),\n\t\t\t\t\t\tchecked: serverPostConfirmed\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (hasAnyPre) {\n\t\t\t\t\tserverChildren.unshift({\n\t\t\t\t\t\ttype: 'server-pre',\n\t\t\t\t\t\tserverId,\n\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.play),\n\t\t\t\t\t\tlabel: localize('runToolsWithoutApproval', \"Run any tool without approval\"),\n\t\t\t\t\t\tchecked: serverPreConfirmed\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Server node has checkbox to control both pre and post\n\t\t\t\tconst serverHasPre = this._preExecutionServerConfirmStore.getAutoConfirmationIn(serverId, currentScope);\n\t\t\t\tconst serverHasPost = this._postExecutionServerConfirmStore.getAutoConfirmationIn(serverId, currentScope);\n\t\t\t\tlet serverChecked: boolean | 'mixed';\n\t\t\t\tif (hasAnyPre && hasAnyPost) {\n\t\t\t\t\tserverChecked = serverHasPre && serverHasPost ? true : (!serverHasPre && !serverHasPost ? false : 'mixed');\n\t\t\t\t} else if (hasAnyPre) {\n\t\t\t\t\tserverChecked = serverHasPre;\n\t\t\t\t} else if (hasAnyPost) {\n\t\t\t\t\tserverChecked = serverHasPost;\n\t\t\t\t} else {\n\t\t\t\t\tserverChecked = false;\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = quickTree.itemTree.find(i => i.serverId === serverId);\n\t\t\t\ttreeItems.push({\n\t\t\t\t\ttype: 'server',\n\t\t\t\t\tserverId,\n\t\t\t\t\tlabel: serverInfo.label,\n\t\t\t\t\tchecked: serverChecked,\n\t\t\t\t\tchildren: serverChildren,\n\t\t\t\t\tcollapsed: existingItem ? quickTree.isCollapsed(existingItem) : true,\n\t\t\t\t\tpickable: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Add individual tool nodes (only for non-MCP/extension tools)\n\t\t\tconst sortedTools = tools.slice().sort((a, b) => a.displayName.localeCompare(b.displayName));\n\t\t\tfor (const tool of sortedTools) {\n\t\t\t\tif (!relevantTools.has(tool.id)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Skip tools that belong to MCP/extension servers (they're shown under server nodes)\n\t\t\t\tif (tool.source.type === 'mcp' || tool.source.type === 'extension') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst contributed = this._contributions.get(tool.id);\n\t\t\t\tconst toolChildren: IToolTreeItem[] = [];\n\n\t\t\t\tconst manageActions = contributed?.getManageActions?.();\n\t\t\t\tif (manageActions) {\n\t\t\t\t\ttoolChildren.push(...manageActions.map(action => ({\n\t\t\t\t\t\ttype: 'manage' as const,\n\t\t\t\t\t\t...action,\n\t\t\t\t\t})));\n\t\t\t\t}\n\n\n\t\t\t\tlet checked: boolean | 'mixed' = false;\n\t\t\t\tlet description: string | undefined;\n\t\t\t\tlet pickable = false;\n\n\t\t\t\tif (contributed?.canUseDefaultApprovals !== false) {\n\t\t\t\t\tpickable = true;\n\t\t\t\t\tconst hasPre = tool.canRequestPreApproval || this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\t\t\t\t\tconst hasPost = tool.canRequestPostApproval || this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\n\t\t\t\t\t// Add child items for granular control when both approval types exist\n\t\t\t\t\tif (hasPre && hasPost) {\n\t\t\t\t\t\ttoolChildren.push({\n\t\t\t\t\t\t\ttype: 'tool-pre',\n\t\t\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\t\t\tlabel: RUN_WITHOUT_APPROVAL,\n\t\t\t\t\t\t\tchecked: this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope)\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttoolChildren.push({\n\t\t\t\t\t\t\ttype: 'tool-post',\n\t\t\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\t\t\tlabel: CONTINUE_WITHOUT_REVIEWING_RESULTS,\n\t\t\t\t\t\t\tchecked: this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Tool item always has a checkbox\n\t\t\t\t\tconst preApproval = this._preExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\t\t\t\t\tconst postApproval = this._postExecutionToolConfirmStore.getAutoConfirmationIn(tool.id, currentScope);\n\n\t\t\t\t\tif (hasPre && hasPost) {\n\t\t\t\t\t\t// Both: checkbox is mixed if only one is enabled\n\t\t\t\t\t\tchecked = preApproval && postApproval ? true : (!preApproval && !postApproval ? false : 'mixed');\n\t\t\t\t\t} else if (hasPre) {\n\t\t\t\t\t\tchecked = preApproval;\n\t\t\t\t\t\tdescription = RUN_WITHOUT_APPROVAL;\n\t\t\t\t\t} else if (hasPost) {\n\t\t\t\t\t\tchecked = postApproval;\n\t\t\t\t\t\tdescription = CONTINUE_WITHOUT_REVIEWING_RESULTS;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// No approval capabilities - shouldn't happen but handle it\n\t\t\t\t\t\tchecked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttreeItems.push({\n\t\t\t\t\ttype: 'tool',\n\t\t\t\t\ttoolId: tool.id,\n\t\t\t\t\tlabel: tool.displayName || tool.id,\n\t\t\t\t\tdescription,\n\t\t\t\t\tchecked,\n\t\t\t\t\tpickable,\n\t\t\t\t\tcollapsed: true,\n\t\t\t\t\tchildren: toolChildren.length > 0 ? toolChildren : undefined\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn treeItems;\n\t\t};\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst quickTree = disposables.add(this._quickInputService.createQuickTree<IToolTreeItem>());\n\t\tquickTree.ignoreFocusOut = true;\n\t\tquickTree.sortByLabel = false;\n\n\t\t// Only show toggle if not in session scope\n\t\tif (currentScope !== 'session') {\n\t\t\tconst scopeToggle = disposables.add(new Toggle({\n\t\t\t\ttitle: localize('workspaceScope', \"Configure for this workspace only\"),\n\t\t\t\ticon: Codicon.folder,\n\t\t\t\tisChecked: currentScope === 'workspace',\n\t\t\t\tinputActiveOptionBorder: asCssVariable(inputActiveOptionBorder),\n\t\t\t\tinputActiveOptionForeground: asCssVariable(inputActiveOptionForeground),\n\t\t\t\tinputActiveOptionBackground: asCssVariable(inputActiveOptionBackground)\n\t\t\t}));\n\t\t\tquickTree.toggles = [scopeToggle];\n\t\t\tdisposables.add(scopeToggle.onChange(() => {\n\t\t\t\tcurrentScope = currentScope === 'workspace' ? 'profile' : 'workspace';\n\t\t\t\tupdatePlaceholder();\n\t\t\t\tquickTree.setItemTree(buildTreeItems());\n\t\t\t}));\n\t\t}\n\n\t\tconst updatePlaceholder = () => {\n\t\t\tif (currentScope === 'session') {\n\t\t\t\tquickTree.placeholder = localize('configureSessionToolApprovals', \"Configure session tool approvals\");\n\t\t\t} else {\n\t\t\t\tquickTree.placeholder = currentScope === 'workspace'\n\t\t\t\t\t? localize('configureWorkspaceToolApprovals', \"Configure workspace tool approvals\")\n\t\t\t\t\t: localize('configureGlobalToolApprovals', \"Configure global tool approvals\");\n\t\t\t}\n\t\t};\n\t\tupdatePlaceholder();\n\n\t\tquickTree.setItemTree(buildTreeItems());\n\n\t\tdisposables.add(quickTree.onDidChangeCheckboxState(item => {\n\t\t\tconst newState = item.checked ? currentScope : 'never';\n\n\t\t\tif (item.type === 'server' && item.serverId) {\n\t\t\t\t// Server-level checkbox: update both pre and post based on server capabilities\n\t\t\t\tconst serverInfo = serversWithTools.get(item.serverId);\n\t\t\t\tif (serverInfo) {\n\t\t\t\t\tthis._preExecutionServerConfirmStore.setAutoConfirmation(item.serverId, newState);\n\t\t\t\t\tthis._postExecutionServerConfirmStore.setAutoConfirmation(item.serverId, newState);\n\t\t\t\t}\n\t\t\t} else if (item.type === 'tool' && item.toolId) {\n\t\t\t\tconst tool = tools.find(t => t.id === item.toolId);\n\t\t\t\tif (tool?.canRequestPostApproval || newState === 'never') {\n\t\t\t\t\tthis._postExecutionToolConfirmStore.setAutoConfirmation(item.toolId, newState);\n\t\t\t\t}\n\t\t\t\tif (tool?.canRequestPreApproval || newState === 'never') {\n\t\t\t\t\tthis._preExecutionToolConfirmStore.setAutoConfirmation(item.toolId, newState);\n\t\t\t\t}\n\t\t\t} else if (item.type === 'tool-pre' && item.toolId) {\n\t\t\t\tthis._preExecutionToolConfirmStore.setAutoConfirmation(item.toolId, newState);\n\t\t\t} else if (item.type === 'tool-post' && item.toolId) {\n\t\t\t\tthis._postExecutionToolConfirmStore.setAutoConfirmation(item.toolId, newState);\n\t\t\t} else if (item.type === 'server-pre' && item.serverId) {\n\t\t\t\tthis._preExecutionServerConfirmStore.setAutoConfirmation(item.serverId, newState);\n\t\t\t\tquickTree.setItemTree(buildTreeItems());\n\t\t\t} else if (item.type === 'server-post' && item.serverId) {\n\t\t\t\tthis._postExecutionServerConfirmStore.setAutoConfirmation(item.serverId, newState);\n\t\t\t\tquickTree.setItemTree(buildTreeItems());\n\t\t\t} else if (item.type === 'manage') {\n\t\t\t\t(item as ILanguageModelToolConfirmationContributionQuickTreeItem).onDidChangeChecked?.(!!item.checked);\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(quickTree.onDidTriggerItemButton(i => {\n\t\t\tif (i.item.type === 'manage') {\n\t\t\t\t(i.item as ILanguageModelToolConfirmationContributionQuickTreeItem).onDidTriggerItemButton?.(i.button);\n\t\t\t}\n\t\t}));\n\n\t\tdisposables.add(quickTree.onDidAccept(() => {\n\t\t\tfor (const item of quickTree.activeItems) {\n\t\t\t\tif (item.type === 'manage') {\n\t\t\t\t\t(item as ILanguageModelToolConfirmationContributionQuickTreeItem).onDidOpen?.();\n\t\t\t\t}\n\t\t\t}\n\t\t\tquickTree.hide();\n\t\t}));\n\n\t\tdisposables.add(quickTree.onDidHide(() => {\n\t\t\tdisposables.dispose();\n\t\t}));\n\n\t\tquickTree.show();\n\t}\n\n\tpublic resetToolAutoConfirmation(): void {\n\t\tthis._preExecutionToolConfirmStore.reset();\n\t\tthis._postExecutionToolConfirmStore.reset();\n\t\tthis._preExecutionServerConfirmStore.reset();\n\t\tthis._postExecutionServerConfirmStore.reset();\n\n\t\t// Reset all contributions\n\t\tfor (const contribution of this._contributions.values()) {\n\t\t\tcontribution.reset?.();\n\t\t}\n\t}\n}\n"]}