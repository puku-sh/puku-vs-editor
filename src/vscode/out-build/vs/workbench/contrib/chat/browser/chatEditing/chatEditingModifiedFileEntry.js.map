{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatEditing/chatEditingModifiedFileEntry.ts"],"names":[],"mappings":"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","file":"chatEditingModifiedFileEntry.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { RunOnceScheduler } from '../../../../../base/common/async.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableMap, MutableDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { clamp } from '../../../../../base/common/numbers.js';\nimport { autorun, derived, IObservable, ITransaction, observableValue, observableValueOpts, transaction } from '../../../../../base/common/observable.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Location, TextEdit } from '../../../../../editor/common/languages.js';\nimport { EditDeltaInfo } from '../../../../../editor/common/textModelEditSource.js';\nimport { localize } from '../../../../../nls.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { observableConfigValue } from '../../../../../platform/observable/common/platformObservableUtils.js';\nimport { editorBackground, registerColor, transparent } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { IUndoRedoElement, IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { IEditorPane } from '../../../../common/editor.js';\nimport { IFilesConfigurationService } from '../../../../services/filesConfiguration/common/filesConfigurationService.js';\nimport { IAiEditTelemetryService } from '../../../editTelemetry/browser/telemetry/aiEditTelemetry/aiEditTelemetryService.js';\nimport { ICellEditOperation } from '../../../notebook/common/notebookCommon.js';\nimport { ChatEditKind, IModifiedEntryTelemetryInfo, IModifiedFileEntry, IModifiedFileEntryEditorIntegration, ISnapshotEntry, ModifiedFileEntryState } from '../../common/chatEditingService.js';\nimport { IChatResponseModel } from '../../common/chatModel.js';\nimport { ChatUserAction, IChatService } from '../../common/chatService.js';\n\nclass AutoAcceptControl {\n\tconstructor(\n\t\treadonly total: number,\n\t\treadonly remaining: number,\n\t\treadonly cancel: () => void\n\t) { }\n}\n\nexport const pendingRewriteMinimap = registerColor('minimap.chatEditHighlight',\n\ttransparent(editorBackground, 0.6),\n\tlocalize('editorSelectionBackground', \"Color of pending edit regions in the minimap\"));\n\n\nexport abstract class AbstractChatEditingModifiedFileEntry extends Disposable implements IModifiedFileEntry {\n\n\tstatic readonly scheme = 'modified-file-entry';\n\n\tprivate static lastEntryId = 0;\n\n\treadonly entryId = `${AbstractChatEditingModifiedFileEntry.scheme}::${++AbstractChatEditingModifiedFileEntry.lastEntryId}`;\n\n\tprotected readonly _onDidDelete = this._register(new Emitter<void>());\n\treadonly onDidDelete = this._onDidDelete.event;\n\n\tprotected readonly _stateObs = observableValue<ModifiedFileEntryState>(this, ModifiedFileEntryState.Modified);\n\treadonly state: IObservable<ModifiedFileEntryState> = this._stateObs;\n\n\tprotected readonly _waitsForLastEdits = observableValue<boolean>(this, false);\n\treadonly waitsForLastEdits: IObservable<boolean> = this._waitsForLastEdits;\n\n\tprotected readonly _isCurrentlyBeingModifiedByObs = observableValue<{ responseModel: IChatResponseModel; undoStopId: string | undefined } | undefined>(this, undefined);\n\treadonly isCurrentlyBeingModifiedBy: IObservable<{ responseModel: IChatResponseModel; undoStopId: string | undefined } | undefined> = this._isCurrentlyBeingModifiedByObs;\n\n\t/**\n\t * Flag to track if we're currently in an external edit operation.\n\t * When true, file system changes should be treated as agent edits, not user edits.\n\t */\n\tprotected _isExternalEditInProgress = false;\n\n\tprotected readonly _lastModifyingResponseObs = observableValueOpts<IChatResponseModel | undefined>({ equalsFn: (a, b) => a?.requestId === b?.requestId }, undefined);\n\treadonly lastModifyingResponse: IObservable<IChatResponseModel | undefined> = this._lastModifyingResponseObs;\n\n\tprotected readonly _lastModifyingResponseInProgressObs = this._lastModifyingResponseObs.map((value, r) => {\n\t\treturn value?.isInProgress.read(r) ?? false;\n\t});\n\n\tprotected readonly _rewriteRatioObs = observableValue<number>(this, 0);\n\treadonly rewriteRatio: IObservable<number> = this._rewriteRatioObs;\n\n\tprivate readonly _reviewModeTempObs = observableValue<true | undefined>(this, undefined);\n\treadonly reviewMode: IObservable<boolean>;\n\n\tprivate readonly _autoAcceptCtrl = observableValue<AutoAcceptControl | undefined>(this, undefined);\n\treadonly autoAcceptController: IObservable<AutoAcceptControl | undefined> = this._autoAcceptCtrl;\n\n\tprotected readonly _autoAcceptTimeout: IObservable<number>;\n\n\tget telemetryInfo(): IModifiedEntryTelemetryInfo {\n\t\treturn this._telemetryInfo;\n\t}\n\n\treadonly createdInRequestId: string | undefined;\n\n\tget lastModifyingRequestId() {\n\t\treturn this._telemetryInfo.requestId;\n\t}\n\n\tprivate _refCounter: number = 1;\n\n\treadonly abstract originalURI: URI;\n\n\tprotected readonly _userEditScheduler = this._register(new RunOnceScheduler(() => this._notifySessionAction('userModified'), 1000));\n\n\tconstructor(\n\t\treadonly modifiedURI: URI,\n\t\tprotected _telemetryInfo: IModifiedEntryTelemetryInfo,\n\t\tkind: ChatEditKind,\n\t\t@IConfigurationService configService: IConfigurationService,\n\t\t@IFilesConfigurationService protected _fileConfigService: IFilesConfigurationService,\n\t\t@IChatService protected readonly _chatService: IChatService,\n\t\t@IFileService protected readonly _fileService: IFileService,\n\t\t@IUndoRedoService private readonly _undoRedoService: IUndoRedoService,\n\t\t@IInstantiationService protected readonly _instantiationService: IInstantiationService,\n\t\t@IAiEditTelemetryService private readonly _aiEditTelemetryService: IAiEditTelemetryService,\n\t) {\n\t\tsuper();\n\n\t\tif (kind === ChatEditKind.Created) {\n\t\t\tthis.createdInRequestId = this._telemetryInfo.requestId;\n\t\t}\n\n\t\tif (this.modifiedURI.scheme !== Schemas.untitled && this.modifiedURI.scheme !== Schemas.vscodeNotebookCell) {\n\t\t\tthis._register(this._fileService.watch(this.modifiedURI));\n\t\t\tthis._register(this._fileService.onDidFilesChange(e => {\n\t\t\t\tif (e.affects(this.modifiedURI) && kind === ChatEditKind.Created && e.gotDeleted()) {\n\t\t\t\t\tthis._onDidDelete.fire();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\t// review mode depends on setting and temporary override\n\t\tconst autoAcceptRaw = observableConfigValue('chat.editing.autoAcceptDelay', 0, configService);\n\t\tthis._autoAcceptTimeout = derived(r => {\n\t\t\tconst value = autoAcceptRaw.read(r);\n\t\t\treturn clamp(value, 0, 100);\n\t\t});\n\t\tthis.reviewMode = derived(r => {\n\t\t\tconst configuredValue = this._autoAcceptTimeout.read(r);\n\t\t\tconst tempValue = this._reviewModeTempObs.read(r);\n\t\t\treturn tempValue ?? configuredValue === 0;\n\t\t});\n\n\t\tthis._store.add(toDisposable(() => this._lastModifyingResponseObs.set(undefined, undefined)));\n\n\t\tconst autoSaveOff = this._store.add(new MutableDisposable());\n\t\tthis._store.add(autorun(r => {\n\t\t\tif (this._waitsForLastEdits.read(r)) {\n\t\t\t\tautoSaveOff.value = _fileConfigService.disableAutoSave(this.modifiedURI);\n\t\t\t} else {\n\t\t\t\tautoSaveOff.clear();\n\t\t\t}\n\t\t}));\n\n\t\tthis._store.add(autorun(r => {\n\t\t\tconst inProgress = this._lastModifyingResponseInProgressObs.read(r);\n\t\t\tif (inProgress === false && !this.reviewMode.read(r)) {\n\t\t\t\t// AUTO accept mode (when request is done)\n\n\t\t\t\tconst acceptTimeout = this._autoAcceptTimeout.read(undefined) * 1000;\n\t\t\t\tconst future = Date.now() + acceptTimeout;\n\t\t\t\tconst update = () => {\n\n\t\t\t\t\tconst reviewMode = this.reviewMode.read(undefined);\n\t\t\t\t\tif (reviewMode) {\n\t\t\t\t\t\t// switched back to review mode\n\t\t\t\t\t\tthis._autoAcceptCtrl.set(undefined, undefined);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst remain = Math.round(future - Date.now());\n\t\t\t\t\tif (remain <= 0) {\n\t\t\t\t\t\tthis.accept();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst handle = setTimeout(update, 100);\n\t\t\t\t\t\tthis._autoAcceptCtrl.set(new AutoAcceptControl(acceptTimeout, remain, () => {\n\t\t\t\t\t\t\tclearTimeout(handle);\n\t\t\t\t\t\t\tthis._autoAcceptCtrl.set(undefined, undefined);\n\t\t\t\t\t\t}), undefined);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tupdate();\n\t\t\t}\n\t\t}));\n\t}\n\n\toverride dispose(): void {\n\t\tif (--this._refCounter === 0) {\n\t\t\tsuper.dispose();\n\t\t}\n\t}\n\n\tpublic abstract hasModificationAt(location: Location): boolean;\n\n\tacquire() {\n\t\tthis._refCounter++;\n\t\treturn this;\n\t}\n\n\tenableReviewModeUntilSettled(): void {\n\n\t\tif (this.state.get() !== ModifiedFileEntryState.Modified) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\n\t\tthis._reviewModeTempObs.set(true, undefined);\n\n\t\tconst cleanup = autorun(r => {\n\t\t\t// reset config when settled\n\t\t\tconst resetConfig = this.state.read(r) !== ModifiedFileEntryState.Modified;\n\t\t\tif (resetConfig) {\n\t\t\t\tthis._store.delete(cleanup);\n\t\t\t\tthis._reviewModeTempObs.set(undefined, undefined);\n\t\t\t}\n\t\t});\n\n\t\tthis._store.add(cleanup);\n\t}\n\n\tupdateTelemetryInfo(telemetryInfo: IModifiedEntryTelemetryInfo) {\n\t\tthis._telemetryInfo = telemetryInfo;\n\t}\n\n\tasync accept(): Promise<void> {\n\t\tconst callback = await this.acceptDeferred();\n\t\tif (callback) {\n\t\t\ttransaction(callback);\n\t\t}\n\t}\n\n\t/** Accepts and returns a function used to transition the state. This MUST be called by the consumer. */\n\tasync acceptDeferred(): Promise<((tx: ITransaction) => void) | undefined> {\n\t\tif (this._stateObs.get() !== ModifiedFileEntryState.Modified) {\n\t\t\t// already accepted or rejected\n\t\t\treturn;\n\t\t}\n\n\t\tawait this._doAccept();\n\n\t\treturn (tx: ITransaction) => {\n\t\t\tthis._stateObs.set(ModifiedFileEntryState.Accepted, tx);\n\t\t\tthis._autoAcceptCtrl.set(undefined, tx);\n\t\t\tthis._notifySessionAction('accepted');\n\t\t};\n\t}\n\n\tprotected abstract _doAccept(): Promise<void>;\n\n\tasync reject(): Promise<void> {\n\t\tconst callback = await this.rejectDeferred();\n\t\tif (callback) {\n\t\t\ttransaction(callback);\n\t\t}\n\t}\n\n\t/** Rejects and returns a function used to transition the state. This MUST be called by the consumer. */\n\tasync rejectDeferred(): Promise<((tx: ITransaction) => void) | undefined> {\n\t\tif (this._stateObs.get() !== ModifiedFileEntryState.Modified) {\n\t\t\t// already accepted or rejected\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._notifySessionAction('rejected');\n\t\tawait this._doReject();\n\n\t\treturn (tx: ITransaction) => {\n\t\t\tthis._stateObs.set(ModifiedFileEntryState.Rejected, tx);\n\t\t\tthis._autoAcceptCtrl.set(undefined, tx);\n\t\t};\n\t}\n\n\tprotected abstract _doReject(): Promise<void>;\n\n\tprotected _notifySessionAction(outcome: 'accepted' | 'rejected' | 'userModified') {\n\t\tthis._notifyAction({ kind: 'chatEditingSessionAction', uri: this.modifiedURI, hasRemainingEdits: false, outcome });\n\t}\n\n\tprotected _notifyAction(action: ChatUserAction) {\n\t\tif (action.kind === 'chatEditingHunkAction') {\n\t\t\tthis._aiEditTelemetryService.handleCodeAccepted({\n\t\t\t\tsuggestionId: undefined, // TODO@hediet try to figure this out\n\t\t\t\tacceptanceMethod: 'accept',\n\t\t\t\tpresentation: 'highlightedEdit',\n\t\t\t\tmodelId: this._telemetryInfo.modelId,\n\t\t\t\tmodeId: this._telemetryInfo.modeId,\n\t\t\t\tapplyCodeBlockSuggestionId: this._telemetryInfo.applyCodeBlockSuggestionId,\n\t\t\t\teditDeltaInfo: new EditDeltaInfo(\n\t\t\t\t\taction.linesAdded,\n\t\t\t\t\taction.linesRemoved,\n\t\t\t\t\t-1,\n\t\t\t\t\t-1,\n\t\t\t\t),\n\t\t\t\tfeature: this._telemetryInfo.feature,\n\t\t\t\tlanguageId: action.languageId,\n\t\t\t\tsource: undefined,\n\t\t\t});\n\t\t}\n\n\t\tthis._chatService.notifyUserAction({\n\t\t\taction,\n\t\t\tagentId: this._telemetryInfo.agentId,\n\t\t\tmodelId: this._telemetryInfo.modelId,\n\t\t\tmodeId: this._telemetryInfo.modeId,\n\t\t\tcommand: this._telemetryInfo.command,\n\t\t\tsessionResource: this._telemetryInfo.sessionResource,\n\t\t\trequestId: this._telemetryInfo.requestId,\n\t\t\tresult: this._telemetryInfo.result\n\t\t});\n\t}\n\n\tprivate readonly _editorIntegrations = this._register(new DisposableMap<IEditorPane, IModifiedFileEntryEditorIntegration>());\n\n\tgetEditorIntegration(pane: IEditorPane): IModifiedFileEntryEditorIntegration {\n\t\tlet value = this._editorIntegrations.get(pane);\n\t\tif (!value) {\n\t\t\tvalue = this._createEditorIntegration(pane);\n\t\t\tthis._editorIntegrations.set(pane, value);\n\t\t}\n\t\treturn value;\n\t}\n\n\t/**\n\t * Create the editor integration for this entry and the given editor pane. This will only be called\n\t * once (and cached) per pane. The integration is meant to be scoped to this entry only and when the\n\t * passed pane/editor changes input, then the editor integration must handle that, e.g use default/null\n\t * values\n\t */\n\tprotected abstract _createEditorIntegration(editor: IEditorPane): IModifiedFileEntryEditorIntegration;\n\n\tabstract readonly changesCount: IObservable<number>;\n\n\tacceptStreamingEditsStart(responseModel: IChatResponseModel, undoStopId: string | undefined, tx: ITransaction | undefined) {\n\t\tthis._resetEditsState(tx);\n\t\tthis._isCurrentlyBeingModifiedByObs.set({ responseModel, undoStopId }, tx);\n\t\tthis._lastModifyingResponseObs.set(responseModel, tx);\n\t\tthis._autoAcceptCtrl.get()?.cancel();\n\n\t\tconst undoRedoElement = this._createUndoRedoElement(responseModel);\n\t\tif (undoRedoElement) {\n\t\t\tthis._undoRedoService.pushElement(undoRedoElement);\n\t\t}\n\t}\n\n\tprotected abstract _createUndoRedoElement(response: IChatResponseModel): IUndoRedoElement | undefined;\n\n\tabstract acceptAgentEdits(uri: URI, edits: (TextEdit | ICellEditOperation)[], isLastEdits: boolean, responseModel: IChatResponseModel | undefined): Promise<void>;\n\n\tasync acceptStreamingEditsEnd() {\n\t\tthis._resetEditsState(undefined);\n\n\t\tif (await this._areOriginalAndModifiedIdentical()) {\n\t\t\t// ACCEPT if identical\n\t\t\tawait this.accept();\n\t\t}\n\t}\n\n\tprotected abstract _areOriginalAndModifiedIdentical(): Promise<boolean>;\n\n\tprotected _resetEditsState(tx: ITransaction | undefined): void {\n\t\tthis._isCurrentlyBeingModifiedByObs.set(undefined, tx);\n\t\tthis._rewriteRatioObs.set(0, tx);\n\t\tthis._waitsForLastEdits.set(false, tx);\n\t}\n\n\t// --- snapshot\n\n\tabstract createSnapshot(chatSessionResource: URI, requestId: string | undefined, undoStop: string | undefined): ISnapshotEntry;\n\n\tabstract equalsSnapshot(snapshot: ISnapshotEntry | undefined): boolean;\n\n\tabstract restoreFromSnapshot(snapshot: ISnapshotEntry, restoreToDisk?: boolean): Promise<void>;\n\n\t// --- inital content\n\n\tabstract resetToInitialContent(): Promise<void>;\n\n\tabstract initialContent: string;\n\n\t/**\n\t * Computes the edits between two snapshots of the file content.\n\t * @param beforeSnapshot The content before the changes\n\t * @param afterSnapshot The content after the changes\n\t * @returns Array of text edits or cell edit operations\n\t */\n\tabstract computeEditsFromSnapshots(beforeSnapshot: string, afterSnapshot: string): Promise<(TextEdit | ICellEditOperation)[]>;\n\n\t/**\n\t * Marks the start of an external edit operation.\n\t * File system changes will be treated as agent edits until stopExternalEdit is called.\n\t */\n\tstartExternalEdit(): void {\n\t\tthis._isExternalEditInProgress = true;\n\t}\n\n\t/**\n\t * Marks the end of an external edit operation.\n\t */\n\tstopExternalEdit(): void {\n\t\tthis._isExternalEditInProgress = false;\n\t}\n\n\t/**\n\t * Saves the current model state to disk.\n\t */\n\tabstract save(): Promise<void>;\n\n\t/**\n\t * Reloads the model from disk to ensure it's in sync with file system changes.\n\t */\n\tabstract revertToDisk(): Promise<void>;\n}\n"]}