{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatContentParts/chatAttachmentsContentPart.ts","vs/workbench/contrib/chat/browser/chatContentParts/chatAttachmentsContentPart.ts"],"names":[],"mappings":"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","file":"chatAttachmentsContentPart.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../../base/common/path.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ResourceLabels } from '../../../../browser/labels.js';\nimport { IChatRequestVariableEntry, isElementVariableEntry, isImageVariableEntry, isNotebookOutputVariableEntry, isPasteVariableEntry, isPromptFileVariableEntry, isPromptTextVariableEntry, isSCMHistoryItemChangeRangeVariableEntry, isSCMHistoryItemChangeVariableEntry, isSCMHistoryItemVariableEntry, isTerminalVariableEntry, isWorkspaceVariableEntry, OmittedState } from '../../common/chatVariableEntries.js';\nimport { ChatResponseReferencePartStatusKind, IChatContentReference } from '../../common/chatService.js';\nimport { DefaultChatAttachmentWidget, ElementChatAttachmentWidget, FileAttachmentWidget, ImageAttachmentWidget, NotebookCellOutputChatAttachmentWidget, PasteAttachmentWidget, PromptFileAttachmentWidget, PromptTextAttachmentWidget, SCMHistoryItemAttachmentWidget, SCMHistoryItemChangeAttachmentWidget, SCMHistoryItemChangeRangeAttachmentWidget, TerminalCommandAttachmentWidget, ToolSetOrToolItemAttachmentWidget } from '../chatAttachmentWidgets.js';\n\nexport interface IChatAttachmentsContentPartOptions {\n\treadonly variables: IChatRequestVariableEntry[];\n\treadonly contentReferences?: ReadonlyArray<IChatContentReference>;\n\treadonly domNode?: HTMLElement;\n\treadonly limit?: number;\n}\n\nexport class ChatAttachmentsContentPart extends Disposable {\n\tprivate readonly attachedContextDisposables = this._register(new DisposableStore());\n\n\tprivate readonly _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\tprivate readonly _contextResourceLabels: ResourceLabels;\n\tprivate _showingAll = false;\n\n\tprivate readonly variables: IChatRequestVariableEntry[];\n\tprivate readonly contentReferences: ReadonlyArray<IChatContentReference>;\n\tprivate readonly limit?: number;\n\tpublic readonly domNode: HTMLElement | undefined;\n\n\tpublic contextMenuHandler?: (attachment: IChatRequestVariableEntry, event: MouseEvent) => void;\n\n\tconstructor(\n\t\toptions: IChatAttachmentsContentPartOptions,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis.variables = options.variables;\n\t\tthis.contentReferences = options.contentReferences ?? [];\n\t\tthis.limit = options.limit;\n\t\tthis.domNode = options.domNode ?? dom.$('.chat-attached-context');\n\n\t\tthis._contextResourceLabels = this._register(this.instantiationService.createInstance(ResourceLabels, { onDidChangeVisibility: this._onDidChangeVisibility.event }));\n\n\t\tthis.initAttachedContext(this.domNode);\n\t\tif (!this.domNode.childElementCount) {\n\t\t\tthis.domNode = undefined;\n\t\t}\n\t}\n\n\tprivate initAttachedContext(container: HTMLElement) {\n\t\tdom.clearNode(container);\n\t\tthis.attachedContextDisposables.clear();\n\n\t\tconst visibleAttachments = this.getVisibleAttachments();\n\t\tconst hasMoreAttachments = this.limit && this.variables.length > this.limit && !this._showingAll;\n\n\t\tfor (const attachment of visibleAttachments) {\n\t\t\tthis.renderAttachment(attachment, container);\n\t\t}\n\n\t\tif (hasMoreAttachments) {\n\t\t\tthis.renderShowMoreButton(container);\n\t\t}\n\t}\n\n\tprivate getVisibleAttachments(): IChatRequestVariableEntry[] {\n\t\tif (!this.limit || this._showingAll) {\n\t\t\treturn this.variables;\n\t\t}\n\t\treturn this.variables.slice(0, this.limit);\n\t}\n\n\tprivate renderShowMoreButton(container: HTMLElement) {\n\t\tconst remainingCount = this.variables.length - (this.limit ?? 0);\n\n\t\t// Create a button that looks like the attachment pills\n\t\tconst showMoreButton = dom.$('div.chat-attached-context-attachment.chat-attachments-show-more-button');\n\t\tshowMoreButton.setAttribute('role', 'button');\n\t\tshowMoreButton.setAttribute('tabindex', '0');\n\t\tshowMoreButton.style.cursor = 'pointer';\n\n\t\t// Add pill icon (ellipsis)\n\t\tconst pillIcon = dom.$('div.chat-attached-context-pill', {}, dom.$('span.codicon.codicon-ellipsis'));\n\n\t\t// Add text label\n\t\tconst textLabel = dom.$('span.chat-attached-context-custom-text');\n\t\ttextLabel.textContent = `${remainingCount} more`;\n\n\t\tshowMoreButton.appendChild(pillIcon);\n\t\tshowMoreButton.appendChild(textLabel);\n\n\t\t// Add click and keyboard event handlers\n\t\tconst clickHandler = () => {\n\t\t\tthis._showingAll = true;\n\t\t\tthis.initAttachedContext(container);\n\t\t};\n\n\t\tthis.attachedContextDisposables.add(dom.addDisposableListener(showMoreButton, 'click', clickHandler));\n\t\tthis.attachedContextDisposables.add(dom.addDisposableListener(showMoreButton, 'keydown', (e) => {\n\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\te.preventDefault();\n\t\t\t\tclickHandler();\n\t\t\t}\n\t\t}));\n\n\t\tcontainer.appendChild(showMoreButton);\n\t\tthis.attachedContextDisposables.add({ dispose: () => showMoreButton.remove() });\n\t}\n\n\tprivate renderAttachment(attachment: IChatRequestVariableEntry, container: HTMLElement) {\n\t\tconst resource = URI.isUri(attachment.value) ? attachment.value : attachment.value && typeof attachment.value === 'object' && 'uri' in attachment.value && URI.isUri(attachment.value.uri) ? attachment.value.uri : undefined;\n\t\tconst range = attachment.value && typeof attachment.value === 'object' && 'range' in attachment.value && Range.isIRange(attachment.value.range) ? attachment.value.range : undefined;\n\t\tconst correspondingContentReference = this.contentReferences.find((ref) => (typeof ref.reference === 'object' && 'variableName' in ref.reference && ref.reference.variableName === attachment.name) || (URI.isUri(ref.reference) && basename(ref.reference.path) === attachment.name));\n\t\tconst isAttachmentOmitted = correspondingContentReference?.options?.status?.kind === ChatResponseReferencePartStatusKind.Omitted;\n\t\tconst isAttachmentPartialOrOmitted = isAttachmentOmitted || correspondingContentReference?.options?.status?.kind === ChatResponseReferencePartStatusKind.Partial;\n\n\t\tlet widget;\n\t\tif (attachment.kind === 'tool' || attachment.kind === 'toolset') {\n\t\t\twidget = this.instantiationService.createInstance(ToolSetOrToolItemAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isElementVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(ElementChatAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isImageVariableEntry(attachment)) {\n\t\t\tattachment.omittedState = isAttachmentPartialOrOmitted ? OmittedState.Full : attachment.omittedState;\n\t\t\twidget = this.instantiationService.createInstance(ImageAttachmentWidget, resource, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPromptFileVariableEntry(attachment)) {\n\t\t\tif (attachment.automaticallyAdded) {\n\t\t\t\treturn; // Skip automatically added prompt files\n\t\t\t}\n\t\t\twidget = this.instantiationService.createInstance(PromptFileAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPromptTextVariableEntry(attachment)) {\n\t\t\tif (attachment.automaticallyAdded) {\n\t\t\t\treturn; // Skip automatically added prompt text\n\t\t\t}\n\t\t\twidget = this.instantiationService.createInstance(PromptTextAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (resource && (attachment.kind === 'file' || attachment.kind === 'directory')) {\n\t\t\twidget = this.instantiationService.createInstance(FileAttachmentWidget, resource, range, attachment, correspondingContentReference, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isTerminalVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(TerminalCommandAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPasteVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(PasteAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (resource && isNotebookOutputVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(NotebookCellOutputChatAttachmentWidget, resource, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemChangeVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemChangeAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemChangeRangeVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemChangeRangeAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isWorkspaceVariableEntry(attachment)) {\n\t\t\t// skip workspace attachments\n\t\t\treturn;\n\t\t} else {\n\t\t\twidget = this.instantiationService.createInstance(DefaultChatAttachmentWidget, resource, range, attachment, correspondingContentReference, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t}\n\n\t\tlet ariaLabel: string | null = null;\n\n\t\tif (isAttachmentPartialOrOmitted) {\n\t\t\twidget.element.classList.add('warning');\n\t\t}\n\t\tconst description = correspondingContentReference?.options?.status?.description;\n\t\tif (isAttachmentPartialOrOmitted) {\n\t\t\tariaLabel = `${ariaLabel}${description ? ` ${description}` : ''}`;\n\t\t\tfor (const selector of ['.monaco-icon-suffix-container', '.monaco-icon-name-container']) {\n\t\t\t\t// eslint-disable-next-line no-restricted-syntax\n\t\t\t\tconst element = widget.label.element.querySelector(selector);\n\t\t\t\tif (element) {\n\t\t\t\t\telement.classList.add('warning');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._register(dom.addDisposableListener(widget.element, 'contextmenu', e => this.contextMenuHandler?.(attachment, e)));\n\n\t\tif (this.attachedContextDisposables.isDisposed) {\n\t\t\twidget.dispose();\n\t\t\treturn;\n\t\t}\n\n\t\tif (ariaLabel) {\n\t\t\twidget.element.ariaLabel = ariaLabel;\n\t\t}\n\n\t\tthis.attachedContextDisposables.add(widget);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../../base/common/path.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ResourceLabels } from '../../../../browser/labels.js';\nimport { IChatRequestVariableEntry, isElementVariableEntry, isImageVariableEntry, isNotebookOutputVariableEntry, isPasteVariableEntry, isPromptFileVariableEntry, isPromptTextVariableEntry, isSCMHistoryItemChangeRangeVariableEntry, isSCMHistoryItemChangeVariableEntry, isSCMHistoryItemVariableEntry, isTerminalVariableEntry, isWorkspaceVariableEntry, OmittedState } from '../../common/chatVariableEntries.js';\nimport { ChatResponseReferencePartStatusKind, IChatContentReference } from '../../common/chatService.js';\nimport { DefaultChatAttachmentWidget, ElementChatAttachmentWidget, FileAttachmentWidget, ImageAttachmentWidget, NotebookCellOutputChatAttachmentWidget, PasteAttachmentWidget, PromptFileAttachmentWidget, PromptTextAttachmentWidget, SCMHistoryItemAttachmentWidget, SCMHistoryItemChangeAttachmentWidget, SCMHistoryItemChangeRangeAttachmentWidget, TerminalCommandAttachmentWidget, ToolSetOrToolItemAttachmentWidget } from '../chatAttachmentWidgets.js';\n\nexport interface IChatAttachmentsContentPartOptions {\n\treadonly variables: IChatRequestVariableEntry[];\n\treadonly contentReferences?: ReadonlyArray<IChatContentReference>;\n\treadonly domNode?: HTMLElement;\n\treadonly limit?: number;\n}\n\nexport class ChatAttachmentsContentPart extends Disposable {\n\tprivate readonly attachedContextDisposables = this._register(new DisposableStore());\n\n\tprivate readonly _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\tprivate readonly _contextResourceLabels: ResourceLabels;\n\tprivate _showingAll = false;\n\n\tprivate readonly variables: IChatRequestVariableEntry[];\n\tprivate readonly contentReferences: ReadonlyArray<IChatContentReference>;\n\tprivate readonly limit?: number;\n\tpublic readonly domNode: HTMLElement | undefined;\n\n\tpublic contextMenuHandler?: (attachment: IChatRequestVariableEntry, event: MouseEvent) => void;\n\n\tconstructor(\n\t\toptions: IChatAttachmentsContentPartOptions,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tthis.variables = options.variables;\n\t\tthis.contentReferences = options.contentReferences ?? [];\n\t\tthis.limit = options.limit;\n\t\tthis.domNode = options.domNode ?? dom.$('.chat-attached-context');\n\n\t\tthis._contextResourceLabels = this._register(this.instantiationService.createInstance(ResourceLabels, { onDidChangeVisibility: this._onDidChangeVisibility.event }));\n\n\t\tthis.initAttachedContext(this.domNode);\n\t\tif (!this.domNode.childElementCount) {\n\t\t\tthis.domNode = undefined;\n\t\t}\n\t}\n\n\tprivate initAttachedContext(container: HTMLElement) {\n\t\tdom.clearNode(container);\n\t\tthis.attachedContextDisposables.clear();\n\n\t\tconst visibleAttachments = this.getVisibleAttachments();\n\t\tconst hasMoreAttachments = this.limit && this.variables.length > this.limit && !this._showingAll;\n\n\t\tfor (const attachment of visibleAttachments) {\n\t\t\tthis.renderAttachment(attachment, container);\n\t\t}\n\n\t\tif (hasMoreAttachments) {\n\t\t\tthis.renderShowMoreButton(container);\n\t\t}\n\t}\n\n\tprivate getVisibleAttachments(): IChatRequestVariableEntry[] {\n\t\tif (!this.limit || this._showingAll) {\n\t\t\treturn this.variables;\n\t\t}\n\t\treturn this.variables.slice(0, this.limit);\n\t}\n\n\tprivate renderShowMoreButton(container: HTMLElement) {\n\t\tconst remainingCount = this.variables.length - (this.limit ?? 0);\n\n\t\t// Create a button that looks like the attachment pills\n\t\tconst showMoreButton = dom.$('div.chat-attached-context-attachment.chat-attachments-show-more-button');\n\t\tshowMoreButton.setAttribute('role', 'button');\n\t\tshowMoreButton.setAttribute('tabindex', '0');\n\t\tshowMoreButton.style.cursor = 'pointer';\n\n\t\t// Add pill icon (ellipsis)\n\t\tconst pillIcon = dom.$('div.chat-attached-context-pill', {}, dom.$('span.codicon.codicon-ellipsis'));\n\n\t\t// Add text label\n\t\tconst textLabel = dom.$('span.chat-attached-context-custom-text');\n\t\ttextLabel.textContent = `${remainingCount} more`;\n\n\t\tshowMoreButton.appendChild(pillIcon);\n\t\tshowMoreButton.appendChild(textLabel);\n\n\t\t// Add click and keyboard event handlers\n\t\tconst clickHandler = () => {\n\t\t\tthis._showingAll = true;\n\t\t\tthis.initAttachedContext(container);\n\t\t};\n\n\t\tthis.attachedContextDisposables.add(dom.addDisposableListener(showMoreButton, 'click', clickHandler));\n\t\tthis.attachedContextDisposables.add(dom.addDisposableListener(showMoreButton, 'keydown', (e) => {\n\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\te.preventDefault();\n\t\t\t\tclickHandler();\n\t\t\t}\n\t\t}));\n\n\t\tcontainer.appendChild(showMoreButton);\n\t\tthis.attachedContextDisposables.add({ dispose: () => showMoreButton.remove() });\n\t}\n\n\tprivate renderAttachment(attachment: IChatRequestVariableEntry, container: HTMLElement) {\n\t\tconst resource = URI.isUri(attachment.value) ? attachment.value : attachment.value && typeof attachment.value === 'object' && 'uri' in attachment.value && URI.isUri(attachment.value.uri) ? attachment.value.uri : undefined;\n\t\tconst range = attachment.value && typeof attachment.value === 'object' && 'range' in attachment.value && Range.isIRange(attachment.value.range) ? attachment.value.range : undefined;\n\t\tconst correspondingContentReference = this.contentReferences.find((ref) => (typeof ref.reference === 'object' && 'variableName' in ref.reference && ref.reference.variableName === attachment.name) || (URI.isUri(ref.reference) && basename(ref.reference.path) === attachment.name));\n\t\tconst isAttachmentOmitted = correspondingContentReference?.options?.status?.kind === ChatResponseReferencePartStatusKind.Omitted;\n\t\tconst isAttachmentPartialOrOmitted = isAttachmentOmitted || correspondingContentReference?.options?.status?.kind === ChatResponseReferencePartStatusKind.Partial;\n\n\t\tlet widget;\n\t\tif (attachment.kind === 'tool' || attachment.kind === 'toolset') {\n\t\t\twidget = this.instantiationService.createInstance(ToolSetOrToolItemAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isElementVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(ElementChatAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isImageVariableEntry(attachment)) {\n\t\t\tattachment.omittedState = isAttachmentPartialOrOmitted ? OmittedState.Full : attachment.omittedState;\n\t\t\twidget = this.instantiationService.createInstance(ImageAttachmentWidget, resource, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPromptFileVariableEntry(attachment)) {\n\t\t\tif (attachment.automaticallyAdded) {\n\t\t\t\treturn; // Skip automatically added prompt files\n\t\t\t}\n\t\t\twidget = this.instantiationService.createInstance(PromptFileAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPromptTextVariableEntry(attachment)) {\n\t\t\tif (attachment.automaticallyAdded) {\n\t\t\t\treturn; // Skip automatically added prompt text\n\t\t\t}\n\t\t\twidget = this.instantiationService.createInstance(PromptTextAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (resource && (attachment.kind === 'file' || attachment.kind === 'directory')) {\n\t\t\twidget = this.instantiationService.createInstance(FileAttachmentWidget, resource, range, attachment, correspondingContentReference, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isTerminalVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(TerminalCommandAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isPasteVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(PasteAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (resource && isNotebookOutputVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(NotebookCellOutputChatAttachmentWidget, resource, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemChangeVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemChangeAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isSCMHistoryItemChangeRangeVariableEntry(attachment)) {\n\t\t\twidget = this.instantiationService.createInstance(SCMHistoryItemChangeRangeAttachmentWidget, attachment, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t} else if (isWorkspaceVariableEntry(attachment)) {\n\t\t\t// skip workspace attachments\n\t\t\treturn;\n\t\t} else {\n\t\t\twidget = this.instantiationService.createInstance(DefaultChatAttachmentWidget, resource, range, attachment, correspondingContentReference, undefined, { shouldFocusClearButton: false, supportsDeletion: false }, container, this._contextResourceLabels);\n\t\t}\n\n\t\tlet ariaLabel: string | null = null;\n\n\t\tif (isAttachmentPartialOrOmitted) {\n\t\t\twidget.element.classList.add('warning');\n\t\t}\n\t\tconst description = correspondingContentReference?.options?.status?.description;\n\t\tif (isAttachmentPartialOrOmitted) {\n\t\t\tariaLabel = `${ariaLabel}${description ? ` ${description}` : ''}`;\n\t\t\tfor (const selector of ['.monaco-icon-suffix-container', '.monaco-icon-name-container']) {\n\t\t\t\t// eslint-disable-next-line no-restricted-syntax\n\t\t\t\tconst element = widget.label.element.querySelector(selector);\n\t\t\t\tif (element) {\n\t\t\t\t\telement.classList.add('warning');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._register(dom.addDisposableListener(widget.element, 'contextmenu', e => this.contextMenuHandler?.(attachment, e)));\n\n\t\tif (this.attachedContextDisposables.isDisposed) {\n\t\t\twidget.dispose();\n\t\t\treturn;\n\t\t}\n\n\t\tif (ariaLabel) {\n\t\t\twidget.element.ariaLabel = ariaLabel;\n\t\t}\n\n\t\tthis.attachedContextDisposables.add(widget);\n\t}\n}\n"]}