{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatManagement/chatModelsViewModel.ts","vs/workbench/contrib/chat/browser/chatManagement/chatModelsViewModel.ts"],"names":[],"mappings":"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","file":"chatModelsViewModel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct, coalesce } from '../../../../../base/common/arrays.js';\nimport { IMatch, IFilter, or, matchesCamelCase, matchesWords, matchesBaseContiguousSubString } from '../../../../../base/common/filters.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { ILanguageModelsService, ILanguageModelChatMetadata, IUserFriendlyLanguageModel } from '../../../chat/common/languageModels.js';\nimport { IChatEntitlementService } from '../../../../services/chat/common/chatEntitlementService.js';\n\nexport const MODEL_ENTRY_TEMPLATE_ID = 'model.entry.template';\nexport const VENDOR_ENTRY_TEMPLATE_ID = 'vendor.entry.template';\n\nconst wordFilter = or(matchesBaseContiguousSubString, matchesWords);\nconst CAPABILITY_REGEX = /@capability:\\s*([^\\s]+)/gi;\nconst VISIBLE_REGEX = /@visible:\\s*(true|false)/i;\nconst PROVIDER_REGEX = /@provider:\\s*((\".+?\")|([^\\s]+))/gi;\n\nexport const SEARCH_SUGGESTIONS = {\n\tFILTER_TYPES: [\n\t\t'@provider:',\n\t\t'@capability:',\n\t\t'@visible:'\n\t],\n\tCAPABILITIES: [\n\t\t'@capability:tools',\n\t\t'@capability:vision',\n\t\t'@capability:agent'\n\t],\n\tVISIBILITY: [\n\t\t'@visible:true',\n\t\t'@visible:false'\n\t]\n};\n\nexport interface IVendorEntry {\n\tvendor: string;\n\tvendorDisplayName: string;\n\tmanagementCommand?: string;\n}\n\nexport interface IModelEntry {\n\tvendor: string;\n\tvendorDisplayName: string;\n\tidentifier: string;\n\tmetadata: ILanguageModelChatMetadata;\n}\n\nexport interface IModelItemEntry {\n\ttype: 'model';\n\tid: string;\n\tmodelEntry: IModelEntry;\n\ttemplateId: string;\n\tproviderMatches?: IMatch[];\n\tmodelNameMatches?: IMatch[];\n\tmodelIdMatches?: IMatch[];\n\tcapabilityMatches?: string[];\n}\n\nexport interface IVendorItemEntry {\n\ttype: 'vendor';\n\tid: string;\n\tvendorEntry: IVendorEntry;\n\ttemplateId: string;\n\tcollapsed: boolean;\n}\n\nexport function isVendorEntry(entry: IModelItemEntry | IVendorItemEntry): entry is IVendorItemEntry {\n\treturn entry.type === 'vendor';\n}\n\nexport type IViewModelEntry = IModelItemEntry | IVendorItemEntry;\n\nexport interface IViewModelChangeEvent {\n\tat: number;\n\tremoved: number;\n\tadded: IViewModelEntry[];\n}\n\nexport class ChatModelsViewModel extends EditorModel {\n\n\tprivate readonly _onDidChange = this._register(new Emitter<IViewModelChangeEvent>());\n\treadonly onDidChange = this._onDidChange.event;\n\n\tprivate modelEntries: IModelEntry[];\n\tprivate readonly collapsedVendors = new Set<string>();\n\tprivate searchValue: string = '';\n\n\tconstructor(\n\t\t@ILanguageModelsService private readonly languageModelsService: ILanguageModelsService,\n\t\t@IChatEntitlementService private readonly chatEntitlementService: IChatEntitlementService\n\t) {\n\t\tsuper();\n\t\tthis.modelEntries = [];\n\t\tthis._register(this.chatEntitlementService.onDidChangeEntitlement(() => this.refresh()));\n\t}\n\n\tprivate readonly _viewModelEntries: IViewModelEntry[] = [];\n\tget viewModelEntries(): readonly IViewModelEntry[] {\n\t\treturn this._viewModelEntries;\n\t}\n\tprivate splice(at: number, removed: number, added: IViewModelEntry[]): void {\n\t\tthis._viewModelEntries.splice(at, removed, ...added);\n\t\tif (this.selectedEntry) {\n\t\t\tthis.selectedEntry = this._viewModelEntries.find(entry => entry.id === this.selectedEntry?.id);\n\t\t}\n\t\tthis._onDidChange.fire({ at, removed, added });\n\t}\n\n\tselectedEntry: IViewModelEntry | undefined;\n\n\tfilter(searchValue: string): readonly IViewModelEntry[] {\n\t\tthis.searchValue = searchValue;\n\t\tconst filtered = this.filterModels(this.modelEntries, searchValue);\n\t\tthis.splice(0, this._viewModelEntries.length, filtered);\n\t\treturn this.viewModelEntries;\n\t}\n\n\tprivate filterModels(modelEntries: IModelEntry[], searchValue: string): (IVendorItemEntry | IModelItemEntry)[] {\n\t\tlet visible: boolean | undefined;\n\n\t\tconst visibleMatches = VISIBLE_REGEX.exec(searchValue);\n\t\tif (visibleMatches && visibleMatches[1]) {\n\t\t\tvisible = visibleMatches[1].toLowerCase() === 'true';\n\t\t\tsearchValue = searchValue.replace(VISIBLE_REGEX, '');\n\t\t}\n\n\t\tconst providerNames: string[] = [];\n\t\tlet providerMatch: RegExpExecArray | null;\n\t\tPROVIDER_REGEX.lastIndex = 0;\n\t\twhile ((providerMatch = PROVIDER_REGEX.exec(searchValue)) !== null) {\n\t\t\tconst providerName = providerMatch[2] ? providerMatch[2].substring(1, providerMatch[2].length - 1) : providerMatch[3];\n\t\t\tproviderNames.push(providerName);\n\t\t}\n\t\tif (providerNames.length > 0) {\n\t\t\tsearchValue = searchValue.replace(PROVIDER_REGEX, '');\n\t\t}\n\n\t\tconst capabilities: string[] = [];\n\t\tlet capabilityMatch: RegExpExecArray | null;\n\t\tCAPABILITY_REGEX.lastIndex = 0;\n\t\twhile ((capabilityMatch = CAPABILITY_REGEX.exec(searchValue)) !== null) {\n\t\t\tcapabilities.push(capabilityMatch[1].toLowerCase());\n\t\t}\n\t\tif (capabilities.length > 0) {\n\t\t\tsearchValue = searchValue.replace(CAPABILITY_REGEX, '');\n\t\t}\n\n\t\tconst quoteAtFirstChar = searchValue.charAt(0) === '\"';\n\t\tconst quoteAtLastChar = searchValue.charAt(searchValue.length - 1) === '\"';\n\t\tconst completeMatch = quoteAtFirstChar && quoteAtLastChar;\n\t\tif (quoteAtFirstChar) {\n\t\t\tsearchValue = searchValue.substring(1);\n\t\t}\n\t\tif (quoteAtLastChar) {\n\t\t\tsearchValue = searchValue.substring(0, searchValue.length - 1);\n\t\t}\n\t\tsearchValue = searchValue.trim();\n\n\t\tconst isFiltering = searchValue !== '' || capabilities.length > 0 || providerNames.length > 0 || visible !== undefined;\n\n\t\tconst result: (IVendorItemEntry | IModelItemEntry)[] = [];\n\t\tconst words = searchValue.split(' ');\n\t\tconst allVendors = new Set(this.modelEntries.map(m => m.vendor));\n\t\tconst showHeaders = allVendors.size > 1;\n\t\tconst addedVendors = new Set<string>();\n\t\tconst lowerProviders = providerNames.map(p => p.toLowerCase().trim());\n\n\t\tfor (const modelEntry of modelEntries) {\n\t\t\tif (!isFiltering && showHeaders && this.collapsedVendors.has(modelEntry.vendor)) {\n\t\t\t\tif (!addedVendors.has(modelEntry.vendor)) {\n\t\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'vendor',\n\t\t\t\t\t\tid: `vendor-${modelEntry.vendor}`,\n\t\t\t\t\t\tvendorEntry: {\n\t\t\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttemplateId: VENDOR_ENTRY_TEMPLATE_ID,\n\t\t\t\t\t\tcollapsed: true\n\t\t\t\t\t});\n\t\t\t\t\taddedVendors.add(modelEntry.vendor);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (visible !== undefined) {\n\t\t\t\tif ((modelEntry.metadata.isUserSelectable ?? false) !== visible) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (lowerProviders.length > 0) {\n\t\t\t\tconst matchesProvider = lowerProviders.some(provider =>\n\t\t\t\t\tmodelEntry.vendor.toLowerCase() === provider ||\n\t\t\t\t\tmodelEntry.vendorDisplayName.toLowerCase() === provider\n\t\t\t\t);\n\t\t\t\tif (!matchesProvider) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Filter by capabilities\n\t\t\tlet matchedCapabilities: string[] = [];\n\t\t\tif (capabilities.length > 0) {\n\t\t\t\tif (!modelEntry.metadata.capabilities) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet matchesAll = true;\n\t\t\t\tfor (const capability of capabilities) {\n\t\t\t\t\tconst matchedForThisCapability = this.getMatchingCapabilities(modelEntry, capability);\n\t\t\t\t\tif (matchedForThisCapability.length === 0) {\n\t\t\t\t\t\tmatchesAll = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tmatchedCapabilities.push(...matchedForThisCapability);\n\t\t\t\t}\n\t\t\t\tif (!matchesAll) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tmatchedCapabilities = distinct(matchedCapabilities);\n\t\t\t}\n\n\t\t\t// Filter by text\n\t\t\tlet modelMatches: ModelItemMatches | undefined;\n\t\t\tif (searchValue) {\n\t\t\t\tmodelMatches = new ModelItemMatches(modelEntry, searchValue, words, completeMatch);\n\t\t\t\tif (!modelMatches.modelNameMatches && !modelMatches.modelIdMatches && !modelMatches.providerMatches && !modelMatches.capabilityMatches) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (showHeaders && !addedVendors.has(modelEntry.vendor)) {\n\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\tresult.push({\n\t\t\t\t\ttype: 'vendor',\n\t\t\t\t\tid: `vendor-${modelEntry.vendor}`,\n\t\t\t\t\tvendorEntry: {\n\t\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t\t},\n\t\t\t\t\ttemplateId: VENDOR_ENTRY_TEMPLATE_ID,\n\t\t\t\t\tcollapsed: false\n\t\t\t\t});\n\t\t\t\taddedVendors.add(modelEntry.vendor);\n\t\t\t}\n\n\t\t\tconst modelId = ChatModelsViewModel.getId(modelEntry);\n\t\t\tresult.push({\n\t\t\t\ttype: 'model',\n\t\t\t\tid: modelId,\n\t\t\t\ttemplateId: MODEL_ENTRY_TEMPLATE_ID,\n\t\t\t\tmodelEntry,\n\t\t\t\tmodelNameMatches: modelMatches?.modelNameMatches || undefined,\n\t\t\t\tmodelIdMatches: modelMatches?.modelIdMatches || undefined,\n\t\t\t\tproviderMatches: modelMatches?.providerMatches || undefined,\n\t\t\t\tcapabilityMatches: matchedCapabilities.length ? matchedCapabilities : undefined,\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate getMatchingCapabilities(modelEntry: IModelEntry, capability: string): string[] {\n\t\tconst matchedCapabilities: string[] = [];\n\t\tif (!modelEntry.metadata.capabilities) {\n\t\t\treturn matchedCapabilities;\n\t\t}\n\n\t\tswitch (capability) {\n\t\t\tcase 'tools':\n\t\t\tcase 'toolcalling':\n\t\t\t\tif (modelEntry.metadata.capabilities.toolCalling === true) {\n\t\t\t\t\tmatchedCapabilities.push('toolCalling');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'vision':\n\t\t\t\tif (modelEntry.metadata.capabilities.vision === true) {\n\t\t\t\t\tmatchedCapabilities.push('vision');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'agent':\n\t\t\tcase 'agentmode':\n\t\t\t\tif (modelEntry.metadata.capabilities.agentMode === true) {\n\t\t\t\t\tmatchedCapabilities.push('agentMode');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// Check edit tools\n\t\t\t\tif (modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\tfor (const tool of modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\t\tif (tool.toLowerCase().includes(capability)) {\n\t\t\t\t\t\t\tmatchedCapabilities.push(tool);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn matchedCapabilities;\n\t}\n\n\tgetVendors(): IUserFriendlyLanguageModel[] {\n\t\treturn [...this.languageModelsService.getVendors()].sort((a, b) => {\n\t\t\tif (a.vendor === 'copilot') { return -1; }\n\t\t\tif (b.vendor === 'copilot') { return 1; }\n\t\t\treturn a.displayName.localeCompare(b.displayName);\n\t\t});\n\t}\n\n\toverride async resolve(): Promise<void> {\n\t\tawait this.refresh();\n\t\treturn super.resolve();\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tthis.modelEntries = [];\n\t\tfor (const vendor of this.getVendors()) {\n\t\t\tconst modelIdentifiers = await this.languageModelsService.selectLanguageModels({ vendor: vendor.vendor }, vendor.vendor === 'copilot');\n\t\t\tconst models = coalesce(modelIdentifiers.map(identifier => {\n\t\t\t\tconst metadata = this.languageModelsService.lookupLanguageModel(identifier);\n\t\t\t\tif (!metadata) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tif (vendor.vendor === 'copilot' && metadata.id === 'auto') {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tvendor: vendor.vendor,\n\t\t\t\t\tvendorDisplayName: vendor.displayName,\n\t\t\t\t\tidentifier,\n\t\t\t\t\tmetadata\n\t\t\t\t};\n\t\t\t}));\n\n\t\t\tthis.modelEntries.push(...models.sort((a, b) => a.metadata.name.localeCompare(b.metadata.name)));\n\t\t}\n\n\t\tthis.modelEntries = distinct(this.modelEntries, modelEntry => ChatModelsViewModel.getId(modelEntry));\n\t\tthis.filter(this.searchValue);\n\t}\n\n\ttoggleVisibility(model: IModelItemEntry): void {\n\t\tconst isVisible = model.modelEntry.metadata.isUserSelectable ?? false;\n\t\tconst newVisibility = !isVisible;\n\t\tthis.languageModelsService.updateModelPickerPreference(model.modelEntry.identifier, newVisibility);\n\t\tconst metadata = this.languageModelsService.lookupLanguageModel(model.modelEntry.identifier);\n\t\tconst index = this.viewModelEntries.indexOf(model);\n\t\tif (metadata) {\n\t\t\tmodel.id = ChatModelsViewModel.getId(model.modelEntry);\n\t\t\tmodel.modelEntry.metadata = metadata;\n\t\t\tthis.splice(index, 1, [model]);\n\t\t}\n\t}\n\n\tprivate static getId(modelEntry: IModelEntry): string {\n\t\treturn `${modelEntry.identifier}.${modelEntry.metadata.version}-visible:${modelEntry.metadata.isUserSelectable}`;\n\t}\n\n\ttoggleVendorCollapsed(vendorEntry: IVendorItemEntry): void {\n\t\tthis.selectedEntry = vendorEntry;\n\t\tif (this.collapsedVendors.has(vendorEntry.vendorEntry.vendor)) {\n\t\t\tthis.collapsedVendors.delete(vendorEntry.vendorEntry.vendor);\n\t\t} else {\n\t\t\tthis.collapsedVendors.add(vendorEntry.vendorEntry.vendor);\n\t\t}\n\t\tthis.filter(this.searchValue);\n\t}\n\n\tgetConfiguredVendors(): IVendorEntry[] {\n\t\tconst result: IVendorEntry[] = [];\n\t\tconst seenVendors = new Set<string>();\n\t\tfor (const modelEntry of this.modelEntries) {\n\t\t\tif (!seenVendors.has(modelEntry.vendor)) {\n\t\t\t\tseenVendors.add(modelEntry.vendor);\n\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\tresult.push({\n\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nclass ModelItemMatches {\n\n\treadonly modelNameMatches: IMatch[] | null = null;\n\treadonly modelIdMatches: IMatch[] | null = null;\n\treadonly providerMatches: IMatch[] | null = null;\n\treadonly capabilityMatches: IMatch[] | null = null;\n\n\tconstructor(modelEntry: IModelEntry, searchValue: string, words: string[], completeMatch: boolean) {\n\t\tif (!completeMatch) {\n\t\t\t// Match against model name\n\t\t\tthis.modelNameMatches = modelEntry.metadata.name ?\n\t\t\t\tthis.matches(searchValue, modelEntry.metadata.name, (word, wordToMatchAgainst) => matchesWords(word, wordToMatchAgainst, true), words) :\n\t\t\t\tnull;\n\n\t\t\tthis.modelIdMatches = this.matches(searchValue, modelEntry.identifier, or(matchesWords, matchesCamelCase), words);\n\n\t\t\t// Match against vendor display name\n\t\t\tthis.providerMatches = this.matches(searchValue, modelEntry.vendorDisplayName, (word, wordToMatchAgainst) => matchesWords(word, wordToMatchAgainst, true), words);\n\n\t\t\t// Match against capabilities\n\t\t\tif (modelEntry.metadata.capabilities) {\n\t\t\t\tconst capabilityStrings: string[] = [];\n\t\t\t\tif (modelEntry.metadata.capabilities.toolCalling) {\n\t\t\t\t\tcapabilityStrings.push('tools', 'toolCalling');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.vision) {\n\t\t\t\t\tcapabilityStrings.push('vision');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.agentMode) {\n\t\t\t\t\tcapabilityStrings.push('agent', 'agentMode');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\tcapabilityStrings.push(...modelEntry.metadata.capabilities.editTools);\n\t\t\t\t}\n\n\t\t\t\tconst capabilityString = capabilityStrings.join(' ');\n\t\t\t\tif (capabilityString) {\n\t\t\t\t\tthis.capabilityMatches = this.matches(searchValue, capabilityString, or(matchesWords, matchesCamelCase), words);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate matches(searchValue: string | null, wordToMatchAgainst: string, wordMatchesFilter: IFilter, words: string[]): IMatch[] | null {\n\t\tlet matches = searchValue ? wordFilter(searchValue, wordToMatchAgainst) : null;\n\t\tif (!matches) {\n\t\t\tmatches = this.matchesWords(words, wordToMatchAgainst, wordMatchesFilter);\n\t\t}\n\t\tif (matches) {\n\t\t\tmatches = this.filterAndSort(matches);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tprivate matchesWords(words: string[], wordToMatchAgainst: string, wordMatchesFilter: IFilter): IMatch[] | null {\n\t\tlet matches: IMatch[] | null = [];\n\t\tfor (const word of words) {\n\t\t\tconst wordMatches = wordMatchesFilter(word, wordToMatchAgainst);\n\t\t\tif (wordMatches) {\n\t\t\t\tmatches = [...(matches || []), ...wordMatches];\n\t\t\t} else {\n\t\t\t\tmatches = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn matches;\n\t}\n\n\tprivate filterAndSort(matches: IMatch[]): IMatch[] {\n\t\treturn distinct(matches, (a => a.start + '.' + a.end))\n\t\t\t.filter(match => !matches.some(m => !(m.start === match.start && m.end === match.end) && (m.start <= match.start && m.end >= match.end)))\n\t\t\t.sort((a, b) => a.start - b.start);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct, coalesce } from '../../../../../base/common/arrays.js';\nimport { IMatch, IFilter, or, matchesCamelCase, matchesWords, matchesBaseContiguousSubString } from '../../../../../base/common/filters.js';\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { ILanguageModelsService, ILanguageModelChatMetadata, IUserFriendlyLanguageModel } from '../../../chat/common/languageModels.js';\nimport { IChatEntitlementService } from '../../../../services/chat/common/chatEntitlementService.js';\n\nexport const MODEL_ENTRY_TEMPLATE_ID = 'model.entry.template';\nexport const VENDOR_ENTRY_TEMPLATE_ID = 'vendor.entry.template';\n\nconst wordFilter = or(matchesBaseContiguousSubString, matchesWords);\nconst CAPABILITY_REGEX = /@capability:\\s*([^\\s]+)/gi;\nconst VISIBLE_REGEX = /@visible:\\s*(true|false)/i;\nconst PROVIDER_REGEX = /@provider:\\s*((\".+?\")|([^\\s]+))/gi;\n\nexport const SEARCH_SUGGESTIONS = {\n\tFILTER_TYPES: [\n\t\t'@provider:',\n\t\t'@capability:',\n\t\t'@visible:'\n\t],\n\tCAPABILITIES: [\n\t\t'@capability:tools',\n\t\t'@capability:vision',\n\t\t'@capability:agent'\n\t],\n\tVISIBILITY: [\n\t\t'@visible:true',\n\t\t'@visible:false'\n\t]\n};\n\nexport interface IVendorEntry {\n\tvendor: string;\n\tvendorDisplayName: string;\n\tmanagementCommand?: string;\n}\n\nexport interface IModelEntry {\n\tvendor: string;\n\tvendorDisplayName: string;\n\tidentifier: string;\n\tmetadata: ILanguageModelChatMetadata;\n}\n\nexport interface IModelItemEntry {\n\ttype: 'model';\n\tid: string;\n\tmodelEntry: IModelEntry;\n\ttemplateId: string;\n\tproviderMatches?: IMatch[];\n\tmodelNameMatches?: IMatch[];\n\tmodelIdMatches?: IMatch[];\n\tcapabilityMatches?: string[];\n}\n\nexport interface IVendorItemEntry {\n\ttype: 'vendor';\n\tid: string;\n\tvendorEntry: IVendorEntry;\n\ttemplateId: string;\n\tcollapsed: boolean;\n}\n\nexport function isVendorEntry(entry: IModelItemEntry | IVendorItemEntry): entry is IVendorItemEntry {\n\treturn entry.type === 'vendor';\n}\n\nexport type IViewModelEntry = IModelItemEntry | IVendorItemEntry;\n\nexport interface IViewModelChangeEvent {\n\tat: number;\n\tremoved: number;\n\tadded: IViewModelEntry[];\n}\n\nexport class ChatModelsViewModel extends EditorModel {\n\n\tprivate readonly _onDidChange = this._register(new Emitter<IViewModelChangeEvent>());\n\treadonly onDidChange = this._onDidChange.event;\n\n\tprivate modelEntries: IModelEntry[];\n\tprivate readonly collapsedVendors = new Set<string>();\n\tprivate searchValue: string = '';\n\n\tconstructor(\n\t\t@ILanguageModelsService private readonly languageModelsService: ILanguageModelsService,\n\t\t@IChatEntitlementService private readonly chatEntitlementService: IChatEntitlementService\n\t) {\n\t\tsuper();\n\t\tthis.modelEntries = [];\n\t\tthis._register(this.chatEntitlementService.onDidChangeEntitlement(() => this.refresh()));\n\t}\n\n\tprivate readonly _viewModelEntries: IViewModelEntry[] = [];\n\tget viewModelEntries(): readonly IViewModelEntry[] {\n\t\treturn this._viewModelEntries;\n\t}\n\tprivate splice(at: number, removed: number, added: IViewModelEntry[]): void {\n\t\tthis._viewModelEntries.splice(at, removed, ...added);\n\t\tif (this.selectedEntry) {\n\t\t\tthis.selectedEntry = this._viewModelEntries.find(entry => entry.id === this.selectedEntry?.id);\n\t\t}\n\t\tthis._onDidChange.fire({ at, removed, added });\n\t}\n\n\tselectedEntry: IViewModelEntry | undefined;\n\n\tfilter(searchValue: string): readonly IViewModelEntry[] {\n\t\tthis.searchValue = searchValue;\n\t\tconst filtered = this.filterModels(this.modelEntries, searchValue);\n\t\tthis.splice(0, this._viewModelEntries.length, filtered);\n\t\treturn this.viewModelEntries;\n\t}\n\n\tprivate filterModels(modelEntries: IModelEntry[], searchValue: string): (IVendorItemEntry | IModelItemEntry)[] {\n\t\tlet visible: boolean | undefined;\n\n\t\tconst visibleMatches = VISIBLE_REGEX.exec(searchValue);\n\t\tif (visibleMatches && visibleMatches[1]) {\n\t\t\tvisible = visibleMatches[1].toLowerCase() === 'true';\n\t\t\tsearchValue = searchValue.replace(VISIBLE_REGEX, '');\n\t\t}\n\n\t\tconst providerNames: string[] = [];\n\t\tlet providerMatch: RegExpExecArray | null;\n\t\tPROVIDER_REGEX.lastIndex = 0;\n\t\twhile ((providerMatch = PROVIDER_REGEX.exec(searchValue)) !== null) {\n\t\t\tconst providerName = providerMatch[2] ? providerMatch[2].substring(1, providerMatch[2].length - 1) : providerMatch[3];\n\t\t\tproviderNames.push(providerName);\n\t\t}\n\t\tif (providerNames.length > 0) {\n\t\t\tsearchValue = searchValue.replace(PROVIDER_REGEX, '');\n\t\t}\n\n\t\tconst capabilities: string[] = [];\n\t\tlet capabilityMatch: RegExpExecArray | null;\n\t\tCAPABILITY_REGEX.lastIndex = 0;\n\t\twhile ((capabilityMatch = CAPABILITY_REGEX.exec(searchValue)) !== null) {\n\t\t\tcapabilities.push(capabilityMatch[1].toLowerCase());\n\t\t}\n\t\tif (capabilities.length > 0) {\n\t\t\tsearchValue = searchValue.replace(CAPABILITY_REGEX, '');\n\t\t}\n\n\t\tconst quoteAtFirstChar = searchValue.charAt(0) === '\"';\n\t\tconst quoteAtLastChar = searchValue.charAt(searchValue.length - 1) === '\"';\n\t\tconst completeMatch = quoteAtFirstChar && quoteAtLastChar;\n\t\tif (quoteAtFirstChar) {\n\t\t\tsearchValue = searchValue.substring(1);\n\t\t}\n\t\tif (quoteAtLastChar) {\n\t\t\tsearchValue = searchValue.substring(0, searchValue.length - 1);\n\t\t}\n\t\tsearchValue = searchValue.trim();\n\n\t\tconst isFiltering = searchValue !== '' || capabilities.length > 0 || providerNames.length > 0 || visible !== undefined;\n\n\t\tconst result: (IVendorItemEntry | IModelItemEntry)[] = [];\n\t\tconst words = searchValue.split(' ');\n\t\tconst allVendors = new Set(this.modelEntries.map(m => m.vendor));\n\t\tconst showHeaders = allVendors.size > 1;\n\t\tconst addedVendors = new Set<string>();\n\t\tconst lowerProviders = providerNames.map(p => p.toLowerCase().trim());\n\n\t\tfor (const modelEntry of modelEntries) {\n\t\t\tif (!isFiltering && showHeaders && this.collapsedVendors.has(modelEntry.vendor)) {\n\t\t\t\tif (!addedVendors.has(modelEntry.vendor)) {\n\t\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'vendor',\n\t\t\t\t\t\tid: `vendor-${modelEntry.vendor}`,\n\t\t\t\t\t\tvendorEntry: {\n\t\t\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttemplateId: VENDOR_ENTRY_TEMPLATE_ID,\n\t\t\t\t\t\tcollapsed: true\n\t\t\t\t\t});\n\t\t\t\t\taddedVendors.add(modelEntry.vendor);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (visible !== undefined) {\n\t\t\t\tif ((modelEntry.metadata.isUserSelectable ?? false) !== visible) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (lowerProviders.length > 0) {\n\t\t\t\tconst matchesProvider = lowerProviders.some(provider =>\n\t\t\t\t\tmodelEntry.vendor.toLowerCase() === provider ||\n\t\t\t\t\tmodelEntry.vendorDisplayName.toLowerCase() === provider\n\t\t\t\t);\n\t\t\t\tif (!matchesProvider) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Filter by capabilities\n\t\t\tlet matchedCapabilities: string[] = [];\n\t\t\tif (capabilities.length > 0) {\n\t\t\t\tif (!modelEntry.metadata.capabilities) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet matchesAll = true;\n\t\t\t\tfor (const capability of capabilities) {\n\t\t\t\t\tconst matchedForThisCapability = this.getMatchingCapabilities(modelEntry, capability);\n\t\t\t\t\tif (matchedForThisCapability.length === 0) {\n\t\t\t\t\t\tmatchesAll = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tmatchedCapabilities.push(...matchedForThisCapability);\n\t\t\t\t}\n\t\t\t\tif (!matchesAll) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tmatchedCapabilities = distinct(matchedCapabilities);\n\t\t\t}\n\n\t\t\t// Filter by text\n\t\t\tlet modelMatches: ModelItemMatches | undefined;\n\t\t\tif (searchValue) {\n\t\t\t\tmodelMatches = new ModelItemMatches(modelEntry, searchValue, words, completeMatch);\n\t\t\t\tif (!modelMatches.modelNameMatches && !modelMatches.modelIdMatches && !modelMatches.providerMatches && !modelMatches.capabilityMatches) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (showHeaders && !addedVendors.has(modelEntry.vendor)) {\n\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\tresult.push({\n\t\t\t\t\ttype: 'vendor',\n\t\t\t\t\tid: `vendor-${modelEntry.vendor}`,\n\t\t\t\t\tvendorEntry: {\n\t\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t\t},\n\t\t\t\t\ttemplateId: VENDOR_ENTRY_TEMPLATE_ID,\n\t\t\t\t\tcollapsed: false\n\t\t\t\t});\n\t\t\t\taddedVendors.add(modelEntry.vendor);\n\t\t\t}\n\n\t\t\tconst modelId = ChatModelsViewModel.getId(modelEntry);\n\t\t\tresult.push({\n\t\t\t\ttype: 'model',\n\t\t\t\tid: modelId,\n\t\t\t\ttemplateId: MODEL_ENTRY_TEMPLATE_ID,\n\t\t\t\tmodelEntry,\n\t\t\t\tmodelNameMatches: modelMatches?.modelNameMatches || undefined,\n\t\t\t\tmodelIdMatches: modelMatches?.modelIdMatches || undefined,\n\t\t\t\tproviderMatches: modelMatches?.providerMatches || undefined,\n\t\t\t\tcapabilityMatches: matchedCapabilities.length ? matchedCapabilities : undefined,\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate getMatchingCapabilities(modelEntry: IModelEntry, capability: string): string[] {\n\t\tconst matchedCapabilities: string[] = [];\n\t\tif (!modelEntry.metadata.capabilities) {\n\t\t\treturn matchedCapabilities;\n\t\t}\n\n\t\tswitch (capability) {\n\t\t\tcase 'tools':\n\t\t\tcase 'toolcalling':\n\t\t\t\tif (modelEntry.metadata.capabilities.toolCalling === true) {\n\t\t\t\t\tmatchedCapabilities.push('toolCalling');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'vision':\n\t\t\t\tif (modelEntry.metadata.capabilities.vision === true) {\n\t\t\t\t\tmatchedCapabilities.push('vision');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'agent':\n\t\t\tcase 'agentmode':\n\t\t\t\tif (modelEntry.metadata.capabilities.agentMode === true) {\n\t\t\t\t\tmatchedCapabilities.push('agentMode');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// Check edit tools\n\t\t\t\tif (modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\tfor (const tool of modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\t\tif (tool.toLowerCase().includes(capability)) {\n\t\t\t\t\t\t\tmatchedCapabilities.push(tool);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn matchedCapabilities;\n\t}\n\n\tgetVendors(): IUserFriendlyLanguageModel[] {\n\t\treturn [...this.languageModelsService.getVendors()].sort((a, b) => {\n\t\t\tif (a.vendor === 'copilot') { return -1; }\n\t\t\tif (b.vendor === 'copilot') { return 1; }\n\t\t\treturn a.displayName.localeCompare(b.displayName);\n\t\t});\n\t}\n\n\toverride async resolve(): Promise<void> {\n\t\tawait this.refresh();\n\t\treturn super.resolve();\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tthis.modelEntries = [];\n\t\tfor (const vendor of this.getVendors()) {\n\t\t\tconst modelIdentifiers = await this.languageModelsService.selectLanguageModels({ vendor: vendor.vendor }, vendor.vendor === 'copilot');\n\t\t\tconst models = coalesce(modelIdentifiers.map(identifier => {\n\t\t\t\tconst metadata = this.languageModelsService.lookupLanguageModel(identifier);\n\t\t\t\tif (!metadata) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tif (vendor.vendor === 'copilot' && metadata.id === 'auto') {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tvendor: vendor.vendor,\n\t\t\t\t\tvendorDisplayName: vendor.displayName,\n\t\t\t\t\tidentifier,\n\t\t\t\t\tmetadata\n\t\t\t\t};\n\t\t\t}));\n\n\t\t\tthis.modelEntries.push(...models.sort((a, b) => a.metadata.name.localeCompare(b.metadata.name)));\n\t\t}\n\n\t\tthis.modelEntries = distinct(this.modelEntries, modelEntry => ChatModelsViewModel.getId(modelEntry));\n\t\tthis.filter(this.searchValue);\n\t}\n\n\ttoggleVisibility(model: IModelItemEntry): void {\n\t\tconst isVisible = model.modelEntry.metadata.isUserSelectable ?? false;\n\t\tconst newVisibility = !isVisible;\n\t\tthis.languageModelsService.updateModelPickerPreference(model.modelEntry.identifier, newVisibility);\n\t\tconst metadata = this.languageModelsService.lookupLanguageModel(model.modelEntry.identifier);\n\t\tconst index = this.viewModelEntries.indexOf(model);\n\t\tif (metadata) {\n\t\t\tmodel.id = ChatModelsViewModel.getId(model.modelEntry);\n\t\t\tmodel.modelEntry.metadata = metadata;\n\t\t\tthis.splice(index, 1, [model]);\n\t\t}\n\t}\n\n\tprivate static getId(modelEntry: IModelEntry): string {\n\t\treturn `${modelEntry.identifier}.${modelEntry.metadata.version}-visible:${modelEntry.metadata.isUserSelectable}`;\n\t}\n\n\ttoggleVendorCollapsed(vendorEntry: IVendorItemEntry): void {\n\t\tthis.selectedEntry = vendorEntry;\n\t\tif (this.collapsedVendors.has(vendorEntry.vendorEntry.vendor)) {\n\t\t\tthis.collapsedVendors.delete(vendorEntry.vendorEntry.vendor);\n\t\t} else {\n\t\t\tthis.collapsedVendors.add(vendorEntry.vendorEntry.vendor);\n\t\t}\n\t\tthis.filter(this.searchValue);\n\t}\n\n\tgetConfiguredVendors(): IVendorEntry[] {\n\t\tconst result: IVendorEntry[] = [];\n\t\tconst seenVendors = new Set<string>();\n\t\tfor (const modelEntry of this.modelEntries) {\n\t\t\tif (!seenVendors.has(modelEntry.vendor)) {\n\t\t\t\tseenVendors.add(modelEntry.vendor);\n\t\t\t\tconst vendorInfo = this.languageModelsService.getVendors().find(v => v.vendor === modelEntry.vendor);\n\t\t\t\tresult.push({\n\t\t\t\t\tvendor: modelEntry.vendor,\n\t\t\t\t\tvendorDisplayName: modelEntry.vendorDisplayName,\n\t\t\t\t\tmanagementCommand: vendorInfo?.managementCommand\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nclass ModelItemMatches {\n\n\treadonly modelNameMatches: IMatch[] | null = null;\n\treadonly modelIdMatches: IMatch[] | null = null;\n\treadonly providerMatches: IMatch[] | null = null;\n\treadonly capabilityMatches: IMatch[] | null = null;\n\n\tconstructor(modelEntry: IModelEntry, searchValue: string, words: string[], completeMatch: boolean) {\n\t\tif (!completeMatch) {\n\t\t\t// Match against model name\n\t\t\tthis.modelNameMatches = modelEntry.metadata.name ?\n\t\t\t\tthis.matches(searchValue, modelEntry.metadata.name, (word, wordToMatchAgainst) => matchesWords(word, wordToMatchAgainst, true), words) :\n\t\t\t\tnull;\n\n\t\t\tthis.modelIdMatches = this.matches(searchValue, modelEntry.identifier, or(matchesWords, matchesCamelCase), words);\n\n\t\t\t// Match against vendor display name\n\t\t\tthis.providerMatches = this.matches(searchValue, modelEntry.vendorDisplayName, (word, wordToMatchAgainst) => matchesWords(word, wordToMatchAgainst, true), words);\n\n\t\t\t// Match against capabilities\n\t\t\tif (modelEntry.metadata.capabilities) {\n\t\t\t\tconst capabilityStrings: string[] = [];\n\t\t\t\tif (modelEntry.metadata.capabilities.toolCalling) {\n\t\t\t\t\tcapabilityStrings.push('tools', 'toolCalling');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.vision) {\n\t\t\t\t\tcapabilityStrings.push('vision');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.agentMode) {\n\t\t\t\t\tcapabilityStrings.push('agent', 'agentMode');\n\t\t\t\t}\n\t\t\t\tif (modelEntry.metadata.capabilities.editTools) {\n\t\t\t\t\tcapabilityStrings.push(...modelEntry.metadata.capabilities.editTools);\n\t\t\t\t}\n\n\t\t\t\tconst capabilityString = capabilityStrings.join(' ');\n\t\t\t\tif (capabilityString) {\n\t\t\t\t\tthis.capabilityMatches = this.matches(searchValue, capabilityString, or(matchesWords, matchesCamelCase), words);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate matches(searchValue: string | null, wordToMatchAgainst: string, wordMatchesFilter: IFilter, words: string[]): IMatch[] | null {\n\t\tlet matches = searchValue ? wordFilter(searchValue, wordToMatchAgainst) : null;\n\t\tif (!matches) {\n\t\t\tmatches = this.matchesWords(words, wordToMatchAgainst, wordMatchesFilter);\n\t\t}\n\t\tif (matches) {\n\t\t\tmatches = this.filterAndSort(matches);\n\t\t}\n\t\treturn matches;\n\t}\n\n\tprivate matchesWords(words: string[], wordToMatchAgainst: string, wordMatchesFilter: IFilter): IMatch[] | null {\n\t\tlet matches: IMatch[] | null = [];\n\t\tfor (const word of words) {\n\t\t\tconst wordMatches = wordMatchesFilter(word, wordToMatchAgainst);\n\t\t\tif (wordMatches) {\n\t\t\t\tmatches = [...(matches || []), ...wordMatches];\n\t\t\t} else {\n\t\t\t\tmatches = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn matches;\n\t}\n\n\tprivate filterAndSort(matches: IMatch[]): IMatch[] {\n\t\treturn distinct(matches, (a => a.start + '.' + a.end))\n\t\t\t.filter(match => !matches.some(m => !(m.start === match.start && m.end === match.end) && (m.start <= match.start && m.end >= match.end)))\n\t\t\t.sort((a, b) => a.start - b.start);\n\t}\n}\n"]}