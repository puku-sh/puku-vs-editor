{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatMoveActions.ts"],"names":[],"mappings":"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","file":"chatMoveActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, MenuId, MenuRegistry, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr, ContextKeyExpression } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { ActiveEditorContext } from '../../../../common/contextkeys.js';\nimport { ViewContainerLocation } from '../../../../common/views.js';\nimport { IEditorGroupsService } from '../../../../services/editor/common/editorGroupsService.js';\nimport { ACTIVE_GROUP, AUX_WINDOW_GROUP, IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IViewsService } from '../../../../services/views/common/viewsService.js';\nimport { isChatViewTitleActionContext } from '../../common/chatActions.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ChatAgentLocation } from '../../common/constants.js';\nimport { ChatViewId, IChatWidgetService } from '../chat.js';\nimport { ChatEditor, IChatEditorOptions } from '../chatEditor.js';\nimport { ChatEditorInput } from '../chatEditorInput.js';\nimport { ChatViewPane } from '../chatViewPane.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\n\nenum MoveToNewLocation {\n\tEditor = 'Editor',\n\tWindow = 'Window'\n}\n\nexport function registerMoveActions() {\n\tregisterAction2(class GlobalMoveToEditorAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.openInEditor',\n\t\t\t\ttitle: localize2('chat.openInEditor.label', \"Move Chat into Editor Area\"),\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ViewTitle,\n\t\t\t\t\twhen: ContextKeyExpr.equals('view', ChatViewId),\n\t\t\t\t\torder: 0,\n\t\t\t\t\tgroup: '1_open'\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\tconst context = args[0];\n\t\t\texecuteMoveToAction(accessor, MoveToNewLocation.Editor, isChatViewTitleActionContext(context) ? context.sessionResource : undefined);\n\t\t}\n\t});\n\n\tregisterAction2(class GlobalMoveToNewWindowAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.openInNewWindow',\n\t\t\t\ttitle: localize2('chat.openInNewWindow.label', \"Move Chat into New Window\"),\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ViewTitle,\n\t\t\t\t\twhen: ContextKeyExpr.equals('view', ChatViewId),\n\t\t\t\t\torder: 0,\n\t\t\t\t\tgroup: '1_open'\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\tconst context = args[0];\n\t\t\texecuteMoveToAction(accessor, MoveToNewLocation.Window, isChatViewTitleActionContext(context) ? context.sessionResource : undefined);\n\t\t}\n\t});\n\n\tregisterAction2(class GlobalMoveToSidebarAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.openInSidebar',\n\t\t\t\ttitle: localize2('interactiveSession.openInSidebar.label', \"Move Chat into Side Bar\"),\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true\n\t\t\t});\n\t\t}\n\n\t\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\treturn moveToSidebar(accessor);\n\t\t}\n\t});\n\n\tfunction appendOpenChatInViewMenuItem(menuId: MenuId, title: string, icon: ThemeIcon, locationContextKey: ContextKeyExpression) {\n\t\tMenuRegistry.appendMenuItem(menuId, {\n\t\t\tcommand: { id: 'workbench.action.chat.openInSidebar', title, icon },\n\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\tActiveEditorContext.isEqualTo(ChatEditorInput.EditorID),\n\t\t\t\tlocationContextKey\n\t\t\t),\n\t\t\tgroup: menuId === MenuId.CompactWindowEditorTitle ? 'navigation' : undefined,\n\t\t\torder: 0\n\t\t});\n\t}\n\n\t[MenuId.EditorTitle, MenuId.CompactWindowEditorTitle].forEach(id => {\n\t\tappendOpenChatInViewMenuItem(id, localize('interactiveSession.openInSecondarySidebar.label', \"Move Chat into Secondary Side Bar\"), Codicon.layoutSidebarRightDock, ChatContextKeys.panelLocation.isEqualTo(ViewContainerLocation.AuxiliaryBar));\n\t\tappendOpenChatInViewMenuItem(id, localize('interactiveSession.openInPrimarySidebar.label', \"Move Chat into Primary Side Bar\"), Codicon.layoutSidebarLeftDock, ChatContextKeys.panelLocation.isEqualTo(ViewContainerLocation.Sidebar));\n\t\tappendOpenChatInViewMenuItem(id, localize('interactiveSession.openInPanel.label', \"Move Chat into Panel\"), Codicon.layoutPanelDock, ChatContextKeys.panelLocation.isEqualTo(ViewContainerLocation.Panel));\n\t});\n}\n\nasync function executeMoveToAction(accessor: ServicesAccessor, moveTo: MoveToNewLocation, sessionResource?: URI) {\n\tconst widgetService = accessor.get(IChatWidgetService);\n\tconst editorService = accessor.get(IEditorService);\n\n\tconst auxiliary = { compact: true, bounds: { width: 800, height: 640 } };\n\n\tconst widget = (sessionResource ? widgetService.getWidgetBySessionResource(sessionResource) : undefined)\n\t\t?? widgetService.lastFocusedWidget;\n\tif (!widget || !widget.viewModel || widget.location !== ChatAgentLocation.Chat) {\n\t\tawait editorService.openEditor({ resource: ChatEditorInput.getNewEditorUri(), options: { pinned: true, auxiliary } }, moveTo === MoveToNewLocation.Window ? AUX_WINDOW_GROUP : ACTIVE_GROUP);\n\t\treturn;\n\t}\n\n\tconst existingWidget = widgetService.getWidgetBySessionResource(widget.viewModel.sessionResource);\n\tif (!existingWidget) {\n\t\t// Do NOT attempt to open a session that isn't already open since we cannot guarantee its state.\n\t\tawait editorService.openEditor({ resource: ChatEditorInput.getNewEditorUri(), options: { pinned: true, auxiliary } }, moveTo === MoveToNewLocation.Window ? AUX_WINDOW_GROUP : ACTIVE_GROUP);\n\t\treturn;\n\t}\n\n\t// Save off the session resource before clearing\n\tconst resourceToOpen = widget.viewModel.sessionResource;\n\n\t// Todo: can possibly go away with https://github.com/microsoft/vscode/pull/278476\n\tconst modelInputState = existingWidget.getViewState();\n\n\tawait widget.clear();\n\n\tconst options: IChatEditorOptions = { pinned: true, modelInputState, auxiliary };\n\tawait editorService.openEditor({ resource: resourceToOpen, options }, moveTo === MoveToNewLocation.Window ? AUX_WINDOW_GROUP : ACTIVE_GROUP);\n}\n\nasync function moveToSidebar(accessor: ServicesAccessor): Promise<void> {\n\tconst viewsService = accessor.get(IViewsService);\n\tconst editorService = accessor.get(IEditorService);\n\tconst editorGroupService = accessor.get(IEditorGroupsService);\n\n\tconst chatEditor = editorService.activeEditorPane;\n\tconst chatEditorInput = chatEditor?.input;\n\tlet view: ChatViewPane;\n\tif (chatEditor instanceof ChatEditor && chatEditorInput instanceof ChatEditorInput && chatEditorInput.sessionResource) {\n\t\tconst previousViewState = chatEditor.widget.getViewState();\n\t\tawait editorService.closeEditor({ editor: chatEditor.input, groupId: editorGroupService.activeGroup.id });\n\t\tview = await viewsService.openView(ChatViewId) as ChatViewPane;\n\n\t\t// Todo: can possibly go away with https://github.com/microsoft/vscode/pull/278476\n\t\tconst newModel = await view.loadSession(chatEditorInput.sessionResource);\n\t\tif (previousViewState && newModel && !newModel.inputModel.state.get()) {\n\t\t\tnewModel.inputModel.setState(previousViewState);\n\t\t}\n\t} else {\n\t\tview = await viewsService.openView(ChatViewId) as ChatViewPane;\n\t}\n\n\tview.focus();\n}\n"]}