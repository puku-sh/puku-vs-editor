{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatEditing/chatEditingTextModelContentProviders.ts","vs/workbench/contrib/chat/browser/chatEditing/chatEditingTextModelContentProviders.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;AAEhG,OAAO,EAAE,OAAO,EAAE,MAAM,uCAAuC,CAAC;AAChE,OAAO,EAAE,GAAG,EAAiB,MAAM,mCAAmC,CAAC;AAEvE,OAAO,EAAE,aAAa,EAAE,MAAM,gDAAgD,CAAC;AAMxE,IAAM,mCAAmC,GAAzC,MAAM,mCAAmC;;aACxB,WAAM,GAAG,OAAO,CAAC,gBAAX,AAA2B,CAAC;IAElD,MAAM,CAAC,UAAU,CAAC,mBAAwB,EAAE,UAAkB,EAAE,IAAY;QAClF,OAAO,GAAG,CAAC,IAAI,CAAC;YACf,MAAM,EAAE,qCAAmC,CAAC,MAAM;YAClD,IAAI;YACJ,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,UAAU,EAAE,mBAAmB,EAAiD,CAAC;SACtH,CAAC,CAAC;IACJ,CAAC;IAED,YACkB,mBAAwC,EACzB,aAA4B;QAD3C,wBAAmB,GAAnB,mBAAmB,CAAqB;QACzB,kBAAa,GAAb,aAAa,CAAe;IACzD,CAAC;IAEL,KAAK,CAAC,kBAAkB,CAAC,QAAa;QACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,EAAE,CAAC;YACxC,OAAO,QAAQ,CAAC;QACjB,CAAC;QAED,MAAM,IAAI,GAAyC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAE9E,MAAM,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC;QAEjG,MAAM,KAAK,GAAG,OAAO,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,OAAO,KAAK,IAAI,CAAC,UAAU,CAAC,CAAC;QAC9F,IAAI,CAAC,KAAK,EAAE,CAAC;YACZ,OAAO,IAAI,CAAC;QACb,CAAC;QAED,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;IACvD,CAAC;;AAhCW,mCAAmC;IAa7C,WAAA,aAAa,CAAA;GAbH,mCAAmC,CAiC/C;;AAIM,IAAM,2CAA2C,GAAjD,MAAM,2CAA2C;IAChD,MAAM,CAAC,kBAAkB,CAAC,mBAAwB,EAAE,SAA6B,EAAE,QAA4B,EAAE,IAAY,EAAE,MAAe;QACpJ,OAAO,GAAG,CAAC,IAAI,CAAC;YACf,MAAM,EAAE,OAAO,CAAC,yBAAyB;YACzC,IAAI;YACJ,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,mBAAmB,EAAE,SAAS,EAAE,SAAS,IAAI,EAAE,EAAE,QAAQ,EAAE,QAAQ,IAAI,EAAE,EAAE,MAAM,EAAyD,CAAC;SAC5K,CAAC,CAAC;IACJ,CAAC;IAED,YACkB,mBAAwC,EACzB,aAA4B;QAD3C,wBAAmB,GAAnB,mBAAmB,CAAqB;QACzB,kBAAa,GAAb,aAAa,CAAe;IACzD,CAAC;IAEL,KAAK,CAAC,kBAAkB,CAAC,QAAa;QACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,EAAE,CAAC;YACxC,OAAO,QAAQ,CAAC;QACjB,CAAC;QAED,MAAM,IAAI,GAAiD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QACtF,MAAM,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;QACrF,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YACjC,OAAO,IAAI,CAAC;QACb,CAAC;QAED,OAAO,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,IAAI,SAAS,EAAE,QAAQ,CAAC,CAAC;IACvF,CAAC;CACD,CAAA;AA5BY,2CAA2C;IAWrD,WAAA,aAAa,CAAA;GAXH,2CAA2C,CA4BvD","file":"chatEditingTextModelContentProviders.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ITextModelContentProvider } from '../../../../../editor/common/services/resolverService.js';\nimport { IChatEditingService } from '../../common/chatEditingService.js';\n\ntype ChatEditingTextModelContentQueryData = { kind: 'doc'; documentId: string; chatSessionResource: UriComponents };\n\nexport class ChatEditingTextModelContentProvider implements ITextModelContentProvider {\n\tpublic static readonly scheme = Schemas.chatEditingModel;\n\n\tpublic static getFileURI(chatSessionResource: URI, documentId: string, path: string): URI {\n\t\treturn URI.from({\n\t\t\tscheme: ChatEditingTextModelContentProvider.scheme,\n\t\t\tpath,\n\t\t\tquery: JSON.stringify({ kind: 'doc', documentId, chatSessionResource } satisfies ChatEditingTextModelContentQueryData),\n\t\t});\n\t}\n\n\tconstructor(\n\t\tprivate readonly _chatEditingService: IChatEditingService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) { }\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst data: ChatEditingTextModelContentQueryData = JSON.parse(resource.query);\n\n\t\tconst session = this._chatEditingService.getEditingSession(URI.revive(data.chatSessionResource));\n\n\t\tconst entry = session?.entries.get().find(candidate => candidate.entryId === data.documentId);\n\t\tif (!entry) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this._modelService.getModel(entry.originalURI);\n\t}\n}\n\ntype ChatEditingSnapshotTextModelContentQueryData = { session: UriComponents; requestId: string | undefined; undoStop: string | undefined; scheme: string | undefined };\n\nexport class ChatEditingSnapshotTextModelContentProvider implements ITextModelContentProvider {\n\tpublic static getSnapshotFileURI(chatSessionResource: URI, requestId: string | undefined, undoStop: string | undefined, path: string, scheme?: string): URI {\n\t\treturn URI.from({\n\t\t\tscheme: Schemas.chatEditingSnapshotScheme,\n\t\t\tpath,\n\t\t\tquery: JSON.stringify({ session: chatSessionResource, requestId: requestId ?? '', undoStop: undoStop ?? '', scheme } satisfies ChatEditingSnapshotTextModelContentQueryData),\n\t\t});\n\t}\n\n\tconstructor(\n\t\tprivate readonly _chatEditingService: IChatEditingService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) { }\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst data: ChatEditingSnapshotTextModelContentQueryData = JSON.parse(resource.query);\n\t\tconst session = this._chatEditingService.getEditingSession(URI.revive(data.session));\n\t\tif (!session || !data.requestId) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn session.getSnapshotModel(data.requestId, data.undoStop || undefined, resource);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ITextModelContentProvider } from '../../../../../editor/common/services/resolverService.js';\nimport { IChatEditingService } from '../../common/chatEditingService.js';\n\ntype ChatEditingTextModelContentQueryData = { kind: 'doc'; documentId: string; chatSessionResource: UriComponents };\n\nexport class ChatEditingTextModelContentProvider implements ITextModelContentProvider {\n\tpublic static readonly scheme = Schemas.chatEditingModel;\n\n\tpublic static getFileURI(chatSessionResource: URI, documentId: string, path: string): URI {\n\t\treturn URI.from({\n\t\t\tscheme: ChatEditingTextModelContentProvider.scheme,\n\t\t\tpath,\n\t\t\tquery: JSON.stringify({ kind: 'doc', documentId, chatSessionResource } satisfies ChatEditingTextModelContentQueryData),\n\t\t});\n\t}\n\n\tconstructor(\n\t\tprivate readonly _chatEditingService: IChatEditingService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) { }\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst data: ChatEditingTextModelContentQueryData = JSON.parse(resource.query);\n\n\t\tconst session = this._chatEditingService.getEditingSession(URI.revive(data.chatSessionResource));\n\n\t\tconst entry = session?.entries.get().find(candidate => candidate.entryId === data.documentId);\n\t\tif (!entry) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this._modelService.getModel(entry.originalURI);\n\t}\n}\n\ntype ChatEditingSnapshotTextModelContentQueryData = { session: UriComponents; requestId: string | undefined; undoStop: string | undefined; scheme: string | undefined };\n\nexport class ChatEditingSnapshotTextModelContentProvider implements ITextModelContentProvider {\n\tpublic static getSnapshotFileURI(chatSessionResource: URI, requestId: string | undefined, undoStop: string | undefined, path: string, scheme?: string): URI {\n\t\treturn URI.from({\n\t\t\tscheme: Schemas.chatEditingSnapshotScheme,\n\t\t\tpath,\n\t\t\tquery: JSON.stringify({ session: chatSessionResource, requestId: requestId ?? '', undoStop: undoStop ?? '', scheme } satisfies ChatEditingSnapshotTextModelContentQueryData),\n\t\t});\n\t}\n\n\tconstructor(\n\t\tprivate readonly _chatEditingService: IChatEditingService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t) { }\n\n\tasync provideTextContent(resource: URI): Promise<ITextModel | null> {\n\t\tconst existing = this._modelService.getModel(resource);\n\t\tif (existing && !existing.isDisposed()) {\n\t\t\treturn existing;\n\t\t}\n\n\t\tconst data: ChatEditingSnapshotTextModelContentQueryData = JSON.parse(resource.query);\n\t\tconst session = this._chatEditingService.getEditingSession(URI.revive(data.session));\n\t\tif (!session || !data.requestId) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn session.getSnapshotModel(data.requestId, data.undoStop || undefined, resource);\n\t}\n}\n"]}