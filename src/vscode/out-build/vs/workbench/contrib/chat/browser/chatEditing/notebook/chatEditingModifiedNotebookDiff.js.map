{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatEditing/notebook/chatEditingModifiedNotebookDiff.ts","vs/workbench/contrib/chat/browser/chatEditing/notebook/chatEditingModifiedNotebookDiff.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,eAAe,EAAE,MAAM,4CAA4C,CAAC;AAC7E,OAAO,EAAE,WAAW,EAAE,MAAM,6CAA6C,CAAC;AAC1E,OAAO,EAAE,mCAAmC,EAAE,MAAM,mEAAmE,CAAC;AACxH,OAAO,EAAE,uBAAuB,EAAE,MAAM,uDAAuD,CAAC;AAChG,OAAO,EAAE,4BAA4B,EAAE,MAAM,+DAA+D,CAAC;AAItG,IAAM,+BAA+B,GAArC,MAAM,+BAA+B;aACpC,oBAAe,GAAW,CAAX,AAAY,CAAC;IACnC,YACkB,QAAwB,EACxB,QAAwB,EACM,2BAAyD,EAC9D,sBAA+C,EACnC,0BAA+D;QAJpG,aAAQ,GAAR,QAAQ,CAAgB;QACxB,aAAQ,GAAR,QAAQ,CAAgB;QACM,gCAA2B,GAA3B,2BAA2B,CAA8B;QAC9D,2BAAsB,GAAtB,sBAAsB,CAAyB;QACnC,+BAA0B,GAA1B,0BAA0B,CAAqC;IAGtH,CAAC;IAED,KAAK,CAAC,WAAW;QAEhB,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,OAAO,GAAG,CAAC,CAAC;QAEhB,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;QAC1C,IAAI,CAAC;YACJ,MAAM,CAAC,WAAW,EAAE,WAAW,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;gBACpD,IAAI,CAAC,0BAA0B,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC;gBAClE,IAAI,CAAC,0BAA0B,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC;aAClE,CAAC,CAAC;YACH,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAC7B,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAC7B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,2BAA2B,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YAC9H,MAAM,MAAM,GAAG,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;YACnG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBAClC,QAAQ,IAAI,CAAC,IAAI,EAAE,CAAC;oBACnB,KAAK,UAAU,CAAC;oBAChB,KAAK,QAAQ;wBACZ,KAAK,EAAE,CAAC;wBACR,MAAM;oBACP,KAAK,QAAQ;wBACZ,OAAO,EAAE,CAAC;wBACV,MAAM;oBACP;wBACC,MAAM;gBACR,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,eAAe,EAAE,yBAAyB,GAAG,CAAC,CAAC,CAAC;QACnF,CAAC;gBAAS,CAAC;YACV,WAAW,CAAC,OAAO,EAAE,CAAC;QACvB,CAAC;QAED,OAAO;YACN,KAAK;YACL,OAAO;YACP,SAAS,EAAE,KAAK,KAAK,CAAC,IAAI,OAAO,KAAK,CAAC;YACvC,SAAS,EAAE,KAAK;YAChB,OAAO,EAAE,IAAI;YACb,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW;YACtC,WAAW,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW;SACtC,CAAC;IACH,CAAC;;AAvDW,+BAA+B;IAKzC,WAAA,4BAA4B,CAAA;IAC5B,WAAA,uBAAuB,CAAA;IACvB,WAAA,mCAAmC,CAAA;GAPzB,+BAA+B,CAwD3C","file":"chatEditingModifiedNotebookDiff.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { computeDiff } from '../../../../notebook/common/notebookDiff.js';\nimport { INotebookEditorModelResolverService } from '../../../../notebook/common/notebookEditorModelResolverService.js';\nimport { INotebookLoggingService } from '../../../../notebook/common/notebookLoggingService.js';\nimport { INotebookEditorWorkerService } from '../../../../notebook/common/services/notebookWorkerService.js';\nimport { IEditSessionEntryDiff, ISnapshotEntry } from '../../../common/chatEditingService.js';\n\n\nexport class ChatEditingModifiedNotebookDiff {\n\tstatic NewModelCounter: number = 0;\n\tconstructor(\n\t\tprivate readonly original: ISnapshotEntry,\n\t\tprivate readonly modified: ISnapshotEntry,\n\t\t@INotebookEditorWorkerService private readonly notebookEditorWorkerService: INotebookEditorWorkerService,\n\t\t@INotebookLoggingService private readonly notebookLoggingService: INotebookLoggingService,\n\t\t@INotebookEditorModelResolverService private readonly notebookEditorModelService: INotebookEditorModelResolverService,\n\t) {\n\n\t}\n\n\tasync computeDiff(): Promise<IEditSessionEntryDiff> {\n\n\t\tlet added = 0;\n\t\tlet removed = 0;\n\n\t\tconst disposables = new DisposableStore();\n\t\ttry {\n\t\t\tconst [modifiedRef, originalRef] = await Promise.all([\n\t\t\t\tthis.notebookEditorModelService.resolve(this.modified.snapshotUri),\n\t\t\t\tthis.notebookEditorModelService.resolve(this.original.snapshotUri)\n\t\t\t]);\n\t\t\tdisposables.add(modifiedRef);\n\t\t\tdisposables.add(originalRef);\n\t\t\tconst notebookDiff = await this.notebookEditorWorkerService.computeDiff(this.original.snapshotUri, this.modified.snapshotUri);\n\t\t\tconst result = computeDiff(originalRef.object.notebook, modifiedRef.object.notebook, notebookDiff);\n\t\t\tresult.cellDiffInfo.forEach(diff => {\n\t\t\t\tswitch (diff.type) {\n\t\t\t\t\tcase 'modified':\n\t\t\t\t\tcase 'insert':\n\t\t\t\t\t\tadded++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'delete':\n\t\t\t\t\t\tremoved++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tthis.notebookLoggingService.error('Notebook Chat', 'Error computing diff:\\n' + e);\n\t\t} finally {\n\t\t\tdisposables.dispose();\n\t\t}\n\n\t\treturn {\n\t\t\tadded,\n\t\t\tremoved,\n\t\t\tidentical: added === 0 && removed === 0,\n\t\t\tquitEarly: false,\n\t\t\tisFinal: true,\n\t\t\tmodifiedURI: this.modified.snapshotUri,\n\t\t\toriginalURI: this.original.snapshotUri,\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { computeDiff } from '../../../../notebook/common/notebookDiff.js';\nimport { INotebookEditorModelResolverService } from '../../../../notebook/common/notebookEditorModelResolverService.js';\nimport { INotebookLoggingService } from '../../../../notebook/common/notebookLoggingService.js';\nimport { INotebookEditorWorkerService } from '../../../../notebook/common/services/notebookWorkerService.js';\nimport { IEditSessionEntryDiff, ISnapshotEntry } from '../../../common/chatEditingService.js';\n\n\nexport class ChatEditingModifiedNotebookDiff {\n\tstatic NewModelCounter: number = 0;\n\tconstructor(\n\t\tprivate readonly original: ISnapshotEntry,\n\t\tprivate readonly modified: ISnapshotEntry,\n\t\t@INotebookEditorWorkerService private readonly notebookEditorWorkerService: INotebookEditorWorkerService,\n\t\t@INotebookLoggingService private readonly notebookLoggingService: INotebookLoggingService,\n\t\t@INotebookEditorModelResolverService private readonly notebookEditorModelService: INotebookEditorModelResolverService,\n\t) {\n\n\t}\n\n\tasync computeDiff(): Promise<IEditSessionEntryDiff> {\n\n\t\tlet added = 0;\n\t\tlet removed = 0;\n\n\t\tconst disposables = new DisposableStore();\n\t\ttry {\n\t\t\tconst [modifiedRef, originalRef] = await Promise.all([\n\t\t\t\tthis.notebookEditorModelService.resolve(this.modified.snapshotUri),\n\t\t\t\tthis.notebookEditorModelService.resolve(this.original.snapshotUri)\n\t\t\t]);\n\t\t\tdisposables.add(modifiedRef);\n\t\t\tdisposables.add(originalRef);\n\t\t\tconst notebookDiff = await this.notebookEditorWorkerService.computeDiff(this.original.snapshotUri, this.modified.snapshotUri);\n\t\t\tconst result = computeDiff(originalRef.object.notebook, modifiedRef.object.notebook, notebookDiff);\n\t\t\tresult.cellDiffInfo.forEach(diff => {\n\t\t\t\tswitch (diff.type) {\n\t\t\t\t\tcase 'modified':\n\t\t\t\t\tcase 'insert':\n\t\t\t\t\t\tadded++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'delete':\n\t\t\t\t\t\tremoved++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tthis.notebookLoggingService.error('Notebook Chat', 'Error computing diff:\\n' + e);\n\t\t} finally {\n\t\t\tdisposables.dispose();\n\t\t}\n\n\t\treturn {\n\t\t\tadded,\n\t\t\tremoved,\n\t\t\tidentical: added === 0 && removed === 0,\n\t\t\tquitEarly: false,\n\t\t\tisFinal: true,\n\t\t\tmodifiedURI: this.modified.snapshotUri,\n\t\t\toriginalURI: this.original.snapshotUri,\n\t\t};\n\t}\n}\n"]}