{"version":3,"sources":["vs/workbench/contrib/chat/browser/promptSyntax/pickers/askForPromptSourceFolder.ts"],"names":[],"mappings":"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","file":"askForPromptSourceFolder.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { extUri, isEqual } from '../../../../../../base/common/resources.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ServicesAccessor } from '../../../../../../editor/browser/editorExtensions.js';\nimport { localize } from '../../../../../../nls.js';\nimport { ILabelService } from '../../../../../../platform/label/common/label.js';\nimport { IOpenerService } from '../../../../../../platform/opener/common/opener.js';\nimport { PROMPT_DOCUMENTATION_URL, PromptsType } from '../../../common/promptSyntax/promptTypes.js';\nimport { IPickOptions, IQuickInputService, IQuickPickItem } from '../../../../../../platform/quickinput/common/quickInput.js';\nimport { IWorkspaceContextService } from '../../../../../../platform/workspace/common/workspace.js';\nimport { IPromptPath, IPromptsService, PromptsStorage } from '../../../common/promptSyntax/service/promptsService.js';\n\n\ninterface IFolderQuickPickItem extends IQuickPickItem {\n\treadonly folder: IPromptPath;\n}\n\n/**\n * Asks the user for a specific prompt folder, if multiple folders provided.\n */\nexport async function askForPromptSourceFolder(\n\taccessor: ServicesAccessor,\n\ttype: PromptsType,\n\texistingFolder?: URI | undefined,\n\tisMove: boolean = false,\n): Promise<IPromptPath | undefined> {\n\tconst quickInputService = accessor.get(IQuickInputService);\n\tconst promptsService = accessor.get(IPromptsService);\n\tconst labelService = accessor.get(ILabelService);\n\tconst workspaceService = accessor.get(IWorkspaceContextService);\n\n\t// get prompts source folders based on the prompt type\n\tconst folders = promptsService.getSourceFolders(type);\n\n\t// if no source folders found, show 'learn more' dialog\n\t// note! this is a temporary solution and must be replaced with a dialog to select\n\t//       a custom folder path, or switch to a different prompt type\n\tif (folders.length === 0) {\n\t\tawait showNoFoldersDialog(accessor, type);\n\t\treturn;\n\t}\n\n\tconst pickOptions: IPickOptions<IFolderQuickPickItem> = {\n\t\tplaceHolder: existingFolder ? getPlaceholderStringforMove(type, isMove) : getPlaceholderStringforNew(type),\n\t\tcanPickMany: false,\n\t\tmatchOnDescription: true,\n\t};\n\n\t// create list of source folder locations\n\tconst foldersList = folders.map<IFolderQuickPickItem>(folder => {\n\t\tconst uri = folder.uri;\n\t\tconst detail = (existingFolder && isEqual(uri, existingFolder)) ? localize('current.folder', \"Current Location\") : undefined;\n\t\tif (folder.storage !== PromptsStorage.local) {\n\t\t\treturn {\n\t\t\t\ttype: 'item',\n\t\t\t\tlabel: promptsService.getPromptLocationLabel(folder),\n\t\t\t\tdetail,\n\t\t\t\ttooltip: labelService.getUriLabel(uri),\n\t\t\t\tfolder\n\t\t\t};\n\t\t}\n\n\t\tconst { folders } = workspaceService.getWorkspace();\n\t\tconst isMultirootWorkspace = (folders.length > 1);\n\n\t\tconst firstFolder = folders[0];\n\n\t\t// if multi-root or empty workspace, or source folder `uri` does not point to\n\t\t// the root folder of a single-root workspace, return the default label and description\n\t\tif (isMultirootWorkspace || !firstFolder || !extUri.isEqual(firstFolder.uri, uri)) {\n\t\t\treturn {\n\t\t\t\ttype: 'item',\n\t\t\t\tlabel: labelService.getUriLabel(uri, { relative: true }),\n\t\t\t\tdetail,\n\t\t\t\ttooltip: labelService.getUriLabel(uri),\n\t\t\t\tfolder,\n\t\t\t};\n\t\t}\n\n\t\t// if source folder points to the root of this single-root workspace,\n\t\t// use appropriate label and description strings to prevent confusion\n\t\treturn {\n\t\t\ttype: 'item',\n\t\t\tlabel: localize(\n\t\t\t\t'commands.prompts.create.source-folder.current-workspace',\n\t\t\t\t\"Current Workspace\",\n\t\t\t),\n\t\t\tdetail,\n\t\t\ttooltip: labelService.getUriLabel(uri),\n\t\t\tfolder,\n\t\t};\n\t});\n\n\tconst answer = await quickInputService.pick(foldersList, pickOptions);\n\tif (!answer) {\n\t\treturn;\n\t}\n\n\treturn answer.folder;\n}\n\nfunction getPlaceholderStringforNew(type: PromptsType): string {\n\tswitch (type) {\n\t\tcase PromptsType.instructions:\n\t\t\treturn localize('workbench.command.instructions.create.location.placeholder', \"Select a location to create the instructions file in...\");\n\t\tcase PromptsType.prompt:\n\t\t\treturn localize('workbench.command.prompt.create.location.placeholder', \"Select a location to create the prompt file in...\");\n\t\tcase PromptsType.agent:\n\t\t\treturn localize('workbench.command.agent.create.location.placeholder', \"Select a location to create the agent file in...\");\n\t\tdefault:\n\t\t\tthrow new Error('Unknown prompt type');\n\t}\n}\n\nfunction getPlaceholderStringforMove(type: PromptsType, isMove: boolean): string {\n\tif (isMove) {\n\t\tswitch (type) {\n\t\t\tcase PromptsType.instructions:\n\t\t\t\treturn localize('instructions.move.location.placeholder', \"Select a location to move the instructions file to...\");\n\t\t\tcase PromptsType.prompt:\n\t\t\t\treturn localize('prompt.move.location.placeholder', \"Select a location to move the prompt file to...\");\n\t\t\tcase PromptsType.agent:\n\t\t\t\treturn localize('agent.move.location.placeholder', \"Select a location to move the agent file to...\");\n\t\t\tdefault:\n\t\t\t\tthrow new Error('Unknown prompt type');\n\t\t}\n\t}\n\tswitch (type) {\n\t\tcase PromptsType.instructions:\n\t\t\treturn localize('instructions.copy.location.placeholder', \"Select a location to copy the instructions file to...\");\n\t\tcase PromptsType.prompt:\n\t\t\treturn localize('prompt.copy.location.placeholder', \"Select a location to copy the prompt file to...\");\n\t\tcase PromptsType.agent:\n\t\t\treturn localize('agent.copy.location.placeholder', \"Select a location to copy the agent file to...\");\n\t\tdefault:\n\t\t\tthrow new Error('Unknown prompt type');\n\t}\n}\n\n/**\n * Shows a dialog to the user when no prompt source folders are found.\n *\n * Note! this is a temporary solution and must be replaced with a dialog to select\n *       a custom folder path, or switch to a different prompt type\n */\nasync function showNoFoldersDialog(accessor: ServicesAccessor, type: PromptsType): Promise<void> {\n\tconst quickInputService = accessor.get(IQuickInputService);\n\tconst openerService = accessor.get(IOpenerService);\n\n\tconst docsQuickPick: IQuickPickItem & { value: URI } = {\n\t\ttype: 'item',\n\t\tlabel: getLearnLabel(type),\n\t\tdescription: PROMPT_DOCUMENTATION_URL,\n\t\ttooltip: PROMPT_DOCUMENTATION_URL,\n\t\tvalue: URI.parse(PROMPT_DOCUMENTATION_URL),\n\t};\n\n\tconst result = await quickInputService.pick(\n\t\t[docsQuickPick],\n\t\t{\n\t\t\tplaceHolder: getMissingSourceFolderString(type),\n\t\t\tcanPickMany: false,\n\t\t});\n\n\tif (result) {\n\t\tawait openerService.open(result.value);\n\t}\n}\n\nfunction getLearnLabel(type: PromptsType): string {\n\tswitch (type) {\n\t\tcase PromptsType.prompt:\n\t\t\treturn localize('commands.prompts.create.ask-folder.empty.docs-label', 'Learn how to configure reusable prompts');\n\t\tcase PromptsType.instructions:\n\t\t\treturn localize('commands.instructions.create.ask-folder.empty.docs-label', 'Learn how to configure reusable instructions');\n\t\tcase PromptsType.agent:\n\t\t\treturn localize('commands.agent.create.ask-folder.empty.docs-label', 'Learn how to configure custom agents');\n\t\tdefault:\n\t\t\tthrow new Error('Unknown prompt type');\n\t}\n}\n\nfunction getMissingSourceFolderString(type: PromptsType): string {\n\tswitch (type) {\n\t\tcase PromptsType.instructions:\n\t\t\treturn localize('commands.instructions.create.ask-folder.empty.placeholder', 'No instruction source folders found.');\n\t\tcase PromptsType.prompt:\n\t\t\treturn localize('commands.prompts.create.ask-folder.empty.placeholder', 'No prompt source folders found.');\n\t\tcase PromptsType.agent:\n\t\t\treturn localize('commands.agent.create.ask-folder.empty.placeholder', 'No agent source folders found.');\n\t\tdefault:\n\t\t\tthrow new Error('Unknown prompt type');\n\t}\n}\n"]}