{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/browser/chatVariables.ts","vs/workbench/contrib/chat/browser/chatVariables.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAIhG,OAAO,EAAE,kBAAkB,EAAE,MAAM,WAAW,CAAC;AAC/C,OAAO,EAAE,wBAAwB,EAAE,MAAM,mCAAmC,CAAC;AAC7E,OAAO,EAAE,KAAK,EAAE,MAAM,yCAAyC,CAAC;AAGzD,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAGhC,YACsC,iBAAqC;QAArC,sBAAiB,GAAjB,iBAAiB,CAAoB;IACvE,CAAC;IAEL,mBAAmB,CAAC,eAAoB;QACvC,wJAAwJ;QACxJ,cAAc;QACd,uDAAuD;QACvD,wKAAwK;QACxK,MAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,0BAA0B,CAAC,eAAe,CAAC,CAAC;QAClF,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,MAAM,CAAC,sBAAsB,EAAE,CAAC;YACpE,OAAO,EAAE,CAAC;QACX,CAAC;QAED,MAAM,KAAK,GAAG,MAAM,CAAC,UAAU,CAA2B,wBAAwB,CAAC,EAAE,CAAC,CAAC;QACvF,IAAI,CAAC,KAAK,EAAE,CAAC;YACZ,OAAO,EAAE,CAAC;QACX,CAAC;QAED,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,IAAI,MAAM,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YACrF,MAAM,UAAU,GAAuB,EAAE,CAAC;YAC1C,KAAK,MAAM,UAAU,IAAI,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,WAAW,EAAE,CAAC;gBACnE,0DAA0D;gBAC1D,IAAI,UAAU,CAAC,KAAK,EAAE,CAAC;oBACtB,MAAM,YAAY,GAAqB;wBACtC,EAAE,EAAE,UAAU,CAAC,EAAE;wBACjB,QAAQ,EAAE,UAAU,CAAC,IAAI;wBACzB,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;wBAC7C,KAAK,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,KAAK,CAAC,YAAY,GAAG,CAAC,CAAC;wBACrF,IAAI,EAAE,UAAU,CAAC,IAAI;wBACrB,MAAM,EAAE,UAAU,CAAC,IAAI,KAAK,MAAM;wBAClC,WAAW,EAAE,UAAU,CAAC,IAAI,KAAK,WAAW;wBAC5C,IAAI,EAAE,UAAU,CAAC,KAAK;qBACtB,CAAC;oBACF,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBAC/B,CAAC;YACF,CAAC;YAED,OAAO,CAAC,GAAG,KAAK,CAAC,SAAS,EAAE,GAAG,UAAU,CAAC,CAAC;QAC5C,CAAC;QAED,OAAO,KAAK,CAAC,SAAS,CAAC;IACxB,CAAC;IAED,0BAA0B,CAAC,eAAoB;QAC9C,MAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,0BAA0B,CAAC,eAAe,CAAC,CAAC;QAClF,IAAI,CAAC,MAAM,EAAE,CAAC;YACb,OAAO,IAAI,GAAG,EAAE,CAAC;QAClB,CAAC;QACD,OAAO,MAAM,CAAC,KAAK,CAAC,kBAAkB,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC;IAEzD,CAAC;CACD,CAAA;AAvDY,oBAAoB;IAI9B,WAAA,kBAAkB,CAAA;GAJR,oBAAoB,CAuDhC","file":"chatVariables.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChatVariablesService, IDynamicVariable } from '../common/chatVariables.js';\nimport { IToolAndToolSetEnablementMap } from '../common/languageModelToolsService.js';\nimport { IChatWidgetService } from './chat.js';\nimport { ChatDynamicVariableModel } from './contrib/chatDynamicVariables.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { URI } from '../../../../base/common/uri.js';\n\nexport class ChatVariablesService implements IChatVariablesService {\n\tdeclare _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IChatWidgetService private readonly chatWidgetService: IChatWidgetService,\n\t) { }\n\n\tgetDynamicVariables(sessionResource: URI): ReadonlyArray<IDynamicVariable> {\n\t\t// This is slightly wrong... the parser pulls dynamic references from the input widget, but there is no guarantee that message came from the input here.\n\t\t// Need to ...\n\t\t// - Parser takes list of dynamic references (annoying)\n\t\t// - Or the parser is known to implicitly act on the input widget, and we need to call it before calling the chat service (maybe incompatible with the future, but easy)\n\t\tconst widget = this.chatWidgetService.getWidgetBySessionResource(sessionResource);\n\t\tif (!widget || !widget.viewModel || !widget.supportsFileReferences) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst model = widget.getContrib<ChatDynamicVariableModel>(ChatDynamicVariableModel.ID);\n\t\tif (!model) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (widget.input.attachmentModel.attachments.length > 0 && widget.viewModel.editing) {\n\t\t\tconst references: IDynamicVariable[] = [];\n\t\t\tfor (const attachment of widget.input.attachmentModel.attachments) {\n\t\t\t\t// If the attachment has a range, it is a dynamic variable\n\t\t\t\tif (attachment.range) {\n\t\t\t\t\tconst referenceObj: IDynamicVariable = {\n\t\t\t\t\t\tid: attachment.id,\n\t\t\t\t\t\tfullName: attachment.name,\n\t\t\t\t\t\tmodelDescription: attachment.modelDescription,\n\t\t\t\t\t\trange: new Range(1, attachment.range.start + 1, 1, attachment.range.endExclusive + 1),\n\t\t\t\t\t\ticon: attachment.icon,\n\t\t\t\t\t\tisFile: attachment.kind === 'file',\n\t\t\t\t\t\tisDirectory: attachment.kind === 'directory',\n\t\t\t\t\t\tdata: attachment.value\n\t\t\t\t\t};\n\t\t\t\t\treferences.push(referenceObj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [...model.variables, ...references];\n\t\t}\n\n\t\treturn model.variables;\n\t}\n\n\tgetSelectedToolAndToolSets(sessionResource: URI): IToolAndToolSetEnablementMap {\n\t\tconst widget = this.chatWidgetService.getWidgetBySessionResource(sessionResource);\n\t\tif (!widget) {\n\t\t\treturn new Map();\n\t\t}\n\t\treturn widget.input.selectedToolsModel.entriesMap.get();\n\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChatVariablesService, IDynamicVariable } from '../common/chatVariables.js';\nimport { IToolAndToolSetEnablementMap } from '../common/languageModelToolsService.js';\nimport { IChatWidgetService } from './chat.js';\nimport { ChatDynamicVariableModel } from './contrib/chatDynamicVariables.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { URI } from '../../../../base/common/uri.js';\n\nexport class ChatVariablesService implements IChatVariablesService {\n\tdeclare _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IChatWidgetService private readonly chatWidgetService: IChatWidgetService,\n\t) { }\n\n\tgetDynamicVariables(sessionResource: URI): ReadonlyArray<IDynamicVariable> {\n\t\t// This is slightly wrong... the parser pulls dynamic references from the input widget, but there is no guarantee that message came from the input here.\n\t\t// Need to ...\n\t\t// - Parser takes list of dynamic references (annoying)\n\t\t// - Or the parser is known to implicitly act on the input widget, and we need to call it before calling the chat service (maybe incompatible with the future, but easy)\n\t\tconst widget = this.chatWidgetService.getWidgetBySessionResource(sessionResource);\n\t\tif (!widget || !widget.viewModel || !widget.supportsFileReferences) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst model = widget.getContrib<ChatDynamicVariableModel>(ChatDynamicVariableModel.ID);\n\t\tif (!model) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (widget.input.attachmentModel.attachments.length > 0 && widget.viewModel.editing) {\n\t\t\tconst references: IDynamicVariable[] = [];\n\t\t\tfor (const attachment of widget.input.attachmentModel.attachments) {\n\t\t\t\t// If the attachment has a range, it is a dynamic variable\n\t\t\t\tif (attachment.range) {\n\t\t\t\t\tconst referenceObj: IDynamicVariable = {\n\t\t\t\t\t\tid: attachment.id,\n\t\t\t\t\t\tfullName: attachment.name,\n\t\t\t\t\t\tmodelDescription: attachment.modelDescription,\n\t\t\t\t\t\trange: new Range(1, attachment.range.start + 1, 1, attachment.range.endExclusive + 1),\n\t\t\t\t\t\ticon: attachment.icon,\n\t\t\t\t\t\tisFile: attachment.kind === 'file',\n\t\t\t\t\t\tisDirectory: attachment.kind === 'directory',\n\t\t\t\t\t\tdata: attachment.value\n\t\t\t\t\t};\n\t\t\t\t\treferences.push(referenceObj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [...model.variables, ...references];\n\t\t}\n\n\t\treturn model.variables;\n\t}\n\n\tgetSelectedToolAndToolSets(sessionResource: URI): IToolAndToolSetEnablementMap {\n\t\tconst widget = this.chatWidgetService.getWidgetBySessionResource(sessionResource);\n\t\tif (!widget) {\n\t\t\treturn new Map();\n\t\t}\n\t\treturn widget.input.selectedToolsModel.entriesMap.get();\n\n\t}\n}\n"]}