{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatPromptNavigationActions.ts"],"names":[],"mappings":"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","file":"chatPromptNavigationActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { KeyCode, KeyMod } from '../../../../../base/common/keyCodes.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { localize2 } from '../../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { KeybindingWeight } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { IChatRequestViewModel, isRequestVM, isResponseVM } from '../../common/chatViewModel.js';\n\nexport function registerChatPromptNavigationActions() {\n\tregisterAction2(class NextUserPromptAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.nextUserPrompt',\n\t\t\t\ttitle: localize2('interactive.nextUserPrompt.label', \"Next User Prompt\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.DownArrow,\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\twhen: ChatContextKeys.inChatSession,\n\t\t\t\t},\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\tnavigateUserPrompts(accessor, false);\n\t\t}\n\t});\n\n\tregisterAction2(class PreviousUserPromptAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.previousUserPrompt',\n\t\t\t\ttitle: localize2('interactive.previousUserPrompt.label', \"Previous User Prompt\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.UpArrow,\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\twhen: ChatContextKeys.inChatSession,\n\t\t\t\t},\n\t\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\t\tf1: true,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\t\tnavigateUserPrompts(accessor, true);\n\t\t}\n\t});\n}\n\nfunction navigateUserPrompts(accessor: ServicesAccessor, reverse: boolean) {\n\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\tconst widget = chatWidgetService.lastFocusedWidget;\n\tif (!widget) {\n\t\treturn;\n\t}\n\n\tconst items = widget.viewModel?.getItems();\n\tif (!items || items.length === 0) {\n\t\treturn;\n\t}\n\n\t// Get all user prompts (requests) in the conversation\n\tconst userPrompts = items.filter((item): item is IChatRequestViewModel => isRequestVM(item));\n\tif (userPrompts.length === 0) {\n\t\treturn;\n\t}\n\n\t// Find the currently focused item\n\tconst focused = widget.getFocus();\n\tlet currentIndex = -1;\n\n\tif (focused) {\n\t\tif (isRequestVM(focused)) {\n\t\t\t// If a request is focused, find its index in the user prompts array\n\t\t\tcurrentIndex = userPrompts.findIndex(prompt => prompt.id === focused.id);\n\t\t} else if (isResponseVM(focused)) {\n\t\t\t// If a response is focused, find the associated request's index\n\t\t\t// Response view models have a requestId property\n\t\t\tcurrentIndex = userPrompts.findIndex(prompt => prompt.id === focused.requestId);\n\t\t}\n\t}\n\n\t// Calculate next index\n\tlet nextIndex: number;\n\tif (currentIndex === -1) {\n\t\t// No current focus, go to first or last prompt based on direction\n\t\tnextIndex = reverse ? userPrompts.length - 1 : 0;\n\t} else {\n\t\t// Navigate to next/previous prompt\n\t\tnextIndex = reverse ? currentIndex - 1 : currentIndex + 1;\n\n\t\t// Clamp instead of wrap and stay at boundaries when trying to navigate past ends\n\t\tif (nextIndex < 0) {\n\t\t\tnextIndex = 0; // already at first, do not move further\n\t\t} else if (nextIndex >= userPrompts.length) {\n\t\t\tnextIndex = userPrompts.length - 1; // already at last, do not move further\n\t\t}\n\n\t\t// avoid re-focusing if we didn't actually move\n\t\tif (nextIndex === currentIndex) {\n\t\t\treturn; // no change in focus\n\t\t}\n\t}\n\n\t// Focus and reveal the selected user prompt\n\tconst targetPrompt = userPrompts[nextIndex];\n\tif (targetPrompt) {\n\t\twidget.focus(targetPrompt);\n\t\twidget.reveal(targetPrompt);\n\t}\n}\n"]}