{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatEditing/chatEditingActions.ts"],"names":[],"mappings":"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","file":"chatEditingActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { KeyCode, KeyMod } from '../../../../../base/common/keyCodes.js';\nimport { basename } from '../../../../../base/common/resources.js';\nimport { URI, UriComponents } from '../../../../../base/common/uri.js';\nimport { isCodeEditor } from '../../../../../editor/browser/editorBrowser.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { Position } from '../../../../../editor/common/core/position.js';\nimport { EditorContextKeys } from '../../../../../editor/common/editorContextKeys.js';\nimport { isLocation, Location } from '../../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { ILanguageFeaturesService } from '../../../../../editor/common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, IAction2Options, MenuId, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { EditorActivation } from '../../../../../platform/editor/common/editor.js';\nimport { KeybindingWeight } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IEditorPane } from '../../../../common/editor.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { isChatViewTitleActionContext } from '../../common/chatActions.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { applyingChatEditsFailedContextKey, CHAT_EDITING_MULTI_DIFF_SOURCE_RESOLVER_SCHEME, chatEditingResourceContextKey, chatEditingWidgetFileStateContextKey, decidedChatEditingResourceContextKey, hasAppliedChatEditsContextKey, hasUndecidedChatEditingResourceContextKey, IChatEditingService, IChatEditingSession, ModifiedFileEntryState } from '../../common/chatEditingService.js';\nimport { IChatService } from '../../common/chatService.js';\nimport { isRequestVM, isResponseVM } from '../../common/chatViewModel.js';\nimport { ChatAgentLocation, ChatConfiguration, ChatModeKind } from '../../common/constants.js';\nimport { CHAT_CATEGORY } from '../actions/chatActions.js';\nimport { ChatTreeItem, IChatWidget, IChatWidgetService } from '../chat.js';\n\nexport abstract class EditingSessionAction extends Action2 {\n\n\tconstructor(opts: Readonly<IAction2Options>) {\n\t\tsuper({\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t...opts\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tconst context = getEditingSessionContext(accessor, args);\n\t\tif (!context || !context.editingSession) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.runEditingSessionAction(accessor, context.editingSession, context.chatWidget, ...args);\n\t}\n\n\tabstract runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]): any;\n}\n\n/**\n * Resolve view title toolbar context. If none, return context from the lastFocusedWidget.\n */\nexport function getEditingSessionContext(accessor: ServicesAccessor, args: any[]): { editingSession?: IChatEditingSession; chatWidget: IChatWidget } | undefined {\n\tconst arg0 = args.at(0);\n\tconst context = isChatViewTitleActionContext(arg0) ? arg0 : undefined;\n\n\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\tconst chatEditingService = accessor.get(IChatEditingService);\n\tlet chatWidget = context ? chatWidgetService.getWidgetBySessionResource(context.sessionResource) : undefined;\n\tif (!chatWidget) {\n\t\tchatWidget = chatWidgetService.lastFocusedWidget ?? chatWidgetService.getWidgetsByLocations(ChatAgentLocation.Chat).find(w => w.supportsChangingModes);\n\t}\n\n\tif (!chatWidget?.viewModel) {\n\t\treturn;\n\t}\n\n\tconst editingSession = chatEditingService.getEditingSession(chatWidget.viewModel.model.sessionResource);\n\treturn { editingSession, chatWidget };\n}\n\n\nabstract class WorkingSetAction extends EditingSessionAction {\n\n\trunEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]) {\n\n\t\tconst uris: URI[] = [];\n\t\tif (URI.isUri(args[0])) {\n\t\t\turis.push(args[0]);\n\t\t} else if (chatWidget) {\n\t\t\turis.push(...chatWidget.input.selectedElements);\n\t\t}\n\t\tif (!uris.length) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.runWorkingSetAction(accessor, editingSession, chatWidget, ...uris);\n\t}\n\n\tabstract runWorkingSetAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget | undefined, ...uris: URI[]): any;\n}\n\nregisterAction2(class OpenFileInDiffAction extends WorkingSetAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'chatEditing.openFileInDiff',\n\t\t\ttitle: localize2('open.fileInDiff', 'Open Changes in Diff Editor'),\n\t\t\ticon: Codicon.diffSingle,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ChatEditingWidgetModifiedFilesToolbar,\n\t\t\t\twhen: ContextKeyExpr.equals(chatEditingWidgetFileStateContextKey.key, ModifiedFileEntryState.Modified),\n\t\t\t\torder: 2,\n\t\t\t\tgroup: 'navigation'\n\t\t\t}],\n\t\t});\n\t}\n\n\tasync runWorkingSetAction(accessor: ServicesAccessor, currentEditingSession: IChatEditingSession, _chatWidget: IChatWidget, ...uris: URI[]): Promise<void> {\n\t\tconst editorService = accessor.get(IEditorService);\n\n\n\t\tfor (const uri of uris) {\n\n\t\t\tlet pane: IEditorPane | undefined = editorService.activeEditorPane;\n\t\t\tif (!pane) {\n\t\t\t\tpane = await editorService.openEditor({ resource: uri });\n\t\t\t}\n\n\t\t\tif (!pane) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst editedFile = currentEditingSession.getEntry(uri);\n\t\t\teditedFile?.getEditorIntegration(pane).toggleDiff(undefined, true);\n\t\t}\n\t}\n});\n\nregisterAction2(class AcceptAction extends WorkingSetAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'chatEditing.acceptFile',\n\t\t\ttitle: localize2('accept.file', 'Keep'),\n\t\t\ticon: Codicon.check,\n\t\t\tmenu: [{\n\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.equals('resourceScheme', CHAT_EDITING_MULTI_DIFF_SOURCE_RESOLVER_SCHEME), ContextKeyExpr.notIn(chatEditingResourceContextKey.key, decidedChatEditingResourceContextKey.key)),\n\t\t\t\tid: MenuId.MultiDiffEditorFileToolbar,\n\t\t\t\torder: 0,\n\t\t\t\tgroup: 'navigation',\n\t\t\t}, {\n\t\t\t\tid: MenuId.ChatEditingWidgetModifiedFilesToolbar,\n\t\t\t\twhen: ContextKeyExpr.equals(chatEditingWidgetFileStateContextKey.key, ModifiedFileEntryState.Modified),\n\t\t\t\torder: 0,\n\t\t\t\tgroup: 'navigation'\n\t\t\t}],\n\t\t});\n\t}\n\n\tasync runWorkingSetAction(accessor: ServicesAccessor, currentEditingSession: IChatEditingSession, chatWidget: IChatWidget, ...uris: URI[]): Promise<void> {\n\t\tawait currentEditingSession.accept(...uris);\n\t}\n});\n\nregisterAction2(class DiscardAction extends WorkingSetAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'chatEditing.discardFile',\n\t\t\ttitle: localize2('discard.file', 'Undo'),\n\t\t\ticon: Codicon.discard,\n\t\t\tmenu: [{\n\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.equals('resourceScheme', CHAT_EDITING_MULTI_DIFF_SOURCE_RESOLVER_SCHEME), ContextKeyExpr.notIn(chatEditingResourceContextKey.key, decidedChatEditingResourceContextKey.key)),\n\t\t\t\tid: MenuId.MultiDiffEditorFileToolbar,\n\t\t\t\torder: 2,\n\t\t\t\tgroup: 'navigation',\n\t\t\t}, {\n\t\t\t\tid: MenuId.ChatEditingWidgetModifiedFilesToolbar,\n\t\t\t\twhen: ContextKeyExpr.equals(chatEditingWidgetFileStateContextKey.key, ModifiedFileEntryState.Modified),\n\t\t\t\torder: 1,\n\t\t\t\tgroup: 'navigation'\n\t\t\t}],\n\t\t});\n\t}\n\n\tasync runWorkingSetAction(accessor: ServicesAccessor, currentEditingSession: IChatEditingSession, chatWidget: IChatWidget, ...uris: URI[]): Promise<void> {\n\t\tawait currentEditingSession.reject(...uris);\n\t}\n});\n\nexport class ChatEditingAcceptAllAction extends EditingSessionAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'chatEditing.acceptAllFiles',\n\t\t\ttitle: localize('accept', 'Keep'),\n\t\t\ticon: Codicon.check,\n\t\t\ttooltip: localize('acceptAllEdits', 'Keep All Edits'),\n\t\t\tprecondition: hasUndecidedChatEditingResourceContextKey,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Enter,\n\t\t\t\twhen: ContextKeyExpr.and(hasUndecidedChatEditingResourceContextKey, ChatContextKeys.inChatInput),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t},\n\t\t\tmenu: [\n\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatEditingWidgetToolbar,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 0,\n\t\t\t\t\twhen: ContextKeyExpr.and(applyingChatEditsFailedContextKey.negate(), ContextKeyExpr.and(hasUndecidedChatEditingResourceContextKey))\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\toverride async runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]) {\n\t\tawait editingSession.accept();\n\t}\n}\nregisterAction2(ChatEditingAcceptAllAction);\n\nexport class ChatEditingDiscardAllAction extends EditingSessionAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'chatEditing.discardAllFiles',\n\t\t\ttitle: localize('discard', 'Undo'),\n\t\t\ticon: Codicon.discard,\n\t\t\ttooltip: localize('discardAllEdits', 'Undo All Edits'),\n\t\t\tprecondition: hasUndecidedChatEditingResourceContextKey,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatEditingWidgetToolbar,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 1,\n\t\t\t\t\twhen: ContextKeyExpr.and(applyingChatEditsFailedContextKey.negate(), hasUndecidedChatEditingResourceContextKey)\n\t\t\t\t}\n\t\t\t],\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(hasUndecidedChatEditingResourceContextKey, ChatContextKeys.inChatInput, ChatContextKeys.inputHasText.negate()),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace,\n\t\t\t},\n\t\t});\n\t}\n\n\toverride async runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]) {\n\t\tawait discardAllEditsWithConfirmation(accessor, editingSession);\n\t}\n}\nregisterAction2(ChatEditingDiscardAllAction);\n\nexport async function discardAllEditsWithConfirmation(accessor: ServicesAccessor, currentEditingSession: IChatEditingSession): Promise<boolean> {\n\n\tconst dialogService = accessor.get(IDialogService);\n\n\t// Ask for confirmation if there are any edits\n\tconst entries = currentEditingSession.entries.get();\n\tif (entries.length > 0) {\n\t\tconst confirmation = await dialogService.confirm({\n\t\t\ttitle: localize('chat.editing.discardAll.confirmation.title', \"Undo all edits?\"),\n\t\t\tmessage: entries.length === 1\n\t\t\t\t? localize('chat.editing.discardAll.confirmation.oneFile', \"This will undo changes made in {0}. Do you want to proceed?\", basename(entries[0].modifiedURI))\n\t\t\t\t: localize('chat.editing.discardAll.confirmation.manyFiles', \"This will undo changes made in {0} files. Do you want to proceed?\", entries.length),\n\t\t\tprimaryButton: localize('chat.editing.discardAll.confirmation.primaryButton', \"Yes\"),\n\t\t\ttype: 'info'\n\t\t});\n\t\tif (!confirmation.confirmed) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tawait currentEditingSession.reject();\n\treturn true;\n}\n\nexport class ChatEditingShowChangesAction extends EditingSessionAction {\n\tstatic readonly ID = 'chatEditing.viewChanges';\n\tstatic readonly LABEL = localize('chatEditing.viewChanges', 'View All Edits');\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ChatEditingShowChangesAction.ID,\n\t\t\ttitle: { value: ChatEditingShowChangesAction.LABEL, original: ChatEditingShowChangesAction.LABEL },\n\t\t\ttooltip: ChatEditingShowChangesAction.LABEL,\n\t\t\tf1: true,\n\t\t\ticon: Codicon.diffMultiple,\n\t\t\tprecondition: hasUndecidedChatEditingResourceContextKey,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatEditingWidgetToolbar,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 4,\n\t\t\t\t\twhen: ContextKeyExpr.and(applyingChatEditsFailedContextKey.negate(), ContextKeyExpr.and(hasAppliedChatEditsContextKey, hasUndecidedChatEditingResourceContextKey))\n\t\t\t\t}\n\t\t\t],\n\t\t});\n\t}\n\n\toverride async runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]): Promise<void> {\n\t\tawait editingSession.show();\n\t}\n}\nregisterAction2(ChatEditingShowChangesAction);\n\nasync function restoreSnapshotWithConfirmation(accessor: ServicesAccessor, item: ChatTreeItem): Promise<void> {\n\tconst configurationService = accessor.get(IConfigurationService);\n\tconst dialogService = accessor.get(IDialogService);\n\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\tconst widget = chatWidgetService.lastFocusedWidget;\n\tconst chatService = accessor.get(IChatService);\n\tconst chatModel = chatService.getSession(item.sessionResource);\n\tif (!chatModel) {\n\t\treturn;\n\t}\n\n\tconst session = chatModel.editingSession;\n\tif (!session) {\n\t\treturn;\n\t}\n\n\tconst requestId = isRequestVM(item) ? item.id :\n\t\tisResponseVM(item) ? item.requestId : undefined;\n\n\tif (requestId) {\n\t\tconst chatRequests = chatModel.getRequests();\n\t\tconst itemIndex = chatRequests.findIndex(request => request.id === requestId);\n\t\tconst editsToUndo = chatRequests.length - itemIndex;\n\n\t\tconst requestsToRemove = chatRequests.slice(itemIndex);\n\t\tconst requestIdsToRemove = new Set(requestsToRemove.map(request => request.id));\n\t\tconst entriesModifiedInRequestsToRemove = session.entries.get().filter((entry) => requestIdsToRemove.has(entry.lastModifyingRequestId)) ?? [];\n\t\tconst shouldPrompt = entriesModifiedInRequestsToRemove.length > 0 && configurationService.getValue('chat.editing.confirmEditRequestRemoval') === true;\n\n\t\tlet message: string;\n\t\tif (editsToUndo === 1) {\n\t\t\tif (entriesModifiedInRequestsToRemove.length === 1) {\n\t\t\t\tmessage = localize('chat.removeLast.confirmation.message2', \"This will remove your last request and undo the edits made to {0}. Do you want to proceed?\", basename(entriesModifiedInRequestsToRemove[0].modifiedURI));\n\t\t\t} else {\n\t\t\t\tmessage = localize('chat.removeLast.confirmation.multipleEdits.message', \"This will remove your last request and undo edits made to {0} files in your working set. Do you want to proceed?\", entriesModifiedInRequestsToRemove.length);\n\t\t\t}\n\t\t} else {\n\t\t\tif (entriesModifiedInRequestsToRemove.length === 1) {\n\t\t\t\tmessage = localize('chat.remove.confirmation.message2', \"This will remove all subsequent requests and undo edits made to {0}. Do you want to proceed?\", basename(entriesModifiedInRequestsToRemove[0].modifiedURI));\n\t\t\t} else {\n\t\t\t\tmessage = localize('chat.remove.confirmation.multipleEdits.message', \"This will remove all subsequent requests and undo edits made to {0} files in your working set. Do you want to proceed?\", entriesModifiedInRequestsToRemove.length);\n\t\t\t}\n\t\t}\n\n\t\tconst confirmation = shouldPrompt\n\t\t\t? await dialogService.confirm({\n\t\t\t\ttitle: editsToUndo === 1\n\t\t\t\t\t? localize('chat.removeLast.confirmation.title', \"Do you want to undo your last edit?\")\n\t\t\t\t\t: localize('chat.remove.confirmation.title', \"Do you want to undo {0} edits?\", editsToUndo),\n\t\t\t\tmessage: message,\n\t\t\t\tprimaryButton: localize('chat.remove.confirmation.primaryButton', \"Yes\"),\n\t\t\t\tcheckbox: { label: localize('chat.remove.confirmation.checkbox', \"Don't ask again\"), checked: false },\n\t\t\t\ttype: 'info'\n\t\t\t})\n\t\t\t: { confirmed: true };\n\n\t\tif (!confirmation.confirmed) {\n\t\t\twidget?.viewModel?.model.setCheckpoint(undefined);\n\t\t\treturn;\n\t\t}\n\n\t\tif (confirmation.checkboxChecked) {\n\t\t\tawait configurationService.updateValue('chat.editing.confirmEditRequestRemoval', false);\n\t\t}\n\n\t\t// Restore the snapshot to what it was before the request(s) that we deleted\n\t\tconst snapshotRequestId = chatRequests[itemIndex].id;\n\t\tawait session.restoreSnapshot(snapshotRequestId, undefined);\n\t}\n}\n\nregisterAction2(class RemoveAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.chat.undoEdits',\n\t\t\ttitle: localize2('chat.undoEdits.label', \"Undo Requests\"),\n\t\t\tf1: false,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\ticon: Codicon.discard,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyCode.Delete,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace,\n\t\t\t\t},\n\t\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.inChatSession, EditorContextKeys.textInputFocus.negate()),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2,\n\t\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.equals(`config.${ChatConfiguration.EditRequests}`, 'input').negate(), ContextKeyExpr.equals(`config.${ChatConfiguration.CheckpointsEnabled}`, false), ChatContextKeys.lockedToCodingAgent.negate()),\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tlet item = args[0] as ChatTreeItem | undefined;\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\tif (!isResponseVM(item) && !isRequestVM(item)) {\n\t\t\titem = widget?.getFocus();\n\t\t}\n\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait restoreSnapshotWithConfirmation(accessor, item);\n\n\t\tif (isRequestVM(item) && configurationService.getValue('chat.undoRequests.restoreInput')) {\n\t\t\twidget?.focusInput();\n\t\t\twidget?.input.setValue(item.messageText, false);\n\t\t}\n\t}\n});\n\nregisterAction2(class RestoreCheckpointAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.chat.restoreCheckpoint',\n\t\t\ttitle: localize2('chat.restoreCheckpoint.label', \"Restore Checkpoint\"),\n\t\t\ttooltip: localize2('chat.restoreCheckpoint.tooltip', \"Restores workspace and chat to this point\"),\n\t\t\tf1: false,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyCode.Delete,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace,\n\t\t\t\t},\n\t\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.inChatSession, EditorContextKeys.textInputFocus.negate()),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatMessageCheckpoint,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2,\n\t\t\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.isRequest, ChatContextKeys.lockedToCodingAgent.negate())\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tlet item = args[0] as ChatTreeItem | undefined;\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\tif (!isResponseVM(item) && !isRequestVM(item)) {\n\t\t\titem = widget?.getFocus();\n\t\t}\n\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isRequestVM(item)) {\n\t\t\twidget?.focusInput();\n\t\t\twidget?.input.setValue(item.messageText, false);\n\t\t}\n\n\t\twidget?.viewModel?.model.setCheckpoint(item.id);\n\t\tawait restoreSnapshotWithConfirmation(accessor, item);\n\t}\n});\n\nregisterAction2(class RestoreLastCheckpoint extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.chat.restoreLastCheckpoint',\n\t\t\ttitle: localize2('chat.restoreLastCheckpoint.label', \"Restore to Last Checkpoint\"),\n\t\t\tf1: false,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\ticon: Codicon.discard,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatMessageFooter,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 1,\n\t\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.in(ChatContextKeys.itemId.key, ChatContextKeys.lastItemId.key), ContextKeyExpr.equals(`config.${ChatConfiguration.CheckpointsEnabled}`, true), ChatContextKeys.lockedToCodingAgent.negate()),\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tlet item = args[0] as ChatTreeItem | undefined;\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst chatService = accessor.get(IChatService);\n\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\tif (!isResponseVM(item) && !isRequestVM(item)) {\n\t\t\titem = widget?.getFocus();\n\t\t}\n\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatModel = chatService.getSession(item.sessionResource);\n\t\tif (!chatModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst session = chatModel.editingSession;\n\t\tif (!session) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait restoreSnapshotWithConfirmation(accessor, item);\n\n\t\tif (isResponseVM(item)) {\n\t\t\twidget?.viewModel?.model.setCheckpoint(item.requestId);\n\t\t\tconst request = chatModel.getRequests().find(request => request.id === item.requestId);\n\t\t\tif (request) {\n\t\t\t\twidget?.focusInput();\n\t\t\t\twidget?.input.setValue(request.message.text, false);\n\t\t\t}\n\t\t}\n\t}\n});\n\nregisterAction2(class EditAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.chat.editRequests',\n\t\t\ttitle: localize2('chat.editRequests.label', \"Edit Request\"),\n\t\t\tf1: false,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\ticon: Codicon.edit,\n\t\t\tkeybinding: {\n\t\t\t\tprimary: KeyCode.Enter,\n\t\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.inChatSession, EditorContextKeys.textInputFocus.negate()),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2,\n\t\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.or(ContextKeyExpr.equals(`config.${ChatConfiguration.EditRequests}`, 'hover'), ContextKeyExpr.equals(`config.${ChatConfiguration.EditRequests}`, 'input')))\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, ...args: unknown[]) {\n\t\tlet item = args[0] as ChatTreeItem | undefined;\n\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\tif (!isResponseVM(item) && !isRequestVM(item)) {\n\t\t\titem = widget?.getFocus();\n\t\t}\n\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isRequestVM(item)) {\n\t\t\twidget?.startEditing(item.id);\n\t\t}\n\t}\n});\n\nexport interface ChatEditingActionContext {\n\treadonly sessionResource: URI;\n\treadonly requestId: string;\n\treadonly uri: URI;\n\treadonly stopId: string | undefined;\n}\n\nregisterAction2(class OpenWorkingSetHistoryAction extends Action2 {\n\n\tstatic readonly id = 'chat.openFileUpdatedBySnapshot';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: OpenWorkingSetHistoryAction.id,\n\t\t\ttitle: localize('chat.openFileUpdatedBySnapshot.label', \"Open File\"),\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ChatEditingCodeBlockContext,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 0,\n\t\t\t},]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: unknown[]): Promise<void> {\n\t\tconst context = args[0] as ChatEditingActionContext | undefined;\n\t\tif (!context?.sessionResource) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tawait editorService.openEditor({ resource: context.uri });\n\t}\n});\n\nregisterAction2(class OpenWorkingSetHistoryAction extends Action2 {\n\n\tstatic readonly id = 'chat.openFileSnapshot';\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: OpenWorkingSetHistoryAction.id,\n\t\t\ttitle: localize('chat.openSnapshot.label', \"Open File Snapshot\"),\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ChatEditingCodeBlockContext,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1,\n\t\t\t},]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: unknown[]): Promise<void> {\n\t\tconst context = args[0] as ChatEditingActionContext | undefined;\n\t\tif (!context?.sessionResource) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatService = accessor.get(IChatService);\n\t\tconst chatEditingService = accessor.get(IChatEditingService);\n\t\tconst editorService = accessor.get(IEditorService);\n\n\t\tconst chatModel = chatService.getSession(context.sessionResource);\n\t\tif (!chatModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst snapshot = chatEditingService.getEditingSession(chatModel.sessionResource)?.getSnapshotUri(context.requestId, context.uri, context.stopId);\n\t\tif (snapshot) {\n\t\t\tconst editor = await editorService.openEditor({ resource: snapshot, label: localize('chatEditing.snapshot', '{0} (Snapshot)', basename(context.uri)), options: { activation: EditorActivation.ACTIVATE } });\n\t\t\tif (isCodeEditor(editor)) {\n\t\t\t\teditor.updateOptions({ readOnly: true });\n\t\t\t}\n\t\t}\n\t}\n});\n\nregisterAction2(class ResolveSymbolsContextAction extends EditingSessionAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.edits.addFilesFromReferences',\n\t\t\ttitle: localize2('addFilesFromReferences', \"Add Files From References\"),\n\t\t\tf1: false,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.ChatInputSymbolAttachmentContext,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1,\n\t\t\t\twhen: ContextKeyExpr.and(ChatContextKeys.chatModeKind.isEqualTo(ChatModeKind.Ask), EditorContextKeys.hasReferenceProvider)\n\t\t\t}\n\t\t});\n\t}\n\n\toverride async runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]): Promise<void> {\n\t\tif (args.length === 0 || !isLocation(args[0])) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst textModelService = accessor.get(ITextModelService);\n\t\tconst languageFeaturesService = accessor.get(ILanguageFeaturesService);\n\t\tconst symbol = args[0] as Location;\n\n\t\tconst modelReference = await textModelService.createModelReference(symbol.uri);\n\t\tconst textModel = modelReference.object.textEditorModel;\n\t\tif (!textModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst position = new Position(symbol.range.startLineNumber, symbol.range.startColumn);\n\n\t\tconst [references, definitions, implementations] = await Promise.all([\n\t\t\tthis.getReferences(position, textModel, languageFeaturesService),\n\t\t\tthis.getDefinitions(position, textModel, languageFeaturesService),\n\t\t\tthis.getImplementations(position, textModel, languageFeaturesService)\n\t\t]);\n\n\t\t// Sort the references, definitions and implementations by\n\t\t// how important it is that they make it into the working set as it has limited size\n\t\tconst attachments = [];\n\t\tfor (const reference of [...definitions, ...implementations, ...references]) {\n\t\t\tattachments.push(chatWidget.attachmentModel.asFileVariableEntry(reference.uri));\n\t\t}\n\n\t\tchatWidget.attachmentModel.addContext(...attachments);\n\t}\n\n\tprivate async getReferences(position: Position, textModel: ITextModel, languageFeaturesService: ILanguageFeaturesService): Promise<Location[]> {\n\t\tconst referenceProviders = languageFeaturesService.referenceProvider.all(textModel);\n\n\t\tconst references = await Promise.all(referenceProviders.map(async (referenceProvider) => {\n\t\t\treturn await referenceProvider.provideReferences(textModel, position, { includeDeclaration: true }, CancellationToken.None) ?? [];\n\t\t}));\n\n\t\treturn references.flat();\n\t}\n\n\tprivate async getDefinitions(position: Position, textModel: ITextModel, languageFeaturesService: ILanguageFeaturesService): Promise<Location[]> {\n\t\tconst definitionProviders = languageFeaturesService.definitionProvider.all(textModel);\n\n\t\tconst definitions = await Promise.all(definitionProviders.map(async (definitionProvider) => {\n\t\t\treturn await definitionProvider.provideDefinition(textModel, position, CancellationToken.None) ?? [];\n\t\t}));\n\n\t\treturn definitions.flat();\n\t}\n\n\tprivate async getImplementations(position: Position, textModel: ITextModel, languageFeaturesService: ILanguageFeaturesService): Promise<Location[]> {\n\t\tconst implementationProviders = languageFeaturesService.implementationProvider.all(textModel);\n\n\t\tconst implementations = await Promise.all(implementationProviders.map(async (implementationProvider) => {\n\t\t\treturn await implementationProvider.provideImplementation(textModel, position, CancellationToken.None) ?? [];\n\t\t}));\n\n\t\treturn implementations.flat();\n\t}\n});\n\nexport class ViewPreviousEditsAction extends EditingSessionAction {\n\tstatic readonly Id = 'chatEditing.viewPreviousEdits';\n\tstatic readonly Label = localize('chatEditing.viewPreviousEdits', 'View Previous Edits');\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ViewPreviousEditsAction.Id,\n\t\t\ttitle: { value: ViewPreviousEditsAction.Label, original: ViewPreviousEditsAction.Label },\n\t\t\ttooltip: ViewPreviousEditsAction.Label,\n\t\t\tf1: true,\n\t\t\ticon: Codicon.diffMultiple,\n\t\t\tprecondition: ContextKeyExpr.and(ChatContextKeys.enabled, hasUndecidedChatEditingResourceContextKey.negate()),\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.ChatEditingWidgetToolbar,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 4,\n\t\t\t\t\twhen: ContextKeyExpr.and(applyingChatEditsFailedContextKey.negate(), ContextKeyExpr.and(hasAppliedChatEditsContextKey, hasUndecidedChatEditingResourceContextKey.negate()))\n\t\t\t\t}\n\t\t\t],\n\t\t});\n\t}\n\n\toverride async runEditingSessionAction(accessor: ServicesAccessor, editingSession: IChatEditingSession, chatWidget: IChatWidget, ...args: unknown[]): Promise<void> {\n\t\tawait editingSession.show(true);\n\t}\n}\nregisterAction2(ViewPreviousEditsAction);\n\n/**\n * Workbench command to explore accepting working set changes from an extension. Executing\n * the command will accept the changes for the provided resources across all edit sessions.\n */\nCommandsRegistry.registerCommand('_chat.editSessions.accept', async (accessor: ServicesAccessor, resources: UriComponents[]) => {\n\tif (resources.length === 0) {\n\t\treturn;\n\t}\n\n\tconst uris = resources.map(resource => URI.revive(resource));\n\tconst chatEditingService = accessor.get(IChatEditingService);\n\tfor (const editingSession of chatEditingService.editingSessionsObs.get()) {\n\t\tawait editingSession.accept(...uris);\n\t}\n});\n"]}