{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatContinueInAction.ts"],"names":[],"mappings":"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","file":"chatContinueInAction.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../../base/common/resources.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { isITextModel } from '../../../../../editor/common/model.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { ActionWidgetDropdownActionViewItem } from '../../../../../platform/actions/browser/actionWidgetDropdownActionViewItem.js';\nimport { Action2, MenuId, MenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IActionWidgetService } from '../../../../../platform/actionWidget/browser/actionWidget.js';\nimport { IActionWidgetDropdownAction, IActionWidgetDropdownActionProvider } from '../../../../../platform/actionWidget/browser/actionWidgetDropdown.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IChatAgentService } from '../../common/chatAgents.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ChatModel } from '../../common/chatModel.js';\nimport { ChatRequestParser } from '../../common/chatRequestParser.js';\nimport { IChatService } from '../../common/chatService.js';\nimport { IChatSessionsExtensionPoint, IChatSessionsService } from '../../common/chatSessionsService.js';\nimport { ChatAgentLocation } from '../../common/constants.js';\nimport { AgentSessionProviders, getAgentSessionProviderIcon, getAgentSessionProviderName } from '../agentSessions/agentSessions.js';\nimport { IChatWidgetService } from '../chat.js';\nimport { CHAT_SETUP_ACTION_ID } from './chatActions.js';\n\nexport class ContinueChatInSessionAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.continueChatInSession';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ContinueChatInSessionAction.ID,\n\t\t\ttitle: localize2('continueChatInSession', \"Continue Chat in...\"),\n\t\t\ttooltip: localize('continueChatInSession', \"Continue Chat in...\"),\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tChatContextKeys.enabled,\n\t\t\t\tChatContextKeys.requestInProgress.negate(),\n\t\t\t\tChatContextKeys.remoteJobCreating.negate(),\n\t\t\t),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.ChatExecute,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 3.4,\n\t\t\t\twhen: ChatContextKeys.lockedToCodingAgent.negate(),\n\t\t\t}\n\t\t});\n\t}\n\n\toverride async run(): Promise<void> {\n\t\t// Handled by a custom action item\n\t}\n}\n\nexport class ChatContinueInSessionActionItem extends ActionWidgetDropdownActionViewItem {\n\tconstructor(\n\t\taction: MenuItemAction,\n\t\t@IActionWidgetService actionWidgetService: IActionWidgetService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IChatSessionsService chatSessionsService: IChatSessionsService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IOpenerService openerService: IOpenerService\n\t) {\n\t\tsuper(action, {\n\t\t\tactionProvider: ChatContinueInSessionActionItem.actionProvider(chatSessionsService, instantiationService),\n\t\t\tactionBarActions: ChatContinueInSessionActionItem.getActionBarActions(openerService)\n\t\t}, actionWidgetService, keybindingService, contextKeyService);\n\t}\n\n\tprivate static getActionBarActions(openerService: IOpenerService) {\n\t\tconst learnMoreUrl = 'https://aka.ms/vscode-continue-chat-in';\n\t\treturn [{\n\t\t\tid: 'workbench.action.chat.continueChatInSession.learnMore',\n\t\t\tlabel: localize('chat.learnMore', \"Learn More\"),\n\t\t\ttooltip: localize('chat.learnMore', \"Learn More\"),\n\t\t\tclass: undefined,\n\t\t\tenabled: true,\n\t\t\trun: async () => {\n\t\t\t\tawait openerService.open(URI.parse(learnMoreUrl));\n\t\t\t}\n\t\t}];\n\t}\n\n\tprivate static actionProvider(chatSessionsService: IChatSessionsService, instantiationService: IInstantiationService): IActionWidgetDropdownActionProvider {\n\t\treturn {\n\t\t\tgetActions: () => {\n\t\t\t\tconst actions: IActionWidgetDropdownAction[] = [];\n\t\t\t\tconst contributions = chatSessionsService.getAllChatSessionContributions();\n\n\t\t\t\t// Continue in Background\n\t\t\t\tconst backgroundContrib = contributions.find(contrib => contrib.type === AgentSessionProviders.Background);\n\t\t\t\tif (backgroundContrib && backgroundContrib.canDelegate !== false) {\n\t\t\t\t\tactions.push(this.toAction(AgentSessionProviders.Background, backgroundContrib, instantiationService));\n\t\t\t\t}\n\n\t\t\t\t// Continue in Cloud\n\t\t\t\tconst cloudContrib = contributions.find(contrib => contrib.type === AgentSessionProviders.Cloud);\n\t\t\t\tif (cloudContrib && cloudContrib.canDelegate !== false) {\n\t\t\t\t\tactions.push(this.toAction(AgentSessionProviders.Cloud, cloudContrib, instantiationService));\n\t\t\t\t}\n\n\t\t\t\t// Offer actions to enter setup if we have no contributions\n\t\t\t\tif (actions.length === 0) {\n\t\t\t\t\tactions.push(this.toSetupAction(AgentSessionProviders.Background, instantiationService));\n\t\t\t\t\tactions.push(this.toSetupAction(AgentSessionProviders.Cloud, instantiationService));\n\t\t\t\t}\n\n\t\t\t\treturn actions;\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate static toAction(provider: AgentSessionProviders, contrib: IChatSessionsExtensionPoint, instantiationService: IInstantiationService): IActionWidgetDropdownAction {\n\t\treturn {\n\t\t\tid: contrib.type,\n\t\t\tenabled: true,\n\t\t\ticon: getAgentSessionProviderIcon(provider),\n\t\t\tclass: undefined,\n\t\t\tdescription: `@${contrib.name}`,\n\t\t\tlabel: localize('continueSessionIn', \"Continue in {0}\", getAgentSessionProviderName(provider)),\n\t\t\ttooltip: contrib.displayName,\n\t\t\trun: () => instantiationService.invokeFunction(accessor => new CreateRemoteAgentJobAction().run(accessor, contrib))\n\t\t};\n\t}\n\n\tprivate static toSetupAction(provider: AgentSessionProviders, instantiationService: IInstantiationService): IActionWidgetDropdownAction {\n\t\treturn {\n\t\t\tid: provider,\n\t\t\tenabled: true,\n\t\t\ticon: getAgentSessionProviderIcon(provider),\n\t\t\tclass: undefined,\n\t\t\tlabel: localize('continueSessionIn', \"Continue in {0}\", getAgentSessionProviderName(provider)),\n\t\t\ttooltip: localize('continueSessionIn', \"Continue in {0}\", getAgentSessionProviderName(provider)),\n\t\t\trun: () => instantiationService.invokeFunction(accessor => {\n\t\t\t\tconst commandService = accessor.get(ICommandService);\n\t\t\t\treturn commandService.executeCommand(CHAT_SETUP_ACTION_ID);\n\t\t\t})\n\t\t};\n\t}\n\n\tprotected override renderLabel(element: HTMLElement): IDisposable | null {\n\t\tconst icon = this.contextKeyService.contextMatchesRules(ChatContextKeys.remoteJobCreating) ? Codicon.sync : Codicon.forward;\n\t\telement.classList.add(...ThemeIcon.asClassNameArray(icon));\n\n\t\treturn super.renderLabel(element);\n\t}\n}\n\nclass CreateRemoteAgentJobAction {\n\tconstructor() { }\n\n\tasync run(accessor: ServicesAccessor, continuationTarget: IChatSessionsExtensionPoint) {\n\t\tconst contextKeyService = accessor.get(IContextKeyService);\n\t\tconst remoteJobCreatingKey = ChatContextKeys.remoteJobCreating.bindTo(contextKeyService);\n\n\t\ttry {\n\t\t\tremoteJobCreatingKey.set(true);\n\n\t\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\t\tconst chatAgentService = accessor.get(IChatAgentService);\n\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\tconst editorService = accessor.get(IEditorService);\n\n\t\t\tconst widget = widgetService.lastFocusedWidget;\n\t\t\tif (!widget) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!widget.viewModel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// todo@connor4312: remove 'as' cast\n\t\t\tconst chatModel = widget.viewModel.model as ChatModel;\n\t\t\tif (!chatModel) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst sessionResource = widget.viewModel.sessionResource;\n\t\t\tconst chatRequests = chatModel.getRequests();\n\t\t\tlet userPrompt = widget.getInput();\n\t\t\tif (!userPrompt) {\n\t\t\t\tif (!chatRequests.length) {\n\t\t\t\t\t// Nothing to do\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tuserPrompt = 'implement this.';\n\t\t\t}\n\n\t\t\tconst attachedContext = widget.input.getAttachedAndImplicitContext(sessionResource);\n\t\t\twidget.input.acceptInput(true);\n\n\t\t\t// For inline editor mode, add selection or cursor information\n\t\t\tif (widget.location === ChatAgentLocation.EditorInline) {\n\t\t\t\tconst activeEditor = editorService.activeTextEditorControl;\n\t\t\t\tif (activeEditor) {\n\t\t\t\t\tconst model = activeEditor.getModel();\n\t\t\t\t\tlet activeEditorUri: URI | undefined = undefined;\n\t\t\t\t\tif (model && isITextModel(model)) {\n\t\t\t\t\t\tactiveEditorUri = model.uri as URI;\n\t\t\t\t\t}\n\t\t\t\t\tconst selection = activeEditor.getSelection();\n\t\t\t\t\tif (activeEditorUri && selection) {\n\t\t\t\t\t\tattachedContext.add({\n\t\t\t\t\t\t\tkind: 'file',\n\t\t\t\t\t\t\tid: 'vscode.implicit.selection',\n\t\t\t\t\t\t\tname: basename(activeEditorUri),\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\turi: activeEditorUri,\n\t\t\t\t\t\t\t\trange: selection\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst defaultAgent = chatAgentService.getDefaultAgent(ChatAgentLocation.Chat);\n\t\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\t\tconst requestParser = instantiationService.createInstance(ChatRequestParser);\n\t\t\tconst continuationTargetType = continuationTarget.type;\n\n\t\t\t// Add the request to the model first\n\t\t\tconst parsedRequest = requestParser.parseChatRequest(sessionResource, userPrompt, ChatAgentLocation.Chat);\n\t\t\tconst addedRequest = chatModel.addRequest(\n\t\t\t\tparsedRequest,\n\t\t\t\t{ variables: attachedContext.asArray() },\n\t\t\t\t0,\n\t\t\t\tundefined,\n\t\t\t\tdefaultAgent\n\t\t\t);\n\n\t\t\tawait chatService.removeRequest(sessionResource, addedRequest.id);\n\t\t\tawait chatService.sendRequest(sessionResource, userPrompt, {\n\t\t\t\tagentIdSilent: continuationTargetType,\n\t\t\t\tattachedContext: attachedContext.asArray(),\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error('Error creating remote coding agent job', e);\n\t\t\tthrow e;\n\t\t} finally {\n\t\t\tremoteJobCreatingKey.set(false);\n\t\t}\n\t}\n}\n"]}