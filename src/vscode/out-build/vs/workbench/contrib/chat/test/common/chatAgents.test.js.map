{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/common/chatAgents.test.ts","vs/workbench/contrib/chat/test/common/chatAgents.test.ts"],"names":[],"mappings":"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","file":"chatAgents.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ContextKeyExpression } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ChatAgentService, IChatAgentData, IChatAgentImplementation } from '../../common/chatAgents.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\n\nconst testAgentId = 'testAgent';\nconst testAgentData: IChatAgentData = {\n\tid: testAgentId,\n\tname: 'Test Agent',\n\textensionDisplayName: '',\n\textensionId: new ExtensionIdentifier(''),\n\textensionVersion: undefined,\n\textensionPublisherId: '',\n\tlocations: [],\n\tmodes: [],\n\tmetadata: {},\n\tslashCommands: [],\n\tdisambiguation: [],\n};\n\nclass TestingContextKeyService extends MockContextKeyService {\n\tprivate _contextMatchesRulesReturnsTrue = false;\n\tpublic contextMatchesRulesReturnsTrue() {\n\t\tthis._contextMatchesRulesReturnsTrue = true;\n\t}\n\n\tpublic override contextMatchesRules(rules: ContextKeyExpression): boolean {\n\t\treturn this._contextMatchesRulesReturnsTrue;\n\t}\n}\n\nsuite('ChatAgents', function () {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet chatAgentService: ChatAgentService;\n\tlet contextKeyService: TestingContextKeyService;\n\tsetup(() => {\n\t\tcontextKeyService = new TestingContextKeyService();\n\t\tchatAgentService = store.add(new ChatAgentService(contextKeyService, new TestConfigurationService()));\n\t});\n\n\ttest('registerAgent', async () => {\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\n\t\tconst agentRegistration = chatAgentService.registerAgent(testAgentId, testAgentData);\n\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 1);\n\t\tassert.strictEqual(chatAgentService.getAgents()[0].id, testAgentId);\n\n\t\tassert.throws(() => chatAgentService.registerAgent(testAgentId, testAgentData));\n\n\t\tagentRegistration.dispose();\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\t});\n\n\ttest('agent when clause', async () => {\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\t\tstore.add(chatAgentService.registerAgent(testAgentId, {\n\t\t\t...testAgentData,\n\t\t\twhen: 'myKey'\n\t\t}));\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\t\tcontextKeyService.contextMatchesRulesReturnsTrue();\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 1);\n\t});\n\n\tsuite('registerAgentImplementation', function () {\n\t\tconst agentImpl: IChatAgentImplementation = {\n\t\t\tinvoke: async () => { return {}; },\n\t\t\tprovideFollowups: async () => { return []; },\n\t\t};\n\n\t\ttest('should register an agent implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tstore.add(chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\n\t\t\tconst agents = chatAgentService.getActivatedAgents();\n\t\t\tassert.strictEqual(agents.length, 1);\n\t\t\tassert.strictEqual(agents[0].id, testAgentId);\n\t\t});\n\n\t\ttest('can dispose an agent implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tconst implRegistration = chatAgentService.registerAgentImplementation(testAgentId, agentImpl);\n\t\t\timplRegistration.dispose();\n\n\t\t\tconst agents = chatAgentService.getActivatedAgents();\n\t\t\tassert.strictEqual(agents.length, 0);\n\t\t});\n\n\t\ttest('should throw error if agent does not exist', () => {\n\t\t\tassert.throws(() => chatAgentService.registerAgentImplementation('nonexistentAgent', agentImpl));\n\t\t});\n\n\t\ttest('should throw error if agent already has an implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tstore.add(chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\n\t\t\tassert.throws(() => chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ContextKeyExpression } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ChatAgentService, IChatAgentData, IChatAgentImplementation } from '../../common/chatAgents.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\n\nconst testAgentId = 'testAgent';\nconst testAgentData: IChatAgentData = {\n\tid: testAgentId,\n\tname: 'Test Agent',\n\textensionDisplayName: '',\n\textensionId: new ExtensionIdentifier(''),\n\textensionVersion: undefined,\n\textensionPublisherId: '',\n\tlocations: [],\n\tmodes: [],\n\tmetadata: {},\n\tslashCommands: [],\n\tdisambiguation: [],\n};\n\nclass TestingContextKeyService extends MockContextKeyService {\n\tprivate _contextMatchesRulesReturnsTrue = false;\n\tpublic contextMatchesRulesReturnsTrue() {\n\t\tthis._contextMatchesRulesReturnsTrue = true;\n\t}\n\n\tpublic override contextMatchesRules(rules: ContextKeyExpression): boolean {\n\t\treturn this._contextMatchesRulesReturnsTrue;\n\t}\n}\n\nsuite('ChatAgents', function () {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet chatAgentService: ChatAgentService;\n\tlet contextKeyService: TestingContextKeyService;\n\tsetup(() => {\n\t\tcontextKeyService = new TestingContextKeyService();\n\t\tchatAgentService = store.add(new ChatAgentService(contextKeyService, new TestConfigurationService()));\n\t});\n\n\ttest('registerAgent', async () => {\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\n\t\tconst agentRegistration = chatAgentService.registerAgent(testAgentId, testAgentData);\n\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 1);\n\t\tassert.strictEqual(chatAgentService.getAgents()[0].id, testAgentId);\n\n\t\tassert.throws(() => chatAgentService.registerAgent(testAgentId, testAgentData));\n\n\t\tagentRegistration.dispose();\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\t});\n\n\ttest('agent when clause', async () => {\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\t\tstore.add(chatAgentService.registerAgent(testAgentId, {\n\t\t\t...testAgentData,\n\t\t\twhen: 'myKey'\n\t\t}));\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 0);\n\n\t\tcontextKeyService.contextMatchesRulesReturnsTrue();\n\t\tassert.strictEqual(chatAgentService.getAgents().length, 1);\n\t});\n\n\tsuite('registerAgentImplementation', function () {\n\t\tconst agentImpl: IChatAgentImplementation = {\n\t\t\tinvoke: async () => { return {}; },\n\t\t\tprovideFollowups: async () => { return []; },\n\t\t};\n\n\t\ttest('should register an agent implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tstore.add(chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\n\t\t\tconst agents = chatAgentService.getActivatedAgents();\n\t\t\tassert.strictEqual(agents.length, 1);\n\t\t\tassert.strictEqual(agents[0].id, testAgentId);\n\t\t});\n\n\t\ttest('can dispose an agent implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tconst implRegistration = chatAgentService.registerAgentImplementation(testAgentId, agentImpl);\n\t\t\timplRegistration.dispose();\n\n\t\t\tconst agents = chatAgentService.getActivatedAgents();\n\t\t\tassert.strictEqual(agents.length, 0);\n\t\t});\n\n\t\ttest('should throw error if agent does not exist', () => {\n\t\t\tassert.throws(() => chatAgentService.registerAgentImplementation('nonexistentAgent', agentImpl));\n\t\t});\n\n\t\ttest('should throw error if agent already has an implementation', () => {\n\t\t\tstore.add(chatAgentService.registerAgent(testAgentId, testAgentData));\n\t\t\tstore.add(chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\n\t\t\tassert.throws(() => chatAgentService.registerAgentImplementation(testAgentId, agentImpl));\n\t\t});\n\t});\n});\n"]}