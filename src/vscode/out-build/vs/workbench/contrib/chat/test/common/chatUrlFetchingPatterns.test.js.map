{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/common/chatUrlFetchingPatterns.test.ts","vs/workbench/contrib/chat/test/common/chatUrlFetchingPatterns.test.ts"],"names":[],"mappings":"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","file":"chatUrlFetchingPatterns.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { extractUrlPatterns, getPatternLabel, isUrlApproved, getMatchingPattern, IUrlApprovalSettings } from '../../common/chatUrlFetchingPatterns.js';\n\nsuite('ChatUrlFetchingPatterns', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('extractUrlPatterns', () => {\n\t\ttest('simple domain', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com',\n\t\t\t]);\n\t\t});\n\n\t\ttest('subdomain', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://api.example.com',\n\t\t\t\t'https://*.example.com'\n\t\t\t]);\n\t\t});\n\n\t\ttest('multiple subdomains', () => {\n\t\t\tconst url = URI.parse('https://foo.bar.example.com/path');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://foo.bar.example.com/path',\n\t\t\t\t'https://foo.bar.example.com',\n\t\t\t\t'https://*.bar.example.com',\n\t\t\t\t'https://*.example.com',\n\t\t\t]);\n\t\t});\n\n\t\ttest('with path', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/v1/users');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com/api/v1/users',\n\t\t\t\t'https://example.com',\n\t\t\t\t'https://example.com/api/v1',\n\t\t\t\t'https://example.com/api',\n\t\t\t]);\n\t\t});\n\n\t\ttest('IP address - no wildcard subdomain', () => {\n\t\t\tconst url = URI.parse('https://192.168.1.1');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.strictEqual(patterns.filter(p => p.includes('*')).length, 0);\n\t\t});\n\n\t\ttest('with query and fragment', () => {\n\t\t\tconst url = URI.parse('https://example.com/path?query=1#fragment');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com/path?query=1#fragment',\n\t\t\t\t'https://example.com',\n\t\t\t]);\n\t\t});\n\t});\n\n\tsuite('getPatternLabel', () => {\n\t\ttest('removes https protocol', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('removes http protocol', () => {\n\t\t\tconst url = URI.parse('http://example.com');\n\t\t\tconst label = getPatternLabel(url, 'http://example.com');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('removes trailing slashes', () => {\n\t\t\tconst url = URI.parse('https://example.com/');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com/');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('preserves path', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/v1');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com/api/v1');\n\t\t\tassert.strictEqual(label, 'example.com/api/v1');\n\t\t});\n\t});\n\n\tsuite('isUrlApproved', () => {\n\t\ttest('exact match with boolean', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://example.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('no match returns false', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://other.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), false);\n\t\t});\n\n\t\ttest('wildcard subdomain match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst approved = { 'https://*.example.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t});\n\n\t\ttest('path wildcard match', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/users');\n\t\t\tconst approved = { 'https://example.com/api/*': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t});\n\n\t\ttest('granular settings - request approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true, approveResponse: false }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), false);\n\t\t});\n\n\t\ttest('granular settings - response approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: false, approveResponse: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), false);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('granular settings - both approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true, approveResponse: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('granular settings - missing property defaults to false', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), false);\n\t\t});\n\t});\n\n\tsuite('getMatchingPattern', () => {\n\t\ttest('exact match', () => {\n\t\t\tconst url = URI.parse('https://example.com/path');\n\t\t\tconst approved = { 'https://example.com/path': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, 'https://example.com/path');\n\t\t});\n\n\t\ttest('wildcard match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst approved = { 'https://*.example.com': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, 'https://*.example.com');\n\t\t});\n\n\t\ttest('no match returns undefined', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://other.com': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, undefined);\n\t\t});\n\n\t\ttest('most specific match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com/v1/users');\n\t\t\tconst approved = {\n\t\t\t\t'https://*.example.com': true,\n\t\t\t\t'https://api.example.com': true,\n\t\t\t\t'https://api.example.com/v1/*': true\n\t\t\t};\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.ok(pattern !== undefined);\n\t\t});\n\t});\n});\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { extractUrlPatterns, getPatternLabel, isUrlApproved, getMatchingPattern, IUrlApprovalSettings } from '../../common/chatUrlFetchingPatterns.js';\n\nsuite('ChatUrlFetchingPatterns', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuite('extractUrlPatterns', () => {\n\t\ttest('simple domain', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com',\n\t\t\t]);\n\t\t});\n\n\t\ttest('subdomain', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://api.example.com',\n\t\t\t\t'https://*.example.com'\n\t\t\t]);\n\t\t});\n\n\t\ttest('multiple subdomains', () => {\n\t\t\tconst url = URI.parse('https://foo.bar.example.com/path');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://foo.bar.example.com/path',\n\t\t\t\t'https://foo.bar.example.com',\n\t\t\t\t'https://*.bar.example.com',\n\t\t\t\t'https://*.example.com',\n\t\t\t]);\n\t\t});\n\n\t\ttest('with path', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/v1/users');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com/api/v1/users',\n\t\t\t\t'https://example.com',\n\t\t\t\t'https://example.com/api/v1',\n\t\t\t\t'https://example.com/api',\n\t\t\t]);\n\t\t});\n\n\t\ttest('IP address - no wildcard subdomain', () => {\n\t\t\tconst url = URI.parse('https://192.168.1.1');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.strictEqual(patterns.filter(p => p.includes('*')).length, 0);\n\t\t});\n\n\t\ttest('with query and fragment', () => {\n\t\t\tconst url = URI.parse('https://example.com/path?query=1#fragment');\n\t\t\tconst patterns = extractUrlPatterns(url);\n\t\t\tassert.deepStrictEqual(patterns, [\n\t\t\t\t'https://example.com/path?query=1#fragment',\n\t\t\t\t'https://example.com',\n\t\t\t]);\n\t\t});\n\t});\n\n\tsuite('getPatternLabel', () => {\n\t\ttest('removes https protocol', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('removes http protocol', () => {\n\t\t\tconst url = URI.parse('http://example.com');\n\t\t\tconst label = getPatternLabel(url, 'http://example.com');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('removes trailing slashes', () => {\n\t\t\tconst url = URI.parse('https://example.com/');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com/');\n\t\t\tassert.strictEqual(label, 'example.com');\n\t\t});\n\n\t\ttest('preserves path', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/v1');\n\t\t\tconst label = getPatternLabel(url, 'https://example.com/api/v1');\n\t\t\tassert.strictEqual(label, 'example.com/api/v1');\n\t\t});\n\t});\n\n\tsuite('isUrlApproved', () => {\n\t\ttest('exact match with boolean', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://example.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('no match returns false', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://other.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), false);\n\t\t});\n\n\t\ttest('wildcard subdomain match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst approved = { 'https://*.example.com': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t});\n\n\t\ttest('path wildcard match', () => {\n\t\t\tconst url = URI.parse('https://example.com/api/users');\n\t\t\tconst approved = { 'https://example.com/api/*': true };\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t});\n\n\t\ttest('granular settings - request approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true, approveResponse: false }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), false);\n\t\t});\n\n\t\ttest('granular settings - response approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: false, approveResponse: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), false);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('granular settings - both approved', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true, approveResponse: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, true), true);\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), true);\n\t\t});\n\n\t\ttest('granular settings - missing property defaults to false', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved: Record<string, IUrlApprovalSettings> = {\n\t\t\t\t'https://example.com': { approveRequest: true }\n\t\t\t};\n\t\t\tassert.strictEqual(isUrlApproved(url, approved, false), false);\n\t\t});\n\t});\n\n\tsuite('getMatchingPattern', () => {\n\t\ttest('exact match', () => {\n\t\t\tconst url = URI.parse('https://example.com/path');\n\t\t\tconst approved = { 'https://example.com/path': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, 'https://example.com/path');\n\t\t});\n\n\t\ttest('wildcard match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com');\n\t\t\tconst approved = { 'https://*.example.com': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, 'https://*.example.com');\n\t\t});\n\n\t\ttest('no match returns undefined', () => {\n\t\t\tconst url = URI.parse('https://example.com');\n\t\t\tconst approved = { 'https://other.com': true };\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.strictEqual(pattern, undefined);\n\t\t});\n\n\t\ttest('most specific match', () => {\n\t\t\tconst url = URI.parse('https://api.example.com/v1/users');\n\t\t\tconst approved = {\n\t\t\t\t'https://*.example.com': true,\n\t\t\t\t'https://api.example.com': true,\n\t\t\t\t'https://api.example.com/v1/*': true\n\t\t\t};\n\t\t\tconst pattern = getMatchingPattern(url, approved);\n\t\t\tassert.ok(pattern !== undefined);\n\t\t});\n\t});\n});\n\n"]}