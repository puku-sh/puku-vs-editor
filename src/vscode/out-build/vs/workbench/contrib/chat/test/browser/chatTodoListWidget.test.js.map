{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/browser/chatTodoListWidget.test.ts","vs/workbench/contrib/chat/test/browser/chatTodoListWidget.test.ts"],"names":[],"mappings":"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","file":"chatTodoListWidget.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable no-restricted-syntax */\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ChatTodoListWidget } from '../../browser/chatContentParts/chatTodoListWidget.js';\nimport { IChatTodo, IChatTodoListService } from '../../common/chatTodoListService.js';\nimport { mainWindow } from '../../../../../base/browser/window.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { URI } from '../../../../../base/common/uri.js';\n\nconst testSessionUri = URI.parse('chat-session://test/session1');\n\nsuite('ChatTodoListWidget Accessibility', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet widget: ChatTodoListWidget;\n\n\tconst sampleTodos: IChatTodo[] = [\n\t\t{ id: 1, title: 'First task', status: 'not-started' },\n\t\t{ id: 2, title: 'Second task', status: 'in-progress', description: 'This is a task description' },\n\t\t{ id: 3, title: 'Third task', status: 'completed' }\n\t];\n\n\tsetup(() => {\n\t\t// Mock the todo list service\n\t\tconst mockTodoListService: IChatTodoListService = {\n\t\t\t_serviceBrand: undefined,\n\t\t\tonDidUpdateTodos: Event.None,\n\t\t\tgetTodos: (sessionResource: URI) => sampleTodos,\n\t\t\tsetTodos: (sessionResource: URI, todos: IChatTodo[]) => { }\n\t\t};\n\n\t\t// Mock the configuration service\n\t\tconst mockConfigurationService = new TestConfigurationService({ 'chat.todoListTool.descriptionField': true });\n\n\t\tconst instantiationService = workbenchInstantiationService(undefined, store);\n\t\tinstantiationService.stub(IChatTodoListService, mockTodoListService);\n\t\tinstantiationService.stub(IConfigurationService, mockConfigurationService);\n\t\twidget = store.add(instantiationService.createInstance(ChatTodoListWidget));\n\t\tmainWindow.document.body.appendChild(widget.domNode);\n\t});\n\n\tteardown(() => {\n\t\tif (widget.domNode.parentNode) {\n\t\t\twidget.domNode.parentNode.removeChild(widget.domNode);\n\t\t}\n\t});\n\n\ttest('creates proper semantic list structure', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoListContainer = widget.domNode.querySelector('.todo-list-container');\n\t\tassert.ok(todoListContainer, 'Should have todo list container');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('aria-labelledby'), 'todo-list-title');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('role'), 'list');\n\n\t\tconst titleElement = widget.domNode.querySelector('#todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element with ID todo-list-title');\n\t\t// When collapsed, title shows progress and current task without \"Todos\" prefix\n\t\tassert.ok(titleElement?.textContent, 'Title should have content');\n\n\t\t// The todo list container itself acts as the list (no nested ul element)\n\t\tconst todoItems = todoListContainer?.querySelectorAll('li.todo-item');\n\t\tassert.ok(todoItems && todoItems.length > 0, 'Should have todo items in the list container');\n\t});\n\n\ttest('todo items have proper accessibility attributes', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoItems = widget.domNode.querySelectorAll('.todo-item');\n\t\tassert.strictEqual(todoItems.length, 3, 'Should have 3 todo items');\n\n\t\t// Check first item (not-started)\n\t\tconst firstItem = todoItems[0] as HTMLElement;\n\t\tassert.strictEqual(firstItem.getAttribute('role'), 'listitem');\n\t\tassert.ok(firstItem.getAttribute('aria-label')?.includes('First task'));\n\t\tassert.ok(firstItem.getAttribute('aria-label')?.includes('not started'));\n\n\t\t// Check second item (in-progress with description)\n\t\tconst secondItem = todoItems[1] as HTMLElement;\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('Second task'));\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('in progress'));\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('This is a task description'));\n\n\t\t// Check third item (completed)\n\t\tconst thirdItem = todoItems[2] as HTMLElement;\n\t\tassert.ok(thirdItem.getAttribute('aria-label')?.includes('Third task'));\n\t\tassert.ok(thirdItem.getAttribute('aria-label')?.includes('completed'));\n\t});\n\n\ttest('status icons are hidden from screen readers', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst statusIcons = widget.domNode.querySelectorAll('.todo-status-icon');\n\t\tstatusIcons.forEach(icon => {\n\t\t\tassert.strictEqual(icon.getAttribute('aria-hidden'), 'true', 'Status icons should be hidden from screen readers');\n\t\t});\n\t});\n\n\ttest('expand button has proper accessibility attributes', () => {\n\t\twidget.render(testSessionUri);\n\n\t\t// The expandoButton is now a Monaco Button, so we need to check its element\n\t\tconst expandoContainer = widget.domNode.querySelector('.todo-list-expand');\n\t\tassert.ok(expandoContainer, 'Should have expando container');\n\n\t\tconst expandoButton = expandoContainer?.querySelector('.monaco-button');\n\t\tassert.ok(expandoButton, 'Should have Monaco button');\n\t\tassert.strictEqual(expandoButton?.getAttribute('aria-expanded'), 'false'); // Should be collapsed due to in-progress task\n\t\tassert.strictEqual(expandoButton?.getAttribute('aria-controls'), 'todo-list-container');\n\n\t\t// The title element should have progress information\n\t\tconst titleElement = expandoButton?.querySelector('.todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element');\n\t\tconst titleText = titleElement?.textContent;\n\t\t// When collapsed, title shows progress and current task: \" (2/3) - Second task\"\n\t\t// Progress is 2/3 because: 1 completed + 1 in-progress (current) = task 2 of 3\n\t\tassert.ok(titleText?.includes('(2/3)'), `Title should show progress format, but got: \"${titleText}\"`);\n\t\tassert.ok(titleText?.includes('Second task'), `Title should show current task when collapsed, but got: \"${titleText}\"`);\n\t});\n\n\ttest('todo items have complete aria-label with status information', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoItems = widget.domNode.querySelectorAll('.todo-item');\n\t\tassert.strictEqual(todoItems.length, 3, 'Should have 3 todo items');\n\n\t\t// Check first item (not-started) - aria-label should include title and status\n\t\tconst firstItem = todoItems[0] as HTMLElement;\n\t\tconst firstAriaLabel = firstItem.getAttribute('aria-label');\n\t\tassert.ok(firstAriaLabel?.includes('First task'), 'First item aria-label should include title');\n\t\tassert.ok(firstAriaLabel?.includes('not started'), 'First item aria-label should include status');\n\n\t\t// Check second item (in-progress with description) - aria-label should include title, status, and description\n\t\tconst secondItem = todoItems[1] as HTMLElement;\n\t\tconst secondAriaLabel = secondItem.getAttribute('aria-label');\n\t\tassert.ok(secondAriaLabel?.includes('Second task'), 'Second item aria-label should include title');\n\t\tassert.ok(secondAriaLabel?.includes('in progress'), 'Second item aria-label should include status');\n\t\tassert.ok(secondAriaLabel?.includes('This is a task description'), 'Second item aria-label should include description');\n\n\t\t// Check third item (completed) - aria-label should include title and status\n\t\tconst thirdItem = todoItems[2] as HTMLElement;\n\t\tconst thirdAriaLabel = thirdItem.getAttribute('aria-label');\n\t\tassert.ok(thirdAriaLabel?.includes('Third task'), 'Third item aria-label should include title');\n\t\tassert.ok(thirdAriaLabel?.includes('completed'), 'Third item aria-label should include status');\n\t});\n\n\ttest('widget displays properly when no todos exist', () => {\n\t\t// Create a new mock service with empty todos\n\t\tconst emptyTodoListService: IChatTodoListService = {\n\t\t\t_serviceBrand: undefined,\n\t\t\tonDidUpdateTodos: Event.None,\n\t\t\tgetTodos: (sessionResource: URI) => [],\n\t\t\tsetTodos: (sessionResource: URI, todos: IChatTodo[]) => { }\n\t\t};\n\n\t\tconst emptyConfigurationService = new TestConfigurationService({ 'chat.todoListTool.descriptionField': true });\n\n\t\tconst instantiationService = workbenchInstantiationService(undefined, store);\n\t\tinstantiationService.stub(IChatTodoListService, emptyTodoListService);\n\t\tinstantiationService.stub(IConfigurationService, emptyConfigurationService);\n\t\tconst emptyWidget = store.add(instantiationService.createInstance(ChatTodoListWidget));\n\t\tmainWindow.document.body.appendChild(emptyWidget.domNode);\n\n\t\temptyWidget.render(testSessionUri);\n\n\t\t// Widget should be hidden when no todos\n\t\tassert.strictEqual(emptyWidget.domNode.style.display, 'none', 'Widget should be hidden when no todos');\n\t});\n\n\ttest('clear button has proper accessibility', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst clearButton = widget.domNode.querySelector('.todo-clear-button-container .monaco-button');\n\t\tassert.ok(clearButton, 'Should have clear button');\n\t\tassert.strictEqual(clearButton?.getAttribute('tabindex'), '0', 'Clear button should be focusable');\n\t});\n\n\ttest('title element displays progress correctly and is accessible', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst titleElement = widget.domNode.querySelector('#todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element with ID');\n\n\t\t// Title should show progress format: \" (2/3)\" since one todo is completed and one is in-progress\n\t\t// When collapsed, it also shows the current task: \" (2/3) - Second task\"\n\t\t// Progress is 2/3 because: 1 completed + 1 in-progress (current) = task 2 of 3\n\t\tconst titleText = titleElement?.textContent;\n\t\tassert.ok(titleText?.includes('(2/3)'), `Title should show progress format, but got: \"${titleText}\"`);\n\t\tassert.ok(titleText?.includes('Second task'), `Title should show current task when collapsed, but got: \"${titleText}\"`);\n\n\t\t// Verify aria-labelledby connection works\n\t\tconst todoListContainer = widget.domNode.querySelector('.todo-list-container');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('aria-labelledby'), 'todo-list-title');\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* eslint-disable no-restricted-syntax */\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ChatTodoListWidget } from '../../browser/chatContentParts/chatTodoListWidget.js';\nimport { IChatTodo, IChatTodoListService } from '../../common/chatTodoListService.js';\nimport { mainWindow } from '../../../../../base/browser/window.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { URI } from '../../../../../base/common/uri.js';\n\nconst testSessionUri = URI.parse('chat-session://test/session1');\n\nsuite('ChatTodoListWidget Accessibility', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet widget: ChatTodoListWidget;\n\n\tconst sampleTodos: IChatTodo[] = [\n\t\t{ id: 1, title: 'First task', status: 'not-started' },\n\t\t{ id: 2, title: 'Second task', status: 'in-progress', description: 'This is a task description' },\n\t\t{ id: 3, title: 'Third task', status: 'completed' }\n\t];\n\n\tsetup(() => {\n\t\t// Mock the todo list service\n\t\tconst mockTodoListService: IChatTodoListService = {\n\t\t\t_serviceBrand: undefined,\n\t\t\tonDidUpdateTodos: Event.None,\n\t\t\tgetTodos: (sessionResource: URI) => sampleTodos,\n\t\t\tsetTodos: (sessionResource: URI, todos: IChatTodo[]) => { }\n\t\t};\n\n\t\t// Mock the configuration service\n\t\tconst mockConfigurationService = new TestConfigurationService({ 'chat.todoListTool.descriptionField': true });\n\n\t\tconst instantiationService = workbenchInstantiationService(undefined, store);\n\t\tinstantiationService.stub(IChatTodoListService, mockTodoListService);\n\t\tinstantiationService.stub(IConfigurationService, mockConfigurationService);\n\t\twidget = store.add(instantiationService.createInstance(ChatTodoListWidget));\n\t\tmainWindow.document.body.appendChild(widget.domNode);\n\t});\n\n\tteardown(() => {\n\t\tif (widget.domNode.parentNode) {\n\t\t\twidget.domNode.parentNode.removeChild(widget.domNode);\n\t\t}\n\t});\n\n\ttest('creates proper semantic list structure', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoListContainer = widget.domNode.querySelector('.todo-list-container');\n\t\tassert.ok(todoListContainer, 'Should have todo list container');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('aria-labelledby'), 'todo-list-title');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('role'), 'list');\n\n\t\tconst titleElement = widget.domNode.querySelector('#todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element with ID todo-list-title');\n\t\t// When collapsed, title shows progress and current task without \"Todos\" prefix\n\t\tassert.ok(titleElement?.textContent, 'Title should have content');\n\n\t\t// The todo list container itself acts as the list (no nested ul element)\n\t\tconst todoItems = todoListContainer?.querySelectorAll('li.todo-item');\n\t\tassert.ok(todoItems && todoItems.length > 0, 'Should have todo items in the list container');\n\t});\n\n\ttest('todo items have proper accessibility attributes', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoItems = widget.domNode.querySelectorAll('.todo-item');\n\t\tassert.strictEqual(todoItems.length, 3, 'Should have 3 todo items');\n\n\t\t// Check first item (not-started)\n\t\tconst firstItem = todoItems[0] as HTMLElement;\n\t\tassert.strictEqual(firstItem.getAttribute('role'), 'listitem');\n\t\tassert.ok(firstItem.getAttribute('aria-label')?.includes('First task'));\n\t\tassert.ok(firstItem.getAttribute('aria-label')?.includes('not started'));\n\n\t\t// Check second item (in-progress with description)\n\t\tconst secondItem = todoItems[1] as HTMLElement;\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('Second task'));\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('in progress'));\n\t\tassert.ok(secondItem.getAttribute('aria-label')?.includes('This is a task description'));\n\n\t\t// Check third item (completed)\n\t\tconst thirdItem = todoItems[2] as HTMLElement;\n\t\tassert.ok(thirdItem.getAttribute('aria-label')?.includes('Third task'));\n\t\tassert.ok(thirdItem.getAttribute('aria-label')?.includes('completed'));\n\t});\n\n\ttest('status icons are hidden from screen readers', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst statusIcons = widget.domNode.querySelectorAll('.todo-status-icon');\n\t\tstatusIcons.forEach(icon => {\n\t\t\tassert.strictEqual(icon.getAttribute('aria-hidden'), 'true', 'Status icons should be hidden from screen readers');\n\t\t});\n\t});\n\n\ttest('expand button has proper accessibility attributes', () => {\n\t\twidget.render(testSessionUri);\n\n\t\t// The expandoButton is now a Monaco Button, so we need to check its element\n\t\tconst expandoContainer = widget.domNode.querySelector('.todo-list-expand');\n\t\tassert.ok(expandoContainer, 'Should have expando container');\n\n\t\tconst expandoButton = expandoContainer?.querySelector('.monaco-button');\n\t\tassert.ok(expandoButton, 'Should have Monaco button');\n\t\tassert.strictEqual(expandoButton?.getAttribute('aria-expanded'), 'false'); // Should be collapsed due to in-progress task\n\t\tassert.strictEqual(expandoButton?.getAttribute('aria-controls'), 'todo-list-container');\n\n\t\t// The title element should have progress information\n\t\tconst titleElement = expandoButton?.querySelector('.todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element');\n\t\tconst titleText = titleElement?.textContent;\n\t\t// When collapsed, title shows progress and current task: \" (2/3) - Second task\"\n\t\t// Progress is 2/3 because: 1 completed + 1 in-progress (current) = task 2 of 3\n\t\tassert.ok(titleText?.includes('(2/3)'), `Title should show progress format, but got: \"${titleText}\"`);\n\t\tassert.ok(titleText?.includes('Second task'), `Title should show current task when collapsed, but got: \"${titleText}\"`);\n\t});\n\n\ttest('todo items have complete aria-label with status information', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst todoItems = widget.domNode.querySelectorAll('.todo-item');\n\t\tassert.strictEqual(todoItems.length, 3, 'Should have 3 todo items');\n\n\t\t// Check first item (not-started) - aria-label should include title and status\n\t\tconst firstItem = todoItems[0] as HTMLElement;\n\t\tconst firstAriaLabel = firstItem.getAttribute('aria-label');\n\t\tassert.ok(firstAriaLabel?.includes('First task'), 'First item aria-label should include title');\n\t\tassert.ok(firstAriaLabel?.includes('not started'), 'First item aria-label should include status');\n\n\t\t// Check second item (in-progress with description) - aria-label should include title, status, and description\n\t\tconst secondItem = todoItems[1] as HTMLElement;\n\t\tconst secondAriaLabel = secondItem.getAttribute('aria-label');\n\t\tassert.ok(secondAriaLabel?.includes('Second task'), 'Second item aria-label should include title');\n\t\tassert.ok(secondAriaLabel?.includes('in progress'), 'Second item aria-label should include status');\n\t\tassert.ok(secondAriaLabel?.includes('This is a task description'), 'Second item aria-label should include description');\n\n\t\t// Check third item (completed) - aria-label should include title and status\n\t\tconst thirdItem = todoItems[2] as HTMLElement;\n\t\tconst thirdAriaLabel = thirdItem.getAttribute('aria-label');\n\t\tassert.ok(thirdAriaLabel?.includes('Third task'), 'Third item aria-label should include title');\n\t\tassert.ok(thirdAriaLabel?.includes('completed'), 'Third item aria-label should include status');\n\t});\n\n\ttest('widget displays properly when no todos exist', () => {\n\t\t// Create a new mock service with empty todos\n\t\tconst emptyTodoListService: IChatTodoListService = {\n\t\t\t_serviceBrand: undefined,\n\t\t\tonDidUpdateTodos: Event.None,\n\t\t\tgetTodos: (sessionResource: URI) => [],\n\t\t\tsetTodos: (sessionResource: URI, todos: IChatTodo[]) => { }\n\t\t};\n\n\t\tconst emptyConfigurationService = new TestConfigurationService({ 'chat.todoListTool.descriptionField': true });\n\n\t\tconst instantiationService = workbenchInstantiationService(undefined, store);\n\t\tinstantiationService.stub(IChatTodoListService, emptyTodoListService);\n\t\tinstantiationService.stub(IConfigurationService, emptyConfigurationService);\n\t\tconst emptyWidget = store.add(instantiationService.createInstance(ChatTodoListWidget));\n\t\tmainWindow.document.body.appendChild(emptyWidget.domNode);\n\n\t\temptyWidget.render(testSessionUri);\n\n\t\t// Widget should be hidden when no todos\n\t\tassert.strictEqual(emptyWidget.domNode.style.display, 'none', 'Widget should be hidden when no todos');\n\t});\n\n\ttest('clear button has proper accessibility', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst clearButton = widget.domNode.querySelector('.todo-clear-button-container .monaco-button');\n\t\tassert.ok(clearButton, 'Should have clear button');\n\t\tassert.strictEqual(clearButton?.getAttribute('tabindex'), '0', 'Clear button should be focusable');\n\t});\n\n\ttest('title element displays progress correctly and is accessible', () => {\n\t\twidget.render(testSessionUri);\n\n\t\tconst titleElement = widget.domNode.querySelector('#todo-list-title');\n\t\tassert.ok(titleElement, 'Should have title element with ID');\n\n\t\t// Title should show progress format: \" (2/3)\" since one todo is completed and one is in-progress\n\t\t// When collapsed, it also shows the current task: \" (2/3) - Second task\"\n\t\t// Progress is 2/3 because: 1 completed + 1 in-progress (current) = task 2 of 3\n\t\tconst titleText = titleElement?.textContent;\n\t\tassert.ok(titleText?.includes('(2/3)'), `Title should show progress format, but got: \"${titleText}\"`);\n\t\tassert.ok(titleText?.includes('Second task'), `Title should show current task when collapsed, but got: \"${titleText}\"`);\n\n\t\t// Verify aria-labelledby connection works\n\t\tconst todoListContainer = widget.domNode.querySelector('.todo-list-container');\n\t\tassert.strictEqual(todoListContainer?.getAttribute('aria-labelledby'), 'todo-list-title');\n\t});\n});\n"]}