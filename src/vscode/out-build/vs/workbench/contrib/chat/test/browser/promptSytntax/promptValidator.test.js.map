{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/browser/promptSytntax/promptValidator.test.ts","vs/workbench/contrib/chat/test/browser/promptSytntax/promptValidator.test.ts"],"names":[],"mappings":"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","file":"promptValidator.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\n\nimport { ResourceSet } from '../../../../../../base/common/map.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ContextKeyService } from '../../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { TestConfigurationService } from '../../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ExtensionIdentifier } from '../../../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../../../platform/files/common/files.js';\nimport { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILabelService } from '../../../../../../platform/label/common/label.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../../../platform/markers/common/markers.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { LanguageModelToolsService } from '../../../browser/languageModelToolsService.js';\nimport { ChatMode, CustomChatMode, IChatModeService } from '../../../common/chatModes.js';\nimport { IChatService } from '../../../common/chatService.js';\nimport { ChatConfiguration } from '../../../common/constants.js';\nimport { ILanguageModelToolsService, IToolData, ToolDataSource } from '../../../common/languageModelToolsService.js';\nimport { ILanguageModelChatMetadata, ILanguageModelsService } from '../../../common/languageModels.js';\nimport { getPromptFileExtension } from '../../../common/promptSyntax/config/promptFileLocations.js';\nimport { PromptValidator } from '../../../common/promptSyntax/languageProviders/promptValidator.js';\nimport { PromptsType } from '../../../common/promptSyntax/promptTypes.js';\nimport { PromptFileParser } from '../../../common/promptSyntax/promptFileParser.js';\nimport { PromptsStorage } from '../../../common/promptSyntax/service/promptsService.js';\nimport { MockChatModeService } from '../../common/mockChatModeService.js';\nimport { MockChatService } from '../../common/mockChatService.js';\n\nsuite('PromptValidator', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instaService: TestInstantiationService;\n\n\tconst existingRef1 = URI.parse('myFs://test/reference1.md');\n\tconst existingRef2 = URI.parse('myFs://test/reference2.md');\n\n\tsetup(async () => {\n\n\t\tconst testConfigService = new TestConfigurationService();\n\t\ttestConfigService.setUserConfiguration(ChatConfiguration.ExtensionToolsEnabled, true);\n\t\tinstaService = workbenchInstantiationService({\n\t\t\tcontextKeyService: () => disposables.add(new ContextKeyService(testConfigService)),\n\t\t\tconfigurationService: () => testConfigService\n\t\t}, disposables);\n\t\tconst chatService = new MockChatService();\n\t\tinstaService.stub(IChatService, chatService);\n\t\tinstaService.stub(ILabelService, { getUriLabel: (resource) => resource.path });\n\n\t\tconst toolService = disposables.add(instaService.createInstance(LanguageModelToolsService));\n\n\t\tconst testTool1 = { id: 'testTool1', displayName: 'tool1', canBeReferencedInPrompt: true, modelDescription: 'Test Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool1));\n\t\tconst testTool2 = { id: 'testTool2', displayName: 'tool2', canBeReferencedInPrompt: true, toolReferenceName: 'tool2', modelDescription: 'Test Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool2));\n\t\tconst shellTool = { id: 'shell', displayName: 'shell', canBeReferencedInPrompt: true, toolReferenceName: 'shell', modelDescription: 'Runs commands in the terminal', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(shellTool));\n\n\t\tconst myExtSource = { type: 'extension', label: 'My Extension', extensionId: new ExtensionIdentifier('My.extension') } satisfies ToolDataSource;\n\t\tconst testTool3 = { id: 'testTool3', displayName: 'tool3', canBeReferencedInPrompt: true, toolReferenceName: 'tool3', modelDescription: 'Test Tool 3', source: myExtSource, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool3));\n\n\t\tconst prExtSource = { type: 'extension', label: 'GitHub Pull Request Extension', extensionId: new ExtensionIdentifier('github.vscode-pull-request-github') } satisfies ToolDataSource;\n\t\tconst prExtTool1 = { id: 'suggestFix', canBeReferencedInPrompt: true, toolReferenceName: 'suggest-fix', modelDescription: 'tool4', displayName: 'Test Tool 4', source: prExtSource, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(prExtTool1));\n\n\t\tconst toolWithLegacy = { id: 'newTool', toolReferenceName: 'newToolRef', displayName: 'New Tool', canBeReferencedInPrompt: true, modelDescription: 'New Tool', source: ToolDataSource.External, inputSchema: {}, legacyToolReferenceFullNames: ['oldToolName', 'deprecatedToolName'] } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(toolWithLegacy));\n\n\t\tconst toolSetWithLegacy = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'newToolSet',\n\t\t\t'newToolSetRef',\n\t\t\t{ description: 'New Tool Set', legacyFullNames: ['oldToolSet', 'deprecatedToolSet'] }\n\t\t));\n\t\tconst toolInSet = { id: 'toolInSet', toolReferenceName: 'toolInSetRef', displayName: 'Tool In Set', canBeReferencedInPrompt: false, modelDescription: 'Tool In Set', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(toolInSet));\n\t\tdisposables.add(toolSetWithLegacy.addTool(toolInSet));\n\n\t\tconst anotherToolWithLegacy = { id: 'anotherTool', toolReferenceName: 'anotherToolRef', displayName: 'Another Tool', canBeReferencedInPrompt: true, modelDescription: 'Another Tool', source: ToolDataSource.External, inputSchema: {}, legacyToolReferenceFullNames: ['legacyTool'] } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(anotherToolWithLegacy));\n\n\t\tconst anotherToolSetWithLegacy = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'anotherToolSet',\n\t\t\t'anotherToolSetRef',\n\t\t\t{ description: 'Another Tool Set', legacyFullNames: ['legacyToolSet'] }\n\t\t));\n\t\tconst anotherToolInSet = { id: 'anotherToolInSet', toolReferenceName: 'anotherToolInSetRef', displayName: 'Another Tool In Set', canBeReferencedInPrompt: false, modelDescription: 'Another Tool In Set', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(anotherToolInSet));\n\t\tdisposables.add(anotherToolSetWithLegacy.addTool(anotherToolInSet));\n\n\t\tconst conflictToolSet1 = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'conflictSet1',\n\t\t\t'conflictSet1Ref',\n\t\t\t{ legacyFullNames: ['sharedLegacyName'] }\n\t\t));\n\t\tconst conflictTool1 = { id: 'conflictTool1', toolReferenceName: 'conflictTool1Ref', displayName: 'Conflict Tool 1', canBeReferencedInPrompt: false, modelDescription: 'Conflict Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(conflictTool1));\n\t\tdisposables.add(conflictToolSet1.addTool(conflictTool1));\n\n\t\tconst conflictToolSet2 = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'conflictSet2',\n\t\t\t'conflictSet2Ref',\n\t\t\t{ legacyFullNames: ['sharedLegacyName'] }\n\t\t));\n\t\tconst conflictTool2 = { id: 'conflictTool2', toolReferenceName: 'conflictTool2Ref', displayName: 'Conflict Tool 2', canBeReferencedInPrompt: false, modelDescription: 'Conflict Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(conflictTool2));\n\t\tdisposables.add(conflictToolSet2.addTool(conflictTool2));\n\n\t\tinstaService.set(ILanguageModelToolsService, toolService);\n\n\t\tconst testModels: ILanguageModelChatMetadata[] = [\n\t\t\t{ id: 'mae-4', name: 'MAE 4', vendor: 'olama', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024, capabilities: { agentMode: true, toolCalling: true } } satisfies ILanguageModelChatMetadata,\n\t\t\t{ id: 'mae-4.1', name: 'MAE 4.1', vendor: 'copilot', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024, capabilities: { agentMode: true, toolCalling: true } } satisfies ILanguageModelChatMetadata,\n\t\t\t{ id: 'mae-3.5-turbo', name: 'MAE 3.5 Turbo', vendor: 'copilot', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024 } satisfies ILanguageModelChatMetadata\n\t\t];\n\n\t\tinstaService.stub(ILanguageModelsService, {\n\t\t\tgetLanguageModelIds() { return testModels.map(m => m.id); },\n\t\t\tlookupLanguageModel(name: string) {\n\t\t\t\treturn testModels.find(m => m.id === name);\n\t\t\t}\n\t\t});\n\n\t\tconst customChatMode = new CustomChatMode({\n\t\t\turi: URI.parse('myFs://test/test/chatmode.md'),\n\t\t\tname: 'BeastMode',\n\t\t\tagentInstructions: { content: 'Beast mode instructions', toolReferences: [] },\n\t\t\tsource: { storage: PromptsStorage.local }\n\t\t});\n\t\tinstaService.stub(IChatModeService, new MockChatModeService({ builtin: [ChatMode.Agent, ChatMode.Ask, ChatMode.Edit], custom: [customChatMode] }));\n\n\n\t\tconst existingFiles = new ResourceSet([existingRef1, existingRef2]);\n\t\tinstaService.stub(IFileService, {\n\t\t\texists(uri: URI) {\n\t\t\t\treturn Promise.resolve(existingFiles.has(uri));\n\t\t\t}\n\t\t});\n\t});\n\n\tasync function validate(code: string, promptType: PromptsType): Promise<IMarkerData[]> {\n\t\tconst uri = URI.parse('myFs://test/testFile' + getPromptFileExtension(promptType));\n\t\tconst result = new PromptFileParser().parse(uri, code);\n\t\tconst validator = instaService.createInstance(PromptValidator);\n\t\tconst markers: IMarkerData[] = [];\n\t\tawait validator.validate(result, promptType, m => markers.push(m));\n\t\treturn markers;\n\t}\n\tsuite('agents', () => {\n\n\t\ttest('correct agent', async () => {\n\t\t\tconst content = [\n\t\t\t/* 01 */'---',\n\t\t\t/* 02 */`description: \"Agent mode test\"`,\n\t\t\t/* 03 */'model: MAE 4.1',\n\t\t\t/* 04 */`tools: ['tool1', 'tool2']`,\n\t\t\t/* 05 */'---',\n\t\t\t/* 06 */'This is a chat agent test.',\n\t\t\t/* 07 */'Here is a #tool1 variable and a #file:./reference1.md as well as a [reference](./reference2.md).',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('agent with errors (empty description, unknown tool & model)', async () => {\n\t\t\tconst content = [\n\t\t\t/* 01 */'---',\n\t\t\t/* 02 */`description: \"\"`, // empty description -> error\n\t\t\t/* 03 */'model: MAE 4.2', // unknown model -> warning\n\t\t\t/* 04 */`tools: ['tool1', 'tool2', 'tool4', 'my.extension/tool3']`, // tool4 unknown -> error\n\t\t\t/* 05 */'---',\n\t\t\t/* 06 */'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Error, message: `The 'description' attribute should not be empty.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Unknown tool 'tool4'.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Unknown model 'MAE 4.2'.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('tools must be array', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: 'tool1'`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'tools' attribute must be an array.`]);\n\t\t});\n\n\t\ttest('each tool must be string', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['tool1', 2]`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Error, message: `Each tool name in the 'tools' attribute must be a string.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('old tool reference', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['tool1', 'tool3']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'tool3' has been renamed, use 'my.extension/tool3' instead.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('legacy tool reference names', async () => {\n\t\t\t// Test using legacy tool reference name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'oldToolName']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'oldToolName' has been renamed, use 'newToolRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Test using another legacy tool reference name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'deprecatedToolName']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'deprecatedToolName' has been renamed, use 'newToolRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\ttest('legacy toolset names', async () => {\n\t\t\t// Test using legacy toolset name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'oldToolSet']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'oldToolSet' has been renamed, use 'newToolSetRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Test using another legacy toolset name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'deprecatedToolSet']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'deprecatedToolSet' has been renamed, use 'newToolSetRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\ttest('multiple legacy names in same tools list', async () => {\n\t\t\t// Test multiple legacy names together\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['legacyTool', 'legacyToolSet', 'tool3']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'legacyTool' has been renamed, use 'anotherToolRef' instead.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'legacyToolSet' has been renamed, use 'anotherToolSetRef' instead.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'tool3' has been renamed, use 'my.extension/tool3' instead.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('deprecated tool name mapping to multiple new names', async () => {\n\t\t\t// The toolsets are registered in setup with a shared legacy name 'sharedLegacyName'\n\t\t\t// This simulates the case where one deprecated name maps to multiple current names\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['sharedLegacyName']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\t// When multiple toolsets share the same legacy name, the message should indicate multiple options\n\t\t\t// The message will say \"use the following tools instead:\" for multiple mappings\n\t\t\tconst expectedMessage = `Tool or toolset 'sharedLegacyName' has been renamed, use the following tools instead: conflictSet1Ref, conflictSet2Ref`;\n\t\t\tassert.strictEqual(markers[0].message, expectedMessage);\n\t\t});\n\n\t\ttest('deprecated tool name in body variable reference - single mapping', async () => {\n\t\t\t// Test deprecated tool name used as variable reference in body\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool:oldToolName reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\tassert.strictEqual(markers[0].message, `Tool or toolset 'oldToolName' has been renamed, use 'newToolRef' instead.`);\n\t\t});\n\n\t\ttest('deprecated tool name in body variable reference - multiple mappings', async () => {\n\t\t\t// Register tools with the same legacy name to create multiple mappings\n\t\t\tconst multiMapToolSet1 = disposables.add(instaService.get(ILanguageModelToolsService).createToolSet(\n\t\t\t\tToolDataSource.External,\n\t\t\t\t'multiMapSet1',\n\t\t\t\t'multiMapSet1Ref',\n\t\t\t\t{ legacyFullNames: ['multiMapLegacy'] }\n\t\t\t));\n\t\t\tconst multiMapTool1 = { id: 'multiMapTool1', toolReferenceName: 'multiMapTool1Ref', displayName: 'Multi Map Tool 1', canBeReferencedInPrompt: true, modelDescription: 'Multi Map Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\t\tdisposables.add(instaService.get(ILanguageModelToolsService).registerToolData(multiMapTool1));\n\t\t\tdisposables.add(multiMapToolSet1.addTool(multiMapTool1));\n\n\t\t\tconst multiMapToolSet2 = disposables.add(instaService.get(ILanguageModelToolsService).createToolSet(\n\t\t\t\tToolDataSource.External,\n\t\t\t\t'multiMapSet2',\n\t\t\t\t'multiMapSet2Ref',\n\t\t\t\t{ legacyFullNames: ['multiMapLegacy'] }\n\t\t\t));\n\t\t\tconst multiMapTool2 = { id: 'multiMapTool2', toolReferenceName: 'multiMapTool2Ref', displayName: 'Multi Map Tool 2', canBeReferencedInPrompt: true, modelDescription: 'Multi Map Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\t\tdisposables.add(instaService.get(ILanguageModelToolsService).registerToolData(multiMapTool2));\n\t\t\tdisposables.add(multiMapToolSet2.addTool(multiMapTool2));\n\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool:multiMapLegacy reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\t// When multiple toolsets share the same legacy name, the message should indicate multiple options\n\t\t\t// The message will say \"use the following tools instead:\" for multiple mappings in body references\n\t\t\tconst expectedMessage = `Tool or toolset 'multiMapLegacy' has been renamed, use the following tools instead: multiMapSet1Ref, multiMapSet2Ref`;\n\t\t\tassert.strictEqual(markers[0].message, expectedMessage);\n\t\t});\n\n\t\ttest('unknown attribute in agent file', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`applyTo: '*.ts'`, // not allowed in agent file\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Attribute 'applyTo' is not supported in VS Code agent files. Supported: argument-hint, description, handoffs, model, name, target, tools.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('tools with invalid handoffs', async () => {\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs: next`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'handoffs' attribute must be an array.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`Missing required properties 'agent', 'prompt' in handoff object.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t`    agent: ''`,\n\t\t\t\t\t`    prompt: ''`,\n\t\t\t\t\t`    send: true`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'agent' property in a handoff must be a non-empty string.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t`    agent: 'Cool'`,\n\t\t\t\t\t`    prompt: ''`,\n\t\t\t\t\t`    send: true`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`Unknown agent 'Cool'. Available agents: agent, ask, edit, BeastMode.`]);\n\t\t\t}\n\t\t});\n\n\t\ttest('agent with handoffs attribute', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \\\"Test agent with handoffs\\\"',\n\t\t\t\t`handoffs:`,\n\t\t\t\t'  - label: Test Prompt',\n\t\t\t\t'    agent: agent',\n\t\t\t\t'    prompt: Add tests for this code',\n\t\t\t\t'  - label: Optimize Performance',\n\t\t\t\t'    agent: agent',\n\t\t\t\t'    prompt: Optimize for performance',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues for handoffs attribute');\n\t\t});\n\n\t\ttest('github-copilot agent with supported attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHub_Copilot_Custom_Agent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t`tools: ['shell', 'edit', 'search', 'custom-agent']`,\n\t\t\t\t'mcp-servers: []',\n\t\t\t\t'---',\n\t\t\t\t'Body with #search and #edit references',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent warns about model and handoffs attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['shell', 'edit']`,\n\t\t\t\t`handoffs:`,\n\t\t\t\t'  - label: Test',\n\t\t\t\t'    agent: Default',\n\t\t\t\t'    prompt: Test',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'model\\' is not supported in custom GitHub Copilot agent files. Supported: description, mcp-servers, name, target, tools.',\n\t\t\t\t'Attribute \\'handoffs\\' is not supported in custom GitHub Copilot agent files. Supported: description, mcp-servers, name, target, tools.',\n\t\t\t], 'Model and handoffs are not validated for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent does not validate variable references', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t`tools: ['shell', 'edit']`,\n\t\t\t\t'---',\n\t\t\t\t'Body with #unknownTool reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t// Variable references should not be validated for github-copilot target\n\t\t\tassert.deepStrictEqual(markers, [], 'Variable references are not validated for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent rejects unsupported attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t'argument-hint: \"test hint\"',\n\t\t\t\t`tools: ['shell']`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.ok(markers[0].message.includes(`Attribute 'argument-hint' is not supported`), 'Expected warning about unsupported attribute');\n\t\t});\n\n\t\ttest('vscode target agent validates normally', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1', 'tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool1',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'VS Code target should validate normally');\n\t\t});\n\n\t\ttest('vscode target agent warns about unknown tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t`tools: ['tool1', 'unknownTool']`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown tool 'unknownTool'.`);\n\t\t});\n\n\t\ttest('vscode target agent with mcp-servers and github-tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t`tools: ['tool1', 'edit']`,\n\t\t\t\t`mcp-servers: {}`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'mcp-servers\\' is ignored when running locally in VS Code.',\n\t\t\t\t'Unknown tool \\'edit\\'.',\n\t\t\t]);\n\t\t});\n\n\t\ttest('undefined target with mcp-servers and github-tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t`tools: ['tool1', 'shell']`,\n\t\t\t\t`mcp-servers: {}`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'mcp-servers\\' is ignored when running locally in VS Code.',\n\t\t\t]);\n\t\t});\n\n\t\ttest('default target (no target specified) validates as vscode', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Agent without target\"',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'argument-hint: \"test hint\"',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t// Should validate normally as if target was vscode\n\t\t\tassert.deepStrictEqual(markers, [], 'Agent without target should validate as vscode');\n\t\t});\n\n\t\ttest('name attribute validation', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyAgent\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\n\t\t\t// Non-string name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: 123',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must be a string.`);\n\t\t\t}\n\n\t\t\t// Valid name with allowed characters\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"My_Agent-2.0 with spaces\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Name with allowed characters should be valid');\n\t\t\t}\n\t\t});\n\n\t\ttest('github-copilot target requires name attribute', async () => {\n\t\t\t// Missing name with github-copilot target\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t\t'target: github-copilot',\n\t\t\t\t\t`tools: ['shell']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 0);\n\t\t\t}\n\n\t\t\t// Valid name with github-copilot target\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t\t'target: github-copilot',\n\t\t\t\t\t`tools: ['shell']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid github-copilot agent with name should not produce errors');\n\t\t\t}\n\n\t\t\t// Missing name with vscode target (should be optional)\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Name should be optional for vscode target');\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('instructions', () => {\n\n\t\ttest('instructions valid', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t'applyTo: *.ts,*.js',\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.deepEqual(markers, []);\n\t\t});\n\n\t\ttest('instructions invalid applyTo type', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t'applyTo: 5',\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].message, `The 'applyTo' attribute must be a string.`);\n\t\t});\n\n\t\ttest('instructions invalid applyTo glob & unknown attribute', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t`applyTo: ''`, // empty -> invalid glob\n\t\t\t\t'model: mae-4', // model not allowed in instructions\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 2);\n\t\t\t// Order: unknown attribute warnings first (attribute iteration) then applyTo validation\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.ok(markers[0].message.startsWith(`Attribute 'model' is not supported in instructions files.`));\n\t\t\tassert.strictEqual(markers[1].message, `The 'applyTo' attribute must be a valid glob pattern.`);\n\t\t});\n\n\t\ttest('invalid header structure (YAML array)', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'- item1',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].message, 'Invalid header, expecting <key: value> pairs');\n\t\t});\n\n\t\ttest('name attribute validation in instructions', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyInstructions\"',\n\t\t\t\t\t'description: \"Test instructions\"',\n\t\t\t\t\t'applyTo: \"**/*.ts\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test instructions\"',\n\t\t\t\t\t'applyTo: \"**/*.ts\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('prompts', () => {\n\n\t\ttest('prompt valid with agent mode (default) and tools and a BYO model', async () => {\n\t\t\t// mode omitted -> defaults to Agent; tools+model should validate; model MAE 4 is agent capable\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt with tools\"',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1','tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('prompt model not suited for agent mode', async () => {\n\t\t\t// MAE 3.5 Turbo lacks agentMode capability -> warning when used in agent (default)\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt with unsuitable model\"',\n\t\t\t\t'model: MAE 3.5 Turbo',\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning about unsuitable model');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Model 'MAE 3.5 Turbo' is not suited for agent mode.`);\n\t\t});\n\n\t\ttest('prompt with custom agent BeastMode and tools', async () => {\n\t\t\t// Explicit custom agent should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'agent: BeastMode',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('prompt with custom mode BeastMode and tools', async () => {\n\t\t\t// Explicit custom mode should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'mode: BeastMode',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'mode' attribute has been deprecated. Please rename it to 'agent'.`]);\n\n\t\t});\n\n\t\ttest('prompt with custom mode an agent', async () => {\n\t\t\t// Explicit custom mode should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'mode: BeastMode',\n\t\t\t\t`agent: agent`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'mode' attribute has been deprecated. The 'agent' attribute is used instead.`]);\n\n\t\t});\n\n\t\ttest('prompt with unknown agent Ask', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt unknown agent Ask\"',\n\t\t\t\t'agent: Ask',\n\t\t\t\t`tools: ['tool1','tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning about tools in non-agent mode');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown agent 'Ask'. Available agents: agent, ask, edit, BeastMode.`);\n\t\t});\n\n\t\ttest('prompt with agent edit', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt edit mode with tool\"',\n\t\t\t\t'agent: edit',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `The 'tools' attribute is only supported when using agents. Attribute will be ignored.`);\n\t\t});\n\n\t\ttest('name attribute validation in prompts', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyPrompt\"',\n\t\t\t\t\t'description: \"Test prompt\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test prompt\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('body', () => {\n\t\ttest('body with existing file references and known tools has no markers', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Refs\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a #file:./reference1.md and a markdown [reference](./reference2.md) plus variables #tool1 and #tool2'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues');\n\t\t});\n\n\t\ttest('body with missing file references reports warnings', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Missing Refs\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a #file:./missing1.md and a markdown [missing link](./missing2.md).'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst messages = markers.map(m => m.message).sort();\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t`File './missing1.md' not found at '/missing1.md'.`,\n\t\t\t\t`File './missing2.md' not found at '/missing2.md'.`\n\t\t\t]);\n\t\t});\n\n\t\ttest('body with http link', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"HTTP Link\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a [http link](http://example.com).'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues');\n\t\t});\n\n\t\ttest('body with url link', async () => {\n\t\t\tconst nonExistingRef = existingRef1.with({ path: '/nonexisting' });\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"URL Links\"',\n\t\t\t\t'---',\n\t\t\t\t`Here is a [url link](${existingRef1.toString()}).`,\n\t\t\t\t`Here is a [url link](${nonExistingRef.toString()}).`\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst messages = markers.map(m => m.message).sort();\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t`File 'myFs://test/nonexisting' not found at '/nonexisting'.`,\n\t\t\t]);\n\t\t});\n\n\t\ttest('body with unknown tool variable reference warns', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Unknown tool var\"',\n\t\t\t\t'---',\n\t\t\t\t'This line references known #tool:tool1 and unknown #tool:toolX'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning for unknown tool variable');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown tool or toolset 'toolX'.`);\n\t\t});\n\n\t\ttest('body with tool not present in tools list', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'tools: []',\n\t\t\t\t'---',\n\t\t\t\t'I need',\n\t\t\t\t'#tool:ms-azuretools.vscode-azure-github-copilot/azure_recommend_custom_modes',\n\t\t\t\t'#tool:github.vscode-pull-request-github/suggest-fix',\n\t\t\t\t'#tool:openSimpleBrowser',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst actual = markers.sort((a, b) => a.startLineNumber - b.startLineNumber).map(m => ({ message: m.message, startColumn: m.startColumn, endColumn: m.endColumn }));\n\t\t\tassert.deepEqual(actual, [\n\t\t\t\t{ message: `Unknown tool or toolset 'ms-azuretools.vscode-azure-github-copilot/azure_recommend_custom_modes'.`, startColumn: 7, endColumn: 77 },\n\t\t\t\t{ message: `Tool or toolset 'github.vscode-pull-request-github/suggest-fix' also needs to be enabled in the header.`, startColumn: 7, endColumn: 52 },\n\t\t\t\t{ message: `Unknown tool or toolset 'openSimpleBrowser'.`, startColumn: 7, endColumn: 24 },\n\t\t\t]);\n\t\t});\n\n\t});\n\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\n\nimport { ResourceSet } from '../../../../../../base/common/map.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { ContextKeyService } from '../../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { TestConfigurationService } from '../../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ExtensionIdentifier } from '../../../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../../../platform/files/common/files.js';\nimport { TestInstantiationService } from '../../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILabelService } from '../../../../../../platform/label/common/label.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../../../platform/markers/common/markers.js';\nimport { workbenchInstantiationService } from '../../../../../test/browser/workbenchTestServices.js';\nimport { LanguageModelToolsService } from '../../../browser/languageModelToolsService.js';\nimport { ChatMode, CustomChatMode, IChatModeService } from '../../../common/chatModes.js';\nimport { IChatService } from '../../../common/chatService.js';\nimport { ChatConfiguration } from '../../../common/constants.js';\nimport { ILanguageModelToolsService, IToolData, ToolDataSource } from '../../../common/languageModelToolsService.js';\nimport { ILanguageModelChatMetadata, ILanguageModelsService } from '../../../common/languageModels.js';\nimport { getPromptFileExtension } from '../../../common/promptSyntax/config/promptFileLocations.js';\nimport { PromptValidator } from '../../../common/promptSyntax/languageProviders/promptValidator.js';\nimport { PromptsType } from '../../../common/promptSyntax/promptTypes.js';\nimport { PromptFileParser } from '../../../common/promptSyntax/promptFileParser.js';\nimport { PromptsStorage } from '../../../common/promptSyntax/service/promptsService.js';\nimport { MockChatModeService } from '../../common/mockChatModeService.js';\nimport { MockChatService } from '../../common/mockChatService.js';\n\nsuite('PromptValidator', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instaService: TestInstantiationService;\n\n\tconst existingRef1 = URI.parse('myFs://test/reference1.md');\n\tconst existingRef2 = URI.parse('myFs://test/reference2.md');\n\n\tsetup(async () => {\n\n\t\tconst testConfigService = new TestConfigurationService();\n\t\ttestConfigService.setUserConfiguration(ChatConfiguration.ExtensionToolsEnabled, true);\n\t\tinstaService = workbenchInstantiationService({\n\t\t\tcontextKeyService: () => disposables.add(new ContextKeyService(testConfigService)),\n\t\t\tconfigurationService: () => testConfigService\n\t\t}, disposables);\n\t\tconst chatService = new MockChatService();\n\t\tinstaService.stub(IChatService, chatService);\n\t\tinstaService.stub(ILabelService, { getUriLabel: (resource) => resource.path });\n\n\t\tconst toolService = disposables.add(instaService.createInstance(LanguageModelToolsService));\n\n\t\tconst testTool1 = { id: 'testTool1', displayName: 'tool1', canBeReferencedInPrompt: true, modelDescription: 'Test Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool1));\n\t\tconst testTool2 = { id: 'testTool2', displayName: 'tool2', canBeReferencedInPrompt: true, toolReferenceName: 'tool2', modelDescription: 'Test Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool2));\n\t\tconst shellTool = { id: 'shell', displayName: 'shell', canBeReferencedInPrompt: true, toolReferenceName: 'shell', modelDescription: 'Runs commands in the terminal', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(shellTool));\n\n\t\tconst myExtSource = { type: 'extension', label: 'My Extension', extensionId: new ExtensionIdentifier('My.extension') } satisfies ToolDataSource;\n\t\tconst testTool3 = { id: 'testTool3', displayName: 'tool3', canBeReferencedInPrompt: true, toolReferenceName: 'tool3', modelDescription: 'Test Tool 3', source: myExtSource, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(testTool3));\n\n\t\tconst prExtSource = { type: 'extension', label: 'GitHub Pull Request Extension', extensionId: new ExtensionIdentifier('github.vscode-pull-request-github') } satisfies ToolDataSource;\n\t\tconst prExtTool1 = { id: 'suggestFix', canBeReferencedInPrompt: true, toolReferenceName: 'suggest-fix', modelDescription: 'tool4', displayName: 'Test Tool 4', source: prExtSource, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(prExtTool1));\n\n\t\tconst toolWithLegacy = { id: 'newTool', toolReferenceName: 'newToolRef', displayName: 'New Tool', canBeReferencedInPrompt: true, modelDescription: 'New Tool', source: ToolDataSource.External, inputSchema: {}, legacyToolReferenceFullNames: ['oldToolName', 'deprecatedToolName'] } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(toolWithLegacy));\n\n\t\tconst toolSetWithLegacy = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'newToolSet',\n\t\t\t'newToolSetRef',\n\t\t\t{ description: 'New Tool Set', legacyFullNames: ['oldToolSet', 'deprecatedToolSet'] }\n\t\t));\n\t\tconst toolInSet = { id: 'toolInSet', toolReferenceName: 'toolInSetRef', displayName: 'Tool In Set', canBeReferencedInPrompt: false, modelDescription: 'Tool In Set', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(toolInSet));\n\t\tdisposables.add(toolSetWithLegacy.addTool(toolInSet));\n\n\t\tconst anotherToolWithLegacy = { id: 'anotherTool', toolReferenceName: 'anotherToolRef', displayName: 'Another Tool', canBeReferencedInPrompt: true, modelDescription: 'Another Tool', source: ToolDataSource.External, inputSchema: {}, legacyToolReferenceFullNames: ['legacyTool'] } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(anotherToolWithLegacy));\n\n\t\tconst anotherToolSetWithLegacy = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'anotherToolSet',\n\t\t\t'anotherToolSetRef',\n\t\t\t{ description: 'Another Tool Set', legacyFullNames: ['legacyToolSet'] }\n\t\t));\n\t\tconst anotherToolInSet = { id: 'anotherToolInSet', toolReferenceName: 'anotherToolInSetRef', displayName: 'Another Tool In Set', canBeReferencedInPrompt: false, modelDescription: 'Another Tool In Set', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(anotherToolInSet));\n\t\tdisposables.add(anotherToolSetWithLegacy.addTool(anotherToolInSet));\n\n\t\tconst conflictToolSet1 = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'conflictSet1',\n\t\t\t'conflictSet1Ref',\n\t\t\t{ legacyFullNames: ['sharedLegacyName'] }\n\t\t));\n\t\tconst conflictTool1 = { id: 'conflictTool1', toolReferenceName: 'conflictTool1Ref', displayName: 'Conflict Tool 1', canBeReferencedInPrompt: false, modelDescription: 'Conflict Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(conflictTool1));\n\t\tdisposables.add(conflictToolSet1.addTool(conflictTool1));\n\n\t\tconst conflictToolSet2 = disposables.add(toolService.createToolSet(\n\t\t\tToolDataSource.External,\n\t\t\t'conflictSet2',\n\t\t\t'conflictSet2Ref',\n\t\t\t{ legacyFullNames: ['sharedLegacyName'] }\n\t\t));\n\t\tconst conflictTool2 = { id: 'conflictTool2', toolReferenceName: 'conflictTool2Ref', displayName: 'Conflict Tool 2', canBeReferencedInPrompt: false, modelDescription: 'Conflict Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\tdisposables.add(toolService.registerToolData(conflictTool2));\n\t\tdisposables.add(conflictToolSet2.addTool(conflictTool2));\n\n\t\tinstaService.set(ILanguageModelToolsService, toolService);\n\n\t\tconst testModels: ILanguageModelChatMetadata[] = [\n\t\t\t{ id: 'mae-4', name: 'MAE 4', vendor: 'olama', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024, capabilities: { agentMode: true, toolCalling: true } } satisfies ILanguageModelChatMetadata,\n\t\t\t{ id: 'mae-4.1', name: 'MAE 4.1', vendor: 'copilot', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024, capabilities: { agentMode: true, toolCalling: true } } satisfies ILanguageModelChatMetadata,\n\t\t\t{ id: 'mae-3.5-turbo', name: 'MAE 3.5 Turbo', vendor: 'copilot', version: '1.0', family: 'mae', modelPickerCategory: undefined, extension: new ExtensionIdentifier('a.b'), isUserSelectable: true, maxInputTokens: 8192, maxOutputTokens: 1024 } satisfies ILanguageModelChatMetadata\n\t\t];\n\n\t\tinstaService.stub(ILanguageModelsService, {\n\t\t\tgetLanguageModelIds() { return testModels.map(m => m.id); },\n\t\t\tlookupLanguageModel(name: string) {\n\t\t\t\treturn testModels.find(m => m.id === name);\n\t\t\t}\n\t\t});\n\n\t\tconst customChatMode = new CustomChatMode({\n\t\t\turi: URI.parse('myFs://test/test/chatmode.md'),\n\t\t\tname: 'BeastMode',\n\t\t\tagentInstructions: { content: 'Beast mode instructions', toolReferences: [] },\n\t\t\tsource: { storage: PromptsStorage.local }\n\t\t});\n\t\tinstaService.stub(IChatModeService, new MockChatModeService({ builtin: [ChatMode.Agent, ChatMode.Ask, ChatMode.Edit], custom: [customChatMode] }));\n\n\n\t\tconst existingFiles = new ResourceSet([existingRef1, existingRef2]);\n\t\tinstaService.stub(IFileService, {\n\t\t\texists(uri: URI) {\n\t\t\t\treturn Promise.resolve(existingFiles.has(uri));\n\t\t\t}\n\t\t});\n\t});\n\n\tasync function validate(code: string, promptType: PromptsType): Promise<IMarkerData[]> {\n\t\tconst uri = URI.parse('myFs://test/testFile' + getPromptFileExtension(promptType));\n\t\tconst result = new PromptFileParser().parse(uri, code);\n\t\tconst validator = instaService.createInstance(PromptValidator);\n\t\tconst markers: IMarkerData[] = [];\n\t\tawait validator.validate(result, promptType, m => markers.push(m));\n\t\treturn markers;\n\t}\n\tsuite('agents', () => {\n\n\t\ttest('correct agent', async () => {\n\t\t\tconst content = [\n\t\t\t/* 01 */'---',\n\t\t\t/* 02 */`description: \"Agent mode test\"`,\n\t\t\t/* 03 */'model: MAE 4.1',\n\t\t\t/* 04 */`tools: ['tool1', 'tool2']`,\n\t\t\t/* 05 */'---',\n\t\t\t/* 06 */'This is a chat agent test.',\n\t\t\t/* 07 */'Here is a #tool1 variable and a #file:./reference1.md as well as a [reference](./reference2.md).',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('agent with errors (empty description, unknown tool & model)', async () => {\n\t\t\tconst content = [\n\t\t\t/* 01 */'---',\n\t\t\t/* 02 */`description: \"\"`, // empty description -> error\n\t\t\t/* 03 */'model: MAE 4.2', // unknown model -> warning\n\t\t\t/* 04 */`tools: ['tool1', 'tool2', 'tool4', 'my.extension/tool3']`, // tool4 unknown -> error\n\t\t\t/* 05 */'---',\n\t\t\t/* 06 */'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Error, message: `The 'description' attribute should not be empty.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Unknown tool 'tool4'.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Unknown model 'MAE 4.2'.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('tools must be array', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: 'tool1'`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'tools' attribute must be an array.`]);\n\t\t});\n\n\t\ttest('each tool must be string', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['tool1', 2]`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Error, message: `Each tool name in the 'tools' attribute must be a string.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('old tool reference', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['tool1', 'tool3']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'tool3' has been renamed, use 'my.extension/tool3' instead.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('legacy tool reference names', async () => {\n\t\t\t// Test using legacy tool reference name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'oldToolName']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'oldToolName' has been renamed, use 'newToolRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Test using another legacy tool reference name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'deprecatedToolName']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'deprecatedToolName' has been renamed, use 'newToolRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\ttest('legacy toolset names', async () => {\n\t\t\t// Test using legacy toolset name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'oldToolSet']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'oldToolSet' has been renamed, use 'newToolSetRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Test using another legacy toolset name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`tools: ['tool1', 'deprecatedToolSet']`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(\n\t\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t\t[\n\t\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'deprecatedToolSet' has been renamed, use 'newToolSetRef' instead.` },\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\ttest('multiple legacy names in same tools list', async () => {\n\t\t\t// Test multiple legacy names together\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['legacyTool', 'legacyToolSet', 'tool3']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'legacyTool' has been renamed, use 'anotherToolRef' instead.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'legacyToolSet' has been renamed, use 'anotherToolSetRef' instead.` },\n\t\t\t\t\t{ severity: MarkerSeverity.Info, message: `Tool or toolset 'tool3' has been renamed, use 'my.extension/tool3' instead.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('deprecated tool name mapping to multiple new names', async () => {\n\t\t\t// The toolsets are registered in setup with a shared legacy name 'sharedLegacyName'\n\t\t\t// This simulates the case where one deprecated name maps to multiple current names\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`tools: ['sharedLegacyName']`,\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\t// When multiple toolsets share the same legacy name, the message should indicate multiple options\n\t\t\t// The message will say \"use the following tools instead:\" for multiple mappings\n\t\t\tconst expectedMessage = `Tool or toolset 'sharedLegacyName' has been renamed, use the following tools instead: conflictSet1Ref, conflictSet2Ref`;\n\t\t\tassert.strictEqual(markers[0].message, expectedMessage);\n\t\t});\n\n\t\ttest('deprecated tool name in body variable reference - single mapping', async () => {\n\t\t\t// Test deprecated tool name used as variable reference in body\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool:oldToolName reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\tassert.strictEqual(markers[0].message, `Tool or toolset 'oldToolName' has been renamed, use 'newToolRef' instead.`);\n\t\t});\n\n\t\ttest('deprecated tool name in body variable reference - multiple mappings', async () => {\n\t\t\t// Register tools with the same legacy name to create multiple mappings\n\t\t\tconst multiMapToolSet1 = disposables.add(instaService.get(ILanguageModelToolsService).createToolSet(\n\t\t\t\tToolDataSource.External,\n\t\t\t\t'multiMapSet1',\n\t\t\t\t'multiMapSet1Ref',\n\t\t\t\t{ legacyFullNames: ['multiMapLegacy'] }\n\t\t\t));\n\t\t\tconst multiMapTool1 = { id: 'multiMapTool1', toolReferenceName: 'multiMapTool1Ref', displayName: 'Multi Map Tool 1', canBeReferencedInPrompt: true, modelDescription: 'Multi Map Tool 1', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\t\tdisposables.add(instaService.get(ILanguageModelToolsService).registerToolData(multiMapTool1));\n\t\t\tdisposables.add(multiMapToolSet1.addTool(multiMapTool1));\n\n\t\t\tconst multiMapToolSet2 = disposables.add(instaService.get(ILanguageModelToolsService).createToolSet(\n\t\t\t\tToolDataSource.External,\n\t\t\t\t'multiMapSet2',\n\t\t\t\t'multiMapSet2Ref',\n\t\t\t\t{ legacyFullNames: ['multiMapLegacy'] }\n\t\t\t));\n\t\t\tconst multiMapTool2 = { id: 'multiMapTool2', toolReferenceName: 'multiMapTool2Ref', displayName: 'Multi Map Tool 2', canBeReferencedInPrompt: true, modelDescription: 'Multi Map Tool 2', source: ToolDataSource.External, inputSchema: {} } satisfies IToolData;\n\t\t\tdisposables.add(instaService.get(ILanguageModelToolsService).registerToolData(multiMapTool2));\n\t\t\tdisposables.add(multiMapToolSet2.addTool(multiMapTool2));\n\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool:multiMapLegacy reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Info);\n\t\t\t// When multiple toolsets share the same legacy name, the message should indicate multiple options\n\t\t\t// The message will say \"use the following tools instead:\" for multiple mappings in body references\n\t\t\tconst expectedMessage = `Tool or toolset 'multiMapLegacy' has been renamed, use the following tools instead: multiMapSet1Ref, multiMapSet2Ref`;\n\t\t\tassert.strictEqual(markers[0].message, expectedMessage);\n\t\t});\n\n\t\ttest('unknown attribute in agent file', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Test\"',\n\t\t\t\t`applyTo: '*.ts'`, // not allowed in agent file\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmarkers.map(m => ({ severity: m.severity, message: m.message })),\n\t\t\t\t[\n\t\t\t\t\t{ severity: MarkerSeverity.Warning, message: `Attribute 'applyTo' is not supported in VS Code agent files. Supported: argument-hint, description, handoffs, model, name, target, tools.` },\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\n\t\ttest('tools with invalid handoffs', async () => {\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs: next`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'handoffs' attribute must be an array.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`Missing required properties 'agent', 'prompt' in handoff object.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t`    agent: ''`,\n\t\t\t\t\t`    prompt: ''`,\n\t\t\t\t\t`    send: true`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'agent' property in a handoff must be a non-empty string.`]);\n\t\t\t}\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"Test\"',\n\t\t\t\t\t`handoffs:`,\n\t\t\t\t\t`  - label: '123'`,\n\t\t\t\t\t`    agent: 'Cool'`,\n\t\t\t\t\t`    prompt: ''`,\n\t\t\t\t\t`    send: true`,\n\t\t\t\t\t'---',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`Unknown agent 'Cool'. Available agents: agent, ask, edit, BeastMode.`]);\n\t\t\t}\n\t\t});\n\n\t\ttest('agent with handoffs attribute', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \\\"Test agent with handoffs\\\"',\n\t\t\t\t`handoffs:`,\n\t\t\t\t'  - label: Test Prompt',\n\t\t\t\t'    agent: agent',\n\t\t\t\t'    prompt: Add tests for this code',\n\t\t\t\t'  - label: Optimize Performance',\n\t\t\t\t'    agent: agent',\n\t\t\t\t'    prompt: Optimize for performance',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues for handoffs attribute');\n\t\t});\n\n\t\ttest('github-copilot agent with supported attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHub_Copilot_Custom_Agent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t`tools: ['shell', 'edit', 'search', 'custom-agent']`,\n\t\t\t\t'mcp-servers: []',\n\t\t\t\t'---',\n\t\t\t\t'Body with #search and #edit references',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent warns about model and handoffs attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['shell', 'edit']`,\n\t\t\t\t`handoffs:`,\n\t\t\t\t'  - label: Test',\n\t\t\t\t'    agent: Default',\n\t\t\t\t'    prompt: Test',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'model\\' is not supported in custom GitHub Copilot agent files. Supported: description, mcp-servers, name, target, tools.',\n\t\t\t\t'Attribute \\'handoffs\\' is not supported in custom GitHub Copilot agent files. Supported: description, mcp-servers, name, target, tools.',\n\t\t\t], 'Model and handoffs are not validated for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent does not validate variable references', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t`tools: ['shell', 'edit']`,\n\t\t\t\t'---',\n\t\t\t\t'Body with #unknownTool reference',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t// Variable references should not be validated for github-copilot target\n\t\t\tassert.deepStrictEqual(markers, [], 'Variable references are not validated for github-copilot target');\n\t\t});\n\n\t\ttest('github-copilot agent rejects unsupported attributes', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t'target: github-copilot',\n\t\t\t\t'argument-hint: \"test hint\"',\n\t\t\t\t`tools: ['shell']`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.ok(markers[0].message.includes(`Attribute 'argument-hint' is not supported`), 'Expected warning about unsupported attribute');\n\t\t});\n\n\t\ttest('vscode target agent validates normally', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1', 'tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body with #tool1',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.deepStrictEqual(markers, [], 'VS Code target should validate normally');\n\t\t});\n\n\t\ttest('vscode target agent warns about unknown tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t`tools: ['tool1', 'unknownTool']`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown tool 'unknownTool'.`);\n\t\t});\n\n\t\ttest('vscode target agent with mcp-servers and github-tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t'target: vscode',\n\t\t\t\t`tools: ['tool1', 'edit']`,\n\t\t\t\t`mcp-servers: {}`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'mcp-servers\\' is ignored when running locally in VS Code.',\n\t\t\t\t'Unknown tool \\'edit\\'.',\n\t\t\t]);\n\t\t});\n\n\t\ttest('undefined target with mcp-servers and github-tools', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t`tools: ['tool1', 'shell']`,\n\t\t\t\t`mcp-servers: {}`,\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\tconst messages = markers.map(m => m.message);\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t'Attribute \\'mcp-servers\\' is ignored when running locally in VS Code.',\n\t\t\t]);\n\t\t});\n\n\t\ttest('default target (no target specified) validates as vscode', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Agent without target\"',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'argument-hint: \"test hint\"',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t// Should validate normally as if target was vscode\n\t\t\tassert.deepStrictEqual(markers, [], 'Agent without target should validate as vscode');\n\t\t});\n\n\t\ttest('name attribute validation', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyAgent\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\n\t\t\t// Non-string name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: 123',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must be a string.`);\n\t\t\t}\n\n\t\t\t// Valid name with allowed characters\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"My_Agent-2.0 with spaces\"',\n\t\t\t\t\t'description: \"Test agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Name with allowed characters should be valid');\n\t\t\t}\n\t\t});\n\n\t\ttest('github-copilot target requires name attribute', async () => {\n\t\t\t// Missing name with github-copilot target\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t\t'target: github-copilot',\n\t\t\t\t\t`tools: ['shell']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.strictEqual(markers.length, 0);\n\t\t\t}\n\n\t\t\t// Valid name with github-copilot target\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"GitHubAgent\"',\n\t\t\t\t\t'description: \"GitHub Copilot agent\"',\n\t\t\t\t\t'target: github-copilot',\n\t\t\t\t\t`tools: ['shell']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid github-copilot agent with name should not produce errors');\n\t\t\t}\n\n\t\t\t// Missing name with vscode target (should be optional)\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'description: \"VS Code agent\"',\n\t\t\t\t\t'target: vscode',\n\t\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.agent);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Name should be optional for vscode target');\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('instructions', () => {\n\n\t\ttest('instructions valid', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t'applyTo: *.ts,*.js',\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.deepEqual(markers, []);\n\t\t});\n\n\t\ttest('instructions invalid applyTo type', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t'applyTo: 5',\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].message, `The 'applyTo' attribute must be a string.`);\n\t\t});\n\n\t\ttest('instructions invalid applyTo glob & unknown attribute', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Instr\"',\n\t\t\t\t`applyTo: ''`, // empty -> invalid glob\n\t\t\t\t'model: mae-4', // model not allowed in instructions\n\t\t\t\t'---',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 2);\n\t\t\t// Order: unknown attribute warnings first (attribute iteration) then applyTo validation\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.ok(markers[0].message.startsWith(`Attribute 'model' is not supported in instructions files.`));\n\t\t\tassert.strictEqual(markers[1].message, `The 'applyTo' attribute must be a valid glob pattern.`);\n\t\t});\n\n\t\ttest('invalid header structure (YAML array)', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'- item1',\n\t\t\t\t'---',\n\t\t\t\t'Body',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].message, 'Invalid header, expecting <key: value> pairs');\n\t\t});\n\n\t\ttest('name attribute validation in instructions', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyInstructions\"',\n\t\t\t\t\t'description: \"Test instructions\"',\n\t\t\t\t\t'applyTo: \"**/*.ts\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test instructions\"',\n\t\t\t\t\t'applyTo: \"**/*.ts\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.instructions);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('prompts', () => {\n\n\t\ttest('prompt valid with agent mode (default) and tools and a BYO model', async () => {\n\t\t\t// mode omitted -> defaults to Agent; tools+model should validate; model MAE 4 is agent capable\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt with tools\"',\n\t\t\t\t'model: MAE 4.1',\n\t\t\t\t`tools: ['tool1','tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('prompt model not suited for agent mode', async () => {\n\t\t\t// MAE 3.5 Turbo lacks agentMode capability -> warning when used in agent (default)\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt with unsuitable model\"',\n\t\t\t\t'model: MAE 3.5 Turbo',\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning about unsuitable model');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Model 'MAE 3.5 Turbo' is not suited for agent mode.`);\n\t\t});\n\n\t\ttest('prompt with custom agent BeastMode and tools', async () => {\n\t\t\t// Explicit custom agent should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'agent: BeastMode',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, []);\n\t\t});\n\n\t\ttest('prompt with custom mode BeastMode and tools', async () => {\n\t\t\t// Explicit custom mode should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'mode: BeastMode',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'mode' attribute has been deprecated. Please rename it to 'agent'.`]);\n\n\t\t});\n\n\t\ttest('prompt with custom mode an agent', async () => {\n\t\t\t// Explicit custom mode should be recognized; BeastMode kind comes from setup; ensure tools accepted\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt custom mode\"',\n\t\t\t\t'mode: BeastMode',\n\t\t\t\t`agent: agent`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.deepStrictEqual(markers.map(m => m.message), [`The 'mode' attribute has been deprecated. The 'agent' attribute is used instead.`]);\n\n\t\t});\n\n\t\ttest('prompt with unknown agent Ask', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt unknown agent Ask\"',\n\t\t\t\t'agent: Ask',\n\t\t\t\t`tools: ['tool1','tool2']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning about tools in non-agent mode');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown agent 'Ask'. Available agents: agent, ask, edit, BeastMode.`);\n\t\t});\n\n\t\ttest('prompt with agent edit', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Prompt edit mode with tool\"',\n\t\t\t\t'agent: edit',\n\t\t\t\t`tools: ['tool1']`,\n\t\t\t\t'---',\n\t\t\t\t'Body'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `The 'tools' attribute is only supported when using agents. Attribute will be ignored.`);\n\t\t});\n\n\t\ttest('name attribute validation in prompts', async () => {\n\t\t\t// Valid name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"MyPrompt\"',\n\t\t\t\t\t'description: \"Test prompt\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\t\tassert.deepStrictEqual(markers, [], 'Valid name should not produce errors');\n\t\t\t}\n\n\t\t\t// Empty name\n\t\t\t{\n\t\t\t\tconst content = [\n\t\t\t\t\t'---',\n\t\t\t\t\t'name: \"\"',\n\t\t\t\t\t'description: \"Test prompt\"',\n\t\t\t\t\t'---',\n\t\t\t\t\t'Body',\n\t\t\t\t].join('\\n');\n\t\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\t\tassert.strictEqual(markers.length, 1);\n\t\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Error);\n\t\t\t\tassert.strictEqual(markers[0].message, `The 'name' attribute must not be empty.`);\n\t\t\t}\n\t\t});\n\t});\n\n\tsuite('body', () => {\n\t\ttest('body with existing file references and known tools has no markers', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Refs\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a #file:./reference1.md and a markdown [reference](./reference2.md) plus variables #tool1 and #tool2'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues');\n\t\t});\n\n\t\ttest('body with missing file references reports warnings', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Missing Refs\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a #file:./missing1.md and a markdown [missing link](./missing2.md).'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst messages = markers.map(m => m.message).sort();\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t`File './missing1.md' not found at '/missing1.md'.`,\n\t\t\t\t`File './missing2.md' not found at '/missing2.md'.`\n\t\t\t]);\n\t\t});\n\n\t\ttest('body with http link', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"HTTP Link\"',\n\t\t\t\t'---',\n\t\t\t\t'Here is a [http link](http://example.com).'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.deepStrictEqual(markers, [], 'Expected no validation issues');\n\t\t});\n\n\t\ttest('body with url link', async () => {\n\t\t\tconst nonExistingRef = existingRef1.with({ path: '/nonexisting' });\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"URL Links\"',\n\t\t\t\t'---',\n\t\t\t\t`Here is a [url link](${existingRef1.toString()}).`,\n\t\t\t\t`Here is a [url link](${nonExistingRef.toString()}).`\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst messages = markers.map(m => m.message).sort();\n\t\t\tassert.deepStrictEqual(messages, [\n\t\t\t\t`File 'myFs://test/nonexisting' not found at '/nonexisting'.`,\n\t\t\t]);\n\t\t});\n\n\t\ttest('body with unknown tool variable reference warns', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'description: \"Unknown tool var\"',\n\t\t\t\t'---',\n\t\t\t\t'This line references known #tool:tool1 and unknown #tool:toolX'\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tassert.strictEqual(markers.length, 1, 'Expected one warning for unknown tool variable');\n\t\t\tassert.strictEqual(markers[0].severity, MarkerSeverity.Warning);\n\t\t\tassert.strictEqual(markers[0].message, `Unknown tool or toolset 'toolX'.`);\n\t\t});\n\n\t\ttest('body with tool not present in tools list', async () => {\n\t\t\tconst content = [\n\t\t\t\t'---',\n\t\t\t\t'tools: []',\n\t\t\t\t'---',\n\t\t\t\t'I need',\n\t\t\t\t'#tool:ms-azuretools.vscode-azure-github-copilot/azure_recommend_custom_modes',\n\t\t\t\t'#tool:github.vscode-pull-request-github/suggest-fix',\n\t\t\t\t'#tool:openSimpleBrowser',\n\t\t\t].join('\\n');\n\t\t\tconst markers = await validate(content, PromptsType.prompt);\n\t\t\tconst actual = markers.sort((a, b) => a.startLineNumber - b.startLineNumber).map(m => ({ message: m.message, startColumn: m.startColumn, endColumn: m.endColumn }));\n\t\t\tassert.deepEqual(actual, [\n\t\t\t\t{ message: `Unknown tool or toolset 'ms-azuretools.vscode-azure-github-copilot/azure_recommend_custom_modes'.`, startColumn: 7, endColumn: 77 },\n\t\t\t\t{ message: `Tool or toolset 'github.vscode-pull-request-github/suggest-fix' also needs to be enabled in the header.`, startColumn: 7, endColumn: 52 },\n\t\t\t\t{ message: `Unknown tool or toolset 'openSimpleBrowser'.`, startColumn: 7, endColumn: 24 },\n\t\t\t]);\n\t\t});\n\n\t});\n\n});\n"]}