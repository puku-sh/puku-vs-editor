{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/common/voiceChatService.test.ts","vs/workbench/contrib/chat/test/common/voiceChatService.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAqB,uBAAuB,EAAE,MAAM,4CAA4C,CAAC;AACxG,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,qCAAqC,CAAC;AACrE,OAAO,EAAE,eAAe,EAAe,YAAY,EAAE,MAAM,yCAAyC,CAAC;AACrG,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AAEnG,OAAO,EAAE,qBAAqB,EAAE,MAAM,yEAAyE,CAAC;AAChH,OAAO,EAAE,wBAAwB,EAAE,MAAM,sDAAsD,CAAC;AAChG,OAAO,EAA6H,kBAAkB,EAAE,MAAM,yCAAyC,CAAC;AAIxM,OAAO,EAAE,iBAAiB,EAAE,YAAY,EAAE,MAAM,2BAA2B,CAAC;AAC5E,OAAO,EAAiD,gBAAgB,EAAE,MAAM,kCAAkC,CAAC;AAEnH,KAAK,CAAC,WAAW,EAAE,GAAG,EAAE;IAEvB,MAAM,oBAAoB;QACzB,YAAqB,IAAY,EAAW,WAAmB;YAA1C,SAAI,GAAJ,IAAI,CAAQ;YAAW,gBAAW,GAAX,WAAW,CAAQ;QAAI,CAAC;KACpE;IAED,MAAM,aAAa;QAUlB,YAAqB,EAAU,EAAW,aAAkC;YAAvD,OAAE,GAAF,EAAE,CAAQ;YAAW,kBAAa,GAAb,aAAa,CAAqB;YAR5E,gBAAW,GAAwB,wBAAwB,CAAC,UAAU,CAAC;YACvE,qBAAgB,GAAuB,SAAS,CAAC;YACjD,uBAAkB,GAAG,EAAE,CAAC;YACxB,yBAAoB,GAAG,EAAE,CAAC;YAC1B,yBAAoB,GAAG,EAAE,CAAC;YAC1B,cAAS,GAAwB,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAC1D,UAAK,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;YAW3B,mBAAc,GAAoE,EAAE,CAAC;YAOrF,aAAQ,GAAG,EAAE,CAAC;YAfb,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QAChB,CAAC;QAQD,gBAAgB,CAAE,OAA0B,EAAE,MAAwB,EAAE,OAAiC,EAAE,KAAwB;YAClI,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC5C,CAAC;QACD,eAAe,CAAC,SAAiB,EAAE,KAAwB;QAC3D,CAAC;QACD,MAAM,CAAC,OAA0B,EAAE,QAAyC,EAAE,OAAiC,EAAE,KAAwB,IAA+B,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;KAErN;IAED,MAAM,MAAM,GAAiB;QAC5B,IAAI,aAAa,CAAC,WAAW,EAAE;YAC9B,IAAI,oBAAoB,CAAC,KAAK,EAAE,KAAK,CAAC;YACtC,IAAI,oBAAoB,CAAC,SAAS,EAAE,SAAS,CAAC;SAC9C,CAAC;QACF,IAAI,aAAa,CAAC,QAAQ,EAAE;YAC3B,IAAI,oBAAoB,CAAC,QAAQ,EAAE,QAAQ,CAAC;SAC5C,CAAC;KACF,CAAC;IAEF,MAAM,oBAAoB;QAA1B;YAEU,sBAAiB,GAAG,KAAK,CAAC,IAAI,CAAC;YAoBxC,kBAAa,GAAY,KAAK,CAAC;QAUhC,CAAC;QA7BA,2BAA2B,CAAC,EAAU,EAAE,KAA+B,IAAiB,MAAM,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;QAC5G,oBAAoB,CAAC,IAAoB,EAAE,SAAmC,IAAiB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC5I,WAAW,CAAC,EAAU,EAAE,OAA0B,EAAE,QAAyC,EAAE,OAAiC,EAAE,KAAwB,IAA+B,MAAM,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;QAC7M,eAAe,CAAC,KAAa,EAAE,SAAiB,EAAE,KAAwB,IAAU,CAAC;QACrF,YAAY,CAAC,EAAU,EAAE,OAA0B,EAAE,MAAwB,EAAE,OAAiC,EAAE,KAAwB,IAA8B,MAAM,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;QAC5L,kBAAkB,KAAmB,OAAO,MAAM,CAAC,CAAC,CAAC;QACrD,SAAS,KAAmB,OAAO,MAAM,CAAC,CAAC,CAAC;QAC5C,eAAe,KAA6B,MAAM,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;QAChE,0BAA0B,KAAiC,MAAM,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;QAC/E,aAAa,CAAC,EAAU,EAAE,IAAoB,IAAiB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC5G,QAAQ,CAAC,EAAU,IAAgC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAChG,eAAe,CAAC,IAAY,IAAsB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC/F,WAAW,CAAC,EAAU,EAAE,cAAkC,IAAU,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACjH,0BAA0B,CAAC,EAAU,IAAgC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAClH,+BAA+B,CAAC,EAAU,EAAE,QAA0F,IAAiB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACpM,uBAAuB,CAAC,EAAU,EAAE,KAAa,EAAE,KAAwB,IAAyC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACjK,gBAAgB,CAAC,EAAU,IAAa,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACrF,YAAY,CAAC,EAAU,EAAE,OAAiC,EAAE,KAAwB,IAAiC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAClK,cAAc,CAAC,EAAU,EAAE,OAAiC,EAAE,KAAwB,IAAiC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAEpK,oCAAoC;YACnC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC5C,CAAC;QACD,wCAAwC,CAAC,MAAc,EAAE,QAA2C;YACnG,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC5C,CAAC;QACD,oBAAoB,CAAC,OAA0B,EAAE,OAAiC,EAAE,OAAwC,EAAE,KAAwB;YACrJ,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;QAC5C,CAAC;KACD;IAED,MAAM,iBAAiB;QAAvB;YAGC,iCAA4B,GAAG,KAAK,CAAC,IAAI,CAAC;YAEjC,sBAAiB,GAAG,IAAI,CAAC;YACzB,iCAA4B,GAAG,KAAK,CAAC;YACrC,iCAA4B,GAAG,KAAK,CAAC;YACrC,gCAA2B,GAAG,KAAK,CAAC;YAG7C,kCAA6B,GAAG,KAAK,CAAC,IAAI,CAAC;YAC3C,gCAA2B,GAAG,KAAK,CAAC,IAAI,CAAC;YAQzC,kCAA6B,GAAG,KAAK,CAAC,IAAI,CAAC;YAC3C,gCAA2B,GAAG,KAAK,CAAC,IAAI,CAAC;YASzC,iCAA4B,GAAG,KAAK,CAAC,IAAI,CAAC;YAC1C,+BAA0B,GAAG,KAAK,CAAC,IAAI,CAAC;QAEzC,CAAC;QAvBA,sBAAsB,CAAC,UAAkB,EAAE,QAAyB,IAAiB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAIlI,KAAK,CAAC,yBAAyB,CAAC,KAAwB;YACvD,OAAO;gBACN,WAAW,EAAE,OAAO,CAAC,KAAK;aAC1B,CAAC;QACH,CAAC;QAKD,KAAK,CAAC,yBAAyB,CAAC,KAAwB;YACvD,OAAO;gBACN,WAAW,EAAE,KAAK,CAAC,IAAI;gBACvB,UAAU,EAAE,KAAK,IAAI,EAAE,GAAG,CAAC;aAC3B,CAAC;QACH,CAAC;QAID,gBAAgB,CAAC,KAAwB,IAAuC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;KAC7H;IAED,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;IAC1C,IAAI,OAAoC,CAAC;IAEzC,IAAI,OAAyB,CAAC;IAC9B,IAAI,KAAsC,CAAC;IAE3C,KAAK,UAAU,aAAa,CAAC,OAAiC;QAC7D,MAAM,GAAG,GAAG,IAAI,uBAAuB,EAAE,CAAC;QAC1C,WAAW,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACvD,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,sBAAsB,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;QACzE,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE;YACvC,KAAK,GAAG,CAAC,CAAC;QACX,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,GAAG,EAAE;QACV,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,OAAO,EAAsB,CAAC,CAAC;QAC7D,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,gBAAgB,CAAC,IAAI,iBAAiB,EAAE,EAAE,IAAI,oBAAoB,EAAE,EAAE,IAAI,qBAAqB,EAAE,CAAC,CAAC,CAAC;IACnI,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,GAAG,EAAE;QACb,WAAW,CAAC,KAAK,EAAE,CAAC;IACrB,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;QACvE,MAAM,mCAAmC,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,EAAgB,EAAE,CAAC,CAAC;IAC3F,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;QACtE,MAAM,mCAAmC,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAE,EAAgB,EAAE,CAAC,CAAC;IAC1F,CAAC,CAAC,CAAC;IAEH,KAAK,UAAU,mCAAmC,CAAC,OAAiC;QAEnF,oBAAoB;QACpB,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,OAAO,EAAE,CAAC,CAAC;QACrD,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,OAAO,CAAC,CAAC;QAE9D,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;QAEtD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,aAAa,EAAE,CAAC,CAAC;QAC9E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,aAAa,CAAC,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;QAEtD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,aAAa,EAAE,CAAC,CAAC;QAC7E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,aAAa,CAAC,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;QAEtD,QAAQ;QACR,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAEtC,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;QAC/E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;QAE/D,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;QAC/E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;QAE/D,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,mBAAmB,EAAE,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,mBAAmB,EAAE,CAAC,CAAC;QACnF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,yBAAyB;QACzB,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,oBAAoB,EAAE,CAAC,CAAC;QACrF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC;QAC/F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,oBAAoB,EAAE,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC;QAC/F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,oBAAoB,EAAE,CAAC,CAAC;QACrF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC;QAC/F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,oBAAoB,EAAE,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC;QAC/F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,gBAAgB;QAChB,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;QAC5E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QACjF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;QAEjD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QACjF,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;QAEjD,wBAAwB;QACxB,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,2BAA2B,EAAE,CAAC,CAAC;QAC5F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC;QAC3G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,2BAA2B,EAAE,CAAC,CAAC;QAC3F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,2BAA2B,CAAC,CAAC;QAC3G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,yCAAyC;QACzC,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,6BAA6B,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,6BAA6B,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,6BAA6B,EAAE,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,6BAA6B,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,2BAA2B;QAC3B,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,gCAAgC,EAAE,CAAC,CAAC;QACjG,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC,CAAC,gCAAgC,CAAC,CAAC;QACvH,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,gCAAgC,EAAE,CAAC,CAAC;QAChG,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,6BAA6B,CAAC,CAAC,CAAC,gCAAgC,CAAC,CAAC;QACvH,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;QAElD,gDAAgD;QAChD,IAAI,OAAO,CAAC,UAAU,EAAE,CAAC;YACxB,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;YAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;YAC9E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;YACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;YAEjD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;YACxE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;YAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;YAElD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;YAC5E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;YAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;YAEjD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;YAC3E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;YACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;YAEjD,MAAM,aAAa,CAAC,OAAO,CAAC,CAAC;YAE7B,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;YAC9E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;YACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;YAEjD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;YAC3E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;YACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;QAClD,CAAC;IACF,CAAC;IAED,IAAI,CAAC,mBAAmB,EAAE,KAAK,IAAI,EAAE;QAEpC,QAAQ;QACR,MAAM,aAAa,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAE,EAAgB,EAAE,CAAC,CAAC;QAEnE,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;QAC/E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;QAEhD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;QAC9E,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;QAEhD,gBAAgB;QAChB,MAAM,aAAa,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAE,EAAgB,EAAE,CAAC,CAAC;QAEnE,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,EAAE,IAAI,EAAE,4BAA4B,EAAE,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,qBAAqB,CAAC,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;QAEhD,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,EAAE,IAAI,EAAE,4BAA4B,EAAE,CAAC,CAAC;QAC5F,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,EAAE,qBAAqB,CAAC,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,uCAAuC,EAAE,CAAC;AAC3C,CAAC,CAAC,CAAC","file":"voiceChatService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { nullExtensionDescription } from '../../../../services/extensions/common/extensions.js';\nimport { ISpeechProvider, ISpeechService, ISpeechToTextEvent, ISpeechToTextSession, ITextToSpeechSession, KeywordRecognitionStatus, SpeechToTextStatus } from '../../../speech/common/speechService.js';\nimport { IChatAgent, IChatAgentCommand, IChatAgentCompletionItem, IChatAgentData, IChatAgentHistoryEntry, IChatAgentImplementation, IChatAgentMetadata, IChatAgentRequest, IChatAgentResult, IChatAgentService, IChatParticipantDetectionProvider, UserSelectedTools } from '../../common/chatAgents.js';\nimport { IChatModel } from '../../common/chatModel.js';\nimport { IChatFollowup, IChatProgress } from '../../common/chatService.js';\nimport { ChatAgentLocation, ChatModeKind } from '../../common/constants.js';\nimport { IVoiceChatSessionOptions, IVoiceChatTextEvent, VoiceChatService } from '../../common/voiceChatService.js';\n\nsuite('VoiceChat', () => {\n\n\tclass TestChatAgentCommand implements IChatAgentCommand {\n\t\tconstructor(readonly name: string, readonly description: string) { }\n\t}\n\n\tclass TestChatAgent implements IChatAgent {\n\n\t\textensionId: ExtensionIdentifier = nullExtensionDescription.identifier;\n\t\textensionVersion: string | undefined = undefined;\n\t\textensionPublisher = '';\n\t\textensionDisplayName = '';\n\t\textensionPublisherId = '';\n\t\tlocations: ChatAgentLocation[] = [ChatAgentLocation.Chat];\n\t\tmodes = [ChatModeKind.Ask];\n\t\tpublic readonly name: string;\n\t\tconstructor(readonly id: string, readonly slashCommands: IChatAgentCommand[]) {\n\t\t\tthis.name = id;\n\t\t}\n\t\tfullName?: string | undefined;\n\t\tdescription?: string | undefined;\n\t\twhen?: string | undefined;\n\t\tpublisherDisplayName?: string | undefined;\n\t\tisDefault?: boolean | undefined;\n\t\tisDynamic?: boolean | undefined;\n\t\tdisambiguation: { category: string; description: string; examples: string[] }[] = [];\n\t\tprovideFollowups?(request: IChatAgentRequest, result: IChatAgentResult, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatFollowup[]> {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tsetRequestTools(requestId: string, tools: UserSelectedTools): void {\n\t\t}\n\t\tinvoke(request: IChatAgentRequest, progress: (part: IChatProgress[]) => void, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatAgentResult> { throw new Error('Method not implemented.'); }\n\t\tmetadata = {};\n\t}\n\n\tconst agents: IChatAgent[] = [\n\t\tnew TestChatAgent('workspace', [\n\t\t\tnew TestChatAgentCommand('fix', 'fix'),\n\t\t\tnew TestChatAgentCommand('explain', 'explain')\n\t\t]),\n\t\tnew TestChatAgent('vscode', [\n\t\t\tnew TestChatAgentCommand('search', 'search')\n\t\t]),\n\t];\n\n\tclass TestChatAgentService implements IChatAgentService {\n\t\t_serviceBrand: undefined;\n\t\treadonly onDidChangeAgents = Event.None;\n\t\tregisterAgentImplementation(id: string, agent: IChatAgentImplementation): IDisposable { throw new Error(); }\n\t\tregisterDynamicAgent(data: IChatAgentData, agentImpl: IChatAgentImplementation): IDisposable { throw new Error('Method not implemented.'); }\n\t\tinvokeAgent(id: string, request: IChatAgentRequest, progress: (part: IChatProgress[]) => void, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatAgentResult> { throw new Error(); }\n\t\tsetRequestTools(agent: string, requestId: string, tools: UserSelectedTools): void { }\n\t\tgetFollowups(id: string, request: IChatAgentRequest, result: IChatAgentResult, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatFollowup[]> { throw new Error(); }\n\t\tgetActivatedAgents(): IChatAgent[] { return agents; }\n\t\tgetAgents(): IChatAgent[] { return agents; }\n\t\tgetDefaultAgent(): IChatAgent | undefined { throw new Error(); }\n\t\tgetContributedDefaultAgent(): IChatAgentData | undefined { throw new Error(); }\n\t\tregisterAgent(id: string, data: IChatAgentData): IDisposable { throw new Error('Method not implemented.'); }\n\t\tgetAgent(id: string): IChatAgentData | undefined { throw new Error('Method not implemented.'); }\n\t\tgetAgentsByName(name: string): IChatAgentData[] { throw new Error('Method not implemented.'); }\n\t\tupdateAgent(id: string, updateMetadata: IChatAgentMetadata): void { throw new Error('Method not implemented.'); }\n\t\tgetAgentByFullyQualifiedId(id: string): IChatAgentData | undefined { throw new Error('Method not implemented.'); }\n\t\tregisterAgentCompletionProvider(id: string, provider: (query: string, token: CancellationToken) => Promise<IChatAgentCompletionItem[]>): IDisposable { throw new Error('Method not implemented.'); }\n\t\tgetAgentCompletionItems(id: string, query: string, token: CancellationToken): Promise<IChatAgentCompletionItem[]> { throw new Error('Method not implemented.'); }\n\t\tagentHasDupeName(id: string): boolean { throw new Error('Method not implemented.'); }\n\t\tgetChatTitle(id: string, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<string | undefined> { throw new Error('Method not implemented.'); }\n\t\tgetChatSummary(id: string, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<string | undefined> { throw new Error('Method not implemented.'); }\n\t\thasToolsAgent: boolean = false;\n\t\thasChatParticipantDetectionProviders(): boolean {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tregisterChatParticipantDetectionProvider(handle: number, provider: IChatParticipantDetectionProvider): IDisposable {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tdetectAgentOrCommand(request: IChatAgentRequest, history: IChatAgentHistoryEntry[], options: { location: ChatAgentLocation }, token: CancellationToken): Promise<{ agent: IChatAgentData; command?: IChatAgentCommand } | undefined> {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t}\n\n\tclass TestSpeechService implements ISpeechService {\n\t\t_serviceBrand: undefined;\n\n\t\tonDidChangeHasSpeechProvider = Event.None;\n\n\t\treadonly hasSpeechProvider = true;\n\t\treadonly hasActiveSpeechToTextSession = false;\n\t\treadonly hasActiveTextToSpeechSession = false;\n\t\treadonly hasActiveKeywordRecognition = false;\n\n\t\tregisterSpeechProvider(identifier: string, provider: ISpeechProvider): IDisposable { throw new Error('Method not implemented.'); }\n\t\tonDidStartSpeechToTextSession = Event.None;\n\t\tonDidEndSpeechToTextSession = Event.None;\n\n\t\tasync createSpeechToTextSession(token: CancellationToken): Promise<ISpeechToTextSession> {\n\t\t\treturn {\n\t\t\t\tonDidChange: emitter.event\n\t\t\t};\n\t\t}\n\n\t\tonDidStartTextToSpeechSession = Event.None;\n\t\tonDidEndTextToSpeechSession = Event.None;\n\n\t\tasync createTextToSpeechSession(token: CancellationToken): Promise<ITextToSpeechSession> {\n\t\t\treturn {\n\t\t\t\tonDidChange: Event.None,\n\t\t\t\tsynthesize: async () => { }\n\t\t\t};\n\t\t}\n\n\t\tonDidStartKeywordRecognition = Event.None;\n\t\tonDidEndKeywordRecognition = Event.None;\n\t\trecognizeKeyword(token: CancellationToken): Promise<KeywordRecognitionStatus> { throw new Error('Method not implemented.'); }\n\t}\n\n\tconst disposables = new DisposableStore();\n\tlet emitter: Emitter<ISpeechToTextEvent>;\n\n\tlet service: VoiceChatService;\n\tlet event: IVoiceChatTextEvent | undefined;\n\n\tasync function createSession(options: IVoiceChatSessionOptions) {\n\t\tconst cts = new CancellationTokenSource();\n\t\tdisposables.add(toDisposable(() => cts.dispose(true)));\n\t\tconst session = await service.createVoiceChatSession(cts.token, options);\n\t\tdisposables.add(session.onDidChange(e => {\n\t\t\tevent = e;\n\t\t}));\n\t}\n\n\tsetup(() => {\n\t\temitter = disposables.add(new Emitter<ISpeechToTextEvent>());\n\t\tservice = disposables.add(new VoiceChatService(new TestSpeechService(), new TestChatAgentService(), new MockContextKeyService()));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('Agent and slash command detection (useAgents: false)', async () => {\n\t\tawait testAgentsAndSlashCommandsDetection({ usesAgents: false, model: {} as IChatModel });\n\t});\n\n\ttest('Agent and slash command detection (useAgents: true)', async () => {\n\t\tawait testAgentsAndSlashCommandsDetection({ usesAgents: true, model: {} as IChatModel });\n\t});\n\n\tasync function testAgentsAndSlashCommandsDetection(options: IVoiceChatSessionOptions) {\n\n\t\t// Nothing to detect\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Started });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Started);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Hello' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'Hello');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Hello World' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'Hello World');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'Hello World' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, 'Hello World');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\t// Agent\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'At');\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace' : 'At workspace');\n\t\tassert.strictEqual(event?.waitingForInput, options.usesAgents);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace' : 'at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, options.usesAgents);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent with punctuation\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At Workspace. help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At Workspace. help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At Workspace. help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At Workspace. help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Slash Command\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Slash fix' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace /fix' : '/fix');\n\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'Slash fix' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace /fix' : '/fix');\n\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t// Agent + Slash Command\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code slash search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code slash search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code slash search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code slash search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent + Slash Command with punctuation\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code, slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code, slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code, slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code, slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code. slash, search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code. slash, search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code. slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code. slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent not detected twice\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace, for at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace for at workspace' : 'At workspace, for at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace, for at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace for at workspace' : 'At workspace, for at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Slash command detected after agent recognized\n\t\tif (options.usesAgents) {\n\t\t\tawait createSession(options);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '@workspace');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'slash' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\t\tassert.strictEqual(event?.text, 'slash');\n\t\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\tawait createSession(options);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '@workspace');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\t\t}\n\t}\n\n\ttest('waiting for input', async () => {\n\n\t\t// Agent\n\t\tawait createSession({ usesAgents: true, model: {} as IChatModel });\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, '@workspace');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, '@workspace');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\t// Slash Command\n\t\tawait createSession({ usesAgents: true, model: {} as IChatModel });\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace slash explain' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, '@workspace /explain');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace slash explain' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, '@workspace /explain');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { MockContextKeyService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { nullExtensionDescription } from '../../../../services/extensions/common/extensions.js';\nimport { ISpeechProvider, ISpeechService, ISpeechToTextEvent, ISpeechToTextSession, ITextToSpeechSession, KeywordRecognitionStatus, SpeechToTextStatus } from '../../../speech/common/speechService.js';\nimport { IChatAgent, IChatAgentCommand, IChatAgentCompletionItem, IChatAgentData, IChatAgentHistoryEntry, IChatAgentImplementation, IChatAgentMetadata, IChatAgentRequest, IChatAgentResult, IChatAgentService, IChatParticipantDetectionProvider, UserSelectedTools } from '../../common/chatAgents.js';\nimport { IChatModel } from '../../common/chatModel.js';\nimport { IChatFollowup, IChatProgress } from '../../common/chatService.js';\nimport { ChatAgentLocation, ChatModeKind } from '../../common/constants.js';\nimport { IVoiceChatSessionOptions, IVoiceChatTextEvent, VoiceChatService } from '../../common/voiceChatService.js';\n\nsuite('VoiceChat', () => {\n\n\tclass TestChatAgentCommand implements IChatAgentCommand {\n\t\tconstructor(readonly name: string, readonly description: string) { }\n\t}\n\n\tclass TestChatAgent implements IChatAgent {\n\n\t\textensionId: ExtensionIdentifier = nullExtensionDescription.identifier;\n\t\textensionVersion: string | undefined = undefined;\n\t\textensionPublisher = '';\n\t\textensionDisplayName = '';\n\t\textensionPublisherId = '';\n\t\tlocations: ChatAgentLocation[] = [ChatAgentLocation.Chat];\n\t\tmodes = [ChatModeKind.Ask];\n\t\tpublic readonly name: string;\n\t\tconstructor(readonly id: string, readonly slashCommands: IChatAgentCommand[]) {\n\t\t\tthis.name = id;\n\t\t}\n\t\tfullName?: string | undefined;\n\t\tdescription?: string | undefined;\n\t\twhen?: string | undefined;\n\t\tpublisherDisplayName?: string | undefined;\n\t\tisDefault?: boolean | undefined;\n\t\tisDynamic?: boolean | undefined;\n\t\tdisambiguation: { category: string; description: string; examples: string[] }[] = [];\n\t\tprovideFollowups?(request: IChatAgentRequest, result: IChatAgentResult, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatFollowup[]> {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tsetRequestTools(requestId: string, tools: UserSelectedTools): void {\n\t\t}\n\t\tinvoke(request: IChatAgentRequest, progress: (part: IChatProgress[]) => void, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatAgentResult> { throw new Error('Method not implemented.'); }\n\t\tmetadata = {};\n\t}\n\n\tconst agents: IChatAgent[] = [\n\t\tnew TestChatAgent('workspace', [\n\t\t\tnew TestChatAgentCommand('fix', 'fix'),\n\t\t\tnew TestChatAgentCommand('explain', 'explain')\n\t\t]),\n\t\tnew TestChatAgent('vscode', [\n\t\t\tnew TestChatAgentCommand('search', 'search')\n\t\t]),\n\t];\n\n\tclass TestChatAgentService implements IChatAgentService {\n\t\t_serviceBrand: undefined;\n\t\treadonly onDidChangeAgents = Event.None;\n\t\tregisterAgentImplementation(id: string, agent: IChatAgentImplementation): IDisposable { throw new Error(); }\n\t\tregisterDynamicAgent(data: IChatAgentData, agentImpl: IChatAgentImplementation): IDisposable { throw new Error('Method not implemented.'); }\n\t\tinvokeAgent(id: string, request: IChatAgentRequest, progress: (part: IChatProgress[]) => void, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatAgentResult> { throw new Error(); }\n\t\tsetRequestTools(agent: string, requestId: string, tools: UserSelectedTools): void { }\n\t\tgetFollowups(id: string, request: IChatAgentRequest, result: IChatAgentResult, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<IChatFollowup[]> { throw new Error(); }\n\t\tgetActivatedAgents(): IChatAgent[] { return agents; }\n\t\tgetAgents(): IChatAgent[] { return agents; }\n\t\tgetDefaultAgent(): IChatAgent | undefined { throw new Error(); }\n\t\tgetContributedDefaultAgent(): IChatAgentData | undefined { throw new Error(); }\n\t\tregisterAgent(id: string, data: IChatAgentData): IDisposable { throw new Error('Method not implemented.'); }\n\t\tgetAgent(id: string): IChatAgentData | undefined { throw new Error('Method not implemented.'); }\n\t\tgetAgentsByName(name: string): IChatAgentData[] { throw new Error('Method not implemented.'); }\n\t\tupdateAgent(id: string, updateMetadata: IChatAgentMetadata): void { throw new Error('Method not implemented.'); }\n\t\tgetAgentByFullyQualifiedId(id: string): IChatAgentData | undefined { throw new Error('Method not implemented.'); }\n\t\tregisterAgentCompletionProvider(id: string, provider: (query: string, token: CancellationToken) => Promise<IChatAgentCompletionItem[]>): IDisposable { throw new Error('Method not implemented.'); }\n\t\tgetAgentCompletionItems(id: string, query: string, token: CancellationToken): Promise<IChatAgentCompletionItem[]> { throw new Error('Method not implemented.'); }\n\t\tagentHasDupeName(id: string): boolean { throw new Error('Method not implemented.'); }\n\t\tgetChatTitle(id: string, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<string | undefined> { throw new Error('Method not implemented.'); }\n\t\tgetChatSummary(id: string, history: IChatAgentHistoryEntry[], token: CancellationToken): Promise<string | undefined> { throw new Error('Method not implemented.'); }\n\t\thasToolsAgent: boolean = false;\n\t\thasChatParticipantDetectionProviders(): boolean {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tregisterChatParticipantDetectionProvider(handle: number, provider: IChatParticipantDetectionProvider): IDisposable {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t\tdetectAgentOrCommand(request: IChatAgentRequest, history: IChatAgentHistoryEntry[], options: { location: ChatAgentLocation }, token: CancellationToken): Promise<{ agent: IChatAgentData; command?: IChatAgentCommand } | undefined> {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t}\n\t}\n\n\tclass TestSpeechService implements ISpeechService {\n\t\t_serviceBrand: undefined;\n\n\t\tonDidChangeHasSpeechProvider = Event.None;\n\n\t\treadonly hasSpeechProvider = true;\n\t\treadonly hasActiveSpeechToTextSession = false;\n\t\treadonly hasActiveTextToSpeechSession = false;\n\t\treadonly hasActiveKeywordRecognition = false;\n\n\t\tregisterSpeechProvider(identifier: string, provider: ISpeechProvider): IDisposable { throw new Error('Method not implemented.'); }\n\t\tonDidStartSpeechToTextSession = Event.None;\n\t\tonDidEndSpeechToTextSession = Event.None;\n\n\t\tasync createSpeechToTextSession(token: CancellationToken): Promise<ISpeechToTextSession> {\n\t\t\treturn {\n\t\t\t\tonDidChange: emitter.event\n\t\t\t};\n\t\t}\n\n\t\tonDidStartTextToSpeechSession = Event.None;\n\t\tonDidEndTextToSpeechSession = Event.None;\n\n\t\tasync createTextToSpeechSession(token: CancellationToken): Promise<ITextToSpeechSession> {\n\t\t\treturn {\n\t\t\t\tonDidChange: Event.None,\n\t\t\t\tsynthesize: async () => { }\n\t\t\t};\n\t\t}\n\n\t\tonDidStartKeywordRecognition = Event.None;\n\t\tonDidEndKeywordRecognition = Event.None;\n\t\trecognizeKeyword(token: CancellationToken): Promise<KeywordRecognitionStatus> { throw new Error('Method not implemented.'); }\n\t}\n\n\tconst disposables = new DisposableStore();\n\tlet emitter: Emitter<ISpeechToTextEvent>;\n\n\tlet service: VoiceChatService;\n\tlet event: IVoiceChatTextEvent | undefined;\n\n\tasync function createSession(options: IVoiceChatSessionOptions) {\n\t\tconst cts = new CancellationTokenSource();\n\t\tdisposables.add(toDisposable(() => cts.dispose(true)));\n\t\tconst session = await service.createVoiceChatSession(cts.token, options);\n\t\tdisposables.add(session.onDidChange(e => {\n\t\t\tevent = e;\n\t\t}));\n\t}\n\n\tsetup(() => {\n\t\temitter = disposables.add(new Emitter<ISpeechToTextEvent>());\n\t\tservice = disposables.add(new VoiceChatService(new TestSpeechService(), new TestChatAgentService(), new MockContextKeyService()));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('Agent and slash command detection (useAgents: false)', async () => {\n\t\tawait testAgentsAndSlashCommandsDetection({ usesAgents: false, model: {} as IChatModel });\n\t});\n\n\ttest('Agent and slash command detection (useAgents: true)', async () => {\n\t\tawait testAgentsAndSlashCommandsDetection({ usesAgents: true, model: {} as IChatModel });\n\t});\n\n\tasync function testAgentsAndSlashCommandsDetection(options: IVoiceChatSessionOptions) {\n\n\t\t// Nothing to detect\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Started });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Started);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Hello' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'Hello');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Hello World' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'Hello World');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'Hello World' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, 'Hello World');\n\t\tassert.strictEqual(event?.waitingForInput, undefined);\n\n\t\t// Agent\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, 'At');\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace' : 'At workspace');\n\t\tassert.strictEqual(event?.waitingForInput, options.usesAgents);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace' : 'at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, options.usesAgents);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent with punctuation\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At workspace, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At Workspace. help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At Workspace. help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At Workspace. help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace help' : 'At Workspace. help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Slash Command\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'Slash fix' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace /fix' : '/fix');\n\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'Slash fix' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace /fix' : '/fix');\n\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t// Agent + Slash Command\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code slash search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code slash search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code slash search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code slash search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent + Slash Command with punctuation\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code, slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code, slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code, slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code, slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At code. slash, search help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code. slash, search help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At code. slash search, help' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@vscode /search help' : 'At code. slash search, help');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Agent not detected twice\n\t\tawait createSession(options);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace, for at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace for at workspace' : 'At workspace, for at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace, for at workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, options.usesAgents ? '@workspace for at workspace' : 'At workspace, for at workspace');\n\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t// Slash command detected after agent recognized\n\t\tif (options.usesAgents) {\n\t\t\tawait createSession(options);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '@workspace');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'slash' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\t\tassert.strictEqual(event?.text, 'slash');\n\t\t\tassert.strictEqual(event?.waitingForInput, false);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\tawait createSession(options);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '@workspace');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\n\t\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'slash fix' });\n\t\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\t\tassert.strictEqual(event?.text, '/fix');\n\t\t\tassert.strictEqual(event?.waitingForInput, true);\n\t\t}\n\t}\n\n\ttest('waiting for input', async () => {\n\n\t\t// Agent\n\t\tawait createSession({ usesAgents: true, model: {} as IChatModel });\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, '@workspace');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, '@workspace');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\t// Slash Command\n\t\tawait createSession({ usesAgents: true, model: {} as IChatModel });\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognizing, text: 'At workspace slash explain' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognizing);\n\t\tassert.strictEqual(event?.text, '@workspace /explain');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\n\t\temitter.fire({ status: SpeechToTextStatus.Recognized, text: 'At workspace slash explain' });\n\t\tassert.strictEqual(event?.status, SpeechToTextStatus.Recognized);\n\t\tassert.strictEqual(event?.text, '@workspace /explain');\n\t\tassert.strictEqual(event.waitingForInput, true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}