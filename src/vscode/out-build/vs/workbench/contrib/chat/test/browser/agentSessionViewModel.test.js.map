{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/browser/agentSessionViewModel.test.ts","vs/workbench/contrib/chat/test/browser/agentSessionViewModel.test.ts"],"names":[],"mappings":"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","file":"agentSessionViewModel.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { AgentSessionsViewModel, IAgentSessionViewModel, isAgentSession, isAgentSessionsViewModel, isLocalAgentSessionItem } from '../../browser/agentSessions/agentSessionViewModel.js';\nimport { AgentSessionsViewFilter } from '../../browser/agentSessions/agentSessionsViewFilter.js';\nimport { ChatSessionStatus, IChatSessionItem, IChatSessionItemProvider, IChatSessionsService, localChatSessionType } from '../../common/chatSessionsService.js';\nimport { LocalChatSessionUri } from '../../common/chatUri.js';\nimport { MockChatSessionsService } from '../common/mockChatSessionsService.js';\nimport { TestLifecycleService, workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { ILifecycleService } from '../../../../services/lifecycle/common/lifecycle.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\n\nsuite('AgentSessionsViewModel', () => {\n\n\tconst disposables = new DisposableStore();\n\tlet mockChatSessionsService: MockChatSessionsService;\n\tlet mockLifecycleService: TestLifecycleService;\n\tlet viewModel: AgentSessionsViewModel;\n\tlet instantiationService: TestInstantiationService;\n\n\tfunction createViewModel(): AgentSessionsViewModel {\n\t\treturn disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewModel,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\t}\n\n\tsetup(() => {\n\t\tmockChatSessionsService = new MockChatSessionsService();\n\t\tmockLifecycleService = disposables.add(new TestLifecycleService());\n\t\tinstantiationService = disposables.add(workbenchInstantiationService(undefined, disposables));\n\t\tinstantiationService.stub(IChatSessionsService, mockChatSessionsService);\n\t\tinstantiationService.stub(ILifecycleService, mockLifecycleService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should initialize with empty sessions', () => {\n\t\tviewModel = createViewModel();\n\n\t\tassert.strictEqual(viewModel.sessions.length, 0);\n\t});\n\n\ttest('should resolve sessions from providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session 1',\n\t\t\t\t\t\tdescription: 'Description 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Test Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(viewModel.sessions[0].label, 'Test Session 1');\n\t\t\tassert.strictEqual(viewModel.sessions[1].resource.toString(), 'test://session-2');\n\t\t\tassert.strictEqual(viewModel.sessions[1].label, 'Test Session 2');\n\t\t});\n\t});\n\n\ttest('should resolve sessions from multiple providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(viewModel.sessions[1].resource.toString(), 'test://session-2');\n\t\t});\n\t});\n\n\ttest('should fire onWillResolve and onDidResolve events', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => []\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tlet willResolveFired = false;\n\t\t\tlet didResolveFired = false;\n\n\t\t\tdisposables.add(viewModel.onWillResolve(() => {\n\t\t\t\twillResolveFired = true;\n\t\t\t\tassert.strictEqual(didResolveFired, false, 'onDidResolve should not fire before onWillResolve completes');\n\t\t\t}));\n\n\t\t\tdisposables.add(viewModel.onDidResolve(() => {\n\t\t\t\tdidResolveFired = true;\n\t\t\t\tassert.strictEqual(willResolveFired, true, 'onWillResolve should fire before onDidResolve');\n\t\t\t}));\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(willResolveFired, true, 'onWillResolve should have fired');\n\t\t\tassert.strictEqual(didResolveFired, true, 'onDidResolve should have fired');\n\t\t});\n\t});\n\n\ttest('should fire onDidChangeSessions event after resolving', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tlet sessionsChangedFired = false;\n\t\t\tdisposables.add(viewModel.onDidChangeSessions(() => {\n\t\t\t\tsessionsChangedFired = true;\n\t\t\t}));\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(sessionsChangedFired, true, 'onDidChangeSessions should have fired');\n\t\t});\n\t});\n\n\ttest('should handle session with all properties', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst startTime = Date.now();\n\t\t\tconst endTime = startTime + 1000;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\tdescription: new MarkdownString('**Bold** description'),\n\t\t\t\t\t\tstatus: ChatSessionStatus.Completed,\n\t\t\t\t\t\ttooltip: 'Session tooltip',\n\t\t\t\t\t\ticonPath: ThemeIcon.fromId('check'),\n\t\t\t\t\t\ttiming: { startTime, endTime },\n\t\t\t\t\t\tstatistics: { files: 1, insertions: 10, deletions: 5 }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tconst session = viewModel.sessions[0];\n\t\t\tassert.strictEqual(session.resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(session.label, 'Test Session');\n\t\t\tassert.ok(session.description instanceof MarkdownString);\n\t\t\tif (session.description instanceof MarkdownString) {\n\t\t\t\tassert.strictEqual(session.description.value, '**Bold** description');\n\t\t\t}\n\t\t\tassert.strictEqual(session.status, ChatSessionStatus.Completed);\n\t\t\tassert.strictEqual(session.timing.startTime, startTime);\n\t\t\tassert.strictEqual(session.timing.endTime, endTime);\n\t\t\tassert.deepStrictEqual(session.statistics, { files: 1, insertions: 10, deletions: 5 });\n\t\t});\n\t});\n\n\ttest('should handle resolve with specific provider', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-2',\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// First resolve all\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\n\t\t\t// Now resolve only type-1\n\t\t\tawait viewModel.resolve('type-1');\n\t\t\t// Should still have both sessions, but only type-1 was re-resolved\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n\n\ttest('should handle resolve with multiple specific providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-2',\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(['type-1', 'type-2']);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeItemsProviders event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeItemsProviders(provider);\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeAvailability event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeAvailability();\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeSessionItems event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeSessionItems('test-type');\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should maintain provider reference in session view model', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].providerType, 'test-type');\n\t\t});\n\t});\n\n\ttest('should handle empty provider results', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => []\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 0);\n\t\t});\n\t});\n\n\ttest('should handle sessions with different statuses', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-failed',\n\t\t\t\t\t\tresource: URI.parse('test://session-failed'),\n\t\t\t\t\t\tlabel: 'Failed Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.Failed,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-completed',\n\t\t\t\t\t\tresource: URI.parse('test://session-completed'),\n\t\t\t\t\t\tlabel: 'Completed Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.Completed,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-inprogress',\n\t\t\t\t\t\tresource: URI.parse('test://session-inprogress'),\n\t\t\t\t\t\tlabel: 'In Progress Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.InProgress,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 3);\n\t\t\tassert.strictEqual(viewModel.sessions[0].status, ChatSessionStatus.Failed);\n\t\t\tassert.strictEqual(viewModel.sessions[1].status, ChatSessionStatus.Completed);\n\t\t\tassert.strictEqual(viewModel.sessions[2].status, ChatSessionStatus.InProgress);\n\t\t});\n\t});\n\n\ttest('should replace sessions on re-resolve', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet sessionCount = 1;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tconst sessions: IChatSessionItem[] = [];\n\t\t\t\t\tfor (let i = 0; i < sessionCount; i++) {\n\t\t\t\t\t\tsessions.push({\n\t\t\t\t\t\t\tresource: URI.parse(`test://session-${i}`),\n\t\t\t\t\t\t\tlabel: `Session ${i}`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn sessions;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\n\t\t\tsessionCount = 3;\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 3);\n\t\t});\n\t});\n\n\ttest('should handle local agent session type specially', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: localChatSessionType,\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'local-session',\n\t\t\t\t\t\tresource: LocalChatSessionUri.forSession('local-session'),\n\t\t\t\t\t\tlabel: 'Local Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].providerType, localChatSessionType);\n\t\t});\n\t});\n\n\ttest('should correctly construct resource URIs for sessions', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst resource = URI.parse('custom://my-session/path');\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), resource.toString());\n\t\t});\n\t});\n\n\ttest('should throttle multiple rapid resolve calls', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet providerCallCount = 0;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tproviderCallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// Make multiple rapid resolve calls\n\t\t\tconst resolvePromises = [\n\t\t\t\tviewModel.resolve(undefined),\n\t\t\t\tviewModel.resolve(undefined),\n\t\t\t\tviewModel.resolve(undefined)\n\t\t\t];\n\n\t\t\tawait Promise.all(resolvePromises);\n\n\t\t\t// Should only call provider once due to throttling\n\t\t\tassert.strictEqual(providerCallCount, 1);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should preserve sessions from non-resolved providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet provider1CallCount = 0;\n\t\t\tlet provider2CallCount = 0;\n\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tprovider1CallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\t\tlabel: `Session 1 (call ${provider1CallCount})`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tprovider2CallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\t\tlabel: `Session 2 (call ${provider2CallCount})`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// First resolve all\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(provider1CallCount, 1);\n\t\t\tassert.strictEqual(provider2CallCount, 1);\n\t\t\tconst originalSession1Label = viewModel.sessions[0].label;\n\n\t\t\t// Now resolve only type-2\n\t\t\tawait viewModel.resolve('type-2');\n\n\t\t\t// Should still have both sessions\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\t// Provider 1 should not be called again\n\t\t\tassert.strictEqual(provider1CallCount, 1);\n\t\t\t// Provider 2 should be called again\n\t\t\tassert.strictEqual(provider2CallCount, 2);\n\t\t\t// Session 1 should be preserved with original label\n\t\t\tassert.strictEqual(viewModel.sessions.find(s => s.resource.toString() === 'test://session-1')?.label, originalSession1Label);\n\t\t});\n\t});\n\n\ttest('should accumulate providers when resolve is called with different provider types', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet resolveCount = 0;\n\t\t\tconst resolvedProviders: (string | undefined)[] = [];\n\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tresolveCount++;\n\t\t\t\t\tresolvedProviders.push('type-1');\n\t\t\t\t\treturn [{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tresolveCount++;\n\t\t\t\t\tresolvedProviders.push('type-2');\n\t\t\t\t\treturn [{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// Call resolve with different types rapidly - they should accumulate\n\t\t\tconst promise1 = viewModel.resolve('type-1');\n\t\t\tconst promise2 = viewModel.resolve(['type-2']);\n\n\t\t\tawait Promise.all([promise1, promise2]);\n\n\t\t\t// Both providers should be resolved\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n});\n\nsuite('AgentSessionsViewModel - Helper Functions', () => {\n\tconst disposables = new DisposableStore();\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('isLocalAgentSessionItem should identify local sessions', () => {\n\t\tconst localSession: IAgentSessionViewModel = {\n\t\t\tproviderType: localChatSessionType,\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://local-1'),\n\t\t\tlabel: 'Local',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst remoteSession: IAgentSessionViewModel = {\n\t\t\tproviderType: 'remote',\n\t\t\tproviderLabel: 'Remote',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://remote-1'),\n\t\t\tlabel: 'Remote',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tassert.strictEqual(isLocalAgentSessionItem(localSession), true);\n\t\tassert.strictEqual(isLocalAgentSessionItem(remoteSession), false);\n\t});\n\n\ttest('isAgentSession should identify session view models', () => {\n\t\tconst session: IAgentSessionViewModel = {\n\t\t\tproviderType: 'test',\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://test-1'),\n\t\t\tlabel: 'Test',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Test with a session object\n\t\tassert.strictEqual(isAgentSession(session), true);\n\n\t\t// Test with a sessions container - pass as session to see it returns false\n\t\tconst sessionOrContainer: IAgentSessionViewModel = session;\n\t\tassert.strictEqual(isAgentSession(sessionOrContainer), true);\n\t});\n\n\ttest('isAgentSessionsViewModel should identify sessions view models', () => {\n\t\tconst session: IAgentSessionViewModel = {\n\t\t\tproviderType: 'test',\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://test-1'),\n\t\t\tlabel: 'Test',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Test with actual view model\n\t\tconst instantiationService = workbenchInstantiationService(undefined, disposables);\n\t\tconst lifecycleService = disposables.add(new TestLifecycleService());\n\t\tinstantiationService.stub(IChatSessionsService, new MockChatSessionsService());\n\t\tinstantiationService.stub(ILifecycleService, lifecycleService);\n\t\tconst actualViewModel = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewModel,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\t\tassert.strictEqual(isAgentSessionsViewModel(actualViewModel), true);\n\n\t\t// Test with session object\n\t\tassert.strictEqual(isAgentSessionsViewModel(session), false);\n\t});\n});\n\nsuite('AgentSessionsViewFilter', () => {\n\tconst disposables = new DisposableStore();\n\tlet mockChatSessionsService: MockChatSessionsService;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\t\tmockChatSessionsService = new MockChatSessionsService();\n\t\tinstantiationService = disposables.add(workbenchInstantiationService(undefined, disposables));\n\t\tinstantiationService.stub(IChatSessionsService, mockChatSessionsService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should filter out sessions from excluded provider', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'type-1',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'type-2',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst session1: IAgentSessionViewModel = {\n\t\t\tproviderType: provider1.chatSessionType,\n\t\t\tproviderLabel: 'Provider 1',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://session-1'),\n\t\t\tlabel: 'Session 1',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst session2: IAgentSessionViewModel = {\n\t\t\tproviderType: provider2.chatSessionType,\n\t\t\tproviderLabel: 'Provider 2',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://session-2'),\n\t\t\tlabel: 'Session 2',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Initially, no sessions should be filtered\n\t\tassert.strictEqual(filter.exclude(session1), false);\n\t\tassert.strictEqual(filter.exclude(session2), false);\n\n\t\t// Exclude type-1 by setting it in storage\n\t\tconst excludes = {\n\t\t\tproviders: ['type-1'],\n\t\t\tstates: [],\n\t\t\tarchived: true\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After excluding type-1, session1 should be filtered but not session2\n\t\tassert.strictEqual(filter.exclude(session1), true);\n\t\tassert.strictEqual(filter.exclude(session2), false);\n\t});\n\n\ttest('should filter out archived sessions', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'test-type',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst archivedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://archived-session'),\n\t\t\tlabel: 'Archived Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: true,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst activeSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://active-session'),\n\t\t\tlabel: 'Active Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// By default, archived sessions should be filtered (archived: true in default excludes)\n\t\tassert.strictEqual(filter.exclude(archivedSession), true);\n\t\tassert.strictEqual(filter.exclude(activeSession), false);\n\n\t\t// Include archived by setting archived to false in storage\n\t\tconst excludes = {\n\t\t\tproviders: [],\n\t\t\tstates: [],\n\t\t\tarchived: false\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After including archived, both sessions should not be filtered\n\t\tassert.strictEqual(filter.exclude(archivedSession), false);\n\t\tassert.strictEqual(filter.exclude(activeSession), false);\n\t});\n\n\ttest('should filter out sessions with excluded status', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'test-type',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst failedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://failed-session'),\n\t\t\tlabel: 'Failed Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Failed\n\t\t};\n\n\t\tconst completedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://completed-session'),\n\t\t\tlabel: 'Completed Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst inProgressSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://inprogress-session'),\n\t\t\tlabel: 'In Progress Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.InProgress\n\t\t};\n\n\t\t// Initially, no sessions should be filtered by status\n\t\tassert.strictEqual(filter.exclude(failedSession), false);\n\t\tassert.strictEqual(filter.exclude(completedSession), false);\n\t\tassert.strictEqual(filter.exclude(inProgressSession), false);\n\n\t\t// Exclude failed status by setting it in storage\n\t\tconst excludes = {\n\t\t\tproviders: [],\n\t\t\tstates: [ChatSessionStatus.Failed],\n\t\t\tarchived: false\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After excluding failed status, only failedSession should be filtered\n\t\tassert.strictEqual(filter.exclude(failedSession), true);\n\t\tassert.strictEqual(filter.exclude(completedSession), false);\n\t\tassert.strictEqual(filter.exclude(inProgressSession), false);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Event } from '../../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { AgentSessionsViewModel, IAgentSessionViewModel, isAgentSession, isAgentSessionsViewModel, isLocalAgentSessionItem } from '../../browser/agentSessions/agentSessionViewModel.js';\nimport { AgentSessionsViewFilter } from '../../browser/agentSessions/agentSessionsViewFilter.js';\nimport { ChatSessionStatus, IChatSessionItem, IChatSessionItemProvider, IChatSessionsService, localChatSessionType } from '../../common/chatSessionsService.js';\nimport { LocalChatSessionUri } from '../../common/chatUri.js';\nimport { MockChatSessionsService } from '../common/mockChatSessionsService.js';\nimport { TestLifecycleService, workbenchInstantiationService } from '../../../../test/browser/workbenchTestServices.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { MenuId } from '../../../../../platform/actions/common/actions.js';\nimport { ILifecycleService } from '../../../../services/lifecycle/common/lifecycle.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\n\nsuite('AgentSessionsViewModel', () => {\n\n\tconst disposables = new DisposableStore();\n\tlet mockChatSessionsService: MockChatSessionsService;\n\tlet mockLifecycleService: TestLifecycleService;\n\tlet viewModel: AgentSessionsViewModel;\n\tlet instantiationService: TestInstantiationService;\n\n\tfunction createViewModel(): AgentSessionsViewModel {\n\t\treturn disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewModel,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\t}\n\n\tsetup(() => {\n\t\tmockChatSessionsService = new MockChatSessionsService();\n\t\tmockLifecycleService = disposables.add(new TestLifecycleService());\n\t\tinstantiationService = disposables.add(workbenchInstantiationService(undefined, disposables));\n\t\tinstantiationService.stub(IChatSessionsService, mockChatSessionsService);\n\t\tinstantiationService.stub(ILifecycleService, mockLifecycleService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should initialize with empty sessions', () => {\n\t\tviewModel = createViewModel();\n\n\t\tassert.strictEqual(viewModel.sessions.length, 0);\n\t});\n\n\ttest('should resolve sessions from providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session 1',\n\t\t\t\t\t\tdescription: 'Description 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Test Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(viewModel.sessions[0].label, 'Test Session 1');\n\t\t\tassert.strictEqual(viewModel.sessions[1].resource.toString(), 'test://session-2');\n\t\t\tassert.strictEqual(viewModel.sessions[1].label, 'Test Session 2');\n\t\t});\n\t});\n\n\ttest('should resolve sessions from multiple providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(viewModel.sessions[1].resource.toString(), 'test://session-2');\n\t\t});\n\t});\n\n\ttest('should fire onWillResolve and onDidResolve events', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => []\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tlet willResolveFired = false;\n\t\t\tlet didResolveFired = false;\n\n\t\t\tdisposables.add(viewModel.onWillResolve(() => {\n\t\t\t\twillResolveFired = true;\n\t\t\t\tassert.strictEqual(didResolveFired, false, 'onDidResolve should not fire before onWillResolve completes');\n\t\t\t}));\n\n\t\t\tdisposables.add(viewModel.onDidResolve(() => {\n\t\t\t\tdidResolveFired = true;\n\t\t\t\tassert.strictEqual(willResolveFired, true, 'onWillResolve should fire before onDidResolve');\n\t\t\t}));\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(willResolveFired, true, 'onWillResolve should have fired');\n\t\t\tassert.strictEqual(didResolveFired, true, 'onDidResolve should have fired');\n\t\t});\n\t});\n\n\ttest('should fire onDidChangeSessions event after resolving', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tlet sessionsChangedFired = false;\n\t\t\tdisposables.add(viewModel.onDidChangeSessions(() => {\n\t\t\t\tsessionsChangedFired = true;\n\t\t\t}));\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(sessionsChangedFired, true, 'onDidChangeSessions should have fired');\n\t\t});\n\t});\n\n\ttest('should handle session with all properties', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst startTime = Date.now();\n\t\t\tconst endTime = startTime + 1000;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\tdescription: new MarkdownString('**Bold** description'),\n\t\t\t\t\t\tstatus: ChatSessionStatus.Completed,\n\t\t\t\t\t\ttooltip: 'Session tooltip',\n\t\t\t\t\t\ticonPath: ThemeIcon.fromId('check'),\n\t\t\t\t\t\ttiming: { startTime, endTime },\n\t\t\t\t\t\tstatistics: { files: 1, insertions: 10, deletions: 5 }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tconst session = viewModel.sessions[0];\n\t\t\tassert.strictEqual(session.resource.toString(), 'test://session-1');\n\t\t\tassert.strictEqual(session.label, 'Test Session');\n\t\t\tassert.ok(session.description instanceof MarkdownString);\n\t\t\tif (session.description instanceof MarkdownString) {\n\t\t\t\tassert.strictEqual(session.description.value, '**Bold** description');\n\t\t\t}\n\t\t\tassert.strictEqual(session.status, ChatSessionStatus.Completed);\n\t\t\tassert.strictEqual(session.timing.startTime, startTime);\n\t\t\tassert.strictEqual(session.timing.endTime, endTime);\n\t\t\tassert.deepStrictEqual(session.statistics, { files: 1, insertions: 10, deletions: 5 });\n\t\t});\n\t});\n\n\ttest('should handle resolve with specific provider', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-2',\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// First resolve all\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\n\t\t\t// Now resolve only type-1\n\t\t\tawait viewModel.resolve('type-1');\n\t\t\t// Should still have both sessions, but only type-1 was re-resolved\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n\n\ttest('should handle resolve with multiple specific providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-2',\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(['type-1', 'type-2']);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeItemsProviders event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeItemsProviders(provider);\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeAvailability event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeAvailability();\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should respond to onDidChangeSessionItems event', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tconst sessionsChangedPromise = Event.toPromise(viewModel.onDidChangeSessions);\n\n\t\t\t// Trigger event - this should automatically call resolve\n\t\t\tmockChatSessionsService.fireDidChangeSessionItems('test-type');\n\n\t\t\t// Wait for the sessions to be resolved\n\t\t\tawait sessionsChangedPromise;\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should maintain provider reference in session view model', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].providerType, 'test-type');\n\t\t});\n\t});\n\n\ttest('should handle empty provider results', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => []\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 0);\n\t\t});\n\t});\n\n\ttest('should handle sessions with different statuses', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-failed',\n\t\t\t\t\t\tresource: URI.parse('test://session-failed'),\n\t\t\t\t\t\tlabel: 'Failed Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.Failed,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-completed',\n\t\t\t\t\t\tresource: URI.parse('test://session-completed'),\n\t\t\t\t\t\tlabel: 'Completed Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.Completed,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'session-inprogress',\n\t\t\t\t\t\tresource: URI.parse('test://session-inprogress'),\n\t\t\t\t\t\tlabel: 'In Progress Session',\n\t\t\t\t\t\tstatus: ChatSessionStatus.InProgress,\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 3);\n\t\t\tassert.strictEqual(viewModel.sessions[0].status, ChatSessionStatus.Failed);\n\t\t\tassert.strictEqual(viewModel.sessions[1].status, ChatSessionStatus.Completed);\n\t\t\tassert.strictEqual(viewModel.sessions[2].status, ChatSessionStatus.InProgress);\n\t\t});\n\t});\n\n\ttest('should replace sessions on re-resolve', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet sessionCount = 1;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tconst sessions: IChatSessionItem[] = [];\n\t\t\t\t\tfor (let i = 0; i < sessionCount; i++) {\n\t\t\t\t\t\tsessions.push({\n\t\t\t\t\t\t\tresource: URI.parse(`test://session-${i}`),\n\t\t\t\t\t\t\tlabel: `Session ${i}`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn sessions;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\n\t\t\tsessionCount = 3;\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 3);\n\t\t});\n\t});\n\n\ttest('should handle local agent session type specially', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: localChatSessionType,\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'local-session',\n\t\t\t\t\t\tresource: LocalChatSessionUri.forSession('local-session'),\n\t\t\t\t\t\tlabel: 'Local Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].providerType, localChatSessionType);\n\t\t});\n\t});\n\n\ttest('should correctly construct resource URIs for sessions', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tconst resource = URI.parse('custom://my-session/path');\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\tawait viewModel.resolve(undefined);\n\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t\tassert.strictEqual(viewModel.sessions[0].resource.toString(), resource.toString());\n\t\t});\n\t});\n\n\ttest('should throttle multiple rapid resolve calls', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet providerCallCount = 0;\n\n\t\t\tconst provider: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'test-type',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tproviderCallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\t\tlabel: 'Test Session',\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider);\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// Make multiple rapid resolve calls\n\t\t\tconst resolvePromises = [\n\t\t\t\tviewModel.resolve(undefined),\n\t\t\t\tviewModel.resolve(undefined),\n\t\t\t\tviewModel.resolve(undefined)\n\t\t\t];\n\n\t\t\tawait Promise.all(resolvePromises);\n\n\t\t\t// Should only call provider once due to throttling\n\t\t\tassert.strictEqual(providerCallCount, 1);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 1);\n\t\t});\n\t});\n\n\ttest('should preserve sessions from non-resolved providers', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet provider1CallCount = 0;\n\t\t\tlet provider2CallCount = 0;\n\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tprovider1CallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\t\tlabel: `Session 1 (call ${provider1CallCount})`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tprovider2CallCount++;\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\t\tlabel: `Session 2 (call ${provider2CallCount})`,\n\t\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// First resolve all\n\t\t\tawait viewModel.resolve(undefined);\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\tassert.strictEqual(provider1CallCount, 1);\n\t\t\tassert.strictEqual(provider2CallCount, 1);\n\t\t\tconst originalSession1Label = viewModel.sessions[0].label;\n\n\t\t\t// Now resolve only type-2\n\t\t\tawait viewModel.resolve('type-2');\n\n\t\t\t// Should still have both sessions\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t\t// Provider 1 should not be called again\n\t\t\tassert.strictEqual(provider1CallCount, 1);\n\t\t\t// Provider 2 should be called again\n\t\t\tassert.strictEqual(provider2CallCount, 2);\n\t\t\t// Session 1 should be preserved with original label\n\t\t\tassert.strictEqual(viewModel.sessions.find(s => s.resource.toString() === 'test://session-1')?.label, originalSession1Label);\n\t\t});\n\t});\n\n\ttest('should accumulate providers when resolve is called with different provider types', async () => {\n\t\treturn runWithFakedTimers({}, async () => {\n\t\t\tlet resolveCount = 0;\n\t\t\tconst resolvedProviders: (string | undefined)[] = [];\n\n\t\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-1',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tresolveCount++;\n\t\t\t\t\tresolvedProviders.push('type-1');\n\t\t\t\t\treturn [{\n\t\t\t\t\t\tresource: URI.parse('test://session-1'),\n\t\t\t\t\t\tlabel: 'Session 1',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\t\tchatSessionType: 'type-2',\n\t\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\t\tprovideChatSessionItems: async () => {\n\t\t\t\t\tresolveCount++;\n\t\t\t\t\tresolvedProviders.push('type-2');\n\t\t\t\t\treturn [{\n\t\t\t\t\t\tresource: URI.parse('test://session-2'),\n\t\t\t\t\t\tlabel: 'Session 2',\n\t\t\t\t\t\ttiming: { startTime: Date.now() }\n\t\t\t\t\t}];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider1);\n\t\t\tmockChatSessionsService.registerChatSessionItemProvider(provider2);\n\n\t\t\tviewModel = createViewModel();\n\n\t\t\t// Call resolve with different types rapidly - they should accumulate\n\t\t\tconst promise1 = viewModel.resolve('type-1');\n\t\t\tconst promise2 = viewModel.resolve(['type-2']);\n\n\t\t\tawait Promise.all([promise1, promise2]);\n\n\t\t\t// Both providers should be resolved\n\t\t\tassert.strictEqual(viewModel.sessions.length, 2);\n\t\t});\n\t});\n});\n\nsuite('AgentSessionsViewModel - Helper Functions', () => {\n\tconst disposables = new DisposableStore();\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('isLocalAgentSessionItem should identify local sessions', () => {\n\t\tconst localSession: IAgentSessionViewModel = {\n\t\t\tproviderType: localChatSessionType,\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://local-1'),\n\t\t\tlabel: 'Local',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst remoteSession: IAgentSessionViewModel = {\n\t\t\tproviderType: 'remote',\n\t\t\tproviderLabel: 'Remote',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://remote-1'),\n\t\t\tlabel: 'Remote',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tassert.strictEqual(isLocalAgentSessionItem(localSession), true);\n\t\tassert.strictEqual(isLocalAgentSessionItem(remoteSession), false);\n\t});\n\n\ttest('isAgentSession should identify session view models', () => {\n\t\tconst session: IAgentSessionViewModel = {\n\t\t\tproviderType: 'test',\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://test-1'),\n\t\t\tlabel: 'Test',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Test with a session object\n\t\tassert.strictEqual(isAgentSession(session), true);\n\n\t\t// Test with a sessions container - pass as session to see it returns false\n\t\tconst sessionOrContainer: IAgentSessionViewModel = session;\n\t\tassert.strictEqual(isAgentSession(sessionOrContainer), true);\n\t});\n\n\ttest('isAgentSessionsViewModel should identify sessions view models', () => {\n\t\tconst session: IAgentSessionViewModel = {\n\t\t\tproviderType: 'test',\n\t\t\tproviderLabel: 'Local',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://test-1'),\n\t\t\tlabel: 'Test',\n\t\t\tdescription: 'test',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Test with actual view model\n\t\tconst instantiationService = workbenchInstantiationService(undefined, disposables);\n\t\tconst lifecycleService = disposables.add(new TestLifecycleService());\n\t\tinstantiationService.stub(IChatSessionsService, new MockChatSessionsService());\n\t\tinstantiationService.stub(ILifecycleService, lifecycleService);\n\t\tconst actualViewModel = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewModel,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\t\tassert.strictEqual(isAgentSessionsViewModel(actualViewModel), true);\n\n\t\t// Test with session object\n\t\tassert.strictEqual(isAgentSessionsViewModel(session), false);\n\t});\n});\n\nsuite('AgentSessionsViewFilter', () => {\n\tconst disposables = new DisposableStore();\n\tlet mockChatSessionsService: MockChatSessionsService;\n\tlet instantiationService: TestInstantiationService;\n\n\tsetup(() => {\n\t\tmockChatSessionsService = new MockChatSessionsService();\n\t\tinstantiationService = disposables.add(workbenchInstantiationService(undefined, disposables));\n\t\tinstantiationService.stub(IChatSessionsService, mockChatSessionsService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should filter out sessions from excluded provider', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider1: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'type-1',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst provider2: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'type-2',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst session1: IAgentSessionViewModel = {\n\t\t\tproviderType: provider1.chatSessionType,\n\t\t\tproviderLabel: 'Provider 1',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://session-1'),\n\t\t\tlabel: 'Session 1',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst session2: IAgentSessionViewModel = {\n\t\t\tproviderType: provider2.chatSessionType,\n\t\t\tproviderLabel: 'Provider 2',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://session-2'),\n\t\t\tlabel: 'Session 2',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// Initially, no sessions should be filtered\n\t\tassert.strictEqual(filter.exclude(session1), false);\n\t\tassert.strictEqual(filter.exclude(session2), false);\n\n\t\t// Exclude type-1 by setting it in storage\n\t\tconst excludes = {\n\t\t\tproviders: ['type-1'],\n\t\t\tstates: [],\n\t\t\tarchived: true\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After excluding type-1, session1 should be filtered but not session2\n\t\tassert.strictEqual(filter.exclude(session1), true);\n\t\tassert.strictEqual(filter.exclude(session2), false);\n\t});\n\n\ttest('should filter out archived sessions', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'test-type',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst archivedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://archived-session'),\n\t\t\tlabel: 'Archived Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: true,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst activeSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://active-session'),\n\t\t\tlabel: 'Active Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\t// By default, archived sessions should be filtered (archived: true in default excludes)\n\t\tassert.strictEqual(filter.exclude(archivedSession), true);\n\t\tassert.strictEqual(filter.exclude(activeSession), false);\n\n\t\t// Include archived by setting archived to false in storage\n\t\tconst excludes = {\n\t\t\tproviders: [],\n\t\t\tstates: [],\n\t\t\tarchived: false\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After including archived, both sessions should not be filtered\n\t\tassert.strictEqual(filter.exclude(archivedSession), false);\n\t\tassert.strictEqual(filter.exclude(activeSession), false);\n\t});\n\n\ttest('should filter out sessions with excluded status', () => {\n\t\tconst storageService = instantiationService.get(IStorageService);\n\t\tconst filter = disposables.add(instantiationService.createInstance(\n\t\t\tAgentSessionsViewFilter,\n\t\t\t{ filterMenuId: MenuId.ViewTitle }\n\t\t));\n\n\t\tconst provider: IChatSessionItemProvider = {\n\t\t\tchatSessionType: 'test-type',\n\t\t\tonDidChangeChatSessionItems: Event.None,\n\t\t\tprovideChatSessionItems: async () => []\n\t\t};\n\n\t\tconst failedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://failed-session'),\n\t\t\tlabel: 'Failed Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Failed\n\t\t};\n\n\t\tconst completedSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://completed-session'),\n\t\t\tlabel: 'Completed Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.Completed\n\t\t};\n\n\t\tconst inProgressSession: IAgentSessionViewModel = {\n\t\t\tproviderType: provider.chatSessionType,\n\t\t\tproviderLabel: 'Test Provider',\n\t\t\ticon: Codicon.chatSparkle,\n\t\t\tresource: URI.parse('test://inprogress-session'),\n\t\t\tlabel: 'In Progress Session',\n\t\t\ttiming: { startTime: Date.now() },\n\t\t\tarchived: false,\n\t\t\tstatus: ChatSessionStatus.InProgress\n\t\t};\n\n\t\t// Initially, no sessions should be filtered by status\n\t\tassert.strictEqual(filter.exclude(failedSession), false);\n\t\tassert.strictEqual(filter.exclude(completedSession), false);\n\t\tassert.strictEqual(filter.exclude(inProgressSession), false);\n\n\t\t// Exclude failed status by setting it in storage\n\t\tconst excludes = {\n\t\t\tproviders: [],\n\t\t\tstates: [ChatSessionStatus.Failed],\n\t\t\tarchived: false\n\t\t};\n\t\tstorageService.store('agentSessions.filterExcludes', JSON.stringify(excludes), StorageScope.PROFILE, StorageTarget.USER);\n\n\t\t// After excluding failed status, only failedSession should be filtered\n\t\tassert.strictEqual(filter.exclude(failedSession), true);\n\t\tassert.strictEqual(filter.exclude(completedSession), false);\n\t\tassert.strictEqual(filter.exclude(inProgressSession), false);\n\t});\n});\n"]}