{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/test/browser/chatModelsViewModel.test.ts","vs/workbench/contrib/chat/test/browser/chatModelsViewModel.test.ts"],"names":[],"mappings":"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","file":"chatModelsViewModel.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ILanguageModelChatMetadata, ILanguageModelChatMetadataAndIdentifier, ILanguageModelChatProvider, ILanguageModelChatSelector, ILanguageModelsService, IUserFriendlyLanguageModel } from '../../common/languageModels.js';\nimport { ChatModelsViewModel, IModelItemEntry, IVendorItemEntry, isVendorEntry } from '../../browser/chatManagement/chatModelsViewModel.js';\nimport { IChatEntitlementService, ChatEntitlement } from '../../../../services/chat/common/chatEntitlementService.js';\nimport { IObservable, observableValue } from '../../../../../base/common/observable.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\n\nclass MockLanguageModelsService implements ILanguageModelsService {\n\t_serviceBrand: undefined;\n\n\tprivate vendors: IUserFriendlyLanguageModel[] = [];\n\tprivate models = new Map<string, ILanguageModelChatMetadata>();\n\tprivate modelsByVendor = new Map<string, string[]>();\n\n\tprivate readonly _onDidChangeLanguageModels = new Emitter<string>();\n\treadonly onDidChangeLanguageModels = this._onDidChangeLanguageModels.event;\n\n\taddVendor(vendor: IUserFriendlyLanguageModel): void {\n\t\tthis.vendors.push(vendor);\n\t\tthis.modelsByVendor.set(vendor.vendor, []);\n\t}\n\n\taddModel(vendorId: string, identifier: string, metadata: ILanguageModelChatMetadata): void {\n\t\tthis.models.set(identifier, metadata);\n\t\tconst models = this.modelsByVendor.get(vendorId) || [];\n\t\tmodels.push(identifier);\n\t\tthis.modelsByVendor.set(vendorId, models);\n\t}\n\n\tregisterLanguageModelProvider(vendor: string, provider: ILanguageModelChatProvider): IDisposable {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tupdateModelPickerPreference(modelIdentifier: string, showInModelPicker: boolean): void {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tgetVendors(): IUserFriendlyLanguageModel[] {\n\t\treturn this.vendors;\n\t}\n\n\tgetLanguageModelIds(): string[] {\n\t\treturn Array.from(this.models.keys());\n\t}\n\n\tlookupLanguageModel(identifier: string): ILanguageModelChatMetadata | undefined {\n\t\treturn this.models.get(identifier);\n\t}\n\n\tgetLanguageModels(): ILanguageModelChatMetadataAndIdentifier[] {\n\t\tconst result: ILanguageModelChatMetadataAndIdentifier[] = [];\n\t\tfor (const [identifier, metadata] of this.models.entries()) {\n\t\t\tresult.push({ identifier, metadata });\n\t\t}\n\t\treturn result;\n\t}\n\n\tsetContributedSessionModels(): void {\n\t}\n\n\tclearContributedSessionModels(): void {\n\t}\n\n\tasync selectLanguageModels(selector: ILanguageModelChatSelector, allowHidden?: boolean): Promise<string[]> {\n\t\tif (selector.vendor) {\n\t\t\treturn this.modelsByVendor.get(selector.vendor) || [];\n\t\t}\n\t\treturn Array.from(this.models.keys());\n\t}\n\n\tsendChatRequest(): Promise<any> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tcomputeTokenLength(): Promise<number> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n}\n\nclass MockChatEntitlementService implements IChatEntitlementService {\n\t_serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeEntitlement = new Emitter<void>();\n\treadonly onDidChangeEntitlement = this._onDidChangeEntitlement.event;\n\n\treadonly entitlement = ChatEntitlement.Unknown;\n\treadonly entitlementObs: IObservable<ChatEntitlement> = observableValue('entitlement', ChatEntitlement.Unknown);\n\n\treadonly organisations: string[] | undefined = undefined;\n\treadonly isInternal = false;\n\treadonly sku: string | undefined = undefined;\n\n\treadonly onDidChangeQuotaExceeded = Event.None;\n\treadonly onDidChangeQuotaRemaining = Event.None;\n\n\treadonly quotas = {\n\t\tchat: {\n\t\t\ttotal: 100,\n\t\t\tremaining: 100,\n\t\t\tpercentRemaining: 100,\n\t\t\toverageEnabled: false,\n\t\t\toverageCount: 0,\n\t\t\tunlimited: false\n\t\t},\n\t\tcompletions: {\n\t\t\ttotal: 100,\n\t\t\tremaining: 100,\n\t\t\tpercentRemaining: 100,\n\t\t\toverageEnabled: false,\n\t\t\toverageCount: 0,\n\t\t\tunlimited: false\n\t\t}\n\t};\n\n\treadonly onDidChangeSentiment = Event.None;\n\treadonly sentiment: any = { installed: true, hidden: false, disabled: false };\n\treadonly sentimentObs: IObservable<any> = observableValue('sentiment', { installed: true, hidden: false, disabled: false });\n\n\treadonly onDidChangeAnonymous = Event.None;\n\treadonly anonymous = false;\n\treadonly anonymousObs: IObservable<boolean> = observableValue('anonymous', false);\n\n\tfireEntitlementChange(): void {\n\t\tthis._onDidChangeEntitlement.fire();\n\t}\n\n\tasync update(): Promise<void> {\n\t\t// Not needed for tests\n\t}\n}\n\nsuite('ChatModelsViewModel', () => {\n\tlet store: DisposableStore;\n\tlet languageModelsService: MockLanguageModelsService;\n\tlet chatEntitlementService: MockChatEntitlementService;\n\tlet viewModel: ChatModelsViewModel;\n\n\tsetup(async () => {\n\t\tstore = new DisposableStore();\n\t\tlanguageModelsService = new MockLanguageModelsService();\n\t\tchatEntitlementService = new MockChatEntitlementService();\n\n\t\t// Setup test data\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'copilot',\n\t\t\tdisplayName: 'GitHub Copilot',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'openai',\n\t\t\tdisplayName: 'OpenAI',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('copilot', 'copilot-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4',\n\t\t\tname: 'GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('copilot', 'copilot-gpt-4o', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4o',\n\t\t\tname: 'GPT-4o',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: true\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('openai', 'openai-gpt-3.5', {\n\t\t\textension: new ExtensionIdentifier('openai.api'),\n\t\t\tid: 'gpt-3.5-turbo',\n\t\t\tname: 'GPT-3.5 Turbo',\n\t\t\tfamily: 'gpt-3.5',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'openai',\n\t\t\tmaxInputTokens: 4096,\n\t\t\tmaxOutputTokens: 2048,\n\t\t\tmodelPickerCategory: { label: 'OpenAI', order: 2 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('openai', 'openai-gpt-4-vision', {\n\t\t\textension: new ExtensionIdentifier('openai.api'),\n\t\t\tid: 'gpt-4-vision',\n\t\t\tname: 'GPT-4 Vision',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'openai',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'OpenAI', order: 2 },\n\t\t\tisUserSelectable: false,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: false,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tviewModel = store.add(new ChatModelsViewModel(\n\t\t\tlanguageModelsService,\n\t\t\tchatEntitlementService\n\t\t));\n\n\t\tawait viewModel.resolve();\n\t});\n\n\tteardown(() => {\n\t\tstore.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should fetch all models without filters', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should have 2 vendor entries and 4 model entries (grouped by vendor)\n\t\tassert.strictEqual(results.length, 6);\n\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 2);\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter by provider name', () => {\n\t\tconst results = viewModel.filter('@provider:copilot');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should filter by provider display name', () => {\n\t\tconst results = viewModel.filter('@provider:OpenAI');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'openai'));\n\t});\n\n\ttest('should filter by multiple providers with OR logic', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @provider:openai');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter by single capability - tools', () => {\n\t\tconst results = viewModel.filter('@capability:tools');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.toolCalling === true));\n\t});\n\n\ttest('should filter by single capability - vision', () => {\n\t\tconst results = viewModel.filter('@capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.vision === true));\n\t});\n\n\ttest('should filter by single capability - agent', () => {\n\t\tconst results = viewModel.filter('@capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should filter by multiple capabilities with AND logic', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only return models that have BOTH tools and vision\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.metadata.capabilities?.toolCalling === true &&\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true\n\t\t));\n\t});\n\n\ttest('should filter by three capabilities with AND logic', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision @capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only return gpt-4o which has all three\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should return no results when filtering by incompatible capabilities', () => {\n\t\tconst results = viewModel.filter('@capability:vision @capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Only gpt-4o has both vision and agent, but gpt-4-vision doesn't have agent\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should filter by visibility - visible:true', () => {\n\t\tconst results = viewModel.filter('@visible:true');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.isUserSelectable === true));\n\t});\n\n\ttest('should filter by visibility - visible:false', () => {\n\t\tconst results = viewModel.filter('@visible:false');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.isUserSelectable, false);\n\t});\n\n\ttest('should combine provider and capability filters', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.vendor === 'copilot' &&\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true\n\t\t));\n\t});\n\n\ttest('should combine provider, capability, and visibility filters', () => {\n\t\tconst results = viewModel.filter('@provider:openai @capability:vision @visible:false');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4-vision');\n\t});\n\n\ttest('should filter by text matching model name', () => {\n\t\tconst results = viewModel.filter('GPT-4o');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.name, 'GPT-4o');\n\t\tassert.ok(models[0].modelNameMatches);\n\t});\n\n\ttest('should filter by text matching model id', () => {\n\t\tconst results = viewModel.filter('copilot-gpt-4o');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.identifier, 'copilot-gpt-4o');\n\t\tassert.ok(models[0].modelIdMatches);\n\t});\n\n\ttest('should filter by text matching vendor name', () => {\n\t\tconst results = viewModel.filter('GitHub');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendorDisplayName === 'GitHub Copilot'));\n\t});\n\n\ttest('should combine text search with capability filter', () => {\n\t\tconst results = viewModel.filter('@capability:tools GPT');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should match all models with tools capability and 'GPT' in name\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.toolCalling === true));\n\t});\n\n\ttest('should handle empty search value', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should return all models grouped by vendor\n\t\tassert.ok(results.length > 0);\n\t});\n\n\ttest('should handle search value with only whitespace', () => {\n\t\tconst results = viewModel.filter('   ');\n\n\t\t// Should return all models grouped by vendor\n\t\tassert.ok(results.length > 0);\n\t});\n\n\ttest('should match capability text in free text search', () => {\n\t\tconst results = viewModel.filter('vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should match models that have vision capability or \"vision\" in their name\n\t\tassert.ok(models.length > 0);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true ||\n\t\t\tm.modelEntry.metadata.name.toLowerCase().includes('vision')\n\t\t));\n\t});\n\n\ttest('should toggle vendor collapsed state', () => {\n\t\tconst vendorEntry = viewModel.viewModelEntries.find(r => isVendorEntry(r) && r.vendorEntry.vendor === 'copilot') as IVendorItemEntry;\n\t\tviewModel.toggleVendorCollapsed(vendorEntry);\n\n\t\tconst results = viewModel.filter('');\n\t\tconst copilotVendor = results.find(r => isVendorEntry(r) && (r as IVendorItemEntry).vendorEntry.vendor === 'copilot') as IVendorItemEntry;\n\n\t\tassert.ok(copilotVendor);\n\t\tassert.strictEqual(copilotVendor.collapsed, true);\n\n\t\t// Models should not be shown when vendor is collapsed\n\t\tconst copilotModelsAfterCollapse = results.filter(r =>\n\t\t\t!isVendorEntry(r) && (r as IModelItemEntry).modelEntry.vendor === 'copilot'\n\t\t);\n\t\tassert.strictEqual(copilotModelsAfterCollapse.length, 0);\n\n\t\t// Toggle back\n\t\tviewModel.toggleVendorCollapsed(vendorEntry);\n\t\tconst resultsAfterExpand = viewModel.filter('');\n\t\tconst copilotModelsAfterExpand = resultsAfterExpand.filter(r =>\n\t\t\t!isVendorEntry(r) && (r as IModelItemEntry).modelEntry.vendor === 'copilot'\n\t\t);\n\t\tassert.strictEqual(copilotModelsAfterExpand.length, 2);\n\t});\n\n\ttest('should fire onDidChangeModelEntries when entitlement changes', async () => {\n\t\tlet fired = false;\n\t\tstore.add(viewModel.onDidChange(() => {\n\t\t\tfired = true;\n\t\t}));\n\n\t\tchatEntitlementService.fireEntitlementChange();\n\n\t\t// Wait a bit for async resolve\n\t\tawait new Promise(resolve => setTimeout(resolve, 10));\n\n\t\tassert.strictEqual(fired, true);\n\t});\n\n\ttest('should handle quoted search strings', () => {\n\t\t// When a search string is fully quoted (starts and ends with quotes),\n\t\t// the completeMatch flag is set to true, which currently skips all matching\n\t\t// This test verifies the quotes are processed without errors\n\t\tconst results = viewModel.filter('\"GPT\"');\n\n\t\t// The function should complete without error\n\t\t// Note: complete match logic (both quotes) currently doesn't perform matching\n\t\tassert.ok(Array.isArray(results));\n\t});\n\n\ttest('should remove filter keywords from text search', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @capability:vision GPT');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only search 'GPT' in model names, not the filter keywords\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should handle case-insensitive capability matching', () => {\n\t\tconst results1 = viewModel.filter('@capability:TOOLS');\n\t\tconst results2 = viewModel.filter('@capability:tools');\n\t\tconst results3 = viewModel.filter('@capability:Tools');\n\n\t\tconst models1 = results1.filter(r => !isVendorEntry(r));\n\t\tconst models2 = results2.filter(r => !isVendorEntry(r));\n\t\tconst models3 = results3.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(models1.length, models2.length);\n\t\tassert.strictEqual(models2.length, models3.length);\n\t});\n\n\ttest('should support toolcalling alias for tools capability', () => {\n\t\tconst resultsTools = viewModel.filter('@capability:tools');\n\t\tconst resultsToolCalling = viewModel.filter('@capability:toolcalling');\n\n\t\tconst modelsTools = resultsTools.filter(r => !isVendorEntry(r));\n\t\tconst modelsToolCalling = resultsToolCalling.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(modelsTools.length, modelsToolCalling.length);\n\t});\n\n\ttest('should support agentmode alias for agent capability', () => {\n\t\tconst resultsAgent = viewModel.filter('@capability:agent');\n\t\tconst resultsAgentMode = viewModel.filter('@capability:agentmode');\n\n\t\tconst modelsAgent = resultsAgent.filter(r => !isVendorEntry(r));\n\t\tconst modelsAgentMode = resultsAgentMode.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(modelsAgent.length, modelsAgentMode.length);\n\t});\n\n\ttest('should include matched capabilities in results', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.ok(models.length > 0);\n\n\t\tfor (const model of models) {\n\t\t\tassert.ok(model.capabilityMatches);\n\t\t\tassert.ok(model.capabilityMatches.length > 0);\n\t\t\t// Should include both toolCalling and vision\n\t\t\tassert.ok(model.capabilityMatches.some(c => c === 'toolCalling' || c === 'vision'));\n\t\t}\n\t});\n\n\t// Helper function to create a single vendor test environment\n\tfunction createSingleVendorViewModel(store: DisposableStore, chatEntitlementService: IChatEntitlementService, includeSecondModel: boolean = true): { service: MockLanguageModelsService; viewModel: ChatModelsViewModel } {\n\t\tconst service = new MockLanguageModelsService();\n\t\tservice.addVendor({\n\t\t\tvendor: 'copilot',\n\t\t\tdisplayName: 'GitHub Copilot',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tservice.addModel('copilot', 'copilot-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4',\n\t\t\tname: 'GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tif (includeSecondModel) {\n\t\t\tservice.addModel('copilot', 'copilot-gpt-4o', {\n\t\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\t\tid: 'gpt-4o',\n\t\t\t\tname: 'GPT-4o',\n\t\t\t\tfamily: 'gpt-4',\n\t\t\t\tversion: '1.0',\n\t\t\t\tvendor: 'copilot',\n\t\t\t\tmaxInputTokens: 8192,\n\t\t\t\tmaxOutputTokens: 4096,\n\t\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\t\tisUserSelectable: true,\n\t\t\t\tcapabilities: {\n\t\t\t\t\ttoolCalling: true,\n\t\t\t\t\tvision: true,\n\t\t\t\t\tagentMode: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst viewModel = store.add(new ChatModelsViewModel(service, chatEntitlementService));\n\t\treturn { service, viewModel };\n\t}\n\n\ttest('should not show vendor header when only one vendor exists', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('');\n\n\t\t// Should have only model entries, no vendor entry\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0, 'Should not show vendor header when only one vendor exists');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2, 'Should show all models');\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should show vendor headers when multiple vendors exist', () => {\n\t\t// This is the existing behavior test\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should have 2 vendor entries and 4 model entries (grouped by vendor)\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 2, 'Should show vendor headers when multiple vendors exist');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter single vendor models by capability', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('@capability:agent');\n\n\t\t// Should not show vendor header\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0, 'Should not show vendor header');\n\n\t\t// Should only show the model with agent capability\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should always place copilot vendor at the top', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\t\tassert.ok(vendors.length >= 2);\n\n\t\t// First vendor should always be copilot\n\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t});\n\n\ttest('should maintain copilot at top with multiple vendors', async () => {\n\t\t// Add more vendors to ensure sorting works correctly\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'anthropic',\n\t\t\tdisplayName: 'Anthropic',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('anthropic', 'anthropic-claude', {\n\t\t\textension: new ExtensionIdentifier('anthropic.api'),\n\t\t\tid: 'claude-3',\n\t\t\tname: 'Claude 3',\n\t\t\tfamily: 'claude',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'anthropic',\n\t\t\tmaxInputTokens: 100000,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Anthropic', order: 3 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'azure',\n\t\t\tdisplayName: 'Azure OpenAI',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('azure', 'azure-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('microsoft.azure'),\n\t\t\tid: 'azure-gpt-4',\n\t\t\tname: 'Azure GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'azure',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Azure', order: 4 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tawait viewModel.resolve();\n\n\t\tconst results = viewModel.filter('');\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\t// Should have 4 vendors: copilot, openai, anthropic, azure\n\t\tassert.strictEqual(vendors.length, 4);\n\n\t\t// First vendor should always be copilot\n\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\n\t\t// Other vendors should be alphabetically sorted: anthropic, azure, openai\n\t\tassert.strictEqual(vendors[1].vendorEntry.vendor, 'anthropic');\n\t\tassert.strictEqual(vendors[2].vendorEntry.vendor, 'azure');\n\t\tassert.strictEqual(vendors[3].vendorEntry.vendor, 'openai');\n\t});\n\n\ttest('should keep copilot at top even with text search', () => {\n\t\t// Even when searching, if results include multiple vendors, copilot should be first\n\t\tconst results = viewModel.filter('GPT');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\tif (vendors.length > 1) {\n\t\t\t// If multiple vendors match, copilot should be first\n\t\t\tconst copilotVendor = vendors.find(v => v.vendorEntry.vendor === 'copilot');\n\t\t\tif (copilotVendor) {\n\t\t\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t\t\t}\n\t\t}\n\t});\n\n\ttest('should keep copilot at top when filtering by capability', () => {\n\t\tconst results = viewModel.filter('@capability:tools');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\t// Both copilot and openai have models with tools capability\n\t\tif (vendors.length > 1) {\n\t\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t\t}\n\t});\n\n\ttest('should show vendor headers when filtered', () => {\n\t\tconst results = viewModel.filter('GPT');\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.ok(vendors.length > 0);\n\t});\n\n\ttest('should not show vendor headers when filtered if only one vendor exists', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('GPT');\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ILanguageModelChatMetadata, ILanguageModelChatMetadataAndIdentifier, ILanguageModelChatProvider, ILanguageModelChatSelector, ILanguageModelsService, IUserFriendlyLanguageModel } from '../../common/languageModels.js';\nimport { ChatModelsViewModel, IModelItemEntry, IVendorItemEntry, isVendorEntry } from '../../browser/chatManagement/chatModelsViewModel.js';\nimport { IChatEntitlementService, ChatEntitlement } from '../../../../services/chat/common/chatEntitlementService.js';\nimport { IObservable, observableValue } from '../../../../../base/common/observable.js';\nimport { ExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\n\nclass MockLanguageModelsService implements ILanguageModelsService {\n\t_serviceBrand: undefined;\n\n\tprivate vendors: IUserFriendlyLanguageModel[] = [];\n\tprivate models = new Map<string, ILanguageModelChatMetadata>();\n\tprivate modelsByVendor = new Map<string, string[]>();\n\n\tprivate readonly _onDidChangeLanguageModels = new Emitter<string>();\n\treadonly onDidChangeLanguageModels = this._onDidChangeLanguageModels.event;\n\n\taddVendor(vendor: IUserFriendlyLanguageModel): void {\n\t\tthis.vendors.push(vendor);\n\t\tthis.modelsByVendor.set(vendor.vendor, []);\n\t}\n\n\taddModel(vendorId: string, identifier: string, metadata: ILanguageModelChatMetadata): void {\n\t\tthis.models.set(identifier, metadata);\n\t\tconst models = this.modelsByVendor.get(vendorId) || [];\n\t\tmodels.push(identifier);\n\t\tthis.modelsByVendor.set(vendorId, models);\n\t}\n\n\tregisterLanguageModelProvider(vendor: string, provider: ILanguageModelChatProvider): IDisposable {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tupdateModelPickerPreference(modelIdentifier: string, showInModelPicker: boolean): void {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tgetVendors(): IUserFriendlyLanguageModel[] {\n\t\treturn this.vendors;\n\t}\n\n\tgetLanguageModelIds(): string[] {\n\t\treturn Array.from(this.models.keys());\n\t}\n\n\tlookupLanguageModel(identifier: string): ILanguageModelChatMetadata | undefined {\n\t\treturn this.models.get(identifier);\n\t}\n\n\tgetLanguageModels(): ILanguageModelChatMetadataAndIdentifier[] {\n\t\tconst result: ILanguageModelChatMetadataAndIdentifier[] = [];\n\t\tfor (const [identifier, metadata] of this.models.entries()) {\n\t\t\tresult.push({ identifier, metadata });\n\t\t}\n\t\treturn result;\n\t}\n\n\tsetContributedSessionModels(): void {\n\t}\n\n\tclearContributedSessionModels(): void {\n\t}\n\n\tasync selectLanguageModels(selector: ILanguageModelChatSelector, allowHidden?: boolean): Promise<string[]> {\n\t\tif (selector.vendor) {\n\t\t\treturn this.modelsByVendor.get(selector.vendor) || [];\n\t\t}\n\t\treturn Array.from(this.models.keys());\n\t}\n\n\tsendChatRequest(): Promise<any> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tcomputeTokenLength(): Promise<number> {\n\t\tthrow new Error('Method not implemented.');\n\t}\n}\n\nclass MockChatEntitlementService implements IChatEntitlementService {\n\t_serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeEntitlement = new Emitter<void>();\n\treadonly onDidChangeEntitlement = this._onDidChangeEntitlement.event;\n\n\treadonly entitlement = ChatEntitlement.Unknown;\n\treadonly entitlementObs: IObservable<ChatEntitlement> = observableValue('entitlement', ChatEntitlement.Unknown);\n\n\treadonly organisations: string[] | undefined = undefined;\n\treadonly isInternal = false;\n\treadonly sku: string | undefined = undefined;\n\n\treadonly onDidChangeQuotaExceeded = Event.None;\n\treadonly onDidChangeQuotaRemaining = Event.None;\n\n\treadonly quotas = {\n\t\tchat: {\n\t\t\ttotal: 100,\n\t\t\tremaining: 100,\n\t\t\tpercentRemaining: 100,\n\t\t\toverageEnabled: false,\n\t\t\toverageCount: 0,\n\t\t\tunlimited: false\n\t\t},\n\t\tcompletions: {\n\t\t\ttotal: 100,\n\t\t\tremaining: 100,\n\t\t\tpercentRemaining: 100,\n\t\t\toverageEnabled: false,\n\t\t\toverageCount: 0,\n\t\t\tunlimited: false\n\t\t}\n\t};\n\n\treadonly onDidChangeSentiment = Event.None;\n\treadonly sentiment: any = { installed: true, hidden: false, disabled: false };\n\treadonly sentimentObs: IObservable<any> = observableValue('sentiment', { installed: true, hidden: false, disabled: false });\n\n\treadonly onDidChangeAnonymous = Event.None;\n\treadonly anonymous = false;\n\treadonly anonymousObs: IObservable<boolean> = observableValue('anonymous', false);\n\n\tfireEntitlementChange(): void {\n\t\tthis._onDidChangeEntitlement.fire();\n\t}\n\n\tasync update(): Promise<void> {\n\t\t// Not needed for tests\n\t}\n}\n\nsuite('ChatModelsViewModel', () => {\n\tlet store: DisposableStore;\n\tlet languageModelsService: MockLanguageModelsService;\n\tlet chatEntitlementService: MockChatEntitlementService;\n\tlet viewModel: ChatModelsViewModel;\n\n\tsetup(async () => {\n\t\tstore = new DisposableStore();\n\t\tlanguageModelsService = new MockLanguageModelsService();\n\t\tchatEntitlementService = new MockChatEntitlementService();\n\n\t\t// Setup test data\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'copilot',\n\t\t\tdisplayName: 'GitHub Copilot',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'openai',\n\t\t\tdisplayName: 'OpenAI',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('copilot', 'copilot-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4',\n\t\t\tname: 'GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('copilot', 'copilot-gpt-4o', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4o',\n\t\t\tname: 'GPT-4o',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: true\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('openai', 'openai-gpt-3.5', {\n\t\t\textension: new ExtensionIdentifier('openai.api'),\n\t\t\tid: 'gpt-3.5-turbo',\n\t\t\tname: 'GPT-3.5 Turbo',\n\t\t\tfamily: 'gpt-3.5',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'openai',\n\t\t\tmaxInputTokens: 4096,\n\t\t\tmaxOutputTokens: 2048,\n\t\t\tmodelPickerCategory: { label: 'OpenAI', order: 2 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addModel('openai', 'openai-gpt-4-vision', {\n\t\t\textension: new ExtensionIdentifier('openai.api'),\n\t\t\tid: 'gpt-4-vision',\n\t\t\tname: 'GPT-4 Vision',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'openai',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'OpenAI', order: 2 },\n\t\t\tisUserSelectable: false,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: false,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tviewModel = store.add(new ChatModelsViewModel(\n\t\t\tlanguageModelsService,\n\t\t\tchatEntitlementService\n\t\t));\n\n\t\tawait viewModel.resolve();\n\t});\n\n\tteardown(() => {\n\t\tstore.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('should fetch all models without filters', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should have 2 vendor entries and 4 model entries (grouped by vendor)\n\t\tassert.strictEqual(results.length, 6);\n\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 2);\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter by provider name', () => {\n\t\tconst results = viewModel.filter('@provider:copilot');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should filter by provider display name', () => {\n\t\tconst results = viewModel.filter('@provider:OpenAI');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'openai'));\n\t});\n\n\ttest('should filter by multiple providers with OR logic', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @provider:openai');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter by single capability - tools', () => {\n\t\tconst results = viewModel.filter('@capability:tools');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.toolCalling === true));\n\t});\n\n\ttest('should filter by single capability - vision', () => {\n\t\tconst results = viewModel.filter('@capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.vision === true));\n\t});\n\n\ttest('should filter by single capability - agent', () => {\n\t\tconst results = viewModel.filter('@capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should filter by multiple capabilities with AND logic', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only return models that have BOTH tools and vision\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.metadata.capabilities?.toolCalling === true &&\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true\n\t\t));\n\t});\n\n\ttest('should filter by three capabilities with AND logic', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision @capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only return gpt-4o which has all three\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should return no results when filtering by incompatible capabilities', () => {\n\t\tconst results = viewModel.filter('@capability:vision @capability:agent');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Only gpt-4o has both vision and agent, but gpt-4-vision doesn't have agent\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should filter by visibility - visible:true', () => {\n\t\tconst results = viewModel.filter('@visible:true');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.isUserSelectable === true));\n\t});\n\n\ttest('should filter by visibility - visible:false', () => {\n\t\tconst results = viewModel.filter('@visible:false');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.isUserSelectable, false);\n\t});\n\n\ttest('should combine provider and capability filters', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.vendor === 'copilot' &&\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true\n\t\t));\n\t});\n\n\ttest('should combine provider, capability, and visibility filters', () => {\n\t\tconst results = viewModel.filter('@provider:openai @capability:vision @visible:false');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4-vision');\n\t});\n\n\ttest('should filter by text matching model name', () => {\n\t\tconst results = viewModel.filter('GPT-4o');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.name, 'GPT-4o');\n\t\tassert.ok(models[0].modelNameMatches);\n\t});\n\n\ttest('should filter by text matching model id', () => {\n\t\tconst results = viewModel.filter('copilot-gpt-4o');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.identifier, 'copilot-gpt-4o');\n\t\tassert.ok(models[0].modelIdMatches);\n\t});\n\n\ttest('should filter by text matching vendor name', () => {\n\t\tconst results = viewModel.filter('GitHub');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendorDisplayName === 'GitHub Copilot'));\n\t});\n\n\ttest('should combine text search with capability filter', () => {\n\t\tconst results = viewModel.filter('@capability:tools GPT');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should match all models with tools capability and 'GPT' in name\n\t\tassert.strictEqual(models.length, 3);\n\t\tassert.ok(models.every(m => m.modelEntry.metadata.capabilities?.toolCalling === true));\n\t});\n\n\ttest('should handle empty search value', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should return all models grouped by vendor\n\t\tassert.ok(results.length > 0);\n\t});\n\n\ttest('should handle search value with only whitespace', () => {\n\t\tconst results = viewModel.filter('   ');\n\n\t\t// Should return all models grouped by vendor\n\t\tassert.ok(results.length > 0);\n\t});\n\n\ttest('should match capability text in free text search', () => {\n\t\tconst results = viewModel.filter('vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should match models that have vision capability or \"vision\" in their name\n\t\tassert.ok(models.length > 0);\n\t\tassert.ok(models.every(m =>\n\t\t\tm.modelEntry.metadata.capabilities?.vision === true ||\n\t\t\tm.modelEntry.metadata.name.toLowerCase().includes('vision')\n\t\t));\n\t});\n\n\ttest('should toggle vendor collapsed state', () => {\n\t\tconst vendorEntry = viewModel.viewModelEntries.find(r => isVendorEntry(r) && r.vendorEntry.vendor === 'copilot') as IVendorItemEntry;\n\t\tviewModel.toggleVendorCollapsed(vendorEntry);\n\n\t\tconst results = viewModel.filter('');\n\t\tconst copilotVendor = results.find(r => isVendorEntry(r) && (r as IVendorItemEntry).vendorEntry.vendor === 'copilot') as IVendorItemEntry;\n\n\t\tassert.ok(copilotVendor);\n\t\tassert.strictEqual(copilotVendor.collapsed, true);\n\n\t\t// Models should not be shown when vendor is collapsed\n\t\tconst copilotModelsAfterCollapse = results.filter(r =>\n\t\t\t!isVendorEntry(r) && (r as IModelItemEntry).modelEntry.vendor === 'copilot'\n\t\t);\n\t\tassert.strictEqual(copilotModelsAfterCollapse.length, 0);\n\n\t\t// Toggle back\n\t\tviewModel.toggleVendorCollapsed(vendorEntry);\n\t\tconst resultsAfterExpand = viewModel.filter('');\n\t\tconst copilotModelsAfterExpand = resultsAfterExpand.filter(r =>\n\t\t\t!isVendorEntry(r) && (r as IModelItemEntry).modelEntry.vendor === 'copilot'\n\t\t);\n\t\tassert.strictEqual(copilotModelsAfterExpand.length, 2);\n\t});\n\n\ttest('should fire onDidChangeModelEntries when entitlement changes', async () => {\n\t\tlet fired = false;\n\t\tstore.add(viewModel.onDidChange(() => {\n\t\t\tfired = true;\n\t\t}));\n\n\t\tchatEntitlementService.fireEntitlementChange();\n\n\t\t// Wait a bit for async resolve\n\t\tawait new Promise(resolve => setTimeout(resolve, 10));\n\n\t\tassert.strictEqual(fired, true);\n\t});\n\n\ttest('should handle quoted search strings', () => {\n\t\t// When a search string is fully quoted (starts and ends with quotes),\n\t\t// the completeMatch flag is set to true, which currently skips all matching\n\t\t// This test verifies the quotes are processed without errors\n\t\tconst results = viewModel.filter('\"GPT\"');\n\n\t\t// The function should complete without error\n\t\t// Note: complete match logic (both quotes) currently doesn't perform matching\n\t\tassert.ok(Array.isArray(results));\n\t});\n\n\ttest('should remove filter keywords from text search', () => {\n\t\tconst results = viewModel.filter('@provider:copilot @capability:vision GPT');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\t// Should only search 'GPT' in model names, not the filter keywords\n\t\tassert.strictEqual(models.length, 2);\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should handle case-insensitive capability matching', () => {\n\t\tconst results1 = viewModel.filter('@capability:TOOLS');\n\t\tconst results2 = viewModel.filter('@capability:tools');\n\t\tconst results3 = viewModel.filter('@capability:Tools');\n\n\t\tconst models1 = results1.filter(r => !isVendorEntry(r));\n\t\tconst models2 = results2.filter(r => !isVendorEntry(r));\n\t\tconst models3 = results3.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(models1.length, models2.length);\n\t\tassert.strictEqual(models2.length, models3.length);\n\t});\n\n\ttest('should support toolcalling alias for tools capability', () => {\n\t\tconst resultsTools = viewModel.filter('@capability:tools');\n\t\tconst resultsToolCalling = viewModel.filter('@capability:toolcalling');\n\n\t\tconst modelsTools = resultsTools.filter(r => !isVendorEntry(r));\n\t\tconst modelsToolCalling = resultsToolCalling.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(modelsTools.length, modelsToolCalling.length);\n\t});\n\n\ttest('should support agentmode alias for agent capability', () => {\n\t\tconst resultsAgent = viewModel.filter('@capability:agent');\n\t\tconst resultsAgentMode = viewModel.filter('@capability:agentmode');\n\n\t\tconst modelsAgent = resultsAgent.filter(r => !isVendorEntry(r));\n\t\tconst modelsAgentMode = resultsAgentMode.filter(r => !isVendorEntry(r));\n\n\t\tassert.strictEqual(modelsAgent.length, modelsAgentMode.length);\n\t});\n\n\ttest('should include matched capabilities in results', () => {\n\t\tconst results = viewModel.filter('@capability:tools @capability:vision');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.ok(models.length > 0);\n\n\t\tfor (const model of models) {\n\t\t\tassert.ok(model.capabilityMatches);\n\t\t\tassert.ok(model.capabilityMatches.length > 0);\n\t\t\t// Should include both toolCalling and vision\n\t\t\tassert.ok(model.capabilityMatches.some(c => c === 'toolCalling' || c === 'vision'));\n\t\t}\n\t});\n\n\t// Helper function to create a single vendor test environment\n\tfunction createSingleVendorViewModel(store: DisposableStore, chatEntitlementService: IChatEntitlementService, includeSecondModel: boolean = true): { service: MockLanguageModelsService; viewModel: ChatModelsViewModel } {\n\t\tconst service = new MockLanguageModelsService();\n\t\tservice.addVendor({\n\t\t\tvendor: 'copilot',\n\t\t\tdisplayName: 'GitHub Copilot',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tservice.addModel('copilot', 'copilot-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\tid: 'gpt-4',\n\t\t\tname: 'GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'copilot',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: true,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tif (includeSecondModel) {\n\t\t\tservice.addModel('copilot', 'copilot-gpt-4o', {\n\t\t\t\textension: new ExtensionIdentifier('github.copilot'),\n\t\t\t\tid: 'gpt-4o',\n\t\t\t\tname: 'GPT-4o',\n\t\t\t\tfamily: 'gpt-4',\n\t\t\t\tversion: '1.0',\n\t\t\t\tvendor: 'copilot',\n\t\t\t\tmaxInputTokens: 8192,\n\t\t\t\tmaxOutputTokens: 4096,\n\t\t\t\tmodelPickerCategory: { label: 'Copilot', order: 1 },\n\t\t\t\tisUserSelectable: true,\n\t\t\t\tcapabilities: {\n\t\t\t\t\ttoolCalling: true,\n\t\t\t\t\tvision: true,\n\t\t\t\t\tagentMode: true\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst viewModel = store.add(new ChatModelsViewModel(service, chatEntitlementService));\n\t\treturn { service, viewModel };\n\t}\n\n\ttest('should not show vendor header when only one vendor exists', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('');\n\n\t\t// Should have only model entries, no vendor entry\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0, 'Should not show vendor header when only one vendor exists');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 2, 'Should show all models');\n\t\tassert.ok(models.every(m => m.modelEntry.vendor === 'copilot'));\n\t});\n\n\ttest('should show vendor headers when multiple vendors exist', () => {\n\t\t// This is the existing behavior test\n\t\tconst results = viewModel.filter('');\n\n\t\t// Should have 2 vendor entries and 4 model entries (grouped by vendor)\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 2, 'Should show vendor headers when multiple vendors exist');\n\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 4);\n\t});\n\n\ttest('should filter single vendor models by capability', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('@capability:agent');\n\n\t\t// Should not show vendor header\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0, 'Should not show vendor header');\n\n\t\t// Should only show the model with agent capability\n\t\tconst models = results.filter(r => !isVendorEntry(r)) as IModelItemEntry[];\n\t\tassert.strictEqual(models.length, 1);\n\t\tassert.strictEqual(models[0].modelEntry.metadata.id, 'gpt-4o');\n\t});\n\n\ttest('should always place copilot vendor at the top', () => {\n\t\tconst results = viewModel.filter('');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\t\tassert.ok(vendors.length >= 2);\n\n\t\t// First vendor should always be copilot\n\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t});\n\n\ttest('should maintain copilot at top with multiple vendors', async () => {\n\t\t// Add more vendors to ensure sorting works correctly\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'anthropic',\n\t\t\tdisplayName: 'Anthropic',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('anthropic', 'anthropic-claude', {\n\t\t\textension: new ExtensionIdentifier('anthropic.api'),\n\t\t\tid: 'claude-3',\n\t\t\tname: 'Claude 3',\n\t\t\tfamily: 'claude',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'anthropic',\n\t\t\tmaxInputTokens: 100000,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Anthropic', order: 3 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tlanguageModelsService.addVendor({\n\t\t\tvendor: 'azure',\n\t\t\tdisplayName: 'Azure OpenAI',\n\t\t\tmanagementCommand: undefined,\n\t\t\twhen: undefined\n\t\t});\n\n\t\tlanguageModelsService.addModel('azure', 'azure-gpt-4', {\n\t\t\textension: new ExtensionIdentifier('microsoft.azure'),\n\t\t\tid: 'azure-gpt-4',\n\t\t\tname: 'Azure GPT-4',\n\t\t\tfamily: 'gpt-4',\n\t\t\tversion: '1.0',\n\t\t\tvendor: 'azure',\n\t\t\tmaxInputTokens: 8192,\n\t\t\tmaxOutputTokens: 4096,\n\t\t\tmodelPickerCategory: { label: 'Azure', order: 4 },\n\t\t\tisUserSelectable: true,\n\t\t\tcapabilities: {\n\t\t\t\ttoolCalling: true,\n\t\t\t\tvision: false,\n\t\t\t\tagentMode: false\n\t\t\t}\n\t\t});\n\n\t\tawait viewModel.resolve();\n\n\t\tconst results = viewModel.filter('');\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\t// Should have 4 vendors: copilot, openai, anthropic, azure\n\t\tassert.strictEqual(vendors.length, 4);\n\n\t\t// First vendor should always be copilot\n\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\n\t\t// Other vendors should be alphabetically sorted: anthropic, azure, openai\n\t\tassert.strictEqual(vendors[1].vendorEntry.vendor, 'anthropic');\n\t\tassert.strictEqual(vendors[2].vendorEntry.vendor, 'azure');\n\t\tassert.strictEqual(vendors[3].vendorEntry.vendor, 'openai');\n\t});\n\n\ttest('should keep copilot at top even with text search', () => {\n\t\t// Even when searching, if results include multiple vendors, copilot should be first\n\t\tconst results = viewModel.filter('GPT');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\tif (vendors.length > 1) {\n\t\t\t// If multiple vendors match, copilot should be first\n\t\t\tconst copilotVendor = vendors.find(v => v.vendorEntry.vendor === 'copilot');\n\t\t\tif (copilotVendor) {\n\t\t\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t\t\t}\n\t\t}\n\t});\n\n\ttest('should keep copilot at top when filtering by capability', () => {\n\t\tconst results = viewModel.filter('@capability:tools');\n\n\t\tconst vendors = results.filter(isVendorEntry) as IVendorItemEntry[];\n\n\t\t// Both copilot and openai have models with tools capability\n\t\tif (vendors.length > 1) {\n\t\t\tassert.strictEqual(vendors[0].vendorEntry.vendor, 'copilot');\n\t\t}\n\t});\n\n\ttest('should show vendor headers when filtered', () => {\n\t\tconst results = viewModel.filter('GPT');\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.ok(vendors.length > 0);\n\t});\n\n\ttest('should not show vendor headers when filtered if only one vendor exists', async () => {\n\t\tconst { viewModel: singleVendorViewModel } = createSingleVendorViewModel(store, chatEntitlementService);\n\t\tawait singleVendorViewModel.resolve();\n\n\t\tconst results = singleVendorViewModel.filter('GPT');\n\t\tconst vendors = results.filter(isVendorEntry);\n\t\tassert.strictEqual(vendors.length, 0);\n\t});\n});\n"]}