{"version":3,"sources":["vs/workbench/contrib/chat/common/chatUrlFetchingConfirmation.ts"],"names":[],"mappings":"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","file":"chatUrlFetchingConfirmation.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IQuickInputButton, IQuickInputService, IQuickTreeItem } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IPreferencesService } from '../../../services/preferences/common/preferences.js';\nimport { ConfirmedReason, ToolConfirmKind } from './chatService.js';\nimport { ChatConfiguration } from './constants.js';\nimport {\n\tILanguageModelToolConfirmationActions,\n\tILanguageModelToolConfirmationContribution,\n\tILanguageModelToolConfirmationContributionQuickTreeItem,\n\tILanguageModelToolConfirmationRef\n} from './languageModelToolsConfirmationService.js';\nimport { extractUrlPatterns, getPatternLabel, isUrlApproved, IUrlApprovalSettings } from './chatUrlFetchingPatterns.js';\n\nconst trashButton: IQuickInputButton = {\n\ticonClass: ThemeIcon.asClassName(Codicon.trash),\n\ttooltip: localize('delete', \"Delete\")\n};\n\nexport class ChatUrlFetchingConfirmationContribution implements ILanguageModelToolConfirmationContribution {\n\treadonly canUseDefaultApprovals = false;\n\n\tconstructor(\n\t\tprivate readonly _getURLS: (parameters: unknown) => string[] | undefined,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@IPreferencesService private readonly _preferencesService: IPreferencesService\n\t) { }\n\n\tgetPreConfirmAction(ref: ILanguageModelToolConfirmationRef): ConfirmedReason | undefined {\n\t\treturn this._checkApproval(ref, true);\n\t}\n\n\tgetPostConfirmAction(ref: ILanguageModelToolConfirmationRef): ConfirmedReason | undefined {\n\t\treturn this._checkApproval(ref, false);\n\t}\n\n\tprivate _checkApproval(ref: ILanguageModelToolConfirmationRef, checkRequest: boolean): ConfirmedReason | undefined {\n\t\tconst urls = this._getURLS(ref.parameters);\n\t\tif (!urls || urls.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst approvedUrls = this._getApprovedUrls();\n\n\t\t// Check if all URLs are approved\n\t\tconst allApproved = urls.every(url => {\n\t\t\ttry {\n\t\t\t\tconst uri = URI.parse(url);\n\t\t\t\treturn isUrlApproved(uri, approvedUrls, checkRequest);\n\t\t\t} catch {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tif (allApproved) {\n\t\t\treturn {\n\t\t\t\ttype: ToolConfirmKind.Setting,\n\t\t\t\tid: ChatConfiguration.AutoApprovedUrls\n\t\t\t};\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetPreConfirmActions(ref: ILanguageModelToolConfirmationRef): ILanguageModelToolConfirmationActions[] {\n\t\treturn this._getConfirmActions(ref, true);\n\t}\n\n\tgetPostConfirmActions(ref: ILanguageModelToolConfirmationRef): ILanguageModelToolConfirmationActions[] {\n\t\treturn this._getConfirmActions(ref, false);\n\t}\n\n\tprivate _getConfirmActions(ref: ILanguageModelToolConfirmationRef, forRequest: boolean): ILanguageModelToolConfirmationActions[] {\n\t\tconst urls = this._getURLS(ref.parameters);\n\t\tif (!urls || urls.length === 0) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst actions: ILanguageModelToolConfirmationActions[] = [];\n\n\t\t// Get unique URLs (may have duplicates)\n\t\tconst uniqueUrls = Array.from(new Set(urls)).map(u => URI.parse(u));\n\n\t\t// For each URL, get its patterns\n\t\tconst urlPatterns = new ResourceMap<string[]>(uniqueUrls.map(u => [u, extractUrlPatterns(u)] as const));\n\n\t\t// If only one URL, show quick actions for specific patterns\n\t\tif (urlPatterns.size === 1) {\n\t\t\tconst uri = uniqueUrls[0];\n\t\t\tconst patterns = urlPatterns.get(uri)!;\n\n\t\t\t// Show top 2 most relevant patterns as quick actions\n\t\t\tconst topPatterns = patterns.slice(0, 2);\n\t\t\tfor (const pattern of topPatterns) {\n\t\t\t\tconst patternLabel = getPatternLabel(uri, pattern);\n\t\t\t\tactions.push({\n\t\t\t\t\tlabel: forRequest\n\t\t\t\t\t\t? localize('approveRequestTo', \"Allow requests to {0}\", patternLabel)\n\t\t\t\t\t\t: localize('approveResponseFrom', \"Allow responses from {0}\", patternLabel),\n\t\t\t\t\tselect: async () => {\n\t\t\t\t\t\tawait this._approvePattern(pattern, forRequest, !forRequest);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// \"More options\" action\n\t\t\tactions.push({\n\t\t\t\tlabel: localize('moreOptions', \"Allow requests to...\"),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tconst result = await this._showMoreOptions(ref, [{ uri, patterns }], forRequest);\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\t// Multiple URLs - show \"More options\" only\n\t\t\tactions.push({\n\t\t\t\tlabel: localize('moreOptionsMultiple', \"Configure URL Approvals...\"),\n\t\t\t\tselect: async () => {\n\t\t\t\t\tawait this._showMoreOptions(ref, [...urlPatterns].map(([uri, patterns]) => ({ uri, patterns })), forRequest);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn actions;\n\t}\n\n\tprivate async _showMoreOptions(ref: ILanguageModelToolConfirmationRef, urls: { uri: URI; patterns: string[] }[], forRequest: boolean): Promise<boolean> {\n\t\tinterface IPatternTreeItem extends IQuickTreeItem {\n\t\t\tpattern: string;\n\t\t\tapprovalType?: 'request' | 'response';\n\t\t\tchildren?: IPatternTreeItem[];\n\t\t}\n\n\t\treturn new Promise<boolean>((resolve) => {\n\t\t\tconst disposables = new DisposableStore();\n\t\t\tconst quickTree = disposables.add(this._quickInputService.createQuickTree<IPatternTreeItem>());\n\t\t\tquickTree.ignoreFocusOut = true;\n\t\t\tquickTree.sortByLabel = false;\n\t\t\tquickTree.placeholder = localize('selectApproval', \"Select URL pattern to approve\");\n\n\t\t\tconst treeItems: IPatternTreeItem[] = [];\n\t\t\tconst approvedUrls = this._getApprovedUrls();\n\n\t\t\tfor (const { uri, patterns } of urls) {\n\t\t\t\tfor (const pattern of patterns.slice().sort((a, b) => b.length - a.length)) {\n\t\t\t\t\tconst settings = approvedUrls[pattern];\n\t\t\t\t\tconst requestChecked = typeof settings === 'boolean' ? settings : (settings?.approveRequest ?? false);\n\t\t\t\t\tconst responseChecked = typeof settings === 'boolean' ? settings : (settings?.approveResponse ?? false);\n\n\t\t\t\t\ttreeItems.push({\n\t\t\t\t\t\tlabel: getPatternLabel(uri, pattern),\n\t\t\t\t\t\tpattern,\n\t\t\t\t\t\tchecked: requestChecked && responseChecked ? true : (!requestChecked && !responseChecked ? false : 'mixed'),\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: localize('allowRequestsCheckbox', \"Make requests without confirmation\"),\n\t\t\t\t\t\t\t\tpattern,\n\t\t\t\t\t\t\t\tapprovalType: 'request',\n\t\t\t\t\t\t\t\tchecked: requestChecked\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: localize('allowResponsesCheckbox', \"Allow responses without confirmation\"),\n\t\t\t\t\t\t\t\tpattern,\n\t\t\t\t\t\t\t\tapprovalType: 'response',\n\t\t\t\t\t\t\t\tchecked: responseChecked\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tquickTree.setItemTree(treeItems);\n\n\t\t\tconst updateApprovals = () => {\n\t\t\t\tconst current = { ...this._getApprovedUrls() };\n\t\t\t\tfor (const item of quickTree.itemTree) {\n\t\t\t\t\t// root-level items\n\n\t\t\t\t\tconst allowPre = item.children?.find(c => c.approvalType === 'request')?.checked;\n\t\t\t\t\tconst allowPost = item.children?.find(c => c.approvalType === 'response')?.checked;\n\n\t\t\t\t\tif (allowPost && allowPre) {\n\t\t\t\t\t\tcurrent[item.pattern] = true;\n\t\t\t\t\t} else if (!allowPost && !allowPre) {\n\t\t\t\t\t\tdelete current[item.pattern];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent[item.pattern] = {\n\t\t\t\t\t\t\tapproveRequest: !!allowPre || undefined,\n\t\t\t\t\t\t\tapproveResponse: !!allowPost || undefined,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this._configurationService.updateValue(ChatConfiguration.AutoApprovedUrls, current);\n\t\t\t};\n\n\t\t\tdisposables.add(quickTree.onDidAccept(async () => {\n\t\t\t\tquickTree.busy = true;\n\t\t\t\tawait updateApprovals();\n\t\t\t\tresolve(!!this._checkApproval(ref, forRequest));\n\t\t\t\tquickTree.hide();\n\t\t\t}));\n\n\t\t\tdisposables.add(quickTree.onDidHide(() => {\n\t\t\t\tupdateApprovals();\n\t\t\t\tdisposables.dispose();\n\t\t\t\tresolve(false);\n\t\t\t}));\n\n\t\t\tquickTree.show();\n\t\t});\n\t}\n\n\tprivate async _approvePattern(pattern: string, approveRequest: boolean, approveResponse: boolean): Promise<void> {\n\t\tconst approvedUrls = { ...this._getApprovedUrls() };\n\n\t\t// Create the approval settings\n\t\tlet value: boolean | IUrlApprovalSettings;\n\t\tif (approveRequest === approveResponse) {\n\t\t\tvalue = approveRequest;\n\t\t} else {\n\t\t\tvalue = { approveRequest, approveResponse };\n\t\t}\n\n\t\tapprovedUrls[pattern] = value;\n\n\t\tawait this._configurationService.updateValue(\n\t\t\tChatConfiguration.AutoApprovedUrls,\n\t\t\tapprovedUrls\n\t\t);\n\t}\n\n\tgetManageActions(): ILanguageModelToolConfirmationContributionQuickTreeItem[] {\n\t\tconst approvedUrls = { ...this._getApprovedUrls() };\n\t\tconst items: ILanguageModelToolConfirmationContributionQuickTreeItem[] = [];\n\n\t\tfor (const [pattern, settings] of Object.entries(approvedUrls)) {\n\t\t\tconst label = pattern;\n\t\t\tlet description: string;\n\n\t\t\tif (typeof settings === 'boolean') {\n\t\t\t\tdescription = settings\n\t\t\t\t\t? localize('approveAll', \"Approve all\")\n\t\t\t\t\t: localize('denyAll', \"Deny all\");\n\t\t\t} else {\n\t\t\t\tconst parts: string[] = [];\n\t\t\t\tif (settings.approveRequest) {\n\t\t\t\t\tparts.push(localize('requests', \"requests\"));\n\t\t\t\t}\n\t\t\t\tif (settings.approveResponse) {\n\t\t\t\t\tparts.push(localize('responses', \"responses\"));\n\t\t\t\t}\n\t\t\t\tdescription = parts.length > 0\n\t\t\t\t\t? localize('approves', \"Approves {0}\", parts.join(', '))\n\t\t\t\t\t: localize('noApprovals', \"No approvals\");\n\t\t\t}\n\n\t\t\tconst item: ILanguageModelToolConfirmationContributionQuickTreeItem = {\n\t\t\t\tlabel,\n\t\t\t\tdescription,\n\t\t\t\tbuttons: [trashButton],\n\t\t\t\tchecked: true,\n\t\t\t\tonDidChangeChecked: (checked) => {\n\t\t\t\t\tif (checked) {\n\t\t\t\t\t\tapprovedUrls[pattern] = settings;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete approvedUrls[pattern];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._configurationService.updateValue(ChatConfiguration.AutoApprovedUrls, approvedUrls);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\titems.push(item);\n\t\t}\n\n\t\titems.push({\n\t\t\tpickable: false,\n\t\t\tlabel: localize('moreOptionsManage', \"More Options...\"),\n\t\t\tdescription: localize('openSettings', \"Open settings\"),\n\t\t\tonDidOpen: () => {\n\t\t\t\tthis._preferencesService.openUserSettings({ query: ChatConfiguration.AutoApprovedUrls });\n\t\t\t}\n\t\t});\n\n\t\treturn items;\n\t}\n\n\tasync reset(): Promise<void> {\n\t\tawait this._configurationService.updateValue(\n\t\t\tChatConfiguration.AutoApprovedUrls,\n\t\t\t{}\n\t\t);\n\t}\n\n\tprivate _getApprovedUrls(): Readonly<Record<string, boolean | IUrlApprovalSettings>> {\n\t\treturn this._configurationService.getValue<Record<string, boolean | IUrlApprovalSettings>>(\n\t\t\tChatConfiguration.AutoApprovedUrls\n\t\t) || {};\n\t}\n}\n"]}