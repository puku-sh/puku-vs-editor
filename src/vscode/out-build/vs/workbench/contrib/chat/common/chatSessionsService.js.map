{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/common/chatSessionsService.ts","vs/workbench/contrib/chat/common/chatSessionsService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAShG,OAAO,EAAE,eAAe,EAAE,MAAM,4DAA4D,CAAC;AAO7F,MAAM,CAAN,IAAkB,iBAIjB;AAJD,WAAkB,iBAAiB;IAClC,6DAAU,CAAA;IACV,mEAAa,CAAA;IACb,qEAAc,CAAA;AACf,CAAC,EAJiB,iBAAiB,KAAjB,iBAAiB,QAIlC;AAsED;;GAEG;AACH,MAAM,CAAC,MAAM,oBAAoB,GAAG,OAAO,CAAC;AAsH5C,MAAM,CAAC,MAAM,oBAAoB,GAAG,eAAe,CAAuB,qBAAqB,CAAC,CAAC","file":"chatSessionsService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditableData } from '../../../common/views.js';\nimport { IChatAgentAttachmentCapabilities, IChatAgentRequest } from './chatAgents.js';\nimport { IChatEditingSession } from './chatEditingService.js';\nimport { IChatRequestVariableData } from './chatModel.js';\nimport { IChatProgress } from './chatService.js';\n\nexport const enum ChatSessionStatus {\n\tFailed = 0,\n\tCompleted = 1,\n\tInProgress = 2\n}\n\nexport interface IChatSessionCommandContribution {\n\tname: string;\n\tdescription: string;\n\twhen?: string;\n}\n\nexport interface IChatSessionProviderOptionItem {\n\tid: string;\n\tname: string;\n\tlocked?: boolean;\n\t// [key: string]: any;\n}\n\nexport interface IChatSessionProviderOptionGroup {\n\tid: string;\n\tname: string;\n\tdescription?: string;\n\titems: IChatSessionProviderOptionItem[];\n}\n\nexport interface IChatSessionsExtensionPoint {\n\treadonly type: string;\n\treadonly name: string;\n\treadonly displayName: string;\n\treadonly description: string;\n\treadonly when?: string;\n\treadonly icon?: string | { light: string; dark: string };\n\treadonly order?: number;\n\treadonly alternativeIds?: string[];\n\treadonly welcomeTitle?: string;\n\treadonly welcomeMessage?: string;\n\treadonly welcomeTips?: string;\n\treadonly inputPlaceholder?: string;\n\treadonly capabilities?: IChatAgentAttachmentCapabilities;\n\treadonly commands?: IChatSessionCommandContribution[];\n\treadonly canDelegate?: boolean;\n}\nexport interface IChatSessionItem {\n\tresource: URI;\n\tlabel: string;\n\ticonPath?: ThemeIcon;\n\tdescription?: string | IMarkdownString;\n\tstatus?: ChatSessionStatus;\n\ttooltip?: string | IMarkdownString;\n\ttiming: {\n\t\tstartTime: number;\n\t\tendTime?: number;\n\t};\n\tstatistics?: {\n\t\tfiles: number;\n\t\tinsertions: number;\n\t\tdeletions: number;\n\t};\n\tarchived?: boolean;\n}\n\nexport type IChatSessionHistoryItem = {\n\ttype: 'request';\n\tprompt: string;\n\tparticipant: string;\n\tcommand?: string;\n\tvariableData?: IChatRequestVariableData;\n} | {\n\ttype: 'response';\n\tparts: IChatProgress[];\n\tparticipant: string;\n};\n\n/**\n * The session type used for local agent chat sessions.\n */\nexport const localChatSessionType = 'local';\n\nexport interface IChatSession extends IDisposable {\n\treadonly onWillDispose: Event<void>;\n\n\treadonly sessionResource: URI;\n\n\treadonly history: readonly IChatSessionHistoryItem[];\n\n\t/**\n\t * Session options as key-value pairs. Keys correspond to option group IDs (e.g., 'models', 'subagents')\n\t * and values are either the selected option item IDs (string) or full option items (for locked state).\n\t */\n\treadonly options?: Record<string, string | IChatSessionProviderOptionItem>;\n\n\treadonly progressObs?: IObservable<IChatProgress[]>;\n\treadonly isCompleteObs?: IObservable<boolean>;\n\treadonly interruptActiveResponseCallback?: () => Promise<boolean>;\n\n\t/**\n\t * Editing session transferred from a previously-untitled chat session in `onDidCommitChatSessionItem`.\n\t */\n\tinitialEditingSession?: IChatEditingSession;\n\n\trequestHandler?: (\n\t\trequest: IChatAgentRequest,\n\t\tprogress: (progress: IChatProgress[]) => void,\n\t\thistory: any[], // TODO: Nail down types\n\t\ttoken: CancellationToken\n\t) => Promise<void>;\n}\n\nexport interface IChatSessionItemProvider {\n\treadonly chatSessionType: string;\n\treadonly onDidChangeChatSessionItems: Event<void>;\n\tprovideChatSessionItems(token: CancellationToken): Promise<IChatSessionItem[]>;\n\tprovideNewChatSessionItem?(options: {\n\t\trequest: IChatAgentRequest;\n\t\tmetadata?: any;\n\t}, token: CancellationToken): Promise<IChatSessionItem>;\n}\n\nexport interface IChatSessionContentProvider {\n\tprovideChatSessionContent(sessionResource: URI, token: CancellationToken): Promise<IChatSession>;\n}\n\nexport type SessionOptionsChangedCallback = (sessionResource: URI, updates: ReadonlyArray<{\n\toptionId: string;\n\tvalue: string;\n}>) => Promise<void>;\n\nexport interface IChatSessionsService {\n\treadonly _serviceBrand: undefined;\n\n\t// #region Chat session item provider support\n\treadonly onDidChangeItemsProviders: Event<IChatSessionItemProvider>;\n\treadonly onDidChangeSessionItems: Event<string>;\n\n\treadonly onDidChangeAvailability: Event<void>;\n\treadonly onDidChangeInProgress: Event<void>;\n\n\tregisterChatSessionItemProvider(provider: IChatSessionItemProvider): IDisposable;\n\tactivateChatSessionItemProvider(chatSessionType: string): Promise<IChatSessionItemProvider | undefined>;\n\tgetAllChatSessionItemProviders(): IChatSessionItemProvider[];\n\n\tgetAllChatSessionContributions(): IChatSessionsExtensionPoint[];\n\tgetIconForSessionType(chatSessionType: string): ThemeIcon | URI | undefined;\n\tgetWelcomeTitleForSessionType(chatSessionType: string): string | undefined;\n\tgetWelcomeMessageForSessionType(chatSessionType: string): string | undefined;\n\tgetInputPlaceholderForSessionType(chatSessionType: string): string | undefined;\n\n\t/**\n\t * Get the list of chat session items grouped by session type.\n\t */\n\tgetAllChatSessionItems(token: CancellationToken): Promise<Array<{ readonly chatSessionType: string; readonly items: IChatSessionItem[] }>>;\n\n\tgetNewChatSessionItem(chatSessionType: string, options: {\n\t\trequest: IChatAgentRequest;\n\t\tmetadata?: any;\n\t}, token: CancellationToken): Promise<IChatSessionItem>;\n\n\treportInProgress(chatSessionType: string, count: number): void;\n\tgetInProgress(): { displayName: string; count: number }[];\n\n\t// Notify providers about session items changes\n\tnotifySessionItemsChanged(chatSessionType: string): void;\n\t// #endregion\n\n\t// #region Content provider support\n\treadonly onDidChangeContentProviderSchemes: Event<{ readonly added: string[]; readonly removed: string[] }>;\n\n\tgetContentProviderSchemes(): string[];\n\n\tregisterChatSessionContentProvider(scheme: string, provider: IChatSessionContentProvider): IDisposable;\n\tcanResolveChatSession(sessionResource: URI): Promise<boolean>;\n\tgetOrCreateChatSession(sessionResource: URI, token: CancellationToken): Promise<IChatSession>;\n\n\thasAnySessionOptions(sessionResource: URI): boolean;\n\tgetSessionOption(sessionResource: URI, optionId: string): string | IChatSessionProviderOptionItem | undefined;\n\tsetSessionOption(sessionResource: URI, optionId: string, value: string | IChatSessionProviderOptionItem): boolean;\n\n\t/**\n\t * Get the capabilities for a specific session type\n\t */\n\tgetCapabilitiesForSessionType(chatSessionType: string): IChatAgentAttachmentCapabilities | undefined;\n\n\tgetOptionGroupsForSessionType(chatSessionType: string): IChatSessionProviderOptionGroup[] | undefined;\n\tsetOptionGroupsForSessionType(chatSessionType: string, handle: number, optionGroups?: IChatSessionProviderOptionGroup[]): void;\n\tsetOptionsChangeCallback(callback: SessionOptionsChangedCallback): void;\n\tnotifySessionOptionsChange(sessionResource: URI, updates: ReadonlyArray<{ optionId: string; value: string }>): Promise<void>;\n\n\t// Editable session support\n\tsetEditableSession(sessionResource: URI, data: IEditableData | null): Promise<void>;\n\tgetEditableData(sessionResource: URI): IEditableData | undefined;\n\tisEditable(sessionResource: URI): boolean;\n\t// #endregion\n}\n\nexport const IChatSessionsService = createDecorator<IChatSessionsService>('chatSessionsService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditableData } from '../../../common/views.js';\nimport { IChatAgentAttachmentCapabilities, IChatAgentRequest } from './chatAgents.js';\nimport { IChatEditingSession } from './chatEditingService.js';\nimport { IChatRequestVariableData } from './chatModel.js';\nimport { IChatProgress } from './chatService.js';\n\nexport const enum ChatSessionStatus {\n\tFailed = 0,\n\tCompleted = 1,\n\tInProgress = 2\n}\n\nexport interface IChatSessionCommandContribution {\n\tname: string;\n\tdescription: string;\n\twhen?: string;\n}\n\nexport interface IChatSessionProviderOptionItem {\n\tid: string;\n\tname: string;\n\tlocked?: boolean;\n\t// [key: string]: any;\n}\n\nexport interface IChatSessionProviderOptionGroup {\n\tid: string;\n\tname: string;\n\tdescription?: string;\n\titems: IChatSessionProviderOptionItem[];\n}\n\nexport interface IChatSessionsExtensionPoint {\n\treadonly type: string;\n\treadonly name: string;\n\treadonly displayName: string;\n\treadonly description: string;\n\treadonly when?: string;\n\treadonly icon?: string | { light: string; dark: string };\n\treadonly order?: number;\n\treadonly alternativeIds?: string[];\n\treadonly welcomeTitle?: string;\n\treadonly welcomeMessage?: string;\n\treadonly welcomeTips?: string;\n\treadonly inputPlaceholder?: string;\n\treadonly capabilities?: IChatAgentAttachmentCapabilities;\n\treadonly commands?: IChatSessionCommandContribution[];\n\treadonly canDelegate?: boolean;\n}\nexport interface IChatSessionItem {\n\tresource: URI;\n\tlabel: string;\n\ticonPath?: ThemeIcon;\n\tdescription?: string | IMarkdownString;\n\tstatus?: ChatSessionStatus;\n\ttooltip?: string | IMarkdownString;\n\ttiming: {\n\t\tstartTime: number;\n\t\tendTime?: number;\n\t};\n\tstatistics?: {\n\t\tfiles: number;\n\t\tinsertions: number;\n\t\tdeletions: number;\n\t};\n\tarchived?: boolean;\n}\n\nexport type IChatSessionHistoryItem = {\n\ttype: 'request';\n\tprompt: string;\n\tparticipant: string;\n\tcommand?: string;\n\tvariableData?: IChatRequestVariableData;\n} | {\n\ttype: 'response';\n\tparts: IChatProgress[];\n\tparticipant: string;\n};\n\n/**\n * The session type used for local agent chat sessions.\n */\nexport const localChatSessionType = 'local';\n\nexport interface IChatSession extends IDisposable {\n\treadonly onWillDispose: Event<void>;\n\n\treadonly sessionResource: URI;\n\n\treadonly history: readonly IChatSessionHistoryItem[];\n\n\t/**\n\t * Session options as key-value pairs. Keys correspond to option group IDs (e.g., 'models', 'subagents')\n\t * and values are either the selected option item IDs (string) or full option items (for locked state).\n\t */\n\treadonly options?: Record<string, string | IChatSessionProviderOptionItem>;\n\n\treadonly progressObs?: IObservable<IChatProgress[]>;\n\treadonly isCompleteObs?: IObservable<boolean>;\n\treadonly interruptActiveResponseCallback?: () => Promise<boolean>;\n\n\t/**\n\t * Editing session transferred from a previously-untitled chat session in `onDidCommitChatSessionItem`.\n\t */\n\tinitialEditingSession?: IChatEditingSession;\n\n\trequestHandler?: (\n\t\trequest: IChatAgentRequest,\n\t\tprogress: (progress: IChatProgress[]) => void,\n\t\thistory: any[], // TODO: Nail down types\n\t\ttoken: CancellationToken\n\t) => Promise<void>;\n}\n\nexport interface IChatSessionItemProvider {\n\treadonly chatSessionType: string;\n\treadonly onDidChangeChatSessionItems: Event<void>;\n\tprovideChatSessionItems(token: CancellationToken): Promise<IChatSessionItem[]>;\n\tprovideNewChatSessionItem?(options: {\n\t\trequest: IChatAgentRequest;\n\t\tmetadata?: any;\n\t}, token: CancellationToken): Promise<IChatSessionItem>;\n}\n\nexport interface IChatSessionContentProvider {\n\tprovideChatSessionContent(sessionResource: URI, token: CancellationToken): Promise<IChatSession>;\n}\n\nexport type SessionOptionsChangedCallback = (sessionResource: URI, updates: ReadonlyArray<{\n\toptionId: string;\n\tvalue: string;\n}>) => Promise<void>;\n\nexport interface IChatSessionsService {\n\treadonly _serviceBrand: undefined;\n\n\t// #region Chat session item provider support\n\treadonly onDidChangeItemsProviders: Event<IChatSessionItemProvider>;\n\treadonly onDidChangeSessionItems: Event<string>;\n\n\treadonly onDidChangeAvailability: Event<void>;\n\treadonly onDidChangeInProgress: Event<void>;\n\n\tregisterChatSessionItemProvider(provider: IChatSessionItemProvider): IDisposable;\n\tactivateChatSessionItemProvider(chatSessionType: string): Promise<IChatSessionItemProvider | undefined>;\n\tgetAllChatSessionItemProviders(): IChatSessionItemProvider[];\n\n\tgetAllChatSessionContributions(): IChatSessionsExtensionPoint[];\n\tgetIconForSessionType(chatSessionType: string): ThemeIcon | URI | undefined;\n\tgetWelcomeTitleForSessionType(chatSessionType: string): string | undefined;\n\tgetWelcomeMessageForSessionType(chatSessionType: string): string | undefined;\n\tgetInputPlaceholderForSessionType(chatSessionType: string): string | undefined;\n\n\t/**\n\t * Get the list of chat session items grouped by session type.\n\t */\n\tgetAllChatSessionItems(token: CancellationToken): Promise<Array<{ readonly chatSessionType: string; readonly items: IChatSessionItem[] }>>;\n\n\tgetNewChatSessionItem(chatSessionType: string, options: {\n\t\trequest: IChatAgentRequest;\n\t\tmetadata?: any;\n\t}, token: CancellationToken): Promise<IChatSessionItem>;\n\n\treportInProgress(chatSessionType: string, count: number): void;\n\tgetInProgress(): { displayName: string; count: number }[];\n\n\t// Notify providers about session items changes\n\tnotifySessionItemsChanged(chatSessionType: string): void;\n\t// #endregion\n\n\t// #region Content provider support\n\treadonly onDidChangeContentProviderSchemes: Event<{ readonly added: string[]; readonly removed: string[] }>;\n\n\tgetContentProviderSchemes(): string[];\n\n\tregisterChatSessionContentProvider(scheme: string, provider: IChatSessionContentProvider): IDisposable;\n\tcanResolveChatSession(sessionResource: URI): Promise<boolean>;\n\tgetOrCreateChatSession(sessionResource: URI, token: CancellationToken): Promise<IChatSession>;\n\n\thasAnySessionOptions(sessionResource: URI): boolean;\n\tgetSessionOption(sessionResource: URI, optionId: string): string | IChatSessionProviderOptionItem | undefined;\n\tsetSessionOption(sessionResource: URI, optionId: string, value: string | IChatSessionProviderOptionItem): boolean;\n\n\t/**\n\t * Get the capabilities for a specific session type\n\t */\n\tgetCapabilitiesForSessionType(chatSessionType: string): IChatAgentAttachmentCapabilities | undefined;\n\n\tgetOptionGroupsForSessionType(chatSessionType: string): IChatSessionProviderOptionGroup[] | undefined;\n\tsetOptionGroupsForSessionType(chatSessionType: string, handle: number, optionGroups?: IChatSessionProviderOptionGroup[]): void;\n\tsetOptionsChangeCallback(callback: SessionOptionsChangedCallback): void;\n\tnotifySessionOptionsChange(sessionResource: URI, updates: ReadonlyArray<{ optionId: string; value: string }>): Promise<void>;\n\n\t// Editable session support\n\tsetEditableSession(sessionResource: URI, data: IEditableData | null): Promise<void>;\n\tgetEditableData(sessionResource: URI): IEditableData | undefined;\n\tisEditable(sessionResource: URI): boolean;\n\t// #endregion\n}\n\nexport const IChatSessionsService = createDecorator<IChatSessionsService>('chatSessionsService');\n"]}