{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/common/promptSyntax/languageProviders/PromptHeaderDefinitionProvider.ts","vs/workbench/contrib/chat/common/promptSyntax/languageProviders/PromptHeaderDefinitionProvider.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAIhG,OAAO,EAAE,KAAK,EAAE,MAAM,+CAA+C,CAAC;AAGtE,OAAO,EAAE,gBAAgB,EAAE,MAAM,oBAAoB,CAAC;AACtD,OAAO,EAAE,2BAA2B,EAAE,MAAM,mBAAmB,CAAC;AAChE,OAAO,EAAE,sBAAsB,EAAE,MAAM,wBAAwB,CAAC;AAChE,OAAO,EAAE,eAAe,EAAE,MAAM,8BAA8B,CAAC;AAExD,IAAM,8BAA8B,GAApC,MAAM,8BAA8B;IAM1C,YACkB,cAAgD,EAC/C,eAAkD;QADlC,mBAAc,GAAd,cAAc,CAAiB;QAC9B,oBAAe,GAAf,eAAe,CAAkB;QAPrE;;WAEG;QACa,sBAAiB,GAAW,gCAAgC,CAAC;IAM7E,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,KAAiB,EAAE,QAAkB,EAAE,KAAwB;QACtF,MAAM,UAAU,GAAG,2BAA2B,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC,CAAC;QACtE,IAAI,CAAC,UAAU,EAAE,CAAC;YACjB,iEAAiE;YACjE,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QACjE,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC;QAChC,IAAI,CAAC,MAAM,EAAE,CAAC;YACb,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,SAAS,GAAG,MAAM,CAAC,YAAY,CAAC,sBAAsB,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,YAAY,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QACxH,IAAI,SAAS,IAAI,SAAS,CAAC,KAAK,CAAC,IAAI,KAAK,QAAQ,IAAI,SAAS,CAAC,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,CAAC;YAClG,MAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACzE,IAAI,KAAK,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC;gBACxB,OAAO;oBACN,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE;oBACpB,KAAK,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;iBAC5B,CAAC;YACH,CAAC;QACF,CAAC;QACD,OAAO,SAAS,CAAC;IAClB,CAAC;CAED,CAAA;AAtCY,8BAA8B;IAOxC,WAAA,eAAe,CAAA;IACf,WAAA,gBAAgB,CAAA;GARN,8BAA8B,CAsC1C","file":"PromptHeaderDefinitionProvider.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../../base/common/cancellation.js';\nimport { Position } from '../../../../../../editor/common/core/position.js';\nimport { Range } from '../../../../../../editor/common/core/range.js';\nimport { Definition, DefinitionProvider } from '../../../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../../../editor/common/model.js';\nimport { IChatModeService } from '../../chatModes.js';\nimport { getPromptsTypeForLanguageId } from '../promptTypes.js';\nimport { PromptHeaderAttributes } from '../promptFileParser.js';\nimport { IPromptsService } from '../service/promptsService.js';\n\nexport class PromptHeaderDefinitionProvider implements DefinitionProvider {\n\t/**\n\t * Debug display name for this provider.\n\t */\n\tpublic readonly _debugDisplayName: string = 'PromptHeaderDefinitionProvider';\n\n\tconstructor(\n\t\t@IPromptsService private readonly promptsService: IPromptsService,\n\t\t@IChatModeService private readonly chatModeService: IChatModeService,\n\t) {\n\t}\n\n\tasync provideDefinition(model: ITextModel, position: Position, token: CancellationToken): Promise<Definition | undefined> {\n\t\tconst promptType = getPromptsTypeForLanguageId(model.getLanguageId());\n\t\tif (!promptType) {\n\t\t\t// if the model is not a prompt, we don't provide any definitions\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst promptAST = this.promptsService.getParsedPromptFile(model);\n\t\tconst header = promptAST.header;\n\t\tif (!header) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst agentAttr = header.getAttribute(PromptHeaderAttributes.agent) ?? header.getAttribute(PromptHeaderAttributes.mode);\n\t\tif (agentAttr && agentAttr.value.type === 'string' && agentAttr.range.containsPosition(position)) {\n\t\t\tconst agent = this.chatModeService.findModeByName(agentAttr.value.value);\n\t\t\tif (agent && agent.uri) {\n\t\t\t\treturn {\n\t\t\t\t\turi: agent.uri.get(),\n\t\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../../base/common/cancellation.js';\nimport { Position } from '../../../../../../editor/common/core/position.js';\nimport { Range } from '../../../../../../editor/common/core/range.js';\nimport { Definition, DefinitionProvider } from '../../../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../../../editor/common/model.js';\nimport { IChatModeService } from '../../chatModes.js';\nimport { getPromptsTypeForLanguageId } from '../promptTypes.js';\nimport { PromptHeaderAttributes } from '../promptFileParser.js';\nimport { IPromptsService } from '../service/promptsService.js';\n\nexport class PromptHeaderDefinitionProvider implements DefinitionProvider {\n\t/**\n\t * Debug display name for this provider.\n\t */\n\tpublic readonly _debugDisplayName: string = 'PromptHeaderDefinitionProvider';\n\n\tconstructor(\n\t\t@IPromptsService private readonly promptsService: IPromptsService,\n\t\t@IChatModeService private readonly chatModeService: IChatModeService,\n\t) {\n\t}\n\n\tasync provideDefinition(model: ITextModel, position: Position, token: CancellationToken): Promise<Definition | undefined> {\n\t\tconst promptType = getPromptsTypeForLanguageId(model.getLanguageId());\n\t\tif (!promptType) {\n\t\t\t// if the model is not a prompt, we don't provide any definitions\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst promptAST = this.promptsService.getParsedPromptFile(model);\n\t\tconst header = promptAST.header;\n\t\tif (!header) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst agentAttr = header.getAttribute(PromptHeaderAttributes.agent) ?? header.getAttribute(PromptHeaderAttributes.mode);\n\t\tif (agentAttr && agentAttr.value.type === 'string' && agentAttr.range.containsPosition(position)) {\n\t\t\tconst agent = this.chatModeService.findModeByName(agentAttr.value.value);\n\t\t\tif (agent && agent.uri) {\n\t\t\t\treturn {\n\t\t\t\t\turi: agent.uri.get(),\n\t\t\t\t\trange: new Range(1, 1, 1, 1)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n}\n"]}