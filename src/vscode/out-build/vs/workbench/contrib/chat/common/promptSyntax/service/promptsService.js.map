{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/chat/common/promptSyntax/service/promptsService.ts","vs/workbench/contrib/chat/common/promptSyntax/service/promptsService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAQhG,OAAO,EAAE,eAAe,EAAE,MAAM,kEAAkE,CAAC;AAMnG;;GAEG;AACH,MAAM,CAAC,MAAM,eAAe,GAAG,eAAe,CAAkB,iBAAiB,CAAC,CAAC;AAEnF;;GAEG;AACH,MAAM,CAAN,IAAY,cAIX;AAJD,WAAY,cAAc;IACzB,iCAAe,CAAA;IACf,+BAAa,CAAA;IACb,yCAAuB,CAAA;AACxB,CAAC,EAJW,cAAc,KAAd,cAAc,QAIzB","file":"promptsService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../../base/common/cancellation.js';\nimport { Event } from '../../../../../../base/common/event.js';\nimport { IDisposable } from '../../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../../editor/common/model.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../../../../../platform/extensions/common/extensions.js';\nimport { createDecorator } from '../../../../../../platform/instantiation/common/instantiation.js';\nimport { IChatModeInstructions, IVariableReference } from '../../chatModes.js';\nimport { PromptsType } from '../promptTypes.js';\nimport { IHandOff, ParsedPromptFile } from '../promptFileParser.js';\nimport { ResourceSet } from '../../../../../../base/common/map.js';\n\n/**\n * Provides prompt services.\n */\nexport const IPromptsService = createDecorator<IPromptsService>('IPromptsService');\n\n/**\n * Where the prompt is stored.\n */\nexport enum PromptsStorage {\n\tlocal = 'local',\n\tuser = 'user',\n\textension = 'extension'\n}\n\n/**\n * Represents a prompt path with its type.\n * This is used for both prompt files and prompt source folders.\n */\nexport type IPromptPath = IExtensionPromptPath | ILocalPromptPath | IUserPromptPath;\n\n\nexport interface IPromptPathBase {\n\t/**\n\t * URI of the prompt.\n\t */\n\treadonly uri: URI;\n\n\t/**\n\t * Storage of the prompt.\n\t */\n\treadonly storage: PromptsStorage;\n\n\t/**\n\t * Type of the prompt (e.g. 'prompt' or 'instructions').\n\t */\n\treadonly type: PromptsType;\n\n\t/**\n\t * Identifier of the contributing extension (only when storage === PromptsStorage.extension).\n\t */\n\treadonly extension?: IExtensionDescription;\n\n\treadonly name?: string;\n\n\treadonly description?: string;\n}\n\nexport interface IExtensionPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.extension;\n\treadonly extension: IExtensionDescription;\n\treadonly name: string;\n\treadonly description: string;\n}\nexport interface ILocalPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.local;\n}\nexport interface IUserPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.user;\n}\n\nexport type IAgentSource = {\n\treadonly storage: PromptsStorage.extension;\n\treadonly extensionId: ExtensionIdentifier;\n} | {\n\treadonly storage: PromptsStorage.local | PromptsStorage.user;\n};\n\nexport interface ICustomAgent {\n\t/**\n\t * URI of a custom agent file.\n\t */\n\treadonly uri: URI;\n\n\t/**\n\t * Name of the custom agent as used in prompt files or contexts\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Description of the agent\n\t */\n\treadonly description?: string;\n\n\t/**\n\t * Tools metadata in the prompt header.\n\t */\n\treadonly tools?: readonly string[];\n\n\t/**\n\t * Model metadata in the prompt header.\n\t */\n\treadonly model?: string;\n\n\t/**\n\t * Argument hint metadata in the prompt header that describes what inputs the agent expects or supports.\n\t */\n\treadonly argumentHint?: string;\n\n\t/**\n\t * Target metadata in the prompt header.\n\t */\n\treadonly target?: string;\n\n\t/**\n\t * Contents of the custom agent file body and other agent instructions.\n\t */\n\treadonly agentInstructions: IChatModeInstructions;\n\n\t/**\n\t * Hand-offs defined in the custom agent file.\n\t */\n\treadonly handOffs?: readonly IHandOff[];\n\n\t/**\n\t * Where the agent was loaded from.\n\t */\n\treadonly source: IAgentSource;\n}\n\nexport interface IAgentInstructions {\n\treadonly content: string;\n\treadonly toolReferences: readonly IVariableReference[];\n\treadonly metadata?: Record<string, boolean | string | number>;\n}\n\nexport interface IChatPromptSlashCommand {\n\treadonly name: string;\n\treadonly description: string | undefined;\n\treadonly argumentHint: string | undefined;\n\treadonly promptPath: IPromptPath;\n\treadonly parsedPromptFile: ParsedPromptFile;\n}\n\nexport interface IClaudeSkill {\n\treadonly uri: URI;\n\treadonly type: 'personal' | 'project';\n\treadonly name: string;\n\treadonly description: string | undefined;\n}\n\n/**\n * Provides prompt services.\n */\nexport interface IPromptsService extends IDisposable {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * The parsed prompt file for the provided text model.\n\t * @param textModel Returns the parsed prompt file.\n\t */\n\tgetParsedPromptFile(textModel: ITextModel): ParsedPromptFile;\n\n\t/**\n\t * List all available prompt files.\n\t */\n\tlistPromptFiles(type: PromptsType, token: CancellationToken): Promise<readonly IPromptPath[]>;\n\n\t/**\n\t * List all available prompt files.\n\t */\n\tlistPromptFilesForStorage(type: PromptsType, storage: PromptsStorage, token: CancellationToken): Promise<readonly IPromptPath[]>;\n\n\t/**\n\t * Get a list of prompt source folders based on the provided prompt type.\n\t */\n\tgetSourceFolders(type: PromptsType): readonly IPromptPath[];\n\n\t/**\n\t * Validates if the provided command name is a valid prompt slash command.\n\t */\n\tisValidSlashCommandName(name: string): boolean;\n\n\t/**\n\t * Gets the prompt file for a slash command.\n\t */\n\tresolvePromptSlashCommand(command: string, token: CancellationToken): Promise<IChatPromptSlashCommand | undefined>;\n\n\t/**\n\t * Event that is triggered when the slash command to ParsedPromptFile cache is updated.\n\t * Event handlers can use {@link resolvePromptSlashCommand} to retrieve the latest data.\n\t */\n\treadonly onDidChangeSlashCommands: Event<void>;\n\n\t/**\n\t * Returns a prompt command if the command name is valid.\n\t */\n\tgetPromptSlashCommands(token: CancellationToken): Promise<readonly IChatPromptSlashCommand[]>;\n\n\t/**\n\t * Returns the prompt command name for the given URI.\n\t */\n\tgetPromptSlashCommandName(uri: URI, token: CancellationToken): Promise<string>;\n\n\t/**\n\t * Event that is triggered when the list of custom agents changes.\n\t */\n\treadonly onDidChangeCustomAgents: Event<void>;\n\n\t/**\n\t * Finds all available custom agents\n\t */\n\tgetCustomAgents(token: CancellationToken): Promise<readonly ICustomAgent[]>;\n\n\t/**\n\t * Parses the provided URI\n\t * @param uris\n\t */\n\tparseNew(uri: URI, token: CancellationToken): Promise<ParsedPromptFile>;\n\n\t/**\n\t * Internal: register a contributed file. Returns a disposable that removes the contribution.\n\t * Not intended for extension authors; used by contribution point handler.\n\t */\n\tregisterContributedFile(type: PromptsType, name: string, description: string, uri: URI, extension: IExtensionDescription): IDisposable;\n\n\n\tgetPromptLocationLabel(promptPath: IPromptPath): string;\n\n\t/**\n\t * Gets list of all AGENTS.md files in the workspace.\n\t */\n\tfindAgentMDsInWorkspace(token: CancellationToken): Promise<URI[]>;\n\n\t/**\n\t * Gets list of AGENTS.md files.\n\t * @param includeNested Whether to include AGENTS.md files from subfolders, or only from the root.\n\t */\n\tlistAgentMDs(token: CancellationToken, includeNested: boolean): Promise<URI[]>;\n\n\t/**\n\t * Gets list of .github/copilot-instructions.md files.\n\t */\n\tlistCopilotInstructionsMDs(token: CancellationToken): Promise<URI[]>;\n\n\t/**\n\t * For a chat mode file URI, return the name of the agent file that it should use.\n\t * @param oldURI\n\t */\n\tgetAgentFileURIFromModeFile(oldURI: URI): URI | undefined;\n\n\t/**\n\t * Returns the list of disabled prompt file URIs for a given type. By default no prompt files are disabled.\n\t */\n\tgetDisabledPromptFiles(type: PromptsType): ResourceSet;\n\n\t/**\n\t * Persists the set of disabled prompt file URIs for the given type.\n\t */\n\tsetDisabledPromptFiles(type: PromptsType, uris: ResourceSet): void;\n\n\t/**\n\t * Gets list of claude skills files.\n\t */\n\tfindClaudeSkills(token: CancellationToken): Promise<IClaudeSkill[] | undefined>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../../base/common/cancellation.js';\nimport { Event } from '../../../../../../base/common/event.js';\nimport { IDisposable } from '../../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { ITextModel } from '../../../../../../editor/common/model.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../../../../../platform/extensions/common/extensions.js';\nimport { createDecorator } from '../../../../../../platform/instantiation/common/instantiation.js';\nimport { IChatModeInstructions, IVariableReference } from '../../chatModes.js';\nimport { PromptsType } from '../promptTypes.js';\nimport { IHandOff, ParsedPromptFile } from '../promptFileParser.js';\nimport { ResourceSet } from '../../../../../../base/common/map.js';\n\n/**\n * Provides prompt services.\n */\nexport const IPromptsService = createDecorator<IPromptsService>('IPromptsService');\n\n/**\n * Where the prompt is stored.\n */\nexport enum PromptsStorage {\n\tlocal = 'local',\n\tuser = 'user',\n\textension = 'extension'\n}\n\n/**\n * Represents a prompt path with its type.\n * This is used for both prompt files and prompt source folders.\n */\nexport type IPromptPath = IExtensionPromptPath | ILocalPromptPath | IUserPromptPath;\n\n\nexport interface IPromptPathBase {\n\t/**\n\t * URI of the prompt.\n\t */\n\treadonly uri: URI;\n\n\t/**\n\t * Storage of the prompt.\n\t */\n\treadonly storage: PromptsStorage;\n\n\t/**\n\t * Type of the prompt (e.g. 'prompt' or 'instructions').\n\t */\n\treadonly type: PromptsType;\n\n\t/**\n\t * Identifier of the contributing extension (only when storage === PromptsStorage.extension).\n\t */\n\treadonly extension?: IExtensionDescription;\n\n\treadonly name?: string;\n\n\treadonly description?: string;\n}\n\nexport interface IExtensionPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.extension;\n\treadonly extension: IExtensionDescription;\n\treadonly name: string;\n\treadonly description: string;\n}\nexport interface ILocalPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.local;\n}\nexport interface IUserPromptPath extends IPromptPathBase {\n\treadonly storage: PromptsStorage.user;\n}\n\nexport type IAgentSource = {\n\treadonly storage: PromptsStorage.extension;\n\treadonly extensionId: ExtensionIdentifier;\n} | {\n\treadonly storage: PromptsStorage.local | PromptsStorage.user;\n};\n\nexport interface ICustomAgent {\n\t/**\n\t * URI of a custom agent file.\n\t */\n\treadonly uri: URI;\n\n\t/**\n\t * Name of the custom agent as used in prompt files or contexts\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Description of the agent\n\t */\n\treadonly description?: string;\n\n\t/**\n\t * Tools metadata in the prompt header.\n\t */\n\treadonly tools?: readonly string[];\n\n\t/**\n\t * Model metadata in the prompt header.\n\t */\n\treadonly model?: string;\n\n\t/**\n\t * Argument hint metadata in the prompt header that describes what inputs the agent expects or supports.\n\t */\n\treadonly argumentHint?: string;\n\n\t/**\n\t * Target metadata in the prompt header.\n\t */\n\treadonly target?: string;\n\n\t/**\n\t * Contents of the custom agent file body and other agent instructions.\n\t */\n\treadonly agentInstructions: IChatModeInstructions;\n\n\t/**\n\t * Hand-offs defined in the custom agent file.\n\t */\n\treadonly handOffs?: readonly IHandOff[];\n\n\t/**\n\t * Where the agent was loaded from.\n\t */\n\treadonly source: IAgentSource;\n}\n\nexport interface IAgentInstructions {\n\treadonly content: string;\n\treadonly toolReferences: readonly IVariableReference[];\n\treadonly metadata?: Record<string, boolean | string | number>;\n}\n\nexport interface IChatPromptSlashCommand {\n\treadonly name: string;\n\treadonly description: string | undefined;\n\treadonly argumentHint: string | undefined;\n\treadonly promptPath: IPromptPath;\n\treadonly parsedPromptFile: ParsedPromptFile;\n}\n\nexport interface IClaudeSkill {\n\treadonly uri: URI;\n\treadonly type: 'personal' | 'project';\n\treadonly name: string;\n\treadonly description: string | undefined;\n}\n\n/**\n * Provides prompt services.\n */\nexport interface IPromptsService extends IDisposable {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * The parsed prompt file for the provided text model.\n\t * @param textModel Returns the parsed prompt file.\n\t */\n\tgetParsedPromptFile(textModel: ITextModel): ParsedPromptFile;\n\n\t/**\n\t * List all available prompt files.\n\t */\n\tlistPromptFiles(type: PromptsType, token: CancellationToken): Promise<readonly IPromptPath[]>;\n\n\t/**\n\t * List all available prompt files.\n\t */\n\tlistPromptFilesForStorage(type: PromptsType, storage: PromptsStorage, token: CancellationToken): Promise<readonly IPromptPath[]>;\n\n\t/**\n\t * Get a list of prompt source folders based on the provided prompt type.\n\t */\n\tgetSourceFolders(type: PromptsType): readonly IPromptPath[];\n\n\t/**\n\t * Validates if the provided command name is a valid prompt slash command.\n\t */\n\tisValidSlashCommandName(name: string): boolean;\n\n\t/**\n\t * Gets the prompt file for a slash command.\n\t */\n\tresolvePromptSlashCommand(command: string, token: CancellationToken): Promise<IChatPromptSlashCommand | undefined>;\n\n\t/**\n\t * Event that is triggered when the slash command to ParsedPromptFile cache is updated.\n\t * Event handlers can use {@link resolvePromptSlashCommand} to retrieve the latest data.\n\t */\n\treadonly onDidChangeSlashCommands: Event<void>;\n\n\t/**\n\t * Returns a prompt command if the command name is valid.\n\t */\n\tgetPromptSlashCommands(token: CancellationToken): Promise<readonly IChatPromptSlashCommand[]>;\n\n\t/**\n\t * Returns the prompt command name for the given URI.\n\t */\n\tgetPromptSlashCommandName(uri: URI, token: CancellationToken): Promise<string>;\n\n\t/**\n\t * Event that is triggered when the list of custom agents changes.\n\t */\n\treadonly onDidChangeCustomAgents: Event<void>;\n\n\t/**\n\t * Finds all available custom agents\n\t */\n\tgetCustomAgents(token: CancellationToken): Promise<readonly ICustomAgent[]>;\n\n\t/**\n\t * Parses the provided URI\n\t * @param uris\n\t */\n\tparseNew(uri: URI, token: CancellationToken): Promise<ParsedPromptFile>;\n\n\t/**\n\t * Internal: register a contributed file. Returns a disposable that removes the contribution.\n\t * Not intended for extension authors; used by contribution point handler.\n\t */\n\tregisterContributedFile(type: PromptsType, name: string, description: string, uri: URI, extension: IExtensionDescription): IDisposable;\n\n\n\tgetPromptLocationLabel(promptPath: IPromptPath): string;\n\n\t/**\n\t * Gets list of all AGENTS.md files in the workspace.\n\t */\n\tfindAgentMDsInWorkspace(token: CancellationToken): Promise<URI[]>;\n\n\t/**\n\t * Gets list of AGENTS.md files.\n\t * @param includeNested Whether to include AGENTS.md files from subfolders, or only from the root.\n\t */\n\tlistAgentMDs(token: CancellationToken, includeNested: boolean): Promise<URI[]>;\n\n\t/**\n\t * Gets list of .github/copilot-instructions.md files.\n\t */\n\tlistCopilotInstructionsMDs(token: CancellationToken): Promise<URI[]>;\n\n\t/**\n\t * For a chat mode file URI, return the name of the agent file that it should use.\n\t * @param oldURI\n\t */\n\tgetAgentFileURIFromModeFile(oldURI: URI): URI | undefined;\n\n\t/**\n\t * Returns the list of disabled prompt file URIs for a given type. By default no prompt files are disabled.\n\t */\n\tgetDisabledPromptFiles(type: PromptsType): ResourceSet;\n\n\t/**\n\t * Persists the set of disabled prompt file URIs for the given type.\n\t */\n\tsetDisabledPromptFiles(type: PromptsType, uris: ResourceSet): void;\n\n\t/**\n\t * Gets list of claude skills files.\n\t */\n\tfindClaudeSkills(token: CancellationToken): Promise<IClaudeSkill[] | undefined>;\n}\n"]}