{"version":3,"sources":["vs/workbench/contrib/preferences/browser/keybindingsEditorContribution.ts"],"names":[],"mappings":"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","file":"keybindingsEditorContribution.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { registerEditorContribution, EditorContributionInstantiation } from '../../../../editor/browser/editorExtensions.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { SnippetController2 } from '../../../../editor/contrib/snippet/browser/snippetController2.js';\nimport { SmartSnippetInserter } from '../common/smartSnippetInserter.js';\nimport { DefineKeybindingOverlayWidget } from './keybindingWidgets.js';\nimport { parseTree, Node } from '../../../../base/common/json.js';\nimport { WindowsNativeResolvedKeybinding } from '../../../services/keybinding/common/windowsKeyboardMapper.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeColor } from '../../../../base/common/themables.js';\nimport { overviewRulerInfo, overviewRulerError } from '../../../../editor/common/core/editorColorRegistry.js';\nimport { IModelDeltaDecoration, ITextModel, TrackedRangeStickiness, OverviewRulerLane } from '../../../../editor/common/model.js';\nimport { KeybindingParser } from '../../../../base/common/keybindingParser.js';\nimport { assertReturnsDefined } from '../../../../base/common/types.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { IUserDataProfileService } from '../../../services/userDataProfile/common/userDataProfile.js';\nimport { DEFINE_KEYBINDING_EDITOR_CONTRIB_ID, IDefineKeybindingEditorContribution } from '../../../services/preferences/common/preferences.js';\nimport { IEditorDecorationsCollection } from '../../../../editor/common/editorCommon.js';\n\nconst NLS_KB_LAYOUT_ERROR_MESSAGE = nls.localize('defineKeybinding.kbLayoutErrorMessage', \"You won't be able to produce this key combination under your current keyboard layout.\");\n\nclass DefineKeybindingEditorContribution extends Disposable implements IDefineKeybindingEditorContribution {\n\n\tprivate readonly _keybindingDecorationRenderer = this._register(new MutableDisposable<KeybindingEditorDecorationsRenderer>());\n\n\tprivate readonly _defineWidget: DefineKeybindingOverlayWidget;\n\n\tconstructor(\n\t\tprivate _editor: ICodeEditor,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IUserDataProfileService private readonly _userDataProfileService: IUserDataProfileService\n\t) {\n\t\tsuper();\n\n\t\tthis._defineWidget = this._register(this._instantiationService.createInstance(DefineKeybindingOverlayWidget, this._editor));\n\t\tthis._register(this._editor.onDidChangeModel(e => this._update()));\n\t\tthis._update();\n\t}\n\n\tprivate _update(): void {\n\t\tthis._keybindingDecorationRenderer.value = isInterestingEditorModel(this._editor, this._userDataProfileService)\n\t\t\t// Decorations are shown for the default keybindings.json **and** for the user keybindings.json\n\t\t\t? this._instantiationService.createInstance(KeybindingEditorDecorationsRenderer, this._editor)\n\t\t\t: undefined;\n\t}\n\n\tshowDefineKeybindingWidget(): void {\n\t\tif (isInterestingEditorModel(this._editor, this._userDataProfileService)) {\n\t\t\tthis._defineWidget.start().then(keybinding => this._onAccepted(keybinding));\n\t\t}\n\t}\n\n\tprivate _onAccepted(keybinding: string | null): void {\n\t\tthis._editor.focus();\n\t\tif (keybinding && this._editor.hasModel()) {\n\t\t\tconst regexp = new RegExp(/\\\\/g);\n\t\t\tconst backslash = regexp.test(keybinding);\n\t\t\tif (backslash) {\n\t\t\t\tkeybinding = keybinding.slice(0, -1) + '\\\\\\\\';\n\t\t\t}\n\t\t\tlet snippetText = [\n\t\t\t\t'{',\n\t\t\t\t'\\t\"key\": ' + JSON.stringify(keybinding) + ',',\n\t\t\t\t'\\t\"command\": \"${1:commandId}\",',\n\t\t\t\t'\\t\"when\": \"${2:editorTextFocus}\"',\n\t\t\t\t'}$0'\n\t\t\t].join('\\n');\n\n\t\t\tconst smartInsertInfo = SmartSnippetInserter.insertSnippet(this._editor.getModel(), this._editor.getPosition());\n\t\t\tsnippetText = smartInsertInfo.prepend + snippetText + smartInsertInfo.append;\n\t\t\tthis._editor.setPosition(smartInsertInfo.position);\n\n\t\t\tSnippetController2.get(this._editor)?.insert(snippetText, { overwriteBefore: 0, overwriteAfter: 0 });\n\t\t}\n\t}\n}\n\nexport class KeybindingEditorDecorationsRenderer extends Disposable {\n\n\tprivate _updateDecorations: RunOnceScheduler;\n\tprivate readonly _dec: IEditorDecorationsCollection;\n\n\tconstructor(\n\t\tprivate _editor: ICodeEditor,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\t\tthis._dec = this._editor.createDecorationsCollection();\n\n\t\tthis._updateDecorations = this._register(new RunOnceScheduler(() => this._updateDecorationsNow(), 500));\n\n\t\tconst model = assertReturnsDefined(this._editor.getModel());\n\t\tthis._register(model.onDidChangeContent(() => this._updateDecorations.schedule()));\n\t\tthis._register(this._keybindingService.onDidUpdateKeybindings(() => this._updateDecorations.schedule()));\n\t\tthis._register({\n\t\t\tdispose: () => {\n\t\t\t\tthis._dec.clear();\n\t\t\t\tthis._updateDecorations.cancel();\n\t\t\t}\n\t\t});\n\t\tthis._updateDecorations.schedule();\n\t}\n\n\tprivate _updateDecorationsNow(): void {\n\t\tconst model = assertReturnsDefined(this._editor.getModel());\n\n\t\tconst newDecorations: IModelDeltaDecoration[] = [];\n\n\t\tconst root = parseTree(model.getValue());\n\t\tif (root && Array.isArray(root.children)) {\n\t\t\tfor (let i = 0, len = root.children.length; i < len; i++) {\n\t\t\t\tconst entry = root.children[i];\n\t\t\t\tconst dec = this._getDecorationForEntry(model, entry);\n\t\t\t\tif (dec !== null) {\n\t\t\t\t\tnewDecorations.push(dec);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._dec.set(newDecorations);\n\t}\n\n\tprivate _getDecorationForEntry(model: ITextModel, entry: Node): IModelDeltaDecoration | null {\n\t\tif (!Array.isArray(entry.children)) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = 0, len = entry.children.length; i < len; i++) {\n\t\t\tconst prop = entry.children[i];\n\t\t\tif (prop.type !== 'property') {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!Array.isArray(prop.children) || prop.children.length !== 2) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst key = prop.children[0];\n\t\t\tif (key.value !== 'key') {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst value = prop.children[1];\n\t\t\tif (value.type !== 'string') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst resolvedKeybindings = this._keybindingService.resolveUserBinding(value.value);\n\t\t\tif (resolvedKeybindings.length === 0) {\n\t\t\t\treturn this._createDecoration(true, null, null, model, value);\n\t\t\t}\n\t\t\tconst resolvedKeybinding = resolvedKeybindings[0];\n\t\t\tlet usLabel: string | null = null;\n\t\t\tif (resolvedKeybinding instanceof WindowsNativeResolvedKeybinding) {\n\t\t\t\tusLabel = resolvedKeybinding.getUSLabel();\n\t\t\t}\n\t\t\tif (!resolvedKeybinding.isWYSIWYG()) {\n\t\t\t\tconst uiLabel = resolvedKeybinding.getLabel();\n\t\t\t\tif (typeof uiLabel === 'string' && value.value.toLowerCase() === uiLabel.toLowerCase()) {\n\t\t\t\t\t// coincidentally, this is actually WYSIWYG\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn this._createDecoration(false, resolvedKeybinding.getLabel(), usLabel, model, value);\n\t\t\t}\n\t\t\tif (/abnt_|oem_/.test(value.value)) {\n\t\t\t\treturn this._createDecoration(false, resolvedKeybinding.getLabel(), usLabel, model, value);\n\t\t\t}\n\t\t\tconst expectedUserSettingsLabel = resolvedKeybinding.getUserSettingsLabel();\n\t\t\tif (typeof expectedUserSettingsLabel === 'string' && !KeybindingEditorDecorationsRenderer._userSettingsFuzzyEquals(value.value, expectedUserSettingsLabel)) {\n\t\t\t\treturn this._createDecoration(false, resolvedKeybinding.getLabel(), usLabel, model, value);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic _userSettingsFuzzyEquals(a: string, b: string): boolean {\n\t\ta = a.trim().toLowerCase();\n\t\tb = b.trim().toLowerCase();\n\n\t\tif (a === b) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst aKeybinding = KeybindingParser.parseKeybinding(a);\n\t\tconst bKeybinding = KeybindingParser.parseKeybinding(b);\n\t\tif (aKeybinding === null && bKeybinding === null) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!aKeybinding || !bKeybinding) {\n\t\t\treturn false;\n\t\t}\n\t\treturn aKeybinding.equals(bKeybinding);\n\t}\n\n\tprivate _createDecoration(isError: boolean, uiLabel: string | null, usLabel: string | null, model: ITextModel, keyNode: Node): IModelDeltaDecoration {\n\t\tlet msg: MarkdownString;\n\t\tlet className: string;\n\t\tlet overviewRulerColor: ThemeColor;\n\n\t\tif (isError) {\n\t\t\t// this is the error case\n\t\t\tmsg = new MarkdownString().appendText(NLS_KB_LAYOUT_ERROR_MESSAGE);\n\t\t\tclassName = 'keybindingError';\n\t\t\toverviewRulerColor = themeColorFromId(overviewRulerError);\n\t\t} else {\n\t\t\t// this is the info case\n\t\t\tif (usLabel && uiLabel !== usLabel) {\n\t\t\t\tmsg = new MarkdownString(\n\t\t\t\t\tnls.localize({\n\t\t\t\t\t\tkey: 'defineKeybinding.kbLayoutLocalAndUSMessage',\n\t\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\t'Please translate maintaining the stars (*) around the placeholders such that they will be rendered in bold.',\n\t\t\t\t\t\t\t'The placeholders will contain a keyboard combination e.g. Ctrl+Shift+/'\n\t\t\t\t\t\t]\n\t\t\t\t\t}, \"**{0}** for your current keyboard layout (**{1}** for US standard).\", uiLabel, usLabel)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tmsg = new MarkdownString(\n\t\t\t\t\tnls.localize({\n\t\t\t\t\t\tkey: 'defineKeybinding.kbLayoutLocalMessage',\n\t\t\t\t\t\tcomment: [\n\t\t\t\t\t\t\t'Please translate maintaining the stars (*) around the placeholder such that it will be rendered in bold.',\n\t\t\t\t\t\t\t'The placeholder will contain a keyboard combination e.g. Ctrl+Shift+/'\n\t\t\t\t\t\t]\n\t\t\t\t\t}, \"**{0}** for your current keyboard layout.\", uiLabel)\n\t\t\t\t);\n\t\t\t}\n\t\t\tclassName = 'keybindingInfo';\n\t\t\toverviewRulerColor = themeColorFromId(overviewRulerInfo);\n\t\t}\n\n\t\tconst startPosition = model.getPositionAt(keyNode.offset);\n\t\tconst endPosition = model.getPositionAt(keyNode.offset + keyNode.length);\n\t\tconst range = new Range(\n\t\t\tstartPosition.lineNumber, startPosition.column,\n\t\t\tendPosition.lineNumber, endPosition.column\n\t\t);\n\n\t\t// icon + highlight + message decoration\n\t\treturn {\n\t\t\trange: range,\n\t\t\toptions: {\n\t\t\t\tdescription: 'keybindings-widget',\n\t\t\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\t\t\tclassName: className,\n\t\t\t\thoverMessage: msg,\n\t\t\t\toverviewRuler: {\n\t\t\t\t\tcolor: overviewRulerColor,\n\t\t\t\t\tposition: OverviewRulerLane.Right\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n}\n\nfunction isInterestingEditorModel(editor: ICodeEditor, userDataProfileService: IUserDataProfileService): boolean {\n\tconst model = editor.getModel();\n\tif (!model) {\n\t\treturn false;\n\t}\n\treturn isEqual(model.uri, userDataProfileService.currentProfile.keybindingsResource);\n}\n\nregisterEditorContribution(DEFINE_KEYBINDING_EDITOR_CONTRIB_ID, DefineKeybindingEditorContribution, EditorContributionInstantiation.AfterFirstRender);\n"]}