{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/preferences/common/smartSnippetInserter.ts","vs/workbench/contrib/preferences/common/smartSnippetInserter.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAe,aAAa,IAAI,iBAAiB,EAAgC,MAAM,iCAAiC,CAAC;AAChI,OAAO,EAAE,QAAQ,EAAE,MAAM,4CAA4C,CAAC;AACtE,OAAO,EAAE,KAAK,EAAE,MAAM,yCAAyC,CAAC;AAShE,MAAM,OAAO,oBAAoB;IAExB,MAAM,CAAC,YAAY,CAAC,OAAoB;QAE/C,OAAO,OAAO,CAAC,IAAI,EAAE,gCAAuB,EAAE,CAAC;YAC9C,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC;YAEhC,IAAI,IAAI,0CAAkC,EAAE,CAAC;gBAC5C,OAAO,IAAI,CAAC;YACb,CAAC;QACF,CAAC;QAED,OAAO,KAAK,CAAC;IACd,CAAC;IAEO,MAAM,CAAC,gBAAgB,CAAC,KAAiB,EAAE,MAAc;QAChE,IAAI,gBAAgB,GAAG,CAAC,CAAC;QACzB,MAAM,SAAS,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC;QACxC,MAAM,SAAS,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;QACvC,KAAK,IAAI,UAAU,GAAG,CAAC,EAAE,UAAU,IAAI,SAAS,EAAE,UAAU,EAAE,EAAE,CAAC;YAChE,MAAM,eAAe,GAAG,KAAK,CAAC,aAAa,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC;YACpE,MAAM,eAAe,GAAG,gBAAgB,GAAG,eAAe,CAAC;YAE3D,IAAI,eAAe,GAAG,MAAM,EAAE,CAAC;gBAC9B,OAAO,IAAI,QAAQ,CAClB,UAAU,EACV,MAAM,GAAG,gBAAgB,GAAG,CAAC,CAC7B,CAAC;YACH,CAAC;YACD,gBAAgB,GAAG,eAAe,CAAC;QACpC,CAAC;QACD,OAAO,IAAI,QAAQ,CAClB,SAAS,EACT,KAAK,CAAC,gBAAgB,CAAC,SAAS,CAAC,CACjC,CAAC;IACH,CAAC;IAED,MAAM,CAAC,aAAa,CAAC,KAAiB,EAAE,SAAmB;QAE1D,MAAM,eAAe,GAAG,KAAK,CAAC,qBAAqB,CAAC,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;QAE7G,qHAAqH;QACrH,IAAK,KAIJ;QAJD,WAAK,KAAK;YACT,uCAAW,CAAA;YACX,iDAAgB,CAAA;YAChB,mDAAiB,CAAA;QAClB,CAAC,EAJI,KAAK,KAAL,KAAK,QAIT;QACD,IAAI,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC;QACjC,IAAI,YAAY,GAAG,CAAC,CAAC,CAAC;QACtB,IAAI,cAAc,GAAG,KAAK,CAAC,OAAO,CAAC;QAEnC,MAAM,OAAO,GAAG,iBAAiB,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;QACpD,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,IAAI,QAAQ,GAAG,CAAC,CAAC;QAEjB,MAAM,gBAAgB,GAAG,CAAC,GAAW,EAAE,KAAY,EAAE,EAAE;YACtD,IAAI,KAAK,KAAK,KAAK,CAAC,OAAO,IAAI,UAAU,KAAK,CAAC,IAAI,QAAQ,KAAK,CAAC,EAAE,CAAC;gBACnE,YAAY,GAAG,KAAK,CAAC;gBACrB,YAAY,GAAG,GAAG,CAAC;gBACnB,cAAc,GAAG,KAAK,CAAC;YACxB,CAAC;iBAAM,CAAC;gBACP,IAAI,YAAY,KAAK,KAAK,CAAC,OAAO,EAAE,CAAC;oBACpC,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC;oBAC7B,YAAY,GAAG,OAAO,CAAC,cAAc,EAAE,CAAC;gBACzC,CAAC;YACF,CAAC;QACF,CAAC,CAAC;QAEF,OAAO,OAAO,CAAC,IAAI,EAAE,gCAAuB,EAAE,CAAC;YAC9C,MAAM,UAAU,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;YACzC,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC;YAEhC,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,QAAQ,IAAI,EAAE,CAAC;gBACd;oBACC,QAAQ,GAAG,IAAI,CAAC;oBAChB,UAAU,EAAE,CAAC;oBACb,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;oBAClD,MAAM;gBACP;oBACC,QAAQ,GAAG,IAAI,CAAC;oBAChB,UAAU,EAAE,CAAC;oBACb,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;oBAC5C,MAAM;gBACP;oBACC,QAAQ,GAAG,IAAI,CAAC;oBAChB,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;oBAClD,MAAM;gBACP;oBACC,QAAQ,GAAG,IAAI,CAAC;oBAChB,QAAQ,EAAE,CAAC;oBACX,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;oBAC5C,MAAM;gBACP;oBACC,QAAQ,GAAG,IAAI,CAAC;oBAChB,QAAQ,EAAE,CAAC;oBACX,gBAAgB,CAAC,UAAU,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;oBACjD,MAAM;gBACP,oCAA2B;gBAC3B;oBACC,QAAQ,GAAG,IAAI,CAAC;YAClB,CAAC;YAED,IAAI,UAAU,IAAI,eAAe,IAAI,CAAC,YAAY,KAAK,KAAK,CAAC,OAAO,IAAI,YAAY,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC;gBAC9F,IAAI,cAAsB,CAAC;gBAC3B,IAAI,WAAkB,CAAC;gBAEvB,IAAI,YAAY,KAAK,KAAK,CAAC,OAAO,EAAE,CAAC;oBACpC,cAAc,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC,CAAC;oBACpE,WAAW,GAAG,YAAY,CAAC;gBAC5B,CAAC;qBAAM,CAAC;oBACP,cAAc,GAAG,YAAY,CAAC;oBAC9B,WAAW,GAAG,cAAc,CAAC;gBAC9B,CAAC;gBAED,IAAI,WAAoB,KAAK,KAAK,CAAC,YAAY,EAAE,CAAC;oBACjD,OAAO;wBACN,QAAQ,EAAE,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,cAAc,CAAC;wBACtD,OAAO,EAAE,GAAG;wBACZ,MAAM,EAAE,EAAE;qBACV,CAAC;gBACH,CAAC;qBAAM,CAAC;oBACP,OAAO,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;oBACpC,OAAO;wBACN,QAAQ,EAAE,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,cAAc,CAAC;wBACtD,OAAO,EAAE,EAAE;wBACX,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;qBAC7C,CAAC;gBACH,CAAC;YACF,CAAC;QACF,CAAC;QAED,2BAA2B;QAC3B,MAAM,cAAc,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;QAC5C,OAAO;YACN,QAAQ,EAAE,IAAI,QAAQ,CAAC,cAAc,EAAE,KAAK,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;YAC9E,OAAO,EAAE,KAAK;YACd,MAAM,EAAE,GAAG;SACX,CAAC;IACH,CAAC;CACD","file":"smartSnippetInserter.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { JSONScanner, createScanner as createJSONScanner, SyntaxKind as JSONSyntaxKind } from '../../../../base/common/json.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\n\nexport interface InsertSnippetResult {\n\tposition: Position;\n\tprepend: string;\n\tappend: string;\n}\n\nexport class SmartSnippetInserter {\n\n\tprivate static hasOpenBrace(scanner: JSONScanner): boolean {\n\n\t\twhile (scanner.scan() !== JSONSyntaxKind.EOF) {\n\t\t\tconst kind = scanner.getToken();\n\n\t\t\tif (kind === JSONSyntaxKind.OpenBraceToken) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate static offsetToPosition(model: ITextModel, offset: number): Position {\n\t\tlet offsetBeforeLine = 0;\n\t\tconst eolLength = model.getEOL().length;\n\t\tconst lineCount = model.getLineCount();\n\t\tfor (let lineNumber = 1; lineNumber <= lineCount; lineNumber++) {\n\t\t\tconst lineTotalLength = model.getLineLength(lineNumber) + eolLength;\n\t\t\tconst offsetAfterLine = offsetBeforeLine + lineTotalLength;\n\n\t\t\tif (offsetAfterLine > offset) {\n\t\t\t\treturn new Position(\n\t\t\t\t\tlineNumber,\n\t\t\t\t\toffset - offsetBeforeLine + 1\n\t\t\t\t);\n\t\t\t}\n\t\t\toffsetBeforeLine = offsetAfterLine;\n\t\t}\n\t\treturn new Position(\n\t\t\tlineCount,\n\t\t\tmodel.getLineMaxColumn(lineCount)\n\t\t);\n\t}\n\n\tstatic insertSnippet(model: ITextModel, _position: Position): InsertSnippetResult {\n\n\t\tconst desiredPosition = model.getValueLengthInRange(new Range(1, 1, _position.lineNumber, _position.column));\n\n\t\t// <INVALID> [ <BEFORE_OBJECT> { <INVALID> } <AFTER_OBJECT>, <BEFORE_OBJECT> { <INVALID> } <AFTER_OBJECT> ] <INVALID>\n\t\tenum State {\n\t\t\tINVALID = 0,\n\t\t\tAFTER_OBJECT = 1,\n\t\t\tBEFORE_OBJECT = 2,\n\t\t}\n\t\tlet currentState = State.INVALID;\n\t\tlet lastValidPos = -1;\n\t\tlet lastValidState = State.INVALID;\n\n\t\tconst scanner = createJSONScanner(model.getValue());\n\t\tlet arrayLevel = 0;\n\t\tlet objLevel = 0;\n\n\t\tconst checkRangeStatus = (pos: number, state: State) => {\n\t\t\tif (state !== State.INVALID && arrayLevel === 1 && objLevel === 0) {\n\t\t\t\tcurrentState = state;\n\t\t\t\tlastValidPos = pos;\n\t\t\t\tlastValidState = state;\n\t\t\t} else {\n\t\t\t\tif (currentState !== State.INVALID) {\n\t\t\t\t\tcurrentState = State.INVALID;\n\t\t\t\t\tlastValidPos = scanner.getTokenOffset();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\twhile (scanner.scan() !== JSONSyntaxKind.EOF) {\n\t\t\tconst currentPos = scanner.getPosition();\n\t\t\tconst kind = scanner.getToken();\n\n\t\t\tlet goodKind = false;\n\t\t\tswitch (kind) {\n\t\t\t\tcase JSONSyntaxKind.OpenBracketToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tarrayLevel++;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.BEFORE_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CloseBracketToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tarrayLevel--;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.INVALID);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CommaToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.BEFORE_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.OpenBraceToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tobjLevel++;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.INVALID);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CloseBraceToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tobjLevel--;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.AFTER_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.Trivia:\n\t\t\t\tcase JSONSyntaxKind.LineBreakTrivia:\n\t\t\t\t\tgoodKind = true;\n\t\t\t}\n\n\t\t\tif (currentPos >= desiredPosition && (currentState !== State.INVALID || lastValidPos !== -1)) {\n\t\t\t\tlet acceptPosition: number;\n\t\t\t\tlet acceptState: State;\n\n\t\t\t\tif (currentState !== State.INVALID) {\n\t\t\t\t\tacceptPosition = (goodKind ? currentPos : scanner.getTokenOffset());\n\t\t\t\t\tacceptState = currentState;\n\t\t\t\t} else {\n\t\t\t\t\tacceptPosition = lastValidPos;\n\t\t\t\t\tacceptState = lastValidState;\n\t\t\t\t}\n\n\t\t\t\tif (acceptState as State === State.AFTER_OBJECT) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tposition: this.offsetToPosition(model, acceptPosition),\n\t\t\t\t\t\tprepend: ',',\n\t\t\t\t\t\tappend: ''\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tscanner.setPosition(acceptPosition);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tposition: this.offsetToPosition(model, acceptPosition),\n\t\t\t\t\t\tprepend: '',\n\t\t\t\t\t\tappend: this.hasOpenBrace(scanner) ? ',' : ''\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// no valid position found!\n\t\tconst modelLineCount = model.getLineCount();\n\t\treturn {\n\t\t\tposition: new Position(modelLineCount, model.getLineMaxColumn(modelLineCount)),\n\t\t\tprepend: '\\n[',\n\t\t\tappend: ']'\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { JSONScanner, createScanner as createJSONScanner, SyntaxKind as JSONSyntaxKind } from '../../../../base/common/json.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\n\nexport interface InsertSnippetResult {\n\tposition: Position;\n\tprepend: string;\n\tappend: string;\n}\n\nexport class SmartSnippetInserter {\n\n\tprivate static hasOpenBrace(scanner: JSONScanner): boolean {\n\n\t\twhile (scanner.scan() !== JSONSyntaxKind.EOF) {\n\t\t\tconst kind = scanner.getToken();\n\n\t\t\tif (kind === JSONSyntaxKind.OpenBraceToken) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate static offsetToPosition(model: ITextModel, offset: number): Position {\n\t\tlet offsetBeforeLine = 0;\n\t\tconst eolLength = model.getEOL().length;\n\t\tconst lineCount = model.getLineCount();\n\t\tfor (let lineNumber = 1; lineNumber <= lineCount; lineNumber++) {\n\t\t\tconst lineTotalLength = model.getLineLength(lineNumber) + eolLength;\n\t\t\tconst offsetAfterLine = offsetBeforeLine + lineTotalLength;\n\n\t\t\tif (offsetAfterLine > offset) {\n\t\t\t\treturn new Position(\n\t\t\t\t\tlineNumber,\n\t\t\t\t\toffset - offsetBeforeLine + 1\n\t\t\t\t);\n\t\t\t}\n\t\t\toffsetBeforeLine = offsetAfterLine;\n\t\t}\n\t\treturn new Position(\n\t\t\tlineCount,\n\t\t\tmodel.getLineMaxColumn(lineCount)\n\t\t);\n\t}\n\n\tstatic insertSnippet(model: ITextModel, _position: Position): InsertSnippetResult {\n\n\t\tconst desiredPosition = model.getValueLengthInRange(new Range(1, 1, _position.lineNumber, _position.column));\n\n\t\t// <INVALID> [ <BEFORE_OBJECT> { <INVALID> } <AFTER_OBJECT>, <BEFORE_OBJECT> { <INVALID> } <AFTER_OBJECT> ] <INVALID>\n\t\tenum State {\n\t\t\tINVALID = 0,\n\t\t\tAFTER_OBJECT = 1,\n\t\t\tBEFORE_OBJECT = 2,\n\t\t}\n\t\tlet currentState = State.INVALID;\n\t\tlet lastValidPos = -1;\n\t\tlet lastValidState = State.INVALID;\n\n\t\tconst scanner = createJSONScanner(model.getValue());\n\t\tlet arrayLevel = 0;\n\t\tlet objLevel = 0;\n\n\t\tconst checkRangeStatus = (pos: number, state: State) => {\n\t\t\tif (state !== State.INVALID && arrayLevel === 1 && objLevel === 0) {\n\t\t\t\tcurrentState = state;\n\t\t\t\tlastValidPos = pos;\n\t\t\t\tlastValidState = state;\n\t\t\t} else {\n\t\t\t\tif (currentState !== State.INVALID) {\n\t\t\t\t\tcurrentState = State.INVALID;\n\t\t\t\t\tlastValidPos = scanner.getTokenOffset();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\twhile (scanner.scan() !== JSONSyntaxKind.EOF) {\n\t\t\tconst currentPos = scanner.getPosition();\n\t\t\tconst kind = scanner.getToken();\n\n\t\t\tlet goodKind = false;\n\t\t\tswitch (kind) {\n\t\t\t\tcase JSONSyntaxKind.OpenBracketToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tarrayLevel++;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.BEFORE_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CloseBracketToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tarrayLevel--;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.INVALID);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CommaToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.BEFORE_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.OpenBraceToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tobjLevel++;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.INVALID);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.CloseBraceToken:\n\t\t\t\t\tgoodKind = true;\n\t\t\t\t\tobjLevel--;\n\t\t\t\t\tcheckRangeStatus(currentPos, State.AFTER_OBJECT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase JSONSyntaxKind.Trivia:\n\t\t\t\tcase JSONSyntaxKind.LineBreakTrivia:\n\t\t\t\t\tgoodKind = true;\n\t\t\t}\n\n\t\t\tif (currentPos >= desiredPosition && (currentState !== State.INVALID || lastValidPos !== -1)) {\n\t\t\t\tlet acceptPosition: number;\n\t\t\t\tlet acceptState: State;\n\n\t\t\t\tif (currentState !== State.INVALID) {\n\t\t\t\t\tacceptPosition = (goodKind ? currentPos : scanner.getTokenOffset());\n\t\t\t\t\tacceptState = currentState;\n\t\t\t\t} else {\n\t\t\t\t\tacceptPosition = lastValidPos;\n\t\t\t\t\tacceptState = lastValidState;\n\t\t\t\t}\n\n\t\t\t\tif (acceptState as State === State.AFTER_OBJECT) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tposition: this.offsetToPosition(model, acceptPosition),\n\t\t\t\t\t\tprepend: ',',\n\t\t\t\t\t\tappend: ''\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tscanner.setPosition(acceptPosition);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tposition: this.offsetToPosition(model, acceptPosition),\n\t\t\t\t\t\tprepend: '',\n\t\t\t\t\t\tappend: this.hasOpenBrace(scanner) ? ',' : ''\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// no valid position found!\n\t\tconst modelLineCount = model.getLineCount();\n\t\treturn {\n\t\t\tposition: new Position(modelLineCount, model.getLineMaxColumn(modelLineCount)),\n\t\t\tprepend: '\\n[',\n\t\t\tappend: ']'\n\t\t};\n\t}\n}\n"]}