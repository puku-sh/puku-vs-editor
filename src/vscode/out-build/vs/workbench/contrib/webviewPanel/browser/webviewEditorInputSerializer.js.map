{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/webviewPanel/browser/webviewEditorInputSerializer.ts","vs/workbench/contrib/webviewPanel/browser/webviewEditorInputSerializer.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,GAAG,EAAiB,MAAM,gCAAgC,CAAC;AACpE,OAAO,EAAE,mBAAmB,EAAE,MAAM,sDAAsD,CAAC;AAI3F,OAAO,EAAgB,YAAY,EAAE,MAAM,yBAAyB,CAAC;AACrE,OAAO,EAAE,wBAAwB,EAAE,MAAM,8BAA8B,CAAC;AAmCjE,IAAM,4BAA4B,GAAlC,MAAM,4BAA4B;aAEjB,OAAE,GAAG,YAAY,CAAC,MAAhB,AAAsB,CAAC;IAEhD,YAC4C,wBAAkD;QAAlD,6BAAwB,GAAxB,wBAAwB,CAA0B;IAC1F,CAAC;IAEE,YAAY,CAAC,KAAmB;QACtC,OAAO,IAAI,CAAC,wBAAwB,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAC3D,CAAC;IAEM,SAAS,CAAC,KAAmB;QACnC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC;YAC/B,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAChC,IAAI,CAAC;YACJ,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC7B,CAAC;QAAC,MAAM,CAAC;YACR,OAAO,SAAS,CAAC;QAClB,CAAC;IACF,CAAC;IAEM,WAAW,CACjB,qBAA4C,EAC5C,qBAA6B;QAE7B,MAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAC9D,OAAO,IAAI,CAAC,wBAAwB,CAAC,kBAAkB,CAAC;YACvD,eAAe,EAAE;gBAChB,gBAAgB,EAAE,IAAI,CAAC,UAAU;gBACjC,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,OAAO,EAAE,IAAI,CAAC,cAAc;gBAC5B,cAAc,EAAE,IAAI,CAAC,cAAc;gBACnC,SAAS,EAAE,IAAI,CAAC,SAAS;aACzB;YACD,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,KAAK,EAAE,IAAI,CAAC,KAAK;SACjB,CAAC,CAAC;IACJ,CAAC;IAES,QAAQ,CAAC,IAAuB;QACzC,OAAO;YACN,GAAG,IAAI;YACP,SAAS,EAAE,iCAAiC,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,CAAC;YACtF,QAAQ,EAAE,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC;YACvC,KAAK,EAAE,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC;YAC9B,cAAc,EAAE,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC;YACnD,cAAc,EAAE,4BAA4B,CAAC,IAAI,CAAC,OAAO,CAAC;SAC1D,CAAC;IACH,CAAC;IAES,MAAM,CAAC,KAAmB;QACnC,OAAO;YACN,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM;YAC5B,QAAQ,EAAE,KAAK,CAAC,QAAQ;YACxB,UAAU,EAAE,KAAK,CAAC,UAAU;YAC5B,KAAK,EAAE,KAAK,CAAC,OAAO,EAAE;YACtB,OAAO,EAAE,EAAE,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,KAAK,CAAC,OAAO,CAAC,cAAc,EAAE;YACtE,iBAAiB,EAAE,KAAK,CAAC,SAAS,EAAE,QAAQ;YAC5C,WAAW,EAAE,KAAK,CAAC,SAAS,EAAE,EAAE,CAAC,KAAK;YACtC,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,KAAK;YAC1B,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,SAAS;YAClG,KAAK,EAAE,KAAK,CAAC,KAAK;SAClB,CAAC;IACH,CAAC;;AAvEW,4BAA4B;IAKtC,WAAA,wBAAwB,CAAA;GALd,4BAA4B,CAwExC;;AAED,MAAM,UAAU,iCAAiC,CAChD,WAA+B,EAC/B,iBAA4C;IAE5C,IAAI,CAAC,WAAW,EAAE,CAAC;QAClB,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,MAAM,QAAQ,GAAG,SAAS,CAAC,iBAAiB,CAAC,CAAC;IAC9C,IAAI,CAAC,QAAQ,EAAE,CAAC;QACf,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,OAAO;QACN,EAAE,EAAE,IAAI,mBAAmB,CAAC,WAAW,CAAC;QACxC,QAAQ;KACR,CAAC;AACH,CAAC;AAED,SAAS,cAAc,CAAC,IAAoC;IAC3D,IAAI,CAAC,IAAI,EAAE,CAAC;QACX,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,MAAM,KAAK,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACpC,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAClC,OAAO,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;AACpD,CAAC;AAID,SAAS,SAAS,CAAC,IAAwC;IAC1D,IAAI,CAAC,IAAI,EAAE,CAAC;QACX,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,IAAI,CAAC;QACJ,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,CAAC;YAC9B,OAAO,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACxB,CAAC;QACD,OAAO,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvB,CAAC;IAAC,MAAM,CAAC;QACR,OAAO,SAAS,CAAC;IAClB,CAAC;AACF,CAAC;AAED,SAAS,WAAW,CAAC,KAA0B;IAC9C,OAAO,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC;AACtD,CAAC;AAED,MAAM,UAAU,qBAAqB,CAAC,OAAiC;IACtE,OAAO,OAAO,CAAC;AAChB,CAAC;AAED,MAAM,UAAU,4BAA4B,CAAC,OAAiC;IAC7E,OAAO;QACN,GAAG,OAAO;QACV,kBAAkB,EAAE,OAAO,CAAC,kBAAkB,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;KAC1E,CAAC;AACH,CAAC","file":"webviewEditorInputSerializer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorSerializer } from '../../../common/editor.js';\nimport { WebviewContentOptions, WebviewExtensionDescription, WebviewOptions } from '../../webview/browser/webview.js';\nimport { WebviewIcons, WebviewInput } from './webviewEditorInput.js';\nimport { IWebviewWorkbenchService } from './webviewWorkbenchService.js';\n\nexport type SerializedWebviewOptions = WebviewOptions & WebviewContentOptions;\n\ninterface SerializedIconPath {\n\tlight: string | UriComponents;\n\tdark: string | UriComponents;\n}\n\nexport interface SerializedWebview {\n\treadonly origin: string | undefined;\n\treadonly viewType: string;\n\treadonly providedId: string | undefined;\n\treadonly title: string;\n\treadonly options: SerializedWebviewOptions;\n\treadonly extensionLocation: UriComponents | undefined;\n\treadonly extensionId: string | undefined;\n\treadonly state: any;\n\treadonly iconPath: SerializedIconPath | undefined;\n\treadonly group?: number;\n}\n\nexport interface DeserializedWebview {\n\treadonly origin: string | undefined;\n\treadonly viewType: string;\n\treadonly providedId: string | undefined;\n\treadonly title: string;\n\treadonly webviewOptions: WebviewOptions;\n\treadonly contentOptions: WebviewContentOptions;\n\treadonly extension: WebviewExtensionDescription | undefined;\n\treadonly state: any;\n\treadonly iconPath: WebviewIcons | undefined;\n\treadonly group?: number;\n}\n\nexport class WebviewEditorInputSerializer implements IEditorSerializer {\n\n\tpublic static readonly ID = WebviewInput.typeId;\n\n\tpublic constructor(\n\t\t@IWebviewWorkbenchService private readonly _webviewWorkbenchService: IWebviewWorkbenchService\n\t) { }\n\n\tpublic canSerialize(input: WebviewInput): boolean {\n\t\treturn this._webviewWorkbenchService.shouldPersist(input);\n\t}\n\n\tpublic serialize(input: WebviewInput): string | undefined {\n\t\tif (!this.canSerialize(input)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst data = this.toJson(input);\n\t\ttry {\n\t\t\treturn JSON.stringify(data);\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tpublic deserialize(\n\t\t_instantiationService: IInstantiationService,\n\t\tserializedEditorInput: string\n\t): WebviewInput {\n\t\tconst data = this.fromJson(JSON.parse(serializedEditorInput));\n\t\treturn this._webviewWorkbenchService.openRevivedWebview({\n\t\t\twebviewInitInfo: {\n\t\t\t\tprovidedViewType: data.providedId,\n\t\t\t\torigin: data.origin,\n\t\t\t\ttitle: data.title,\n\t\t\t\toptions: data.webviewOptions,\n\t\t\t\tcontentOptions: data.contentOptions,\n\t\t\t\textension: data.extension,\n\t\t\t},\n\t\t\tviewType: data.viewType,\n\t\t\ttitle: data.title,\n\t\t\ticonPath: data.iconPath,\n\t\t\tstate: data.state,\n\t\t\tgroup: data.group\n\t\t});\n\t}\n\n\tprotected fromJson(data: SerializedWebview): DeserializedWebview {\n\t\treturn {\n\t\t\t...data,\n\t\t\textension: reviveWebviewExtensionDescription(data.extensionId, data.extensionLocation),\n\t\t\ticonPath: reviveIconPath(data.iconPath),\n\t\t\tstate: reviveState(data.state),\n\t\t\twebviewOptions: restoreWebviewOptions(data.options),\n\t\t\tcontentOptions: restoreWebviewContentOptions(data.options),\n\t\t};\n\t}\n\n\tprotected toJson(input: WebviewInput): SerializedWebview {\n\t\treturn {\n\t\t\torigin: input.webview.origin,\n\t\t\tviewType: input.viewType,\n\t\t\tprovidedId: input.providerId,\n\t\t\ttitle: input.getName(),\n\t\t\toptions: { ...input.webview.options, ...input.webview.contentOptions },\n\t\t\textensionLocation: input.extension?.location,\n\t\t\textensionId: input.extension?.id.value,\n\t\t\tstate: input.webview.state,\n\t\t\ticonPath: input.iconPath ? { light: input.iconPath.light, dark: input.iconPath.dark, } : undefined,\n\t\t\tgroup: input.group\n\t\t};\n\t}\n}\n\nexport function reviveWebviewExtensionDescription(\n\textensionId: string | undefined,\n\textensionLocation: UriComponents | undefined,\n): WebviewExtensionDescription | undefined {\n\tif (!extensionId) {\n\t\treturn undefined;\n\t}\n\n\tconst location = reviveUri(extensionLocation);\n\tif (!location) {\n\t\treturn undefined;\n\t}\n\n\treturn {\n\t\tid: new ExtensionIdentifier(extensionId),\n\t\tlocation,\n\t};\n}\n\nfunction reviveIconPath(data: SerializedIconPath | undefined) {\n\tif (!data) {\n\t\treturn undefined;\n\t}\n\n\tconst light = reviveUri(data.light);\n\tconst dark = reviveUri(data.dark);\n\treturn light && dark ? { light, dark } : undefined;\n}\n\nfunction reviveUri(data: string | UriComponents): URI;\nfunction reviveUri(data: string | UriComponents | undefined): URI | undefined;\nfunction reviveUri(data: string | UriComponents | undefined): URI | undefined {\n\tif (!data) {\n\t\treturn undefined;\n\t}\n\n\ttry {\n\t\tif (typeof data === 'string') {\n\t\t\treturn URI.parse(data);\n\t\t}\n\t\treturn URI.from(data);\n\t} catch {\n\t\treturn undefined;\n\t}\n}\n\nfunction reviveState(state: unknown | undefined): undefined | string {\n\treturn typeof state === 'string' ? state : undefined;\n}\n\nexport function restoreWebviewOptions(options: SerializedWebviewOptions): WebviewOptions {\n\treturn options;\n}\n\nexport function restoreWebviewContentOptions(options: SerializedWebviewOptions): WebviewContentOptions {\n\treturn {\n\t\t...options,\n\t\tlocalResourceRoots: options.localResourceRoots?.map(uri => reviveUri(uri)),\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorSerializer } from '../../../common/editor.js';\nimport { WebviewContentOptions, WebviewExtensionDescription, WebviewOptions } from '../../webview/browser/webview.js';\nimport { WebviewIcons, WebviewInput } from './webviewEditorInput.js';\nimport { IWebviewWorkbenchService } from './webviewWorkbenchService.js';\n\nexport type SerializedWebviewOptions = WebviewOptions & WebviewContentOptions;\n\ninterface SerializedIconPath {\n\tlight: string | UriComponents;\n\tdark: string | UriComponents;\n}\n\nexport interface SerializedWebview {\n\treadonly origin: string | undefined;\n\treadonly viewType: string;\n\treadonly providedId: string | undefined;\n\treadonly title: string;\n\treadonly options: SerializedWebviewOptions;\n\treadonly extensionLocation: UriComponents | undefined;\n\treadonly extensionId: string | undefined;\n\treadonly state: any;\n\treadonly iconPath: SerializedIconPath | undefined;\n\treadonly group?: number;\n}\n\nexport interface DeserializedWebview {\n\treadonly origin: string | undefined;\n\treadonly viewType: string;\n\treadonly providedId: string | undefined;\n\treadonly title: string;\n\treadonly webviewOptions: WebviewOptions;\n\treadonly contentOptions: WebviewContentOptions;\n\treadonly extension: WebviewExtensionDescription | undefined;\n\treadonly state: any;\n\treadonly iconPath: WebviewIcons | undefined;\n\treadonly group?: number;\n}\n\nexport class WebviewEditorInputSerializer implements IEditorSerializer {\n\n\tpublic static readonly ID = WebviewInput.typeId;\n\n\tpublic constructor(\n\t\t@IWebviewWorkbenchService private readonly _webviewWorkbenchService: IWebviewWorkbenchService\n\t) { }\n\n\tpublic canSerialize(input: WebviewInput): boolean {\n\t\treturn this._webviewWorkbenchService.shouldPersist(input);\n\t}\n\n\tpublic serialize(input: WebviewInput): string | undefined {\n\t\tif (!this.canSerialize(input)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst data = this.toJson(input);\n\t\ttry {\n\t\t\treturn JSON.stringify(data);\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tpublic deserialize(\n\t\t_instantiationService: IInstantiationService,\n\t\tserializedEditorInput: string\n\t): WebviewInput {\n\t\tconst data = this.fromJson(JSON.parse(serializedEditorInput));\n\t\treturn this._webviewWorkbenchService.openRevivedWebview({\n\t\t\twebviewInitInfo: {\n\t\t\t\tprovidedViewType: data.providedId,\n\t\t\t\torigin: data.origin,\n\t\t\t\ttitle: data.title,\n\t\t\t\toptions: data.webviewOptions,\n\t\t\t\tcontentOptions: data.contentOptions,\n\t\t\t\textension: data.extension,\n\t\t\t},\n\t\t\tviewType: data.viewType,\n\t\t\ttitle: data.title,\n\t\t\ticonPath: data.iconPath,\n\t\t\tstate: data.state,\n\t\t\tgroup: data.group\n\t\t});\n\t}\n\n\tprotected fromJson(data: SerializedWebview): DeserializedWebview {\n\t\treturn {\n\t\t\t...data,\n\t\t\textension: reviveWebviewExtensionDescription(data.extensionId, data.extensionLocation),\n\t\t\ticonPath: reviveIconPath(data.iconPath),\n\t\t\tstate: reviveState(data.state),\n\t\t\twebviewOptions: restoreWebviewOptions(data.options),\n\t\t\tcontentOptions: restoreWebviewContentOptions(data.options),\n\t\t};\n\t}\n\n\tprotected toJson(input: WebviewInput): SerializedWebview {\n\t\treturn {\n\t\t\torigin: input.webview.origin,\n\t\t\tviewType: input.viewType,\n\t\t\tprovidedId: input.providerId,\n\t\t\ttitle: input.getName(),\n\t\t\toptions: { ...input.webview.options, ...input.webview.contentOptions },\n\t\t\textensionLocation: input.extension?.location,\n\t\t\textensionId: input.extension?.id.value,\n\t\t\tstate: input.webview.state,\n\t\t\ticonPath: input.iconPath ? { light: input.iconPath.light, dark: input.iconPath.dark, } : undefined,\n\t\t\tgroup: input.group\n\t\t};\n\t}\n}\n\nexport function reviveWebviewExtensionDescription(\n\textensionId: string | undefined,\n\textensionLocation: UriComponents | undefined,\n): WebviewExtensionDescription | undefined {\n\tif (!extensionId) {\n\t\treturn undefined;\n\t}\n\n\tconst location = reviveUri(extensionLocation);\n\tif (!location) {\n\t\treturn undefined;\n\t}\n\n\treturn {\n\t\tid: new ExtensionIdentifier(extensionId),\n\t\tlocation,\n\t};\n}\n\nfunction reviveIconPath(data: SerializedIconPath | undefined) {\n\tif (!data) {\n\t\treturn undefined;\n\t}\n\n\tconst light = reviveUri(data.light);\n\tconst dark = reviveUri(data.dark);\n\treturn light && dark ? { light, dark } : undefined;\n}\n\nfunction reviveUri(data: string | UriComponents): URI;\nfunction reviveUri(data: string | UriComponents | undefined): URI | undefined;\nfunction reviveUri(data: string | UriComponents | undefined): URI | undefined {\n\tif (!data) {\n\t\treturn undefined;\n\t}\n\n\ttry {\n\t\tif (typeof data === 'string') {\n\t\t\treturn URI.parse(data);\n\t\t}\n\t\treturn URI.from(data);\n\t} catch {\n\t\treturn undefined;\n\t}\n}\n\nfunction reviveState(state: unknown | undefined): undefined | string {\n\treturn typeof state === 'string' ? state : undefined;\n}\n\nexport function restoreWebviewOptions(options: SerializedWebviewOptions): WebviewOptions {\n\treturn options;\n}\n\nexport function restoreWebviewContentOptions(options: SerializedWebviewOptions): WebviewContentOptions {\n\treturn {\n\t\t...options,\n\t\tlocalResourceRoots: options.localResourceRoots?.map(uri => reviveUri(uri)),\n\t};\n}\n"]}