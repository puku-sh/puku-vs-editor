{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/policyExport/test/node/policyExport.integrationTest.ts","vs/workbench/contrib/policyExport/test/node/policyExport.integrationTest.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,OAAO,KAAK,EAAE,MAAM,eAAe,CAAC;AACpC,OAAO,EAAE,QAAQ,IAAI,EAAE,EAAE,MAAM,IAAI,CAAC;AACpC,OAAO,KAAK,EAAE,MAAM,IAAI,CAAC;AACzB,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AACnG,OAAO,EAAE,SAAS,EAAE,MAAM,wCAAwC,CAAC;AACnE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,oCAAoC,CAAC;AACnE,OAAO,EAAE,UAAU,EAAE,MAAM,uCAAuC,CAAC;AACnE,OAAO,KAAK,IAAI,MAAM,MAAM,CAAC;AAE7B,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;AAErC,KAAK,CAAC,gCAAgC,EAAE,GAAG,EAAE;IAC5C,uCAAuC,EAAE,CAAC;IAE1C,IAAI,CAAC,8CAA8C,EAAE,KAAK;QACzD,kCAAkC;QAClC,IAAI,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC;YAC7B,IAAI,CAAC,IAAI,EAAE,CAAC;QACb,CAAC;QAED,gFAAgF;QAChF,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAEpB,mFAAmF;QACnF,MAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;QAC1D,MAAM,aAAa,GAAG,IAAI,CAAC,QAAQ,EAAE,qCAAqC,CAAC,CAAC;QAC5E,MAAM,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,EAAE,mBAAmB,IAAI,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QAE1E,IAAI,CAAC;YACJ,gDAAgD;YAChD,MAAM,UAAU,GAAG,SAAS;gBAC3B,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,EAAE,UAAU,CAAC;gBACvC,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;YAExC,MAAM,IAAI,CAAC,IAAI,UAAU,2BAA2B,QAAQ,GAAG,EAAE;gBAChE,GAAG,EAAE,QAAQ;aACb,CAAC,CAAC;YAEH,kBAAkB;YAClB,MAAM,CAAC,eAAe,EAAE,gBAAgB,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;gBAC7D,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,OAAO,CAAC;gBAC9B,EAAE,CAAC,QAAQ,CAAC,aAAa,EAAE,OAAO,CAAC;aACnC,CAAC,CAAC;YAEH,mBAAmB;YACnB,MAAM,CAAC,WAAW,CACjB,eAAe,EACf,gBAAgB,EAChB,mHAAmH,CACnH,CAAC;QACH,CAAC;gBAAS,CAAC;YACV,qBAAqB;YACrB,IAAI,CAAC;gBACJ,MAAM,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YAC3B,CAAC;YAAC,MAAM,CAAC;gBACR,wBAAwB;YACzB,CAAC;QACF,CAAC;IACF,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"policyExport.integrationTest.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport * as cp from 'child_process';\nimport { promises as fs } from 'fs';\nimport * as os from 'os';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { dirname, join } from '../../../../../base/common/path.js';\nimport { FileAccess } from '../../../../../base/common/network.js';\nimport * as util from 'util';\n\nconst exec = util.promisify(cp.exec);\n\nsuite('PolicyExport Integration Tests', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('exported policy data matches checked-in file', async function () {\n\t\t// Skip this test in ADO pipelines\n\t\tif (process.env['TF_BUILD']) {\n\t\t\tthis.skip();\n\t\t}\n\n\t\t// This test launches VS Code with --export-policy-data flag, so it takes longer\n\t\tthis.timeout(60000);\n\n\t\t// Get the repository root (FileAccess.asFileUri('') points to the 'out' directory)\n\t\tconst rootPath = dirname(FileAccess.asFileUri('').fsPath);\n\t\tconst checkedInFile = join(rootPath, 'build/lib/policies/policyData.jsonc');\n\t\tconst tempFile = join(os.tmpdir(), `policyData-test-${Date.now()}.jsonc`);\n\n\t\ttry {\n\t\t\t// Launch VS Code with --export-policy-data flag\n\t\t\tconst scriptPath = isWindows\n\t\t\t\t? join(rootPath, 'scripts', 'code.bat')\n\t\t\t\t: join(rootPath, 'scripts', 'code.sh');\n\n\t\t\tawait exec(`\"${scriptPath}\" --export-policy-data=\"${tempFile}\"`, {\n\t\t\t\tcwd: rootPath\n\t\t\t});\n\n\t\t\t// Read both files\n\t\t\tconst [exportedContent, checkedInContent] = await Promise.all([\n\t\t\t\tfs.readFile(tempFile, 'utf-8'),\n\t\t\t\tfs.readFile(checkedInFile, 'utf-8')\n\t\t\t]);\n\n\t\t\t// Compare contents\n\t\t\tassert.strictEqual(\n\t\t\t\texportedContent,\n\t\t\t\tcheckedInContent,\n\t\t\t\t'Exported policy data should match the checked-in file. If this fails, run: ./scripts/code.sh --export-policy-data'\n\t\t\t);\n\t\t} finally {\n\t\t\t// Clean up temp file\n\t\t\ttry {\n\t\t\t\tawait fs.unlink(tempFile);\n\t\t\t} catch {\n\t\t\t\t// Ignore cleanup errors\n\t\t\t}\n\t\t}\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport * as cp from 'child_process';\nimport { promises as fs } from 'fs';\nimport * as os from 'os';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { dirname, join } from '../../../../../base/common/path.js';\nimport { FileAccess } from '../../../../../base/common/network.js';\nimport * as util from 'util';\n\nconst exec = util.promisify(cp.exec);\n\nsuite('PolicyExport Integration Tests', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('exported policy data matches checked-in file', async function () {\n\t\t// Skip this test in ADO pipelines\n\t\tif (process.env['TF_BUILD']) {\n\t\t\tthis.skip();\n\t\t}\n\n\t\t// This test launches VS Code with --export-policy-data flag, so it takes longer\n\t\tthis.timeout(60000);\n\n\t\t// Get the repository root (FileAccess.asFileUri('') points to the 'out' directory)\n\t\tconst rootPath = dirname(FileAccess.asFileUri('').fsPath);\n\t\tconst checkedInFile = join(rootPath, 'build/lib/policies/policyData.jsonc');\n\t\tconst tempFile = join(os.tmpdir(), `policyData-test-${Date.now()}.jsonc`);\n\n\t\ttry {\n\t\t\t// Launch VS Code with --export-policy-data flag\n\t\t\tconst scriptPath = isWindows\n\t\t\t\t? join(rootPath, 'scripts', 'code.bat')\n\t\t\t\t: join(rootPath, 'scripts', 'code.sh');\n\n\t\t\tawait exec(`\"${scriptPath}\" --export-policy-data=\"${tempFile}\"`, {\n\t\t\t\tcwd: rootPath\n\t\t\t});\n\n\t\t\t// Read both files\n\t\t\tconst [exportedContent, checkedInContent] = await Promise.all([\n\t\t\t\tfs.readFile(tempFile, 'utf-8'),\n\t\t\t\tfs.readFile(checkedInFile, 'utf-8')\n\t\t\t]);\n\n\t\t\t// Compare contents\n\t\t\tassert.strictEqual(\n\t\t\t\texportedContent,\n\t\t\t\tcheckedInContent,\n\t\t\t\t'Exported policy data should match the checked-in file. If this fails, run: ./scripts/code.sh --export-policy-data'\n\t\t\t);\n\t\t} finally {\n\t\t\t// Clean up temp file\n\t\t\ttry {\n\t\t\t\tawait fs.unlink(tempFile);\n\t\t\t} catch {\n\t\t\t\t// Ignore cleanup errors\n\t\t\t}\n\t\t}\n\t});\n});\n"]}