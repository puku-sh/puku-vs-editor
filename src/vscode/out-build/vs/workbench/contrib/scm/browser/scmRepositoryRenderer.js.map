{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts","vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts"],"names":[],"mappings":"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","file":"scmRepositoryRenderer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './media/scm.css';\nimport { IDisposable, DisposableStore, combinedDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, IObservable, observableSignalFromEvent } from '../../../../base/common/observable.js';\nimport { append, $ } from '../../../../base/browser/dom.js';\nimport { ISCMProvider, ISCMRepository, ISCMViewService } from '../common/scm.js';\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ActionRunner, IAction } from '../../../../base/common/actions.js';\nimport { connectPrimaryMenu, getRepositoryResourceCount, isSCMRepository, StatusBarAction } from './util.js';\nimport { ITreeNode, ITreeRenderer } from '../../../../base/browser/ui/tree/tree.js';\nimport { ICompressibleTreeRenderer } from '../../../../base/browser/ui/tree/objectTree.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { IListRenderer } from '../../../../base/browser/ui/list/list.js';\nimport { IActionViewItemProvider } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { defaultCountBadgeStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { WorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { shorten } from '../../../../base/common/labels.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\n\nexport class RepositoryActionRunner extends ActionRunner {\n\tconstructor(private readonly getSelectedRepositories: () => ISCMRepository[]) {\n\t\tsuper();\n\t}\n\n\tprotected override async runAction(action: IAction, context: ISCMProvider): Promise<void> {\n\t\tif (!(action instanceof MenuItemAction)) {\n\t\t\treturn super.runAction(action, context);\n\t\t}\n\n\t\tconst actionContext = [context];\n\n\t\t// If the selection contains the repository, add the\n\t\t// other selected repositories to the action context\n\t\tconst selection = this.getSelectedRepositories().map(r => r.provider);\n\t\tif (selection.some(s => s === context)) {\n\t\t\tactionContext.push(...selection.filter(s => s !== context));\n\t\t}\n\n\t\tawait action.run(...actionContext);\n\t}\n}\n\ninterface RepositoryTemplate {\n\treadonly icon: HTMLElement;\n\treadonly label: IconLabel;\n\treadonly countContainer: HTMLElement;\n\treadonly count: CountBadge;\n\treadonly toolBar: WorkbenchToolBar;\n\treadonly elementDisposables: DisposableStore;\n\treadonly templateDisposable: IDisposable;\n}\n\nexport class RepositoryRenderer implements ICompressibleTreeRenderer<ISCMRepository, FuzzyScore, RepositoryTemplate>, IListRenderer<ISCMRepository, RepositoryTemplate>, ITreeRenderer<ISCMRepository, FuzzyScore, RepositoryTemplate> {\n\n\tstatic readonly TEMPLATE_ID = 'repository';\n\tget templateId(): string { return RepositoryRenderer.TEMPLATE_ID; }\n\n\tprivate readonly onDidChangeVisibleRepositoriesSignal: IObservable<void>;\n\n\tconstructor(\n\t\tprivate readonly toolbarMenuId: MenuId,\n\t\tprivate readonly actionViewItemProvider: IActionViewItemProvider,\n\t\t@ICommandService private commandService: ICommandService,\n\t\t@IContextKeyService private contextKeyService: IContextKeyService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IKeybindingService private keybindingService: IKeybindingService,\n\t\t@ILabelService private labelService: ILabelService,\n\t\t@IMenuService private menuService: IMenuService,\n\t\t@ISCMViewService private scmViewService: ISCMViewService,\n\t\t@ITelemetryService private telemetryService: ITelemetryService,\n\t\t@IUriIdentityService private uriIdentityService: IUriIdentityService\n\t) {\n\t\tthis.onDidChangeVisibleRepositoriesSignal = observableSignalFromEvent(this, this.scmViewService.onDidChangeVisibleRepositories);\n\t}\n\n\trenderTemplate(container: HTMLElement): RepositoryTemplate {\n\t\tconst provider = append(container, $('.scm-provider'));\n\t\tconst icon = append(provider, $('.icon'));\n\t\tconst label = new IconLabel(provider, { supportIcons: false });\n\n\t\tconst actions = append(provider, $('.actions'));\n\t\tconst toolBar = new WorkbenchToolBar(actions, { actionViewItemProvider: this.actionViewItemProvider, resetMenu: this.toolbarMenuId, responsiveBehavior: { enabled: true, minItems: 2 } }, this.menuService, this.contextKeyService, this.contextMenuService, this.keybindingService, this.commandService, this.telemetryService);\n\t\tconst countContainer = append(provider, $('.count'));\n\t\tconst count = new CountBadge(countContainer, {}, defaultCountBadgeStyles);\n\t\tconst visibilityDisposable = toolBar.onDidChangeDropdownVisibility(e => provider.classList.toggle('active', e));\n\n\t\tconst templateDisposable = combinedDisposable(label, visibilityDisposable, toolBar);\n\n\t\treturn { icon, label, countContainer, count, toolBar, elementDisposables: new DisposableStore(), templateDisposable };\n\t}\n\n\trenderElement(arg: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, templateData: RepositoryTemplate): void {\n\t\tconst repository = isSCMRepository(arg) ? arg : arg.element;\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tthis.onDidChangeVisibleRepositoriesSignal.read(reader);\n\n\t\t\tconst isVisible = this.scmViewService.isVisible(repository);\n\t\t\tconst icon = ThemeIcon.isThemeIcon(repository.provider.iconPath)\n\t\t\t\t? repository.provider.iconPath\n\t\t\t\t: Codicon.repo;\n\n\t\t\t// Only show the selected icon if there are multiple repositories in the workspace\n\t\t\tconst showSelectedIcon = icon.id === Codicon.repo.id && isVisible && this.scmViewService.repositories.length > 1;\n\n\t\t\ttemplateData.icon.className = showSelectedIcon\n\t\t\t\t? `icon ${ThemeIcon.asClassName(Codicon.repoSelected)}`\n\t\t\t\t: `icon ${ThemeIcon.asClassName(icon)}`;\n\t\t}));\n\n\t\t// Use the description to disambiguate repositories with the same name and have\n\t\t// a `rootUri`. Use the `provider.rootUri` for disambiguation. If they have the\n\t\t// same path, we will use the provider label to disambiguate.\n\t\tlet description: string | undefined = undefined;\n\t\tif (repository.provider.rootUri) {\n\t\t\tconst repositoriesWithRootUri = this.scmViewService.repositories\n\t\t\t\t.filter(r => r.provider.rootUri !== undefined &&\n\t\t\t\t\tthis.uriIdentityService.extUri.isEqual(r.provider.rootUri, repository.provider.rootUri));\n\n\t\t\tconst repositoriesWithSameName = this.scmViewService.repositories\n\t\t\t\t.filter(r => r.provider.rootUri !== undefined &&\n\t\t\t\t\tr.provider.name === repository.provider.name);\n\n\t\t\tif (repositoriesWithRootUri.length > 1) {\n\t\t\t\tdescription = repository.provider.label;\n\t\t\t} else if (repositoriesWithSameName.length > 1) {\n\t\t\t\tconst repositoryIndex = repositoriesWithSameName.findIndex(r => r === repository);\n\t\t\t\tconst shortDescription = shorten(repositoriesWithSameName\n\t\t\t\t\t.map(r => this.labelService.getUriLabel(dirname(r.provider.rootUri!), { relative: true })));\n\n\t\t\t\tdescription = shortDescription[repositoryIndex];\n\t\t\t}\n\t\t}\n\n\t\tlet label: string;\n\t\tif (this.scmViewService.explorerEnabledConfig.get() === false) {\n\t\t\tlabel = repository.provider.name;\n\t\t} else {\n\t\t\tconst parentRepository = this.scmViewService.repositories\n\t\t\t\t.find(r => r.provider.id === repository.provider.parentId);\n\n\t\t\tlabel = parentRepository\n\t\t\t\t? `${parentRepository.provider.name} / ${repository.provider.name}`\n\t\t\t\t: repository.provider.name;\n\t\t}\n\n\t\tconst title = repository.provider.rootUri\n\t\t\t? `${repository.provider.label}: ${this.labelService.getUriLabel(repository.provider.rootUri)}`\n\t\t\t: repository.provider.label;\n\n\t\ttemplateData.label.setLabel(label, description, { title });\n\n\t\tlet statusPrimaryActions: IAction[] = [];\n\t\tlet menuPrimaryActions: IAction[] = [];\n\t\tlet menuSecondaryActions: IAction[] = [];\n\t\tconst updateToolbar = () => {\n\t\t\ttemplateData.toolBar.setActions([...statusPrimaryActions, ...menuPrimaryActions], menuSecondaryActions);\n\t\t};\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tconst commands = repository.provider.statusBarCommands.read(reader) ?? [];\n\t\t\tstatusPrimaryActions = commands.map(c => reader.store.add(new StatusBarAction(c, this.commandService)));\n\t\t\tupdateToolbar();\n\t\t}));\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tconst count = repository.provider.count.read(reader) ?? getRepositoryResourceCount(repository.provider);\n\t\t\ttemplateData.countContainer.setAttribute('data-count', String(count));\n\t\t\ttemplateData.count.setCount(count);\n\t\t}));\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\trepository.provider.contextValue.read(reader);\n\n\t\t\tconst repositoryMenus = this.scmViewService.menus.getRepositoryMenus(repository.provider);\n\t\t\tconst menu = this.toolbarMenuId === MenuId.SCMTitle\n\t\t\t\t? repositoryMenus.titleMenu.menu\n\t\t\t\t: repositoryMenus.getRepositoryMenu(repository);\n\n\t\t\treader.store.add(connectPrimaryMenu(menu, (primary, secondary) => {\n\t\t\t\tmenuPrimaryActions = primary;\n\t\t\t\tmenuSecondaryActions = secondary;\n\t\t\t\tupdateToolbar();\n\t\t\t}, this.toolbarMenuId === MenuId.SCMTitle ? 'navigation' : 'inline'));\n\t\t}));\n\n\t\ttemplateData.toolBar.context = repository.provider;\n\t}\n\n\trenderCompressedElements(): void {\n\t\tthrow new Error('Should never happen since node is incompressible');\n\t}\n\n\tdisposeElement(group: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, template: RepositoryTemplate): void {\n\t\ttemplate.elementDisposables.clear();\n\t}\n\n\tdisposeTemplate(templateData: RepositoryTemplate): void {\n\t\ttemplateData.elementDisposables.dispose();\n\t\ttemplateData.templateDisposable.dispose();\n\t\ttemplateData.count.dispose();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './media/scm.css';\nimport { IDisposable, DisposableStore, combinedDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, IObservable, observableSignalFromEvent } from '../../../../base/common/observable.js';\nimport { append, $ } from '../../../../base/browser/dom.js';\nimport { ISCMProvider, ISCMRepository, ISCMViewService } from '../common/scm.js';\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ActionRunner, IAction } from '../../../../base/common/actions.js';\nimport { connectPrimaryMenu, getRepositoryResourceCount, isSCMRepository, StatusBarAction } from './util.js';\nimport { ITreeNode, ITreeRenderer } from '../../../../base/browser/ui/tree/tree.js';\nimport { ICompressibleTreeRenderer } from '../../../../base/browser/ui/tree/objectTree.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { IListRenderer } from '../../../../base/browser/ui/list/list.js';\nimport { IActionViewItemProvider } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { defaultCountBadgeStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { WorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { shorten } from '../../../../base/common/labels.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\n\nexport class RepositoryActionRunner extends ActionRunner {\n\tconstructor(private readonly getSelectedRepositories: () => ISCMRepository[]) {\n\t\tsuper();\n\t}\n\n\tprotected override async runAction(action: IAction, context: ISCMProvider): Promise<void> {\n\t\tif (!(action instanceof MenuItemAction)) {\n\t\t\treturn super.runAction(action, context);\n\t\t}\n\n\t\tconst actionContext = [context];\n\n\t\t// If the selection contains the repository, add the\n\t\t// other selected repositories to the action context\n\t\tconst selection = this.getSelectedRepositories().map(r => r.provider);\n\t\tif (selection.some(s => s === context)) {\n\t\t\tactionContext.push(...selection.filter(s => s !== context));\n\t\t}\n\n\t\tawait action.run(...actionContext);\n\t}\n}\n\ninterface RepositoryTemplate {\n\treadonly icon: HTMLElement;\n\treadonly label: IconLabel;\n\treadonly countContainer: HTMLElement;\n\treadonly count: CountBadge;\n\treadonly toolBar: WorkbenchToolBar;\n\treadonly elementDisposables: DisposableStore;\n\treadonly templateDisposable: IDisposable;\n}\n\nexport class RepositoryRenderer implements ICompressibleTreeRenderer<ISCMRepository, FuzzyScore, RepositoryTemplate>, IListRenderer<ISCMRepository, RepositoryTemplate>, ITreeRenderer<ISCMRepository, FuzzyScore, RepositoryTemplate> {\n\n\tstatic readonly TEMPLATE_ID = 'repository';\n\tget templateId(): string { return RepositoryRenderer.TEMPLATE_ID; }\n\n\tprivate readonly onDidChangeVisibleRepositoriesSignal: IObservable<void>;\n\n\tconstructor(\n\t\tprivate readonly toolbarMenuId: MenuId,\n\t\tprivate readonly actionViewItemProvider: IActionViewItemProvider,\n\t\t@ICommandService private commandService: ICommandService,\n\t\t@IContextKeyService private contextKeyService: IContextKeyService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IKeybindingService private keybindingService: IKeybindingService,\n\t\t@ILabelService private labelService: ILabelService,\n\t\t@IMenuService private menuService: IMenuService,\n\t\t@ISCMViewService private scmViewService: ISCMViewService,\n\t\t@ITelemetryService private telemetryService: ITelemetryService,\n\t\t@IUriIdentityService private uriIdentityService: IUriIdentityService\n\t) {\n\t\tthis.onDidChangeVisibleRepositoriesSignal = observableSignalFromEvent(this, this.scmViewService.onDidChangeVisibleRepositories);\n\t}\n\n\trenderTemplate(container: HTMLElement): RepositoryTemplate {\n\t\tconst provider = append(container, $('.scm-provider'));\n\t\tconst icon = append(provider, $('.icon'));\n\t\tconst label = new IconLabel(provider, { supportIcons: false });\n\n\t\tconst actions = append(provider, $('.actions'));\n\t\tconst toolBar = new WorkbenchToolBar(actions, { actionViewItemProvider: this.actionViewItemProvider, resetMenu: this.toolbarMenuId, responsiveBehavior: { enabled: true, minItems: 2 } }, this.menuService, this.contextKeyService, this.contextMenuService, this.keybindingService, this.commandService, this.telemetryService);\n\t\tconst countContainer = append(provider, $('.count'));\n\t\tconst count = new CountBadge(countContainer, {}, defaultCountBadgeStyles);\n\t\tconst visibilityDisposable = toolBar.onDidChangeDropdownVisibility(e => provider.classList.toggle('active', e));\n\n\t\tconst templateDisposable = combinedDisposable(label, visibilityDisposable, toolBar);\n\n\t\treturn { icon, label, countContainer, count, toolBar, elementDisposables: new DisposableStore(), templateDisposable };\n\t}\n\n\trenderElement(arg: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, templateData: RepositoryTemplate): void {\n\t\tconst repository = isSCMRepository(arg) ? arg : arg.element;\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tthis.onDidChangeVisibleRepositoriesSignal.read(reader);\n\n\t\t\tconst isVisible = this.scmViewService.isVisible(repository);\n\t\t\tconst icon = ThemeIcon.isThemeIcon(repository.provider.iconPath)\n\t\t\t\t? repository.provider.iconPath\n\t\t\t\t: Codicon.repo;\n\n\t\t\t// Only show the selected icon if there are multiple repositories in the workspace\n\t\t\tconst showSelectedIcon = icon.id === Codicon.repo.id && isVisible && this.scmViewService.repositories.length > 1;\n\n\t\t\ttemplateData.icon.className = showSelectedIcon\n\t\t\t\t? `icon ${ThemeIcon.asClassName(Codicon.repoSelected)}`\n\t\t\t\t: `icon ${ThemeIcon.asClassName(icon)}`;\n\t\t}));\n\n\t\t// Use the description to disambiguate repositories with the same name and have\n\t\t// a `rootUri`. Use the `provider.rootUri` for disambiguation. If they have the\n\t\t// same path, we will use the provider label to disambiguate.\n\t\tlet description: string | undefined = undefined;\n\t\tif (repository.provider.rootUri) {\n\t\t\tconst repositoriesWithRootUri = this.scmViewService.repositories\n\t\t\t\t.filter(r => r.provider.rootUri !== undefined &&\n\t\t\t\t\tthis.uriIdentityService.extUri.isEqual(r.provider.rootUri, repository.provider.rootUri));\n\n\t\t\tconst repositoriesWithSameName = this.scmViewService.repositories\n\t\t\t\t.filter(r => r.provider.rootUri !== undefined &&\n\t\t\t\t\tr.provider.name === repository.provider.name);\n\n\t\t\tif (repositoriesWithRootUri.length > 1) {\n\t\t\t\tdescription = repository.provider.label;\n\t\t\t} else if (repositoriesWithSameName.length > 1) {\n\t\t\t\tconst repositoryIndex = repositoriesWithSameName.findIndex(r => r === repository);\n\t\t\t\tconst shortDescription = shorten(repositoriesWithSameName\n\t\t\t\t\t.map(r => this.labelService.getUriLabel(dirname(r.provider.rootUri!), { relative: true })));\n\n\t\t\t\tdescription = shortDescription[repositoryIndex];\n\t\t\t}\n\t\t}\n\n\t\tlet label: string;\n\t\tif (this.scmViewService.explorerEnabledConfig.get() === false) {\n\t\t\tlabel = repository.provider.name;\n\t\t} else {\n\t\t\tconst parentRepository = this.scmViewService.repositories\n\t\t\t\t.find(r => r.provider.id === repository.provider.parentId);\n\n\t\t\tlabel = parentRepository\n\t\t\t\t? `${parentRepository.provider.name} / ${repository.provider.name}`\n\t\t\t\t: repository.provider.name;\n\t\t}\n\n\t\tconst title = repository.provider.rootUri\n\t\t\t? `${repository.provider.label}: ${this.labelService.getUriLabel(repository.provider.rootUri)}`\n\t\t\t: repository.provider.label;\n\n\t\ttemplateData.label.setLabel(label, description, { title });\n\n\t\tlet statusPrimaryActions: IAction[] = [];\n\t\tlet menuPrimaryActions: IAction[] = [];\n\t\tlet menuSecondaryActions: IAction[] = [];\n\t\tconst updateToolbar = () => {\n\t\t\ttemplateData.toolBar.setActions([...statusPrimaryActions, ...menuPrimaryActions], menuSecondaryActions);\n\t\t};\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tconst commands = repository.provider.statusBarCommands.read(reader) ?? [];\n\t\t\tstatusPrimaryActions = commands.map(c => reader.store.add(new StatusBarAction(c, this.commandService)));\n\t\t\tupdateToolbar();\n\t\t}));\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\tconst count = repository.provider.count.read(reader) ?? getRepositoryResourceCount(repository.provider);\n\t\t\ttemplateData.countContainer.setAttribute('data-count', String(count));\n\t\t\ttemplateData.count.setCount(count);\n\t\t}));\n\n\t\ttemplateData.elementDisposables.add(autorun(reader => {\n\t\t\trepository.provider.contextValue.read(reader);\n\n\t\t\tconst repositoryMenus = this.scmViewService.menus.getRepositoryMenus(repository.provider);\n\t\t\tconst menu = this.toolbarMenuId === MenuId.SCMTitle\n\t\t\t\t? repositoryMenus.titleMenu.menu\n\t\t\t\t: repositoryMenus.getRepositoryMenu(repository);\n\n\t\t\treader.store.add(connectPrimaryMenu(menu, (primary, secondary) => {\n\t\t\t\tmenuPrimaryActions = primary;\n\t\t\t\tmenuSecondaryActions = secondary;\n\t\t\t\tupdateToolbar();\n\t\t\t}, this.toolbarMenuId === MenuId.SCMTitle ? 'navigation' : 'inline'));\n\t\t}));\n\n\t\ttemplateData.toolBar.context = repository.provider;\n\t}\n\n\trenderCompressedElements(): void {\n\t\tthrow new Error('Should never happen since node is incompressible');\n\t}\n\n\tdisposeElement(group: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, template: RepositoryTemplate): void {\n\t\ttemplate.elementDisposables.clear();\n\t}\n\n\tdisposeTemplate(templateData: RepositoryTemplate): void {\n\t\ttemplateData.elementDisposables.dispose();\n\t\ttemplateData.templateDisposable.dispose();\n\t\ttemplateData.count.dispose();\n\t}\n}\n"]}