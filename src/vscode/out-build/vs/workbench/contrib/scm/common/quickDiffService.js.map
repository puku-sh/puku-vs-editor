{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/scm/common/quickDiffService.ts","vs/workbench/contrib/scm/common/quickDiffService.ts"],"names":[],"mappings":"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","file":"quickDiffService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../base/common/uri.js';\nimport { Disposable, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IQuickDiffService, QuickDiff, QuickDiffProvider } from './quickDiff.js';\nimport { isEqualOrParent } from '../../../../base/common/resources.js';\nimport { score } from '../../../../editor/common/languageSelector.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\n\nfunction createProviderComparer(uri: URI): (a: QuickDiffProvider, b: QuickDiffProvider) => number {\n\treturn (a, b) => {\n\t\tif (a.rootUri && !b.rootUri) {\n\t\t\treturn -1;\n\t\t} else if (!a.rootUri && b.rootUri) {\n\t\t\treturn 1;\n\t\t} else if (!a.rootUri && !b.rootUri) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst aIsParent = isEqualOrParent(uri, a.rootUri!);\n\t\tconst bIsParent = isEqualOrParent(uri, b.rootUri!);\n\n\t\tif (aIsParent && bIsParent) {\n\t\t\treturn providerComparer(a, b);\n\t\t} else if (aIsParent) {\n\t\t\treturn -1;\n\t\t} else if (bIsParent) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t};\n}\n\nfunction providerComparer(a: QuickDiffProvider, b: QuickDiffProvider): number {\n\tif (a.kind === 'primary') {\n\t\treturn -1;\n\t} else if (b.kind === 'primary') {\n\t\treturn 1;\n\t} else if (a.kind === 'secondary') {\n\t\treturn -1;\n\t} else if (b.kind === 'secondary') {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nexport class QuickDiffService extends Disposable implements IQuickDiffService {\n\tdeclare readonly _serviceBrand: undefined;\n\tprivate static readonly STORAGE_KEY = 'workbench.scm.quickDiffProviders.hidden';\n\n\tprivate quickDiffProviders: Set<QuickDiffProvider> = new Set();\n\tget providers(): readonly QuickDiffProvider[] {\n\t\treturn Array.from(this.quickDiffProviders).sort(providerComparer);\n\t}\n\n\tprivate readonly _onDidChangeQuickDiffProviders = this._register(new Emitter<void>());\n\treadonly onDidChangeQuickDiffProviders = this._onDidChangeQuickDiffProviders.event;\n\n\tprivate hiddenQuickDiffProviders = new Set<string>();\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper();\n\n\t\tthis.loadState();\n\t}\n\n\taddQuickDiffProvider(quickDiff: QuickDiffProvider): IDisposable {\n\t\tthis.quickDiffProviders.add(quickDiff);\n\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis.quickDiffProviders.delete(quickDiff);\n\t\t\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t\t\t}\n\t\t};\n\t}\n\n\tasync getQuickDiffs(uri: URI, language: string = '', isSynchronized: boolean = false): Promise<QuickDiff[]> {\n\t\tconst providers = Array.from(this.quickDiffProviders)\n\t\t\t.filter(provider => !provider.rootUri || this.uriIdentityService.extUri.isEqualOrParent(uri, provider.rootUri))\n\t\t\t.sort(createProviderComparer(uri));\n\n\t\tconst quickDiffOriginalResources = await Promise.allSettled(providers.map(async provider => {\n\t\t\tconst scoreValue = provider.selector ? score(provider.selector, uri, language, isSynchronized, undefined, undefined) : 10;\n\t\t\tconst originalResource = scoreValue > 0 ? await provider.getOriginalResource(uri) ?? undefined : undefined;\n\t\t\treturn { provider, originalResource };\n\t\t}));\n\n\t\tconst quickDiffs: QuickDiff[] = [];\n\t\tfor (const quickDiffOriginalResource of quickDiffOriginalResources) {\n\t\t\tif (quickDiffOriginalResource.status === 'rejected') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst { provider, originalResource } = quickDiffOriginalResource.value;\n\t\t\tif (!originalResource) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tquickDiffs.push({\n\t\t\t\tid: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tkind: provider.kind,\n\t\t\t\toriginalResource,\n\t\t\t} satisfies QuickDiff);\n\t\t}\n\n\t\treturn quickDiffs;\n\t}\n\n\ttoggleQuickDiffProviderVisibility(id: string): void {\n\t\tif (this.isQuickDiffProviderVisible(id)) {\n\t\t\tthis.hiddenQuickDiffProviders.add(id);\n\t\t} else {\n\t\t\tthis.hiddenQuickDiffProviders.delete(id);\n\t\t}\n\n\t\tthis.saveState();\n\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t}\n\n\tisQuickDiffProviderVisible(id: string): boolean {\n\t\treturn !this.hiddenQuickDiffProviders.has(id);\n\t}\n\n\tprivate loadState(): void {\n\t\tconst raw = this.storageService.get(QuickDiffService.STORAGE_KEY, StorageScope.PROFILE);\n\t\tif (raw) {\n\t\t\ttry {\n\t\t\t\tthis.hiddenQuickDiffProviders = new Set(JSON.parse(raw));\n\t\t\t} catch { }\n\t\t}\n\t}\n\n\tprivate saveState(): void {\n\t\tif (this.hiddenQuickDiffProviders.size === 0) {\n\t\t\tthis.storageService.remove(QuickDiffService.STORAGE_KEY, StorageScope.PROFILE);\n\t\t} else {\n\t\t\tthis.storageService.store(QuickDiffService.STORAGE_KEY, JSON.stringify(Array.from(this.hiddenQuickDiffProviders)), StorageScope.PROFILE, StorageTarget.USER);\n\t\t}\n\t}\n}\n\nexport async function getOriginalResource(quickDiffService: IQuickDiffService, uri: URI, language: string | undefined, isSynchronized: boolean | undefined): Promise<URI | null> {\n\tconst quickDiffs = await quickDiffService.getQuickDiffs(uri, language, isSynchronized);\n\treturn quickDiffs.length > 0 ? quickDiffs[0].originalResource : null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../base/common/uri.js';\nimport { Disposable, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IQuickDiffService, QuickDiff, QuickDiffProvider } from './quickDiff.js';\nimport { isEqualOrParent } from '../../../../base/common/resources.js';\nimport { score } from '../../../../editor/common/languageSelector.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\n\nfunction createProviderComparer(uri: URI): (a: QuickDiffProvider, b: QuickDiffProvider) => number {\n\treturn (a, b) => {\n\t\tif (a.rootUri && !b.rootUri) {\n\t\t\treturn -1;\n\t\t} else if (!a.rootUri && b.rootUri) {\n\t\t\treturn 1;\n\t\t} else if (!a.rootUri && !b.rootUri) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst aIsParent = isEqualOrParent(uri, a.rootUri!);\n\t\tconst bIsParent = isEqualOrParent(uri, b.rootUri!);\n\n\t\tif (aIsParent && bIsParent) {\n\t\t\treturn providerComparer(a, b);\n\t\t} else if (aIsParent) {\n\t\t\treturn -1;\n\t\t} else if (bIsParent) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t};\n}\n\nfunction providerComparer(a: QuickDiffProvider, b: QuickDiffProvider): number {\n\tif (a.kind === 'primary') {\n\t\treturn -1;\n\t} else if (b.kind === 'primary') {\n\t\treturn 1;\n\t} else if (a.kind === 'secondary') {\n\t\treturn -1;\n\t} else if (b.kind === 'secondary') {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nexport class QuickDiffService extends Disposable implements IQuickDiffService {\n\tdeclare readonly _serviceBrand: undefined;\n\tprivate static readonly STORAGE_KEY = 'workbench.scm.quickDiffProviders.hidden';\n\n\tprivate quickDiffProviders: Set<QuickDiffProvider> = new Set();\n\tget providers(): readonly QuickDiffProvider[] {\n\t\treturn Array.from(this.quickDiffProviders).sort(providerComparer);\n\t}\n\n\tprivate readonly _onDidChangeQuickDiffProviders = this._register(new Emitter<void>());\n\treadonly onDidChangeQuickDiffProviders = this._onDidChangeQuickDiffProviders.event;\n\n\tprivate hiddenQuickDiffProviders = new Set<string>();\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper();\n\n\t\tthis.loadState();\n\t}\n\n\taddQuickDiffProvider(quickDiff: QuickDiffProvider): IDisposable {\n\t\tthis.quickDiffProviders.add(quickDiff);\n\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis.quickDiffProviders.delete(quickDiff);\n\t\t\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t\t\t}\n\t\t};\n\t}\n\n\tasync getQuickDiffs(uri: URI, language: string = '', isSynchronized: boolean = false): Promise<QuickDiff[]> {\n\t\tconst providers = Array.from(this.quickDiffProviders)\n\t\t\t.filter(provider => !provider.rootUri || this.uriIdentityService.extUri.isEqualOrParent(uri, provider.rootUri))\n\t\t\t.sort(createProviderComparer(uri));\n\n\t\tconst quickDiffOriginalResources = await Promise.allSettled(providers.map(async provider => {\n\t\t\tconst scoreValue = provider.selector ? score(provider.selector, uri, language, isSynchronized, undefined, undefined) : 10;\n\t\t\tconst originalResource = scoreValue > 0 ? await provider.getOriginalResource(uri) ?? undefined : undefined;\n\t\t\treturn { provider, originalResource };\n\t\t}));\n\n\t\tconst quickDiffs: QuickDiff[] = [];\n\t\tfor (const quickDiffOriginalResource of quickDiffOriginalResources) {\n\t\t\tif (quickDiffOriginalResource.status === 'rejected') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst { provider, originalResource } = quickDiffOriginalResource.value;\n\t\t\tif (!originalResource) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tquickDiffs.push({\n\t\t\t\tid: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tkind: provider.kind,\n\t\t\t\toriginalResource,\n\t\t\t} satisfies QuickDiff);\n\t\t}\n\n\t\treturn quickDiffs;\n\t}\n\n\ttoggleQuickDiffProviderVisibility(id: string): void {\n\t\tif (this.isQuickDiffProviderVisible(id)) {\n\t\t\tthis.hiddenQuickDiffProviders.add(id);\n\t\t} else {\n\t\t\tthis.hiddenQuickDiffProviders.delete(id);\n\t\t}\n\n\t\tthis.saveState();\n\t\tthis._onDidChangeQuickDiffProviders.fire();\n\t}\n\n\tisQuickDiffProviderVisible(id: string): boolean {\n\t\treturn !this.hiddenQuickDiffProviders.has(id);\n\t}\n\n\tprivate loadState(): void {\n\t\tconst raw = this.storageService.get(QuickDiffService.STORAGE_KEY, StorageScope.PROFILE);\n\t\tif (raw) {\n\t\t\ttry {\n\t\t\t\tthis.hiddenQuickDiffProviders = new Set(JSON.parse(raw));\n\t\t\t} catch { }\n\t\t}\n\t}\n\n\tprivate saveState(): void {\n\t\tif (this.hiddenQuickDiffProviders.size === 0) {\n\t\t\tthis.storageService.remove(QuickDiffService.STORAGE_KEY, StorageScope.PROFILE);\n\t\t} else {\n\t\t\tthis.storageService.store(QuickDiffService.STORAGE_KEY, JSON.stringify(Array.from(this.hiddenQuickDiffProviders)), StorageScope.PROFILE, StorageTarget.USER);\n\t\t}\n\t}\n}\n\nexport async function getOriginalResource(quickDiffService: IQuickDiffService, uri: URI, language: string | undefined, isSynchronized: boolean | undefined): Promise<URI | null> {\n\tconst quickDiffs = await quickDiffService.getQuickDiffs(uri, language, isSynchronized);\n\treturn quickDiffs.length > 0 ? quickDiffs[0].originalResource : null;\n}\n"]}