{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/tags/electron-browser/workspaceTags.ts","vs/workbench/contrib/tags/electron-browser/workspaceTags.ts"],"names":[],"mappings":"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","file":"workspaceTags.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IFileService, IFileStat } from '../../../../platform/files/common/files.js';\nimport { ITelemetryService, TelemetryLevel } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ITextFileService, } from '../../../services/textfile/common/textfiles.js';\nimport { IWorkspaceTagsService, Tags, getHashedRemotesFromConfig as baseGetHashedRemotesFromConfig } from '../common/workspaceTags.js';\nimport { IDiagnosticsService, IWorkspaceInformation } from '../../../../platform/diagnostics/common/diagnostics.js';\nimport { IRequestService } from '../../../../platform/request/common/request.js';\nimport { isWindows } from '../../../../base/common/platform.js';\nimport { AllowedSecondLevelDomains, getDomainsOfRemotes } from '../../../../platform/extensionManagement/common/configRemotes.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { hashAsync } from '../../../../base/common/hash.js';\n\nexport async function getHashedRemotesFromConfig(text: string, stripEndingDotGit: boolean = false): Promise<string[]> {\n\treturn baseGetHashedRemotesFromConfig(text, stripEndingDotGit, hashAsync);\n}\n\nexport class WorkspaceTags implements IWorkbenchContribution {\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IRequestService private readonly requestService: IRequestService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IWorkspaceTagsService private readonly workspaceTagsService: IWorkspaceTagsService,\n\t\t@IDiagnosticsService private readonly diagnosticsService: IDiagnosticsService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService\n\t) {\n\t\tif (this.telemetryService.telemetryLevel === TelemetryLevel.USAGE) {\n\t\t\tthis.report();\n\t\t}\n\t}\n\n\tprivate async report(): Promise<void> {\n\t\t// Windows-only Edition Event\n\t\tthis.reportWindowsEdition();\n\n\t\t// Workspace Tags\n\t\tthis.workspaceTagsService.getTags()\n\t\t\t.then(tags => this.reportWorkspaceTags(tags), error => onUnexpectedError(error));\n\n\t\t// Cloud Stats\n\t\tthis.reportCloudStats();\n\n\t\tthis.reportProxyStats();\n\n\t\tthis.getWorkspaceInformation().then(stats => this.diagnosticsService.reportWorkspaceStats(stats));\n\t}\n\n\tprivate async reportWindowsEdition(): Promise<void> {\n\t\tif (!isWindows) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet value = await this.nativeHostService.windowsGetStringRegKey('HKEY_LOCAL_MACHINE', 'SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion', 'EditionID');\n\t\tif (value === undefined) {\n\t\t\tvalue = 'Unknown';\n\t\t}\n\n\t\tthis.telemetryService.publicLog2<{ edition: string }, { owner: 'sbatten'; comment: 'Information about the Windows edition.'; edition: { classification: 'SystemMetaData'; purpose: 'BusinessInsight'; comment: 'The Windows edition.' } }>('windowsEdition', { edition: value });\n\t}\n\n\tprivate async getWorkspaceInformation(): Promise<IWorkspaceInformation> {\n\t\tconst workspace = this.contextService.getWorkspace();\n\t\tconst state = this.contextService.getWorkbenchState();\n\t\tconst telemetryId = await this.workspaceTagsService.getTelemetryWorkspaceId(workspace, state);\n\n\t\treturn {\n\t\t\tid: workspace.id,\n\t\t\ttelemetryId,\n\t\t\trendererSessionId: this.telemetryService.sessionId,\n\t\t\tfolders: workspace.folders,\n\t\t\ttransient: workspace.transient,\n\t\t\tconfiguration: workspace.configuration\n\t\t};\n\t}\n\n\tprivate reportWorkspaceTags(tags: Tags): void {\n\t\t/* __GDPR__\n\t\t\t\"workspce.tags\" : {\n\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${WorkspaceTags}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('workspce.tags', tags);\n\t}\n\n\tprivate reportRemoteDomains(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/.git/config` });\n\t\t\treturn this.fileService.exists(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\treturn this.textFileService.read(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => getDomainsOfRemotes(content.value, AllowedSecondLevelDomains),\n\t\t\t\t\terr => [] // ignore missing or binary file\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(domains => {\n\t\t\tconst set = domains.reduce((set, list) => list.reduce((set, item) => set.add(item), set), new Set<string>());\n\t\t\tconst list: string[] = [];\n\t\t\tset.forEach(item => list.push(item));\n\t\t\t/* __GDPR__\n\t\t\t\t\"workspace.remotes\" : {\n\t\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\t\"domains\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('workspace.remotes', { domains: list.sort() });\n\t\t}, onUnexpectedError);\n\t}\n\n\tprivate reportRemotes(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\treturn this.workspaceTagsService.getHashedRemotesFromUri(workspaceUri, true);\n\t\t})).then(() => { }, onUnexpectedError);\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"node\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureNode(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\t// TODO: should also work for `node_modules` folders several levels down\n\t\tconst uris = workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\treturn workspaceUri.with({ path: `${path !== '/' ? path : ''}/node_modules` });\n\t\t});\n\t\treturn this.fileService.resolveAll(uris.map(resource => ({ resource }))).then(\n\t\t\tresults => {\n\t\t\t\tconst names = (<IFileStat[]>[]).concat(...results.map(result => result.success ? (result.stat!.children || []) : [])).map(c => c.name);\n\t\t\t\tconst referencesAzure = WorkspaceTags.searchArray(names, /azure/i);\n\t\t\t\tif (referencesAzure) {\n\t\t\t\t\ttags['node'] = true;\n\t\t\t\t}\n\t\t\t\treturn tags;\n\t\t\t},\n\t\t\terr => {\n\t\t\t\treturn tags;\n\t\t\t});\n\t}\n\n\tprivate static searchArray(arr: string[], regEx: RegExp): boolean | undefined {\n\t\treturn arr.some(v => v.search(regEx) > -1) || undefined;\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"java\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureJava(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\treturn Promise.all(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/pom.xml` });\n\t\t\treturn this.fileService.exists(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn this.textFileService.read(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => !!content.value.match(/azure/i),\n\t\t\t\t\terr => false\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(javas => {\n\t\t\tif (javas.indexOf(true) !== -1) {\n\t\t\t\ttags['java'] = true;\n\t\t\t}\n\t\t\treturn tags;\n\t\t});\n\t}\n\n\tprivate reportAzure(uris: URI[]) {\n\t\tconst tags: Tags = Object.create(null);\n\t\tthis.reportAzureNode(uris, tags).then((tags) => {\n\t\t\treturn this.reportAzureJava(uris, tags);\n\t\t}).then((tags) => {\n\t\t\tif (Object.keys(tags).length) {\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"workspace.azure\" : {\n\t\t\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${AzureTags}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog('workspace.azure', tags);\n\t\t\t}\n\t\t}).then(undefined, onUnexpectedError);\n\t}\n\n\tprivate reportCloudStats(): void {\n\t\tconst uris = this.contextService.getWorkspace().folders.map(folder => folder.uri);\n\t\tif (uris.length && this.fileService) {\n\t\t\tthis.reportRemoteDomains(uris);\n\t\t\tthis.reportRemotes(uris);\n\t\t\tthis.reportAzure(uris);\n\t\t}\n\t}\n\n\tprivate reportProxyStats() {\n\t\tconst downloadUrl = this.productService.downloadUrl;\n\t\tif (!downloadUrl) {\n\t\t\treturn;\n\t\t}\n\t\tthis.requestService.resolveProxy(downloadUrl)\n\t\t\t.then(proxy => {\n\t\t\t\tlet type = proxy ? String(proxy).trim().split(/\\s+/, 1)[0] : 'EMPTY';\n\t\t\t\tif (['DIRECT', 'PROXY', 'HTTPS', 'SOCKS', 'EMPTY'].indexOf(type) === -1) {\n\t\t\t\t\ttype = 'UNKNOWN';\n\t\t\t\t}\n\t\t\t}).then(undefined, onUnexpectedError);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IFileService, IFileStat } from '../../../../platform/files/common/files.js';\nimport { ITelemetryService, TelemetryLevel } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { ITextFileService, } from '../../../services/textfile/common/textfiles.js';\nimport { IWorkspaceTagsService, Tags, getHashedRemotesFromConfig as baseGetHashedRemotesFromConfig } from '../common/workspaceTags.js';\nimport { IDiagnosticsService, IWorkspaceInformation } from '../../../../platform/diagnostics/common/diagnostics.js';\nimport { IRequestService } from '../../../../platform/request/common/request.js';\nimport { isWindows } from '../../../../base/common/platform.js';\nimport { AllowedSecondLevelDomains, getDomainsOfRemotes } from '../../../../platform/extensionManagement/common/configRemotes.js';\nimport { INativeHostService } from '../../../../platform/native/common/native.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { hashAsync } from '../../../../base/common/hash.js';\n\nexport async function getHashedRemotesFromConfig(text: string, stripEndingDotGit: boolean = false): Promise<string[]> {\n\treturn baseGetHashedRemotesFromConfig(text, stripEndingDotGit, hashAsync);\n}\n\nexport class WorkspaceTags implements IWorkbenchContribution {\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IRequestService private readonly requestService: IRequestService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IWorkspaceTagsService private readonly workspaceTagsService: IWorkspaceTagsService,\n\t\t@IDiagnosticsService private readonly diagnosticsService: IDiagnosticsService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService\n\t) {\n\t\tif (this.telemetryService.telemetryLevel === TelemetryLevel.USAGE) {\n\t\t\tthis.report();\n\t\t}\n\t}\n\n\tprivate async report(): Promise<void> {\n\t\t// Windows-only Edition Event\n\t\tthis.reportWindowsEdition();\n\n\t\t// Workspace Tags\n\t\tthis.workspaceTagsService.getTags()\n\t\t\t.then(tags => this.reportWorkspaceTags(tags), error => onUnexpectedError(error));\n\n\t\t// Cloud Stats\n\t\tthis.reportCloudStats();\n\n\t\tthis.reportProxyStats();\n\n\t\tthis.getWorkspaceInformation().then(stats => this.diagnosticsService.reportWorkspaceStats(stats));\n\t}\n\n\tprivate async reportWindowsEdition(): Promise<void> {\n\t\tif (!isWindows) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet value = await this.nativeHostService.windowsGetStringRegKey('HKEY_LOCAL_MACHINE', 'SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion', 'EditionID');\n\t\tif (value === undefined) {\n\t\t\tvalue = 'Unknown';\n\t\t}\n\n\t\tthis.telemetryService.publicLog2<{ edition: string }, { owner: 'sbatten'; comment: 'Information about the Windows edition.'; edition: { classification: 'SystemMetaData'; purpose: 'BusinessInsight'; comment: 'The Windows edition.' } }>('windowsEdition', { edition: value });\n\t}\n\n\tprivate async getWorkspaceInformation(): Promise<IWorkspaceInformation> {\n\t\tconst workspace = this.contextService.getWorkspace();\n\t\tconst state = this.contextService.getWorkbenchState();\n\t\tconst telemetryId = await this.workspaceTagsService.getTelemetryWorkspaceId(workspace, state);\n\n\t\treturn {\n\t\t\tid: workspace.id,\n\t\t\ttelemetryId,\n\t\t\trendererSessionId: this.telemetryService.sessionId,\n\t\t\tfolders: workspace.folders,\n\t\t\ttransient: workspace.transient,\n\t\t\tconfiguration: workspace.configuration\n\t\t};\n\t}\n\n\tprivate reportWorkspaceTags(tags: Tags): void {\n\t\t/* __GDPR__\n\t\t\t\"workspce.tags\" : {\n\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${WorkspaceTags}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('workspce.tags', tags);\n\t}\n\n\tprivate reportRemoteDomains(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/.git/config` });\n\t\t\treturn this.fileService.exists(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\treturn this.textFileService.read(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => getDomainsOfRemotes(content.value, AllowedSecondLevelDomains),\n\t\t\t\t\terr => [] // ignore missing or binary file\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(domains => {\n\t\t\tconst set = domains.reduce((set, list) => list.reduce((set, item) => set.add(item), set), new Set<string>());\n\t\t\tconst list: string[] = [];\n\t\t\tset.forEach(item => list.push(item));\n\t\t\t/* __GDPR__\n\t\t\t\t\"workspace.remotes\" : {\n\t\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\t\"domains\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('workspace.remotes', { domains: list.sort() });\n\t\t}, onUnexpectedError);\n\t}\n\n\tprivate reportRemotes(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\treturn this.workspaceTagsService.getHashedRemotesFromUri(workspaceUri, true);\n\t\t})).then(() => { }, onUnexpectedError);\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"node\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureNode(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\t// TODO: should also work for `node_modules` folders several levels down\n\t\tconst uris = workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\treturn workspaceUri.with({ path: `${path !== '/' ? path : ''}/node_modules` });\n\t\t});\n\t\treturn this.fileService.resolveAll(uris.map(resource => ({ resource }))).then(\n\t\t\tresults => {\n\t\t\t\tconst names = (<IFileStat[]>[]).concat(...results.map(result => result.success ? (result.stat!.children || []) : [])).map(c => c.name);\n\t\t\t\tconst referencesAzure = WorkspaceTags.searchArray(names, /azure/i);\n\t\t\t\tif (referencesAzure) {\n\t\t\t\t\ttags['node'] = true;\n\t\t\t\t}\n\t\t\t\treturn tags;\n\t\t\t},\n\t\t\terr => {\n\t\t\t\treturn tags;\n\t\t\t});\n\t}\n\n\tprivate static searchArray(arr: string[], regEx: RegExp): boolean | undefined {\n\t\treturn arr.some(v => v.search(regEx) > -1) || undefined;\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"java\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureJava(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\treturn Promise.all(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/pom.xml` });\n\t\t\treturn this.fileService.exists(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn this.textFileService.read(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => !!content.value.match(/azure/i),\n\t\t\t\t\terr => false\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(javas => {\n\t\t\tif (javas.indexOf(true) !== -1) {\n\t\t\t\ttags['java'] = true;\n\t\t\t}\n\t\t\treturn tags;\n\t\t});\n\t}\n\n\tprivate reportAzure(uris: URI[]) {\n\t\tconst tags: Tags = Object.create(null);\n\t\tthis.reportAzureNode(uris, tags).then((tags) => {\n\t\t\treturn this.reportAzureJava(uris, tags);\n\t\t}).then((tags) => {\n\t\t\tif (Object.keys(tags).length) {\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"workspace.azure\" : {\n\t\t\t\t\t\t\"owner\": \"lramos15\",\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${AzureTags}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog('workspace.azure', tags);\n\t\t\t}\n\t\t}).then(undefined, onUnexpectedError);\n\t}\n\n\tprivate reportCloudStats(): void {\n\t\tconst uris = this.contextService.getWorkspace().folders.map(folder => folder.uri);\n\t\tif (uris.length && this.fileService) {\n\t\t\tthis.reportRemoteDomains(uris);\n\t\t\tthis.reportRemotes(uris);\n\t\t\tthis.reportAzure(uris);\n\t\t}\n\t}\n\n\tprivate reportProxyStats() {\n\t\tconst downloadUrl = this.productService.downloadUrl;\n\t\tif (!downloadUrl) {\n\t\t\treturn;\n\t\t}\n\t\tthis.requestService.resolveProxy(downloadUrl)\n\t\t\t.then(proxy => {\n\t\t\t\tlet type = proxy ? String(proxy).trim().split(/\\s+/, 1)[0] : 'EMPTY';\n\t\t\t\tif (['DIRECT', 'PROXY', 'HTTPS', 'SOCKS', 'EMPTY'].indexOf(type) === -1) {\n\t\t\t\t\ttype = 'UNKNOWN';\n\t\t\t\t}\n\t\t\t}).then(undefined, onUnexpectedError);\n\t}\n}\n"]}