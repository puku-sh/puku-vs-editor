{"version":3,"sources":["vs/workbench/contrib/notebook/browser/controller/notebookIndentationActions.ts"],"names":[],"mappings":"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","file":"notebookIndentationActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../../nls.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { IBulkEditService, ResourceTextEdit } from '../../../../../editor/browser/services/bulkEditService.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { Action2, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\nimport { IQuickInputService } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { INotebookEditorService } from '../services/notebookEditorService.js';\nimport { NotebookSetting } from '../../common/notebookCommon.js';\nimport { isNotebookEditorInput } from '../../common/notebookEditorInput.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\n\nexport class NotebookIndentUsingTabs extends Action2 {\n\tpublic static readonly ID = 'notebook.action.indentUsingTabs';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: NotebookIndentUsingTabs.ID,\n\t\t\ttitle: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n\t\t\tprecondition: undefined,\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, ...args: unknown[]): void {\n\t\tchangeNotebookIndentation(accessor, false, false);\n\t}\n}\n\nexport class NotebookIndentUsingSpaces extends Action2 {\n\tpublic static readonly ID = 'notebook.action.indentUsingSpaces';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: NotebookIndentUsingSpaces.ID,\n\t\t\ttitle: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n\t\t\tprecondition: undefined,\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, ...args: unknown[]): void {\n\t\tchangeNotebookIndentation(accessor, true, false);\n\t}\n}\n\nexport class NotebookChangeTabDisplaySize extends Action2 {\n\tpublic static readonly ID = 'notebook.action.changeTabDisplaySize';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: NotebookChangeTabDisplaySize.ID,\n\t\t\ttitle: nls.localize('changeTabDisplaySize', \"Change Tab Display Size\"),\n\t\t\tprecondition: undefined,\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, ...args: unknown[]): void {\n\t\tchangeNotebookIndentation(accessor, true, true);\n\t}\n}\n\nexport class NotebookIndentationToSpacesAction extends Action2 {\n\tpublic static readonly ID = 'notebook.action.convertIndentationToSpaces';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: NotebookIndentationToSpacesAction.ID,\n\t\t\ttitle: nls.localize('convertIndentationToSpaces', \"Convert Indentation to Spaces\"),\n\t\t\tprecondition: undefined,\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, ...args: unknown[]): void {\n\t\tconvertNotebookIndentation(accessor, true);\n\t}\n}\n\nexport class NotebookIndentationToTabsAction extends Action2 {\n\tpublic static readonly ID = 'notebook.action.convertIndentationToTabs';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: NotebookIndentationToTabsAction.ID,\n\t\t\ttitle: nls.localize('convertIndentationToTabs', \"Convert Indentation to Tabs\"),\n\t\t\tprecondition: undefined,\n\t\t});\n\t}\n\n\toverride run(accessor: ServicesAccessor, ...args: unknown[]): void {\n\t\tconvertNotebookIndentation(accessor, false);\n\t}\n}\n\nfunction changeNotebookIndentation(accessor: ServicesAccessor, insertSpaces: boolean, displaySizeOnly: boolean) {\n\tconst editorService = accessor.get(IEditorService);\n\tconst configurationService = accessor.get(IConfigurationService);\n\tconst notebookEditorService = accessor.get(INotebookEditorService);\n\tconst quickInputService = accessor.get(IQuickInputService);\n\n\t// keep this check here to pop on non-notebook actions\n\tconst activeInput = editorService.activeEditorPane?.input;\n\tconst isNotebook = isNotebookEditorInput(activeInput);\n\tif (!isNotebook) {\n\t\treturn;\n\t}\n\n\t// get notebook editor to access all codeEditors\n\tconst notebookEditor = notebookEditorService.retrieveExistingWidgetFromURI(activeInput.resource)?.value;\n\tif (!notebookEditor) {\n\t\treturn;\n\t}\n\n\tconst picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n\t\tid: n.toString(),\n\t\tlabel: n.toString(),\n\t}));\n\n\t// store the initial values of the configuration\n\tconst initialConfig = configurationService.getValue(NotebookSetting.cellEditorOptionsCustomizations) as Record<string, unknown>;\n\tconst initialInsertSpaces = initialConfig['editor.insertSpaces'];\n\t// remove the initial values from the configuration\n\tdelete initialConfig['editor.indentSize'];\n\tdelete initialConfig['editor.tabSize'];\n\tdelete initialConfig['editor.insertSpaces'];\n\n\tsetTimeout(() => {\n\t\tquickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\") }).then(pick => {\n\t\t\tif (pick) {\n\t\t\t\tconst pickedVal = parseInt(pick.label, 10);\n\t\t\t\tif (displaySizeOnly) {\n\t\t\t\t\tconfigurationService.updateValue(NotebookSetting.cellEditorOptionsCustomizations, {\n\t\t\t\t\t\t...initialConfig,\n\t\t\t\t\t\t'editor.tabSize': pickedVal,\n\t\t\t\t\t\t'editor.indentSize': pickedVal,\n\t\t\t\t\t\t'editor.insertSpaces': initialInsertSpaces\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconfigurationService.updateValue(NotebookSetting.cellEditorOptionsCustomizations, {\n\t\t\t\t\t\t...initialConfig,\n\t\t\t\t\t\t'editor.tabSize': pickedVal,\n\t\t\t\t\t\t'editor.indentSize': pickedVal,\n\t\t\t\t\t\t'editor.insertSpaces': insertSpaces\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t}, 50/* quick input is sensitive to being opened so soon after another */);\n}\n\nfunction convertNotebookIndentation(accessor: ServicesAccessor, tabsToSpaces: boolean): void {\n\tconst editorService = accessor.get(IEditorService);\n\tconst configurationService = accessor.get(IConfigurationService);\n\tconst logService = accessor.get(ILogService);\n\tconst textModelService = accessor.get(ITextModelService);\n\tconst notebookEditorService = accessor.get(INotebookEditorService);\n\tconst bulkEditService = accessor.get(IBulkEditService);\n\n\t// keep this check here to pop on non-notebook\n\tconst activeInput = editorService.activeEditorPane?.input;\n\tconst isNotebook = isNotebookEditorInput(activeInput);\n\tif (!isNotebook) {\n\t\treturn;\n\t}\n\n\t// get notebook editor to access all codeEditors\n\tconst notebookTextModel = notebookEditorService.retrieveExistingWidgetFromURI(activeInput.resource)?.value?.textModel;\n\tif (!notebookTextModel) {\n\t\treturn;\n\t}\n\n\tconst disposable = new DisposableStore();\n\ttry {\n\t\tPromise.all(notebookTextModel.cells.map(async cell => {\n\t\t\tconst ref = await textModelService.createModelReference(cell.uri);\n\t\t\tdisposable.add(ref);\n\t\t\tconst textEditorModel = ref.object.textEditorModel;\n\n\t\t\tconst modelOpts = cell.textModel?.getOptions();\n\t\t\tif (!modelOpts) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst edits = getIndentationEditOperations(textEditorModel, modelOpts.tabSize, tabsToSpaces);\n\n\t\t\tbulkEditService.apply(edits, { label: nls.localize('convertIndentation', \"Convert Indentation\"), code: 'undoredo.convertIndentation', });\n\n\t\t})).then(() => {\n\t\t\t// store the initial values of the configuration\n\t\t\tconst initialConfig = configurationService.getValue(NotebookSetting.cellEditorOptionsCustomizations) as Record<string, unknown>;\n\t\t\tconst initialIndentSize = initialConfig['editor.indentSize'];\n\t\t\tconst initialTabSize = initialConfig['editor.tabSize'];\n\t\t\t// remove the initial values from the configuration\n\t\t\tdelete initialConfig['editor.indentSize'];\n\t\t\tdelete initialConfig['editor.tabSize'];\n\t\t\tdelete initialConfig['editor.insertSpaces'];\n\n\t\t\tconfigurationService.updateValue(NotebookSetting.cellEditorOptionsCustomizations, {\n\t\t\t\t...initialConfig,\n\t\t\t\t'editor.tabSize': initialTabSize,\n\t\t\t\t'editor.indentSize': initialIndentSize,\n\t\t\t\t'editor.insertSpaces': tabsToSpaces\n\t\t\t});\n\t\t\tdisposable.dispose();\n\t\t});\n\t} catch {\n\t\tlogService.error('Failed to convert indentation to spaces for notebook cells.');\n\t}\n}\n\nfunction getIndentationEditOperations(model: ITextModel, tabSize: number, tabsToSpaces: boolean): ResourceTextEdit[] {\n\tif (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n\t\t// Model is empty\n\t\treturn [];\n\t}\n\n\tlet spaces = '';\n\tfor (let i = 0; i < tabSize; i++) {\n\t\tspaces += ' ';\n\t}\n\n\tconst spacesRegExp = new RegExp(spaces, 'gi');\n\n\tconst edits: ResourceTextEdit[] = [];\n\tfor (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n\t\tlet lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n\t\tif (lastIndentationColumn === 0) {\n\t\t\tlastIndentationColumn = model.getLineMaxColumn(lineNumber);\n\t\t}\n\n\t\tif (lastIndentationColumn === 1) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n\t\tconst originalIndentation = model.getValueInRange(originalIndentationRange);\n\t\tconst newIndentation = (\n\t\t\ttabsToSpaces\n\t\t\t\t? originalIndentation.replace(/\\t/ig, spaces)\n\t\t\t\t: originalIndentation.replace(spacesRegExp, '\\t')\n\t\t);\n\t\tedits.push(new ResourceTextEdit(model.uri, { range: originalIndentationRange, text: newIndentation }));\n\t}\n\treturn edits;\n}\n\nregisterAction2(NotebookIndentUsingSpaces);\nregisterAction2(NotebookIndentUsingTabs);\nregisterAction2(NotebookChangeTabDisplaySize);\nregisterAction2(NotebookIndentationToSpacesAction);\nregisterAction2(NotebookIndentationToTabsAction);\n"]}