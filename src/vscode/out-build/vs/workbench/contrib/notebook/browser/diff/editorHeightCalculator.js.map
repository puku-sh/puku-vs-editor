{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/diff/editorHeightCalculator.ts","vs/workbench/contrib/notebook/browser/diff/editorHeightCalculator.ts"],"names":[],"mappings":"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","file":"editorHeightCalculator.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../../base/common/uri.js';\nimport { UnchangedRegion } from '../../../../../editor/browser/widget/diffEditor/diffEditorViewModel.js';\nimport { IEditorWorkerService } from '../../../../../editor/common/services/editorWorker.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { getEditorPadding } from './diffCellEditorOptions.js';\nimport { HeightOfHiddenLinesRegionInDiffEditor } from './diffElementViewModel.js';\n\nexport interface IDiffEditorHeightCalculatorService {\n\tdiffAndComputeHeight(original: URI, modified: URI): Promise<number>;\n\tcomputeHeightFromLines(lineCount: number): number;\n}\n\nexport class DiffEditorHeightCalculatorService {\n\tconstructor(\n\t\tprivate readonly lineHeight: number,\n\t\t@ITextModelService private readonly textModelResolverService: ITextModelService,\n\t\t@IEditorWorkerService private readonly editorWorkerService: IEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) { }\n\n\tpublic async diffAndComputeHeight(original: URI, modified: URI): Promise<number> {\n\t\tconst [originalModel, modifiedModel] = await Promise.all([this.textModelResolverService.createModelReference(original), this.textModelResolverService.createModelReference(modified)]);\n\t\ttry {\n\t\t\tconst diffChanges = await this.editorWorkerService.computeDiff(original, modified, {\n\t\t\t\tignoreTrimWhitespace: true,\n\t\t\t\tmaxComputationTimeMs: 0,\n\t\t\t\tcomputeMoves: false\n\t\t\t}, 'advanced').then(diff => diff?.changes || []);\n\n\t\t\tconst unchangedRegionFeatureEnabled = this.configurationService.getValue<boolean>('diffEditor.hideUnchangedRegions.enabled');\n\t\t\tconst minimumLineCount = this.configurationService.getValue<number>('diffEditor.hideUnchangedRegions.minimumLineCount');\n\t\t\tconst contextLineCount = this.configurationService.getValue<number>('diffEditor.hideUnchangedRegions.contextLineCount');\n\t\t\tconst originalLineCount = originalModel.object.textEditorModel.getLineCount();\n\t\t\tconst modifiedLineCount = modifiedModel.object.textEditorModel.getLineCount();\n\t\t\tconst unchanged = unchangedRegionFeatureEnabled ? UnchangedRegion.fromDiffs(diffChanges,\n\t\t\t\toriginalLineCount,\n\t\t\t\tmodifiedLineCount,\n\t\t\t\tminimumLineCount ?? 3,\n\t\t\t\tcontextLineCount ?? 3) : [];\n\n\t\t\tconst numberOfNewLines = diffChanges.reduce((prev, curr) => {\n\t\t\t\tif (curr.original.isEmpty && !curr.modified.isEmpty) {\n\t\t\t\t\treturn prev + curr.modified.length;\n\t\t\t\t}\n\t\t\t\tif (!curr.original.isEmpty && !curr.modified.isEmpty && curr.modified.length > curr.original.length) {\n\t\t\t\t\treturn prev + curr.modified.length - curr.original.length;\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, 0);\n\t\t\tconst orginalNumberOfLines = originalModel.object.textEditorModel.getLineCount();\n\t\t\tconst numberOfHiddenLines = unchanged.reduce((prev, curr) => prev + curr.lineCount, 0);\n\t\t\tconst numberOfHiddenSections = unchanged.length;\n\t\t\tconst unchangeRegionsHeight = numberOfHiddenSections * HeightOfHiddenLinesRegionInDiffEditor;\n\t\t\tconst visibleLineCount = orginalNumberOfLines + numberOfNewLines - numberOfHiddenLines;\n\n\t\t\t// TODO: When we have a horizontal scrollbar, we need to add 12 to the height.\n\t\t\t// Right now there's no way to determine if a horizontal scrollbar is visible in the editor.\n\t\t\treturn (visibleLineCount * this.lineHeight) + getEditorPadding(visibleLineCount).top + getEditorPadding(visibleLineCount).bottom + unchangeRegionsHeight;\n\t\t} finally {\n\t\t\toriginalModel.dispose();\n\t\t\tmodifiedModel.dispose();\n\t\t}\n\t}\n\n\tpublic computeHeightFromLines(lineCount: number): number {\n\t\treturn lineCount * this.lineHeight + getEditorPadding(lineCount).top + getEditorPadding(lineCount).bottom;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../../base/common/uri.js';\nimport { UnchangedRegion } from '../../../../../editor/browser/widget/diffEditor/diffEditorViewModel.js';\nimport { IEditorWorkerService } from '../../../../../editor/common/services/editorWorker.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { getEditorPadding } from './diffCellEditorOptions.js';\nimport { HeightOfHiddenLinesRegionInDiffEditor } from './diffElementViewModel.js';\n\nexport interface IDiffEditorHeightCalculatorService {\n\tdiffAndComputeHeight(original: URI, modified: URI): Promise<number>;\n\tcomputeHeightFromLines(lineCount: number): number;\n}\n\nexport class DiffEditorHeightCalculatorService {\n\tconstructor(\n\t\tprivate readonly lineHeight: number,\n\t\t@ITextModelService private readonly textModelResolverService: ITextModelService,\n\t\t@IEditorWorkerService private readonly editorWorkerService: IEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) { }\n\n\tpublic async diffAndComputeHeight(original: URI, modified: URI): Promise<number> {\n\t\tconst [originalModel, modifiedModel] = await Promise.all([this.textModelResolverService.createModelReference(original), this.textModelResolverService.createModelReference(modified)]);\n\t\ttry {\n\t\t\tconst diffChanges = await this.editorWorkerService.computeDiff(original, modified, {\n\t\t\t\tignoreTrimWhitespace: true,\n\t\t\t\tmaxComputationTimeMs: 0,\n\t\t\t\tcomputeMoves: false\n\t\t\t}, 'advanced').then(diff => diff?.changes || []);\n\n\t\t\tconst unchangedRegionFeatureEnabled = this.configurationService.getValue<boolean>('diffEditor.hideUnchangedRegions.enabled');\n\t\t\tconst minimumLineCount = this.configurationService.getValue<number>('diffEditor.hideUnchangedRegions.minimumLineCount');\n\t\t\tconst contextLineCount = this.configurationService.getValue<number>('diffEditor.hideUnchangedRegions.contextLineCount');\n\t\t\tconst originalLineCount = originalModel.object.textEditorModel.getLineCount();\n\t\t\tconst modifiedLineCount = modifiedModel.object.textEditorModel.getLineCount();\n\t\t\tconst unchanged = unchangedRegionFeatureEnabled ? UnchangedRegion.fromDiffs(diffChanges,\n\t\t\t\toriginalLineCount,\n\t\t\t\tmodifiedLineCount,\n\t\t\t\tminimumLineCount ?? 3,\n\t\t\t\tcontextLineCount ?? 3) : [];\n\n\t\t\tconst numberOfNewLines = diffChanges.reduce((prev, curr) => {\n\t\t\t\tif (curr.original.isEmpty && !curr.modified.isEmpty) {\n\t\t\t\t\treturn prev + curr.modified.length;\n\t\t\t\t}\n\t\t\t\tif (!curr.original.isEmpty && !curr.modified.isEmpty && curr.modified.length > curr.original.length) {\n\t\t\t\t\treturn prev + curr.modified.length - curr.original.length;\n\t\t\t\t}\n\t\t\t\treturn prev;\n\t\t\t}, 0);\n\t\t\tconst orginalNumberOfLines = originalModel.object.textEditorModel.getLineCount();\n\t\t\tconst numberOfHiddenLines = unchanged.reduce((prev, curr) => prev + curr.lineCount, 0);\n\t\t\tconst numberOfHiddenSections = unchanged.length;\n\t\t\tconst unchangeRegionsHeight = numberOfHiddenSections * HeightOfHiddenLinesRegionInDiffEditor;\n\t\t\tconst visibleLineCount = orginalNumberOfLines + numberOfNewLines - numberOfHiddenLines;\n\n\t\t\t// TODO: When we have a horizontal scrollbar, we need to add 12 to the height.\n\t\t\t// Right now there's no way to determine if a horizontal scrollbar is visible in the editor.\n\t\t\treturn (visibleLineCount * this.lineHeight) + getEditorPadding(visibleLineCount).top + getEditorPadding(visibleLineCount).bottom + unchangeRegionsHeight;\n\t\t} finally {\n\t\t\toriginalModel.dispose();\n\t\t\tmodifiedModel.dispose();\n\t\t}\n\t}\n\n\tpublic computeHeightFromLines(lineCount: number): number {\n\t\treturn lineCount * this.lineHeight + getEditorPadding(lineCount).top + getEditorPadding(lineCount).bottom;\n\t}\n}\n"]}