{"version":3,"sources":["vs/workbench/contrib/notebook/browser/contrib/cellDiagnostics/cellDiagnosticsActions.ts"],"names":[],"mappings":"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","file":"cellDiagnosticsActions.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { KeyCode, KeyMod } from '../../../../../../base/common/keyCodes.js';\nimport { ServicesAccessor } from '../../../../../../editor/browser/editorExtensions.js';\nimport { Range } from '../../../../../../editor/common/core/range.js';\nimport { CodeActionController } from '../../../../../../editor/contrib/codeAction/browser/codeActionController.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../../../../../editor/contrib/codeAction/common/types.js';\nimport { localize, localize2 } from '../../../../../../nls.js';\nimport { registerAction2 } from '../../../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingWeight } from '../../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotebookCellActionContext, NotebookCellAction, findTargetCellEditor } from '../../controller/coreActions.js';\nimport { CodeCellViewModel } from '../../viewModel/codeCellViewModel.js';\nimport { NOTEBOOK_CELL_EDITOR_FOCUSED, NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_HAS_ERROR_DIAGNOSTICS } from '../../../common/notebookContextKeys.js';\nimport { InlineChatController } from '../../../../inlineChat/browser/inlineChatController.js';\nimport { IChatWidgetService } from '../../../../chat/browser/chat.js';\n\nexport const OPEN_CELL_FAILURE_ACTIONS_COMMAND_ID = 'notebook.cell.openFailureActions';\nexport const FIX_CELL_ERROR_COMMAND_ID = 'notebook.cell.chat.fixError';\nexport const EXPLAIN_CELL_ERROR_COMMAND_ID = 'notebook.cell.chat.explainError';\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: OPEN_CELL_FAILURE_ACTIONS_COMMAND_ID,\n\t\t\ttitle: localize2('notebookActions.cellFailureActions', \"Show Cell Failure Actions\"),\n\t\t\tprecondition: ContextKeyExpr.and(NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_HAS_ERROR_DIAGNOSTICS, NOTEBOOK_CELL_EDITOR_FOCUSED.toNegated()),\n\t\t\tf1: true,\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_HAS_ERROR_DIAGNOSTICS, NOTEBOOK_CELL_EDITOR_FOCUSED.toNegated()),\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Period,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tif (context.cell instanceof CodeCellViewModel) {\n\t\t\tconst error = context.cell.executionErrorDiagnostic.get();\n\t\t\tif (error?.location) {\n\t\t\t\tconst location = Range.lift({\n\t\t\t\t\tstartLineNumber: error.location.startLineNumber + 1,\n\t\t\t\t\tstartColumn: error.location.startColumn + 1,\n\t\t\t\t\tendLineNumber: error.location.endLineNumber + 1,\n\t\t\t\t\tendColumn: error.location.endColumn + 1\n\t\t\t\t});\n\t\t\t\tcontext.notebookEditor.setCellEditorSelection(context.cell, Range.lift(location));\n\t\t\t\tconst editor = findTargetCellEditor(context, context.cell);\n\t\t\t\tif (editor) {\n\t\t\t\t\tconst controller = CodeActionController.get(editor);\n\t\t\t\t\tcontroller?.manualTriggerAtCurrentPosition(\n\t\t\t\t\t\tlocalize('cellCommands.quickFix.noneMessage', \"No code actions available\"),\n\t\t\t\t\t\tCodeActionTriggerSource.Default,\n\t\t\t\t\t\t{ include: CodeActionKind.QuickFix });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: FIX_CELL_ERROR_COMMAND_ID,\n\t\t\ttitle: localize2('notebookActions.chatFixCellError', \"Fix Cell Error\"),\n\t\t\tprecondition: ContextKeyExpr.and(NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_HAS_ERROR_DIAGNOSTICS, NOTEBOOK_CELL_EDITOR_FOCUSED.toNegated()),\n\t\t\tf1: true\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tif (context.cell instanceof CodeCellViewModel) {\n\t\t\tconst error = context.cell.executionErrorDiagnostic.get();\n\t\t\tif (error?.location) {\n\t\t\t\tconst location = Range.lift({\n\t\t\t\t\tstartLineNumber: error.location.startLineNumber + 1,\n\t\t\t\t\tstartColumn: error.location.startColumn + 1,\n\t\t\t\t\tendLineNumber: error.location.endLineNumber + 1,\n\t\t\t\t\tendColumn: error.location.endColumn + 1\n\t\t\t\t});\n\t\t\t\tcontext.notebookEditor.setCellEditorSelection(context.cell, Range.lift(location));\n\t\t\t\tconst editor = findTargetCellEditor(context, context.cell);\n\t\t\t\tif (editor) {\n\t\t\t\t\tconst controller = InlineChatController.get(editor);\n\t\t\t\t\tconst message = error.name ? `${error.name}: ${error.message}` : error.message;\n\t\t\t\t\tif (controller) {\n\t\t\t\t\t\tawait controller.run({ message: '/fix ' + message, initialRange: location, autoSend: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXPLAIN_CELL_ERROR_COMMAND_ID,\n\t\t\ttitle: localize2('notebookActions.chatExplainCellError', \"Explain Cell Error\"),\n\t\t\tprecondition: ContextKeyExpr.and(NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_HAS_ERROR_DIAGNOSTICS, NOTEBOOK_CELL_EDITOR_FOCUSED.toNegated()),\n\t\t\tf1: true\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tif (context.cell instanceof CodeCellViewModel) {\n\t\t\tconst error = context.cell.executionErrorDiagnostic.get();\n\t\t\tif (error?.message) {\n\t\t\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\t\t\tconst chatWidget = await widgetService.revealWidget();\n\t\t\t\tconst message = error.name ? `${error.name}: ${error.message}` : error.message;\n\t\t\t\t// TODO: can we add special prompt instructions? e.g. use \"%pip install\"\n\t\t\t\tchatWidget?.acceptInput('@workspace /explain ' + message,);\n\t\t\t}\n\t\t}\n\t}\n});\n"]}