{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/services/notebookWorkerServiceImpl.ts","vs/workbench/contrib/notebook/browser/services/notebookWorkerServiceImpl.ts"],"names":[],"mappings":"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","file":"notebookWorkerServiceImpl.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, dispose, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IWebWorkerClient, Proxied } from '../../../../../base/common/worker/webWorker.js';\nimport { WebWorkerDescriptor } from '../../../../../platform/webWorker/browser/webWorkerDescriptor.js';\nimport { IWebWorkerService } from '../../../../../platform/webWorker/browser/webWorkerService.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { CellUri, IMainCellDto, INotebookDiffResult, NotebookCellsChangeType, NotebookRawContentEventDto } from '../../common/notebookCommon.js';\nimport { INotebookService } from '../../common/notebookService.js';\nimport { NotebookWorker } from '../../common/services/notebookWebWorker.js';\nimport { INotebookEditorWorkerService } from '../../common/services/notebookWorkerService.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { TextModel } from '../../../../../editor/common/model/textModel.js';\nimport { FileAccess, Schemas } from '../../../../../base/common/network.js';\nimport { isEqual } from '../../../../../base/common/resources.js';\n\nexport class NotebookEditorWorkerServiceImpl extends Disposable implements INotebookEditorWorkerService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _workerManager: WorkerManager;\n\n\tconstructor(\n\t\t@INotebookService notebookService: INotebookService,\n\t\t@IModelService modelService: IModelService,\n\t\t@IWebWorkerService webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\n\t\tthis._workerManager = this._register(new WorkerManager(notebookService, modelService, webWorkerService));\n\t}\n\tcanComputeDiff(original: URI, modified: URI): boolean {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tcomputeDiff(original: URI, modified: URI): Promise<INotebookDiffResult> {\n\t\treturn this._workerManager.withWorker().then(client => {\n\t\t\treturn client.computeDiff(original, modified);\n\t\t});\n\t}\n\n\tcanPromptRecommendation(model: URI): Promise<boolean> {\n\t\treturn this._workerManager.withWorker().then(client => {\n\t\t\treturn client.canPromptRecommendation(model);\n\t\t});\n\t}\n}\n\nclass WorkerManager extends Disposable {\n\tprivate _editorWorkerClient: NotebookWorkerClient | null;\n\t// private _lastWorkerUsedTime: number;\n\n\tconstructor(\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t\tprivate readonly _webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\t\tthis._editorWorkerClient = null;\n\t\t// this._lastWorkerUsedTime = (new Date()).getTime();\n\t}\n\n\twithWorker(): Promise<NotebookWorkerClient> {\n\t\t// this._lastWorkerUsedTime = (new Date()).getTime();\n\t\tif (!this._editorWorkerClient) {\n\t\t\tthis._editorWorkerClient = new NotebookWorkerClient(this._notebookService, this._modelService, this._webWorkerService);\n\t\t\tthis._register(this._editorWorkerClient);\n\t\t}\n\t\treturn Promise.resolve(this._editorWorkerClient);\n\t}\n}\n\nclass NotebookEditorModelManager extends Disposable {\n\tprivate _syncedModels: { [modelUrl: string]: IDisposable } = Object.create(null);\n\tprivate _syncedModelsLastUsedTime: { [modelUrl: string]: number } = Object.create(null);\n\n\tconstructor(\n\t\tprivate readonly _proxy: Proxied<NotebookWorker>,\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic ensureSyncedResources(resources: URI[]): void {\n\t\tfor (const resource of resources) {\n\t\t\tconst resourceStr = resource.toString();\n\n\t\t\tif (!this._syncedModels[resourceStr]) {\n\t\t\t\tthis._beginModelSync(resource);\n\t\t\t}\n\t\t\tif (this._syncedModels[resourceStr]) {\n\t\t\t\tthis._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _beginModelSync(resource: URI): void {\n\t\tconst model = this._notebookService.listNotebookDocuments().find(document => document.uri.toString() === resource.toString());\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modelUrl = resource.toString();\n\n\t\tthis._proxy.$acceptNewModel(\n\t\t\tmodel.uri.toString(),\n\t\t\tmodel.metadata,\n\t\t\tmodel.transientOptions.transientDocumentMetadata,\n\t\t\tmodel.cells.map(cell => ({\n\t\t\t\thandle: cell.handle,\n\t\t\t\turl: cell.uri.toString(),\n\t\t\t\tsource: cell.textBuffer.getLinesContent(),\n\t\t\t\teol: cell.textBuffer.getEOL(),\n\t\t\t\tversionId: cell.textModel?.getVersionId() ?? 0,\n\t\t\t\tlanguage: cell.language,\n\t\t\t\tmime: cell.mime,\n\t\t\t\tcellKind: cell.cellKind,\n\t\t\t\toutputs: cell.outputs.map(op => ({ outputId: op.outputId, outputs: op.outputs })),\n\t\t\t\tmetadata: cell.metadata,\n\t\t\t\tinternalMetadata: cell.internalMetadata,\n\t\t\t}))\n\t\t);\n\n\t\tconst toDispose = new DisposableStore();\n\n\t\tconst cellToDto = (cell: NotebookCellTextModel): IMainCellDto => {\n\t\t\treturn {\n\t\t\t\thandle: cell.handle,\n\t\t\t\turl: cell.uri.toString(),\n\t\t\t\tsource: cell.textBuffer.getLinesContent(),\n\t\t\t\teol: cell.textBuffer.getEOL(),\n\t\t\t\tversionId: 0,\n\t\t\t\tlanguage: cell.language,\n\t\t\t\tcellKind: cell.cellKind,\n\t\t\t\toutputs: cell.outputs.map(op => ({ outputId: op.outputId, outputs: op.outputs })),\n\t\t\t\tmetadata: cell.metadata,\n\t\t\t\tinternalMetadata: cell.internalMetadata,\n\t\t\t};\n\t\t};\n\n\t\tconst cellHandlers = new Set<NotebookCellTextModel>();\n\t\tconst addCellContentChangeHandler = (cell: NotebookCellTextModel) => {\n\t\t\tcellHandlers.add(cell);\n\t\t\ttoDispose.add(cell.onDidChangeContent((e) => {\n\t\t\t\tif (typeof e === 'object' && e.type === 'model') {\n\t\t\t\t\tthis._proxy.$acceptCellModelChanged(modelUrl, cell.handle, e.event);\n\t\t\t\t}\n\t\t\t}));\n\t\t};\n\n\t\tmodel.cells.forEach(cell => addCellContentChangeHandler(cell));\n\t\t// Possible some of the models have not yet been loaded.\n\t\t// If all have been loaded, for all cells, then no need to listen to model add events.\n\t\tif (model.cells.length !== cellHandlers.size) {\n\t\t\ttoDispose.add(this._modelService.onModelAdded((textModel: ITextModel) => {\n\t\t\t\tif (textModel.uri.scheme !== Schemas.vscodeNotebookCell || !(textModel instanceof TextModel)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cellUri = CellUri.parse(textModel.uri);\n\t\t\t\tif (!cellUri || !isEqual(cellUri.notebook, model.uri)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cell = model.cells.find(cell => cell.handle === cellUri.handle);\n\t\t\t\tif (cell) {\n\t\t\t\t\taddCellContentChangeHandler(cell);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\ttoDispose.add(model.onDidChangeContent((event) => {\n\t\t\tconst dto: NotebookRawContentEventDto[] = [];\n\t\t\tevent.rawEvents\n\t\t\t\t.forEach(e => {\n\t\t\t\t\tswitch (e.kind) {\n\t\t\t\t\t\tcase NotebookCellsChangeType.ModelChange:\n\t\t\t\t\t\tcase NotebookCellsChangeType.Initialize: {\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: e.kind,\n\t\t\t\t\t\t\t\tchanges: e.changes.map(diff => [diff[0], diff[1], diff[2].map(cell => cellToDto(cell as NotebookCellTextModel))] as [number, number, IMainCellDto[]])\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tfor (const change of e.changes) {\n\t\t\t\t\t\t\t\tfor (const cell of change[2]) {\n\t\t\t\t\t\t\t\t\taddCellContentChangeHandler(cell as NotebookCellTextModel);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase NotebookCellsChangeType.Move: {\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: NotebookCellsChangeType.Move,\n\t\t\t\t\t\t\t\tindex: e.index,\n\t\t\t\t\t\t\t\tlength: e.length,\n\t\t\t\t\t\t\t\tnewIdx: e.newIdx,\n\t\t\t\t\t\t\t\tcells: e.cells.map(cell => cellToDto(cell as NotebookCellTextModel))\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase NotebookCellsChangeType.ChangeCellContent:\n\t\t\t\t\t\t\t// Changes to cell content are handled by the cell model change listener.\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookCellsChangeType.ChangeDocumentMetadata:\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: e.kind,\n\t\t\t\t\t\t\t\tmetadata: e.metadata\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdto.push(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tthis._proxy.$acceptModelChanged(modelUrl.toString(), {\n\t\t\t\trawEvents: dto,\n\t\t\t\tversionId: event.versionId\n\t\t\t});\n\t\t}));\n\n\t\ttoDispose.add(model.onWillDispose(() => {\n\t\t\tthis._stopModelSync(modelUrl);\n\t\t}));\n\t\ttoDispose.add(toDisposable(() => {\n\t\t\tthis._proxy.$acceptRemovedModel(modelUrl);\n\t\t}));\n\n\t\tthis._syncedModels[modelUrl] = toDispose;\n\t}\n\n\tprivate _stopModelSync(modelUrl: string): void {\n\t\tconst toDispose = this._syncedModels[modelUrl];\n\t\tdelete this._syncedModels[modelUrl];\n\t\tdelete this._syncedModelsLastUsedTime[modelUrl];\n\t\tdispose(toDispose);\n\t}\n}\n\nclass NotebookWorkerClient extends Disposable {\n\tprivate _worker: IWebWorkerClient<NotebookWorker> | null;\n\tprivate _modelManager: NotebookEditorModelManager | null;\n\n\n\tconstructor(\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t\tprivate readonly _webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\t\tthis._worker = null;\n\t\tthis._modelManager = null;\n\n\t}\n\n\tcomputeDiff(original: URI, modified: URI) {\n\t\tconst proxy = this._ensureSyncedResources([original, modified]);\n\t\treturn proxy.$computeDiff(original.toString(), modified.toString());\n\t}\n\n\tcanPromptRecommendation(modelUri: URI) {\n\t\tconst proxy = this._ensureSyncedResources([modelUri]);\n\t\treturn proxy.$canPromptRecommendation(modelUri.toString());\n\t}\n\n\tprivate _getOrCreateModelManager(proxy: Proxied<NotebookWorker>): NotebookEditorModelManager {\n\t\tif (!this._modelManager) {\n\t\t\tthis._modelManager = this._register(new NotebookEditorModelManager(proxy, this._notebookService, this._modelService));\n\t\t}\n\t\treturn this._modelManager;\n\t}\n\n\tprotected _ensureSyncedResources(resources: URI[]): Proxied<NotebookWorker> {\n\t\tconst proxy = this._getOrCreateWorker().proxy;\n\t\tthis._getOrCreateModelManager(proxy).ensureSyncedResources(resources);\n\t\treturn proxy;\n\t}\n\n\tprivate _getOrCreateWorker(): IWebWorkerClient<NotebookWorker> {\n\t\tif (!this._worker) {\n\t\t\ttry {\n\t\t\t\tthis._worker = this._register(this._webWorkerService.createWorkerClient<NotebookWorker>(\n\t\t\t\t\tnew WebWorkerDescriptor({\n\t\t\t\t\t\tesmModuleLocation: FileAccess.asBrowserUri('vs/workbench/contrib/notebook/common/services/notebookWebWorkerMain.js'),\n\t\t\t\t\t\tlabel: 'NotebookEditorWorker'\n\t\t\t\t\t})\n\t\t\t\t));\n\t\t\t} catch (err) {\n\t\t\t\tthrow (err);\n\t\t\t}\n\t\t}\n\t\treturn this._worker;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, dispose, IDisposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IWebWorkerClient, Proxied } from '../../../../../base/common/worker/webWorker.js';\nimport { WebWorkerDescriptor } from '../../../../../platform/webWorker/browser/webWorkerDescriptor.js';\nimport { IWebWorkerService } from '../../../../../platform/webWorker/browser/webWorkerService.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { CellUri, IMainCellDto, INotebookDiffResult, NotebookCellsChangeType, NotebookRawContentEventDto } from '../../common/notebookCommon.js';\nimport { INotebookService } from '../../common/notebookService.js';\nimport { NotebookWorker } from '../../common/services/notebookWebWorker.js';\nimport { INotebookEditorWorkerService } from '../../common/services/notebookWorkerService.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { TextModel } from '../../../../../editor/common/model/textModel.js';\nimport { FileAccess, Schemas } from '../../../../../base/common/network.js';\nimport { isEqual } from '../../../../../base/common/resources.js';\n\nexport class NotebookEditorWorkerServiceImpl extends Disposable implements INotebookEditorWorkerService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _workerManager: WorkerManager;\n\n\tconstructor(\n\t\t@INotebookService notebookService: INotebookService,\n\t\t@IModelService modelService: IModelService,\n\t\t@IWebWorkerService webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\n\t\tthis._workerManager = this._register(new WorkerManager(notebookService, modelService, webWorkerService));\n\t}\n\tcanComputeDiff(original: URI, modified: URI): boolean {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tcomputeDiff(original: URI, modified: URI): Promise<INotebookDiffResult> {\n\t\treturn this._workerManager.withWorker().then(client => {\n\t\t\treturn client.computeDiff(original, modified);\n\t\t});\n\t}\n\n\tcanPromptRecommendation(model: URI): Promise<boolean> {\n\t\treturn this._workerManager.withWorker().then(client => {\n\t\t\treturn client.canPromptRecommendation(model);\n\t\t});\n\t}\n}\n\nclass WorkerManager extends Disposable {\n\tprivate _editorWorkerClient: NotebookWorkerClient | null;\n\t// private _lastWorkerUsedTime: number;\n\n\tconstructor(\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t\tprivate readonly _webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\t\tthis._editorWorkerClient = null;\n\t\t// this._lastWorkerUsedTime = (new Date()).getTime();\n\t}\n\n\twithWorker(): Promise<NotebookWorkerClient> {\n\t\t// this._lastWorkerUsedTime = (new Date()).getTime();\n\t\tif (!this._editorWorkerClient) {\n\t\t\tthis._editorWorkerClient = new NotebookWorkerClient(this._notebookService, this._modelService, this._webWorkerService);\n\t\t\tthis._register(this._editorWorkerClient);\n\t\t}\n\t\treturn Promise.resolve(this._editorWorkerClient);\n\t}\n}\n\nclass NotebookEditorModelManager extends Disposable {\n\tprivate _syncedModels: { [modelUrl: string]: IDisposable } = Object.create(null);\n\tprivate _syncedModelsLastUsedTime: { [modelUrl: string]: number } = Object.create(null);\n\n\tconstructor(\n\t\tprivate readonly _proxy: Proxied<NotebookWorker>,\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic ensureSyncedResources(resources: URI[]): void {\n\t\tfor (const resource of resources) {\n\t\t\tconst resourceStr = resource.toString();\n\n\t\t\tif (!this._syncedModels[resourceStr]) {\n\t\t\t\tthis._beginModelSync(resource);\n\t\t\t}\n\t\t\tif (this._syncedModels[resourceStr]) {\n\t\t\t\tthis._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _beginModelSync(resource: URI): void {\n\t\tconst model = this._notebookService.listNotebookDocuments().find(document => document.uri.toString() === resource.toString());\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modelUrl = resource.toString();\n\n\t\tthis._proxy.$acceptNewModel(\n\t\t\tmodel.uri.toString(),\n\t\t\tmodel.metadata,\n\t\t\tmodel.transientOptions.transientDocumentMetadata,\n\t\t\tmodel.cells.map(cell => ({\n\t\t\t\thandle: cell.handle,\n\t\t\t\turl: cell.uri.toString(),\n\t\t\t\tsource: cell.textBuffer.getLinesContent(),\n\t\t\t\teol: cell.textBuffer.getEOL(),\n\t\t\t\tversionId: cell.textModel?.getVersionId() ?? 0,\n\t\t\t\tlanguage: cell.language,\n\t\t\t\tmime: cell.mime,\n\t\t\t\tcellKind: cell.cellKind,\n\t\t\t\toutputs: cell.outputs.map(op => ({ outputId: op.outputId, outputs: op.outputs })),\n\t\t\t\tmetadata: cell.metadata,\n\t\t\t\tinternalMetadata: cell.internalMetadata,\n\t\t\t}))\n\t\t);\n\n\t\tconst toDispose = new DisposableStore();\n\n\t\tconst cellToDto = (cell: NotebookCellTextModel): IMainCellDto => {\n\t\t\treturn {\n\t\t\t\thandle: cell.handle,\n\t\t\t\turl: cell.uri.toString(),\n\t\t\t\tsource: cell.textBuffer.getLinesContent(),\n\t\t\t\teol: cell.textBuffer.getEOL(),\n\t\t\t\tversionId: 0,\n\t\t\t\tlanguage: cell.language,\n\t\t\t\tcellKind: cell.cellKind,\n\t\t\t\toutputs: cell.outputs.map(op => ({ outputId: op.outputId, outputs: op.outputs })),\n\t\t\t\tmetadata: cell.metadata,\n\t\t\t\tinternalMetadata: cell.internalMetadata,\n\t\t\t};\n\t\t};\n\n\t\tconst cellHandlers = new Set<NotebookCellTextModel>();\n\t\tconst addCellContentChangeHandler = (cell: NotebookCellTextModel) => {\n\t\t\tcellHandlers.add(cell);\n\t\t\ttoDispose.add(cell.onDidChangeContent((e) => {\n\t\t\t\tif (typeof e === 'object' && e.type === 'model') {\n\t\t\t\t\tthis._proxy.$acceptCellModelChanged(modelUrl, cell.handle, e.event);\n\t\t\t\t}\n\t\t\t}));\n\t\t};\n\n\t\tmodel.cells.forEach(cell => addCellContentChangeHandler(cell));\n\t\t// Possible some of the models have not yet been loaded.\n\t\t// If all have been loaded, for all cells, then no need to listen to model add events.\n\t\tif (model.cells.length !== cellHandlers.size) {\n\t\t\ttoDispose.add(this._modelService.onModelAdded((textModel: ITextModel) => {\n\t\t\t\tif (textModel.uri.scheme !== Schemas.vscodeNotebookCell || !(textModel instanceof TextModel)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cellUri = CellUri.parse(textModel.uri);\n\t\t\t\tif (!cellUri || !isEqual(cellUri.notebook, model.uri)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cell = model.cells.find(cell => cell.handle === cellUri.handle);\n\t\t\t\tif (cell) {\n\t\t\t\t\taddCellContentChangeHandler(cell);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\ttoDispose.add(model.onDidChangeContent((event) => {\n\t\t\tconst dto: NotebookRawContentEventDto[] = [];\n\t\t\tevent.rawEvents\n\t\t\t\t.forEach(e => {\n\t\t\t\t\tswitch (e.kind) {\n\t\t\t\t\t\tcase NotebookCellsChangeType.ModelChange:\n\t\t\t\t\t\tcase NotebookCellsChangeType.Initialize: {\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: e.kind,\n\t\t\t\t\t\t\t\tchanges: e.changes.map(diff => [diff[0], diff[1], diff[2].map(cell => cellToDto(cell as NotebookCellTextModel))] as [number, number, IMainCellDto[]])\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tfor (const change of e.changes) {\n\t\t\t\t\t\t\t\tfor (const cell of change[2]) {\n\t\t\t\t\t\t\t\t\taddCellContentChangeHandler(cell as NotebookCellTextModel);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase NotebookCellsChangeType.Move: {\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: NotebookCellsChangeType.Move,\n\t\t\t\t\t\t\t\tindex: e.index,\n\t\t\t\t\t\t\t\tlength: e.length,\n\t\t\t\t\t\t\t\tnewIdx: e.newIdx,\n\t\t\t\t\t\t\t\tcells: e.cells.map(cell => cellToDto(cell as NotebookCellTextModel))\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase NotebookCellsChangeType.ChangeCellContent:\n\t\t\t\t\t\t\t// Changes to cell content are handled by the cell model change listener.\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookCellsChangeType.ChangeDocumentMetadata:\n\t\t\t\t\t\t\tdto.push({\n\t\t\t\t\t\t\t\tkind: e.kind,\n\t\t\t\t\t\t\t\tmetadata: e.metadata\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdto.push(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tthis._proxy.$acceptModelChanged(modelUrl.toString(), {\n\t\t\t\trawEvents: dto,\n\t\t\t\tversionId: event.versionId\n\t\t\t});\n\t\t}));\n\n\t\ttoDispose.add(model.onWillDispose(() => {\n\t\t\tthis._stopModelSync(modelUrl);\n\t\t}));\n\t\ttoDispose.add(toDisposable(() => {\n\t\t\tthis._proxy.$acceptRemovedModel(modelUrl);\n\t\t}));\n\n\t\tthis._syncedModels[modelUrl] = toDispose;\n\t}\n\n\tprivate _stopModelSync(modelUrl: string): void {\n\t\tconst toDispose = this._syncedModels[modelUrl];\n\t\tdelete this._syncedModels[modelUrl];\n\t\tdelete this._syncedModelsLastUsedTime[modelUrl];\n\t\tdispose(toDispose);\n\t}\n}\n\nclass NotebookWorkerClient extends Disposable {\n\tprivate _worker: IWebWorkerClient<NotebookWorker> | null;\n\tprivate _modelManager: NotebookEditorModelManager | null;\n\n\n\tconstructor(\n\t\tprivate readonly _notebookService: INotebookService,\n\t\tprivate readonly _modelService: IModelService,\n\t\tprivate readonly _webWorkerService: IWebWorkerService,\n\t) {\n\t\tsuper();\n\t\tthis._worker = null;\n\t\tthis._modelManager = null;\n\n\t}\n\n\tcomputeDiff(original: URI, modified: URI) {\n\t\tconst proxy = this._ensureSyncedResources([original, modified]);\n\t\treturn proxy.$computeDiff(original.toString(), modified.toString());\n\t}\n\n\tcanPromptRecommendation(modelUri: URI) {\n\t\tconst proxy = this._ensureSyncedResources([modelUri]);\n\t\treturn proxy.$canPromptRecommendation(modelUri.toString());\n\t}\n\n\tprivate _getOrCreateModelManager(proxy: Proxied<NotebookWorker>): NotebookEditorModelManager {\n\t\tif (!this._modelManager) {\n\t\t\tthis._modelManager = this._register(new NotebookEditorModelManager(proxy, this._notebookService, this._modelService));\n\t\t}\n\t\treturn this._modelManager;\n\t}\n\n\tprotected _ensureSyncedResources(resources: URI[]): Proxied<NotebookWorker> {\n\t\tconst proxy = this._getOrCreateWorker().proxy;\n\t\tthis._getOrCreateModelManager(proxy).ensureSyncedResources(resources);\n\t\treturn proxy;\n\t}\n\n\tprivate _getOrCreateWorker(): IWebWorkerClient<NotebookWorker> {\n\t\tif (!this._worker) {\n\t\t\ttry {\n\t\t\t\tthis._worker = this._register(this._webWorkerService.createWorkerClient<NotebookWorker>(\n\t\t\t\t\tnew WebWorkerDescriptor({\n\t\t\t\t\t\tesmModuleLocation: FileAccess.asBrowserUri('vs/workbench/contrib/notebook/common/services/notebookWebWorkerMain.js'),\n\t\t\t\t\t\tlabel: 'NotebookEditorWorker'\n\t\t\t\t\t})\n\t\t\t\t));\n\t\t\t} catch (err) {\n\t\t\t\tthrow (err);\n\t\t\t}\n\t\t}\n\t\treturn this._worker;\n\t}\n}\n"]}