{"version":3,"sources":["vs/workbench/contrib/notebook/browser/view/cellParts/codeCell.ts"],"names":[],"mappings":"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","file":"codeCell.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// allow-any-unicode-comment-file\n\nimport { localize } from '../../../../../../nls.js';\nimport * as DOM from '../../../../../../base/browser/dom.js';\nimport { raceCancellation } from '../../../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../../base/common/codicons.js';\nimport { Event } from '../../../../../../base/common/event.js';\nimport { Disposable, IDisposable, toDisposable } from '../../../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../../../base/common/numbers.js';\nimport * as strings from '../../../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../../../base/common/themables.js';\nimport { EditorOption } from '../../../../../../editor/common/config/editorOptions.js';\nimport { IDimension } from '../../../../../../editor/common/core/2d/dimension.js';\nimport { ILanguageService } from '../../../../../../editor/common/languages/language.js';\nimport { tokenizeToStringSync } from '../../../../../../editor/common/languages/textToHtmlTokenizer.js';\nimport { IReadonlyTextBuffer, ITextModel } from '../../../../../../editor/common/model.js';\nimport { CodeActionController } from '../../../../../../editor/contrib/codeAction/browser/codeActionController.js';\nimport { IConfigurationService } from '../../../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../../platform/keybinding/common/keybinding.js';\nimport { INotebookExecutionStateService } from '../../../common/notebookExecutionStateService.js';\nimport { CellFocusMode, EXPAND_CELL_INPUT_COMMAND_ID, IActiveNotebookEditorDelegate } from '../../notebookBrowser.js';\nimport { CodeCellViewModel, outputDisplayLimit } from '../../viewModel/codeCellViewModel.js';\nimport { CellPartsCollection } from '../cellPart.js';\nimport { NotebookCellEditorPool } from '../notebookCellEditorPool.js';\nimport { CodeCellRenderTemplate, collapsedCellTTPolicy } from '../notebookRenderingCommon.js';\nimport { CellEditorOptions } from './cellEditorOptions.js';\nimport { CellOutputContainer } from './cellOutput.js';\nimport { CollapsedCodeCellExecutionIcon } from './codeCellExecutionIcon.js';\nimport { INotebookLoggingService } from '../../../common/notebookLoggingService.js';\n\n\nexport class CodeCell extends Disposable {\n\tprivate _outputContainerRenderer: CellOutputContainer;\n\tprivate _inputCollapseElement: HTMLElement | undefined;\n\n\tprivate _renderedInputCollapseState: boolean | undefined;\n\tprivate _renderedOutputCollapseState: boolean | undefined;\n\tprivate _isDisposed: boolean = false;\n\tprivate readonly cellParts: CellPartsCollection;\n\n\tprivate _collapsedExecutionIcon: CollapsedCodeCellExecutionIcon;\n\tprivate _cellEditorOptions: CellEditorOptions;\n\tprivate _useNewApproachForEditorLayout = true;\n\tprivate readonly _cellLayout: CodeCellLayout;\n\tprivate readonly _debug: (output: string) => void;\n\tconstructor(\n\t\tprivate readonly notebookEditor: IActiveNotebookEditorDelegate,\n\t\tprivate readonly viewCell: CodeCellViewModel,\n\t\tprivate readonly templateData: CodeCellRenderTemplate,\n\t\tprivate readonly editorPool: NotebookCellEditorPool,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t\t@IConfigurationService private configurationService: IConfigurationService,\n\t\t@INotebookExecutionStateService notebookExecutionStateService: INotebookExecutionStateService,\n\t\t@INotebookLoggingService notebookLogService: INotebookLoggingService,\n\t) {\n\t\tsuper();\n\t\tconst cellIndex = this.notebookEditor.getCellIndex(this.viewCell);\n\t\tconst debugPrefix = `[Cell ${cellIndex}]`;\n\t\tconst debug = this._debug = (output: string) => {\n\t\t\tnotebookLogService.debug('CellLayout', `${debugPrefix} ${output}`);\n\t\t};\n\n\t\tthis._cellEditorOptions = this._register(new CellEditorOptions(this.notebookEditor.getBaseCellEditorOptions(viewCell.language), this.notebookEditor.notebookOptions, this.configurationService));\n\t\tthis._outputContainerRenderer = this.instantiationService.createInstance(CellOutputContainer, notebookEditor, viewCell, templateData, { limit: outputDisplayLimit });\n\t\tthis.cellParts = this._register(templateData.cellParts.concatContentPart([this._cellEditorOptions, this._outputContainerRenderer], DOM.getWindow(notebookEditor.getDomNode())));\n\n\t\tconst initialEditorDimension = { height: this.calculateInitEditorHeight(), width: this.viewCell.layoutInfo.editorWidth };\n\t\tthis._cellLayout = new CodeCellLayout(this._useNewApproachForEditorLayout, notebookEditor, viewCell, templateData, { debug }, initialEditorDimension);\n\t\tthis.initializeEditor(initialEditorDimension);\n\t\tthis._renderedInputCollapseState = false; // editor is always expanded initially\n\n\t\tthis.registerNotebookEditorListeners();\n\t\tthis.registerViewCellLayoutChange();\n\t\tthis.registerCellEditorEventListeners();\n\t\tthis.registerMouseListener();\n\n\t\tthis._register(Event.any(this.viewCell.onDidStartExecution, this.viewCell.onDidStopExecution)((e) => {\n\t\t\tthis.cellParts.updateForExecutionState(this.viewCell, e);\n\t\t}));\n\n\t\tthis._register(this.viewCell.onDidChangeState(e => {\n\t\t\tthis.cellParts.updateState(this.viewCell, e);\n\n\t\t\tif (e.outputIsHoveredChanged) {\n\t\t\t\tthis.updateForOutputHover();\n\t\t\t}\n\n\t\t\tif (e.outputIsFocusedChanged) {\n\t\t\t\tthis.updateForOutputFocus();\n\t\t\t}\n\n\t\t\tif (e.metadataChanged || e.internalMetadataChanged) {\n\t\t\t\tthis.updateEditorOptions();\n\t\t\t}\n\n\t\t\tif (e.inputCollapsedChanged || e.outputCollapsedChanged) {\n\t\t\t\tthis.viewCell.pauseLayout();\n\t\t\t\tconst updated = this.updateForCollapseState();\n\t\t\t\tthis.viewCell.resumeLayout();\n\t\t\t\tif (updated) {\n\t\t\t\t\tthis.relayoutCell();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.focusModeChanged) {\n\t\t\t\tthis.updateEditorForFocusModeChange(true);\n\t\t\t}\n\t\t}));\n\n\t\tthis.updateEditorOptions();\n\t\tthis.updateEditorForFocusModeChange(false);\n\t\tthis.updateForOutputHover();\n\t\tthis.updateForOutputFocus();\n\n\t\tthis.cellParts.scheduleRenderCell(this.viewCell);\n\n\t\tthis._register(toDisposable(() => {\n\t\t\tthis.cellParts.unrenderCell(this.viewCell);\n\t\t}));\n\n\n\t\t// Render Outputs\n\t\tthis.viewCell.editorHeight = initialEditorDimension.height;\n\t\tthis._outputContainerRenderer.render();\n\t\tthis._renderedOutputCollapseState = false; // the output is always rendered initially\n\t\t// Need to do this after the intial renderOutput\n\t\tthis.initialViewUpdateExpanded();\n\n\t\tthis._register(this.viewCell.onLayoutInfoRead(() => {\n\t\t\tthis.cellParts.prepareLayout();\n\t\t}));\n\n\t\tconst executionItemElement = DOM.append(this.templateData.cellInputCollapsedContainer, DOM.$('.collapsed-execution-icon'));\n\t\tthis._register(toDisposable(() => {\n\t\t\texecutionItemElement.remove();\n\t\t}));\n\t\tthis._collapsedExecutionIcon = this._register(this.instantiationService.createInstance(CollapsedCodeCellExecutionIcon, this.notebookEditor, this.viewCell, executionItemElement));\n\t\tthis.updateForCollapseState();\n\n\t\tthis._register(Event.runAndSubscribe(viewCell.onDidChangeOutputs, this.updateForOutputs.bind(this)));\n\t\tthis._register(Event.runAndSubscribe(viewCell.onDidChangeLayout, this.updateForLayout.bind(this)));\n\n\t\tthis._cellEditorOptions.setLineNumbers(this.viewCell.lineNumbers);\n\t\ttemplateData.editor.updateOptions(this._cellEditorOptions.getUpdatedValue(this.viewCell.internalMetadata, this.viewCell.uri));\n\t}\n\n\tprivate updateCodeCellOptions(templateData: CodeCellRenderTemplate) {\n\t\ttemplateData.editor.updateOptions(this._cellEditorOptions.getUpdatedValue(this.viewCell.internalMetadata, this.viewCell.uri));\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tthis._register({ dispose() { cts.dispose(true); } });\n\t\traceCancellation(this.viewCell.resolveTextModel(), cts.token).then(model => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (model) {\n\t\t\t\tmodel.updateOptions({\n\t\t\t\t\tindentSize: this._cellEditorOptions.indentSize,\n\t\t\t\t\ttabSize: this._cellEditorOptions.tabSize,\n\t\t\t\t\tinsertSpaces: this._cellEditorOptions.insertSpaces,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _pendingLayout: IDisposable | undefined;\n\n\tprivate updateForLayout(): void {\n\t\tthis._pendingLayout?.dispose();\n\t\tthis._pendingLayout = DOM.modify(DOM.getWindow(this.notebookEditor.getDomNode()), () => {\n\t\t\tthis.cellParts.updateInternalLayoutNow(this.viewCell);\n\t\t});\n\t}\n\n\tprivate updateForOutputHover() {\n\t\tthis.templateData.container.classList.toggle('cell-output-hover', this.viewCell.outputIsHovered);\n\t}\n\n\tprivate updateForOutputFocus() {\n\t\tthis.templateData.container.classList.toggle('cell-output-focus', this.viewCell.outputIsFocused);\n\t}\n\n\tprivate calculateInitEditorHeight() {\n\t\tconst lineNum = this.viewCell.lineCount;\n\t\tconst lineHeight = this.viewCell.layoutInfo.fontInfo?.lineHeight || 17;\n\t\tconst editorPadding = this.notebookEditor.notebookOptions.computeEditorPadding(this.viewCell.internalMetadata, this.viewCell.uri);\n\t\tconst editorHeight = this.viewCell.layoutInfo.editorHeight === 0\n\t\t\t? lineNum * lineHeight + editorPadding.top + editorPadding.bottom\n\t\t\t: this.viewCell.layoutInfo.editorHeight;\n\t\treturn editorHeight;\n\t}\n\n\tprivate initializeEditor(dimension: IDimension) {\n\t\tthis._debug(`Initialize Editor ${dimension.height} x ${dimension.width}, Scroll Top = ${this.notebookEditor.scrollTop}`);\n\t\tthis._cellLayout.layoutEditor('init');\n\t\tthis.layoutEditor(dimension);\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tthis._register({ dispose() { cts.dispose(true); } });\n\t\traceCancellation(this.viewCell.resolveTextModel(), cts.token).then(model => {\n\t\t\tif (this._isDisposed || model?.isDisposed()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (model && this.templateData.editor) {\n\t\t\t\tthis._reigsterModelListeners(model);\n\n\t\t\t\t// set model can trigger view update, which can lead to dispose of this cell\n\t\t\t\tthis.templateData.editor.setModel(model);\n\n\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmodel.updateOptions({\n\t\t\t\t\tindentSize: this._cellEditorOptions.indentSize,\n\t\t\t\t\ttabSize: this._cellEditorOptions.tabSize,\n\t\t\t\t\tinsertSpaces: this._cellEditorOptions.insertSpaces,\n\t\t\t\t});\n\t\t\t\tthis.viewCell.attachTextEditor(this.templateData.editor, this.viewCell.layoutInfo.estimatedHasHorizontalScrolling);\n\t\t\t\tconst focusEditorIfNeeded = () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.notebookEditor.getActiveCell() === this.viewCell &&\n\t\t\t\t\t\tthis.viewCell.focusMode === CellFocusMode.Editor &&\n\t\t\t\t\t\t(this.notebookEditor.hasEditorFocus() || this.notebookEditor.getDomNode().ownerDocument.activeElement === this.notebookEditor.getDomNode().ownerDocument.body)) // Don't steal focus from other workbench parts, but if body has focus, we can take it\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.templateData.editor.focus();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tfocusEditorIfNeeded();\n\n\t\t\t\tconst realContentHeight = this.templateData.editor.getContentHeight();\n\t\t\t\tif (realContentHeight !== dimension.height) {\n\t\t\t\t\tthis.onCellEditorHeightChange('onDidResolveTextModel');\n\t\t\t\t}\n\n\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfocusEditorIfNeeded();\n\t\t\t}\n\n\t\t\tthis._register(this._cellEditorOptions.onDidChange(() => this.updateCodeCellOptions(this.templateData)));\n\t\t});\n\t}\n\n\tprivate updateForOutputs(): void {\n\t\tDOM.setVisibility(this.viewCell.outputsViewModels.length > 0, this.templateData.focusSinkElement);\n\t}\n\n\tprivate updateEditorOptions() {\n\t\tconst editor = this.templateData.editor;\n\t\tif (!editor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isReadonly = this.notebookEditor.isReadOnly;\n\t\tconst padding = this.notebookEditor.notebookOptions.computeEditorPadding(this.viewCell.internalMetadata, this.viewCell.uri);\n\t\tconst options = editor.getOptions();\n\t\tif (options.get(EditorOption.readOnly) !== isReadonly || options.get(EditorOption.padding) !== padding) {\n\t\t\teditor.updateOptions({\n\t\t\t\treadOnly: this.notebookEditor.isReadOnly, padding: this.notebookEditor.notebookOptions.computeEditorPadding(this.viewCell.internalMetadata, this.viewCell.uri)\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate registerNotebookEditorListeners() {\n\t\tthis._register(this.notebookEditor.onDidScroll(() => {\n\t\t\tthis.adjustEditorPosition();\n\t\t\tthis._cellLayout.layoutEditor('nbDidScroll');\n\t\t}));\n\n\t\tthis._register(this.notebookEditor.onDidChangeLayout(() => {\n\t\t\tthis.adjustEditorPosition();\n\t\t\tthis.onCellWidthChange('nbLayoutChange');\n\t\t}));\n\t}\n\n\tprivate adjustEditorPosition() {\n\t\tif (this._useNewApproachForEditorLayout) {\n\t\t\treturn;\n\t\t}\n\t\tconst extraOffset = -6 /** distance to the top of the cell editor, which is 6px under the focus indicator */ - 1 /** border */;\n\t\tconst min = 0;\n\n\t\tconst scrollTop = this.notebookEditor.scrollTop;\n\t\tconst elementTop = this.notebookEditor.getAbsoluteTopOfElement(this.viewCell);\n\t\tconst diff = scrollTop - elementTop + extraOffset;\n\n\t\tconst notebookEditorLayout = this.notebookEditor.getLayoutInfo();\n\n\t\t// we should stop adjusting the top when users are viewing the bottom of the cell editor\n\t\tconst editorMaxHeight = notebookEditorLayout.height\n\t\t\t- notebookEditorLayout.stickyHeight\n\t\t\t- 26 /** notebook toolbar */;\n\n\t\tconst maxTop =\n\t\t\tthis.viewCell.layoutInfo.editorHeight\n\t\t\t// + this.viewCell.layoutInfo.statusBarHeight\n\t\t\t- editorMaxHeight\n\t\t\t;\n\t\tconst top = maxTop > 20 ?\n\t\t\tclamp(min, diff, maxTop) :\n\t\t\tmin;\n\t\tthis.templateData.editorPart.style.top = `${top}px`;\n\t\t// scroll the editor with top\n\t\tthis.templateData.editor.setScrollTop(top);\n\t}\n\n\tprivate registerViewCellLayoutChange() {\n\t\tthis._register(this.viewCell.onDidChangeLayout((e) => {\n\t\t\tif (e.outerWidth !== undefined) {\n\t\t\t\tconst layoutInfo = this.templateData.editor.getLayoutInfo();\n\t\t\t\tif (layoutInfo.width !== this.viewCell.layoutInfo.editorWidth) {\n\t\t\t\t\tthis.onCellWidthChange('viewCellLayoutChange');\n\t\t\t\t\tthis.adjustEditorPosition();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate registerCellEditorEventListeners() {\n\t\tthis._register(this.templateData.editor.onDidContentSizeChange((e) => {\n\t\t\tif (e.contentHeightChanged) {\n\t\t\t\tif (this.viewCell.layoutInfo.editorHeight !== e.contentHeight) {\n\t\t\t\t\tthis.onCellEditorHeightChange(`onDidContentSizeChange`);\n\t\t\t\t\tthis.adjustEditorPosition();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tif (this._useNewApproachForEditorLayout) {\n\t\t\tthis._register(this.templateData.editor.onDidScrollChange(e => {\n\t\t\t\tif (this._cellLayout.editorVisibility === 'Invisible' || !this.templateData.editor.hasTextFocus()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._cellLayout._lastChangedEditorScrolltop === e.scrollTop || this._cellLayout.isUpdatingLayout) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst scrollTop = this.notebookEditor.scrollTop;\n\t\t\t\tconst diff = e.scrollTop - (this._cellLayout._lastChangedEditorScrolltop ?? 0);\n\t\t\t\tif (this._cellLayout.editorVisibility === 'Full (Small Viewport)' && typeof this._cellLayout._lastChangedEditorScrolltop === 'number') {\n\t\t\t\t\tthis._debug(`Scroll Change (1) = ${e.scrollTop} changed by ${diff} (notebook scrollTop: ${scrollTop}, setEditorScrollTop: ${e.scrollTop})`);\n\t\t\t\t\t// this.templateData.editor.setScrollTop(e.scrollTop);\n\t\t\t\t} else if (this._cellLayout.editorVisibility === 'Bottom Clipped' && typeof this._cellLayout._lastChangedEditorScrolltop === 'number') {\n\t\t\t\t\tthis._debug(`Scroll Change (2) = ${e.scrollTop} changed by ${diff} (notebook scrollTop: ${scrollTop}, setNotebookScrollTop: ${scrollTop + e.scrollTop})`);\n\t\t\t\t\tthis.notebookEditor.setScrollTop(scrollTop + e.scrollTop);\n\t\t\t\t} else if (this._cellLayout.editorVisibility === 'Top Clipped' && typeof this._cellLayout._lastChangedEditorScrolltop === 'number') {\n\t\t\t\t\tconst newScrollTop = scrollTop + diff - 1;\n\t\t\t\t\tthis._debug(`Scroll Change (3) = ${e.scrollTop} changed by ${diff} (notebook scrollTop: ${scrollTop}, setNotebookScrollTop?: ${newScrollTop})`);\n\t\t\t\t\tif (scrollTop !== newScrollTop) {\n\t\t\t\t\t\tthis.notebookEditor.setScrollTop(newScrollTop);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._debug(`Scroll Change (4) = ${e.scrollTop} changed by ${diff} (notebook scrollTop: ${scrollTop})`);\n\t\t\t\t\tthis._cellLayout._lastChangedEditorScrolltop = undefined;\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis._register(this.templateData.editor.onDidChangeCursorSelection((e) => {\n\t\t\tif (\n\t\t\t\t// do not reveal the cell into view if this selection change was caused by restoring editors\n\t\t\t\te.source === 'restoreState' || e.oldModelVersionId === 0\n\t\t\t\t// nor if the text editor is not actually focused (e.g. inline chat is focused and modifying the cell content)\n\t\t\t\t|| !this.templateData.editor.hasTextFocus()\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selections = this.templateData.editor.getSelections();\n\n\t\t\tif (selections?.length) {\n\t\t\t\tconst contentHeight = this.templateData.editor.getContentHeight();\n\t\t\t\tconst layoutContentHeight = this.viewCell.layoutInfo.editorHeight;\n\n\t\t\t\tif (contentHeight !== layoutContentHeight) {\n\t\t\t\t\tif (!this._useNewApproachForEditorLayout) {\n\t\t\t\t\t\tthis._debug(`onDidChangeCursorSelection`);\n\t\t\t\t\t\tthis.onCellEditorHeightChange('onDidChangeCursorSelection');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst lastSelection = selections[selections.length - 1];\n\t\t\t\tthis.notebookEditor.revealRangeInViewAsync(this.viewCell, lastSelection);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.templateData.editor.onDidBlurEditorWidget(() => {\n\t\t\tCodeActionController.get(this.templateData.editor)?.hideLightBulbWidget();\n\t\t}));\n\t}\n\n\tprivate _reigsterModelListeners(model: ITextModel) {\n\t\tthis._register(model.onDidChangeTokens(() => {\n\t\t\tif (this.viewCell.isInputCollapsed && this._inputCollapseElement) {\n\t\t\t\t// flush the collapsed input with the latest tokens\n\t\t\t\tconst content = this._getRichTextFromLineTokens(model);\n\t\t\t\tthis._inputCollapseElement.innerHTML = (collapsedCellTTPolicy?.createHTML(content) ?? content) as string;\n\t\t\t\tthis._attachInputExpandButton(this._inputCollapseElement);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate registerMouseListener() {\n\t\tthis._register(this.templateData.editor.onMouseDown(e => {\n\t\t\t// prevent default on right mouse click, otherwise it will trigger unexpected focus changes\n\t\t\t// the catch is, it means we don't allow customization of right button mouse down handlers other than the built in ones.\n\t\t\tif (e.event.rightButton) {\n\t\t\t\te.event.preventDefault();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate shouldPreserveEditor() {\n\t\t// The DOM focus needs to be adjusted:\n\t\t// when a cell editor should be focused\n\t\t// the document active element is inside the notebook editor or the document body (cell editor being disposed previously)\n\t\treturn this.notebookEditor.getActiveCell() === this.viewCell\n\t\t\t&& this.viewCell.focusMode === CellFocusMode.Editor\n\t\t\t&& (this.notebookEditor.hasEditorFocus() || this.notebookEditor.getDomNode().ownerDocument.activeElement === this.notebookEditor.getDomNode().ownerDocument.body);\n\t}\n\n\tprivate updateEditorForFocusModeChange(sync: boolean) {\n\t\tif (this.shouldPreserveEditor()) {\n\t\t\tif (sync) {\n\t\t\t\tthis.templateData.editor.focus();\n\t\t\t} else {\n\t\t\t\tthis._register(DOM.runAtThisOrScheduleAtNextAnimationFrame(DOM.getWindow(this.templateData.container), () => {\n\t\t\t\t\tthis.templateData.editor.focus();\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tthis.templateData.container.classList.toggle('cell-editor-focus', this.viewCell.focusMode === CellFocusMode.Editor);\n\t\tthis.templateData.container.classList.toggle('cell-output-focus', this.viewCell.focusMode === CellFocusMode.Output);\n\t}\n\tprivate updateForCollapseState(): boolean {\n\t\tif (this.viewCell.isOutputCollapsed === this._renderedOutputCollapseState &&\n\t\t\tthis.viewCell.isInputCollapsed === this._renderedInputCollapseState) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.viewCell.layoutChange({ editorHeight: true });\n\n\t\tif (this.viewCell.isInputCollapsed) {\n\t\t\tthis._collapseInput();\n\t\t} else {\n\t\t\tthis._showInput();\n\t\t}\n\n\t\tif (this.viewCell.isOutputCollapsed) {\n\t\t\tthis._collapseOutput();\n\t\t} else {\n\t\t\tthis._showOutput(false);\n\t\t}\n\n\t\tthis.relayoutCell();\n\n\t\tthis._renderedOutputCollapseState = this.viewCell.isOutputCollapsed;\n\t\tthis._renderedInputCollapseState = this.viewCell.isInputCollapsed;\n\n\t\treturn true;\n\t}\n\n\tprivate _collapseInput() {\n\t\t// hide the editor and execution label, keep the run button\n\t\tDOM.hide(this.templateData.editorPart);\n\t\tthis.templateData.container.classList.toggle('input-collapsed', true);\n\n\t\t// remove input preview\n\t\tthis._removeInputCollapsePreview();\n\n\t\tthis._collapsedExecutionIcon.setVisibility(true);\n\n\t\t// update preview\n\t\tconst richEditorText = this.templateData.editor.hasModel() ? this._getRichTextFromLineTokens(this.templateData.editor.getModel()) : this._getRichText(this.viewCell.textBuffer, this.viewCell.language);\n\t\tconst element = DOM.$('div.cell-collapse-preview');\n\t\telement.innerHTML = (collapsedCellTTPolicy?.createHTML(richEditorText) ?? richEditorText) as string;\n\t\tthis._inputCollapseElement = element;\n\t\tthis.templateData.cellInputCollapsedContainer.appendChild(element);\n\t\tthis._attachInputExpandButton(element);\n\n\t\tDOM.show(this.templateData.cellInputCollapsedContainer);\n\t}\n\n\tprivate _attachInputExpandButton(element: HTMLElement) {\n\t\tconst expandIcon = DOM.$('span.expandInputIcon');\n\t\tconst keybinding = this.keybindingService.lookupKeybinding(EXPAND_CELL_INPUT_COMMAND_ID);\n\t\tif (keybinding) {\n\t\t\telement.title = localize('cellExpandInputButtonLabelWithDoubleClick', \"Double-click to expand cell input ({0})\", keybinding.getLabel());\n\t\t\texpandIcon.title = localize('cellExpandInputButtonLabel', \"Expand Cell Input ({0})\", keybinding.getLabel());\n\t\t}\n\n\t\texpandIcon.classList.add(...ThemeIcon.asClassNameArray(Codicon.more));\n\t\telement.appendChild(expandIcon);\n\t}\n\n\tprivate _showInput() {\n\t\tthis._collapsedExecutionIcon.setVisibility(false);\n\t\tDOM.show(this.templateData.editorPart);\n\t\tDOM.hide(this.templateData.cellInputCollapsedContainer);\n\t}\n\n\tprivate _getRichText(buffer: IReadonlyTextBuffer, language: string) {\n\t\treturn tokenizeToStringSync(this.languageService, buffer.getLineContent(1), language);\n\t}\n\n\tprivate _getRichTextFromLineTokens(model: ITextModel) {\n\t\tlet result = `<div class=\"monaco-tokenized-source\">`;\n\n\t\tconst firstLineTokens = model.tokenization.getLineTokens(1);\n\t\tconst viewLineTokens = firstLineTokens.inflate();\n\t\tconst line = model.getLineContent(1);\n\t\tlet startOffset = 0;\n\t\tfor (let j = 0, lenJ = viewLineTokens.getCount(); j < lenJ; j++) {\n\t\t\tconst type = viewLineTokens.getClassName(j);\n\t\t\tconst endIndex = viewLineTokens.getEndOffset(j);\n\t\t\tresult += `<span class=\"${type}\">${strings.escape(line.substring(startOffset, endIndex))}</span>`;\n\t\t\tstartOffset = endIndex;\n\t\t}\n\n\t\tresult += `</div>`;\n\t\treturn result;\n\t}\n\n\tprivate _removeInputCollapsePreview() {\n\t\tconst children = this.templateData.cellInputCollapsedContainer.children;\n\t\tconst elements = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tif (children[i].classList.contains('cell-collapse-preview')) {\n\t\t\t\telements.push(children[i]);\n\t\t\t}\n\t\t}\n\n\t\telements.forEach(element => {\n\t\t\telement.remove();\n\t\t});\n\t}\n\n\tprivate _updateOutputInnerContainer(hide: boolean) {\n\t\tconst children = this.templateData.outputContainer.domNode.children;\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tif (children[i].classList.contains('output-inner-container')) {\n\t\t\t\tDOM.setVisibility(!hide, children[i] as HTMLElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _collapseOutput() {\n\t\tthis.templateData.container.classList.toggle('output-collapsed', true);\n\t\tDOM.show(this.templateData.cellOutputCollapsedContainer);\n\t\tthis._updateOutputInnerContainer(true);\n\t\tthis._outputContainerRenderer.viewUpdateHideOuputs();\n\t}\n\n\tprivate _showOutput(initRendering: boolean) {\n\t\tthis.templateData.container.classList.toggle('output-collapsed', false);\n\t\tDOM.hide(this.templateData.cellOutputCollapsedContainer);\n\t\tthis._updateOutputInnerContainer(false);\n\t\tthis._outputContainerRenderer.viewUpdateShowOutputs(initRendering);\n\t}\n\n\tprivate initialViewUpdateExpanded(): void {\n\t\tthis.templateData.container.classList.toggle('input-collapsed', false);\n\t\tDOM.show(this.templateData.editorPart);\n\t\tDOM.hide(this.templateData.cellInputCollapsedContainer);\n\t\tthis.templateData.container.classList.toggle('output-collapsed', false);\n\t\tthis._showOutput(true);\n\t}\n\n\tprivate layoutEditor(dimension: IDimension): void {\n\t\tif (this._useNewApproachForEditorLayout) {\n\t\t\treturn;\n\t\t}\n\t\tconst editorLayout = this.notebookEditor.getLayoutInfo();\n\t\tconst maxHeight = Math.min(\n\t\t\teditorLayout.height\n\t\t\t- editorLayout.stickyHeight\n\t\t\t- 26 /** notebook toolbar */,\n\t\t\tdimension.height\n\t\t);\n\t\tthis._debug(`Layout Editor: Width = ${dimension.width}, Height = ${maxHeight} (Requested: ${dimension.height}, Editor Layout Height: ${editorLayout.height}, Sticky: ${editorLayout.stickyHeight})`);\n\t\tthis.templateData.editor.layout({\n\t\t\twidth: dimension.width,\n\t\t\theight: maxHeight\n\t\t}, true);\n\t}\n\n\tprivate onCellWidthChange(dbgReasonForChange: CellLayoutChangeReason): void {\n\t\tthis._debug(`Cell Editor Width Change, ${dbgReasonForChange}, Content Height = ${this.templateData.editor.getContentHeight()}`);\n\t\tconst height = this.templateData.editor.getContentHeight();\n\t\tif (this.templateData.editor.hasModel()) {\n\t\t\tthis._debug(`**** Updating Cell Editor Height (1), ContentHeight: ${height}, CodeCellLayoutInfo.EditorWidth ${this.viewCell.layoutInfo.editorWidth}, EditorLayoutInfo ${this.templateData.editor.getLayoutInfo().height} ****`);\n\t\t\tthis.viewCell.editorHeight = height;\n\t\t\tthis.relayoutCell();\n\t\t\tthis.layoutEditor(\n\t\t\t\t{\n\t\t\t\t\twidth: this.viewCell.layoutInfo.editorWidth,\n\t\t\t\t\theight\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tthis._debug(`Cell Editor Width Change without model, return (1), ContentHeight: ${height}, CodeCellLayoutInfo.EditorWidth ${this.viewCell.layoutInfo.editorWidth}, EditorLayoutInfo ${this.templateData.editor.getLayoutInfo().height}`);\n\t\t}\n\t\tthis._cellLayout.layoutEditor(dbgReasonForChange);\n\t}\n\n\tprivate onCellEditorHeightChange(dbgReasonForChange: CellLayoutChangeReason): void {\n\t\tconst height = this.templateData.editor.getContentHeight();\n\t\tif (!this.templateData.editor.hasModel()) {\n\t\t\tthis._debug(`Cell Editor Height Change without model, return (2), ContentHeight: ${height}, CodeCellLayoutInfo.EditorWidth ${this.viewCell.layoutInfo.editorWidth}, EditorLayoutInfo ${this.templateData.editor.getLayoutInfo()}`);\n\t\t}\n\t\tthis._debug(`Cell Editor Height Change (${dbgReasonForChange}): ${height}`);\n\t\tthis._debug(`**** Updating Cell Editor Height (2), ContentHeight: ${height}, CodeCellLayoutInfo.EditorWidth ${this.viewCell.layoutInfo.editorWidth}, EditorLayoutInfo ${this.templateData.editor.getLayoutInfo().height} ****`);\n\t\tconst viewLayout = this.templateData.editor.getLayoutInfo();\n\t\tthis.viewCell.editorHeight = height;\n\t\tthis.relayoutCell();\n\t\tthis.layoutEditor(\n\t\t\t{\n\t\t\t\twidth: viewLayout.width,\n\t\t\t\theight\n\t\t\t}\n\t\t);\n\t\tthis._cellLayout.layoutEditor(dbgReasonForChange);\n\t}\n\n\trelayoutCell() {\n\t\tthis.notebookEditor.layoutNotebookCell(this.viewCell, this.viewCell.layoutInfo.totalHeight);\n\t}\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\n\t\t// move focus back to the cell list otherwise the focus goes to body\n\t\tif (this.shouldPreserveEditor()) {\n\t\t\t// now the focus is on the monaco editor for the cell but detached from the rows.\n\t\t\tthis.editorPool.preserveFocusedEditor(this.viewCell);\n\t\t}\n\n\t\tthis.viewCell.detachTextEditor();\n\t\tthis._removeInputCollapsePreview();\n\t\tthis._outputContainerRenderer.dispose();\n\t\tthis._pendingLayout?.dispose();\n\n\t\tsuper.dispose();\n\t}\n}\n\ntype CellLayoutChangeReason = 'nbLayoutChange' | 'nbDidScroll' | 'viewCellLayoutChange' | 'init' | 'onDidChangeCursorSelection' | 'onDidContentSizeChange' | 'onDidResolveTextModel';\n\nexport class CodeCellLayout {\n\tprivate _editorVisibility?: 'Full' | 'Top Clipped' | 'Bottom Clipped' | 'Full (Small Viewport)' | 'Invisible';\n\tpublic get editorVisibility() {\n\t\treturn this._editorVisibility;\n\t}\n\tprivate _isUpdatingLayout?: boolean;\n\tpublic get isUpdatingLayout() {\n\t\treturn this._isUpdatingLayout;\n\t}\n\tpublic _previousScrollBottom?: number;\n\tpublic _lastChangedEditorScrolltop?: number;\n\tprivate _initialized: boolean = false;\n\tconstructor(\n\t\tprivate readonly _enabled: boolean,\n\t\tprivate readonly notebookEditor: IActiveNotebookEditorDelegate,\n\t\tprivate readonly viewCell: CodeCellViewModel,\n\t\tprivate readonly templateData: CodeCellRenderTemplate,\n\t\tprivate readonly _logService: { debug: (output: string) => void },\n\t\tprivate readonly _initialEditorDimension: IDimension\n\t) {\n\t}\n\t/**\n\t * Dynamically lays out the code cell's Monaco editor to simulate a \"sticky\" run/exec area while\n\t * constraining the visible editor height to the notebook viewport. It adjusts two things:\n\t *  - The absolute `top` offset of the editor part inside the cell (so the run / execution order\n\t *    area remains visible for a limited vertical travel band ~45px).\n\t *  - The editor's layout height plus the editor's internal scroll position (`editorScrollTop`) to\n\t *    crop content when the cell is partially visible (top or bottom clipped) or when content is\n\t *    taller than the viewport.\n\t *\n\t * ---------------------------------------------------------------------------\n\t * SECTION 1. OVERALL NOTEBOOK VIEW (EACH CELL HAS AN 18px GAP ABOVE IT)\n\t * Legend:\n\t *   GAP (between cells & before first cell) ............. 18px\n\t *   CELL PADDING (top & bottom inside cell) ............. 6px\n\t *   STATUS BAR HEIGHT (typical) ......................... 22px\n\t *   LINE HEIGHT (logic clamp) ........................... 21px\n\t *   BORDER/OUTLINE HEIGHT (visual conceal adjustment) ... 1px\n\t *   EDITOR_HEIGHT (example visible editor) .............. 200px (capped by viewport)\n\t *   EDITOR_CONTENT_HEIGHT (example full content) ........ 380px (e.g. 50 lines)\n\t *   extraOffset = -(CELL_PADDING + BORDER_HEIGHT) ....... -7\n\t *\n\t *   (The list ensures the editor's laid out height never exceeds viewport height.)\n\t *\n\t *    Notebook Viewport (scrolling container) \n\t *    (scrollTop)                                                                                       \n\t *                                                                                                      \n\t *     18px GAP (top spacing before first cell)                                                         \n\t *                                                                                                     \n\t *      Cell A Outer Container    \n\t *       6px top padding                                                                             \n\t *                                                                                                   \n\t *         Execution Order / Run Column (~45px vertical travel band)   Editor Part     \n\t *         (Run button, execution # label)                               Visible Lines ...       \n\t *                                                                                               \n\t *                                                                       EDITOR_HEIGHT=200px     \n\t *                                                                       (Content=380px)         \n\t *              \n\t *                                                                                                   \n\t *         Status Bar (22px)     \n\t *         language | indent | selection info | kernel/status bits ...                             \n\t *            \n\t *                                                                                                   \n\t *       6px bottom padding                                                                          \n\t *        \n\t *     18px GAP                                                                                         \n\t *      Cell B Outer Container    \n\t *      (same structure as Cell A)                                                                    \n\t *        \n\t *                                                                                                      \n\t *    (scrollBottom)                                                                                    \n\t *   \n\t *\n\t * SECTION 2. SINGLE CELL STRUCTURE (VERTICAL LAYERS)\n\t *\n\t *   Inter-Cell GAP (18px)\n\t *    Cell Wrapper (<li>) \n\t *     .cell-inner-container  \n\t *     6px top padding                                                               \n\t *                                                                                   \n\t *      Left Gutter (Run / Exec / Focus Border)  Editor Part   \n\t *       Sticky vertical travel (~45px allowance)   (Monaco surface)              \n\t *                                                Visible height 200px            \n\t *                                                Content height 380px            \n\t *       \n\t *                                                                                   \n\t *      Status Bar (22px)   \n\t *      language | indent | selection | kernel | state                             \n\t *       \n\t *     6px bottom padding                                                            \n\t *     \n\t *    (Outputs region begins at outputContainerOffset below input area)                \n\t *   \n\t */\n\tpublic layoutEditor(reason: CellLayoutChangeReason): void {\n\t\tif (!this._enabled) {\n\t\t\treturn;\n\t\t}\n\t\tconst element = this.templateData.editorPart;\n\t\tif (this.viewCell.isInputCollapsed) {\n\t\t\telement.style.top = '';\n\t\t\treturn;\n\t\t}\n\n\t\tconst LINE_HEIGHT = this.notebookEditor.getLayoutInfo().fontInfo.lineHeight; // 21;\n\t\tconst CELL_TOP_MARGIN = this.viewCell.layoutInfo.topMargin;\n\t\tconst CELL_OUTLINE_WIDTH = this.viewCell.layoutInfo.outlineWidth; // 1 extra px for border (we don't want to be able to see the cell border when scrolling up);\n\t\tconst STATUSBAR_HEIGHT = this.viewCell.layoutInfo.statusBarHeight;\n\n\n\t\tconst editor = this.templateData.editor;\n\t\tconst editorLayout = this.templateData.editor.getLayoutInfo();\n\t\t// If we've already initialized once, we should use the viewCell layout info for editor width.\n\t\t// E.g. when resizing VS Code window or notebook editor (horizontal space changes).\n\t\tconst editorWidth = this._initialized && (reason === 'nbLayoutChange' || reason === 'viewCellLayoutChange') ? this.viewCell.layoutInfo.editorWidth : editorLayout.width;\n\t\tconst editorHeight = this.viewCell.layoutInfo.editorHeight;\n\t\tconst scrollTop = this.notebookEditor.scrollTop;\n\t\tconst elementTop = this.notebookEditor.getAbsoluteTopOfElement(this.viewCell);\n\t\tconst elementBottom = this.notebookEditor.getAbsoluteBottomOfElement(this.viewCell);\n\t\tconst elementHeight = this.notebookEditor.getHeightOfElement(this.viewCell);\n\t\tconst gotContentHeight = editor.getContentHeight();\n\t\tconst editorContentHeight = Math.max((gotContentHeight === -1 ? editor.getLayoutInfo().height : gotContentHeight), gotContentHeight === -1 ? this._initialEditorDimension.height : gotContentHeight); // || this.calculatedEditorHeight || 0;\n\t\tconst editorBottom = elementTop + this.viewCell.layoutInfo.outputContainerOffset;\n\t\tconst scrollBottom = this.notebookEditor.scrollBottom;\n\t\t// When loading, scrollBottom -scrollTop === 0;\n\t\tconst viewportHeight = scrollBottom - scrollTop === 0 ? this.notebookEditor.getLayoutInfo().height : scrollBottom - scrollTop;\n\t\tconst outputContainerOffset = this.viewCell.layoutInfo.outputContainerOffset;\n\t\tconst scrollDirection: 'down' | 'up' = typeof this._previousScrollBottom === 'number' ? (scrollBottom < this._previousScrollBottom ? 'up' : 'down') : 'down';\n\t\tthis._previousScrollBottom = scrollBottom;\n\n\t\tlet top = Math.max(0, scrollTop - elementTop - CELL_TOP_MARGIN - CELL_OUTLINE_WIDTH);\n\t\tconst possibleEditorHeight = editorHeight - top;\n\t\tif (possibleEditorHeight < LINE_HEIGHT) {\n\t\t\ttop = top - (LINE_HEIGHT - possibleEditorHeight) - CELL_OUTLINE_WIDTH;\n\t\t}\n\n\t\tlet height = editorContentHeight;\n\t\tlet editorScrollTop = 0;\n\t\tif (scrollTop <= (elementTop + CELL_TOP_MARGIN)) {\n\t\t\tconst minimumEditorHeight = LINE_HEIGHT + this.notebookEditor.notebookOptions.getLayoutConfiguration().editorTopPadding;\n\t\t\tif (scrollBottom >= editorBottom) {\n\t\t\t\theight = clamp(editorContentHeight, minimumEditorHeight, editorContentHeight);\n\t\t\t\tthis._editorVisibility = 'Full';\n\t\t\t} else {\n\t\t\t\theight = clamp(scrollBottom - (elementTop + CELL_TOP_MARGIN) - STATUSBAR_HEIGHT, minimumEditorHeight, editorContentHeight) + (2 * CELL_OUTLINE_WIDTH); // We don't want bottom border to be visible.;\n\t\t\t\tthis._editorVisibility = 'Bottom Clipped';\n\t\t\t\teditorScrollTop = 0;\n\t\t\t}\n\t\t} else {\n\t\t\tif (viewportHeight <= editorContentHeight && scrollBottom <= editorBottom) {\n\t\t\t\tconst minimumEditorHeight = LINE_HEIGHT + this.notebookEditor.notebookOptions.getLayoutConfiguration().editorTopPadding;\n\t\t\t\theight = clamp(viewportHeight - STATUSBAR_HEIGHT, minimumEditorHeight, editorContentHeight - STATUSBAR_HEIGHT) + (2 * CELL_OUTLINE_WIDTH); // We don't want bottom border to be visible.\n\t\t\t\tthis._editorVisibility = 'Full (Small Viewport)';\n\t\t\t\teditorScrollTop = top;\n\t\t\t} else {\n\t\t\t\tconst minimumEditorHeight = LINE_HEIGHT;\n\t\t\t\theight = clamp(editorContentHeight - (scrollTop - (elementTop + CELL_TOP_MARGIN)), minimumEditorHeight, editorContentHeight);\n\t\t\t\t// Check if the cell is visible.\n\t\t\t\tif (scrollTop > editorBottom) {\n\t\t\t\t\tthis._editorVisibility = 'Invisible';\n\t\t\t\t} else {\n\t\t\t\t\tthis._editorVisibility = 'Top Clipped';\n\t\t\t\t}\n\t\t\t\teditorScrollTop = editorContentHeight - height;\n\t\t\t}\n\t\t}\n\n\t\tthis._logService.debug(`${reason} (${this._editorVisibility})`);\n\t\tthis._logService.debug(`=> Editor Top = ${top}px (editHeight = ${editorHeight}, editContentHeight: ${editorContentHeight})`);\n\t\tthis._logService.debug(`=> eleTop = ${elementTop}, eleBottom = ${elementBottom}, eleHeight = ${elementHeight}`);\n\t\tthis._logService.debug(`=> scrollTop = ${scrollTop}, top = ${top}`);\n\t\tthis._logService.debug(`=> cellTopMargin = ${CELL_TOP_MARGIN}, cellBottomMargin = ${this.viewCell.layoutInfo.topMargin}, cellOutline = ${CELL_OUTLINE_WIDTH}`);\n\t\tthis._logService.debug(`=> scrollBottom: ${scrollBottom}, editBottom: ${editorBottom}, viewport: ${viewportHeight}, scroll: ${scrollDirection}, contOffset: ${outputContainerOffset})`);\n\t\tthis._logService.debug(`=> Editor Height = ${height}px, Width: ${editorWidth}px, Initial Width: ${this._initialEditorDimension.width}, EditorScrollTop = ${editorScrollTop}px, StatusbarHeight = ${STATUSBAR_HEIGHT}, lineHeight = ${this.notebookEditor.getLayoutInfo().fontInfo.lineHeight}`);\n\n\t\ttry {\n\t\t\tthis._isUpdatingLayout = true;\n\t\t\telement.style.top = `${top}px`;\n\t\t\teditor.layout({\n\t\t\t\twidth: this._initialized ? editorWidth : this._initialEditorDimension.width,\n\t\t\t\theight\n\t\t\t}, true);\n\t\t\tif (editorScrollTop >= 0) {\n\t\t\t\tthis._lastChangedEditorScrolltop = editorScrollTop;\n\t\t\t\teditor.setScrollTop(editorScrollTop);\n\t\t\t}\n\t\t} finally {\n\t\t\tthis._initialized = true;\n\t\t\tthis._isUpdatingLayout = false;\n\t\t\tthis._logService.debug('Updated Editor Layout');\n\t\t}\n\t}\n}\n"]}