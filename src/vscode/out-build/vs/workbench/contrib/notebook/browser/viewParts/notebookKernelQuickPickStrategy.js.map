{"version":3,"sources":["vs/workbench/contrib/notebook/browser/viewParts/notebookKernelQuickPickStrategy.ts"],"names":[],"mappings":"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","file":"notebookKernelQuickPickStrategy.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from '../../../../../base/common/actions.js';\nimport { groupBy } from '../../../../../base/common/arrays.js';\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { MarshalledId } from '../../../../../base/common/marshallingIds.js';\nimport { uppercaseFirstLetter } from '../../../../../base/common/strings.js';\nimport { Command } from '../../../../../editor/common/languages.js';\nimport { localize } from '../../../../../nls.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { ILogService } from '../../../../../platform/log/common/log.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { ProgressLocation } from '../../../../../platform/progress/common/progress.js';\nimport { IQuickInputButton, IQuickInputService, IQuickPick, IQuickPickItem, QuickPickInput } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { IExtension, IExtensionsWorkbenchService } from '../../../extensions/common/extensions.js';\nimport { IActiveNotebookEditor, INotebookExtensionRecommendation, JUPYTER_EXTENSION_ID, KERNEL_RECOMMENDATIONS } from '../notebookBrowser.js';\nimport { NotebookEditorWidget } from '../notebookEditorWidget.js';\nimport { executingStateIcon, selectKernelIcon } from '../notebookIcons.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { INotebookKernel, INotebookKernelHistoryService, INotebookKernelMatchResult, INotebookKernelService, ISourceAction } from '../../common/notebookKernelService.js';\nimport { IExtensionService } from '../../../../services/extensions/common/extensions.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { INotebookTextModel } from '../../common/notebookCommon.js';\nimport { SELECT_KERNEL_ID } from '../controller/coreActions.js';\nimport { EnablementState, IExtensionManagementServerService } from '../../../../services/extensionManagement/common/extensionManagement.js';\nimport { areSameExtensions } from '../../../../../platform/extensionManagement/common/extensionManagementUtil.js';\n\ntype KernelPick = IQuickPickItem & { kernel: INotebookKernel };\nfunction isKernelPick(item: QuickPickInput<IQuickPickItem>): item is KernelPick {\n\treturn 'kernel' in item;\n}\ntype GroupedKernelsPick = IQuickPickItem & { kernels: INotebookKernel[]; source: string };\nfunction isGroupedKernelsPick(item: QuickPickInput<IQuickPickItem>): item is GroupedKernelsPick {\n\treturn 'kernels' in item;\n}\ntype SourcePick = IQuickPickItem & { action: ISourceAction };\nfunction isSourcePick(item: QuickPickInput<IQuickPickItem>): item is SourcePick {\n\treturn 'action' in item;\n}\ntype InstallExtensionPick = IQuickPickItem & { extensionIds: string[] };\nfunction isInstallExtensionPick(item: QuickPickInput<IQuickPickItem>): item is InstallExtensionPick {\n\treturn item.id === 'installSuggested' && 'extensionIds' in item;\n}\ntype SearchMarketplacePick = IQuickPickItem & { id: 'install' };\nfunction isSearchMarketplacePick(item: QuickPickInput<IQuickPickItem>): item is SearchMarketplacePick {\n\treturn item.id === 'install';\n}\n\ntype KernelSourceQuickPickItem = IQuickPickItem & { command: Command; documentation?: string };\nfunction isKernelSourceQuickPickItem(item: IQuickPickItem): item is KernelSourceQuickPickItem {\n\treturn 'command' in item;\n}\n\nfunction supportAutoRun(item: QuickPickInput<IQuickPickItem>): item is IQuickPickItem {\n\treturn 'autoRun' in item && !!item.autoRun;\n}\ntype KernelQuickPickItem = (IQuickPickItem & { autoRun?: boolean }) | SearchMarketplacePick | InstallExtensionPick | KernelPick | GroupedKernelsPick | SourcePick | KernelSourceQuickPickItem;\nconst KERNEL_PICKER_UPDATE_DEBOUNCE = 200;\n\nexport type KernelQuickPickContext =\n\t{ id: string; extension: string } |\n\t{ notebookEditorId: string } |\n\t{ id: string; extension: string; notebookEditorId: string } |\n\t{ ui?: boolean; notebookEditor?: NotebookEditorWidget; skipIfAlreadySelected?: boolean };\n\nexport interface IKernelPickerStrategy {\n\tshowQuickPick(editor: IActiveNotebookEditor, wantedKernelId?: string): Promise<boolean>;\n}\n\nfunction toKernelQuickPick(kernel: INotebookKernel, selected: INotebookKernel | undefined) {\n\tconst res: KernelPick = {\n\t\tkernel,\n\t\tpicked: kernel.id === selected?.id,\n\t\tlabel: kernel.label,\n\t\tdescription: kernel.description,\n\t\tdetail: kernel.detail\n\t};\n\tif (kernel.id === selected?.id) {\n\t\tif (!res.description) {\n\t\t\tres.description = localize('current1', \"Currently Selected\");\n\t\t} else {\n\t\t\tres.description = localize('current2', \"{0} - Currently Selected\", res.description);\n\t\t}\n\t}\n\treturn res;\n}\n\n\nabstract class KernelPickerStrategyBase implements IKernelPickerStrategy {\n\tconstructor(\n\t\tprotected readonly _notebookKernelService: INotebookKernelService,\n\t\tprotected readonly _productService: IProductService,\n\t\tprotected readonly _quickInputService: IQuickInputService,\n\t\tprotected readonly _labelService: ILabelService,\n\t\tprotected readonly _logService: ILogService,\n\t\tprotected readonly _extensionWorkbenchService: IExtensionsWorkbenchService,\n\t\tprotected readonly _extensionService: IExtensionService,\n\t\tprotected readonly _commandService: ICommandService,\n\t\tprotected readonly _extensionManagementServerService: IExtensionManagementServerService\n\t) { }\n\n\tasync showQuickPick(editor: IActiveNotebookEditor, wantedId?: string, skipAutoRun?: boolean): Promise<boolean> {\n\t\tconst notebook = editor.textModel;\n\t\tconst scopedContextKeyService = editor.scopedContextKeyService;\n\t\tconst matchResult = this._getMatchingResult(notebook);\n\t\tconst { selected, all } = matchResult;\n\n\t\tlet newKernel: INotebookKernel | undefined;\n\t\tif (wantedId) {\n\t\t\tfor (const candidate of all) {\n\t\t\t\tif (candidate.id === wantedId) {\n\t\t\t\t\tnewKernel = candidate;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!newKernel) {\n\t\t\t\tthis._logService.warn(`wanted kernel DOES NOT EXIST, wanted: ${wantedId}, all: ${all.map(k => k.id)}`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (newKernel) {\n\t\t\tthis._selecteKernel(notebook, newKernel);\n\t\t\treturn true;\n\t\t}\n\n\n\t\tconst localDisposableStore = new DisposableStore();\n\t\tconst quickPick = localDisposableStore.add(this._quickInputService.createQuickPick<KernelQuickPickItem>({ useSeparators: true }));\n\t\tconst quickPickItems = this._getKernelPickerQuickPickItems(notebook, matchResult, this._notebookKernelService, scopedContextKeyService);\n\n\t\tif (quickPickItems.length === 1 && supportAutoRun(quickPickItems[0]) && !skipAutoRun) {\n\t\t\tconst picked = await this._handleQuickPick(editor, quickPickItems[0], quickPickItems as KernelQuickPickItem[]);\n\t\t\tlocalDisposableStore.dispose();\n\t\t\treturn picked;\n\t\t}\n\n\t\tquickPick.items = quickPickItems;\n\t\tquickPick.canSelectMany = false;\n\t\tquickPick.placeholder = selected\n\t\t\t? localize('prompt.placeholder.change', \"Change kernel for '{0}'\", this._labelService.getUriLabel(notebook.uri, { relative: true }))\n\t\t\t: localize('prompt.placeholder.select', \"Select kernel for '{0}'\", this._labelService.getUriLabel(notebook.uri, { relative: true }));\n\n\t\tquickPick.busy = this._notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n\n\t\tconst kernelDetectionTaskListener = this._notebookKernelService.onDidChangeKernelDetectionTasks(() => {\n\t\t\tquickPick.busy = this._notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n\t\t});\n\n\t\t// run extension recommendataion task if quickPickItems is empty\n\t\tconst extensionRecommendataionPromise = quickPickItems.length === 0\n\t\t\t? createCancelablePromise(token => this._showInstallKernelExtensionRecommendation(notebook, quickPick, this._extensionWorkbenchService, token))\n\t\t\t: undefined;\n\n\t\tconst kernelChangeEventListener = Event.debounce<void, void>(\n\t\t\tEvent.any(\n\t\t\t\tthis._notebookKernelService.onDidChangeSourceActions,\n\t\t\t\tthis._notebookKernelService.onDidAddKernel,\n\t\t\t\tthis._notebookKernelService.onDidRemoveKernel,\n\t\t\t\tthis._notebookKernelService.onDidChangeNotebookAffinity\n\t\t\t),\n\t\t\t(last, _current) => last,\n\t\t\tKERNEL_PICKER_UPDATE_DEBOUNCE\n\t\t)(async () => {\n\t\t\t// reset quick pick progress\n\t\t\tquickPick.busy = false;\n\t\t\textensionRecommendataionPromise?.cancel();\n\n\t\t\tconst currentActiveItems = quickPick.activeItems;\n\t\t\tconst matchResult = this._getMatchingResult(notebook);\n\t\t\tconst quickPickItems = this._getKernelPickerQuickPickItems(notebook, matchResult, this._notebookKernelService, scopedContextKeyService);\n\t\t\tquickPick.keepScrollPosition = true;\n\n\t\t\t// recalcuate active items\n\t\t\tconst activeItems: KernelQuickPickItem[] = [];\n\t\t\tfor (const item of currentActiveItems) {\n\t\t\t\tif (isKernelPick(item)) {\n\t\t\t\t\tconst kernelId = item.kernel.id;\n\t\t\t\t\tconst sameItem = quickPickItems.find(pi => isKernelPick(pi) && pi.kernel.id === kernelId) as KernelPick | undefined;\n\t\t\t\t\tif (sameItem) {\n\t\t\t\t\t\tactiveItems.push(sameItem);\n\t\t\t\t\t}\n\t\t\t\t} else if (isSourcePick(item)) {\n\t\t\t\t\tconst sameItem = quickPickItems.find(pi => isSourcePick(pi) && pi.action.action.id === item.action.action.id) as SourcePick | undefined;\n\t\t\t\t\tif (sameItem) {\n\t\t\t\t\t\tactiveItems.push(sameItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tquickPick.items = quickPickItems;\n\t\t\tquickPick.activeItems = activeItems;\n\t\t}, this);\n\n\t\tconst pick = await new Promise<{ selected: KernelQuickPickItem | undefined; items: KernelQuickPickItem[] }>((resolve, reject) => {\n\t\t\tlocalDisposableStore.add(quickPick.onDidAccept(() => {\n\t\t\t\tconst item = quickPick.selectedItems[0];\n\t\t\t\tif (item) {\n\t\t\t\t\tresolve({ selected: item, items: quickPick.items as KernelQuickPickItem[] });\n\t\t\t\t} else {\n\t\t\t\t\tresolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n\t\t\t\t}\n\n\t\t\t\tquickPick.hide();\n\t\t\t}));\n\n\t\t\tlocalDisposableStore.add(quickPick.onDidHide(() => {\n\t\t\t\tkernelDetectionTaskListener.dispose();\n\t\t\t\tkernelChangeEventListener.dispose();\n\t\t\t\tquickPick.dispose();\n\t\t\t\tresolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n\t\t\t}));\n\t\t\tquickPick.show();\n\t\t});\n\n\t\tlocalDisposableStore.dispose();\n\n\t\tif (pick.selected) {\n\t\t\treturn await this._handleQuickPick(editor, pick.selected, pick.items);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprotected _getMatchingResult(notebook: NotebookTextModel) {\n\t\treturn this._notebookKernelService.getMatchingKernel(notebook);\n\t}\n\n\tprotected abstract _getKernelPickerQuickPickItems(\n\t\tnotebookTextModel: NotebookTextModel,\n\t\tmatchResult: INotebookKernelMatchResult,\n\t\tnotebookKernelService: INotebookKernelService,\n\t\tscopedContextKeyService: IContextKeyService\n\t): QuickPickInput<KernelQuickPickItem>[];\n\n\tprotected async _handleQuickPick(editor: IActiveNotebookEditor, pick: KernelQuickPickItem, quickPickItems: KernelQuickPickItem[]): Promise<boolean> {\n\t\tif (isKernelPick(pick)) {\n\t\t\tconst newKernel = pick.kernel;\n\t\t\tthis._selecteKernel(editor.textModel, newKernel);\n\t\t\treturn true;\n\t\t}\n\n\t\t// actions\n\t\tif (isSearchMarketplacePick(pick)) {\n\t\t\tawait this._showKernelExtension(\n\t\t\t\tthis._extensionWorkbenchService,\n\t\t\t\tthis._extensionService,\n\t\t\t\tthis._extensionManagementServerService,\n\t\t\t\teditor.textModel.viewType,\n\t\t\t\t[]\n\t\t\t);\n\t\t\t// suggestedExtension must be defined for this option to be shown, but still check to make TS happy\n\t\t} else if (isInstallExtensionPick(pick)) {\n\t\t\tawait this._showKernelExtension(\n\t\t\t\tthis._extensionWorkbenchService,\n\t\t\t\tthis._extensionService,\n\t\t\t\tthis._extensionManagementServerService,\n\t\t\t\teditor.textModel.viewType,\n\t\t\t\tpick.extensionIds,\n\t\t\t\tthis._productService.quality !== 'stable'\n\t\t\t);\n\t\t} else if (isSourcePick(pick)) {\n\t\t\t// selected explicilty, it should trigger the execution?\n\t\t\tpick.action.runAction();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprotected _selecteKernel(notebook: NotebookTextModel, kernel: INotebookKernel) {\n\t\tthis._notebookKernelService.selectKernelForNotebook(kernel, notebook);\n\t}\n\n\tprotected async _showKernelExtension(\n\t\textensionWorkbenchService: IExtensionsWorkbenchService,\n\t\textensionService: IExtensionService,\n\t\textensionManagementServerService: IExtensionManagementServerService,\n\t\tviewType: string,\n\t\textIds: string[],\n\t\tisInsiders?: boolean\n\t) {\n\t\t// If extension id is provided attempt to install the extension as the user has requested the suggested ones be installed\n\t\tconst extensionsToInstall: IExtension[] = [];\n\t\tconst extensionsToInstallOnRemote: IExtension[] = [];\n\t\tconst extensionsToEnable: IExtension[] = [];\n\n\t\tfor (const extId of extIds) {\n\t\t\tconst extension = (await extensionWorkbenchService.getExtensions([{ id: extId }], CancellationToken.None))[0];\n\t\t\tif (extension.enablementState === EnablementState.DisabledGlobally || extension.enablementState === EnablementState.DisabledWorkspace || extension.enablementState === EnablementState.DisabledByEnvironment) {\n\t\t\t\textensionsToEnable.push(extension);\n\t\t\t} else if (!extensionWorkbenchService.installed.some(e => areSameExtensions(e.identifier, extension.identifier))) {\n\t\t\t\t// Install this extension only if it hasn't already been installed.\n\t\t\t\tconst canInstall = await extensionWorkbenchService.canInstall(extension);\n\t\t\t\tif (canInstall === true) {\n\t\t\t\t\textensionsToInstall.push(extension);\n\t\t\t\t}\n\t\t\t} else if (extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\t\t// already installed, check if it should be installed on remote since we are not getting any kernels or kernel providers.\n\t\t\t\tif (extensionWorkbenchService.installed.some(e => areSameExtensions(e.identifier, extension.identifier) && e.server === extensionManagementServerService.remoteExtensionManagementServer)) {\n\t\t\t\t\t// extension exists on remote server. should not happen\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\t// extension doesn't exist on remote server\n\t\t\t\t\tconst canInstall = await extensionWorkbenchService.canInstall(extension);\n\t\t\t\t\tif (canInstall) {\n\t\t\t\t\t\textensionsToInstallOnRemote.push(extension);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (extensionsToInstall.length || extensionsToEnable.length || extensionsToInstallOnRemote.length) {\n\t\t\tawait Promise.all([...extensionsToInstall.map(async extension => {\n\t\t\t\tawait extensionWorkbenchService.install(\n\t\t\t\t\textension,\n\t\t\t\t\t{\n\t\t\t\t\t\tinstallPreReleaseVersion: isInsiders ?? false,\n\t\t\t\t\t\tcontext: { skipWalkthrough: true },\n\t\t\t\t\t},\n\t\t\t\t\tProgressLocation.Notification\n\t\t\t\t);\n\t\t\t}), ...extensionsToEnable.map(async extension => {\n\t\t\t\tswitch (extension.enablementState) {\n\t\t\t\t\tcase EnablementState.DisabledWorkspace:\n\t\t\t\t\t\tawait extensionWorkbenchService.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase EnablementState.DisabledGlobally:\n\t\t\t\t\t\tawait extensionWorkbenchService.setEnablement([extension], EnablementState.EnabledGlobally);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase EnablementState.DisabledByEnvironment:\n\t\t\t\t\t\tawait extensionWorkbenchService.setEnablement([extension], EnablementState.EnabledByEnvironment);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}), ...extensionsToInstallOnRemote.map(async extension => {\n\t\t\t\tawait extensionWorkbenchService.installInServer(extension, this._extensionManagementServerService.remoteExtensionManagementServer!);\n\t\t\t})]);\n\n\t\t\tawait extensionService.activateByEvent(`onNotebook:${viewType}`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst pascalCased = viewType.split(/[^a-z0-9]/ig).map(uppercaseFirstLetter).join('');\n\t\tawait extensionWorkbenchService.openSearch(`@tag:notebookKernel${pascalCased}`);\n\t}\n\n\tprivate async _showInstallKernelExtensionRecommendation(\n\t\tnotebookTextModel: NotebookTextModel,\n\t\tquickPick: IQuickPick<KernelQuickPickItem, { useSeparators: true }>,\n\t\textensionWorkbenchService: IExtensionsWorkbenchService,\n\t\ttoken: CancellationToken\n\t) {\n\t\tquickPick.busy = true;\n\n\t\tconst newQuickPickItems = await this._getKernelRecommendationsQuickPickItems(notebookTextModel, extensionWorkbenchService);\n\t\tquickPick.busy = false;\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (newQuickPickItems && quickPick.items.length === 0) {\n\t\t\tquickPick.items = newQuickPickItems;\n\t\t}\n\t}\n\n\tprotected async _getKernelRecommendationsQuickPickItems(\n\t\tnotebookTextModel: NotebookTextModel,\n\t\textensionWorkbenchService: IExtensionsWorkbenchService,\n\t): Promise<QuickPickInput<SearchMarketplacePick | InstallExtensionPick>[] | undefined> {\n\t\tconst quickPickItems: QuickPickInput<SearchMarketplacePick | InstallExtensionPick>[] = [];\n\n\t\tconst language = this.getSuggestedLanguage(notebookTextModel);\n\t\tconst suggestedExtension: INotebookExtensionRecommendation | undefined = language ? this.getSuggestedKernelFromLanguage(notebookTextModel.viewType, language) : undefined;\n\t\tif (suggestedExtension) {\n\t\t\tawait extensionWorkbenchService.queryLocal();\n\n\t\t\tconst extensions = extensionWorkbenchService.installed.filter(e =>\n\t\t\t\t(e.enablementState === EnablementState.EnabledByEnvironment || e.enablementState === EnablementState.EnabledGlobally || e.enablementState === EnablementState.EnabledWorkspace)\n\t\t\t\t&& suggestedExtension.extensionIds.includes(e.identifier.id)\n\t\t\t);\n\n\t\t\tif (extensions.length === suggestedExtension.extensionIds.length) {\n\t\t\t\t// it's installed but might be detecting kernels\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\t// We have a suggested kernel, show an option to install it\n\t\t\tquickPickItems.push({\n\t\t\t\tid: 'installSuggested',\n\t\t\t\tdescription: suggestedExtension.displayName ?? suggestedExtension.extensionIds.join(', '),\n\t\t\t\tlabel: `$(${Codicon.lightbulb.id}) ` + localize('installSuggestedKernel', 'Install/Enable suggested extensions'),\n\t\t\t\textensionIds: suggestedExtension.extensionIds\n\t\t\t} satisfies InstallExtensionPick);\n\t\t}\n\t\t// there is no kernel, show the install from marketplace\n\t\tquickPickItems.push({\n\t\t\tid: 'install',\n\t\t\tlabel: localize('searchForKernels', \"Browse marketplace for kernel extensions\"),\n\t\t} satisfies SearchMarketplacePick);\n\n\t\treturn quickPickItems;\n\t}\n\n\t/**\n\t * Examine the most common language in the notebook\n\t * @param notebookTextModel The notebook text model\n\t * @returns What the suggested language is for the notebook. Used for kernal installing\n\t */\n\tprivate getSuggestedLanguage(notebookTextModel: NotebookTextModel): string | undefined {\n\t\tconst metaData = notebookTextModel.metadata;\n\t\tconst language_info = (metaData?.metadata as Record<string, unknown>)?.language_info as Record<string, string> | undefined;\n\t\tlet suggestedKernelLanguage: string | undefined = language_info?.name;\n\t\t// TODO how do we suggest multi language notebooks?\n\t\tif (!suggestedKernelLanguage) {\n\t\t\tconst cellLanguages = notebookTextModel.cells.map(cell => cell.language).filter(language => language !== 'markdown');\n\t\t\t// Check if cell languages is all the same\n\t\t\tif (cellLanguages.length > 1) {\n\t\t\t\tconst firstLanguage = cellLanguages[0];\n\t\t\t\tif (cellLanguages.every(language => language === firstLanguage)) {\n\t\t\t\t\tsuggestedKernelLanguage = firstLanguage;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn suggestedKernelLanguage;\n\t}\n\n\t/**\n\t * Given a language and notebook view type suggest a kernel for installation\n\t * @param language The language to find a suggested kernel extension for\n\t * @returns A recommednation object for the recommended extension, else undefined\n\t */\n\tprivate getSuggestedKernelFromLanguage(viewType: string, language: string): INotebookExtensionRecommendation | undefined {\n\t\tconst recommendation = KERNEL_RECOMMENDATIONS.get(viewType)?.get(language);\n\t\treturn recommendation;\n\t}\n}\n\nexport class KernelPickerMRUStrategy extends KernelPickerStrategyBase {\n\tconstructor(\n\t\t@INotebookKernelService _notebookKernelService: INotebookKernelService,\n\t\t@IProductService _productService: IProductService,\n\t\t@IQuickInputService _quickInputService: IQuickInputService,\n\t\t@ILabelService _labelService: ILabelService,\n\t\t@ILogService _logService: ILogService,\n\t\t@IExtensionsWorkbenchService _extensionWorkbenchService: IExtensionsWorkbenchService,\n\t\t@IExtensionService _extensionService: IExtensionService,\n\t\t@IExtensionManagementServerService _extensionManagementServerService: IExtensionManagementServerService,\n\t\t@ICommandService _commandService: ICommandService,\n\t\t@INotebookKernelHistoryService private readonly _notebookKernelHistoryService: INotebookKernelHistoryService,\n\t\t@IOpenerService private readonly _openerService: IOpenerService\n\n\t) {\n\t\tsuper(\n\t\t\t_notebookKernelService,\n\t\t\t_productService,\n\t\t\t_quickInputService,\n\t\t\t_labelService,\n\t\t\t_logService,\n\t\t\t_extensionWorkbenchService,\n\t\t\t_extensionService,\n\t\t\t_commandService,\n\t\t\t_extensionManagementServerService,\n\t\t);\n\t}\n\n\tprotected _getKernelPickerQuickPickItems(notebookTextModel: NotebookTextModel, matchResult: INotebookKernelMatchResult, notebookKernelService: INotebookKernelService, scopedContextKeyService: IContextKeyService): QuickPickInput<KernelQuickPickItem>[] {\n\t\tconst quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n\t\tif (matchResult.selected) {\n\t\t\tconst kernelItem = toKernelQuickPick(matchResult.selected, matchResult.selected);\n\t\t\tquickPickItems.push(kernelItem);\n\t\t}\n\n\t\tmatchResult.suggestions.filter(kernel => kernel.id !== matchResult.selected?.id).map(kernel => toKernelQuickPick(kernel, matchResult.selected))\n\t\t\t.forEach(kernel => {\n\t\t\t\tquickPickItems.push(kernel);\n\t\t\t});\n\n\t\tconst shouldAutoRun = quickPickItems.length === 0;\n\n\t\tif (quickPickItems.length > 0) {\n\t\t\tquickPickItems.push({\n\t\t\t\ttype: 'separator'\n\t\t\t});\n\t\t}\n\n\t\t// select another kernel quick pick\n\t\tquickPickItems.push({\n\t\t\tid: 'selectAnother',\n\t\t\tlabel: localize('selectAnotherKernel.more', \"Select Another Kernel...\"),\n\t\t\tautoRun: shouldAutoRun\n\t\t});\n\n\t\treturn quickPickItems;\n\t}\n\n\tprotected override _selecteKernel(notebook: NotebookTextModel, kernel: INotebookKernel): void {\n\t\tconst currentInfo = this._notebookKernelService.getMatchingKernel(notebook);\n\t\tif (currentInfo.selected) {\n\t\t\t// there is already a selected kernel\n\t\t\tthis._notebookKernelHistoryService.addMostRecentKernel(currentInfo.selected);\n\t\t}\n\t\tsuper._selecteKernel(notebook, kernel);\n\t\tthis._notebookKernelHistoryService.addMostRecentKernel(kernel);\n\t}\n\n\tprotected override _getMatchingResult(notebook: NotebookTextModel): INotebookKernelMatchResult {\n\t\tconst { selected, all } = this._notebookKernelHistoryService.getKernels(notebook);\n\t\tconst matchingResult = this._notebookKernelService.getMatchingKernel(notebook);\n\t\treturn {\n\t\t\tselected: selected,\n\t\t\tall: matchingResult.all,\n\t\t\tsuggestions: all,\n\t\t\thidden: []\n\t\t};\n\t}\n\n\tprotected override async _handleQuickPick(editor: IActiveNotebookEditor, pick: KernelQuickPickItem, items: KernelQuickPickItem[]): Promise<boolean> {\n\t\tif (pick.id === 'selectAnother') {\n\t\t\treturn this.displaySelectAnotherQuickPick(editor, items.length === 1 && items[0] === pick);\n\t\t}\n\n\t\treturn super._handleQuickPick(editor, pick, items);\n\t}\n\n\tprivate async displaySelectAnotherQuickPick(editor: IActiveNotebookEditor, kernelListEmpty: boolean): Promise<boolean> {\n\t\tconst notebook: NotebookTextModel = editor.textModel;\n\t\tconst disposables = new DisposableStore();\n\t\tconst quickPick = disposables.add(this._quickInputService.createQuickPick<KernelQuickPickItem>({ useSeparators: true }));\n\t\tconst quickPickItem = await new Promise<KernelQuickPickItem | IQuickInputButton | undefined>(resolve => {\n\t\t\t// select from kernel sources\n\t\t\tquickPick.title = kernelListEmpty ? localize('select', \"Select Kernel\") : localize('selectAnotherKernel', \"Select Another Kernel\");\n\t\t\tquickPick.placeholder = localize('selectKernel.placeholder', \"Type to choose a kernel source\");\n\t\t\tquickPick.busy = true;\n\t\t\tquickPick.buttons = [this._quickInputService.backButton];\n\t\t\tquickPick.show();\n\n\t\t\tdisposables.add(quickPick.onDidTriggerButton(button => {\n\t\t\t\tif (button === this._quickInputService.backButton) {\n\t\t\t\t\tresolve(button);\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(quickPick.onDidTriggerItemButton(async (e) => {\n\t\t\t\tif (isKernelSourceQuickPickItem(e.item) && e.item.documentation !== undefined) {\n\t\t\t\t\tconst uri = URI.isUri(e.item.documentation) ? URI.parse(e.item.documentation) : await this._commandService.executeCommand<URI>(e.item.documentation);\n\t\t\t\t\tif (uri) {\n\t\t\t\t\t\tvoid this._openerService.open(uri, { openExternal: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdisposables.add(quickPick.onDidAccept(async () => {\n\t\t\t\tresolve(quickPick.selectedItems[0]);\n\t\t\t}));\n\t\t\tdisposables.add(quickPick.onDidHide(() => {\n\t\t\t\tresolve(undefined);\n\t\t\t}));\n\n\t\t\tthis._calculdateKernelSources(editor).then(quickPickItems => {\n\t\t\t\tquickPick.items = quickPickItems;\n\t\t\t\tif (quickPick.items.length > 0) {\n\t\t\t\t\tquickPick.busy = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdisposables.add(Event.debounce<void, void>(\n\t\t\t\tEvent.any(\n\t\t\t\t\tthis._notebookKernelService.onDidChangeSourceActions,\n\t\t\t\t\tthis._notebookKernelService.onDidAddKernel,\n\t\t\t\t\tthis._notebookKernelService.onDidRemoveKernel\n\t\t\t\t),\n\t\t\t\t(last, _current) => last,\n\t\t\t\tKERNEL_PICKER_UPDATE_DEBOUNCE\n\t\t\t)(async () => {\n\t\t\t\tquickPick.busy = true;\n\t\t\t\tconst quickPickItems = await this._calculdateKernelSources(editor);\n\t\t\t\tquickPick.items = quickPickItems;\n\t\t\t\tquickPick.busy = false;\n\t\t\t}));\n\t\t});\n\n\t\tquickPick.hide();\n\t\tdisposables.dispose();\n\n\t\tif (quickPickItem === this._quickInputService.backButton) {\n\t\t\treturn this.showQuickPick(editor, undefined, true);\n\t\t}\n\n\t\tif (quickPickItem) {\n\t\t\tconst selectedKernelPickItem = quickPickItem as KernelQuickPickItem;\n\t\t\tif (isKernelSourceQuickPickItem(selectedKernelPickItem)) {\n\t\t\t\ttry {\n\t\t\t\t\tconst selectedKernelId = await this._executeCommand<string>(notebook, selectedKernelPickItem.command);\n\t\t\t\t\tif (selectedKernelId) {\n\t\t\t\t\t\tconst { all } = await this._getMatchingResult(notebook);\n\t\t\t\t\t\tconst kernel = all.find(kernel => kernel.id === `ms-toolsai.jupyter/${selectedKernelId}`);\n\t\t\t\t\t\tif (kernel) {\n\t\t\t\t\t\t\tawait this._selecteKernel(notebook, kernel);\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this.displaySelectAnotherQuickPick(editor, false);\n\t\t\t\t\t}\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (isKernelPick(selectedKernelPickItem)) {\n\t\t\t\tawait this._selecteKernel(notebook, selectedKernelPickItem.kernel);\n\t\t\t\treturn true;\n\t\t\t} else if (isGroupedKernelsPick(selectedKernelPickItem)) {\n\t\t\t\tawait this._selectOneKernel(notebook, selectedKernelPickItem.label, selectedKernelPickItem.kernels);\n\t\t\t\treturn true;\n\t\t\t} else if (isSourcePick(selectedKernelPickItem)) {\n\t\t\t\t// selected explicilty, it should trigger the execution?\n\t\t\t\ttry {\n\t\t\t\t\tawait selectedKernelPickItem.action.runAction();\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (isSearchMarketplacePick(selectedKernelPickItem)) {\n\t\t\t\tawait this._showKernelExtension(\n\t\t\t\t\tthis._extensionWorkbenchService,\n\t\t\t\t\tthis._extensionService,\n\t\t\t\t\tthis._extensionManagementServerService,\n\t\t\t\t\teditor.textModel.viewType,\n\t\t\t\t\t[]\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t} else if (isInstallExtensionPick(selectedKernelPickItem)) {\n\t\t\t\tawait this._showKernelExtension(\n\t\t\t\t\tthis._extensionWorkbenchService,\n\t\t\t\t\tthis._extensionService,\n\t\t\t\t\tthis._extensionManagementServerService,\n\t\t\t\t\teditor.textModel.viewType,\n\t\t\t\t\tselectedKernelPickItem.extensionIds,\n\t\t\t\t\tthis._productService.quality !== 'stable'\n\t\t\t\t);\n\t\t\t\treturn this.displaySelectAnotherQuickPick(editor, false);\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate async _calculdateKernelSources(editor: IActiveNotebookEditor) {\n\t\tconst notebook: NotebookTextModel = editor.textModel;\n\n\t\tconst sourceActionCommands = this._notebookKernelService.getSourceActions(notebook, editor.scopedContextKeyService);\n\t\tconst actions = await this._notebookKernelService.getKernelSourceActions2(notebook);\n\t\tconst matchResult = this._getMatchingResult(notebook);\n\n\t\tif (sourceActionCommands.length === 0 && matchResult.all.length === 0 && actions.length === 0) {\n\t\t\treturn await this._getKernelRecommendationsQuickPickItems(notebook, this._extensionWorkbenchService) ?? [];\n\t\t}\n\n\t\tconst others = matchResult.all.filter(item => item.extension.value !== JUPYTER_EXTENSION_ID);\n\t\tconst quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n\t\t// group controllers by extension\n\t\tfor (const group of groupBy(others, (a, b) => a.extension.value === b.extension.value ? 0 : 1)) {\n\t\t\tconst extension = this._extensionService.extensions.find(extension => extension.identifier.value === group[0].extension.value);\n\t\t\tconst source = extension?.displayName ?? extension?.description ?? group[0].extension.value;\n\t\t\tif (group.length > 1) {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tlabel: source,\n\t\t\t\t\tkernels: group\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tlabel: group[0].label,\n\t\t\t\t\tkernel: group[0]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst validActions = actions.filter(action => action.command);\n\n\t\tquickPickItems.push(...validActions.map(action => {\n\t\t\tconst buttons = action.documentation ? [{\n\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.info),\n\t\t\t\ttooltip: localize('learnMoreTooltip', 'Learn More'),\n\t\t\t}] : [];\n\t\t\treturn {\n\t\t\t\tid: typeof action.command! === 'string' ? action.command : action.command!.id,\n\t\t\t\tlabel: action.label,\n\t\t\t\tdescription: action.description,\n\t\t\t\tcommand: action.command,\n\t\t\t\tdocumentation: action.documentation,\n\t\t\t\tbuttons\n\t\t\t};\n\t\t}));\n\n\t\tfor (const sourceAction of sourceActionCommands) {\n\t\t\tconst res: SourcePick = {\n\t\t\t\taction: sourceAction,\n\t\t\t\tpicked: false,\n\t\t\t\tlabel: sourceAction.action.label,\n\t\t\t\ttooltip: sourceAction.action.tooltip\n\t\t\t};\n\n\t\t\tquickPickItems.push(res);\n\t\t}\n\n\t\treturn quickPickItems;\n\t}\n\n\tprivate async _selectOneKernel(notebook: NotebookTextModel, source: string, kernels: INotebookKernel[]) {\n\t\tconst quickPickItems: QuickPickInput<KernelPick>[] = kernels.map(kernel => toKernelQuickPick(kernel, undefined));\n\t\tconst localDisposableStore = new DisposableStore();\n\t\tconst quickPick = localDisposableStore.add(this._quickInputService.createQuickPick<KernelQuickPickItem>({ useSeparators: true }));\n\t\tquickPick.items = quickPickItems;\n\t\tquickPick.canSelectMany = false;\n\n\t\tquickPick.title = localize('selectKernelFromExtension', \"Select Kernel from {0}\", source);\n\n\t\tlocalDisposableStore.add(quickPick.onDidAccept(async () => {\n\t\t\tif (quickPick.selectedItems && quickPick.selectedItems.length > 0 && isKernelPick(quickPick.selectedItems[0])) {\n\t\t\t\tawait this._selecteKernel(notebook, quickPick.selectedItems[0].kernel);\n\t\t\t}\n\n\t\t\tquickPick.hide();\n\t\t\tquickPick.dispose();\n\t\t}));\n\n\t\tlocalDisposableStore.add(quickPick.onDidHide(() => {\n\t\t\tlocalDisposableStore.dispose();\n\t\t}));\n\n\t\tquickPick.show();\n\t}\n\n\tprivate async _executeCommand<T>(notebook: NotebookTextModel, command: string | Command): Promise<T | undefined | void> {\n\t\tconst id = typeof command === 'string' ? command : command.id;\n\t\tconst args = typeof command === 'string' ? [] : command.arguments ?? [];\n\n\t\tif (typeof command === 'string' || !command.arguments || !Array.isArray(command.arguments) || command.arguments.length === 0) {\n\t\t\targs.unshift({\n\t\t\t\turi: notebook.uri,\n\t\t\t\t$mid: MarshalledId.NotebookActionContext\n\t\t\t});\n\t\t}\n\n\t\tif (typeof command === 'string') {\n\t\t\treturn this._commandService.executeCommand(id);\n\t\t} else {\n\t\t\treturn this._commandService.executeCommand(id, ...args);\n\t\t}\n\t}\n\n\tstatic updateKernelStatusAction(notebook: NotebookTextModel, action: IAction, notebookKernelService: INotebookKernelService, notebookKernelHistoryService: INotebookKernelHistoryService) {\n\t\tconst detectionTasks = notebookKernelService.getKernelDetectionTasks(notebook);\n\t\tif (detectionTasks.length) {\n\t\t\tconst info = notebookKernelService.getMatchingKernel(notebook);\n\t\t\taction.enabled = true;\n\t\t\taction.class = ThemeIcon.asClassName(ThemeIcon.modify(executingStateIcon, 'spin'));\n\n\t\t\tif (info.selected) {\n\t\t\t\taction.label = info.selected.label;\n\t\t\t\tconst kernelInfo = info.selected.description ?? info.selected.detail;\n\t\t\t\taction.tooltip = kernelInfo\n\t\t\t\t\t? localize('kernels.selectedKernelAndKernelDetectionRunning', \"Selected Kernel: {0} (Kernel Detection Tasks Running)\", kernelInfo)\n\t\t\t\t\t: localize('kernels.detecting', \"Detecting Kernels\");\n\t\t\t} else {\n\t\t\t\taction.label = localize('kernels.detecting', \"Detecting Kernels\");\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst runningActions = notebookKernelService.getRunningSourceActions(notebook);\n\n\t\tconst updateActionFromSourceAction = (sourceAction: ISourceAction, running: boolean) => {\n\t\t\tconst sAction = sourceAction.action;\n\t\t\taction.class = running ? ThemeIcon.asClassName(ThemeIcon.modify(executingStateIcon, 'spin')) : ThemeIcon.asClassName(selectKernelIcon);\n\t\t\taction.label = sAction.label;\n\t\t\taction.enabled = true;\n\t\t};\n\n\t\tif (runningActions.length) {\n\t\t\treturn updateActionFromSourceAction(runningActions[0] /** TODO handle multiple actions state */, true);\n\t\t}\n\n\t\tconst { selected } = notebookKernelHistoryService.getKernels(notebook);\n\n\t\tif (selected) {\n\t\t\taction.label = selected.label;\n\t\t\taction.class = ThemeIcon.asClassName(selectKernelIcon);\n\t\t\taction.tooltip = selected.description ?? selected.detail ?? '';\n\t\t} else {\n\t\t\taction.label = localize('select', \"Select Kernel\");\n\t\t\taction.class = ThemeIcon.asClassName(selectKernelIcon);\n\t\t\taction.tooltip = '';\n\t\t}\n\t}\n\n\tstatic async resolveKernel(notebook: INotebookTextModel, notebookKernelService: INotebookKernelService, notebookKernelHistoryService: INotebookKernelHistoryService, commandService: ICommandService): Promise<INotebookKernel | undefined> {\n\t\tconst alreadySelected = notebookKernelHistoryService.getKernels(notebook);\n\n\t\tif (alreadySelected.selected) {\n\t\t\treturn alreadySelected.selected;\n\t\t}\n\n\t\tawait commandService.executeCommand(SELECT_KERNEL_ID);\n\t\tconst { selected } = notebookKernelHistoryService.getKernels(notebook);\n\t\treturn selected;\n\t}\n}\n"]}