{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/viewParts/notebookOverviewRuler.ts","vs/workbench/contrib/notebook/browser/viewParts/notebookOverviewRuler.ts"],"names":[],"mappings":"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","file":"notebookOverviewRuler.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getWindow } from '../../../../../base/browser/dom.js';\nimport { createFastDomNode, FastDomNode } from '../../../../../base/browser/fastDomNode.js';\nimport { PixelRatio } from '../../../../../base/browser/pixelRatio.js';\nimport { IThemeService, Themable } from '../../../../../platform/theme/common/themeService.js';\nimport { INotebookEditorDelegate, NotebookOverviewRulerLane } from '../notebookBrowser.js';\n\nexport class NotebookOverviewRuler extends Themable {\n\tprivate readonly _domNode: FastDomNode<HTMLCanvasElement>;\n\tprivate _lanes = 3;\n\n\tconstructor(readonly notebookEditor: INotebookEditorDelegate, container: HTMLElement, @IThemeService themeService: IThemeService) {\n\t\tsuper(themeService);\n\t\tthis._domNode = createFastDomNode(document.createElement('canvas'));\n\t\tthis._domNode.setPosition('relative');\n\t\tthis._domNode.setLayerHinting(true);\n\t\tthis._domNode.setContain('strict');\n\n\t\tcontainer.appendChild(this._domNode.domNode);\n\n\t\tthis._register(notebookEditor.onDidChangeDecorations(() => {\n\t\t\tthis.layout();\n\t\t}));\n\n\t\tthis._register(PixelRatio.getInstance(getWindow(this._domNode.domNode)).onDidChange(() => {\n\t\t\tthis.layout();\n\t\t}));\n\t}\n\n\tlayout() {\n\t\tconst width = 10;\n\t\tconst layoutInfo = this.notebookEditor.getLayoutInfo();\n\t\tconst scrollHeight = layoutInfo.scrollHeight;\n\t\tconst height = layoutInfo.height;\n\t\tconst ratio = PixelRatio.getInstance(getWindow(this._domNode.domNode)).value;\n\t\tthis._domNode.setWidth(width);\n\t\tthis._domNode.setHeight(height);\n\t\tthis._domNode.domNode.width = width * ratio;\n\t\tthis._domNode.domNode.height = height * ratio;\n\t\tconst ctx = this._domNode.domNode.getContext('2d')!;\n\t\tctx.clearRect(0, 0, width * ratio, height * ratio);\n\t\tthis._render(ctx, width * ratio, height * ratio, scrollHeight * ratio, ratio);\n\t}\n\n\tprivate _render(ctx: CanvasRenderingContext2D, width: number, height: number, scrollHeight: number, ratio: number) {\n\t\tconst viewModel = this.notebookEditor.getViewModel();\n\t\tconst fontInfo = this.notebookEditor.getLayoutInfo().fontInfo;\n\t\tconst laneWidth = width / this._lanes;\n\n\t\tlet currentFrom = 0;\n\n\t\tif (viewModel) {\n\t\t\tfor (let i = 0; i < viewModel.viewCells.length; i++) {\n\t\t\t\tconst viewCell = viewModel.viewCells[i];\n\t\t\t\tconst textBuffer = viewCell.textBuffer;\n\t\t\t\tconst decorations = viewCell.getCellDecorations();\n\t\t\t\tconst cellHeight = (viewCell.layoutInfo.totalHeight / scrollHeight) * ratio * height;\n\n\t\t\t\tdecorations.filter(decoration => decoration.overviewRuler).forEach(decoration => {\n\t\t\t\t\tconst overviewRuler = decoration.overviewRuler!;\n\t\t\t\t\tconst fillStyle = this.getColor(overviewRuler.color) ?? '#000000';\n\t\t\t\t\tconst lineHeight = Math.min(fontInfo.lineHeight, (viewCell.layoutInfo.editorHeight / scrollHeight / textBuffer.getLineCount()) * ratio * height);\n\t\t\t\t\tconst lineNumbers = overviewRuler.modelRanges.map(range => range.startLineNumber).reduce((previous: number[], current: number) => {\n\t\t\t\t\t\tif (previous.length === 0) {\n\t\t\t\t\t\t\tprevious.push(current);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst last = previous[previous.length - 1];\n\t\t\t\t\t\t\tif (last !== current) {\n\t\t\t\t\t\t\t\tprevious.push(current);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn previous;\n\t\t\t\t\t}, [] as number[]);\n\n\t\t\t\t\tlet x = 0;\n\t\t\t\t\tswitch (overviewRuler.position) {\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Left:\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Center:\n\t\t\t\t\t\t\tx = laneWidth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Right:\n\t\t\t\t\t\t\tx = laneWidth * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst width = overviewRuler.position === NotebookOverviewRulerLane.Full ? laneWidth * 3 : laneWidth;\n\n\t\t\t\t\tfor (let i = 0; i < lineNumbers.length; i++) {\n\t\t\t\t\t\tctx.fillStyle = fillStyle;\n\t\t\t\t\t\tconst lineNumber = lineNumbers[i];\n\t\t\t\t\t\tconst offset = (lineNumber - 1) * lineHeight;\n\t\t\t\t\t\tctx.fillRect(x, currentFrom + offset, width, lineHeight);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (overviewRuler.includeOutput) {\n\t\t\t\t\t\tctx.fillStyle = fillStyle;\n\t\t\t\t\t\tconst outputOffset = (viewCell.layoutInfo.editorHeight / scrollHeight) * ratio * height;\n\t\t\t\t\t\tconst decorationHeight = (fontInfo.lineHeight / scrollHeight) * ratio * height;\n\t\t\t\t\t\tctx.fillRect(laneWidth, currentFrom + outputOffset, laneWidth, decorationHeight);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tcurrentFrom += cellHeight;\n\t\t\t}\n\n\t\t\tconst overviewRulerDecorations = viewModel.getOverviewRulerDecorations();\n\n\t\t\tfor (let i = 0; i < overviewRulerDecorations.length; i++) {\n\t\t\t\tconst decoration = overviewRulerDecorations[i];\n\t\t\t\tif (!decoration.options.overviewRuler) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst viewZoneInfo = this.notebookEditor.getViewZoneLayoutInfo(decoration.viewZoneId);\n\n\t\t\t\tif (!viewZoneInfo) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst fillStyle = this.getColor(decoration.options.overviewRuler.color) ?? '#000000';\n\t\t\t\tlet x = 0;\n\t\t\t\tswitch (decoration.options.overviewRuler.position) {\n\t\t\t\t\tcase NotebookOverviewRulerLane.Left:\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase NotebookOverviewRulerLane.Center:\n\t\t\t\t\t\tx = laneWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase NotebookOverviewRulerLane.Right:\n\t\t\t\t\t\tx = laneWidth * 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst width = decoration.options.overviewRuler.position === NotebookOverviewRulerLane.Full ? laneWidth * 3 : laneWidth;\n\n\t\t\t\tctx.fillStyle = fillStyle;\n\n\t\t\t\tconst viewZoneHeight = (viewZoneInfo.height / scrollHeight) * ratio * height;\n\t\t\t\tconst viewZoneTop = (viewZoneInfo.top / scrollHeight) * ratio * height;\n\n\t\t\t\tctx.fillRect(x, viewZoneTop, width, viewZoneHeight);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getWindow } from '../../../../../base/browser/dom.js';\nimport { createFastDomNode, FastDomNode } from '../../../../../base/browser/fastDomNode.js';\nimport { PixelRatio } from '../../../../../base/browser/pixelRatio.js';\nimport { IThemeService, Themable } from '../../../../../platform/theme/common/themeService.js';\nimport { INotebookEditorDelegate, NotebookOverviewRulerLane } from '../notebookBrowser.js';\n\nexport class NotebookOverviewRuler extends Themable {\n\tprivate readonly _domNode: FastDomNode<HTMLCanvasElement>;\n\tprivate _lanes = 3;\n\n\tconstructor(readonly notebookEditor: INotebookEditorDelegate, container: HTMLElement, @IThemeService themeService: IThemeService) {\n\t\tsuper(themeService);\n\t\tthis._domNode = createFastDomNode(document.createElement('canvas'));\n\t\tthis._domNode.setPosition('relative');\n\t\tthis._domNode.setLayerHinting(true);\n\t\tthis._domNode.setContain('strict');\n\n\t\tcontainer.appendChild(this._domNode.domNode);\n\n\t\tthis._register(notebookEditor.onDidChangeDecorations(() => {\n\t\t\tthis.layout();\n\t\t}));\n\n\t\tthis._register(PixelRatio.getInstance(getWindow(this._domNode.domNode)).onDidChange(() => {\n\t\t\tthis.layout();\n\t\t}));\n\t}\n\n\tlayout() {\n\t\tconst width = 10;\n\t\tconst layoutInfo = this.notebookEditor.getLayoutInfo();\n\t\tconst scrollHeight = layoutInfo.scrollHeight;\n\t\tconst height = layoutInfo.height;\n\t\tconst ratio = PixelRatio.getInstance(getWindow(this._domNode.domNode)).value;\n\t\tthis._domNode.setWidth(width);\n\t\tthis._domNode.setHeight(height);\n\t\tthis._domNode.domNode.width = width * ratio;\n\t\tthis._domNode.domNode.height = height * ratio;\n\t\tconst ctx = this._domNode.domNode.getContext('2d')!;\n\t\tctx.clearRect(0, 0, width * ratio, height * ratio);\n\t\tthis._render(ctx, width * ratio, height * ratio, scrollHeight * ratio, ratio);\n\t}\n\n\tprivate _render(ctx: CanvasRenderingContext2D, width: number, height: number, scrollHeight: number, ratio: number) {\n\t\tconst viewModel = this.notebookEditor.getViewModel();\n\t\tconst fontInfo = this.notebookEditor.getLayoutInfo().fontInfo;\n\t\tconst laneWidth = width / this._lanes;\n\n\t\tlet currentFrom = 0;\n\n\t\tif (viewModel) {\n\t\t\tfor (let i = 0; i < viewModel.viewCells.length; i++) {\n\t\t\t\tconst viewCell = viewModel.viewCells[i];\n\t\t\t\tconst textBuffer = viewCell.textBuffer;\n\t\t\t\tconst decorations = viewCell.getCellDecorations();\n\t\t\t\tconst cellHeight = (viewCell.layoutInfo.totalHeight / scrollHeight) * ratio * height;\n\n\t\t\t\tdecorations.filter(decoration => decoration.overviewRuler).forEach(decoration => {\n\t\t\t\t\tconst overviewRuler = decoration.overviewRuler!;\n\t\t\t\t\tconst fillStyle = this.getColor(overviewRuler.color) ?? '#000000';\n\t\t\t\t\tconst lineHeight = Math.min(fontInfo.lineHeight, (viewCell.layoutInfo.editorHeight / scrollHeight / textBuffer.getLineCount()) * ratio * height);\n\t\t\t\t\tconst lineNumbers = overviewRuler.modelRanges.map(range => range.startLineNumber).reduce((previous: number[], current: number) => {\n\t\t\t\t\t\tif (previous.length === 0) {\n\t\t\t\t\t\t\tprevious.push(current);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst last = previous[previous.length - 1];\n\t\t\t\t\t\t\tif (last !== current) {\n\t\t\t\t\t\t\t\tprevious.push(current);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn previous;\n\t\t\t\t\t}, [] as number[]);\n\n\t\t\t\t\tlet x = 0;\n\t\t\t\t\tswitch (overviewRuler.position) {\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Left:\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Center:\n\t\t\t\t\t\t\tx = laneWidth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase NotebookOverviewRulerLane.Right:\n\t\t\t\t\t\t\tx = laneWidth * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst width = overviewRuler.position === NotebookOverviewRulerLane.Full ? laneWidth * 3 : laneWidth;\n\n\t\t\t\t\tfor (let i = 0; i < lineNumbers.length; i++) {\n\t\t\t\t\t\tctx.fillStyle = fillStyle;\n\t\t\t\t\t\tconst lineNumber = lineNumbers[i];\n\t\t\t\t\t\tconst offset = (lineNumber - 1) * lineHeight;\n\t\t\t\t\t\tctx.fillRect(x, currentFrom + offset, width, lineHeight);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (overviewRuler.includeOutput) {\n\t\t\t\t\t\tctx.fillStyle = fillStyle;\n\t\t\t\t\t\tconst outputOffset = (viewCell.layoutInfo.editorHeight / scrollHeight) * ratio * height;\n\t\t\t\t\t\tconst decorationHeight = (fontInfo.lineHeight / scrollHeight) * ratio * height;\n\t\t\t\t\t\tctx.fillRect(laneWidth, currentFrom + outputOffset, laneWidth, decorationHeight);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tcurrentFrom += cellHeight;\n\t\t\t}\n\n\t\t\tconst overviewRulerDecorations = viewModel.getOverviewRulerDecorations();\n\n\t\t\tfor (let i = 0; i < overviewRulerDecorations.length; i++) {\n\t\t\t\tconst decoration = overviewRulerDecorations[i];\n\t\t\t\tif (!decoration.options.overviewRuler) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst viewZoneInfo = this.notebookEditor.getViewZoneLayoutInfo(decoration.viewZoneId);\n\n\t\t\t\tif (!viewZoneInfo) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst fillStyle = this.getColor(decoration.options.overviewRuler.color) ?? '#000000';\n\t\t\t\tlet x = 0;\n\t\t\t\tswitch (decoration.options.overviewRuler.position) {\n\t\t\t\t\tcase NotebookOverviewRulerLane.Left:\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase NotebookOverviewRulerLane.Center:\n\t\t\t\t\t\tx = laneWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase NotebookOverviewRulerLane.Right:\n\t\t\t\t\t\tx = laneWidth * 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst width = decoration.options.overviewRuler.position === NotebookOverviewRulerLane.Full ? laneWidth * 3 : laneWidth;\n\n\t\t\t\tctx.fillStyle = fillStyle;\n\n\t\t\t\tconst viewZoneHeight = (viewZoneInfo.height / scrollHeight) * ratio * height;\n\t\t\t\tconst viewZoneTop = (viewZoneInfo.top / scrollHeight) * ratio * height;\n\n\t\t\t\tctx.fillRect(x, viewZoneTop, width, viewZoneHeight);\n\t\t\t}\n\t\t}\n\t}\n}\n"]}