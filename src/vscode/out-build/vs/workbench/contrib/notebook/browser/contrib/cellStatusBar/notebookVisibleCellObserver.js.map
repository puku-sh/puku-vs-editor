{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/contrib/cellStatusBar/notebookVisibleCellObserver.ts","vs/workbench/contrib/notebook/browser/contrib/cellStatusBar/notebookVisibleCellObserver.ts"],"names":[],"mappings":"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","file":"notebookVisibleCellObserver.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { diffSets } from '../../../../../../base/common/collections.js';\nimport { Emitter } from '../../../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { isDefined } from '../../../../../../base/common/types.js';\nimport { ICellViewModel, INotebookEditor } from '../../notebookBrowser.js';\nimport { cellRangesToIndexes } from '../../../common/notebookRange.js';\n\nexport interface ICellVisibilityChangeEvent {\n\tadded: ICellViewModel[];\n\tremoved: ICellViewModel[];\n}\n\nexport class NotebookVisibleCellObserver extends Disposable {\n\tprivate readonly _onDidChangeVisibleCells = this._register(new Emitter<ICellVisibilityChangeEvent>());\n\treadonly onDidChangeVisibleCells = this._onDidChangeVisibleCells.event;\n\n\tprivate readonly _viewModelDisposables = this._register(new DisposableStore());\n\n\tprivate _visibleCells: ICellViewModel[] = [];\n\n\tget visibleCells(): ICellViewModel[] {\n\t\treturn this._visibleCells;\n\t}\n\n\tconstructor(private readonly _notebookEditor: INotebookEditor) {\n\t\tsuper();\n\n\t\tthis._register(this._notebookEditor.onDidChangeVisibleRanges(this._updateVisibleCells, this));\n\t\tthis._register(this._notebookEditor.onDidChangeModel(this._onModelChange, this));\n\t\tthis._updateVisibleCells();\n\t}\n\n\tprivate _onModelChange() {\n\t\tthis._viewModelDisposables.clear();\n\t\tif (this._notebookEditor.hasModel()) {\n\t\t\tthis._viewModelDisposables.add(this._notebookEditor.onDidChangeViewCells(() => this.updateEverything()));\n\t\t}\n\n\t\tthis.updateEverything();\n\t}\n\n\tprotected updateEverything(): void {\n\t\tthis._onDidChangeVisibleCells.fire({ added: [], removed: Array.from(this._visibleCells) });\n\t\tthis._visibleCells = [];\n\t\tthis._updateVisibleCells();\n\t}\n\n\tprivate _updateVisibleCells(): void {\n\t\tif (!this._notebookEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newVisibleCells = cellRangesToIndexes(this._notebookEditor.visibleRanges)\n\t\t\t.map(index => this._notebookEditor.cellAt(index))\n\t\t\t.filter(isDefined);\n\t\tconst newVisibleHandles = new Set(newVisibleCells.map(cell => cell.handle));\n\t\tconst oldVisibleHandles = new Set(this._visibleCells.map(cell => cell.handle));\n\t\tconst diff = diffSets(oldVisibleHandles, newVisibleHandles);\n\n\t\tconst added = diff.added\n\t\t\t.map(handle => this._notebookEditor.getCellByHandle(handle))\n\t\t\t.filter(isDefined);\n\t\tconst removed = diff.removed\n\t\t\t.map(handle => this._notebookEditor.getCellByHandle(handle))\n\t\t\t.filter(isDefined);\n\n\t\tthis._visibleCells = newVisibleCells;\n\t\tthis._onDidChangeVisibleCells.fire({\n\t\t\tadded,\n\t\t\tremoved\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { diffSets } from '../../../../../../base/common/collections.js';\nimport { Emitter } from '../../../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { isDefined } from '../../../../../../base/common/types.js';\nimport { ICellViewModel, INotebookEditor } from '../../notebookBrowser.js';\nimport { cellRangesToIndexes } from '../../../common/notebookRange.js';\n\nexport interface ICellVisibilityChangeEvent {\n\tadded: ICellViewModel[];\n\tremoved: ICellViewModel[];\n}\n\nexport class NotebookVisibleCellObserver extends Disposable {\n\tprivate readonly _onDidChangeVisibleCells = this._register(new Emitter<ICellVisibilityChangeEvent>());\n\treadonly onDidChangeVisibleCells = this._onDidChangeVisibleCells.event;\n\n\tprivate readonly _viewModelDisposables = this._register(new DisposableStore());\n\n\tprivate _visibleCells: ICellViewModel[] = [];\n\n\tget visibleCells(): ICellViewModel[] {\n\t\treturn this._visibleCells;\n\t}\n\n\tconstructor(private readonly _notebookEditor: INotebookEditor) {\n\t\tsuper();\n\n\t\tthis._register(this._notebookEditor.onDidChangeVisibleRanges(this._updateVisibleCells, this));\n\t\tthis._register(this._notebookEditor.onDidChangeModel(this._onModelChange, this));\n\t\tthis._updateVisibleCells();\n\t}\n\n\tprivate _onModelChange() {\n\t\tthis._viewModelDisposables.clear();\n\t\tif (this._notebookEditor.hasModel()) {\n\t\t\tthis._viewModelDisposables.add(this._notebookEditor.onDidChangeViewCells(() => this.updateEverything()));\n\t\t}\n\n\t\tthis.updateEverything();\n\t}\n\n\tprotected updateEverything(): void {\n\t\tthis._onDidChangeVisibleCells.fire({ added: [], removed: Array.from(this._visibleCells) });\n\t\tthis._visibleCells = [];\n\t\tthis._updateVisibleCells();\n\t}\n\n\tprivate _updateVisibleCells(): void {\n\t\tif (!this._notebookEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newVisibleCells = cellRangesToIndexes(this._notebookEditor.visibleRanges)\n\t\t\t.map(index => this._notebookEditor.cellAt(index))\n\t\t\t.filter(isDefined);\n\t\tconst newVisibleHandles = new Set(newVisibleCells.map(cell => cell.handle));\n\t\tconst oldVisibleHandles = new Set(this._visibleCells.map(cell => cell.handle));\n\t\tconst diff = diffSets(oldVisibleHandles, newVisibleHandles);\n\n\t\tconst added = diff.added\n\t\t\t.map(handle => this._notebookEditor.getCellByHandle(handle))\n\t\t\t.filter(isDefined);\n\t\tconst removed = diff.removed\n\t\t\t.map(handle => this._notebookEditor.getCellByHandle(handle))\n\t\t\t.filter(isDefined);\n\n\t\tthis._visibleCells = newVisibleCells;\n\t\tthis._onDidChangeVisibleCells.fire({\n\t\t\tadded,\n\t\t\tremoved\n\t\t});\n\t}\n}\n"]}