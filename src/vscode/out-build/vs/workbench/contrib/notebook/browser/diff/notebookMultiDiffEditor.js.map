{"version":3,"sources":["vs/workbench/contrib/notebook/browser/diff/notebookMultiDiffEditor.ts"],"names":[],"mappings":"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","file":"notebookMultiDiffEditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { IWorkbenchUIElementFactory, type IResourceLabel } from '../../../../../editor/browser/widget/multiDiffEditor/workbenchUIElementFactory.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IEditorOpenContext } from '../../../../common/editor.js';\nimport { IEditorGroup } from '../../../../services/editor/common/editorGroupsService.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IContextKey, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { INotebookEditorWorkerService } from '../../common/services/notebookWorkerService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IEditorOptions as ICodeEditorOptions } from '../../../../../editor/common/config/editorOptions.js';\nimport { FontInfo } from '../../../../../editor/common/config/fontInfo.js';\nimport { createBareFontInfoFromRawSettings } from '../../../../../editor/common/config/fontInfoFromSettings.js';\nimport { PixelRatio } from '../../../../../base/browser/pixelRatio.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { EditorPane } from '../../../../browser/parts/editor/editorPane.js';\nimport { CellUri, INotebookDiffEditorModel, NOTEBOOK_MULTI_DIFF_EDITOR_ID } from '../../common/notebookCommon.js';\nimport { FontMeasurements } from '../../../../../editor/browser/config/fontMeasurements.js';\nimport { NotebookOptions } from '../notebookOptions.js';\nimport { INotebookService } from '../../common/notebookService.js';\nimport { NotebookMultiDiffEditorInput, NotebookMultiDiffEditorWidgetInput } from './notebookMultiDiffEditorInput.js';\nimport { MultiDiffEditorWidget } from '../../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidget.js';\nimport { ResourceLabel } from '../../../../browser/labels.js';\nimport type { IMultiDiffEditorOptions } from '../../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorWidgetImpl.js';\nimport { INotebookDocumentService } from '../../../../services/notebook/common/notebookDocumentService.js';\nimport { localize } from '../../../../../nls.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { getIconClassesForLanguageId } from '../../../../../editor/common/services/getIconClasses.js';\nimport { NotebookDiffViewModel } from './notebookDiffViewModel.js';\nimport { NotebookDiffEditorEventDispatcher } from './eventDispatcher.js';\nimport { NOTEBOOK_DIFF_CELLS_COLLAPSED, NOTEBOOK_DIFF_HAS_UNCHANGED_CELLS, NOTEBOOK_DIFF_UNCHANGED_CELLS_HIDDEN } from './notebookDiffEditorBrowser.js';\nimport type { DocumentDiffItemViewModel, MultiDiffEditorViewModel } from '../../../../../editor/browser/widget/multiDiffEditor/multiDiffEditorViewModel.js';\nimport type { URI } from '../../../../../base/common/uri.js';\nimport { type IDiffElementViewModelBase } from './diffElementViewModel.js';\nimport { autorun, transaction } from '../../../../../base/common/observable.js';\nimport { DiffEditorHeightCalculatorService } from './editorHeightCalculator.js';\n\nexport class NotebookMultiTextDiffEditor extends EditorPane {\n\tprivate _multiDiffEditorWidget?: MultiDiffEditorWidget;\n\tstatic readonly ID: string = NOTEBOOK_MULTI_DIFF_EDITOR_ID;\n\tprivate _fontInfo: FontInfo | undefined;\n\tprotected _scopeContextKeyService!: IContextKeyService;\n\tprivate readonly modelSpecificResources: DisposableStore;\n\tprivate _model?: INotebookDiffEditorModel;\n\tprivate viewModel?: NotebookDiffViewModel;\n\tprivate widgetViewModel?: MultiDiffEditorViewModel;\n\tget textModel() {\n\t\treturn this._model?.modified.notebook;\n\t}\n\tprivate _notebookOptions: NotebookOptions;\n\tget notebookOptions() {\n\t\treturn this._notebookOptions;\n\t}\n\tprivate readonly ctxAllCollapsed: IContextKey<boolean>;\n\tprivate readonly ctxHasUnchangedCells: IContextKey<boolean>;\n\tprivate readonly ctxHiddenUnchangedCells: IContextKey<boolean>;\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IContextKeyService private readonly _parentContextKeyService: IContextKeyService,\n\t\t@INotebookEditorWorkerService private readonly notebookEditorWorkerService: INotebookEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@INotebookService private readonly notebookService: INotebookService,\n\t) {\n\t\tsuper(NotebookMultiTextDiffEditor.ID, group, telemetryService, themeService, storageService);\n\t\tthis.modelSpecificResources = this._register(new DisposableStore());\n\t\tthis.ctxAllCollapsed = this._parentContextKeyService.createKey<boolean>(NOTEBOOK_DIFF_CELLS_COLLAPSED.key, false);\n\t\tthis.ctxHasUnchangedCells = this._parentContextKeyService.createKey<boolean>(NOTEBOOK_DIFF_HAS_UNCHANGED_CELLS.key, false);\n\t\tthis.ctxHiddenUnchangedCells = this._parentContextKeyService.createKey<boolean>(NOTEBOOK_DIFF_UNCHANGED_CELLS_HIDDEN.key, true);\n\t\tthis._notebookOptions = instantiationService.createInstance(NotebookOptions, this.window, false, undefined);\n\t\tthis._register(this._notebookOptions);\n\t}\n\n\tprivate get fontInfo() {\n\t\tif (!this._fontInfo) {\n\t\t\tthis._fontInfo = this.createFontInfo();\n\t\t}\n\n\t\treturn this._fontInfo;\n\t}\n\toverride layout(dimension: DOM.Dimension, position?: DOM.IDomPosition): void {\n\t\tthis._multiDiffEditorWidget!.layout(dimension);\n\t}\n\n\tprivate createFontInfo() {\n\t\tconst editorOptions = this.configurationService.getValue<ICodeEditorOptions>('editor');\n\t\treturn FontMeasurements.readFontInfo(this.window, createBareFontInfoFromRawSettings(editorOptions, PixelRatio.getInstance(this.window).value));\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._multiDiffEditorWidget = this._register(this.instantiationService.createInstance(\n\t\t\tMultiDiffEditorWidget,\n\t\t\tparent,\n\t\t\tthis.instantiationService.createInstance(WorkbenchUIElementFactory),\n\t\t));\n\n\t\tthis._register(this._multiDiffEditorWidget.onDidChangeActiveControl(() => {\n\t\t\tthis._onDidChangeControl.fire();\n\t\t}));\n\t}\n\toverride async setInput(input: NotebookMultiDiffEditorInput, options: IMultiDiffEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\tsuper.setInput(input, options, context, token);\n\t\tconst model = await input.resolve();\n\t\tif (this._model !== model) {\n\t\t\tthis._detachModel();\n\t\t\tthis._model = model;\n\t\t}\n\t\tconst eventDispatcher = this.modelSpecificResources.add(new NotebookDiffEditorEventDispatcher());\n\t\tconst diffEditorHeightCalculator = this.instantiationService.createInstance(DiffEditorHeightCalculatorService, this.fontInfo.lineHeight);\n\t\tthis.viewModel = this.modelSpecificResources.add(new NotebookDiffViewModel(model, this.notebookEditorWorkerService, this.configurationService, eventDispatcher, this.notebookService, diffEditorHeightCalculator, undefined, true));\n\t\tawait this.viewModel.computeDiff(this.modelSpecificResources.add(new CancellationTokenSource()).token);\n\t\tthis.ctxHasUnchangedCells.set(this.viewModel.hasUnchangedCells);\n\t\tthis.ctxHasUnchangedCells.set(this.viewModel.hasUnchangedCells);\n\n\t\tconst widgetInput = this.modelSpecificResources.add(NotebookMultiDiffEditorWidgetInput.createInput(this.viewModel, this.instantiationService));\n\t\tthis.widgetViewModel = this.modelSpecificResources.add(await widgetInput.getViewModel());\n\n\t\tconst itemsWeHaveSeen = new WeakSet<DocumentDiffItemViewModel>();\n\t\tthis.modelSpecificResources.add(autorun(reader => {\n\t\t\t/** @description NotebookDiffEditor => Collapse unmodified items */\n\t\t\tif (!this.widgetViewModel || !this.viewModel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst items = this.widgetViewModel.items.read(reader);\n\t\t\tconst diffItems = this.viewModel.value;\n\t\t\tif (items.length !== diffItems.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If cell has not changed, but metadata or output has changed, then collapse the cell & keep output/metadata expanded.\n\t\t\t// Similarly if the cell has changed, but the metadata or output has not, then expand the cell, but collapse output/metadata.\n\t\t\ttransaction((tx) => {\n\t\t\t\titems.forEach(item => {\n\t\t\t\t\t// We do not want to mess with UI state if users change it, hence no need to collapse again.\n\t\t\t\t\tif (itemsWeHaveSeen.has(item)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\titemsWeHaveSeen.add(item);\n\t\t\t\t\tconst diffItem = diffItems.find(d => d.modifiedUri?.toString() === item.modifiedUri?.toString() && d.originalUri?.toString() === item.originalUri?.toString());\n\t\t\t\t\tif (diffItem && diffItem.type === 'unchanged') {\n\t\t\t\t\t\titem.collapsed.set(true, tx);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}));\n\n\n\t\tthis._multiDiffEditorWidget!.setViewModel(this.widgetViewModel);\n\t}\n\n\tprivate _detachModel() {\n\t\tthis.viewModel = undefined;\n\t\tthis.modelSpecificResources.clear();\n\t}\n\t_generateFontFamily(): string {\n\t\treturn this.fontInfo.fontFamily ?? `\"SF Mono\", Monaco, Menlo, Consolas, \"Ubuntu Mono\", \"Liberation Mono\", \"DejaVu Sans Mono\", \"Courier New\", monospace`;\n\t}\n\toverride setOptions(options: IMultiDiffEditorOptions | undefined): void {\n\t\tsuper.setOptions(options);\n\t}\n\n\toverride getControl() {\n\t\treturn this._multiDiffEditorWidget!.getActiveControl();\n\t}\n\n\toverride focus(): void {\n\t\tsuper.focus();\n\n\t\tthis._multiDiffEditorWidget?.getActiveControl()?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn this._multiDiffEditorWidget?.getActiveControl()?.hasTextFocus() || super.hasFocus();\n\t}\n\n\toverride clearInput(): void {\n\t\tsuper.clearInput();\n\t\tthis._multiDiffEditorWidget!.setViewModel(undefined);\n\t\tthis.modelSpecificResources.clear();\n\t\tthis.viewModel = undefined;\n\t\tthis.widgetViewModel = undefined;\n\t}\n\n\tpublic expandAll() {\n\t\tif (this.widgetViewModel) {\n\t\t\tthis.widgetViewModel.expandAll();\n\t\t\tthis.ctxAllCollapsed.set(false);\n\t\t}\n\t}\n\tpublic collapseAll() {\n\t\tif (this.widgetViewModel) {\n\t\t\tthis.widgetViewModel.collapseAll();\n\t\t\tthis.ctxAllCollapsed.set(true);\n\t\t}\n\t}\n\n\tpublic hideUnchanged() {\n\t\tif (this.viewModel) {\n\t\t\tthis.viewModel.includeUnchanged = false;\n\t\t\tthis.ctxHiddenUnchangedCells.set(true);\n\t\t}\n\t}\n\n\tpublic showUnchanged() {\n\t\tif (this.viewModel) {\n\t\t\tthis.viewModel.includeUnchanged = true;\n\t\t\tthis.ctxHiddenUnchangedCells.set(false);\n\t\t}\n\t}\n\n\tpublic getDiffElementViewModel(uri: URI): IDiffElementViewModelBase | undefined {\n\t\tif (uri.scheme === Schemas.vscodeNotebookCellOutput || uri.scheme === Schemas.vscodeNotebookCellOutputDiff ||\n\t\t\turi.scheme === Schemas.vscodeNotebookCellMetadata || uri.scheme === Schemas.vscodeNotebookCellMetadataDiff\n\t\t) {\n\t\t\tconst data = CellUri.parseCellPropertyUri(uri, uri.scheme);\n\t\t\tif (data) {\n\t\t\t\turi = CellUri.generate(data.notebook, data.handle);\n\t\t\t}\n\t\t}\n\t\tif (uri.scheme === Schemas.vscodeNotebookMetadata) {\n\t\t\treturn this.viewModel?.items.find(item =>\n\t\t\t\titem.type === 'modifiedMetadata' ||\n\t\t\t\titem.type === 'unchangedMetadata'\n\t\t\t);\n\t\t}\n\t\treturn this.viewModel?.items.find(c => {\n\t\t\tswitch (c.type) {\n\t\t\t\tcase 'delete':\n\t\t\t\t\treturn c.original?.uri.toString() === uri.toString();\n\t\t\t\tcase 'insert':\n\t\t\t\t\treturn c.modified?.uri.toString() === uri.toString();\n\t\t\t\tcase 'modified':\n\t\t\t\tcase 'unchanged':\n\t\t\t\t\treturn c.modified?.uri.toString() === uri.toString() || c.original?.uri.toString() === uri.toString();\n\t\t\t\tdefault:\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t}\n}\n\n\nclass WorkbenchUIElementFactory implements IWorkbenchUIElementFactory {\n\tconstructor(\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@INotebookDocumentService private readonly notebookDocumentService: INotebookDocumentService,\n\t\t@INotebookService private readonly notebookService: INotebookService\n\t) { }\n\n\tcreateResourceLabel(element: HTMLElement): IResourceLabel {\n\t\tconst label = this._instantiationService.createInstance(ResourceLabel, element, {});\n\t\tconst that = this;\n\t\treturn {\n\t\t\tsetUri(uri, options = {}) {\n\t\t\t\tif (!uri) {\n\t\t\t\t\tlabel.element.clear();\n\t\t\t\t} else {\n\t\t\t\t\tlet name = '';\n\t\t\t\t\tlet description = '';\n\t\t\t\t\tlet extraClasses: string[] | undefined = undefined;\n\n\t\t\t\t\tif (uri.scheme === Schemas.vscodeNotebookCell) {\n\t\t\t\t\t\tconst notebookDocument = uri.scheme === Schemas.vscodeNotebookCell ? that.notebookDocumentService.getNotebook(uri) : undefined;\n\t\t\t\t\t\tconst cellIndex = Schemas.vscodeNotebookCell ? that.notebookDocumentService.getNotebook(uri)?.getCellIndex(uri) : undefined;\n\t\t\t\t\t\tif (notebookDocument && cellIndex !== undefined) {\n\t\t\t\t\t\t\tname = localize('notebookCellLabel', \"Cell {0}\", `${cellIndex + 1}`);\n\t\t\t\t\t\t\tconst nb = notebookDocument ? that.notebookService.getNotebookTextModel(notebookDocument?.uri) : undefined;\n\t\t\t\t\t\t\tconst cellLanguage = nb && cellIndex !== undefined ? nb.cells[cellIndex].language : undefined;\n\t\t\t\t\t\t\textraClasses = cellLanguage ? getIconClassesForLanguageId(cellLanguage) : undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (uri.scheme === Schemas.vscodeNotebookCellMetadata || uri.scheme === Schemas.vscodeNotebookCellMetadataDiff) {\n\t\t\t\t\t\tdescription = localize('notebookCellMetadataLabel', \"Metadata\");\n\t\t\t\t\t} else if (uri.scheme === Schemas.vscodeNotebookCellOutput || uri.scheme === Schemas.vscodeNotebookCellOutputDiff) {\n\t\t\t\t\t\tdescription = localize('notebookCellOutputLabel', \"Output\");\n\t\t\t\t\t}\n\n\t\t\t\t\tlabel.element.setResource({ name, description }, { strikethrough: options.strikethrough, forceLabel: true, hideIcon: !extraClasses, extraClasses });\n\t\t\t\t}\n\t\t\t},\n\t\t\tdispose() {\n\t\t\t\tlabel.dispose();\n\t\t\t}\n\t\t};\n\t}\n}\n"]}