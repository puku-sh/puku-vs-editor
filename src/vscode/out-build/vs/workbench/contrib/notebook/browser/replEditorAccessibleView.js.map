{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/replEditorAccessibleView.ts","vs/workbench/contrib/notebook/browser/replEditorAccessibleView.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAGhG,OAAO,EAAsB,yBAAyB,EAA4B,MAAM,8DAA8D,CAAC;AAEvJ,OAAO,EAAE,cAAc,EAAE,MAAM,sDAAsD,CAAC;AACtF,OAAO,EAAE,cAAc,EAAE,MAAM,kDAAkD,CAAC;AAElF,OAAO,EAAE,mBAAmB,EAAE,MAAM,0CAA0C,CAAC;AAC/E,OAAO,EAAE,qBAAqB,EAAE,0BAA0B,EAAE,MAAM,kCAAkC,CAAC;AACrG,OAAO,EAAE,iBAAiB,EAAE,MAAM,qCAAqC,CAAC;AAExE;;GAEG;AACH,MAAM,OAAO,wBAAwB;IAArC;QACU,aAAQ,GAAG,GAAG,CAAC;QACf,SAAI,GAAG,iBAAiB,CAAC;QACzB,SAAI,wCAA2B;QAC/B,SAAI,GAAG,cAAc,CAAC,GAAG,CAAC,qBAAqB,EAAE,0BAA0B,CAAC,MAAM,EAAE,CAAC,CAAC;IAKhG,CAAC;IAJA,WAAW,CAAC,QAA0B;QACrC,MAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QACnD,OAAO,2BAA2B,CAAC,aAAa,CAAC,CAAC;IACnD,CAAC;CACD;AAED,MAAM,UAAU,2BAA2B,CAAC,aAA6B;IACxE,MAAM,aAAa,GAAG,aAAa,CAAC,gBAAgB,EAAE,UAAU,EAAE,CAAC;IAEnE,IAAI,aAAa,IAAI,mBAAmB,CAAC,aAAa,CAAC,IAAI,aAAa,CAAC,cAAc,EAAE,CAAC;QACzF,MAAM,cAAc,GAAG,aAAa,CAAC,cAAc,CAAC;QACpD,MAAM,SAAS,GAAG,cAAc,EAAE,YAAY,EAAE,CAAC;QACjD,IAAI,cAAc,IAAI,SAAS,EAAE,CAAC;YACjC,sDAAsD;YACtD,MAAM,aAAa,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;YAC3C,IAAI,aAAa,IAAI,CAAC,EAAE,CAAC;gBACxB,MAAM,IAAI,GAAG,SAAS,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;gBAChD,MAAM,aAAa,GAAG,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;gBAE1E,IAAI,aAAa,EAAE,CAAC;oBACnB,OAAO,IAAI,yBAAyB,qDAEnC,EAAE,IAAI,sCAAyB,EAAE,EACjC,GAAG,EAAE,GAAG,OAAO,aAAa,CAAC,CAAC,CAAC,EAC/B,GAAG,EAAE;wBACJ,aAAa,CAAC,gBAAgB,EAAE,KAAK,EAAE,CAAC;oBACzC,CAAC,wFAED,CAAC;gBACH,CAAC;YACF,CAAC;QACF,CAAC;IACF,CAAC;IAED,OAAO;AACR,CAAC","file":"replEditorAccessibleView.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { AccessibleViewType, AccessibleContentProvider, AccessibleViewProviderId } from '../../../../platform/accessibility/browser/accessibleView.js';\nimport { IAccessibleViewImplementation } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { isReplEditorControl } from '../../replNotebook/browser/replEditor.js';\nimport { IS_COMPOSITE_NOTEBOOK, NOTEBOOK_CELL_LIST_FOCUSED } from '../common/notebookContextKeys.js';\nimport { getAllOutputsText } from './viewModel/cellOutputTextHelper.js';\n\n/**\n * The REPL input is already accessible, so we can show a view for the most recent execution output.\n */\nexport class ReplEditorAccessibleView implements IAccessibleViewImplementation {\n\treadonly priority = 100;\n\treadonly name = 'replEditorInput';\n\treadonly type = AccessibleViewType.View;\n\treadonly when = ContextKeyExpr.and(IS_COMPOSITE_NOTEBOOK, NOTEBOOK_CELL_LIST_FOCUSED.negate());\n\tgetProvider(accessor: ServicesAccessor) {\n\t\tconst editorService = accessor.get(IEditorService);\n\t\treturn getAccessibleOutputProvider(editorService);\n\t}\n}\n\nexport function getAccessibleOutputProvider(editorService: IEditorService) {\n\tconst editorControl = editorService.activeEditorPane?.getControl();\n\n\tif (editorControl && isReplEditorControl(editorControl) && editorControl.notebookEditor) {\n\t\tconst notebookEditor = editorControl.notebookEditor;\n\t\tconst viewModel = notebookEditor?.getViewModel();\n\t\tif (notebookEditor && viewModel) {\n\t\t\t// last cell of the viewmodel is the last cell history\n\t\t\tconst lastCellIndex = viewModel.length - 1;\n\t\t\tif (lastCellIndex >= 0) {\n\t\t\t\tconst cell = viewModel.viewCells[lastCellIndex];\n\t\t\t\tconst outputContent = getAllOutputsText(viewModel.notebookDocument, cell);\n\n\t\t\t\tif (outputContent) {\n\t\t\t\t\treturn new AccessibleContentProvider(\n\t\t\t\t\t\tAccessibleViewProviderId.Notebook,\n\t\t\t\t\t\t{ type: AccessibleViewType.View },\n\t\t\t\t\t\t() => { return outputContent; },\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\teditorControl.activeCodeEditor?.focus();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tAccessibilityVerbositySettingId.ReplEditor,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { AccessibleViewType, AccessibleContentProvider, AccessibleViewProviderId } from '../../../../platform/accessibility/browser/accessibleView.js';\nimport { IAccessibleViewImplementation } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { AccessibilityVerbositySettingId } from '../../accessibility/browser/accessibilityConfiguration.js';\nimport { isReplEditorControl } from '../../replNotebook/browser/replEditor.js';\nimport { IS_COMPOSITE_NOTEBOOK, NOTEBOOK_CELL_LIST_FOCUSED } from '../common/notebookContextKeys.js';\nimport { getAllOutputsText } from './viewModel/cellOutputTextHelper.js';\n\n/**\n * The REPL input is already accessible, so we can show a view for the most recent execution output.\n */\nexport class ReplEditorAccessibleView implements IAccessibleViewImplementation {\n\treadonly priority = 100;\n\treadonly name = 'replEditorInput';\n\treadonly type = AccessibleViewType.View;\n\treadonly when = ContextKeyExpr.and(IS_COMPOSITE_NOTEBOOK, NOTEBOOK_CELL_LIST_FOCUSED.negate());\n\tgetProvider(accessor: ServicesAccessor) {\n\t\tconst editorService = accessor.get(IEditorService);\n\t\treturn getAccessibleOutputProvider(editorService);\n\t}\n}\n\nexport function getAccessibleOutputProvider(editorService: IEditorService) {\n\tconst editorControl = editorService.activeEditorPane?.getControl();\n\n\tif (editorControl && isReplEditorControl(editorControl) && editorControl.notebookEditor) {\n\t\tconst notebookEditor = editorControl.notebookEditor;\n\t\tconst viewModel = notebookEditor?.getViewModel();\n\t\tif (notebookEditor && viewModel) {\n\t\t\t// last cell of the viewmodel is the last cell history\n\t\t\tconst lastCellIndex = viewModel.length - 1;\n\t\t\tif (lastCellIndex >= 0) {\n\t\t\t\tconst cell = viewModel.viewCells[lastCellIndex];\n\t\t\t\tconst outputContent = getAllOutputsText(viewModel.notebookDocument, cell);\n\n\t\t\t\tif (outputContent) {\n\t\t\t\t\treturn new AccessibleContentProvider(\n\t\t\t\t\t\tAccessibleViewProviderId.Notebook,\n\t\t\t\t\t\t{ type: AccessibleViewType.View },\n\t\t\t\t\t\t() => { return outputContent; },\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\teditorControl.activeCodeEditor?.focus();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tAccessibilityVerbositySettingId.ReplEditor,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn;\n}\n"]}