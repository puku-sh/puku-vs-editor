{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/viewParts/notebookEditorToolbar.ts","vs/workbench/contrib/notebook/browser/viewParts/notebookEditorToolbar.ts"],"names":[],"mappings":"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","file":"notebookEditorToolbar.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { StandardMouseEvent } from '../../../../../base/browser/mouseEvent.js';\nimport { DomScrollableElement } from '../../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { ToolBar } from '../../../../../base/browser/ui/toolbar/toolbar.js';\nimport { IAction, Separator } from '../../../../../base/common/actions.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Disposable, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ScrollbarVisibility } from '../../../../../base/common/scrollable.js';\nimport { MenuEntryActionViewItem, SubmenuEntryActionViewItem } from '../../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction, SubmenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { SELECT_KERNEL_ID } from '../controller/coreActions.js';\nimport { NOTEBOOK_EDITOR_ID, NotebookSetting } from '../../common/notebookCommon.js';\nimport { INotebookEditorDelegate } from '../notebookBrowser.js';\nimport { NotebooKernelActionViewItem } from './notebookKernelView.js';\nimport { ActionViewWithLabel, UnifiedSubmenuActionView } from '../view/cellParts/cellActionView.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { NotebookOptions } from '../notebookOptions.js';\nimport { IActionViewItem, IActionViewItemProvider } from '../../../../../base/browser/ui/actionbar/actionbar.js';\nimport { disposableTimeout } from '../../../../../base/common/async.js';\nimport { HiddenItemStrategy, IWorkbenchToolBarOptions, WorkbenchToolBar } from '../../../../../platform/actions/browser/toolbar.js';\nimport { IActionViewItemOptions } from '../../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { WorkbenchHoverDelegate } from '../../../../../platform/hover/browser/hover.js';\n\ninterface IActionModel {\n\taction: IAction;\n\tsize: number;\n\tvisible: boolean;\n\trenderLabel: boolean;\n}\n\nexport enum RenderLabel {\n\tAlways = 0,\n\tNever = 1,\n\tDynamic = 2\n}\n\nexport type RenderLabelWithFallback = true | false | 'always' | 'never' | 'dynamic';\n\nexport function convertConfiguration(value: RenderLabelWithFallback): RenderLabel {\n\tswitch (value) {\n\t\tcase true:\n\t\t\treturn RenderLabel.Always;\n\t\tcase false:\n\t\t\treturn RenderLabel.Never;\n\t\tcase 'always':\n\t\t\treturn RenderLabel.Always;\n\t\tcase 'never':\n\t\t\treturn RenderLabel.Never;\n\t\tcase 'dynamic':\n\t\t\treturn RenderLabel.Dynamic;\n\t}\n}\n\nconst ICON_ONLY_ACTION_WIDTH = 21;\nconst TOGGLE_MORE_ACTION_WIDTH = 21;\nconst ACTION_PADDING = 8;\n\ninterface IActionLayoutStrategy {\n\tactionProvider: IActionViewItemProvider;\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] };\n}\n\nclass WorkbenchAlwaysLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate });\n\t\t}\n\n\t\tif (action instanceof SubmenuItemAction && action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, true, {\n\t\t\t\tgetActions: () => {\n\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t}\n\t\t\t}, this.actionProvider.bind(this));\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nclass WorkbenchNeverLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t}\n\n\t\tif (action instanceof SubmenuItemAction) {\n\t\t\tif (action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, false, {\n\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t}\n\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t} else {\n\t\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nclass WorkbenchDynamicLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tconst a = this.editorToolbar.primaryActions.find(a => a.action.id === action.id);\n\t\tif (!a || a.renderLabel) {\n\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\treturn this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\n\t\t\tif (action instanceof SubmenuItemAction && action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, true, {\n\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t}\n\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\n\t\t\tif (action instanceof SubmenuItemAction) {\n\t\t\t\tif (action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, false, {\n\t\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t\t} else {\n\t\t\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchDynamicCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nexport class NotebookEditorWorkbenchToolbar extends Disposable {\n\tprivate _leftToolbarScrollable!: DomScrollableElement;\n\tprivate _notebookTopLeftToolbarContainer!: HTMLElement;\n\tprivate _notebookTopRightToolbarContainer!: HTMLElement;\n\tprivate _notebookGlobalActionsMenu!: IMenu;\n\tprivate _executeGoToActionsMenu!: IMenu;\n\tprivate _notebookLeftToolbar!: WorkbenchToolBar;\n\tprivate _primaryActions: IActionModel[];\n\tget primaryActions(): IActionModel[] {\n\t\treturn this._primaryActions;\n\t}\n\tprivate _secondaryActions: IAction[];\n\tget secondaryActions(): IAction[] {\n\t\treturn this._secondaryActions;\n\t}\n\tprivate _notebookRightToolbar!: ToolBar;\n\tprivate _useGlobalToolbar: boolean = false;\n\tprivate _strategy!: IActionLayoutStrategy;\n\tprivate _renderLabel: RenderLabel = RenderLabel.Always;\n\n\tprivate _visible: boolean = false;\n\tset visible(visible: boolean) {\n\t\tif (this._visible !== visible) {\n\t\t\tthis._visible = visible;\n\t\t\tthis._onDidChangeVisibility.fire(visible);\n\t\t}\n\t}\n\tprivate readonly _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\treadonly onDidChangeVisibility: Event<boolean> = this._onDidChangeVisibility.event;\n\n\tget useGlobalToolbar(): boolean {\n\t\treturn this._useGlobalToolbar;\n\t}\n\n\tprivate _dimension: DOM.Dimension | null = null;\n\n\tprivate _deferredActionUpdate: IDisposable | undefined;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly contextKeyService: IContextKeyService,\n\t\treadonly notebookOptions: NotebookOptions,\n\t\treadonly domNode: HTMLElement,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\n\t\tthis._primaryActions = [];\n\t\tthis._secondaryActions = [];\n\t\tthis._buildBody();\n\n\t\tthis._register(Event.debounce<void, void>(\n\t\t\tthis.editorService.onDidActiveEditorChange,\n\t\t\t(last, _current) => last,\n\t\t\t200\n\t\t)(this._updatePerEditorChange, this));\n\n\t\tthis._registerNotebookActionsToolbar();\n\n\t\tthis._register(DOM.addDisposableListener(this.domNode, DOM.EventType.CONTEXT_MENU, e => {\n\t\t\tconst event = new StandardMouseEvent(DOM.getWindow(this.domNode), e);\n\t\t\tthis.contextMenuService.showContextMenu({\n\t\t\t\tmenuId: MenuId.NotebookToolbarContext,\n\t\t\t\tgetAnchor: () => event,\n\t\t\t});\n\t\t}));\n\t}\n\n\tprivate _buildBody() {\n\t\tthis._notebookTopLeftToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopLeftToolbarContainer.classList.add('notebook-toolbar-left');\n\t\tthis._leftToolbarScrollable = new DomScrollableElement(this._notebookTopLeftToolbarContainer, {\n\t\t\tvertical: ScrollbarVisibility.Hidden,\n\t\t\thorizontal: ScrollbarVisibility.Visible,\n\t\t\thorizontalScrollbarSize: 3,\n\t\t\tuseShadows: false,\n\t\t\tscrollYToX: true\n\t\t});\n\t\tthis._register(this._leftToolbarScrollable);\n\n\t\tDOM.append(this.domNode, this._leftToolbarScrollable.getDomNode());\n\t\tthis._notebookTopRightToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopRightToolbarContainer.classList.add('notebook-toolbar-right');\n\t\tDOM.append(this.domNode, this._notebookTopRightToolbarContainer);\n\t}\n\n\tprivate _updatePerEditorChange() {\n\t\tif (this.editorService.activeEditorPane?.getId() === NOTEBOOK_EDITOR_ID) {\n\t\t\tconst notebookEditor = this.editorService.activeEditorPane.getControl() as INotebookEditorDelegate;\n\t\t\tif (notebookEditor === this.notebookEditor) {\n\t\t\t\t// this is the active editor\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerNotebookActionsToolbar() {\n\t\tthis._notebookGlobalActionsMenu = this._register(this.menuService.createMenu(this.notebookEditor.creationOptions.menuIds.notebookToolbar, this.contextKeyService));\n\t\tthis._executeGoToActionsMenu = this._register(this.menuService.createMenu(MenuId.NotebookCellExecuteGoTo, this.contextKeyService));\n\n\t\tthis._useGlobalToolbar = this.notebookOptions.getDisplayOptions().globalToolbar;\n\t\tthis._renderLabel = this._convertConfiguration(this.configurationService.getValue(NotebookSetting.globalToolbarShowLabel));\n\t\tthis._updateStrategy();\n\n\t\tconst context = {\n\t\t\tui: true,\n\t\t\tnotebookEditor: this.notebookEditor,\n\t\t\tsource: 'notebookToolbar'\n\t\t};\n\n\t\tconst actionProvider = (action: IAction, options: IActionViewItemOptions) => {\n\t\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t\t// this is being disposed by the consumer\n\t\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t\t}\n\n\t\t\tif (this._renderLabel !== RenderLabel.Never) {\n\t\t\t\tconst a = this._primaryActions.find(a => a.action.id === action.id);\n\t\t\t\tif (a && a.renderLabel) {\n\t\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t}\n\t\t};\n\n\t\t// Make sure both toolbars have the same hover delegate for instant hover to work\n\t\t// Due to the elements being further apart than normal toolbars, the default time limit is to short and has to be increased\n\t\tconst hoverDelegate = this._register(this.instantiationService.createInstance(WorkbenchHoverDelegate, 'element', { instantHover: true }, {}));\n\t\thoverDelegate.setInstantHoverTimeLimit(600);\n\n\t\tconst leftToolbarOptions: IWorkbenchToolBarOptions = {\n\t\t\thiddenItemStrategy: HiddenItemStrategy.RenderInSecondaryGroup,\n\t\t\tresetMenu: MenuId.NotebookToolbar,\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\treturn this._strategy.actionProvider(action, options);\n\t\t\t},\n\t\t\tgetKeyBinding: action => this.keybindingService.lookupKeybinding(action.id),\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\thoverDelegate\n\t\t};\n\n\t\tthis._notebookLeftToolbar = this.instantiationService.createInstance(\n\t\t\tWorkbenchToolBar,\n\t\t\tthis._notebookTopLeftToolbarContainer,\n\t\t\tleftToolbarOptions\n\t\t);\n\t\tthis._register(this._notebookLeftToolbar);\n\t\tthis._notebookLeftToolbar.context = context;\n\n\t\tthis._notebookRightToolbar = new ToolBar(this._notebookTopRightToolbarContainer, this.contextMenuService, {\n\t\t\tgetKeyBinding: action => this.keybindingService.lookupKeybinding(action.id),\n\t\t\tactionViewItemProvider: actionProvider,\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\thoverDelegate\n\t\t});\n\t\tthis._register(this._notebookRightToolbar);\n\t\tthis._notebookRightToolbar.context = context;\n\n\t\tthis._showNotebookActionsinEditorToolbar();\n\t\tlet dropdownIsVisible = false;\n\t\tlet deferredUpdate: (() => void) | undefined;\n\n\t\tthis._register(this._notebookGlobalActionsMenu.onDidChange(() => {\n\t\t\tif (dropdownIsVisible) {\n\t\t\t\tdeferredUpdate = () => this._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.notebookEditor.isVisible) {\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._notebookLeftToolbar.onDidChangeDropdownVisibility(visible => {\n\t\t\tdropdownIsVisible = visible;\n\n\t\t\tif (deferredUpdate && !visible) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdeferredUpdate?.();\n\t\t\t\t}, 0);\n\t\t\t\tdeferredUpdate = undefined;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.globalToolbar !== undefined) {\n\t\t\t\tthis._useGlobalToolbar = this.notebookOptions.getDisplayOptions().globalToolbar;\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(NotebookSetting.globalToolbarShowLabel)) {\n\t\t\t\tthis._renderLabel = this._convertConfiguration(this.configurationService.getValue<RenderLabelWithFallback>(NotebookSetting.globalToolbarShowLabel));\n\t\t\t\tthis._updateStrategy();\n\t\t\t\tconst oldElement = this._notebookLeftToolbar.getElement();\n\t\t\t\toldElement.remove();\n\t\t\t\tthis._notebookLeftToolbar.dispose();\n\n\t\t\t\tthis._notebookLeftToolbar = this.instantiationService.createInstance(\n\t\t\t\t\tWorkbenchToolBar,\n\t\t\t\t\tthis._notebookTopLeftToolbarContainer,\n\t\t\t\t\tleftToolbarOptions\n\t\t\t\t);\n\n\t\t\t\tthis._register(this._notebookLeftToolbar);\n\t\t\t\tthis._notebookLeftToolbar.context = context;\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _updateStrategy() {\n\t\tswitch (this._renderLabel) {\n\t\t\tcase RenderLabel.Always:\n\t\t\t\tthis._strategy = new WorkbenchAlwaysLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t\tcase RenderLabel.Never:\n\t\t\t\tthis._strategy = new WorkbenchNeverLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t\tcase RenderLabel.Dynamic:\n\t\t\t\tthis._strategy = new WorkbenchDynamicLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _convertConfiguration(value: RenderLabelWithFallback): RenderLabel {\n\t\tswitch (value) {\n\t\t\tcase true:\n\t\t\t\treturn RenderLabel.Always;\n\t\t\tcase false:\n\t\t\t\treturn RenderLabel.Never;\n\t\t\tcase 'always':\n\t\t\t\treturn RenderLabel.Always;\n\t\t\tcase 'never':\n\t\t\t\treturn RenderLabel.Never;\n\t\t\tcase 'dynamic':\n\t\t\t\treturn RenderLabel.Dynamic;\n\t\t}\n\t}\n\n\tprivate _showNotebookActionsinEditorToolbar() {\n\t\t// when there is no view model, just ignore.\n\t\tif (!this.notebookEditor.hasModel()) {\n\t\t\tthis._deferredActionUpdate?.dispose();\n\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\tthis.visible = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._deferredActionUpdate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._useGlobalToolbar) {\n\t\t\tthis.domNode.style.display = 'none';\n\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\tthis.visible = false;\n\t\t} else {\n\t\t\tthis._deferredActionUpdate = disposableTimeout(async () => {\n\t\t\t\tawait this._setNotebookActions();\n\t\t\t\tthis.visible = true;\n\t\t\t\tthis._deferredActionUpdate?.dispose();\n\t\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\t}, 50);\n\t\t}\n\t}\n\n\tprivate async _setNotebookActions() {\n\t\tconst groups = this._notebookGlobalActionsMenu.getActions({ shouldForwardArgs: true, renderShortTitle: true });\n\t\tthis.domNode.style.display = 'flex';\n\t\tconst primaryLeftGroups = groups.filter(group => /^navigation/.test(group[0]));\n\t\tconst primaryActions: IAction[] = [];\n\t\tprimaryLeftGroups.sort((a, b) => {\n\t\t\tif (a[0] === 'navigation') {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (b[0] === 'navigation') {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}).forEach((group, index) => {\n\t\t\tprimaryActions.push(...group[1]);\n\t\t\tif (index < primaryLeftGroups.length - 1) {\n\t\t\t\tprimaryActions.push(new Separator());\n\t\t\t}\n\t\t});\n\t\tconst primaryRightGroup = groups.find(group => /^status/.test(group[0]));\n\t\tconst primaryRightActions = primaryRightGroup ? primaryRightGroup[1] : [];\n\t\tconst secondaryActions = groups.filter(group => !/^navigation/.test(group[0]) && !/^status/.test(group[0])).reduce((prev: (MenuItemAction | SubmenuItemAction)[], curr) => { prev.push(...curr[1]); return prev; }, []);\n\n\t\tthis._notebookLeftToolbar.setActions([], []);\n\n\t\tthis._primaryActions = primaryActions.map(action => ({\n\t\t\taction: action,\n\t\t\tsize: (action instanceof Separator ? 1 : 0),\n\t\t\trenderLabel: true,\n\t\t\tvisible: true\n\t\t}));\n\t\tthis._notebookLeftToolbar.setActions(primaryActions, secondaryActions);\n\t\tthis._secondaryActions = secondaryActions;\n\n\t\tthis._notebookRightToolbar.setActions(primaryRightActions, []);\n\t\tthis._secondaryActions = secondaryActions;\n\n\n\t\tif (this._dimension && this._dimension.width >= 0 && this._dimension.height >= 0) {\n\t\t\tthis._cacheItemSizes(this._notebookLeftToolbar);\n\t\t}\n\n\t\tthis._computeSizes();\n\t}\n\n\tprivate _cacheItemSizes(toolbar: WorkbenchToolBar) {\n\t\tfor (let i = 0; i < toolbar.getItemsLength(); i++) {\n\t\t\tconst action = toolbar.getItemAction(i);\n\t\t\tif (action && action.id !== 'toolbar.toggle.more') {\n\t\t\t\tconst existing = this._primaryActions.find(a => a.action.id === action.id);\n\t\t\t\tif (existing) {\n\t\t\t\t\texisting.size = toolbar.getItemWidth(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _computeSizes() {\n\t\tconst toolbar = this._notebookLeftToolbar;\n\t\tconst rightToolbar = this._notebookRightToolbar;\n\t\tif (toolbar && rightToolbar && this._dimension && this._dimension.height >= 0 && this._dimension.width >= 0) {\n\t\t\t// compute size only if it's visible\n\t\t\tif (this._primaryActions.length === 0 && toolbar.getItemsLength() !== this._primaryActions.length) {\n\t\t\t\tthis._cacheItemSizes(this._notebookLeftToolbar);\n\t\t\t}\n\n\t\t\tif (this._primaryActions.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst kernelWidth = (rightToolbar.getItemsLength() ? rightToolbar.getItemWidth(0) : 0) + ACTION_PADDING;\n\t\t\tconst leftToolbarContainerMaxWidth = this._dimension.width - kernelWidth - (ACTION_PADDING + TOGGLE_MORE_ACTION_WIDTH) - (/** toolbar left margin */ACTION_PADDING) - (/** toolbar right margin */ACTION_PADDING);\n\t\t\tconst calculatedActions = this._strategy.calculateActions(leftToolbarContainerMaxWidth);\n\t\t\tthis._notebookLeftToolbar.setActions(calculatedActions.primaryActions, calculatedActions.secondaryActions);\n\t\t}\n\t}\n\n\tlayout(dimension: DOM.Dimension) {\n\t\tthis._dimension = dimension;\n\n\t\tif (!this._useGlobalToolbar) {\n\t\t\tthis.domNode.style.display = 'none';\n\t\t} else {\n\t\t\tthis.domNode.style.display = 'flex';\n\t\t}\n\t\tthis._computeSizes();\n\t}\n\n\toverride dispose() {\n\t\tthis._notebookLeftToolbar.context = undefined;\n\t\tthis._notebookRightToolbar.context = undefined;\n\t\tthis._notebookLeftToolbar.dispose();\n\t\tthis._notebookRightToolbar.dispose();\n\t\tthis._notebookLeftToolbar = null!;\n\t\tthis._notebookRightToolbar = null!;\n\t\tthis._deferredActionUpdate?.dispose();\n\t\tthis._deferredActionUpdate = undefined;\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport function workbenchCalculateActions(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, false);\n}\n\nexport function workbenchDynamicCalculateActions(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\n\tif (initialPrimaryActions.length === 0) {\n\t\treturn { primaryActions: [], secondaryActions: initialSecondaryActions };\n\t}\n\n\t// find true length of array, add 1 for each primary actions, ignoring an item when size = 0\n\tconst visibleActionLength = initialPrimaryActions.filter(action => action.size !== 0).length;\n\n\t// step 1: try to fit all primary actions\n\tconst totalWidthWithLabels = initialPrimaryActions.map(action => action.size).reduce((a, b) => a + b, 0) + (visibleActionLength - 1) * ACTION_PADDING;\n\tif (totalWidthWithLabels <= leftToolbarContainerMaxWidth) {\n\t\tinitialPrimaryActions.forEach(action => {\n\t\t\taction.renderLabel = true;\n\t\t});\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, false);\n\t}\n\n\t// step 2: check if they fit without labels\n\tif ((visibleActionLength * ICON_ONLY_ACTION_WIDTH + (visibleActionLength - 1) * ACTION_PADDING) > leftToolbarContainerMaxWidth) {\n\t\tinitialPrimaryActions.forEach(action => { action.renderLabel = false; });\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, true);\n\t}\n\n\t// step 3: render as many actions as possible with labels, rest without.\n\tlet sum = 0;\n\tlet lastActionWithLabel = -1;\n\tfor (let i = 0; i < initialPrimaryActions.length; i++) {\n\t\tsum += initialPrimaryActions[i].size + ACTION_PADDING;\n\n\t\tif (initialPrimaryActions[i].action instanceof Separator) {\n\t\t\t// find group separator\n\t\t\tconst remainingItems = initialPrimaryActions.slice(i + 1).filter(action => action.size !== 0); // todo: need to exclude size 0 items from this\n\t\t\tconst newTotalSum = sum + (remainingItems.length === 0 ? 0 : (remainingItems.length * ICON_ONLY_ACTION_WIDTH + (remainingItems.length - 1) * ACTION_PADDING));\n\t\t\tif (newTotalSum <= leftToolbarContainerMaxWidth) {\n\t\t\t\tlastActionWithLabel = i;\n\t\t\t}\n\t\t} else {\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\t// icons only don't fit either\n\tif (lastActionWithLabel < 0) {\n\t\tinitialPrimaryActions.forEach(action => { action.renderLabel = false; });\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, true);\n\t}\n\n\t// render labels for the actions that have space\n\tinitialPrimaryActions.slice(0, lastActionWithLabel + 1).forEach(action => { action.renderLabel = true; });\n\tinitialPrimaryActions.slice(lastActionWithLabel + 1).forEach(action => { action.renderLabel = false; });\n\treturn {\n\t\tprimaryActions: initialPrimaryActions,\n\t\tsecondaryActions: initialSecondaryActions\n\t};\n}\n\nfunction actionOverflowHelper(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number, iconOnly: boolean): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\tconst renderActions: IActionModel[] = [];\n\tconst overflow: IAction[] = [];\n\n\tlet currentSize = 0;\n\tlet nonZeroAction = false;\n\tlet containerFull = false;\n\n\tif (initialPrimaryActions.length === 0) {\n\t\treturn { primaryActions: [], secondaryActions: initialSecondaryActions };\n\t}\n\n\tfor (let i = 0; i < initialPrimaryActions.length; i++) {\n\t\tconst actionModel = initialPrimaryActions[i];\n\t\tconst itemSize = iconOnly ? (actionModel.size === 0 ? 0 : ICON_ONLY_ACTION_WIDTH) : actionModel.size;\n\n\t\t// if two separators in a row, ignore the second\n\t\tif (actionModel.action instanceof Separator && renderActions.length > 0 && renderActions[renderActions.length - 1].action instanceof Separator) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// if a separator is the first nonZero action, ignore it\n\t\tif (actionModel.action instanceof Separator && !nonZeroAction) {\n\t\t\tcontinue;\n\t\t}\n\n\n\t\tif (currentSize + itemSize <= leftToolbarContainerMaxWidth && !containerFull) {\n\t\t\tcurrentSize += ACTION_PADDING + itemSize;\n\t\t\trenderActions.push(actionModel);\n\t\t\tif (itemSize !== 0) {\n\t\t\t\tnonZeroAction = true;\n\t\t\t}\n\t\t\tif (actionModel.action instanceof Separator) {\n\t\t\t\tnonZeroAction = false;\n\t\t\t}\n\t\t} else {\n\t\t\tcontainerFull = true;\n\t\t\tif (itemSize === 0) { // size 0 implies a hidden item, keep in primary to allow for Workbench to handle visibility\n\t\t\t\trenderActions.push(actionModel);\n\t\t\t} else {\n\t\t\t\tif (actionModel.action instanceof Separator) { // never push a separator to overflow\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\toverflow.push(actionModel.action);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (let i = (renderActions.length - 1); i > 0; i--) {\n\t\tconst temp = renderActions[i];\n\t\tif (temp.size === 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (temp.action instanceof Separator) {\n\t\t\trenderActions.splice(i, 1);\n\t\t}\n\t\tbreak;\n\t}\n\n\n\tif (renderActions.length && renderActions[renderActions.length - 1].action instanceof Separator) {\n\t\trenderActions.pop();\n\t}\n\n\tif (overflow.length !== 0) {\n\t\toverflow.push(new Separator());\n\t}\n\n\tif (iconOnly) {\n\t\t// if icon only mode, don't render both (+ code) and (+ markdown) buttons. remove of markdown action\n\t\tconst markdownIndex = renderActions.findIndex(a => a.action.id === 'notebook.cell.insertMarkdownCellBelow');\n\t\tif (markdownIndex !== -1) {\n\t\t\trenderActions.splice(markdownIndex, 1);\n\t\t}\n\t}\n\n\treturn {\n\t\tprimaryActions: renderActions,\n\t\tsecondaryActions: [...overflow, ...initialSecondaryActions]\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { StandardMouseEvent } from '../../../../../base/browser/mouseEvent.js';\nimport { DomScrollableElement } from '../../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { ToolBar } from '../../../../../base/browser/ui/toolbar/toolbar.js';\nimport { IAction, Separator } from '../../../../../base/common/actions.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Disposable, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ScrollbarVisibility } from '../../../../../base/common/scrollable.js';\nimport { MenuEntryActionViewItem, SubmenuEntryActionViewItem } from '../../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenu, IMenuService, MenuId, MenuItemAction, SubmenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { SELECT_KERNEL_ID } from '../controller/coreActions.js';\nimport { NOTEBOOK_EDITOR_ID, NotebookSetting } from '../../common/notebookCommon.js';\nimport { INotebookEditorDelegate } from '../notebookBrowser.js';\nimport { NotebooKernelActionViewItem } from './notebookKernelView.js';\nimport { ActionViewWithLabel, UnifiedSubmenuActionView } from '../view/cellParts/cellActionView.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { NotebookOptions } from '../notebookOptions.js';\nimport { IActionViewItem, IActionViewItemProvider } from '../../../../../base/browser/ui/actionbar/actionbar.js';\nimport { disposableTimeout } from '../../../../../base/common/async.js';\nimport { HiddenItemStrategy, IWorkbenchToolBarOptions, WorkbenchToolBar } from '../../../../../platform/actions/browser/toolbar.js';\nimport { IActionViewItemOptions } from '../../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { WorkbenchHoverDelegate } from '../../../../../platform/hover/browser/hover.js';\n\ninterface IActionModel {\n\taction: IAction;\n\tsize: number;\n\tvisible: boolean;\n\trenderLabel: boolean;\n}\n\nexport enum RenderLabel {\n\tAlways = 0,\n\tNever = 1,\n\tDynamic = 2\n}\n\nexport type RenderLabelWithFallback = true | false | 'always' | 'never' | 'dynamic';\n\nexport function convertConfiguration(value: RenderLabelWithFallback): RenderLabel {\n\tswitch (value) {\n\t\tcase true:\n\t\t\treturn RenderLabel.Always;\n\t\tcase false:\n\t\t\treturn RenderLabel.Never;\n\t\tcase 'always':\n\t\t\treturn RenderLabel.Always;\n\t\tcase 'never':\n\t\t\treturn RenderLabel.Never;\n\t\tcase 'dynamic':\n\t\t\treturn RenderLabel.Dynamic;\n\t}\n}\n\nconst ICON_ONLY_ACTION_WIDTH = 21;\nconst TOGGLE_MORE_ACTION_WIDTH = 21;\nconst ACTION_PADDING = 8;\n\ninterface IActionLayoutStrategy {\n\tactionProvider: IActionViewItemProvider;\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] };\n}\n\nclass WorkbenchAlwaysLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate });\n\t\t}\n\n\t\tif (action instanceof SubmenuItemAction && action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, true, {\n\t\t\t\tgetActions: () => {\n\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t}\n\t\t\t}, this.actionProvider.bind(this));\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nclass WorkbenchNeverLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t}\n\n\t\tif (action instanceof SubmenuItemAction) {\n\t\t\tif (action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, false, {\n\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t}\n\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t} else {\n\t\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nclass WorkbenchDynamicLabelStrategy implements IActionLayoutStrategy {\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly editorToolbar: NotebookEditorWorkbenchToolbar,\n\t\treadonly goToMenu: IMenu,\n\t\treadonly instantiationService: IInstantiationService) { }\n\n\tactionProvider(action: IAction, options: IActionViewItemOptions): IActionViewItem | undefined {\n\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t//\tthis is being disposed by the consumer\n\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t}\n\n\t\tconst a = this.editorToolbar.primaryActions.find(a => a.action.id === action.id);\n\t\tif (!a || a.renderLabel) {\n\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\treturn this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\n\t\t\tif (action instanceof SubmenuItemAction && action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, true, {\n\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t}\n\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t}\n\n\t\t\tif (action instanceof SubmenuItemAction) {\n\t\t\t\tif (action.item.submenu.id === MenuId.NotebookCellExecuteGoTo.id) {\n\t\t\t\t\treturn this.instantiationService.createInstance(UnifiedSubmenuActionView, action, { hoverDelegate: options.hoverDelegate }, false, {\n\t\t\t\t\t\tgetActions: () => {\n\t\t\t\t\t\t\treturn this.goToMenu.getActions().find(([group]) => group === 'navigation/execute')?.[1] ?? [];\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this.actionProvider.bind(this));\n\t\t\t\t} else {\n\t\t\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tcalculateActions(leftToolbarContainerMaxWidth: number): { primaryActions: IAction[]; secondaryActions: IAction[] } {\n\t\tconst initialPrimaryActions = this.editorToolbar.primaryActions;\n\t\tconst initialSecondaryActions = this.editorToolbar.secondaryActions;\n\n\t\tconst actionOutput = workbenchDynamicCalculateActions(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth);\n\t\treturn {\n\t\t\tprimaryActions: actionOutput.primaryActions.map(a => a.action),\n\t\t\tsecondaryActions: actionOutput.secondaryActions\n\t\t};\n\t}\n}\n\nexport class NotebookEditorWorkbenchToolbar extends Disposable {\n\tprivate _leftToolbarScrollable!: DomScrollableElement;\n\tprivate _notebookTopLeftToolbarContainer!: HTMLElement;\n\tprivate _notebookTopRightToolbarContainer!: HTMLElement;\n\tprivate _notebookGlobalActionsMenu!: IMenu;\n\tprivate _executeGoToActionsMenu!: IMenu;\n\tprivate _notebookLeftToolbar!: WorkbenchToolBar;\n\tprivate _primaryActions: IActionModel[];\n\tget primaryActions(): IActionModel[] {\n\t\treturn this._primaryActions;\n\t}\n\tprivate _secondaryActions: IAction[];\n\tget secondaryActions(): IAction[] {\n\t\treturn this._secondaryActions;\n\t}\n\tprivate _notebookRightToolbar!: ToolBar;\n\tprivate _useGlobalToolbar: boolean = false;\n\tprivate _strategy!: IActionLayoutStrategy;\n\tprivate _renderLabel: RenderLabel = RenderLabel.Always;\n\n\tprivate _visible: boolean = false;\n\tset visible(visible: boolean) {\n\t\tif (this._visible !== visible) {\n\t\t\tthis._visible = visible;\n\t\t\tthis._onDidChangeVisibility.fire(visible);\n\t\t}\n\t}\n\tprivate readonly _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\treadonly onDidChangeVisibility: Event<boolean> = this._onDidChangeVisibility.event;\n\n\tget useGlobalToolbar(): boolean {\n\t\treturn this._useGlobalToolbar;\n\t}\n\n\tprivate _dimension: DOM.Dimension | null = null;\n\n\tprivate _deferredActionUpdate: IDisposable | undefined;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly contextKeyService: IContextKeyService,\n\t\treadonly notebookOptions: NotebookOptions,\n\t\treadonly domNode: HTMLElement,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\n\t\tthis._primaryActions = [];\n\t\tthis._secondaryActions = [];\n\t\tthis._buildBody();\n\n\t\tthis._register(Event.debounce<void, void>(\n\t\t\tthis.editorService.onDidActiveEditorChange,\n\t\t\t(last, _current) => last,\n\t\t\t200\n\t\t)(this._updatePerEditorChange, this));\n\n\t\tthis._registerNotebookActionsToolbar();\n\n\t\tthis._register(DOM.addDisposableListener(this.domNode, DOM.EventType.CONTEXT_MENU, e => {\n\t\t\tconst event = new StandardMouseEvent(DOM.getWindow(this.domNode), e);\n\t\t\tthis.contextMenuService.showContextMenu({\n\t\t\t\tmenuId: MenuId.NotebookToolbarContext,\n\t\t\t\tgetAnchor: () => event,\n\t\t\t});\n\t\t}));\n\t}\n\n\tprivate _buildBody() {\n\t\tthis._notebookTopLeftToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopLeftToolbarContainer.classList.add('notebook-toolbar-left');\n\t\tthis._leftToolbarScrollable = new DomScrollableElement(this._notebookTopLeftToolbarContainer, {\n\t\t\tvertical: ScrollbarVisibility.Hidden,\n\t\t\thorizontal: ScrollbarVisibility.Visible,\n\t\t\thorizontalScrollbarSize: 3,\n\t\t\tuseShadows: false,\n\t\t\tscrollYToX: true\n\t\t});\n\t\tthis._register(this._leftToolbarScrollable);\n\n\t\tDOM.append(this.domNode, this._leftToolbarScrollable.getDomNode());\n\t\tthis._notebookTopRightToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopRightToolbarContainer.classList.add('notebook-toolbar-right');\n\t\tDOM.append(this.domNode, this._notebookTopRightToolbarContainer);\n\t}\n\n\tprivate _updatePerEditorChange() {\n\t\tif (this.editorService.activeEditorPane?.getId() === NOTEBOOK_EDITOR_ID) {\n\t\t\tconst notebookEditor = this.editorService.activeEditorPane.getControl() as INotebookEditorDelegate;\n\t\t\tif (notebookEditor === this.notebookEditor) {\n\t\t\t\t// this is the active editor\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerNotebookActionsToolbar() {\n\t\tthis._notebookGlobalActionsMenu = this._register(this.menuService.createMenu(this.notebookEditor.creationOptions.menuIds.notebookToolbar, this.contextKeyService));\n\t\tthis._executeGoToActionsMenu = this._register(this.menuService.createMenu(MenuId.NotebookCellExecuteGoTo, this.contextKeyService));\n\n\t\tthis._useGlobalToolbar = this.notebookOptions.getDisplayOptions().globalToolbar;\n\t\tthis._renderLabel = this._convertConfiguration(this.configurationService.getValue(NotebookSetting.globalToolbarShowLabel));\n\t\tthis._updateStrategy();\n\n\t\tconst context = {\n\t\t\tui: true,\n\t\t\tnotebookEditor: this.notebookEditor,\n\t\t\tsource: 'notebookToolbar'\n\t\t};\n\n\t\tconst actionProvider = (action: IAction, options: IActionViewItemOptions) => {\n\t\t\tif (action.id === SELECT_KERNEL_ID) {\n\t\t\t\t// this is being disposed by the consumer\n\t\t\t\treturn this.instantiationService.createInstance(NotebooKernelActionViewItem, action, this.notebookEditor, options);\n\t\t\t}\n\n\t\t\tif (this._renderLabel !== RenderLabel.Never) {\n\t\t\t\tconst a = this._primaryActions.find(a => a.action.id === action.id);\n\t\t\t\tif (a && a.renderLabel) {\n\t\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(ActionViewWithLabel, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn action instanceof MenuItemAction ? this.instantiationService.createInstance(MenuEntryActionViewItem, action, { hoverDelegate: options.hoverDelegate }) : undefined;\n\t\t\t}\n\t\t};\n\n\t\t// Make sure both toolbars have the same hover delegate for instant hover to work\n\t\t// Due to the elements being further apart than normal toolbars, the default time limit is to short and has to be increased\n\t\tconst hoverDelegate = this._register(this.instantiationService.createInstance(WorkbenchHoverDelegate, 'element', { instantHover: true }, {}));\n\t\thoverDelegate.setInstantHoverTimeLimit(600);\n\n\t\tconst leftToolbarOptions: IWorkbenchToolBarOptions = {\n\t\t\thiddenItemStrategy: HiddenItemStrategy.RenderInSecondaryGroup,\n\t\t\tresetMenu: MenuId.NotebookToolbar,\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\treturn this._strategy.actionProvider(action, options);\n\t\t\t},\n\t\t\tgetKeyBinding: action => this.keybindingService.lookupKeybinding(action.id),\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\thoverDelegate\n\t\t};\n\n\t\tthis._notebookLeftToolbar = this.instantiationService.createInstance(\n\t\t\tWorkbenchToolBar,\n\t\t\tthis._notebookTopLeftToolbarContainer,\n\t\t\tleftToolbarOptions\n\t\t);\n\t\tthis._register(this._notebookLeftToolbar);\n\t\tthis._notebookLeftToolbar.context = context;\n\n\t\tthis._notebookRightToolbar = new ToolBar(this._notebookTopRightToolbarContainer, this.contextMenuService, {\n\t\t\tgetKeyBinding: action => this.keybindingService.lookupKeybinding(action.id),\n\t\t\tactionViewItemProvider: actionProvider,\n\t\t\trenderDropdownAsChildElement: true,\n\t\t\thoverDelegate\n\t\t});\n\t\tthis._register(this._notebookRightToolbar);\n\t\tthis._notebookRightToolbar.context = context;\n\n\t\tthis._showNotebookActionsinEditorToolbar();\n\t\tlet dropdownIsVisible = false;\n\t\tlet deferredUpdate: (() => void) | undefined;\n\n\t\tthis._register(this._notebookGlobalActionsMenu.onDidChange(() => {\n\t\t\tif (dropdownIsVisible) {\n\t\t\t\tdeferredUpdate = () => this._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.notebookEditor.isVisible) {\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._notebookLeftToolbar.onDidChangeDropdownVisibility(visible => {\n\t\t\tdropdownIsVisible = visible;\n\n\t\t\tif (deferredUpdate && !visible) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdeferredUpdate?.();\n\t\t\t\t}, 0);\n\t\t\t\tdeferredUpdate = undefined;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.globalToolbar !== undefined) {\n\t\t\t\tthis._useGlobalToolbar = this.notebookOptions.getDisplayOptions().globalToolbar;\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(NotebookSetting.globalToolbarShowLabel)) {\n\t\t\t\tthis._renderLabel = this._convertConfiguration(this.configurationService.getValue<RenderLabelWithFallback>(NotebookSetting.globalToolbarShowLabel));\n\t\t\t\tthis._updateStrategy();\n\t\t\t\tconst oldElement = this._notebookLeftToolbar.getElement();\n\t\t\t\toldElement.remove();\n\t\t\t\tthis._notebookLeftToolbar.dispose();\n\n\t\t\t\tthis._notebookLeftToolbar = this.instantiationService.createInstance(\n\t\t\t\t\tWorkbenchToolBar,\n\t\t\t\t\tthis._notebookTopLeftToolbarContainer,\n\t\t\t\t\tleftToolbarOptions\n\t\t\t\t);\n\n\t\t\t\tthis._register(this._notebookLeftToolbar);\n\t\t\t\tthis._notebookLeftToolbar.context = context;\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _updateStrategy() {\n\t\tswitch (this._renderLabel) {\n\t\t\tcase RenderLabel.Always:\n\t\t\t\tthis._strategy = new WorkbenchAlwaysLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t\tcase RenderLabel.Never:\n\t\t\t\tthis._strategy = new WorkbenchNeverLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t\tcase RenderLabel.Dynamic:\n\t\t\t\tthis._strategy = new WorkbenchDynamicLabelStrategy(this.notebookEditor, this, this._executeGoToActionsMenu, this.instantiationService);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _convertConfiguration(value: RenderLabelWithFallback): RenderLabel {\n\t\tswitch (value) {\n\t\t\tcase true:\n\t\t\t\treturn RenderLabel.Always;\n\t\t\tcase false:\n\t\t\t\treturn RenderLabel.Never;\n\t\t\tcase 'always':\n\t\t\t\treturn RenderLabel.Always;\n\t\t\tcase 'never':\n\t\t\t\treturn RenderLabel.Never;\n\t\t\tcase 'dynamic':\n\t\t\t\treturn RenderLabel.Dynamic;\n\t\t}\n\t}\n\n\tprivate _showNotebookActionsinEditorToolbar() {\n\t\t// when there is no view model, just ignore.\n\t\tif (!this.notebookEditor.hasModel()) {\n\t\t\tthis._deferredActionUpdate?.dispose();\n\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\tthis.visible = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._deferredActionUpdate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._useGlobalToolbar) {\n\t\t\tthis.domNode.style.display = 'none';\n\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\tthis.visible = false;\n\t\t} else {\n\t\t\tthis._deferredActionUpdate = disposableTimeout(async () => {\n\t\t\t\tawait this._setNotebookActions();\n\t\t\t\tthis.visible = true;\n\t\t\t\tthis._deferredActionUpdate?.dispose();\n\t\t\t\tthis._deferredActionUpdate = undefined;\n\t\t\t}, 50);\n\t\t}\n\t}\n\n\tprivate async _setNotebookActions() {\n\t\tconst groups = this._notebookGlobalActionsMenu.getActions({ shouldForwardArgs: true, renderShortTitle: true });\n\t\tthis.domNode.style.display = 'flex';\n\t\tconst primaryLeftGroups = groups.filter(group => /^navigation/.test(group[0]));\n\t\tconst primaryActions: IAction[] = [];\n\t\tprimaryLeftGroups.sort((a, b) => {\n\t\t\tif (a[0] === 'navigation') {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (b[0] === 'navigation') {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}).forEach((group, index) => {\n\t\t\tprimaryActions.push(...group[1]);\n\t\t\tif (index < primaryLeftGroups.length - 1) {\n\t\t\t\tprimaryActions.push(new Separator());\n\t\t\t}\n\t\t});\n\t\tconst primaryRightGroup = groups.find(group => /^status/.test(group[0]));\n\t\tconst primaryRightActions = primaryRightGroup ? primaryRightGroup[1] : [];\n\t\tconst secondaryActions = groups.filter(group => !/^navigation/.test(group[0]) && !/^status/.test(group[0])).reduce((prev: (MenuItemAction | SubmenuItemAction)[], curr) => { prev.push(...curr[1]); return prev; }, []);\n\n\t\tthis._notebookLeftToolbar.setActions([], []);\n\n\t\tthis._primaryActions = primaryActions.map(action => ({\n\t\t\taction: action,\n\t\t\tsize: (action instanceof Separator ? 1 : 0),\n\t\t\trenderLabel: true,\n\t\t\tvisible: true\n\t\t}));\n\t\tthis._notebookLeftToolbar.setActions(primaryActions, secondaryActions);\n\t\tthis._secondaryActions = secondaryActions;\n\n\t\tthis._notebookRightToolbar.setActions(primaryRightActions, []);\n\t\tthis._secondaryActions = secondaryActions;\n\n\n\t\tif (this._dimension && this._dimension.width >= 0 && this._dimension.height >= 0) {\n\t\t\tthis._cacheItemSizes(this._notebookLeftToolbar);\n\t\t}\n\n\t\tthis._computeSizes();\n\t}\n\n\tprivate _cacheItemSizes(toolbar: WorkbenchToolBar) {\n\t\tfor (let i = 0; i < toolbar.getItemsLength(); i++) {\n\t\t\tconst action = toolbar.getItemAction(i);\n\t\t\tif (action && action.id !== 'toolbar.toggle.more') {\n\t\t\t\tconst existing = this._primaryActions.find(a => a.action.id === action.id);\n\t\t\t\tif (existing) {\n\t\t\t\t\texisting.size = toolbar.getItemWidth(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _computeSizes() {\n\t\tconst toolbar = this._notebookLeftToolbar;\n\t\tconst rightToolbar = this._notebookRightToolbar;\n\t\tif (toolbar && rightToolbar && this._dimension && this._dimension.height >= 0 && this._dimension.width >= 0) {\n\t\t\t// compute size only if it's visible\n\t\t\tif (this._primaryActions.length === 0 && toolbar.getItemsLength() !== this._primaryActions.length) {\n\t\t\t\tthis._cacheItemSizes(this._notebookLeftToolbar);\n\t\t\t}\n\n\t\t\tif (this._primaryActions.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst kernelWidth = (rightToolbar.getItemsLength() ? rightToolbar.getItemWidth(0) : 0) + ACTION_PADDING;\n\t\t\tconst leftToolbarContainerMaxWidth = this._dimension.width - kernelWidth - (ACTION_PADDING + TOGGLE_MORE_ACTION_WIDTH) - (/** toolbar left margin */ACTION_PADDING) - (/** toolbar right margin */ACTION_PADDING);\n\t\t\tconst calculatedActions = this._strategy.calculateActions(leftToolbarContainerMaxWidth);\n\t\t\tthis._notebookLeftToolbar.setActions(calculatedActions.primaryActions, calculatedActions.secondaryActions);\n\t\t}\n\t}\n\n\tlayout(dimension: DOM.Dimension) {\n\t\tthis._dimension = dimension;\n\n\t\tif (!this._useGlobalToolbar) {\n\t\t\tthis.domNode.style.display = 'none';\n\t\t} else {\n\t\t\tthis.domNode.style.display = 'flex';\n\t\t}\n\t\tthis._computeSizes();\n\t}\n\n\toverride dispose() {\n\t\tthis._notebookLeftToolbar.context = undefined;\n\t\tthis._notebookRightToolbar.context = undefined;\n\t\tthis._notebookLeftToolbar.dispose();\n\t\tthis._notebookRightToolbar.dispose();\n\t\tthis._notebookLeftToolbar = null!;\n\t\tthis._notebookRightToolbar = null!;\n\t\tthis._deferredActionUpdate?.dispose();\n\t\tthis._deferredActionUpdate = undefined;\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport function workbenchCalculateActions(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, false);\n}\n\nexport function workbenchDynamicCalculateActions(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\n\tif (initialPrimaryActions.length === 0) {\n\t\treturn { primaryActions: [], secondaryActions: initialSecondaryActions };\n\t}\n\n\t// find true length of array, add 1 for each primary actions, ignoring an item when size = 0\n\tconst visibleActionLength = initialPrimaryActions.filter(action => action.size !== 0).length;\n\n\t// step 1: try to fit all primary actions\n\tconst totalWidthWithLabels = initialPrimaryActions.map(action => action.size).reduce((a, b) => a + b, 0) + (visibleActionLength - 1) * ACTION_PADDING;\n\tif (totalWidthWithLabels <= leftToolbarContainerMaxWidth) {\n\t\tinitialPrimaryActions.forEach(action => {\n\t\t\taction.renderLabel = true;\n\t\t});\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, false);\n\t}\n\n\t// step 2: check if they fit without labels\n\tif ((visibleActionLength * ICON_ONLY_ACTION_WIDTH + (visibleActionLength - 1) * ACTION_PADDING) > leftToolbarContainerMaxWidth) {\n\t\tinitialPrimaryActions.forEach(action => { action.renderLabel = false; });\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, true);\n\t}\n\n\t// step 3: render as many actions as possible with labels, rest without.\n\tlet sum = 0;\n\tlet lastActionWithLabel = -1;\n\tfor (let i = 0; i < initialPrimaryActions.length; i++) {\n\t\tsum += initialPrimaryActions[i].size + ACTION_PADDING;\n\n\t\tif (initialPrimaryActions[i].action instanceof Separator) {\n\t\t\t// find group separator\n\t\t\tconst remainingItems = initialPrimaryActions.slice(i + 1).filter(action => action.size !== 0); // todo: need to exclude size 0 items from this\n\t\t\tconst newTotalSum = sum + (remainingItems.length === 0 ? 0 : (remainingItems.length * ICON_ONLY_ACTION_WIDTH + (remainingItems.length - 1) * ACTION_PADDING));\n\t\t\tif (newTotalSum <= leftToolbarContainerMaxWidth) {\n\t\t\t\tlastActionWithLabel = i;\n\t\t\t}\n\t\t} else {\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\t// icons only don't fit either\n\tif (lastActionWithLabel < 0) {\n\t\tinitialPrimaryActions.forEach(action => { action.renderLabel = false; });\n\t\treturn actionOverflowHelper(initialPrimaryActions, initialSecondaryActions, leftToolbarContainerMaxWidth, true);\n\t}\n\n\t// render labels for the actions that have space\n\tinitialPrimaryActions.slice(0, lastActionWithLabel + 1).forEach(action => { action.renderLabel = true; });\n\tinitialPrimaryActions.slice(lastActionWithLabel + 1).forEach(action => { action.renderLabel = false; });\n\treturn {\n\t\tprimaryActions: initialPrimaryActions,\n\t\tsecondaryActions: initialSecondaryActions\n\t};\n}\n\nfunction actionOverflowHelper(initialPrimaryActions: IActionModel[], initialSecondaryActions: IAction[], leftToolbarContainerMaxWidth: number, iconOnly: boolean): { primaryActions: IActionModel[]; secondaryActions: IAction[] } {\n\tconst renderActions: IActionModel[] = [];\n\tconst overflow: IAction[] = [];\n\n\tlet currentSize = 0;\n\tlet nonZeroAction = false;\n\tlet containerFull = false;\n\n\tif (initialPrimaryActions.length === 0) {\n\t\treturn { primaryActions: [], secondaryActions: initialSecondaryActions };\n\t}\n\n\tfor (let i = 0; i < initialPrimaryActions.length; i++) {\n\t\tconst actionModel = initialPrimaryActions[i];\n\t\tconst itemSize = iconOnly ? (actionModel.size === 0 ? 0 : ICON_ONLY_ACTION_WIDTH) : actionModel.size;\n\n\t\t// if two separators in a row, ignore the second\n\t\tif (actionModel.action instanceof Separator && renderActions.length > 0 && renderActions[renderActions.length - 1].action instanceof Separator) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// if a separator is the first nonZero action, ignore it\n\t\tif (actionModel.action instanceof Separator && !nonZeroAction) {\n\t\t\tcontinue;\n\t\t}\n\n\n\t\tif (currentSize + itemSize <= leftToolbarContainerMaxWidth && !containerFull) {\n\t\t\tcurrentSize += ACTION_PADDING + itemSize;\n\t\t\trenderActions.push(actionModel);\n\t\t\tif (itemSize !== 0) {\n\t\t\t\tnonZeroAction = true;\n\t\t\t}\n\t\t\tif (actionModel.action instanceof Separator) {\n\t\t\t\tnonZeroAction = false;\n\t\t\t}\n\t\t} else {\n\t\t\tcontainerFull = true;\n\t\t\tif (itemSize === 0) { // size 0 implies a hidden item, keep in primary to allow for Workbench to handle visibility\n\t\t\t\trenderActions.push(actionModel);\n\t\t\t} else {\n\t\t\t\tif (actionModel.action instanceof Separator) { // never push a separator to overflow\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\toverflow.push(actionModel.action);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (let i = (renderActions.length - 1); i > 0; i--) {\n\t\tconst temp = renderActions[i];\n\t\tif (temp.size === 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (temp.action instanceof Separator) {\n\t\t\trenderActions.splice(i, 1);\n\t\t}\n\t\tbreak;\n\t}\n\n\n\tif (renderActions.length && renderActions[renderActions.length - 1].action instanceof Separator) {\n\t\trenderActions.pop();\n\t}\n\n\tif (overflow.length !== 0) {\n\t\toverflow.push(new Separator());\n\t}\n\n\tif (iconOnly) {\n\t\t// if icon only mode, don't render both (+ code) and (+ markdown) buttons. remove of markdown action\n\t\tconst markdownIndex = renderActions.findIndex(a => a.action.id === 'notebook.cell.insertMarkdownCellBelow');\n\t\tif (markdownIndex !== -1) {\n\t\t\trenderActions.splice(markdownIndex, 1);\n\t\t}\n\t}\n\n\treturn {\n\t\tprimaryActions: renderActions,\n\t\tsecondaryActions: [...overflow, ...initialSecondaryActions]\n\t};\n}\n"]}