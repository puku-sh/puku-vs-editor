{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel.ts","vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel.ts"],"names":[],"mappings":"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","file":"diffNestedCellViewModel.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { generateUuid } from '../../../../../base/common/uuid.js';\nimport { PrefixSumComputer } from '../../../../../editor/common/model/prefixSumComputer.js';\nimport { IDiffNestedCellViewModel } from './notebookDiffEditorBrowser.js';\nimport { ICellOutputViewModel, IGenericCellViewModel } from '../notebookBrowser.js';\nimport { CellViewModelStateChangeEvent } from '../notebookViewEvents.js';\nimport { CellOutputViewModel } from '../viewModel/cellOutputViewModel.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { INotebookService } from '../../common/notebookService.js';\n\nexport class DiffNestedCellViewModel extends Disposable implements IDiffNestedCellViewModel, IGenericCellViewModel {\n\tprivate _id: string;\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget outputs() {\n\t\treturn this.textModel.outputs;\n\t}\n\n\tget language() {\n\t\treturn this.textModel.language;\n\t}\n\n\tget metadata() {\n\t\treturn this.textModel.metadata;\n\t}\n\n\tget uri() {\n\t\treturn this.textModel.uri;\n\t}\n\n\tget handle() {\n\t\treturn this.textModel.handle;\n\t}\n\n\tprotected readonly _onDidChangeState: Emitter<CellViewModelStateChangeEvent> = this._register(new Emitter<CellViewModelStateChangeEvent>());\n\n\tprivate _hoveringOutput: boolean = false;\n\tpublic get outputIsHovered(): boolean {\n\t\treturn this._hoveringOutput;\n\t}\n\n\tpublic set outputIsHovered(v: boolean) {\n\t\tthis._hoveringOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsHoveredChanged: true });\n\t}\n\n\tprivate _focusOnOutput: boolean = false;\n\tpublic get outputIsFocused(): boolean {\n\t\treturn this._focusOnOutput;\n\t}\n\n\tpublic set outputIsFocused(v: boolean) {\n\t\tthis._focusOnOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsFocusedChanged: true });\n\t}\n\n\tprivate _focusInputInOutput: boolean = false;\n\tpublic get inputInOutputIsFocused(): boolean {\n\t\treturn this._focusInputInOutput;\n\t}\n\n\tpublic set inputInOutputIsFocused(v: boolean) {\n\t\tthis._focusInputInOutput = v;\n\t}\n\n\tprivate _outputViewModels: ICellOutputViewModel[];\n\n\tget outputsViewModels() {\n\t\treturn this._outputViewModels;\n\t}\n\n\tprotected _outputCollection: number[] = [];\n\tprotected _outputsTop: PrefixSumComputer | null = null;\n\n\tprotected readonly _onDidChangeOutputLayout = this._register(new Emitter<void>());\n\treadonly onDidChangeOutputLayout = this._onDidChangeOutputLayout.event;\n\n\tconstructor(\n\t\treadonly textModel: NotebookCellTextModel,\n\t\t@INotebookService private _notebookService: INotebookService\n\t) {\n\t\tsuper();\n\t\tthis._id = generateUuid();\n\n\t\tthis._outputViewModels = this.textModel.outputs.map(output => new CellOutputViewModel(this, output, this._notebookService));\n\t\tthis._register(this.textModel.onDidChangeOutputs((splice) => {\n\t\t\tthis._outputCollection.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(() => 0));\n\t\t\tconst removed = this._outputViewModels.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(output => new CellOutputViewModel(this, output, this._notebookService)));\n\t\t\tremoved.forEach(vm => vm.dispose());\n\n\t\t\tthis._outputsTop = null;\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}));\n\t\tthis._outputCollection = new Array(this.textModel.outputs.length);\n\t}\n\n\tprivate _ensureOutputsTop() {\n\t\tif (!this._outputsTop) {\n\t\t\tconst values = new Uint32Array(this._outputCollection.length);\n\t\t\tfor (let i = 0; i < this._outputCollection.length; i++) {\n\t\t\t\tvalues[i] = this._outputCollection[i];\n\t\t\t}\n\n\t\t\tthis._outputsTop = new PrefixSumComputer(values);\n\t\t}\n\t}\n\n\tgetOutputOffset(index: number): number {\n\t\tthis._ensureOutputsTop();\n\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error('Output index out of range!');\n\t\t}\n\n\t\treturn this._outputsTop!.getPrefixSum(index - 1);\n\t}\n\n\tupdateOutputHeight(index: number, height: number): void {\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error('Output index out of range!');\n\t\t}\n\n\t\tthis._ensureOutputsTop();\n\t\tthis._outputCollection[index] = height;\n\t\tif (this._outputsTop!.setValue(index, height)) {\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}\n\t}\n\n\tgetOutputTotalHeight() {\n\t\tthis._ensureOutputsTop();\n\n\t\treturn this._outputsTop?.getTotalSum() ?? 0;\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._outputViewModels.forEach(output => {\n\t\t\toutput.dispose();\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { generateUuid } from '../../../../../base/common/uuid.js';\nimport { PrefixSumComputer } from '../../../../../editor/common/model/prefixSumComputer.js';\nimport { IDiffNestedCellViewModel } from './notebookDiffEditorBrowser.js';\nimport { ICellOutputViewModel, IGenericCellViewModel } from '../notebookBrowser.js';\nimport { CellViewModelStateChangeEvent } from '../notebookViewEvents.js';\nimport { CellOutputViewModel } from '../viewModel/cellOutputViewModel.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { INotebookService } from '../../common/notebookService.js';\n\nexport class DiffNestedCellViewModel extends Disposable implements IDiffNestedCellViewModel, IGenericCellViewModel {\n\tprivate _id: string;\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget outputs() {\n\t\treturn this.textModel.outputs;\n\t}\n\n\tget language() {\n\t\treturn this.textModel.language;\n\t}\n\n\tget metadata() {\n\t\treturn this.textModel.metadata;\n\t}\n\n\tget uri() {\n\t\treturn this.textModel.uri;\n\t}\n\n\tget handle() {\n\t\treturn this.textModel.handle;\n\t}\n\n\tprotected readonly _onDidChangeState: Emitter<CellViewModelStateChangeEvent> = this._register(new Emitter<CellViewModelStateChangeEvent>());\n\n\tprivate _hoveringOutput: boolean = false;\n\tpublic get outputIsHovered(): boolean {\n\t\treturn this._hoveringOutput;\n\t}\n\n\tpublic set outputIsHovered(v: boolean) {\n\t\tthis._hoveringOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsHoveredChanged: true });\n\t}\n\n\tprivate _focusOnOutput: boolean = false;\n\tpublic get outputIsFocused(): boolean {\n\t\treturn this._focusOnOutput;\n\t}\n\n\tpublic set outputIsFocused(v: boolean) {\n\t\tthis._focusOnOutput = v;\n\t\tthis._onDidChangeState.fire({ outputIsFocusedChanged: true });\n\t}\n\n\tprivate _focusInputInOutput: boolean = false;\n\tpublic get inputInOutputIsFocused(): boolean {\n\t\treturn this._focusInputInOutput;\n\t}\n\n\tpublic set inputInOutputIsFocused(v: boolean) {\n\t\tthis._focusInputInOutput = v;\n\t}\n\n\tprivate _outputViewModels: ICellOutputViewModel[];\n\n\tget outputsViewModels() {\n\t\treturn this._outputViewModels;\n\t}\n\n\tprotected _outputCollection: number[] = [];\n\tprotected _outputsTop: PrefixSumComputer | null = null;\n\n\tprotected readonly _onDidChangeOutputLayout = this._register(new Emitter<void>());\n\treadonly onDidChangeOutputLayout = this._onDidChangeOutputLayout.event;\n\n\tconstructor(\n\t\treadonly textModel: NotebookCellTextModel,\n\t\t@INotebookService private _notebookService: INotebookService\n\t) {\n\t\tsuper();\n\t\tthis._id = generateUuid();\n\n\t\tthis._outputViewModels = this.textModel.outputs.map(output => new CellOutputViewModel(this, output, this._notebookService));\n\t\tthis._register(this.textModel.onDidChangeOutputs((splice) => {\n\t\t\tthis._outputCollection.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(() => 0));\n\t\t\tconst removed = this._outputViewModels.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(output => new CellOutputViewModel(this, output, this._notebookService)));\n\t\t\tremoved.forEach(vm => vm.dispose());\n\n\t\t\tthis._outputsTop = null;\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}));\n\t\tthis._outputCollection = new Array(this.textModel.outputs.length);\n\t}\n\n\tprivate _ensureOutputsTop() {\n\t\tif (!this._outputsTop) {\n\t\t\tconst values = new Uint32Array(this._outputCollection.length);\n\t\t\tfor (let i = 0; i < this._outputCollection.length; i++) {\n\t\t\t\tvalues[i] = this._outputCollection[i];\n\t\t\t}\n\n\t\t\tthis._outputsTop = new PrefixSumComputer(values);\n\t\t}\n\t}\n\n\tgetOutputOffset(index: number): number {\n\t\tthis._ensureOutputsTop();\n\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error('Output index out of range!');\n\t\t}\n\n\t\treturn this._outputsTop!.getPrefixSum(index - 1);\n\t}\n\n\tupdateOutputHeight(index: number, height: number): void {\n\t\tif (index >= this._outputCollection.length) {\n\t\t\tthrow new Error('Output index out of range!');\n\t\t}\n\n\t\tthis._ensureOutputsTop();\n\t\tthis._outputCollection[index] = height;\n\t\tif (this._outputsTop!.setValue(index, height)) {\n\t\t\tthis._onDidChangeOutputLayout.fire();\n\t\t}\n\t}\n\n\tgetOutputTotalHeight() {\n\t\tthis._ensureOutputsTop();\n\n\t\treturn this._outputsTop?.getTotalSum() ?? 0;\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._outputViewModels.forEach(output => {\n\t\t\toutput.dispose();\n\t\t});\n\t}\n}\n"]}