{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/browser/view/notebookCellListView.ts","vs/workbench/contrib/notebook/browser/view/notebookCellListView.ts"],"names":[],"mappings":"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","file":"notebookCellListView.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IRange } from '../../../../../base/common/range.js';\nimport { ListView } from '../../../../../base/browser/ui/list/listView.js';\nimport { IItem, IRangeMap } from '../../../../../base/browser/ui/list/rangeMap.js';\nimport { ConstantTimePrefixSumComputer } from '../../../../../editor/common/model/prefixSumComputer.js';\n\nexport interface IWhitespace {\n\tid: string;\n\t/**\n\t * To insert whitespace before the first item, use afterPosition 0.\n\t * In other cases, afterPosition is 1-based.\n\t */\n\tafterPosition: number;\n\tsize: number;\n\tpriority: number;\n}\nexport class NotebookCellsLayout implements IRangeMap {\n\tprivate _items: IItem[] = [];\n\tprivate _whitespace: IWhitespace[] = [];\n\tprotected _prefixSumComputer: ConstantTimePrefixSumComputer = new ConstantTimePrefixSumComputer([]);\n\tprivate _size = 0;\n\tprivate _paddingTop = 0;\n\n\tget paddingTop() {\n\t\treturn this._paddingTop;\n\t}\n\n\tset paddingTop(paddingTop: number) {\n\t\tthis._size = this._size + paddingTop - this._paddingTop;\n\t\tthis._paddingTop = paddingTop;\n\t}\n\n\tget count(): number {\n\t\treturn this._items.length;\n\t}\n\n\t/**\n\t * Returns the sum of the sizes of all items in the range map.\n\t */\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tconstructor(topPadding?: number) {\n\t\tthis._paddingTop = topPadding ?? 0;\n\t\tthis._size = this._paddingTop;\n\t}\n\n\tgetWhitespaces(): IWhitespace[] {\n\t\treturn this._whitespace;\n\t}\n\n\trestoreWhitespace(items: IWhitespace[]) {\n\t\tthis._whitespace = items;\n\t\tthis._size = this._paddingTop + this._items.reduce((total, item) => total + item.size, 0) + this._whitespace.reduce((total, ws) => total + ws.size, 0);\n\t}\n\n\t/**\n\t */\n\tsplice(index: number, deleteCount: number, items?: IItem[] | undefined): void {\n\t\tconst inserts = items ?? [];\n\t\t// Perform the splice operation on the items array.\n\t\tthis._items.splice(index, deleteCount, ...inserts);\n\n\t\tthis._size = this._paddingTop + this._items.reduce((total, item) => total + item.size, 0) + this._whitespace.reduce((total, ws) => total + ws.size, 0);\n\t\tthis._prefixSumComputer.removeValues(index, deleteCount);\n\n\t\t// inserts should also include whitespaces\n\t\tconst newSizes = [];\n\t\tfor (let i = 0; i < inserts.length; i++) {\n\t\t\tconst insertIndex = i + index;\n\t\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === insertIndex + 1);\n\n\n\t\t\tif (existingWhitespaces.length > 0) {\n\t\t\t\tnewSizes.push(inserts[i].size + existingWhitespaces.reduce((acc, ws) => acc + ws.size, 0));\n\t\t\t} else {\n\t\t\t\tnewSizes.push(inserts[i].size);\n\t\t\t}\n\t\t}\n\t\tthis._prefixSumComputer.insertValues(index, newSizes);\n\n\t\t// Now that the items array has been updated, and the whitespaces are updated elsewhere, if an item is removed/inserted, the accumlated size of the items are all updated.\n\t\t// Loop through all items from the index where the splice started, to the end\n\t\tfor (let i = index; i < this._items.length; i++) {\n\t\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === i + 1);\n\t\t\tif (existingWhitespaces.length > 0) {\n\t\t\t\tthis._prefixSumComputer.setValue(i, this._items[i].size + existingWhitespaces.reduce((acc, ws) => acc + ws.size, 0));\n\t\t\t} else {\n\t\t\t\tthis._prefixSumComputer.setValue(i, this._items[i].size);\n\t\t\t}\n\t\t}\n\t}\n\n\tinsertWhitespace(id: string, afterPosition: number, size: number): void {\n\t\tlet priority = 0;\n\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === afterPosition);\n\t\tif (existingWhitespaces.length > 0) {\n\t\t\tpriority = Math.max(...existingWhitespaces.map(ws => ws.priority)) + 1;\n\t\t}\n\n\t\tthis._whitespace.push({ id, afterPosition: afterPosition, size, priority });\n\t\tthis._size += size; // Update the total size to include the whitespace\n\t\tthis._whitespace.sort((a, b) => {\n\t\t\tif (a.afterPosition === b.afterPosition) {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t}\n\t\t\treturn a.afterPosition - b.afterPosition;\n\t\t});\n\n\t\t// find item size of index\n\t\tif (afterPosition > 0) {\n\t\t\tconst index = afterPosition - 1;\n\t\t\tconst itemSize = this._items[index].size;\n\t\t\tconst accSize = itemSize + size;\n\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t}\n\t}\n\n\tchangeOneWhitespace(id: string, afterPosition: number, size: number): void {\n\t\tconst whitespaceIndex = this._whitespace.findIndex(ws => ws.id === id);\n\t\tif (whitespaceIndex !== -1) {\n\t\t\tconst whitespace = this._whitespace[whitespaceIndex];\n\t\t\tconst oldAfterPosition = whitespace.afterPosition;\n\t\t\twhitespace.afterPosition = afterPosition;\n\t\t\tconst oldSize = whitespace.size;\n\t\t\tconst delta = size - oldSize;\n\t\t\twhitespace.size = size;\n\t\t\tthis._size += delta;\n\n\t\t\tif (oldAfterPosition > 0 && oldAfterPosition <= this._items.length) {\n\t\t\t\tconst index = oldAfterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst accSize = itemSize;\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\n\t\t\tif (afterPosition > 0 && afterPosition <= this._items.length) {\n\t\t\t\tconst index = afterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst accSize = itemSize + size;\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveWhitespace(id: string): void {\n\t\tconst whitespaceIndex = this._whitespace.findIndex(ws => ws.id === id);\n\t\tif (whitespaceIndex !== -1) {\n\t\t\tconst whitespace = this._whitespace[whitespaceIndex];\n\t\t\tthis._whitespace.splice(whitespaceIndex, 1);\n\t\t\tthis._size -= whitespace.size; // Reduce the total size by the size of the removed whitespace\n\n\t\t\tif (whitespace.afterPosition > 0) {\n\t\t\t\tconst index = whitespace.afterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst remainingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === whitespace.afterPosition);\n\t\t\t\tconst accSize = itemSize + remainingWhitespaces.reduce((acc, ws) => acc + ws.size, 0);\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * find position of whitespace\n\t * @param id: id of the whitespace\n\t * @returns: position in the list view\n\t */\n\tgetWhitespacePosition(id: string): number {\n\t\tconst whitespace = this._whitespace.find(ws => ws.id === id);\n\t\tif (!whitespace) {\n\t\t\tthrow new Error('Whitespace not found');\n\t\t}\n\n\t\tconst afterPosition = whitespace.afterPosition;\n\t\tif (afterPosition === 0) {\n\t\t\t// find all whitespaces at the same position but with higher priority (smaller number)\n\t\t\tconst whitespaces = this._whitespace.filter(ws => ws.afterPosition === afterPosition && ws.priority < whitespace.priority);\n\t\t\treturn whitespaces.reduce((acc, ws) => acc + ws.size, 0) + this.paddingTop;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\n\t\t// previous item index\n\t\tconst index = afterPosition - 1;\n\t\tconst previousItemPosition = this._prefixSumComputer.getPrefixSum(index);\n\t\tconst previousItemSize = this._items[index].size;\n\t\treturn previousItemPosition + previousItemSize + whitespaceBeforeFirstItem + this.paddingTop;\n\t}\n\n\tindexAt(position: number): number {\n\t\tif (position < 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\n\t\tconst offset = position - (this._paddingTop + whitespaceBeforeFirstItem);\n\t\tif (offset <= 0) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (offset >= (this._size - this._paddingTop - whitespaceBeforeFirstItem)) {\n\t\t\treturn this.count;\n\t\t}\n\n\t\treturn this._prefixSumComputer.getIndexOf(Math.trunc(offset)).index;\n\t}\n\n\tindexAfter(position: number): number {\n\t\tconst index = this.indexAt(position);\n\t\treturn Math.min(index + 1, this._items.length);\n\t}\n\n\tpositionAt(index: number): number {\n\t\tif (index < 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (this.count === 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\t// index is zero based, if index+1 > this.count, then it points to the fictitious element after the last element of this array.\n\t\tif (index >= this.count) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\t\treturn this._prefixSumComputer.getPrefixSum(index/** count */) + this._paddingTop + whitespaceBeforeFirstItem;\n\t}\n}\n\nexport class NotebookCellListView<T> extends ListView<T> {\n\tprivate _lastWhitespaceId: number = 0;\n\tprivate _renderingStack = 0;\n\n\tget inRenderingTransaction(): boolean {\n\t\treturn this._renderingStack > 0;\n\t}\n\n\tget notebookRangeMap(): NotebookCellsLayout {\n\t\treturn this.rangeMap as NotebookCellsLayout;\n\t}\n\n\tprotected override render(previousRenderRange: IRange, renderTop: number, renderHeight: number, renderLeft: number | undefined, scrollWidth: number | undefined, updateItemsInDOM?: boolean): void {\n\t\tthis._renderingStack++;\n\t\tsuper.render(previousRenderRange, renderTop, renderHeight, renderLeft, scrollWidth, updateItemsInDOM);\n\t\tthis._renderingStack--;\n\t}\n\n\tprotected override _rerender(renderTop: number, renderHeight: number, inSmoothScrolling?: boolean | undefined): void {\n\t\tthis._renderingStack++;\n\t\tsuper._rerender(renderTop, renderHeight, inSmoothScrolling);\n\t\tthis._renderingStack--;\n\t}\n\n\tprotected override createRangeMap(paddingTop: number): IRangeMap {\n\t\tconst existingMap = this.rangeMap as NotebookCellsLayout | undefined;\n\t\tif (existingMap) {\n\t\t\tconst layout = new NotebookCellsLayout(paddingTop);\n\t\t\tlayout.restoreWhitespace(existingMap.getWhitespaces());\n\t\t\treturn layout;\n\t\t} else {\n\t\t\treturn new NotebookCellsLayout(paddingTop);\n\t\t}\n\n\t}\n\n\tinsertWhitespace(afterPosition: number, size: number): string {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst id = `${++this._lastWhitespaceId}`;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\t\tconst elementPosition = this.elementTop(afterPosition);\n\t\tconst aboveScrollTop = scrollTop > elementPosition;\n\t\tthis.notebookRangeMap.insertWhitespace(id, afterPosition, size);\n\n\t\tconst newScrolltop = aboveScrollTop ? scrollTop + size : scrollTop;\n\t\tthis.render(previousRenderRange, newScrolltop, this.lastRenderHeight, undefined, undefined, false);\n\t\tthis._rerender(newScrolltop, this.renderHeight, false);\n\t\tthis.eventuallyUpdateScrollDimensions();\n\n\t\treturn id;\n\t}\n\n\tchangeOneWhitespace(id: string, newAfterPosition: number, newSize: number) {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\t\tconst currentPosition = this.notebookRangeMap.getWhitespacePosition(id);\n\n\t\tif (currentPosition > scrollTop) {\n\t\t\tthis.notebookRangeMap.changeOneWhitespace(id, newAfterPosition, newSize);\n\t\t\tthis.render(previousRenderRange, scrollTop, this.lastRenderHeight, undefined, undefined, false);\n\t\t\tthis._rerender(scrollTop, this.renderHeight, false);\n\t\t\tthis.eventuallyUpdateScrollDimensions();\n\t\t} else {\n\t\t\tthis.notebookRangeMap.changeOneWhitespace(id, newAfterPosition, newSize);\n\t\t\tthis.eventuallyUpdateScrollDimensions();\n\t\t}\n\t}\n\n\tremoveWhitespace(id: string): void {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\n\t\tthis.notebookRangeMap.removeWhitespace(id);\n\t\tthis.render(previousRenderRange, scrollTop, this.lastRenderHeight, undefined, undefined, false);\n\t\tthis._rerender(scrollTop, this.renderHeight, false);\n\t\tthis.eventuallyUpdateScrollDimensions();\n\t}\n\n\tgetWhitespacePosition(id: string): number {\n\t\treturn this.notebookRangeMap.getWhitespacePosition(id);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IRange } from '../../../../../base/common/range.js';\nimport { ListView } from '../../../../../base/browser/ui/list/listView.js';\nimport { IItem, IRangeMap } from '../../../../../base/browser/ui/list/rangeMap.js';\nimport { ConstantTimePrefixSumComputer } from '../../../../../editor/common/model/prefixSumComputer.js';\n\nexport interface IWhitespace {\n\tid: string;\n\t/**\n\t * To insert whitespace before the first item, use afterPosition 0.\n\t * In other cases, afterPosition is 1-based.\n\t */\n\tafterPosition: number;\n\tsize: number;\n\tpriority: number;\n}\nexport class NotebookCellsLayout implements IRangeMap {\n\tprivate _items: IItem[] = [];\n\tprivate _whitespace: IWhitespace[] = [];\n\tprotected _prefixSumComputer: ConstantTimePrefixSumComputer = new ConstantTimePrefixSumComputer([]);\n\tprivate _size = 0;\n\tprivate _paddingTop = 0;\n\n\tget paddingTop() {\n\t\treturn this._paddingTop;\n\t}\n\n\tset paddingTop(paddingTop: number) {\n\t\tthis._size = this._size + paddingTop - this._paddingTop;\n\t\tthis._paddingTop = paddingTop;\n\t}\n\n\tget count(): number {\n\t\treturn this._items.length;\n\t}\n\n\t/**\n\t * Returns the sum of the sizes of all items in the range map.\n\t */\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tconstructor(topPadding?: number) {\n\t\tthis._paddingTop = topPadding ?? 0;\n\t\tthis._size = this._paddingTop;\n\t}\n\n\tgetWhitespaces(): IWhitespace[] {\n\t\treturn this._whitespace;\n\t}\n\n\trestoreWhitespace(items: IWhitespace[]) {\n\t\tthis._whitespace = items;\n\t\tthis._size = this._paddingTop + this._items.reduce((total, item) => total + item.size, 0) + this._whitespace.reduce((total, ws) => total + ws.size, 0);\n\t}\n\n\t/**\n\t */\n\tsplice(index: number, deleteCount: number, items?: IItem[] | undefined): void {\n\t\tconst inserts = items ?? [];\n\t\t// Perform the splice operation on the items array.\n\t\tthis._items.splice(index, deleteCount, ...inserts);\n\n\t\tthis._size = this._paddingTop + this._items.reduce((total, item) => total + item.size, 0) + this._whitespace.reduce((total, ws) => total + ws.size, 0);\n\t\tthis._prefixSumComputer.removeValues(index, deleteCount);\n\n\t\t// inserts should also include whitespaces\n\t\tconst newSizes = [];\n\t\tfor (let i = 0; i < inserts.length; i++) {\n\t\t\tconst insertIndex = i + index;\n\t\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === insertIndex + 1);\n\n\n\t\t\tif (existingWhitespaces.length > 0) {\n\t\t\t\tnewSizes.push(inserts[i].size + existingWhitespaces.reduce((acc, ws) => acc + ws.size, 0));\n\t\t\t} else {\n\t\t\t\tnewSizes.push(inserts[i].size);\n\t\t\t}\n\t\t}\n\t\tthis._prefixSumComputer.insertValues(index, newSizes);\n\n\t\t// Now that the items array has been updated, and the whitespaces are updated elsewhere, if an item is removed/inserted, the accumlated size of the items are all updated.\n\t\t// Loop through all items from the index where the splice started, to the end\n\t\tfor (let i = index; i < this._items.length; i++) {\n\t\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === i + 1);\n\t\t\tif (existingWhitespaces.length > 0) {\n\t\t\t\tthis._prefixSumComputer.setValue(i, this._items[i].size + existingWhitespaces.reduce((acc, ws) => acc + ws.size, 0));\n\t\t\t} else {\n\t\t\t\tthis._prefixSumComputer.setValue(i, this._items[i].size);\n\t\t\t}\n\t\t}\n\t}\n\n\tinsertWhitespace(id: string, afterPosition: number, size: number): void {\n\t\tlet priority = 0;\n\t\tconst existingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === afterPosition);\n\t\tif (existingWhitespaces.length > 0) {\n\t\t\tpriority = Math.max(...existingWhitespaces.map(ws => ws.priority)) + 1;\n\t\t}\n\n\t\tthis._whitespace.push({ id, afterPosition: afterPosition, size, priority });\n\t\tthis._size += size; // Update the total size to include the whitespace\n\t\tthis._whitespace.sort((a, b) => {\n\t\t\tif (a.afterPosition === b.afterPosition) {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t}\n\t\t\treturn a.afterPosition - b.afterPosition;\n\t\t});\n\n\t\t// find item size of index\n\t\tif (afterPosition > 0) {\n\t\t\tconst index = afterPosition - 1;\n\t\t\tconst itemSize = this._items[index].size;\n\t\t\tconst accSize = itemSize + size;\n\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t}\n\t}\n\n\tchangeOneWhitespace(id: string, afterPosition: number, size: number): void {\n\t\tconst whitespaceIndex = this._whitespace.findIndex(ws => ws.id === id);\n\t\tif (whitespaceIndex !== -1) {\n\t\t\tconst whitespace = this._whitespace[whitespaceIndex];\n\t\t\tconst oldAfterPosition = whitespace.afterPosition;\n\t\t\twhitespace.afterPosition = afterPosition;\n\t\t\tconst oldSize = whitespace.size;\n\t\t\tconst delta = size - oldSize;\n\t\t\twhitespace.size = size;\n\t\t\tthis._size += delta;\n\n\t\t\tif (oldAfterPosition > 0 && oldAfterPosition <= this._items.length) {\n\t\t\t\tconst index = oldAfterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst accSize = itemSize;\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\n\t\t\tif (afterPosition > 0 && afterPosition <= this._items.length) {\n\t\t\t\tconst index = afterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst accSize = itemSize + size;\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveWhitespace(id: string): void {\n\t\tconst whitespaceIndex = this._whitespace.findIndex(ws => ws.id === id);\n\t\tif (whitespaceIndex !== -1) {\n\t\t\tconst whitespace = this._whitespace[whitespaceIndex];\n\t\t\tthis._whitespace.splice(whitespaceIndex, 1);\n\t\t\tthis._size -= whitespace.size; // Reduce the total size by the size of the removed whitespace\n\n\t\t\tif (whitespace.afterPosition > 0) {\n\t\t\t\tconst index = whitespace.afterPosition - 1;\n\t\t\t\tconst itemSize = this._items[index].size;\n\t\t\t\tconst remainingWhitespaces = this._whitespace.filter(ws => ws.afterPosition === whitespace.afterPosition);\n\t\t\t\tconst accSize = itemSize + remainingWhitespaces.reduce((acc, ws) => acc + ws.size, 0);\n\t\t\t\tthis._prefixSumComputer.setValue(index, accSize);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * find position of whitespace\n\t * @param id: id of the whitespace\n\t * @returns: position in the list view\n\t */\n\tgetWhitespacePosition(id: string): number {\n\t\tconst whitespace = this._whitespace.find(ws => ws.id === id);\n\t\tif (!whitespace) {\n\t\t\tthrow new Error('Whitespace not found');\n\t\t}\n\n\t\tconst afterPosition = whitespace.afterPosition;\n\t\tif (afterPosition === 0) {\n\t\t\t// find all whitespaces at the same position but with higher priority (smaller number)\n\t\t\tconst whitespaces = this._whitespace.filter(ws => ws.afterPosition === afterPosition && ws.priority < whitespace.priority);\n\t\t\treturn whitespaces.reduce((acc, ws) => acc + ws.size, 0) + this.paddingTop;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\n\t\t// previous item index\n\t\tconst index = afterPosition - 1;\n\t\tconst previousItemPosition = this._prefixSumComputer.getPrefixSum(index);\n\t\tconst previousItemSize = this._items[index].size;\n\t\treturn previousItemPosition + previousItemSize + whitespaceBeforeFirstItem + this.paddingTop;\n\t}\n\n\tindexAt(position: number): number {\n\t\tif (position < 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\n\t\tconst offset = position - (this._paddingTop + whitespaceBeforeFirstItem);\n\t\tif (offset <= 0) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (offset >= (this._size - this._paddingTop - whitespaceBeforeFirstItem)) {\n\t\t\treturn this.count;\n\t\t}\n\n\t\treturn this._prefixSumComputer.getIndexOf(Math.trunc(offset)).index;\n\t}\n\n\tindexAfter(position: number): number {\n\t\tconst index = this.indexAt(position);\n\t\treturn Math.min(index + 1, this._items.length);\n\t}\n\n\tpositionAt(index: number): number {\n\t\tif (index < 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (this.count === 0) {\n\t\t\treturn -1;\n\t\t}\n\n\t\t// index is zero based, if index+1 > this.count, then it points to the fictitious element after the last element of this array.\n\t\tif (index >= this.count) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst whitespaceBeforeFirstItem = this._whitespace.filter(ws => ws.afterPosition === 0).reduce((acc, ws) => acc + ws.size, 0);\n\t\treturn this._prefixSumComputer.getPrefixSum(index/** count */) + this._paddingTop + whitespaceBeforeFirstItem;\n\t}\n}\n\nexport class NotebookCellListView<T> extends ListView<T> {\n\tprivate _lastWhitespaceId: number = 0;\n\tprivate _renderingStack = 0;\n\n\tget inRenderingTransaction(): boolean {\n\t\treturn this._renderingStack > 0;\n\t}\n\n\tget notebookRangeMap(): NotebookCellsLayout {\n\t\treturn this.rangeMap as NotebookCellsLayout;\n\t}\n\n\tprotected override render(previousRenderRange: IRange, renderTop: number, renderHeight: number, renderLeft: number | undefined, scrollWidth: number | undefined, updateItemsInDOM?: boolean): void {\n\t\tthis._renderingStack++;\n\t\tsuper.render(previousRenderRange, renderTop, renderHeight, renderLeft, scrollWidth, updateItemsInDOM);\n\t\tthis._renderingStack--;\n\t}\n\n\tprotected override _rerender(renderTop: number, renderHeight: number, inSmoothScrolling?: boolean | undefined): void {\n\t\tthis._renderingStack++;\n\t\tsuper._rerender(renderTop, renderHeight, inSmoothScrolling);\n\t\tthis._renderingStack--;\n\t}\n\n\tprotected override createRangeMap(paddingTop: number): IRangeMap {\n\t\tconst existingMap = this.rangeMap as NotebookCellsLayout | undefined;\n\t\tif (existingMap) {\n\t\t\tconst layout = new NotebookCellsLayout(paddingTop);\n\t\t\tlayout.restoreWhitespace(existingMap.getWhitespaces());\n\t\t\treturn layout;\n\t\t} else {\n\t\t\treturn new NotebookCellsLayout(paddingTop);\n\t\t}\n\n\t}\n\n\tinsertWhitespace(afterPosition: number, size: number): string {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst id = `${++this._lastWhitespaceId}`;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\t\tconst elementPosition = this.elementTop(afterPosition);\n\t\tconst aboveScrollTop = scrollTop > elementPosition;\n\t\tthis.notebookRangeMap.insertWhitespace(id, afterPosition, size);\n\n\t\tconst newScrolltop = aboveScrollTop ? scrollTop + size : scrollTop;\n\t\tthis.render(previousRenderRange, newScrolltop, this.lastRenderHeight, undefined, undefined, false);\n\t\tthis._rerender(newScrolltop, this.renderHeight, false);\n\t\tthis.eventuallyUpdateScrollDimensions();\n\n\t\treturn id;\n\t}\n\n\tchangeOneWhitespace(id: string, newAfterPosition: number, newSize: number) {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\t\tconst currentPosition = this.notebookRangeMap.getWhitespacePosition(id);\n\n\t\tif (currentPosition > scrollTop) {\n\t\t\tthis.notebookRangeMap.changeOneWhitespace(id, newAfterPosition, newSize);\n\t\t\tthis.render(previousRenderRange, scrollTop, this.lastRenderHeight, undefined, undefined, false);\n\t\t\tthis._rerender(scrollTop, this.renderHeight, false);\n\t\t\tthis.eventuallyUpdateScrollDimensions();\n\t\t} else {\n\t\t\tthis.notebookRangeMap.changeOneWhitespace(id, newAfterPosition, newSize);\n\t\t\tthis.eventuallyUpdateScrollDimensions();\n\t\t}\n\t}\n\n\tremoveWhitespace(id: string): void {\n\t\tconst scrollTop = this.scrollTop;\n\t\tconst previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n\n\t\tthis.notebookRangeMap.removeWhitespace(id);\n\t\tthis.render(previousRenderRange, scrollTop, this.lastRenderHeight, undefined, undefined, false);\n\t\tthis._rerender(scrollTop, this.renderHeight, false);\n\t\tthis.eventuallyUpdateScrollDimensions();\n\t}\n\n\tgetWhitespacePosition(id: string): number {\n\t\treturn this.notebookRangeMap.getWhitespacePosition(id);\n\t}\n}\n"]}