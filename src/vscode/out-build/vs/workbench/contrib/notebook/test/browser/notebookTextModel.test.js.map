{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/test/browser/notebookTextModel.test.ts","vs/workbench/contrib/notebook/test/browser/notebookTextModel.test.ts"],"names":[],"mappings":"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","file":"notebookTextModel.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../../editor/common/core/position.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { CellEditType, CellKind, ICellEditOperation, MOVE_CURSOR_1_LINE_COMMAND, NotebookTextModelChangedEvent, NotebookTextModelWillAddRemoveEvent, SelectionStateType } from '../../common/notebookCommon.js';\nimport { setupInstantiationService, TestCell, valueBytesFromString, withTestNotebook } from './testNotebookEditor.js';\n\nsuite('NotebookTextModel', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuiteSetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = setupInstantiationService(disposables);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t\tinstantiationService.spy(IUndoRedoService, 'pushElement');\n\t});\n\n\tsuiteTeardown(() => disposables.dispose());\n\n\ttest('insert', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 6, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 6);\n\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[4].getValue(), 'var f = 6;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple inserts at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 6, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 6);\n\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var f = 6;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 1, cells: [] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete + insert', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var e = 5;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete + insert at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('(replace) delete + insert at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('output', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// invalid index 1\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: Number.MAX_VALUE,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\toutputs: []\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\t// invalid index 2\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: -1,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\toutputs: []\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello_') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1);\n\n\t\t\t\t// append\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\tappend: true,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId2',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello2_') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 2);\n\t\t\t\tlet [first, second] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'someId');\n\t\t\t\tassert.strictEqual(second.outputId, 'someId2');\n\n\t\t\t\t// replace all\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId3',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('Last, replaced output') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1);\n\t\t\t\t[first] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'someId3');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple append output in one position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// append\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append2',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 2') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 2);\n\t\t\t\tconst [first, second] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'append1');\n\t\t\t\tassert.strictEqual(second.outputId, 'append2');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('append to output created in same batch', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: Mimes.markdown, data: valueBytesFromString('append 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1, 'has 1 output');\n\t\t\t\tconst [first] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'append1');\n\t\t\t\tassert.strictEqual(first.outputs.length, 2, 'has 2 items');\n\t\t\t}\n\t\t);\n\t});\n\n\tconst stdOutMime = 'application/vnd.code.notebook.stdout';\n\tconst stdErrMime = 'application/vnd.code.notebook.stderr';\n\n\ttest('appending streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: stdOutMime, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 2') },\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 3') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 4') },\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 5') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 2, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1, 'has 1 output');\n\t\t\t\tassert.strictEqual(output.outputId, 'append1');\n\t\t\t\tassert.strictEqual(output.outputs.length, 1, 'outputs are compressed');\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1append 2append 3append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime)?.toString(), 'append 2append 3append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(1, stdOutMime)?.toString(), 'append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdOutMime), undefined);\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdErrMime), undefined);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('replacing streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: stdOutMime, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('append 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: false,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('replace 3')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 2, 'version should bump per replace');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('append 4')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 3, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'replace 3append 4');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'replacing output should clear out previous versioned output buffers');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(1, stdOutMime), undefined,\n\t\t\t\t\t'replacing output should clear out previous versioned output buffers');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdOutMime)?.toString(), 'append 4');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending streaming outputs with move cursor compression', async function () {\n\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 1') },\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('\\nappend 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString(MOVE_CURSOR_1_LINE_COMMAND + '\\nappend 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1\\nappend 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'compressing outputs should clear out previous versioned output buffers');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending streaming outputs with carraige return compression', async function () {\n\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 1') },\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('\\nappend 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('\\rappend 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1\\nappend 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'compressing outputs should clear out previous versioned output buffers');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending multiple different mime streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('stdout 1') },\n\t\t\t\t\t\t\t\t{ mime: stdErrMime, data: valueBytesFromString('stderr 1') }\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('stdout 2') },\n\t\t\t\t\t\t\t{ mime: stdErrMime, data: valueBytesFromString('stderr 2') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per replace');\n\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdErrMime)?.toString(), 'stderr 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime)?.toString(), 'stdout 2');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('metadata', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// invalid index 1\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: Number.MAX_VALUE,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {}\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\t// invalid index 2\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: -1,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {}\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: { customProperty: 15 },\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {},\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].metadata.customProperty, undefined);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('partial metadata', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.PartialMetadata,\n\t\t\t\t\tmetadata: { customProperty: 15 },\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.PartialMetadata,\n\t\t\t\t\tmetadata: {},\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].metadata.customProperty, 15);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple inserts in one edit', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\tlet changeEvent: NotebookTextModelChangedEvent | undefined = undefined;\n\t\t\t\tconst eventListener = textModel.onDidChangeContent(e => {\n\t\t\t\t\tchangeEvent = e;\n\t\t\t\t});\n\t\t\t\tconst willChangeEvents: NotebookTextModelWillAddRemoveEvent[] = [];\n\t\t\t\tconst willChangeListener = textModel.onWillAddRemoveCells(e => {\n\t\t\t\t\twillChangeEvents.push(e);\n\t\t\t\t});\n\t\t\t\tconst version = textModel.versionId;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => ({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] }), undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\n\t\t\t\tassert.notStrictEqual(changeEvent, undefined);\n\t\t\t\tassert.strictEqual(changeEvent!.rawEvents.length, 2);\n\t\t\t\tassert.deepStrictEqual(changeEvent!.endSelectionState?.selections, [{ start: 0, end: 1 }]);\n\t\t\t\tassert.strictEqual(willChangeEvents.length, 2);\n\t\t\t\tassert.strictEqual(textModel.versionId, version + 1);\n\t\t\t\teventListener.dispose();\n\t\t\t\twillChangeListener.dispose();\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('insert and metadata change in one edit', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\tlet changeEvent: NotebookTextModelChangedEvent | undefined = undefined;\n\t\t\t\tconst eventListener = textModel.onDidChangeContent(e => {\n\t\t\t\t\tchangeEvent = e;\n\t\t\t\t});\n\t\t\t\tconst willChangeEvents: NotebookTextModelWillAddRemoveEvent[] = [];\n\t\t\t\tconst willChangeListener = textModel.onWillAddRemoveCells(e => {\n\t\t\t\t\twillChangeEvents.push(e);\n\t\t\t\t});\n\n\t\t\t\tconst version = textModel.versionId;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {},\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => ({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] }), undefined, true);\n\n\t\t\t\tassert.notStrictEqual(changeEvent, undefined);\n\t\t\t\tassert.strictEqual(changeEvent!.rawEvents.length, 2);\n\t\t\t\tassert.deepStrictEqual(changeEvent!.endSelectionState?.selections, [{ start: 0, end: 1 }]);\n\t\t\t\tassert.strictEqual(willChangeEvents.length, 1);\n\t\t\t\tassert.strictEqual(textModel.versionId, version + 1);\n\t\t\t\teventListener.dispose();\n\t\t\t\twillChangeListener.dispose();\n\t\t\t}\n\t\t);\n\t});\n\n\n\ttest('Updating appending/updating output in Notebooks does not work as expected #117273', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tassert.strictEqual(model.cells.length, 1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 0);\n\n\t\t\tconst success1 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\n\t\t\tconst success2 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out2', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: true\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 2);\n\t\t});\n\t});\n\n\ttest('Clearing output of an empty notebook makes it dirty #119608', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor, _, ds) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tlet event: NotebookTextModelChangedEvent | undefined;\n\n\t\t\tds.add(model.onDidChangeContent(e => { event = e; }));\n\n\t\t\t{\n\t\t\t\t// 1: add ouput -> event\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t\t],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\t\tassert.ok(event);\n\t\t\t}\n\n\t\t\t{\n\t\t\t\t// 2: clear all output w/ output -> event\n\t\t\t\tevent = undefined;\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.ok(event);\n\t\t\t}\n\n\t\t\t{\n\t\t\t\t// 2: clear all output wo/ output -> NO event\n\t\t\t\tevent = undefined;\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.ok(event === undefined);\n\t\t\t}\n\t\t});\n\t});\n\n\ttest('Cell metadata/output change should update version id and alternative id #121807', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel) => {\n\t\t\tassert.strictEqual(editor.textModel.versionId, 0);\n\t\t\tconst firstAltVersion = '0_0,1;1,1';\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {\n\t\t\t\t\t\tinputCollapsed: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\tassert.strictEqual(editor.textModel.versionId, 1);\n\t\t\tassert.notStrictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\tconst secondAltVersion = '1_0,1;1,1';\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t\tawait viewModel.undo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 2);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\n\t\t\tawait viewModel.redo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 3);\n\t\t\tassert.notStrictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\tindex: 1,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {\n\t\t\t\t\t\tinputCollapsed: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\tassert.strictEqual(editor.textModel.versionId, 4);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, '4_0,1;1,1');\n\n\t\t\tawait viewModel.undo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 5);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t});\n\t});\n\n\ttest('metadata changes on newly added cells should combine their undo operations', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel, ds) => {\n\t\t\tconst textModel = editor.textModel;\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 1, 'var e = 5;', 'javascript', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 2, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { id: '123' } },\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells[1].metadata.id, '123');\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\n\t\t\tawait viewModel.redo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\t\t});\n\t});\n\n\ttest('changes with non-metadata edit should not combine their undo operations', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel, ds) => {\n\t\t\tconst textModel = editor.textModel;\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 1, 'var e = 5;', 'javascript', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 2, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { id: '123' } },\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells[1].metadata.id, '123');\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.deepStrictEqual(notebook.cells[0].outputs[0].outputs[0].data, valueBytesFromString('test'));\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, outputs: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs[0].outputs.length, 2);\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994. cell splice between output changes', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [{ outputId: 'i43', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [{ outputId: 'i44', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 1, cells: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 2, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 0);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[0].outputId, 'i44');\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[1].outputId, 'newOutput');\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994. cell splice between output changes 2', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [{ outputId: 'i43', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [{ outputId: 'i44', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 1, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 1, cells: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 1, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput2',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[0].outputId, 'i44');\n\t\t});\n\t});\n\n\ttest('Output edits splice', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tassert.strictEqual(model.cells.length, 1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 0);\n\n\t\t\tconst success1 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('1') }] },\n\t\t\t\t\t\t{ outputId: 'out2', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('2') }] },\n\t\t\t\t\t\t{ outputId: 'out3', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('3') }] },\n\t\t\t\t\t\t{ outputId: 'out4', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('4') }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 4);\n\n\t\t\tconst success2 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('1') }] },\n\t\t\t\t\t\t{ outputId: 'out5', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('5') }] },\n\t\t\t\t\t\t{ outputId: 'out3', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('3') }] },\n\t\t\t\t\t\t{ outputId: 'out6', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('6') }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 4);\n\t\t\tassert.strictEqual(model.cells[0].outputs[0].outputId, 'out1');\n\t\t\tassert.strictEqual(model.cells[0].outputs[1].outputId, 'out5');\n\t\t\tassert.strictEqual(model.cells[0].outputs[2].outputId, 'out3');\n\t\t\tassert.strictEqual(model.cells[0].outputs[3].outputId, 'out6');\n\t\t});\n\t});\n\n\ttest('computeEdits no insert', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits last cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) },\n\t\t\t]);\n\t\t});\n\t});\n\ttest('computeEdits first cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits middle cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var c = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1, 2) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 2, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell metadata changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'foo' } },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: { name: 'foo' } },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell language changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'typescript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell kind changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Markup, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell metadata & content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'foo' } },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: { name: 'foo' } },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell content changed while executing', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells, [model.cells[1].handle]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell internal metadata changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, internalMetadata: { executionOrder: 1 } },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell internal metadata changed while executing', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {}, internalMetadata: { executionOrder: 1 } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells, [model.cells[1].handle]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell insertion', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, },\n\t\t\t\t{ source: 'var c = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: cells.slice(1, 2) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 3);\n\t\t\tassert.equal(model.cells[1].getValue(), 'var c = 1;');\n\t\t\tassert.equal(model.cells[2].getValue(), 'var b = 1;');\n\t\t\tassert.deepStrictEqual(model.cells[2].metadata, { foo: 'bar' });\n\t\t});\n\t});\n\n\ttest('computeEdits output changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{\n\t\t\t\t\tsource: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], metadata: undefined,\n\t\t\t\t},\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], append: false\n\t\t\t\t},\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputId, 'someId');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), '_World_');\n\t\t});\n\t});\n\n\ttest('computeEdits output items changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: 'someId',\n\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello_') }]\n\t\t\t}], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{\n\t\t\t\t\tsource: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], metadata: undefined,\n\t\t\t\t},\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.OutputItems, outputId: 'someId', items: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }], append: false },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputId, 'someId');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), '_World_');\n\t\t});\n\t});\n\ttest('Append multiple text/plain output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'text/plain', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'text/plain', data: VSBuffer.fromString('bar') }, { mime: 'text/plain', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 3);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foo');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].data.toString(), 'bar');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].data.toString(), 'baz');\n\t\t});\n\t});\n\ttest('Append multiple stdout stream output items to an output with another mime', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'text/plain', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 3);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foo');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].data.toString(), 'bar');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].data.toString(), 'baz');\n\t\t});\n\t});\n\ttest('Compress multiple stdout stream output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'application/vnd.code.notebook.stdout', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foobarbaz');\n\t\t});\n\n\t});\n\ttest('Compress multiple stderr stream output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'application/vnd.code.notebook.stderr', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stderr', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stderr', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'application/vnd.code.notebook.stderr');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foobarbaz');\n\t\t});\n\n\t});\n\n\ttest('findNextMatch', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tconst notebookModel = viewModel.notebookDocument;\n\n\t\t\t\t// Test case 1: Find 'var' starting from the first cell\n\t\t\t\tlet findMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\t// Test case 2: Find 'b' starting from the second cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('b', { cellIndex: 1, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 3: Find 'c' starting from the third cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('c', { cellIndex: 2, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 4: Find 'd' starting from the fourth cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('d', { cellIndex: 3, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 5: No match found\n\t\t\t\tfindMatch = notebookModel.findNextMatch('e', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.strictEqual(findMatch, null);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('findNextMatch 2', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1; var a = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tconst notebookModel = viewModel.notebookDocument;\n\n\t\t\t\t// Test case 1: Find 'var' starting from the first cell\n\t\t\t\tlet findMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\t// Test case 2: Find 'b' starting from the second cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('b', { cellIndex: 1, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 3: Find 'c' starting from the third cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('c', { cellIndex: 2, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 4: Find 'd' starting from the fourth cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('d', { cellIndex: 3, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 5: No match found\n\t\t\t\tfindMatch = notebookModel.findNextMatch('e', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.strictEqual(findMatch, null);\n\n\t\t\t\t// Test case 6: Same keywords in the same cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 5) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 12);\n\n\t\t\t\t// Test case 7: Search from the middle of a cell with keyword before and after\n\t\t\t\tfindMatch = notebookModel.findNextMatch('a', { cellIndex: 0, position: new Position(1, 10) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 13);\n\n\t\t\t\t// Test case 8: Search from a cell and next match is in another cell below\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 20) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\t\t\t\t// assert.strictEqual(match!.cellIndex, 1);\n\t\t\t}\n\t\t);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { Position } from '../../../../../editor/common/core/position.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { CellEditType, CellKind, ICellEditOperation, MOVE_CURSOR_1_LINE_COMMAND, NotebookTextModelChangedEvent, NotebookTextModelWillAddRemoveEvent, SelectionStateType } from '../../common/notebookCommon.js';\nimport { setupInstantiationService, TestCell, valueBytesFromString, withTestNotebook } from './testNotebookEditor.js';\n\nsuite('NotebookTextModel', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsuiteSetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = setupInstantiationService(disposables);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t\tinstantiationService.spy(IUndoRedoService, 'pushElement');\n\t});\n\n\tsuiteTeardown(() => disposables.dispose());\n\n\ttest('insert', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 6, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 6);\n\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[4].getValue(), 'var f = 6;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple inserts at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 6, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 6);\n\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var f = 6;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 1, cells: [] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete + insert', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 3, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var e = 5;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('delete + insert at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('(replace) delete + insert at same position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('output', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// invalid index 1\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: Number.MAX_VALUE,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\toutputs: []\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\t// invalid index 2\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: -1,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\toutputs: []\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello_') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1);\n\n\t\t\t\t// append\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\tappend: true,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId2',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello2_') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 2);\n\t\t\t\tlet [first, second] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'someId');\n\t\t\t\tassert.strictEqual(second.outputId, 'someId2');\n\n\t\t\t\t// replace all\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\toutputs: [{\n\t\t\t\t\t\toutputId: 'someId3',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('Last, replaced output') }]\n\t\t\t\t\t}]\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1);\n\t\t\t\t[first] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'someId3');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple append output in one position', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// append\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append2',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 2') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 2);\n\t\t\t\tconst [first, second] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'append1');\n\t\t\t\tassert.strictEqual(second.outputId, 'append2');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('append to output created in same batch', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: Mimes.markdown, data: valueBytesFromString('append 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1, 'has 1 output');\n\t\t\t\tconst [first] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(first.outputId, 'append1');\n\t\t\t\tassert.strictEqual(first.outputs.length, 2, 'has 2 items');\n\t\t\t}\n\t\t);\n\t});\n\n\tconst stdOutMime = 'application/vnd.code.notebook.stdout';\n\tconst stdErrMime = 'application/vnd.code.notebook.stderr';\n\n\ttest('appending streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: stdOutMime, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 2') },\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 3') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 4') },\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 5') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 2, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].outputs.length, 1, 'has 1 output');\n\t\t\t\tassert.strictEqual(output.outputId, 'append1');\n\t\t\t\tassert.strictEqual(output.outputs.length, 1, 'outputs are compressed');\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1append 2append 3append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime)?.toString(), 'append 2append 3append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(1, stdOutMime)?.toString(), 'append 4append 5');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdOutMime), undefined);\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdErrMime), undefined);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('replacing streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [{ mime: stdOutMime, data: valueBytesFromString('append 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('append 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: false,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('replace 3')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 2, 'version should bump per replace');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('append 4')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 3, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'replace 3append 4');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'replacing output should clear out previous versioned output buffers');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(1, stdOutMime), undefined,\n\t\t\t\t\t'replacing output should clear out previous versioned output buffers');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(2, stdOutMime)?.toString(), 'append 4');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending streaming outputs with move cursor compression', async function () {\n\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 1') },\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('\\nappend 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString(MOVE_CURSOR_1_LINE_COMMAND + '\\nappend 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1\\nappend 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'compressing outputs should clear out previous versioned output buffers');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending streaming outputs with carraige return compression', async function () {\n\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('append 1') },\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('\\nappend 1') }]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\tmime: stdOutMime, data: valueBytesFromString('\\rappend 2')\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per append');\n\n\t\t\t\tassert.strictEqual(output.outputs[0].data.toString(), 'append 1\\nappend 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime), undefined,\n\t\t\t\t\t'compressing outputs should clear out previous versioned output buffers');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('appending multiple different mime streaming outputs', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputs: [{\n\t\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\t\toutputs: [\n\t\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('stdout 1') },\n\t\t\t\t\t\t\t\t{ mime: stdErrMime, data: valueBytesFromString('stderr 1') }\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tconst [output] = textModel.cells[0].outputs;\n\t\t\t\tassert.strictEqual(output.versionId, 0, 'initial output version should be 0');\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\t\tappend: true,\n\t\t\t\t\t\toutputId: 'append1',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{ mime: stdOutMime, data: valueBytesFromString('stdout 2') },\n\t\t\t\t\t\t\t{ mime: stdErrMime, data: valueBytesFromString('stderr 2') }\n\t\t\t\t\t\t]\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.strictEqual(output.versionId, 1, 'version should bump per replace');\n\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdErrMime)?.toString(), 'stderr 2');\n\t\t\t\tassert.strictEqual(output.appendedSinceVersion(0, stdOutMime)?.toString(), 'stdout 2');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('metadata', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\t// invalid index 1\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: Number.MAX_VALUE,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {}\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\t// invalid index 2\n\t\t\t\tassert.throws(() => {\n\t\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\t\tindex: -1,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {}\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\t});\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: { customProperty: 15 },\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {},\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].metadata.customProperty, undefined);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('partial metadata', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.PartialMetadata,\n\t\t\t\t\tmetadata: { customProperty: 15 },\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\ttextModel.applyEdits([{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.PartialMetadata,\n\t\t\t\t\tmetadata: {},\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t\t\tassert.strictEqual(textModel.cells[0].metadata.customProperty, 15);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('multiple inserts in one edit', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, _viewModel, ds) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\tlet changeEvent: NotebookTextModelChangedEvent | undefined = undefined;\n\t\t\t\tconst eventListener = textModel.onDidChangeContent(e => {\n\t\t\t\t\tchangeEvent = e;\n\t\t\t\t});\n\t\t\t\tconst willChangeEvents: NotebookTextModelWillAddRemoveEvent[] = [];\n\t\t\t\tconst willChangeListener = textModel.onWillAddRemoveCells(e => {\n\t\t\t\t\twillChangeEvents.push(e);\n\t\t\t\t});\n\t\t\t\tconst version = textModel.versionId;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: [ds.add(new TestCell(textModel.viewType, 5, 'var e = 5;', 'javascript', CellKind.Code, [], languageService))] },\n\t\t\t\t], true, undefined, () => ({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] }), undefined, true);\n\n\t\t\t\tassert.strictEqual(textModel.cells.length, 4);\n\t\t\t\tassert.strictEqual(textModel.cells[0].getValue(), 'var a = 1;');\n\t\t\t\tassert.strictEqual(textModel.cells[1].getValue(), 'var e = 5;');\n\t\t\t\tassert.strictEqual(textModel.cells[2].getValue(), 'var c = 3;');\n\n\t\t\t\tassert.notStrictEqual(changeEvent, undefined);\n\t\t\t\tassert.strictEqual(changeEvent!.rawEvents.length, 2);\n\t\t\t\tassert.deepStrictEqual(changeEvent!.endSelectionState?.selections, [{ start: 0, end: 1 }]);\n\t\t\t\tassert.strictEqual(willChangeEvents.length, 2);\n\t\t\t\tassert.strictEqual(textModel.versionId, version + 1);\n\t\t\t\teventListener.dispose();\n\t\t\t\twillChangeListener.dispose();\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('insert and metadata change in one edit', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst textModel = editor.textModel;\n\t\t\t\tlet changeEvent: NotebookTextModelChangedEvent | undefined = undefined;\n\t\t\t\tconst eventListener = textModel.onDidChangeContent(e => {\n\t\t\t\t\tchangeEvent = e;\n\t\t\t\t});\n\t\t\t\tconst willChangeEvents: NotebookTextModelWillAddRemoveEvent[] = [];\n\t\t\t\tconst willChangeListener = textModel.onWillAddRemoveCells(e => {\n\t\t\t\t\twillChangeEvents.push(e);\n\t\t\t\t});\n\n\t\t\t\tconst version = textModel.versionId;\n\n\t\t\t\ttextModel.applyEdits([\n\t\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: [] },\n\t\t\t\t\t{\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\t\tmetadata: {},\n\t\t\t\t\t}\n\t\t\t\t], true, undefined, () => ({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] }), undefined, true);\n\n\t\t\t\tassert.notStrictEqual(changeEvent, undefined);\n\t\t\t\tassert.strictEqual(changeEvent!.rawEvents.length, 2);\n\t\t\t\tassert.deepStrictEqual(changeEvent!.endSelectionState?.selections, [{ start: 0, end: 1 }]);\n\t\t\t\tassert.strictEqual(willChangeEvents.length, 1);\n\t\t\t\tassert.strictEqual(textModel.versionId, version + 1);\n\t\t\t\teventListener.dispose();\n\t\t\t\twillChangeListener.dispose();\n\t\t\t}\n\t\t);\n\t});\n\n\n\ttest('Updating appending/updating output in Notebooks does not work as expected #117273', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tassert.strictEqual(model.cells.length, 1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 0);\n\n\t\t\tconst success1 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\n\t\t\tconst success2 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out2', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: true\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 2);\n\t\t});\n\t});\n\n\ttest('Clearing output of an empty notebook makes it dirty #119608', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor, _, ds) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tlet event: NotebookTextModelChangedEvent | undefined;\n\n\t\t\tds.add(model.onDidChangeContent(e => { event = e; }));\n\n\t\t\t{\n\t\t\t\t// 1: add ouput -> event\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: VSBuffer.wrap(new Uint8Array([1])) }] }\n\t\t\t\t\t\t],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\t\tassert.ok(event);\n\t\t\t}\n\n\t\t\t{\n\t\t\t\t// 2: clear all output w/ output -> event\n\t\t\t\tevent = undefined;\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.ok(event);\n\t\t\t}\n\n\t\t\t{\n\t\t\t\t// 2: clear all output wo/ output -> NO event\n\t\t\t\tevent = undefined;\n\t\t\t\tconst success = model.applyEdits(\n\t\t\t\t\t[{\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 0,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}, {\n\t\t\t\t\t\teditType: CellEditType.Output,\n\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\tappend: false\n\t\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t\t);\n\n\t\t\t\tassert.ok(success);\n\t\t\t\tassert.ok(event === undefined);\n\t\t\t}\n\t\t});\n\t});\n\n\ttest('Cell metadata/output change should update version id and alternative id #121807', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel) => {\n\t\t\tassert.strictEqual(editor.textModel.versionId, 0);\n\t\t\tconst firstAltVersion = '0_0,1;1,1';\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\tindex: 0,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {\n\t\t\t\t\t\tinputCollapsed: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\tassert.strictEqual(editor.textModel.versionId, 1);\n\t\t\tassert.notStrictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\tconst secondAltVersion = '1_0,1;1,1';\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t\tawait viewModel.undo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 2);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\n\t\t\tawait viewModel.redo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 3);\n\t\t\tassert.notStrictEqual(editor.textModel.alternativeVersionId, firstAltVersion);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\tindex: 1,\n\t\t\t\t\teditType: CellEditType.Metadata,\n\t\t\t\t\tmetadata: {\n\t\t\t\t\t\tinputCollapsed: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\t\t\tassert.strictEqual(editor.textModel.versionId, 4);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, '4_0,1;1,1');\n\n\t\t\tawait viewModel.undo();\n\t\t\tassert.strictEqual(editor.textModel.versionId, 5);\n\t\t\tassert.strictEqual(editor.textModel.alternativeVersionId, secondAltVersion);\n\n\t\t});\n\t});\n\n\ttest('metadata changes on newly added cells should combine their undo operations', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel, ds) => {\n\t\t\tconst textModel = editor.textModel;\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 1, 'var e = 5;', 'javascript', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 2, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { id: '123' } },\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells[1].metadata.id, '123');\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\n\t\t\tawait viewModel.redo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\t\t});\n\t});\n\n\ttest('changes with non-metadata edit should not combine their undo operations', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (editor, viewModel, ds) => {\n\t\t\tconst textModel = editor.textModel;\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 1, 'var e = 5;', 'javascript', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(textModel.viewType, 2, 'var f = 6;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\teditor.textModel.applyEdits([\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { id: '123' } },\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t], true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(textModel.cells[1].metadata.id, '123');\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 3);\n\n\t\t\tawait viewModel.undo();\n\n\t\t\tassert.strictEqual(textModel.cells.length, 1);\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.deepStrictEqual(notebook.cells[0].outputs[0].outputs[0].data, valueBytesFromString('test'));\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, outputs: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, handle: 0, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs[0].outputs.length, 2);\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994. cell splice between output changes', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [{ outputId: 'i43', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [{ outputId: 'i44', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 1, cells: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 2, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 0);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[0].outputId, 'i44');\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[1].outputId, 'newOutput');\n\t\t});\n\t});\n\n\ttest('Destructive sorting in _doApplyEdits #121994. cell splice between output changes 2', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{ outputId: 'i42', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [{ outputId: 'i43', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [{ outputId: 'i44', outputs: [{ mime: 'm/ime', data: valueBytesFromString('test') }] }], {}]\n\t\t], async (editor) => {\n\t\t\tconst notebook = editor.textModel;\n\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 1, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Replace, index: 1, count: 1, cells: []\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 1, append: true, outputs: [{\n\t\t\t\t\t\toutputId: 'newOutput2',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.text, data: valueBytesFromString('cba') }, { mime: 'application/foo', data: valueBytesFromString('cba') }]\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\teditor.textModel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\n\t\t\tassert.strictEqual(notebook.cells.length, 2);\n\t\t\tassert.strictEqual(notebook.cells[0].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs.length, 1);\n\t\t\tassert.strictEqual(notebook.cells[1].outputs[0].outputId, 'i44');\n\t\t});\n\t});\n\n\ttest('Output edits splice', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\n\t\t\tassert.strictEqual(model.cells.length, 1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 0);\n\n\t\t\tconst success1 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('1') }] },\n\t\t\t\t\t\t{ outputId: 'out2', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('2') }] },\n\t\t\t\t\t\t{ outputId: 'out3', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('3') }] },\n\t\t\t\t\t\t{ outputId: 'out4', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('4') }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success1);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 4);\n\n\t\t\tconst success2 = model.applyEdits(\n\t\t\t\t[{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [\n\t\t\t\t\t\t{ outputId: 'out1', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('1') }] },\n\t\t\t\t\t\t{ outputId: 'out5', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('5') }] },\n\t\t\t\t\t\t{ outputId: 'out3', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('3') }] },\n\t\t\t\t\t\t{ outputId: 'out6', outputs: [{ mime: 'application/x.notebook.stream', data: valueBytesFromString('6') }] }\n\t\t\t\t\t],\n\t\t\t\t\tappend: false\n\t\t\t\t}], true, undefined, () => undefined, undefined, false\n\t\t\t);\n\n\t\t\tassert.ok(success2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 4);\n\t\t\tassert.strictEqual(model.cells[0].outputs[0].outputId, 'out1');\n\t\t\tassert.strictEqual(model.cells[0].outputs[1].outputId, 'out5');\n\t\t\tassert.strictEqual(model.cells[0].outputs[2].outputId, 'out3');\n\t\t\tassert.strictEqual(model.cells[0].outputs[3].outputId, 'out6');\n\t\t});\n\t});\n\n\ttest('computeEdits no insert', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits last cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) },\n\t\t\t]);\n\t\t});\n\t});\n\ttest('computeEdits first cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits middle cell content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var c = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1, 2) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 2, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell metadata changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'foo' } },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: { name: 'foo' } },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell language changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'typescript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell kind changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Markup, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell metadata & content changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'foo' } },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { name: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: { name: 'foo' } },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell content changed while executing', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} },\n\t\t\t\t{ source: 'var b = 2;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells, [model.cells[1].handle]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 1, cells: cells.slice(1) }\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell internal metadata changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, internalMetadata: { executionOrder: 1 } },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Replace, index: 0, count: 1, cells: cells.slice(0, 1) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell internal metadata changed while executing', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {} },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: {}, internalMetadata: { executionOrder: 1 } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells, [model.cells[1].handle]);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: {} },\n\t\t\t]);\n\t\t});\n\t});\n\n\ttest('computeEdits cell insertion', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{ source: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, },\n\t\t\t\t{ source: 'var c = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: undefined, },\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.Replace, index: 1, count: 0, cells: cells.slice(1, 2) },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 3);\n\t\t\tassert.equal(model.cells[1].getValue(), 'var c = 1;');\n\t\t\tassert.equal(model.cells[2].getValue(), 'var b = 1;');\n\t\t\tassert.deepStrictEqual(model.cells[2].metadata, { foo: 'bar' });\n\t\t});\n\t});\n\n\ttest('computeEdits output changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{\n\t\t\t\t\tsource: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], metadata: undefined,\n\t\t\t\t},\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.Output, index: 0, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], append: false\n\t\t\t\t},\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputId, 'someId');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), '_World_');\n\t\t});\n\t});\n\n\ttest('computeEdits output items changed', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: 'someId',\n\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_Hello_') }]\n\t\t\t}], {}],\n\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst cells = [\n\t\t\t\t{\n\t\t\t\t\tsource: 'var a = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [{\n\t\t\t\t\t\toutputId: 'someId',\n\t\t\t\t\t\toutputs: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }]\n\t\t\t\t\t}], metadata: undefined,\n\t\t\t\t},\n\t\t\t\t{ source: 'var b = 1;', language: 'javascript', cellKind: CellKind.Code, mime: undefined, outputs: [], metadata: { foo: 'bar' } }\n\t\t\t];\n\t\t\tconst edits = NotebookTextModel.computeEdits(model, cells);\n\n\t\t\tassert.deepStrictEqual(edits, [\n\t\t\t\t{ editType: CellEditType.Metadata, index: 0, metadata: {} },\n\t\t\t\t{ editType: CellEditType.OutputItems, outputId: 'someId', items: [{ mime: Mimes.markdown, data: valueBytesFromString('_World_') }], append: false },\n\t\t\t\t{ editType: CellEditType.Metadata, index: 1, metadata: { foo: 'bar' } },\n\t\t\t]);\n\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 2);\n\t\t\tassert.strictEqual(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputId, 'someId');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), '_World_');\n\t\t});\n\t});\n\ttest('Append multiple text/plain output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'text/plain', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'text/plain', data: VSBuffer.fromString('bar') }, { mime: 'text/plain', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 3);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foo');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].data.toString(), 'bar');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].data.toString(), 'baz');\n\t\t});\n\t});\n\ttest('Append multiple stdout stream output items to an output with another mime', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'text/plain', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 3);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'text/plain');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foo');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[1].data.toString(), 'bar');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[2].data.toString(), 'baz');\n\t\t});\n\t});\n\ttest('Compress multiple stdout stream output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'application/vnd.code.notebook.stdout', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stdout', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'application/vnd.code.notebook.stdout');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foobarbaz');\n\t\t});\n\n\t});\n\ttest('Compress multiple stderr stream output items', async function () {\n\t\tawait withTestNotebook([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [{\n\t\t\t\toutputId: '1',\n\t\t\t\toutputs: [{ mime: 'application/vnd.code.notebook.stderr', data: valueBytesFromString('foo') }]\n\t\t\t}], {}]\n\t\t], (editor) => {\n\t\t\tconst model = editor.textModel;\n\t\t\tconst edits: ICellEditOperation[] = [\n\t\t\t\t{\n\t\t\t\t\teditType: CellEditType.OutputItems,\n\t\t\t\t\toutputId: '1',\n\t\t\t\t\tappend: true,\n\t\t\t\t\titems: [{ mime: 'application/vnd.code.notebook.stderr', data: VSBuffer.fromString('bar') }, { mime: 'application/vnd.code.notebook.stderr', data: VSBuffer.fromString('baz') }]\n\t\t\t\t}\n\t\t\t];\n\t\t\tmodel.applyEdits(edits, true, undefined, () => undefined, undefined, true);\n\t\t\tassert.equal(model.cells.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs.length, 1);\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].mime, 'application/vnd.code.notebook.stderr');\n\t\t\tassert.equal(model.cells[0].outputs[0].outputs[0].data.toString(), 'foobarbaz');\n\t\t});\n\n\t});\n\n\ttest('findNextMatch', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tconst notebookModel = viewModel.notebookDocument;\n\n\t\t\t\t// Test case 1: Find 'var' starting from the first cell\n\t\t\t\tlet findMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\t// Test case 2: Find 'b' starting from the second cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('b', { cellIndex: 1, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 3: Find 'c' starting from the third cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('c', { cellIndex: 2, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 4: Find 'd' starting from the fourth cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('d', { cellIndex: 3, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 5: No match found\n\t\t\t\tfindMatch = notebookModel.findNextMatch('e', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.strictEqual(findMatch, null);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('findNextMatch 2', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1; var a = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tconst notebookModel = viewModel.notebookDocument;\n\n\t\t\t\t// Test case 1: Find 'var' starting from the first cell\n\t\t\t\tlet findMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\t// Test case 2: Find 'b' starting from the second cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('b', { cellIndex: 1, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 3: Find 'c' starting from the third cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('c', { cellIndex: 2, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 4: Find 'd' starting from the fourth cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('d', { cellIndex: 3, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 5);\n\n\t\t\t\t// Test case 5: No match found\n\t\t\t\tfindMatch = notebookModel.findNextMatch('e', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.strictEqual(findMatch, null);\n\n\t\t\t\t// Test case 6: Same keywords in the same cell\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 1) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 5) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 12);\n\n\t\t\t\t// Test case 7: Search from the middle of a cell with keyword before and after\n\t\t\t\tfindMatch = notebookModel.findNextMatch('a', { cellIndex: 0, position: new Position(1, 10) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 13);\n\n\t\t\t\t// Test case 8: Search from a cell and next match is in another cell below\n\t\t\t\tfindMatch = notebookModel.findNextMatch('var', { cellIndex: 0, position: new Position(1, 20) }, false, false, null);\n\t\t\t\tassert.ok(findMatch);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startLineNumber, 1);\n\t\t\t\tassert.strictEqual(findMatch!.match.range.startColumn, 1);\n\t\t\t\t// assert.strictEqual(match!.cellIndex, 1);\n\t\t\t}\n\t\t);\n\t});\n});\n"]}