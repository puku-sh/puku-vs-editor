{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/test/browser/diff/notebookDiff.test.ts","vs/workbench/contrib/notebook/test/browser/diff/notebookDiff.test.ts"],"names":[],"mappings":"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","file":"notebookDiff.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../../../base/common/buffer.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../../base/common/cancellation.js';\nimport { IDiffResult, ISequence, LcsDiff } from '../../../../../../base/common/diff/diff.js';\nimport { DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../../../base/common/mime.js';\nimport { mock } from '../../../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { TestConfigurationService } from '../../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IDiffElementViewModelBase, SideBySideDiffElementViewModel } from '../../../browser/diff/diffElementViewModel.js';\nimport { NotebookDiffEditorEventDispatcher } from '../../../browser/diff/eventDispatcher.js';\nimport { INotebookDiffViewModel, INotebookDiffViewModelUpdateEvent } from '../../../browser/diff/notebookDiffEditorBrowser.js';\nimport { NotebookDiffViewModel, prettyChanges } from '../../../browser/diff/notebookDiffViewModel.js';\nimport { CellKind, INotebookTextModel } from '../../../common/notebookCommon.js';\nimport { INotebookService } from '../../../common/notebookService.js';\nimport { INotebookEditorWorkerService } from '../../../common/services/notebookWorkerService.js';\nimport { withTestNotebookDiffModel } from '../testNotebookEditor.js';\nimport { IDiffEditorHeightCalculatorService } from '../../../browser/diff/editorHeightCalculator.js';\n\nclass CellSequence implements ISequence {\n\n\tconstructor(readonly textModel: INotebookTextModel) {\n\t}\n\n\tgetElements(): string[] | number[] | Int32Array {\n\t\tconst hashValue = new Int32Array(this.textModel.cells.length);\n\t\tfor (let i = 0; i < this.textModel.cells.length; i++) {\n\t\t\thashValue[i] = this.textModel.cells[i].getHashValue();\n\t\t}\n\n\t\treturn hashValue;\n\t}\n}\n\nsuite('NotebookDiff', () => {\n\tlet disposables: DisposableStore;\n\tlet token: CancellationToken;\n\tlet eventDispatcher: NotebookDiffEditorEventDispatcher;\n\tlet diffViewModel: NotebookDiffViewModel;\n\tlet diffResult: IDiffResult;\n\tlet notebookEditorWorkerService: INotebookEditorWorkerService;\n\tlet heightCalculator: IDiffEditorHeightCalculatorService;\n\tteardown(() => disposables.dispose());\n\n\tconst configurationService = new TestConfigurationService({ notebook: { diff: { ignoreMetadata: true } } });\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tconst cancellation = disposables.add(new CancellationTokenSource());\n\t\teventDispatcher = disposables.add(new NotebookDiffEditorEventDispatcher());\n\t\ttoken = cancellation.token;\n\t\tnotebookEditorWorkerService = new class extends mock<INotebookEditorWorkerService>() {\n\t\t\toverride computeDiff() { return Promise.resolve({ cellsDiff: diffResult, metadataChanged: false }); }\n\t\t};\n\t\theightCalculator = new class extends mock<IDiffEditorHeightCalculatorService>() {\n\t\t\toverride diffAndComputeHeight() { return Promise.resolve(0); }\n\t\t\toverride computeHeightFromLines(_lineCount: number): number {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\t});\n\n\tasync function verifyChangeEventIsNotFired(diffViewModel: INotebookDiffViewModel) {\n\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\tawait diffViewModel.computeDiff(token);\n\n\t\tassert.strictEqual(eventArgs, undefined);\n\t}\n\n\ttest('diff different source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t});\n\t});\n\n\ttest('No changes when re-computing diff with the same source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff different output', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\t(diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).hideUnchangedCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual((diffViewModel.items[1] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff test small source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['123456789', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['987654321', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff test data single cell', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t[[\n\t\t\t\t'# This version has a bug\\n',\n\t\t\t\t'def mult(a, b):\\n',\n\t\t\t\t'    return a / b'\n\t\t\t].join(''), 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t[[\n\t\t\t\t'def mult(a, b):\\n',\n\t\t\t\t'    \\'This version is debugged.\\'\\n',\n\t\t\t\t'    return a * b'\n\t\t\t].join(''), 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff foo/foe', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t[['def foe(x, y):\\n', '    return x + y\\n', 'foe(3, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([6])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t[['def foo(x, y):\\n', '    return x * y\\n', 'foo(1, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([2])) }] }], { metadata: { collapsed: false }, executionOrder: 6 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t[['def foo(x, y):\\n', '    return x * y\\n', 'foo(1, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([6])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t[['def foe(x, y):\\n', '    return x + y\\n', 'foe(3, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([2])) }] }], { metadata: { collapsed: false }, executionOrder: 6 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 3);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'placeholder');\n\t\t\tdiffViewModel.items[2].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 2, deleteCount: 1, elements: [diffViewModel.items[2]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff markdown', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['This is a test notebook with only markdown cells', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['Lorem ipsum dolor sit amet', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['In other news', 'markdown', CellKind.Markup, [], {}],\n\t\t], [\n\t\t\t['This is a test notebook with markdown cells only', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['Lorem ipsum dolor sit amet', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['In the news', 'markdown', CellKind.Markup, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 3);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'modified');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\n\t\t});\n\t});\n\n\ttest('diff insert', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 0,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(eventArgs?.firstChangeIndex, 0);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1], diffViewModel.items[2]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff insert 2', async () => {\n\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst eventDispatcher = disposables.add(new NotebookDiffEditorEventDispatcher());\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 0,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}, {\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 6,\n\t\t\t\t\tmodifiedStart: 1,\n\t\t\t\t\tmodifiedLength: 6\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(eventArgs?.firstChangeIndex, 0);\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[6].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[7].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: diffViewModel.items.slice(1) });\n\n\n\t\t\t(diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).hideUnchangedCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual((diffViewModel.items[1] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 7, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff insert 3', async () => {\n\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 4,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 4,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 0, deleteCount: 1, elements: diffViewModel.items.slice(0, 4) });\n\n\t\t\tdiffViewModel.items[5].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual((diffViewModel.items[2] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 5, deleteCount: 1, elements: diffViewModel.items.slice(5) });\n\n\t\t\t(diffViewModel.items[0] as SideBySideDiffElementViewModel).hideUnchangedCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'insert');\n\t\t\tassert.strictEqual((diffViewModel.items[2] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 0, deleteCount: 4, elements: diffViewModel.items.slice(0, 1) });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\n\t\t});\n\t});\n\n\ttest('LCS', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }]\n\t\t], [\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }]\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 2,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 2,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 3,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('LCS 2', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x = 5', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], {}],\n\t\t], [\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x = 5', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tprettyChanges(model.original.notebook, model.modified.notebook, diffResult);\n\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 2,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 2,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 3,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}, {\n\t\t\t\toriginalStart: 5,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 5,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 6,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 7,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('LCS 3', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tprettyChanges(model.original.notebook, model.modified.notebook, diffResult);\n\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 4,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('diff output', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([4])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).checkIfOutputsModified(), false);\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff output fast check', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([4])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).original!.textModel.equal((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).modified!.textModel), true);\n\t\t\tassert.strictEqual((diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).original!.textModel.equal((diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).modified!.textModel), false);\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { VSBuffer } from '../../../../../../base/common/buffer.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../../base/common/cancellation.js';\nimport { IDiffResult, ISequence, LcsDiff } from '../../../../../../base/common/diff/diff.js';\nimport { DisposableStore } from '../../../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../../../base/common/mime.js';\nimport { mock } from '../../../../../../base/test/common/mock.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../../base/test/common/utils.js';\nimport { TestConfigurationService } from '../../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IDiffElementViewModelBase, SideBySideDiffElementViewModel } from '../../../browser/diff/diffElementViewModel.js';\nimport { NotebookDiffEditorEventDispatcher } from '../../../browser/diff/eventDispatcher.js';\nimport { INotebookDiffViewModel, INotebookDiffViewModelUpdateEvent } from '../../../browser/diff/notebookDiffEditorBrowser.js';\nimport { NotebookDiffViewModel, prettyChanges } from '../../../browser/diff/notebookDiffViewModel.js';\nimport { CellKind, INotebookTextModel } from '../../../common/notebookCommon.js';\nimport { INotebookService } from '../../../common/notebookService.js';\nimport { INotebookEditorWorkerService } from '../../../common/services/notebookWorkerService.js';\nimport { withTestNotebookDiffModel } from '../testNotebookEditor.js';\nimport { IDiffEditorHeightCalculatorService } from '../../../browser/diff/editorHeightCalculator.js';\n\nclass CellSequence implements ISequence {\n\n\tconstructor(readonly textModel: INotebookTextModel) {\n\t}\n\n\tgetElements(): string[] | number[] | Int32Array {\n\t\tconst hashValue = new Int32Array(this.textModel.cells.length);\n\t\tfor (let i = 0; i < this.textModel.cells.length; i++) {\n\t\t\thashValue[i] = this.textModel.cells[i].getHashValue();\n\t\t}\n\n\t\treturn hashValue;\n\t}\n}\n\nsuite('NotebookDiff', () => {\n\tlet disposables: DisposableStore;\n\tlet token: CancellationToken;\n\tlet eventDispatcher: NotebookDiffEditorEventDispatcher;\n\tlet diffViewModel: NotebookDiffViewModel;\n\tlet diffResult: IDiffResult;\n\tlet notebookEditorWorkerService: INotebookEditorWorkerService;\n\tlet heightCalculator: IDiffEditorHeightCalculatorService;\n\tteardown(() => disposables.dispose());\n\n\tconst configurationService = new TestConfigurationService({ notebook: { diff: { ignoreMetadata: true } } });\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tconst cancellation = disposables.add(new CancellationTokenSource());\n\t\teventDispatcher = disposables.add(new NotebookDiffEditorEventDispatcher());\n\t\ttoken = cancellation.token;\n\t\tnotebookEditorWorkerService = new class extends mock<INotebookEditorWorkerService>() {\n\t\t\toverride computeDiff() { return Promise.resolve({ cellsDiff: diffResult, metadataChanged: false }); }\n\t\t};\n\t\theightCalculator = new class extends mock<IDiffEditorHeightCalculatorService>() {\n\t\t\toverride diffAndComputeHeight() { return Promise.resolve(0); }\n\t\t\toverride computeHeightFromLines(_lineCount: number): number {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\t});\n\n\tasync function verifyChangeEventIsNotFired(diffViewModel: INotebookDiffViewModel) {\n\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\tawait diffViewModel.computeDiff(token);\n\n\t\tassert.strictEqual(eventArgs, undefined);\n\t}\n\n\ttest('diff different source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t});\n\t});\n\n\ttest('No changes when re-computing diff with the same source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff different output', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\t(diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).hideUnchangedCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual((diffViewModel.items[1] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff test small source', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['123456789', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['987654321', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff test data single cell', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t[[\n\t\t\t\t'# This version has a bug\\n',\n\t\t\t\t'def mult(a, b):\\n',\n\t\t\t\t'    return a / b'\n\t\t\t].join(''), 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t[[\n\t\t\t\t'def mult(a, b):\\n',\n\t\t\t\t'    \\'This version is debugged.\\'\\n',\n\t\t\t\t'    return a * b'\n\t\t\t].join(''), 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\t\t\tassert.strictEqual(diffResult.changes.length, 1);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 0,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 0,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 1);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff foo/foe', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t[['def foe(x, y):\\n', '    return x + y\\n', 'foe(3, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([6])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t[['def foo(x, y):\\n', '    return x * y\\n', 'foo(1, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([2])) }] }], { metadata: { collapsed: false }, executionOrder: 6 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t[['def foo(x, y):\\n', '    return x * y\\n', 'foo(1, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([6])) }] }], { metadata: { collapsed: false }, executionOrder: 5 }],\n\t\t\t[['def foe(x, y):\\n', '    return x + y\\n', 'foe(3, 2)'].join(''), 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([2])) }] }], { metadata: { collapsed: false }, executionOrder: 6 }],\n\t\t\t['', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 3);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'placeholder');\n\t\t\tdiffViewModel.items[2].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 2, deleteCount: 1, elements: [diffViewModel.items[2]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff markdown', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['This is a test notebook with only markdown cells', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['Lorem ipsum dolor sit amet', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['In other news', 'markdown', CellKind.Markup, [], {}],\n\t\t], [\n\t\t\t['This is a test notebook with markdown cells only', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['Lorem ipsum dolor sit amet', 'markdown', CellKind.Markup, [], {}],\n\t\t\t['In the news', 'markdown', CellKind.Markup, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 3);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'modified');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'modified');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\n\t\t});\n\t});\n\n\ttest('diff insert', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], [\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t], async (model, disposables, accessor) => {\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 0,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(eventArgs?.firstChangeIndex, 0);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: [diffViewModel.items[1], diffViewModel.items[2]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff insert 2', async () => {\n\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst eventDispatcher = disposables.add(new NotebookDiffEditorEventDispatcher());\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 0,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}, {\n\t\t\t\t\toriginalStart: 0,\n\t\t\t\t\toriginalLength: 6,\n\t\t\t\t\tmodifiedStart: 1,\n\t\t\t\t\tmodifiedLength: 6\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(eventArgs?.firstChangeIndex, 0);\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[1].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[6].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[7].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 1, elements: diffViewModel.items.slice(1) });\n\n\n\t\t\t(diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).hideUnchangedCells();\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'insert');\n\t\t\tassert.strictEqual((diffViewModel.items[1] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 1, deleteCount: 7, elements: [diffViewModel.items[1]] });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff insert 3', async () => {\n\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tdiffResult = {\n\t\t\t\tchanges: [{\n\t\t\t\t\toriginalStart: 4,\n\t\t\t\t\toriginalLength: 0,\n\t\t\t\t\tmodifiedStart: 4,\n\t\t\t\t\tmodifiedLength: 1\n\t\t\t\t}],\n\t\t\t\tquitEarly: false\n\t\t\t};\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tlet eventArgs: INotebookDiffViewModelUpdateEvent | undefined = undefined;\n\t\t\tdisposables.add(diffViewModel.onDidChangeItems(e => eventArgs = e));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'placeholder');\n\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[2].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'placeholder');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 0, deleteCount: 1, elements: diffViewModel.items.slice(0, 4) });\n\n\t\t\tdiffViewModel.items[5].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'unchanged');\n\t\t\tassert.strictEqual((diffViewModel.items[2] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[3].type, 'unchanged');\n\t\t\tassert.strictEqual(diffViewModel.items[4].type, 'insert');\n\t\t\tassert.strictEqual(diffViewModel.items[5].type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 5, deleteCount: 1, elements: diffViewModel.items.slice(5) });\n\n\t\t\t(diffViewModel.items[0] as SideBySideDiffElementViewModel).hideUnchangedCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as IDiffElementViewModelBase).type, 'placeholder');\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'insert');\n\t\t\tassert.strictEqual((diffViewModel.items[2] as IDiffElementViewModelBase).type, 'unchanged');\n\t\t\tassert.deepStrictEqual(eventArgs, { start: 0, deleteCount: 4, elements: diffViewModel.items.slice(0, 1) });\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\n\t\t});\n\t});\n\n\ttest('LCS', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }]\n\t\t], [\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }]\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 2,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 2,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 3,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('LCS 2', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x = 5', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], {}],\n\t\t], [\n\t\t\t['# Description', 'markdown', CellKind.Markup, [], { metadata: {} }],\n\t\t\t['x = 3', 'javascript', CellKind.Code, [], { metadata: { collapsed: true }, executionOrder: 1 }],\n\t\t\t['x', 'javascript', CellKind.Code, [], { metadata: { collapsed: false } }],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 1 }],\n\t\t\t['x = 5', 'javascript', CellKind.Code, [], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], {}],\n\t\t\t['x', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tprettyChanges(model.original.notebook, model.modified.notebook, diffResult);\n\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 2,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 2,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 3,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}, {\n\t\t\t\toriginalStart: 5,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 5,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}, {\n\t\t\t\toriginalStart: 6,\n\t\t\t\toriginalLength: 1,\n\t\t\t\tmodifiedStart: 7,\n\t\t\t\tmodifiedLength: 0\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('LCS 3', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], [\n\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var h = 8;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var f = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t['var g = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t], async (model) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tconst diffResult = diff.ComputeDiff(false);\n\t\t\tprettyChanges(model.original.notebook, model.modified.notebook, diffResult);\n\n\t\t\tassert.deepStrictEqual(diffResult.changes.map(change => ({\n\t\t\t\toriginalStart: change.originalStart,\n\t\t\t\toriginalLength: change.originalLength,\n\t\t\t\tmodifiedStart: change.modifiedStart,\n\t\t\t\tmodifiedLength: change.modifiedLength\n\t\t\t})), [{\n\t\t\t\toriginalStart: 4,\n\t\t\t\toriginalLength: 0,\n\t\t\t\tmodifiedStart: 4,\n\t\t\t\tmodifiedLength: 1\n\t\t\t}]);\n\t\t});\n\t});\n\n\ttest('diff output', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([4])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).checkIfOutputsModified(), false);\n\t\t\tassert.strictEqual(diffViewModel.items[1].type, 'modified');\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n\n\ttest('diff output fast check', async () => {\n\t\tawait withTestNotebookDiffModel([\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([4])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], [\n\t\t\t['x', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([3])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t\t['y', 'javascript', CellKind.Code, [{ outputId: 'someOtherId', outputs: [{ mime: Mimes.text, data: VSBuffer.wrap(new Uint8Array([5])) }] }], { metadata: { collapsed: false }, executionOrder: 3 }],\n\t\t], async (model, disposables, accessor) => {\n\t\t\tconst diff = new LcsDiff(new CellSequence(model.original.notebook), new CellSequence(model.modified.notebook));\n\t\t\tdiffResult = diff.ComputeDiff(false);\n\n\t\t\tdiffViewModel = disposables.add(new NotebookDiffViewModel(model, notebookEditorWorkerService, configurationService, eventDispatcher, accessor.get<INotebookService>(INotebookService), heightCalculator, undefined));\n\t\t\tawait diffViewModel.computeDiff(token);\n\n\t\t\tassert.strictEqual(diffViewModel.items.length, 2);\n\t\t\tassert.strictEqual(diffViewModel.items[0].type, 'placeholder');\n\t\t\tdiffViewModel.items[0].showHiddenCells();\n\t\t\tassert.strictEqual((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).original!.textModel.equal((diffViewModel.items[0] as unknown as SideBySideDiffElementViewModel).modified!.textModel), true);\n\t\t\tassert.strictEqual((diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).original!.textModel.equal((diffViewModel.items[1] as unknown as SideBySideDiffElementViewModel).modified!.textModel), false);\n\n\t\t\tawait verifyChangeEventIsNotFired(diffViewModel);\n\t\t});\n\t});\n});\n"]}