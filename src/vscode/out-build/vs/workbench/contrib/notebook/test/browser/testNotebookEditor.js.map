{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/test/browser/testNotebookEditor.ts","vs/workbench/contrib/notebook/test/browser/testNotebookEditor.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,KAAK,GAAG,MAAM,oCAAoC,CAAC;AAE1D,OAAO,EAAE,QAAQ,EAAE,MAAM,sCAAsC,CAAC;AAChE,OAAO,EAAE,mBAAmB,EAAE,MAAM,sCAAsC,CAAC;AAC3E,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,qCAAqC,CAAC;AACrE,OAAO,EAAE,eAAe,EAAE,MAAM,yCAAyC,CAAC;AAC1E,OAAO,EAAE,WAAW,EAAE,MAAM,mCAAmC,CAAC;AAChE,OAAO,EAAE,KAAK,EAAE,MAAM,oCAAoC,CAAC;AAC3D,OAAO,EAAE,GAAG,EAAE,MAAM,mCAAmC,CAAC;AACxD,OAAO,EAAE,IAAI,EAAE,MAAM,yCAAyC,CAAC;AAC/D,OAAO,EAAE,kBAAkB,EAAE,MAAM,wDAAwD,CAAC;AAC5F,OAAO,EAAE,gBAAgB,EAAE,MAAM,oDAAoD,CAAC;AACtF,OAAO,EAAE,6BAA6B,EAAE,MAAM,yEAAyE,CAAC;AACxH,OAAO,EAAE,eAAe,EAAE,MAAM,0DAA0D,CAAC;AAC3F,OAAO,EAAE,aAAa,EAAE,MAAM,gDAAgD,CAAC;AAC/E,OAAO,EAAE,YAAY,EAAE,MAAM,uDAAuD,CAAC;AACrF,OAAO,EAAE,iBAAiB,EAAE,MAAM,0DAA0D,CAAC;AAC7F,OAAO,EAAE,gCAAgC,EAAE,MAAM,6EAA6E,CAAC;AAC/H,OAAO,EAAE,iBAAiB,EAAE,MAAM,8DAA8D,CAAC;AACjG,OAAO,EAAE,oBAAoB,EAAE,MAAM,uEAAuE,CAAC;AAC7G,OAAO,EAAE,qBAAqB,EAAE,MAAM,+DAA+D,CAAC;AACtG,OAAO,EAAE,wBAAwB,EAAE,MAAM,+EAA+E,CAAC;AACzH,OAAO,EAAE,iBAAiB,EAAE,MAAM,iEAAiE,CAAC;AACpG,OAAO,EAAE,kBAAkB,EAAE,MAAM,yDAAyD,CAAC;AAC7F,OAAO,EAAE,wBAAwB,EAAE,MAAM,+EAA+E,CAAC;AACzH,OAAO,EAAE,kBAAkB,EAAE,MAAM,yDAAyD,CAAC;AAC7F,OAAO,EAAE,qBAAqB,EAAE,MAAM,yEAAyE,CAAC;AAChH,OAAO,EAAE,cAAc,EAAE,MAAM,yDAAyD,CAAC;AACzF,OAAO,EAAE,YAAY,EAAE,WAAW,EAAE,MAAM,qDAAqD,CAAC;AAChG,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE,MAAM,2CAA2C,CAAC;AACxF,OAAO,EAAE,eAAe,EAAE,MAAM,mDAAmD,CAAC;AACpF,OAAO,EAAE,aAAa,EAAE,MAAM,sDAAsD,CAAC;AACrF,OAAO,EAAE,gBAAgB,EAAE,MAAM,+DAA+D,CAAC;AACjG,OAAO,EAAE,gBAAgB,EAAE,MAAM,qDAAqD,CAAC;AACvF,OAAO,EAAE,eAAe,EAAE,MAAM,4DAA4D,CAAC;AAC7F,OAAO,EAAE,6BAA6B,EAAE,MAAM,4DAA4D,CAAC;AAE3G,OAAO,EAAE,WAAW,EAAE,MAAM,0CAA0C,CAAC;AACvE,OAAO,EAA0B,aAAa,EAAkG,MAAM,kCAAkC,CAAC;AAEzL,OAAO,EAAE,4BAA4B,EAAE,MAAM,4DAA4D,CAAC;AAC1G,OAAO,EAAE,oBAAoB,EAAE,gBAAgB,EAAE,MAAM,wCAAwC,CAAC;AAEhG,OAAO,EAAE,uBAAuB,EAAE,MAAM,4CAA4C,CAAC;AACrF,OAAO,EAAiB,iBAAiB,EAAE,MAAM,kDAAkD,CAAC;AACpG,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,qBAAqB,EAAE,MAAM,6CAA6C,CAAC;AACpF,OAAO,EAAE,iBAAiB,EAAE,MAAM,yCAAyC,CAAC;AAC5E,OAAO,EAAE,6BAA6B,EAAE,MAAM,8CAA8C,CAAC;AAC7F,OAAO,EAAY,OAAO,EAA6H,0BAA0B,EAAwB,kBAAkB,EAAE,MAAM,gCAAgC,CAAC;AACpQ,OAAO,EAAwJ,8BAA8B,EAAkC,MAAM,+CAA+C,CAAC;AACrR,OAAO,EAAE,eAAe,EAAE,MAAM,kCAAkC,CAAC;AAEnE,OAAO,EAAE,wBAAwB,EAAE,MAAM,2EAA2E,CAAC;AAErH,OAAO,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACtF,OAAO,EAAE,kBAAkB,EAAE,iCAAiC,EAAE,gCAAgC,EAAE,MAAM,kDAAkD,CAAC;AAC3J,OAAO,EAAE,QAAQ,EAAE,MAAM,iDAAiD,CAAC;AAC3E,OAAO,EAAE,mBAAmB,EAAE,oBAAoB,EAAE,MAAM,sDAAsD,CAAC;AACjH,OAAO,EAAE,kBAAkB,EAAE,MAAM,6DAA6D,CAAC;AACjG,OAAO,EAAE,UAAU,EAAE,MAAM,uCAAuC,CAAC;AACnE,OAAO,EAAE,qBAAqB,EAAE,MAAM,0DAA0D,CAAC;AACjG,OAAO,EAAE,qCAAqC,EAAE,oCAAoC,EAAE,MAAM,6DAA6D,CAAC;AAC1J,OAAO,EAAE,yBAAyB,EAAE,MAAM,iFAAiF,CAAC;AAC5H,OAAO,EAAE,4BAA4B,EAAE,2BAA2B,EAAE,MAAM,wDAAwD,CAAC;AACnI,OAAO,EAAE,eAAe,EAAE,MAAM,iDAAiD,CAAC;AAElF,OAAO,EAAE,8BAA8B,EAAE,MAAM,oEAAoE,CAAC;AACpH,OAAO,EAAE,uBAAuB,EAAE,MAAM,wCAAwC,CAAC;AAEjF,MAAM,0BAA0B;IAE/B,IAAI,CAAC,QAAgB,EAAE,MAAc,IAAU,CAAC;IAChD,IAAI,CAAC,QAAgB,EAAE,MAAc,IAAU,CAAC;IAChD,KAAK,CAAC,QAAgB,EAAE,MAAc,IAAU,CAAC;IACjD,KAAK,CAAC,QAAgB,EAAE,MAAc,IAAU,CAAC;IACjD,KAAK,CAAC,QAAgB,EAAE,OAAe,IAAU,CAAC;CAClD;AAED,MAAM,OAAO,QAAS,SAAQ,qBAAqB;IAClD,YACQ,QAAgB,EACvB,MAAc,EACP,MAAc,EACrB,QAAgB,EAChB,QAAkB,EAClB,OAAqB,EACrB,eAAiC;QAEjC,KAAK,CACJ,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,uBAAuB,CAAC,EAAE,MAAM,CAAC,EAC5D,MAAM,EACN;YACC,MAAM;YACN,QAAQ;YACR,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,QAAQ;YACR,OAAO;YACP,QAAQ,EAAE,SAAS;YACnB,gBAAgB,EAAE,SAAS;YAC3B,aAAa,EAAE,SAAS;SACxB,EACD,EAAE,qBAAqB,EAAE,EAAE,EAAE,yBAAyB,EAAE,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,mBAAmB,EAAE,EAAE,EAAE,EAC9G,eAAe,+BAEf,SAAS,EAAE,wBAAwB;QACnC,SAAS,EAAG,2BAA2B;QACvC,IAAI,0BAA0B,EAAE,CAChC,CAAC;QA3BK,aAAQ,GAAR,QAAQ,CAAQ;QAEhB,WAAM,GAAN,MAAM,CAAQ;IA0BtB,CAAC;CACD;AAED,MAAM,OAAO,uBAAwB,SAAQ,WAAW;IAiBvD,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;IAChC,CAAC;IAED,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;IAC3B,CAAC;IAED,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IAED,YACS,SAA4B;QAEpC,KAAK,EAAE,CAAC;QAFA,cAAS,GAAT,SAAS,CAAmB;QA7B7B,WAAM,GAAG,KAAK,CAAC;QAEJ,eAAU,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAyB,CAAC,CAAC;QAC5E,cAAS,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QAExB,sBAAiB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAQ,CAAC,CAAC;QAClE,qBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC;QAEhD,wBAAmB,GAAG,KAAK,CAAC,IAAI,CAAC;QACjC,wBAAmB,GAAG,KAAK,CAAC,IAAI,CAAC;QACjC,wBAAmB,GAAG,KAAK,CAAC,IAAI,CAAC;QAEzB,wBAAmB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAQ,CAAC,CAAC;QAClE,uBAAkB,GAAgB,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC;QAoBzE,IAAI,SAAS,IAAI,SAAS,CAAC,kBAAkB,EAAE,CAAC;YAC/C,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,kBAAkB,CAAC,GAAG,EAAE;gBAChD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;gBAC9B,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;YACjC,CAAC,CAAC,CAAC,CAAC;QACL,CAAC;IACF,CAAC;IAED,UAAU;QACT,OAAO,KAAK,CAAC;IACd,CAAC;IAED,UAAU;QACT,OAAO,KAAK,CAAC;IACd,CAAC;IAED,qBAAqB;QACpB,OAAO,KAAK,CAAC;IACd,CAAC;IAED,OAAO;QACN,OAAO,IAAI,CAAC,MAAM,CAAC;IACpB,CAAC;IAED,IAAI,aAAa;QAChB,OAAO,KAAK,CAAC;IACd,CAAC;IAED,UAAU;QACT,OAAO,IAAI,CAAC,MAAM,CAAC;IACpB,CAAC;IAED,WAAW;QACV,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IAED,KAAK,CAAC,IAAI;QACT,OAAO,IAAI,CAAC;IACb,CAAC;IAED,KAAK,CAAC,IAAI;QACT,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACpB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YACzB,yBAAyB;YACzB,OAAO,IAAI,CAAC;QACb,CAAC;QAED,OAAO,KAAK,CAAC;IACd,CAAC;IAED,MAAM;QACL,MAAM,IAAI,mBAAmB,EAAE,CAAC;IACjC,CAAC;IAED,MAAM;QACL,MAAM,IAAI,mBAAmB,EAAE,CAAC;IACjC,CAAC;CACD;AAED,MAAM,UAAU,yBAAyB,CAAC,WAAyC;IAClF,MAAM,oBAAoB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,wBAAwB,EAAE,CAAC,CAAC;IAC7E,MAAM,gBAAgB,GAAG,IAAI,gBAAgB,EAAE,CAAC;IAChD,oBAAoB,CAAC,IAAI,CAAC,gBAAgB,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,eAAe,EAAE,CAAC,CAAC,CAAC;IACpF,oBAAoB,CAAC,IAAI,CAAC,gBAAgB,EAAE,oBAAoB,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC,CAAC;IAClG,oBAAoB,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,wBAAwB,EAAE,CAAC,CAAC;IACjF,oBAAoB,CAAC,IAAI,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;IAC3D,oBAAoB,CAAC,IAAI,CAAC,6BAA6B,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,gCAAgC,EAAE,CAAC,CAAC,CAAC;IAClH,oBAAoB,CAAC,IAAI,CAAC,8BAA8B,EAAE,oBAAoB,CAAC,cAAc,CAAC,iCAAiC,CAAC,CAAC,CAAC;IAClI,oBAAoB,CAAC,IAAI,CAAC,aAAa,EAAE,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;IAC7G,oBAAoB,CAAC,IAAI,CAAC,iBAAiB,EAAqB,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC;IAChJ,oBAAoB,CAAC,IAAI,CAAC,kBAAkB,EAAE,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACvH,oBAAoB,CAAC,IAAI,CAAC,YAAY,EAAE,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAC3G,oBAAoB,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,iBAAiB,EAAE,CAAC,CAAC;IACnE,oBAAoB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;IAC7D,oBAAoB,CAAC,IAAI,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,CAAC;IACnE,oBAAoB,CAAC,IAAI,CAAC,eAAe,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACtF,oBAAoB,CAAC,IAAI,CAAC,6BAA6B,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,gCAAgC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACtH,oBAAoB,CAAC,IAAI,CAAC,8BAA8B,EAAE,IAAI,iCAAiC,EAAE,CAAC,CAAC;IACnG,oBAAoB,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,qBAAqB,EAAE,CAAC,CAAC;IAC3E,oBAAoB,CAAC,IAAI,CAAC,6BAA6B,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,4BAA4B,EAAE,CAAC,CAAC,CAAC;IAC9G,oBAAoB,CAAC,IAAI,CAAC,kBAAkB,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,qBAAqB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;IAC5G,oBAAoB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,KAAM,SAAQ,IAAI,EAAmB;QAAY,sBAAsB,KAAK,OAAO,EAAE,OAAO,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;KAAE,CAAC,CAAC;IAC1J,oBAAoB,CAAC,IAAI,CAAC,qCAAqC,EAAE,oBAAoB,CAAC,cAAc,CAAC,oCAAoC,CAAC,CAAC,CAAC;IAC5I,oBAAoB,CAAC,IAAI,CAAC,4BAA4B,EAAE,oBAAoB,CAAC,cAAc,CAAC,2BAA2B,CAAC,CAAC,CAAC;IAC1H,oBAAoB,CAAC,IAAI,CAAC,uBAAuB,EAAE,IAAI,0BAA0B,EAAE,CAAC,CAAC;IAErF,oBAAoB,CAAC,IAAI,CAAC,yBAAyB,EAAE,IAAI,MAAM,4BAA4B;QAE1F,oBAAoB,CAAC,UAAkB;YACtC,OAAO,KAAK,CAAC;QACd,CAAC;QACD,KAAK,CAAC,cAAc,CAAC,QAAa,EAAE,cAAqC;YACxE,OAAO,SAAS,CAAC;QAClB,CAAC;KACD,CAAC,CAAC;IAEH,OAAO,oBAAoB,CAAC;AAC7B,CAAC;AAED,SAAS,yBAAyB,CAAC,oBAA8C,EAAE,WAA4B,EAAE,KAAyB;IAEzI,MAAM,QAAQ,GAAG,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,iBAAiB,EAAE,QAAQ,EAAE,GAAG,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAa,EAAE;QACzJ,OAAO;YACN,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;YACf,IAAI,EAAE,SAAS;YACf,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;YACjB,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;YACjB,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE;YACtB,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;SACjB,CAAC;IACH,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,qBAAqB,EAAE,EAAE,EAAE,yBAAyB,EAAE,EAAE,EAAE,mBAAmB,EAAE,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;IAEzH,MAAM,KAAK,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,uBAAuB,CAAC,QAAQ,CAAC,CAAC,CAAC;IACrE,MAAM,eAAe,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,eAAe,CAAC,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,oBAAoB,CAAC,GAAG,CAAC,qBAAqB,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,8BAA8B,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;IACpP,MAAM,qBAAqB,GAAG,IAAI,KAAM,SAAQ,IAAI,EAA0B;KAAI,CAAC;IACnF,MAAM,WAAW,GAAG,IAAI,WAAW,CAAC,eAAe,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,uBAAuB,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,qBAAqB,CAAC,CAAC;IAClI,MAAM,SAAS,GAAsB,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,iBAAiB,EAAE,QAAQ,EAAE,KAAK,CAAC,QAAQ,EAAE,WAAW,EAAE,IAAI,EAAE,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;IAEjL,MAAM,QAAQ,GAAG,WAAW,CAAC,GAAG,CAAC,sBAAsB,CAAC,oBAAoB,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC,CAAC;IACzG,QAAQ,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;IACpC,MAAM,oBAAoB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC;IAEjF,IAAI,aAAa,GAAiB,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;IAE3D,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC;IACjC,MAAM,cAAc,GAAkC,IAAI,KAAM,SAAQ,IAAI,EAAiC;QAAnD;;YAKhD,oBAAe,GAAG,eAAe,CAAC;YAClC,qBAAgB,GAAyC,IAAI,OAAO,EAAiC,CAAC,KAAK,CAAC;YAC5G,yBAAoB,GAAyC,IAAI,OAAO,EAAiC,CAAC,KAAK,CAAC;YAIhH,cAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC;YAkEvC,6BAAwB,GAAG,KAAK,CAAC,IAAI,CAAC;QA4ChD,CAAC;QAxHA,6DAA6D;QACpD,OAAO;YACf,SAAS,CAAC,OAAO,EAAE,CAAC;QACrB,CAAC;QAIQ,YAAY;YACpB,OAAO,SAAS,CAAC;QAClB,CAAC;QAEQ,QAAQ;YAChB,OAAO,CAAC,CAAC,SAAS,CAAC;QACpB,CAAC;QACQ,SAAS,KAAK,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;QACxC,QAAQ,KAAK,OAAO,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;QAC3C,aAAa,KAAK,OAAO,SAAS,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;QACrD,QAAQ,CAAC,KAAiB;YAClC,SAAS,CAAC,qBAAqB,CAAC;gBAC/B,IAAI,EAAE,kBAAkB,CAAC,KAAK;gBAC9B,KAAK,EAAE,KAAK;gBACZ,UAAU,EAAE,SAAS,CAAC,aAAa,EAAE;aACrC,CAAC,CAAC;QACJ,CAAC;QACQ,aAAa,CAAC,UAAwB;YAC9C,SAAS,CAAC,qBAAqB,CAAC;gBAC/B,IAAI,EAAE,kBAAkB,CAAC,KAAK;gBAC9B,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE;gBAC3B,UAAU,EAAE,UAAU;aACtB,CAAC,CAAC;QACJ,CAAC;QACQ,wBAAwB,CAAC,KAAa,IAAI,OAAO,oBAAoB,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACjH,yBAAyB,CAAC,UAAkB,EAAE,QAAgB,IAAI,OAAO,oBAAoB,CAAC,yBAAyB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;QAChJ,qBAAqB,KAAK,CAAC;QAC3B,KAAK,CAAC,YAAY,KAAK,CAAC;QACxB,cAAc,CAAC,OAAqB;YAC5C,OAAO,QAAQ,CAAC,cAAc,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC/C,CAAC;QACQ,aAAa;YACrB,MAAM,QAAQ,GAAG,QAAQ,CAAC,kBAAkB,EAAE,CAAC;YAE/C,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACjC,OAAO,QAAQ,CAAC,CAAC,CAAC,CAAC;YACpB,CAAC;YAED,OAAO,SAAS,CAAC;QAClB,CAAC;QACQ,sBAAsB;YAC9B,OAAO,KAAK,CAAC;QACd,CAAC;QACQ,sBAAsB,KAAK,OAAO,IAAI,CAAC,CAAC,CAAC;QACzC,YAAY,KAAK,CAAC;QAClB,sBAAsB,KAAK,CAAC;QAC5B,KAAK,CAAC,yCAAyC,KAAK,CAAC;QACrD,KAAK,CAAC,kBAAkB,KAAK,CAAC;QAC9B,KAAK,CAAC,YAAY,KAAK,CAAC;QACxB,KAAK,CAAC,WAAW,KAAK,CAAC;QACvB,KAAK,CAAC,iBAAiB,CAAC,IAAoB,EAAE,SAA4C;YAClG,IAAI,CAAC,SAAS,GAAG,SAAS,KAAK,QAAQ,CAAC,CAAC,CAAC,aAAa,CAAC,MAAM;gBAC7D,CAAC,CAAC,SAAS,KAAK,QAAQ,CAAC,CAAC,CAAC,aAAa,CAAC,MAAM;oBAC9C,CAAC,CAAC,aAAa,CAAC,SAAS,CAAC;QAC7B,CAAC;QACQ,MAAM,CAAC,KAAa,IAAI,OAAO,SAAS,CAAC,MAAM,CAAC,KAAK,CAAE,CAAC,CAAC,CAAC;QAC1D,YAAY,CAAC,IAAoB,IAAI,OAAO,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC3E,eAAe,CAAC,KAAkB,IAAI,OAAO,SAAS,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAChF,eAAe,CAAC,MAAc,IAAI,OAAO,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC7E,uBAAuB,CAAC,KAAa,IAAI,OAAO,SAAS,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACpG,UAAU,KAAK,OAAO,IAAI,CAAC,CAAC,CAAC;QAC7B,IAAa,oBAAoB,KAAK,OAAO,SAAS,CAAC,oBAAkC,CAAC,CAAC,CAAC;QAC5F,IAAa,kBAAkB,KAAK,OAAO,SAAS,CAAC,kBAAkB,CAAC,CAAC,CAAC;QAC1E,IAAa,oBAAoB,KAAK,OAAO,SAAS,CAAC,oBAAoB,CAAC,CAAC,CAAC;QACrE,KAAK,CAAC,IAAI,CAAC,KAAa,EAAE,OAA6B;YAC/D,MAAM,WAAW,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACrF,OAAO,WAAW,CAAC;QACpB,CAAC;QACQ,oBAAoB,KAAK,OAAO,EAAE,CAAC,CAAC,CAAC;QAG9C,IAAa,aAAa;YACzB,OAAO,aAAa,CAAC;QACtB,CAAC;QAED,IAAa,aAAa,CAAC,OAAqB;YAC/C,aAAa,GAAG,OAAO,CAAC;QACzB,CAAC;QAEQ,KAAK,KAAa,OAAO,EAAE,CAAC,CAAC,CAAC;QAC9B,YAAY,CAAC,SAAiB;YACtC,QAAQ,CAAC,SAAS,GAAG,SAAS,CAAC;QAChC,CAAC;QACD,IAAa,SAAS;YACrB,OAAO,QAAQ,CAAC,SAAS,CAAC;QAC3B,CAAC;QACQ,aAAa;YACrB,OAAO;gBACN,KAAK,EAAE,CAAC;gBACR,MAAM,EAAE,CAAC;gBACT,YAAY,EAAE,QAAQ,CAAC,eAAe,EAAE;gBACxC,QAAQ,EAAE,IAAI,QAAQ,CAAC;oBACtB,UAAU,EAAE,CAAC;oBACb,UAAU,EAAE,UAAU;oBACtB,UAAU,EAAE,QAAQ;oBACpB,QAAQ,EAAE,EAAE;oBACZ,mBAAmB,EAAE,mBAAmB,CAAC,GAAG;oBAC5C,qBAAqB,EAAE,oBAAoB,CAAC,GAAG;oBAC/C,UAAU,EAAE,EAAE;oBACd,aAAa,EAAE,GAAG;oBAClB,WAAW,EAAE,IAAI;oBACjB,8BAA8B,EAAE,EAAE;oBAClC,8BAA8B,EAAE,EAAE;oBAClC,8BAA8B,EAAE,IAAI;oBACpC,UAAU,EAAE,EAAE;oBACd,WAAW,EAAE,EAAE;oBACf,aAAa,EAAE,EAAE;oBACjB,aAAa,EAAE,EAAE;iBACjB,EAAE,IAAI,CAAC;gBACR,YAAY,EAAE,CAAC;gBACf,iBAAiB,EAAE,CAAC;aACpB,CAAC;QACH,CAAC;KACD,CAAC;IAEF,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,SAAS,EAAE,CAAC;AAC9C,CAAC;AAED,MAAM,UAAU,wBAAwB,CAAC,oBAA8C,EAAE,WAA4B,EAAE,KAA+G;IACrO,OAAO,yBAAyB,CAAC,oBAAoB,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;AAC5E,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,yBAAyB,CAAU,aAAuH,EAAE,aAAuH,EAAE,QAAmI;IAC7a,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;IAC1C,MAAM,oBAAoB,GAAG,yBAAyB,CAAC,WAAW,CAAC,CAAC;IACpE,MAAM,gBAAgB,GAAG,wBAAwB,CAAC,oBAAoB,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;IACpG,MAAM,gBAAgB,GAAG,wBAAwB,CAAC,oBAAoB,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;IACpG,MAAM,gBAAgB,GAAG,IAAI,KAAM,SAAQ,IAAI,EAAgC;QAC9E,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC;QACpD,CAAC;QACD,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,GAAG,CAAC;QACxD,CAAC;KACD,CAAC;IAEF,MAAM,gBAAgB,GAAG,IAAI,KAAM,SAAQ,IAAI,EAAgC;QAC9E,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC;QACpD,CAAC;QACD,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,GAAG,CAAC;QACxD,CAAC;KACD,CAAC;IAEF,MAAM,KAAK,GAAG,IAAI,KAAM,SAAQ,IAAI,EAA4B;QAC/D,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC;QACzB,CAAC;QACD,IAAa,QAAQ;YACpB,OAAO,gBAAgB,CAAC;QACzB,CAAC;KACD,CAAC;IAEF,MAAM,GAAG,GAAG,MAAM,QAAQ,CAAC,KAAK,EAAE,WAAW,EAAE,oBAAoB,CAAC,CAAC;IACrE,IAAI,GAAG,YAAY,OAAO,EAAE,CAAC;QAC5B,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE;YAChB,gBAAgB,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;YAClC,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;YACtD,gBAAgB,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YACrC,gBAAgB,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;YAClC,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;YACtD,gBAAgB,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YACrC,WAAW,CAAC,OAAO,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;IACJ,CAAC;SAAM,CAAC;QACP,gBAAgB,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;QAClC,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;QACtD,gBAAgB,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;QACrC,gBAAgB,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;QAClC,gBAAgB,CAAC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;QACtD,gBAAgB,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;QACrC,WAAW,CAAC,OAAO,EAAE,CAAC;IACvB,CAAC;IACD,OAAO,GAAG,CAAC;AACZ,CAAC;AAqBD,MAAM,CAAC,KAAK,UAAU,gBAAgB,CAAU,KAAyB,EAAE,QAAuK,EAAE,QAAmC;IACtR,MAAM,WAAW,GAAoB,IAAI,eAAe,EAAE,CAAC;IAC3D,MAAM,oBAAoB,GAAG,QAAQ,IAAI,yBAAyB,CAAC,WAAW,CAAC,CAAC;IAChF,MAAM,cAAc,GAAG,yBAAyB,CAAC,oBAAoB,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;IAE3F,OAAO,kBAAkB,CAAC,EAAE,aAAa,EAAE,IAAI,EAAE,EAAE,KAAK,IAAI,EAAE;QAC7D,MAAM,GAAG,GAAG,MAAM,QAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,cAAc,CAAC,SAAS,EAAE,WAAW,EAAE,oBAAoB,CAAC,CAAC;QAC/G,IAAI,GAAG,YAAY,OAAO,EAAE,CAAC;YAC5B,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE;gBAChB,cAAc,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;gBAChC,cAAc,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;gBACnC,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;gBAC1C,WAAW,CAAC,OAAO,EAAE,CAAC;YACvB,CAAC,CAAC,CAAC;QACJ,CAAC;aAAM,CAAC;YACP,cAAc,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;YAChC,cAAc,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YACnC,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YAC1C,WAAW,CAAC,OAAO,EAAE,CAAC;QACvB,CAAC;QACD,OAAO,GAAG,CAAC;IACZ,CAAC,CAAC,CAAC;AACJ,CAAC;AAED,MAAM,UAAU,sBAAsB,CAAC,oBAA8C,EAAE,WAAyC,EAAE,WAAyB;IAC1J,MAAM,QAAQ,GAAwC;QACrD,SAAS,CAAC,OAAsB,IAAI,OAAO,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACnE,aAAa,KAAK,OAAO,UAAU,CAAC,CAAC,CAAC;KACtC,CAAC;IAEF,MAAM,sBAAsB,GAAG,IAAI,KAAM,SAAQ,IAAI,EAA0B;KAAI,CAAC;IACpF,MAAM,QAAQ,GAAyD;QACtE,UAAU,EAAE,UAAU;QACtB,cAAc,KAAK,OAAO,sBAAsB,CAAC,CAAC,CAAC;QACnD,aAAa,KAAK,CAAC;QACnB,eAAe,KAAK,CAAC;KACrB,CAAC;IAEF,MAAM,eAAe,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,eAAe;QAClE,CAAC,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,eAAe,CAAC,UAAU,EAAE,KAAK,EAAE,SAAS,EAAE,oBAAoB,CAAC,GAAG,CAAC,qBAAqB,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,8BAA8B,CAAC,EAAE,oBAAoB,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;IAC/N,MAAM,QAAQ,GAAqB,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CACrF,gBAAgB,EAChB,kBAAkB,EAClB,GAAG,CAAC,CAAC,CAAC,WAAW,CAAC,EAClB,eAAe,EACf,QAAQ,EACR,CAAC,QAAQ,CAAC,EACV,oBAAoB,CAAC,GAAG,CAAqB,kBAAkB,CAAC,EAChE;QACC,qBAAqB,EAAE,IAAI;QAC3B,wBAAwB,EAAE,IAAI;KAC9B,CACD,CAAC,CAAC;IAEH,OAAO,QAAQ,CAAC;AACjB,CAAC;AAED,MAAM,UAAU,oBAAoB,CAAC,KAAa;IACjD,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AACnC,CAAC;AAED,MAAM,iBAAiB;IACtB,YACU,QAAa,EACb,UAAkB,EACnB,UAAsB;QAFrB,aAAQ,GAAR,QAAQ,CAAK;QACb,eAAU,GAAV,UAAU,CAAQ;QACnB,eAAU,GAAV,UAAU,CAAY;QAGtB,UAAK,GAA+B,0BAA0B,CAAC,WAAW,CAAC;QAE3E,aAAQ,GAAY,KAAK,CAAC;QAC1B,aAAQ,GAAY,KAAK,CAAC;IAL/B,CAAC;IAOL,OAAO;IACP,CAAC;IAED,MAAM,CAAC,OAA6B;IACpC,CAAC;IAED,QAAQ,CAAC,QAAgC;QACxC,IAAI,CAAC,UAAU,EAAE,CAAC;IACnB,CAAC;CACD;AAED,MAAM,OAAO,iCAAiC;IAA9C;QAGS,gBAAW,GAAG,IAAI,WAAW,EAA0B,CAAC;QAEhE,yBAAoB,GAAG,IAAI,OAAO,EAAiE,CAAC,KAAK,CAAC;QAC1G,gCAA2B,GAAG,IAAI,OAAO,EAAkC,CAAC,KAAK,CAAC;IAoCnF,CAAC;IAlCA,6BAA6B,CAAC,WAAgB;IAC9C,CAAC;IAED,4BAA4B,CAAC,QAAa;QACzC,OAAO,EAAE,CAAC;IACX,CAAC;IAED,gBAAgB,CAAC,OAAY;QAC5B,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IACtC,CAAC;IAED,mBAAmB,CAAC,QAAa,EAAE,UAAkB;QACpD,MAAM,UAAU,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC;QACzF,MAAM,GAAG,GAAG,IAAI,iBAAiB,CAAC,QAAQ,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;QACpE,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE,GAAG,CAAC,CAAC;QAClE,OAAO,GAAG,CAAC;IACZ,CAAC;IAED,oCAAoC,CAAC,QAAa;QACjD,OAAO;IACR,CAAC;IAED,4BAA4B,CAAC,QAAa;QACzC,OAAO;IACR,CAAC;IACD,+BAA+B,CAAC,QAAa;QAC5C,OAAO;IACR,CAAC;IACD,YAAY,CAAC,QAAa;QACzB,OAAO;IACR,CAAC;IACD,eAAe,CAAC,QAAa;QAC5B,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;IAC5C,CAAC;CACD","file":"testNotebookEditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { IListRenderer, IListVirtualDelegate } from '../../../../../base/browser/ui/list/list.js';\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { NotImplementedError } from '../../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { LanguageService } from '../../../../../editor/common/services/languageService.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ModelService } from '../../../../../editor/common/services/modelService.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { TestClipboardService } from '../../../../../platform/clipboard/test/common/testClipboardService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ContextKeyService } from '../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { MockKeybindingService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILayoutService } from '../../../../../platform/layout/browser/layoutService.js';\nimport { IListService, ListService } from '../../../../../platform/list/browser/listService.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { TestThemeService } from '../../../../../platform/theme/test/common/testThemeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../../platform/undoRedo/common/undoRedoService.js';\nimport { IWorkspaceTrustRequestService } from '../../../../../platform/workspace/common/workspaceTrust.js';\nimport { EditorInput } from '../../../../common/editor/editorInput.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { CellFindMatchWithIndex, CellFocusMode, IActiveNotebookEditorDelegate, IBaseCellEditorOptions, ICellViewModel, INotebookEditorDelegate } from '../../browser/notebookBrowser.js';\nimport { NotebookCellStateChangedEvent, NotebookLayoutInfo } from '../../browser/notebookViewEvents.js';\nimport { NotebookCellStatusBarService } from '../../browser/services/notebookCellStatusBarServiceImpl.js';\nimport { ListViewInfoAccessor, NotebookCellList } from '../../browser/view/notebookCellList.js';\nimport { BaseCellRenderTemplate } from '../../browser/view/notebookRenderingCommon.js';\nimport { NotebookEventDispatcher } from '../../browser/viewModel/eventDispatcher.js';\nimport { CellViewModel, NotebookViewModel } from '../../browser/viewModel/notebookViewModelImpl.js';\nimport { ViewContext } from '../../browser/viewModel/viewContext.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { INotebookCellStatusBarService } from '../../common/notebookCellStatusBarService.js';\nimport { CellKind, CellUri, ICellDto2, INotebookDiffEditorModel, INotebookEditorModel, INotebookFindOptions, IOutputDto, IResolvedNotebookEditorModel, NotebookCellExecutionState, NotebookCellMetadata, SelectionStateType } from '../../common/notebookCommon.js';\nimport { ICellExecuteUpdate, ICellExecutionComplete, ICellExecutionStateChangedEvent, IExecutionStateChangedEvent, INotebookCellExecution, INotebookExecution, INotebookExecutionStateService, INotebookFailStateChangedEvent } from '../../common/notebookExecutionStateService.js';\nimport { NotebookOptions } from '../../browser/notebookOptions.js';\nimport { ICellRange } from '../../common/notebookRange.js';\nimport { TextModelResolverService } from '../../../../services/textmodelResolver/common/textModelResolverService.js';\nimport { IWorkingCopySaveEvent } from '../../../../services/workingCopy/common/workingCopy.js';\nimport { TestLayoutService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestStorageService, TestTextResourcePropertiesService, TestWorkspaceTrustRequestService } from '../../../../test/common/workbenchTestServices.js';\nimport { FontInfo } from '../../../../../editor/common/config/fontInfo.js';\nimport { EditorFontLigatures, EditorFontVariations } from '../../../../../editor/common/config/editorOptions.js';\nimport { ICodeEditorService } from '../../../../../editor/browser/services/codeEditorService.js';\nimport { mainWindow } from '../../../../../base/browser/window.js';\nimport { TestCodeEditorService } from '../../../../../editor/test/browser/editorTestServices.js';\nimport { INotebookCellOutlineDataSourceFactory, NotebookCellOutlineDataSourceFactory } from '../../browser/viewModel/notebookOutlineDataSourceFactory.js';\nimport { ILanguageDetectionService } from '../../../../services/languageDetection/common/languageDetectionWorkerService.js';\nimport { INotebookOutlineEntryFactory, NotebookOutlineEntryFactory } from '../../browser/viewModel/notebookOutlineEntryFactory.js';\nimport { IOutlineService } from '../../../../services/outline/browser/outline.js';\nimport { DefaultEndOfLine } from '../../../../../editor/common/model.js';\nimport { ITextResourcePropertiesService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { INotebookLoggingService } from '../../common/notebookLoggingService.js';\n\nclass NullNotebookLoggingService implements INotebookLoggingService {\n\t_serviceBrand: undefined;\n\tinfo(category: string, output: string): void { }\n\twarn(category: string, output: string): void { }\n\terror(category: string, output: string): void { }\n\tdebug(category: string, output: string): void { }\n\ttrace(category: string, message: string): void { }\n}\n\nexport class TestCell extends NotebookCellTextModel {\n\tconstructor(\n\t\tpublic viewType: string,\n\t\thandle: number,\n\t\tpublic source: string,\n\t\tlanguage: string,\n\t\tcellKind: CellKind,\n\t\toutputs: IOutputDto[],\n\t\tlanguageService: ILanguageService,\n\t) {\n\t\tsuper(\n\t\t\tCellUri.generate(URI.parse('test:///fake/notebook'), handle),\n\t\t\thandle,\n\t\t\t{\n\t\t\t\tsource,\n\t\t\t\tlanguage,\n\t\t\t\tmime: Mimes.text,\n\t\t\t\tcellKind,\n\t\t\t\toutputs,\n\t\t\t\tmetadata: undefined,\n\t\t\t\tinternalMetadata: undefined,\n\t\t\t\tcollapseState: undefined\n\t\t\t},\n\t\t\t{ transientCellMetadata: {}, transientDocumentMetadata: {}, transientOutputs: false, cellContentMetadata: {} },\n\t\t\tlanguageService,\n\t\t\tDefaultEndOfLine.LF,\n\t\t\tundefined, // defaultCollapseConfig\n\t\t\tundefined,  // languageDetectionService\n\t\t\tnew NullNotebookLoggingService()\n\t\t);\n\t}\n}\n\nexport class NotebookEditorTestModel extends EditorModel implements INotebookEditorModel {\n\tprivate _dirty = false;\n\n\tprotected readonly _onDidSave = this._register(new Emitter<IWorkingCopySaveEvent>());\n\treadonly onDidSave = this._onDidSave.event;\n\n\tprotected readonly _onDidChangeDirty = this._register(new Emitter<void>());\n\treadonly onDidChangeDirty = this._onDidChangeDirty.event;\n\n\treadonly onDidChangeOrphaned = Event.None;\n\treadonly onDidChangeReadonly = Event.None;\n\treadonly onDidRevertUntitled = Event.None;\n\n\tprivate readonly _onDidChangeContent = this._register(new Emitter<void>());\n\treadonly onDidChangeContent: Event<void> = this._onDidChangeContent.event;\n\n\n\tget viewType() {\n\t\treturn this._notebook.viewType;\n\t}\n\n\tget resource() {\n\t\treturn this._notebook.uri;\n\t}\n\n\tget notebook(): NotebookTextModel {\n\t\treturn this._notebook;\n\t}\n\n\tconstructor(\n\t\tprivate _notebook: NotebookTextModel\n\t) {\n\t\tsuper();\n\n\t\tif (_notebook && _notebook.onDidChangeContent) {\n\t\t\tthis._register(_notebook.onDidChangeContent(() => {\n\t\t\t\tthis._dirty = true;\n\t\t\t\tthis._onDidChangeDirty.fire();\n\t\t\t\tthis._onDidChangeContent.fire();\n\t\t\t}));\n\t\t}\n\t}\n\n\tisReadonly(): boolean {\n\t\treturn false;\n\t}\n\n\tisOrphaned(): boolean {\n\t\treturn false;\n\t}\n\n\thasAssociatedFilePath(): boolean {\n\t\treturn false;\n\t}\n\n\tisDirty() {\n\t\treturn this._dirty;\n\t}\n\n\tget hasErrorState() {\n\t\treturn false;\n\t}\n\n\tisModified(): boolean {\n\t\treturn this._dirty;\n\t}\n\n\tgetNotebook(): NotebookTextModel {\n\t\treturn this._notebook;\n\t}\n\n\tasync load(): Promise<IResolvedNotebookEditorModel> {\n\t\treturn this;\n\t}\n\n\tasync save(): Promise<boolean> {\n\t\tif (this._notebook) {\n\t\t\tthis._dirty = false;\n\t\t\tthis._onDidChangeDirty.fire();\n\t\t\tthis._onDidSave.fire({});\n\t\t\t// todo, flush all states\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsaveAs(): Promise<EditorInput | undefined> {\n\t\tthrow new NotImplementedError();\n\t}\n\n\trevert(): Promise<void> {\n\t\tthrow new NotImplementedError();\n\t}\n}\n\nexport function setupInstantiationService(disposables: Pick<DisposableStore, 'add'>) {\n\tconst instantiationService = disposables.add(new TestInstantiationService());\n\tconst testThemeService = new TestThemeService();\n\tinstantiationService.stub(ILanguageService, disposables.add(new LanguageService()));\n\tinstantiationService.stub(IUndoRedoService, instantiationService.createInstance(UndoRedoService));\n\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\tinstantiationService.stub(IThemeService, testThemeService);\n\tinstantiationService.stub(ILanguageConfigurationService, disposables.add(new TestLanguageConfigurationService()));\n\tinstantiationService.stub(ITextResourcePropertiesService, instantiationService.createInstance(TestTextResourcePropertiesService));\n\tinstantiationService.stub(IModelService, disposables.add(instantiationService.createInstance(ModelService)));\n\tinstantiationService.stub(ITextModelService, <ITextModelService>disposables.add(instantiationService.createInstance(TextModelResolverService)));\n\tinstantiationService.stub(IContextKeyService, disposables.add(instantiationService.createInstance(ContextKeyService)));\n\tinstantiationService.stub(IListService, disposables.add(instantiationService.createInstance(ListService)));\n\tinstantiationService.stub(ILayoutService, new TestLayoutService());\n\tinstantiationService.stub(ILogService, new NullLogService());\n\tinstantiationService.stub(IClipboardService, TestClipboardService);\n\tinstantiationService.stub(IStorageService, disposables.add(new TestStorageService()));\n\tinstantiationService.stub(IWorkspaceTrustRequestService, disposables.add(new TestWorkspaceTrustRequestService(true)));\n\tinstantiationService.stub(INotebookExecutionStateService, new TestNotebookExecutionStateService());\n\tinstantiationService.stub(IKeybindingService, new MockKeybindingService());\n\tinstantiationService.stub(INotebookCellStatusBarService, disposables.add(new NotebookCellStatusBarService()));\n\tinstantiationService.stub(ICodeEditorService, disposables.add(new TestCodeEditorService(testThemeService)));\n\tinstantiationService.stub(IOutlineService, new class extends mock<IOutlineService>() { override registerOutlineCreator() { return { dispose() { } }; } });\n\tinstantiationService.stub(INotebookCellOutlineDataSourceFactory, instantiationService.createInstance(NotebookCellOutlineDataSourceFactory));\n\tinstantiationService.stub(INotebookOutlineEntryFactory, instantiationService.createInstance(NotebookOutlineEntryFactory));\n\tinstantiationService.stub(INotebookLoggingService, new NullNotebookLoggingService());\n\n\tinstantiationService.stub(ILanguageDetectionService, new class MockLanguageDetectionService implements ILanguageDetectionService {\n\t\t_serviceBrand: undefined;\n\t\tisEnabledForLanguage(languageId: string): boolean {\n\t\t\treturn false;\n\t\t}\n\t\tasync detectLanguage(resource: URI, supportedLangs?: string[] | undefined): Promise<string | undefined> {\n\t\t\treturn undefined;\n\t\t}\n\t});\n\n\treturn instantiationService;\n}\n\nfunction _createTestNotebookEditor(instantiationService: TestInstantiationService, disposables: DisposableStore, cells: MockNotebookCell[]): { editor: IActiveNotebookEditorDelegate; viewModel: NotebookViewModel } {\n\n\tconst viewType = 'notebook';\n\tconst notebook = disposables.add(instantiationService.createInstance(NotebookTextModel, viewType, URI.parse('test://test'), cells.map((cell): ICellDto2 => {\n\t\treturn {\n\t\t\tsource: cell[0],\n\t\t\tmime: undefined,\n\t\t\tlanguage: cell[1],\n\t\t\tcellKind: cell[2],\n\t\t\toutputs: cell[3] ?? [],\n\t\t\tmetadata: cell[4]\n\t\t};\n\t}), {}, { transientCellMetadata: {}, transientDocumentMetadata: {}, cellContentMetadata: {}, transientOutputs: false }));\n\n\tconst model = disposables.add(new NotebookEditorTestModel(notebook));\n\tconst notebookOptions = disposables.add(new NotebookOptions(mainWindow, false, undefined, instantiationService.get(IConfigurationService), instantiationService.get(INotebookExecutionStateService), instantiationService.get(ICodeEditorService)));\n\tconst baseCellEditorOptions = new class extends mock<IBaseCellEditorOptions>() { };\n\tconst viewContext = new ViewContext(notebookOptions, disposables.add(new NotebookEventDispatcher()), () => baseCellEditorOptions);\n\tconst viewModel: NotebookViewModel = disposables.add(instantiationService.createInstance(NotebookViewModel, viewType, model.notebook, viewContext, null, { isReadOnly: false }));\n\n\tconst cellList = disposables.add(createNotebookCellList(instantiationService, disposables, viewContext));\n\tcellList.attachViewModel(viewModel);\n\tconst listViewInfoAccessor = disposables.add(new ListViewInfoAccessor(cellList));\n\n\tlet visibleRanges: ICellRange[] = [{ start: 0, end: 100 }];\n\n\tconst id = Date.now().toString();\n\tconst notebookEditor: IActiveNotebookEditorDelegate = new class extends mock<IActiveNotebookEditorDelegate>() {\n\t\t// eslint-disable-next-line local/code-must-use-super-dispose\n\t\toverride dispose() {\n\t\t\tviewModel.dispose();\n\t\t}\n\t\toverride notebookOptions = notebookOptions;\n\t\toverride onDidChangeModel: Event<NotebookTextModel | undefined> = new Emitter<NotebookTextModel | undefined>().event;\n\t\toverride onDidChangeCellState: Event<NotebookCellStateChangedEvent> = new Emitter<NotebookCellStateChangedEvent>().event;\n\t\toverride getViewModel(): NotebookViewModel {\n\t\t\treturn viewModel;\n\t\t}\n\t\toverride textModel = viewModel.notebookDocument;\n\t\toverride hasModel(): this is IActiveNotebookEditorDelegate {\n\t\t\treturn !!viewModel;\n\t\t}\n\t\toverride getLength() { return viewModel.length; }\n\t\toverride getFocus() { return viewModel.getFocus(); }\n\t\toverride getSelections() { return viewModel.getSelections(); }\n\t\toverride setFocus(focus: ICellRange) {\n\t\t\tviewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: focus,\n\t\t\t\tselections: viewModel.getSelections()\n\t\t\t});\n\t\t}\n\t\toverride setSelections(selections: ICellRange[]) {\n\t\t\tviewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: viewModel.getFocus(),\n\t\t\t\tselections: selections\n\t\t\t});\n\t\t}\n\t\toverride getViewIndexByModelIndex(index: number) { return listViewInfoAccessor.getViewIndex(viewModel.viewCells[index]); }\n\t\toverride getCellRangeFromViewRange(startIndex: number, endIndex: number) { return listViewInfoAccessor.getCellRangeFromViewRange(startIndex, endIndex); }\n\t\toverride revealCellRangeInView() { }\n\t\toverride async revealInView() { }\n\t\toverride setHiddenAreas(_ranges: ICellRange[]): boolean {\n\t\t\treturn cellList.setHiddenAreas(_ranges, true);\n\t\t}\n\t\toverride getActiveCell() {\n\t\t\tconst elements = cellList.getFocusedElements();\n\n\t\t\tif (elements && elements.length) {\n\t\t\t\treturn elements[0];\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t\toverride hasOutputTextSelection() {\n\t\t\treturn false;\n\t\t}\n\t\toverride changeModelDecorations() { return null; }\n\t\toverride focusElement() { }\n\t\toverride setCellEditorSelection() { }\n\t\toverride async revealRangeInCenterIfOutsideViewportAsync() { }\n\t\toverride async layoutNotebookCell() { }\n\t\toverride async createOutput() { }\n\t\toverride async removeInset() { }\n\t\toverride async focusNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output') {\n\t\t\tcell.focusMode = focusItem === 'editor' ? CellFocusMode.Editor\n\t\t\t\t: focusItem === 'output' ? CellFocusMode.Output\n\t\t\t\t\t: CellFocusMode.Container;\n\t\t}\n\t\toverride cellAt(index: number) { return viewModel.cellAt(index)!; }\n\t\toverride getCellIndex(cell: ICellViewModel) { return viewModel.getCellIndex(cell); }\n\t\toverride getCellsInRange(range?: ICellRange) { return viewModel.getCellsInRange(range); }\n\t\toverride getCellByHandle(handle: number) { return viewModel.getCellByHandle(handle); }\n\t\toverride getNextVisibleCellIndex(index: number) { return viewModel.getNextVisibleCellIndex(index); }\n\t\tgetControl() { return this; }\n\t\toverride get onDidChangeSelection() { return viewModel.onDidChangeSelection as Event<any>; }\n\t\toverride get onDidChangeOptions() { return viewModel.onDidChangeOptions; }\n\t\toverride get onDidChangeViewCells() { return viewModel.onDidChangeViewCells; }\n\t\toverride async find(query: string, options: INotebookFindOptions): Promise<CellFindMatchWithIndex[]> {\n\t\t\tconst findMatches = viewModel.find(query, options).filter(match => match.length > 0);\n\t\t\treturn findMatches;\n\t\t}\n\t\toverride deltaCellDecorations() { return []; }\n\t\toverride onDidChangeVisibleRanges = Event.None;\n\n\t\toverride get visibleRanges() {\n\t\t\treturn visibleRanges;\n\t\t}\n\n\t\toverride set visibleRanges(_ranges: ICellRange[]) {\n\t\t\tvisibleRanges = _ranges;\n\t\t}\n\n\t\toverride getId(): string { return id; }\n\t\toverride setScrollTop(scrollTop: number): void {\n\t\t\tcellList.scrollTop = scrollTop;\n\t\t}\n\t\toverride get scrollTop(): number {\n\t\t\treturn cellList.scrollTop;\n\t\t}\n\t\toverride getLayoutInfo(): NotebookLayoutInfo {\n\t\t\treturn {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tscrollHeight: cellList.getScrollHeight(),\n\t\t\t\tfontInfo: new FontInfo({\n\t\t\t\t\tpixelRatio: 1,\n\t\t\t\t\tfontFamily: 'mockFont',\n\t\t\t\t\tfontWeight: 'normal',\n\t\t\t\t\tfontSize: 14,\n\t\t\t\t\tfontFeatureSettings: EditorFontLigatures.OFF,\n\t\t\t\t\tfontVariationSettings: EditorFontVariations.OFF,\n\t\t\t\t\tlineHeight: 19,\n\t\t\t\t\tletterSpacing: 1.5,\n\t\t\t\t\tisMonospace: true,\n\t\t\t\t\ttypicalHalfwidthCharacterWidth: 10,\n\t\t\t\t\ttypicalFullwidthCharacterWidth: 20,\n\t\t\t\t\tcanUseHalfwidthRightwardsArrow: true,\n\t\t\t\t\tspaceWidth: 10,\n\t\t\t\t\tmiddotWidth: 10,\n\t\t\t\t\twsmiddotWidth: 10,\n\t\t\t\t\tmaxDigitWidth: 10,\n\t\t\t\t}, true),\n\t\t\t\tstickyHeight: 0,\n\t\t\t\tlistViewOffsetTop: 0,\n\t\t\t};\n\t\t}\n\t};\n\n\treturn { editor: notebookEditor, viewModel };\n}\n\nexport function createTestNotebookEditor(instantiationService: TestInstantiationService, disposables: DisposableStore, cells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][]): { editor: INotebookEditorDelegate; viewModel: NotebookViewModel } {\n\treturn _createTestNotebookEditor(instantiationService, disposables, cells);\n}\n\nexport async function withTestNotebookDiffModel<R = any>(originalCells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][], modifiedCells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][], callback: (diffModel: INotebookDiffEditorModel, disposables: DisposableStore, accessor: TestInstantiationService) => Promise<R> | R): Promise<R> {\n\tconst disposables = new DisposableStore();\n\tconst instantiationService = setupInstantiationService(disposables);\n\tconst originalNotebook = createTestNotebookEditor(instantiationService, disposables, originalCells);\n\tconst modifiedNotebook = createTestNotebookEditor(instantiationService, disposables, modifiedCells);\n\tconst originalResource = new class extends mock<IResolvedNotebookEditorModel>() {\n\t\toverride get notebook() {\n\t\t\treturn originalNotebook.viewModel.notebookDocument;\n\t\t}\n\t\toverride get resource() {\n\t\t\treturn originalNotebook.viewModel.notebookDocument.uri;\n\t\t}\n\t};\n\n\tconst modifiedResource = new class extends mock<IResolvedNotebookEditorModel>() {\n\t\toverride get notebook() {\n\t\t\treturn modifiedNotebook.viewModel.notebookDocument;\n\t\t}\n\t\toverride get resource() {\n\t\t\treturn modifiedNotebook.viewModel.notebookDocument.uri;\n\t\t}\n\t};\n\n\tconst model = new class extends mock<INotebookDiffEditorModel>() {\n\t\toverride get original() {\n\t\t\treturn originalResource;\n\t\t}\n\t\toverride get modified() {\n\t\t\treturn modifiedResource;\n\t\t}\n\t};\n\n\tconst res = await callback(model, disposables, instantiationService);\n\tif (res instanceof Promise) {\n\t\tres.finally(() => {\n\t\t\toriginalNotebook.editor.dispose();\n\t\t\toriginalNotebook.viewModel.notebookDocument.dispose();\n\t\t\toriginalNotebook.viewModel.dispose();\n\t\t\tmodifiedNotebook.editor.dispose();\n\t\t\tmodifiedNotebook.viewModel.notebookDocument.dispose();\n\t\t\tmodifiedNotebook.viewModel.dispose();\n\t\t\tdisposables.dispose();\n\t\t});\n\t} else {\n\t\toriginalNotebook.editor.dispose();\n\t\toriginalNotebook.viewModel.notebookDocument.dispose();\n\t\toriginalNotebook.viewModel.dispose();\n\t\tmodifiedNotebook.editor.dispose();\n\t\tmodifiedNotebook.viewModel.notebookDocument.dispose();\n\t\tmodifiedNotebook.viewModel.dispose();\n\t\tdisposables.dispose();\n\t}\n\treturn res;\n}\n\ninterface IActiveTestNotebookEditorDelegate extends IActiveNotebookEditorDelegate {\n\tvisibleRanges: ICellRange[];\n}\n\nexport type MockNotebookCell = [\n\tsource: string,\n\tlang: string,\n\tkind: CellKind,\n\toutput?: IOutputDto[],\n\tmetadata?: NotebookCellMetadata,\n];\n\nexport type MockDocumentSymbol = {\n\tname: string;\n\trange: {};\n\tkind?: number;\n\tchildren?: MockDocumentSymbol[];\n};\n\nexport async function withTestNotebook<R = any>(cells: MockNotebookCell[], callback: (editor: IActiveTestNotebookEditorDelegate, viewModel: NotebookViewModel, disposables: DisposableStore, accessor: TestInstantiationService) => Promise<R> | R, accessor?: TestInstantiationService): Promise<R> {\n\tconst disposables: DisposableStore = new DisposableStore();\n\tconst instantiationService = accessor ?? setupInstantiationService(disposables);\n\tconst notebookEditor = _createTestNotebookEditor(instantiationService, disposables, cells);\n\n\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst res = await callback(notebookEditor.editor, notebookEditor.viewModel, disposables, instantiationService);\n\t\tif (res instanceof Promise) {\n\t\t\tres.finally(() => {\n\t\t\t\tnotebookEditor.editor.dispose();\n\t\t\t\tnotebookEditor.viewModel.dispose();\n\t\t\t\tnotebookEditor.editor.textModel.dispose();\n\t\t\t\tdisposables.dispose();\n\t\t\t});\n\t\t} else {\n\t\t\tnotebookEditor.editor.dispose();\n\t\t\tnotebookEditor.viewModel.dispose();\n\t\t\tnotebookEditor.editor.textModel.dispose();\n\t\t\tdisposables.dispose();\n\t\t}\n\t\treturn res;\n\t});\n}\n\nexport function createNotebookCellList(instantiationService: TestInstantiationService, disposables: Pick<DisposableStore, 'add'>, viewContext?: ViewContext) {\n\tconst delegate: IListVirtualDelegate<CellViewModel> = {\n\t\tgetHeight(element: CellViewModel) { return element.getHeight(17); },\n\t\tgetTemplateId() { return 'template'; }\n\t};\n\n\tconst baseCellRenderTemplate = new class extends mock<BaseCellRenderTemplate>() { };\n\tconst renderer: IListRenderer<CellViewModel, BaseCellRenderTemplate> = {\n\t\ttemplateId: 'template',\n\t\trenderTemplate() { return baseCellRenderTemplate; },\n\t\trenderElement() { },\n\t\tdisposeTemplate() { }\n\t};\n\n\tconst notebookOptions = !!viewContext ? viewContext.notebookOptions\n\t\t: disposables.add(new NotebookOptions(mainWindow, false, undefined, instantiationService.get(IConfigurationService), instantiationService.get(INotebookExecutionStateService), instantiationService.get(ICodeEditorService)));\n\tconst cellList: NotebookCellList = disposables.add(instantiationService.createInstance(\n\t\tNotebookCellList,\n\t\t'NotebookCellList',\n\t\tDOM.$('container'),\n\t\tnotebookOptions,\n\t\tdelegate,\n\t\t[renderer],\n\t\tinstantiationService.get<IContextKeyService>(IContextKeyService),\n\t\t{\n\t\t\tsupportDynamicHeights: true,\n\t\t\tmultipleSelectionSupport: true,\n\t\t}\n\t));\n\n\treturn cellList;\n}\n\nexport function valueBytesFromString(value: string): VSBuffer {\n\treturn VSBuffer.fromString(value);\n}\n\nclass TestCellExecution implements INotebookCellExecution {\n\tconstructor(\n\t\treadonly notebook: URI,\n\t\treadonly cellHandle: number,\n\t\tprivate onComplete: () => void,\n\t) { }\n\n\treadonly state: NotebookCellExecutionState = NotebookCellExecutionState.Unconfirmed;\n\n\treadonly didPause: boolean = false;\n\treadonly isPaused: boolean = false;\n\n\tconfirm(): void {\n\t}\n\n\tupdate(updates: ICellExecuteUpdate[]): void {\n\t}\n\n\tcomplete(complete: ICellExecutionComplete): void {\n\t\tthis.onComplete();\n\t}\n}\n\nexport class TestNotebookExecutionStateService implements INotebookExecutionStateService {\n\t_serviceBrand: undefined;\n\n\tprivate _executions = new ResourceMap<INotebookCellExecution>();\n\n\tonDidChangeExecution = new Emitter<ICellExecutionStateChangedEvent | IExecutionStateChangedEvent>().event;\n\tonDidChangeLastRunFailState = new Emitter<INotebookFailStateChangedEvent>().event;\n\n\tforceCancelNotebookExecutions(notebookUri: URI): void {\n\t}\n\n\tgetCellExecutionsForNotebook(notebook: URI): INotebookCellExecution[] {\n\t\treturn [];\n\t}\n\n\tgetCellExecution(cellUri: URI): INotebookCellExecution | undefined {\n\t\treturn this._executions.get(cellUri);\n\t}\n\n\tcreateCellExecution(notebook: URI, cellHandle: number): INotebookCellExecution {\n\t\tconst onComplete = () => this._executions.delete(CellUri.generate(notebook, cellHandle));\n\t\tconst exe = new TestCellExecution(notebook, cellHandle, onComplete);\n\t\tthis._executions.set(CellUri.generate(notebook, cellHandle), exe);\n\t\treturn exe;\n\t}\n\n\tgetCellExecutionsByHandleForNotebook(notebook: URI): Map<number, INotebookCellExecution> | undefined {\n\t\treturn;\n\t}\n\n\tgetLastFailedCellForNotebook(notebook: URI): number | undefined {\n\t\treturn;\n\t}\n\tgetLastCompletedCellForNotebook(notebook: URI): number | undefined {\n\t\treturn;\n\t}\n\tgetExecution(notebook: URI): INotebookExecution | undefined {\n\t\treturn;\n\t}\n\tcreateExecution(notebook: URI): INotebookExecution {\n\t\tthrow new Error('Method not implemented.');\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from '../../../../../base/browser/dom.js';\nimport { IListRenderer, IListVirtualDelegate } from '../../../../../base/browser/ui/list/list.js';\nimport { VSBuffer } from '../../../../../base/common/buffer.js';\nimport { NotImplementedError } from '../../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../../base/common/map.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { LanguageService } from '../../../../../editor/common/services/languageService.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ModelService } from '../../../../../editor/common/services/modelService.js';\nimport { ITextModelService } from '../../../../../editor/common/services/resolverService.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { TestClipboardService } from '../../../../../platform/clipboard/test/common/testClipboardService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ContextKeyService } from '../../../../../platform/contextkey/browser/contextKeyService.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { MockKeybindingService } from '../../../../../platform/keybinding/test/common/mockKeybindingService.js';\nimport { ILayoutService } from '../../../../../platform/layout/browser/layoutService.js';\nimport { IListService, ListService } from '../../../../../platform/list/browser/listService.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { TestThemeService } from '../../../../../platform/theme/test/common/testThemeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../../platform/undoRedo/common/undoRedoService.js';\nimport { IWorkspaceTrustRequestService } from '../../../../../platform/workspace/common/workspaceTrust.js';\nimport { EditorInput } from '../../../../common/editor/editorInput.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { CellFindMatchWithIndex, CellFocusMode, IActiveNotebookEditorDelegate, IBaseCellEditorOptions, ICellViewModel, INotebookEditorDelegate } from '../../browser/notebookBrowser.js';\nimport { NotebookCellStateChangedEvent, NotebookLayoutInfo } from '../../browser/notebookViewEvents.js';\nimport { NotebookCellStatusBarService } from '../../browser/services/notebookCellStatusBarServiceImpl.js';\nimport { ListViewInfoAccessor, NotebookCellList } from '../../browser/view/notebookCellList.js';\nimport { BaseCellRenderTemplate } from '../../browser/view/notebookRenderingCommon.js';\nimport { NotebookEventDispatcher } from '../../browser/viewModel/eventDispatcher.js';\nimport { CellViewModel, NotebookViewModel } from '../../browser/viewModel/notebookViewModelImpl.js';\nimport { ViewContext } from '../../browser/viewModel/viewContext.js';\nimport { NotebookCellTextModel } from '../../common/model/notebookCellTextModel.js';\nimport { NotebookTextModel } from '../../common/model/notebookTextModel.js';\nimport { INotebookCellStatusBarService } from '../../common/notebookCellStatusBarService.js';\nimport { CellKind, CellUri, ICellDto2, INotebookDiffEditorModel, INotebookEditorModel, INotebookFindOptions, IOutputDto, IResolvedNotebookEditorModel, NotebookCellExecutionState, NotebookCellMetadata, SelectionStateType } from '../../common/notebookCommon.js';\nimport { ICellExecuteUpdate, ICellExecutionComplete, ICellExecutionStateChangedEvent, IExecutionStateChangedEvent, INotebookCellExecution, INotebookExecution, INotebookExecutionStateService, INotebookFailStateChangedEvent } from '../../common/notebookExecutionStateService.js';\nimport { NotebookOptions } from '../../browser/notebookOptions.js';\nimport { ICellRange } from '../../common/notebookRange.js';\nimport { TextModelResolverService } from '../../../../services/textmodelResolver/common/textModelResolverService.js';\nimport { IWorkingCopySaveEvent } from '../../../../services/workingCopy/common/workingCopy.js';\nimport { TestLayoutService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestStorageService, TestTextResourcePropertiesService, TestWorkspaceTrustRequestService } from '../../../../test/common/workbenchTestServices.js';\nimport { FontInfo } from '../../../../../editor/common/config/fontInfo.js';\nimport { EditorFontLigatures, EditorFontVariations } from '../../../../../editor/common/config/editorOptions.js';\nimport { ICodeEditorService } from '../../../../../editor/browser/services/codeEditorService.js';\nimport { mainWindow } from '../../../../../base/browser/window.js';\nimport { TestCodeEditorService } from '../../../../../editor/test/browser/editorTestServices.js';\nimport { INotebookCellOutlineDataSourceFactory, NotebookCellOutlineDataSourceFactory } from '../../browser/viewModel/notebookOutlineDataSourceFactory.js';\nimport { ILanguageDetectionService } from '../../../../services/languageDetection/common/languageDetectionWorkerService.js';\nimport { INotebookOutlineEntryFactory, NotebookOutlineEntryFactory } from '../../browser/viewModel/notebookOutlineEntryFactory.js';\nimport { IOutlineService } from '../../../../services/outline/browser/outline.js';\nimport { DefaultEndOfLine } from '../../../../../editor/common/model.js';\nimport { ITextResourcePropertiesService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { INotebookLoggingService } from '../../common/notebookLoggingService.js';\n\nclass NullNotebookLoggingService implements INotebookLoggingService {\n\t_serviceBrand: undefined;\n\tinfo(category: string, output: string): void { }\n\twarn(category: string, output: string): void { }\n\terror(category: string, output: string): void { }\n\tdebug(category: string, output: string): void { }\n\ttrace(category: string, message: string): void { }\n}\n\nexport class TestCell extends NotebookCellTextModel {\n\tconstructor(\n\t\tpublic viewType: string,\n\t\thandle: number,\n\t\tpublic source: string,\n\t\tlanguage: string,\n\t\tcellKind: CellKind,\n\t\toutputs: IOutputDto[],\n\t\tlanguageService: ILanguageService,\n\t) {\n\t\tsuper(\n\t\t\tCellUri.generate(URI.parse('test:///fake/notebook'), handle),\n\t\t\thandle,\n\t\t\t{\n\t\t\t\tsource,\n\t\t\t\tlanguage,\n\t\t\t\tmime: Mimes.text,\n\t\t\t\tcellKind,\n\t\t\t\toutputs,\n\t\t\t\tmetadata: undefined,\n\t\t\t\tinternalMetadata: undefined,\n\t\t\t\tcollapseState: undefined\n\t\t\t},\n\t\t\t{ transientCellMetadata: {}, transientDocumentMetadata: {}, transientOutputs: false, cellContentMetadata: {} },\n\t\t\tlanguageService,\n\t\t\tDefaultEndOfLine.LF,\n\t\t\tundefined, // defaultCollapseConfig\n\t\t\tundefined,  // languageDetectionService\n\t\t\tnew NullNotebookLoggingService()\n\t\t);\n\t}\n}\n\nexport class NotebookEditorTestModel extends EditorModel implements INotebookEditorModel {\n\tprivate _dirty = false;\n\n\tprotected readonly _onDidSave = this._register(new Emitter<IWorkingCopySaveEvent>());\n\treadonly onDidSave = this._onDidSave.event;\n\n\tprotected readonly _onDidChangeDirty = this._register(new Emitter<void>());\n\treadonly onDidChangeDirty = this._onDidChangeDirty.event;\n\n\treadonly onDidChangeOrphaned = Event.None;\n\treadonly onDidChangeReadonly = Event.None;\n\treadonly onDidRevertUntitled = Event.None;\n\n\tprivate readonly _onDidChangeContent = this._register(new Emitter<void>());\n\treadonly onDidChangeContent: Event<void> = this._onDidChangeContent.event;\n\n\n\tget viewType() {\n\t\treturn this._notebook.viewType;\n\t}\n\n\tget resource() {\n\t\treturn this._notebook.uri;\n\t}\n\n\tget notebook(): NotebookTextModel {\n\t\treturn this._notebook;\n\t}\n\n\tconstructor(\n\t\tprivate _notebook: NotebookTextModel\n\t) {\n\t\tsuper();\n\n\t\tif (_notebook && _notebook.onDidChangeContent) {\n\t\t\tthis._register(_notebook.onDidChangeContent(() => {\n\t\t\t\tthis._dirty = true;\n\t\t\t\tthis._onDidChangeDirty.fire();\n\t\t\t\tthis._onDidChangeContent.fire();\n\t\t\t}));\n\t\t}\n\t}\n\n\tisReadonly(): boolean {\n\t\treturn false;\n\t}\n\n\tisOrphaned(): boolean {\n\t\treturn false;\n\t}\n\n\thasAssociatedFilePath(): boolean {\n\t\treturn false;\n\t}\n\n\tisDirty() {\n\t\treturn this._dirty;\n\t}\n\n\tget hasErrorState() {\n\t\treturn false;\n\t}\n\n\tisModified(): boolean {\n\t\treturn this._dirty;\n\t}\n\n\tgetNotebook(): NotebookTextModel {\n\t\treturn this._notebook;\n\t}\n\n\tasync load(): Promise<IResolvedNotebookEditorModel> {\n\t\treturn this;\n\t}\n\n\tasync save(): Promise<boolean> {\n\t\tif (this._notebook) {\n\t\t\tthis._dirty = false;\n\t\t\tthis._onDidChangeDirty.fire();\n\t\t\tthis._onDidSave.fire({});\n\t\t\t// todo, flush all states\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsaveAs(): Promise<EditorInput | undefined> {\n\t\tthrow new NotImplementedError();\n\t}\n\n\trevert(): Promise<void> {\n\t\tthrow new NotImplementedError();\n\t}\n}\n\nexport function setupInstantiationService(disposables: Pick<DisposableStore, 'add'>) {\n\tconst instantiationService = disposables.add(new TestInstantiationService());\n\tconst testThemeService = new TestThemeService();\n\tinstantiationService.stub(ILanguageService, disposables.add(new LanguageService()));\n\tinstantiationService.stub(IUndoRedoService, instantiationService.createInstance(UndoRedoService));\n\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\tinstantiationService.stub(IThemeService, testThemeService);\n\tinstantiationService.stub(ILanguageConfigurationService, disposables.add(new TestLanguageConfigurationService()));\n\tinstantiationService.stub(ITextResourcePropertiesService, instantiationService.createInstance(TestTextResourcePropertiesService));\n\tinstantiationService.stub(IModelService, disposables.add(instantiationService.createInstance(ModelService)));\n\tinstantiationService.stub(ITextModelService, <ITextModelService>disposables.add(instantiationService.createInstance(TextModelResolverService)));\n\tinstantiationService.stub(IContextKeyService, disposables.add(instantiationService.createInstance(ContextKeyService)));\n\tinstantiationService.stub(IListService, disposables.add(instantiationService.createInstance(ListService)));\n\tinstantiationService.stub(ILayoutService, new TestLayoutService());\n\tinstantiationService.stub(ILogService, new NullLogService());\n\tinstantiationService.stub(IClipboardService, TestClipboardService);\n\tinstantiationService.stub(IStorageService, disposables.add(new TestStorageService()));\n\tinstantiationService.stub(IWorkspaceTrustRequestService, disposables.add(new TestWorkspaceTrustRequestService(true)));\n\tinstantiationService.stub(INotebookExecutionStateService, new TestNotebookExecutionStateService());\n\tinstantiationService.stub(IKeybindingService, new MockKeybindingService());\n\tinstantiationService.stub(INotebookCellStatusBarService, disposables.add(new NotebookCellStatusBarService()));\n\tinstantiationService.stub(ICodeEditorService, disposables.add(new TestCodeEditorService(testThemeService)));\n\tinstantiationService.stub(IOutlineService, new class extends mock<IOutlineService>() { override registerOutlineCreator() { return { dispose() { } }; } });\n\tinstantiationService.stub(INotebookCellOutlineDataSourceFactory, instantiationService.createInstance(NotebookCellOutlineDataSourceFactory));\n\tinstantiationService.stub(INotebookOutlineEntryFactory, instantiationService.createInstance(NotebookOutlineEntryFactory));\n\tinstantiationService.stub(INotebookLoggingService, new NullNotebookLoggingService());\n\n\tinstantiationService.stub(ILanguageDetectionService, new class MockLanguageDetectionService implements ILanguageDetectionService {\n\t\t_serviceBrand: undefined;\n\t\tisEnabledForLanguage(languageId: string): boolean {\n\t\t\treturn false;\n\t\t}\n\t\tasync detectLanguage(resource: URI, supportedLangs?: string[] | undefined): Promise<string | undefined> {\n\t\t\treturn undefined;\n\t\t}\n\t});\n\n\treturn instantiationService;\n}\n\nfunction _createTestNotebookEditor(instantiationService: TestInstantiationService, disposables: DisposableStore, cells: MockNotebookCell[]): { editor: IActiveNotebookEditorDelegate; viewModel: NotebookViewModel } {\n\n\tconst viewType = 'notebook';\n\tconst notebook = disposables.add(instantiationService.createInstance(NotebookTextModel, viewType, URI.parse('test://test'), cells.map((cell): ICellDto2 => {\n\t\treturn {\n\t\t\tsource: cell[0],\n\t\t\tmime: undefined,\n\t\t\tlanguage: cell[1],\n\t\t\tcellKind: cell[2],\n\t\t\toutputs: cell[3] ?? [],\n\t\t\tmetadata: cell[4]\n\t\t};\n\t}), {}, { transientCellMetadata: {}, transientDocumentMetadata: {}, cellContentMetadata: {}, transientOutputs: false }));\n\n\tconst model = disposables.add(new NotebookEditorTestModel(notebook));\n\tconst notebookOptions = disposables.add(new NotebookOptions(mainWindow, false, undefined, instantiationService.get(IConfigurationService), instantiationService.get(INotebookExecutionStateService), instantiationService.get(ICodeEditorService)));\n\tconst baseCellEditorOptions = new class extends mock<IBaseCellEditorOptions>() { };\n\tconst viewContext = new ViewContext(notebookOptions, disposables.add(new NotebookEventDispatcher()), () => baseCellEditorOptions);\n\tconst viewModel: NotebookViewModel = disposables.add(instantiationService.createInstance(NotebookViewModel, viewType, model.notebook, viewContext, null, { isReadOnly: false }));\n\n\tconst cellList = disposables.add(createNotebookCellList(instantiationService, disposables, viewContext));\n\tcellList.attachViewModel(viewModel);\n\tconst listViewInfoAccessor = disposables.add(new ListViewInfoAccessor(cellList));\n\n\tlet visibleRanges: ICellRange[] = [{ start: 0, end: 100 }];\n\n\tconst id = Date.now().toString();\n\tconst notebookEditor: IActiveNotebookEditorDelegate = new class extends mock<IActiveNotebookEditorDelegate>() {\n\t\t// eslint-disable-next-line local/code-must-use-super-dispose\n\t\toverride dispose() {\n\t\t\tviewModel.dispose();\n\t\t}\n\t\toverride notebookOptions = notebookOptions;\n\t\toverride onDidChangeModel: Event<NotebookTextModel | undefined> = new Emitter<NotebookTextModel | undefined>().event;\n\t\toverride onDidChangeCellState: Event<NotebookCellStateChangedEvent> = new Emitter<NotebookCellStateChangedEvent>().event;\n\t\toverride getViewModel(): NotebookViewModel {\n\t\t\treturn viewModel;\n\t\t}\n\t\toverride textModel = viewModel.notebookDocument;\n\t\toverride hasModel(): this is IActiveNotebookEditorDelegate {\n\t\t\treturn !!viewModel;\n\t\t}\n\t\toverride getLength() { return viewModel.length; }\n\t\toverride getFocus() { return viewModel.getFocus(); }\n\t\toverride getSelections() { return viewModel.getSelections(); }\n\t\toverride setFocus(focus: ICellRange) {\n\t\t\tviewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: focus,\n\t\t\t\tselections: viewModel.getSelections()\n\t\t\t});\n\t\t}\n\t\toverride setSelections(selections: ICellRange[]) {\n\t\t\tviewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: viewModel.getFocus(),\n\t\t\t\tselections: selections\n\t\t\t});\n\t\t}\n\t\toverride getViewIndexByModelIndex(index: number) { return listViewInfoAccessor.getViewIndex(viewModel.viewCells[index]); }\n\t\toverride getCellRangeFromViewRange(startIndex: number, endIndex: number) { return listViewInfoAccessor.getCellRangeFromViewRange(startIndex, endIndex); }\n\t\toverride revealCellRangeInView() { }\n\t\toverride async revealInView() { }\n\t\toverride setHiddenAreas(_ranges: ICellRange[]): boolean {\n\t\t\treturn cellList.setHiddenAreas(_ranges, true);\n\t\t}\n\t\toverride getActiveCell() {\n\t\t\tconst elements = cellList.getFocusedElements();\n\n\t\t\tif (elements && elements.length) {\n\t\t\t\treturn elements[0];\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t\toverride hasOutputTextSelection() {\n\t\t\treturn false;\n\t\t}\n\t\toverride changeModelDecorations() { return null; }\n\t\toverride focusElement() { }\n\t\toverride setCellEditorSelection() { }\n\t\toverride async revealRangeInCenterIfOutsideViewportAsync() { }\n\t\toverride async layoutNotebookCell() { }\n\t\toverride async createOutput() { }\n\t\toverride async removeInset() { }\n\t\toverride async focusNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output') {\n\t\t\tcell.focusMode = focusItem === 'editor' ? CellFocusMode.Editor\n\t\t\t\t: focusItem === 'output' ? CellFocusMode.Output\n\t\t\t\t\t: CellFocusMode.Container;\n\t\t}\n\t\toverride cellAt(index: number) { return viewModel.cellAt(index)!; }\n\t\toverride getCellIndex(cell: ICellViewModel) { return viewModel.getCellIndex(cell); }\n\t\toverride getCellsInRange(range?: ICellRange) { return viewModel.getCellsInRange(range); }\n\t\toverride getCellByHandle(handle: number) { return viewModel.getCellByHandle(handle); }\n\t\toverride getNextVisibleCellIndex(index: number) { return viewModel.getNextVisibleCellIndex(index); }\n\t\tgetControl() { return this; }\n\t\toverride get onDidChangeSelection() { return viewModel.onDidChangeSelection as Event<any>; }\n\t\toverride get onDidChangeOptions() { return viewModel.onDidChangeOptions; }\n\t\toverride get onDidChangeViewCells() { return viewModel.onDidChangeViewCells; }\n\t\toverride async find(query: string, options: INotebookFindOptions): Promise<CellFindMatchWithIndex[]> {\n\t\t\tconst findMatches = viewModel.find(query, options).filter(match => match.length > 0);\n\t\t\treturn findMatches;\n\t\t}\n\t\toverride deltaCellDecorations() { return []; }\n\t\toverride onDidChangeVisibleRanges = Event.None;\n\n\t\toverride get visibleRanges() {\n\t\t\treturn visibleRanges;\n\t\t}\n\n\t\toverride set visibleRanges(_ranges: ICellRange[]) {\n\t\t\tvisibleRanges = _ranges;\n\t\t}\n\n\t\toverride getId(): string { return id; }\n\t\toverride setScrollTop(scrollTop: number): void {\n\t\t\tcellList.scrollTop = scrollTop;\n\t\t}\n\t\toverride get scrollTop(): number {\n\t\t\treturn cellList.scrollTop;\n\t\t}\n\t\toverride getLayoutInfo(): NotebookLayoutInfo {\n\t\t\treturn {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tscrollHeight: cellList.getScrollHeight(),\n\t\t\t\tfontInfo: new FontInfo({\n\t\t\t\t\tpixelRatio: 1,\n\t\t\t\t\tfontFamily: 'mockFont',\n\t\t\t\t\tfontWeight: 'normal',\n\t\t\t\t\tfontSize: 14,\n\t\t\t\t\tfontFeatureSettings: EditorFontLigatures.OFF,\n\t\t\t\t\tfontVariationSettings: EditorFontVariations.OFF,\n\t\t\t\t\tlineHeight: 19,\n\t\t\t\t\tletterSpacing: 1.5,\n\t\t\t\t\tisMonospace: true,\n\t\t\t\t\ttypicalHalfwidthCharacterWidth: 10,\n\t\t\t\t\ttypicalFullwidthCharacterWidth: 20,\n\t\t\t\t\tcanUseHalfwidthRightwardsArrow: true,\n\t\t\t\t\tspaceWidth: 10,\n\t\t\t\t\tmiddotWidth: 10,\n\t\t\t\t\twsmiddotWidth: 10,\n\t\t\t\t\tmaxDigitWidth: 10,\n\t\t\t\t}, true),\n\t\t\t\tstickyHeight: 0,\n\t\t\t\tlistViewOffsetTop: 0,\n\t\t\t};\n\t\t}\n\t};\n\n\treturn { editor: notebookEditor, viewModel };\n}\n\nexport function createTestNotebookEditor(instantiationService: TestInstantiationService, disposables: DisposableStore, cells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][]): { editor: INotebookEditorDelegate; viewModel: NotebookViewModel } {\n\treturn _createTestNotebookEditor(instantiationService, disposables, cells);\n}\n\nexport async function withTestNotebookDiffModel<R = any>(originalCells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][], modifiedCells: [source: string, lang: string, kind: CellKind, output?: IOutputDto[], metadata?: NotebookCellMetadata][], callback: (diffModel: INotebookDiffEditorModel, disposables: DisposableStore, accessor: TestInstantiationService) => Promise<R> | R): Promise<R> {\n\tconst disposables = new DisposableStore();\n\tconst instantiationService = setupInstantiationService(disposables);\n\tconst originalNotebook = createTestNotebookEditor(instantiationService, disposables, originalCells);\n\tconst modifiedNotebook = createTestNotebookEditor(instantiationService, disposables, modifiedCells);\n\tconst originalResource = new class extends mock<IResolvedNotebookEditorModel>() {\n\t\toverride get notebook() {\n\t\t\treturn originalNotebook.viewModel.notebookDocument;\n\t\t}\n\t\toverride get resource() {\n\t\t\treturn originalNotebook.viewModel.notebookDocument.uri;\n\t\t}\n\t};\n\n\tconst modifiedResource = new class extends mock<IResolvedNotebookEditorModel>() {\n\t\toverride get notebook() {\n\t\t\treturn modifiedNotebook.viewModel.notebookDocument;\n\t\t}\n\t\toverride get resource() {\n\t\t\treturn modifiedNotebook.viewModel.notebookDocument.uri;\n\t\t}\n\t};\n\n\tconst model = new class extends mock<INotebookDiffEditorModel>() {\n\t\toverride get original() {\n\t\t\treturn originalResource;\n\t\t}\n\t\toverride get modified() {\n\t\t\treturn modifiedResource;\n\t\t}\n\t};\n\n\tconst res = await callback(model, disposables, instantiationService);\n\tif (res instanceof Promise) {\n\t\tres.finally(() => {\n\t\t\toriginalNotebook.editor.dispose();\n\t\t\toriginalNotebook.viewModel.notebookDocument.dispose();\n\t\t\toriginalNotebook.viewModel.dispose();\n\t\t\tmodifiedNotebook.editor.dispose();\n\t\t\tmodifiedNotebook.viewModel.notebookDocument.dispose();\n\t\t\tmodifiedNotebook.viewModel.dispose();\n\t\t\tdisposables.dispose();\n\t\t});\n\t} else {\n\t\toriginalNotebook.editor.dispose();\n\t\toriginalNotebook.viewModel.notebookDocument.dispose();\n\t\toriginalNotebook.viewModel.dispose();\n\t\tmodifiedNotebook.editor.dispose();\n\t\tmodifiedNotebook.viewModel.notebookDocument.dispose();\n\t\tmodifiedNotebook.viewModel.dispose();\n\t\tdisposables.dispose();\n\t}\n\treturn res;\n}\n\ninterface IActiveTestNotebookEditorDelegate extends IActiveNotebookEditorDelegate {\n\tvisibleRanges: ICellRange[];\n}\n\nexport type MockNotebookCell = [\n\tsource: string,\n\tlang: string,\n\tkind: CellKind,\n\toutput?: IOutputDto[],\n\tmetadata?: NotebookCellMetadata,\n];\n\nexport type MockDocumentSymbol = {\n\tname: string;\n\trange: {};\n\tkind?: number;\n\tchildren?: MockDocumentSymbol[];\n};\n\nexport async function withTestNotebook<R = any>(cells: MockNotebookCell[], callback: (editor: IActiveTestNotebookEditorDelegate, viewModel: NotebookViewModel, disposables: DisposableStore, accessor: TestInstantiationService) => Promise<R> | R, accessor?: TestInstantiationService): Promise<R> {\n\tconst disposables: DisposableStore = new DisposableStore();\n\tconst instantiationService = accessor ?? setupInstantiationService(disposables);\n\tconst notebookEditor = _createTestNotebookEditor(instantiationService, disposables, cells);\n\n\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\tconst res = await callback(notebookEditor.editor, notebookEditor.viewModel, disposables, instantiationService);\n\t\tif (res instanceof Promise) {\n\t\t\tres.finally(() => {\n\t\t\t\tnotebookEditor.editor.dispose();\n\t\t\t\tnotebookEditor.viewModel.dispose();\n\t\t\t\tnotebookEditor.editor.textModel.dispose();\n\t\t\t\tdisposables.dispose();\n\t\t\t});\n\t\t} else {\n\t\t\tnotebookEditor.editor.dispose();\n\t\t\tnotebookEditor.viewModel.dispose();\n\t\t\tnotebookEditor.editor.textModel.dispose();\n\t\t\tdisposables.dispose();\n\t\t}\n\t\treturn res;\n\t});\n}\n\nexport function createNotebookCellList(instantiationService: TestInstantiationService, disposables: Pick<DisposableStore, 'add'>, viewContext?: ViewContext) {\n\tconst delegate: IListVirtualDelegate<CellViewModel> = {\n\t\tgetHeight(element: CellViewModel) { return element.getHeight(17); },\n\t\tgetTemplateId() { return 'template'; }\n\t};\n\n\tconst baseCellRenderTemplate = new class extends mock<BaseCellRenderTemplate>() { };\n\tconst renderer: IListRenderer<CellViewModel, BaseCellRenderTemplate> = {\n\t\ttemplateId: 'template',\n\t\trenderTemplate() { return baseCellRenderTemplate; },\n\t\trenderElement() { },\n\t\tdisposeTemplate() { }\n\t};\n\n\tconst notebookOptions = !!viewContext ? viewContext.notebookOptions\n\t\t: disposables.add(new NotebookOptions(mainWindow, false, undefined, instantiationService.get(IConfigurationService), instantiationService.get(INotebookExecutionStateService), instantiationService.get(ICodeEditorService)));\n\tconst cellList: NotebookCellList = disposables.add(instantiationService.createInstance(\n\t\tNotebookCellList,\n\t\t'NotebookCellList',\n\t\tDOM.$('container'),\n\t\tnotebookOptions,\n\t\tdelegate,\n\t\t[renderer],\n\t\tinstantiationService.get<IContextKeyService>(IContextKeyService),\n\t\t{\n\t\t\tsupportDynamicHeights: true,\n\t\t\tmultipleSelectionSupport: true,\n\t\t}\n\t));\n\n\treturn cellList;\n}\n\nexport function valueBytesFromString(value: string): VSBuffer {\n\treturn VSBuffer.fromString(value);\n}\n\nclass TestCellExecution implements INotebookCellExecution {\n\tconstructor(\n\t\treadonly notebook: URI,\n\t\treadonly cellHandle: number,\n\t\tprivate onComplete: () => void,\n\t) { }\n\n\treadonly state: NotebookCellExecutionState = NotebookCellExecutionState.Unconfirmed;\n\n\treadonly didPause: boolean = false;\n\treadonly isPaused: boolean = false;\n\n\tconfirm(): void {\n\t}\n\n\tupdate(updates: ICellExecuteUpdate[]): void {\n\t}\n\n\tcomplete(complete: ICellExecutionComplete): void {\n\t\tthis.onComplete();\n\t}\n}\n\nexport class TestNotebookExecutionStateService implements INotebookExecutionStateService {\n\t_serviceBrand: undefined;\n\n\tprivate _executions = new ResourceMap<INotebookCellExecution>();\n\n\tonDidChangeExecution = new Emitter<ICellExecutionStateChangedEvent | IExecutionStateChangedEvent>().event;\n\tonDidChangeLastRunFailState = new Emitter<INotebookFailStateChangedEvent>().event;\n\n\tforceCancelNotebookExecutions(notebookUri: URI): void {\n\t}\n\n\tgetCellExecutionsForNotebook(notebook: URI): INotebookCellExecution[] {\n\t\treturn [];\n\t}\n\n\tgetCellExecution(cellUri: URI): INotebookCellExecution | undefined {\n\t\treturn this._executions.get(cellUri);\n\t}\n\n\tcreateCellExecution(notebook: URI, cellHandle: number): INotebookCellExecution {\n\t\tconst onComplete = () => this._executions.delete(CellUri.generate(notebook, cellHandle));\n\t\tconst exe = new TestCellExecution(notebook, cellHandle, onComplete);\n\t\tthis._executions.set(CellUri.generate(notebook, cellHandle), exe);\n\t\treturn exe;\n\t}\n\n\tgetCellExecutionsByHandleForNotebook(notebook: URI): Map<number, INotebookCellExecution> | undefined {\n\t\treturn;\n\t}\n\n\tgetLastFailedCellForNotebook(notebook: URI): number | undefined {\n\t\treturn;\n\t}\n\tgetLastCompletedCellForNotebook(notebook: URI): number | undefined {\n\t\treturn;\n\t}\n\tgetExecution(notebook: URI): INotebookExecution | undefined {\n\t\treturn;\n\t}\n\tcreateExecution(notebook: URI): INotebookExecution {\n\t\tthrow new Error('Method not implemented.');\n\t}\n}\n"]}