{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/test/browser/notebookSelection.test.ts","vs/workbench/contrib/notebook/test/browser/notebookSelection.test.ts"],"names":[],"mappings":"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","file":"notebookSelection.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { FoldingModel, updateFoldingStateAtIndex } from '../../browser/viewModel/foldingModel.js';\nimport { runDeleteAction } from '../../browser/controller/cellOperations.js';\nimport { NotebookCellSelectionCollection } from '../../browser/viewModel/cellSelectionCollection.js';\nimport { CellEditType, CellKind, SelectionStateType } from '../../common/notebookCommon.js';\nimport { createNotebookCellList, setupInstantiationService, TestCell, withTestNotebook } from './testNotebookEditor.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\n\nsuite('NotebookSelection', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('focus is never empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tassert.deepStrictEqual(selectionCollection.focus, { start: 0, end: 0 });\n\n\t\tselectionCollection.setState(null, [], true, 'model');\n\t\tassert.deepStrictEqual(selectionCollection.focus, { start: 0, end: 0 });\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('selection is never empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tassert.deepStrictEqual(selectionCollection.selections, [{ start: 0, end: 0 }]);\n\n\t\tselectionCollection.setState(null, [], true, 'model');\n\t\tassert.deepStrictEqual(selectionCollection.selections, [{ start: 0, end: 0 }]);\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('selections does not change when setting to empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tlet changed = false;\n\t\tstore.add(selectionCollection.onDidChangeSelection(() => {\n\t\t\tchanged = true;\n\t\t}));\n\n\t\tselectionCollection.setState(null, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [{ start: 0, end: 0 }], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState(null, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('event fires when selection or focus changes', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tlet eventCount = 0;\n\t\tstore.add(selectionCollection.onDidChangeSelection(() => {\n\t\t\teventCount++;\n\t\t}));\n\n\t\t// Change focus\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 1);\n\n\t\t// Change selections\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }, { start: 2, end: 3 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 2);\n\n\t\t// no change\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }, { start: 2, end: 3 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 2);\n\n\t\t// change to empty focus\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [{ start: 4, end: 5 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 3);\n\n\t\t// change to empty selections\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [], false, 'model');\n\t\tassert.strictEqual(eventCount, 4);\n\n\t\tselectionCollection.dispose();\n\t});\n\n});\n\nsuite('NotebookCellList focus/selection', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = setupInstantiationService(disposables);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t});\n\n\n\ttest('notebook cell list setFocus', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\n\t\t\t\tcellList.setFocus([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tcellList.detachViewModel();\n\t\t\t});\n\t});\n\n\ttest('notebook cell list setSelections', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setSelection([0]);\n\t\t\t\t// the only selection is also the focus\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// set selection does not modify focus\n\t\t\t\tcellList.setSelection([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell list setFocus2', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\n\t\t\t\tcellList.setFocus([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\n\t\t\t\tcellList.setSelection([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t\tcellList.detachViewModel();\n\t\t\t});\n\t});\n\n\n\ttest('notebook cell list focus/selection from UI', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// arrow down, move both focus and selections\n\t\t\t\tcellList.setFocus([1], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tcellList.setSelection([1], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\n\t\t\t\t// shift+arrow down, expands selection\n\t\t\t\tcellList.setFocus([2], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tcellList.setSelection([1, 2]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 3 }]);\n\n\t\t\t\t// arrow down, will move focus but not expand selection\n\t\t\t\tcellList.setFocus([3], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 3, end: 4 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 3 }]);\n\t\t\t});\n\t});\n\n\n\ttest('notebook cell list focus/selection with folding regions', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tassert.strictEqual(cellList.length, 5);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\t\t\t\tcellList.setFocus([0]);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.length, 3);\n\n\t\t\t\t// currently, focus on a folded cell will only focus the cell itself, excluding its \"inner\" cells\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\tcellList.focusNext(1, false);\n\t\t\t\t// focus next should skip the folded items\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// unfold\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.length, 4);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t});\n\t});\n\n\ttest('notebook cell list focus/selection with folding regions and applyEdits', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3', 'javascript', CellKind.Markup, [], {}],\n\t\t\t\t['# header d', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var e = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tcellList.setSelection([0]);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 2);\n\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace, index: 0, count: 2, cells: []\n\t\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 3);\n\n\t\t\t\t// mimic undo\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace, index: 0, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(viewModel.viewType, 7, '# header f', 'markdown', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(viewModel.viewType, 8, 'var g = 5;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 1);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(2), 2);\n\t\t\t});\n\t});\n\n\ttest('notebook cell list getModelIndex', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(-1), 0);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(1), 2);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(2), 4);\n\t\t\t});\n\t});\n\n\n\ttest('notebook validate range', async () => {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange(null), null);\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange(undefined), null);\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 0 }), { start: 0, end: 0 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 2 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 3 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: -1, end: 3 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: -1, end: 1 }), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 2, end: 1 }), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 2, end: -1 }), { start: 0, end: 2 });\n\t\t\t});\n\t});\n\n\ttest('notebook updateSelectionState', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }, { start: -1, end: 0 }] });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell selection w/ cell deletion', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }] });\n\t\t\t\trunDeleteAction(editor, viewModel.cellAt(1)!);\n\t\t\t\t// viewModel.deleteCell(1, true, false);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\t\t\t\trunDeleteAction(editor, viewModel.cellAt(0)!);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 0 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 0 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell selection w/ cell deletion from applyEdits', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\tasync (editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }] });\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\tindex: 1,\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tcells: []\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { FoldingModel, updateFoldingStateAtIndex } from '../../browser/viewModel/foldingModel.js';\nimport { runDeleteAction } from '../../browser/controller/cellOperations.js';\nimport { NotebookCellSelectionCollection } from '../../browser/viewModel/cellSelectionCollection.js';\nimport { CellEditType, CellKind, SelectionStateType } from '../../common/notebookCommon.js';\nimport { createNotebookCellList, setupInstantiationService, TestCell, withTestNotebook } from './testNotebookEditor.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\n\nsuite('NotebookSelection', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('focus is never empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tassert.deepStrictEqual(selectionCollection.focus, { start: 0, end: 0 });\n\n\t\tselectionCollection.setState(null, [], true, 'model');\n\t\tassert.deepStrictEqual(selectionCollection.focus, { start: 0, end: 0 });\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('selection is never empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tassert.deepStrictEqual(selectionCollection.selections, [{ start: 0, end: 0 }]);\n\n\t\tselectionCollection.setState(null, [], true, 'model');\n\t\tassert.deepStrictEqual(selectionCollection.selections, [{ start: 0, end: 0 }]);\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('selections does not change when setting to empty', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tlet changed = false;\n\t\tstore.add(selectionCollection.onDidChangeSelection(() => {\n\t\t\tchanged = true;\n\t\t}));\n\n\t\tselectionCollection.setState(null, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [{ start: 0, end: 0 }], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.setState(null, [], false, 'model');\n\t\tassert.strictEqual(changed, false);\n\t\tselectionCollection.dispose();\n\t});\n\n\ttest('event fires when selection or focus changes', function () {\n\t\tconst selectionCollection = new NotebookCellSelectionCollection();\n\t\tlet eventCount = 0;\n\t\tstore.add(selectionCollection.onDidChangeSelection(() => {\n\t\t\teventCount++;\n\t\t}));\n\n\t\t// Change focus\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 1);\n\n\t\t// Change selections\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }, { start: 2, end: 3 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 2);\n\n\t\t// no change\n\t\tselectionCollection.setState({ start: 1, end: 1 }, [{ start: 1, end: 2 }, { start: 2, end: 3 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 2);\n\n\t\t// change to empty focus\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [{ start: 4, end: 5 }], false, 'model');\n\t\tassert.strictEqual(eventCount, 3);\n\n\t\t// change to empty selections\n\t\tselectionCollection.setState({ start: 0, end: 0 }, [], false, 'model');\n\t\tassert.strictEqual(eventCount, 4);\n\n\t\tselectionCollection.dispose();\n\t});\n\n});\n\nsuite('NotebookCellList focus/selection', () => {\n\tlet disposables: DisposableStore;\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tdisposables = new DisposableStore();\n\t\tinstantiationService = setupInstantiationService(disposables);\n\t\tlanguageService = instantiationService.get(ILanguageService);\n\t});\n\n\n\ttest('notebook cell list setFocus', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\n\t\t\t\tcellList.setFocus([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tcellList.detachViewModel();\n\t\t\t});\n\t});\n\n\ttest('notebook cell list setSelections', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setSelection([0]);\n\t\t\t\t// the only selection is also the focus\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// set selection does not modify focus\n\t\t\t\tcellList.setSelection([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell list setFocus2', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tassert.strictEqual(cellList.length, 2);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\n\t\t\t\tcellList.setFocus([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\n\t\t\t\tcellList.setSelection([1]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t\tcellList.detachViewModel();\n\t\t\t});\n\t});\n\n\n\ttest('notebook cell list focus/selection from UI', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// arrow down, move both focus and selections\n\t\t\t\tcellList.setFocus([1], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tcellList.setSelection([1], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\n\t\t\t\t// shift+arrow down, expands selection\n\t\t\t\tcellList.setFocus([2], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tcellList.setSelection([1, 2]);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 3 }]);\n\n\t\t\t\t// arrow down, will move focus but not expand selection\n\t\t\t\tcellList.setFocus([3], new KeyboardEvent('keydown'), undefined);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 3, end: 4 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 3 }]);\n\t\t\t});\n\t});\n\n\n\ttest('notebook cell list focus/selection with folding regions', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tassert.strictEqual(cellList.length, 5);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\t\t\t\tcellList.setFocus([0]);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.length, 3);\n\n\t\t\t\t// currently, focus on a folded cell will only focus the cell itself, excluding its \"inner\" cells\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\tcellList.focusNext(1, false);\n\t\t\t\t// focus next should skip the folded items\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\n\t\t\t\t// unfold\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.length, 4);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 2, end: 3 });\n\t\t\t});\n\t});\n\n\ttest('notebook cell list focus/selection with folding regions and applyEdits', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3', 'javascript', CellKind.Markup, [], {}],\n\t\t\t\t['# header d', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var e = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\t\t\t\tcellList.setFocus([0]);\n\t\t\t\tcellList.setSelection([0]);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 2);\n\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace, index: 0, count: 2, cells: []\n\t\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 3);\n\n\t\t\t\t// mimic undo\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace, index: 0, count: 0, cells: [\n\t\t\t\t\t\tds.add(new TestCell(viewModel.viewType, 7, '# header f', 'markdown', CellKind.Code, [], languageService)),\n\t\t\t\t\t\tds.add(new TestCell(viewModel.viewType, 8, 'var g = 5;', 'javascript', CellKind.Code, [], languageService))\n\t\t\t\t\t]\n\t\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(1), 1);\n\t\t\t\tassert.strictEqual(cellList.getModelIndex2(2), 2);\n\t\t\t});\n\t});\n\n\ttest('notebook cell list getModelIndex', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header c', 'markdown', CellKind.Markup, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel, ds) => {\n\t\t\t\tconst foldingModel = ds.add(new FoldingModel());\n\t\t\t\tfoldingModel.attachViewModel(viewModel);\n\n\t\t\t\tconst cellList = createNotebookCellList(instantiationService, ds);\n\t\t\t\tcellList.attachViewModel(viewModel);\n\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 0, true);\n\t\t\t\tupdateFoldingStateAtIndex(foldingModel, 2, true);\n\t\t\t\tviewModel.updateFoldingRanges(foldingModel.regions);\n\t\t\t\tcellList.setHiddenAreas(viewModel.getHiddenRanges(), true);\n\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(-1), 0);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(0), 0);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(1), 2);\n\t\t\t\tassert.deepStrictEqual(cellList.getModelIndex2(2), 4);\n\t\t\t});\n\t});\n\n\n\ttest('notebook validate range', async () => {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange(null), null);\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange(undefined), null);\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 0 }), { start: 0, end: 0 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 2 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 0, end: 3 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: -1, end: 3 }), { start: 0, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: -1, end: 1 }), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 2, end: 1 }), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.validateRange({ start: 2, end: -1 }), { start: 0, end: 2 });\n\t\t\t});\n\t});\n\n\ttest('notebook updateSelectionState', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }, { start: -1, end: 0 }] });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell selection w/ cell deletion', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }] });\n\t\t\t\trunDeleteAction(editor, viewModel.cellAt(1)!);\n\t\t\t\t// viewModel.deleteCell(1, true, false);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 1 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 1 }]);\n\t\t\t\trunDeleteAction(editor, viewModel.cellAt(0)!);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 0, end: 0 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 0, end: 0 }]);\n\t\t\t});\n\t});\n\n\ttest('notebook cell selection w/ cell deletion from applyEdits', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markup, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\tasync (editor, viewModel) => {\n\t\t\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 1, end: 2 }, selections: [{ start: 1, end: 2 }] });\n\t\t\t\teditor.textModel.applyEdits([{\n\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\tindex: 1,\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tcells: []\n\t\t\t\t}], true, undefined, () => undefined, undefined, true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getFocus(), { start: 1, end: 2 });\n\t\t\t\tassert.deepStrictEqual(viewModel.getSelections(), [{ start: 1, end: 2 }]);\n\t\t\t});\n\t});\n});\n"]}