{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/notebook/common/notebookDiff.ts","vs/workbench/contrib/notebook/common/notebookDiff.ts"],"names":[],"mappings":"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","file":"notebookDiff.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDiffChange } from '../../../../base/common/diff/diff.js';\nimport { CellKind, INotebookDiffResult } from './notebookCommon.js';\n\nexport type CellDiffInfo = {\n\toriginalCellIndex: number;\n\tmodifiedCellIndex: number;\n\ttype: 'unchanged' | 'modified';\n} |\n{\n\toriginalCellIndex: number;\n\ttype: 'delete';\n} |\n{\n\tmodifiedCellIndex: number;\n\ttype: 'insert';\n};\n\ninterface ICell {\n\tcellKind: CellKind;\n\tgetHashValue(): number;\n\tequal(cell: ICell): boolean;\n}\n// interface INotebookDiffResult {\n// \tcellsDiff: IDiffResult;\n// \tmetadataChanged: boolean;\n// }\n\nexport function computeDiff(originalModel: { readonly cells: readonly ICell[] }, modifiedModel: { readonly cells: readonly ICell[] }, diffResult: INotebookDiffResult) {\n\tconst cellChanges = diffResult.cellsDiff.changes;\n\tconst cellDiffInfo: CellDiffInfo[] = [];\n\tlet originalCellIndex = 0;\n\tlet modifiedCellIndex = 0;\n\n\tlet firstChangeIndex = -1;\n\n\tfor (let i = 0; i < cellChanges.length; i++) {\n\t\tconst change = cellChanges[i];\n\t\t// common cells\n\n\t\tfor (let j = 0; j < change.originalStart - originalCellIndex; j++) {\n\t\t\tconst originalCell = originalModel.cells[originalCellIndex + j];\n\t\t\tconst modifiedCell = modifiedModel.cells[modifiedCellIndex + j];\n\t\t\tif (originalCell.getHashValue() === modifiedCell.getHashValue()) {\n\t\t\t\tcellDiffInfo.push({\n\t\t\t\t\toriginalCellIndex: originalCellIndex + j,\n\t\t\t\t\tmodifiedCellIndex: modifiedCellIndex + j,\n\t\t\t\t\ttype: 'unchanged'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (firstChangeIndex === -1) {\n\t\t\t\t\tfirstChangeIndex = cellDiffInfo.length;\n\t\t\t\t}\n\t\t\t\tcellDiffInfo.push({\n\t\t\t\t\toriginalCellIndex: originalCellIndex + j,\n\t\t\t\t\tmodifiedCellIndex: modifiedCellIndex + j,\n\t\t\t\t\ttype: 'modified'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst modifiedLCS = computeModifiedLCS(change, originalModel, modifiedModel);\n\t\tif (modifiedLCS.length && firstChangeIndex === -1) {\n\t\t\tfirstChangeIndex = cellDiffInfo.length;\n\t\t}\n\n\t\tcellDiffInfo.push(...modifiedLCS);\n\t\toriginalCellIndex = change.originalStart + change.originalLength;\n\t\tmodifiedCellIndex = change.modifiedStart + change.modifiedLength;\n\t}\n\n\tfor (let i = originalCellIndex; i < originalModel.cells.length; i++) {\n\t\tcellDiffInfo.push({\n\t\t\toriginalCellIndex: i,\n\t\t\tmodifiedCellIndex: i - originalCellIndex + modifiedCellIndex,\n\t\t\ttype: 'unchanged'\n\t\t});\n\t}\n\n\treturn {\n\t\tcellDiffInfo,\n\t\tfirstChangeIndex\n\t};\n}\n\nfunction computeModifiedLCS(change: IDiffChange, originalModel: { readonly cells: readonly ICell[] }, modifiedModel: { readonly cells: readonly ICell[] }) {\n\tconst result: CellDiffInfo[] = [];\n\t// modified cells\n\tconst modifiedLen = Math.min(change.originalLength, change.modifiedLength);\n\n\tfor (let j = 0; j < modifiedLen; j++) {\n\t\tconst originalCell = originalModel.cells[change.originalStart + j];\n\t\tconst modifiedCell = modifiedModel.cells[change.modifiedStart + j];\n\t\tif (originalCell.cellKind !== modifiedCell.cellKind) {\n\t\t\tresult.push({\n\t\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\t\ttype: 'delete'\n\t\t\t});\n\t\t\tresult.push({\n\t\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\t\ttype: 'insert'\n\t\t\t});\n\t\t} else {\n\t\t\tconst isTheSame = originalCell.equal(modifiedCell);\n\t\t\tresult.push({\n\t\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\t\ttype: isTheSame ? 'unchanged' : 'modified'\n\t\t\t});\n\t\t}\n\t}\n\n\tfor (let j = modifiedLen; j < change.originalLength; j++) {\n\t\t// deletion\n\t\tresult.push({\n\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\ttype: 'delete'\n\t\t});\n\t}\n\n\tfor (let j = modifiedLen; j < change.modifiedLength; j++) {\n\t\tresult.push({\n\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\ttype: 'insert'\n\t\t});\n\t}\n\n\treturn result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDiffChange } from '../../../../base/common/diff/diff.js';\nimport { CellKind, INotebookDiffResult } from './notebookCommon.js';\n\nexport type CellDiffInfo = {\n\toriginalCellIndex: number;\n\tmodifiedCellIndex: number;\n\ttype: 'unchanged' | 'modified';\n} |\n{\n\toriginalCellIndex: number;\n\ttype: 'delete';\n} |\n{\n\tmodifiedCellIndex: number;\n\ttype: 'insert';\n};\n\ninterface ICell {\n\tcellKind: CellKind;\n\tgetHashValue(): number;\n\tequal(cell: ICell): boolean;\n}\n// interface INotebookDiffResult {\n// \tcellsDiff: IDiffResult;\n// \tmetadataChanged: boolean;\n// }\n\nexport function computeDiff(originalModel: { readonly cells: readonly ICell[] }, modifiedModel: { readonly cells: readonly ICell[] }, diffResult: INotebookDiffResult) {\n\tconst cellChanges = diffResult.cellsDiff.changes;\n\tconst cellDiffInfo: CellDiffInfo[] = [];\n\tlet originalCellIndex = 0;\n\tlet modifiedCellIndex = 0;\n\n\tlet firstChangeIndex = -1;\n\n\tfor (let i = 0; i < cellChanges.length; i++) {\n\t\tconst change = cellChanges[i];\n\t\t// common cells\n\n\t\tfor (let j = 0; j < change.originalStart - originalCellIndex; j++) {\n\t\t\tconst originalCell = originalModel.cells[originalCellIndex + j];\n\t\t\tconst modifiedCell = modifiedModel.cells[modifiedCellIndex + j];\n\t\t\tif (originalCell.getHashValue() === modifiedCell.getHashValue()) {\n\t\t\t\tcellDiffInfo.push({\n\t\t\t\t\toriginalCellIndex: originalCellIndex + j,\n\t\t\t\t\tmodifiedCellIndex: modifiedCellIndex + j,\n\t\t\t\t\ttype: 'unchanged'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (firstChangeIndex === -1) {\n\t\t\t\t\tfirstChangeIndex = cellDiffInfo.length;\n\t\t\t\t}\n\t\t\t\tcellDiffInfo.push({\n\t\t\t\t\toriginalCellIndex: originalCellIndex + j,\n\t\t\t\t\tmodifiedCellIndex: modifiedCellIndex + j,\n\t\t\t\t\ttype: 'modified'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst modifiedLCS = computeModifiedLCS(change, originalModel, modifiedModel);\n\t\tif (modifiedLCS.length && firstChangeIndex === -1) {\n\t\t\tfirstChangeIndex = cellDiffInfo.length;\n\t\t}\n\n\t\tcellDiffInfo.push(...modifiedLCS);\n\t\toriginalCellIndex = change.originalStart + change.originalLength;\n\t\tmodifiedCellIndex = change.modifiedStart + change.modifiedLength;\n\t}\n\n\tfor (let i = originalCellIndex; i < originalModel.cells.length; i++) {\n\t\tcellDiffInfo.push({\n\t\t\toriginalCellIndex: i,\n\t\t\tmodifiedCellIndex: i - originalCellIndex + modifiedCellIndex,\n\t\t\ttype: 'unchanged'\n\t\t});\n\t}\n\n\treturn {\n\t\tcellDiffInfo,\n\t\tfirstChangeIndex\n\t};\n}\n\nfunction computeModifiedLCS(change: IDiffChange, originalModel: { readonly cells: readonly ICell[] }, modifiedModel: { readonly cells: readonly ICell[] }) {\n\tconst result: CellDiffInfo[] = [];\n\t// modified cells\n\tconst modifiedLen = Math.min(change.originalLength, change.modifiedLength);\n\n\tfor (let j = 0; j < modifiedLen; j++) {\n\t\tconst originalCell = originalModel.cells[change.originalStart + j];\n\t\tconst modifiedCell = modifiedModel.cells[change.modifiedStart + j];\n\t\tif (originalCell.cellKind !== modifiedCell.cellKind) {\n\t\t\tresult.push({\n\t\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\t\ttype: 'delete'\n\t\t\t});\n\t\t\tresult.push({\n\t\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\t\ttype: 'insert'\n\t\t\t});\n\t\t} else {\n\t\t\tconst isTheSame = originalCell.equal(modifiedCell);\n\t\t\tresult.push({\n\t\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\t\ttype: isTheSame ? 'unchanged' : 'modified'\n\t\t\t});\n\t\t}\n\t}\n\n\tfor (let j = modifiedLen; j < change.originalLength; j++) {\n\t\t// deletion\n\t\tresult.push({\n\t\t\toriginalCellIndex: change.originalStart + j,\n\t\t\ttype: 'delete'\n\t\t});\n\t}\n\n\tfor (let j = modifiedLen; j < change.modifiedLength; j++) {\n\t\tresult.push({\n\t\t\tmodifiedCellIndex: change.modifiedStart + j,\n\t\t\ttype: 'insert'\n\t\t});\n\t}\n\n\treturn result;\n}\n"]}