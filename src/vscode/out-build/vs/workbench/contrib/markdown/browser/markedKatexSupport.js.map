{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/markdown/browser/markedKatexSupport.ts","vs/workbench/contrib/markdown/browser/markedKatexSupport.ts"],"names":[],"mappings":"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","file":"markedKatexSupport.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { importAMDNodeModule, resolveAmdNodeModulePath } from '../../../../amdX.js';\nimport * as domSanitize from '../../../../base/browser/domSanitize.js';\nimport { MarkdownSanitizerConfig } from '../../../../base/browser/markdownRenderer.js';\nimport { CodeWindow } from '../../../../base/browser/window.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport type * as marked from '../../../../base/common/marked/marked.js';\nimport { katexContainerLatexAttributeName, MarkedKatexExtension } from '../common/markedKatexExtension.js';\n\nexport class MarkedKatexSupport {\n\n\tpublic static getSanitizerOptions(baseConfig: {\n\t\treadonly allowedTags: readonly string[];\n\t\treadonly allowedAttributes: ReadonlyArray<string | domSanitize.SanitizeAttributeRule>;\n\t}): MarkdownSanitizerConfig {\n\t\treturn {\n\t\t\tallowedTags: {\n\t\t\t\toverride: [\n\t\t\t\t\t...baseConfig.allowedTags,\n\t\t\t\t\t...trustedMathMlTags,\n\t\t\t\t]\n\t\t\t},\n\t\t\tallowedAttributes: {\n\t\t\t\toverride: [\n\t\t\t\t\t...baseConfig.allowedAttributes,\n\n\t\t\t\t\t// Math\n\t\t\t\t\t'stretchy',\n\t\t\t\t\t'encoding',\n\t\t\t\t\t'accent',\n\t\t\t\t\tkatexContainerLatexAttributeName,\n\n\t\t\t\t\t// SVG\n\t\t\t\t\t'd',\n\t\t\t\t\t'viewBox',\n\t\t\t\t\t'preserveAspectRatio',\n\n\t\t\t\t\t// Allow all classes since we don't have a list of allowed katex classes\n\t\t\t\t\t'class',\n\n\t\t\t\t\t// Sanitize allowed styles for katex\n\t\t\t\t\t{\n\t\t\t\t\t\tattributeName: 'style',\n\t\t\t\t\t\tshouldKeep: (_el, data) => this.sanitizeKatexStyles(data.attrValue),\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate static tempSanitizerRule = new Lazy(() => {\n\t\t// Create a CSSStyleDeclaration object via a style sheet rule\n\t\tconst styleSheet = new CSSStyleSheet();\n\t\tstyleSheet.insertRule(`.temp{}`);\n\t\tconst rule = styleSheet.cssRules[0];\n\t\tif (!(rule instanceof CSSStyleRule)) {\n\t\t\tthrow new Error('Invalid CSS rule');\n\t\t}\n\t\treturn rule.style;\n\t});\n\n\tprivate static sanitizeStyles(styleString: string, allowedProperties: readonly string[]): string {\n\t\tconst style = this.tempSanitizerRule.value;\n\t\tstyle.cssText = styleString;\n\n\t\tconst sanitizedProps = [];\n\n\t\tfor (let i = 0; i < style.length; i++) {\n\t\t\tconst prop = style[i];\n\t\t\tif (allowedProperties.includes(prop)) {\n\t\t\t\tconst value = style.getPropertyValue(prop);\n\t\t\t\t// Allow through lists of numbers with units or bare words like 'block'\n\t\t\t\t// Main goal is to block things like 'url()'.\n\t\t\t\tif (/^(([\\d\\.\\-]+\\w*\\s?)+|\\w+)$/.test(value)) {\n\t\t\t\t\tsanitizedProps.push(`${prop}: ${value}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sanitizedProps.join('; ');\n\t}\n\n\tprivate static sanitizeKatexStyles(styleString: string): string {\n\t\tconst allowedProperties = [\n\t\t\t'display',\n\t\t\t'position',\n\t\t\t'font-family',\n\t\t\t'font-style',\n\t\t\t'font-weight',\n\t\t\t'font-size',\n\t\t\t'height',\n\t\t\t'min-height',\n\t\t\t'max-height',\n\t\t\t'width',\n\t\t\t'min-width',\n\t\t\t'max-width',\n\t\t\t'margin',\n\t\t\t'margin-top',\n\t\t\t'margin-right',\n\t\t\t'margin-bottom',\n\t\t\t'margin-left',\n\t\t\t'padding',\n\t\t\t'padding-top',\n\t\t\t'padding-right',\n\t\t\t'padding-bottom',\n\t\t\t'padding-left',\n\t\t\t'top',\n\t\t\t'left',\n\t\t\t'right',\n\t\t\t'bottom',\n\t\t\t'vertical-align',\n\t\t\t'transform',\n\t\t\t'border',\n\t\t\t'border-top-width',\n\t\t\t'border-right-width',\n\t\t\t'border-bottom-width',\n\t\t\t'border-left-width',\n\t\t\t'color',\n\t\t\t'white-space',\n\t\t\t'text-align',\n\t\t\t'line-height',\n\t\t\t'float',\n\t\t\t'clear',\n\t\t];\n\t\treturn this.sanitizeStyles(styleString, allowedProperties);\n\t}\n\n\tprivate static _katex?: typeof import('katex').default;\n\tprivate static _katexPromise = new Lazy(async () => {\n\t\tthis._katex = await importAMDNodeModule<typeof import('katex').default>('katex', 'dist/katex.min.js');\n\t\treturn this._katex;\n\t});\n\n\tpublic static getExtension(window: CodeWindow, options: MarkedKatexExtension.MarkedKatexOptions = {}): marked.MarkedExtension | undefined {\n\t\tif (!this._katex) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis.ensureKatexStyles(window);\n\t\treturn MarkedKatexExtension.extension(this._katex, options);\n\t}\n\n\tpublic static async loadExtension(window: CodeWindow, options: MarkedKatexExtension.MarkedKatexOptions = {}): Promise<marked.MarkedExtension> {\n\t\tconst katex = await this._katexPromise.value;\n\t\tthis.ensureKatexStyles(window);\n\t\treturn MarkedKatexExtension.extension(katex, options);\n\t}\n\n\tpublic static ensureKatexStyles(window: CodeWindow) {\n\t\tconst doc = window.document;\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tif (!doc.querySelector('link.katex')) {\n\t\t\tconst katexStyle = document.createElement('link');\n\t\t\tkatexStyle.classList.add('katex');\n\t\t\tkatexStyle.rel = 'stylesheet';\n\t\t\tkatexStyle.href = resolveAmdNodeModulePath('katex', 'dist/katex.min.css');\n\t\t\tdoc.head.appendChild(katexStyle);\n\t\t}\n\t}\n}\n\nconst trustedMathMlTags = Object.freeze([\n\t'semantics',\n\t'annotation',\n\t'math',\n\t'menclose',\n\t'merror',\n\t'mfenced',\n\t'mfrac',\n\t'mglyph',\n\t'mi',\n\t'mlabeledtr',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msup',\n\t'msubsup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'mprescripts',\n\n\t// svg tags\n\t'svg',\n\t'altglyph',\n\t'altglyphdef',\n\t'altglyphitem',\n\t'circle',\n\t'clippath',\n\t'defs',\n\t'desc',\n\t'ellipse',\n\t'filter',\n\t'font',\n\t'g',\n\t'glyph',\n\t'glyphref',\n\t'hkern',\n\t'line',\n\t'lineargradient',\n\t'marker',\n\t'mask',\n\t'metadata',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialgradient',\n\t'rect',\n\t'stop',\n\t'style',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textpath',\n\t'title',\n\t'tref',\n\t'tspan',\n\t'view',\n\t'vkern',\n]);\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { importAMDNodeModule, resolveAmdNodeModulePath } from '../../../../amdX.js';\nimport * as domSanitize from '../../../../base/browser/domSanitize.js';\nimport { MarkdownSanitizerConfig } from '../../../../base/browser/markdownRenderer.js';\nimport { CodeWindow } from '../../../../base/browser/window.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport type * as marked from '../../../../base/common/marked/marked.js';\nimport { katexContainerLatexAttributeName, MarkedKatexExtension } from '../common/markedKatexExtension.js';\n\nexport class MarkedKatexSupport {\n\n\tpublic static getSanitizerOptions(baseConfig: {\n\t\treadonly allowedTags: readonly string[];\n\t\treadonly allowedAttributes: ReadonlyArray<string | domSanitize.SanitizeAttributeRule>;\n\t}): MarkdownSanitizerConfig {\n\t\treturn {\n\t\t\tallowedTags: {\n\t\t\t\toverride: [\n\t\t\t\t\t...baseConfig.allowedTags,\n\t\t\t\t\t...trustedMathMlTags,\n\t\t\t\t]\n\t\t\t},\n\t\t\tallowedAttributes: {\n\t\t\t\toverride: [\n\t\t\t\t\t...baseConfig.allowedAttributes,\n\n\t\t\t\t\t// Math\n\t\t\t\t\t'stretchy',\n\t\t\t\t\t'encoding',\n\t\t\t\t\t'accent',\n\t\t\t\t\tkatexContainerLatexAttributeName,\n\n\t\t\t\t\t// SVG\n\t\t\t\t\t'd',\n\t\t\t\t\t'viewBox',\n\t\t\t\t\t'preserveAspectRatio',\n\n\t\t\t\t\t// Allow all classes since we don't have a list of allowed katex classes\n\t\t\t\t\t'class',\n\n\t\t\t\t\t// Sanitize allowed styles for katex\n\t\t\t\t\t{\n\t\t\t\t\t\tattributeName: 'style',\n\t\t\t\t\t\tshouldKeep: (_el, data) => this.sanitizeKatexStyles(data.attrValue),\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate static tempSanitizerRule = new Lazy(() => {\n\t\t// Create a CSSStyleDeclaration object via a style sheet rule\n\t\tconst styleSheet = new CSSStyleSheet();\n\t\tstyleSheet.insertRule(`.temp{}`);\n\t\tconst rule = styleSheet.cssRules[0];\n\t\tif (!(rule instanceof CSSStyleRule)) {\n\t\t\tthrow new Error('Invalid CSS rule');\n\t\t}\n\t\treturn rule.style;\n\t});\n\n\tprivate static sanitizeStyles(styleString: string, allowedProperties: readonly string[]): string {\n\t\tconst style = this.tempSanitizerRule.value;\n\t\tstyle.cssText = styleString;\n\n\t\tconst sanitizedProps = [];\n\n\t\tfor (let i = 0; i < style.length; i++) {\n\t\t\tconst prop = style[i];\n\t\t\tif (allowedProperties.includes(prop)) {\n\t\t\t\tconst value = style.getPropertyValue(prop);\n\t\t\t\t// Allow through lists of numbers with units or bare words like 'block'\n\t\t\t\t// Main goal is to block things like 'url()'.\n\t\t\t\tif (/^(([\\d\\.\\-]+\\w*\\s?)+|\\w+)$/.test(value)) {\n\t\t\t\t\tsanitizedProps.push(`${prop}: ${value}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sanitizedProps.join('; ');\n\t}\n\n\tprivate static sanitizeKatexStyles(styleString: string): string {\n\t\tconst allowedProperties = [\n\t\t\t'display',\n\t\t\t'position',\n\t\t\t'font-family',\n\t\t\t'font-style',\n\t\t\t'font-weight',\n\t\t\t'font-size',\n\t\t\t'height',\n\t\t\t'min-height',\n\t\t\t'max-height',\n\t\t\t'width',\n\t\t\t'min-width',\n\t\t\t'max-width',\n\t\t\t'margin',\n\t\t\t'margin-top',\n\t\t\t'margin-right',\n\t\t\t'margin-bottom',\n\t\t\t'margin-left',\n\t\t\t'padding',\n\t\t\t'padding-top',\n\t\t\t'padding-right',\n\t\t\t'padding-bottom',\n\t\t\t'padding-left',\n\t\t\t'top',\n\t\t\t'left',\n\t\t\t'right',\n\t\t\t'bottom',\n\t\t\t'vertical-align',\n\t\t\t'transform',\n\t\t\t'border',\n\t\t\t'border-top-width',\n\t\t\t'border-right-width',\n\t\t\t'border-bottom-width',\n\t\t\t'border-left-width',\n\t\t\t'color',\n\t\t\t'white-space',\n\t\t\t'text-align',\n\t\t\t'line-height',\n\t\t\t'float',\n\t\t\t'clear',\n\t\t];\n\t\treturn this.sanitizeStyles(styleString, allowedProperties);\n\t}\n\n\tprivate static _katex?: typeof import('katex').default;\n\tprivate static _katexPromise = new Lazy(async () => {\n\t\tthis._katex = await importAMDNodeModule<typeof import('katex').default>('katex', 'dist/katex.min.js');\n\t\treturn this._katex;\n\t});\n\n\tpublic static getExtension(window: CodeWindow, options: MarkedKatexExtension.MarkedKatexOptions = {}): marked.MarkedExtension | undefined {\n\t\tif (!this._katex) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis.ensureKatexStyles(window);\n\t\treturn MarkedKatexExtension.extension(this._katex, options);\n\t}\n\n\tpublic static async loadExtension(window: CodeWindow, options: MarkedKatexExtension.MarkedKatexOptions = {}): Promise<marked.MarkedExtension> {\n\t\tconst katex = await this._katexPromise.value;\n\t\tthis.ensureKatexStyles(window);\n\t\treturn MarkedKatexExtension.extension(katex, options);\n\t}\n\n\tpublic static ensureKatexStyles(window: CodeWindow) {\n\t\tconst doc = window.document;\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tif (!doc.querySelector('link.katex')) {\n\t\t\tconst katexStyle = document.createElement('link');\n\t\t\tkatexStyle.classList.add('katex');\n\t\t\tkatexStyle.rel = 'stylesheet';\n\t\t\tkatexStyle.href = resolveAmdNodeModulePath('katex', 'dist/katex.min.css');\n\t\t\tdoc.head.appendChild(katexStyle);\n\t\t}\n\t}\n}\n\nconst trustedMathMlTags = Object.freeze([\n\t'semantics',\n\t'annotation',\n\t'math',\n\t'menclose',\n\t'merror',\n\t'mfenced',\n\t'mfrac',\n\t'mglyph',\n\t'mi',\n\t'mlabeledtr',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msup',\n\t'msubsup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'mprescripts',\n\n\t// svg tags\n\t'svg',\n\t'altglyph',\n\t'altglyphdef',\n\t'altglyphitem',\n\t'circle',\n\t'clippath',\n\t'defs',\n\t'desc',\n\t'ellipse',\n\t'filter',\n\t'font',\n\t'g',\n\t'glyph',\n\t'glyphref',\n\t'hkern',\n\t'line',\n\t'lineargradient',\n\t'marker',\n\t'mask',\n\t'metadata',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialgradient',\n\t'rect',\n\t'stop',\n\t'style',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textpath',\n\t'title',\n\t'tref',\n\t'tspan',\n\t'view',\n\t'vkern',\n]);\n\n"]}