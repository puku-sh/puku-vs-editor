{"version":3,"sources":["vs/workbench/contrib/replNotebook/browser/replEditor.ts"],"names":[],"mappings":"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","file":"replEditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport './media/interactive.css';\nimport * as DOM from '../../../../base/browser/dom.js';\nimport * as domStylesheets from '../../../../base/browser/domStylesheets.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { CodeEditorWidget } from '../../../../editor/browser/widget/codeEditor/codeEditorWidget.js';\nimport { ICodeEditorViewState, ICompositeCodeEditor } from '../../../../editor/common/editorCommon.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { EditorPane } from '../../../browser/parts/editor/editorPane.js';\nimport { EditorPaneSelectionChangeReason, IEditorMemento, IEditorOpenContext, IEditorPaneScrollPosition, IEditorPaneSelectionChangeEvent, IEditorPaneWithScrolling } from '../../../common/editor.js';\nimport { getSimpleEditorOptions } from '../../codeEditor/browser/simpleEditorOptions.js';\nimport { ICellViewModel, INotebookEditorOptions, INotebookEditorViewState, INotebookViewCellsUpdateEvent } from '../../notebook/browser/notebookBrowser.js';\nimport { NotebookEditorExtensionsRegistry } from '../../notebook/browser/notebookEditorExtensions.js';\nimport { IBorrowValue, INotebookEditorService } from '../../notebook/browser/services/notebookEditorService.js';\nimport { getDefaultNotebookCreationOptions, NotebookEditorWidget } from '../../notebook/browser/notebookEditorWidget.js';\nimport { GroupsOrder, IEditorGroup, IEditorGroupsService } from '../../../services/editor/common/editorGroupsService.js';\nimport { ExecutionStateCellStatusBarContrib, TimerCellStatusBarContrib } from '../../notebook/browser/contrib/cellStatusBar/executionStatusBarItemController.js';\nimport { INotebookKernelService } from '../../notebook/common/notebookKernelService.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ReplEditorSettings, INTERACTIVE_INPUT_CURSOR_BOUNDARY } from '../../interactive/browser/interactiveCommon.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { NotebookOptions } from '../../notebook/browser/notebookOptions.js';\nimport { ToolBar } from '../../../../base/browser/ui/toolbar/toolbar.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { createActionViewItem, getActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { EditorExtensionsRegistry } from '../../../../editor/browser/editorExtensions.js';\nimport { SelectionClipboardContributionID } from '../../codeEditor/browser/selectionClipboard.js';\nimport { ContextMenuController } from '../../../../editor/contrib/contextmenu/browser/contextmenu.js';\nimport { SuggestController } from '../../../../editor/contrib/suggest/browser/suggestController.js';\nimport { MarkerController } from '../../../../editor/contrib/gotoError/browser/gotoError.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { ITextEditorOptions, TextEditorSelectionSource } from '../../../../platform/editor/common/editor.js';\nimport { INotebookExecutionStateService, NotebookExecutionType } from '../../notebook/common/notebookExecutionStateService.js';\nimport { NOTEBOOK_KERNEL } from '../../notebook/common/notebookContextKeys.js';\nimport { ICursorPositionChangedEvent } from '../../../../editor/common/cursorEvents.js';\nimport { IExtensionService } from '../../../services/extensions/common/extensions.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { NotebookFindContrib } from '../../notebook/browser/contrib/find/notebookFindWidget.js';\nimport { REPL_EDITOR_ID } from '../../notebook/common/notebookCommon.js';\nimport './interactiveEditor.css';\nimport { IEditorOptions } from '../../../../editor/common/config/editorOptions.js';\nimport { deepClone } from '../../../../base/common/objects.js';\nimport { GlyphHoverController } from '../../../../editor/contrib/hover/browser/glyphHoverController.js';\nimport { ContentHoverController } from '../../../../editor/contrib/hover/browser/contentHoverController.js';\nimport { ReplEditorInput } from './replEditorInput.js';\nimport { ReplInputHintContentWidget } from '../../interactive/browser/replInputHintContentWidget.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { localize } from '../../../../nls.js';\nimport { NotebookViewModel } from '../../notebook/browser/viewModel/notebookViewModelImpl.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\n\nconst INTERACTIVE_EDITOR_VIEW_STATE_PREFERENCE_KEY = 'InteractiveEditorViewState';\n\nconst INPUT_CELL_VERTICAL_PADDING = 8;\nconst INPUT_CELL_HORIZONTAL_PADDING_RIGHT = 10;\nconst INPUT_EDITOR_PADDING = 8;\n\nexport interface InteractiveEditorViewState {\n\treadonly notebook?: INotebookEditorViewState;\n\treadonly input?: ICodeEditorViewState | null;\n}\n\nexport interface InteractiveEditorOptions extends ITextEditorOptions {\n\treadonly viewState?: InteractiveEditorViewState;\n}\n\nexport class ReplEditor extends EditorPane implements IEditorPaneWithScrolling {\n\tprivate _rootElement!: HTMLElement;\n\tprivate _styleElement!: HTMLStyleElement;\n\tprivate _notebookEditorContainer!: HTMLElement;\n\tprivate _notebookWidget: IBorrowValue<NotebookEditorWidget> = { value: undefined };\n\tprivate _inputCellContainer!: HTMLElement;\n\tprivate _inputFocusIndicator!: HTMLElement;\n\tprivate _inputRunButtonContainer!: HTMLElement;\n\tprivate _inputEditorContainer!: HTMLElement;\n\tprivate _codeEditorWidget!: CodeEditorWidget;\n\tprivate _notebookWidgetService: INotebookEditorService;\n\tprivate _instantiationService: IInstantiationService;\n\tprivate _languageService: ILanguageService;\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _configurationService: IConfigurationService;\n\tprivate _notebookKernelService: INotebookKernelService;\n\tprivate _keybindingService: IKeybindingService;\n\tprivate _menuService: IMenuService;\n\tprivate _contextMenuService: IContextMenuService;\n\tprivate _editorGroupService: IEditorGroupsService;\n\tprivate _extensionService: IExtensionService;\n\tprivate readonly _widgetDisposableStore: DisposableStore = this._register(new DisposableStore());\n\tprivate _lastLayoutDimensions?: { readonly dimension: DOM.Dimension; readonly position: DOM.IDomPosition };\n\tprivate _editorOptions: IEditorOptions;\n\tprivate _notebookOptions: NotebookOptions;\n\tprivate _editorMemento: IEditorMemento<InteractiveEditorViewState>;\n\tprivate readonly _groupListener = this._register(new MutableDisposable());\n\tprivate _runbuttonToolbar: ToolBar | undefined;\n\tprivate _hintElement: ReplInputHintContentWidget | undefined;\n\n\tprivate _onDidFocusWidget = this._register(new Emitter<void>());\n\toverride get onDidFocus(): Event<void> { return this._onDidFocusWidget.event; }\n\tprivate _onDidChangeSelection = this._register(new Emitter<IEditorPaneSelectionChangeEvent>());\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\tprivate _onDidChangeScroll = this._register(new Emitter<void>());\n\treadonly onDidChangeScroll = this._onDidChangeScroll.event;\n\n\tconstructor(\n\t\tgroup: IEditorGroup,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@INotebookEditorService notebookWidgetService: INotebookEditorService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@INotebookKernelService notebookKernelService: INotebookKernelService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@INotebookExecutionStateService notebookExecutionStateService: INotebookExecutionStateService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper(\n\t\t\tREPL_EDITOR_ID,\n\t\t\tgroup,\n\t\t\ttelemetryService,\n\t\t\tthemeService,\n\t\t\tstorageService\n\t\t);\n\t\tthis._notebookWidgetService = notebookWidgetService;\n\t\tthis._configurationService = configurationService;\n\t\tthis._notebookKernelService = notebookKernelService;\n\t\tthis._languageService = languageService;\n\t\tthis._keybindingService = keybindingService;\n\t\tthis._menuService = menuService;\n\t\tthis._contextMenuService = contextMenuService;\n\t\tthis._editorGroupService = editorGroupService;\n\t\tthis._extensionService = extensionService;\n\n\t\tthis._rootElement = DOM.$('.interactive-editor');\n\t\tthis._contextKeyService = this._register(contextKeyService.createScoped(this._rootElement));\n\t\tthis._contextKeyService.createKey('isCompositeNotebook', true);\n\t\tthis._instantiationService = this._register(instantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService])));\n\n\t\tthis._editorOptions = this._computeEditorOptions();\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor') || e.affectsConfiguration('notebook')) {\n\t\t\t\tthis._editorOptions = this._computeEditorOptions();\n\t\t\t}\n\t\t}));\n\t\tthis._notebookOptions = instantiationService.createInstance(NotebookOptions, this.window, true, { cellToolbarInteraction: 'hover', globalToolbar: true, stickyScrollEnabled: false, dragAndDropEnabled: false, disableRulers: true });\n\t\tthis._editorMemento = this.getEditorMemento<InteractiveEditorViewState>(editorGroupService, textResourceConfigurationService, INTERACTIVE_EDITOR_VIEW_STATE_PREFERENCE_KEY);\n\n\t\tthis._register(this._keybindingService.onDidUpdateKeybindings(this._updateInputHint, this));\n\t\tthis._register(notebookExecutionStateService.onDidChangeExecution((e) => {\n\t\t\tif (e.type === NotebookExecutionType.cell && isEqual(e.notebook, this._notebookWidget.value?.viewModel?.notebookDocument.uri)) {\n\t\t\t\tconst cell = this._notebookWidget.value?.getCellByHandle(e.cellHandle);\n\t\t\t\tif (cell && e.changed?.state) {\n\t\t\t\t\tthis._scrollIfNecessary(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate get inputCellContainerHeight() {\n\t\treturn 19 + 2 + INPUT_CELL_VERTICAL_PADDING * 2 + INPUT_EDITOR_PADDING * 2;\n\t}\n\n\tprivate get inputCellEditorHeight() {\n\t\treturn 19 + INPUT_EDITOR_PADDING * 2;\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tDOM.append(parent, this._rootElement);\n\t\tthis._rootElement.style.position = 'relative';\n\t\tthis._notebookEditorContainer = DOM.append(this._rootElement, DOM.$('.notebook-editor-container'));\n\t\tthis._inputCellContainer = DOM.append(this._rootElement, DOM.$('.input-cell-container'));\n\t\tthis._inputCellContainer.style.position = 'absolute';\n\t\tthis._inputCellContainer.style.height = `${this.inputCellContainerHeight}px`;\n\t\tthis._inputFocusIndicator = DOM.append(this._inputCellContainer, DOM.$('.input-focus-indicator'));\n\t\tthis._inputRunButtonContainer = DOM.append(this._inputCellContainer, DOM.$('.run-button-container'));\n\t\tthis._setupRunButtonToolbar(this._inputRunButtonContainer);\n\t\tthis._inputEditorContainer = DOM.append(this._inputCellContainer, DOM.$('.input-editor-container'));\n\t\tthis._createLayoutStyles();\n\t}\n\n\tprivate _setupRunButtonToolbar(runButtonContainer: HTMLElement) {\n\t\tconst menu = this._register(this._menuService.createMenu(MenuId.ReplInputExecute, this._contextKeyService));\n\t\tthis._runbuttonToolbar = this._register(new ToolBar(runButtonContainer, this._contextMenuService, {\n\t\t\tgetKeyBinding: action => this._keybindingService.lookupKeybinding(action.id),\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\treturn createActionViewItem(this._instantiationService, action, options);\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true\n\t\t}));\n\n\t\tconst { primary, secondary } = getActionBarActions(menu.getActions({ shouldForwardArgs: true }));\n\t\tthis._runbuttonToolbar.setActions([...primary, ...secondary]);\n\t}\n\n\tprivate _createLayoutStyles(): void {\n\t\tthis._styleElement = domStylesheets.createStyleSheet(this._rootElement);\n\t\tconst styleSheets: string[] = [];\n\n\t\tconst {\n\t\t\tcodeCellLeftMargin,\n\t\t\tcellRunGutter\n\t\t} = this._notebookOptions.getLayoutConfiguration();\n\t\tconst {\n\t\t\tfocusIndicator\n\t\t} = this._notebookOptions.getDisplayOptions();\n\t\tconst leftMargin = this._notebookOptions.getCellEditorContainerLeftMargin();\n\n\t\tstyleSheets.push(`\n\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\tpadding: ${INPUT_CELL_VERTICAL_PADDING}px ${INPUT_CELL_HORIZONTAL_PADDING_RIGHT}px ${INPUT_CELL_VERTICAL_PADDING}px ${leftMargin}px;\n\t\t\t}\n\t\t`);\n\t\tif (focusIndicator === 'gutter') {\n\t\t\tstyleSheets.push(`\n\t\t\t\t.interactive-editor .input-cell-container:focus-within .input-focus-indicator::before {\n\t\t\t\t\tborder-color: var(--vscode-notebook-focusedCellBorder) !important;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-focus-indicator::before {\n\t\t\t\t\tborder-color: var(--vscode-notebook-inactiveFocusedCellBorder) !important;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container .input-focus-indicator {\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\ttop: ${INPUT_CELL_VERTICAL_PADDING}px;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\t\tborder-top: 1px solid var(--vscode-notebook-inactiveFocusedCellBorder);\n\t\t\t\t}\n\t\t\t`);\n\t\t} else {\n\t\t\t// border\n\t\t\tstyleSheets.push(`\n\t\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\t\tborder-top: 1px solid var(--vscode-notebook-inactiveFocusedCellBorder);\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container .input-focus-indicator {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\tstyleSheets.push(`\n\t\t\t.interactive-editor .input-cell-container .run-button-container {\n\t\t\t\twidth: ${cellRunGutter}px;\n\t\t\t\tleft: ${codeCellLeftMargin}px;\n\t\t\t\tmargin-top: ${INPUT_EDITOR_PADDING - 2}px;\n\t\t\t}\n\t\t`);\n\n\t\tthis._styleElement.textContent = styleSheets.join('\\n');\n\t}\n\n\tprivate _computeEditorOptions(): IEditorOptions {\n\t\tlet overrideIdentifier: string | undefined = undefined;\n\t\tif (this._codeEditorWidget) {\n\t\t\toverrideIdentifier = this._codeEditorWidget.getModel()?.getLanguageId();\n\t\t}\n\t\tconst editorOptions = deepClone(this._configurationService.getValue<IEditorOptions>('editor', { overrideIdentifier }));\n\t\tconst editorOptionsOverride = getSimpleEditorOptions(this._configurationService);\n\t\tconst computed = Object.freeze({\n\t\t\t...editorOptions,\n\t\t\t...editorOptionsOverride,\n\t\t\t...{\n\t\t\t\tariaLabel: localize('replEditorInput', \"REPL Input\"),\n\t\t\t\tglyphMargin: true,\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: INPUT_EDITOR_PADDING,\n\t\t\t\t\tbottom: INPUT_EDITOR_PADDING\n\t\t\t\t},\n\t\t\t\thover: {\n\t\t\t\t\tenabled: 'on' as const\n\t\t\t\t},\n\t\t\t\trulers: []\n\t\t\t}\n\t\t});\n\n\t\treturn computed;\n\t}\n\n\tprotected override saveState(): void {\n\t\tthis._saveEditorViewState(this.input);\n\t\tsuper.saveState();\n\t}\n\n\toverride getViewState(): InteractiveEditorViewState | undefined {\n\t\tconst input = this.input;\n\t\tif (!(input instanceof ReplEditorInput)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._saveEditorViewState(input);\n\t\treturn this._loadNotebookEditorViewState(input);\n\t}\n\n\tprivate _saveEditorViewState(input: EditorInput | undefined): void {\n\t\tif (this._notebookWidget.value && input instanceof ReplEditorInput) {\n\t\t\tif (this._notebookWidget.value.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst state = this._notebookWidget.value.getEditorViewState();\n\t\t\tconst editorState = this._codeEditorWidget.saveViewState();\n\t\t\tthis._editorMemento.saveEditorState(this.group, input.resource, {\n\t\t\t\tnotebook: state,\n\t\t\t\tinput: editorState\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _loadNotebookEditorViewState(input: ReplEditorInput): InteractiveEditorViewState | undefined {\n\t\tconst result = this._editorMemento.loadEditorState(this.group, input.resource);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\t// when we don't have a view state for the group/input-tuple then we try to use an existing\n\t\t// editor for the same resource.\n\t\tfor (const group of this._editorGroupService.getGroups(GroupsOrder.MOST_RECENTLY_ACTIVE)) {\n\t\t\tif (group.activeEditorPane !== this && group.activeEditorPane === this && group.activeEditor?.matches(input)) {\n\t\t\t\tconst notebook = this._notebookWidget.value?.getEditorViewState();\n\t\t\t\tconst input = this._codeEditorWidget.saveViewState();\n\t\t\t\treturn {\n\t\t\t\t\tnotebook,\n\t\t\t\t\tinput\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\toverride async setInput(input: ReplEditorInput, options: InteractiveEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\t// there currently is a widget which we still own so\n\t\t// we need to hide it before getting a new widget\n\t\tthis._notebookWidget.value?.onWillHide();\n\n\t\tthis._codeEditorWidget?.dispose();\n\n\t\tthis._widgetDisposableStore.clear();\n\n\t\tthis._notebookWidget = <IBorrowValue<NotebookEditorWidget>>this._instantiationService.invokeFunction(this._notebookWidgetService.retrieveWidget, this.group.id, input, {\n\t\t\tisReplHistory: true,\n\t\t\tisReadOnly: true,\n\t\t\tcontributions: NotebookEditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tExecutionStateCellStatusBarContrib.id,\n\t\t\t\tTimerCellStatusBarContrib.id,\n\t\t\t\tNotebookFindContrib.id\n\t\t\t]),\n\t\t\tmenuIds: {\n\t\t\t\tnotebookToolbar: MenuId.InteractiveToolbar,\n\t\t\t\tcellTitleToolbar: MenuId.InteractiveCellTitle,\n\t\t\t\tcellDeleteToolbar: MenuId.InteractiveCellDelete,\n\t\t\t\tcellInsertToolbar: MenuId.NotebookCellBetween,\n\t\t\t\tcellTopInsertToolbar: MenuId.NotebookCellListTop,\n\t\t\t\tcellExecuteToolbar: MenuId.InteractiveCellExecute,\n\t\t\t\tcellExecutePrimary: undefined\n\t\t\t},\n\t\t\tcellEditorContributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\t\t\t\tContentHoverController.ID,\n\t\t\t\tGlyphHoverController.ID,\n\t\t\t\tMarkerController.ID\n\t\t\t]),\n\t\t\toptions: this._notebookOptions,\n\t\t\tcodeWindow: this.window\n\t\t}, undefined, this.window);\n\n\t\tconst skipContributions = [\n\t\t\t'workbench.notebook.cellToolbar',\n\t\t\t'editor.contrib.inlineCompletionsController'\n\t\t];\n\n\t\tconst inputContributions = getDefaultNotebookCreationOptions().cellEditorContributions?.filter(c => skipContributions.indexOf(c.id) === -1);\n\t\tthis._codeEditorWidget = this._instantiationService.createInstance(CodeEditorWidget, this._inputEditorContainer, this._editorOptions, {\n\t\t\t...{\n\t\t\t\tisSimpleWidget: false,\n\t\t\t\tcontributions: inputContributions,\n\t\t\t}\n\t\t});\n\n\t\tif (this._lastLayoutDimensions) {\n\t\t\tthis._notebookEditorContainer.style.height = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\t\tthis._notebookWidget.value!.layout(new DOM.Dimension(this._lastLayoutDimensions.dimension.width, this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight), this._notebookEditorContainer);\n\t\t\tconst leftMargin = this._notebookOptions.getCellEditorContainerLeftMargin();\n\t\t\tconst maxHeight = Math.min(this._lastLayoutDimensions.dimension.height / 2, this.inputCellEditorHeight);\n\t\t\tthis._codeEditorWidget.layout(this._validateDimension(this._lastLayoutDimensions.dimension.width - leftMargin - INPUT_CELL_HORIZONTAL_PADDING_RIGHT, maxHeight));\n\t\t\tthis._inputFocusIndicator.style.height = `${this.inputCellEditorHeight}px`;\n\t\t\tthis._inputCellContainer.style.top = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\t\tthis._inputCellContainer.style.width = `${this._lastLayoutDimensions.dimension.width}px`;\n\t\t}\n\n\t\tawait super.setInput(input, options, context, token);\n\t\tconst model = await input.resolve();\n\t\tif (this._runbuttonToolbar) {\n\t\t\tthis._runbuttonToolbar.context = input.resource;\n\t\t}\n\n\t\tif (model === null) {\n\t\t\tthrow new Error('The REPL model could not be resolved');\n\t\t}\n\n\t\tthis._notebookWidget.value?.setParentContextKeyService(this._contextKeyService);\n\n\t\tconst viewState = options?.viewState ?? this._loadNotebookEditorViewState(input);\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tawait this._notebookWidget.value!.setModel(model.notebook, viewState?.notebook, undefined, 'repl');\n\t\tmodel.notebook.setCellCollapseDefault(this._notebookOptions.getCellCollapseDefault());\n\t\tthis._notebookWidget.value!.setOptions({\n\t\t\tisReadOnly: true\n\t\t});\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidResizeOutput((cvm) => {\n\t\t\tthis._scrollIfNecessary(cvm);\n\t\t}));\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidFocusWidget(() => this._onDidFocusWidget.fire()));\n\t\tthis._widgetDisposableStore.add(this._notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.compactView || e.focusIndicator) {\n\t\t\t\t// update the styling\n\t\t\t\tthis._styleElement?.remove();\n\t\t\t\tthis._createLayoutStyles();\n\t\t\t}\n\n\t\t\tif (this._lastLayoutDimensions && this.isVisible()) {\n\t\t\t\tthis.layout(this._lastLayoutDimensions.dimension, this._lastLayoutDimensions.position);\n\t\t\t}\n\n\t\t\tif (e.interactiveWindowCollapseCodeCells) {\n\t\t\t\tmodel.notebook.setCellCollapseDefault(this._notebookOptions.getCellCollapseDefault());\n\t\t\t}\n\t\t}));\n\n\t\tconst editorModel = await input.resolveInput(model.notebook);\n\t\tthis._codeEditorWidget.setModel(editorModel);\n\t\tif (viewState?.input) {\n\t\t\tthis._codeEditorWidget.restoreViewState(viewState.input);\n\t\t}\n\t\tthis._editorOptions = this._computeEditorOptions();\n\t\tthis._codeEditorWidget.updateOptions(this._editorOptions);\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidFocusEditorWidget(() => this._onDidFocusWidget.fire()));\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidContentSizeChange(e => {\n\t\t\tif (!e.contentHeightChanged) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._lastLayoutDimensions) {\n\t\t\t\tthis._layoutWidgets(this._lastLayoutDimensions.dimension, this._lastLayoutDimensions.position);\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeCursorPosition(e => this._onDidChangeSelection.fire({ reason: this._toEditorPaneSelectionChangeReason(e) })));\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeModelContent(() => this._onDidChangeSelection.fire({ reason: EditorPaneSelectionChangeReason.EDIT })));\n\n\n\t\tthis._widgetDisposableStore.add(this._notebookKernelService.onDidChangeNotebookAffinity(this._syncWithKernel, this));\n\t\tthis._widgetDisposableStore.add(this._notebookKernelService.onDidChangeSelectedNotebooks(this._syncWithKernel, this));\n\n\t\tthis._widgetDisposableStore.add(this.themeService.onDidColorThemeChange(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis._updateInputHint();\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeModelContent(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis._updateInputHint();\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeModelDecorations(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis._updateInputHint();\n\t\t\t}\n\t\t}));\n\n\t\tconst cursorAtBoundaryContext = INTERACTIVE_INPUT_CURSOR_BOUNDARY.bindTo(this._contextKeyService);\n\t\tif (input.resource && input.historyService.has(input.resource)) {\n\t\t\tcursorAtBoundaryContext.set('top');\n\t\t} else {\n\t\t\tcursorAtBoundaryContext.set('none');\n\t\t}\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeCursorPosition(({ position }) => {\n\t\t\tconst viewModel = this._codeEditorWidget._getViewModel()!;\n\t\t\tconst lastLineNumber = viewModel.getLineCount();\n\t\t\tconst lastLineCol = viewModel.getLineLength(lastLineNumber) + 1;\n\t\t\tconst viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(position);\n\t\t\tconst firstLine = viewPosition.lineNumber === 1 && viewPosition.column === 1;\n\t\t\tconst lastLine = viewPosition.lineNumber === lastLineNumber && viewPosition.column === lastLineCol;\n\n\t\t\tif (firstLine) {\n\t\t\t\tif (lastLine) {\n\t\t\t\t\tcursorAtBoundaryContext.set('both');\n\t\t\t\t} else {\n\t\t\t\t\tcursorAtBoundaryContext.set('top');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (lastLine) {\n\t\t\t\t\tcursorAtBoundaryContext.set('bottom');\n\t\t\t\t} else {\n\t\t\t\t\tcursorAtBoundaryContext.set('none');\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(editorModel.onDidChangeContent(() => {\n\t\t\tconst value = editorModel.getValue();\n\t\t\tif (this.input?.resource && value !== '') {\n\t\t\t\tconst historyService = (this.input as ReplEditorInput).historyService;\n\t\t\t\tif (!historyService.matchesCurrent(this.input.resource, value)) {\n\t\t\t\t\thistoryService.replaceLast(this.input.resource, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidScroll(() => this._onDidChangeScroll.fire()));\n\n\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidChangeViewCells(this.handleViewCellChange, this));\n\n\t\tthis._updateInputHint();\n\t\tthis._syncWithKernel();\n\t}\n\n\tprivate handleViewCellChange(e: INotebookViewCellsUpdateEvent) {\n\t\tconst notebookWidget = this._notebookWidget.value;\n\t\tif (!notebookWidget) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const splice of e.splices) {\n\t\t\tconst [_start, _delete, addedCells] = splice;\n\t\t\tif (addedCells.length) {\n\t\t\t\tconst viewModel = notebookWidget.viewModel;\n\t\t\t\tif (viewModel) {\n\t\t\t\t\tthis.handleAppend(notebookWidget, viewModel);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleAppend(notebookWidget: NotebookEditorWidget, viewModel: NotebookViewModel) {\n\t\tthis._notebookWidgetService.updateReplContextKey(viewModel.notebookDocument.uri.toString());\n\t\tconst navigateToCell = this._configurationService.getValue('accessibility.replEditor.autoFocusReplExecution');\n\t\tif (this._accessibilityService.isScreenReaderOptimized()) {\n\t\t\tif (navigateToCell === 'lastExecution') {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst lastCellIndex = viewModel.length - 1;\n\t\t\t\t\tif (lastCellIndex >= 0) {\n\t\t\t\t\t\tconst cell = viewModel.viewCells[lastCellIndex];\n\t\t\t\t\t\tnotebookWidget.focusNotebookCell(cell, 'container');\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t} else if (navigateToCell === 'input') {\n\t\t\t\tthis._codeEditorWidget.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\toverride setOptions(options: INotebookEditorOptions | undefined): void {\n\t\tthis._notebookWidget.value?.setOptions(options);\n\t\tsuper.setOptions(options);\n\t}\n\n\tprivate _toEditorPaneSelectionChangeReason(e: ICursorPositionChangedEvent): EditorPaneSelectionChangeReason {\n\t\tswitch (e.source) {\n\t\t\tcase TextEditorSelectionSource.PROGRAMMATIC: return EditorPaneSelectionChangeReason.PROGRAMMATIC;\n\t\t\tcase TextEditorSelectionSource.NAVIGATION: return EditorPaneSelectionChangeReason.NAVIGATION;\n\t\t\tcase TextEditorSelectionSource.JUMP: return EditorPaneSelectionChangeReason.JUMP;\n\t\t\tdefault: return EditorPaneSelectionChangeReason.USER;\n\t\t}\n\t}\n\n\tprivate _cellAtBottom(cell: ICellViewModel): boolean {\n\t\tconst visibleRanges = this._notebookWidget.value?.visibleRanges || [];\n\t\tconst cellIndex = this._notebookWidget.value?.getCellIndex(cell);\n\t\tif (cellIndex === Math.max(...visibleRanges.map(range => range.end - 1))) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _scrollIfNecessary(cvm: ICellViewModel) {\n\t\tconst index = this._notebookWidget.value!.getCellIndex(cvm);\n\t\tif (index === this._notebookWidget.value!.getLength() - 1) {\n\t\t\t// If we're already at the bottom or auto scroll is enabled, scroll to the bottom\n\t\t\tif (this._configurationService.getValue<boolean>(ReplEditorSettings.interactiveWindowAlwaysScrollOnNewCell) || this._cellAtBottom(cvm)) {\n\t\t\t\tthis._notebookWidget.value!.scrollToBottom();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _syncWithKernel() {\n\t\tconst notebook = this._notebookWidget.value?.textModel;\n\t\tconst textModel = this._codeEditorWidget.getModel();\n\n\t\tif (notebook && textModel) {\n\t\t\tconst info = this._notebookKernelService.getMatchingKernel(notebook);\n\t\t\tconst selectedOrSuggested = info.selected\n\t\t\t\t?? (info.suggestions.length === 1 ? info.suggestions[0] : undefined)\n\t\t\t\t?? (info.all.length === 1 ? info.all[0] : undefined);\n\n\t\t\tif (selectedOrSuggested) {\n\t\t\t\tconst language = selectedOrSuggested.supportedLanguages[0];\n\t\t\t\t// All kernels will initially list plaintext as the supported language before they properly initialized.\n\t\t\t\tif (language && language !== 'plaintext') {\n\t\t\t\t\tconst newMode = this._languageService.createById(language).languageId;\n\t\t\t\t\ttextModel.setLanguage(newMode);\n\t\t\t\t}\n\n\t\t\t\tNOTEBOOK_KERNEL.bindTo(this._contextKeyService).set(selectedOrSuggested.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout(dimension: DOM.Dimension, position: DOM.IDomPosition): void {\n\t\tthis._rootElement.classList.toggle('mid-width', dimension.width < 1000 && dimension.width >= 600);\n\t\tthis._rootElement.classList.toggle('narrow-width', dimension.width < 600);\n\t\tconst editorHeightChanged = dimension.height !== this._lastLayoutDimensions?.dimension.height;\n\t\tthis._lastLayoutDimensions = { dimension, position };\n\n\t\tif (!this._notebookWidget.value) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (editorHeightChanged && this._codeEditorWidget) {\n\t\t\tSuggestController.get(this._codeEditorWidget)?.cancelSuggestWidget();\n\t\t}\n\n\t\tthis._notebookEditorContainer.style.height = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\tthis._layoutWidgets(dimension, position);\n\t}\n\n\tprivate _layoutWidgets(dimension: DOM.Dimension, position: DOM.IDomPosition) {\n\t\tconst contentHeight = this._codeEditorWidget.hasModel() ? this._codeEditorWidget.getContentHeight() : this.inputCellEditorHeight;\n\t\tconst maxHeight = Math.min(dimension.height / 2, contentHeight);\n\t\tconst leftMargin = this._notebookOptions.getCellEditorContainerLeftMargin();\n\n\t\tconst inputCellContainerHeight = maxHeight + INPUT_CELL_VERTICAL_PADDING * 2;\n\t\tthis._notebookEditorContainer.style.height = `${dimension.height - inputCellContainerHeight}px`;\n\n\t\tthis._notebookWidget.value!.layout(dimension.with(dimension.width, dimension.height - inputCellContainerHeight), this._notebookEditorContainer, position);\n\t\tthis._codeEditorWidget.layout(this._validateDimension(dimension.width - leftMargin - INPUT_CELL_HORIZONTAL_PADDING_RIGHT, maxHeight));\n\t\tthis._inputFocusIndicator.style.height = `${contentHeight}px`;\n\t\tthis._inputCellContainer.style.top = `${dimension.height - inputCellContainerHeight}px`;\n\t\tthis._inputCellContainer.style.width = `${dimension.width}px`;\n\t}\n\n\tprivate _validateDimension(width: number, height: number) {\n\t\treturn new DOM.Dimension(Math.max(0, width), Math.max(0, height));\n\t}\n\n\tprivate _hasConflictingDecoration() {\n\t\treturn Boolean(this._codeEditorWidget.getLineDecorations(1)?.find((d) =>\n\t\t\td.options.beforeContentClassName\n\t\t\t|| d.options.afterContentClassName\n\t\t\t|| d.options.before?.content\n\t\t\t|| d.options.after?.content\n\t\t));\n\t}\n\n\tprivate _updateInputHint(): void {\n\t\tif (!this._codeEditorWidget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst shouldHide =\n\t\t\t!this._codeEditorWidget.hasModel() ||\n\t\t\tthis._configurationService.getValue<boolean>(ReplEditorSettings.showExecutionHint) === false ||\n\t\t\tthis._codeEditorWidget.getModel()!.getValueLength() !== 0 ||\n\t\t\tthis._hasConflictingDecoration();\n\n\t\tif (!this._hintElement && !shouldHide) {\n\t\t\tthis._hintElement = this._instantiationService.createInstance(ReplInputHintContentWidget, this._codeEditorWidget);\n\t\t} else if (this._hintElement && shouldHide) {\n\t\t\tthis._hintElement.dispose();\n\t\t\tthis._hintElement = undefined;\n\t\t}\n\t}\n\n\tgetScrollPosition(): IEditorPaneScrollPosition {\n\t\treturn {\n\t\t\tscrollTop: this._notebookWidget.value?.scrollTop ?? 0,\n\t\t\tscrollLeft: 0\n\t\t};\n\t}\n\n\tsetScrollPosition(position: IEditorPaneScrollPosition): void {\n\t\tthis._notebookWidget.value?.setScrollTop(position.scrollTop);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\n\t\tthis._notebookWidget.value?.onShow();\n\t\tthis._codeEditorWidget.focus();\n\t}\n\n\tfocusHistory() {\n\t\tthis._notebookWidget.value!.focus();\n\t}\n\n\tprotected override setEditorVisible(visible: boolean): void {\n\t\tsuper.setEditorVisible(visible);\n\t\tthis._groupListener.value = this.group.onWillCloseEditor(e => this._saveEditorViewState(e.editor));\n\n\t\tif (!visible) {\n\t\t\tthis._saveEditorViewState(this.input);\n\t\t\tif (this.input && this._notebookWidget.value) {\n\t\t\t\tthis._notebookWidget.value.onWillHide();\n\t\t\t}\n\t\t}\n\n\t\tthis._updateInputHint();\n\t}\n\n\toverride clearInput() {\n\t\tif (this._notebookWidget.value) {\n\t\t\tthis._saveEditorViewState(this.input);\n\t\t\tthis._notebookWidget.value.onWillHide();\n\t\t}\n\n\t\tthis._codeEditorWidget?.dispose();\n\n\t\tthis._notebookWidget = { value: undefined };\n\t\tthis._widgetDisposableStore.clear();\n\n\t\tsuper.clearInput();\n\t}\n\n\toverride getControl(): ReplEditorControl & ICompositeCodeEditor {\n\t\treturn {\n\t\t\tnotebookEditor: this._notebookWidget.value,\n\t\t\tactiveCodeEditor: this.getActiveCodeEditor(),\n\t\t\tonDidChangeActiveEditor: Event.None\n\t\t};\n\t}\n\n\tprivate getActiveCodeEditor() {\n\t\tif (!this._codeEditorWidget) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._codeEditorWidget.hasWidgetFocus() || !this._notebookWidget.value?.activeCodeEditor ?\n\t\t\tthis._codeEditorWidget :\n\t\t\tthis._notebookWidget.value.activeCodeEditor;\n\t}\n}\n\nexport type ReplEditorControl = { activeCodeEditor: ICodeEditor | undefined; notebookEditor: NotebookEditorWidget | undefined };\n\nexport function isReplEditorControl(control: unknown): control is ReplEditorControl {\n\tconst candidate = control as ReplEditorControl;\n\treturn candidate?.activeCodeEditor instanceof CodeEditorWidget && candidate?.notebookEditor instanceof NotebookEditorWidget;\n}\n"]}