{"version":3,"sources":["vs/workbench/contrib/mcp/browser/mcpCommandsAddConfiguration.ts"],"names":[],"mappings":"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","file":"mcpCommandsAddConfiguration.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mapFindFirst } from '../../../../base/common/arraysFind.js';\nimport { assertNever } from '../../../../base/common/assert.js';\nimport { disposableTimeout } from '../../../../base/common/async.js';\nimport { parse as parseJsonc } from '../../../../base/common/jsonc.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { autorun } from '../../../../base/common/observable.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { localize } from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ConfigurationTarget, IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IMcpRemoteServerConfiguration, IMcpServerConfiguration, IMcpServerVariable, IMcpStdioServerConfiguration, McpServerType } from '../../../../platform/mcp/common/mcpPlatformTypes.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IQuickInputService, IQuickPickItem, QuickPickInput } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { isWorkspaceFolder, IWorkspaceContextService, IWorkspaceFolder, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IWorkbenchEnvironmentService } from '../../../services/environment/common/environmentService.js';\nimport { IWorkbenchMcpManagementService } from '../../../services/mcp/common/mcpWorkbenchManagementService.js';\nimport { McpCommandIds } from '../common/mcpCommandIds.js';\nimport { allDiscoverySources, DiscoverySource, mcpDiscoverySection, mcpStdioServerSchema } from '../common/mcpConfiguration.js';\nimport { IMcpRegistry } from '../common/mcpRegistryTypes.js';\nimport { IMcpService, McpConnectionState } from '../common/mcpTypes.js';\n\nexport const enum AddConfigurationType {\n\tStdio,\n\tHTTP,\n\n\tNpmPackage,\n\tPipPackage,\n\tNuGetPackage,\n\tDockerImage,\n}\n\ntype AssistedConfigurationType = AddConfigurationType.NpmPackage | AddConfigurationType.PipPackage | AddConfigurationType.NuGetPackage | AddConfigurationType.DockerImage;\n\nexport const AssistedTypes = {\n\t[AddConfigurationType.NpmPackage]: {\n\t\ttitle: localize('mcp.npm.title', \"Enter NPM Package Name\"),\n\t\tplaceholder: localize('mcp.npm.placeholder', \"Package name (e.g., @org/package)\"),\n\t\tpickLabel: localize('mcp.serverType.npm', \"NPM Package\"),\n\t\tpickDescription: localize('mcp.serverType.npm.description', \"Install from an NPM package name\"),\n\t\tenabledConfigKey: null, // always enabled\n\t},\n\t[AddConfigurationType.PipPackage]: {\n\t\ttitle: localize('mcp.pip.title', \"Enter Pip Package Name\"),\n\t\tplaceholder: localize('mcp.pip.placeholder', \"Package name (e.g., package-name)\"),\n\t\tpickLabel: localize('mcp.serverType.pip', \"Pip Package\"),\n\t\tpickDescription: localize('mcp.serverType.pip.description', \"Install from a Pip package name\"),\n\t\tenabledConfigKey: null, // always enabled\n\t},\n\t[AddConfigurationType.NuGetPackage]: {\n\t\ttitle: localize('mcp.nuget.title', \"Enter NuGet Package Name\"),\n\t\tplaceholder: localize('mcp.nuget.placeholder', \"Package name (e.g., Package.Name)\"),\n\t\tpickLabel: localize('mcp.serverType.nuget', \"NuGet Package\"),\n\t\tpickDescription: localize('mcp.serverType.nuget.description', \"Install from a NuGet package name\"),\n\t\tenabledConfigKey: 'chat.mcp.assisted.nuget.enabled',\n\t},\n\t[AddConfigurationType.DockerImage]: {\n\t\ttitle: localize('mcp.docker.title', \"Enter Docker Image Name\"),\n\t\tplaceholder: localize('mcp.docker.placeholder', \"Image name (e.g., mcp/imagename)\"),\n\t\tpickLabel: localize('mcp.serverType.docker', \"Docker Image\"),\n\t\tpickDescription: localize('mcp.serverType.docker.description', \"Install from a Docker image\"),\n\t\tenabledConfigKey: null, // always enabled\n\t},\n};\n\nconst enum AddConfigurationCopilotCommand {\n\t/** Returns whether MCP enhanced setup is enabled. */\n\tIsSupported = 'github.copilot.chat.mcp.setup.check',\n\n\t/** Takes an npm/pip package name, validates its owner. */\n\tValidatePackage = 'github.copilot.chat.mcp.setup.validatePackage',\n\n\t/** Returns the resolved MCP configuration. */\n\tStartFlow = 'github.copilot.chat.mcp.setup.flow',\n}\n\ntype ValidatePackageResult =\n\t{ state: 'ok'; publisher: string; name?: string; version?: string }\n\t| { state: 'error'; error: string; helpUri?: string; helpUriLabel?: string };\n\ntype AddServerData = {\n\tpackageType: string;\n};\ntype AddServerClassification = {\n\towner: 'digitarald';\n\tcomment: 'Generic details for adding a new MCP server';\n\tpackageType: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The type of MCP server package' };\n};\ntype AddServerCompletedData = {\n\tpackageType: string;\n\tserverType: string | undefined;\n\ttarget: string;\n};\ntype AddServerCompletedClassification = {\n\towner: 'digitarald';\n\tcomment: 'Generic details for successfully adding model-assisted MCP server';\n\tpackageType: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The type of MCP server package' };\n\tserverType: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The type of MCP server' };\n\ttarget: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The target of the MCP server configuration' };\n};\n\ntype AssistedServerConfiguration = {\n\ttype?: 'assisted';\n\tname?: string;\n\tserver: Omit<IMcpStdioServerConfiguration, 'type'>;\n\tinputs?: IMcpServerVariable[];\n\tinputValues?: Record<string, string>;\n} | {\n\ttype: 'mapped';\n\tname?: string;\n\tserver: Omit<IMcpStdioServerConfiguration, 'type'>;\n\tinputs?: IMcpServerVariable[];\n};\n\nexport class McpAddConfigurationCommand {\n\tconstructor(\n\t\tprivate readonly workspaceFolder: IWorkspaceFolder | undefined,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@IWorkbenchMcpManagementService private readonly _mcpManagementService: IWorkbenchMcpManagementService,\n\t\t@IWorkspaceContextService private readonly _workspaceService: IWorkspaceContextService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IMcpRegistry private readonly _mcpRegistry: IMcpRegistry,\n\t\t@IOpenerService private readonly _openerService: IOpenerService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@IMcpService private readonly _mcpService: IMcpService,\n\t\t@ILabelService private readonly _label: ILabelService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t) { }\n\n\tprivate async getServerType(): Promise<AddConfigurationType | undefined> {\n\t\ttype TItem = { kind: AddConfigurationType | 'browse' | 'discovery' } & IQuickPickItem;\n\t\tconst items: QuickPickInput<TItem>[] = [\n\t\t\t{ kind: AddConfigurationType.Stdio, label: localize('mcp.serverType.command', \"Command (stdio)\"), description: localize('mcp.serverType.command.description', \"Run a local command that implements the MCP protocol\") },\n\t\t\t{ kind: AddConfigurationType.HTTP, label: localize('mcp.serverType.http', \"HTTP (HTTP or Server-Sent Events)\"), description: localize('mcp.serverType.http.description', \"Connect to a remote HTTP server that implements the MCP protocol\") }\n\t\t];\n\n\t\tlet aiSupported: boolean | undefined;\n\t\ttry {\n\t\t\taiSupported = await this._commandService.executeCommand<boolean>(AddConfigurationCopilotCommand.IsSupported);\n\t\t} catch {\n\t\t\t// ignored\n\t\t}\n\n\t\tif (aiSupported) {\n\t\t\titems.unshift({ type: 'separator', label: localize('mcp.serverType.manual', \"Manual Install\") });\n\n\t\t\tconst elligableTypes = Object.entries(AssistedTypes).map(([type, { pickLabel, pickDescription, enabledConfigKey }]) => {\n\t\t\t\tif (enabledConfigKey) {\n\t\t\t\t\tconst enabled = this._configurationService.getValue<boolean>(enabledConfigKey) ?? false;\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tkind: Number(type) as AddConfigurationType,\n\t\t\t\t\tlabel: pickLabel,\n\t\t\t\t\tdescription: pickDescription,\n\t\t\t\t};\n\t\t\t}).filter(x => !!x);\n\n\t\t\titems.push(\n\t\t\t\t{ type: 'separator', label: localize('mcp.serverType.copilot', \"Model-Assisted\") },\n\t\t\t\t...elligableTypes\n\t\t\t);\n\t\t}\n\n\t\titems.push({ type: 'separator' });\n\n\t\tconst discovery = this._configurationService.getValue<{ [K in DiscoverySource]: boolean }>(mcpDiscoverySection);\n\t\tif (discovery && typeof discovery === 'object' && allDiscoverySources.some(d => !discovery[d])) {\n\t\t\titems.push({\n\t\t\t\tkind: 'discovery',\n\t\t\t\tlabel: localize('mcp.servers.discovery', \"Add from another application...\"),\n\t\t\t});\n\t\t}\n\n\t\titems.push({\n\t\t\tkind: 'browse',\n\t\t\tlabel: localize('mcp.servers.browse', \"Browse MCP Servers...\"),\n\t\t});\n\n\t\tconst result = await this._quickInputService.pick<TItem>(items, {\n\t\t\tplaceHolder: localize('mcp.serverType.placeholder', \"Choose the type of MCP server to add\"),\n\t\t});\n\n\t\tif (result?.kind === 'browse') {\n\t\t\tthis._commandService.executeCommand(McpCommandIds.Browse);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (result?.kind === 'discovery') {\n\t\t\tthis._commandService.executeCommand('workbench.action.openSettings', mcpDiscoverySection);\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn result?.kind;\n\t}\n\n\tprivate async getStdioConfig(): Promise<IMcpStdioServerConfiguration | undefined> {\n\t\tconst command = await this._quickInputService.input({\n\t\t\ttitle: localize('mcp.command.title', \"Enter Command\"),\n\t\t\tplaceHolder: localize('mcp.command.placeholder', \"Command to run (with optional arguments)\"),\n\t\t\tignoreFocusLost: true,\n\t\t});\n\n\t\tif (!command) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._telemetryService.publicLog2<AddServerData, AddServerClassification>('mcp.addserver', {\n\t\t\tpackageType: 'stdio'\n\t\t});\n\n\t\t// Split command into command and args, handling quotes\n\t\tconst parts = command.match(/(?:[^\\s\"]+|\"[^\"]*\")+/g)!;\n\t\treturn {\n\t\t\ttype: McpServerType.LOCAL,\n\t\t\tcommand: parts[0].replace(/\"/g, ''),\n\n\t\t\targs: parts.slice(1).map(arg => arg.replace(/\"/g, ''))\n\t\t};\n\t}\n\n\tprivate async getSSEConfig(): Promise<IMcpRemoteServerConfiguration | undefined> {\n\t\tconst url = await this._quickInputService.input({\n\t\t\ttitle: localize('mcp.url.title', \"Enter Server URL\"),\n\t\t\tplaceHolder: localize('mcp.url.placeholder', \"URL of the MCP server (e.g., http://localhost:3000)\"),\n\t\t\tignoreFocusLost: true,\n\t\t});\n\n\t\tif (!url) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._telemetryService.publicLog2<AddServerData, AddServerClassification>('mcp.addserver', {\n\t\t\tpackageType: 'sse'\n\t\t});\n\n\t\treturn { url, type: McpServerType.REMOTE };\n\t}\n\n\tprivate async getServerId(suggestion = `my-mcp-server-${generateUuid().split('-')[0]}`): Promise<string | undefined> {\n\t\tconst id = await this._quickInputService.input({\n\t\t\ttitle: localize('mcp.serverId.title', \"Enter Server ID\"),\n\t\t\tplaceHolder: localize('mcp.serverId.placeholder', \"Unique identifier for this server\"),\n\t\t\tvalue: suggestion,\n\t\t\tignoreFocusLost: true,\n\t\t});\n\n\t\treturn id;\n\t}\n\n\tprivate async getConfigurationTarget(): Promise<ConfigurationTarget | IWorkspaceFolder | undefined> {\n\t\tconst options: (IQuickPickItem & { target?: ConfigurationTarget | IWorkspaceFolder })[] = [\n\t\t\t{ target: ConfigurationTarget.USER_LOCAL, label: localize('mcp.target.user', \"Global\"), description: localize('mcp.target.user.description', \"Available in all workspaces, runs locally\") }\n\t\t];\n\n\t\tconst raLabel = this._environmentService.remoteAuthority && this._label.getHostLabel(Schemas.vscodeRemote, this._environmentService.remoteAuthority);\n\t\tif (raLabel) {\n\t\t\toptions.push({ target: ConfigurationTarget.USER_REMOTE, label: localize('mcp.target.remote', \"Remote\"), description: localize('mcp.target..remote.description', \"Available on this remote machine, runs on {0}\", raLabel) });\n\t\t}\n\n\t\tconst workbenchState = this._workspaceService.getWorkbenchState();\n\t\tif (workbenchState !== WorkbenchState.EMPTY) {\n\t\t\tconst target = workbenchState === WorkbenchState.FOLDER ? this._workspaceService.getWorkspace().folders[0] : ConfigurationTarget.WORKSPACE;\n\t\t\tif (this._environmentService.remoteAuthority) {\n\t\t\t\toptions.push({ target, label: localize('mcp.target.workspace', \"Workspace\"), description: localize('mcp.target.workspace.description.remote', \"Available in this workspace, runs on {0}\", raLabel) });\n\t\t\t} else {\n\t\t\t\toptions.push({ target, label: localize('mcp.target.workspace', \"Workspace\"), description: localize('mcp.target.workspace.description', \"Available in this workspace, runs locally\") });\n\t\t\t}\n\t\t}\n\n\t\tif (options.length === 1) {\n\t\t\treturn options[0].target;\n\t\t}\n\n\t\tconst targetPick = await this._quickInputService.pick(options, {\n\t\t\ttitle: localize('mcp.target.title', \"Add MCP Server\"),\n\t\t\tplaceHolder: localize('mcp.target.placeholder', \"Select the configuration target\")\n\t\t});\n\n\t\treturn targetPick?.target;\n\t}\n\n\tprivate async getAssistedConfig(type: AssistedConfigurationType): Promise<{ name?: string; server: Omit<IMcpStdioServerConfiguration, 'type'>; inputs?: IMcpServerVariable[]; inputValues?: Record<string, string> } | undefined> {\n\t\tconst packageName = await this._quickInputService.input({\n\t\t\tignoreFocusLost: true,\n\t\t\ttitle: AssistedTypes[type].title,\n\t\t\tplaceHolder: AssistedTypes[type].placeholder,\n\t\t});\n\n\t\tif (!packageName) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst enum LoadAction {\n\t\t\tRetry = 'retry',\n\t\t\tCancel = 'cancel',\n\t\t\tAllow = 'allow',\n\t\t\tOpenUri = 'openUri',\n\t\t}\n\n\t\tconst loadingQuickPickStore = new DisposableStore();\n\t\tconst loadingQuickPick = loadingQuickPickStore.add(this._quickInputService.createQuickPick<IQuickPickItem & { id: LoadAction; helpUri?: URI }>());\n\t\tloadingQuickPick.title = localize('mcp.loading.title', \"Loading package details...\");\n\t\tloadingQuickPick.busy = true;\n\t\tloadingQuickPick.ignoreFocusOut = true;\n\n\t\tconst packageType = this.getPackageType(type);\n\n\t\tthis._telemetryService.publicLog2<AddServerData, AddServerClassification>('mcp.addserver', {\n\t\t\tpackageType: packageType!\n\t\t});\n\n\t\tthis._commandService.executeCommand<ValidatePackageResult>(\n\t\t\tAddConfigurationCopilotCommand.ValidatePackage,\n\t\t\t{\n\t\t\t\ttype: packageType,\n\t\t\t\tname: packageName,\n\t\t\t\ttargetConfig: {\n\t\t\t\t\t...mcpStdioServerSchema,\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\t...mcpStdioServerSchema.properties,\n\t\t\t\t\t\tname: {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tdescription: 'Suggested name of the server, alphanumeric and hyphen only',\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\trequired: [...(mcpStdioServerSchema.required || []), 'name'],\n\t\t\t\t},\n\t\t\t}\n\t\t).then(result => {\n\t\t\tif (!result || result.state === 'error') {\n\t\t\t\tloadingQuickPick.title = result?.error || 'Unknown error loading package';\n\n\t\t\t\tconst items: Array<IQuickPickItem & { id: LoadAction; helpUri?: URI }> = [];\n\n\t\t\t\tif (result?.helpUri) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tid: LoadAction.OpenUri,\n\t\t\t\t\t\tlabel: result.helpUriLabel ?? localize('mcp.error.openHelpUri', 'Open help URL'),\n\t\t\t\t\t\thelpUri: URI.parse(result.helpUri),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\titems.push(\n\t\t\t\t\t{ id: LoadAction.Retry, label: localize('mcp.error.retry', 'Try a different package') },\n\t\t\t\t\t{ id: LoadAction.Cancel, label: localize('cancel', 'Cancel') },\n\t\t\t\t);\n\n\t\t\t\tloadingQuickPick.items = items;\n\t\t\t} else {\n\t\t\t\tloadingQuickPick.title = localize(\n\t\t\t\t\t'mcp.confirmPublish', 'Install {0}{1} from {2}?',\n\t\t\t\t\tresult.name ?? packageName,\n\t\t\t\t\tresult.version ? `@${result.version}` : '',\n\t\t\t\t\tresult.publisher);\n\t\t\t\tloadingQuickPick.items = [\n\t\t\t\t\t{ id: LoadAction.Allow, label: localize('allow', \"Allow\") },\n\t\t\t\t\t{ id: LoadAction.Cancel, label: localize('cancel', 'Cancel') }\n\t\t\t\t];\n\t\t\t}\n\t\t\tloadingQuickPick.busy = false;\n\t\t});\n\n\t\tconst loadingAction = await new Promise<{ id: LoadAction; helpUri?: URI } | undefined>(resolve => {\n\t\t\tloadingQuickPick.onDidAccept(() => resolve(loadingQuickPick.selectedItems[0]));\n\t\t\tloadingQuickPick.onDidHide(() => resolve(undefined));\n\t\t\tloadingQuickPick.show();\n\t\t}).finally(() => loadingQuickPick.dispose());\n\n\t\tswitch (loadingAction?.id) {\n\t\t\tcase LoadAction.Retry:\n\t\t\t\treturn this.getAssistedConfig(type);\n\t\t\tcase LoadAction.OpenUri:\n\t\t\t\tif (loadingAction.helpUri) { this._openerService.open(loadingAction.helpUri); }\n\t\t\t\treturn undefined;\n\t\t\tcase LoadAction.Allow:\n\t\t\t\tbreak;\n\t\t\tcase LoadAction.Cancel:\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\n\t\tconst config = await this._commandService.executeCommand<AssistedServerConfiguration>(\n\t\t\tAddConfigurationCopilotCommand.StartFlow,\n\t\t\t{\n\t\t\t\tname: packageName,\n\t\t\t\ttype: packageType\n\t\t\t}\n\t\t);\n\n\t\tif (config?.type === 'mapped') {\n\t\t\treturn {\n\t\t\t\tname: config.name,\n\t\t\t\tserver: config.server,\n\t\t\t\tinputs: config.inputs,\n\t\t\t};\n\t\t} else if (config?.type === 'assisted' || !config?.type) {\n\t\t\treturn config;\n\t\t} else {\n\t\t\tassertNever(config?.type);\n\t\t}\n\t}\n\n\t/** Shows the location of a server config once it's discovered. */\n\tprivate showOnceDiscovered(name: string) {\n\t\tconst store = new DisposableStore();\n\t\tstore.add(autorun(reader => {\n\t\t\tconst colls = this._mcpRegistry.collections.read(reader);\n\t\t\tconst servers = this._mcpService.servers.read(reader);\n\t\t\tconst match = mapFindFirst(colls, collection => mapFindFirst(collection.serverDefinitions.read(reader),\n\t\t\t\tserver => server.label === name ? { server, collection } : undefined));\n\t\t\tconst server = match && servers.find(s => s.definition.id === match.server.id);\n\n\n\t\t\tif (match && server) {\n\t\t\t\tif (match.collection.presentation?.origin) {\n\t\t\t\t\tthis._editorService.openEditor({\n\t\t\t\t\t\tresource: match.collection.presentation.origin,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselection: match.server.presentation?.origin?.range,\n\t\t\t\t\t\t\tpreserveFocus: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis._commandService.executeCommand(McpCommandIds.ServerOptions, name);\n\t\t\t\t}\n\n\t\t\t\tserver.start({ promptType: 'all-untrusted' }).then(state => {\n\t\t\t\t\tif (state.state === McpConnectionState.Kind.Error) {\n\t\t\t\t\t\tserver.showOutput();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.dispose();\n\t\t\t}\n\t\t}));\n\n\t\tstore.add(disposableTimeout(() => store.dispose(), 5000));\n\t}\n\n\tpublic async run(): Promise<void> {\n\t\t// Step 1: Choose server type\n\t\tconst serverType = await this.getServerType();\n\t\tif (serverType === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Step 2: Get server details based on type\n\t\tlet config: IMcpServerConfiguration | undefined;\n\t\tlet suggestedName: string | undefined;\n\t\tlet inputs: IMcpServerVariable[] | undefined;\n\t\tlet inputValues: Record<string, string> | undefined;\n\t\tswitch (serverType) {\n\t\t\tcase AddConfigurationType.Stdio:\n\t\t\t\tconfig = await this.getStdioConfig();\n\t\t\t\tbreak;\n\t\t\tcase AddConfigurationType.HTTP:\n\t\t\t\tconfig = await this.getSSEConfig();\n\t\t\t\tbreak;\n\t\t\tcase AddConfigurationType.NpmPackage:\n\t\t\tcase AddConfigurationType.PipPackage:\n\t\t\tcase AddConfigurationType.NuGetPackage:\n\t\t\tcase AddConfigurationType.DockerImage: {\n\t\t\t\tconst r = await this.getAssistedConfig(serverType);\n\t\t\t\tconfig = r?.server ? { ...r.server, type: McpServerType.LOCAL } : undefined;\n\t\t\t\tsuggestedName = r?.name;\n\t\t\t\tinputs = r?.inputs;\n\t\t\t\tinputValues = r?.inputValues;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tassertNever(serverType);\n\t\t}\n\n\t\tif (!config) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Step 3: Get server ID\n\t\tconst name = await this.getServerId(suggestedName);\n\t\tif (!name) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Step 4: Choose configuration target if no configUri provided\n\t\tlet target: ConfigurationTarget | IWorkspaceFolder | undefined = this.workspaceFolder;\n\t\tif (!target) {\n\t\t\ttarget = await this.getConfigurationTarget();\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tawait this._mcpManagementService.install({ name, config, inputs }, { target });\n\n\t\tif (inputValues) {\n\t\t\tfor (const [key, value] of Object.entries(inputValues)) {\n\t\t\t\tawait this._mcpRegistry.setSavedInput(key, (isWorkspaceFolder(target) ? ConfigurationTarget.WORKSPACE_FOLDER : target) ?? ConfigurationTarget.WORKSPACE, value);\n\t\t\t}\n\t\t}\n\n\t\tconst packageType = this.getPackageType(serverType);\n\t\tif (packageType) {\n\t\t\tthis._telemetryService.publicLog2<AddServerCompletedData, AddServerCompletedClassification>('mcp.addserver.completed', {\n\t\t\t\tpackageType,\n\t\t\t\tserverType: config.type,\n\t\t\t\ttarget: target === ConfigurationTarget.WORKSPACE ? 'workspace' : 'user'\n\t\t\t});\n\t\t}\n\n\t\tthis.showOnceDiscovered(name);\n\t}\n\n\tpublic async pickForUrlHandler(resource: URI, showIsPrimary = false): Promise<void> {\n\t\tconst name = decodeURIComponent(basename(resource)).replace(/\\.json$/, '');\n\t\tconst placeHolder = localize('install.title', 'Install MCP server {0}', name);\n\n\t\tconst items: IQuickPickItem[] = [\n\t\t\t{ id: 'install', label: localize('install.start', 'Install Server') },\n\t\t\t{ id: 'show', label: localize('install.show', 'Show Configuration', name) },\n\t\t\t{ id: 'rename', label: localize('install.rename', 'Rename \"{0}\"', name) },\n\t\t\t{ id: 'cancel', label: localize('cancel', 'Cancel') },\n\t\t];\n\t\tif (showIsPrimary) {\n\t\t\t[items[0], items[1]] = [items[1], items[0]];\n\t\t}\n\n\t\tconst pick = await this._quickInputService.pick(items, { placeHolder, ignoreFocusLost: true });\n\t\tconst getEditors = () => this._editorService.findEditors(resource);\n\n\t\tswitch (pick?.id) {\n\t\t\tcase 'show':\n\t\t\t\tawait this._editorService.openEditor({ resource });\n\t\t\t\tbreak;\n\t\t\tcase 'install':\n\t\t\t\tawait this._editorService.save(getEditors());\n\t\t\t\ttry {\n\t\t\t\t\tconst contents = await this._fileService.readFile(resource);\n\t\t\t\t\tconst { inputs, ...config }: IMcpServerConfiguration & { inputs?: IMcpServerVariable[] } = parseJsonc(contents.value.toString());\n\t\t\t\t\tawait this._mcpManagementService.install({ name, config, inputs });\n\t\t\t\t\tthis._editorService.closeEditors(getEditors());\n\t\t\t\t\tthis.showOnceDiscovered(name);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis._notificationService.error(localize('install.error', 'Error installing MCP server {0}: {1}', name, e.message));\n\t\t\t\t\tawait this._editorService.openEditor({ resource });\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'rename': {\n\t\t\t\tconst newName = await this._quickInputService.input({ placeHolder: localize('install.newName', 'Enter new name'), value: name });\n\t\t\t\tif (newName) {\n\t\t\t\t\tconst newURI = resource.with({ path: `/${encodeURIComponent(newName)}.json` });\n\t\t\t\t\tawait this._editorService.save(getEditors());\n\t\t\t\t\tawait this._fileService.move(resource, newURI);\n\t\t\t\t\treturn this.pickForUrlHandler(newURI, showIsPrimary);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getPackageType(serverType: AddConfigurationType): string | undefined {\n\t\tswitch (serverType) {\n\t\t\tcase AddConfigurationType.NpmPackage:\n\t\t\t\treturn 'npm';\n\t\t\tcase AddConfigurationType.PipPackage:\n\t\t\t\treturn 'pip';\n\t\t\tcase AddConfigurationType.NuGetPackage:\n\t\t\t\treturn 'nuget';\n\t\t\tcase AddConfigurationType.DockerImage:\n\t\t\t\treturn 'docker';\n\t\t\tcase AddConfigurationType.Stdio:\n\t\t\t\treturn 'stdio';\n\t\t\tcase AddConfigurationType.HTTP:\n\t\t\t\treturn 'sse';\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n}\n"]}