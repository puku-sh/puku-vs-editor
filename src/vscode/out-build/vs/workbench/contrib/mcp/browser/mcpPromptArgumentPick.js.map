{"version":3,"sources":["vs/workbench/contrib/mcp/browser/mcpPromptArgumentPick.ts"],"names":[],"mappings":"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","file":"mcpPromptArgumentPick.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { assertNever } from '../../../../base/common/assert.js';\nimport { disposableTimeout, RunOnceScheduler, timeout } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, derived, IObservable, ObservablePromise, observableSignalFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { getIconClasses } from '../../../../editor/common/services/getIconClasses.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { localize } from '../../../../nls.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IQuickInputService, IQuickPick, IQuickPickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ICommandDetectionCapability, TerminalCapability } from '../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { TerminalLocation } from '../../../../platform/terminal/common/terminal.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { QueryBuilder } from '../../../services/search/common/queryBuilder.js';\nimport { ISearchService } from '../../../services/search/common/search.js';\nimport { ITerminalGroupService, ITerminalInstance, ITerminalService } from '../../terminal/browser/terminal.js';\nimport { IMcpPrompt } from '../common/mcpTypes.js';\nimport { MCP } from '../common/modelContextProtocol.js';\n\ntype PickItem = IQuickPickItem & (\n\t| { action: 'text' | 'command' | 'suggest' }\n\t| { action: 'file'; uri: URI }\n\t| { action: 'selectedText'; uri: URI; selectedText: string }\n);\n\nconst SHELL_INTEGRATION_TIMEOUT = 5000;\nconst NO_SHELL_INTEGRATION_IDLE = 1000;\nconst SUGGEST_DEBOUNCE = 200;\n\ntype Action = { type: 'arg'; value: string | undefined } | { type: 'back' } | { type: 'cancel' };\n\nexport class McpPromptArgumentPick extends Disposable {\n\tprivate readonly quickPick: IQuickPick<PickItem, { useSeparators: true }>;\n\tprivate _terminal?: ITerminalInstance;\n\n\tconstructor(\n\t\tprivate readonly prompt: IMcpPrompt,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ISearchService private readonly _searchService: ISearchService,\n\t\t@IWorkspaceContextService private readonly _workspaceContextService: IWorkspaceContextService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ILanguageService private readonly _languageService: ILanguageService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t) {\n\t\tsuper();\n\t\tthis.quickPick = this._register(_quickInputService.createQuickPick({ useSeparators: true }));\n\t}\n\n\tpublic async createArgs(token?: CancellationToken): Promise<Record<string, string | undefined> | undefined> {\n\t\tconst { quickPick, prompt } = this;\n\n\t\tquickPick.totalSteps = prompt.arguments.length;\n\t\tquickPick.step = 0;\n\t\tquickPick.ignoreFocusOut = true;\n\t\tquickPick.sortByLabel = false;\n\n\t\tconst args: Record<string, string | undefined> = {};\n\t\tconst backSnapshots: { value: string; items: readonly (PickItem | IQuickPickSeparator)[]; activeItems: readonly PickItem[] }[] = [];\n\t\tfor (let i = 0; i < prompt.arguments.length; i++) {\n\t\t\tconst arg = prompt.arguments[i];\n\t\t\tconst restore = backSnapshots.at(i);\n\t\t\tquickPick.step = i + 1;\n\t\t\tquickPick.placeholder = arg.required ? arg.description : `${arg.description || ''} (${localize('optional', 'Optional')})`;\n\t\t\tquickPick.title = localize('mcp.prompt.pick.title', 'Value for: {0}', arg.title || arg.name);\n\t\t\tquickPick.value = restore?.value ?? ((args.hasOwnProperty(arg.name) && args[arg.name]) || '');\n\t\t\tquickPick.items = restore?.items ?? [];\n\t\t\tquickPick.activeItems = restore?.activeItems ?? [];\n\t\t\tquickPick.buttons = i > 0 ? [this._quickInputService.backButton] : [];\n\n\t\t\tconst value = await this._getArg(arg, !!restore, args, token);\n\t\t\tif (value.type === 'back') {\n\t\t\t\ti -= 2;\n\t\t\t} else if (value.type === 'cancel') {\n\t\t\t\treturn undefined;\n\t\t\t} else if (value.type === 'arg') {\n\t\t\t\tbackSnapshots[i] = { value: quickPick.value, items: quickPick.items.slice(), activeItems: quickPick.activeItems.slice() };\n\t\t\t\targs[arg.name] = value.value;\n\t\t\t} else {\n\t\t\t\tassertNever(value);\n\t\t\t}\n\t\t}\n\n\t\tquickPick.value = '';\n\t\tquickPick.placeholder = localize('loading', 'Loading...');\n\t\tquickPick.busy = true;\n\n\t\treturn args;\n\t}\n\n\tprivate async _getArg(arg: MCP.PromptArgument, didRestoreState: boolean, argsSoFar: Record<string, string | undefined>, token?: CancellationToken): Promise<Action> {\n\t\tconst { quickPick } = this;\n\t\tconst store = new DisposableStore();\n\n\t\tconst input$ = observableValue(this, quickPick.value);\n\t\tconst asyncPicks = [\n\t\t\t{\n\t\t\t\tname: localize('mcp.arg.suggestions', 'Suggestions'),\n\t\t\t\tobserver: this._promptCompletions(arg, input$, argsSoFar),\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: localize('mcp.arg.activeFiles', 'Active File'),\n\t\t\t\tobserver: this._activeFileCompletions(),\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: localize('mcp.arg.files', 'Files'),\n\t\t\t\tobserver: this._fileCompletions(input$),\n\t\t\t}\n\t\t];\n\n\t\tstore.add(autorun(reader => {\n\t\t\tif (didRestoreState) {\n\t\t\t\tinput$.read(reader);\n\t\t\t\treturn; // don't overwrite initial items until the user types\n\t\t\t}\n\n\t\t\tlet items: (PickItem | IQuickPickSeparator)[] = [];\n\t\t\titems.push({ id: 'insert-text', label: localize('mcp.arg.asText', 'Insert as text'), iconClass: ThemeIcon.asClassName(Codicon.textSize), action: 'text', alwaysShow: true });\n\t\t\titems.push({ id: 'run-command', label: localize('mcp.arg.asCommand', 'Run as Command'), description: localize('mcp.arg.asCommand.description', 'Inserts the command output as the prompt argument'), iconClass: ThemeIcon.asClassName(Codicon.terminal), action: 'command', alwaysShow: true });\n\n\t\t\tlet busy = false;\n\t\t\tfor (const pick of asyncPicks) {\n\t\t\t\tconst state = pick.observer.read(reader);\n\t\t\t\tbusy ||= state.busy;\n\t\t\t\tif (state.picks) {\n\t\t\t\t\titems.push({ label: pick.name, type: 'separator' });\n\t\t\t\t\titems = items.concat(state.picks);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst previouslyActive = quickPick.activeItems;\n\t\t\tquickPick.busy = busy;\n\t\t\tquickPick.items = items;\n\n\t\t\tconst lastActive = items.find(i => previouslyActive.some(a => a.id === i.id)) as PickItem | undefined;\n\t\t\tconst serverSuggestions = asyncPicks[0].observer;\n\t\t\t// Keep any selection state, but otherwise select the first completion item, and avoid default-selecting the top item unless there are no compltions\n\t\t\tif (lastActive) {\n\t\t\t\tquickPick.activeItems = [lastActive];\n\t\t\t} else if (serverSuggestions.read(reader).picks?.length) {\n\t\t\t\tquickPick.activeItems = [items[3] as PickItem];\n\t\t\t} else if (busy) {\n\t\t\t\tquickPick.activeItems = [];\n\t\t\t} else {\n\t\t\t\tquickPick.activeItems = [items[0] as PickItem];\n\t\t\t}\n\t\t}));\n\n\t\ttry {\n\t\t\tconst value = await new Promise<PickItem | 'back' | undefined>(resolve => {\n\t\t\t\tif (token) {\n\t\t\t\t\tstore.add(token.onCancellationRequested(() => {\n\t\t\t\t\t\tresolve(undefined);\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tstore.add(quickPick.onDidChangeValue(value => {\n\t\t\t\t\tquickPick.validationMessage = undefined;\n\t\t\t\t\tinput$.set(value, undefined);\n\t\t\t\t}));\n\t\t\t\tstore.add(quickPick.onDidAccept(() => {\n\t\t\t\t\tconst item = quickPick.selectedItems[0];\n\t\t\t\t\tif (!quickPick.value && arg.required && (!item || item.action === 'text' || item.action === 'command')) {\n\t\t\t\t\t\tquickPick.validationMessage = localize('mcp.arg.required', \"This argument is required\");\n\t\t\t\t\t} else if (!item) {\n\t\t\t\t\t\t// For optional arguments when no item is selected, return empty text action\n\t\t\t\t\t\tresolve({ id: 'insert-text', label: '', action: 'text' });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(item);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tstore.add(quickPick.onDidTriggerButton(() => {\n\t\t\t\t\tresolve('back');\n\t\t\t\t}));\n\t\t\t\tstore.add(quickPick.onDidHide(() => {\n\t\t\t\t\tresolve(undefined);\n\t\t\t\t}));\n\t\t\t\tquickPick.show();\n\t\t\t});\n\n\t\t\tif (value === 'back') {\n\t\t\t\treturn { type: 'back' };\n\t\t\t}\n\n\t\t\tif (value === undefined) {\n\t\t\t\treturn { type: 'cancel' };\n\t\t\t}\n\n\t\t\tstore.clear();\n\t\t\tconst cts = new CancellationTokenSource();\n\t\t\tstore.add(toDisposable(() => cts.dispose(true)));\n\t\t\tstore.add(quickPick.onDidHide(() => store.dispose()));\n\n\t\t\tswitch (value.action) {\n\t\t\t\tcase 'text':\n\t\t\t\t\treturn { type: 'arg', value: quickPick.value || undefined };\n\t\t\t\tcase 'command':\n\t\t\t\t\tif (!quickPick.value) {\n\t\t\t\t\t\treturn { type: 'arg', value: undefined };\n\t\t\t\t\t}\n\t\t\t\t\tquickPick.busy = true;\n\t\t\t\t\treturn { type: 'arg', value: await this._getTerminalOutput(quickPick.value, cts.token) };\n\t\t\t\tcase 'suggest':\n\t\t\t\t\treturn { type: 'arg', value: value.label };\n\t\t\t\tcase 'file':\n\t\t\t\t\tquickPick.busy = true;\n\t\t\t\t\treturn { type: 'arg', value: await this._fileService.readFile(value.uri).then(c => c.value.toString()) };\n\t\t\t\tcase 'selectedText':\n\t\t\t\t\treturn { type: 'arg', value: value.selectedText };\n\t\t\t\tdefault:\n\t\t\t\t\tassertNever(value);\n\t\t\t}\n\t\t} finally {\n\t\t\tstore.dispose();\n\t\t}\n\t}\n\n\tprivate _promptCompletions(arg: MCP.PromptArgument, input: IObservable<string>, argsSoFar: Record<string, string | undefined>) {\n\t\tconst alreadyResolved: Record<string, string> = {};\n\t\tfor (const [key, value] of Object.entries(argsSoFar)) {\n\t\t\tif (value) {\n\t\t\t\talreadyResolved[key] = value;\n\t\t\t}\n\t\t}\n\n\t\treturn this._asyncCompletions(input, async (i, t) => {\n\t\t\tconst items = await this.prompt.complete(arg.name, i, alreadyResolved, t);\n\t\t\treturn items.map((i): PickItem => ({ id: `suggest:${i}`, label: i, action: 'suggest' }));\n\t\t});\n\t}\n\n\tprivate _fileCompletions(input: IObservable<string>) {\n\t\tconst qb = this._instantiationService.createInstance(QueryBuilder);\n\t\treturn this._asyncCompletions(input, async (i, token) => {\n\t\t\tif (!i) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst query = qb.file(this._workspaceContextService.getWorkspace().folders, {\n\t\t\t\tfilePattern: i,\n\t\t\t\tmaxResults: 10,\n\t\t\t});\n\n\t\t\tconst { results } = await this._searchService.fileSearch(query, token);\n\n\t\t\treturn results.map((i): PickItem => ({\n\t\t\t\tid: i.resource.toString(),\n\t\t\t\tlabel: basename(i.resource),\n\t\t\t\tdescription: this._labelService.getUriLabel(i.resource),\n\t\t\t\ticonClasses: getIconClasses(this._modelService, this._languageService, i.resource),\n\t\t\t\turi: i.resource,\n\t\t\t\taction: 'file',\n\t\t\t}));\n\t\t});\n\t}\n\n\tprivate _activeFileCompletions() {\n\t\tconst activeEditorChange = observableSignalFromEvent(this, this._editorService.onDidActiveEditorChange);\n\t\tconst activeEditor = derived(reader => {\n\t\t\tactiveEditorChange.read(reader);\n\t\t\treturn this._codeEditorService.getActiveCodeEditor();\n\t\t});\n\n\t\tconst resourceObs = activeEditor\n\t\t\t.map(e => e ? observableSignalFromEvent(this, e.onDidChangeModel).map(() => e.getModel()?.uri) : undefined)\n\t\t\t.map((o, reader) => o?.read(reader));\n\t\tconst selectionObs = activeEditor\n\t\t\t.map(e => e ? observableSignalFromEvent(this, e.onDidChangeCursorSelection).map(() => ({ range: e.getSelection(), model: e.getModel() })) : undefined)\n\t\t\t.map((o, reader) => o?.read(reader));\n\n\t\treturn derived(reader => {\n\t\t\tconst resource = resourceObs.read(reader);\n\t\t\tif (!resource) {\n\t\t\t\treturn { busy: false, picks: [] };\n\t\t\t}\n\n\t\t\tconst items: PickItem[] = [];\n\n\t\t\t// Add active file option\n\t\t\titems.push({\n\t\t\t\tid: 'active-file',\n\t\t\t\tlabel: localize('mcp.arg.activeFile', 'Active File'),\n\t\t\t\tdescription: this._labelService.getUriLabel(resource),\n\t\t\t\ticonClasses: getIconClasses(this._modelService, this._languageService, resource),\n\t\t\t\turi: resource,\n\t\t\t\taction: 'file',\n\t\t\t});\n\n\t\t\tconst selection = selectionObs.read(reader);\n\t\t\t// Add selected text option if there's a selection\n\t\t\tif (selection && selection.model && selection.range && !selection.range.isEmpty()) {\n\t\t\t\tconst selectedText = selection.model.getValueInRange(selection.range);\n\t\t\t\tconst lineCount = selection.range.endLineNumber - selection.range.startLineNumber + 1;\n\t\t\t\tconst description = lineCount === 1\n\t\t\t\t\t? localize('mcp.arg.selectedText.singleLine', 'line {0}', selection.range.startLineNumber)\n\t\t\t\t\t: localize('mcp.arg.selectedText.multiLine', '{0} lines', lineCount);\n\n\t\t\t\titems.push({\n\t\t\t\t\tid: 'selected-text',\n\t\t\t\t\tlabel: localize('mcp.arg.selectedText', 'Selected Text'),\n\t\t\t\t\tdescription,\n\t\t\t\t\tselectedText,\n\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.selection),\n\t\t\t\t\turi: resource,\n\t\t\t\t\taction: 'selectedText',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn { picks: items, busy: false };\n\t\t});\n\t}\n\n\tprivate _asyncCompletions(input: IObservable<string>, mapper: (input: string, token: CancellationToken) => Promise<PickItem[]>): IObservable<{ busy: boolean; picks: PickItem[] | undefined }> {\n\t\tconst promise = derived(reader => {\n\t\t\tconst queryValue = input.read(reader);\n\t\t\tconst cts = new CancellationTokenSource();\n\t\t\treader.store.add(toDisposable(() => cts.dispose(true)));\n\t\t\treturn new ObservablePromise(\n\t\t\t\ttimeout(SUGGEST_DEBOUNCE, cts.token)\n\t\t\t\t\t.then(() => mapper(queryValue, cts.token))\n\t\t\t\t\t.catch(() => [])\n\t\t\t);\n\t\t});\n\n\t\treturn promise.map((value, reader) => {\n\t\t\tconst result = value.promiseResult.read(reader);\n\t\t\treturn { picks: result?.data || [], busy: result === undefined };\n\t\t});\n\t}\n\n\tprivate async _getTerminalOutput(command: string, token: CancellationToken): Promise<string | undefined> {\n\t\t// The terminal outlives the specific pick argument. This is both a feature and a bug.\n\t\t// Feature: we can reuse the terminal if the user puts in multiple args\n\t\t// Bug workaround: if we dispose the terminal here and that results in the panel\n\t\t// closing, then focus moves out of the quickpick and into the active editor pane (chat input)\n\t\t// https://github.com/microsoft/vscode/blob/6a016f2507cd200b12ca6eecdab2f59da15aacb1/src/vs/workbench/browser/parts/editor/editorGroupView.ts#L1084\n\t\tconst terminal = (this._terminal ??= this._register(await this._terminalService.createTerminal({\n\t\t\tconfig: {\n\t\t\t\tname: localize('mcp.terminal.name', \"MCP Terminal\"),\n\t\t\t\tisTransient: true,\n\t\t\t\tforceShellIntegration: true,\n\t\t\t\tisFeatureTerminal: true,\n\t\t\t},\n\t\t\tlocation: TerminalLocation.Panel,\n\t\t})));\n\n\t\tthis._terminalService.setActiveInstance(terminal);\n\t\tthis._terminalGroupService.showPanel(false);\n\n\t\tconst shellIntegration = terminal.capabilities.get(TerminalCapability.CommandDetection);\n\t\tif (shellIntegration) {\n\t\t\treturn this._getTerminalOutputInner(terminal, command, shellIntegration, token);\n\t\t}\n\n\t\tconst store = new DisposableStore();\n\t\treturn await new Promise<string | undefined>(resolve => {\n\t\t\tstore.add(terminal.capabilities.onDidAddCapability(e => {\n\t\t\t\tif (e.id === TerminalCapability.CommandDetection) {\n\t\t\t\t\tstore.dispose();\n\t\t\t\t\tresolve(this._getTerminalOutputInner(terminal, command, e.capability, token));\n\t\t\t\t}\n\t\t\t}));\n\t\t\tstore.add(token.onCancellationRequested(() => {\n\t\t\t\tstore.dispose();\n\t\t\t\tresolve(undefined);\n\t\t\t}));\n\t\t\tstore.add(disposableTimeout(() => {\n\t\t\t\tstore.dispose();\n\t\t\t\tresolve(this._getTerminalOutputInner(terminal, command, undefined, token));\n\t\t\t}, SHELL_INTEGRATION_TIMEOUT));\n\t\t});\n\t}\n\n\tprivate async _getTerminalOutputInner(terminal: ITerminalInstance, command: string, shellIntegration: ICommandDetectionCapability | undefined, token: CancellationToken) {\n\t\tconst store = new DisposableStore();\n\t\treturn new Promise<string | undefined>(resolve => {\n\t\t\tlet allData: string = '';\n\t\t\tstore.add(terminal.onLineData(d => allData += d + '\\n'));\n\t\t\tif (shellIntegration) {\n\t\t\t\tstore.add(shellIntegration.onCommandFinished(e => resolve(e.getOutput() || allData)));\n\t\t\t} else {\n\t\t\t\tconst done = store.add(new RunOnceScheduler(() => resolve(allData), NO_SHELL_INTEGRATION_IDLE));\n\t\t\t\tstore.add(terminal.onData(() => done.schedule()));\n\t\t\t}\n\t\t\tstore.add(token.onCancellationRequested(() => resolve(undefined)));\n\t\t\tstore.add(terminal.onDisposed(() => resolve(undefined)));\n\n\t\t\tterminal.runCommand(command, true);\n\t\t}).finally(() => {\n\t\t\tstore.dispose();\n\t\t});\n\t}\n}\n"]}