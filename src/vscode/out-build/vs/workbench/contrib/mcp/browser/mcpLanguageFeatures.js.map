{"version":3,"sources":["vs/workbench/contrib/mcp/browser/mcpLanguageFeatures.ts"],"names":[],"mappings":"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","file":"mcpLanguageFeatures.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { computeLevenshteinDistance } from '../../../../base/common/diff/diff.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { createMarkdownCommandLink, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { findNodeAtLocation, Node, parseTree } from '../../../../base/common/json.js';\nimport { Disposable, DisposableStore, dispose, IDisposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { IObservable } from '../../../../base/common/observable.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { CodeLens, CodeLensList, CodeLensProvider, InlayHint, InlayHintList } from '../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../editor/common/model.js';\nimport { ILanguageFeaturesService } from '../../../../editor/common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport { IMarkerData, IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IConfigurationResolverService } from '../../../services/configurationResolver/common/configurationResolver.js';\nimport { ConfigurationResolverExpression, IResolvedValue } from '../../../services/configurationResolver/common/configurationResolverExpression.js';\nimport { McpCommandIds } from '../common/mcpCommandIds.js';\nimport { mcpConfigurationSection } from '../common/mcpConfiguration.js';\nimport { IMcpRegistry } from '../common/mcpRegistryTypes.js';\nimport { IMcpConfigPath, IMcpServerStartOpts, IMcpService, IMcpWorkbenchService, McpConnectionState } from '../common/mcpTypes.js';\n\nconst diagnosticOwner = 'vscode.mcp';\n\nexport class McpLanguageFeatures extends Disposable implements IWorkbenchContribution {\n\tprivate readonly _cachedMcpSection = this._register(new MutableDisposable<{ model: ITextModel; inConfig: IMcpConfigPath; tree: Node } & IDisposable>());\n\n\tconstructor(\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@IMcpRegistry private readonly _mcpRegistry: IMcpRegistry,\n\t\t@IMcpWorkbenchService private readonly _mcpWorkbenchService: IMcpWorkbenchService,\n\t\t@IMcpService private readonly _mcpService: IMcpService,\n\t\t@IMarkerService private readonly _markerService: IMarkerService,\n\t\t@IConfigurationResolverService private readonly _configurationResolverService: IConfigurationResolverService,\n\t) {\n\t\tsuper();\n\n\t\tconst patterns = [\n\t\t\t{ pattern: '**/mcp.json' },\n\t\t\t{ pattern: '**/workspace.json' },\n\t\t];\n\n\t\tconst onDidChangeCodeLens = this._register(new Emitter<CodeLensProvider>());\n\t\tconst codeLensProvider: CodeLensProvider = {\n\t\t\tonDidChange: onDidChangeCodeLens.event,\n\t\t\tprovideCodeLenses: (model, range) => this._provideCodeLenses(model, () => onDidChangeCodeLens.fire(codeLensProvider)),\n\t\t};\n\t\tthis._register(languageFeaturesService.codeLensProvider.register(patterns, codeLensProvider));\n\n\t\tthis._register(languageFeaturesService.inlayHintsProvider.register(patterns, {\n\t\t\tonDidChangeInlayHints: _mcpRegistry.onDidChangeInputs,\n\t\t\tprovideInlayHints: (model, range) => this._provideInlayHints(model, range),\n\t\t}));\n\t}\n\n\t/** Simple mechanism to avoid extra json parsing for hints+lenses */\n\tprivate async _parseModel(model: ITextModel) {\n\t\tif (this._cachedMcpSection.value?.model === model) {\n\t\t\treturn this._cachedMcpSection.value;\n\t\t}\n\n\t\tconst uri = model.uri;\n\t\tconst inConfig = await this._mcpWorkbenchService.getMcpConfigPath(model.uri);\n\t\tif (!inConfig) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst value = model.getValue();\n\t\tconst tree = parseTree(value);\n\t\tconst listeners = [\n\t\t\tmodel.onDidChangeContent(() => this._cachedMcpSection.clear()),\n\t\t\tmodel.onWillDispose(() => this._cachedMcpSection.clear()),\n\t\t];\n\t\tthis._addDiagnostics(model, value, tree, inConfig);\n\n\t\treturn this._cachedMcpSection.value = {\n\t\t\tmodel,\n\t\t\ttree,\n\t\t\tinConfig,\n\t\t\tdispose: () => {\n\t\t\t\tthis._markerService.remove(diagnosticOwner, [uri]);\n\t\t\t\tdispose(listeners);\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _addDiagnostics(tm: ITextModel, value: string, tree: Node, inConfig: IMcpConfigPath) {\n\t\tconst serversNode = findNodeAtLocation(tree, inConfig.section ? [...inConfig.section, 'servers'] : ['servers']);\n\t\tif (!serversNode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst getClosestMatchingVariable = (name: string) => {\n\t\t\tlet bestValue = '';\n\t\t\tlet bestDistance = Infinity;\n\t\t\tfor (const variable of this._configurationResolverService.resolvableVariables) {\n\t\t\t\tconst distance = computeLevenshteinDistance(name, variable);\n\t\t\t\tif (distance < bestDistance) {\n\t\t\t\t\tbestDistance = distance;\n\t\t\t\t\tbestValue = variable;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn bestValue;\n\t\t};\n\n\t\tconst diagnostics: IMarkerData[] = [];\n\t\tforEachPropertyWithReplacement(serversNode, node => {\n\t\t\tconst expr = ConfigurationResolverExpression.parse(node.value);\n\n\t\t\tfor (const { id, name, arg } of expr.unresolved()) {\n\t\t\t\tif (!this._configurationResolverService.resolvableVariables.has(name)) {\n\t\t\t\t\tconst position = value.indexOf(id, node.offset);\n\t\t\t\t\tif (position === -1) { continue; } // unreachable?\n\n\t\t\t\t\tconst start = tm.getPositionAt(position);\n\t\t\t\t\tconst end = tm.getPositionAt(position + id.length);\n\t\t\t\t\tdiagnostics.push({\n\t\t\t\t\t\tseverity: MarkerSeverity.Warning,\n\t\t\t\t\t\tmessage: localize('mcp.variableNotFound', 'Variable `{0}` not found, did you mean ${{1}}?', name, getClosestMatchingVariable(name) + (arg ? `:${arg}` : '')),\n\t\t\t\t\t\tstartLineNumber: start.lineNumber,\n\t\t\t\t\t\tstartColumn: start.column,\n\t\t\t\t\t\tendLineNumber: end.lineNumber,\n\t\t\t\t\t\tendColumn: end.column,\n\t\t\t\t\t\tmodelVersionId: tm.getVersionId(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (diagnostics.length) {\n\t\t\tthis._markerService.changeOne(diagnosticOwner, tm.uri, diagnostics);\n\t\t} else {\n\t\t\tthis._markerService.remove(diagnosticOwner, [tm.uri]);\n\t\t}\n\t}\n\n\tprivate async _provideCodeLenses(model: ITextModel, onDidChangeCodeLens: () => void): Promise<CodeLensList | undefined> {\n\t\tconst parsed = await this._parseModel(model);\n\t\tif (!parsed) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { tree, inConfig } = parsed;\n\t\tconst serversNode = findNodeAtLocation(tree, inConfig.section ? [...inConfig.section, 'servers'] : ['servers']);\n\t\tif (!serversNode) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst store = new DisposableStore();\n\t\tconst lenses: CodeLens[] = [];\n\t\tconst lensList: CodeLensList = { lenses, dispose: () => store.dispose() };\n\t\tconst read = <T>(observable: IObservable<T>): T => {\n\t\t\tstore.add(Event.fromObservableLight(observable)(onDidChangeCodeLens));\n\t\t\treturn observable.get();\n\t\t};\n\n\t\tconst collection = read(this._mcpRegistry.collections).find(c => isEqual(c.presentation?.origin, model.uri));\n\t\tif (!collection) {\n\t\t\treturn lensList;\n\t\t}\n\n\t\tconst mcpServers = read(this._mcpService.servers).filter(s => s.collection.id === collection.id);\n\t\tfor (const node of serversNode.children || []) {\n\t\t\tif (node.type !== 'property' || node.children?.[0]?.type !== 'string') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst name = node.children[0].value as string;\n\t\t\tconst server = mcpServers.find(s => s.definition.label === name);\n\t\t\tif (!server) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst range = Range.fromPositions(model.getPositionAt(node.children[0].offset));\n\t\t\tconst canDebug = !!server.readDefinitions().get().server?.devMode?.debug;\n\t\t\tconst state = read(server.connectionState).state;\n\t\t\tswitch (state) {\n\t\t\t\tcase McpConnectionState.Kind.Error:\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.ShowOutput,\n\t\t\t\t\t\t\ttitle: '$(error) ' + localize('server.error', 'Error'),\n\t\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t\t},\n\t\t\t\t\t}, {\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.RestartServer,\n\t\t\t\t\t\t\ttitle: localize('mcp.restart', \"Restart\"),\n\t\t\t\t\t\t\targuments: [server.definition.id, { autoTrustChanges: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tif (canDebug) {\n\t\t\t\t\t\tlenses.push({\n\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\t\tid: McpCommandIds.RestartServer,\n\t\t\t\t\t\t\t\ttitle: localize('mcp.debug', \"Debug\"),\n\t\t\t\t\t\t\t\targuments: [server.definition.id, { debug: true, autoTrustChanges: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase McpConnectionState.Kind.Starting:\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.ShowOutput,\n\t\t\t\t\t\t\ttitle: '$(loading~spin) ' + localize('server.starting', 'Starting'),\n\t\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t\t},\n\t\t\t\t\t}, {\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.StopServer,\n\t\t\t\t\t\t\ttitle: localize('cancel', \"Cancel\"),\n\t\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase McpConnectionState.Kind.Running:\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.ShowOutput,\n\t\t\t\t\t\t\ttitle: '$(check) ' + localize('server.running', 'Running'),\n\t\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t\t},\n\t\t\t\t\t}, {\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.StopServer,\n\t\t\t\t\t\t\ttitle: localize('mcp.stop', \"Stop\"),\n\t\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t\t},\n\t\t\t\t\t}, {\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.RestartServer,\n\t\t\t\t\t\t\ttitle: localize('mcp.restart', \"Restart\"),\n\t\t\t\t\t\t\targuments: [server.definition.id, { autoTrustChanges: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tif (canDebug) {\n\t\t\t\t\t\tlenses.push({\n\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\t\tid: McpCommandIds.RestartServer,\n\t\t\t\t\t\t\t\ttitle: localize('mcp.debug', \"Debug\"),\n\t\t\t\t\t\t\t\targuments: [server.definition.id, { autoTrustChanges: true, debug: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase McpConnectionState.Kind.Stopped:\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.StartServer,\n\t\t\t\t\t\t\ttitle: '$(debug-start) ' + localize('mcp.start', \"Start\"),\n\t\t\t\t\t\t\targuments: [server.definition.id, { autoTrustChanges: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tif (canDebug) {\n\t\t\t\t\t\tlenses.push({\n\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\t\tid: McpCommandIds.StartServer,\n\t\t\t\t\t\t\t\ttitle: localize('mcp.debug', \"Debug\"),\n\t\t\t\t\t\t\t\targuments: [server.definition.id, { autoTrustChanges: true, debug: true } satisfies IMcpServerStartOpts],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (state !== McpConnectionState.Kind.Error) {\n\t\t\t\tconst toolCount = read(server.tools).length;\n\t\t\t\tif (toolCount) {\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: '',\n\t\t\t\t\t\t\ttitle: localize('server.toolCount', '{0} tools', toolCount),\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tconst promptCount = read(server.prompts).length;\n\t\t\t\tif (promptCount) {\n\t\t\t\t\tlenses.push({\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\tid: McpCommandIds.StartPromptForServer,\n\t\t\t\t\t\t\ttitle: localize('server.promptcount', '{0} prompts', promptCount),\n\t\t\t\t\t\t\targuments: [server],\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlenses.push({\n\t\t\t\t\trange,\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tid: McpCommandIds.ServerOptions,\n\t\t\t\t\t\ttitle: localize('mcp.server.more', 'More...'),\n\t\t\t\t\t\targuments: [server.definition.id],\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn lensList;\n\t}\n\n\tprivate async _provideInlayHints(model: ITextModel, range: Range): Promise<InlayHintList | undefined> {\n\t\tconst parsed = await this._parseModel(model);\n\t\tif (!parsed) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { tree, inConfig } = parsed;\n\t\tconst mcpSection = inConfig.section ? findNodeAtLocation(tree, [...inConfig.section]) : tree;\n\t\tif (!mcpSection) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst inputsNode = findNodeAtLocation(mcpSection, ['inputs']);\n\t\tif (!inputsNode) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst inputs = await this._mcpRegistry.getSavedInputs(inConfig.scope);\n\t\tconst hints: InlayHint[] = [];\n\n\t\tconst serversNode = findNodeAtLocation(mcpSection, ['servers']);\n\t\tif (serversNode) {\n\t\t\tannotateServers(serversNode);\n\t\t}\n\t\tannotateInputs(inputsNode);\n\n\t\treturn { hints, dispose: () => { } };\n\n\t\tfunction annotateServers(servers: Node) {\n\t\t\tforEachPropertyWithReplacement(servers, node => {\n\t\t\t\tconst expr = ConfigurationResolverExpression.parse(node.value);\n\t\t\t\tfor (const { id } of expr.unresolved()) {\n\t\t\t\t\tconst saved = inputs[id];\n\t\t\t\t\tif (saved) {\n\t\t\t\t\t\tpushAnnotation(id, node.offset + node.value.indexOf(id) + id.length, saved);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction annotateInputs(node: Node) {\n\t\t\tif (node.type !== 'array' || !node.children) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const input of node.children) {\n\t\t\t\tif (input.type !== 'object' || !input.children) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst idProp = input.children.find(c => c.type === 'property' && c.children?.[0].value === 'id');\n\t\t\t\tif (!idProp) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst id = idProp.children![1];\n\t\t\t\tif (!id || id.type !== 'string' || !id.value) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst savedId = '${input:' + id.value + '}';\n\t\t\t\tconst saved = inputs[savedId];\n\t\t\t\tif (saved) {\n\t\t\t\t\tpushAnnotation(savedId, id.offset + 1 + id.length, saved);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction pushAnnotation(savedId: string, offset: number, saved: IResolvedValue): InlayHint {\n\t\t\tconst tooltip = new MarkdownString([\n\t\t\t\tcreateMarkdownCommandLink({ id: McpCommandIds.EditStoredInput, title: localize('edit', 'Edit'), arguments: [savedId, model.uri, mcpConfigurationSection, inConfig!.target] }),\n\t\t\t\tcreateMarkdownCommandLink({ id: McpCommandIds.RemoveStoredInput, title: localize('clear', 'Clear'), arguments: [inConfig!.scope, savedId] }),\n\t\t\t\tcreateMarkdownCommandLink({ id: McpCommandIds.RemoveStoredInput, title: localize('clearAll', 'Clear All'), arguments: [inConfig!.scope] }),\n\t\t\t].join(' | '), { isTrusted: true });\n\n\t\t\tconst hint: InlayHint = {\n\t\t\t\tlabel: '= ' + (saved.input?.type === 'promptString' && saved.input.password ? '*'.repeat(10) : (saved.value || '')),\n\t\t\t\tposition: model.getPositionAt(offset),\n\t\t\t\ttooltip,\n\t\t\t\tpaddingLeft: true,\n\t\t\t};\n\n\t\t\thints.push(hint);\n\t\t\treturn hint;\n\t\t}\n\t}\n}\n\n\n\nfunction forEachPropertyWithReplacement(node: Node, callback: (node: Node) => void) {\n\tif (node.type === 'string' && typeof node.value === 'string' && node.value.includes(ConfigurationResolverExpression.VARIABLE_LHS)) {\n\t\tcallback(node);\n\t} else if (node.type === 'property') {\n\t\t// skip the property name\n\t\tnode.children?.slice(1).forEach(n => forEachPropertyWithReplacement(n, callback));\n\t} else {\n\t\tnode.children?.forEach(n => forEachPropertyWithReplacement(n, callback));\n\t}\n}\n\n\n"]}