{"version":3,"sources":["vs/workbench/contrib/mcp/browser/mcpResourceQuickAccess.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,eAAe,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,MAAM,kCAAkC,CAAC;AACxG,OAAO,EAAE,iBAAiB,EAAE,uBAAuB,EAAE,MAAM,yCAAyC,CAAC;AACrG,OAAO,EAAE,OAAO,EAAE,MAAM,qCAAqC,CAAC;AAC9D,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AACzD,OAAO,EAAE,eAAe,EAAe,YAAY,EAAE,UAAU,EAAE,MAAM,sCAAsC,CAAC;AAC9G,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,eAAe,EAAe,MAAM,uCAAuC,CAAC;AACvG,OAAO,EAAE,SAAS,EAAE,MAAM,sCAAsC,CAAC;AAEjE,OAAO,EAAE,YAAY,EAAE,MAAM,iCAAiC,CAAC;AAC/D,OAAO,EAAE,QAAQ,EAAE,MAAM,oBAAoB,CAAC;AAC9C,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAa,MAAM,4CAA4C,CAAC;AAC/F,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAE,oBAAoB,EAAE,MAAM,0DAA0D,CAAC;AAChG,OAAO,EAAE,6BAA6B,EAAwD,MAAM,uDAAuD,CAAC;AAC5J,OAAO,EAAE,kBAAkB,EAAmD,MAAM,sDAAsD,CAAC;AAC3I,OAAO,EAAE,cAAc,EAAE,MAAM,kDAAkD,CAAC;AAClF,OAAO,EAAE,aAAa,EAAE,MAAM,gDAAgD,CAAC;AAC/E,OAAO,EAAE,kBAAkB,EAAE,MAAM,4BAA4B,CAAC;AAChE,OAAO,EAAE,6BAA6B,EAAE,MAAM,oDAAoD,CAAC;AAEnG,OAAO,EAAkD,WAAW,EAAE,qBAAqB,EAAqC,cAAc,EAAE,MAAM,uBAAuB,CAAC;AAC9K,OAAO,EAAE,QAAQ,EAAE,MAAM,uBAAuB,CAAC;AAEjD,OAAO,EAAE,yBAAyB,EAAE,MAAM,gCAAgC,CAAC;AAC3E,OAAO,EAAE,UAAU,EAAE,MAAM,uCAAuC,CAAC;AAG5D,IAAM,qBAAqB,GAA3B,MAAM,qBAAsB,SAAQ,UAAU;IAI7C,MAAM,CAAC,GAAG,CAAC,MAAkB;QACnC,OAAO;YACN,EAAE,EAAE,MAAM,CAAC,UAAU,CAAC,EAAE;YACxB,IAAI,EAAE,WAAW;YACjB,KAAK,EAAE,MAAM,CAAC,UAAU,CAAC,KAAK;SAC9B,CAAC;IACH,CAAC;IAEM,+BAA+B,CAAC,MAAkB,EAAE,SAAkD;QAC5G,IAAI,WAAW,GAAY,KAAK,CAAC;QACjC,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;QAC7C,IAAI,CAAC,WAAW,EAAE,CAAC;YAClB,MAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC;YAChD,IAAI,WAAW,EAAE,MAAM,KAAK,MAAM,IAAI,WAAW,CAAC,SAAS,KAAK,SAAS,EAAE,CAAC;gBAC3E,WAAW,GAAG,KAAK,CAAC;YACrB,CAAC;iBAAM,CAAC;gBACP,WAAW,GAAG,IAAI,CAAC;YACpB,CAAC;QACF,CAAC;QACD,IAAI,WAAW,EAAE,CAAC;YACjB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;QAClD,CAAC;IAEF,CAAC;IAEM,YAAY;QAClB,MAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,CAAC;QACzC,IAAI,KAAK,EAAE,CAAC;YACX,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,KAAK,CAAC,MAAM,EAAE,SAAS,EAAE,KAAK,CAAC,SAAS,EAAE,EAAE,SAAS,CAAC,CAAC;YACvF,OAAO,IAAI,CAAC;QACb,CAAC;aAAM,CAAC;YACP,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC;IAEM,MAAM,CAAC,IAAI,CAAC,QAA6C;QAC/D,MAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAC3C,IAAI,qBAAqB,CAAC,QAAQ,CAAC,EAAE,CAAC;YACrC,OAAO;gBACN,EAAE,EAAE,QAAQ,CAAC,QAAQ,CAAC,QAAQ;gBAC9B,KAAK,EAAE,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,IAAI;gBACtC,WAAW,EAAE,QAAQ,CAAC,WAAW;gBACjC,MAAM,EAAE,QAAQ,CAAC,IAAuB,EAAE,IAAwB,EAAE,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC;gBAC/F,QAAQ;aACR,CAAC;QACH,CAAC;QAED,OAAO;YACN,EAAE,EAAE,QAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE;YAC3B,KAAK,EAAE,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,IAAI;YACtC,WAAW,EAAE,QAAQ,CAAC,WAAW;YACjC,MAAM,EAAE,QAAQ,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,GAAG,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;YAC5H,QAAQ;SACR,CAAC;IACH,CAAC;IAmBD,YACc,WAAyC,EACxC,YAA2C,EACrC,kBAAuD,EACrD,oBAA2D,EAClD,6BAA6E;QAE5G,KAAK,EAAE,CAAC;QANsB,gBAAW,GAAX,WAAW,CAAa;QACvB,iBAAY,GAAZ,YAAY,CAAc;QACpB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACpC,yBAAoB,GAApB,oBAAoB,CAAsB;QACjC,kCAA6B,GAA7B,6BAA6B,CAA+B;QAjFrG,eAAU,GAAG,eAAe,CAAuF,IAAI,EAAE,EAAE,KAAK,EAAE,IAAI,GAAG,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAC;QAC9J,oBAAe,GAA2F,IAAI,UAAU,EAAE,CAAC;QAC3H,iBAAY,GAAG,eAAe,CAAyF,IAAI,EAAE,SAAS,CAAC,CAAC;QAyDzI,4BAAuB,GAAG,OAAO,CAAC,MAAM,CAAC,EAAE;YACjD,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;gBAC5D,MAAM,GAAG,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBAChD,IAAI,GAAG,KAAK,SAAS,EAAE,CAAC;oBACvB,OAAO,GAAG,IAAI,CAAC,CAAC,qBAAqB;gBACtC,CAAC;qBAAM,IAAI,GAAG,mCAA0B,EAAE,CAAC;oBAC1C,OAAO,GAAG,IAAI,CAAC;oBACf,MAAM;gBACP,CAAC;YACF,CAAC;YAED,OAAO,OAAO,CAAC;QAChB,CAAC,CAAC,CAAC;QA0FI,2BAAsB,GAAG,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IA9EtE,CAAC;IAED;;;;;OAKG;IACI,KAAK,CAAC,QAAQ,CAAC,QAA6C,EAAE,MAAkB;QACtF,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;QACvC,IAAI,CAAC,GAAG,EAAE,CAAC;YACV,OAAO,KAAK,CAAC;QACd,CAAC;QACD,IAAI,IAAI,GAA0B,SAAS,CAAC;QAC5C,IAAI,CAAC;YACJ,IAAI,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,eAAe,EAAE,KAAK,EAAE,CAAC,CAAC;QACzE,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACZ,OAAO,KAAK,CAAC;QACd,CAAC;QAED,IAAI,IAAI,IAAI,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC;YACrF,gDAAgD;YAChD,MAAM,gBAAgB,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACjE,IAAI,gBAAgB,EAAE,CAAC;gBACtB,IAAI,CAAC,+BAA+B,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;YAChE,CAAC;YAED,mDAAmD;YACnD,MAAM,cAAc,GAAmB,IAAI,CAAC,QAAS,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACjE,MAAM,MAAM,GAAG,cAAc,CAAC,UAAU,CAAC,MAAM,CAAC,UAAU,EAAE,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACvF,OAAO;oBACN,GAAG,EAAE,MAAM;oBACX,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI;oBAC3B,IAAI,EAAE,KAAK,CAAC,IAAI;oBAChB,KAAK,EAAE,KAAK,CAAC,IAAI;oBACjB,WAAW,EAAE,QAAQ,CAAC,WAAW;oBACjC,QAAQ,EAAE,SAAS;oBACnB,WAAW,EAAE,KAAK,CAAC,IAAI;oBACvB,KAAK,EAAE,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC;iBACrC,CAAC;YACH,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,cAAc,EAAE,EAAE,SAAS,CAAC,CAAC;YACxE,OAAO,IAAI,CAAC;QACb,CAAC;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAEM,YAAY,CAAC,QAA6C,EAAE,MAAkB;QACpF,MAAM,IAAI,GAAG,MAAM,CAAC;QACpB,IAAI,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,EAAE,CAAC;YACzC,oBAAoB;YACpB,IAAI,CAAC,2BAA2B,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACnD,OAAO,IAAI,CAAC;QACb,CAAC;QACD,IAAI,qBAAqB,CAAC,QAAQ,CAAC,EAAE,CAAC;YACrC,OAAO,IAAI,CAAC,6BAA6B,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC;QAC9E,CAAC;aAAM,CAAC;YACP,OAAO,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC;QACtE,CAAC;IACF,CAAC;IAEM,KAAK,CAAC,2BAA2B,CAAC,QAA6C,EAAE,MAAkB;QACzG,IAAI,CAAC;YACJ,OAAO,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QAC/C,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YAChB,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC;IAEM,KAAK,CAAC,KAAK,CAAC,QAA6C;QAC/D,IAAI,qBAAqB,CAAC,QAAQ,CAAC,EAAE,CAAC;YACrC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC;YAC7D,OAAO,QAAQ,IAAI,MAAM,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;QAC5D,CAAC;aAAM,CAAC;YACP,OAAO,QAAQ,CAAC,GAAG,CAAC;QACrB,CAAC;IACF,CAAC;IAIO,KAAK,CAAC,qBAAqB,CAAC,QAAuD;QAC1F,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,6BAA6B,CAAC,+BAA+B,CAAC,QAAQ,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACrI,IAAI,OAAO,EAAE,CAAC;YACb,OAAO,OAAO,CAAC;QAChB,CAAC;QAED,OAAO;YACN,EAAE,EAAE,QAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE;YAC3B,IAAI,EAAE,MAAM;YACZ,IAAI,EAAE,QAAQ,CAAC,IAAI;YACnB,KAAK,EAAE,QAAQ,CAAC,GAAG;SACnB,CAAC;IACH,CAAC;IAEO,KAAK,CAAC,6BAA6B,CAAC,EAAwB;QACnE,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,EAAE,CAAC,CAAC;QACvD,MAAM,GAAG,GAAG,QAAQ,IAAI,MAAM,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;QAChE,OAAO,GAAG,IAAI,IAAI,CAAC,qBAAqB,CAAC;YACxC,GAAG;YACH,IAAI,EAAE,EAAE,CAAC,IAAI;YACb,QAAQ,EAAE,EAAE,CAAC,QAAQ;SACrB,CAAC,CAAC;IAEJ,CAAC;IAEO,KAAK,CAAC,kBAAkB,CAAC,EAAE,GAAG,EAAE,iBAAiB,EAA4C;QACpG,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACxB,OAAO,GAAG,CAAC;QACZ,CAAC;QAED,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACnD,IAAI,MAAM,EAAE,CAAC;YACZ,OAAO,GAAG,CAAC;QACZ,CAAC;QAED,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAgC,EAAE,IAAiC,EAAE,cAAc,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;QACnK,OAAO,SAAS,CAAC;IAClB,CAAC;IAEO,KAAK,CAAC,sBAAsB,CAAC,EAAwB;QAC5D,MAAM,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAE3F,MAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,eAAe,EAAE,CAAC;QAC7D,MAAM,GAAG,GAAG,IAAI,uBAAuB,EAAE,CAAC;QAE1C,MAAM,IAAI,GAAsC,EAAE,CAAC;QACnD,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;QACpC,UAAU,CAAC,cAAc,GAAG,IAAI,CAAC;QACjC,IAAI,iBAAiB,GAAG,KAAK,CAAC;QAE9B,IAAI,CAAC;YACJ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBACtC,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBACzB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,QAAQ,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;gBACpF,IAAI,QAAQ,KAAK,SAAS,EAAE,CAAC;oBAC5B,OAAO,SAAS,CAAC;gBAClB,CAAC;gBACD,6EAA6E;gBAC7E,iBAAiB,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC;gBAC1C,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvF,CAAC;YACD,OAAO,EAAE,GAAG,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,iBAAiB,EAAE,CAAC;QACxD,CAAC;gBAAS,CAAC;YACV,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAClB,UAAU,CAAC,OAAO,EAAE,CAAC;QACtB,CAAC;IACF,CAAC;IAEO,uBAAuB,CAAC,KAAiC,EAAE,QAA8B,EAAE,cAAiD,EAAE,EAAwB;QAC7K,MAAM,KAAK,GAAG,IAAI,eAAe,EAAE,CAAC;QACpC,MAAM,WAAW,GAAG,IAAI,GAAG,CAA4B,EAAE,CAAC,CAAC;QAE3D,MAAM,yBAAyB,GAAG,EAAE,GAAG,cAAc,EAAE,CAAC;QACxD,KAAK,MAAM,QAAQ,IAAI,EAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;YACtG,IAAI,CAAC,yBAAyB,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;gBAC9D,yBAAyB,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC;YAC9E,CAAC;QACF,CAAC;QAED,IAAI,WAAW,GAAG,QAAQ,CAAC,IAAmC,EAAE,IAAuB,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,UAAU,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC;QAC7L,IAAI,QAAQ,CAAC,QAAQ,EAAE,CAAC;YACvB,WAAW,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAgC,EAAE,IAAU,CAAC,GAAG,GAAG,CAAC;QACpF,CAAC;QAED,KAAK,CAAC,WAAW,GAAG,WAAW,CAAC;QAChC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;QACjB,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;QACjB,KAAK,CAAC,IAAI,EAAE,CAAC;QAEb,MAAM,SAAS,GAAG,YAAY,EAAE,CAAC;QACjC,MAAM,QAAQ,GAAG,CAAC,KAAa,EAAE,YAAsB,EAAE,EAAE,EAAE;YAC5D,MAAM,KAAK,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;YACjF,IAAI,KAAK,EAAE,CAAC;gBACX,KAAK,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;YAChD,CAAC;iBAAM,IAAI,QAAQ,CAAC,QAAQ,EAAE,CAAC;gBAC9B,KAAK,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,CAAC,IAA6B,EAAE,IAAS,CAAC,EAAE,CAAC,CAAC;YAC7F,CAAC;YAED,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;QACrB,CAAC,CAAC;QAEF,IAAI,kBAAkB,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,uBAAuB,EAAE,CAAC,CAAC;QAClE,MAAM,kBAAkB,GAAG,GAAG,EAAE;YAC/B,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC;YAC/B,IAAI,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAC1C,IAAI,CAAC,OAAO,EAAE,CAAC;gBACd,OAAO,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,UAAU,EAAE,cAAc,EAAE,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBAC3F,WAAW,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;YACtC,CAAC;YAED,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;gBACrB,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,uBAAuB,EAAE,CAAC;oBACvD,QAAQ,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;gBAC9B,CAAC;YACF,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE;gBACb,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;YAChC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE;gBACf,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,uBAAuB,EAAE,CAAC;oBACvD,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;gBACpB,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC;QAEF,MAAM,2BAA2B,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,gBAAgB,CAAC,kBAAkB,EAAE,GAAG,CAAC,CAAC,CAAC;QAE7F,OAAO,IAAI,OAAO,CAAoD,OAAO,CAAC,EAAE;YAC/E,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACrD,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,EAAE;gBAChC,MAAM,IAAI,GAAG,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;gBACpC,IAAI,IAAI,CAAC,EAAE,KAAK,SAAS,EAAE,CAAC;oBAC3B,OAAO,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;gBACnD,CAAC;qBAAM,IAAI,QAAQ,CAAC,UAAU,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC,KAAK,EAAE,CAAC;oBAC1F,8FAA8F;oBAC9F,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;gBAC1B,CAAC;qBAAM,CAAC;oBACP,OAAO,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;gBACjD,CAAC;YACF,CAAC,CAAC,CAAC,CAAC;YACJ,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,EAAE;gBACxC,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;gBAClB,kBAAkB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACjC,KAAK,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC;gBACjC,kBAAkB,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,uBAAuB,EAAE,CAAC,CAAC;gBAC9D,2BAA2B,CAAC,MAAM,EAAE,CAAC;gBACrC,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAEhB,IAAI,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC;oBAClC,kBAAkB,EAAE,CAAC;gBACtB,CAAC;qBAAM,CAAC;oBACP,2BAA2B,CAAC,QAAQ,EAAE,CAAC;gBACxC,CAAC;YACF,CAAC,CAAC,CAAC,CAAC;YAEJ,kBAAkB,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;IACnC,CAAC;IAEO,oBAAoB,CAAC,QAA6C;QAEzE,IAAI,QAAQ,CAAC,QAAQ,IAAI,QAAQ,CAAC,QAAQ,KAAK,iBAAiB,EAAE,CAAC;YAClE,OAAO,IAAI,CAAC;QACb,CAAC;aAAM,IAAI,qBAAqB,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC5C,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACjD,CAAC;aAAM,CAAC;YACP,OAAO,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;QACxC,CAAC;IACF,CAAC;IAEM,QAAQ,CAAC,KAAyB;QACxC,MAAM,GAAG,GAAG,IAAI,uBAAuB,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,kBAAkB,GAAG,IAAI,CAAC;QAC9B,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtD,iFAAiF;QACjF,oFAAoF;QACpF,IAAI,cAAc,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,GAAG,EAAE;YACrC,cAAc,GAAG,KAAK,CAAC;YACvB,OAAO,EAAE,CAAC;QACX,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC;QAEX,MAAM,OAAO,GAAG,GAAG,EAAE;YACpB,MAAM,MAAM,GAAG,IAAI,GAAG,EAAuD,CAAC;YAC9E,KAAK,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,IAAI,OAAO,EAAE,CAAC;gBACrC,MAAM,CAAC,GAA4C,EAAE,CAAC;gBACtD,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACtB,IAAI,GAAG,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;oBAC9B,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,SAAS,CAAC,KAAM,CAAC,CAAC;gBACjC,CAAC;qBAAM,IAAI,cAAc,EAAE,CAAC;oBAC3B,MAAM;gBACP,CAAC;gBAED,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,cAAc,CAAC,CAAC;gBAC9B,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,SAAS,IAAI,cAAc,EAAE,CAAC;oBAChD,MAAM;gBACP,CAAC;YACF,CAAC;YACD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,kBAAkB,EAAE,EAAE,SAAS,CAAC,CAAC;QAC/E,CAAC,CAAC;QAIF,MAAM,OAAO,GAAG,IAAI,GAAG,EAAmB,CAAC;QAC3C,kFAAkF;QAClF,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,EAAC,MAAM,EAAC,EAAE;YACvF,IAAI,GAAG,GAAG,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;YACpC,MAAM,GAAG,GAAQ;gBAChB,SAAS,EAAE,IAAI,eAAe,EAAE;gBAChC,cAAc,EAAE,EAAE;gBAClB,SAAS,EAAE,IAAI,eAAe,EAAE;aAChC,CAAC;YACF,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC,gCAAgC;YAE1D,IAAI,GAAG,KAAK,SAAS,EAAE,CAAC;gBACvB,GAAG,GAAG,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;oBACjC,MAAM,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;wBAC3B,IAAI,KAAK,CAAC,KAAK,0CAAkC,IAAI,KAAK,CAAC,KAAK,4CAAoC,EAAE,CAAC;4BACtG,OAAO,CAAC,SAAS,CAAC,CAAC;wBACpB,CAAC;oBACF,CAAC,CAAC,CAAC;oBACH,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,uBAAuB,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;oBAC5E,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;wBAC/B,MAAM,IAAI,GAAG,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;wBAC9C,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;4BACxB,OAAO,CAAC,IAAI,CAAC,CAAC;wBACf,CAAC;oBACF,CAAC,CAAC,CAAC,CAAC;gBACL,CAAC,CAAC,CAAC;YACJ,CAAC;YAED,IAAI,GAAG,IAAI,CAAC,GAAG,mCAA0B,CAAC,EAAE,CAAC;gBAC5C,MAAM,OAAO,CAAC,GAAG,CAAC;oBACjB,GAAG,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,iBAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC;oBAC9F,GAAG,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,KAAK,IAAI,EAAE;wBACpC,IAAI,KAAK,EAAE,MAAM,IAAI,IAAI,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC;4BACtD,GAAG,CAAC,cAAc,GAAG,GAAG,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;4BACrD,OAAO,EAAE,CAAC;wBACX,CAAC;oBACF,CAAC,CAAC,EAAE,CAAC;iBACL,CAAC,CAAC;YACJ,CAAC;iBAAM,CAAC;gBACP,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC3B,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC5B,CAAC;QACF,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE;YAChB,kBAAkB,GAAG,KAAK,CAAC;YAC3B,OAAO,EAAE,CAAC;QACX,CAAC,CAAC,CAAC;QAEH,0FAA0F;QAC1F,OAAO,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE;YAC7B,MAAM,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACzD,OAAO,iBAAiB;gBACvB,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC,iBAAiB,CAAC,MAAM,EAAE,iBAAiB,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE;gBAC9F,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;IACJ,CAAC;CACD,CAAA;AAraY,qBAAqB;IA8E/B,WAAA,WAAW,CAAA;IACX,WAAA,YAAY,CAAA;IACZ,WAAA,kBAAkB,CAAA;IAClB,WAAA,oBAAoB,CAAA;IACpB,WAAA,6BAA6B,CAAA;GAlFnB,qBAAqB,CAqajC;;AAEM,IAAe,6BAA6B,GAA5C,MAAe,6BAA6B;IAClD,YACkB,QAAgC,EACT,qBAA4C,EACnD,cAA8B,EACxB,kBAAsC,EAC7C,aAA4B;QAJ3C,aAAQ,GAAR,QAAQ,CAAwB;QACT,0BAAqB,GAArB,qBAAqB,CAAuB;QACnD,mBAAc,GAAd,cAAc,CAAgB;QACxB,uBAAkB,GAAlB,kBAAkB,CAAoB;QAC7C,kBAAa,GAAb,aAAa,CAAe;IAE7D,CAAC;IAES,WAAW,CAAC,MAA2D,EAAE,KAAwB,EAAE,UAA2C;QACvJ,MAAM,CAAC,qBAAqB,GAAG,IAAI,CAAC;QACpC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;QACnB,MAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;QACjC,MAAM,KAAK,GAAG,IAAI,eAAe,EAAE,CAAC;QACpC,MAAM,QAAQ,GAAG,UAAU,CAAC;QAI5B,MAAM,YAAY,GAAG,QAAQ,CAAC,IAAwB,EAAE,IAAgB,CAAC,CAAC;QAE1E,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,CAAC,cAAc,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAC3F,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YACnB,MAAM,CAAC,eAAe,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1C,CAAC;QACD,MAAM,eAAe,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC/C,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YAC1B,MAAM,SAAS,GAAG,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC/C,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC;YAChC,MAAM,KAAK,GAAqE,EAAE,CAAC;YACnF,KAAK,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,IAAI,SAAS,CAAC,KAAK,EAAE,CAAC;gBACnD,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;gBAC9C,KAAK,MAAM,QAAQ,IAAI,SAAS,EAAE,CAAC;oBAClC,MAAM,QAAQ,GAAG,qBAAqB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBACtD,QAAQ,CAAC,OAAO,GAAG,CAAC,EAAE,SAAS,EAAE,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,CAAC,CAAC;oBACjG,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC;gBAC/C,CAAC;YACF,CAAC;YACD,IAAI,MAAM,CAAC,sBAAsB,EAAE,EAAE,CAAC;gBACrC,mBAAmB;gBACnB,MAAM,UAAU,GAAmB;oBAClC,EAAE,EAAE,QAAQ;oBACZ,KAAK,EAAE,QAAQ,CAAC,IAAQ,EAAE,IAAW,CAAC;oBACtC,UAAU,EAAE,IAAI;iBAChB,CAAC;gBACF,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACxB,CAAC;YACD,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;YACrB,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC;QACtB,CAAC,CAAC,CAAC,CAAC;QAEJ,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,sBAAsB,CAAC,KAAK,CAAC,EAAE;YAC/C,IAAI,KAAK,CAAC,MAAM,CAAC,OAAO,KAAK,YAAY,EAAE,CAAC;gBAC3C,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;gBACnB,MAAM,YAAY,GAAG,KAAK,CAAC,IAA6B,CAAC;gBACzD,MAAM,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC,QAAQ,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;gBACnF,IAAI,UAAU,YAAY,OAAO,EAAE,CAAC;oBACnC,UAAU,CAAC,IAAI,CAAC,KAAK,EAAC,CAAC,EAAC,EAAE;wBACzB,IAAI,CAAC,KAAK,MAAM,EAAE,CAAC;4BAClB,MAAM,MAAM,GAAG,MAAM,yBAAyB,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;4BAC5F,MAAM,EAAE,eAAe,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;wBACvC,CAAC;wBACD,MAAM,CAAC,IAAI,EAAE,CAAC;oBACf,CAAC,CAAC,CAAC;gBACJ,CAAC;YACF,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;QAEJ,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE;YAC/B,MAAM,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC,CAAC;QAEJ,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAC,KAAK,EAAC,EAAE;YAC1C,IAAI,CAAC;gBACJ,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;gBACnB,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,aAAa,CAAC;gBAEpC,qCAAqC;gBACrC,IAAI,IAAI,CAAC,EAAE,KAAK,QAAQ,EAAE,CAAC;oBAC1B,MAAM,CAAC,YAAY,EAAE,CAAC;oBACtB,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC;oBACpB,OAAO;gBACR,CAAC;gBAED,MAAM,YAAY,GAAG,IAA6B,CAAC;gBACnD,MAAM,QAAQ,GAAG,YAAY,CAAC,QAAQ,CAAC;gBACvC,wDAAwD;gBACxD,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;gBACtE,IAAI,CAAC,QAAQ,EAAE,CAAC;oBACf,MAAM,GAAG,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;oBACzC,IAAI,GAAG,EAAE,CAAC;wBACT,MAAM,CAAC,IAAI,EAAE,CAAC;wBACd,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE,aAAa,EAAE,KAAK,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;oBACnG,CAAC;gBACF,CAAC;YACF,CAAC;oBAAS,CAAC;gBACV,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC;YACrB,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;QACJ,OAAO,KAAK,CAAC;IACd,CAAC;CACD,CAAA;AArGqB,6BAA6B;IAGhD,WAAA,qBAAqB,CAAA;IACrB,WAAA,cAAc,CAAA;IACd,WAAA,kBAAkB,CAAA;IAClB,WAAA,aAAa,CAAA;GANM,6BAA6B,CAqGlD;;AAEM,IAAM,oBAAoB,GAA1B,MAAM,oBAAqB,SAAQ,6BAA6B;IACtE,YACC,OAA+B,EACR,oBAA2C,EAClD,aAA6B,EACzB,iBAAqC,EAC1C,YAA2B,EACL,kBAAsC;QAE3E,KAAK,CAAC,OAAO,EAAE,oBAAoB,EAAE,aAAa,EAAE,iBAAiB,EAAE,YAAY,CAAC,CAAC;QAFhD,uBAAkB,GAAlB,kBAAkB,CAAoB;IAG5E,CAAC;IAEM,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,iBAAiB,CAAC,IAAI;QAC/C,MAAM,KAAK,GAAG,IAAI,eAAe,EAAE,CAAC;QACpC,MAAM,EAAE,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QACvF,EAAE,CAAC,WAAW,GAAG,QAAQ,CAAC,IAA6B,EAAE,IAAsB,CAAC,CAAC;QACjF,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;QACvC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;QAC/C,EAAE,CAAC,IAAI,EAAE,CAAC;QACV,MAAM,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;IACrC,CAAC;CACD,CAAA;AArBY,oBAAoB;IAG9B,WAAA,qBAAqB,CAAA;IACrB,WAAA,cAAc,CAAA;IACd,WAAA,kBAAkB,CAAA;IAClB,WAAA,aAAa,CAAA;IACb,WAAA,kBAAkB,CAAA;GAPR,oBAAoB,CAqBhC;;AAEM,IAAM,sBAAsB,GAA5B,MAAM,sBAAuB,SAAQ,6BAA6B;aACjD,WAAM,GAAG,OAAH,AAAU,CAAC;IAIxC,YACwB,oBAA2C,EAClD,aAA6B,EACzB,iBAAqC,EAC1C,YAA2B;QAE1C,KAAK,CAAC,SAAS,EAAE,oBAAoB,EAAE,aAAa,EAAE,iBAAiB,EAAE,YAAY,CAAC,CAAC;QARxF,uBAAkB,GAAG,6BAA6B,CAAC,IAAI,CAAC;IASxD,CAAC;IAED,OAAO,CAAC,MAA2D,EAAE,KAAwB,EAAE,UAA2C;QACzI,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;IACpD,CAAC;;AAhBW,sBAAsB;IAMhC,WAAA,qBAAqB,CAAA;IACrB,WAAA,cAAc,CAAA;IACd,WAAA,kBAAkB,CAAA;IAClB,WAAA,aAAa,CAAA;GATH,sBAAsB,CAiBlC","file":"mcpResourceQuickAccess.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DeferredPromise, disposableTimeout, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { DisposableStore, IDisposable, toDisposable, Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, derived, observableValue, IObservable } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { localize } from '../../../../nls.js';\nimport { ByteSize, IFileService, IFileStat } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { DefaultQuickAccessFilterValue, IQuickAccessProvider, IQuickAccessProviderRunOptions } from '../../../../platform/quickinput/common/quickAccess.js';\nimport { IQuickInputService, IQuickPick, IQuickPickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { IChatWidgetService } from '../../chat/browser/chat.js';\nimport { IChatAttachmentResolveService } from '../../chat/browser/chatAttachmentResolveService.js';\nimport { IChatRequestVariableEntry } from '../../chat/common/chatVariableEntries.js';\nimport { IMcpResource, IMcpResourceTemplate, IMcpServer, IMcpService, isMcpResourceTemplate, McpCapability, McpConnectionState, McpResourceURI } from '../common/mcpTypes.js';\nimport { McpIcons } from '../common/mcpIcons.js';\nimport { IUriTemplateVariable } from '../common/uriTemplate.js';\nimport { openPanelChatAndGetWidget } from './openPanelChatAndGetWidget.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { ChatContextPickAttachment } from '../../chat/browser/chatContextPickService.js';\n\nexport class McpResourcePickHelper extends Disposable {\n\tprivate _resources = observableValue<{ picks: Map<IMcpServer, (IMcpResourceTemplate | IMcpResource)[]>; isBusy: boolean }>(this, { picks: new Map(), isBusy: false });\n\tprivate _pickItemsStack: LinkedList<{ server: IMcpServer; resources: (IMcpResource | IMcpResourceTemplate)[] }> = new LinkedList();\n\tprivate _inDirectory = observableValue<undefined | { server: IMcpServer; resources: (IMcpResource | IMcpResourceTemplate)[] }>(this, undefined);\n\tpublic static sep(server: IMcpServer): IQuickPickSeparator {\n\t\treturn {\n\t\t\tid: server.definition.id,\n\t\t\ttype: 'separator',\n\t\t\tlabel: server.definition.label,\n\t\t};\n\t}\n\n\tpublic addCurrentMCPQuickPickItemLevel(server: IMcpServer, resources: (IMcpResource | IMcpResourceTemplate)[]): void {\n\t\tlet isValidPush: boolean = false;\n\t\tisValidPush = this._pickItemsStack.isEmpty();\n\t\tif (!isValidPush) {\n\t\t\tconst stackedItem = this._pickItemsStack.peek();\n\t\t\tif (stackedItem?.server === server && stackedItem.resources === resources) {\n\t\t\t\tisValidPush = false;\n\t\t\t} else {\n\t\t\t\tisValidPush = true;\n\t\t\t}\n\t\t}\n\t\tif (isValidPush) {\n\t\t\tthis._pickItemsStack.push({ server, resources });\n\t\t}\n\n\t}\n\n\tpublic navigateBack(): boolean {\n\t\tconst items = this._pickItemsStack.pop();\n\t\tif (items) {\n\t\t\tthis._inDirectory.set({ server: items.server, resources: items.resources }, undefined);\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic static item(resource: IMcpResource | IMcpResourceTemplate): IQuickPickItem {\n\t\tconst iconPath = resource.icons.getUrl(22);\n\t\tif (isMcpResourceTemplate(resource)) {\n\t\t\treturn {\n\t\t\t\tid: resource.template.template,\n\t\t\t\tlabel: resource.title || resource.name,\n\t\t\t\tdescription: resource.description,\n\t\t\t\tdetail: localize('mcp.resource.template', 'Resource template: {0}', resource.template.template),\n\t\t\t\ticonPath,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tid: resource.uri.toString(),\n\t\t\tlabel: resource.title || resource.name,\n\t\t\tdescription: resource.description,\n\t\t\tdetail: resource.mcpUri + (resource.sizeInBytes !== undefined ? ' (' + ByteSize.formatSize(resource.sizeInBytes) + ')' : ''),\n\t\t\ticonPath,\n\t\t};\n\t}\n\n\tpublic hasServersWithResources = derived(reader => {\n\t\tlet enabled = false;\n\t\tfor (const server of this._mcpService.servers.read(reader)) {\n\t\t\tconst cap = server.capabilities.read(undefined);\n\t\t\tif (cap === undefined) {\n\t\t\t\tenabled = true; // until we know more\n\t\t\t} else if (cap & McpCapability.Resources) {\n\t\t\t\tenabled = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn enabled;\n\t});\n\n\tpublic explicitServers?: IMcpServer[];\n\n\tconstructor(\n\t\t@IMcpService private readonly _mcpService: IMcpService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@IChatAttachmentResolveService private readonly _chatAttachmentResolveService: IChatAttachmentResolveService\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * Navigate to a resource if it's a directory.\n\t * Returns true if the resource is a directory with children (navigation succeeded).\n\t * Returns false if the resource is a leaf file (no navigation).\n\t * When returning true, statefully updates the picker state to display directory contents.\n\t */\n\tpublic async navigate(resource: IMcpResource | IMcpResourceTemplate, server: IMcpServer): Promise<boolean> {\n\t\tconst uri = await this.toURI(resource);\n\t\tif (!uri) {\n\t\t\treturn false;\n\t\t}\n\t\tlet stat: IFileStat | undefined = undefined;\n\t\ttry {\n\t\t\tstat = await this._fileService.resolve(uri, { resolveMetadata: false });\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (stat && this._isDirectoryResource(resource) && (stat.children?.length ?? 0) > 0) {\n\t\t\t// Save current state to stack before navigating\n\t\t\tconst currentResources = this._resources.get().picks.get(server);\n\t\t\tif (currentResources) {\n\t\t\t\tthis.addCurrentMCPQuickPickItemLevel(server, currentResources);\n\t\t\t}\n\n\t\t\t// Convert all the children to IMcpResource objects\n\t\t\tconst childResources: IMcpResource[] = stat.children!.map(child => {\n\t\t\t\tconst mcpUri = McpResourceURI.fromServer(server.definition, child.resource.toString());\n\t\t\t\treturn {\n\t\t\t\t\turi: mcpUri,\n\t\t\t\t\tmcpUri: child.resource.path,\n\t\t\t\t\tname: child.name,\n\t\t\t\t\ttitle: child.name,\n\t\t\t\t\tdescription: resource.description,\n\t\t\t\t\tmimeType: undefined,\n\t\t\t\t\tsizeInBytes: child.size,\n\t\t\t\t\ticons: McpIcons.fromParsed(undefined)\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis._inDirectory.set({ server, resources: childResources }, undefined);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic toAttachment(resource: IMcpResource | IMcpResourceTemplate, server: IMcpServer): Promise<ChatContextPickAttachment> | 'noop' {\n\t\tconst noop = 'noop';\n\t\tif (this._isDirectoryResource(resource)) {\n\t\t\t//Check if directory\n\t\t\tthis.checkIfDirectoryAndPopulate(resource, server);\n\t\t\treturn noop;\n\t\t}\n\t\tif (isMcpResourceTemplate(resource)) {\n\t\t\treturn this._resourceTemplateToAttachment(resource).then(val => val || noop);\n\t\t} else {\n\t\t\treturn this._resourceToAttachment(resource).then(val => val || noop);\n\t\t}\n\t}\n\n\tpublic async checkIfDirectoryAndPopulate(resource: IMcpResource | IMcpResourceTemplate, server: IMcpServer): Promise<boolean> {\n\t\ttry {\n\t\t\treturn !await this.navigate(resource, server);\n\t\t} catch (error) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic async toURI(resource: IMcpResource | IMcpResourceTemplate): Promise<URI | undefined> {\n\t\tif (isMcpResourceTemplate(resource)) {\n\t\t\tconst maybeUri = await this._resourceTemplateToURI(resource);\n\t\t\treturn maybeUri && await this._verifyUriIfNeeded(maybeUri);\n\t\t} else {\n\t\t\treturn resource.uri;\n\t\t}\n\t}\n\n\tpublic checkIfNestedResources = () => !this._pickItemsStack.isEmpty();\n\n\tprivate async _resourceToAttachment(resource: { uri: URI; name: string; mimeType?: string }): Promise<IChatRequestVariableEntry | undefined> {\n\t\tconst asImage = await this._chatAttachmentResolveService.resolveImageEditorAttachContext(resource.uri, undefined, resource.mimeType);\n\t\tif (asImage) {\n\t\t\treturn asImage;\n\t\t}\n\n\t\treturn {\n\t\t\tid: resource.uri.toString(),\n\t\t\tkind: 'file',\n\t\t\tname: resource.name,\n\t\t\tvalue: resource.uri,\n\t\t};\n\t}\n\n\tprivate async _resourceTemplateToAttachment(rt: IMcpResourceTemplate) {\n\t\tconst maybeUri = await this._resourceTemplateToURI(rt);\n\t\tconst uri = maybeUri && await this._verifyUriIfNeeded(maybeUri);\n\t\treturn uri && this._resourceToAttachment({\n\t\t\turi,\n\t\t\tname: rt.name,\n\t\t\tmimeType: rt.mimeType,\n\t\t});\n\n\t}\n\n\tprivate async _verifyUriIfNeeded({ uri, needsVerification }: { uri: URI; needsVerification: boolean }): Promise<URI | undefined> {\n\t\tif (!needsVerification) {\n\t\t\treturn uri;\n\t\t}\n\n\t\tconst exists = await this._fileService.exists(uri);\n\t\tif (exists) {\n\t\t\treturn uri;\n\t\t}\n\n\t\tthis._notificationService.warn(localize('mcp.resource.template.notFound', \"The resource {0} was not found.\", McpResourceURI.toServer(uri).resourceURL.toString()));\n\t\treturn undefined;\n\t}\n\n\tprivate async _resourceTemplateToURI(rt: IMcpResourceTemplate) {\n\t\tconst todo = rt.template.components.flatMap(c => typeof c === 'object' ? c.variables : []);\n\n\t\tconst quickInput = this._quickInputService.createQuickPick();\n\t\tconst cts = new CancellationTokenSource();\n\n\t\tconst vars: Record<string, string | string[]> = {};\n\t\tquickInput.totalSteps = todo.length;\n\t\tquickInput.ignoreFocusOut = true;\n\t\tlet needsVerification = false;\n\n\t\ttry {\n\t\t\tfor (let i = 0; i < todo.length; i++) {\n\t\t\t\tconst variable = todo[i];\n\t\t\t\tconst resolved = await this._promptForTemplateValue(quickInput, variable, vars, rt);\n\t\t\t\tif (resolved === undefined) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\t// mark the URI as needing verification if any part was not a completion pick\n\t\t\t\tneedsVerification ||= !resolved.completed;\n\t\t\t\tvars[todo[i].name] = variable.repeatable ? resolved.value.split('/') : resolved.value;\n\t\t\t}\n\t\t\treturn { uri: rt.resolveURI(vars), needsVerification };\n\t\t} finally {\n\t\t\tcts.dispose(true);\n\t\t\tquickInput.dispose();\n\t\t}\n\t}\n\n\tprivate _promptForTemplateValue(input: IQuickPick<IQuickPickItem>, variable: IUriTemplateVariable, variablesSoFar: Record<string, string | string[]>, rt: IMcpResourceTemplate): Promise<{ value: string; completed: boolean } | undefined> {\n\t\tconst store = new DisposableStore();\n\t\tconst completions = new Map<string, Promise<string[]>>([]);\n\n\t\tconst variablesWithPlaceholders = { ...variablesSoFar };\n\t\tfor (const variable of rt.template.components.flatMap(c => typeof c === 'object' ? c.variables : [])) {\n\t\t\tif (!variablesWithPlaceholders.hasOwnProperty(variable.name)) {\n\t\t\t\tvariablesWithPlaceholders[variable.name] = `$${variable.name.toUpperCase()}`;\n\t\t\t}\n\t\t}\n\n\t\tlet placeholder = localize('mcp.resource.template.placeholder', \"Value for ${0} in {1}\", variable.name.toUpperCase(), rt.template.resolve(variablesWithPlaceholders).replaceAll('%24', '$'));\n\t\tif (variable.optional) {\n\t\t\tplaceholder += ' (' + localize('mcp.resource.template.optional', \"Optional\") + ')';\n\t\t}\n\n\t\tinput.placeholder = placeholder;\n\t\tinput.value = '';\n\t\tinput.items = [];\n\t\tinput.show();\n\n\t\tconst currentID = generateUuid();\n\t\tconst setItems = (value: string, completed: string[] = []) => {\n\t\t\tconst items = completed.filter(c => c !== value).map(c => ({ id: c, label: c }));\n\t\t\tif (value) {\n\t\t\t\titems.unshift({ id: currentID, label: value });\n\t\t\t} else if (variable.optional) {\n\t\t\t\titems.unshift({ id: currentID, label: localize('mcp.resource.template.empty', \"<Empty>\") });\n\t\t\t}\n\n\t\t\tinput.items = items;\n\t\t};\n\n\t\tlet changeCancellation = store.add(new CancellationTokenSource());\n\t\tconst getCompletionItems = () => {\n\t\t\tconst inputValue = input.value;\n\t\t\tlet promise = completions.get(inputValue);\n\t\t\tif (!promise) {\n\t\t\t\tpromise = rt.complete(variable.name, inputValue, variablesSoFar, changeCancellation.token);\n\t\t\t\tcompletions.set(inputValue, promise);\n\t\t\t}\n\n\t\t\tpromise.then(values => {\n\t\t\t\tif (!changeCancellation.token.isCancellationRequested) {\n\t\t\t\t\tsetItems(inputValue, values);\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tcompletions.delete(inputValue);\n\t\t\t}).finally(() => {\n\t\t\t\tif (!changeCancellation.token.isCancellationRequested) {\n\t\t\t\t\tinput.busy = false;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tconst getCompletionItemsScheduler = store.add(new RunOnceScheduler(getCompletionItems, 300));\n\n\t\treturn new Promise<{ value: string; completed: boolean } | undefined>(resolve => {\n\t\t\tstore.add(input.onDidHide(() => resolve(undefined)));\n\t\t\tstore.add(input.onDidAccept(() => {\n\t\t\t\tconst item = input.selectedItems[0];\n\t\t\t\tif (item.id === currentID) {\n\t\t\t\t\tresolve({ value: input.value, completed: false });\n\t\t\t\t} else if (variable.explodable && item.label.endsWith('/') && item.label !== input.value) {\n\t\t\t\t\t// if navigating in a path structure, picking a `/` should let the user pick in a subdirectory\n\t\t\t\t\tinput.value = item.label;\n\t\t\t\t} else {\n\t\t\t\t\tresolve({ value: item.label, completed: true });\n\t\t\t\t}\n\t\t\t}));\n\t\t\tstore.add(input.onDidChangeValue(value => {\n\t\t\t\tinput.busy = true;\n\t\t\t\tchangeCancellation.dispose(true);\n\t\t\t\tstore.delete(changeCancellation);\n\t\t\t\tchangeCancellation = store.add(new CancellationTokenSource());\n\t\t\t\tgetCompletionItemsScheduler.cancel();\n\t\t\t\tsetItems(value);\n\n\t\t\t\tif (completions.has(input.value)) {\n\t\t\t\t\tgetCompletionItems();\n\t\t\t\t} else {\n\t\t\t\t\tgetCompletionItemsScheduler.schedule();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tgetCompletionItems();\n\t\t}).finally(() => store.dispose());\n\t}\n\n\tprivate _isDirectoryResource(resource: IMcpResource | IMcpResourceTemplate): boolean {\n\n\t\tif (resource.mimeType && resource.mimeType === 'inode/directory') {\n\t\t\treturn true;\n\t\t} else if (isMcpResourceTemplate(resource)) {\n\t\t\treturn resource.template.template.endsWith('/');\n\t\t} else {\n\t\t\treturn resource.uri.path.endsWith('/');\n\t\t}\n\t}\n\n\tpublic getPicks(token?: CancellationToken): IObservable<{ picks: Map<IMcpServer, (IMcpResourceTemplate | IMcpResource)[]>; isBusy: boolean }> {\n\t\tconst cts = new CancellationTokenSource(token);\n\t\tlet isBusyLoadingPicks = true;\n\t\tthis._register(toDisposable(() => cts.dispose(true)));\n\t\t// We try to show everything in-sequence to avoid flickering (#250411) as long as\n\t\t// it loads within 5 seconds. Otherwise we just show things as the load in parallel.\n\t\tlet showInSequence = true;\n\t\tthis._register(disposableTimeout(() => {\n\t\t\tshowInSequence = false;\n\t\t\tpublish();\n\t\t}, 5_000));\n\n\t\tconst publish = () => {\n\t\t\tconst output = new Map<IMcpServer, (IMcpResourceTemplate | IMcpResource)[]>();\n\t\t\tfor (const [server, rec] of servers) {\n\t\t\t\tconst r: (IMcpResourceTemplate | IMcpResource)[] = [];\n\t\t\t\toutput.set(server, r);\n\t\t\t\tif (rec.templates.isResolved) {\n\t\t\t\t\tr.push(...rec.templates.value!);\n\t\t\t\t} else if (showInSequence) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tr.push(...rec.resourcesSoFar);\n\t\t\t\tif (!rec.resources.isSettled && showInSequence) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._resources.set({ picks: output, isBusy: isBusyLoadingPicks }, undefined);\n\t\t};\n\n\t\ttype Rec = { templates: DeferredPromise<IMcpResourceTemplate[]>; resourcesSoFar: IMcpResource[]; resources: DeferredPromise<unknown> };\n\n\t\tconst servers = new Map<IMcpServer, Rec>();\n\t\t// Enumerate servers and start servers that need to be started to get capabilities\n\t\tPromise.all((this.explicitServers || this._mcpService.servers.get()).map(async server => {\n\t\t\tlet cap = server.capabilities.get();\n\t\t\tconst rec: Rec = {\n\t\t\t\ttemplates: new DeferredPromise(),\n\t\t\t\tresourcesSoFar: [],\n\t\t\t\tresources: new DeferredPromise(),\n\t\t\t};\n\t\t\tservers.set(server, rec); // always add it to retain order\n\n\t\t\tif (cap === undefined) {\n\t\t\t\tcap = await new Promise(resolve => {\n\t\t\t\t\tserver.start().then(state => {\n\t\t\t\t\t\tif (state.state === McpConnectionState.Kind.Error || state.state === McpConnectionState.Kind.Stopped) {\n\t\t\t\t\t\t\tresolve(undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis._register(cts.token.onCancellationRequested(() => resolve(undefined)));\n\t\t\t\t\tthis._register(autorun(reader => {\n\t\t\t\t\t\tconst cap2 = server.capabilities.read(reader);\n\t\t\t\t\t\tif (cap2 !== undefined) {\n\t\t\t\t\t\t\tresolve(cap2);\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (cap && (cap & McpCapability.Resources)) {\n\t\t\t\tawait Promise.all([\n\t\t\t\t\trec.templates.settleWith(server.resourceTemplates(cts.token).catch(() => [])).finally(publish),\n\t\t\t\t\trec.resources.settleWith((async () => {\n\t\t\t\t\t\tfor await (const page of server.resources(cts.token)) {\n\t\t\t\t\t\t\trec.resourcesSoFar = rec.resourcesSoFar.concat(page);\n\t\t\t\t\t\t\tpublish();\n\t\t\t\t\t\t}\n\t\t\t\t\t})())\n\t\t\t\t]);\n\t\t\t} else {\n\t\t\t\trec.templates.complete([]);\n\t\t\t\trec.resources.complete([]);\n\t\t\t}\n\t\t})).finally(() => {\n\t\t\tisBusyLoadingPicks = false;\n\t\t\tpublish();\n\t\t});\n\n\t\t// Use derived to compute the appropriate resource map based on directory navigation state\n\t\treturn derived(this, reader => {\n\t\t\tconst directoryResource = this._inDirectory.read(reader);\n\t\t\treturn directoryResource\n\t\t\t\t? { picks: new Map([[directoryResource.server, directoryResource.resources]]), isBusy: false }\n\t\t\t\t: this._resources.read(reader);\n\t\t});\n\t}\n}\n\nexport abstract class AbstractMcpResourceAccessPick {\n\tconstructor(\n\t\tprivate readonly _scopeTo: IMcpServer | undefined,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IChatWidgetService protected readonly _chatWidgetService: IChatWidgetService,\n\t\t@IViewsService private readonly _viewsService: IViewsService,\n\t) {\n\t}\n\n\tprotected applyToPick(picker: IQuickPick<IQuickPickItem, { useSeparators: true }>, token: CancellationToken, runOptions?: IQuickAccessProviderRunOptions) {\n\t\tpicker.canAcceptInBackground = true;\n\t\tpicker.busy = true;\n\t\tpicker.keepScrollPosition = true;\n\t\tconst store = new DisposableStore();\n\t\tconst goBackId = '_goback_';\n\n\t\ttype ResourceQuickPickItem = IQuickPickItem & { resource: IMcpResource | IMcpResourceTemplate; server: IMcpServer };\n\n\t\tconst attachButton = localize('mcp.quickaccess.attach', \"Attach to chat\");\n\n\t\tconst helper = store.add(this._instantiationService.createInstance(McpResourcePickHelper));\n\t\tif (this._scopeTo) {\n\t\t\thelper.explicitServers = [this._scopeTo];\n\t\t}\n\t\tconst picksObservable = helper.getPicks(token);\n\t\tstore.add(autorun(reader => {\n\t\t\tconst pickItems = picksObservable.read(reader);\n\t\t\tconst isBusy = pickItems.isBusy;\n\t\t\tconst items: (ResourceQuickPickItem | IQuickPickSeparator | IQuickPickItem)[] = [];\n\t\t\tfor (const [server, resources] of pickItems.picks) {\n\t\t\t\titems.push(McpResourcePickHelper.sep(server));\n\t\t\t\tfor (const resource of resources) {\n\t\t\t\t\tconst pickItem = McpResourcePickHelper.item(resource);\n\t\t\t\t\tpickItem.buttons = [{ iconClass: ThemeIcon.asClassName(Codicon.attach), tooltip: attachButton }];\n\t\t\t\t\titems.push({ ...pickItem, resource, server });\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (helper.checkIfNestedResources()) {\n\t\t\t\t// Add go back item\n\t\t\t\tconst goBackItem: IQuickPickItem = {\n\t\t\t\t\tid: goBackId,\n\t\t\t\t\tlabel: localize('goBack', 'Go back â†©'),\n\t\t\t\t\talwaysShow: true\n\t\t\t\t};\n\t\t\t\titems.push(goBackItem);\n\t\t\t}\n\t\t\tpicker.items = items;\n\t\t\tpicker.busy = isBusy;\n\t\t}));\n\n\t\tstore.add(picker.onDidTriggerItemButton(event => {\n\t\t\tif (event.button.tooltip === attachButton) {\n\t\t\t\tpicker.busy = true;\n\t\t\t\tconst resourceItem = event.item as ResourceQuickPickItem;\n\t\t\t\tconst attachment = helper.toAttachment(resourceItem.resource, resourceItem.server);\n\t\t\t\tif (attachment instanceof Promise) {\n\t\t\t\t\tattachment.then(async a => {\n\t\t\t\t\t\tif (a !== 'noop') {\n\t\t\t\t\t\t\tconst widget = await openPanelChatAndGetWidget(this._viewsService, this._chatWidgetService);\n\t\t\t\t\t\t\twidget?.attachmentModel.addContext(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpicker.hide();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tstore.add(picker.onDidHide(() => {\n\t\t\thelper.dispose();\n\t\t}));\n\n\t\tstore.add(picker.onDidAccept(async event => {\n\t\t\ttry {\n\t\t\t\tpicker.busy = true;\n\t\t\t\tconst [item] = picker.selectedItems;\n\n\t\t\t\t// Check if go back item was selected\n\t\t\t\tif (item.id === goBackId) {\n\t\t\t\t\thelper.navigateBack();\n\t\t\t\t\tpicker.busy = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst resourceItem = item as ResourceQuickPickItem;\n\t\t\t\tconst resource = resourceItem.resource;\n\t\t\t\t// Try to navigate into the resource if it's a directory\n\t\t\t\tconst isNested = await helper.navigate(resource, resourceItem.server);\n\t\t\t\tif (!isNested) {\n\t\t\t\t\tconst uri = await helper.toURI(resource);\n\t\t\t\t\tif (uri) {\n\t\t\t\t\t\tpicker.hide();\n\t\t\t\t\t\tthis._editorService.openEditor({ resource: uri, options: { preserveFocus: event.inBackground } });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tpicker.busy = false;\n\t\t\t}\n\t\t}));\n\t\treturn store;\n\t}\n}\n\nexport class McpResourceQuickPick extends AbstractMcpResourceAccessPick {\n\tconstructor(\n\t\tscopeTo: IMcpServer | undefined,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IChatWidgetService chatWidgetService: IChatWidgetService,\n\t\t@IViewsService viewsService: IViewsService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t) {\n\t\tsuper(scopeTo, instantiationService, editorService, chatWidgetService, viewsService);\n\t}\n\n\tpublic async pick(token = CancellationToken.None) {\n\t\tconst store = new DisposableStore();\n\t\tconst qp = store.add(this._quickInputService.createQuickPick({ useSeparators: true }));\n\t\tqp.placeholder = localize('mcp.quickaccess.placeholder', \"Search for resources\");\n\t\tstore.add(this.applyToPick(qp, token));\n\t\tstore.add(qp.onDidHide(() => store.dispose()));\n\t\tqp.show();\n\t\tawait Event.toPromise(qp.onDidHide);\n\t}\n}\n\nexport class McpResourceQuickAccess extends AbstractMcpResourceAccessPick implements IQuickAccessProvider {\n\tpublic static readonly PREFIX = 'mcpr ';\n\n\tdefaultFilterValue = DefaultQuickAccessFilterValue.LAST;\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IChatWidgetService chatWidgetService: IChatWidgetService,\n\t\t@IViewsService viewsService: IViewsService\n\t) {\n\t\tsuper(undefined, instantiationService, editorService, chatWidgetService, viewsService);\n\t}\n\n\tprovide(picker: IQuickPick<IQuickPickItem, { useSeparators: true }>, token: CancellationToken, runOptions?: IQuickAccessProviderRunOptions): IDisposable {\n\t\treturn this.applyToPick(picker, token, runOptions);\n\t}\n}\n"]}