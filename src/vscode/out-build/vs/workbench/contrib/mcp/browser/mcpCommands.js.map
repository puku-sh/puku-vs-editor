{"version":3,"sources":["vs/workbench/contrib/mcp/browser/mcpCommands.ts"],"names":[],"mappings":"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","file":"mcpCommands.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { $, addDisposableListener, disposableWindowInterval, EventType } from '../../../../base/browser/dom.js';\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { IManagedHoverTooltipHTMLElement } from '../../../../base/browser/ui/hover/hover.js';\nimport { Checkbox } from '../../../../base/browser/ui/toggle/toggle.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { assertNever } from '../../../../base/common/assert.js';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { groupBy } from '../../../../base/common/collections.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { createMarkdownCommandLink, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, derived, derivedObservableWithCache, observableValue } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../../editor/common/core/range.js';\nimport { SuggestController } from '../../../../editor/contrib/suggest/browser/suggestController.js';\nimport { ILocalizedString, localize, localize2 } from '../../../../nls.js';\nimport { IActionViewItemService } from '../../../../platform/actions/browser/actionViewItemService.js';\nimport { MenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { Action2, MenuId, MenuItemAction, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ConfigurationTarget, IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { mcpAutoStartConfig, McpAutoStartValue } from '../../../../platform/mcp/common/mcpManagement.js';\nimport { observableConfigValue } from '../../../../platform/observable/common/platformObservableUtils.js';\nimport { IQuickInputService, IQuickPickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { StorageScope } from '../../../../platform/storage/common/storage.js';\nimport { defaultCheckboxStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { spinningLoading } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IWorkspaceContextService, IWorkspaceFolder } from '../../../../platform/workspace/common/workspace.js';\nimport { PICK_WORKSPACE_FOLDER_COMMAND_ID } from '../../../browser/actions/workspaceCommands.js';\nimport { ActiveEditorContext, RemoteNameContext, ResourceContextKey, WorkbenchStateContext, WorkspaceFolderCountContext } from '../../../common/contextkeys.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IAuthenticationService } from '../../../services/authentication/common/authentication.js';\nimport { IAccountQuery, IAuthenticationQueryService } from '../../../services/authentication/common/authenticationQuery.js';\nimport { MCP_CONFIGURATION_KEY, WORKSPACE_STANDALONE_CONFIGURATIONS } from '../../../services/configuration/common/configuration.js';\nimport { IEditorService } from '../../../services/editor/common/editorService.js';\nimport { IRemoteUserDataProfilesService } from '../../../services/userDataProfile/common/remoteUserDataProfiles.js';\nimport { IUserDataProfileService } from '../../../services/userDataProfile/common/userDataProfile.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { CHAT_CONFIG_MENU_ID } from '../../chat/browser/actions/chatActions.js';\nimport { ChatViewId, IChatWidgetService } from '../../chat/browser/chat.js';\nimport { ChatContextKeys } from '../../chat/common/chatContextKeys.js';\nimport { IChatElicitationRequest, IChatToolInvocation } from '../../chat/common/chatService.js';\nimport { ChatModeKind } from '../../chat/common/constants.js';\nimport { ILanguageModelsService } from '../../chat/common/languageModels.js';\nimport { ILanguageModelToolsService } from '../../chat/common/languageModelToolsService.js';\nimport { VIEW_CONTAINER } from '../../extensions/browser/extensions.contribution.js';\nimport { extensionsFilterSubMenu, IExtensionsWorkbenchService } from '../../extensions/common/extensions.js';\nimport { TEXT_FILE_EDITOR_ID } from '../../files/common/files.js';\nimport { McpCommandIds } from '../common/mcpCommandIds.js';\nimport { McpContextKeys } from '../common/mcpContextKeys.js';\nimport { IMcpRegistry } from '../common/mcpRegistryTypes.js';\nimport { HasInstalledMcpServersContext, IMcpSamplingService, IMcpServer, IMcpServerStartOpts, IMcpService, InstalledMcpServersViewId, LazyCollectionState, McpCapability, McpCollectionDefinition, McpConnectionState, McpDefinitionReference, mcpPromptPrefix, McpServerCacheState, McpStartServerInteraction } from '../common/mcpTypes.js';\nimport { McpAddConfigurationCommand } from './mcpCommandsAddConfiguration.js';\nimport { McpResourceQuickAccess, McpResourceQuickPick } from './mcpResourceQuickAccess.js';\nimport './media/mcpServerAction.css';\nimport { openPanelChatAndGetWidget } from './openPanelChatAndGetWidget.js';\n\n// acroynms do not get localized\nconst category: ILocalizedString = {\n\toriginal: 'MCP',\n\tvalue: 'MCP',\n};\n\nexport class ListMcpServerCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ListServer,\n\t\t\ttitle: localize2('mcp.list', 'List Servers'),\n\t\t\ticon: Codicon.server,\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ChatContextKeys.Setup.hidden.negate(),\n\t\t\tmenu: [{\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tContextKeyExpr.or(\n\t\t\t\t\t\tContextKeyExpr.and(ContextKeyExpr.equals(`config.${mcpAutoStartConfig}`, McpAutoStartValue.Never), McpContextKeys.hasUnknownTools),\n\t\t\t\t\t\tMcpContextKeys.hasServersWithErrors,\n\t\t\t\t\t),\n\t\t\t\t\tChatContextKeys.chatModeKind.isEqualTo(ChatModeKind.Agent),\n\t\t\t\t\tChatContextKeys.lockedToCodingAgent.negate(),\n\t\t\t\t\tChatContextKeys.Setup.hidden.negate(),\n\t\t\t\t),\n\t\t\t\tid: MenuId.ChatInput,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 101,\n\t\t\t}],\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor) {\n\t\tconst mcpService = accessor.get(IMcpService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst quickInput = accessor.get(IQuickInputService);\n\n\t\ttype ItemType = { id: string } & IQuickPickItem;\n\n\t\tconst store = new DisposableStore();\n\t\tconst pick = quickInput.createQuickPick<ItemType>({ useSeparators: true });\n\t\tpick.placeholder = localize('mcp.selectServer', 'Select an MCP Server');\n\n\t\tmcpService.activateCollections();\n\n\t\tstore.add(pick);\n\n\t\tstore.add(autorun(reader => {\n\t\t\tconst servers = groupBy(mcpService.servers.read(reader).slice().sort((a, b) => (a.collection.presentation?.order || 0) - (b.collection.presentation?.order || 0)), s => s.collection.id);\n\t\t\tconst firstRun = pick.items.length === 0;\n\t\t\tpick.items = [\n\t\t\t\t{ id: '$add', label: localize('mcp.addServer', 'Add Server'), description: localize('mcp.addServer.description', 'Add a new server configuration'), alwaysShow: true, iconClass: ThemeIcon.asClassName(Codicon.add) },\n\t\t\t\t...Object.values(servers).filter(s => s!.length).flatMap((servers): (ItemType | IQuickPickSeparator)[] => [\n\t\t\t\t\t{ type: 'separator', label: servers![0].collection.label, id: servers![0].collection.id },\n\t\t\t\t\t...servers!.map(server => ({\n\t\t\t\t\t\tid: server.definition.id,\n\t\t\t\t\t\tlabel: server.definition.label,\n\t\t\t\t\t\tdescription: McpConnectionState.toString(server.connectionState.read(reader)),\n\t\t\t\t\t})),\n\t\t\t\t]),\n\t\t\t];\n\n\t\t\tif (firstRun && pick.items.length > 3) {\n\t\t\t\tpick.activeItems = pick.items.slice(2, 3) as ItemType[]; // select the first server by default\n\t\t\t}\n\t\t}));\n\n\n\t\tconst picked = await new Promise<ItemType | undefined>(resolve => {\n\t\t\tstore.add(pick.onDidAccept(() => {\n\t\t\t\tresolve(pick.activeItems[0]);\n\t\t\t}));\n\t\t\tstore.add(pick.onDidHide(() => {\n\t\t\t\tresolve(undefined);\n\t\t\t}));\n\t\t\tpick.show();\n\t\t});\n\n\t\tstore.dispose();\n\n\t\tif (!picked) {\n\t\t\t// no-op\n\t\t} else if (picked.id === '$add') {\n\t\t\tcommandService.executeCommand(McpCommandIds.AddConfiguration);\n\t\t} else {\n\t\t\tcommandService.executeCommand(McpCommandIds.ServerOptions, picked.id);\n\t\t}\n\t}\n}\n\ninterface ActionItem extends IQuickPickItem {\n\taction: 'start' | 'stop' | 'restart' | 'showOutput' | 'config' | 'configSampling' | 'samplingLog' | 'resources';\n}\n\ninterface AuthActionItem extends IQuickPickItem {\n\taction: 'disconnect' | 'signout';\n\taccountQuery: IAccountQuery;\n}\n\nexport class McpConfirmationServerOptionsCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ServerOptionsInConfirmation,\n\t\t\ttitle: localize2('mcp.options', 'Server Options'),\n\t\t\tcategory,\n\t\t\ticon: Codicon.settingsGear,\n\t\t\tf1: false,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ChatConfirmationMenu,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tContextKeyExpr.equals('chatConfirmationPartSource', 'mcp'),\n\t\t\t\t\tContextKeyExpr.or(\n\t\t\t\t\t\tContextKeyExpr.equals('chatConfirmationPartType', 'chatToolConfirmation'),\n\t\t\t\t\t\tContextKeyExpr.equals('chatConfirmationPartType', 'elicitation'),\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t\tgroup: 'navigation'\n\t\t\t}],\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, arg: IChatToolInvocation | IChatElicitationRequest): Promise<void> {\n\t\tconst toolsService = accessor.get(ILanguageModelToolsService);\n\t\tif (arg.kind === 'toolInvocation') {\n\t\t\tconst tool = toolsService.getTool(arg.toolId);\n\t\t\tif (tool?.source.type === 'mcp') {\n\t\t\t\taccessor.get(ICommandService).executeCommand(McpCommandIds.ServerOptions, tool.source.definitionId);\n\t\t\t}\n\t\t} else if (arg.kind === 'elicitation2') {\n\t\t\tif (arg.source?.type === 'mcp') {\n\t\t\t\taccessor.get(ICommandService).executeCommand(McpCommandIds.ServerOptions, arg.source.definitionId);\n\t\t\t}\n\t\t} else {\n\t\t\tassertNever(arg);\n\t\t}\n\t}\n}\n\nexport class McpServerOptionsCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ServerOptions,\n\t\t\ttitle: localize2('mcp.options', 'Server Options'),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, id: string): Promise<void> {\n\t\tconst mcpService = accessor.get(IMcpService);\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst mcpRegistry = accessor.get(IMcpRegistry);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst samplingService = accessor.get(IMcpSamplingService);\n\t\tconst authenticationQueryService = accessor.get(IAuthenticationQueryService);\n\t\tconst authenticationService = accessor.get(IAuthenticationService);\n\t\tconst server = mcpService.servers.get().find(s => s.definition.id === id);\n\t\tif (!server) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst collection = mcpRegistry.collections.get().find(c => c.id === server.collection.id);\n\t\tconst serverDefinition = collection?.serverDefinitions.get().find(s => s.id === server.definition.id);\n\n\t\tconst items: (ActionItem | AuthActionItem | IQuickPickSeparator)[] = [];\n\t\tconst serverState = server.connectionState.get();\n\n\t\titems.push({ type: 'separator', label: localize('mcp.actions.status', 'Status') });\n\n\t\t// Only show start when server is stopped or in error state\n\t\tif (McpConnectionState.canBeStarted(serverState.state)) {\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.start', 'Start Server'),\n\t\t\t\taction: 'start'\n\t\t\t});\n\t\t} else {\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.stop', 'Stop Server'),\n\t\t\t\taction: 'stop'\n\t\t\t});\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.restart', 'Restart Server'),\n\t\t\t\taction: 'restart'\n\t\t\t});\n\t\t}\n\n\t\titems.push(...this._getAuthActions(authenticationQueryService, server.definition.id));\n\n\t\tconst configTarget = serverDefinition?.presentation?.origin || collection?.presentation?.origin;\n\t\tif (configTarget) {\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.config', 'Show Configuration'),\n\t\t\t\taction: 'config',\n\t\t\t});\n\t\t}\n\n\t\titems.push({\n\t\t\tlabel: localize('mcp.showOutput', 'Show Output'),\n\t\t\taction: 'showOutput'\n\t\t});\n\n\t\titems.push(\n\t\t\t{ type: 'separator', label: localize('mcp.actions.sampling', 'Sampling') },\n\t\t\t{\n\t\t\t\tlabel: localize('mcp.configAccess', 'Configure Model Access'),\n\t\t\t\tdescription: localize('mcp.showOutput.description', 'Set the models the server can use via MCP sampling'),\n\t\t\t\taction: 'configSampling'\n\t\t\t},\n\t\t);\n\n\n\t\tif (samplingService.hasLogs(server)) {\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.samplingLog', 'Show Sampling Requests'),\n\t\t\t\tdescription: localize('mcp.samplingLog.description', 'Show the sampling requests for this server'),\n\t\t\t\taction: 'samplingLog',\n\t\t\t});\n\t\t}\n\n\t\tconst capabilities = server.capabilities.get();\n\t\tif (capabilities === undefined || (capabilities & McpCapability.Resources)) {\n\t\t\titems.push({ type: 'separator', label: localize('mcp.actions.resources', 'Resources') });\n\t\t\titems.push({\n\t\t\t\tlabel: localize('mcp.resources', 'Browse Resources'),\n\t\t\t\taction: 'resources',\n\t\t\t});\n\t\t}\n\n\t\tconst pick = await quickInputService.pick(items, {\n\t\t\tplaceHolder: localize('mcp.selectAction', 'Select action for \\'{0}\\'', server.definition.label),\n\t\t});\n\n\t\tif (!pick) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (pick.action) {\n\t\t\tcase 'start':\n\t\t\t\tawait server.start({ promptType: 'all-untrusted' });\n\t\t\t\tserver.showOutput();\n\t\t\t\tbreak;\n\t\t\tcase 'stop':\n\t\t\t\tawait server.stop();\n\t\t\t\tbreak;\n\t\t\tcase 'restart':\n\t\t\t\tawait server.stop();\n\t\t\t\tawait server.start({ promptType: 'all-untrusted' });\n\t\t\t\tbreak;\n\t\t\tcase 'disconnect':\n\t\t\t\tawait server.stop();\n\t\t\t\tawait this._handleAuth(authenticationService, pick.accountQuery, server.definition, false);\n\t\t\t\tbreak;\n\t\t\tcase 'signout':\n\t\t\t\tawait server.stop();\n\t\t\t\tawait this._handleAuth(authenticationService, pick.accountQuery, server.definition, true);\n\t\t\t\tbreak;\n\t\t\tcase 'showOutput':\n\t\t\t\tserver.showOutput();\n\t\t\t\tbreak;\n\t\t\tcase 'config':\n\t\t\t\teditorService.openEditor({\n\t\t\t\t\tresource: URI.isUri(configTarget) ? configTarget : configTarget!.uri,\n\t\t\t\t\toptions: { selection: URI.isUri(configTarget) ? undefined : configTarget!.range }\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'configSampling':\n\t\t\t\treturn commandService.executeCommand(McpCommandIds.ConfigureSamplingModels, server);\n\t\t\tcase 'resources':\n\t\t\t\treturn commandService.executeCommand(McpCommandIds.BrowseResources, server);\n\t\t\tcase 'samplingLog':\n\t\t\t\teditorService.openEditor({\n\t\t\t\t\tresource: undefined,\n\t\t\t\t\tcontents: samplingService.getLogText(server),\n\t\t\t\t\tlabel: localize('mcp.samplingLog.title', 'MCP Sampling: {0}', server.definition.label),\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tassertNever(pick);\n\t\t}\n\t}\n\n\tprivate _getAuthActions(\n\t\tauthenticationQueryService: IAuthenticationQueryService,\n\t\tserverId: string\n\t): AuthActionItem[] {\n\t\tconst result: AuthActionItem[] = [];\n\t\t// Really, this should only ever have one entry.\n\t\tfor (const [providerId, accountName] of authenticationQueryService.mcpServer(serverId).getAllAccountPreferences()) {\n\n\t\t\tconst accountQuery = authenticationQueryService.provider(providerId).account(accountName);\n\t\t\tif (!accountQuery.mcpServer(serverId).isAccessAllowed()) {\n\t\t\t\tcontinue; // skip accounts that are not allowed\n\t\t\t}\n\t\t\t// If there are multiple allowed servers/extensions, other things are using this provider\n\t\t\t// so we show a disconnect action, otherwise we show a sign out action.\n\t\t\tif (accountQuery.entities().getEntityCount().total > 1) {\n\t\t\t\tresult.push({\n\t\t\t\t\taction: 'disconnect',\n\t\t\t\t\tlabel: localize('mcp.disconnect', 'Disconnect Account'),\n\t\t\t\t\tdescription: `(${accountName})`,\n\t\t\t\t\taccountQuery\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresult.push({\n\t\t\t\t\taction: 'signout',\n\t\t\t\t\tlabel: localize('mcp.signOut', 'Sign Out'),\n\t\t\t\t\tdescription: `(${accountName})`,\n\t\t\t\t\taccountQuery\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate async _handleAuth(\n\t\tauthenticationService: IAuthenticationService,\n\t\taccountQuery: IAccountQuery,\n\t\tdefinition: McpDefinitionReference,\n\t\tsignOut: boolean\n\t) {\n\t\tconst { providerId, accountName } = accountQuery;\n\t\taccountQuery.mcpServer(definition.id).setAccessAllowed(false, definition.label);\n\t\tif (signOut) {\n\t\t\tconst accounts = await authenticationService.getAccounts(providerId);\n\t\t\tconst account = accounts.find(a => a.label === accountName);\n\t\t\tif (account) {\n\t\t\t\tconst sessions = await authenticationService.getSessions(providerId, undefined, { account });\n\t\t\t\tfor (const session of sessions) {\n\t\t\t\t\tawait authenticationService.removeSession(providerId, session.id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class MCPServerActionRendering extends Disposable implements IWorkbenchContribution {\n\tconstructor(\n\t\t@IActionViewItemService actionViewItemService: IActionViewItemService,\n\t\t@IMcpService mcpService: IMcpService,\n\t\t@IInstantiationService instaService: IInstantiationService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t) {\n\t\tsuper();\n\n\t\tconst hoverIsOpen = observableValue(this, false);\n\t\tconst config = observableConfigValue(mcpAutoStartConfig, McpAutoStartValue.NewAndOutdated, configurationService);\n\n\t\tconst enum DisplayedState {\n\t\t\tNone,\n\t\t\tNewTools,\n\t\t\tError,\n\t\t\tRefreshing,\n\t\t}\n\n\t\ttype DisplayedStateT = {\n\t\t\tstate: DisplayedState;\n\t\t\tservers: (IMcpServer | McpCollectionDefinition)[];\n\t\t};\n\n\t\tfunction isServer(s: IMcpServer | McpCollectionDefinition): s is IMcpServer {\n\t\t\treturn typeof (s as IMcpServer).start === 'function';\n\t\t}\n\n\t\tconst displayedStateCurrent = derived((reader): DisplayedStateT => {\n\t\t\tconst servers = mcpService.servers.read(reader);\n\t\t\tconst serversPerState: (IMcpServer | McpCollectionDefinition)[][] = [];\n\t\t\tfor (const server of servers) {\n\t\t\t\tlet thisState = DisplayedState.None;\n\t\t\t\tswitch (server.cacheState.read(reader)) {\n\t\t\t\t\tcase McpServerCacheState.Unknown:\n\t\t\t\t\tcase McpServerCacheState.Outdated:\n\t\t\t\t\t\tthisState = server.connectionState.read(reader).state === McpConnectionState.Kind.Error ? DisplayedState.Error : DisplayedState.NewTools;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase McpServerCacheState.RefreshingFromUnknown:\n\t\t\t\t\t\tthisState = DisplayedState.Refreshing;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthisState = server.connectionState.read(reader).state === McpConnectionState.Kind.Error ? DisplayedState.Error : DisplayedState.None;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tserversPerState[thisState] ??= [];\n\t\t\t\tserversPerState[thisState].push(server);\n\t\t\t}\n\n\t\t\tconst unknownServerStates = mcpService.lazyCollectionState.read(reader);\n\t\t\tif (unknownServerStates.state === LazyCollectionState.LoadingUnknown) {\n\t\t\t\tserversPerState[DisplayedState.Refreshing] ??= [];\n\t\t\t\tserversPerState[DisplayedState.Refreshing].push(...unknownServerStates.collections);\n\t\t\t} else if (unknownServerStates.state === LazyCollectionState.HasUnknown) {\n\t\t\t\tserversPerState[DisplayedState.NewTools] ??= [];\n\t\t\t\tserversPerState[DisplayedState.NewTools].push(...unknownServerStates.collections);\n\t\t\t}\n\n\t\t\tlet maxState = (serversPerState.length - 1) as DisplayedState;\n\t\t\tif (maxState === DisplayedState.NewTools && config.read(reader) !== McpAutoStartValue.Never) {\n\t\t\t\tmaxState = DisplayedState.None;\n\t\t\t}\n\n\t\t\treturn { state: maxState, servers: serversPerState[maxState] || [] };\n\t\t});\n\n\t\t// avoid hiding the hover if a state changes while it's open:\n\t\tconst displayedState = derivedObservableWithCache<DisplayedStateT>(this, (reader, last) => {\n\t\t\tif (last && hoverIsOpen.read(reader)) {\n\t\t\t\treturn last;\n\t\t\t} else {\n\t\t\t\treturn displayedStateCurrent.read(reader);\n\t\t\t}\n\t\t});\n\n\t\tconst actionItemState = displayedState.map(s => s.state);\n\n\t\tthis._store.add(actionViewItemService.register(MenuId.ChatInput, McpCommandIds.ListServer, (action, options) => {\n\t\t\tif (!(action instanceof MenuItemAction)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn instaService.createInstance(class extends MenuEntryActionViewItem {\n\n\t\t\t\toverride render(container: HTMLElement): void {\n\n\t\t\t\t\tsuper.render(container);\n\t\t\t\t\tcontainer.classList.add('chat-mcp');\n\t\t\t\t\tcontainer.style.position = 'relative';\n\n\t\t\t\t\tconst stateIndicator = container.appendChild($('.chat-mcp-state-indicator'));\n\t\t\t\t\tstateIndicator.style.display = 'none';\n\n\t\t\t\t\tthis._register(autorun(r => {\n\t\t\t\t\t\tconst displayed = displayedState.read(r);\n\t\t\t\t\t\tconst { state } = displayed;\n\t\t\t\t\t\tthis.updateTooltip();\n\n\n\t\t\t\t\t\tstateIndicator.ariaLabel = this.getLabelForState(displayed);\n\t\t\t\t\t\tstateIndicator.className = 'chat-mcp-state-indicator';\n\t\t\t\t\t\tif (state === DisplayedState.NewTools) {\n\t\t\t\t\t\t\tstateIndicator.style.display = 'block';\n\t\t\t\t\t\t\tstateIndicator.classList.add('chat-mcp-state-new', ...ThemeIcon.asClassNameArray(Codicon.refresh));\n\t\t\t\t\t\t} else if (state === DisplayedState.Error) {\n\t\t\t\t\t\t\tstateIndicator.style.display = 'block';\n\t\t\t\t\t\t\tstateIndicator.classList.add('chat-mcp-state-error', ...ThemeIcon.asClassNameArray(Codicon.warning));\n\t\t\t\t\t\t} else if (state === DisplayedState.Refreshing) {\n\t\t\t\t\t\t\tstateIndicator.style.display = 'block';\n\t\t\t\t\t\t\tstateIndicator.classList.add('chat-mcp-state-refreshing', ...ThemeIcon.asClassNameArray(spinningLoading));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstateIndicator.style.display = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\toverride async onClick(e: MouseEvent): Promise<void> {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\tconst { state, servers } = displayedStateCurrent.get();\n\t\t\t\t\tif (state === DisplayedState.NewTools) {\n\t\t\t\t\t\tconst interaction = new McpStartServerInteraction();\n\t\t\t\t\t\tservers.filter(isServer).forEach(server => server.stop().then(() => server.start({ interaction })));\n\t\t\t\t\t\tmcpService.activateCollections();\n\t\t\t\t\t} else if (state === DisplayedState.Refreshing) {\n\t\t\t\t\t\tfindLast(servers, isServer)?.showOutput();\n\t\t\t\t\t} else if (state === DisplayedState.Error) {\n\t\t\t\t\t\tconst server = findLast(servers, isServer);\n\t\t\t\t\t\tif (server) {\n\t\t\t\t\t\t\tawait server.showOutput(true);\n\t\t\t\t\t\t\tcommandService.executeCommand(McpCommandIds.ServerOptions, server.definition.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommandService.executeCommand(McpCommandIds.ListServer);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tprotected override getTooltip(): string {\n\t\t\t\t\treturn this.getLabelForState() || super.getTooltip();\n\t\t\t\t}\n\n\t\t\t\tprotected override getHoverContents({ state, servers } = displayedStateCurrent.get()): string | undefined | IManagedHoverTooltipHTMLElement {\n\t\t\t\t\tconst link = (s: IMcpServer) => createMarkdownCommandLink({\n\t\t\t\t\t\ttitle: s.definition.label,\n\t\t\t\t\t\tid: McpCommandIds.ServerOptions,\n\t\t\t\t\t\targuments: [s.definition.id],\n\t\t\t\t\t});\n\n\t\t\t\t\tconst single = servers.length === 1;\n\t\t\t\t\tconst names = servers.map(s => isServer(s) ? link(s) : '`' + s.label + '`').map(l => single ? l : `- ${l}`).join('\\n');\n\t\t\t\t\tlet markdown: MarkdownString;\n\t\t\t\t\tif (state === DisplayedState.NewTools) {\n\t\t\t\t\t\tmarkdown = new MarkdownString(single\n\t\t\t\t\t\t\t? localize('mcp.newTools.md.single', \"MCP server {0} has been updated and may have new tools available.\", names)\n\t\t\t\t\t\t\t: localize('mcp.newTools.md.multi', \"MCP servers have been updated and may have new tools available:\\n\\n{0}\", names)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (state === DisplayedState.Error) {\n\t\t\t\t\t\tmarkdown = new MarkdownString(single\n\t\t\t\t\t\t\t? localize('mcp.err.md.single', \"MCP server {0} was unable to start successfully.\", names)\n\t\t\t\t\t\t\t: localize('mcp.err.md.multi', \"Multiple MCP servers were unable to start successfully:\\n\\n{0}\", names)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this.getLabelForState() || undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\telement: (token): HTMLElement => {\n\t\t\t\t\t\t\thoverIsOpen.set(true, undefined);\n\n\t\t\t\t\t\t\tconst store = new DisposableStore();\n\t\t\t\t\t\t\tstore.add(toDisposable(() => hoverIsOpen.set(false, undefined)));\n\t\t\t\t\t\t\tstore.add(token.onCancellationRequested(() => {\n\t\t\t\t\t\t\t\tstore.dispose();\n\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t// todo@connor4312/@benibenj: workaround for #257923\n\t\t\t\t\t\t\tstore.add(disposableWindowInterval(mainWindow, () => {\n\t\t\t\t\t\t\t\tif (!container.isConnected) {\n\t\t\t\t\t\t\t\t\tstore.dispose();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 2000));\n\n\t\t\t\t\t\t\tconst container = $('div.mcp-hover-contents');\n\n\t\t\t\t\t\t\t// Render markdown content\n\t\t\t\t\t\t\tmarkdown.isTrusted = true;\n\t\t\t\t\t\t\tconst markdownResult = store.add(renderMarkdown(markdown));\n\t\t\t\t\t\t\tcontainer.appendChild(markdownResult.element);\n\n\t\t\t\t\t\t\t// Add divider\n\t\t\t\t\t\t\tconst divider = $('hr.mcp-hover-divider');\n\t\t\t\t\t\t\tcontainer.appendChild(divider);\n\n\t\t\t\t\t\t\t// Add checkbox for mcpAutoStartConfig setting\n\t\t\t\t\t\t\tconst checkboxContainer = $('div.mcp-hover-setting');\n\t\t\t\t\t\t\tconst settingLabelStr = localize('mcp.autoStart', \"Automatically start MCP servers when sending a chat message\");\n\n\t\t\t\t\t\t\tconst checkbox = store.add(new Checkbox(\n\t\t\t\t\t\t\t\tsettingLabelStr,\n\t\t\t\t\t\t\t\tconfig.get() !== McpAutoStartValue.Never,\n\t\t\t\t\t\t\t\t{ ...defaultCheckboxStyles }\n\t\t\t\t\t\t\t));\n\n\t\t\t\t\t\t\tcheckboxContainer.appendChild(checkbox.domNode);\n\n\t\t\t\t\t\t\t// Add label next to checkbox\n\t\t\t\t\t\t\tconst settingLabel = $('span.mcp-hover-setting-label', undefined, settingLabelStr);\n\t\t\t\t\t\t\tcheckboxContainer.appendChild(settingLabel);\n\n\t\t\t\t\t\t\tconst onChange = () => {\n\t\t\t\t\t\t\t\tconst newValue = checkbox.checked ? McpAutoStartValue.NewAndOutdated : McpAutoStartValue.Never;\n\t\t\t\t\t\t\t\tconfigurationService.updateValue(mcpAutoStartConfig, newValue);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tstore.add(checkbox.onChange(onChange));\n\n\t\t\t\t\t\t\tstore.add(addDisposableListener(settingLabel, EventType.CLICK, () => {\n\t\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t\t\tonChange();\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\tcontainer.appendChild(checkboxContainer);\n\n\t\t\t\t\t\t\treturn container;\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tprivate getLabelForState({ state, servers } = displayedStateCurrent.get()) {\n\t\t\t\t\tif (state === DisplayedState.NewTools) {\n\t\t\t\t\t\treturn localize('mcp.newTools', \"New tools available ({0})\", servers.length || 1);\n\t\t\t\t\t} else if (state === DisplayedState.Error) {\n\t\t\t\t\t\treturn localize('mcp.toolError', \"Error loading {0} tool(s)\", servers.length || 1);\n\t\t\t\t\t} else if (state === DisplayedState.Refreshing) {\n\t\t\t\t\t\treturn localize('mcp.toolRefresh', \"Discovering tools...\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, action, { ...options, keybindingNotRenderedWithLabel: true });\n\n\t\t}, Event.fromObservableLight(actionItemState)));\n\t}\n}\n\nexport class ResetMcpTrustCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ResetTrust,\n\t\t\ttitle: localize2('mcp.resetTrust', \"Reset Trust\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ContextKeyExpr.and(McpContextKeys.toolsCount.greater(0), ChatContextKeys.Setup.hidden.negate()),\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst mcpService = accessor.get(IMcpService);\n\t\tmcpService.resetTrust();\n\t}\n}\n\n\nexport class ResetMcpCachedTools extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ResetCachedTools,\n\t\t\ttitle: localize2('mcp.resetCachedTools', \"Reset Cached Tools\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ContextKeyExpr.and(McpContextKeys.toolsCount.greater(0), ChatContextKeys.Setup.hidden.negate()),\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst mcpService = accessor.get(IMcpService);\n\t\tmcpService.resetCaches();\n\t}\n}\n\nexport class AddConfigurationAction extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.AddConfiguration,\n\t\t\ttitle: localize2('mcp.addConfiguration', \"Add Server...\"),\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize2('mcp.addConfiguration.description', \"Installs a new Model Context protocol to the mcp.json settings\"),\n\t\t\t},\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ChatContextKeys.Setup.hidden.negate(),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorContent,\n\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\tContextKeyExpr.regex(ResourceContextKey.Path.key, /\\.vscode[/\\\\]mcp\\.json$/),\n\t\t\t\t\tActiveEditorContext.isEqualTo(TEXT_FILE_EDITOR_ID),\n\t\t\t\t\tChatContextKeys.Setup.hidden.negate(),\n\t\t\t\t)\n\t\t\t}\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, configUri?: string): Promise<void> {\n\t\tconst instantiationService = accessor.get(IInstantiationService);\n\t\tconst workspaceService = accessor.get(IWorkspaceContextService);\n\t\tconst target = configUri ? workspaceService.getWorkspaceFolder(URI.parse(configUri)) : undefined;\n\t\treturn instantiationService.createInstance(McpAddConfigurationCommand, target ?? undefined).run();\n\t}\n}\n\n\nexport class RemoveStoredInput extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.RemoveStoredInput,\n\t\t\ttitle: localize2('mcp.resetCachedTools', \"Reset Cached Tools\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, scope: StorageScope, id?: string): void {\n\t\taccessor.get(IMcpRegistry).clearSavedInputs(scope, id);\n\t}\n}\n\nexport class EditStoredInput extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.EditStoredInput,\n\t\t\ttitle: localize2('mcp.editStoredInput', \"Edit Stored Input\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, inputId: string, uri: URI | undefined, configSection: string, target: ConfigurationTarget): void {\n\t\tconst workspaceFolder = uri && accessor.get(IWorkspaceContextService).getWorkspaceFolder(uri);\n\t\taccessor.get(IMcpRegistry).editSavedInput(inputId, workspaceFolder || undefined, configSection, target);\n\t}\n}\n\nexport class ShowConfiguration extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ShowConfiguration,\n\t\t\ttitle: localize2('mcp.command.showConfiguration', \"Show Configuration\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, collectionId: string, serverId: string): void {\n\t\tconst collection = accessor.get(IMcpRegistry).collections.get().find(c => c.id === collectionId);\n\t\tif (!collection) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst server = collection?.serverDefinitions.get().find(s => s.id === serverId);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tif (server?.presentation?.origin) {\n\t\t\teditorService.openEditor({\n\t\t\t\tresource: server.presentation.origin.uri,\n\t\t\t\toptions: { selection: server.presentation.origin.range }\n\t\t\t});\n\t\t} else if (collection.presentation?.origin) {\n\t\t\teditorService.openEditor({\n\t\t\t\tresource: collection.presentation.origin,\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport class ShowOutput extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ShowOutput,\n\t\t\ttitle: localize2('mcp.command.showOutput', \"Show Output\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, serverId: string): void {\n\t\taccessor.get(IMcpService).servers.get().find(s => s.definition.id === serverId)?.showOutput();\n\t}\n}\n\nexport class RestartServer extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.RestartServer,\n\t\t\ttitle: localize2('mcp.command.restartServer', \"Restart Server\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, serverId: string, opts?: IMcpServerStartOpts) {\n\t\tconst s = accessor.get(IMcpService).servers.get().find(s => s.definition.id === serverId);\n\t\ts?.showOutput();\n\t\tawait s?.stop();\n\t\tawait s?.start({ promptType: 'all-untrusted', ...opts });\n\t}\n}\n\nexport class StartServer extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.StartServer,\n\t\t\ttitle: localize2('mcp.command.startServer', \"Start Server\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, serverId: string, opts?: IMcpServerStartOpts) {\n\t\tconst s = accessor.get(IMcpService).servers.get().find(s => s.definition.id === serverId);\n\t\tawait s?.start({ promptType: 'all-untrusted', ...opts });\n\t}\n}\n\nexport class StopServer extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.StopServer,\n\t\t\ttitle: localize2('mcp.command.stopServer', \"Stop Server\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, serverId: string) {\n\t\tconst s = accessor.get(IMcpService).servers.get().find(s => s.definition.id === serverId);\n\t\tawait s?.stop();\n\t}\n}\n\nexport class McpBrowseCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.Browse,\n\t\t\ttitle: localize2('mcp.command.browse', \"MCP Servers\"),\n\t\t\ttooltip: localize2('mcp.command.browse.tooltip', \"Browse MCP Servers\"),\n\t\t\tcategory,\n\t\t\ticon: Codicon.search,\n\t\t\tprecondition: ChatContextKeys.Setup.hidden.negate(),\n\t\t\tmenu: [{\n\t\t\t\tid: extensionsFilterSubMenu,\n\t\t\t\tgroup: '1_predefined',\n\t\t\t\torder: 1,\n\t\t\t\twhen: ChatContextKeys.Setup.hidden.negate(),\n\t\t\t}, {\n\t\t\t\tid: MenuId.ViewTitle,\n\t\t\t\twhen: ContextKeyExpr.and(ContextKeyExpr.equals('view', InstalledMcpServersViewId), ChatContextKeys.Setup.hidden.negate()),\n\t\t\t\tgroup: 'navigation',\n\t\t\t}],\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\taccessor.get(IExtensionsWorkbenchService).openSearch('@mcp ');\n\t}\n}\n\nMenuRegistry.appendMenuItem(MenuId.CommandPalette, {\n\tcommand: {\n\t\tid: McpCommandIds.Browse,\n\t\ttitle: localize2('mcp.command.browse.mcp', \"Browse MCP Servers\"),\n\t\tcategory,\n\t\tprecondition: ChatContextKeys.Setup.hidden.negate(),\n\t},\n});\n\nexport class ShowInstalledMcpServersCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ShowInstalled,\n\t\t\ttitle: localize2('mcp.command.show.installed', \"Show Installed Servers\"),\n\t\t\tcategory,\n\t\t\tprecondition: ContextKeyExpr.and(HasInstalledMcpServersContext, ChatContextKeys.Setup.hidden.negate()),\n\t\t\tf1: true,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tconst viewsService = accessor.get(IViewsService);\n\t\tconst view = await viewsService.openView(InstalledMcpServersViewId, true);\n\t\tif (!view) {\n\t\t\tawait viewsService.openViewContainer(VIEW_CONTAINER.id);\n\t\t\tawait viewsService.openView(InstalledMcpServersViewId, true);\n\t\t}\n\t}\n}\n\nMenuRegistry.appendMenuItem(CHAT_CONFIG_MENU_ID, {\n\tcommand: {\n\t\tid: McpCommandIds.ShowInstalled,\n\t\ttitle: localize2('mcp.servers', \"MCP Servers\")\n\t},\n\twhen: ContextKeyExpr.and(ChatContextKeys.enabled, ContextKeyExpr.equals('view', ChatViewId)),\n\torder: 10,\n\tgroup: '2_level'\n});\n\nabstract class OpenMcpResourceCommand extends Action2 {\n\tprotected abstract getURI(accessor: ServicesAccessor): Promise<URI>;\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tconst fileService = accessor.get(IFileService);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst resource = await this.getURI(accessor);\n\t\tif (!(await fileService.exists(resource))) {\n\t\t\tawait fileService.createFile(resource, VSBuffer.fromString(JSON.stringify({ servers: {} }, null, '\\t')));\n\t\t}\n\t\tawait editorService.openEditor({ resource });\n\t}\n}\n\nexport class OpenUserMcpResourceCommand extends OpenMcpResourceCommand {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.OpenUserMcp,\n\t\t\ttitle: localize2('mcp.command.openUserMcp', \"Open User Configuration\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ChatContextKeys.Setup.hidden.negate(),\n\t\t});\n\t}\n\n\tprotected override getURI(accessor: ServicesAccessor): Promise<URI> {\n\t\tconst userDataProfileService = accessor.get(IUserDataProfileService);\n\t\treturn Promise.resolve(userDataProfileService.currentProfile.mcpResource);\n\t}\n}\n\nexport class OpenRemoteUserMcpResourceCommand extends OpenMcpResourceCommand {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.OpenRemoteUserMcp,\n\t\t\ttitle: localize2('mcp.command.openRemoteUserMcp', \"Open Remote User Configuration\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tChatContextKeys.Setup.hidden.negate(),\n\t\t\t\tRemoteNameContext.notEqualsTo('')\n\t\t\t)\n\t\t});\n\t}\n\n\tprotected override async getURI(accessor: ServicesAccessor): Promise<URI> {\n\t\tconst userDataProfileService = accessor.get(IUserDataProfileService);\n\t\tconst remoteUserDataProfileService = accessor.get(IRemoteUserDataProfilesService);\n\t\tconst remoteProfile = await remoteUserDataProfileService.getRemoteProfile(userDataProfileService.currentProfile);\n\t\treturn remoteProfile.mcpResource;\n\t}\n}\n\nexport class OpenWorkspaceFolderMcpResourceCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.OpenWorkspaceFolderMcp,\n\t\t\ttitle: localize2('mcp.command.openWorkspaceFolderMcp', \"Open Workspace Folder MCP Configuration\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tChatContextKeys.Setup.hidden.negate(),\n\t\t\t\tWorkspaceFolderCountContext.notEqualsTo(0)\n\t\t\t)\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tconst workspaceContextService = accessor.get(IWorkspaceContextService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst workspaceFolders = workspaceContextService.getWorkspace().folders;\n\t\tconst workspaceFolder = workspaceFolders.length === 1 ? workspaceFolders[0] : await commandService.executeCommand<IWorkspaceFolder>(PICK_WORKSPACE_FOLDER_COMMAND_ID);\n\t\tif (workspaceFolder) {\n\t\t\tawait editorService.openEditor({ resource: workspaceFolder.toResource(WORKSPACE_STANDALONE_CONFIGURATIONS[MCP_CONFIGURATION_KEY]) });\n\t\t}\n\t}\n}\n\nexport class OpenWorkspaceMcpResourceCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.OpenWorkspaceMcp,\n\t\t\ttitle: localize2('mcp.command.openWorkspaceMcp', \"Open Workspace MCP Configuration\"),\n\t\t\tcategory,\n\t\t\tf1: true,\n\t\t\tprecondition: ContextKeyExpr.and(\n\t\t\t\tChatContextKeys.Setup.hidden.negate(),\n\t\t\t\tWorkbenchStateContext.isEqualTo('workspace')\n\t\t\t)\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor) {\n\t\tconst workspaceContextService = accessor.get(IWorkspaceContextService);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst workspaceConfiguration = workspaceContextService.getWorkspace().configuration;\n\t\tif (workspaceConfiguration) {\n\t\t\tawait editorService.openEditor({ resource: workspaceConfiguration });\n\t\t}\n\t}\n}\n\nexport class McpBrowseResourcesCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.BrowseResources,\n\t\t\ttitle: localize2('mcp.browseResources', \"Browse Resources...\"),\n\t\t\tcategory,\n\t\t\tprecondition: ContextKeyExpr.and(McpContextKeys.serverCount.greater(0), ChatContextKeys.Setup.hidden.negate()),\n\t\t\tf1: true,\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, server?: IMcpServer): void {\n\t\tif (server) {\n\t\t\taccessor.get(IInstantiationService).createInstance(McpResourceQuickPick, server).pick();\n\t\t} else {\n\t\t\taccessor.get(IQuickInputService).quickAccess.show(McpResourceQuickAccess.PREFIX);\n\t\t}\n\t}\n}\n\nexport class McpConfigureSamplingModels extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.ConfigureSamplingModels,\n\t\t\ttitle: localize2('mcp.configureSamplingModels', \"Configure SamplingModel\"),\n\t\t\tcategory,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, server: IMcpServer): Promise<number> {\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst lmService = accessor.get(ILanguageModelsService);\n\t\tconst mcpSampling = accessor.get(IMcpSamplingService);\n\n\t\tconst existingIds = new Set(mcpSampling.getConfig(server).allowedModels);\n\t\tconst allItems: IQuickPickItem[] = lmService.getLanguageModelIds().map(id => {\n\t\t\tconst model = lmService.lookupLanguageModel(id)!;\n\t\t\tif (!model.isUserSelectable) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tlabel: model.name,\n\t\t\t\tdescription: model.tooltip,\n\t\t\t\tid,\n\t\t\t\tpicked: existingIds.size ? existingIds.has(id) : model.isDefault,\n\t\t\t};\n\t\t}).filter(isDefined);\n\n\t\tallItems.sort((a, b) => (b.picked ? 1 : 0) - (a.picked ? 1 : 0) || a.label.localeCompare(b.label));\n\n\t\t// do the quickpick selection\n\t\tconst picked = await quickInputService.pick(allItems, {\n\t\t\tplaceHolder: localize('mcp.configureSamplingModels.ph', 'Pick the models {0} can access via MCP sampling', server.definition.label),\n\t\t\tcanPickMany: true,\n\t\t});\n\n\t\tif (picked) {\n\t\t\tawait mcpSampling.updateConfig(server, c => c.allowedModels = picked.map(p => p.id!));\n\t\t}\n\n\t\treturn picked?.length || 0;\n\t}\n}\n\nexport class McpStartPromptingServerCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.StartPromptForServer,\n\t\t\ttitle: localize2('mcp.startPromptingServer', \"Start Prompting Server\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, server: IMcpServer): Promise<void> {\n\t\tconst widget = await openPanelChatAndGetWidget(accessor.get(IViewsService), accessor.get(IChatWidgetService));\n\t\tif (!widget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editor = widget.inputEditor;\n\t\tconst model = editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst range = (editor.getSelection() || model.getFullModelRange()).collapseToEnd();\n\t\tconst text = mcpPromptPrefix(server.definition) + '.';\n\n\t\tmodel.applyEdits([{ range, text }]);\n\t\teditor.setSelection(Range.fromPositions(range.getEndPosition().delta(0, text.length)));\n\t\twidget.focusInput();\n\t\tSuggestController.get(editor)?.triggerSuggest();\n\t}\n}\n\nexport class McpSkipCurrentAutostartCommand extends Action2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: McpCommandIds.SkipCurrentAutostart,\n\t\t\ttitle: localize2('mcp.skipCurrentAutostart', \"Skip Current Autostart\"),\n\t\t\tcategory,\n\t\t\tf1: false,\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\taccessor.get(IMcpService).cancelAutostart();\n\t}\n}\n"]}