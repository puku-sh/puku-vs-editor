{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/mcp/common/discovery/workspaceMcpDiscoveryAdapter.ts","vs/workbench/contrib/mcp/common/discovery/workspaceMcpDiscoveryAdapter.ts"],"names":[],"mappings":"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","file":"workspaceMcpDiscoveryAdapter.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableMap, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { observableValue } from '../../../../../base/common/observable.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ConfigurationTarget, IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { StorageScope } from '../../../../../platform/storage/common/storage.js';\nimport { IWorkspaceContextService, IWorkspaceFolder } from '../../../../../platform/workspace/common/workspace.js';\nimport { IRemoteAgentService } from '../../../../services/remote/common/remoteAgentService.js';\nimport { DiscoverySource } from '../mcpConfiguration.js';\nimport { IMcpRegistry } from '../mcpRegistryTypes.js';\nimport { McpCollectionSortOrder, McpServerTrust } from '../mcpTypes.js';\nimport { IMcpDiscovery } from './mcpDiscovery.js';\nimport { FilesystemMcpDiscovery, WritableMcpCollectionDefinition } from './nativeMcpDiscoveryAbstract.js';\nimport { claudeConfigToServerDefinition } from './nativeMcpDiscoveryAdapters.js';\n\nexport class CursorWorkspaceMcpDiscoveryAdapter extends FilesystemMcpDiscovery implements IMcpDiscovery {\n\tprivate readonly _collections = this._register(new DisposableMap<string, IDisposable>());\n\n\tconstructor(\n\t\t@IFileService fileService: IFileService,\n\t\t@IWorkspaceContextService private readonly _workspaceContextService: IWorkspaceContextService,\n\t\t@IMcpRegistry mcpRegistry: IMcpRegistry,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IRemoteAgentService private readonly _remoteAgentService: IRemoteAgentService,\n\t) {\n\t\tsuper(configurationService, fileService, mcpRegistry);\n\t}\n\n\tstart(): void {\n\t\tthis._register(this._workspaceContextService.onDidChangeWorkspaceFolders(e => {\n\t\t\tfor (const removed of e.removed) {\n\t\t\t\tthis._collections.deleteAndDispose(removed.uri.toString());\n\t\t\t}\n\t\t\tfor (const added of e.added) {\n\t\t\t\tthis.watchFolder(added);\n\t\t\t}\n\t\t}));\n\n\t\tfor (const folder of this._workspaceContextService.getWorkspace().folders) {\n\t\t\tthis.watchFolder(folder);\n\t\t}\n\t}\n\n\tprivate watchFolder(folder: IWorkspaceFolder) {\n\t\tconst configFile = joinPath(folder.uri, '.cursor', 'mcp.json');\n\t\tconst collection: WritableMcpCollectionDefinition = {\n\t\t\tid: `cursor-workspace.${folder.index}`,\n\t\t\tlabel: `${folder.name}/.cursor/mcp.json`,\n\t\t\tremoteAuthority: this._remoteAgentService.getConnection()?.remoteAuthority || null,\n\t\t\tscope: StorageScope.WORKSPACE,\n\t\t\ttrustBehavior: McpServerTrust.Kind.TrustedOnNonce,\n\t\t\tserverDefinitions: observableValue(this, []),\n\t\t\tconfigTarget: ConfigurationTarget.WORKSPACE_FOLDER,\n\t\t\tpresentation: {\n\t\t\t\torigin: configFile,\n\t\t\t\torder: McpCollectionSortOrder.WorkspaceFolder + 1,\n\t\t\t},\n\t\t};\n\n\t\tthis._collections.set(folder.uri.toString(), this.watchFile(\n\t\t\tURI.joinPath(folder.uri, '.cursor', 'mcp.json'),\n\t\t\tcollection,\n\t\t\tDiscoverySource.CursorWorkspace,\n\t\t\tasync contents => {\n\t\t\t\tconst defs = await claudeConfigToServerDefinition(collection.id, contents, folder.uri);\n\t\t\t\tdefs?.forEach(d => d.roots = [folder.uri]);\n\t\t\t\treturn defs;\n\t\t\t}\n\t\t));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DisposableMap, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { observableValue } from '../../../../../base/common/observable.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ConfigurationTarget, IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { StorageScope } from '../../../../../platform/storage/common/storage.js';\nimport { IWorkspaceContextService, IWorkspaceFolder } from '../../../../../platform/workspace/common/workspace.js';\nimport { IRemoteAgentService } from '../../../../services/remote/common/remoteAgentService.js';\nimport { DiscoverySource } from '../mcpConfiguration.js';\nimport { IMcpRegistry } from '../mcpRegistryTypes.js';\nimport { McpCollectionSortOrder, McpServerTrust } from '../mcpTypes.js';\nimport { IMcpDiscovery } from './mcpDiscovery.js';\nimport { FilesystemMcpDiscovery, WritableMcpCollectionDefinition } from './nativeMcpDiscoveryAbstract.js';\nimport { claudeConfigToServerDefinition } from './nativeMcpDiscoveryAdapters.js';\n\nexport class CursorWorkspaceMcpDiscoveryAdapter extends FilesystemMcpDiscovery implements IMcpDiscovery {\n\tprivate readonly _collections = this._register(new DisposableMap<string, IDisposable>());\n\n\tconstructor(\n\t\t@IFileService fileService: IFileService,\n\t\t@IWorkspaceContextService private readonly _workspaceContextService: IWorkspaceContextService,\n\t\t@IMcpRegistry mcpRegistry: IMcpRegistry,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IRemoteAgentService private readonly _remoteAgentService: IRemoteAgentService,\n\t) {\n\t\tsuper(configurationService, fileService, mcpRegistry);\n\t}\n\n\tstart(): void {\n\t\tthis._register(this._workspaceContextService.onDidChangeWorkspaceFolders(e => {\n\t\t\tfor (const removed of e.removed) {\n\t\t\t\tthis._collections.deleteAndDispose(removed.uri.toString());\n\t\t\t}\n\t\t\tfor (const added of e.added) {\n\t\t\t\tthis.watchFolder(added);\n\t\t\t}\n\t\t}));\n\n\t\tfor (const folder of this._workspaceContextService.getWorkspace().folders) {\n\t\t\tthis.watchFolder(folder);\n\t\t}\n\t}\n\n\tprivate watchFolder(folder: IWorkspaceFolder) {\n\t\tconst configFile = joinPath(folder.uri, '.cursor', 'mcp.json');\n\t\tconst collection: WritableMcpCollectionDefinition = {\n\t\t\tid: `cursor-workspace.${folder.index}`,\n\t\t\tlabel: `${folder.name}/.cursor/mcp.json`,\n\t\t\tremoteAuthority: this._remoteAgentService.getConnection()?.remoteAuthority || null,\n\t\t\tscope: StorageScope.WORKSPACE,\n\t\t\ttrustBehavior: McpServerTrust.Kind.TrustedOnNonce,\n\t\t\tserverDefinitions: observableValue(this, []),\n\t\t\tconfigTarget: ConfigurationTarget.WORKSPACE_FOLDER,\n\t\t\tpresentation: {\n\t\t\t\torigin: configFile,\n\t\t\t\torder: McpCollectionSortOrder.WorkspaceFolder + 1,\n\t\t\t},\n\t\t};\n\n\t\tthis._collections.set(folder.uri.toString(), this.watchFile(\n\t\t\tURI.joinPath(folder.uri, '.cursor', 'mcp.json'),\n\t\t\tcollection,\n\t\t\tDiscoverySource.CursorWorkspace,\n\t\t\tasync contents => {\n\t\t\t\tconst defs = await claudeConfigToServerDefinition(collection.id, contents, folder.uri);\n\t\t\t\tdefs?.forEach(d => d.roots = [folder.uri]);\n\t\t\t\treturn defs;\n\t\t\t}\n\t\t));\n\t}\n}\n"]}