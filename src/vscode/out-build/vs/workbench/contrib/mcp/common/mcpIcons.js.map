{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/mcp/common/mcpIcons.ts","vs/workbench/contrib/mcp/common/mcpIcons.ts"],"names":[],"mappings":"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","file":"mcpIcons.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getMediaMime } from '../../../../base/common/mime.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ILogger } from '../../../../platform/log/common/log.js';\nimport { Dto } from '../../../services/extensions/common/proxyIdentifier.js';\nimport { IMcpIcons, McpServerLaunch, McpServerTransportType } from './mcpTypes.js';\nimport { MCP } from './modelContextProtocol.js';\n\nconst mcpAllowableContentTypes: readonly string[] = [\n\t'image/webp',\n\t'image/png',\n\t'image/jpeg',\n\t'image/jpg',\n\t'image/gif'\n];\n\nconst enum IconTheme {\n\tLight,\n\tDark,\n\tAny,\n}\n\ninterface IIcon {\n\t/** URI the image can be loaded from */\n\tsrc: URI;\n\t/** Theme for this icon. */\n\ttheme: IconTheme;\n\t/** Sizes of the icon in ascending order. */\n\tsizes: { width: number; height: number }[];\n}\n\nexport type ParsedMcpIcons = IIcon[];\nexport type StoredMcpIcons = Dto<IIcon>[];\n\n\nfunction validateIcon(icon: MCP.Icon, launch: McpServerLaunch, logger: ILogger): URI | undefined {\n\tconst mimeType = icon.mimeType?.toLowerCase() || getMediaMime(icon.src);\n\tif (!mimeType || !mcpAllowableContentTypes.includes(mimeType)) {\n\t\tlogger.debug(`Ignoring icon with unsupported mime type: ${icon.src} (${mimeType}), allowed: ${mcpAllowableContentTypes.join(', ')}`);\n\t\treturn;\n\t}\n\n\tconst uri = URI.parse(icon.src);\n\tif (uri.scheme === 'data') {\n\t\treturn uri;\n\t}\n\n\tif (uri.scheme === 'https' || uri.scheme === 'http') {\n\t\tif (launch.type !== McpServerTransportType.HTTP) {\n\t\t\tlogger.debug(`Ignoring icon with HTTP/HTTPS URL: ${icon.src} as the MCP server is not launched with HTTP transport.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst expectedAuthority = launch.uri.authority.toLowerCase();\n\t\tif (uri.authority.toLowerCase() !== expectedAuthority) {\n\t\t\tlogger.debug(`Ignoring icon with untrusted authority: ${icon.src}, expected authority: ${expectedAuthority}`);\n\t\t\treturn;\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tif (uri.scheme === 'file') {\n\t\tif (launch.type !== McpServerTransportType.Stdio) {\n\t\t\tlogger.debug(`Ignoring icon with file URL: ${icon.src} as the MCP server is not launched as a local process.`);\n\t\t\treturn;\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tlogger.debug(`Ignoring icon with unsupported scheme: ${icon.src}. Allowed: data:, http:, https:, file:`);\n\treturn;\n}\n\nexport function parseAndValidateMcpIcon(icons: MCP.Icons, launch: McpServerLaunch, logger: ILogger): ParsedMcpIcons {\n\tconst result: ParsedMcpIcons = [];\n\tfor (const icon of icons.icons || []) {\n\t\tconst uri = validateIcon(icon, launch, logger);\n\t\tif (!uri) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst sizesArr = typeof icon.sizes === 'string' ? icon.sizes.split(' ') : Array.isArray(icon.sizes) ? icon.sizes : [];\n\t\tresult.push({\n\t\t\tsrc: uri,\n\t\t\ttheme: icon.theme === 'light' ? IconTheme.Light : icon.theme === 'dark' ? IconTheme.Dark : IconTheme.Any,\n\t\t\tsizes: sizesArr.map(size => {\n\t\t\t\tconst [widthStr, heightStr] = size.toLowerCase().split('x');\n\t\t\t\treturn { width: Number(widthStr) || 0, height: Number(heightStr) || 0 };\n\t\t\t}).sort((a, b) => a.width - b.width)\n\t\t});\n\t}\n\n\tresult.sort((a, b) => a.sizes[0]?.width - b.sizes[0]?.width);\n\n\treturn result;\n}\n\nexport class McpIcons implements IMcpIcons {\n\tpublic static fromStored(icons: StoredMcpIcons | undefined) {\n\t\treturn McpIcons.fromParsed(icons?.map(i => ({ src: URI.revive(i.src), theme: i.theme, sizes: i.sizes })));\n\t}\n\n\tpublic static fromParsed(icons: ParsedMcpIcons | undefined) {\n\t\treturn new McpIcons(icons || []);\n\t}\n\n\tprotected constructor(private readonly _icons: IIcon[]) { }\n\n\tgetUrl(size: number): { dark: URI; light?: URI } | undefined {\n\t\tconst dark = this.getSizeWithTheme(size, IconTheme.Dark);\n\t\tif (dark?.theme === IconTheme.Any) {\n\t\t\treturn { dark: dark.src };\n\t\t}\n\n\t\tconst light = this.getSizeWithTheme(size, IconTheme.Light);\n\t\tif (!light && !dark) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn { dark: (dark || light)!.src, light: light?.src };\n\t}\n\n\tprivate getSizeWithTheme(size: number, theme: IconTheme): IIcon | undefined {\n\t\tlet bestOfAnySize: IIcon | undefined;\n\n\t\tfor (const icon of this._icons) {\n\t\t\tif (icon.theme === theme || icon.theme === IconTheme.Any || icon.theme === undefined) { // undefined check for back compat\n\t\t\t\tbestOfAnySize = icon;\n\n\t\t\t\tconst matchingSize = icon.sizes.find(s => s.width >= size);\n\t\t\t\tif (matchingSize) {\n\t\t\t\t\treturn { ...icon, sizes: [matchingSize] };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn bestOfAnySize;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getMediaMime } from '../../../../base/common/mime.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ILogger } from '../../../../platform/log/common/log.js';\nimport { Dto } from '../../../services/extensions/common/proxyIdentifier.js';\nimport { IMcpIcons, McpServerLaunch, McpServerTransportType } from './mcpTypes.js';\nimport { MCP } from './modelContextProtocol.js';\n\nconst mcpAllowableContentTypes: readonly string[] = [\n\t'image/webp',\n\t'image/png',\n\t'image/jpeg',\n\t'image/jpg',\n\t'image/gif'\n];\n\nconst enum IconTheme {\n\tLight,\n\tDark,\n\tAny,\n}\n\ninterface IIcon {\n\t/** URI the image can be loaded from */\n\tsrc: URI;\n\t/** Theme for this icon. */\n\ttheme: IconTheme;\n\t/** Sizes of the icon in ascending order. */\n\tsizes: { width: number; height: number }[];\n}\n\nexport type ParsedMcpIcons = IIcon[];\nexport type StoredMcpIcons = Dto<IIcon>[];\n\n\nfunction validateIcon(icon: MCP.Icon, launch: McpServerLaunch, logger: ILogger): URI | undefined {\n\tconst mimeType = icon.mimeType?.toLowerCase() || getMediaMime(icon.src);\n\tif (!mimeType || !mcpAllowableContentTypes.includes(mimeType)) {\n\t\tlogger.debug(`Ignoring icon with unsupported mime type: ${icon.src} (${mimeType}), allowed: ${mcpAllowableContentTypes.join(', ')}`);\n\t\treturn;\n\t}\n\n\tconst uri = URI.parse(icon.src);\n\tif (uri.scheme === 'data') {\n\t\treturn uri;\n\t}\n\n\tif (uri.scheme === 'https' || uri.scheme === 'http') {\n\t\tif (launch.type !== McpServerTransportType.HTTP) {\n\t\t\tlogger.debug(`Ignoring icon with HTTP/HTTPS URL: ${icon.src} as the MCP server is not launched with HTTP transport.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst expectedAuthority = launch.uri.authority.toLowerCase();\n\t\tif (uri.authority.toLowerCase() !== expectedAuthority) {\n\t\t\tlogger.debug(`Ignoring icon with untrusted authority: ${icon.src}, expected authority: ${expectedAuthority}`);\n\t\t\treturn;\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tif (uri.scheme === 'file') {\n\t\tif (launch.type !== McpServerTransportType.Stdio) {\n\t\t\tlogger.debug(`Ignoring icon with file URL: ${icon.src} as the MCP server is not launched as a local process.`);\n\t\t\treturn;\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tlogger.debug(`Ignoring icon with unsupported scheme: ${icon.src}. Allowed: data:, http:, https:, file:`);\n\treturn;\n}\n\nexport function parseAndValidateMcpIcon(icons: MCP.Icons, launch: McpServerLaunch, logger: ILogger): ParsedMcpIcons {\n\tconst result: ParsedMcpIcons = [];\n\tfor (const icon of icons.icons || []) {\n\t\tconst uri = validateIcon(icon, launch, logger);\n\t\tif (!uri) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst sizesArr = typeof icon.sizes === 'string' ? icon.sizes.split(' ') : Array.isArray(icon.sizes) ? icon.sizes : [];\n\t\tresult.push({\n\t\t\tsrc: uri,\n\t\t\ttheme: icon.theme === 'light' ? IconTheme.Light : icon.theme === 'dark' ? IconTheme.Dark : IconTheme.Any,\n\t\t\tsizes: sizesArr.map(size => {\n\t\t\t\tconst [widthStr, heightStr] = size.toLowerCase().split('x');\n\t\t\t\treturn { width: Number(widthStr) || 0, height: Number(heightStr) || 0 };\n\t\t\t}).sort((a, b) => a.width - b.width)\n\t\t});\n\t}\n\n\tresult.sort((a, b) => a.sizes[0]?.width - b.sizes[0]?.width);\n\n\treturn result;\n}\n\nexport class McpIcons implements IMcpIcons {\n\tpublic static fromStored(icons: StoredMcpIcons | undefined) {\n\t\treturn McpIcons.fromParsed(icons?.map(i => ({ src: URI.revive(i.src), theme: i.theme, sizes: i.sizes })));\n\t}\n\n\tpublic static fromParsed(icons: ParsedMcpIcons | undefined) {\n\t\treturn new McpIcons(icons || []);\n\t}\n\n\tprotected constructor(private readonly _icons: IIcon[]) { }\n\n\tgetUrl(size: number): { dark: URI; light?: URI } | undefined {\n\t\tconst dark = this.getSizeWithTheme(size, IconTheme.Dark);\n\t\tif (dark?.theme === IconTheme.Any) {\n\t\t\treturn { dark: dark.src };\n\t\t}\n\n\t\tconst light = this.getSizeWithTheme(size, IconTheme.Light);\n\t\tif (!light && !dark) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn { dark: (dark || light)!.src, light: light?.src };\n\t}\n\n\tprivate getSizeWithTheme(size: number, theme: IconTheme): IIcon | undefined {\n\t\tlet bestOfAnySize: IIcon | undefined;\n\n\t\tfor (const icon of this._icons) {\n\t\t\tif (icon.theme === theme || icon.theme === IconTheme.Any || icon.theme === undefined) { // undefined check for back compat\n\t\t\t\tbestOfAnySize = icon;\n\n\t\t\t\tconst matchingSize = icon.sizes.find(s => s.width >= size);\n\t\t\t\tif (matchingSize) {\n\t\t\t\t\treturn { ...icon, sizes: [matchingSize] };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn bestOfAnySize;\n\t}\n}\n"]}