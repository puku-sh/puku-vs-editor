{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/contrib/editTelemetry/browser/helpers/vscodeObservableWorkspace.ts","vs/workbench/contrib/editTelemetry/browser/helpers/vscodeObservableWorkspace.ts"],"names":[],"mappings":"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","file":"vscodeObservableWorkspace.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { derived, IObservable, IObservableWithChange, mapObservableArrayCached, observableSignalFromEvent, observableValue, transaction } from '../../../../../base/common/observable.js';\nimport { isDefined } from '../../../../../base/common/types.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { StringText } from '../../../../../editor/common/core/text/abstractText.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { offsetEditFromContentChanges } from '../../../../../editor/common/model/textModelStringEdit.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { IObservableDocument, ObservableWorkspace, StringEditWithReason } from './observableWorkspace.js';\n\nexport class VSCodeWorkspace extends ObservableWorkspace implements IDisposable {\n\tprivate readonly _documents;\n\tpublic get documents() { return this._documents; }\n\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IModelService private readonly _textModelService: IModelService,\n\t) {\n\t\tsuper();\n\n\t\tconst onModelAdded = observableSignalFromEvent(this, this._textModelService.onModelAdded);\n\t\tconst onModelRemoved = observableSignalFromEvent(this, this._textModelService.onModelRemoved);\n\n\t\tconst models = derived(this, reader => {\n\t\t\tonModelAdded.read(reader);\n\t\t\tonModelRemoved.read(reader);\n\t\t\tconst models = this._textModelService.getModels();\n\t\t\treturn models;\n\t\t});\n\n\t\tconst documents = mapObservableArrayCached(this, models, (m, store) => {\n\t\t\tif (m.isTooLargeForSyncing()) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn store.add(new VSCodeDocument(m));\n\t\t}).recomputeInitiallyAndOnChange(this._store).map(d => d.filter(isDefined));\n\n\t\tthis._documents = documents;\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n\nexport class VSCodeDocument extends Disposable implements IObservableDocument {\n\tget uri(): URI { return this.textModel.uri; }\n\tprivate readonly _value;\n\tprivate readonly _version;\n\tprivate readonly _languageId;\n\tget value(): IObservableWithChange<StringText, StringEditWithReason> { return this._value; }\n\tget version(): IObservable<number> { return this._version; }\n\tget languageId(): IObservable<string> { return this._languageId; }\n\n\tconstructor(\n\t\tpublic readonly textModel: ITextModel,\n\t) {\n\t\tsuper();\n\n\t\tthis._value = observableValue<StringText, StringEditWithReason>(this, new StringText(this.textModel.getValue()));\n\t\tthis._version = observableValue(this, this.textModel.getVersionId());\n\t\tthis._languageId = observableValue(this, this.textModel.getLanguageId());\n\n\t\tthis._register(this.textModel.onDidChangeContent((e) => {\n\t\t\ttransaction(tx => {\n\t\t\t\tconst edit = offsetEditFromContentChanges(e.changes);\n\t\t\t\tif (e.detailedReasons.length !== 1) {\n\t\t\t\t\tonUnexpectedError(new Error(`Unexpected number of detailed reasons: ${e.detailedReasons.length}`));\n\t\t\t\t}\n\n\t\t\t\tconst change = new StringEditWithReason(edit.replacements, e.detailedReasons[0]);\n\n\t\t\t\tthis._value.set(new StringText(this.textModel.getValue()), tx, change);\n\t\t\t\tthis._version.set(this.textModel.getVersionId(), tx);\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(this.textModel.onDidChangeLanguage(e => {\n\t\t\ttransaction(tx => {\n\t\t\t\tthis._languageId.set(this.textModel.getLanguageId(), tx);\n\t\t\t});\n\t\t}));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { derived, IObservable, IObservableWithChange, mapObservableArrayCached, observableSignalFromEvent, observableValue, transaction } from '../../../../../base/common/observable.js';\nimport { isDefined } from '../../../../../base/common/types.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { StringText } from '../../../../../editor/common/core/text/abstractText.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { offsetEditFromContentChanges } from '../../../../../editor/common/model/textModelStringEdit.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { IObservableDocument, ObservableWorkspace, StringEditWithReason } from './observableWorkspace.js';\n\nexport class VSCodeWorkspace extends ObservableWorkspace implements IDisposable {\n\tprivate readonly _documents;\n\tpublic get documents() { return this._documents; }\n\n\tprivate readonly _store = new DisposableStore();\n\n\tconstructor(\n\t\t@IModelService private readonly _textModelService: IModelService,\n\t) {\n\t\tsuper();\n\n\t\tconst onModelAdded = observableSignalFromEvent(this, this._textModelService.onModelAdded);\n\t\tconst onModelRemoved = observableSignalFromEvent(this, this._textModelService.onModelRemoved);\n\n\t\tconst models = derived(this, reader => {\n\t\t\tonModelAdded.read(reader);\n\t\t\tonModelRemoved.read(reader);\n\t\t\tconst models = this._textModelService.getModels();\n\t\t\treturn models;\n\t\t});\n\n\t\tconst documents = mapObservableArrayCached(this, models, (m, store) => {\n\t\t\tif (m.isTooLargeForSyncing()) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn store.add(new VSCodeDocument(m));\n\t\t}).recomputeInitiallyAndOnChange(this._store).map(d => d.filter(isDefined));\n\n\t\tthis._documents = documents;\n\t}\n\n\tdispose(): void {\n\t\tthis._store.dispose();\n\t}\n}\n\nexport class VSCodeDocument extends Disposable implements IObservableDocument {\n\tget uri(): URI { return this.textModel.uri; }\n\tprivate readonly _value;\n\tprivate readonly _version;\n\tprivate readonly _languageId;\n\tget value(): IObservableWithChange<StringText, StringEditWithReason> { return this._value; }\n\tget version(): IObservable<number> { return this._version; }\n\tget languageId(): IObservable<string> { return this._languageId; }\n\n\tconstructor(\n\t\tpublic readonly textModel: ITextModel,\n\t) {\n\t\tsuper();\n\n\t\tthis._value = observableValue<StringText, StringEditWithReason>(this, new StringText(this.textModel.getValue()));\n\t\tthis._version = observableValue(this, this.textModel.getVersionId());\n\t\tthis._languageId = observableValue(this, this.textModel.getLanguageId());\n\n\t\tthis._register(this.textModel.onDidChangeContent((e) => {\n\t\t\ttransaction(tx => {\n\t\t\t\tconst edit = offsetEditFromContentChanges(e.changes);\n\t\t\t\tif (e.detailedReasons.length !== 1) {\n\t\t\t\t\tonUnexpectedError(new Error(`Unexpected number of detailed reasons: ${e.detailedReasons.length}`));\n\t\t\t\t}\n\n\t\t\t\tconst change = new StringEditWithReason(edit.replacements, e.detailedReasons[0]);\n\n\t\t\t\tthis._value.set(new StringText(this.textModel.getValue()), tx, change);\n\t\t\t\tthis._version.set(this.textModel.getVersionId(), tx);\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(this.textModel.onDidChangeLanguage(e => {\n\t\t\ttransaction(tx => {\n\t\t\t\tthis._languageId.set(this.textModel.getLanguageId(), tx);\n\t\t\t});\n\t\t}));\n\t}\n}\n"]}