{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/test/browser/parts/editor/editorModel.test.ts","vs/workbench/test/browser/parts/editor/editorModel.test.ts"],"names":[],"mappings":"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","file":"editorModel.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { BaseTextEditorModel } from '../../../../common/editor/textEditorModel.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { LanguageService } from '../../../../../editor/common/services/languageService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ModelService } from '../../../../../editor/common/services/modelService.js';\nimport { ITextBufferFactory } from '../../../../../editor/common/model.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { createTextBufferFactory } from '../../../../../editor/common/model/textModel.js';\nimport { ITextResourcePropertiesService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../../platform/undoRedo/common/undoRedoService.js';\nimport { TestDialogService } from '../../../../../platform/dialogs/test/common/testDialogService.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { TestNotificationService } from '../../../../../platform/notification/test/common/testNotificationService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { TestStorageService, TestTextResourcePropertiesService } from '../../../common/workbenchTestServices.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { TestThemeService } from '../../../../../platform/theme/test/common/testThemeService.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { LanguageDetectionService } from '../../../../services/languageDetection/browser/languageDetectionWorkerServiceImpl.js';\nimport { IWorkbenchEnvironmentService } from '../../../../services/environment/common/environmentService.js';\nimport { TestEditorService, TestEnvironmentService } from '../../workbenchTestServices.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { TestAccessibilityService } from '../../../../../platform/accessibility/test/common/testAccessibilityService.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ITreeSitterLibraryService } from '../../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { TestTreeSitterLibraryService } from '../../../../../editor/test/common/services/testTreeSitterLibraryService.js';\n\nsuite('EditorModel', () => {\n\n\tclass MyEditorModel extends EditorModel { }\n\tclass MyTextEditorModel extends BaseTextEditorModel {\n\t\ttestCreateTextEditorModel(value: ITextBufferFactory, resource?: URI, preferredLanguageId?: string) {\n\t\t\treturn super.createTextEditorModel(value, resource, preferredLanguageId);\n\t\t}\n\n\t\toverride isReadonly(): boolean {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction stubModelService(instantiationService: TestInstantiationService): IModelService {\n\t\tconst dialogService = new TestDialogService();\n\t\tconst notificationService = new TestNotificationService();\n\t\tconst undoRedoService = new UndoRedoService(dialogService, notificationService);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, TestEnvironmentService);\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(ITextResourcePropertiesService, new TestTextResourcePropertiesService(instantiationService.get(IConfigurationService)));\n\t\tinstantiationService.stub(IDialogService, dialogService);\n\t\tinstantiationService.stub(INotificationService, notificationService);\n\t\tinstantiationService.stub(IUndoRedoService, undoRedoService);\n\t\tinstantiationService.stub(IEditorService, disposables.add(new TestEditorService()));\n\t\tinstantiationService.stub(IThemeService, new TestThemeService());\n\t\tinstantiationService.stub(ILanguageConfigurationService, disposables.add(new TestLanguageConfigurationService()));\n\t\tinstantiationService.stub(IStorageService, disposables.add(new TestStorageService()));\n\t\tinstantiationService.stub(ITreeSitterLibraryService, new TestTreeSitterLibraryService());\n\n\t\treturn disposables.add(instantiationService.createInstance(ModelService));\n\t}\n\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tconst disposables = new DisposableStore();\n\n\tsetup(() => {\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\t\tlanguageService = instantiationService.stub(ILanguageService, LanguageService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('basics', async () => {\n\t\tlet counter = 0;\n\n\t\tconst model = disposables.add(new MyEditorModel());\n\n\t\tdisposables.add(model.onWillDispose(() => {\n\t\t\tassert(true);\n\t\t\tcounter++;\n\t\t}));\n\n\t\tawait model.resolve();\n\t\tassert.strictEqual(model.isDisposed(), false);\n\t\tassert.strictEqual(model.isResolved(), true);\n\t\tmodel.dispose();\n\t\tassert.strictEqual(counter, 1);\n\t\tassert.strictEqual(model.isDisposed(), true);\n\t});\n\n\ttest('BaseTextEditorModel', async () => {\n\t\tconst modelService = stubModelService(instantiationService);\n\n\t\tconst model = disposables.add(new MyTextEditorModel(modelService, languageService, disposables.add(instantiationService.createInstance(LanguageDetectionService)), instantiationService.createInstance(TestAccessibilityService)));\n\t\tawait model.resolve();\n\n\t\tdisposables.add(model.testCreateTextEditorModel(createTextBufferFactory('foo'), null!, Mimes.text));\n\t\tassert.strictEqual(model.isResolved(), true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { BaseTextEditorModel } from '../../../../common/editor/textEditorModel.js';\nimport { IModelService } from '../../../../../editor/common/services/model.js';\nimport { ILanguageService } from '../../../../../editor/common/languages/language.js';\nimport { LanguageService } from '../../../../../editor/common/services/languageService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { ModelService } from '../../../../../editor/common/services/modelService.js';\nimport { ITextBufferFactory } from '../../../../../editor/common/model.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { createTextBufferFactory } from '../../../../../editor/common/model/textModel.js';\nimport { ITextResourcePropertiesService } from '../../../../../editor/common/services/textResourceConfiguration.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { UndoRedoService } from '../../../../../platform/undoRedo/common/undoRedoService.js';\nimport { TestDialogService } from '../../../../../platform/dialogs/test/common/testDialogService.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { TestNotificationService } from '../../../../../platform/notification/test/common/testNotificationService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { TestStorageService, TestTextResourcePropertiesService } from '../../../common/workbenchTestServices.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { TestThemeService } from '../../../../../platform/theme/test/common/testThemeService.js';\nimport { EditorModel } from '../../../../common/editor/editorModel.js';\nimport { Mimes } from '../../../../../base/common/mime.js';\nimport { LanguageDetectionService } from '../../../../services/languageDetection/browser/languageDetectionWorkerServiceImpl.js';\nimport { IWorkbenchEnvironmentService } from '../../../../services/environment/common/environmentService.js';\nimport { TestEditorService, TestEnvironmentService } from '../../workbenchTestServices.js';\nimport { TestLanguageConfigurationService } from '../../../../../editor/test/common/modes/testLanguageConfigurationService.js';\nimport { ILanguageConfigurationService } from '../../../../../editor/common/languages/languageConfigurationRegistry.js';\nimport { TestAccessibilityService } from '../../../../../platform/accessibility/test/common/testAccessibilityService.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { ITreeSitterLibraryService } from '../../../../../editor/common/services/treeSitter/treeSitterLibraryService.js';\nimport { TestTreeSitterLibraryService } from '../../../../../editor/test/common/services/testTreeSitterLibraryService.js';\n\nsuite('EditorModel', () => {\n\n\tclass MyEditorModel extends EditorModel { }\n\tclass MyTextEditorModel extends BaseTextEditorModel {\n\t\ttestCreateTextEditorModel(value: ITextBufferFactory, resource?: URI, preferredLanguageId?: string) {\n\t\t\treturn super.createTextEditorModel(value, resource, preferredLanguageId);\n\t\t}\n\n\t\toverride isReadonly(): boolean {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction stubModelService(instantiationService: TestInstantiationService): IModelService {\n\t\tconst dialogService = new TestDialogService();\n\t\tconst notificationService = new TestNotificationService();\n\t\tconst undoRedoService = new UndoRedoService(dialogService, notificationService);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, TestEnvironmentService);\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(ITextResourcePropertiesService, new TestTextResourcePropertiesService(instantiationService.get(IConfigurationService)));\n\t\tinstantiationService.stub(IDialogService, dialogService);\n\t\tinstantiationService.stub(INotificationService, notificationService);\n\t\tinstantiationService.stub(IUndoRedoService, undoRedoService);\n\t\tinstantiationService.stub(IEditorService, disposables.add(new TestEditorService()));\n\t\tinstantiationService.stub(IThemeService, new TestThemeService());\n\t\tinstantiationService.stub(ILanguageConfigurationService, disposables.add(new TestLanguageConfigurationService()));\n\t\tinstantiationService.stub(IStorageService, disposables.add(new TestStorageService()));\n\t\tinstantiationService.stub(ITreeSitterLibraryService, new TestTreeSitterLibraryService());\n\n\t\treturn disposables.add(instantiationService.createInstance(ModelService));\n\t}\n\n\tlet instantiationService: TestInstantiationService;\n\tlet languageService: ILanguageService;\n\n\tconst disposables = new DisposableStore();\n\n\tsetup(() => {\n\t\tinstantiationService = disposables.add(new TestInstantiationService());\n\t\tlanguageService = instantiationService.stub(ILanguageService, LanguageService);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('basics', async () => {\n\t\tlet counter = 0;\n\n\t\tconst model = disposables.add(new MyEditorModel());\n\n\t\tdisposables.add(model.onWillDispose(() => {\n\t\t\tassert(true);\n\t\t\tcounter++;\n\t\t}));\n\n\t\tawait model.resolve();\n\t\tassert.strictEqual(model.isDisposed(), false);\n\t\tassert.strictEqual(model.isResolved(), true);\n\t\tmodel.dispose();\n\t\tassert.strictEqual(counter, 1);\n\t\tassert.strictEqual(model.isDisposed(), true);\n\t});\n\n\ttest('BaseTextEditorModel', async () => {\n\t\tconst modelService = stubModelService(instantiationService);\n\n\t\tconst model = disposables.add(new MyTextEditorModel(modelService, languageService, disposables.add(instantiationService.createInstance(LanguageDetectionService)), instantiationService.createInstance(TestAccessibilityService)));\n\t\tawait model.resolve();\n\n\t\tdisposables.add(model.testCreateTextEditorModel(createTextBufferFactory('foo'), null!, Mimes.text));\n\t\tassert.strictEqual(model.isResolved(), true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}