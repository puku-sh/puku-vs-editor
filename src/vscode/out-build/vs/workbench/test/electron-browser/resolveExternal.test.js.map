{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/test/electron-browser/resolveExternal.test.ts","vs/workbench/test/electron-browser/resolveExternal.test.ts"],"names":[],"mappings":"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","file":"resolveExternal.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../base/test/common/utils.js';\nimport { NativeWindow } from '../../electron-browser/window.js';\nimport { ITunnelService, RemoteTunnel } from '../../../platform/tunnel/common/tunnel.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { TestInstantiationService } from '../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IAddressProvider } from '../../../platform/remote/common/remoteAgentConnection.js';\nimport { workbenchInstantiationService } from './workbenchTestServices.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\n\ntype PortMap = Record<number, number>;\n\nclass TunnelMock implements Partial<ITunnelService> {\n\tprivate assignedPorts: PortMap = {};\n\tprivate expectedDispose = false;\n\n\treset(ports: PortMap) {\n\t\tthis.assignedPorts = ports;\n\t}\n\n\texpectDispose() {\n\t\tthis.expectedDispose = true;\n\t}\n\n\tgetExistingTunnel(): Promise<string | RemoteTunnel | undefined> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\topenTunnel(_addressProvider: IAddressProvider | undefined, _host: string | undefined, port: number): Promise<RemoteTunnel | string | undefined> | undefined {\n\t\tif (!this.assignedPorts[port]) {\n\t\t\treturn Promise.reject(new Error('Unexpected tunnel request'));\n\t\t}\n\t\tconst res: RemoteTunnel = {\n\t\t\tlocalAddress: `localhost:${this.assignedPorts[port]}`,\n\t\t\ttunnelRemoteHost: '4.3.2.1',\n\t\t\ttunnelRemotePort: this.assignedPorts[port],\n\t\t\tprivacy: '',\n\t\t\tdispose: () => {\n\t\t\t\tassert(this.expectedDispose, 'Unexpected dispose');\n\t\t\t\tthis.expectedDispose = false;\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t};\n\t\tdelete this.assignedPorts[port];\n\t\treturn Promise.resolve(res);\n\t}\n\n\tvalidate() {\n\t\ttry {\n\t\t\tassert(Object.keys(this.assignedPorts).length === 0, 'Expected tunnel to be used');\n\t\t\tassert(!this.expectedDispose, 'Expected dispose to be called');\n\t\t} finally {\n\t\t\tthis.expectedDispose = false;\n\t\t}\n\t}\n}\n\nclass TestNativeWindow extends NativeWindow {\n\tprotected override create(): void { }\n\tprotected override registerListeners(): void { }\n\tprotected override enableMultiWindowAwareTimeout(): void { }\n}\n\nsuite.skip('NativeWindow:resolveExternal', () => {\n\tconst disposables = new DisposableStore();\n\tconst tunnelMock = new TunnelMock();\n\tlet window: TestNativeWindow;\n\n\tsetup(() => {\n\t\tconst instantiationService: TestInstantiationService = <TestInstantiationService>workbenchInstantiationService(undefined, disposables);\n\t\tinstantiationService.stub(ITunnelService, tunnelMock);\n\t\twindow = disposables.add(instantiationService.createInstance(TestNativeWindow));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tasync function doTest(uri: string, ports: PortMap = {}, expectedUri?: string) {\n\t\ttunnelMock.reset(ports);\n\t\tconst res = await window.resolveExternalUri(URI.parse(uri), {\n\t\t\tallowTunneling: true,\n\t\t\topenExternal: true\n\t\t});\n\t\tassert.strictEqual(!expectedUri, !res, `Expected URI ${expectedUri} but got ${res}`);\n\t\tif (expectedUri && res) {\n\t\t\tassert.strictEqual(res.resolved.toString(), URI.parse(expectedUri).toString());\n\t\t}\n\t\ttunnelMock.validate();\n\t}\n\n\ttest('invalid', async () => {\n\t\tawait doTest('file:///foo.bar/baz');\n\t\tawait doTest('http://foo.bar/path');\n\t});\n\ttest('simple', async () => {\n\t\tawait doTest('http://localhost:1234/path', { 1234: 1234 }, 'http://localhost:1234/path');\n\t});\n\ttest('all interfaces', async () => {\n\t\tawait doTest('http://0.0.0.0:1234/path', { 1234: 1234 }, 'http://localhost:1234/path');\n\t});\n\ttest('changed port', async () => {\n\t\tawait doTest('http://localhost:1234/path', { 1234: 1235 }, 'http://localhost:1235/path');\n\t});\n\ttest('query', async () => {\n\t\tawait doTest('http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455', { 4455: 4455 }, 'http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\ttest('query with different port', async () => {\n\t\ttunnelMock.expectDispose();\n\t\tawait doTest('http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455', { 4455: 4567 });\n\t});\n\ttest('both url and query', async () => {\n\t\tawait doTest('http://localhost:1234/path?a=b&c=http%3a%2f%2flocalhost%3a4455',\n\t\t\t{ 1234: 4321, 4455: 4455 },\n\t\t\t'http://localhost:4321/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\ttest('both url and query, query rejected', async () => {\n\t\ttunnelMock.expectDispose();\n\t\tawait doTest('http://localhost:1234/path?a=b&c=http%3a%2f%2flocalhost%3a4455',\n\t\t\t{ 1234: 4321, 4455: 5544 },\n\t\t\t'http://localhost:4321/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../base/test/common/utils.js';\nimport { NativeWindow } from '../../electron-browser/window.js';\nimport { ITunnelService, RemoteTunnel } from '../../../platform/tunnel/common/tunnel.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { TestInstantiationService } from '../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IAddressProvider } from '../../../platform/remote/common/remoteAgentConnection.js';\nimport { workbenchInstantiationService } from './workbenchTestServices.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\n\ntype PortMap = Record<number, number>;\n\nclass TunnelMock implements Partial<ITunnelService> {\n\tprivate assignedPorts: PortMap = {};\n\tprivate expectedDispose = false;\n\n\treset(ports: PortMap) {\n\t\tthis.assignedPorts = ports;\n\t}\n\n\texpectDispose() {\n\t\tthis.expectedDispose = true;\n\t}\n\n\tgetExistingTunnel(): Promise<string | RemoteTunnel | undefined> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\topenTunnel(_addressProvider: IAddressProvider | undefined, _host: string | undefined, port: number): Promise<RemoteTunnel | string | undefined> | undefined {\n\t\tif (!this.assignedPorts[port]) {\n\t\t\treturn Promise.reject(new Error('Unexpected tunnel request'));\n\t\t}\n\t\tconst res: RemoteTunnel = {\n\t\t\tlocalAddress: `localhost:${this.assignedPorts[port]}`,\n\t\t\ttunnelRemoteHost: '4.3.2.1',\n\t\t\ttunnelRemotePort: this.assignedPorts[port],\n\t\t\tprivacy: '',\n\t\t\tdispose: () => {\n\t\t\t\tassert(this.expectedDispose, 'Unexpected dispose');\n\t\t\t\tthis.expectedDispose = false;\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t};\n\t\tdelete this.assignedPorts[port];\n\t\treturn Promise.resolve(res);\n\t}\n\n\tvalidate() {\n\t\ttry {\n\t\t\tassert(Object.keys(this.assignedPorts).length === 0, 'Expected tunnel to be used');\n\t\t\tassert(!this.expectedDispose, 'Expected dispose to be called');\n\t\t} finally {\n\t\t\tthis.expectedDispose = false;\n\t\t}\n\t}\n}\n\nclass TestNativeWindow extends NativeWindow {\n\tprotected override create(): void { }\n\tprotected override registerListeners(): void { }\n\tprotected override enableMultiWindowAwareTimeout(): void { }\n}\n\nsuite.skip('NativeWindow:resolveExternal', () => {\n\tconst disposables = new DisposableStore();\n\tconst tunnelMock = new TunnelMock();\n\tlet window: TestNativeWindow;\n\n\tsetup(() => {\n\t\tconst instantiationService: TestInstantiationService = <TestInstantiationService>workbenchInstantiationService(undefined, disposables);\n\t\tinstantiationService.stub(ITunnelService, tunnelMock);\n\t\twindow = disposables.add(instantiationService.createInstance(TestNativeWindow));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tasync function doTest(uri: string, ports: PortMap = {}, expectedUri?: string) {\n\t\ttunnelMock.reset(ports);\n\t\tconst res = await window.resolveExternalUri(URI.parse(uri), {\n\t\t\tallowTunneling: true,\n\t\t\topenExternal: true\n\t\t});\n\t\tassert.strictEqual(!expectedUri, !res, `Expected URI ${expectedUri} but got ${res}`);\n\t\tif (expectedUri && res) {\n\t\t\tassert.strictEqual(res.resolved.toString(), URI.parse(expectedUri).toString());\n\t\t}\n\t\ttunnelMock.validate();\n\t}\n\n\ttest('invalid', async () => {\n\t\tawait doTest('file:///foo.bar/baz');\n\t\tawait doTest('http://foo.bar/path');\n\t});\n\ttest('simple', async () => {\n\t\tawait doTest('http://localhost:1234/path', { 1234: 1234 }, 'http://localhost:1234/path');\n\t});\n\ttest('all interfaces', async () => {\n\t\tawait doTest('http://0.0.0.0:1234/path', { 1234: 1234 }, 'http://localhost:1234/path');\n\t});\n\ttest('changed port', async () => {\n\t\tawait doTest('http://localhost:1234/path', { 1234: 1235 }, 'http://localhost:1235/path');\n\t});\n\ttest('query', async () => {\n\t\tawait doTest('http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455', { 4455: 4455 }, 'http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\ttest('query with different port', async () => {\n\t\ttunnelMock.expectDispose();\n\t\tawait doTest('http://foo.bar/path?a=b&c=http%3a%2f%2flocalhost%3a4455', { 4455: 4567 });\n\t});\n\ttest('both url and query', async () => {\n\t\tawait doTest('http://localhost:1234/path?a=b&c=http%3a%2f%2flocalhost%3a4455',\n\t\t\t{ 1234: 4321, 4455: 4455 },\n\t\t\t'http://localhost:4321/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\ttest('both url and query, query rejected', async () => {\n\t\ttunnelMock.expectDispose();\n\t\tawait doTest('http://localhost:1234/path?a=b&c=http%3a%2f%2flocalhost%3a4455',\n\t\t\t{ 1234: 4321, 4455: 5544 },\n\t\t\t'http://localhost:4321/path?a=b&c=http%3a%2f%2flocalhost%3a4455');\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}