{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/common/editor/textResourceEditorInput.ts","vs/workbench/common/editor/textResourceEditorInput.ts"],"names":[],"mappings":"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","file":"textResourceEditorInput.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DEFAULT_EDITOR_ASSOCIATION, GroupIdentifier, IRevertOptions, isResourceEditorInput, IUntypedEditorInput } from '../editor.js';\nimport { EditorInput } from './editorInput.js';\nimport { AbstractResourceEditorInput } from './resourceEditorInput.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ITextFileService, ITextFileSaveOptions, ILanguageSupport } from '../../services/textfile/common/textfiles.js';\nimport { IEditorService } from '../../services/editor/common/editorService.js';\nimport { IFileService } from '../../../platform/files/common/files.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { isEqual } from '../../../base/common/resources.js';\nimport { ITextEditorModel, ITextModelService } from '../../../editor/common/services/resolverService.js';\nimport { TextResourceEditorModel } from './textResourceEditorModel.js';\nimport { IReference } from '../../../base/common/lifecycle.js';\nimport { createTextBufferFactory } from '../../../editor/common/model/textModel.js';\nimport { IFilesConfigurationService } from '../../services/filesConfiguration/common/filesConfigurationService.js';\nimport { ITextResourceConfigurationService } from '../../../editor/common/services/textResourceConfiguration.js';\nimport { ICustomEditorLabelService } from '../../services/editor/common/customEditorLabelService.js';\n\n/**\n * The base class for all editor inputs that open in text editors.\n */\nexport abstract class AbstractTextResourceEditorInput extends AbstractResourceEditorInput {\n\n\tconstructor(\n\t\tresource: URI,\n\t\tpreferredResource: URI | undefined,\n\t\t@IEditorService protected readonly editorService: IEditorService,\n\t\t@ITextFileService protected readonly textFileService: ITextFileService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@ICustomEditorLabelService customEditorLabelService: ICustomEditorLabelService\n\t) {\n\t\tsuper(resource, preferredResource, labelService, fileService, filesConfigurationService, textResourceConfigurationService, customEditorLabelService);\n\t}\n\n\toverride save(group: GroupIdentifier, options?: ITextFileSaveOptions): Promise<IUntypedEditorInput | undefined> {\n\n\t\t// If this is neither an `untitled` resource, nor a resource\n\t\t// we can handle with the file service, we can only \"Save As...\"\n\t\tif (this.resource.scheme !== Schemas.untitled && !this.fileService.hasProvider(this.resource)) {\n\t\t\treturn this.saveAs(group, options);\n\t\t}\n\n\t\t// Normal save\n\t\treturn this.doSave(options, false, group);\n\t}\n\n\toverride saveAs(group: GroupIdentifier, options?: ITextFileSaveOptions): Promise<IUntypedEditorInput | undefined> {\n\t\treturn this.doSave(options, true, group);\n\t}\n\n\tprivate async doSave(options: ITextFileSaveOptions | undefined, saveAs: boolean, group: GroupIdentifier | undefined): Promise<IUntypedEditorInput | undefined> {\n\n\t\t// Save / Save As\n\t\tlet target: URI | undefined;\n\t\tif (saveAs) {\n\t\t\ttarget = await this.textFileService.saveAs(this.resource, undefined, { ...options, suggestedTarget: this.preferredResource });\n\t\t} else {\n\t\t\ttarget = await this.textFileService.save(this.resource, options);\n\t\t}\n\n\t\tif (!target) {\n\t\t\treturn undefined; // save cancelled\n\t\t}\n\n\t\treturn { resource: target };\n\t}\n\n\toverride async revert(group: GroupIdentifier, options?: IRevertOptions): Promise<void> {\n\t\tawait this.textFileService.revert(this.resource, options);\n\t}\n}\n\n/**\n * A read-only text editor input whos contents are made of the provided resource that points to an existing\n * code editor model.\n */\nexport class TextResourceEditorInput extends AbstractTextResourceEditorInput implements ILanguageSupport {\n\n\tstatic readonly ID: string = 'workbench.editors.resourceEditorInput';\n\n\toverride get typeId(): string {\n\t\treturn TextResourceEditorInput.ID;\n\t}\n\n\toverride get editorId(): string | undefined {\n\t\treturn DEFAULT_EDITOR_ASSOCIATION.id;\n\t}\n\n\tprivate cachedModel: TextResourceEditorModel | undefined = undefined;\n\tprivate modelReference: Promise<IReference<ITextEditorModel>> | undefined = undefined;\n\n\tconstructor(\n\t\tresource: URI,\n\t\tprivate name: string | undefined,\n\t\tprivate description: string | undefined,\n\t\tprivate preferredLanguageId: string | undefined,\n\t\tprivate preferredContents: string | undefined,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t\t@ITextFileService textFileService: ITextFileService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IFileService fileService: IFileService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@ICustomEditorLabelService customEditorLabelService: ICustomEditorLabelService\n\t) {\n\t\tsuper(resource, undefined, editorService, textFileService, labelService, fileService, filesConfigurationService, textResourceConfigurationService, customEditorLabelService);\n\t}\n\n\toverride getName(): string {\n\t\treturn this.name || super.getName();\n\t}\n\n\tsetName(name: string): void {\n\t\tif (this.name !== name) {\n\t\t\tthis.name = name;\n\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}\n\t}\n\n\toverride getDescription(): string | undefined {\n\t\treturn this.description;\n\t}\n\n\tsetDescription(description: string): void {\n\t\tif (this.description !== description) {\n\t\t\tthis.description = description;\n\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}\n\t}\n\n\tsetLanguageId(languageId: string, source?: string): void {\n\t\tthis.setPreferredLanguageId(languageId);\n\n\t\tthis.cachedModel?.setLanguageId(languageId, source);\n\t}\n\n\tsetPreferredLanguageId(languageId: string): void {\n\t\tthis.preferredLanguageId = languageId;\n\t}\n\n\tsetPreferredContents(contents: string): void {\n\t\tthis.preferredContents = contents;\n\t}\n\n\toverride async resolve(): Promise<ITextEditorModel> {\n\n\t\t// Unset preferred contents and language after resolving\n\t\t// once to prevent these properties to stick. We still\n\t\t// want the user to change the language in the editor\n\t\t// and want to show updated contents (if any) in future\n\t\t// `resolve` calls.\n\t\tconst preferredContents = this.preferredContents;\n\t\tconst preferredLanguageId = this.preferredLanguageId;\n\t\tthis.preferredContents = undefined;\n\t\tthis.preferredLanguageId = undefined;\n\n\t\tif (!this.modelReference) {\n\t\t\tthis.modelReference = this.textModelService.createModelReference(this.resource);\n\t\t}\n\n\t\tconst ref = await this.modelReference;\n\n\t\t// Ensure the resolved model is of expected type\n\t\tconst model = ref.object;\n\t\tif (!(model instanceof TextResourceEditorModel)) {\n\t\t\tref.dispose();\n\t\t\tthis.modelReference = undefined;\n\n\t\t\tthrow new Error(`Unexpected model for TextResourceEditorInput: ${this.resource}`);\n\t\t}\n\n\t\tthis.cachedModel = model;\n\n\t\t// Set contents and language if preferred\n\t\tif (typeof preferredContents === 'string' || typeof preferredLanguageId === 'string') {\n\t\t\tmodel.updateTextEditorModel(typeof preferredContents === 'string' ? createTextBufferFactory(preferredContents) : undefined, preferredLanguageId);\n\t\t}\n\n\t\treturn model;\n\t}\n\n\toverride matches(otherInput: EditorInput | IUntypedEditorInput): boolean {\n\t\tif (this === otherInput) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (otherInput instanceof TextResourceEditorInput) {\n\t\t\treturn isEqual(otherInput.resource, this.resource);\n\t\t}\n\n\t\tif (isResourceEditorInput(otherInput)) {\n\t\t\treturn super.matches(otherInput);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\toverride dispose(): void {\n\t\tif (this.modelReference) {\n\t\t\tthis.modelReference.then(ref => ref.dispose());\n\t\t\tthis.modelReference = undefined;\n\t\t}\n\n\t\tthis.cachedModel = undefined;\n\n\t\tsuper.dispose();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DEFAULT_EDITOR_ASSOCIATION, GroupIdentifier, IRevertOptions, isResourceEditorInput, IUntypedEditorInput } from '../editor.js';\nimport { EditorInput } from './editorInput.js';\nimport { AbstractResourceEditorInput } from './resourceEditorInput.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ITextFileService, ITextFileSaveOptions, ILanguageSupport } from '../../services/textfile/common/textfiles.js';\nimport { IEditorService } from '../../services/editor/common/editorService.js';\nimport { IFileService } from '../../../platform/files/common/files.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { isEqual } from '../../../base/common/resources.js';\nimport { ITextEditorModel, ITextModelService } from '../../../editor/common/services/resolverService.js';\nimport { TextResourceEditorModel } from './textResourceEditorModel.js';\nimport { IReference } from '../../../base/common/lifecycle.js';\nimport { createTextBufferFactory } from '../../../editor/common/model/textModel.js';\nimport { IFilesConfigurationService } from '../../services/filesConfiguration/common/filesConfigurationService.js';\nimport { ITextResourceConfigurationService } from '../../../editor/common/services/textResourceConfiguration.js';\nimport { ICustomEditorLabelService } from '../../services/editor/common/customEditorLabelService.js';\n\n/**\n * The base class for all editor inputs that open in text editors.\n */\nexport abstract class AbstractTextResourceEditorInput extends AbstractResourceEditorInput {\n\n\tconstructor(\n\t\tresource: URI,\n\t\tpreferredResource: URI | undefined,\n\t\t@IEditorService protected readonly editorService: IEditorService,\n\t\t@ITextFileService protected readonly textFileService: ITextFileService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@ICustomEditorLabelService customEditorLabelService: ICustomEditorLabelService\n\t) {\n\t\tsuper(resource, preferredResource, labelService, fileService, filesConfigurationService, textResourceConfigurationService, customEditorLabelService);\n\t}\n\n\toverride save(group: GroupIdentifier, options?: ITextFileSaveOptions): Promise<IUntypedEditorInput | undefined> {\n\n\t\t// If this is neither an `untitled` resource, nor a resource\n\t\t// we can handle with the file service, we can only \"Save As...\"\n\t\tif (this.resource.scheme !== Schemas.untitled && !this.fileService.hasProvider(this.resource)) {\n\t\t\treturn this.saveAs(group, options);\n\t\t}\n\n\t\t// Normal save\n\t\treturn this.doSave(options, false, group);\n\t}\n\n\toverride saveAs(group: GroupIdentifier, options?: ITextFileSaveOptions): Promise<IUntypedEditorInput | undefined> {\n\t\treturn this.doSave(options, true, group);\n\t}\n\n\tprivate async doSave(options: ITextFileSaveOptions | undefined, saveAs: boolean, group: GroupIdentifier | undefined): Promise<IUntypedEditorInput | undefined> {\n\n\t\t// Save / Save As\n\t\tlet target: URI | undefined;\n\t\tif (saveAs) {\n\t\t\ttarget = await this.textFileService.saveAs(this.resource, undefined, { ...options, suggestedTarget: this.preferredResource });\n\t\t} else {\n\t\t\ttarget = await this.textFileService.save(this.resource, options);\n\t\t}\n\n\t\tif (!target) {\n\t\t\treturn undefined; // save cancelled\n\t\t}\n\n\t\treturn { resource: target };\n\t}\n\n\toverride async revert(group: GroupIdentifier, options?: IRevertOptions): Promise<void> {\n\t\tawait this.textFileService.revert(this.resource, options);\n\t}\n}\n\n/**\n * A read-only text editor input whos contents are made of the provided resource that points to an existing\n * code editor model.\n */\nexport class TextResourceEditorInput extends AbstractTextResourceEditorInput implements ILanguageSupport {\n\n\tstatic readonly ID: string = 'workbench.editors.resourceEditorInput';\n\n\toverride get typeId(): string {\n\t\treturn TextResourceEditorInput.ID;\n\t}\n\n\toverride get editorId(): string | undefined {\n\t\treturn DEFAULT_EDITOR_ASSOCIATION.id;\n\t}\n\n\tprivate cachedModel: TextResourceEditorModel | undefined = undefined;\n\tprivate modelReference: Promise<IReference<ITextEditorModel>> | undefined = undefined;\n\n\tconstructor(\n\t\tresource: URI,\n\t\tprivate name: string | undefined,\n\t\tprivate description: string | undefined,\n\t\tprivate preferredLanguageId: string | undefined,\n\t\tprivate preferredContents: string | undefined,\n\t\t@ITextModelService private readonly textModelService: ITextModelService,\n\t\t@ITextFileService textFileService: ITextFileService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IFileService fileService: IFileService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@ICustomEditorLabelService customEditorLabelService: ICustomEditorLabelService\n\t) {\n\t\tsuper(resource, undefined, editorService, textFileService, labelService, fileService, filesConfigurationService, textResourceConfigurationService, customEditorLabelService);\n\t}\n\n\toverride getName(): string {\n\t\treturn this.name || super.getName();\n\t}\n\n\tsetName(name: string): void {\n\t\tif (this.name !== name) {\n\t\t\tthis.name = name;\n\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}\n\t}\n\n\toverride getDescription(): string | undefined {\n\t\treturn this.description;\n\t}\n\n\tsetDescription(description: string): void {\n\t\tif (this.description !== description) {\n\t\t\tthis.description = description;\n\n\t\t\tthis._onDidChangeLabel.fire();\n\t\t}\n\t}\n\n\tsetLanguageId(languageId: string, source?: string): void {\n\t\tthis.setPreferredLanguageId(languageId);\n\n\t\tthis.cachedModel?.setLanguageId(languageId, source);\n\t}\n\n\tsetPreferredLanguageId(languageId: string): void {\n\t\tthis.preferredLanguageId = languageId;\n\t}\n\n\tsetPreferredContents(contents: string): void {\n\t\tthis.preferredContents = contents;\n\t}\n\n\toverride async resolve(): Promise<ITextEditorModel> {\n\n\t\t// Unset preferred contents and language after resolving\n\t\t// once to prevent these properties to stick. We still\n\t\t// want the user to change the language in the editor\n\t\t// and want to show updated contents (if any) in future\n\t\t// `resolve` calls.\n\t\tconst preferredContents = this.preferredContents;\n\t\tconst preferredLanguageId = this.preferredLanguageId;\n\t\tthis.preferredContents = undefined;\n\t\tthis.preferredLanguageId = undefined;\n\n\t\tif (!this.modelReference) {\n\t\t\tthis.modelReference = this.textModelService.createModelReference(this.resource);\n\t\t}\n\n\t\tconst ref = await this.modelReference;\n\n\t\t// Ensure the resolved model is of expected type\n\t\tconst model = ref.object;\n\t\tif (!(model instanceof TextResourceEditorModel)) {\n\t\t\tref.dispose();\n\t\t\tthis.modelReference = undefined;\n\n\t\t\tthrow new Error(`Unexpected model for TextResourceEditorInput: ${this.resource}`);\n\t\t}\n\n\t\tthis.cachedModel = model;\n\n\t\t// Set contents and language if preferred\n\t\tif (typeof preferredContents === 'string' || typeof preferredLanguageId === 'string') {\n\t\t\tmodel.updateTextEditorModel(typeof preferredContents === 'string' ? createTextBufferFactory(preferredContents) : undefined, preferredLanguageId);\n\t\t}\n\n\t\treturn model;\n\t}\n\n\toverride matches(otherInput: EditorInput | IUntypedEditorInput): boolean {\n\t\tif (this === otherInput) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (otherInput instanceof TextResourceEditorInput) {\n\t\t\treturn isEqual(otherInput.resource, this.resource);\n\t\t}\n\n\t\tif (isResourceEditorInput(otherInput)) {\n\t\t\treturn super.matches(otherInput);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\toverride dispose(): void {\n\t\tif (this.modelReference) {\n\t\t\tthis.modelReference.then(ref => ref.dispose());\n\t\t\tthis.modelReference = undefined;\n\t\t}\n\n\t\tthis.cachedModel = undefined;\n\n\t\tsuper.dispose();\n\t}\n}\n"]}