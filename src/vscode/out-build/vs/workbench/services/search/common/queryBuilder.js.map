{"version":3,"sources":["vs/workbench/services/search/common/queryBuilder.ts"],"names":[],"mappings":"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","file":"queryBuilder.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from '../../../../base/common/arrays.js';\nimport * as collections from '../../../../base/common/collections.js';\nimport * as glob from '../../../../base/common/glob.js';\nimport { untildify } from '../../../../base/common/labels.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as path from '../../../../base/common/path.js';\nimport { isEqual, basename, relativePath, isAbsolutePath } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { assertReturnsDefined, isDefined } from '../../../../base/common/types.js';\nimport { URI, URI as uri, UriComponents } from '../../../../base/common/uri.js';\nimport { isMultilineRegexSource } from '../../../../editor/common/model/textModelSearch.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceContextService, IWorkspaceFolderData, toWorkspaceFolder, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IEditorGroupsService } from '../../editor/common/editorGroupsService.js';\nimport { IPathService } from '../../path/common/pathService.js';\nimport { ExcludeGlobPattern, getExcludes, IAITextQuery, ICommonQueryProps, IFileQuery, IFolderQuery, IPatternInfo, ISearchConfiguration, ITextQuery, ITextSearchPreviewOptions, pathIncludedInQuery, QueryType } from './search.js';\nimport { GlobPattern } from './searchExtTypes.js';\n\n/**\n * One folder to search and a glob expression that should be applied.\n */\ninterface IOneSearchPathPattern {\n\tsearchPath: uri;\n\tpattern?: string;\n}\n\n/**\n * One folder to search and a set of glob expressions that should be applied.\n */\nexport interface ISearchPathPattern {\n\tsearchPath: uri;\n\tpattern?: glob.IExpression;\n}\n\ntype ISearchPathPatternBuilder = string | string[];\n\nexport interface ISearchPatternBuilder<U extends UriComponents> {\n\turi?: U;\n\tpattern: ISearchPathPatternBuilder;\n}\n\nexport function isISearchPatternBuilder<U extends UriComponents>(object: ISearchPatternBuilder<U> | ISearchPathPatternBuilder): object is ISearchPatternBuilder<U> {\n\treturn (typeof object === 'object' && 'uri' in object && 'pattern' in object);\n}\n\nexport function globPatternToISearchPatternBuilder(globPattern: GlobPattern): ISearchPatternBuilder<URI> {\n\n\tif (typeof globPattern === 'string') {\n\t\treturn {\n\t\t\tpattern: globPattern\n\t\t};\n\t}\n\n\treturn {\n\t\tpattern: globPattern.pattern,\n\t\turi: globPattern.baseUri\n\t};\n}\n\n/**\n * A set of search paths and a set of glob expressions that should be applied.\n */\nexport interface ISearchPathsInfo {\n\tsearchPaths?: ISearchPathPattern[];\n\tpattern?: glob.IExpression;\n}\n\ninterface ICommonQueryBuilderOptions<U extends UriComponents = URI> {\n\t_reason?: string;\n\texcludePattern?: ISearchPatternBuilder<U>[];\n\tincludePattern?: ISearchPathPatternBuilder;\n\textraFileResources?: U[];\n\n\t/** Parse the special ./ syntax supported by the searchview, and expand foo to ** /foo */\n\texpandPatterns?: boolean;\n\n\tmaxResults?: number;\n\tmaxFileSize?: number;\n\tdisregardIgnoreFiles?: boolean;\n\tdisregardGlobalIgnoreFiles?: boolean;\n\tdisregardParentIgnoreFiles?: boolean;\n\tdisregardExcludeSettings?: boolean;\n\tdisregardSearchExcludeSettings?: boolean;\n\tignoreSymlinks?: boolean;\n\tonlyOpenEditors?: boolean;\n\tonlyFileScheme?: boolean;\n}\n\nexport interface IFileQueryBuilderOptions<U extends UriComponents = URI> extends ICommonQueryBuilderOptions<U> {\n\tfilePattern?: string;\n\texists?: boolean;\n\tsortByScore?: boolean;\n\tcacheKey?: string;\n\tshouldGlobSearch?: boolean;\n}\n\nexport interface ITextQueryBuilderOptions<U extends UriComponents = URI> extends ICommonQueryBuilderOptions<U> {\n\tpreviewOptions?: ITextSearchPreviewOptions;\n\tfileEncoding?: string;\n\tsurroundingContext?: number;\n\tisSmartCase?: boolean;\n\tnotebookSearchConfig?: {\n\t\tincludeMarkupInput: boolean;\n\t\tincludeMarkupPreview: boolean;\n\t\tincludeCodeInput: boolean;\n\t\tincludeOutput: boolean;\n\t};\n}\n\nexport class QueryBuilder {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService,\n\t\t@IEditorGroupsService private readonly editorGroupsService: IEditorGroupsService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IPathService private readonly pathService: IPathService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService\n\t) {\n\t}\n\n\taiText(contentPattern: string, folderResources?: uri[], options: ITextQueryBuilderOptions = {}): IAITextQuery {\n\t\tconst commonQuery = this.commonQuery(folderResources?.map(toWorkspaceFolder), options);\n\t\treturn {\n\t\t\t...commonQuery,\n\t\t\ttype: QueryType.aiText,\n\t\t\tcontentPattern,\n\t\t};\n\t}\n\n\ttext(contentPattern: IPatternInfo, folderResources?: uri[], options: ITextQueryBuilderOptions = {}): ITextQuery {\n\t\tcontentPattern = this.getContentPattern(contentPattern, options);\n\t\tconst searchConfig = this.configurationService.getValue<ISearchConfiguration>();\n\n\t\tconst fallbackToPCRE = folderResources && folderResources.some(folder => {\n\t\t\tconst folderConfig = this.configurationService.getValue<ISearchConfiguration>({ resource: folder });\n\t\t\treturn !folderConfig.search.useRipgrep;\n\t\t});\n\n\t\tconst commonQuery = this.commonQuery(folderResources?.map(toWorkspaceFolder), options);\n\t\treturn {\n\t\t\t...commonQuery,\n\t\t\ttype: QueryType.Text,\n\t\t\tcontentPattern,\n\t\t\tpreviewOptions: options.previewOptions,\n\t\t\tmaxFileSize: options.maxFileSize,\n\t\t\tusePCRE2: searchConfig.search.usePCRE2 || fallbackToPCRE || false,\n\t\t\tsurroundingContext: options.surroundingContext,\n\t\t\tuserDisabledExcludesAndIgnoreFiles: options.disregardExcludeSettings && options.disregardIgnoreFiles,\n\n\t\t};\n\t}\n\n\t/**\n\t * Adjusts input pattern for config\n\t */\n\tprivate getContentPattern(inputPattern: IPatternInfo, options: ITextQueryBuilderOptions): IPatternInfo {\n\t\tconst searchConfig = this.configurationService.getValue<ISearchConfiguration>();\n\n\t\tif (inputPattern.isRegExp) {\n\t\t\tinputPattern.pattern = inputPattern.pattern.replace(/\\r?\\n/g, '\\\\n');\n\t\t}\n\n\t\tconst newPattern = {\n\t\t\t...inputPattern,\n\t\t\twordSeparators: searchConfig.editor.wordSeparators\n\t\t};\n\n\t\tif (this.isCaseSensitive(inputPattern, options)) {\n\t\t\tnewPattern.isCaseSensitive = true;\n\t\t}\n\n\t\tif (this.isMultiline(inputPattern)) {\n\t\t\tnewPattern.isMultiline = true;\n\t\t}\n\n\t\tif (options.notebookSearchConfig?.includeMarkupInput) {\n\t\t\tif (!newPattern.notebookInfo) {\n\t\t\t\tnewPattern.notebookInfo = {};\n\t\t\t}\n\t\t\tnewPattern.notebookInfo.isInNotebookMarkdownInput = options.notebookSearchConfig.includeMarkupInput;\n\t\t}\n\n\t\tif (options.notebookSearchConfig?.includeMarkupPreview) {\n\t\t\tif (!newPattern.notebookInfo) {\n\t\t\t\tnewPattern.notebookInfo = {};\n\t\t\t}\n\t\t\tnewPattern.notebookInfo.isInNotebookMarkdownPreview = options.notebookSearchConfig.includeMarkupPreview;\n\t\t}\n\n\t\tif (options.notebookSearchConfig?.includeCodeInput) {\n\t\t\tif (!newPattern.notebookInfo) {\n\t\t\t\tnewPattern.notebookInfo = {};\n\t\t\t}\n\t\t\tnewPattern.notebookInfo.isInNotebookCellInput = options.notebookSearchConfig.includeCodeInput;\n\t\t}\n\n\t\tif (options.notebookSearchConfig?.includeOutput) {\n\t\t\tif (!newPattern.notebookInfo) {\n\t\t\t\tnewPattern.notebookInfo = {};\n\t\t\t}\n\t\t\tnewPattern.notebookInfo.isInNotebookCellOutput = options.notebookSearchConfig.includeOutput;\n\t\t}\n\n\t\treturn newPattern;\n\t}\n\n\tfile(folders: (IWorkspaceFolderData | URI)[], options: IFileQueryBuilderOptions = {}): IFileQuery {\n\t\tconst commonQuery = this.commonQuery(folders, options);\n\t\treturn {\n\t\t\t...commonQuery,\n\t\t\ttype: QueryType.File,\n\t\t\tfilePattern: options.filePattern\n\t\t\t\t? options.filePattern.trim()\n\t\t\t\t: options.filePattern,\n\t\t\texists: options.exists,\n\t\t\tsortByScore: options.sortByScore,\n\t\t\tcacheKey: options.cacheKey,\n\t\t\tshouldGlobMatchFilePattern: options.shouldGlobSearch\n\t\t};\n\t}\n\n\tprivate handleIncludeExclude(pattern: string | string[] | undefined, expandPatterns: boolean | undefined): ISearchPathsInfo {\n\t\tif (!pattern) {\n\t\t\treturn {};\n\t\t}\n\n\t\tif (Array.isArray(pattern)) {\n\t\t\tpattern = pattern.filter(p => p.length > 0).map(normalizeSlashes);\n\t\t\tif (!pattern.length) {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t} else {\n\t\t\tpattern = normalizeSlashes(pattern);\n\t\t}\n\t\treturn expandPatterns\n\t\t\t? this.parseSearchPaths(pattern)\n\t\t\t: { pattern: patternListToIExpression(...(Array.isArray(pattern) ? pattern : [pattern])) };\n\t}\n\n\tprivate commonQuery(folderResources: (IWorkspaceFolderData | URI)[] = [], options: ICommonQueryBuilderOptions = {}): ICommonQueryProps<uri> {\n\n\t\tlet excludePatterns: string | string[] | undefined = Array.isArray(options.excludePattern) ? options.excludePattern.map(p => p.pattern).flat() : options.excludePattern;\n\t\texcludePatterns = excludePatterns?.length === 1 ? excludePatterns[0] : excludePatterns;\n\t\tconst includeSearchPathsInfo: ISearchPathsInfo = this.handleIncludeExclude(options.includePattern, options.expandPatterns);\n\t\tconst excludeSearchPathsInfo: ISearchPathsInfo = this.handleIncludeExclude(excludePatterns, options.expandPatterns);\n\n\t\t// Build folderQueries from searchPaths, if given, otherwise folderResources\n\t\tconst includeFolderName = folderResources.length > 1;\n\t\tconst folderQueries = (includeSearchPathsInfo.searchPaths && includeSearchPathsInfo.searchPaths.length ?\n\t\t\tincludeSearchPathsInfo.searchPaths.map(searchPath => this.getFolderQueryForSearchPath(searchPath, options, excludeSearchPathsInfo)) :\n\t\t\tfolderResources.map(folder => this.getFolderQueryForRoot(folder, options, excludeSearchPathsInfo, includeFolderName)))\n\t\t\t.filter(query => !!query) as IFolderQuery[];\n\n\t\tconst queryProps: ICommonQueryProps<uri> = {\n\t\t\t_reason: options._reason,\n\t\t\tfolderQueries,\n\t\t\tusingSearchPaths: !!(includeSearchPathsInfo.searchPaths && includeSearchPathsInfo.searchPaths.length),\n\t\t\textraFileResources: options.extraFileResources,\n\n\t\t\texcludePattern: excludeSearchPathsInfo.pattern,\n\t\t\tincludePattern: includeSearchPathsInfo.pattern,\n\t\t\tonlyOpenEditors: options.onlyOpenEditors,\n\t\t\tmaxResults: options.maxResults,\n\t\t\tonlyFileScheme: options.onlyFileScheme\n\t\t};\n\n\t\tif (options.onlyOpenEditors) {\n\t\t\tconst openEditors = arrays.coalesce(this.editorGroupsService.groups.flatMap(group => group.editors.map(editor => editor.resource)));\n\t\t\tthis.logService.trace('QueryBuilder#commonQuery - openEditor URIs', JSON.stringify(openEditors));\n\t\t\tconst openEditorsInQuery = openEditors.filter(editor => pathIncludedInQuery(queryProps, editor.fsPath));\n\t\t\tconst openEditorsQueryProps = this.commonQueryFromFileList(openEditorsInQuery);\n\t\t\tthis.logService.trace('QueryBuilder#commonQuery - openEditor Query', JSON.stringify(openEditorsQueryProps));\n\t\t\treturn { ...queryProps, ...openEditorsQueryProps };\n\t\t}\n\n\t\t// Filter extraFileResources against global include/exclude patterns - they are already expected to not belong to a workspace\n\t\tconst extraFileResources = options.extraFileResources && options.extraFileResources.filter(extraFile => pathIncludedInQuery(queryProps, extraFile.fsPath));\n\t\tqueryProps.extraFileResources = extraFileResources && extraFileResources.length ? extraFileResources : undefined;\n\n\t\treturn queryProps;\n\t}\n\n\tprivate commonQueryFromFileList(files: URI[]): ICommonQueryProps<URI> {\n\t\tconst folderQueries: IFolderQuery[] = [];\n\t\tconst foldersToSearch: ResourceMap<IFolderQuery> = new ResourceMap();\n\t\tconst includePattern: glob.IExpression = {};\n\t\tlet hasIncludedFile = false;\n\t\tfiles.forEach(file => {\n\t\t\tif (file.scheme === Schemas.walkThrough) { return; }\n\n\t\t\tconst providerExists = isAbsolutePath(file);\n\t\t\t// Special case userdata as we don't have a search provider for it, but it can be searched.\n\t\t\tif (providerExists) {\n\n\t\t\t\tconst searchRoot = this.workspaceContextService.getWorkspaceFolder(file)?.uri ?? this.uriIdentityService.extUri.dirname(file);\n\n\t\t\t\tlet folderQuery = foldersToSearch.get(searchRoot);\n\t\t\t\tif (!folderQuery) {\n\t\t\t\t\thasIncludedFile = true;\n\t\t\t\t\tfolderQuery = { folder: searchRoot, includePattern: {} };\n\t\t\t\t\tfolderQueries.push(folderQuery);\n\t\t\t\t\tfoldersToSearch.set(searchRoot, folderQuery);\n\t\t\t\t}\n\n\t\t\t\tconst relPath = path.relative(searchRoot.fsPath, file.fsPath);\n\t\t\t\tassertReturnsDefined(folderQuery.includePattern)[escapeGlobPattern(relPath.replace(/\\\\/g, '/'))] = true;\n\t\t\t} else {\n\t\t\t\tif (file.fsPath) {\n\t\t\t\t\thasIncludedFile = true;\n\t\t\t\t\tincludePattern[escapeGlobPattern(file.fsPath)] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tfolderQueries,\n\t\t\tincludePattern,\n\t\t\tusingSearchPaths: true,\n\t\t\texcludePattern: hasIncludedFile ? undefined : { '**/*': true }\n\t\t};\n\t}\n\n\t/**\n\t * Resolve isCaseSensitive flag based on the query and the isSmartCase flag, for search providers that don't support smart case natively.\n\t */\n\tprivate isCaseSensitive(contentPattern: IPatternInfo, options: ITextQueryBuilderOptions): boolean {\n\t\tif (options.isSmartCase) {\n\t\t\tif (contentPattern.isRegExp) {\n\t\t\t\t// Consider it case sensitive if it contains an unescaped capital letter\n\t\t\t\tif (strings.containsUppercaseCharacter(contentPattern.pattern, true)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else if (strings.containsUppercaseCharacter(contentPattern.pattern)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn !!contentPattern.isCaseSensitive;\n\t}\n\n\tprivate isMultiline(contentPattern: IPatternInfo): boolean {\n\t\tif (contentPattern.isMultiline) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (contentPattern.isRegExp && isMultilineRegexSource(contentPattern.pattern)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (contentPattern.pattern.indexOf('\\n') >= 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn !!contentPattern.isMultiline;\n\t}\n\n\t/**\n\t * Take the includePattern as seen in the search viewlet, and split into components that look like searchPaths, and\n\t * glob patterns. Glob patterns are expanded from 'foo/bar' to '{foo/bar/**, **\\/foo/bar}.\n\t *\n\t * Public for test.\n\t */\n\tparseSearchPaths(pattern: string | string[]): ISearchPathsInfo {\n\t\tconst isSearchPath = (segment: string) => {\n\t\t\t// A segment is a search path if it is an absolute path or starts with ./, ../, .\\, or ..\\\n\t\t\treturn path.isAbsolute(segment) || /^\\.\\.?([\\/\\\\]|$)/.test(segment);\n\t\t};\n\n\t\tconst patterns = Array.isArray(pattern) ? pattern : splitGlobPattern(pattern);\n\t\tconst segments = patterns\n\t\t\t.map(segment => {\n\t\t\t\tconst userHome = this.pathService.resolvedUserHome;\n\t\t\t\tif (userHome) {\n\t\t\t\t\treturn untildify(segment, userHome.scheme === Schemas.file ? userHome.fsPath : userHome.path);\n\t\t\t\t}\n\n\t\t\t\treturn segment;\n\t\t\t});\n\t\tconst groups = collections.groupBy(segments,\n\t\t\tsegment => isSearchPath(segment) ? 'searchPaths' : 'exprSegments');\n\n\t\tconst expandedExprSegments = (groups.exprSegments || [])\n\t\t\t.map(s => strings.rtrim(s, '/'))\n\t\t\t.map(s => strings.rtrim(s, '\\\\'))\n\t\t\t.map(p => {\n\t\t\t\tif (p[0] === '.') {\n\t\t\t\t\tp = '*' + p; // convert \".js\" to \"*.js\"\n\t\t\t\t}\n\n\t\t\t\treturn expandGlobalGlob(p);\n\t\t\t});\n\n\t\tconst result: ISearchPathsInfo = {};\n\t\tconst searchPaths = this.expandSearchPathPatterns(groups.searchPaths || []);\n\t\tif (searchPaths && searchPaths.length) {\n\t\t\tresult.searchPaths = searchPaths;\n\t\t}\n\n\t\tconst exprSegments = expandedExprSegments.flat();\n\t\tconst includePattern = patternListToIExpression(...exprSegments);\n\t\tif (includePattern) {\n\t\t\tresult.pattern = includePattern;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate getExcludesForFolder(folderConfig: ISearchConfiguration, options: ICommonQueryBuilderOptions): glob.IExpression | undefined {\n\t\treturn options.disregardExcludeSettings ?\n\t\t\tundefined :\n\t\t\tgetExcludes(folderConfig, !options.disregardSearchExcludeSettings);\n\t}\n\n\t/**\n\t * Split search paths (./ or ../ or absolute paths in the includePatterns) into absolute paths and globs applied to those paths\n\t */\n\tprivate expandSearchPathPatterns(searchPaths: string[]): ISearchPathPattern[] {\n\t\tif (!searchPaths || !searchPaths.length) {\n\t\t\t// No workspace => ignore search paths\n\t\t\treturn [];\n\t\t}\n\n\t\tconst expandedSearchPaths = searchPaths.flatMap(searchPath => {\n\t\t\t// 1 open folder => just resolve the search paths to absolute paths\n\t\t\tlet { pathPortion, globPortion } = splitGlobFromPath(searchPath);\n\n\t\t\tif (globPortion) {\n\t\t\t\tglobPortion = normalizeGlobPattern(globPortion);\n\t\t\t}\n\n\t\t\t// One pathPortion to multiple expanded search paths (e.g. duplicate matching workspace folders)\n\t\t\tconst oneExpanded = this.expandOneSearchPath(pathPortion);\n\n\t\t\t// Expanded search paths to multiple resolved patterns (with ** and without)\n\t\t\treturn oneExpanded.flatMap(oneExpandedResult => this.resolveOneSearchPathPattern(oneExpandedResult, globPortion));\n\t\t});\n\n\t\tconst searchPathPatternMap = new Map<string, ISearchPathPattern>();\n\t\texpandedSearchPaths.forEach(oneSearchPathPattern => {\n\t\t\tconst key = oneSearchPathPattern.searchPath.toString();\n\t\t\tconst existing = searchPathPatternMap.get(key);\n\t\t\tif (existing) {\n\t\t\t\tif (oneSearchPathPattern.pattern) {\n\t\t\t\t\texisting.pattern = existing.pattern || {};\n\t\t\t\t\texisting.pattern[oneSearchPathPattern.pattern] = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsearchPathPatternMap.set(key, {\n\t\t\t\t\tsearchPath: oneSearchPathPattern.searchPath,\n\t\t\t\t\tpattern: oneSearchPathPattern.pattern ? patternListToIExpression(oneSearchPathPattern.pattern) : undefined\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn Array.from(searchPathPatternMap.values());\n\t}\n\n\t/**\n\t * Takes a searchPath like `./a/foo` or `../a/foo` and expands it to absolute paths for all the workspaces it matches.\n\t */\n\tprivate expandOneSearchPath(searchPath: string): IOneSearchPathPattern[] {\n\t\tif (path.isAbsolute(searchPath)) {\n\t\t\tconst workspaceFolders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tif (workspaceFolders[0] && workspaceFolders[0].uri.scheme !== Schemas.file) {\n\t\t\t\treturn [{\n\t\t\t\t\tsearchPath: workspaceFolders[0].uri.with({ path: searchPath })\n\t\t\t\t}];\n\t\t\t}\n\n\t\t\t// Currently only local resources can be searched for with absolute search paths.\n\t\t\t// TODO convert this to a workspace folder + pattern, so excludes will be resolved properly for an absolute path inside a workspace folder\n\t\t\treturn [{\n\t\t\t\tsearchPath: uri.file(path.normalize(searchPath))\n\t\t\t}];\n\t\t}\n\n\t\tif (this.workspaceContextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\tconst workspaceUri = this.workspaceContextService.getWorkspace().folders[0].uri;\n\n\t\t\tsearchPath = normalizeSlashes(searchPath);\n\t\t\tif (searchPath.startsWith('../') || searchPath === '..') {\n\t\t\t\tconst resolvedPath = path.posix.resolve(workspaceUri.path, searchPath);\n\t\t\t\treturn [{\n\t\t\t\t\tsearchPath: workspaceUri.with({ path: resolvedPath })\n\t\t\t\t}];\n\t\t\t}\n\n\t\t\tconst cleanedPattern = normalizeGlobPattern(searchPath);\n\t\t\treturn [{\n\t\t\t\tsearchPath: workspaceUri,\n\t\t\t\tpattern: cleanedPattern\n\t\t\t}];\n\t\t} else if (searchPath === './' || searchPath === '.\\\\') {\n\t\t\treturn []; // ./ or ./**/foo makes sense for single-folder but not multi-folder workspaces\n\t\t} else {\n\t\t\tconst searchPathWithoutDotSlash = searchPath.replace(/^\\.[\\/\\\\]/, '');\n\t\t\tconst folders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tconst folderMatches = folders.map(folder => {\n\t\t\t\tconst match = searchPathWithoutDotSlash.match(new RegExp(`^${strings.escapeRegExpCharacters(folder.name)}(?:/(.*)|$)`));\n\t\t\t\treturn match ? {\n\t\t\t\t\tmatch,\n\t\t\t\t\tfolder\n\t\t\t\t} : null;\n\t\t\t}).filter(isDefined);\n\n\t\t\tif (folderMatches.length) {\n\t\t\t\treturn folderMatches.map(match => {\n\t\t\t\t\tconst patternMatch = match.match[1];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsearchPath: match.folder.uri,\n\t\t\t\t\t\tpattern: patternMatch && normalizeGlobPattern(patternMatch)\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst probableWorkspaceFolderNameMatch = searchPath.match(/\\.[\\/\\\\](.+)[\\/\\\\]?/);\n\t\t\t\tconst probableWorkspaceFolderName = probableWorkspaceFolderNameMatch ? probableWorkspaceFolderNameMatch[1] : searchPath;\n\n\t\t\t\t// No root folder with name\n\t\t\t\tconst searchPathNotFoundError = nls.localize('search.noWorkspaceWithName', \"Workspace folder does not exist: {0}\", probableWorkspaceFolderName);\n\t\t\t\tthrow new Error(searchPathNotFoundError);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate resolveOneSearchPathPattern(oneExpandedResult: IOneSearchPathPattern, globPortion?: string): IOneSearchPathPattern[] {\n\t\tconst pattern = oneExpandedResult.pattern && globPortion ?\n\t\t\t`${oneExpandedResult.pattern}/${globPortion}` :\n\t\t\toneExpandedResult.pattern || globPortion;\n\n\t\tconst results = [\n\t\t\t{\n\t\t\t\tsearchPath: oneExpandedResult.searchPath,\n\t\t\t\tpattern\n\t\t\t}];\n\n\t\tif (pattern && !pattern.endsWith('**')) {\n\t\t\tresults.push({\n\t\t\t\tsearchPath: oneExpandedResult.searchPath,\n\t\t\t\tpattern: pattern + '/**'\n\t\t\t});\n\t\t}\n\n\t\treturn results;\n\t}\n\n\tprivate getFolderQueryForSearchPath(searchPath: ISearchPathPattern, options: ICommonQueryBuilderOptions, searchPathExcludes: ISearchPathsInfo): IFolderQuery | null {\n\t\tconst rootConfig = this.getFolderQueryForRoot(toWorkspaceFolder(searchPath.searchPath), options, searchPathExcludes, false);\n\t\tif (!rootConfig) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\t...rootConfig,\n\t\t\t...{\n\t\t\t\tincludePattern: searchPath.pattern\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate getFolderQueryForRoot(folder: (IWorkspaceFolderData | URI), options: ICommonQueryBuilderOptions, searchPathExcludes: ISearchPathsInfo, includeFolderName: boolean): IFolderQuery | null {\n\t\tlet thisFolderExcludeSearchPathPattern: glob.IExpression | undefined;\n\t\tconst folderUri = URI.isUri(folder) ? folder : folder.uri;\n\n\t\t// only use exclude root if it is different from the folder root\n\t\tlet excludeFolderRoots = options.excludePattern?.map(excludePattern => {\n\t\t\tconst excludeRoot = options.excludePattern && isISearchPatternBuilder(excludePattern) ? excludePattern.uri : undefined;\n\t\t\tconst shouldUseExcludeRoot = (!excludeRoot || !(URI.isUri(folder) && this.uriIdentityService.extUri.isEqual(folder, excludeRoot)));\n\t\t\treturn shouldUseExcludeRoot ? excludeRoot : undefined;\n\t\t});\n\n\t\tif (!excludeFolderRoots?.length) {\n\t\t\texcludeFolderRoots = [undefined];\n\t\t}\n\n\t\tif (searchPathExcludes.searchPaths) {\n\t\t\tconst thisFolderExcludeSearchPath = searchPathExcludes.searchPaths.filter(sp => isEqual(sp.searchPath, folderUri))[0];\n\t\t\tif (thisFolderExcludeSearchPath && !thisFolderExcludeSearchPath.pattern) {\n\t\t\t\t// entire folder is excluded\n\t\t\t\treturn null;\n\t\t\t} else if (thisFolderExcludeSearchPath) {\n\t\t\t\tthisFolderExcludeSearchPathPattern = thisFolderExcludeSearchPath.pattern;\n\t\t\t}\n\t\t}\n\n\t\tconst folderConfig = this.configurationService.getValue<ISearchConfiguration>({ resource: folderUri });\n\t\tconst settingExcludes = this.getExcludesForFolder(folderConfig, options);\n\t\tconst excludePattern: glob.IExpression = {\n\t\t\t...(settingExcludes || {}),\n\t\t\t...(thisFolderExcludeSearchPathPattern || {})\n\t\t};\n\n\t\tconst folderName = URI.isUri(folder) ? basename(folder) : folder.name;\n\n\t\tconst excludePatternRet: ExcludeGlobPattern[] = excludeFolderRoots.map(excludeFolderRoot => {\n\t\t\treturn Object.keys(excludePattern).length > 0 ? {\n\t\t\t\tfolder: excludeFolderRoot,\n\t\t\t\tpattern: excludePattern\n\t\t\t} satisfies ExcludeGlobPattern : undefined;\n\t\t}).filter((e) => e) as ExcludeGlobPattern[];\n\n\t\treturn {\n\t\t\tfolder: folderUri,\n\t\t\tfolderName: includeFolderName ? folderName : undefined,\n\t\t\texcludePattern: excludePatternRet,\n\t\t\tfileEncoding: folderConfig.files && folderConfig.files.encoding,\n\t\t\tdisregardIgnoreFiles: typeof options.disregardIgnoreFiles === 'boolean' ? options.disregardIgnoreFiles : !folderConfig.search.useIgnoreFiles,\n\t\t\tdisregardGlobalIgnoreFiles: typeof options.disregardGlobalIgnoreFiles === 'boolean' ? options.disregardGlobalIgnoreFiles : !folderConfig.search.useGlobalIgnoreFiles,\n\t\t\tdisregardParentIgnoreFiles: typeof options.disregardParentIgnoreFiles === 'boolean' ? options.disregardParentIgnoreFiles : !folderConfig.search.useParentIgnoreFiles,\n\t\t\tignoreSymlinks: typeof options.ignoreSymlinks === 'boolean' ? options.ignoreSymlinks : !folderConfig.search.followSymlinks,\n\t\t};\n\t}\n}\n\nfunction splitGlobFromPath(searchPath: string): { pathPortion: string; globPortion?: string } {\n\tconst globCharMatch = searchPath.match(/[\\*\\{\\}\\(\\)\\[\\]\\?]/);\n\tif (globCharMatch) {\n\t\tconst globCharIdx = globCharMatch.index;\n\t\tconst lastSlashMatch = searchPath.substr(0, globCharIdx).match(/[/|\\\\][^/\\\\]*$/);\n\t\tif (lastSlashMatch) {\n\t\t\tlet pathPortion = searchPath.substr(0, lastSlashMatch.index);\n\t\t\tif (!pathPortion.match(/[/\\\\]/)) {\n\t\t\t\t// If the last slash was the only slash, then we now have '' or 'C:' or '.'. Append a slash.\n\t\t\t\tpathPortion += '/';\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tpathPortion,\n\t\t\t\tglobPortion: searchPath.substr((lastSlashMatch.index || 0) + 1)\n\t\t\t};\n\t\t}\n\t}\n\n\t// No glob char, or malformed\n\treturn {\n\t\tpathPortion: searchPath\n\t};\n}\n\nfunction patternListToIExpression(...patterns: string[]): glob.IExpression | undefined {\n\treturn patterns.length ?\n\t\tpatterns.reduce((glob, cur) => { glob[cur] = true; return glob; }, Object.create(null)) :\n\t\tundefined;\n}\n\nfunction splitGlobPattern(pattern: string): string[] {\n\treturn glob.splitGlobAware(pattern, ',')\n\t\t.map(s => s.trim())\n\t\t.filter(s => !!s.length);\n}\n\n/**\n * Note - we used {} here previously but ripgrep can't handle nested {} patterns. See https://github.com/microsoft/vscode/issues/32761\n */\nfunction expandGlobalGlob(pattern: string): string[] {\n\tconst patterns = [\n\t\t`**/${pattern}/**`,\n\t\t`**/${pattern}`\n\t];\n\n\treturn patterns.map(p => p.replace(/\\*\\*\\/\\*\\*/g, '**'));\n}\n\nfunction normalizeSlashes(pattern: string): string {\n\treturn pattern.replace(/\\\\/g, '/');\n}\n\n/**\n * Normalize slashes, remove `./` and trailing slashes\n */\nfunction normalizeGlobPattern(pattern: string): string {\n\treturn normalizeSlashes(pattern)\n\t\t.replace(/^\\.\\//, '')\n\t\t.replace(/\\/+$/g, '');\n}\n\n/**\n * Escapes a path for use as a glob pattern that would match the input precisely.\n * Characters '?', '*', '[', and ']' are escaped into character range glob syntax\n * (for example, '?' becomes '[?]').\n * NOTE: This implementation makes no special cases for UNC paths. For example,\n * given the input \"//?/C:/A?.txt\", this would produce output '//[?]/C:/A[?].txt',\n * which may not be desirable in some cases. Use with caution if UNC paths could be expected.\n */\nexport function escapeGlobPattern(path: string): string {\n\treturn path.replace(/([?*[\\]])/g, '[$1]');\n}\n\n/**\n * Construct an include pattern from a list of folders uris to search in.\n */\nexport function resolveResourcesForSearchIncludes(resources: URI[], contextService: IWorkspaceContextService): string[] {\n\tresources = arrays.distinct(resources, resource => resource.toString());\n\n\tconst folderPaths: string[] = [];\n\tconst workspace = contextService.getWorkspace();\n\n\tif (resources) {\n\t\tresources.forEach(resource => {\n\t\t\tlet folderPath: string | undefined;\n\t\t\tif (contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\t\t// Show relative path from the root for single-root mode\n\t\t\t\tfolderPath = relativePath(workspace.folders[0].uri, resource); // always uses forward slashes\n\t\t\t\tif (folderPath && folderPath !== '.') {\n\t\t\t\t\tfolderPath = './' + folderPath;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst owningFolder = contextService.getWorkspaceFolder(resource);\n\t\t\t\tif (owningFolder) {\n\t\t\t\t\tconst owningRootName = owningFolder.name;\n\t\t\t\t\t// If this root is the only one with its basename, use a relative ./ path. If there is another, use an absolute path\n\t\t\t\t\tconst isUniqueFolder = workspace.folders.filter(folder => folder.name === owningRootName).length === 1;\n\t\t\t\t\tif (isUniqueFolder) {\n\t\t\t\t\t\tconst relPath = relativePath(owningFolder.uri, resource); // always uses forward slashes\n\t\t\t\t\t\tif (relPath === '') {\n\t\t\t\t\t\t\tfolderPath = `./${owningFolder.name}`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfolderPath = `./${owningFolder.name}/${relPath}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfolderPath = resource.fsPath; // TODO rob: handle non-file URIs\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (folderPath) {\n\t\t\t\tfolderPaths.push(escapeGlobPattern(folderPath));\n\t\t\t}\n\t\t});\n\t}\n\treturn folderPaths;\n}\n"]}