{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/search/test/node/fileSearch.integrationTest.ts","vs/workbench/services/search/test/node/fileSearch.integrationTest.ts"],"names":[],"mappings":"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","file":"fileSearch.integrationTest.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { FileAccess } from '../../../../../base/common/network.js';\nimport * as path from '../../../../../base/common/path.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { flakySuite } from '../../../../../base/test/node/testUtils.js';\nimport { IFileQuery, IFolderQuery, ISerializedSearchProgressItem, isProgressMessage, QueryType } from '../../common/search.js';\nimport { SearchService } from '../../node/rawSearchService.js';\n\nconst TEST_FIXTURES = path.normalize(FileAccess.asFileUri('vs/workbench/services/search/test/node/fixtures').fsPath);\nconst TEST_FIXTURES2 = path.normalize(FileAccess.asFileUri('vs/workbench/services/search/test/node/fixtures2').fsPath);\nconst EXAMPLES_FIXTURES = path.join(TEST_FIXTURES, 'examples');\nconst MORE_FIXTURES = path.join(TEST_FIXTURES, 'more');\nconst TEST_ROOT_FOLDER: IFolderQuery = { folder: URI.file(TEST_FIXTURES) };\nconst ROOT_FOLDER_QUERY: IFolderQuery[] = [\n\tTEST_ROOT_FOLDER\n];\n\nconst MULTIROOT_QUERIES: IFolderQuery[] = [\n\t{ folder: URI.file(EXAMPLES_FIXTURES), folderName: 'examples_folder' },\n\t{ folder: URI.file(MORE_FIXTURES) }\n];\n\nconst numThreads = undefined;\n\nasync function doSearchTest(query: IFileQuery, expectedResultCount: number | Function): Promise<void> {\n\tconst svc = new SearchService();\n\n\tconst results: ISerializedSearchProgressItem[] = [];\n\tawait svc.doFileSearch(query, numThreads, e => {\n\t\tif (!isProgressMessage(e)) {\n\t\t\tif (Array.isArray(e)) {\n\t\t\t\tresults.push(...e);\n\t\t\t} else {\n\t\t\t\tresults.push(e);\n\t\t\t}\n\t\t}\n\t});\n\n\tassert.strictEqual(results.length, expectedResultCount, `rg ${results.length} !== ${expectedResultCount}`);\n}\n\nflakySuite('FileSearch-integration', function () {\n\n\ttest('File - simple', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY\n\t\t};\n\n\t\treturn doSearchTest(config, 14);\n\t});\n\n\ttest('File - filepattern', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY,\n\t\t\tfilePattern: 'anotherfile'\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n\n\ttest('File - exclude', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY,\n\t\t\tfilePattern: 'file',\n\t\t\texcludePattern: { '**/anotherfolder/**': true }\n\t\t};\n\n\t\treturn doSearchTest(config, 2);\n\t});\n\n\ttest('File - multiroot', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: MULTIROOT_QUERIES,\n\t\t\tfilePattern: 'file',\n\t\t\texcludePattern: { '**/anotherfolder/**': true }\n\t\t};\n\n\t\treturn doSearchTest(config, 2);\n\t});\n\n\ttest('File - multiroot with folder name', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: MULTIROOT_QUERIES,\n\t\t\tfilePattern: 'examples_folder anotherfile'\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n\n\ttest('File - multiroot with folder name and sibling exclude', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: [\n\t\t\t\t{ folder: URI.file(TEST_FIXTURES), folderName: 'folder1' },\n\t\t\t\t{ folder: URI.file(TEST_FIXTURES2) }\n\t\t\t],\n\t\t\tfilePattern: 'folder1 site',\n\t\t\texcludePattern: { '*.css': { when: '$(basename).less' } }\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { FileAccess } from '../../../../../base/common/network.js';\nimport * as path from '../../../../../base/common/path.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { flakySuite } from '../../../../../base/test/node/testUtils.js';\nimport { IFileQuery, IFolderQuery, ISerializedSearchProgressItem, isProgressMessage, QueryType } from '../../common/search.js';\nimport { SearchService } from '../../node/rawSearchService.js';\n\nconst TEST_FIXTURES = path.normalize(FileAccess.asFileUri('vs/workbench/services/search/test/node/fixtures').fsPath);\nconst TEST_FIXTURES2 = path.normalize(FileAccess.asFileUri('vs/workbench/services/search/test/node/fixtures2').fsPath);\nconst EXAMPLES_FIXTURES = path.join(TEST_FIXTURES, 'examples');\nconst MORE_FIXTURES = path.join(TEST_FIXTURES, 'more');\nconst TEST_ROOT_FOLDER: IFolderQuery = { folder: URI.file(TEST_FIXTURES) };\nconst ROOT_FOLDER_QUERY: IFolderQuery[] = [\n\tTEST_ROOT_FOLDER\n];\n\nconst MULTIROOT_QUERIES: IFolderQuery[] = [\n\t{ folder: URI.file(EXAMPLES_FIXTURES), folderName: 'examples_folder' },\n\t{ folder: URI.file(MORE_FIXTURES) }\n];\n\nconst numThreads = undefined;\n\nasync function doSearchTest(query: IFileQuery, expectedResultCount: number | Function): Promise<void> {\n\tconst svc = new SearchService();\n\n\tconst results: ISerializedSearchProgressItem[] = [];\n\tawait svc.doFileSearch(query, numThreads, e => {\n\t\tif (!isProgressMessage(e)) {\n\t\t\tif (Array.isArray(e)) {\n\t\t\t\tresults.push(...e);\n\t\t\t} else {\n\t\t\t\tresults.push(e);\n\t\t\t}\n\t\t}\n\t});\n\n\tassert.strictEqual(results.length, expectedResultCount, `rg ${results.length} !== ${expectedResultCount}`);\n}\n\nflakySuite('FileSearch-integration', function () {\n\n\ttest('File - simple', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY\n\t\t};\n\n\t\treturn doSearchTest(config, 14);\n\t});\n\n\ttest('File - filepattern', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY,\n\t\t\tfilePattern: 'anotherfile'\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n\n\ttest('File - exclude', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: ROOT_FOLDER_QUERY,\n\t\t\tfilePattern: 'file',\n\t\t\texcludePattern: { '**/anotherfolder/**': true }\n\t\t};\n\n\t\treturn doSearchTest(config, 2);\n\t});\n\n\ttest('File - multiroot', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: MULTIROOT_QUERIES,\n\t\t\tfilePattern: 'file',\n\t\t\texcludePattern: { '**/anotherfolder/**': true }\n\t\t};\n\n\t\treturn doSearchTest(config, 2);\n\t});\n\n\ttest('File - multiroot with folder name', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: MULTIROOT_QUERIES,\n\t\t\tfilePattern: 'examples_folder anotherfile'\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n\n\ttest('File - multiroot with folder name and sibling exclude', () => {\n\t\tconst config: IFileQuery = {\n\t\t\ttype: QueryType.File,\n\t\t\tfolderQueries: [\n\t\t\t\t{ folder: URI.file(TEST_FIXTURES), folderName: 'folder1' },\n\t\t\t\t{ folder: URI.file(TEST_FIXTURES2) }\n\t\t\t],\n\t\t\tfilePattern: 'folder1 site',\n\t\t\texcludePattern: { '*.css': { when: '$(basename).less' } }\n\t\t};\n\n\t\treturn doSearchTest(config, 1);\n\t});\n});\n"]}