{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/untitled/common/untitledTextEditorHandler.ts","vs/workbench/services/untitled/common/untitledTextEditorHandler.ts"],"names":[],"mappings":"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","file":"untitledTextEditorHandler.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../../base/common/network.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IEditorSerializer } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { ITextEditorService } from '../../textfile/common/textEditorService.js';\nimport { isEqual, toLocalResource } from '../../../../base/common/resources.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../editor/common/languages/modesRegistry.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { IFilesConfigurationService } from '../../filesConfiguration/common/filesConfigurationService.js';\nimport { IPathService } from '../../path/common/pathService.js';\nimport { UntitledTextEditorInput } from './untitledTextEditorInput.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IWorkingCopyIdentifier, NO_TYPE_ID } from '../../workingCopy/common/workingCopy.js';\nimport { IWorkingCopyEditorHandler, IWorkingCopyEditorService } from '../../workingCopy/common/workingCopyEditorService.js';\nimport { IUntitledTextEditorService } from './untitledTextEditorService.js';\n\ninterface ISerializedUntitledTextEditorInput {\n\treadonly resourceJSON: UriComponents;\n\treadonly modeId: string | undefined; // should be `languageId` but is kept for backwards compatibility\n\treadonly encoding: string | undefined;\n}\n\nexport class UntitledTextEditorInputSerializer implements IEditorSerializer {\n\n\tconstructor(\n\t\t@IFilesConfigurationService private readonly filesConfigurationService: IFilesConfigurationService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IPathService private readonly pathService: IPathService\n\t) { }\n\n\tcanSerialize(editorInput: EditorInput): boolean {\n\t\treturn this.filesConfigurationService.isHotExitEnabled && !editorInput.isDisposed();\n\t}\n\n\tserialize(editorInput: EditorInput): string | undefined {\n\t\tif (!this.canSerialize(editorInput)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst untitledTextEditorInput = editorInput as UntitledTextEditorInput;\n\n\t\tlet resource = untitledTextEditorInput.resource;\n\t\tif (untitledTextEditorInput.hasAssociatedFilePath) {\n\t\t\tresource = toLocalResource(resource, this.environmentService.remoteAuthority, this.pathService.defaultUriScheme); // untitled with associated file path use the local schema\n\t\t}\n\n\t\t// Language: only remember language if it is either specific (not text)\n\t\t// or if the language was explicitly set by the user. We want to preserve\n\t\t// this information across restarts and not set the language unless\n\t\t// this is the case.\n\t\tlet languageId: string | undefined;\n\t\tconst languageIdCandidate = untitledTextEditorInput.getLanguageId();\n\t\tif (languageIdCandidate !== PLAINTEXT_LANGUAGE_ID) {\n\t\t\tlanguageId = languageIdCandidate;\n\t\t} else if (untitledTextEditorInput.hasLanguageSetExplicitly) {\n\t\t\tlanguageId = languageIdCandidate;\n\t\t}\n\n\t\tconst serialized: ISerializedUntitledTextEditorInput = {\n\t\t\tresourceJSON: resource.toJSON(),\n\t\t\tmodeId: languageId,\n\t\t\tencoding: untitledTextEditorInput.getEncoding()\n\t\t};\n\n\t\treturn JSON.stringify(serialized);\n\t}\n\n\tdeserialize(instantiationService: IInstantiationService, serializedEditorInput: string): UntitledTextEditorInput {\n\t\treturn instantiationService.invokeFunction(accessor => {\n\t\t\tconst deserialized: ISerializedUntitledTextEditorInput = JSON.parse(serializedEditorInput);\n\t\t\tconst resource = URI.revive(deserialized.resourceJSON);\n\t\t\tconst languageId = deserialized.modeId;\n\t\t\tconst encoding = deserialized.encoding;\n\n\t\t\treturn accessor.get(ITextEditorService).createTextEditor({ resource, languageId, encoding, forceUntitled: true }) as UntitledTextEditorInput;\n\t\t});\n\t}\n}\n\nexport class UntitledTextEditorWorkingCopyEditorHandler extends Disposable implements IWorkbenchContribution, IWorkingCopyEditorHandler {\n\n\tstatic readonly ID = 'workbench.contrib.untitledTextEditorWorkingCopyEditorHandler';\n\n\tconstructor(\n\t\t@IWorkingCopyEditorService workingCopyEditorService: IWorkingCopyEditorService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IPathService private readonly pathService: IPathService,\n\t\t@ITextEditorService private readonly textEditorService: ITextEditorService,\n\t\t@IUntitledTextEditorService private readonly untitledTextEditorService: IUntitledTextEditorService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(workingCopyEditorService.registerHandler(this));\n\t}\n\n\thandles(workingCopy: IWorkingCopyIdentifier): boolean {\n\t\treturn workingCopy.resource.scheme === Schemas.untitled && workingCopy.typeId === NO_TYPE_ID;\n\t}\n\n\tisOpen(workingCopy: IWorkingCopyIdentifier, editor: EditorInput): boolean {\n\t\tif (!this.handles(workingCopy)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn editor instanceof UntitledTextEditorInput && isEqual(workingCopy.resource, editor.resource);\n\t}\n\n\tcreateEditor(workingCopy: IWorkingCopyIdentifier): EditorInput {\n\t\tlet editorInputResource: URI;\n\n\t\t// If the untitled has an associated resource,\n\t\t// ensure to restore the local resource it had\n\t\tif (this.untitledTextEditorService.isUntitledWithAssociatedResource(workingCopy.resource)) {\n\t\t\teditorInputResource = toLocalResource(workingCopy.resource, this.environmentService.remoteAuthority, this.pathService.defaultUriScheme);\n\t\t} else {\n\t\t\teditorInputResource = workingCopy.resource;\n\t\t}\n\n\t\treturn this.textEditorService.createTextEditor({ resource: editorInputResource, forceUntitled: true });\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from '../../../../base/common/network.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { URI, UriComponents } from '../../../../base/common/uri.js';\nimport { IEditorSerializer } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { ITextEditorService } from '../../textfile/common/textEditorService.js';\nimport { isEqual, toLocalResource } from '../../../../base/common/resources.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../editor/common/languages/modesRegistry.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { IFilesConfigurationService } from '../../filesConfiguration/common/filesConfigurationService.js';\nimport { IPathService } from '../../path/common/pathService.js';\nimport { UntitledTextEditorInput } from './untitledTextEditorInput.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IWorkingCopyIdentifier, NO_TYPE_ID } from '../../workingCopy/common/workingCopy.js';\nimport { IWorkingCopyEditorHandler, IWorkingCopyEditorService } from '../../workingCopy/common/workingCopyEditorService.js';\nimport { IUntitledTextEditorService } from './untitledTextEditorService.js';\n\ninterface ISerializedUntitledTextEditorInput {\n\treadonly resourceJSON: UriComponents;\n\treadonly modeId: string | undefined; // should be `languageId` but is kept for backwards compatibility\n\treadonly encoding: string | undefined;\n}\n\nexport class UntitledTextEditorInputSerializer implements IEditorSerializer {\n\n\tconstructor(\n\t\t@IFilesConfigurationService private readonly filesConfigurationService: IFilesConfigurationService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IPathService private readonly pathService: IPathService\n\t) { }\n\n\tcanSerialize(editorInput: EditorInput): boolean {\n\t\treturn this.filesConfigurationService.isHotExitEnabled && !editorInput.isDisposed();\n\t}\n\n\tserialize(editorInput: EditorInput): string | undefined {\n\t\tif (!this.canSerialize(editorInput)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst untitledTextEditorInput = editorInput as UntitledTextEditorInput;\n\n\t\tlet resource = untitledTextEditorInput.resource;\n\t\tif (untitledTextEditorInput.hasAssociatedFilePath) {\n\t\t\tresource = toLocalResource(resource, this.environmentService.remoteAuthority, this.pathService.defaultUriScheme); // untitled with associated file path use the local schema\n\t\t}\n\n\t\t// Language: only remember language if it is either specific (not text)\n\t\t// or if the language was explicitly set by the user. We want to preserve\n\t\t// this information across restarts and not set the language unless\n\t\t// this is the case.\n\t\tlet languageId: string | undefined;\n\t\tconst languageIdCandidate = untitledTextEditorInput.getLanguageId();\n\t\tif (languageIdCandidate !== PLAINTEXT_LANGUAGE_ID) {\n\t\t\tlanguageId = languageIdCandidate;\n\t\t} else if (untitledTextEditorInput.hasLanguageSetExplicitly) {\n\t\t\tlanguageId = languageIdCandidate;\n\t\t}\n\n\t\tconst serialized: ISerializedUntitledTextEditorInput = {\n\t\t\tresourceJSON: resource.toJSON(),\n\t\t\tmodeId: languageId,\n\t\t\tencoding: untitledTextEditorInput.getEncoding()\n\t\t};\n\n\t\treturn JSON.stringify(serialized);\n\t}\n\n\tdeserialize(instantiationService: IInstantiationService, serializedEditorInput: string): UntitledTextEditorInput {\n\t\treturn instantiationService.invokeFunction(accessor => {\n\t\t\tconst deserialized: ISerializedUntitledTextEditorInput = JSON.parse(serializedEditorInput);\n\t\t\tconst resource = URI.revive(deserialized.resourceJSON);\n\t\t\tconst languageId = deserialized.modeId;\n\t\t\tconst encoding = deserialized.encoding;\n\n\t\t\treturn accessor.get(ITextEditorService).createTextEditor({ resource, languageId, encoding, forceUntitled: true }) as UntitledTextEditorInput;\n\t\t});\n\t}\n}\n\nexport class UntitledTextEditorWorkingCopyEditorHandler extends Disposable implements IWorkbenchContribution, IWorkingCopyEditorHandler {\n\n\tstatic readonly ID = 'workbench.contrib.untitledTextEditorWorkingCopyEditorHandler';\n\n\tconstructor(\n\t\t@IWorkingCopyEditorService workingCopyEditorService: IWorkingCopyEditorService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IPathService private readonly pathService: IPathService,\n\t\t@ITextEditorService private readonly textEditorService: ITextEditorService,\n\t\t@IUntitledTextEditorService private readonly untitledTextEditorService: IUntitledTextEditorService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(workingCopyEditorService.registerHandler(this));\n\t}\n\n\thandles(workingCopy: IWorkingCopyIdentifier): boolean {\n\t\treturn workingCopy.resource.scheme === Schemas.untitled && workingCopy.typeId === NO_TYPE_ID;\n\t}\n\n\tisOpen(workingCopy: IWorkingCopyIdentifier, editor: EditorInput): boolean {\n\t\tif (!this.handles(workingCopy)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn editor instanceof UntitledTextEditorInput && isEqual(workingCopy.resource, editor.resource);\n\t}\n\n\tcreateEditor(workingCopy: IWorkingCopyIdentifier): EditorInput {\n\t\tlet editorInputResource: URI;\n\n\t\t// If the untitled has an associated resource,\n\t\t// ensure to restore the local resource it had\n\t\tif (this.untitledTextEditorService.isUntitledWithAssociatedResource(workingCopy.resource)) {\n\t\t\teditorInputResource = toLocalResource(workingCopy.resource, this.environmentService.remoteAuthority, this.pathService.defaultUriScheme);\n\t\t} else {\n\t\t\teditorInputResource = workingCopy.resource;\n\t\t}\n\n\t\treturn this.textEditorService.createTextEditor({ resource: editorInputResource, forceUntitled: true });\n\t}\n}\n"]}