{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/keybinding/electron-browser/nativeKeyboardLayout.ts","vs/workbench/services/keybinding/electron-browser/nativeKeyboardLayout.ts"],"names":[],"mappings":"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","file":"nativeKeyboardLayout.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IKeyboardLayoutInfo, IKeyboardLayoutService, IKeyboardMapping, ILinuxKeyboardLayoutInfo, IMacKeyboardLayoutInfo, IMacLinuxKeyboardMapping, IWindowsKeyboardLayoutInfo, IWindowsKeyboardMapping } from '../../../../platform/keyboardLayout/common/keyboardLayout.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { OperatingSystem, OS } from '../../../../base/common/platform.js';\nimport { CachedKeyboardMapper, IKeyboardMapper } from '../../../../platform/keyboardLayout/common/keyboardMapper.js';\nimport { WindowsKeyboardMapper } from '../common/windowsKeyboardMapper.js';\nimport { FallbackKeyboardMapper } from '../common/fallbackKeyboardMapper.js';\nimport { MacLinuxKeyboardMapper } from '../common/macLinuxKeyboardMapper.js';\nimport { DispatchConfig, readKeyboardConfig } from '../../../../platform/keyboardLayout/common/keyboardConfig.js';\nimport { IKeyboardEvent } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { INativeKeyboardLayoutService } from './nativeKeyboardLayoutService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\n\nexport class KeyboardLayoutService extends Disposable implements IKeyboardLayoutService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeKeyboardLayout = this._register(new Emitter<void>());\n\treadonly onDidChangeKeyboardLayout = this._onDidChangeKeyboardLayout.event;\n\n\tprivate _keyboardMapper: IKeyboardMapper | null;\n\n\tconstructor(\n\t\t@INativeKeyboardLayoutService private readonly _nativeKeyboardLayoutService: INativeKeyboardLayoutService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t\tthis._keyboardMapper = null;\n\n\t\tthis._register(this._nativeKeyboardLayoutService.onDidChangeKeyboardLayout(async () => {\n\t\t\tthis._keyboardMapper = null;\n\t\t\tthis._onDidChangeKeyboardLayout.fire();\n\t\t}));\n\n\t\tthis._register(_configurationService.onDidChangeConfiguration(async (e) => {\n\t\t\tif (e.affectsConfiguration('keyboard')) {\n\t\t\t\tthis._keyboardMapper = null;\n\t\t\t\tthis._onDidChangeKeyboardLayout.fire();\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic getRawKeyboardMapping(): IKeyboardMapping | null {\n\t\treturn this._nativeKeyboardLayoutService.getRawKeyboardMapping();\n\t}\n\n\tpublic getCurrentKeyboardLayout(): IKeyboardLayoutInfo | null {\n\t\treturn this._nativeKeyboardLayoutService.getCurrentKeyboardLayout();\n\t}\n\n\tpublic getAllKeyboardLayouts(): IKeyboardLayoutInfo[] {\n\t\treturn [];\n\t}\n\n\tpublic getKeyboardMapper(): IKeyboardMapper {\n\t\tconst config = readKeyboardConfig(this._configurationService);\n\t\tif (config.dispatch === DispatchConfig.KeyCode) {\n\t\t\t// Forcefully set to use keyCode\n\t\t\treturn new FallbackKeyboardMapper(config.mapAltGrToCtrlAlt, OS);\n\t\t}\n\t\tif (!this._keyboardMapper) {\n\t\t\tthis._keyboardMapper = new CachedKeyboardMapper(createKeyboardMapper(this.getCurrentKeyboardLayout(), this.getRawKeyboardMapping(), config.mapAltGrToCtrlAlt));\n\t\t}\n\t\treturn this._keyboardMapper;\n\t}\n\n\tpublic validateCurrentKeyboardMapping(keyboardEvent: IKeyboardEvent): void {\n\t\treturn;\n\t}\n}\n\nfunction createKeyboardMapper(layoutInfo: IKeyboardLayoutInfo | null, rawMapping: IKeyboardMapping | null, mapAltGrToCtrlAlt: boolean): IKeyboardMapper {\n\tconst _isUSStandard = isUSStandard(layoutInfo);\n\tif (OS === OperatingSystem.Windows) {\n\t\treturn new WindowsKeyboardMapper(_isUSStandard, <IWindowsKeyboardMapping>rawMapping, mapAltGrToCtrlAlt);\n\t}\n\n\tif (!rawMapping || Object.keys(rawMapping).length === 0) {\n\t\t// Looks like reading the mappings failed (most likely Mac + Japanese/Chinese keyboard layouts)\n\t\treturn new FallbackKeyboardMapper(mapAltGrToCtrlAlt, OS);\n\t}\n\n\tif (OS === OperatingSystem.Macintosh) {\n\t\tconst kbInfo = <IMacKeyboardLayoutInfo>layoutInfo;\n\t\tif (kbInfo.id === 'com.apple.keylayout.DVORAK-QWERTYCMD') {\n\t\t\t// Use keyCode based dispatching for DVORAK - QWERTY ⌘\n\t\t\treturn new FallbackKeyboardMapper(mapAltGrToCtrlAlt, OS);\n\t\t}\n\t}\n\n\treturn new MacLinuxKeyboardMapper(_isUSStandard, <IMacLinuxKeyboardMapping>rawMapping, mapAltGrToCtrlAlt, OS);\n}\n\nfunction isUSStandard(_kbInfo: IKeyboardLayoutInfo | null): boolean {\n\tif (!_kbInfo) {\n\t\treturn false;\n\t}\n\n\tif (OS === OperatingSystem.Linux) {\n\t\tconst kbInfo = <ILinuxKeyboardLayoutInfo>_kbInfo;\n\t\tconst layouts = kbInfo.layout.split(/,/g);\n\t\treturn (layouts[kbInfo.group] === 'us');\n\t}\n\n\tif (OS === OperatingSystem.Macintosh) {\n\t\tconst kbInfo = <IMacKeyboardLayoutInfo>_kbInfo;\n\t\treturn (kbInfo.id === 'com.apple.keylayout.US');\n\t}\n\n\tif (OS === OperatingSystem.Windows) {\n\t\tconst kbInfo = <IWindowsKeyboardLayoutInfo>_kbInfo;\n\t\treturn (kbInfo.name === '00000409');\n\t}\n\n\treturn false;\n}\n\nregisterSingleton(IKeyboardLayoutService, KeyboardLayoutService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IKeyboardLayoutInfo, IKeyboardLayoutService, IKeyboardMapping, ILinuxKeyboardLayoutInfo, IMacKeyboardLayoutInfo, IMacLinuxKeyboardMapping, IWindowsKeyboardLayoutInfo, IWindowsKeyboardMapping } from '../../../../platform/keyboardLayout/common/keyboardLayout.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { OperatingSystem, OS } from '../../../../base/common/platform.js';\nimport { CachedKeyboardMapper, IKeyboardMapper } from '../../../../platform/keyboardLayout/common/keyboardMapper.js';\nimport { WindowsKeyboardMapper } from '../common/windowsKeyboardMapper.js';\nimport { FallbackKeyboardMapper } from '../common/fallbackKeyboardMapper.js';\nimport { MacLinuxKeyboardMapper } from '../common/macLinuxKeyboardMapper.js';\nimport { DispatchConfig, readKeyboardConfig } from '../../../../platform/keyboardLayout/common/keyboardConfig.js';\nimport { IKeyboardEvent } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { INativeKeyboardLayoutService } from './nativeKeyboardLayoutService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\n\nexport class KeyboardLayoutService extends Disposable implements IKeyboardLayoutService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeKeyboardLayout = this._register(new Emitter<void>());\n\treadonly onDidChangeKeyboardLayout = this._onDidChangeKeyboardLayout.event;\n\n\tprivate _keyboardMapper: IKeyboardMapper | null;\n\n\tconstructor(\n\t\t@INativeKeyboardLayoutService private readonly _nativeKeyboardLayoutService: INativeKeyboardLayoutService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t\tthis._keyboardMapper = null;\n\n\t\tthis._register(this._nativeKeyboardLayoutService.onDidChangeKeyboardLayout(async () => {\n\t\t\tthis._keyboardMapper = null;\n\t\t\tthis._onDidChangeKeyboardLayout.fire();\n\t\t}));\n\n\t\tthis._register(_configurationService.onDidChangeConfiguration(async (e) => {\n\t\t\tif (e.affectsConfiguration('keyboard')) {\n\t\t\t\tthis._keyboardMapper = null;\n\t\t\t\tthis._onDidChangeKeyboardLayout.fire();\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic getRawKeyboardMapping(): IKeyboardMapping | null {\n\t\treturn this._nativeKeyboardLayoutService.getRawKeyboardMapping();\n\t}\n\n\tpublic getCurrentKeyboardLayout(): IKeyboardLayoutInfo | null {\n\t\treturn this._nativeKeyboardLayoutService.getCurrentKeyboardLayout();\n\t}\n\n\tpublic getAllKeyboardLayouts(): IKeyboardLayoutInfo[] {\n\t\treturn [];\n\t}\n\n\tpublic getKeyboardMapper(): IKeyboardMapper {\n\t\tconst config = readKeyboardConfig(this._configurationService);\n\t\tif (config.dispatch === DispatchConfig.KeyCode) {\n\t\t\t// Forcefully set to use keyCode\n\t\t\treturn new FallbackKeyboardMapper(config.mapAltGrToCtrlAlt, OS);\n\t\t}\n\t\tif (!this._keyboardMapper) {\n\t\t\tthis._keyboardMapper = new CachedKeyboardMapper(createKeyboardMapper(this.getCurrentKeyboardLayout(), this.getRawKeyboardMapping(), config.mapAltGrToCtrlAlt));\n\t\t}\n\t\treturn this._keyboardMapper;\n\t}\n\n\tpublic validateCurrentKeyboardMapping(keyboardEvent: IKeyboardEvent): void {\n\t\treturn;\n\t}\n}\n\nfunction createKeyboardMapper(layoutInfo: IKeyboardLayoutInfo | null, rawMapping: IKeyboardMapping | null, mapAltGrToCtrlAlt: boolean): IKeyboardMapper {\n\tconst _isUSStandard = isUSStandard(layoutInfo);\n\tif (OS === OperatingSystem.Windows) {\n\t\treturn new WindowsKeyboardMapper(_isUSStandard, <IWindowsKeyboardMapping>rawMapping, mapAltGrToCtrlAlt);\n\t}\n\n\tif (!rawMapping || Object.keys(rawMapping).length === 0) {\n\t\t// Looks like reading the mappings failed (most likely Mac + Japanese/Chinese keyboard layouts)\n\t\treturn new FallbackKeyboardMapper(mapAltGrToCtrlAlt, OS);\n\t}\n\n\tif (OS === OperatingSystem.Macintosh) {\n\t\tconst kbInfo = <IMacKeyboardLayoutInfo>layoutInfo;\n\t\tif (kbInfo.id === 'com.apple.keylayout.DVORAK-QWERTYCMD') {\n\t\t\t// Use keyCode based dispatching for DVORAK - QWERTY ⌘\n\t\t\treturn new FallbackKeyboardMapper(mapAltGrToCtrlAlt, OS);\n\t\t}\n\t}\n\n\treturn new MacLinuxKeyboardMapper(_isUSStandard, <IMacLinuxKeyboardMapping>rawMapping, mapAltGrToCtrlAlt, OS);\n}\n\nfunction isUSStandard(_kbInfo: IKeyboardLayoutInfo | null): boolean {\n\tif (!_kbInfo) {\n\t\treturn false;\n\t}\n\n\tif (OS === OperatingSystem.Linux) {\n\t\tconst kbInfo = <ILinuxKeyboardLayoutInfo>_kbInfo;\n\t\tconst layouts = kbInfo.layout.split(/,/g);\n\t\treturn (layouts[kbInfo.group] === 'us');\n\t}\n\n\tif (OS === OperatingSystem.Macintosh) {\n\t\tconst kbInfo = <IMacKeyboardLayoutInfo>_kbInfo;\n\t\treturn (kbInfo.id === 'com.apple.keylayout.US');\n\t}\n\n\tif (OS === OperatingSystem.Windows) {\n\t\tconst kbInfo = <IWindowsKeyboardLayoutInfo>_kbInfo;\n\t\treturn (kbInfo.name === '00000409');\n\t}\n\n\treturn false;\n}\n\nregisterSingleton(IKeyboardLayoutService, KeyboardLayoutService, InstantiationType.Delayed);\n"]}