{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/userActivity/test/common/userActivityService.test.ts","vs/workbench/services/userActivity/test/common/userActivityService.test.ts"],"names":[],"mappings":"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","file":"userActivityService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n\nimport * as assert from 'assert';\nimport * as sinon from 'sinon';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IMarkActiveOptions, IUserActivityService, UserActivityService } from '../../common/userActivityService.js';\n\nconst MARK_INACTIVE_DEBOUNCE = 10_000;\n\nsuite('UserActivityService', () => {\n\tlet userActivityService: IUserActivityService;\n\tlet clock: sinon.SinonFakeTimers;\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tclock = sinon.useFakeTimers();\n\t\tuserActivityService = ds.add(new UserActivityService(ds.add(new TestInstantiationService())));\n\t});\n\n\tteardown(() => {\n\t\tclock.restore();\n\t});\n\n\ttest('isActive should be true initially', () => {\n\t\tassert.ok(userActivityService.isActive);\n\t});\n\n\ttest('markActive should be inactive when all handles gone', () => {\n\t\tconst h1 = userActivityService.markActive();\n\t\tconst h2 = userActivityService.markActive();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th1.dispose();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th2.dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive sets active whenHeldFor', async () => {\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\n\t\tconst duration = 100; // milliseconds\n\t\tconst opts: IMarkActiveOptions = { whenHeldFor: duration };\n\t\tconst handle = userActivityService.markActive(opts);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(duration - 1);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(1);\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\thandle.dispose();\n\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive whenHeldFor before triggers', async () => {\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\n\t\tconst duration = 100; // milliseconds\n\t\tconst opts: IMarkActiveOptions = { whenHeldFor: duration };\n\t\tuserActivityService.markActive(opts).dispose();\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(duration + MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive with extendOnly only extends if already active', () => {\n\t\t// Make user inactive\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\n\t\t// Should not activate if inactive and extendOnly is true\n\t\tconst handle = userActivityService.markActive({ extendOnly: true });\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\thandle.dispose();\n\n\t\t// Activate normally\n\t\tconst h1 = userActivityService.markActive();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\n\t\t// Should extend activity if already active\n\t\tconst h2 = userActivityService.markActive({ extendOnly: true });\n\t\th1.dispose();\n\t\t// Still active because h2 is holding\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th2.dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n\nimport * as assert from 'assert';\nimport * as sinon from 'sinon';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { IMarkActiveOptions, IUserActivityService, UserActivityService } from '../../common/userActivityService.js';\n\nconst MARK_INACTIVE_DEBOUNCE = 10_000;\n\nsuite('UserActivityService', () => {\n\tlet userActivityService: IUserActivityService;\n\tlet clock: sinon.SinonFakeTimers;\n\n\tconst ds = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tsetup(() => {\n\t\tclock = sinon.useFakeTimers();\n\t\tuserActivityService = ds.add(new UserActivityService(ds.add(new TestInstantiationService())));\n\t});\n\n\tteardown(() => {\n\t\tclock.restore();\n\t});\n\n\ttest('isActive should be true initially', () => {\n\t\tassert.ok(userActivityService.isActive);\n\t});\n\n\ttest('markActive should be inactive when all handles gone', () => {\n\t\tconst h1 = userActivityService.markActive();\n\t\tconst h2 = userActivityService.markActive();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th1.dispose();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th2.dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive sets active whenHeldFor', async () => {\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\n\t\tconst duration = 100; // milliseconds\n\t\tconst opts: IMarkActiveOptions = { whenHeldFor: duration };\n\t\tconst handle = userActivityService.markActive(opts);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(duration - 1);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(1);\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\thandle.dispose();\n\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive whenHeldFor before triggers', async () => {\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\n\t\tconst duration = 100; // milliseconds\n\t\tconst opts: IMarkActiveOptions = { whenHeldFor: duration };\n\t\tuserActivityService.markActive(opts).dispose();\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\tclock.tick(duration + MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n\n\ttest('markActive with extendOnly only extends if already active', () => {\n\t\t// Make user inactive\n\t\tuserActivityService.markActive().dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\n\t\t// Should not activate if inactive and extendOnly is true\n\t\tconst handle = userActivityService.markActive({ extendOnly: true });\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t\thandle.dispose();\n\n\t\t// Activate normally\n\t\tconst h1 = userActivityService.markActive();\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\n\t\t// Should extend activity if already active\n\t\tconst h2 = userActivityService.markActive({ extendOnly: true });\n\t\th1.dispose();\n\t\t// Still active because h2 is holding\n\t\tassert.strictEqual(userActivityService.isActive, true);\n\t\th2.dispose();\n\t\tclock.tick(MARK_INACTIVE_DEBOUNCE);\n\t\tassert.strictEqual(userActivityService.isActive, false);\n\t});\n});\n"]}