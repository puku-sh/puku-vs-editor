{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/userActivity/common/userActivityService.ts","vs/workbench/services/userActivity/common/userActivityService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,iBAAiB,EAAE,MAAM,kCAAkC,CAAC;AAC1G,OAAO,EAAE,OAAO,EAAS,MAAM,kCAAkC,CAAC;AAClE,OAAO,EAAE,UAAU,EAAE,eAAe,EAAe,YAAY,EAAE,MAAM,sCAAsC,CAAC;AAC9G,OAAO,EAAqB,iBAAiB,EAAE,MAAM,yDAAyD,CAAC;AAC/G,OAAO,EAAE,qBAAqB,EAAE,eAAe,EAAE,MAAM,4DAA4D,CAAC;AACpH,OAAO,EAAE,oBAAoB,EAAE,MAAM,2BAA2B,CAAC;AAmCjE,MAAM,sBAAsB,GAAG,MAAM,CAAC;AAEtC,MAAM,CAAC,MAAM,oBAAoB,GAAG,eAAe,CAAuB,sBAAsB,CAAC,CAAC;AAE3F,IAAM,mBAAmB,GAAzB,MAAM,mBAAoB,SAAQ,UAAU;IAsBlD,YAAmC,oBAA2C;QAC7E,KAAK,EAAE,CAAC;QArBQ,iBAAY,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,gBAAgB,CAAC,GAAG,EAAE;YACxE,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;YACtB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChC,CAAC,EAAE,sBAAsB,CAAC,CAAC,CAAC;QAEX,kBAAa,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAgB,CAAC,CAAC;QAC9D,WAAM,GAAG,CAAC,CAAC;QAEnB;;;;;;WAMG;QACI,aAAQ,GAAG,IAAI,CAAC;QAEvB,kBAAkB;QACT,wBAAmB,GAAmB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;QAIvE,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,GAAG,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAAE,oBAAoB,CAAC,CAAC,CAAC,CAAC;IAChG,CAAC;IAED,kBAAkB;IAClB,UAAU,CAAC,IAAyB;QACnC,IAAI,IAAI,EAAE,UAAU,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;YACxC,OAAO,UAAU,CAAC,IAAI,CAAC;QACxB,CAAC;QAED,IAAI,IAAI,EAAE,WAAW,EAAE,CAAC;YACvB,MAAM,KAAK,GAAG,IAAI,eAAe,EAAE,CAAC;YACpC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;QACd,CAAC;QAED,IAAI,EAAE,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACzB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC9B,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC;QAC5B,CAAC;QAED,OAAO,YAAY,CAAC,GAAG,EAAE;YACxB,IAAI,EAAE,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;gBACzB,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9B,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;CACD,CAAA;AAnDY,mBAAmB;IAsBlB,WAAA,qBAAqB,CAAA;GAtBtB,mBAAmB,CAmD/B;;AAED,iBAAiB,CAAC,oBAAoB,EAAE,mBAAmB,oCAA4B,CAAC","file":"userActivityService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { disposableTimeout, RunOnceScheduler, runWhenGlobalIdle } from '../../../../base/common/async.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IInstantiationService, createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { userActivityRegistry } from './userActivityRegistry.js';\n\nexport interface IMarkActiveOptions {\n\twhenHeldFor?: number;\n\t/**\n\t * Only consider this progress if the state is already active. Used to avoid\n\t * background work from incorrectly marking the user as active (#237386)\n\t */\n\textendOnly?: boolean;\n}\n\n/**\n * Service that observes user activity in the window.\n */\nexport interface IUserActivityService {\n\t_serviceBrand: undefined;\n\n\t/**\n\t * Whether the user is currently active.\n\t */\n\treadonly isActive: boolean;\n\n\t/**\n\t * Fires when the activity state changes.\n\t */\n\treadonly onDidChangeIsActive: Event<boolean>;\n\n\t/**\n\t * Marks the user as being active until the Disposable is disposed of.\n\t * Multiple consumers call this method; the user will only be considered\n\t * inactive once all consumers have disposed of their Disposables.\n\t */\n\tmarkActive(opts?: IMarkActiveOptions): IDisposable;\n}\n\nconst MARK_INACTIVE_DEBOUNCE = 10_000;\n\nexport const IUserActivityService = createDecorator<IUserActivityService>('IUserActivityService');\n\nexport class UserActivityService extends Disposable implements IUserActivityService {\n\tdeclare readonly _serviceBrand: undefined;\n\tprivate readonly markInactive = this._register(new RunOnceScheduler(() => {\n\t\tthis.isActive = false;\n\t\tthis.changeEmitter.fire(false);\n\t}, MARK_INACTIVE_DEBOUNCE));\n\n\tprivate readonly changeEmitter = this._register(new Emitter<boolean>);\n\tprivate active = 0;\n\n\t/**\n\t * @inheritdoc\n\t *\n\t * Note: initialized to true, since the user just did something to open the\n\t * window. The bundled DomActivityTracker will initially assume activity\n\t * as well in order to unset this if the window gets abandoned.\n\t */\n\tpublic isActive = true;\n\n\t/** @inheritdoc */\n\treadonly onDidChangeIsActive: Event<boolean> = this.changeEmitter.event;\n\n\tconstructor(@IInstantiationService instantiationService: IInstantiationService) {\n\t\tsuper();\n\t\tthis._register(runWhenGlobalIdle(() => userActivityRegistry.take(this, instantiationService)));\n\t}\n\n\t/** @inheritdoc */\n\tmarkActive(opts?: IMarkActiveOptions): IDisposable {\n\t\tif (opts?.extendOnly && !this.isActive) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tif (opts?.whenHeldFor) {\n\t\t\tconst store = new DisposableStore();\n\t\t\tstore.add(disposableTimeout(() => store.add(this.markActive()), opts.whenHeldFor));\n\t\t\treturn store;\n\t\t}\n\n\t\tif (++this.active === 1) {\n\t\t\tthis.isActive = true;\n\t\t\tthis.changeEmitter.fire(true);\n\t\t\tthis.markInactive.cancel();\n\t\t}\n\n\t\treturn toDisposable(() => {\n\t\t\tif (--this.active === 0) {\n\t\t\t\tthis.markInactive.schedule();\n\t\t\t}\n\t\t});\n\t}\n}\n\nregisterSingleton(IUserActivityService, UserActivityService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { disposableTimeout, RunOnceScheduler, runWhenGlobalIdle } from '../../../../base/common/async.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IInstantiationService, createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { userActivityRegistry } from './userActivityRegistry.js';\n\nexport interface IMarkActiveOptions {\n\twhenHeldFor?: number;\n\t/**\n\t * Only consider this progress if the state is already active. Used to avoid\n\t * background work from incorrectly marking the user as active (#237386)\n\t */\n\textendOnly?: boolean;\n}\n\n/**\n * Service that observes user activity in the window.\n */\nexport interface IUserActivityService {\n\t_serviceBrand: undefined;\n\n\t/**\n\t * Whether the user is currently active.\n\t */\n\treadonly isActive: boolean;\n\n\t/**\n\t * Fires when the activity state changes.\n\t */\n\treadonly onDidChangeIsActive: Event<boolean>;\n\n\t/**\n\t * Marks the user as being active until the Disposable is disposed of.\n\t * Multiple consumers call this method; the user will only be considered\n\t * inactive once all consumers have disposed of their Disposables.\n\t */\n\tmarkActive(opts?: IMarkActiveOptions): IDisposable;\n}\n\nconst MARK_INACTIVE_DEBOUNCE = 10_000;\n\nexport const IUserActivityService = createDecorator<IUserActivityService>('IUserActivityService');\n\nexport class UserActivityService extends Disposable implements IUserActivityService {\n\tdeclare readonly _serviceBrand: undefined;\n\tprivate readonly markInactive = this._register(new RunOnceScheduler(() => {\n\t\tthis.isActive = false;\n\t\tthis.changeEmitter.fire(false);\n\t}, MARK_INACTIVE_DEBOUNCE));\n\n\tprivate readonly changeEmitter = this._register(new Emitter<boolean>);\n\tprivate active = 0;\n\n\t/**\n\t * @inheritdoc\n\t *\n\t * Note: initialized to true, since the user just did something to open the\n\t * window. The bundled DomActivityTracker will initially assume activity\n\t * as well in order to unset this if the window gets abandoned.\n\t */\n\tpublic isActive = true;\n\n\t/** @inheritdoc */\n\treadonly onDidChangeIsActive: Event<boolean> = this.changeEmitter.event;\n\n\tconstructor(@IInstantiationService instantiationService: IInstantiationService) {\n\t\tsuper();\n\t\tthis._register(runWhenGlobalIdle(() => userActivityRegistry.take(this, instantiationService)));\n\t}\n\n\t/** @inheritdoc */\n\tmarkActive(opts?: IMarkActiveOptions): IDisposable {\n\t\tif (opts?.extendOnly && !this.isActive) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tif (opts?.whenHeldFor) {\n\t\t\tconst store = new DisposableStore();\n\t\t\tstore.add(disposableTimeout(() => store.add(this.markActive()), opts.whenHeldFor));\n\t\t\treturn store;\n\t\t}\n\n\t\tif (++this.active === 1) {\n\t\t\tthis.isActive = true;\n\t\t\tthis.changeEmitter.fire(true);\n\t\t\tthis.markInactive.cancel();\n\t\t}\n\n\t\treturn toDisposable(() => {\n\t\t\tif (--this.active === 0) {\n\t\t\t\tthis.markInactive.schedule();\n\t\t\t}\n\t\t});\n\t}\n}\n\nregisterSingleton(IUserActivityService, UserActivityService, InstantiationType.Delayed);\n"]}