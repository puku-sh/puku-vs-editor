{"version":3,"sources":["vs/workbench/services/themes/common/iconExtensionPoint.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,KAAK,GAAG,MAAM,oBAAoB,CAAC;AAC1C,OAAO,EAAE,kBAAkB,EAAE,MAAM,+CAA+C,CAAC;AACnF,OAAO,EAAiB,UAAU,IAAI,sBAAsB,EAAE,MAAM,mDAAmD,CAAC;AACxH,OAAO,EAAE,QAAQ,EAAE,MAAM,kDAAkD,CAAC;AAC5E,OAAO,EAAE,SAAS,EAAE,MAAM,sCAAsC,CAAC;AACjE,OAAO,KAAK,SAAS,MAAM,sCAAsC,CAAC;AAElE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,iCAAiC,CAAC;AASjE,MAAM,YAAY,GAAkB,QAAQ,CAAC,EAAE,CAAgB,sBAAsB,CAAC,gBAAgB,CAAC,CAAC;AAExG,MAAM,mBAAmB,GAAG,YAAY,CAAC,sBAAsB,EAAE,CAAC;AAClE,MAAM,aAAa,GAAG,IAAI,SAAS,CAAC,eAAe,KAAK,SAAS,CAAC,eAAe,KAAK,CAAC;AAEvF,MAAM,yBAAyB,GAAG,kBAAkB,CAAC,sBAAsB,CAAsB;IAChG,cAAc,EAAE,OAAO;IACvB,UAAU,EAAE;QACX,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAmB,EAAE,IAA8C,CAAC;QAC9F,IAAI,EAAE,QAAQ;QACd,aAAa,EAAE;YACd,OAAO,EAAE,aAAa;YACtB,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAqB,EAAE,IAAqC,CAAC;YACvF,mBAAmB,EAAE,GAAG,CAAC,QAAQ,CAAC,KAA4B,EAAE,IAAyI,CAAC;SAC1M;QACD,oBAAoB,EAAE;YACrB,IAAI,EAAE,QAAQ;YACd,UAAU,EAAE;gBACX,WAAW,EAAE;oBACZ,IAAI,EAAE,QAAQ;oBACd,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAA8B,EAAE,IAAsC,CAAC;iBACjG;gBACD,OAAO,EAAE;oBACR,KAAK,EAAE;wBACN,mBAAmB;wBACnB;4BACC,IAAI,EAAE,QAAQ;4BACd,UAAU,EAAE;gCACX,QAAQ,EAAE;oCACT,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAmC,EAAE,IAAkD,CAAC;oCAClH,IAAI,EAAE,QAAQ;iCACd;gCACD,aAAa,EAAE;oCACd,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAAwC,EAAE,IAA8C,CAAC;oCACnH,IAAI,EAAE,QAAQ;iCACd;6BACD;4BACD,QAAQ,EAAE,CAAC,UAAU,EAAE,eAAe,CAAC;4BACvC,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,sBAAsB,EAAE,aAAa,EAAE,eAAe,EAAE,EAAE,CAAC;yBACjG;qBACD;oBACD,WAAW,EAAE,GAAG,CAAC,QAAQ,CAAC,KAA0B,EAAE,IAAkG,CAAC;iBACzJ;aACD;YACD,QAAQ,EAAE,CAAC,aAAa,EAAE,SAAS,CAAC;YACpC,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE,WAAW,EAAE,cAAc,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,sBAAsB,EAAE,aAAa,EAAE,eAAe,EAAE,EAAE,EAAE,CAAC;SAC3I;QACD,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE,iBAAiB,EAAE,EAAE,WAAW,EAAE,cAAc,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,sBAAsB,EAAE,aAAa,EAAE,eAAe,EAAE,EAAE,EAAE,EAAE,CAAC;KAClK;CACD,CAAC,CAAC;AAEH,MAAM,OAAO,kBAAkB;IAE9B;QACC,yBAAyB,CAAC,UAAU,CAAC,CAAC,UAAU,EAAE,KAAK,EAAE,EAAE;YAC1D,KAAK,MAAM,SAAS,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;gBACrC,MAAM,cAAc,GAAwB,SAAS,CAAC,KAAK,CAAC;gBAC5D,MAAM,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC;gBAEtC,IAAI,CAAC,cAAc,IAAI,OAAO,cAAc,KAAK,QAAQ,EAAE,CAAC;oBAC3D,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,KAA6B,EAAE,IAA4E,CAAC,CAAC,CAAC;oBAC3I,OAAO;gBACR,CAAC;gBAED,KAAK,MAAM,EAAE,IAAI,cAAc,EAAE,CAAC;oBACjC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,CAAC;wBAC9B,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAyB,EAAE,IAAmL,CAAC,CAAC,CAAC;wBAC9O,OAAO;oBACR,CAAC;oBACD,MAAM,gBAAgB,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;oBAC5C,IAAI,OAAO,gBAAgB,CAAC,WAAW,KAAK,QAAQ,IAAI,gBAAgB,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;wBACnG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,KAA2B,EAAE,IAAwE,CAAC,CAAC,CAAC;wBACrI,OAAO;oBACR,CAAC;oBACD,MAAM,WAAW,GAAG,gBAAgB,CAAC,OAAO,CAAC;oBAC7C,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE,CAAC;wBACrC,YAAY,CAAC,YAAY,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,gBAAgB,CAAC,WAAW,CAAC,CAAC;oBAClF,CAAC;yBAAM,IAAI,OAAO,WAAW,KAAK,QAAQ,IAAI,OAAO,WAAW,CAAC,QAAQ,KAAK,QAAQ,IAAI,OAAO,WAAW,CAAC,aAAa,KAAK,QAAQ,EAAE,CAAC;wBACzI,MAAM,OAAO,GAAG,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;wBAC3D,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,CAAC;wBAClC,IAAI,CAAC,MAAM,EAAE,CAAC;4BACb,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,KAA0C,EAAE,IAAyG,EAAE,OAAO,CAAC,CAAC,CAAC;4BAC7L,OAAO;wBACR,CAAC;wBACD,MAAM,iBAAiB,GAAG,SAAS,CAAC,WAAW,CAAC,iBAAiB,CAAC;wBAClE,MAAM,gBAAgB,GAAG,SAAS,CAAC,QAAQ,CAAC,iBAAiB,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;wBACrF,MAAM,MAAM,GAAG,SAAS,CAAC,SAAS,CAAC,WAAW,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC;wBACtE,MAAM,UAAU,GAAG,YAAY,CAAC,gBAAgB,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,QAAQ,EAAE,gBAAgB,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;wBAC5G,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,gBAAgB,EAAE,iBAAiB,CAAC,EAAE,CAAC;4BACrE,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAqC,EAAE,IAAqG,EAAE,gBAAgB,CAAC,IAAI,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC;4BAC1N,OAAO;wBACR,CAAC;wBACD,YAAY,CAAC,YAAY,CAAC,EAAE,EAAE;4BAC7B,aAAa,EAAE,WAAW,CAAC,aAAa;4BACxC,IAAI,EAAE;gCACL,EAAE,EAAE,MAAM;gCACV,UAAU;6BACV;yBACD,EAAE,gBAAgB,CAAC,WAAW,CAAC,CAAC;oBAClC,CAAC;yBAAM,CAAC;wBACP,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAuB,EAAE,IAAkL,CAAC,CAAC,CAAC;oBAC5O,CAAC;gBACF,CAAC;YACF,CAAC;YACD,KAAK,MAAM,SAAS,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;gBACvC,MAAM,cAAc,GAAwB,SAAS,CAAC,KAAK,CAAC;gBAC5D,KAAK,MAAM,EAAE,IAAI,cAAc,EAAE,CAAC;oBACjC,YAAY,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;gBACjC,CAAC;YACF,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;CACD;AAED,MAAM,SAAS,GAA2B;IACzC,KAAK,EAAE,UAAU;IACjB,MAAM,EAAE,MAAM;IACd,OAAO,EAAE,OAAO;CAChB,CAAC;AAEF,SAAS,SAAS,CAAC,WAAkC,EAAE,QAAgB;IACtE,OAAO,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC3D,CAAC","file":"iconExtensionPoint.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from '../../../../nls.js';\nimport { ExtensionsRegistry } from '../../extensions/common/extensionsRegistry.js';\nimport { IIconRegistry, Extensions as IconRegistryExtensions } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { IExtensionDescription } from '../../../../platform/extensions/common/extensions.js';\nimport { extname, posix } from '../../../../base/common/path.js';\n\ninterface IIconExtensionPoint {\n\t[id: string]: {\n\t\tdescription: string;\n\t\tdefault: { fontPath: string; fontCharacter: string } | string;\n\t};\n}\n\nconst iconRegistry: IIconRegistry = Registry.as<IIconRegistry>(IconRegistryExtensions.IconContribution);\n\nconst iconReferenceSchema = iconRegistry.getIconReferenceSchema();\nconst iconIdPattern = `^${ThemeIcon.iconNameSegment}(-${ThemeIcon.iconNameSegment})+$`;\n\nconst iconConfigurationExtPoint = ExtensionsRegistry.registerExtensionPoint<IIconExtensionPoint>({\n\textensionPoint: 'icons',\n\tjsonSchema: {\n\t\tdescription: nls.localize('contributes.icons', 'Contributes extension defined themable icons'),\n\t\ttype: 'object',\n\t\tpropertyNames: {\n\t\t\tpattern: iconIdPattern,\n\t\t\tdescription: nls.localize('contributes.icon.id', 'The identifier of the themable icon'),\n\t\t\tpatternErrorMessage: nls.localize('contributes.icon.id.format', 'Identifiers can only contain letters, digits and minuses and need to consist of at least two segments in the form `component-iconname`.'),\n\t\t},\n\t\tadditionalProperties: {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tdescription: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdescription: nls.localize('contributes.icon.description', 'The description of the themable icon'),\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\tanyOf: [\n\t\t\t\t\t\ticonReferenceSchema,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tfontPath: {\n\t\t\t\t\t\t\t\t\tdescription: nls.localize('contributes.icon.default.fontPath', 'The path of the icon font that defines the icon.'),\n\t\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfontCharacter: {\n\t\t\t\t\t\t\t\t\tdescription: nls.localize('contributes.icon.default.fontCharacter', 'The character for the icon in the icon font.'),\n\t\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\trequired: ['fontPath', 'fontCharacter'],\n\t\t\t\t\t\t\tdefaultSnippets: [{ body: { fontPath: '${1:myiconfont.woff}', fontCharacter: '${2:\\\\\\\\E001}' } }]\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tdescription: nls.localize('contributes.icon.default', 'The default of the icon. Either a reference to an existing ThemeIcon or an icon in an icon font.'),\n\t\t\t\t}\n\t\t\t},\n\t\t\trequired: ['description', 'default'],\n\t\t\tdefaultSnippets: [{ body: { description: '${1:my icon}', default: { fontPath: '${2:myiconfont.woff}', fontCharacter: '${3:\\\\\\\\E001}' } } }]\n\t\t},\n\t\tdefaultSnippets: [{ body: { '${1:my-icon-id}': { description: '${2:my icon}', default: { fontPath: '${3:myiconfont.woff}', fontCharacter: '${4:\\\\\\\\E001}' } } } }]\n\t}\n});\n\nexport class IconExtensionPoint {\n\n\tconstructor() {\n\t\ticonConfigurationExtPoint.setHandler((extensions, delta) => {\n\t\t\tfor (const extension of delta.added) {\n\t\t\t\tconst extensionValue = <IIconExtensionPoint>extension.value;\n\t\t\t\tconst collector = extension.collector;\n\n\t\t\t\tif (!extensionValue || typeof extensionValue !== 'object') {\n\t\t\t\t\tcollector.error(nls.localize('invalid.icons.configuration', \"'configuration.icons' must be an object with the icon names as properties.\"));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (const id in extensionValue) {\n\t\t\t\t\tif (!id.match(iconIdPattern)) {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.icons.id.format', \"'configuration.icons' keys represent the icon id and can only contain letter, digits and minuses. They need to consist of at least two segments in the form `component-iconname`.\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst iconContribution = extensionValue[id];\n\t\t\t\t\tif (typeof iconContribution.description !== 'string' || iconContribution.description.length === 0) {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.icons.description', \"'configuration.icons.description' must be defined and can not be empty\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst defaultIcon = iconContribution.default;\n\t\t\t\t\tif (typeof defaultIcon === 'string') {\n\t\t\t\t\t\ticonRegistry.registerIcon(id, { id: defaultIcon }, iconContribution.description);\n\t\t\t\t\t} else if (typeof defaultIcon === 'object' && typeof defaultIcon.fontPath === 'string' && typeof defaultIcon.fontCharacter === 'string') {\n\t\t\t\t\t\tconst fileExt = extname(defaultIcon.fontPath).substring(1);\n\t\t\t\t\t\tconst format = formatMap[fileExt];\n\t\t\t\t\t\tif (!format) {\n\t\t\t\t\t\t\tcollector.warn(nls.localize('invalid.icons.default.fontPath.extension', \"Expected `contributes.icons.default.fontPath` to have file extension 'woff', woff2' or 'ttf', is '{0}'.\", fileExt));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst extensionLocation = extension.description.extensionLocation;\n\t\t\t\t\t\tconst iconFontLocation = resources.joinPath(extensionLocation, defaultIcon.fontPath);\n\t\t\t\t\t\tconst fontId = getFontId(extension.description, defaultIcon.fontPath);\n\t\t\t\t\t\tconst definition = iconRegistry.registerIconFont(fontId, { src: [{ location: iconFontLocation, format }] });\n\t\t\t\t\t\tif (!resources.isEqualOrParent(iconFontLocation, extensionLocation)) {\n\t\t\t\t\t\t\tcollector.warn(nls.localize('invalid.icons.default.fontPath.path', \"Expected `contributes.icons.default.fontPath` ({0}) to be included inside extension's folder ({0}).\", iconFontLocation.path, extensionLocation.path));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticonRegistry.registerIcon(id, {\n\t\t\t\t\t\t\tfontCharacter: defaultIcon.fontCharacter,\n\t\t\t\t\t\t\tfont: {\n\t\t\t\t\t\t\t\tid: fontId,\n\t\t\t\t\t\t\t\tdefinition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, iconContribution.description);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcollector.error(nls.localize('invalid.icons.default', \"'configuration.icons.default' must be either a reference to the id of an other theme icon (string) or a icon definition (object) with properties `fontPath` and `fontCharacter`.\"));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const extension of delta.removed) {\n\t\t\t\tconst extensionValue = <IIconExtensionPoint>extension.value;\n\t\t\t\tfor (const id in extensionValue) {\n\t\t\t\t\ticonRegistry.deregisterIcon(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nconst formatMap: Record<string, string> = {\n\t'ttf': 'truetype',\n\t'woff': 'woff',\n\t'woff2': 'woff2'\n};\n\nfunction getFontId(description: IExtensionDescription, fontPath: string) {\n\treturn posix.join(description.identifier.value, fontPath);\n}\n"]}