{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/history/test/browser/historyService.test.ts","vs/workbench/services/history/test/browser/historyService.test.ts"],"names":[],"mappings":"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","file":"historyService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite, toResource } from '../../../../../base/test/common/utils.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { workbenchInstantiationService, TestFileEditorInput, registerTestEditor, createEditorPart, registerTestFileEditor, TestServiceAccessor, TestTextFileEditor, workbenchTeardown, registerTestSideBySideEditor } from '../../../../test/browser/workbenchTestServices.js';\nimport { EditorPart } from '../../../../browser/parts/editor/editorPart.js';\nimport { SyncDescriptor } from '../../../../../platform/instantiation/common/descriptors.js';\nimport { IEditorGroupsService, GroupDirection } from '../../../editor/common/editorGroupsService.js';\nimport { EditorNavigationStack, HistoryService } from '../../browser/historyService.js';\nimport { IEditorService, SIDE_GROUP } from '../../../editor/common/editorService.js';\nimport { EditorService } from '../../../editor/browser/editorService.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { GoFilter, GoScope, IHistoryService } from '../../common/history.js';\nimport { DeferredPromise, timeout } from '../../../../../base/common/async.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { EditorPaneSelectionChangeReason, isResourceEditorInput, IUntypedEditorInput } from '../../../../common/editor.js';\nimport { IResourceEditorInput, ITextEditorOptions } from '../../../../../platform/editor/common/editor.js';\nimport { EditorInput } from '../../../../common/editor/editorInput.js';\nimport { IResolvedTextFileEditorModel, ITextFileService } from '../../../textfile/common/textfiles.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { FileChangesEvent, FileChangeType, FileOperation, FileOperationEvent } from '../../../../../platform/files/common/files.js';\nimport { isLinux } from '../../../../../base/common/platform.js';\nimport { Selection } from '../../../../../editor/common/core/selection.js';\nimport { EditorPane } from '../../../../browser/parts/editor/editorPane.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { SideBySideEditorInput } from '../../../../common/editor/sideBySideEditorInput.js';\n\nsuite('HistoryService', function () {\n\n\tconst TEST_EDITOR_ID = 'MyTestEditorForEditorHistory';\n\tconst TEST_EDITOR_INPUT_ID = 'testEditorInputForHistoyService';\n\n\tasync function createServices(scope = GoScope.DEFAULT, configureSearchExclude = false): Promise<[EditorPart, HistoryService, EditorService, ITextFileService, IInstantiationService, TestConfigurationService]> {\n\t\tconst instantiationService = workbenchInstantiationService(undefined, disposables);\n\n\t\tconst part = await createEditorPart(instantiationService, disposables);\n\t\tinstantiationService.stub(IEditorGroupsService, part);\n\n\t\tconst editorService = disposables.add(instantiationService.createInstance(EditorService, undefined));\n\t\tinstantiationService.stub(IEditorService, editorService);\n\n\t\tconst configurationService = new TestConfigurationService();\n\t\tif (scope === GoScope.EDITOR_GROUP) {\n\t\t\tconfigurationService.setUserConfiguration('workbench.editor.navigationScope', 'editorGroup');\n\t\t} else if (scope === GoScope.EDITOR) {\n\t\t\tconfigurationService.setUserConfiguration('workbench.editor.navigationScope', 'editor');\n\t\t}\n\t\tif (configureSearchExclude) {\n\t\t\tconfigurationService.setUserConfiguration('search', { exclude: { '**/node_modules/**': true } });\n\t\t}\n\t\tinstantiationService.stub(IConfigurationService, configurationService);\n\n\t\tconst historyService = disposables.add(instantiationService.createInstance(HistoryService));\n\t\tinstantiationService.stub(IHistoryService, historyService);\n\n\t\tconst accessor = instantiationService.createInstance(TestServiceAccessor);\n\n\t\treturn [part, historyService, editorService, accessor.textFileService, instantiationService, configurationService];\n\t}\n\n\tconst disposables = new DisposableStore();\n\n\tsetup(() => {\n\t\tdisposables.add(registerTestEditor(TEST_EDITOR_ID, [new SyncDescriptor(TestFileEditorInput)]));\n\t\tdisposables.add(registerTestSideBySideEditor());\n\t\tdisposables.add(registerTestFileEditor());\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('back / forward: basics', async () => {\n\t\tconst [part, historyService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\t});\n\n\ttest('back / forward: is editor group aware', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource: URI = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource: URI = toResource.call(this, '/path/other.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource, options: { pinned: true } });\n\t\tconst pane2 = await editorService.openEditor({ resource, options: { pinned: true } }, SIDE_GROUP);\n\n\t\t// [index.txt] | [>index.txt<]\n\n\t\tassert.notStrictEqual(pane1, pane2);\n\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } }, pane2?.group);\n\n\t\t// [index.txt] | [index.txt] [>other.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [index.txt] | [>index.txt<] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goBack();\n\n\t\t// [>index.txt<] | [index.txt] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goForward();\n\n\t\t// [index.txt] | [>index.txt<] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goForward();\n\n\t\t// [index.txt] | [index.txt] [>other.html<]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), otherResource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (user)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(1, 2, 1, 2));\n\t\tawait setTextSelection(historyService, pane, new Selection(15, 1, 15, 1)); // will be merged and dropped\n\t\tawait setTextSelection(historyService, pane, new Selection(16, 1, 16, 1)); // will be merged and dropped\n\t\tawait setTextSelection(historyService, pane, new Selection(17, 1, 17, 1));\n\t\tawait setTextSelection(historyService, pane, new Selection(30, 5, 30, 8));\n\t\tawait setTextSelection(historyService, pane, new Selection(40, 1, 40, 1));\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(30, 5, 30, 8), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(17, 1, 17, 1), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(1, 2, 1, 2), pane);\n\n\t\tawait historyService.goForward(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(17, 1, 17, 1), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (navigation)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10)); // this is our starting point\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.NAVIGATION); // this is our first target definition\n\t\tawait setTextSelection(historyService, pane, new Selection(120, 8, 120, 18), EditorPaneSelectionChangeReason.NAVIGATION); // this is our second target definition\n\t\tawait setTextSelection(historyService, pane, new Selection(300, 3, 300, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(500, 3, 500, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION); // this should reveal the last navigation entry because we are not at it currently\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goForward(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (jump)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10), EditorPaneSelectionChangeReason.USER);\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.JUMP);\n\t\tawait setTextSelection(historyService, pane, new Selection(120, 8, 120, 18), EditorPaneSelectionChangeReason.JUMP);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\tawait historyService.goForward(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goLast(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: selection changes with JUMP or NAVIGATION source are not merged (#143833)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10), EditorPaneSelectionChangeReason.USER);\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.JUMP);\n\t\tawait setTextSelection(historyService, pane, new Selection(6, 3, 6, 20), EditorPaneSelectionChangeReason.NAVIGATION);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: edit selection changes', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(50, 3, 50, 20), EditorPaneSelectionChangeReason.EDIT);\n\t\tawait setTextSelection(historyService, pane, new Selection(300, 3, 300, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(500, 3, 500, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.EDIT);\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\n\t\tawait historyService.goBack(GoFilter.EDITS); // this should reveal the last navigation entry because we are not at it currently\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.EDITS);\n\t\tassertTextSelection(new Selection(50, 3, 50, 20), pane);\n\n\t\tawait historyService.goForward(GoFilter.EDITS);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\tasync function setTextSelection(historyService: IHistoryService, pane: TestTextFileEditor, selection: Selection, reason = EditorPaneSelectionChangeReason.USER): Promise<void> {\n\t\tconst promise = Event.toPromise((historyService as HistoryService).onDidChangeEditorNavigationStack);\n\t\tpane.setSelection(selection, reason);\n\t\tawait promise;\n\t}\n\n\tfunction assertTextSelection(expected: Selection, pane: EditorPane): void {\n\t\tconst options: ITextEditorOptions | undefined = pane.options;\n\t\tif (!options) {\n\t\t\tassert.fail('EditorPane has no selection');\n\t\t}\n\n\t\tassert.strictEqual(options.selection?.startLineNumber, expected.startLineNumber);\n\t\tassert.strictEqual(options.selection?.startColumn, expected.startColumn);\n\t\tassert.strictEqual(options.selection?.endLineNumber, expected.endLineNumber);\n\t\tassert.strictEqual(options.selection?.endColumn, expected.endColumn);\n\t}\n\n\ttest('back / forward: tracks editor moves across groups', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource1: URI = toResource.call(this, '/path/one.txt');\n\t\tconst resource2: URI = toResource.call(this, '/path/two.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\n\t\t// [one.txt] [>two.html<]\n\n\t\tconst sideGroup = part.addGroup(part.activeGroup, GroupDirection.RIGHT);\n\n\t\t// [one.txt] [>two.html<] | <empty>\n\n\t\tconst editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\tpane1?.group.moveEditor(pane1.input!, sideGroup);\n\t\tawait editorChangePromise;\n\n\t\t// [one.txt] | [>two.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [>one.txt<] | [two.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: tracks group removals', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tconst pane2 = await editorService.openEditor({ resource: resource2, options: { pinned: true } }, SIDE_GROUP);\n\n\t\t// [one.txt] | [>two.html<]\n\n\t\tassert.notStrictEqual(pane1, pane2);\n\n\t\tawait pane1?.group.closeAllEditors();\n\n\t\t// [>two.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [>two.html<]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource2.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor navigation stack - navigation', async function () {\n\t\tconst [, , editorService, , instantiationService] = await createServices();\n\n\t\tconst stack = instantiationService.createInstance(EditorNavigationStack, GoFilter.NONE, GoScope.DEFAULT);\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource = toResource.call(this, '/path/index.html');\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } });\n\n\t\tlet changed = false;\n\t\tdisposables.add(stack.onDidChange(() => changed = true));\n\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\t\tassert.strictEqual(stack.canGoLast(), false);\n\n\t\t// Opening our first editor emits change event\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(changed, true);\n\t\tchanged = false;\n\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoLast(), true);\n\n\t\t// Opening same editor is not treated as new history stop\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\t// Opening different editor allows to go back\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(changed, true);\n\t\tchanged = false;\n\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\t\tassert.strictEqual(stack.canGoLast(), true);\n\n\t\tawait stack.goForward();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tawait stack.goPrevious();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\n\t\tawait stack.goPrevious();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tawait stack.goBack();\n\t\tawait stack.goLast();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tstack.dispose();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor navigation stack - mutations', async function () {\n\t\tconst [, , editorService, , instantiationService] = await createServices();\n\n\t\tconst stack = disposables.add(instantiationService.createInstance(EditorNavigationStack, GoFilter.NONE, GoScope.DEFAULT));\n\n\t\tconst resource: URI = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource: URI = toResource.call(this, '/path/index.html');\n\t\tconst unrelatedResource: URI = toResource.call(this, '/path/unrelated.html');\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } });\n\n\t\tstack.notifyNavigation(pane);\n\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Clear\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.clear();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove unrelated resource does not cause any harm (via internal event)\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\t\tstack.remove(new FileOperationEvent(unrelatedResource, FileOperation.DELETE));\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\n\t\t// Remove (via internal event)\n\t\tawait stack.goForward();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(new FileOperationEvent(resource, FileOperation.DELETE));\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via external event)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(new FileChangesEvent([{ resource, type: FileChangeType.DELETED }], !isLinux));\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via editor)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(pane!.input!);\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via group)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(pane!.group!.id);\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Move\n\t\tconst stat = {\n\t\t\tctime: 0,\n\t\t\tetag: '',\n\t\t\tmtime: 0,\n\t\t\tisDirectory: false,\n\t\t\tisFile: true,\n\t\t\tisSymbolicLink: false,\n\t\t\tname: 'other.txt',\n\t\t\treadonly: false,\n\t\t\tlocked: false,\n\t\t\tsize: 0,\n\t\t\tresource: toResource.call(this, '/path/other.txt'),\n\t\t\tchildren: undefined\n\t\t};\n\t\tstack.move(new FileOperationEvent(resource, FileOperation.MOVE, stat));\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(pane?.input?.resource?.toString(), stat.resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor group scope', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(GoScope.EDITOR_GROUP);\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\t\tconst resource3 = toResource.call(this, '/path/three.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } });\n\n\t\t// [one.txt] [two.html] [>three.html<]\n\n\t\tconst sideGroup = part.addGroup(part.activeGroup, GroupDirection.RIGHT);\n\n\t\t// [one.txt] [two.html] [>three.html<] | <empty>\n\n\t\tconst pane2 = await editorService.openEditor({ resource: resource1, options: { pinned: true } }, sideGroup);\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } });\n\n\t\t// [one.txt] [two.html] [>three.html<] | [one.txt] [two.html] [>three.html<]\n\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\t// [one.txt] [two.html] [>three.html<] | [>one.txt<] [two.html] [three.html]\n\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } }, pane1?.group);\n\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor  scope', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(GoScope.EDITOR);\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\n\t\tconst pane = await editorService.openEditor({ resource: resource1, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(50, 3, 50, 20));\n\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait setTextSelection(historyService, pane, new Selection(12, 2, 12, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(150, 3, 150, 20));\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(12, 2, 12, 10), pane);\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(12, 2, 12, 10), pane); // no change\n\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource2.toString());\n\n\t\tawait editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane); // no change\n\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\n\ttest('go to last edit location', async function () {\n\t\tconst [, historyService, editorService, textFileService, instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource = toResource.call(this, '/path/index.html');\n\t\tawait editorService.openEditor({ resource });\n\n\t\tconst model = await textFileService.files.resolve(resource) as IResolvedTextFileEditorModel;\n\t\tmodel.textEditorModel.setValue('Hello World');\n\t\tawait timeout(10); // history debounces change events\n\n\t\tawait editorService.openEditor({ resource: otherResource });\n\n\t\tconst onDidActiveEditorChange = new DeferredPromise<void>();\n\t\tdisposables.add(editorService.onDidActiveEditorChange(e => {\n\t\t\tonDidActiveEditorChange.complete(e);\n\t\t}));\n\n\t\thistoryService.goLast(GoFilter.EDITS);\n\t\tawait onDidActiveEditorChange.p;\n\n\t\tassert.strictEqual(editorService.activeEditor?.resource?.toString(), resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('reopen closed editor', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst pane = await editorService.openEditor({ resource });\n\n\t\tawait pane?.group.closeAllEditors();\n\n\t\tconst onDidActiveEditorChange = new DeferredPromise<void>();\n\t\tdisposables.add(editorService.onDidActiveEditorChange(e => {\n\t\t\tonDidActiveEditorChange.complete(e);\n\t\t}));\n\n\t\thistoryService.reopenLastClosedEditor();\n\t\tawait onDidActiveEditorChange.p;\n\n\t\tassert.strictEqual(editorService.activeEditor?.resource?.toString(), resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('getHistory', async () => {\n\n\t\tclass TestFileEditorInputWithUntyped extends TestFileEditorInput {\n\n\t\t\toverride toUntyped(): IUntypedEditorInput {\n\t\t\t\treturn {\n\t\t\t\t\tresource: this.resource,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\toverride: 'testOverride'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(undefined, true);\n\n\t\tlet history = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 0);\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1/node_modules/test.txt'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\n\t\tconst input3 = disposables.add(new TestFileEditorInputWithUntyped(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input3, { pinned: true });\n\n\t\tconst input4 = disposables.add(new TestFileEditorInputWithUntyped(URI.file('bar4'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 4);\n\n\t\t// first entry is untyped because it implements `toUntyped` and has a supported scheme\n\t\tassert.strictEqual(isResourceEditorInput(history[0]) && !(history[0] instanceof EditorInput), true);\n\t\tassert.strictEqual((history[0] as IResourceEditorInput).options?.override, 'testOverride');\n\t\t// second entry is not untyped even though it implements `toUntyped` but has unsupported scheme\n\t\tassert.strictEqual(history[1] instanceof EditorInput, true);\n\t\tassert.strictEqual(history[2] instanceof EditorInput, true);\n\t\tassert.strictEqual(history[3] instanceof EditorInput, true);\n\n\t\thistoryService.removeFromHistory(input2);\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3);\n\t\tassert.strictEqual(history[0].resource?.toString(), input4.resource.toString());\n\n\t\tinput1.dispose(); // disposing the editor will apply `search.exclude` rules\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 2);\n\n\t\t// side by side\n\t\tconst input5 = disposables.add(new TestFileEditorInputWithUntyped(URI.parse('file://bar5'), TEST_EDITOR_INPUT_ID));\n\t\tconst input6 = disposables.add(new TestFileEditorInputWithUntyped(URI.file('file://bar1/node_modules/test.txt'), TEST_EDITOR_INPUT_ID));\n\t\tconst input7 = new SideBySideEditorInput(undefined, undefined, input6, input5, editorService);\n\t\tawait part.activeGroup.openEditor(input7, { pinned: true });\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3);\n\t\tinput7.dispose();\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3); // only input5 survived, input6 is excluded via search.exclude\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('getLastActiveFile', async () => {\n\t\tconst [part, historyService] = await createServices();\n\n\t\tassert.ok(!historyService.getLastActiveFile('foo'));\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo')?.toString(), input2.resource.toString());\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo', 'bar2')?.toString(), input2.resource.toString());\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo', 'bar1')?.toString(), input1.resource.toString());\n\t});\n\n\ttest('open next/previous recently used editor (single group)', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor(part.activeGroup.id);\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor(part.activeGroup.id);\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('open next/previous recently used editor (multi group)', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\t\tconst rootGroup = part.activeGroup;\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\n\t\tconst sideGroup = part.addGroup(rootGroup, GroupDirection.RIGHT);\n\n\t\tawait rootGroup.openEditor(input1, { pinned: true });\n\t\tawait sideGroup.openEditor(input2, { pinned: true });\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup, rootGroup);\n\t\tassert.strictEqual(rootGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup, sideGroup);\n\t\tassert.strictEqual(sideGroup.activeEditor, input2);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('open next/previous recently is reset when other input opens', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tconst input3 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tconst input4 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar4'), TEST_EDITOR_INPUT_ID));\n\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tawait part.activeGroup.openEditor(input3, { pinned: true });\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tawait timeout(0);\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('transient editors suspends editor change tracking', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tconst input3 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tconst input4 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar4'), TEST_EDITOR_INPUT_ID));\n\t\tconst input5 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar5'), TEST_EDITOR_INPUT_ID));\n\n\t\tlet editorChangePromise: Promise<void> = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\t\tawait editorChangePromise;\n\n\t\tawait part.activeGroup.openEditor(input2, { transient: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\t\tawait part.activeGroup.openEditor(input3, { transient: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input3);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange)\n\t\t\t.then(() => Event.toPromise(editorService.onDidActiveEditorChange));\n\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait part.activeGroup.openEditor(input5, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input5);\n\n\t\t// stack should be [input1, input4, input5]\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input5);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite, toResource } from '../../../../../base/test/common/utils.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { workbenchInstantiationService, TestFileEditorInput, registerTestEditor, createEditorPart, registerTestFileEditor, TestServiceAccessor, TestTextFileEditor, workbenchTeardown, registerTestSideBySideEditor } from '../../../../test/browser/workbenchTestServices.js';\nimport { EditorPart } from '../../../../browser/parts/editor/editorPart.js';\nimport { SyncDescriptor } from '../../../../../platform/instantiation/common/descriptors.js';\nimport { IEditorGroupsService, GroupDirection } from '../../../editor/common/editorGroupsService.js';\nimport { EditorNavigationStack, HistoryService } from '../../browser/historyService.js';\nimport { IEditorService, SIDE_GROUP } from '../../../editor/common/editorService.js';\nimport { EditorService } from '../../../editor/browser/editorService.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { GoFilter, GoScope, IHistoryService } from '../../common/history.js';\nimport { DeferredPromise, timeout } from '../../../../../base/common/async.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { EditorPaneSelectionChangeReason, isResourceEditorInput, IUntypedEditorInput } from '../../../../common/editor.js';\nimport { IResourceEditorInput, ITextEditorOptions } from '../../../../../platform/editor/common/editor.js';\nimport { EditorInput } from '../../../../common/editor/editorInput.js';\nimport { IResolvedTextFileEditorModel, ITextFileService } from '../../../textfile/common/textfiles.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { FileChangesEvent, FileChangeType, FileOperation, FileOperationEvent } from '../../../../../platform/files/common/files.js';\nimport { isLinux } from '../../../../../base/common/platform.js';\nimport { Selection } from '../../../../../editor/common/core/selection.js';\nimport { EditorPane } from '../../../../browser/parts/editor/editorPane.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { SideBySideEditorInput } from '../../../../common/editor/sideBySideEditorInput.js';\n\nsuite('HistoryService', function () {\n\n\tconst TEST_EDITOR_ID = 'MyTestEditorForEditorHistory';\n\tconst TEST_EDITOR_INPUT_ID = 'testEditorInputForHistoyService';\n\n\tasync function createServices(scope = GoScope.DEFAULT, configureSearchExclude = false): Promise<[EditorPart, HistoryService, EditorService, ITextFileService, IInstantiationService, TestConfigurationService]> {\n\t\tconst instantiationService = workbenchInstantiationService(undefined, disposables);\n\n\t\tconst part = await createEditorPart(instantiationService, disposables);\n\t\tinstantiationService.stub(IEditorGroupsService, part);\n\n\t\tconst editorService = disposables.add(instantiationService.createInstance(EditorService, undefined));\n\t\tinstantiationService.stub(IEditorService, editorService);\n\n\t\tconst configurationService = new TestConfigurationService();\n\t\tif (scope === GoScope.EDITOR_GROUP) {\n\t\t\tconfigurationService.setUserConfiguration('workbench.editor.navigationScope', 'editorGroup');\n\t\t} else if (scope === GoScope.EDITOR) {\n\t\t\tconfigurationService.setUserConfiguration('workbench.editor.navigationScope', 'editor');\n\t\t}\n\t\tif (configureSearchExclude) {\n\t\t\tconfigurationService.setUserConfiguration('search', { exclude: { '**/node_modules/**': true } });\n\t\t}\n\t\tinstantiationService.stub(IConfigurationService, configurationService);\n\n\t\tconst historyService = disposables.add(instantiationService.createInstance(HistoryService));\n\t\tinstantiationService.stub(IHistoryService, historyService);\n\n\t\tconst accessor = instantiationService.createInstance(TestServiceAccessor);\n\n\t\treturn [part, historyService, editorService, accessor.textFileService, instantiationService, configurationService];\n\t}\n\n\tconst disposables = new DisposableStore();\n\n\tsetup(() => {\n\t\tdisposables.add(registerTestEditor(TEST_EDITOR_ID, [new SyncDescriptor(TestFileEditorInput)]));\n\t\tdisposables.add(registerTestSideBySideEditor());\n\t\tdisposables.add(registerTestFileEditor());\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('back / forward: basics', async () => {\n\t\tconst [part, historyService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\t});\n\n\ttest('back / forward: is editor group aware', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource: URI = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource: URI = toResource.call(this, '/path/other.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource, options: { pinned: true } });\n\t\tconst pane2 = await editorService.openEditor({ resource, options: { pinned: true } }, SIDE_GROUP);\n\n\t\t// [index.txt] | [>index.txt<]\n\n\t\tassert.notStrictEqual(pane1, pane2);\n\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } }, pane2?.group);\n\n\t\t// [index.txt] | [index.txt] [>other.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [index.txt] | [>index.txt<] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goBack();\n\n\t\t// [>index.txt<] | [index.txt] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goForward();\n\n\t\t// [index.txt] | [>index.txt<] [other.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource.toString());\n\n\t\tawait historyService.goForward();\n\n\t\t// [index.txt] | [index.txt] [>other.html<]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), otherResource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (user)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(1, 2, 1, 2));\n\t\tawait setTextSelection(historyService, pane, new Selection(15, 1, 15, 1)); // will be merged and dropped\n\t\tawait setTextSelection(historyService, pane, new Selection(16, 1, 16, 1)); // will be merged and dropped\n\t\tawait setTextSelection(historyService, pane, new Selection(17, 1, 17, 1));\n\t\tawait setTextSelection(historyService, pane, new Selection(30, 5, 30, 8));\n\t\tawait setTextSelection(historyService, pane, new Selection(40, 1, 40, 1));\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(30, 5, 30, 8), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(17, 1, 17, 1), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(1, 2, 1, 2), pane);\n\n\t\tawait historyService.goForward(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(17, 1, 17, 1), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (navigation)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10)); // this is our starting point\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.NAVIGATION); // this is our first target definition\n\t\tawait setTextSelection(historyService, pane, new Selection(120, 8, 120, 18), EditorPaneSelectionChangeReason.NAVIGATION); // this is our second target definition\n\t\tawait setTextSelection(historyService, pane, new Selection(300, 3, 300, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(500, 3, 500, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION); // this should reveal the last navigation entry because we are not at it currently\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goForward(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: in-editor text selection changes (jump)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10), EditorPaneSelectionChangeReason.USER);\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.JUMP);\n\t\tawait setTextSelection(historyService, pane, new Selection(120, 8, 120, 18), EditorPaneSelectionChangeReason.JUMP);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\tawait historyService.goForward(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goLast(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goPrevious(GoFilter.NAVIGATION);\n\t\tassertTextSelection(new Selection(120, 8, 120, 18), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: selection changes with JUMP or NAVIGATION source are not merged (#143833)', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10), EditorPaneSelectionChangeReason.USER);\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.JUMP);\n\t\tawait setTextSelection(historyService, pane, new Selection(6, 3, 6, 20), EditorPaneSelectionChangeReason.NAVIGATION);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.NONE);\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: edit selection changes', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(50, 3, 50, 20), EditorPaneSelectionChangeReason.EDIT);\n\t\tawait setTextSelection(historyService, pane, new Selection(300, 3, 300, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(500, 3, 500, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\t\tawait setTextSelection(historyService, pane, new Selection(5, 3, 5, 20), EditorPaneSelectionChangeReason.EDIT);\n\t\tawait setTextSelection(historyService, pane, new Selection(200, 3, 200, 20)); // unrelated user navigation\n\n\t\tawait historyService.goBack(GoFilter.EDITS); // this should reveal the last navigation entry because we are not at it currently\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\tawait historyService.goBack(GoFilter.EDITS);\n\t\tassertTextSelection(new Selection(50, 3, 50, 20), pane);\n\n\t\tawait historyService.goForward(GoFilter.EDITS);\n\t\tassertTextSelection(new Selection(5, 3, 5, 20), pane);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\tasync function setTextSelection(historyService: IHistoryService, pane: TestTextFileEditor, selection: Selection, reason = EditorPaneSelectionChangeReason.USER): Promise<void> {\n\t\tconst promise = Event.toPromise((historyService as HistoryService).onDidChangeEditorNavigationStack);\n\t\tpane.setSelection(selection, reason);\n\t\tawait promise;\n\t}\n\n\tfunction assertTextSelection(expected: Selection, pane: EditorPane): void {\n\t\tconst options: ITextEditorOptions | undefined = pane.options;\n\t\tif (!options) {\n\t\t\tassert.fail('EditorPane has no selection');\n\t\t}\n\n\t\tassert.strictEqual(options.selection?.startLineNumber, expected.startLineNumber);\n\t\tassert.strictEqual(options.selection?.startColumn, expected.startColumn);\n\t\tassert.strictEqual(options.selection?.endLineNumber, expected.endLineNumber);\n\t\tassert.strictEqual(options.selection?.endColumn, expected.endColumn);\n\t}\n\n\ttest('back / forward: tracks editor moves across groups', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource1: URI = toResource.call(this, '/path/one.txt');\n\t\tconst resource2: URI = toResource.call(this, '/path/two.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\n\t\t// [one.txt] [>two.html<]\n\n\t\tconst sideGroup = part.addGroup(part.activeGroup, GroupDirection.RIGHT);\n\n\t\t// [one.txt] [>two.html<] | <empty>\n\n\t\tconst editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\tpane1?.group.moveEditor(pane1.input!, sideGroup);\n\t\tawait editorChangePromise;\n\n\t\t// [one.txt] | [>two.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [>one.txt<] | [two.html]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: tracks group removals', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tconst pane2 = await editorService.openEditor({ resource: resource2, options: { pinned: true } }, SIDE_GROUP);\n\n\t\t// [one.txt] | [>two.html<]\n\n\t\tassert.notStrictEqual(pane1, pane2);\n\n\t\tawait pane1?.group.closeAllEditors();\n\n\t\t// [>two.html<]\n\n\t\tawait historyService.goBack();\n\n\t\t// [>two.html<]\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource2.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor navigation stack - navigation', async function () {\n\t\tconst [, , editorService, , instantiationService] = await createServices();\n\n\t\tconst stack = instantiationService.createInstance(EditorNavigationStack, GoFilter.NONE, GoScope.DEFAULT);\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource = toResource.call(this, '/path/index.html');\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } });\n\n\t\tlet changed = false;\n\t\tdisposables.add(stack.onDidChange(() => changed = true));\n\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\t\tassert.strictEqual(stack.canGoLast(), false);\n\n\t\t// Opening our first editor emits change event\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(changed, true);\n\t\tchanged = false;\n\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoLast(), true);\n\n\t\t// Opening same editor is not treated as new history stop\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\t// Opening different editor allows to go back\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\n\t\tstack.notifyNavigation(pane, { reason: EditorPaneSelectionChangeReason.USER });\n\t\tassert.strictEqual(changed, true);\n\t\tchanged = false;\n\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\t\tassert.strictEqual(stack.canGoLast(), true);\n\n\t\tawait stack.goForward();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tawait stack.goPrevious();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\n\t\tawait stack.goPrevious();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tawait stack.goBack();\n\t\tawait stack.goLast();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tassert.strictEqual(stack.canGoForward(), false);\n\n\t\tstack.dispose();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor navigation stack - mutations', async function () {\n\t\tconst [, , editorService, , instantiationService] = await createServices();\n\n\t\tconst stack = disposables.add(instantiationService.createInstance(EditorNavigationStack, GoFilter.NONE, GoScope.DEFAULT));\n\n\t\tconst resource: URI = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource: URI = toResource.call(this, '/path/index.html');\n\t\tconst unrelatedResource: URI = toResource.call(this, '/path/unrelated.html');\n\t\tconst pane = await editorService.openEditor({ resource, options: { pinned: true } });\n\n\t\tstack.notifyNavigation(pane);\n\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Clear\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.clear();\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove unrelated resource does not cause any harm (via internal event)\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\t\tstack.remove(new FileOperationEvent(unrelatedResource, FileOperation.DELETE));\n\t\tassert.strictEqual(stack.canGoForward(), true);\n\n\t\t// Remove (via internal event)\n\t\tawait stack.goForward();\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(new FileOperationEvent(resource, FileOperation.DELETE));\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via external event)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(new FileChangesEvent([{ resource, type: FileChangeType.DELETED }], !isLinux));\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via editor)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(pane!.input!);\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Remove (via group)\n\t\tassert.strictEqual(stack.canGoBack(), true);\n\t\tstack.remove(pane!.group!.id);\n\t\tassert.strictEqual(stack.canGoBack(), false);\n\t\tstack.clear();\n\n\t\tawait editorService.openEditor({ resource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\t\tawait editorService.openEditor({ resource: otherResource, options: { pinned: true } });\n\t\tstack.notifyNavigation(pane);\n\n\t\t// Move\n\t\tconst stat = {\n\t\t\tctime: 0,\n\t\t\tetag: '',\n\t\t\tmtime: 0,\n\t\t\tisDirectory: false,\n\t\t\tisFile: true,\n\t\t\tisSymbolicLink: false,\n\t\t\tname: 'other.txt',\n\t\t\treadonly: false,\n\t\t\tlocked: false,\n\t\t\tsize: 0,\n\t\t\tresource: toResource.call(this, '/path/other.txt'),\n\t\t\tchildren: undefined\n\t\t};\n\t\tstack.move(new FileOperationEvent(resource, FileOperation.MOVE, stat));\n\t\tawait stack.goBack();\n\t\tassert.strictEqual(pane?.input?.resource?.toString(), stat.resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor group scope', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(GoScope.EDITOR_GROUP);\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\t\tconst resource3 = toResource.call(this, '/path/three.html');\n\n\t\tconst pane1 = await editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } });\n\n\t\t// [one.txt] [two.html] [>three.html<]\n\n\t\tconst sideGroup = part.addGroup(part.activeGroup, GroupDirection.RIGHT);\n\n\t\t// [one.txt] [two.html] [>three.html<] | <empty>\n\n\t\tconst pane2 = await editorService.openEditor({ resource: resource1, options: { pinned: true } }, sideGroup);\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } });\n\n\t\t// [one.txt] [two.html] [>three.html<] | [one.txt] [two.html] [>three.html<]\n\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\n\t\tassert.strictEqual(part.activeGroup.id, pane2?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\t// [one.txt] [two.html] [>three.html<] | [>one.txt<] [two.html] [three.html]\n\n\t\tawait editorService.openEditor({ resource: resource3, options: { pinned: true } }, pane1?.group);\n\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\t\tawait historyService.goBack();\n\n\t\tassert.strictEqual(part.activeGroup.id, pane1?.group.id);\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('back / forward: editor  scope', async function () {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(GoScope.EDITOR);\n\n\t\tconst resource1 = toResource.call(this, '/path/one.txt');\n\t\tconst resource2 = toResource.call(this, '/path/two.html');\n\n\t\tconst pane = await editorService.openEditor({ resource: resource1, options: { pinned: true } }) as TestTextFileEditor;\n\n\t\tawait setTextSelection(historyService, pane, new Selection(2, 2, 2, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(50, 3, 50, 20));\n\n\t\tawait editorService.openEditor({ resource: resource2, options: { pinned: true } });\n\t\tawait setTextSelection(historyService, pane, new Selection(12, 2, 12, 10));\n\t\tawait setTextSelection(historyService, pane, new Selection(150, 3, 150, 20));\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(12, 2, 12, 10), pane);\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(12, 2, 12, 10), pane); // no change\n\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource2.toString());\n\n\t\tawait editorService.openEditor({ resource: resource1, options: { pinned: true } });\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane);\n\n\t\tawait historyService.goBack();\n\t\tassertTextSelection(new Selection(2, 2, 2, 10), pane); // no change\n\n\t\tassert.strictEqual(part.activeGroup.activeEditor?.resource?.toString(), resource1.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\n\ttest('go to last edit location', async function () {\n\t\tconst [, historyService, editorService, textFileService, instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst otherResource = toResource.call(this, '/path/index.html');\n\t\tawait editorService.openEditor({ resource });\n\n\t\tconst model = await textFileService.files.resolve(resource) as IResolvedTextFileEditorModel;\n\t\tmodel.textEditorModel.setValue('Hello World');\n\t\tawait timeout(10); // history debounces change events\n\n\t\tawait editorService.openEditor({ resource: otherResource });\n\n\t\tconst onDidActiveEditorChange = new DeferredPromise<void>();\n\t\tdisposables.add(editorService.onDidActiveEditorChange(e => {\n\t\t\tonDidActiveEditorChange.complete(e);\n\t\t}));\n\n\t\thistoryService.goLast(GoFilter.EDITS);\n\t\tawait onDidActiveEditorChange.p;\n\n\t\tassert.strictEqual(editorService.activeEditor?.resource?.toString(), resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('reopen closed editor', async function () {\n\t\tconst [, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst resource = toResource.call(this, '/path/index.txt');\n\t\tconst pane = await editorService.openEditor({ resource });\n\n\t\tawait pane?.group.closeAllEditors();\n\n\t\tconst onDidActiveEditorChange = new DeferredPromise<void>();\n\t\tdisposables.add(editorService.onDidActiveEditorChange(e => {\n\t\t\tonDidActiveEditorChange.complete(e);\n\t\t}));\n\n\t\thistoryService.reopenLastClosedEditor();\n\t\tawait onDidActiveEditorChange.p;\n\n\t\tassert.strictEqual(editorService.activeEditor?.resource?.toString(), resource.toString());\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('getHistory', async () => {\n\n\t\tclass TestFileEditorInputWithUntyped extends TestFileEditorInput {\n\n\t\t\toverride toUntyped(): IUntypedEditorInput {\n\t\t\t\treturn {\n\t\t\t\t\tresource: this.resource,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\toverride: 'testOverride'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices(undefined, true);\n\n\t\tlet history = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 0);\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1/node_modules/test.txt'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\n\t\tconst input3 = disposables.add(new TestFileEditorInputWithUntyped(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input3, { pinned: true });\n\n\t\tconst input4 = disposables.add(new TestFileEditorInputWithUntyped(URI.file('bar4'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 4);\n\n\t\t// first entry is untyped because it implements `toUntyped` and has a supported scheme\n\t\tassert.strictEqual(isResourceEditorInput(history[0]) && !(history[0] instanceof EditorInput), true);\n\t\tassert.strictEqual((history[0] as IResourceEditorInput).options?.override, 'testOverride');\n\t\t// second entry is not untyped even though it implements `toUntyped` but has unsupported scheme\n\t\tassert.strictEqual(history[1] instanceof EditorInput, true);\n\t\tassert.strictEqual(history[2] instanceof EditorInput, true);\n\t\tassert.strictEqual(history[3] instanceof EditorInput, true);\n\n\t\thistoryService.removeFromHistory(input2);\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3);\n\t\tassert.strictEqual(history[0].resource?.toString(), input4.resource.toString());\n\n\t\tinput1.dispose(); // disposing the editor will apply `search.exclude` rules\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 2);\n\n\t\t// side by side\n\t\tconst input5 = disposables.add(new TestFileEditorInputWithUntyped(URI.parse('file://bar5'), TEST_EDITOR_INPUT_ID));\n\t\tconst input6 = disposables.add(new TestFileEditorInputWithUntyped(URI.file('file://bar1/node_modules/test.txt'), TEST_EDITOR_INPUT_ID));\n\t\tconst input7 = new SideBySideEditorInput(undefined, undefined, input6, input5, editorService);\n\t\tawait part.activeGroup.openEditor(input7, { pinned: true });\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3);\n\t\tinput7.dispose();\n\n\t\thistory = historyService.getHistory();\n\t\tassert.strictEqual(history.length, 3); // only input5 survived, input6 is excluded via search.exclude\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('getLastActiveFile', async () => {\n\t\tconst [part, historyService] = await createServices();\n\n\t\tassert.ok(!historyService.getLastActiveFile('foo'));\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo')?.toString(), input2.resource.toString());\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo', 'bar2')?.toString(), input2.resource.toString());\n\t\tassert.strictEqual(historyService.getLastActiveFile('foo', 'bar1')?.toString(), input1.resource.toString());\n\t});\n\n\ttest('open next/previous recently used editor (single group)', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor(part.activeGroup.id);\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor(part.activeGroup.id);\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('open next/previous recently used editor (multi group)', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\t\tconst rootGroup = part.activeGroup;\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\n\t\tconst sideGroup = part.addGroup(rootGroup, GroupDirection.RIGHT);\n\n\t\tawait rootGroup.openEditor(input1, { pinned: true });\n\t\tawait sideGroup.openEditor(input2, { pinned: true });\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup, rootGroup);\n\t\tassert.strictEqual(rootGroup.activeEditor, input1);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup, sideGroup);\n\t\tassert.strictEqual(sideGroup.activeEditor, input2);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('open next/previous recently is reset when other input opens', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tconst input3 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tconst input4 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar4'), TEST_EDITOR_INPUT_ID));\n\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tawait part.activeGroup.openEditor(input2, { pinned: true });\n\t\tawait part.activeGroup.openEditor(input3, { pinned: true });\n\n\t\tlet editorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\tawait timeout(0);\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openPreviouslyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\thistoryService.openNextRecentlyUsedEditor();\n\t\tawait editorChangePromise;\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\ttest('transient editors suspends editor change tracking', async () => {\n\t\tconst [part, historyService, editorService, , instantiationService] = await createServices();\n\n\t\tconst input1 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar1'), TEST_EDITOR_INPUT_ID));\n\t\tconst input2 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar2'), TEST_EDITOR_INPUT_ID));\n\t\tconst input3 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar3'), TEST_EDITOR_INPUT_ID));\n\t\tconst input4 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar4'), TEST_EDITOR_INPUT_ID));\n\t\tconst input5 = disposables.add(new TestFileEditorInput(URI.parse('foo://bar5'), TEST_EDITOR_INPUT_ID));\n\n\t\tlet editorChangePromise: Promise<void> = Event.toPromise(editorService.onDidActiveEditorChange);\n\t\tawait part.activeGroup.openEditor(input1, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\t\tawait editorChangePromise;\n\n\t\tawait part.activeGroup.openEditor(input2, { transient: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input2);\n\t\tawait part.activeGroup.openEditor(input3, { transient: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input3);\n\n\t\teditorChangePromise = Event.toPromise(editorService.onDidActiveEditorChange)\n\t\t\t.then(() => Event.toPromise(editorService.onDidActiveEditorChange));\n\n\t\tawait part.activeGroup.openEditor(input4, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait part.activeGroup.openEditor(input5, { pinned: true });\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input5);\n\n\t\t// stack should be [input1, input4, input5]\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\t\tawait historyService.goBack();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input1);\n\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input4);\n\t\tawait historyService.goForward();\n\t\tassert.strictEqual(part.activeGroup.activeEditor, input5);\n\n\t\treturn workbenchTeardown(instantiationService);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}