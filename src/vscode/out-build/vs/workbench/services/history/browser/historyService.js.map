{"version":3,"sources":["vs/workbench/services/history/browser/historyService.ts"],"names":[],"mappings":"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","file":"historyService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IResourceEditorInput, IEditorOptions } from '../../../../platform/editor/common/editor.js';\nimport { IEditorPane, IEditorCloseEvent, EditorResourceAccessor, IEditorIdentifier, GroupIdentifier, EditorsOrder, SideBySideEditor, IUntypedEditorInput, isResourceEditorInput, isEditorInput, isSideBySideEditorInput, EditorCloseContext, IEditorPaneSelection, EditorPaneSelectionCompareResult, EditorPaneSelectionChangeReason, isEditorPaneWithSelection, IEditorPaneSelectionChangeEvent, IEditorPaneWithSelection, IEditorWillMoveEvent, GroupModelChangeKind } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { GoFilter, GoScope, IHistoryService } from '../common/history.js';\nimport { FileChangesEvent, IFileService, FileChangeType, FILES_EXCLUDE_CONFIG, FileOperationEvent, FileOperation } from '../../../../platform/files/common/files.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { dispose, Disposable, DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IEditorGroup, IEditorGroupsService } from '../../editor/common/editorGroupsService.js';\nimport { getExcludes, ISearchConfiguration, SEARCH_EXCLUDE_CONFIG } from '../../search/common/search.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { EditorServiceImpl } from '../../../browser/parts/editor/editor.js';\nimport { IWorkbenchLayoutService } from '../../layout/browser/layoutService.js';\nimport { IContextKey, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { coalesce, remove } from '../../../../base/common/arrays.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { addDisposableListener, EventType, EventHelper, WindowIdleValue } from '../../../../base/browser/dom.js';\nimport { IWorkspacesService } from '../../../../platform/workspaces/common/workspaces.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { ResourceGlobMatcher } from '../../../common/resources.js';\nimport { IPathService } from '../../path/common/pathService.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport { ILogService, LogLevel } from '../../../../platform/log/common/log.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\n\ninterface ISerializedEditorHistoryEntry {\n\treadonly editor: Omit<IResourceEditorInput, 'resource'> & { resource: string };\n}\n\ninterface IRecentlyClosedEditor {\n\treadonly editorId: string | undefined;\n\treadonly editor: IUntypedEditorInput;\n\n\treadonly resource: URI | undefined;\n\treadonly associatedResources: URI[];\n\n\treadonly index: number;\n\treadonly sticky: boolean;\n}\n\nexport class HistoryService extends Disposable implements IHistoryService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static readonly MOUSE_NAVIGATION_SETTING = 'workbench.editor.mouseBackForwardToNavigate';\n\tprivate static readonly NAVIGATION_SCOPE_SETTING = 'workbench.editor.navigationScope';\n\n\tprivate readonly activeEditorListeners = this._register(new DisposableStore());\n\tprivate lastActiveEditor: IEditorIdentifier | undefined = undefined;\n\n\tprivate readonly editorHelper: EditorHelper;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: EditorServiceImpl,\n\t\t@IEditorGroupsService private readonly editorGroupService: IEditorGroupsService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IWorkspacesService private readonly workspacesService: IWorkspacesService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper();\n\n\t\tthis.editorHelper = this.instantiationService.createInstance(EditorHelper);\n\n\t\tthis.canNavigateBackContextKey = (new RawContextKey<boolean>('canNavigateBack', false, localize('canNavigateBack', \"Whether it is possible to navigate back in editor history\"))).bindTo(this.contextKeyService);\n\t\tthis.canNavigateForwardContextKey = (new RawContextKey<boolean>('canNavigateForward', false, localize('canNavigateForward', \"Whether it is possible to navigate forward in editor history\"))).bindTo(this.contextKeyService);\n\n\t\tthis.canNavigateBackInNavigationsContextKey = (new RawContextKey<boolean>('canNavigateBackInNavigationLocations', false, localize('canNavigateBackInNavigationLocations', \"Whether it is possible to navigate back in editor navigation locations history\"))).bindTo(this.contextKeyService);\n\t\tthis.canNavigateForwardInNavigationsContextKey = (new RawContextKey<boolean>('canNavigateForwardInNavigationLocations', false, localize('canNavigateForwardInNavigationLocations', \"Whether it is possible to navigate forward in editor navigation locations history\"))).bindTo(this.contextKeyService);\n\t\tthis.canNavigateToLastNavigationLocationContextKey = (new RawContextKey<boolean>('canNavigateToLastNavigationLocation', false, localize('canNavigateToLastNavigationLocation', \"Whether it is possible to navigate to the last editor navigation location\"))).bindTo(this.contextKeyService);\n\n\t\tthis.canNavigateBackInEditsContextKey = (new RawContextKey<boolean>('canNavigateBackInEditLocations', false, localize('canNavigateBackInEditLocations', \"Whether it is possible to navigate back in editor edit locations history\"))).bindTo(this.contextKeyService);\n\t\tthis.canNavigateForwardInEditsContextKey = (new RawContextKey<boolean>('canNavigateForwardInEditLocations', false, localize('canNavigateForwardInEditLocations', \"Whether it is possible to navigate forward in editor edit locations history\"))).bindTo(this.contextKeyService);\n\t\tthis.canNavigateToLastEditLocationContextKey = (new RawContextKey<boolean>('canNavigateToLastEditLocation', false, localize('canNavigateToLastEditLocation', \"Whether it is possible to navigate to the last editor edit location\"))).bindTo(this.contextKeyService);\n\n\t\tthis.canReopenClosedEditorContextKey = (new RawContextKey<boolean>('canReopenClosedEditor', false, localize('canReopenClosedEditor', \"Whether it is possible to reopen the last closed editor\"))).bindTo(this.contextKeyService);\n\n\t\tthis.registerListeners();\n\n\t\t// if the service is created late enough that an editor is already opened\n\t\t// make sure to trigger the onActiveEditorChanged() to track the editor\n\t\t// properly (fixes https://github.com/microsoft/vscode/issues/59908)\n\t\tif (this.editorService.activeEditorPane) {\n\t\t\tthis.onDidActiveEditorChange();\n\t\t}\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Mouse back/forward support\n\t\tthis.registerMouseNavigationListener();\n\n\t\t// Editor changes\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => this.onDidActiveEditorChange()));\n\t\tthis._register(this.editorService.onDidOpenEditorFail(event => this.remove(event.editor)));\n\t\tthis._register(this.editorService.onDidCloseEditor(event => this.onDidCloseEditor(event)));\n\t\tthis._register(this.editorService.onDidMostRecentlyActiveEditorsChange(() => this.handleEditorEventInRecentEditorsStack()));\n\n\t\t// Editor group changes\n\t\tthis._register(this.editorGroupService.onDidRemoveGroup(e => this.onDidRemoveGroup(e)));\n\n\t\t// File changes\n\t\tthis._register(this.fileService.onDidFilesChange(event => this.onDidFilesChange(event)));\n\t\tthis._register(this.fileService.onDidRunOperation(event => this.onDidFilesChange(event)));\n\n\t\t// Storage\n\t\tthis._register(this.storageService.onWillSaveState(() => this.saveState()));\n\n\t\t// Configuration\n\t\tthis.registerEditorNavigationScopeChangeListener();\n\n\t\t// Context keys\n\t\tthis._register(this.onDidChangeEditorNavigationStack(() => this.updateContextKeys()));\n\t\tthis._register(this.editorGroupService.onDidChangeActiveGroup(() => this.updateContextKeys()));\n\t}\n\n\tprivate onDidCloseEditor(e: IEditorCloseEvent): void {\n\t\tthis.handleEditorCloseEventInHistory(e);\n\t\tthis.handleEditorCloseEventInReopen(e);\n\t}\n\n\tprivate registerMouseNavigationListener(): void {\n\t\tconst mouseBackForwardSupportListener = this._register(new DisposableStore());\n\t\tconst handleMouseBackForwardSupport = () => {\n\t\t\tmouseBackForwardSupportListener.clear();\n\n\t\t\tif (this.configurationService.getValue(HistoryService.MOUSE_NAVIGATION_SETTING)) {\n\t\t\t\tthis._register(Event.runAndSubscribe(this.layoutService.onDidAddContainer, ({ container, disposables }) => {\n\t\t\t\t\tconst eventDisposables = disposables.add(new DisposableStore());\n\t\t\t\t\teventDisposables.add(addDisposableListener(container, EventType.MOUSE_DOWN, e => this.onMouseDownOrUp(e, true)));\n\t\t\t\t\teventDisposables.add(addDisposableListener(container, EventType.MOUSE_UP, e => this.onMouseDownOrUp(e, false)));\n\n\t\t\t\t\tmouseBackForwardSupportListener.add(eventDisposables);\n\t\t\t\t}, { container: this.layoutService.mainContainer, disposables: this._store }));\n\t\t\t}\n\t\t};\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(event => {\n\t\t\tif (event.affectsConfiguration(HistoryService.MOUSE_NAVIGATION_SETTING)) {\n\t\t\t\thandleMouseBackForwardSupport();\n\t\t\t}\n\t\t}));\n\n\t\thandleMouseBackForwardSupport();\n\t}\n\n\tprivate onMouseDownOrUp(event: MouseEvent, isMouseDown: boolean): void {\n\n\t\t// Support to navigate in history when mouse buttons 4/5 are pressed\n\t\t// We want to trigger this on mouse down for a faster experience\n\t\t// but we also need to prevent mouse up from triggering the default\n\t\t// which is to navigate in the browser history.\n\n\t\tswitch (event.button) {\n\t\t\tcase 3:\n\t\t\t\tEventHelper.stop(event);\n\t\t\t\tif (isMouseDown) {\n\t\t\t\t\tthis.goBack();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tEventHelper.stop(event);\n\t\t\t\tif (isMouseDown) {\n\t\t\t\t\tthis.goForward();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate onDidRemoveGroup(group: IEditorGroup): void {\n\t\tthis.handleEditorGroupRemoveInNavigationStacks(group);\n\t}\n\n\tprivate onDidActiveEditorChange(): void {\n\t\tconst activeEditorGroup = this.editorGroupService.activeGroup;\n\t\tconst activeEditorPane = activeEditorGroup.activeEditorPane;\n\n\t\tif (this.lastActiveEditor && this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor, activeEditorPane)) {\n\t\t\treturn; // return if the active editor is still the same\n\t\t}\n\n\t\t// Remember as last active editor (can be undefined if none opened)\n\t\tthis.lastActiveEditor = activeEditorPane?.input ? { editor: activeEditorPane.input, groupId: activeEditorPane.group.id } : undefined;\n\n\t\t// Dispose old listeners\n\t\tthis.activeEditorListeners.clear();\n\n\t\t// Handle editor change unless the editor is transient. In that case\n\t\t// setup a listener to see if the transient editor becomes non-transient\n\t\t// (https://github.com/microsoft/vscode/issues/211769)\n\t\tif (!activeEditorPane?.group.isTransient(activeEditorPane.input)) {\n\t\t\tthis.handleActiveEditorChange(activeEditorGroup, activeEditorPane);\n\t\t} else {\n\t\t\tthis.logService.trace(`[History]: ignoring transient editor change until becoming non-transient (editor: ${activeEditorPane.input?.resource?.toString()}})`);\n\n\t\t\tconst transientListener = activeEditorGroup.onDidModelChange(e => {\n\t\t\t\tif (e.kind === GroupModelChangeKind.EDITOR_TRANSIENT && e.editor === activeEditorPane.input && !activeEditorPane.group.isTransient(activeEditorPane.input)) {\n\t\t\t\t\ttransientListener.dispose();\n\n\t\t\t\t\tthis.handleActiveEditorChange(activeEditorGroup, activeEditorPane);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.activeEditorListeners.add(transientListener);\n\t\t}\n\n\t\t// Listen to selection changes unless the editor is transient\n\t\tif (isEditorPaneWithSelection(activeEditorPane)) {\n\t\t\tthis.activeEditorListeners.add(activeEditorPane.onDidChangeSelection(e => {\n\t\t\t\tif (!activeEditorPane.group.isTransient(activeEditorPane.input)) {\n\t\t\t\t\tthis.handleActiveEditorSelectionChangeEvent(activeEditorGroup, activeEditorPane, e);\n\t\t\t\t} else {\n\t\t\t\t\tthis.logService.trace(`[History]: ignoring transient editor selection change (editor: ${activeEditorPane.input?.resource?.toString()}})`);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\t// Context keys\n\t\tthis.updateContextKeys();\n\t}\n\n\tprivate onDidFilesChange(event: FileChangesEvent | FileOperationEvent): void {\n\n\t\t// External file changes (watcher)\n\t\tif (event instanceof FileChangesEvent) {\n\t\t\tif (event.gotDeleted()) {\n\t\t\t\tthis.remove(event);\n\t\t\t}\n\t\t}\n\n\t\t// Internal file changes (e.g. explorer)\n\t\telse {\n\n\t\t\t// Delete\n\t\t\tif (event.isOperation(FileOperation.DELETE)) {\n\t\t\t\tthis.remove(event);\n\t\t\t}\n\n\t\t\t// Move\n\t\t\telse if (event.isOperation(FileOperation.MOVE) && event.target.isFile) {\n\t\t\t\tthis.move(event);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleActiveEditorChange(group: IEditorGroup, editorPane?: IEditorPane): void {\n\t\tthis.handleActiveEditorChangeInHistory(editorPane);\n\t\tthis.handleActiveEditorChangeInNavigationStacks(group, editorPane);\n\t}\n\n\tprivate handleActiveEditorSelectionChangeEvent(group: IEditorGroup, editorPane: IEditorPaneWithSelection, event: IEditorPaneSelectionChangeEvent): void {\n\t\tthis.handleActiveEditorSelectionChangeInNavigationStacks(group, editorPane, event);\n\t}\n\n\tprivate move(event: FileOperationEvent): void {\n\t\tthis.moveInHistory(event);\n\t\tthis.moveInEditorNavigationStacks(event);\n\t}\n\n\tprivate remove(editor: EditorInput): void;\n\tprivate remove(event: FileChangesEvent): void;\n\tprivate remove(event: FileOperationEvent): void;\n\tprivate remove(arg1: EditorInput | FileChangesEvent | FileOperationEvent): void {\n\t\tthis.removeFromHistory(arg1);\n\t\tthis.removeFromEditorNavigationStacks(arg1);\n\t\tthis.removeFromRecentlyClosedEditors(arg1);\n\t\tthis.removeFromRecentlyOpened(arg1);\n\t}\n\n\tprivate removeFromRecentlyOpened(arg1: EditorInput | FileChangesEvent | FileOperationEvent): void {\n\t\tlet resource: URI | undefined = undefined;\n\t\tif (isEditorInput(arg1)) {\n\t\t\tresource = EditorResourceAccessor.getOriginalUri(arg1);\n\t\t} else if (arg1 instanceof FileChangesEvent) {\n\t\t\t// Ignore for now (recently opened are most often out of workspace files anyway for which there are no file events)\n\t\t} else {\n\t\t\tresource = arg1.resource;\n\t\t}\n\n\t\tif (resource) {\n\t\t\tthis.workspacesService.removeRecentlyOpened([resource]);\n\t\t}\n\t}\n\n\tclear(): void {\n\n\t\t// History\n\t\tthis.clearRecentlyOpened();\n\n\t\t// Navigation (next, previous)\n\t\tthis.clearEditorNavigationStacks();\n\n\t\t// Recently closed editors\n\t\tthis.recentlyClosedEditors = [];\n\n\t\t// Context Keys\n\t\tthis.updateContextKeys();\n\t}\n\n\t//#region History Context Keys\n\n\tprivate readonly canNavigateBackContextKey: IContextKey<boolean>;\n\tprivate readonly canNavigateForwardContextKey: IContextKey<boolean>;\n\n\tprivate readonly canNavigateBackInNavigationsContextKey: IContextKey<boolean>;\n\tprivate readonly canNavigateForwardInNavigationsContextKey: IContextKey<boolean>;\n\tprivate readonly canNavigateToLastNavigationLocationContextKey: IContextKey<boolean>;\n\n\tprivate readonly canNavigateBackInEditsContextKey: IContextKey<boolean>;\n\tprivate readonly canNavigateForwardInEditsContextKey: IContextKey<boolean>;\n\tprivate readonly canNavigateToLastEditLocationContextKey: IContextKey<boolean>;\n\n\tprivate readonly canReopenClosedEditorContextKey: IContextKey<boolean>;\n\n\tupdateContextKeys(): void {\n\t\tthis.contextKeyService.bufferChangeEvents(() => {\n\t\t\tconst activeStack = this.getStack();\n\n\t\t\tthis.canNavigateBackContextKey.set(activeStack.canGoBack(GoFilter.NONE));\n\t\t\tthis.canNavigateForwardContextKey.set(activeStack.canGoForward(GoFilter.NONE));\n\n\t\t\tthis.canNavigateBackInNavigationsContextKey.set(activeStack.canGoBack(GoFilter.NAVIGATION));\n\t\t\tthis.canNavigateForwardInNavigationsContextKey.set(activeStack.canGoForward(GoFilter.NAVIGATION));\n\t\t\tthis.canNavigateToLastNavigationLocationContextKey.set(activeStack.canGoLast(GoFilter.NAVIGATION));\n\n\t\t\tthis.canNavigateBackInEditsContextKey.set(activeStack.canGoBack(GoFilter.EDITS));\n\t\t\tthis.canNavigateForwardInEditsContextKey.set(activeStack.canGoForward(GoFilter.EDITS));\n\t\t\tthis.canNavigateToLastEditLocationContextKey.set(activeStack.canGoLast(GoFilter.EDITS));\n\n\t\t\tthis.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length > 0);\n\t\t});\n\t}\n\n\t//#endregion\n\n\t//#region Editor History Navigation (limit: 50)\n\n\tprivate readonly _onDidChangeEditorNavigationStack = this._register(new Emitter<void>());\n\treadonly onDidChangeEditorNavigationStack = this._onDidChangeEditorNavigationStack.event;\n\n\tprivate defaultScopedEditorNavigationStack: IEditorNavigationStacks | undefined = undefined;\n\tprivate readonly editorGroupScopedNavigationStacks = new Map<GroupIdentifier, { stack: IEditorNavigationStacks; disposable: IDisposable }>();\n\tprivate readonly editorScopedNavigationStacks = new Map<GroupIdentifier, Map<EditorInput, { stack: IEditorNavigationStacks; disposable: IDisposable }>>();\n\n\tprivate editorNavigationScope = GoScope.DEFAULT;\n\n\tprivate registerEditorNavigationScopeChangeListener(): void {\n\t\tconst handleEditorNavigationScopeChange = () => {\n\n\t\t\t// Ensure to start fresh when setting changes\n\t\t\tthis.disposeEditorNavigationStacks();\n\n\t\t\t// Update scope\n\t\t\tconst configuredScope = this.configurationService.getValue(HistoryService.NAVIGATION_SCOPE_SETTING);\n\t\t\tif (configuredScope === 'editorGroup') {\n\t\t\t\tthis.editorNavigationScope = GoScope.EDITOR_GROUP;\n\t\t\t} else if (configuredScope === 'editor') {\n\t\t\t\tthis.editorNavigationScope = GoScope.EDITOR;\n\t\t\t} else {\n\t\t\t\tthis.editorNavigationScope = GoScope.DEFAULT;\n\t\t\t}\n\t\t};\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(event => {\n\t\t\tif (event.affectsConfiguration(HistoryService.NAVIGATION_SCOPE_SETTING)) {\n\t\t\t\thandleEditorNavigationScopeChange();\n\t\t\t}\n\t\t}));\n\n\t\thandleEditorNavigationScopeChange();\n\t}\n\n\tprivate getStack(group = this.editorGroupService.activeGroup, editor = group.activeEditor): IEditorNavigationStacks {\n\t\tswitch (this.editorNavigationScope) {\n\n\t\t\t// Per Editor\n\t\t\tcase GoScope.EDITOR: {\n\t\t\t\tif (!editor) {\n\t\t\t\t\treturn new NoOpEditorNavigationStacks();\n\t\t\t\t}\n\n\t\t\t\tlet stacksForGroup = this.editorScopedNavigationStacks.get(group.id);\n\t\t\t\tif (!stacksForGroup) {\n\t\t\t\t\tstacksForGroup = new Map<EditorInput, { stack: IEditorNavigationStacks; disposable: IDisposable }>();\n\t\t\t\t\tthis.editorScopedNavigationStacks.set(group.id, stacksForGroup);\n\t\t\t\t}\n\n\t\t\t\tlet stack = stacksForGroup.get(editor)?.stack;\n\t\t\t\tif (!stack) {\n\t\t\t\t\tconst disposable = new DisposableStore();\n\n\t\t\t\t\tstack = disposable.add(this.instantiationService.createInstance(EditorNavigationStacks, GoScope.EDITOR));\n\t\t\t\t\tdisposable.add(stack.onDidChange(() => this._onDidChangeEditorNavigationStack.fire()));\n\n\t\t\t\t\tstacksForGroup.set(editor, { stack, disposable });\n\t\t\t\t}\n\n\t\t\t\treturn stack;\n\t\t\t}\n\n\t\t\t// Per Editor Group\n\t\t\tcase GoScope.EDITOR_GROUP: {\n\t\t\t\tlet stack = this.editorGroupScopedNavigationStacks.get(group.id)?.stack;\n\t\t\t\tif (!stack) {\n\t\t\t\t\tconst disposable = new DisposableStore();\n\n\t\t\t\t\tstack = disposable.add(this.instantiationService.createInstance(EditorNavigationStacks, GoScope.EDITOR_GROUP));\n\t\t\t\t\tdisposable.add(stack.onDidChange(() => this._onDidChangeEditorNavigationStack.fire()));\n\n\t\t\t\t\tthis.editorGroupScopedNavigationStacks.set(group.id, { stack, disposable });\n\t\t\t\t}\n\n\t\t\t\treturn stack;\n\t\t\t}\n\n\t\t\t// Global\n\t\t\tcase GoScope.DEFAULT: {\n\t\t\t\tif (!this.defaultScopedEditorNavigationStack) {\n\t\t\t\t\tthis.defaultScopedEditorNavigationStack = this._register(this.instantiationService.createInstance(EditorNavigationStacks, GoScope.DEFAULT));\n\n\t\t\t\t\tthis._register(this.defaultScopedEditorNavigationStack.onDidChange(() => this._onDidChangeEditorNavigationStack.fire()));\n\t\t\t\t}\n\n\t\t\t\treturn this.defaultScopedEditorNavigationStack;\n\t\t\t}\n\t\t}\n\t}\n\n\tgoForward(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack().goForward(filter);\n\t}\n\n\tgoBack(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack().goBack(filter);\n\t}\n\n\tgoPrevious(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack().goPrevious(filter);\n\t}\n\n\tgoLast(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack().goLast(filter);\n\t}\n\n\tprivate handleActiveEditorChangeInNavigationStacks(group: IEditorGroup, editorPane?: IEditorPane): void {\n\t\tthis.getStack(group, editorPane?.input).handleActiveEditorChange(editorPane);\n\t}\n\n\tprivate handleActiveEditorSelectionChangeInNavigationStacks(group: IEditorGroup, editorPane: IEditorPaneWithSelection, event: IEditorPaneSelectionChangeEvent): void {\n\t\tthis.getStack(group, editorPane.input).handleActiveEditorSelectionChange(editorPane, event);\n\t}\n\n\tprivate handleEditorCloseEventInHistory(e: IEditorCloseEvent): void {\n\t\tconst editors = this.editorScopedNavigationStacks.get(e.groupId);\n\t\tif (editors) {\n\t\t\tconst editorStack = editors.get(e.editor);\n\t\t\tif (editorStack) {\n\t\t\t\teditorStack.disposable.dispose();\n\t\t\t\teditors.delete(e.editor);\n\t\t\t}\n\n\t\t\tif (editors.size === 0) {\n\t\t\t\tthis.editorScopedNavigationStacks.delete(e.groupId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate handleEditorGroupRemoveInNavigationStacks(group: IEditorGroup): void {\n\n\t\t// Global\n\t\tthis.defaultScopedEditorNavigationStack?.remove(group.id);\n\n\t\t// Editor groups\n\t\tconst editorGroupStack = this.editorGroupScopedNavigationStacks.get(group.id);\n\t\tif (editorGroupStack) {\n\t\t\teditorGroupStack.disposable.dispose();\n\t\t\tthis.editorGroupScopedNavigationStacks.delete(group.id);\n\t\t}\n\t}\n\n\tprivate clearEditorNavigationStacks(): void {\n\t\tthis.withEachEditorNavigationStack(stack => stack.clear());\n\t}\n\n\tprivate removeFromEditorNavigationStacks(arg1: EditorInput | FileChangesEvent | FileOperationEvent): void {\n\t\tthis.withEachEditorNavigationStack(stack => stack.remove(arg1));\n\t}\n\n\tprivate moveInEditorNavigationStacks(event: FileOperationEvent): void {\n\t\tthis.withEachEditorNavigationStack(stack => stack.move(event));\n\t}\n\n\tprivate withEachEditorNavigationStack(fn: (stack: IEditorNavigationStacks) => void): void {\n\n\t\t// Global\n\t\tif (this.defaultScopedEditorNavigationStack) {\n\t\t\tfn(this.defaultScopedEditorNavigationStack);\n\t\t}\n\n\t\t// Per editor group\n\t\tfor (const [, entry] of this.editorGroupScopedNavigationStacks) {\n\t\t\tfn(entry.stack);\n\t\t}\n\n\t\t// Per editor\n\t\tfor (const [, entries] of this.editorScopedNavigationStacks) {\n\t\t\tfor (const [, entry] of entries) {\n\t\t\t\tfn(entry.stack);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate disposeEditorNavigationStacks(): void {\n\n\t\t// Global\n\t\tthis.defaultScopedEditorNavigationStack?.dispose();\n\t\tthis.defaultScopedEditorNavigationStack = undefined;\n\n\t\t// Per Editor group\n\t\tfor (const [, stack] of this.editorGroupScopedNavigationStacks) {\n\t\t\tstack.disposable.dispose();\n\t\t}\n\t\tthis.editorGroupScopedNavigationStacks.clear();\n\n\t\t// Per Editor\n\t\tfor (const [, stacks] of this.editorScopedNavigationStacks) {\n\t\t\tfor (const [, stack] of stacks) {\n\t\t\t\tstack.disposable.dispose();\n\t\t\t}\n\t\t}\n\t\tthis.editorScopedNavigationStacks.clear();\n\t}\n\n\t//#endregion\n\n\t//#region Navigation: Next/Previous Used Editor\n\n\tprivate recentlyUsedEditorsStack: readonly IEditorIdentifier[] | undefined = undefined;\n\tprivate recentlyUsedEditorsStackIndex = 0;\n\n\tprivate recentlyUsedEditorsInGroupStack: readonly IEditorIdentifier[] | undefined = undefined;\n\tprivate recentlyUsedEditorsInGroupStackIndex = 0;\n\n\tprivate navigatingInRecentlyUsedEditorsStack = false;\n\tprivate navigatingInRecentlyUsedEditorsInGroupStack = false;\n\n\topenNextRecentlyUsedEditor(groupId?: GroupIdentifier): Promise<void> {\n\t\tconst [stack, index] = this.ensureRecentlyUsedStack(index => index - 1, groupId);\n\n\t\treturn this.doNavigateInRecentlyUsedEditorsStack(stack[index], groupId);\n\t}\n\n\topenPreviouslyUsedEditor(groupId?: GroupIdentifier): Promise<void> {\n\t\tconst [stack, index] = this.ensureRecentlyUsedStack(index => index + 1, groupId);\n\n\t\treturn this.doNavigateInRecentlyUsedEditorsStack(stack[index], groupId);\n\t}\n\n\tprivate async doNavigateInRecentlyUsedEditorsStack(editorIdentifier: IEditorIdentifier | undefined, groupId?: GroupIdentifier): Promise<void> {\n\t\tif (editorIdentifier) {\n\t\t\tconst acrossGroups = typeof groupId !== 'number' || !this.editorGroupService.getGroup(groupId);\n\n\t\t\tif (acrossGroups) {\n\t\t\t\tthis.navigatingInRecentlyUsedEditorsStack = true;\n\t\t\t} else {\n\t\t\t\tthis.navigatingInRecentlyUsedEditorsInGroupStack = true;\n\t\t\t}\n\n\t\t\tconst group = this.editorGroupService.getGroup(editorIdentifier.groupId) ?? this.editorGroupService.activeGroup;\n\t\t\ttry {\n\t\t\t\tawait group.openEditor(editorIdentifier.editor);\n\t\t\t} finally {\n\t\t\t\tif (acrossGroups) {\n\t\t\t\t\tthis.navigatingInRecentlyUsedEditorsStack = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis.navigatingInRecentlyUsedEditorsInGroupStack = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate ensureRecentlyUsedStack(indexModifier: (index: number) => number, groupId?: GroupIdentifier): [readonly IEditorIdentifier[], number] {\n\t\tlet editors: readonly IEditorIdentifier[];\n\t\tlet index: number;\n\n\t\tconst group = typeof groupId === 'number' ? this.editorGroupService.getGroup(groupId) : undefined;\n\n\t\t// Across groups\n\t\tif (!group) {\n\t\t\teditors = this.recentlyUsedEditorsStack || this.editorService.getEditors(EditorsOrder.MOST_RECENTLY_ACTIVE);\n\t\t\tindex = this.recentlyUsedEditorsStackIndex;\n\t\t}\n\n\t\t// Within group\n\t\telse {\n\t\t\teditors = this.recentlyUsedEditorsInGroupStack || group.getEditors(EditorsOrder.MOST_RECENTLY_ACTIVE).map(editor => ({ groupId: group.id, editor }));\n\t\t\tindex = this.recentlyUsedEditorsInGroupStackIndex;\n\t\t}\n\n\t\t// Adjust index\n\t\tlet newIndex = indexModifier(index);\n\t\tif (newIndex < 0) {\n\t\t\tnewIndex = 0;\n\t\t} else if (newIndex > editors.length - 1) {\n\t\t\tnewIndex = editors.length - 1;\n\t\t}\n\n\t\t// Remember index and editors\n\t\tif (!group) {\n\t\t\tthis.recentlyUsedEditorsStack = editors;\n\t\t\tthis.recentlyUsedEditorsStackIndex = newIndex;\n\t\t} else {\n\t\t\tthis.recentlyUsedEditorsInGroupStack = editors;\n\t\t\tthis.recentlyUsedEditorsInGroupStackIndex = newIndex;\n\t\t}\n\n\t\treturn [editors, newIndex];\n\t}\n\n\tprivate handleEditorEventInRecentEditorsStack(): void {\n\n\t\t// Drop all-editors stack unless navigating in all editors\n\t\tif (!this.navigatingInRecentlyUsedEditorsStack) {\n\t\t\tthis.recentlyUsedEditorsStack = undefined;\n\t\t\tthis.recentlyUsedEditorsStackIndex = 0;\n\t\t}\n\n\t\t// Drop in-group-editors stack unless navigating in group\n\t\tif (!this.navigatingInRecentlyUsedEditorsInGroupStack) {\n\t\t\tthis.recentlyUsedEditorsInGroupStack = undefined;\n\t\t\tthis.recentlyUsedEditorsInGroupStackIndex = 0;\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region File: Reopen Closed Editor (limit: 20)\n\n\tprivate static readonly MAX_RECENTLY_CLOSED_EDITORS = 20;\n\n\tprivate recentlyClosedEditors: IRecentlyClosedEditor[] = [];\n\tprivate ignoreEditorCloseEvent = false;\n\n\tprivate handleEditorCloseEventInReopen(event: IEditorCloseEvent): void {\n\t\tif (this.ignoreEditorCloseEvent) {\n\t\t\treturn; // blocked\n\t\t}\n\n\t\tconst { editor, context } = event;\n\t\tif (context === EditorCloseContext.REPLACE || context === EditorCloseContext.MOVE) {\n\t\t\treturn; // ignore if editor was replaced or moved\n\t\t}\n\n\t\tconst untypedEditor = editor.toUntyped();\n\t\tif (!untypedEditor) {\n\t\t\treturn; // we need a untyped editor to restore from going forward\n\t\t}\n\n\t\tconst associatedResources: URI[] = [];\n\t\tconst editorResource = EditorResourceAccessor.getOriginalUri(editor, { supportSideBySide: SideBySideEditor.BOTH });\n\t\tif (URI.isUri(editorResource)) {\n\t\t\tassociatedResources.push(editorResource);\n\t\t} else if (editorResource) {\n\t\t\tassociatedResources.push(...coalesce([editorResource.primary, editorResource.secondary]));\n\t\t}\n\n\t\t// Remove from list of recently closed before...\n\t\tthis.removeFromRecentlyClosedEditors(editor);\n\n\t\t// ...adding it as last recently closed\n\t\tthis.recentlyClosedEditors.push({\n\t\t\teditorId: editor.editorId,\n\t\t\teditor: untypedEditor,\n\t\t\tresource: EditorResourceAccessor.getOriginalUri(editor),\n\t\t\tassociatedResources,\n\t\t\tindex: event.index,\n\t\t\tsticky: event.sticky\n\t\t});\n\n\t\t// Bounding\n\t\tif (this.recentlyClosedEditors.length > HistoryService.MAX_RECENTLY_CLOSED_EDITORS) {\n\t\t\tthis.recentlyClosedEditors.shift();\n\t\t}\n\n\t\t// Context\n\t\tthis.canReopenClosedEditorContextKey.set(true);\n\t}\n\n\tasync reopenLastClosedEditor(): Promise<void> {\n\n\t\t// Open editor if we have one\n\t\tconst lastClosedEditor = this.recentlyClosedEditors.pop();\n\t\tlet reopenClosedEditorPromise: Promise<void> | undefined = undefined;\n\t\tif (lastClosedEditor) {\n\t\t\treopenClosedEditorPromise = this.doReopenLastClosedEditor(lastClosedEditor);\n\t\t}\n\n\t\t// Update context\n\t\tthis.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length > 0);\n\n\t\treturn reopenClosedEditorPromise;\n\t}\n\n\tprivate async doReopenLastClosedEditor(lastClosedEditor: IRecentlyClosedEditor): Promise<void> {\n\t\tconst options: IEditorOptions = { pinned: true, sticky: lastClosedEditor.sticky, index: lastClosedEditor.index, ignoreError: true };\n\n\t\t// Special sticky handling: remove the index property from options\n\t\t// if that would result in sticky state to not preserve or apply\n\t\t// wrongly.\n\t\tif (\n\t\t\t(lastClosedEditor.sticky && !this.editorGroupService.activeGroup.isSticky(lastClosedEditor.index)) ||\n\t\t\t(!lastClosedEditor.sticky && this.editorGroupService.activeGroup.isSticky(lastClosedEditor.index))\n\t\t) {\n\t\t\toptions.index = undefined;\n\t\t}\n\n\t\t// Re-open editor unless already opened\n\t\tlet editorPane: IEditorPane | undefined = undefined;\n\t\tif (!this.editorGroupService.activeGroup.contains(lastClosedEditor.editor)) {\n\n\t\t\t// Fix for https://github.com/microsoft/vscode/issues/107850\n\t\t\t// If opening an editor fails, it is possible that we get\n\t\t\t// another editor-close event as a result. But we really do\n\t\t\t// want to ignore that in our list of recently closed editors\n\t\t\t//  to prevent endless loops.\n\n\t\t\tthis.ignoreEditorCloseEvent = true;\n\t\t\ttry {\n\t\t\t\teditorPane = await this.editorService.openEditor({\n\t\t\t\t\t...lastClosedEditor.editor,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...lastClosedEditor.editor.options,\n\t\t\t\t\t\t...options\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} finally {\n\t\t\t\tthis.ignoreEditorCloseEvent = false;\n\t\t\t}\n\t\t}\n\n\t\t// If no editor was opened, try with the next one\n\t\tif (!editorPane) {\n\n\t\t\t// Fix for https://github.com/microsoft/vscode/issues/67882\n\t\t\t// If opening of the editor fails, make sure to try the next one\n\t\t\t// but make sure to remove this one from the list to prevent\n\t\t\t// endless loops.\n\t\t\tremove(this.recentlyClosedEditors, lastClosedEditor);\n\n\t\t\t// Try with next one\n\t\t\tthis.reopenLastClosedEditor();\n\t\t}\n\t}\n\n\tprivate removeFromRecentlyClosedEditors(arg1: EditorInput | FileChangesEvent | FileOperationEvent): void {\n\t\tthis.recentlyClosedEditors = this.recentlyClosedEditors.filter(recentlyClosedEditor => {\n\t\t\tif (isEditorInput(arg1) && recentlyClosedEditor.editorId !== arg1.editorId) {\n\t\t\t\treturn true; // keep: different editor identifiers\n\t\t\t}\n\n\t\t\tif (recentlyClosedEditor.resource && this.editorHelper.matchesFile(recentlyClosedEditor.resource, arg1)) {\n\t\t\t\treturn false; // remove: editor matches directly\n\t\t\t}\n\n\t\t\tif (recentlyClosedEditor.associatedResources.some(associatedResource => this.editorHelper.matchesFile(associatedResource, arg1))) {\n\t\t\t\treturn false; // remove: an associated resource matches\n\t\t\t}\n\n\t\t\treturn true; // keep\n\t\t});\n\n\t\t// Update context\n\t\tthis.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length > 0);\n\t}\n\n\t//#endregion\n\n\t//#region Go to: Recently Opened Editor (limit: 200, persisted)\n\n\tprivate static readonly MAX_HISTORY_ITEMS = 200;\n\tprivate static readonly HISTORY_STORAGE_KEY = 'history.entries';\n\n\tprivate history: Array<EditorInput | IResourceEditorInput> | undefined = undefined;\n\n\tprivate readonly editorHistoryListeners = new Map<EditorInput, DisposableStore>();\n\n\tprivate readonly resourceExcludeMatcher = this._register(new WindowIdleValue(mainWindow, () => {\n\t\tconst matcher = this._register(this.instantiationService.createInstance(\n\t\t\tResourceGlobMatcher,\n\t\t\troot => getExcludes(root ? this.configurationService.getValue<ISearchConfiguration>({ resource: root }) : this.configurationService.getValue<ISearchConfiguration>()) || Object.create(null),\n\t\t\tevent => event.affectsConfiguration(FILES_EXCLUDE_CONFIG) || event.affectsConfiguration(SEARCH_EXCLUDE_CONFIG)\n\t\t));\n\n\t\tthis._register(matcher.onExpressionChange(() => this.removeExcludedFromHistory()));\n\n\t\treturn matcher;\n\t}));\n\n\tprivate handleActiveEditorChangeInHistory(editorPane?: IEditorPane): void {\n\n\t\t// Ensure we have not configured to exclude input and don't track invalid inputs\n\t\tconst editor = editorPane?.input;\n\t\tif (!editor || editor.isDisposed() || !this.includeInHistory(editor)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove any existing entry and add to the beginning\n\t\tthis.removeFromHistory(editor);\n\t\tthis.addToHistory(editor);\n\t}\n\n\tprivate addToHistory(editor: EditorInput | IResourceEditorInput, insertFirst = true): void {\n\t\tthis.ensureHistoryLoaded(this.history);\n\n\t\tconst historyInput = this.editorHelper.preferResourceEditorInput(editor);\n\t\tif (!historyInput) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Insert based on preference\n\t\tif (insertFirst) {\n\t\t\tthis.history.unshift(historyInput);\n\t\t} else {\n\t\t\tthis.history.push(historyInput);\n\t\t}\n\n\t\t// Respect max entries setting\n\t\tif (this.history.length > HistoryService.MAX_HISTORY_ITEMS) {\n\t\t\tthis.editorHelper.clearOnEditorDispose(this.history.pop()!, this.editorHistoryListeners);\n\t\t}\n\n\t\t// React to editor input disposing\n\t\tif (isEditorInput(editor)) {\n\t\t\tthis.editorHelper.onEditorDispose(editor, () => this.updateHistoryOnEditorDispose(historyInput), this.editorHistoryListeners);\n\t\t}\n\t}\n\n\tprivate updateHistoryOnEditorDispose(editor: EditorInput | IResourceEditorInput): void {\n\t\tif (isEditorInput(editor)) {\n\n\t\t\t// Any non side-by-side editor input gets removed directly on dispose\n\t\t\tif (!isSideBySideEditorInput(editor)) {\n\t\t\t\tthis.removeFromHistory(editor);\n\t\t\t}\n\n\t\t\t// Side-by-side editors get special treatment: we try to distill the\n\t\t\t// possibly untyped resource inputs from both sides to be able to\n\t\t\t// offer these entries from the history to the user still unless\n\t\t\t// they are excluded.\n\t\t\telse {\n\t\t\t\tconst resourceInputs: IResourceEditorInput[] = [];\n\t\t\t\tconst sideInputs = editor.primary.matches(editor.secondary) ? [editor.primary] : [editor.primary, editor.secondary];\n\t\t\t\tfor (const sideInput of sideInputs) {\n\t\t\t\t\tconst candidateResourceInput = this.editorHelper.preferResourceEditorInput(sideInput);\n\t\t\t\t\tif (isResourceEditorInput(candidateResourceInput) && this.includeInHistory(candidateResourceInput)) {\n\t\t\t\t\t\tresourceInputs.push(candidateResourceInput);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Insert the untyped resource inputs where our disposed\n\t\t\t\t// side-by-side editor input is in the history stack\n\t\t\t\tthis.replaceInHistory(editor, ...resourceInputs);\n\t\t\t}\n\t\t} else {\n\n\t\t\t// Remove any editor that should not be included in history\n\t\t\tif (!this.includeInHistory(editor)) {\n\t\t\t\tthis.removeFromHistory(editor);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate includeInHistory(editor: EditorInput | IResourceEditorInput): boolean {\n\t\tif (isEditorInput(editor)) {\n\t\t\treturn true; // include any non files\n\t\t}\n\n\t\treturn !this.resourceExcludeMatcher.value.matches(editor.resource);\n\t}\n\n\tprivate removeExcludedFromHistory(): void {\n\t\tthis.ensureHistoryLoaded(this.history);\n\n\t\tthis.history = this.history.filter(entry => {\n\t\t\tconst include = this.includeInHistory(entry);\n\n\t\t\t// Cleanup any listeners associated with the input when removing from history\n\t\t\tif (!include) {\n\t\t\t\tthis.editorHelper.clearOnEditorDispose(entry, this.editorHistoryListeners);\n\t\t\t}\n\n\t\t\treturn include;\n\t\t});\n\t}\n\n\tprivate moveInHistory(event: FileOperationEvent): void {\n\t\tif (event.isOperation(FileOperation.MOVE)) {\n\t\t\tconst removed = this.removeFromHistory(event);\n\t\t\tif (removed) {\n\t\t\t\tthis.addToHistory({ resource: event.target.resource });\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFromHistory(arg1: EditorInput | IResourceEditorInput | FileChangesEvent | FileOperationEvent): boolean {\n\t\tlet removed = false;\n\n\t\tthis.ensureHistoryLoaded(this.history);\n\n\t\tthis.history = this.history.filter(entry => {\n\t\t\tconst matches = this.editorHelper.matchesEditor(arg1, entry);\n\n\t\t\t// Cleanup any listeners associated with the input when removing from history\n\t\t\tif (matches) {\n\t\t\t\tthis.editorHelper.clearOnEditorDispose(arg1, this.editorHistoryListeners);\n\t\t\t\tremoved = true;\n\t\t\t}\n\n\t\t\treturn !matches;\n\t\t});\n\n\t\treturn removed;\n\t}\n\n\tprivate replaceInHistory(editor: EditorInput | IResourceEditorInput, ...replacements: ReadonlyArray<EditorInput | IResourceEditorInput>): void {\n\t\tthis.ensureHistoryLoaded(this.history);\n\n\t\tlet replaced = false;\n\n\t\tconst newHistory: Array<EditorInput | IResourceEditorInput> = [];\n\t\tfor (const entry of this.history) {\n\n\t\t\t// Entry matches and is going to be disposed + replaced\n\t\t\tif (this.editorHelper.matchesEditor(editor, entry)) {\n\n\t\t\t\t// Cleanup any listeners associated with the input when replacing from history\n\t\t\t\tthis.editorHelper.clearOnEditorDispose(editor, this.editorHistoryListeners);\n\n\t\t\t\t// Insert replacements but only once\n\t\t\t\tif (!replaced) {\n\t\t\t\t\tnewHistory.push(...replacements);\n\t\t\t\t\treplaced = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Entry does not match, but only add it if it didn't match\n\t\t\t// our replacements already\n\t\t\telse if (!replacements.some(replacement => this.editorHelper.matchesEditor(replacement, entry))) {\n\t\t\t\tnewHistory.push(entry);\n\t\t\t}\n\t\t}\n\n\t\t// If the target editor to replace was not found, make sure to\n\t\t// insert the replacements to the end to ensure we got them\n\t\tif (!replaced) {\n\t\t\tnewHistory.push(...replacements);\n\t\t}\n\n\t\tthis.history = newHistory;\n\t}\n\n\tclearRecentlyOpened(): void {\n\t\tthis.history = [];\n\n\t\tfor (const [, disposable] of this.editorHistoryListeners) {\n\t\t\tdispose(disposable);\n\t\t}\n\t\tthis.editorHistoryListeners.clear();\n\t}\n\n\tgetHistory(): readonly (EditorInput | IResourceEditorInput)[] {\n\t\tthis.ensureHistoryLoaded(this.history);\n\n\t\treturn this.history;\n\t}\n\n\tprivate ensureHistoryLoaded(history: Array<EditorInput | IResourceEditorInput> | undefined): asserts history {\n\t\tif (!this.history) {\n\n\t\t\t// Until history is loaded, it is just empty\n\t\t\tthis.history = [];\n\n\t\t\t// We want to seed history from opened editors\n\t\t\t// too as well as previous stored state, so we\n\t\t\t// need to wait for the editor groups being ready\n\t\t\tif (this.editorGroupService.isReady) {\n\t\t\t\tthis.loadHistory();\n\t\t\t} else {\n\t\t\t\t(async () => {\n\t\t\t\t\tawait this.editorGroupService.whenReady;\n\n\t\t\t\t\tthis.loadHistory();\n\t\t\t\t})();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate loadHistory(): void {\n\n\t\t// Init as empty before adding - since we are about to\n\t\t// populate the history from opened editors, we capture\n\t\t// the right order here.\n\t\tthis.history = [];\n\n\t\t// All stored editors from previous session\n\t\tconst storedEditorHistory = this.loadHistoryFromStorage();\n\n\t\t// All restored editors from previous session\n\t\t// in reverse editor from least to most recently\n\t\t// used.\n\t\tconst openedEditorsLru = [...this.editorService.getEditors(EditorsOrder.MOST_RECENTLY_ACTIVE)].reverse();\n\n\t\t// We want to merge the opened editors from the last\n\t\t// session with the stored editors from the last\n\t\t// session. Because not all editors can be serialised\n\t\t// we want to make sure to include all opened editors\n\t\t// too.\n\t\t// Opened editors should always be first in the history\n\n\t\tconst handledEditors = new Set<string /* resource + editorId */>();\n\n\t\t// Add all opened editors first\n\t\tfor (const { editor } of openedEditorsLru) {\n\t\t\tif (!this.includeInHistory(editor)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Make sure to skip duplicates from the editors LRU\n\t\t\tif (editor.resource) {\n\t\t\t\tconst historyEntryId = `${editor.resource.toString()}/${editor.editorId}`;\n\t\t\t\tif (handledEditors.has(historyEntryId)) {\n\t\t\t\t\tcontinue; // already added\n\t\t\t\t}\n\n\t\t\t\thandledEditors.add(historyEntryId);\n\t\t\t}\n\n\t\t\t// Add into history\n\t\t\tthis.addToHistory(editor);\n\t\t}\n\n\t\t// Add remaining from storage if not there already\n\t\t// We check on resource and `editorId` (from `override`)\n\t\t// to figure out if the editor has been already added.\n\t\tfor (const editor of storedEditorHistory) {\n\t\t\tconst historyEntryId = `${editor.resource.toString()}/${editor.options?.override}`;\n\t\t\tif (\n\t\t\t\t!handledEditors.has(historyEntryId) &&\n\t\t\t\tthis.includeInHistory(editor)\n\t\t\t) {\n\t\t\t\thandledEditors.add(historyEntryId);\n\t\t\t\tthis.addToHistory(editor, false /* at the end */);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate loadHistoryFromStorage(): Array<IResourceEditorInput> {\n\t\tconst entries: IResourceEditorInput[] = [];\n\n\t\tconst entriesRaw = this.storageService.get(HistoryService.HISTORY_STORAGE_KEY, StorageScope.WORKSPACE);\n\t\tif (entriesRaw) {\n\t\t\ttry {\n\t\t\t\tconst entriesParsed: ISerializedEditorHistoryEntry[] = JSON.parse(entriesRaw);\n\t\t\t\tfor (const entryParsed of entriesParsed) {\n\t\t\t\t\tif (!entryParsed.editor || !entryParsed.editor.resource) {\n\t\t\t\t\t\tcontinue; // unexpected data format\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tentries.push({\n\t\t\t\t\t\t\t...entryParsed.editor,\n\t\t\t\t\t\t\tresource: typeof entryParsed.editor.resource === 'string' ?\n\t\t\t\t\t\t\t\tURI.parse(entryParsed.editor.resource) :  \t//  from 1.67.x: URI is stored efficiently as URI.toString()\n\t\t\t\t\t\t\t\tURI.from(entryParsed.editor.resource)\t\t// until 1.66.x: URI was stored very verbose as URI.toJSON()\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tonUnexpectedError(error); // do not fail entire history when one entry fails\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tonUnexpectedError(error); // https://github.com/microsoft/vscode/issues/99075\n\t\t\t}\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tprivate saveState(): void {\n\t\tif (!this.history) {\n\t\t\treturn; // nothing to save because history was not used\n\t\t}\n\n\t\tconst entries: ISerializedEditorHistoryEntry[] = [];\n\t\tfor (const editor of this.history) {\n\t\t\tif (isEditorInput(editor) || !isResourceEditorInput(editor)) {\n\t\t\t\tcontinue; // only save resource editor inputs\n\t\t\t}\n\n\t\t\tentries.push({\n\t\t\t\teditor: {\n\t\t\t\t\t...editor,\n\t\t\t\t\tresource: editor.resource.toString()\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.storageService.store(HistoryService.HISTORY_STORAGE_KEY, JSON.stringify(entries), StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t}\n\n\t//#endregion\n\n\t//#region Last Active Workspace/File\n\n\tgetLastActiveWorkspaceRoot(schemeFilter?: string, authorityFilter?: string): URI | undefined {\n\n\t\t// No Folder: return early\n\t\tconst folders = this.contextService.getWorkspace().folders;\n\t\tif (folders.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Single Folder: return early\n\t\tif (folders.length === 1) {\n\t\t\tconst resource = folders[0].uri;\n\t\t\tif ((!schemeFilter || resource.scheme === schemeFilter) && (!authorityFilter || resource.authority === authorityFilter)) {\n\t\t\t\treturn resource;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Multiple folders: find the last active one\n\t\tfor (const input of this.getHistory()) {\n\t\t\tif (isEditorInput(input)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (schemeFilter && input.resource.scheme !== schemeFilter) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (authorityFilter && input.resource.authority !== authorityFilter) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst resourceWorkspace = this.contextService.getWorkspaceFolder(input.resource);\n\t\t\tif (resourceWorkspace) {\n\t\t\t\treturn resourceWorkspace.uri;\n\t\t\t}\n\t\t}\n\n\t\t// Fallback to first workspace matching scheme filter if any\n\t\tfor (const folder of folders) {\n\t\t\tconst resource = folder.uri;\n\t\t\tif ((!schemeFilter || resource.scheme === schemeFilter) && (!authorityFilter || resource.authority === authorityFilter)) {\n\t\t\t\treturn resource;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetLastActiveFile(filterByScheme: string, filterByAuthority?: string): URI | undefined {\n\t\tfor (const input of this.getHistory()) {\n\t\t\tlet resource: URI | undefined;\n\t\t\tif (isEditorInput(input)) {\n\t\t\t\tresource = EditorResourceAccessor.getOriginalUri(input, { filterByScheme });\n\t\t\t} else {\n\t\t\t\tresource = input.resource;\n\t\t\t}\n\n\t\t\tif (resource && resource.scheme === filterByScheme && (!filterByAuthority || resource.authority === filterByAuthority)) {\n\t\t\t\treturn resource;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t//#endregion\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tfor (const [, stack] of this.editorGroupScopedNavigationStacks) {\n\t\t\tstack.disposable.dispose();\n\t\t}\n\n\t\tfor (const [, editors] of this.editorScopedNavigationStacks) {\n\t\t\tfor (const [, stack] of editors) {\n\t\t\t\tstack.disposable.dispose();\n\t\t\t}\n\t\t}\n\n\t\tfor (const [, listener] of this.editorHistoryListeners) {\n\t\t\tlistener.dispose();\n\t\t}\n\t}\n}\n\nregisterSingleton(IHistoryService, HistoryService, InstantiationType.Eager);\n\nclass EditorSelectionState {\n\n\tconstructor(\n\t\tprivate readonly editorIdentifier: IEditorIdentifier,\n\t\treadonly selection: IEditorPaneSelection | undefined,\n\t\tprivate readonly reason: EditorPaneSelectionChangeReason | undefined\n\t) { }\n\n\tjustifiesNewNavigationEntry(other: EditorSelectionState): boolean {\n\t\tif (this.editorIdentifier.groupId !== other.editorIdentifier.groupId) {\n\t\t\treturn true; // different group\n\t\t}\n\n\t\tif (!this.editorIdentifier.editor.matches(other.editorIdentifier.editor)) {\n\t\t\treturn true; // different editor\n\t\t}\n\n\t\tif (!this.selection || !other.selection) {\n\t\t\treturn true; // unknown selections\n\t\t}\n\n\t\tconst result = this.selection.compare(other.selection);\n\n\t\tif (result === EditorPaneSelectionCompareResult.SIMILAR && (other.reason === EditorPaneSelectionChangeReason.NAVIGATION || other.reason === EditorPaneSelectionChangeReason.JUMP)) {\n\t\t\t// let navigation sources win even if the selection is `SIMILAR`\n\t\t\t// (e.g. \"Go to definition\" should add a history entry)\n\t\t\treturn true;\n\t\t}\n\n\t\treturn result === EditorPaneSelectionCompareResult.DIFFERENT;\n\t}\n}\n\ninterface IEditorNavigationStacks extends IDisposable {\n\treadonly onDidChange: Event<void>;\n\n\tcanGoForward(filter?: GoFilter): boolean;\n\tgoForward(filter?: GoFilter): Promise<void>;\n\tcanGoBack(filter?: GoFilter): boolean;\n\tgoBack(filter?: GoFilter): Promise<void>;\n\tgoPrevious(filter?: GoFilter): Promise<void>;\n\tcanGoLast(filter?: GoFilter): boolean;\n\tgoLast(filter?: GoFilter): Promise<void>;\n\n\thandleActiveEditorChange(editorPane?: IEditorPane): void;\n\thandleActiveEditorSelectionChange(editorPane: IEditorPaneWithSelection, event: IEditorPaneSelectionChangeEvent): void;\n\n\tclear(): void;\n\tremove(arg1: EditorInput | FileChangesEvent | FileOperationEvent | GroupIdentifier): void;\n\tmove(event: FileOperationEvent): void;\n}\n\nclass EditorNavigationStacks extends Disposable implements IEditorNavigationStacks {\n\n\tprivate readonly selectionsStack: EditorNavigationStack;\n\tprivate readonly editsStack: EditorNavigationStack;\n\tprivate readonly navigationsStack: EditorNavigationStack;\n\n\tprivate readonly stacks: EditorNavigationStack[];\n\n\treadonly onDidChange: Event<void>;\n\n\tconstructor(\n\t\tprivate readonly scope: GoScope,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\n\t\tthis.selectionsStack = this._register(this.instantiationService.createInstance(EditorNavigationStack, GoFilter.NONE, this.scope));\n\t\tthis.editsStack = this._register(this.instantiationService.createInstance(EditorNavigationStack, GoFilter.EDITS, this.scope));\n\t\tthis.navigationsStack = this._register(this.instantiationService.createInstance(EditorNavigationStack, GoFilter.NAVIGATION, this.scope));\n\n\t\tthis.stacks = [\n\t\t\tthis.selectionsStack,\n\t\t\tthis.editsStack,\n\t\t\tthis.navigationsStack\n\t\t];\n\n\t\tthis.onDidChange = Event.any(\n\t\t\tthis.selectionsStack.onDidChange,\n\t\t\tthis.editsStack.onDidChange,\n\t\t\tthis.navigationsStack.onDidChange\n\t\t);\n\t}\n\n\tcanGoForward(filter?: GoFilter): boolean {\n\t\treturn this.getStack(filter).canGoForward();\n\t}\n\n\tgoForward(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack(filter).goForward();\n\t}\n\n\tcanGoBack(filter?: GoFilter): boolean {\n\t\treturn this.getStack(filter).canGoBack();\n\t}\n\n\tgoBack(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack(filter).goBack();\n\t}\n\n\tgoPrevious(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack(filter).goPrevious();\n\t}\n\n\tcanGoLast(filter?: GoFilter): boolean {\n\t\treturn this.getStack(filter).canGoLast();\n\t}\n\n\tgoLast(filter?: GoFilter): Promise<void> {\n\t\treturn this.getStack(filter).goLast();\n\t}\n\n\tprivate getStack(filter = GoFilter.NONE): EditorNavigationStack {\n\t\tswitch (filter) {\n\t\t\tcase GoFilter.NONE: return this.selectionsStack;\n\t\t\tcase GoFilter.EDITS: return this.editsStack;\n\t\t\tcase GoFilter.NAVIGATION: return this.navigationsStack;\n\t\t}\n\t}\n\n\thandleActiveEditorChange(editorPane?: IEditorPane): void {\n\n\t\t// Always send to selections navigation stack\n\t\tthis.selectionsStack.notifyNavigation(editorPane);\n\t}\n\n\thandleActiveEditorSelectionChange(editorPane: IEditorPaneWithSelection, event: IEditorPaneSelectionChangeEvent): void {\n\t\tconst previous = this.selectionsStack.current;\n\n\t\t// Always send to selections navigation stack\n\t\tthis.selectionsStack.notifyNavigation(editorPane, event);\n\n\t\t// Check for edits\n\t\tif (event.reason === EditorPaneSelectionChangeReason.EDIT) {\n\t\t\tthis.editsStack.notifyNavigation(editorPane, event);\n\t\t}\n\n\t\t// Check for navigations\n\t\t//\n\t\t// Note: ignore if selections navigation stack is navigating because\n\t\t// in that case we do not want to receive repeated entries in\n\t\t// the navigation stack.\n\t\telse if (\n\t\t\t(event.reason === EditorPaneSelectionChangeReason.NAVIGATION || event.reason === EditorPaneSelectionChangeReason.JUMP) &&\n\t\t\t!this.selectionsStack.isNavigating()\n\t\t) {\n\n\t\t\t// A \"JUMP\" navigation selection change always has a source and\n\t\t\t// target. As such, we add the previous entry of the selections\n\t\t\t// navigation stack so that our navigation stack receives both\n\t\t\t// entries unless the user is currently navigating.\n\n\t\t\tif (event.reason === EditorPaneSelectionChangeReason.JUMP && !this.navigationsStack.isNavigating()) {\n\t\t\t\tif (previous) {\n\t\t\t\t\tthis.navigationsStack.addOrReplace(previous.groupId, previous.editor, previous.selection);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.navigationsStack.notifyNavigation(editorPane, event);\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tfor (const stack of this.stacks) {\n\t\t\tstack.clear();\n\t\t}\n\t}\n\n\tremove(arg1: EditorInput | FileChangesEvent | FileOperationEvent | GroupIdentifier): void {\n\t\tfor (const stack of this.stacks) {\n\t\t\tstack.remove(arg1);\n\t\t}\n\t}\n\n\tmove(event: FileOperationEvent): void {\n\t\tfor (const stack of this.stacks) {\n\t\t\tstack.move(event);\n\t\t}\n\t}\n}\n\nclass NoOpEditorNavigationStacks implements IEditorNavigationStacks {\n\tonDidChange = Event.None;\n\n\tcanGoForward(): boolean { return false; }\n\tasync goForward(): Promise<void> { }\n\tcanGoBack(): boolean { return false; }\n\tasync goBack(): Promise<void> { }\n\tasync goPrevious(): Promise<void> { }\n\tcanGoLast(): boolean { return false; }\n\tasync goLast(): Promise<void> { }\n\n\thandleActiveEditorChange(): void { }\n\thandleActiveEditorSelectionChange(): void { }\n\n\tclear(): void { }\n\tremove(): void { }\n\tmove(): void { }\n\n\tdispose(): void { }\n}\n\ninterface IEditorNavigationStackEntry {\n\tgroupId: GroupIdentifier;\n\teditor: EditorInput | IResourceEditorInput;\n\tselection?: IEditorPaneSelection;\n}\n\nexport class EditorNavigationStack extends Disposable {\n\n\tprivate static readonly MAX_STACK_SIZE = 50;\n\n\tprivate readonly _onDidChange = this._register(new Emitter<void>());\n\treadonly onDidChange = this._onDidChange.event;\n\n\tprivate readonly mapEditorToDisposable = new Map<EditorInput, DisposableStore>();\n\tprivate readonly mapGroupToDisposable = new Map<GroupIdentifier, IDisposable>();\n\n\tprivate readonly editorHelper: EditorHelper;\n\n\tprivate stack: IEditorNavigationStackEntry[] = [];\n\n\tprivate index = -1;\n\tprivate previousIndex = -1;\n\n\tprivate navigating = false;\n\n\tprivate currentSelectionState: EditorSelectionState | undefined = undefined;\n\n\tget current(): IEditorNavigationStackEntry | undefined {\n\t\treturn this.stack[this.index];\n\t}\n\n\tprivate set current(entry: IEditorNavigationStackEntry | undefined) {\n\t\tif (entry) {\n\t\t\tthis.stack[this.index] = entry;\n\t\t}\n\t}\n\n\tconstructor(\n\t\tprivate readonly filter: GoFilter,\n\t\tprivate readonly scope: GoScope,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly editorGroupService: IEditorGroupsService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper();\n\n\t\tthis.editorHelper = instantiationService.createInstance(EditorHelper);\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(this.onDidChange(() => this.traceStack()));\n\t\tthis._register(this.logService.onDidChangeLogLevel(() => this.traceStack()));\n\t}\n\n\tprivate traceStack(): void {\n\t\tif (this.logService.getLevel() !== LogLevel.Trace) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst entryLabels: string[] = [];\n\t\tfor (const entry of this.stack) {\n\t\t\tif (typeof entry.selection?.log === 'function') {\n\t\t\t\tentryLabels.push(`- group: ${entry.groupId}, editor: ${entry.editor.resource?.toString()}, selection: ${entry.selection.log()}`);\n\t\t\t} else {\n\t\t\t\tentryLabels.push(`- group: ${entry.groupId}, editor: ${entry.editor.resource?.toString()}, selection: <none>`);\n\t\t\t}\n\t\t}\n\n\t\tif (entryLabels.length === 0) {\n\t\t\tthis.trace(`index: ${this.index}, navigating: ${this.isNavigating()}: <empty>`);\n\t\t} else {\n\t\t\tthis.trace(`index: ${this.index}, navigating: ${this.isNavigating()}\n${entryLabels.join('\\n')}\n\t\t\t`);\n\t\t}\n\t}\n\n\tprivate trace(msg: string, editor: EditorInput | IResourceEditorInput | undefined | null = null, event?: IEditorPaneSelectionChangeEvent): void {\n\t\tif (this.logService.getLevel() !== LogLevel.Trace) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet filterLabel: string;\n\t\tswitch (this.filter) {\n\t\t\tcase GoFilter.NONE: filterLabel = 'global';\n\t\t\t\tbreak;\n\t\t\tcase GoFilter.EDITS: filterLabel = 'edits';\n\t\t\t\tbreak;\n\t\t\tcase GoFilter.NAVIGATION: filterLabel = 'navigation';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet scopeLabel: string;\n\t\tswitch (this.scope) {\n\t\t\tcase GoScope.DEFAULT: scopeLabel = 'default';\n\t\t\t\tbreak;\n\t\t\tcase GoScope.EDITOR_GROUP: scopeLabel = 'editorGroup';\n\t\t\t\tbreak;\n\t\t\tcase GoScope.EDITOR: scopeLabel = 'editor';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (editor !== null) {\n\t\t\tthis.logService.trace(`[History stack ${filterLabel}-${scopeLabel}]: ${msg} (editor: ${editor?.resource?.toString()}, event: ${this.traceEvent(event)})`);\n\t\t} else {\n\t\t\tthis.logService.trace(`[History stack ${filterLabel}-${scopeLabel}]: ${msg}`);\n\t\t}\n\t}\n\n\tprivate traceEvent(event?: IEditorPaneSelectionChangeEvent): string {\n\t\tif (!event) {\n\t\t\treturn '<none>';\n\t\t}\n\n\t\tswitch (event.reason) {\n\t\t\tcase EditorPaneSelectionChangeReason.EDIT: return 'edit';\n\t\t\tcase EditorPaneSelectionChangeReason.NAVIGATION: return 'navigation';\n\t\t\tcase EditorPaneSelectionChangeReason.JUMP: return 'jump';\n\t\t\tcase EditorPaneSelectionChangeReason.PROGRAMMATIC: return 'programmatic';\n\t\t\tcase EditorPaneSelectionChangeReason.USER: return 'user';\n\t\t}\n\t}\n\n\tprivate registerGroupListeners(groupId: GroupIdentifier): void {\n\t\tif (!this.mapGroupToDisposable.has(groupId)) {\n\t\t\tconst group = this.editorGroupService.getGroup(groupId);\n\t\t\tif (group) {\n\t\t\t\tthis.mapGroupToDisposable.set(groupId, group.onWillMoveEditor(e => this.onWillMoveEditor(e)));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onWillMoveEditor(e: IEditorWillMoveEvent): void {\n\t\tthis.trace('onWillMoveEditor()', e.editor);\n\n\t\tif (this.scope === GoScope.EDITOR_GROUP) {\n\t\t\treturn; // ignore move events if our scope is group based\n\t\t}\n\n\t\tfor (const entry of this.stack) {\n\t\t\tif (entry.groupId !== e.groupId) {\n\t\t\t\tcontinue; // not in the group that reported the event\n\t\t\t}\n\n\t\t\tif (!this.editorHelper.matchesEditor(e.editor, entry.editor)) {\n\t\t\t\tcontinue; // not the editor this event is about\n\t\t\t}\n\n\t\t\t// Update to target group\n\t\t\tentry.groupId = e.target;\n\t\t}\n\t}\n\n\t//#region Stack Mutation\n\n\tnotifyNavigation(editorPane: IEditorPane | undefined, event?: IEditorPaneSelectionChangeEvent): void {\n\t\tthis.trace('notifyNavigation()', editorPane?.input, event);\n\n\t\tconst isSelectionAwareEditorPane = isEditorPaneWithSelection(editorPane);\n\t\tconst hasValidEditor = editorPane?.input && !editorPane.input.isDisposed();\n\n\t\t// Treat editor changes that happen as part of stack navigation specially\n\t\t// we do not want to add a new stack entry as a matter of navigating the\n\t\t// stack but we need to keep our currentEditorSelectionState up to date\n\t\t// with the navigtion that occurs.\n\t\tif (this.navigating) {\n\t\t\tthis.trace(`notifyNavigation() ignoring (navigating)`, editorPane?.input, event);\n\n\t\t\tif (isSelectionAwareEditorPane && hasValidEditor) {\n\t\t\t\tthis.trace('notifyNavigation() updating current selection state', editorPane?.input, event);\n\n\t\t\t\tthis.currentSelectionState = new EditorSelectionState({ groupId: editorPane.group.id, editor: editorPane.input }, editorPane.getSelection(), event?.reason);\n\t\t\t} else {\n\t\t\t\tthis.trace('notifyNavigation() dropping current selection state', editorPane?.input, event);\n\n\t\t\t\tthis.currentSelectionState = undefined; // we navigated to a non-selection aware or disposed editor\n\t\t\t}\n\t\t}\n\n\t\t// Normal navigation not part of stack navigation\n\t\telse {\n\t\t\tthis.trace(`notifyNavigation() not ignoring`, editorPane?.input, event);\n\n\t\t\t// Navigation inside selection aware editor\n\t\t\tif (isSelectionAwareEditorPane && hasValidEditor) {\n\t\t\t\tthis.onSelectionAwareEditorNavigation(editorPane.group.id, editorPane.input, editorPane.getSelection(), event);\n\t\t\t}\n\n\t\t\t// Navigation to non-selection aware or disposed editor\n\t\t\telse {\n\t\t\t\tthis.currentSelectionState = undefined; // at this time we have no active selection aware editor\n\n\t\t\t\tif (hasValidEditor) {\n\t\t\t\t\tthis.onNonSelectionAwareEditorNavigation(editorPane.group.id, editorPane.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onSelectionAwareEditorNavigation(groupId: GroupIdentifier, editor: EditorInput, selection: IEditorPaneSelection | undefined, event?: IEditorPaneSelectionChangeEvent): void {\n\t\tif (this.current?.groupId === groupId && !selection && this.editorHelper.matchesEditor(this.current.editor, editor)) {\n\t\t\treturn; // do not push same editor input again of same group if we have no valid selection\n\t\t}\n\n\t\tthis.trace('onSelectionAwareEditorNavigation()', editor, event);\n\n\t\tconst stateCandidate = new EditorSelectionState({ groupId, editor }, selection, event?.reason);\n\n\t\t// Add to stack if we dont have a current state or this new state justifies a push\n\t\tif (!this.currentSelectionState || this.currentSelectionState.justifiesNewNavigationEntry(stateCandidate)) {\n\t\t\tthis.doAdd(groupId, editor, stateCandidate.selection);\n\t\t}\n\n\t\t// Otherwise we replace the current stack entry with this one\n\t\telse {\n\t\t\tthis.doReplace(groupId, editor, stateCandidate.selection);\n\t\t}\n\n\t\t// Update our current navigation editor state\n\t\tthis.currentSelectionState = stateCandidate;\n\t}\n\n\tprivate onNonSelectionAwareEditorNavigation(groupId: GroupIdentifier, editor: EditorInput): void {\n\t\tif (this.current?.groupId === groupId && this.editorHelper.matchesEditor(this.current.editor, editor)) {\n\t\t\treturn; // do not push same editor input again of same group\n\t\t}\n\n\t\tthis.trace('onNonSelectionAwareEditorNavigation()', editor);\n\n\t\tthis.doAdd(groupId, editor);\n\t}\n\n\tprivate doAdd(groupId: GroupIdentifier, editor: EditorInput | IResourceEditorInput, selection?: IEditorPaneSelection): void {\n\t\tif (!this.navigating) {\n\t\t\tthis.addOrReplace(groupId, editor, selection);\n\t\t}\n\t}\n\n\tprivate doReplace(groupId: GroupIdentifier, editor: EditorInput | IResourceEditorInput, selection?: IEditorPaneSelection): void {\n\t\tif (!this.navigating) {\n\t\t\tthis.addOrReplace(groupId, editor, selection, true /* force replace */);\n\t\t}\n\t}\n\n\taddOrReplace(groupId: GroupIdentifier, editorCandidate: EditorInput | IResourceEditorInput, selection?: IEditorPaneSelection, forceReplace?: boolean): void {\n\n\t\t// Ensure we listen to changes in group\n\t\tthis.registerGroupListeners(groupId);\n\n\t\t// Check whether to replace an existing entry or not\n\t\tlet replace = false;\n\t\tif (this.current) {\n\t\t\tif (forceReplace) {\n\t\t\t\treplace = true; // replace if we are forced to\n\t\t\t} else if (this.shouldReplaceStackEntry(this.current, { groupId, editor: editorCandidate, selection })) {\n\t\t\t\treplace = true; // replace if the group & input is the same and selection indicates as such\n\t\t\t}\n\t\t}\n\n\t\tconst editor = this.editorHelper.preferResourceEditorInput(editorCandidate);\n\t\tif (!editor) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (replace) {\n\t\t\tthis.trace('replace()', editor);\n\t\t} else {\n\t\t\tthis.trace('add()', editor);\n\t\t}\n\n\t\tconst newStackEntry: IEditorNavigationStackEntry = { groupId, editor, selection };\n\n\t\t// Replace at current position\n\t\tconst removedEntries: IEditorNavigationStackEntry[] = [];\n\t\tif (replace) {\n\t\t\tif (this.current) {\n\t\t\t\tremovedEntries.push(this.current);\n\t\t\t}\n\t\t\tthis.current = newStackEntry;\n\t\t}\n\n\t\t// Add to stack at current position\n\t\telse {\n\n\t\t\t// If we are not at the end of history, we remove anything after\n\t\t\tif (this.stack.length > this.index + 1) {\n\t\t\t\tfor (let i = this.index + 1; i < this.stack.length; i++) {\n\t\t\t\t\tremovedEntries.push(this.stack[i]);\n\t\t\t\t}\n\n\t\t\t\tthis.stack = this.stack.slice(0, this.index + 1);\n\t\t\t}\n\n\t\t\t// Insert entry at index\n\t\t\tthis.stack.splice(this.index + 1, 0, newStackEntry);\n\n\t\t\t// Check for limit\n\t\t\tif (this.stack.length > EditorNavigationStack.MAX_STACK_SIZE) {\n\t\t\t\tremovedEntries.push(this.stack.shift()!); // remove first\n\t\t\t\tif (this.previousIndex >= 0) {\n\t\t\t\t\tthis.previousIndex--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.setIndex(this.index + 1, true /* skip event, we fire it later */);\n\t\t\t}\n\t\t}\n\n\t\t// Clear editor listeners from removed entries\n\t\tfor (const removedEntry of removedEntries) {\n\t\t\tthis.editorHelper.clearOnEditorDispose(removedEntry.editor, this.mapEditorToDisposable);\n\t\t}\n\n\t\t// Remove this from the stack unless the stack input is a resource\n\t\t// that can easily be restored even when the input gets disposed\n\t\tif (isEditorInput(editor)) {\n\t\t\tthis.editorHelper.onEditorDispose(editor, () => this.remove(editor), this.mapEditorToDisposable);\n\t\t}\n\n\t\t// Event\n\t\tthis._onDidChange.fire();\n\t}\n\n\tprivate shouldReplaceStackEntry(entry: IEditorNavigationStackEntry, candidate: IEditorNavigationStackEntry): boolean {\n\t\tif (entry.groupId !== candidate.groupId) {\n\t\t\treturn false; // different group\n\t\t}\n\n\t\tif (!this.editorHelper.matchesEditor(entry.editor, candidate.editor)) {\n\t\t\treturn false; // different editor\n\t\t}\n\n\t\tif (!entry.selection) {\n\t\t\treturn true; // always replace when we have no specific selection yet\n\t\t}\n\n\t\tif (!candidate.selection) {\n\t\t\treturn false; // otherwise, prefer to keep existing specific selection over new unspecific one\n\t\t}\n\n\t\t// Finally, replace when selections are considered identical\n\t\treturn entry.selection.compare(candidate.selection) === EditorPaneSelectionCompareResult.IDENTICAL;\n\t}\n\n\tmove(event: FileOperationEvent): void {\n\t\tif (event.isOperation(FileOperation.MOVE)) {\n\t\t\tfor (const entry of this.stack) {\n\t\t\t\tif (this.editorHelper.matchesEditor(event, entry.editor)) {\n\t\t\t\t\tentry.editor = { resource: event.target.resource };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove(arg1: EditorInput | FileChangesEvent | FileOperationEvent | GroupIdentifier): void {\n\t\tconst previousStackSize = this.stack.length;\n\n\t\t// Remove all stack entries that match `arg1`\n\t\tthis.stack = this.stack.filter(entry => {\n\t\t\tconst matches = typeof arg1 === 'number' ? entry.groupId === arg1 : this.editorHelper.matchesEditor(arg1, entry.editor);\n\n\t\t\t// Cleanup any listeners associated with the input when removing\n\t\t\tif (matches) {\n\t\t\t\tthis.editorHelper.clearOnEditorDispose(entry.editor, this.mapEditorToDisposable);\n\t\t\t}\n\n\t\t\treturn !matches;\n\t\t});\n\n\t\tif (previousStackSize === this.stack.length) {\n\t\t\treturn; // nothing removed\n\t\t}\n\n\t\t// Given we just removed entries, we need to make sure\n\t\t// to remove entries that are now identical and next\n\t\t// to each other to prevent no-op navigations.\n\t\tthis.flatten();\n\n\t\t// Reset indeces\n\t\tthis.index = this.stack.length - 1;\n\t\tthis.previousIndex = -1;\n\n\t\t// Clear group listener\n\t\tif (typeof arg1 === 'number') {\n\t\t\tthis.mapGroupToDisposable.get(arg1)?.dispose();\n\t\t\tthis.mapGroupToDisposable.delete(arg1);\n\t\t}\n\n\t\t// Event\n\t\tthis._onDidChange.fire();\n\t}\n\n\tprivate flatten(): void {\n\t\tconst flattenedStack: IEditorNavigationStackEntry[] = [];\n\n\t\tlet previousEntry: IEditorNavigationStackEntry | undefined = undefined;\n\t\tfor (const entry of this.stack) {\n\t\t\tif (previousEntry && this.shouldReplaceStackEntry(entry, previousEntry)) {\n\t\t\t\tcontinue; // skip over entry when it is considered the same\n\t\t\t}\n\n\t\t\tpreviousEntry = entry;\n\t\t\tflattenedStack.push(entry);\n\t\t}\n\n\t\tthis.stack = flattenedStack;\n\t}\n\n\tclear(): void {\n\t\tthis.index = -1;\n\t\tthis.previousIndex = -1;\n\t\tthis.stack.splice(0);\n\n\t\tfor (const [, disposable] of this.mapEditorToDisposable) {\n\t\t\tdispose(disposable);\n\t\t}\n\t\tthis.mapEditorToDisposable.clear();\n\n\t\tfor (const [, disposable] of this.mapGroupToDisposable) {\n\t\t\tdispose(disposable);\n\t\t}\n\t\tthis.mapGroupToDisposable.clear();\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.clear();\n\t}\n\n\t//#endregion\n\n\t//#region Navigation\n\n\tcanGoForward(): boolean {\n\t\treturn this.stack.length > this.index + 1;\n\t}\n\n\tasync goForward(): Promise<void> {\n\t\tconst navigated = await this.maybeGoCurrent();\n\t\tif (navigated) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.canGoForward()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this.index + 1);\n\t\treturn this.navigate();\n\t}\n\n\tcanGoBack(): boolean {\n\t\treturn this.index > 0;\n\t}\n\n\tasync goBack(): Promise<void> {\n\t\tconst navigated = await this.maybeGoCurrent();\n\t\tif (navigated) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.canGoBack()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this.index - 1);\n\t\treturn this.navigate();\n\t}\n\n\tasync goPrevious(): Promise<void> {\n\t\tconst navigated = await this.maybeGoCurrent();\n\t\tif (navigated) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If we never navigated, just go back\n\t\tif (this.previousIndex === -1) {\n\t\t\treturn this.goBack();\n\t\t}\n\n\t\t// Otherwise jump to previous stack entry\n\t\tthis.setIndex(this.previousIndex);\n\t\treturn this.navigate();\n\t}\n\n\tcanGoLast(): boolean {\n\t\treturn this.stack.length > 0;\n\t}\n\n\tasync goLast(): Promise<void> {\n\t\tif (!this.canGoLast()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIndex(this.stack.length - 1);\n\t\treturn this.navigate();\n\t}\n\n\tprivate async maybeGoCurrent(): Promise<boolean> {\n\n\t\t// When this navigation stack works with a specific\n\t\t// filter where not every selection change is added\n\t\t// to the stack, we want to first reveal the current\n\t\t// selection before attempting to navigate in the\n\t\t// stack.\n\n\t\tif (this.filter === GoFilter.NONE) {\n\t\t\treturn false; // only applies when  we are a filterd stack\n\t\t}\n\n\t\tif (this.isCurrentSelectionActive()) {\n\t\t\treturn false; // we are at the current navigation stop\n\t\t}\n\n\t\t// Go to current selection\n\t\tawait this.navigate();\n\n\t\treturn true;\n\t}\n\n\tprivate isCurrentSelectionActive(): boolean {\n\t\tif (!this.current?.selection) {\n\t\t\treturn false; // we need a current selection\n\t\t}\n\n\t\tconst pane = this.editorService.activeEditorPane;\n\t\tif (!isEditorPaneWithSelection(pane)) {\n\t\t\treturn false; // we need an active editor pane with selection support\n\t\t}\n\n\t\tif (pane.group.id !== this.current.groupId) {\n\t\t\treturn false; // we need matching groups\n\t\t}\n\n\t\tif (!pane.input || !this.editorHelper.matchesEditor(pane.input, this.current.editor)) {\n\t\t\treturn false; // we need matching editors\n\t\t}\n\n\t\tconst paneSelection = pane.getSelection();\n\t\tif (!paneSelection) {\n\t\t\treturn false; // we need a selection to compare with\n\t\t}\n\n\t\treturn paneSelection.compare(this.current.selection) === EditorPaneSelectionCompareResult.IDENTICAL;\n\t}\n\n\tprivate setIndex(newIndex: number, skipEvent?: boolean): void {\n\t\tthis.previousIndex = this.index;\n\t\tthis.index = newIndex;\n\n\t\t// Event\n\t\tif (!skipEvent) {\n\t\t\tthis._onDidChange.fire();\n\t\t}\n\t}\n\n\tprivate async navigate(): Promise<void> {\n\t\tthis.navigating = true;\n\n\t\ttry {\n\t\t\tif (this.current) {\n\t\t\t\tawait this.doNavigate(this.current);\n\t\t\t}\n\t\t} finally {\n\t\t\tthis.navigating = false;\n\t\t}\n\t}\n\n\tprivate doNavigate(location: IEditorNavigationStackEntry): Promise<IEditorPane | undefined> {\n\t\tlet options: IEditorOptions = Object.create(null);\n\n\t\t// Apply selection if any\n\t\tif (location.selection) {\n\t\t\toptions = location.selection.restore(options);\n\t\t}\n\n\t\tif (isEditorInput(location.editor)) {\n\t\t\treturn this.editorService.openEditor(location.editor, options, location.groupId);\n\t\t}\n\n\t\treturn this.editorService.openEditor({\n\t\t\t...location.editor,\n\t\t\toptions: {\n\t\t\t\t...location.editor.options,\n\t\t\t\t...options\n\t\t\t}\n\t\t}, location.groupId);\n\t}\n\n\tisNavigating(): boolean {\n\t\treturn this.navigating;\n\t}\n\n\t//#endregion\n}\n\nclass EditorHelper {\n\n\tconstructor(\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IPathService private readonly pathService: IPathService\n\t) { }\n\n\tpreferResourceEditorInput(editor: EditorInput): EditorInput | IResourceEditorInput;\n\tpreferResourceEditorInput(editor: IResourceEditorInput): IResourceEditorInput | undefined;\n\tpreferResourceEditorInput(editor: EditorInput | IResourceEditorInput): EditorInput | IResourceEditorInput | undefined;\n\tpreferResourceEditorInput(editor: EditorInput | IResourceEditorInput): EditorInput | IResourceEditorInput | undefined {\n\t\tconst resource = EditorResourceAccessor.getOriginalUri(editor);\n\n\t\t// For now, only prefer well known schemes that we control to prevent\n\t\t// issues such as https://github.com/microsoft/vscode/issues/85204\n\t\t// from being used as resource inputs\n\t\t// resource inputs survive editor disposal and as such are a lot more\n\t\t// durable across editor changes and restarts\n\t\tconst hasValidResourceEditorInputScheme =\n\t\t\tresource?.scheme === Schemas.file ||\n\t\t\tresource?.scheme === Schemas.vscodeRemote ||\n\t\t\tresource?.scheme === Schemas.vscodeUserData ||\n\t\t\tresource?.scheme === this.pathService.defaultUriScheme;\n\n\t\t// Scheme is valid: prefer the untyped input\n\t\t// over the typed input if possible to keep\n\t\t// the entry across restarts\n\t\tif (hasValidResourceEditorInputScheme) {\n\t\t\tif (isEditorInput(editor)) {\n\t\t\t\tconst untypedInput = editor.toUntyped();\n\t\t\t\tif (isResourceEditorInput(untypedInput)) {\n\t\t\t\t\treturn untypedInput;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn editor;\n\t\t}\n\n\t\t// Scheme is invalid: allow the editor input\n\t\t// for as long as it is not disposed\n\t\telse {\n\t\t\treturn isEditorInput(editor) ? editor : undefined;\n\t\t}\n\t}\n\n\tmatchesEditor(arg1: EditorInput | IResourceEditorInput | FileChangesEvent | FileOperationEvent, inputB: EditorInput | IResourceEditorInput): boolean {\n\t\tif (arg1 instanceof FileChangesEvent || arg1 instanceof FileOperationEvent) {\n\t\t\tif (isEditorInput(inputB)) {\n\t\t\t\treturn false; // we only support this for `IResourceEditorInputs` that are file based\n\t\t\t}\n\n\t\t\tif (arg1 instanceof FileChangesEvent) {\n\t\t\t\treturn arg1.contains(inputB.resource, FileChangeType.DELETED);\n\t\t\t}\n\n\t\t\treturn this.matchesFile(inputB.resource, arg1);\n\t\t}\n\n\t\tif (isEditorInput(arg1)) {\n\t\t\tif (isEditorInput(inputB)) {\n\t\t\t\treturn arg1.matches(inputB);\n\t\t\t}\n\n\t\t\treturn this.matchesFile(inputB.resource, arg1);\n\t\t}\n\n\t\tif (isEditorInput(inputB)) {\n\t\t\treturn this.matchesFile(arg1.resource, inputB);\n\t\t}\n\n\t\treturn arg1 && inputB && this.uriIdentityService.extUri.isEqual(arg1.resource, inputB.resource);\n\t}\n\n\tmatchesFile(resource: URI, arg2: EditorInput | IResourceEditorInput | FileChangesEvent | FileOperationEvent): boolean {\n\t\tif (arg2 instanceof FileChangesEvent) {\n\t\t\treturn arg2.contains(resource, FileChangeType.DELETED);\n\t\t}\n\n\t\tif (arg2 instanceof FileOperationEvent) {\n\t\t\treturn this.uriIdentityService.extUri.isEqualOrParent(resource, arg2.resource);\n\t\t}\n\n\t\tif (isEditorInput(arg2)) {\n\t\t\tconst inputResource = arg2.resource;\n\t\t\tif (!inputResource) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.lifecycleService.phase >= LifecyclePhase.Restored && !this.fileService.hasProvider(inputResource)) {\n\t\t\t\treturn false; // make sure to only check this when workbench has restored (for https://github.com/microsoft/vscode/issues/48275)\n\t\t\t}\n\n\t\t\treturn this.uriIdentityService.extUri.isEqual(inputResource, resource);\n\t\t}\n\n\t\treturn this.uriIdentityService.extUri.isEqual(arg2?.resource, resource);\n\t}\n\n\tmatchesEditorIdentifier(identifier: IEditorIdentifier, editorPane?: IEditorPane): boolean {\n\t\tif (!editorPane?.group) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (identifier.groupId !== editorPane.group.id) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn editorPane.input ? identifier.editor.matches(editorPane.input) : false;\n\t}\n\n\tonEditorDispose(editor: EditorInput, listener: Function, mapEditorToDispose: Map<EditorInput, DisposableStore>): void {\n\t\tconst toDispose = Event.once(editor.onWillDispose)(() => listener());\n\n\t\tlet disposables = mapEditorToDispose.get(editor);\n\t\tif (!disposables) {\n\t\t\tdisposables = new DisposableStore();\n\t\t\tmapEditorToDispose.set(editor, disposables);\n\t\t}\n\n\t\tdisposables.add(toDispose);\n\t}\n\n\tclearOnEditorDispose(editor: EditorInput | IResourceEditorInput | FileChangesEvent | FileOperationEvent, mapEditorToDispose: Map<EditorInput, DisposableStore>): void {\n\t\tif (!isEditorInput(editor)) {\n\t\t\treturn; // only supported when passing in an actual editor input\n\t\t}\n\n\t\tconst disposables = mapEditorToDispose.get(editor);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t\tmapEditorToDispose.delete(editor);\n\t\t}\n\t}\n}\n"]}