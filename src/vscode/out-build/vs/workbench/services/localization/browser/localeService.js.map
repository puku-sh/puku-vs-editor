{"version":3,"sources":["vs/workbench/services/localization/browser/localeService.ts"],"names":[],"mappings":"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","file":"localeService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { Language, LANGUAGE_DEFAULT } from '../../../../base/common/platform.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { ILanguagePackItem } from '../../../../platform/languagePacks/common/languagePacks.js';\nimport { IActiveLanguagePackService, ILocaleService } from '../common/locale.js';\nimport { IHostService } from '../../host/browser/host.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { IExtensionGalleryService } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\n\nconst localeStorage = new class LocaleStorage {\n\n\tprivate static readonly LOCAL_STORAGE_LOCALE_KEY = 'vscode.nls.locale';\n\tprivate static readonly LOCAL_STORAGE_EXTENSION_ID_KEY = 'vscode.nls.languagePackExtensionId';\n\n\tsetLocale(locale: string): void {\n\t\tlocalStorage.setItem(LocaleStorage.LOCAL_STORAGE_LOCALE_KEY, locale);\n\t\tthis.doSetLocaleToCookie(locale);\n\t}\n\n\tprivate doSetLocaleToCookie(locale: string): void {\n\t\tdocument.cookie = `${LocaleStorage.LOCAL_STORAGE_LOCALE_KEY}=${locale};path=/;max-age=3153600000`;\n\t}\n\n\tclearLocale(): void {\n\t\tlocalStorage.removeItem(LocaleStorage.LOCAL_STORAGE_LOCALE_KEY);\n\t\tthis.doClearLocaleToCookie();\n\t}\n\n\tprivate doClearLocaleToCookie(): void {\n\t\tdocument.cookie = `${LocaleStorage.LOCAL_STORAGE_LOCALE_KEY}=;path=/;max-age=0`;\n\t}\n\n\tsetExtensionId(extensionId: string): void {\n\t\tlocalStorage.setItem(LocaleStorage.LOCAL_STORAGE_EXTENSION_ID_KEY, extensionId);\n\t}\n\n\tgetExtensionId(): string | null {\n\t\treturn localStorage.getItem(LocaleStorage.LOCAL_STORAGE_EXTENSION_ID_KEY);\n\t}\n\n\tclearExtensionId(): void {\n\t\tlocalStorage.removeItem(LocaleStorage.LOCAL_STORAGE_EXTENSION_ID_KEY);\n\t}\n};\n\nexport class WebLocaleService implements ILocaleService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IProductService private readonly productService: IProductService\n\t) { }\n\n\tasync setLocale(languagePackItem: ILanguagePackItem, _skipDialog = false): Promise<void> {\n\t\tconst locale = languagePackItem.id;\n\t\tif (locale === Language.value() || (!locale && Language.value() === navigator.language.toLowerCase())) {\n\t\t\treturn;\n\t\t}\n\t\tif (locale) {\n\t\t\tlocaleStorage.setLocale(locale);\n\t\t\tif (languagePackItem.extensionId) {\n\t\t\t\tlocaleStorage.setExtensionId(languagePackItem.extensionId);\n\t\t\t}\n\t\t} else {\n\t\t\tlocaleStorage.clearLocale();\n\t\t\tlocaleStorage.clearExtensionId();\n\t\t}\n\n\t\tconst restartDialog = await this.dialogService.confirm({\n\t\t\ttype: 'info',\n\t\t\tmessage: localize('relaunchDisplayLanguageMessage', \"To change the display language, {0} needs to reload\", this.productService.nameLong),\n\t\t\tdetail: localize('relaunchDisplayLanguageDetail', \"Press the reload button to refresh the page and set the display language to {0}.\", languagePackItem.label),\n\t\t\tprimaryButton: localize({ key: 'reload', comment: ['&& denotes a mnemonic character'] }, \"&&Reload\"),\n\t\t});\n\n\t\tif (restartDialog.confirmed) {\n\t\t\tthis.hostService.restart();\n\t\t}\n\t}\n\n\tasync clearLocalePreference(): Promise<void> {\n\t\tlocaleStorage.clearLocale();\n\t\tlocaleStorage.clearExtensionId();\n\n\t\tif (Language.value() === navigator.language.toLowerCase()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst restartDialog = await this.dialogService.confirm({\n\t\t\ttype: 'info',\n\t\t\tmessage: localize('clearDisplayLanguageMessage', \"To change the display language, {0} needs to reload\", this.productService.nameLong),\n\t\t\tdetail: localize('clearDisplayLanguageDetail', \"Press the reload button to refresh the page and use your browser's language.\"),\n\t\t\tprimaryButton: localize({ key: 'reload', comment: ['&& denotes a mnemonic character'] }, \"&&Reload\"),\n\t\t});\n\n\t\tif (restartDialog.confirmed) {\n\t\t\tthis.hostService.restart();\n\t\t}\n\t}\n}\n\nclass WebActiveLanguagePackService implements IActiveLanguagePackService {\n\t_serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@ILogService private readonly logService: ILogService\n\t) { }\n\n\tasync getExtensionIdProvidingCurrentLocale(): Promise<string | undefined> {\n\t\tconst language = Language.value();\n\t\tif (language === LANGUAGE_DEFAULT) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst extensionId = localeStorage.getExtensionId();\n\t\tif (extensionId) {\n\t\t\treturn extensionId;\n\t\t}\n\n\t\tif (!this.galleryService.isEnabled()) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst tagResult = await this.galleryService.query({ text: `tag:lp-${language}` }, CancellationToken.None);\n\n\t\t\t// Only install extensions that are published by Microsoft and start with vscode-language-pack for extra certainty\n\t\t\tconst extensionToInstall = tagResult.firstPage.find(e => e.publisher === 'MS-CEINTL' && e.name.startsWith('vscode-language-pack'));\n\t\t\tif (extensionToInstall) {\n\t\t\t\tlocaleStorage.setExtensionId(extensionToInstall.identifier.id);\n\t\t\t\treturn extensionToInstall.identifier.id;\n\t\t\t}\n\n\t\t\t// TODO: If a non-Microsoft language pack is installed, we should prompt the user asking if they want to install that.\n\t\t\t// Since no such language packs exist yet, we can wait until that happens to implement this.\n\t\t} catch (e) {\n\t\t\t// Best effort\n\t\t\tthis.logService.error(e);\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nregisterSingleton(ILocaleService, WebLocaleService, InstantiationType.Delayed);\nregisterSingleton(IActiveLanguagePackService, WebActiveLanguagePackService, InstantiationType.Delayed);\n"]}