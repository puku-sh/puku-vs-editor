{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/userDataProfile/browser/userDataProfileStorageService.ts","vs/workbench/services/userDataProfile/browser/userDataProfileStorageService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AAElE,OAAO,EAAqB,iBAAiB,EAAE,MAAM,yDAAyD,CAAC;AAC/G,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,qCAAqC,EAA0B,8BAA8B,EAAE,MAAM,8EAA8E,CAAC;AAC7L,OAAO,EAAmC,4BAA4B,EAAE,eAAe,EAAgB,MAAM,gDAAgD,CAAC;AAE9J,OAAO,EAAE,wBAAwB,EAAE,MAAM,yCAAyC,CAAC;AACnF,OAAO,EAAE,uBAAuB,EAAE,MAAM,8BAA8B,CAAC;AACvE,OAAO,EAAE,eAAe,EAAE,MAAM,sCAAsC,CAAC;AAEhE,IAAM,6BAA6B,GAAnC,MAAM,6BAA8B,SAAQ,qCAAqC;IAKvF,YACkB,cAA+B,EACvB,sBAAgE,EAC5E,UAAwC;QAErD,KAAK,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAHc,2BAAsB,GAAtB,sBAAsB,CAAyB;QAC3D,eAAU,GAAV,UAAU,CAAa;QANrC,iBAAY,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAA0B,CAAC,CAAC;QAC7E,gBAAW,GAAkC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;QAQ7E,MAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,eAAe,EAAE,CAAC,CAAC;QAC1D,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,iCAAyB,EAAE,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,wCAAwC,EAAE,CAAC,CAAC,CAAC;QAC1K,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,gBAAgB,+BAAuB,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,uCAAuC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrJ,CAAC;IAEO,wCAAwC;QAC/C,+EAA+E;QAC/E,+BAA+B;QAC/B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,aAAa,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,EAAE,YAAY,EAAE,EAAE,EAAE,CAAC,CAAC;IAC3G,CAAC;IAEO,uCAAuC,CAAC,CAAkC;QACjF,8EAA8E;QAC9E,+BAA+B;QAC/B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,aAAa,EAAE,EAAE,EAAE,YAAY,EAAE,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,sBAAsB,CAAC,cAAc,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACtI,CAAC;IAES,qBAAqB,CAAC,OAAyB;QACxD,OAAO,4BAA4B,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,wBAAwB,CAAC,wBAAwB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,wBAAwB,CAAC,oBAAoB,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;IAC7L,CAAC;CACD,CAAA;AA/BY,6BAA6B;IAMvC,WAAA,eAAe,CAAA;IACf,WAAA,uBAAuB,CAAA;IACvB,WAAA,WAAW,CAAA;GARD,6BAA6B,CA+BzC;;AAED,iBAAiB,CAAC,8BAA8B,EAAE,6BAA6B,oCAA4B,CAAC","file":"userDataProfileStorageService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IStorageDatabase } from '../../../../base/parts/storage/common/storage.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractUserDataProfileStorageService, IProfileStorageChanges, IUserDataProfileStorageService } from '../../../../platform/userDataProfile/common/userDataProfileStorageService.js';\nimport { IProfileStorageValueChangeEvent, isProfileUsingDefaultStorage, IStorageService, StorageScope } from '../../../../platform/storage/common/storage.js';\nimport { IUserDataProfile } from '../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { IndexedDBStorageDatabase } from '../../storage/browser/storageService.js';\nimport { IUserDataProfileService } from '../common/userDataProfile.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\nexport class UserDataProfileStorageService extends AbstractUserDataProfileStorageService implements IUserDataProfileStorageService {\n\n\tprivate readonly _onDidChange = this._register(new Emitter<IProfileStorageChanges>());\n\treadonly onDidChange: Event<IProfileStorageChanges> = this._onDidChange.event;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IUserDataProfileService private readonly userDataProfileService: IUserDataProfileService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper(true, storageService);\n\t\tconst disposables = this._register(new DisposableStore());\n\t\tthis._register(Event.filter(storageService.onDidChangeTarget, e => e.scope === StorageScope.PROFILE, disposables)(() => this.onDidChangeStorageTargetInCurrentProfile()));\n\t\tthis._register(storageService.onDidChangeValue(StorageScope.PROFILE, undefined, disposables)(e => this.onDidChangeStorageValueInCurrentProfile(e)));\n\t}\n\n\tprivate onDidChangeStorageTargetInCurrentProfile(): void {\n\t\t// Not broadcasting changes to other windows/tabs as it is not required in web.\n\t\t// Revisit if needed in future.\n\t\tthis._onDidChange.fire({ targetChanges: [this.userDataProfileService.currentProfile], valueChanges: [] });\n\t}\n\n\tprivate onDidChangeStorageValueInCurrentProfile(e: IProfileStorageValueChangeEvent): void {\n\t\t// Not broadcasting changes to other windows/tabs as it is not required in web\n\t\t// Revisit if needed in future.\n\t\tthis._onDidChange.fire({ targetChanges: [], valueChanges: [{ profile: this.userDataProfileService.currentProfile, changes: [e] }] });\n\t}\n\n\tprotected createStorageDatabase(profile: IUserDataProfile): Promise<IStorageDatabase> {\n\t\treturn isProfileUsingDefaultStorage(profile) ? IndexedDBStorageDatabase.createApplicationStorage(this.logService) : IndexedDBStorageDatabase.createProfileStorage(profile, this.logService);\n\t}\n}\n\nregisterSingleton(IUserDataProfileStorageService, UserDataProfileStorageService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IStorageDatabase } from '../../../../base/parts/storage/common/storage.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractUserDataProfileStorageService, IProfileStorageChanges, IUserDataProfileStorageService } from '../../../../platform/userDataProfile/common/userDataProfileStorageService.js';\nimport { IProfileStorageValueChangeEvent, isProfileUsingDefaultStorage, IStorageService, StorageScope } from '../../../../platform/storage/common/storage.js';\nimport { IUserDataProfile } from '../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { IndexedDBStorageDatabase } from '../../storage/browser/storageService.js';\nimport { IUserDataProfileService } from '../common/userDataProfile.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\n\nexport class UserDataProfileStorageService extends AbstractUserDataProfileStorageService implements IUserDataProfileStorageService {\n\n\tprivate readonly _onDidChange = this._register(new Emitter<IProfileStorageChanges>());\n\treadonly onDidChange: Event<IProfileStorageChanges> = this._onDidChange.event;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IUserDataProfileService private readonly userDataProfileService: IUserDataProfileService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper(true, storageService);\n\t\tconst disposables = this._register(new DisposableStore());\n\t\tthis._register(Event.filter(storageService.onDidChangeTarget, e => e.scope === StorageScope.PROFILE, disposables)(() => this.onDidChangeStorageTargetInCurrentProfile()));\n\t\tthis._register(storageService.onDidChangeValue(StorageScope.PROFILE, undefined, disposables)(e => this.onDidChangeStorageValueInCurrentProfile(e)));\n\t}\n\n\tprivate onDidChangeStorageTargetInCurrentProfile(): void {\n\t\t// Not broadcasting changes to other windows/tabs as it is not required in web.\n\t\t// Revisit if needed in future.\n\t\tthis._onDidChange.fire({ targetChanges: [this.userDataProfileService.currentProfile], valueChanges: [] });\n\t}\n\n\tprivate onDidChangeStorageValueInCurrentProfile(e: IProfileStorageValueChangeEvent): void {\n\t\t// Not broadcasting changes to other windows/tabs as it is not required in web\n\t\t// Revisit if needed in future.\n\t\tthis._onDidChange.fire({ targetChanges: [], valueChanges: [{ profile: this.userDataProfileService.currentProfile, changes: [e] }] });\n\t}\n\n\tprotected createStorageDatabase(profile: IUserDataProfile): Promise<IStorageDatabase> {\n\t\treturn isProfileUsingDefaultStorage(profile) ? IndexedDBStorageDatabase.createApplicationStorage(this.logService) : IndexedDBStorageDatabase.createProfileStorage(profile, this.logService);\n\t}\n}\n\nregisterSingleton(IUserDataProfileStorageService, UserDataProfileStorageService, InstantiationType.Delayed);\n"]}