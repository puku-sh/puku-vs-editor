{"version":3,"sources":["vs/workbench/services/userDataProfile/browser/userDataProfileManagement.ts"],"names":[],"mappings":"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","file":"userDataProfileManagement.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError } from '../../../../base/common/errors.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { equals } from '../../../../base/common/objects.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { IRequestService, asJson } from '../../../../platform/request/common/request.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IUserDataProfile, IUserDataProfileOptions, IUserDataProfilesService, IUserDataProfileUpdateOptions } from '../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { isEmptyWorkspaceIdentifier, IWorkspaceContextService, toWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nimport { CONFIG_NEW_WINDOW_PROFILE } from '../../../common/configuration.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\nimport { IHostService } from '../../host/browser/host.js';\nimport { DidChangeUserDataProfileEvent, IProfileTemplateInfo, IUserDataProfileManagementService, IUserDataProfileService } from '../common/userDataProfile.js';\n\nexport class UserDataProfileManagementService extends Disposable implements IUserDataProfileManagementService {\n\treadonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IUserDataProfilesService private readonly userDataProfilesService: IUserDataProfilesService,\n\t\t@IUserDataProfileService private readonly userDataProfileService: IUserDataProfileService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService,\n\t\t@IExtensionService private readonly extensionService: IExtensionService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IRequestService private readonly requestService: IRequestService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\t\tthis._register(userDataProfileService.onDidChangeCurrentProfile(e => this.onDidChangeCurrentProfile(e)));\n\t\tthis._register(userDataProfilesService.onDidChangeProfiles(e => {\n\t\t\tif (e.removed.some(profile => profile.id === this.userDataProfileService.currentProfile.id)) {\n\t\t\t\tconst profileToUse = this.getProfileToUseForCurrentWorkspace();\n\t\t\t\tthis.switchProfile(profileToUse);\n\t\t\t\tthis.changeCurrentProfile(profileToUse, localize('reload message when removed', \"The current profile has been removed. Please reload to switch back to default profile\"));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst updatedCurrentProfile = e.updated.find(p => this.userDataProfileService.currentProfile.id === p.id);\n\t\t\tif (updatedCurrentProfile) {\n\t\t\t\tconst profileToUse = this.getProfileToUseForCurrentWorkspace();\n\t\t\t\tif (profileToUse?.id !== updatedCurrentProfile.id) {\n\t\t\t\t\tthis.switchProfile(profileToUse);\n\t\t\t\t\tthis.changeCurrentProfile(profileToUse, localize('reload message when switched', \"The current workspace has been removed from the current profile. Please reload to switch back to the updated profile\"));\n\t\t\t\t} else {\n\t\t\t\t\tthis.changeCurrentProfile(updatedCurrentProfile, localize('reload message when updated', \"The current profile has been updated. Please reload to switch back to the updated profile\"));\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate async onDidChangeCurrentProfile(e: DidChangeUserDataProfileEvent): Promise<void> {\n\t\tif (e.previous.isTransient) {\n\t\t\tawait this.userDataProfilesService.cleanUpTransientProfiles();\n\t\t}\n\t}\n\n\tprivate getWorkspaceUri(): URI | undefined {\n\t\tconst workspace = this.workspaceContextService.getWorkspace();\n\t\treturn workspace.configuration ?? workspace.folders[0]?.uri;\n\t}\n\n\tprivate getProfileToUseForCurrentWorkspace(): IUserDataProfile {\n\t\tconst workspaceUri = this.getWorkspaceUri();\n\t\tif (workspaceUri) {\n\t\t\tconst profileForWorkspace = this.userDataProfilesService.profiles.find(profile => profile.workspaces?.some(ws => this.uriIdentityService.extUri.isEqual(ws, workspaceUri)));\n\t\t\tif (profileForWorkspace) {\n\t\t\t\treturn profileForWorkspace;\n\t\t\t}\n\t\t} else {\n\t\t\t// If no workspace is open, use the current profile\n\t\t\tconst currentProfile = this.userDataProfilesService.profiles.find(profile => profile.id === this.userDataProfileService.currentProfile.id);\n\t\t\tif (currentProfile) {\n\t\t\t\treturn currentProfile;\n\t\t\t}\n\t\t}\n\t\treturn this.getDefaultProfileToUse();\n\t}\n\n\tpublic getDefaultProfileToUse(): IUserDataProfile {\n\t\tconst newWindowProfileConfigValue = this.configurationService.getValue(CONFIG_NEW_WINDOW_PROFILE);\n\t\tif (newWindowProfileConfigValue) {\n\t\t\tconst newWindowProfile = this.userDataProfilesService.profiles.find(profile => profile.name === newWindowProfileConfigValue);\n\t\t\tif (newWindowProfile) {\n\t\t\t\treturn newWindowProfile;\n\t\t\t}\n\t\t}\n\t\treturn this.userDataProfilesService.defaultProfile;\n\t}\n\n\tasync createProfile(name: string, options?: IUserDataProfileOptions): Promise<IUserDataProfile> {\n\t\treturn this.userDataProfilesService.createNamedProfile(name, options);\n\t}\n\n\tasync createAndEnterProfile(name: string, options?: IUserDataProfileOptions): Promise<IUserDataProfile> {\n\t\tconst profile = await this.userDataProfilesService.createNamedProfile(name, options, toWorkspaceIdentifier(this.workspaceContextService.getWorkspace()));\n\t\tawait this.changeCurrentProfile(profile);\n\t\treturn profile;\n\t}\n\n\tasync createAndEnterTransientProfile(): Promise<IUserDataProfile> {\n\t\tconst profile = await this.userDataProfilesService.createTransientProfile(toWorkspaceIdentifier(this.workspaceContextService.getWorkspace()));\n\t\tawait this.changeCurrentProfile(profile);\n\t\treturn profile;\n\t}\n\n\tasync updateProfile(profile: IUserDataProfile, updateOptions: IUserDataProfileUpdateOptions): Promise<IUserDataProfile> {\n\t\tif (!this.userDataProfilesService.profiles.some(p => p.id === profile.id)) {\n\t\t\tthrow new Error(`Profile ${profile.name} does not exist`);\n\t\t}\n\t\tif (profile.isDefault) {\n\t\t\tthrow new Error(localize('cannotRenameDefaultProfile', \"Cannot rename the default profile\"));\n\t\t}\n\t\tconst updatedProfile = await this.userDataProfilesService.updateProfile(profile, updateOptions);\n\t\treturn updatedProfile;\n\t}\n\n\tasync removeProfile(profile: IUserDataProfile): Promise<void> {\n\t\tif (!this.userDataProfilesService.profiles.some(p => p.id === profile.id)) {\n\t\t\tthrow new Error(`Profile ${profile.name} does not exist`);\n\t\t}\n\t\tif (profile.isDefault) {\n\t\t\tthrow new Error(localize('cannotDeleteDefaultProfile', \"Cannot delete the default profile\"));\n\t\t}\n\t\tawait this.userDataProfilesService.removeProfile(profile);\n\t}\n\n\tasync switchProfile(profile: IUserDataProfile): Promise<void> {\n\t\tif (!this.userDataProfilesService.profiles.some(p => p.id === profile.id)) {\n\t\t\tthrow new Error(`Profile ${profile.name} does not exist`);\n\t\t}\n\t\tif (this.userDataProfileService.currentProfile.id === profile.id) {\n\t\t\treturn;\n\t\t}\n\t\tconst workspaceUri = this.getWorkspaceUri();\n\t\tif (workspaceUri && profile.workspaces?.some(ws => this.uriIdentityService.extUri.isEqual(ws, workspaceUri))) {\n\t\t\treturn;\n\t\t}\n\t\tconst workspaceIdentifier = toWorkspaceIdentifier(this.workspaceContextService.getWorkspace());\n\t\tawait this.userDataProfilesService.setProfileForWorkspace(workspaceIdentifier, profile);\n\t\tif (isEmptyWorkspaceIdentifier(workspaceIdentifier)) {\n\t\t\tawait this.changeCurrentProfile(profile);\n\t\t}\n\t}\n\n\tasync getBuiltinProfileTemplates(): Promise<IProfileTemplateInfo[]> {\n\t\tif (this.productService.profileTemplatesUrl) {\n\t\t\ttry {\n\t\t\t\tconst context = await this.requestService.request({ type: 'GET', url: this.productService.profileTemplatesUrl }, CancellationToken.None);\n\t\t\t\tif (context.res.statusCode === 200) {\n\t\t\t\t\treturn (await asJson<IProfileTemplateInfo[]>(context)) || [];\n\t\t\t\t} else {\n\t\t\t\t\tthis.logService.error('Could not get profile templates.', context.res.statusCode);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate async changeCurrentProfile(profile: IUserDataProfile, reloadMessage?: string): Promise<void> {\n\t\tconst isRemoteWindow = !!this.environmentService.remoteAuthority;\n\n\t\tconst shouldRestartExtensionHosts = this.userDataProfileService.currentProfile.id !== profile.id || !equals(this.userDataProfileService.currentProfile.useDefaultFlags, profile.useDefaultFlags);\n\n\t\tif (shouldRestartExtensionHosts) {\n\t\t\tif (!isRemoteWindow) {\n\t\t\t\tif (!(await this.extensionService.stopExtensionHosts(localize('switch profile', \"Switching to a profile\")))) {\n\t\t\t\t\t// If extension host did not stop, do not switch profile\n\t\t\t\t\tif (this.userDataProfilesService.profiles.some(p => p.id === this.userDataProfileService.currentProfile.id)) {\n\t\t\t\t\t\tawait this.userDataProfilesService.setProfileForWorkspace(toWorkspaceIdentifier(this.workspaceContextService.getWorkspace()), this.userDataProfileService.currentProfile);\n\t\t\t\t\t}\n\t\t\t\t\tthrow new CancellationError();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// In a remote window update current profile before reloading so that data is preserved from current profile if asked to preserve\n\t\tawait this.userDataProfileService.updateCurrentProfile(profile);\n\n\t\tif (shouldRestartExtensionHosts) {\n\t\t\tif (isRemoteWindow) {\n\t\t\t\tconst { confirmed } = await this.dialogService.confirm({\n\t\t\t\t\tmessage: reloadMessage ?? localize('reload message', \"Switching a profile requires reloading VS Code.\"),\n\t\t\t\t\tprimaryButton: localize('reload button', \"&&Reload\"),\n\t\t\t\t});\n\t\t\t\tif (confirmed) {\n\t\t\t\t\tawait this.hostService.reload();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait this.extensionService.startExtensionHosts();\n\t\t\t}\n\t\t}\n\t}\n}\n\nregisterSingleton(IUserDataProfileManagementService, UserDataProfileManagementService, InstantiationType.Eager /* Eager because it updates the current window profile by listening to profiles changes */);\n"]}