{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts","vs/workbench/services/extensionManagement/test/browser/extensionEnablementService.test.ts"],"names":[],"mappings":"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","file":"extensionEnablementService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { IExtensionManagementService, DidUninstallExtensionEvent, ILocalExtension, InstallExtensionEvent, InstallExtensionResult, UninstallExtensionEvent, DidUpdateExtensionMetadata, InstallOperation, IAllowedExtensionsService, AllowedExtensionsConfigKey, IExtensionsControlManifest } from '../../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { EnablementState, IExtensionManagementServerService, IExtensionManagementServer, IWorkbenchExtensionManagementService, ExtensionInstallLocation, IProfileAwareExtensionManagementService, DidChangeProfileEvent } from '../../common/extensionManagement.js';\nimport { ExtensionEnablementService } from '../../browser/extensionEnablementService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { IWorkspace, IWorkspaceContextService, WorkbenchState } from '../../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchEnvironmentService } from '../../../environment/common/environmentService.js';\nimport { IStorageService, InMemoryStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { IExtensionContributions, ExtensionType, IExtension, IExtensionManifest, IExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { isUndefinedOrNull } from '../../../../../base/common/types.js';\nimport { areSameExtensions } from '../../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { productService, TestLifecycleService } from '../../../../test/browser/workbenchTestServices.js';\nimport { GlobalExtensionEnablementService } from '../../../../../platform/extensionManagement/common/extensionEnablementService.js';\nimport { IUserDataSyncAccountService, UserDataSyncAccountService } from '../../../../../platform/userDataSync/common/userDataSyncAccount.js';\nimport { IUserDataSyncEnablementService } from '../../../../../platform/userDataSync/common/userDataSync.js';\nimport { ILifecycleService } from '../../../lifecycle/common/lifecycle.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { TestNotificationService } from '../../../../../platform/notification/test/common/testNotificationService.js';\nimport { IHostService } from '../../../host/browser/host.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { IExtensionBisectService } from '../../browser/extensionBisect.js';\nimport { IWorkspaceTrustManagementService, IWorkspaceTrustRequestService, WorkspaceTrustRequestOptions } from '../../../../../platform/workspace/common/workspaceTrust.js';\nimport { ExtensionManifestPropertiesService, IExtensionManifestPropertiesService } from '../../../extensions/common/extensionManifestPropertiesService.js';\nimport { TestContextService, TestProductService, TestWorkspaceTrustEnablementService, TestWorkspaceTrustManagementService } from '../../../../test/common/workbenchTestServices.js';\nimport { TestWorkspace } from '../../../../../platform/workspace/test/common/testWorkspace.js';\nimport { ExtensionManagementService } from '../../common/extensionManagementService.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { AllowedExtensionsService } from '../../../../../platform/extensionManagement/common/allowedExtensionsService.js';\nimport { IStringDictionary } from '../../../../../base/common/collections.js';\n\nfunction createStorageService(instantiationService: TestInstantiationService, disposableStore: DisposableStore): IStorageService {\n\tlet service = instantiationService.get(IStorageService);\n\tif (!service) {\n\t\tlet workspaceContextService = instantiationService.get(IWorkspaceContextService);\n\t\tif (!workspaceContextService) {\n\t\t\tworkspaceContextService = instantiationService.stub(IWorkspaceContextService, <IWorkspaceContextService>{\n\t\t\t\tgetWorkbenchState: () => WorkbenchState.FOLDER,\n\t\t\t\tgetWorkspace: () => TestWorkspace as IWorkspace\n\t\t\t});\n\t\t}\n\t\tservice = instantiationService.stub(IStorageService, disposableStore.add(new InMemoryStorageService()));\n\t}\n\treturn service;\n}\n\nexport class TestExtensionEnablementService extends ExtensionEnablementService {\n\tconstructor(instantiationService: TestInstantiationService) {\n\t\tconst disposables = new DisposableStore();\n\t\tconst storageService = createStorageService(instantiationService, disposables);\n\t\tconst extensionManagementServerService = instantiationService.get(IExtensionManagementServerService) ||\n\t\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService({\n\t\t\t\tid: 'local',\n\t\t\t\tlabel: 'local',\n\t\t\t\textensionManagementService: <IProfileAwareExtensionManagementService>{\n\t\t\t\t\tonInstallExtension: disposables.add(new Emitter<InstallExtensionEvent>()).event,\n\t\t\t\t\tonDidInstallExtensions: disposables.add(new Emitter<readonly InstallExtensionResult[]>()).event,\n\t\t\t\t\tonUninstallExtension: disposables.add(new Emitter<UninstallExtensionEvent>()).event,\n\t\t\t\t\tonDidUninstallExtension: disposables.add(new Emitter<DidUninstallExtensionEvent>()).event,\n\t\t\t\t\tonDidChangeProfile: disposables.add(new Emitter<DidChangeProfileEvent>()).event,\n\t\t\t\t\tonDidUpdateExtensionMetadata: disposables.add(new Emitter<DidUpdateExtensionMetadata>()).event,\n\t\t\t\t\tonProfileAwareDidInstallExtensions: Event.None,\n\t\t\t\t},\n\t\t\t}, null, null));\n\t\tconst extensionManagementService = disposables.add(instantiationService.createInstance(ExtensionManagementService));\n\t\tconst workbenchExtensionManagementService = instantiationService.get(IWorkbenchExtensionManagementService) || instantiationService.stub(IWorkbenchExtensionManagementService, extensionManagementService);\n\t\tconst workspaceTrustManagementService = instantiationService.get(IWorkspaceTrustManagementService) || instantiationService.stub(IWorkspaceTrustManagementService, disposables.add(new TestWorkspaceTrustManagementService()));\n\t\tsuper(\n\t\t\tstorageService,\n\t\t\tdisposables.add(new GlobalExtensionEnablementService(storageService, extensionManagementService)),\n\t\t\tinstantiationService.get(IWorkspaceContextService) || new TestContextService(),\n\t\t\tinstantiationService.get(IWorkbenchEnvironmentService) || instantiationService.stub(IWorkbenchEnvironmentService, {}),\n\t\t\tworkbenchExtensionManagementService,\n\t\t\tinstantiationService.get(IConfigurationService),\n\t\t\textensionManagementServerService,\n\t\t\tinstantiationService.get(IUserDataSyncEnablementService) || instantiationService.stub(IUserDataSyncEnablementService, <Partial<IUserDataSyncEnablementService>>{ isEnabled() { return false; } }),\n\t\t\tinstantiationService.get(IUserDataSyncAccountService) || instantiationService.stub(IUserDataSyncAccountService, UserDataSyncAccountService),\n\t\t\tinstantiationService.get(ILifecycleService) || instantiationService.stub(ILifecycleService, disposables.add(new TestLifecycleService())),\n\t\t\tinstantiationService.get(INotificationService) || instantiationService.stub(INotificationService, new TestNotificationService()),\n\t\t\tinstantiationService.get(IHostService),\n\t\t\tnew class extends mock<IExtensionBisectService>() { override isDisabledByBisect() { return false; } },\n\t\t\tinstantiationService.stub(IAllowedExtensionsService, disposables.add(new AllowedExtensionsService(instantiationService.get(IProductService), instantiationService.get(IConfigurationService)))),\n\t\t\tworkspaceTrustManagementService,\n\t\t\tnew class extends mock<IWorkspaceTrustRequestService>() { override requestWorkspaceTrust(options?: WorkspaceTrustRequestOptions): Promise<boolean> { return Promise.resolve(true); } },\n\t\t\tinstantiationService.get(IExtensionManifestPropertiesService) || instantiationService.stub(IExtensionManifestPropertiesService, disposables.add(new ExtensionManifestPropertiesService(TestProductService, new TestConfigurationService(), new TestWorkspaceTrustEnablementService(), new NullLogService()))),\n\t\t\tinstantiationService,\n\t\t\tnew NullLogService(),\n\t\t\tproductService\n\t\t);\n\t\tthis._register(disposables);\n\t}\n\n\tpublic async waitUntilInitialized(): Promise<void> {\n\t\tawait this.extensionsManager.whenInitialized();\n\t}\n\n\tpublic reset(): void {\n\t\tlet extensions = this.globalExtensionEnablementService.getDisabledExtensions();\n\t\tfor (const e of this._getWorkspaceDisabledExtensions()) {\n\t\t\tif (!extensions.some(r => areSameExtensions(r, e))) {\n\t\t\t\textensions.push(e);\n\t\t\t}\n\t\t}\n\t\tconst workspaceEnabledExtensions = this._getWorkspaceEnabledExtensions();\n\t\tif (workspaceEnabledExtensions.length) {\n\t\t\textensions = extensions.filter(r => !workspaceEnabledExtensions.some(e => areSameExtensions(e, r)));\n\t\t}\n\t\textensions.forEach(d => this.setEnablement([aLocalExtension(d.id)], EnablementState.EnabledGlobally));\n\t}\n}\n\nsuite('ExtensionEnablementService Test', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet testObject: TestExtensionEnablementService;\n\n\tconst didInstallEvent = new Emitter<readonly InstallExtensionResult[]>();\n\tconst didUninstallEvent = new Emitter<DidUninstallExtensionEvent>();\n\tconst didChangeProfileExtensionsEvent = new Emitter<DidChangeProfileEvent>();\n\tconst installed: ILocalExtension[] = [];\n\tconst malicious: IExtensionIdentifier[] = [];\n\n\tsetup(() => {\n\t\tinstalled.splice(0, installed.length);\n\t\tinstantiationService = disposableStore.add(new TestInstantiationService());\n\t\tinstantiationService.stub(IFileService, disposableStore.add(new FileService(new NullLogService())));\n\t\tinstantiationService.stub(IProductService, TestProductService);\n\t\tconst testConfigurationService = new TestConfigurationService();\n\t\ttestConfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true, 'unallowed': false });\n\t\tinstantiationService.stub(IConfigurationService, testConfigurationService);\n\t\tinstantiationService.stub(IWorkspaceContextService, new TestContextService());\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService({\n\t\t\tid: 'local',\n\t\t\tlabel: 'local',\n\t\t\textensionManagementService: <IProfileAwareExtensionManagementService>{\n\t\t\t\tonDidInstallExtensions: didInstallEvent.event,\n\t\t\t\tonDidUninstallExtension: didUninstallEvent.event,\n\t\t\t\tonDidChangeProfile: didChangeProfileExtensionsEvent.event,\n\t\t\t\tonProfileAwareDidInstallExtensions: Event.None,\n\t\t\t\tgetInstalled: () => Promise.resolve(installed),\n\t\t\t\tasync getExtensionsControlManifest(): Promise<IExtensionsControlManifest> {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmalicious: malicious.map(e => ({ extensionOrPublisher: e })),\n\t\t\t\t\t\tdeprecated: {},\n\t\t\t\t\t\tsearch: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\t\t}, null, null));\n\t\tinstantiationService.stub(ILogService, NullLogService);\n\t\tinstantiationService.stub(IWorkbenchExtensionManagementService, disposableStore.add(instantiationService.createInstance(ExtensionManagementService)));\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t});\n\n\ttest('test disable an extension globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t});\n\n\ttest('test disable an extension globally should return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension globally triggers the change event', async () => {\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\t\tawait testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally);\n\t\tassert.ok(target.calledOnce);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t});\n\n\ttest('test disable an extension globally again should return a falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test state of globally disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of globally enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test disable an extension for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledWorkspace);\n\t});\n\n\ttest('test disable an extension for workspace returns a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension for workspace again should return a falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test state of workspace disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of workspace and globally disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of workspace enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledWorkspace));\n\t});\n\n\ttest('test state of globally disabled and workspace enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledWorkspace));\n\t});\n\n\ttest('test state of an extension when disabled for workspace from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of an extension when disabled globally from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of an extension when disabled globally from workspace disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of an extension when enabled globally from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test state of an extension when enabled globally from workspace disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test disable an extension for workspace and then globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t});\n\n\ttest('test disable an extension for workspace and then globally return a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension for workspace and then globally trigger the change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test disable an extension globally and then for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledWorkspace);\n\t});\n\n\ttest('test disable an extension globally and then for workspace return a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension globally and then for workspace triggers the change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test disable an extension for workspace when there is no workspace throws error', () => {\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkbenchState', WorkbenchState.EMPTY);\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.fail('should throw an error'), error => assert.ok(error));\n\t});\n\n\ttest('test enable an extension globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension globally return truthy promise', async () => {\n\t\tawait testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally);\n\t\tconst value = await testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(value[0], true);\n\t});\n\n\ttest('test enable an extension globally triggers change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test enable an extension globally when already enabled return falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally)\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test enable an extension for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension for workspace return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test enable an extension for workspace triggers change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.b')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.b')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.b' });\n\t\t\t});\n\t});\n\n\ttest('test enable an extension for workspace when already enabled return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test enable an extension for workspace when disabled in workspace and gloablly', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension globally when disabled in workspace and gloablly', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension also enables dependencies', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }), aLocalExtension('pub.b')]);\n\t\tconst target = installed[0];\n\t\tconst dep = installed[1];\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([dep, target], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(dep));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(dep), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension in workspace with a dependency extension that has auth providers', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }), aLocalExtension('pub.b', { authentication: [{ id: 'a', label: 'a' }] })]);\n\t\tconst target = installed[0];\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([target], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension with a dependency extension that cannot be enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceDepExtension = aLocalExtension2('pub.b', { extensionKind: ['workspace'] }, { location: URI.file(`pub.b`) });\n\t\tconst remoteWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'], extensionDependencies: ['pub.b'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst remoteWorkspaceDepExtension = aLocalExtension2('pub.b', { extensionKind: ['workspace'] }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(localWorkspaceDepExtension, remoteWorkspaceExtension, remoteWorkspaceDepExtension);\n\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([remoteWorkspaceExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([remoteWorkspaceExtension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(remoteWorkspaceExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(remoteWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension also enables packed extensions', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionPack: ['pub.b'] }), aLocalExtension('pub.b')]);\n\t\tconst target = installed[0];\n\t\tconst dep = installed[1];\n\t\tawait testObject.setEnablement([dep, target], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(dep));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(dep), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test remove an extension from disablement list when uninstalled', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tdidUninstallEvent.fire({ identifier: { id: 'pub.a' }, profileLocation: null! });\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test isEnabled return false extension is disabled globally', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => assert.ok(!testObject.isEnabled(aLocalExtension('pub.a'))));\n\t});\n\n\ttest('test isEnabled return false extension is disabled in workspace', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.ok(!testObject.isEnabled(aLocalExtension('pub.a'))));\n\t});\n\n\ttest('test isEnabled return true extension is not disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.c')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.ok(testObject.isEnabled(aLocalExtension('pub.b'))));\n\t});\n\n\ttest('test canChangeEnablement return false for language packs', () => {\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { localizations: [{ languageId: 'gr', translations: [{ id: 'vscode', path: 'path' }] }] })), false);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension', () => {\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension when user data sync account does not depends on it', () => {\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'b' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension when user data sync account depends on it but auto sync is off', () => {\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'a' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return false for auth extension and user data sync account depends on it and auto sync is on', () => {\n\t\tinstantiationService.stub(IUserDataSyncEnablementService, <Partial<IUserDataSyncEnablementService>>{ isEnabled() { return true; } });\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'a' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), false);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return true', () => {\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a')), true);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return false if there is no workspace', () => {\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkbenchState', WorkbenchState.EMPTY);\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return false for auth extension', () => {\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extensions are disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeEnablement return false when the extension is disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeEnablement return true for system extensions when extensions are disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst extension = aLocalExtension('pub.a', undefined, ExtensionType.System);\n\t\tassert.strictEqual(testObject.canChangeEnablement(extension), true);\n\t});\n\n\ttest('test canChangeEnablement return false for system extension when extension is disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst extension = aLocalExtension('pub.a', undefined, ExtensionType.System);\n\t\tassert.ok(!testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension is disabled when disabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByEnvironment);\n\t});\n\n\ttest('test extension is enabled globally when enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled workspace when enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test extension is enabled by environment when disabled globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledByEnvironment);\n\t});\n\n\ttest('test extension is enabled by environment when disabled workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledByEnvironment);\n\t});\n\n\ttest('test extension is disabled by environment when also enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\ttestObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true, enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByEnvironment);\n\t});\n\n\ttest('test canChangeEnablement return false when the extension is enabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test extension does not support vitrual workspace is not enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByVirtualWorkspace);\n\t});\n\n\ttest('test web extension from web extension management server and does not support vitrual workspace is enabled in virtual workspace', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false }, browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'web' }) });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension from remote extension management server and does not support vitrual workspace is disabled in virtual workspace', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false }, browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByVirtualWorkspace);\n\t});\n\n\ttest('test enable a remote workspace extension and local ui extension that is a dependency of remote', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tconst target = aLocalExtension2('pub.b', { main: 'main.js', extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.b`).with({ scheme: 'vscode-remote' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tinstalled.push(localUIExtension, remoteUIExtension, target);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(localUIExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable a remote workspace extension also enables its dependency in local', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tconst target = aLocalExtension2('pub.b', { main: 'main.js', extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.b`).with({ scheme: 'vscode-remote' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tinstalled.push(localUIExtension, remoteUIExtension, target);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(localUIExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled in virtual workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension does not support vitrual workspace is enabled in normal workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA') }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension supports virtual workspace is enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: true } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension does not support untrusted workspaces is disabled in untrusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByTrustRequirement);\n\t});\n\n\ttest('test canChangeEnablement return true when extension is disabled by workspace trust', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension supports untrusted workspaces is enabled in untrusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension does not support untrusted workspaces is enabled in trusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension supports untrusted workspaces is enabled in trusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension without any value for virtual worksapce is enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a');\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test local workspace extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test local workspace + ui extension is enabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace', 'ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test local ui extension is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return true when the local workspace extension is disabled by kind', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), false);\n\t});\n\n\ttest('test canChangeEnablement return true for local ui extension', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), true);\n\t});\n\n\ttest('test remote ui extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test remote ui+workspace extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui', 'workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test remote ui extension is disabled by kind when there is no local server', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test remote workspace extension is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return true when the remote ui extension is disabled by kind', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), false);\n\t});\n\n\ttest('test canChangeEnablement return true for remote workspace extension', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), true);\n\t});\n\n\ttest('test web extension on local server is disabled by kind when web worker is not enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on local server is not disabled by kind when web worker is enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension on remote server is disabled by kind when web worker is not enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on remote server is disabled by kind when web worker is enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on remote server is enabled in web', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension on web server is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst webExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'web' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(webExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(webExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test state of multipe extensions', async () => {\n\t\tinstalled.push(...[aLocalExtension('pub.a'), aLocalExtension('pub.b'), aLocalExtension('pub.c'), aLocalExtension('pub.d'), aLocalExtension('pub.e')]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([installed[1]], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([installed[2]], EnablementState.EnabledWorkspace);\n\t\tawait testObject.setEnablement([installed[3]], EnablementState.EnabledGlobally);\n\n\t\tassert.deepStrictEqual(testObject.getEnablementStates(installed), [EnablementState.DisabledGlobally, EnablementState.DisabledWorkspace, EnablementState.EnabledWorkspace, EnablementState.EnabledGlobally, EnablementState.EnabledGlobally]);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a'), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled by virtual workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { virtualWorkspaces: true } })]);\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[0]), EnablementState.DisabledByVirtualWorkspace);\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled by virtual workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { virtualWorkspaces: true } })]);\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.ok(!testObject.canChangeEnablement(installed[1]));\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled by workspace trust', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { main: 'hello.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { untrustedWorkspaces: { supported: true } } })]);\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[0]), EnablementState.DisabledByTrustRequirement);\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is not disabled by dependency if it has a dependency that is disabled by extension kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst remoteWorkspaceExtension = aLocalExtension2('pub.n', { extensionKind: ['workspace'], extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(localUIExtension, remoteUIExtension, remoteWorkspaceExtension);\n\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(remoteUIExtension), EnablementState.DisabledByExtensionKind);\n\t\tassert.strictEqual(testObject.getEnablementState(remoteWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled by workspace trust', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { main: 'hello.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { untrustedWorkspaces: { supported: true } } })]);\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled globally', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', {}), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', {}), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledWorkspace);\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test extension is not disabled by dependency even if it has a dependency that is disabled when installed extensions are not set', async () => {\n\t\tawait testObject.setEnablement([aLocalExtension2('pub.a')], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled when all extensions are passed', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a'), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.deepStrictEqual(testObject.getEnablementStates(installed), [EnablementState.DisabledGlobally, EnablementState.DisabledByExtensionDependency]);\n\t});\n\n\ttest('test extension is not disabled when it has a missing dependency', async () => {\n\t\tconst target = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(target);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is not disabled when it has a dependency in another server', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', {}, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled when it has a dependency in another server which is disabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', {}, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled when it has a dependency in another server which is disabled and with no exports and no main and no browser entrypoints', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none' }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency in another server  which is disabled and with no exports and has main entry point', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none', main: 'main.js' }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency in another server  which is disabled and with no exports and has browser entry point', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none', browser: 'browser.js', extensionKind: 'ui' }, { location: URI.file(`pub.b`) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by invalidity', async () => {\n\t\tconst target = aLocalExtension2('pub.b', {}, { isValid: false });\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByInvalidExtension);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency that is invalid', async () => {\n\t\tconst target = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(...[target, aLocalExtension2('pub.a', {}, { isValid: false })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is enabled when its dependency becomes valid', async () => {\n\t\tconst extension = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(...[extension, aLocalExtension2('pub.a', {}, { isValid: false })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByExtensionDependency);\n\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\n\t\tconst validExtension = aLocalExtension2('pub.a');\n\t\tdidInstallEvent.fire([{\n\t\t\tidentifier: validExtension.identifier,\n\t\t\toperation: InstallOperation.Install,\n\t\t\tsource: validExtension.location,\n\t\t\tprofileLocation: validExtension.location,\n\t\t\tlocal: validExtension,\n\t\t}]);\n\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.b' });\n\t});\n\n\ttest('test override workspace to trusted when getting extensions enablements', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.strictEqual(testObject.getEnablementStates([extension], { trusted: true })[0], EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test override workspace to not trusted when getting extensions enablements', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.strictEqual(testObject.getEnablementStates([extension], { trusted: false })[0], EnablementState.DisabledByTrustRequirement);\n\t});\n\n\ttest('test update extensions enablements on trust change triggers change events for extensions depending on workspace trust', async () => {\n\t\tinstalled.push(...[\n\t\t\taLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } }),\n\t\t\taLocalExtension2('pub.b', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } }),\n\t\t\taLocalExtension2('pub.c', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } }),\n\t\t\taLocalExtension2('pub.d', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } }),\n\t\t]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\n\t\tawait testObject.updateExtensionsEnablementsWhenWorkspaceTrustChanges();\n\t\tassert.strictEqual(target.args[0][0].length, 2);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][1]).identifier, { id: 'pub.c' });\n\t});\n\n\ttest('test adding an extension that was disabled', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\t\tdidChangeProfileExtensionsEvent.fire({ added: [extension], removed: [] });\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t\tassert.strictEqual(target.args[0][0].length, 1);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t});\n\n\ttest('test extension is disabled by allowed list', async () => {\n\t\tconst target = aLocalExtension2('unallowed.extension');\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByAllowlist);\n\t});\n\n\ttest('test extension is disabled by malicious', async () => {\n\t\tmalicious.push({ id: 'malicious.extensionA' });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tconst target = aLocalExtension2('malicious.extensionA');\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByMalicious);\n\t});\n\n\ttest('test installed malicious extension triggers change event', async () => {\n\t\ttestObject.dispose();\n\t\tmalicious.push({ id: 'malicious.extensionB' });\n\t\tconst local = aLocalExtension2('malicious.extensionB');\n\t\tinstalled.push(local);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(local), EnablementState.EnabledGlobally);\n\t\tconst promise = Event.toPromise(testObject.onEnablementChanged);\n\n\t\tconst result = await promise;\n\t\tassert.deepStrictEqual(result[0], local);\n\t\tassert.strictEqual(testObject.getEnablementState(local), EnablementState.DisabledByMalicious);\n\t});\n\n});\n\nfunction anExtensionManagementServer(authority: string, instantiationService: TestInstantiationService): IExtensionManagementServer {\n\treturn {\n\t\tid: authority,\n\t\tlabel: authority,\n\t\textensionManagementService: instantiationService.get(IExtensionManagementService) as IProfileAwareExtensionManagementService,\n\t};\n}\n\nfunction aMultiExtensionManagementServerService(instantiationService: TestInstantiationService): IExtensionManagementServerService {\n\tconst localExtensionManagementServer = anExtensionManagementServer('vscode-local', instantiationService);\n\tconst remoteExtensionManagementServer = anExtensionManagementServer('vscode-remote', instantiationService);\n\treturn anExtensionManagementServerService(localExtensionManagementServer, remoteExtensionManagementServer, null);\n}\n\nexport function anExtensionManagementServerService(localExtensionManagementServer: IExtensionManagementServer | null, remoteExtensionManagementServer: IExtensionManagementServer | null, webExtensionManagementServer: IExtensionManagementServer | null): IExtensionManagementServerService {\n\treturn {\n\t\t_serviceBrand: undefined,\n\t\tlocalExtensionManagementServer,\n\t\tremoteExtensionManagementServer,\n\t\twebExtensionManagementServer,\n\t\tgetExtensionManagementServer: (extension: IExtension) => {\n\t\t\tif (extension.location.scheme === Schemas.file) {\n\t\t\t\treturn localExtensionManagementServer;\n\t\t\t}\n\t\t\tif (extension.location.scheme === Schemas.vscodeRemote) {\n\t\t\t\treturn remoteExtensionManagementServer;\n\t\t\t}\n\t\t\treturn webExtensionManagementServer;\n\t\t},\n\t\tgetExtensionInstallLocation(extension: IExtension): ExtensionInstallLocation | null {\n\t\t\tconst server = this.getExtensionManagementServer(extension);\n\t\t\treturn server === remoteExtensionManagementServer ? ExtensionInstallLocation.Remote\n\t\t\t\t: server === webExtensionManagementServer ? ExtensionInstallLocation.Web\n\t\t\t\t\t: ExtensionInstallLocation.Local;\n\t\t}\n\t};\n}\n\nfunction aLocalExtension(id: string, contributes?: IExtensionContributions, type?: ExtensionType): ILocalExtension {\n\treturn aLocalExtension2(id, contributes ? { contributes } : {}, isUndefinedOrNull(type) ? {} : { type });\n}\n\nfunction aLocalExtension2(id: string, manifest: Partial<IExtensionManifest> = {}, properties: IStringDictionary<unknown> = {}): ILocalExtension {\n\tconst [publisher, name] = id.split('.');\n\tmanifest = { name, publisher, ...manifest };\n\tproperties = {\n\t\tidentifier: { id },\n\t\tlocation: URI.file(`pub.${name}`),\n\t\tgalleryIdentifier: { id, uuid: undefined },\n\t\ttype: ExtensionType.User,\n\t\t...properties,\n\t\tisValid: properties.isValid ?? true,\n\t};\n\tproperties.isBuiltin = properties.type === ExtensionType.System;\n\treturn <ILocalExtension>Object.create({ manifest, ...properties });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport assert from 'assert';\nimport * as sinon from 'sinon';\nimport { IExtensionManagementService, DidUninstallExtensionEvent, ILocalExtension, InstallExtensionEvent, InstallExtensionResult, UninstallExtensionEvent, DidUpdateExtensionMetadata, InstallOperation, IAllowedExtensionsService, AllowedExtensionsConfigKey, IExtensionsControlManifest } from '../../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { EnablementState, IExtensionManagementServerService, IExtensionManagementServer, IWorkbenchExtensionManagementService, ExtensionInstallLocation, IProfileAwareExtensionManagementService, DidChangeProfileEvent } from '../../common/extensionManagement.js';\nimport { ExtensionEnablementService } from '../../browser/extensionEnablementService.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { IWorkspace, IWorkspaceContextService, WorkbenchState } from '../../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchEnvironmentService } from '../../../environment/common/environmentService.js';\nimport { IStorageService, InMemoryStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { IExtensionContributions, ExtensionType, IExtension, IExtensionManifest, IExtensionIdentifier } from '../../../../../platform/extensions/common/extensions.js';\nimport { isUndefinedOrNull } from '../../../../../base/common/types.js';\nimport { areSameExtensions } from '../../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { TestConfigurationService } from '../../../../../platform/configuration/test/common/testConfigurationService.js';\nimport { productService, TestLifecycleService } from '../../../../test/browser/workbenchTestServices.js';\nimport { GlobalExtensionEnablementService } from '../../../../../platform/extensionManagement/common/extensionEnablementService.js';\nimport { IUserDataSyncAccountService, UserDataSyncAccountService } from '../../../../../platform/userDataSync/common/userDataSyncAccount.js';\nimport { IUserDataSyncEnablementService } from '../../../../../platform/userDataSync/common/userDataSync.js';\nimport { ILifecycleService } from '../../../lifecycle/common/lifecycle.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { TestNotificationService } from '../../../../../platform/notification/test/common/testNotificationService.js';\nimport { IHostService } from '../../../host/browser/host.js';\nimport { mock } from '../../../../../base/test/common/mock.js';\nimport { IExtensionBisectService } from '../../browser/extensionBisect.js';\nimport { IWorkspaceTrustManagementService, IWorkspaceTrustRequestService, WorkspaceTrustRequestOptions } from '../../../../../platform/workspace/common/workspaceTrust.js';\nimport { ExtensionManifestPropertiesService, IExtensionManifestPropertiesService } from '../../../extensions/common/extensionManifestPropertiesService.js';\nimport { TestContextService, TestProductService, TestWorkspaceTrustEnablementService, TestWorkspaceTrustManagementService } from '../../../../test/common/workbenchTestServices.js';\nimport { TestWorkspace } from '../../../../../platform/workspace/test/common/testWorkspace.js';\nimport { ExtensionManagementService } from '../../common/extensionManagementService.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { IFileService } from '../../../../../platform/files/common/files.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { AllowedExtensionsService } from '../../../../../platform/extensionManagement/common/allowedExtensionsService.js';\nimport { IStringDictionary } from '../../../../../base/common/collections.js';\n\nfunction createStorageService(instantiationService: TestInstantiationService, disposableStore: DisposableStore): IStorageService {\n\tlet service = instantiationService.get(IStorageService);\n\tif (!service) {\n\t\tlet workspaceContextService = instantiationService.get(IWorkspaceContextService);\n\t\tif (!workspaceContextService) {\n\t\t\tworkspaceContextService = instantiationService.stub(IWorkspaceContextService, <IWorkspaceContextService>{\n\t\t\t\tgetWorkbenchState: () => WorkbenchState.FOLDER,\n\t\t\t\tgetWorkspace: () => TestWorkspace as IWorkspace\n\t\t\t});\n\t\t}\n\t\tservice = instantiationService.stub(IStorageService, disposableStore.add(new InMemoryStorageService()));\n\t}\n\treturn service;\n}\n\nexport class TestExtensionEnablementService extends ExtensionEnablementService {\n\tconstructor(instantiationService: TestInstantiationService) {\n\t\tconst disposables = new DisposableStore();\n\t\tconst storageService = createStorageService(instantiationService, disposables);\n\t\tconst extensionManagementServerService = instantiationService.get(IExtensionManagementServerService) ||\n\t\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService({\n\t\t\t\tid: 'local',\n\t\t\t\tlabel: 'local',\n\t\t\t\textensionManagementService: <IProfileAwareExtensionManagementService>{\n\t\t\t\t\tonInstallExtension: disposables.add(new Emitter<InstallExtensionEvent>()).event,\n\t\t\t\t\tonDidInstallExtensions: disposables.add(new Emitter<readonly InstallExtensionResult[]>()).event,\n\t\t\t\t\tonUninstallExtension: disposables.add(new Emitter<UninstallExtensionEvent>()).event,\n\t\t\t\t\tonDidUninstallExtension: disposables.add(new Emitter<DidUninstallExtensionEvent>()).event,\n\t\t\t\t\tonDidChangeProfile: disposables.add(new Emitter<DidChangeProfileEvent>()).event,\n\t\t\t\t\tonDidUpdateExtensionMetadata: disposables.add(new Emitter<DidUpdateExtensionMetadata>()).event,\n\t\t\t\t\tonProfileAwareDidInstallExtensions: Event.None,\n\t\t\t\t},\n\t\t\t}, null, null));\n\t\tconst extensionManagementService = disposables.add(instantiationService.createInstance(ExtensionManagementService));\n\t\tconst workbenchExtensionManagementService = instantiationService.get(IWorkbenchExtensionManagementService) || instantiationService.stub(IWorkbenchExtensionManagementService, extensionManagementService);\n\t\tconst workspaceTrustManagementService = instantiationService.get(IWorkspaceTrustManagementService) || instantiationService.stub(IWorkspaceTrustManagementService, disposables.add(new TestWorkspaceTrustManagementService()));\n\t\tsuper(\n\t\t\tstorageService,\n\t\t\tdisposables.add(new GlobalExtensionEnablementService(storageService, extensionManagementService)),\n\t\t\tinstantiationService.get(IWorkspaceContextService) || new TestContextService(),\n\t\t\tinstantiationService.get(IWorkbenchEnvironmentService) || instantiationService.stub(IWorkbenchEnvironmentService, {}),\n\t\t\tworkbenchExtensionManagementService,\n\t\t\tinstantiationService.get(IConfigurationService),\n\t\t\textensionManagementServerService,\n\t\t\tinstantiationService.get(IUserDataSyncEnablementService) || instantiationService.stub(IUserDataSyncEnablementService, <Partial<IUserDataSyncEnablementService>>{ isEnabled() { return false; } }),\n\t\t\tinstantiationService.get(IUserDataSyncAccountService) || instantiationService.stub(IUserDataSyncAccountService, UserDataSyncAccountService),\n\t\t\tinstantiationService.get(ILifecycleService) || instantiationService.stub(ILifecycleService, disposables.add(new TestLifecycleService())),\n\t\t\tinstantiationService.get(INotificationService) || instantiationService.stub(INotificationService, new TestNotificationService()),\n\t\t\tinstantiationService.get(IHostService),\n\t\t\tnew class extends mock<IExtensionBisectService>() { override isDisabledByBisect() { return false; } },\n\t\t\tinstantiationService.stub(IAllowedExtensionsService, disposables.add(new AllowedExtensionsService(instantiationService.get(IProductService), instantiationService.get(IConfigurationService)))),\n\t\t\tworkspaceTrustManagementService,\n\t\t\tnew class extends mock<IWorkspaceTrustRequestService>() { override requestWorkspaceTrust(options?: WorkspaceTrustRequestOptions): Promise<boolean> { return Promise.resolve(true); } },\n\t\t\tinstantiationService.get(IExtensionManifestPropertiesService) || instantiationService.stub(IExtensionManifestPropertiesService, disposables.add(new ExtensionManifestPropertiesService(TestProductService, new TestConfigurationService(), new TestWorkspaceTrustEnablementService(), new NullLogService()))),\n\t\t\tinstantiationService,\n\t\t\tnew NullLogService(),\n\t\t\tproductService\n\t\t);\n\t\tthis._register(disposables);\n\t}\n\n\tpublic async waitUntilInitialized(): Promise<void> {\n\t\tawait this.extensionsManager.whenInitialized();\n\t}\n\n\tpublic reset(): void {\n\t\tlet extensions = this.globalExtensionEnablementService.getDisabledExtensions();\n\t\tfor (const e of this._getWorkspaceDisabledExtensions()) {\n\t\t\tif (!extensions.some(r => areSameExtensions(r, e))) {\n\t\t\t\textensions.push(e);\n\t\t\t}\n\t\t}\n\t\tconst workspaceEnabledExtensions = this._getWorkspaceEnabledExtensions();\n\t\tif (workspaceEnabledExtensions.length) {\n\t\t\textensions = extensions.filter(r => !workspaceEnabledExtensions.some(e => areSameExtensions(e, r)));\n\t\t}\n\t\textensions.forEach(d => this.setEnablement([aLocalExtension(d.id)], EnablementState.EnabledGlobally));\n\t}\n}\n\nsuite('ExtensionEnablementService Test', () => {\n\n\tconst disposableStore = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet instantiationService: TestInstantiationService;\n\tlet testObject: TestExtensionEnablementService;\n\n\tconst didInstallEvent = new Emitter<readonly InstallExtensionResult[]>();\n\tconst didUninstallEvent = new Emitter<DidUninstallExtensionEvent>();\n\tconst didChangeProfileExtensionsEvent = new Emitter<DidChangeProfileEvent>();\n\tconst installed: ILocalExtension[] = [];\n\tconst malicious: IExtensionIdentifier[] = [];\n\n\tsetup(() => {\n\t\tinstalled.splice(0, installed.length);\n\t\tinstantiationService = disposableStore.add(new TestInstantiationService());\n\t\tinstantiationService.stub(IFileService, disposableStore.add(new FileService(new NullLogService())));\n\t\tinstantiationService.stub(IProductService, TestProductService);\n\t\tconst testConfigurationService = new TestConfigurationService();\n\t\ttestConfigurationService.setUserConfiguration(AllowedExtensionsConfigKey, { '*': true, 'unallowed': false });\n\t\tinstantiationService.stub(IConfigurationService, testConfigurationService);\n\t\tinstantiationService.stub(IWorkspaceContextService, new TestContextService());\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService({\n\t\t\tid: 'local',\n\t\t\tlabel: 'local',\n\t\t\textensionManagementService: <IProfileAwareExtensionManagementService>{\n\t\t\t\tonDidInstallExtensions: didInstallEvent.event,\n\t\t\t\tonDidUninstallExtension: didUninstallEvent.event,\n\t\t\t\tonDidChangeProfile: didChangeProfileExtensionsEvent.event,\n\t\t\t\tonProfileAwareDidInstallExtensions: Event.None,\n\t\t\t\tgetInstalled: () => Promise.resolve(installed),\n\t\t\t\tasync getExtensionsControlManifest(): Promise<IExtensionsControlManifest> {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmalicious: malicious.map(e => ({ extensionOrPublisher: e })),\n\t\t\t\t\t\tdeprecated: {},\n\t\t\t\t\t\tsearch: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t},\n\t\t}, null, null));\n\t\tinstantiationService.stub(ILogService, NullLogService);\n\t\tinstantiationService.stub(IWorkbenchExtensionManagementService, disposableStore.add(instantiationService.createInstance(ExtensionManagementService)));\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t});\n\n\ttest('test disable an extension globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t});\n\n\ttest('test disable an extension globally should return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension globally triggers the change event', async () => {\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\t\tawait testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally);\n\t\tassert.ok(target.calledOnce);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t});\n\n\ttest('test disable an extension globally again should return a falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test state of globally disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of globally enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test disable an extension for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledWorkspace);\n\t});\n\n\ttest('test disable an extension for workspace returns a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension for workspace again should return a falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test state of workspace disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of workspace and globally disabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of workspace enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledWorkspace));\n\t});\n\n\ttest('test state of globally disabled and workspace enabled extension', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledWorkspace));\n\t});\n\n\ttest('test state of an extension when disabled for workspace from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledWorkspace));\n\t});\n\n\ttest('test state of an extension when disabled globally from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of an extension when disabled globally from workspace disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.DisabledGlobally));\n\t});\n\n\ttest('test state of an extension when enabled globally from workspace enabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test state of an extension when enabled globally from workspace disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => assert.strictEqual(testObject.getEnablementState(aLocalExtension('pub.a')), EnablementState.EnabledGlobally));\n\t});\n\n\ttest('test disable an extension for workspace and then globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t});\n\n\ttest('test disable an extension for workspace and then globally return a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension for workspace and then globally trigger the change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test disable an extension globally and then for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledWorkspace);\n\t});\n\n\ttest('test disable an extension globally and then for workspace return a truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test disable an extension globally and then for workspace triggers the change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test disable an extension for workspace when there is no workspace throws error', () => {\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkbenchState', WorkbenchState.EMPTY);\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.fail('should throw an error'), error => assert.ok(error));\n\t});\n\n\ttest('test enable an extension globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension globally return truthy promise', async () => {\n\t\tawait testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally);\n\t\tconst value = await testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(value[0], true);\n\t});\n\n\ttest('test enable an extension globally triggers change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\t\t});\n\t});\n\n\ttest('test enable an extension globally when already enabled return falsy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledGlobally)\n\t\t\t.then(value => assert.ok(!value[0]));\n\t});\n\n\ttest('test enable an extension for workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension for workspace return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace))\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test enable an extension for workspace triggers change event', () => {\n\t\tconst target = sinon.spy();\n\t\treturn testObject.setEnablement([aLocalExtension('pub.b')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => disposableStore.add(testObject.onEnablementChanged(target)))\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.b')], EnablementState.EnabledWorkspace))\n\t\t\t.then(() => {\n\t\t\t\tassert.ok(target.calledOnce);\n\t\t\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.b' });\n\t\t\t});\n\t});\n\n\ttest('test enable an extension for workspace when already enabled return truthy promise', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.EnabledWorkspace)\n\t\t\t.then(value => assert.ok(value));\n\t});\n\n\ttest('test enable an extension for workspace when disabled in workspace and gloablly', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension globally when disabled in workspace and gloablly', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension also enables dependencies', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }), aLocalExtension('pub.b')]);\n\t\tconst target = installed[0];\n\t\tconst dep = installed[1];\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([dep, target], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(dep));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(dep), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension in workspace with a dependency extension that has auth providers', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }), aLocalExtension('pub.b', { authentication: [{ id: 'a', label: 'a' }] })]);\n\t\tconst target = installed[0];\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([target], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledWorkspace);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test enable an extension with a dependency extension that cannot be enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceDepExtension = aLocalExtension2('pub.b', { extensionKind: ['workspace'] }, { location: URI.file(`pub.b`) });\n\t\tconst remoteWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'], extensionDependencies: ['pub.b'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst remoteWorkspaceDepExtension = aLocalExtension2('pub.b', { extensionKind: ['workspace'] }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(localWorkspaceDepExtension, remoteWorkspaceExtension, remoteWorkspaceDepExtension);\n\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([remoteWorkspaceExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([remoteWorkspaceExtension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(remoteWorkspaceExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(remoteWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable an extension also enables packed extensions', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { extensionPack: ['pub.b'] }), aLocalExtension('pub.b')]);\n\t\tconst target = installed[0];\n\t\tconst dep = installed[1];\n\t\tawait testObject.setEnablement([dep, target], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(dep));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(dep), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test remove an extension from disablement list when uninstalled', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tdidUninstallEvent.fire({ identifier: { id: 'pub.a' }, profileLocation: null! });\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test isEnabled return false extension is disabled globally', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledGlobally)\n\t\t\t.then(() => assert.ok(!testObject.isEnabled(aLocalExtension('pub.a'))));\n\t});\n\n\ttest('test isEnabled return false extension is disabled in workspace', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => assert.ok(!testObject.isEnabled(aLocalExtension('pub.a'))));\n\t});\n\n\ttest('test isEnabled return true extension is not disabled', () => {\n\t\treturn testObject.setEnablement([aLocalExtension('pub.a')], EnablementState.DisabledWorkspace)\n\t\t\t.then(() => testObject.setEnablement([aLocalExtension('pub.c')], EnablementState.DisabledGlobally))\n\t\t\t.then(() => assert.ok(testObject.isEnabled(aLocalExtension('pub.b'))));\n\t});\n\n\ttest('test canChangeEnablement return false for language packs', () => {\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { localizations: [{ languageId: 'gr', translations: [{ id: 'vscode', path: 'path' }] }] })), false);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension', () => {\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension when user data sync account does not depends on it', () => {\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'b' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return true for auth extension when user data sync account depends on it but auto sync is off', () => {\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'a' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), true);\n\t});\n\n\ttest('test canChangeEnablement return false for auth extension and user data sync account depends on it and auto sync is on', () => {\n\t\tinstantiationService.stub(IUserDataSyncEnablementService, <Partial<IUserDataSyncEnablementService>>{ isEnabled() { return true; } });\n\t\tinstantiationService.stub(IUserDataSyncAccountService, <Partial<IUserDataSyncAccountService>>{\n\t\t\taccount: { authenticationProviderId: 'a' }\n\t\t});\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), false);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return true', () => {\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a')), true);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return false if there is no workspace', () => {\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkbenchState', WorkbenchState.EMPTY);\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeWorkspaceEnablement return false for auth extension', () => {\n\t\tassert.strictEqual(testObject.canChangeWorkspaceEnablement(aLocalExtension('pub.a', { authentication: [{ id: 'a', label: 'a' }] })), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extensions are disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeEnablement return false when the extension is disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test canChangeEnablement return true for system extensions when extensions are disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst extension = aLocalExtension('pub.a', undefined, ExtensionType.System);\n\t\tassert.strictEqual(testObject.canChangeEnablement(extension), true);\n\t});\n\n\ttest('test canChangeEnablement return false for system extension when extension is disabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst extension = aLocalExtension('pub.a', undefined, ExtensionType.System);\n\t\tassert.ok(!testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension is disabled when disabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: ['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByEnvironment);\n\t});\n\n\ttest('test extension is enabled globally when enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled workspace when enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.EnabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledWorkspace);\n\t});\n\n\ttest('test extension is enabled by environment when disabled globally', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledByEnvironment);\n\t});\n\n\ttest('test extension is enabled by environment when disabled workspace', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledByEnvironment);\n\t});\n\n\ttest('test extension is disabled by environment when also enabled in environment', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\n\t\ttestObject.setEnablement([extension], EnablementState.DisabledWorkspace);\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { disableExtensions: true, enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByEnvironment);\n\t});\n\n\ttest('test canChangeEnablement return false when the extension is enabled in environment', () => {\n\t\tinstantiationService.stub(IWorkbenchEnvironmentService, { enableExtensions: <readonly string[]>['pub.a'] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(aLocalExtension('pub.a')), false);\n\t});\n\n\ttest('test extension does not support vitrual workspace is not enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByVirtualWorkspace);\n\t});\n\n\ttest('test web extension from web extension management server and does not support vitrual workspace is enabled in virtual workspace', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false }, browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'web' }) });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension from remote extension management server and does not support vitrual workspace is disabled in virtual workspace', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false }, browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByVirtualWorkspace);\n\t});\n\n\ttest('test enable a remote workspace extension and local ui extension that is a dependency of remote', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tconst target = aLocalExtension2('pub.b', { main: 'main.js', extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.b`).with({ scheme: 'vscode-remote' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tinstalled.push(localUIExtension, remoteUIExtension, target);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(localUIExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test enable a remote workspace extension also enables its dependency in local', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { main: 'main.js', extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\tconst target = aLocalExtension2('pub.b', { main: 'main.js', extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.b`).with({ scheme: 'vscode-remote' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tinstalled.push(localUIExtension, remoteUIExtension, target);\n\t\tawait testObject.setEnablement([target, localUIExtension], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([target], EnablementState.EnabledGlobally);\n\t\tassert.ok(testObject.isEnabled(target));\n\t\tassert.ok(testObject.isEnabled(localUIExtension));\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled in virtual workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension does not support vitrual workspace is enabled in normal workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA') }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension supports virtual workspace is enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: true } });\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension does not support untrusted workspaces is disabled in untrusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByTrustRequirement);\n\t});\n\n\ttest('test canChangeEnablement return true when extension is disabled by workspace trust', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.canChangeEnablement(extension));\n\t});\n\n\ttest('test extension supports untrusted workspaces is enabled in untrusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension does not support untrusted workspaces is enabled in trusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension supports untrusted workspaces is enabled in trusted workspace', () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension without any value for virtual worksapce is enabled in virtual workspace', async () => {\n\t\tconst extension = aLocalExtension2('pub.a');\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(extension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test local workspace extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test local workspace + ui extension is enabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace', 'ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test local ui extension is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return true when the local workspace extension is disabled by kind', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), false);\n\t});\n\n\ttest('test canChangeEnablement return true for local ui extension', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), true);\n\t});\n\n\ttest('test remote ui extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test remote ui+workspace extension is disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui', 'workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test remote ui extension is disabled by kind when there is no local server', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(null, anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(!testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test remote workspace extension is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.ok(testObject.isEnabled(localWorkspaceExtension));\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return true when the remote ui extension is disabled by kind', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), false);\n\t});\n\n\ttest('test canChangeEnablement return true for remote workspace extension', () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { extensionKind: ['workspace'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.canChangeEnablement(localWorkspaceExtension), true);\n\t});\n\n\ttest('test web extension on local server is disabled by kind when web worker is not enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on local server is not disabled by kind when web worker is enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension on remote server is disabled by kind when web worker is not enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on remote server is disabled by kind when web worker is enabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: true });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), false);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.DisabledByExtensionKind);\n\t});\n\n\ttest('test web extension on remote server is enabled in web', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst localWorkspaceExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'vscode-remote' }) });\n\t\t(<TestConfigurationService>instantiationService.get(IConfigurationService)).setUserConfiguration('extensions', { webWorker: false });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(localWorkspaceExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(localWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test web extension on web server is not disabled by kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), anExtensionManagementServer('web', instantiationService)));\n\t\tconst webExtension = aLocalExtension2('pub.a', { browser: 'browser.js' }, { location: URI.file(`pub.a`).with({ scheme: 'web' }) });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.isEnabled(webExtension), true);\n\t\tassert.deepStrictEqual(testObject.getEnablementState(webExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test state of multipe extensions', async () => {\n\t\tinstalled.push(...[aLocalExtension('pub.a'), aLocalExtension('pub.b'), aLocalExtension('pub.c'), aLocalExtension('pub.d'), aLocalExtension('pub.e')]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\t\tawait testObject.setEnablement([installed[1]], EnablementState.DisabledWorkspace);\n\t\tawait testObject.setEnablement([installed[2]], EnablementState.EnabledWorkspace);\n\t\tawait testObject.setEnablement([installed[3]], EnablementState.EnabledGlobally);\n\n\t\tassert.deepStrictEqual(testObject.getEnablementStates(installed), [EnablementState.DisabledGlobally, EnablementState.DisabledWorkspace, EnablementState.EnabledWorkspace, EnablementState.EnabledGlobally, EnablementState.EnabledGlobally]);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a'), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled by virtual workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { virtualWorkspaces: true } })]);\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[0]), EnablementState.DisabledByVirtualWorkspace);\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled by virtual workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { capabilities: { virtualWorkspaces: false } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { virtualWorkspaces: true } })]);\n\t\tinstantiationService.stub(IWorkspaceContextService, 'getWorkspace', <IWorkspace>{ folders: [{ uri: URI.file('worskapceA').with(({ scheme: 'virtual' })) }] });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.ok(!testObject.canChangeEnablement(installed[1]));\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled by workspace trust', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { main: 'hello.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { untrustedWorkspaces: { supported: true } } })]);\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(installed[0]), EnablementState.DisabledByTrustRequirement);\n\t\tassert.strictEqual(testObject.getEnablementState(installed[1]), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is not disabled by dependency if it has a dependency that is disabled by extension kind', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, anExtensionManagementServerService(anExtensionManagementServer('vscode-local', instantiationService), anExtensionManagementServer('vscode-remote', instantiationService), null));\n\t\tconst localUIExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst remoteUIExtension = aLocalExtension2('pub.a', { extensionKind: ['ui'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst remoteWorkspaceExtension = aLocalExtension2('pub.n', { extensionKind: ['workspace'], extensionDependencies: ['pub.a'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(localUIExtension, remoteUIExtension, remoteWorkspaceExtension);\n\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(localUIExtension), EnablementState.EnabledGlobally);\n\t\tassert.strictEqual(testObject.getEnablementState(remoteUIExtension), EnablementState.DisabledByExtensionKind);\n\t\tassert.strictEqual(testObject.getEnablementState(remoteWorkspaceExtension), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled by workspace trust', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', { main: 'hello.js', capabilities: { untrustedWorkspaces: { supported: false, description: '' } } }), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'], capabilities: { untrustedWorkspaces: { supported: true } } })]);\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled globally', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', {}), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test canChangeEnablement return false when extension is disabled by dependency if it has a dependency that is disabled workspace', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a', {}), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledWorkspace);\n\n\t\tassert.deepEqual(testObject.canChangeEnablement(installed[1]), false);\n\t});\n\n\ttest('test extension is not disabled by dependency even if it has a dependency that is disabled when installed extensions are not set', async () => {\n\t\tawait testObject.setEnablement([aLocalExtension2('pub.a')], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is disabled by dependency if it has a dependency that is disabled when all extensions are passed', async () => {\n\t\tinstalled.push(...[aLocalExtension2('pub.a'), aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tawait testObject.setEnablement([installed[0]], EnablementState.DisabledGlobally);\n\n\t\tassert.deepStrictEqual(testObject.getEnablementStates(installed), [EnablementState.DisabledGlobally, EnablementState.DisabledByExtensionDependency]);\n\t});\n\n\ttest('test extension is not disabled when it has a missing dependency', async () => {\n\t\tconst target = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(target);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is not disabled when it has a dependency in another server', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', {}, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled when it has a dependency in another server which is disabled', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', {}, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is enabled when it has a dependency in another server which is disabled and with no exports and no main and no browser entrypoints', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none' }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency in another server  which is disabled and with no exports and has main entry point', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'], extensionKind: ['ui'] }, { location: URI.file(`pub.a`) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none', main: 'main.js' }, { location: URI.file(`pub.b`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency in another server  which is disabled and with no exports and has browser entry point', async () => {\n\t\tinstantiationService.stub(IExtensionManagementServerService, aMultiExtensionManagementServerService(instantiationService));\n\t\tconst target = aLocalExtension2('pub.a', { extensionDependencies: ['pub.b'] }, { location: URI.file(`pub.a`).with({ scheme: Schemas.vscodeRemote }) });\n\t\tconst depdencyOnAnotherServer = aLocalExtension2('pub.b', { api: 'none', browser: 'browser.js', extensionKind: 'ui' }, { location: URI.file(`pub.b`) });\n\t\tinstalled.push(...[target, depdencyOnAnotherServer]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tawait testObject.setEnablement([depdencyOnAnotherServer], EnablementState.DisabledGlobally);\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is disabled by invalidity', async () => {\n\t\tconst target = aLocalExtension2('pub.b', {}, { isValid: false });\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByInvalidExtension);\n\t});\n\n\ttest('test extension is disabled by dependency when it has a dependency that is invalid', async () => {\n\t\tconst target = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(...[target, aLocalExtension2('pub.a', {}, { isValid: false })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByExtensionDependency);\n\t});\n\n\ttest('test extension is enabled when its dependency becomes valid', async () => {\n\t\tconst extension = aLocalExtension2('pub.b', { extensionDependencies: ['pub.a'] });\n\t\tinstalled.push(...[extension, aLocalExtension2('pub.a', {}, { isValid: false })]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledByExtensionDependency);\n\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\n\t\tconst validExtension = aLocalExtension2('pub.a');\n\t\tdidInstallEvent.fire([{\n\t\t\tidentifier: validExtension.identifier,\n\t\t\toperation: InstallOperation.Install,\n\t\t\tsource: validExtension.location,\n\t\t\tprofileLocation: validExtension.location,\n\t\t\tlocal: validExtension,\n\t\t}]);\n\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.EnabledGlobally);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.b' });\n\t});\n\n\ttest('test override workspace to trusted when getting extensions enablements', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return false; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.strictEqual(testObject.getEnablementStates([extension], { trusted: true })[0], EnablementState.EnabledGlobally);\n\t});\n\n\ttest('test override workspace to not trusted when getting extensions enablements', async () => {\n\t\tconst extension = aLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } });\n\t\tinstantiationService.stub(IWorkspaceTrustManagementService, <Partial<IWorkspaceTrustManagementService>>{ isWorkspaceTrusted() { return true; } });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\n\t\tassert.strictEqual(testObject.getEnablementStates([extension], { trusted: false })[0], EnablementState.DisabledByTrustRequirement);\n\t});\n\n\ttest('test update extensions enablements on trust change triggers change events for extensions depending on workspace trust', async () => {\n\t\tinstalled.push(...[\n\t\t\taLocalExtension2('pub.a', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } }),\n\t\t\taLocalExtension2('pub.b', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } }),\n\t\t\taLocalExtension2('pub.c', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: false, description: 'hello' } } }),\n\t\t\taLocalExtension2('pub.d', { main: 'main.js', capabilities: { untrustedWorkspaces: { supported: true } } }),\n\t\t]);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\n\t\tawait testObject.updateExtensionsEnablementsWhenWorkspaceTrustChanges();\n\t\tassert.strictEqual(target.args[0][0].length, 2);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][1]).identifier, { id: 'pub.c' });\n\t});\n\n\ttest('test adding an extension that was disabled', async () => {\n\t\tconst extension = aLocalExtension('pub.a');\n\t\tinstalled.push(extension);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait testObject.setEnablement([extension], EnablementState.DisabledGlobally);\n\n\t\tconst target = sinon.spy();\n\t\tdisposableStore.add(testObject.onEnablementChanged(target));\n\t\tdidChangeProfileExtensionsEvent.fire({ added: [extension], removed: [] });\n\n\t\tassert.ok(!testObject.isEnabled(extension));\n\t\tassert.strictEqual(testObject.getEnablementState(extension), EnablementState.DisabledGlobally);\n\t\tassert.strictEqual(target.args[0][0].length, 1);\n\t\tassert.deepStrictEqual((<IExtension>target.args[0][0][0]).identifier, { id: 'pub.a' });\n\t});\n\n\ttest('test extension is disabled by allowed list', async () => {\n\t\tconst target = aLocalExtension2('unallowed.extension');\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByAllowlist);\n\t});\n\n\ttest('test extension is disabled by malicious', async () => {\n\t\tmalicious.push({ id: 'malicious.extensionA' });\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tawait (<TestExtensionEnablementService>testObject).waitUntilInitialized();\n\t\tconst target = aLocalExtension2('malicious.extensionA');\n\t\tassert.strictEqual(testObject.getEnablementState(target), EnablementState.DisabledByMalicious);\n\t});\n\n\ttest('test installed malicious extension triggers change event', async () => {\n\t\ttestObject.dispose();\n\t\tmalicious.push({ id: 'malicious.extensionB' });\n\t\tconst local = aLocalExtension2('malicious.extensionB');\n\t\tinstalled.push(local);\n\t\ttestObject = disposableStore.add(new TestExtensionEnablementService(instantiationService));\n\t\tassert.strictEqual(testObject.getEnablementState(local), EnablementState.EnabledGlobally);\n\t\tconst promise = Event.toPromise(testObject.onEnablementChanged);\n\n\t\tconst result = await promise;\n\t\tassert.deepStrictEqual(result[0], local);\n\t\tassert.strictEqual(testObject.getEnablementState(local), EnablementState.DisabledByMalicious);\n\t});\n\n});\n\nfunction anExtensionManagementServer(authority: string, instantiationService: TestInstantiationService): IExtensionManagementServer {\n\treturn {\n\t\tid: authority,\n\t\tlabel: authority,\n\t\textensionManagementService: instantiationService.get(IExtensionManagementService) as IProfileAwareExtensionManagementService,\n\t};\n}\n\nfunction aMultiExtensionManagementServerService(instantiationService: TestInstantiationService): IExtensionManagementServerService {\n\tconst localExtensionManagementServer = anExtensionManagementServer('vscode-local', instantiationService);\n\tconst remoteExtensionManagementServer = anExtensionManagementServer('vscode-remote', instantiationService);\n\treturn anExtensionManagementServerService(localExtensionManagementServer, remoteExtensionManagementServer, null);\n}\n\nexport function anExtensionManagementServerService(localExtensionManagementServer: IExtensionManagementServer | null, remoteExtensionManagementServer: IExtensionManagementServer | null, webExtensionManagementServer: IExtensionManagementServer | null): IExtensionManagementServerService {\n\treturn {\n\t\t_serviceBrand: undefined,\n\t\tlocalExtensionManagementServer,\n\t\tremoteExtensionManagementServer,\n\t\twebExtensionManagementServer,\n\t\tgetExtensionManagementServer: (extension: IExtension) => {\n\t\t\tif (extension.location.scheme === Schemas.file) {\n\t\t\t\treturn localExtensionManagementServer;\n\t\t\t}\n\t\t\tif (extension.location.scheme === Schemas.vscodeRemote) {\n\t\t\t\treturn remoteExtensionManagementServer;\n\t\t\t}\n\t\t\treturn webExtensionManagementServer;\n\t\t},\n\t\tgetExtensionInstallLocation(extension: IExtension): ExtensionInstallLocation | null {\n\t\t\tconst server = this.getExtensionManagementServer(extension);\n\t\t\treturn server === remoteExtensionManagementServer ? ExtensionInstallLocation.Remote\n\t\t\t\t: server === webExtensionManagementServer ? ExtensionInstallLocation.Web\n\t\t\t\t\t: ExtensionInstallLocation.Local;\n\t\t}\n\t};\n}\n\nfunction aLocalExtension(id: string, contributes?: IExtensionContributions, type?: ExtensionType): ILocalExtension {\n\treturn aLocalExtension2(id, contributes ? { contributes } : {}, isUndefinedOrNull(type) ? {} : { type });\n}\n\nfunction aLocalExtension2(id: string, manifest: Partial<IExtensionManifest> = {}, properties: IStringDictionary<unknown> = {}): ILocalExtension {\n\tconst [publisher, name] = id.split('.');\n\tmanifest = { name, publisher, ...manifest };\n\tproperties = {\n\t\tidentifier: { id },\n\t\tlocation: URI.file(`pub.${name}`),\n\t\tgalleryIdentifier: { id, uuid: undefined },\n\t\ttype: ExtensionType.User,\n\t\t...properties,\n\t\tisValid: properties.isValid ?? true,\n\t};\n\tproperties.isBuiltin = properties.type === ExtensionType.System;\n\treturn <ILocalExtension>Object.create({ manifest, ...properties });\n}\n"]}