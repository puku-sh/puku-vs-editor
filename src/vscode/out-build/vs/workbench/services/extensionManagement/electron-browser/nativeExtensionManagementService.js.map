{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/extensionManagement/electron-browser/nativeExtensionManagementService.ts","vs/workbench/services/extensionManagement/electron-browser/nativeExtensionManagementService.ts"],"names":[],"mappings":"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","file":"nativeExtensionManagementService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { DidChangeProfileEvent, IProfileAwareExtensionManagementService } from '../common/extensionManagement.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IAllowedExtensionsService, ILocalExtension, InstallOptions } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IUserDataProfileService } from '../../userDataProfile/common/userDataProfile.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IDownloadService } from '../../../../platform/download/common/download.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ProfileAwareExtensionManagementChannelClient } from '../common/extensionManagementChannelClient.js';\nimport { ExtensionIdentifier, ExtensionType, isResolverExtension } from '../../../../platform/extensions/common/extensions.js';\nimport { INativeWorkbenchEnvironmentService } from '../../environment/electron-browser/environmentService.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\n\nexport class NativeExtensionManagementService extends ProfileAwareExtensionManagementChannelClient implements IProfileAwareExtensionManagementService {\n\n\tconstructor(\n\t\tchannel: IChannel,\n\t\t@IProductService productService: IProductService,\n\t\t@IAllowedExtensionsService allowedExtensionsService: IAllowedExtensionsService,\n\t\t@IUserDataProfileService userDataProfileService: IUserDataProfileService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IDownloadService private readonly downloadService: IDownloadService,\n\t\t@INativeWorkbenchEnvironmentService private readonly nativeEnvironmentService: INativeWorkbenchEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper(channel, productService, allowedExtensionsService, userDataProfileService, uriIdentityService);\n\t}\n\n\tprotected filterEvent(profileLocation: URI, isApplicationScoped: boolean): boolean {\n\t\treturn isApplicationScoped || this.uriIdentityService.extUri.isEqual(this.userDataProfileService.currentProfile.extensionsResource, profileLocation);\n\t}\n\n\toverride async install(vsix: URI, options?: InstallOptions): Promise<ILocalExtension> {\n\t\tconst { location, cleanup } = await this.downloadVsix(vsix);\n\t\ttry {\n\t\t\treturn await super.install(location, options);\n\t\t} finally {\n\t\t\tawait cleanup();\n\t\t}\n\t}\n\n\tprivate async downloadVsix(vsix: URI): Promise<{ location: URI; cleanup: () => Promise<void> }> {\n\t\tif (vsix.scheme === Schemas.file) {\n\t\t\treturn { location: vsix, async cleanup() { } };\n\t\t}\n\t\tthis.logService.trace('Downloading extension from', vsix.toString());\n\t\tconst location = joinPath(this.nativeEnvironmentService.extensionsDownloadLocation, generateUuid());\n\t\tawait this.downloadService.download(vsix, location);\n\t\tthis.logService.info('Downloaded extension to', location.toString());\n\t\tconst cleanup = async () => {\n\t\t\ttry {\n\t\t\t\tawait this.fileService.del(location);\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t};\n\t\treturn { location, cleanup };\n\t}\n\n\tprotected override async switchExtensionsProfile(previousProfileLocation: URI, currentProfileLocation: URI, preserveExtensions?: ExtensionIdentifier[]): Promise<DidChangeProfileEvent> {\n\t\tif (this.nativeEnvironmentService.remoteAuthority) {\n\t\t\tconst previousInstalledExtensions = await this.getInstalled(ExtensionType.User, previousProfileLocation);\n\t\t\tconst resolverExtension = previousInstalledExtensions.find(e => isResolverExtension(e.manifest, this.nativeEnvironmentService.remoteAuthority));\n\t\t\tif (resolverExtension) {\n\t\t\t\tif (!preserveExtensions) {\n\t\t\t\t\tpreserveExtensions = [];\n\t\t\t\t}\n\t\t\t\tpreserveExtensions.push(new ExtensionIdentifier(resolverExtension.identifier.id));\n\t\t\t}\n\t\t}\n\t\treturn super.switchExtensionsProfile(previousProfileLocation, currentProfileLocation, preserveExtensions);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { DidChangeProfileEvent, IProfileAwareExtensionManagementService } from '../common/extensionManagement.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IAllowedExtensionsService, ILocalExtension, InstallOptions } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IUserDataProfileService } from '../../userDataProfile/common/userDataProfile.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IDownloadService } from '../../../../platform/download/common/download.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ProfileAwareExtensionManagementChannelClient } from '../common/extensionManagementChannelClient.js';\nimport { ExtensionIdentifier, ExtensionType, isResolverExtension } from '../../../../platform/extensions/common/extensions.js';\nimport { INativeWorkbenchEnvironmentService } from '../../environment/electron-browser/environmentService.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\n\nexport class NativeExtensionManagementService extends ProfileAwareExtensionManagementChannelClient implements IProfileAwareExtensionManagementService {\n\n\tconstructor(\n\t\tchannel: IChannel,\n\t\t@IProductService productService: IProductService,\n\t\t@IAllowedExtensionsService allowedExtensionsService: IAllowedExtensionsService,\n\t\t@IUserDataProfileService userDataProfileService: IUserDataProfileService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IDownloadService private readonly downloadService: IDownloadService,\n\t\t@INativeWorkbenchEnvironmentService private readonly nativeEnvironmentService: INativeWorkbenchEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper(channel, productService, allowedExtensionsService, userDataProfileService, uriIdentityService);\n\t}\n\n\tprotected filterEvent(profileLocation: URI, isApplicationScoped: boolean): boolean {\n\t\treturn isApplicationScoped || this.uriIdentityService.extUri.isEqual(this.userDataProfileService.currentProfile.extensionsResource, profileLocation);\n\t}\n\n\toverride async install(vsix: URI, options?: InstallOptions): Promise<ILocalExtension> {\n\t\tconst { location, cleanup } = await this.downloadVsix(vsix);\n\t\ttry {\n\t\t\treturn await super.install(location, options);\n\t\t} finally {\n\t\t\tawait cleanup();\n\t\t}\n\t}\n\n\tprivate async downloadVsix(vsix: URI): Promise<{ location: URI; cleanup: () => Promise<void> }> {\n\t\tif (vsix.scheme === Schemas.file) {\n\t\t\treturn { location: vsix, async cleanup() { } };\n\t\t}\n\t\tthis.logService.trace('Downloading extension from', vsix.toString());\n\t\tconst location = joinPath(this.nativeEnvironmentService.extensionsDownloadLocation, generateUuid());\n\t\tawait this.downloadService.download(vsix, location);\n\t\tthis.logService.info('Downloaded extension to', location.toString());\n\t\tconst cleanup = async () => {\n\t\t\ttry {\n\t\t\t\tawait this.fileService.del(location);\n\t\t\t} catch (error) {\n\t\t\t\tthis.logService.error(error);\n\t\t\t}\n\t\t};\n\t\treturn { location, cleanup };\n\t}\n\n\tprotected override async switchExtensionsProfile(previousProfileLocation: URI, currentProfileLocation: URI, preserveExtensions?: ExtensionIdentifier[]): Promise<DidChangeProfileEvent> {\n\t\tif (this.nativeEnvironmentService.remoteAuthority) {\n\t\t\tconst previousInstalledExtensions = await this.getInstalled(ExtensionType.User, previousProfileLocation);\n\t\t\tconst resolverExtension = previousInstalledExtensions.find(e => isResolverExtension(e.manifest, this.nativeEnvironmentService.remoteAuthority));\n\t\t\tif (resolverExtension) {\n\t\t\t\tif (!preserveExtensions) {\n\t\t\t\t\tpreserveExtensions = [];\n\t\t\t\t}\n\t\t\t\tpreserveExtensions.push(new ExtensionIdentifier(resolverExtension.identifier.id));\n\t\t\t}\n\t\t}\n\t\treturn super.switchExtensionsProfile(previousProfileLocation, currentProfileLocation, preserveExtensions);\n\t}\n}\n"]}