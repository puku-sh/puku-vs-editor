{"version":3,"sources":["vs/workbench/services/textfile/electron-browser/nativeTextFileService.ts"],"names":[],"mappings":"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","file":"nativeTextFileService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { AbstractTextFileService } from '../browser/textFileService.js';\nimport { ITextFileService, ITextFileStreamContent, ITextFileContent, IReadTextFileOptions, TextFileEditorModelState, ITextFileEditorModel } from '../common/textfiles.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IFileService, IFileReadLimits } from '../../../../platform/files/common/files.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { IUntitledTextEditorModelManager, IUntitledTextEditorService } from '../../untitled/common/untitledTextEditorService.js';\nimport { ILifecycleService } from '../../lifecycle/common/lifecycle.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IModelService } from '../../../../editor/common/services/model.js';\nimport { INativeWorkbenchEnvironmentService } from '../../environment/electron-browser/environmentService.js';\nimport { IDialogService, IFileDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { IFilesConfigurationService } from '../../filesConfiguration/common/filesConfigurationService.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { IPathService } from '../../path/common/pathService.js';\nimport { IWorkingCopyFileService } from '../../workingCopy/common/workingCopyFileService.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { ILanguageService } from '../../../../editor/common/languages/language.js';\nimport { IElevatedFileService } from '../../files/common/elevatedFileService.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Promises } from '../../../../base/common/async.js';\nimport { IDecorationsService } from '../../decorations/common/decorations.js';\n\nexport class NativeTextFileService extends AbstractTextFileService {\n\n\tprotected override readonly environmentService: INativeWorkbenchEnvironmentService;\n\n\tconstructor(\n\t\t@IFileService fileService: IFileService,\n\t\t@IUntitledTextEditorService untitledTextEditorService: IUntitledTextEditorModelManager,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IModelService modelService: IModelService,\n\t\t@INativeWorkbenchEnvironmentService environmentService: INativeWorkbenchEnvironmentService,\n\t\t@IDialogService dialogService: IDialogService,\n\t\t@IFileDialogService fileDialogService: IFileDialogService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@IPathService pathService: IPathService,\n\t\t@IWorkingCopyFileService workingCopyFileService: IWorkingCopyFileService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IElevatedFileService elevatedFileService: IElevatedFileService,\n\t\t@ILogService logService: ILogService,\n\t\t@IDecorationsService decorationsService: IDecorationsService\n\t) {\n\t\tsuper(fileService, untitledTextEditorService, lifecycleService, instantiationService, modelService, environmentService, dialogService, fileDialogService, textResourceConfigurationService, filesConfigurationService, codeEditorService, pathService, workingCopyFileService, uriIdentityService, languageService, logService, elevatedFileService, decorationsService);\n\n\t\tthis.environmentService = environmentService;\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Lifecycle\n\t\tthis._register(this.lifecycleService.onWillShutdown(event => event.join(this.onWillShutdown(), { id: 'join.textFiles', label: localize('join.textFiles', \"Saving text files\") })));\n\t}\n\n\tprivate async onWillShutdown(): Promise<void> {\n\t\tlet modelsPendingToSave: ITextFileEditorModel[];\n\n\t\t// As long as models are pending to be saved, we prolong the shutdown\n\t\t// until that has happened to ensure we are not shutting down in the\n\t\t// middle of writing to the file\n\t\t// (https://github.com/microsoft/vscode/issues/116600)\n\t\twhile ((modelsPendingToSave = this.files.models.filter(model => model.hasState(TextFileEditorModelState.PENDING_SAVE))).length > 0) {\n\t\t\tawait Promises.settled(modelsPendingToSave.map(model => model.joinState(TextFileEditorModelState.PENDING_SAVE)));\n\t\t}\n\t}\n\n\toverride async read(resource: URI, options?: IReadTextFileOptions): Promise<ITextFileContent> {\n\n\t\t// ensure platform limits are applied\n\t\toptions = this.ensureLimits(options);\n\n\t\treturn super.read(resource, options);\n\t}\n\n\toverride async readStream(resource: URI, options?: IReadTextFileOptions): Promise<ITextFileStreamContent> {\n\n\t\t// ensure platform limits are applied\n\t\toptions = this.ensureLimits(options);\n\n\t\treturn super.readStream(resource, options);\n\t}\n\n\tprivate ensureLimits(options?: IReadTextFileOptions): IReadTextFileOptions {\n\t\tlet ensuredOptions: IReadTextFileOptions;\n\t\tif (!options) {\n\t\t\tensuredOptions = Object.create(null);\n\t\t} else {\n\t\t\tensuredOptions = options;\n\t\t}\n\n\t\tlet ensuredLimits: IFileReadLimits;\n\t\tif (!ensuredOptions.limits) {\n\t\t\tensuredLimits = Object.create(null);\n\t\t\tensuredOptions = {\n\t\t\t\t...ensuredOptions,\n\t\t\t\tlimits: ensuredLimits\n\t\t\t};\n\t\t} else {\n\t\t\tensuredLimits = ensuredOptions.limits;\n\t\t}\n\n\t\treturn ensuredOptions;\n\t}\n}\n\nregisterSingleton(ITextFileService, NativeTextFileService, InstantiationType.Eager);\n"]}