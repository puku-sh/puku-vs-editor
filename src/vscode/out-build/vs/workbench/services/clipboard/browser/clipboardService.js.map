{"version":3,"sources":["vs/workbench/services/clipboard/browser/clipboardService.ts"],"names":[],"mappings":"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","file":"clipboardService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { BrowserClipboardService as BaseBrowserClipboardService } from '../../../../platform/clipboard/browser/clipboardService.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { getActiveWindow } from '../../../../base/browser/dom.js';\n\nexport class BrowserClipboardService extends BaseBrowserClipboardService {\n\n\tconstructor(\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@ILogService logService: ILogService,\n\t\t@ILayoutService layoutService: ILayoutService\n\t) {\n\t\tsuper(layoutService, logService);\n\t}\n\n\toverride async writeText(text: string, type?: string): Promise<void> {\n\t\tthis.logService.trace('BrowserClipboardService#writeText called with type:', type, ' with text.length:', text.length);\n\t\tif (!!this.environmentService.extensionTestsLocationURI && typeof type !== 'string') {\n\t\t\ttype = 'vscode-tests'; // force in-memory clipboard for tests to avoid permission issues\n\t\t}\n\t\tthis.logService.trace('BrowserClipboardService#super.writeText');\n\t\treturn super.writeText(text, type);\n\t}\n\n\toverride async readText(type?: string): Promise<string> {\n\t\tthis.logService.trace('BrowserClipboardService#readText called with type:', type);\n\t\tif (!!this.environmentService.extensionTestsLocationURI && typeof type !== 'string') {\n\t\t\ttype = 'vscode-tests'; // force in-memory clipboard for tests to avoid permission issues\n\t\t}\n\n\t\tif (type) {\n\t\t\tthis.logService.trace('BrowserClipboardService#super.readText');\n\t\t\treturn super.readText(type);\n\t\t}\n\n\t\ttry {\n\t\t\tconst readText = await getActiveWindow().navigator.clipboard.readText();\n\t\t\tthis.logService.trace('BrowserClipboardService#readText with readText.length:', readText.length);\n\t\t\treturn readText;\n\t\t} catch (error) {\n\t\t\treturn new Promise<string>(resolve => {\n\n\t\t\t\t// Inform user about permissions problem (https://github.com/microsoft/vscode/issues/112089)\n\t\t\t\tconst listener = new DisposableStore();\n\t\t\t\tconst handle = this.notificationService.prompt(\n\t\t\t\t\tSeverity.Error,\n\t\t\t\t\tlocalize('clipboardError', \"Unable to read from the browser's clipboard. Please make sure you have granted access for this website to read from the clipboard.\"),\n\t\t\t\t\t[{\n\t\t\t\t\t\tlabel: localize('retry', \"Retry\"),\n\t\t\t\t\t\trun: async () => {\n\t\t\t\t\t\t\tlistener.dispose();\n\t\t\t\t\t\t\tresolve(await this.readText(type));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: localize('learnMore', \"Learn More\"),\n\t\t\t\t\t\trun: () => this.openerService.open('https://go.microsoft.com/fwlink/?linkid=2151362')\n\t\t\t\t\t}],\n\t\t\t\t\t{\n\t\t\t\t\t\tsticky: true\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Always resolve the promise once the notification closes\n\t\t\t\tlistener.add(Event.once(handle.onDidClose)(() => resolve('')));\n\t\t\t});\n\t\t}\n\t}\n}\n\nregisterSingleton(IClipboardService, BrowserClipboardService, InstantiationType.Delayed);\n"]}