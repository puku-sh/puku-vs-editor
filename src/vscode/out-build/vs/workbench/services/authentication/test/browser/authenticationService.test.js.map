{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/authentication/test/browser/authenticationService.test.ts","vs/workbench/services/authentication/test/browser/authenticationService.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,MAAM,MAAM,QAAQ,CAAC;AAC5B,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,qCAAqC,CAAC;AACrE,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AACnG,OAAO,EAAE,GAAG,EAAE,MAAM,mCAAmC,CAAC;AACxD,OAAO,EAAE,2BAA2B,EAAE,MAAM,8CAA8C,CAAC;AAC3F,OAAO,EAAE,qBAAqB,EAAE,MAAM,wCAAwC,CAAC;AAE/E,OAAO,EAAE,sBAAsB,EAAE,MAAM,mDAAmD,CAAC;AAC3F,OAAO,EAAE,oBAAoB,EAAE,kBAAkB,EAAE,kBAAkB,EAAE,MAAM,kDAAkD,CAAC;AAChI,OAAO,EAAE,cAAc,EAAE,MAAM,2CAA2C,CAAC;AAE3E,SAAS,aAAa;IACrB,OAAO,EAAE,EAAE,EAAE,UAAU,EAAE,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC;AAClH,CAAC;AAED,SAAS,cAAc,CAAC,YAA8C,EAAE;IACvE,OAAO;QACN,wBAAwB,EAAE,KAAK;QAC/B,mBAAmB,EAAE,IAAI,OAAO,EAAqC,CAAC,KAAK;QAC3E,EAAE,EAAE,MAAM;QACV,KAAK,EAAE,MAAM;QACb,WAAW,EAAE,KAAK,IAAI,EAAE,CAAC,EAAE;QAC3B,aAAa,EAAE,KAAK,IAAI,EAAE,CAAC,aAAa,EAAE;QAC1C,aAAa,EAAE,KAAK,IAAI,EAAE,GAAG,CAAC;QAC9B,GAAG,SAAS;KACZ,CAAC;AACH,CAAC;AAED,KAAK,CAAC,uBAAuB,EAAE,GAAG,EAAE;IACnC,MAAM,WAAW,GAAG,uCAAuC,EAAE,CAAC;IAE9D,IAAI,qBAA4C,CAAC;IAEjD,KAAK,CAAC,GAAG,EAAE;QACV,MAAM,cAAc,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,kBAAkB,EAAE,CAAC,CAAC;QACjE,MAAM,2BAA2B,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,2BAA2B,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAC,CAAC;QACzH,qBAAqB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,qBAAqB,CAAC,IAAI,oBAAoB,EAAE,EAAE,2BAA2B,EAAE,sBAAsB,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC,CAAC;IAC3K,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,GAAG,EAAE;QACb,qDAAqD;QACrD,qBAAqB,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,iCAAiC,EAAE,GAAG,EAAE;QAC7C,IAAI,CAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;YACzD,MAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,4BAA4B,CAAC,CAAC;YACpF,MAAM,QAAQ,GAAsC;gBACnD,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;aACf,CAAC;YACF,qBAAqB,CAAC,sCAAsC,CAAC,QAAQ,CAAC,CAAC;YAEvE,uFAAuF;YACvF,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAChE,MAAM,CAAC,SAAS,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;YACvE,MAAM,OAAO,CAAC;QACf,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YAC3D,MAAM,QAAQ,GAAsC;gBACnD,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;aACf,CAAC;YACF,qBAAqB,CAAC,sCAAsC,CAAC,QAAQ,CAAC,CAAC;YACvE,MAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,4BAA4B,CAAC,CAAC;YACpF,qBAAqB,CAAC,wCAAwC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAE5E,2FAA2F;YAC3F,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAChE,MAAM,OAAO,CAAC;QACf,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,yBAAyB,EAAE,GAAG,EAAE;QACrC,IAAI,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YACrD,MAAM,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,mCAAmC,CAAC,CAAC;YAC9F,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,kCAAkC,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;YAC3F,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,kCAAkC,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;YAC1F,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC;YAChC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;QACtE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YACnD,MAAM,YAAY,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,qCAAqC,CAAC,CAAC;YAClG,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAClC,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,kCAAkC,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;YAC1F,qBAAqB,CAAC,gCAAgC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YACpE,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,kCAAkC,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;YAC3F,MAAM,MAAM,GAAG,MAAM,YAAY,CAAC;YAClC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,KAAK,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;QACtE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE;YAC3B,MAAM,SAAS,GAAG,cAAc,CAAC;gBAChC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,YAAY;aACnB,CAAC,CAAC;YACH,MAAM,SAAS,GAAG,cAAc,CAAC;gBAChC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,YAAY;aACnB,CAAC,CAAC;YAEH,qBAAqB,CAAC,8BAA8B,CAAC,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;YAC9E,qBAAqB,CAAC,8BAA8B,CAAC,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;YAE9E,MAAM,WAAW,GAAG,qBAAqB,CAAC,cAAc,EAAE,CAAC;YAE3D,yEAAyE;YACzE,MAAM,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE;YACxB,MAAM,QAAQ,GAAG,cAAc,EAAE,CAAC;YAElC,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAE5E,MAAM,iBAAiB,GAAG,qBAAqB,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAEzE,4EAA4E;YAC5E,MAAM,CAAC,SAAS,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,8GAA8G,EAAE,KAAK,IAAI,EAAE;YAC/H,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;YAC7D,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,CAAC,CAAC;YACjG,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,iIAAiI,EAAE,KAAK,IAAI,EAAE;YAClJ,iEAAiE;YACjE,MAAM,QAAQ,GAAsC;gBACnD,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,wBAAwB,EAAE,CAAC,sBAAsB,CAAC;aAClD,CAAC;YACF,qBAAqB,CAAC,sCAAsC,CAAC,QAAQ,CAAC,CAAC;YAEvE,0EAA0E;YAC1E,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,oBAAoB,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC;aAC7D,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;YAE7E,2BAA2B;YAC3B,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC;YAClE,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,CAAC,CAAC;YAEjG,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oIAAoI,EAAE,KAAK,IAAI,EAAE;YACrJ,iEAAiE;YACjE,MAAM,QAAQ,GAAsC;gBACnD,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,wBAAwB,EAAE,CAAC,sBAAsB,CAAC;aAClD,CAAC;YACF,qBAAqB,CAAC,sCAAsC,CAAC,QAAQ,CAAC,CAAC;YAEvE,8EAA8E;YAC9E,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,oBAAoB,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC;aACjE,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;YAE7E,+BAA+B;YAC/B,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC;YAClE,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,CAAC,CAAC;YAEjG,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,4GAA4G,EAAE,KAAK,IAAI,EAAE;YAC7H,kEAAkE;YAClE,MAAM,SAAS,GAAsC;gBACpD,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,wBAAwB,EAAE,CAAC,sBAAsB,CAAC;aAClD,CAAC;YACF,MAAM,SAAS,GAAsC;gBACpD,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,wBAAwB,EAAE,CAAC,qCAAqC,CAAC;aACjE,CAAC;YACF,qBAAqB,CAAC,sCAAsC,CAAC,SAAS,CAAC,CAAC;YACxE,qBAAqB,CAAC,sCAAsC,CAAC,SAAS,CAAC,CAAC;YAExE,oCAAoC;YACpC,MAAM,cAAc,GAAG,cAAc,CAAC;gBACrC,EAAE,EAAE,QAAQ;gBACZ,KAAK,EAAE,QAAQ;gBACf,oBAAoB,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC;aACjE,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;YAE/E,MAAM,iBAAiB,GAAG,cAAc,CAAC;gBACxC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,oBAAoB,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;aAC7E,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;YAErF,wDAAwD;YACxD,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,CAAC,CAAC;YAEjG,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,qGAAqG,EAAE,KAAK,IAAI,EAAE;YACtH,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,cAAc,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;YAEhE,4DAA4D;YAC5D,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;gBAC3C,cAAc,EAAE,cAAc;aAC9B,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;YAEhF,8DAA8D;YAC9D,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,cAAc,CAAC,CAAC;YAEjH,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gHAAgH,EAAE,KAAK,IAAI,EAAE;YACjI,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,cAAc,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;YAChE,MAAM,uBAAuB,GAAG,GAAG,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;YAErE,4DAA4D;YAC5D,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;gBAC3C,cAAc,EAAE,cAAc;aAC9B,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;YAEhF,wEAAwE;YACxE,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,uBAAuB,CAAC,CAAC;YAE1H,4EAA4E;YAC5E,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oHAAoH,EAAE,KAAK,IAAI,EAAE;YACrI,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,cAAc,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;YAEhE,+DAA+D;YAC/D,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;aAC3C,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;YAEhF,gEAAgE;YAChE,8DAA8D;YAC9D,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,cAAc,CAAC,CAAC;YAEjH,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oHAAoH,EAAE,KAAK,IAAI,EAAE;YACrI,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,cAAc,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;YAEhE,4DAA4D;YAC5D,MAAM,YAAY,GAAG,cAAc,CAAC;gBACnC,EAAE,EAAE,WAAW;gBACf,KAAK,EAAE,WAAW;gBAClB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;gBAC3C,cAAc,EAAE,cAAc;aAC9B,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;YAEhF,0EAA0E;YAC1E,sEAAsE;YACtE,MAAM,MAAM,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,CAAC,CAAC;YAEjG,oBAAoB;YACpB,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,uIAAuI,EAAE,KAAK,IAAI,EAAE;YACxJ,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;YAClF,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;YACrE,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;YAEjE,qDAAqD;YACrD,MAAM,aAAa,GAAG,cAAc,CAAC;gBACpC,EAAE,EAAE,iBAAiB;gBACrB,KAAK,EAAE,iBAAiB;gBACxB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;gBAC3C,cAAc,EAAE,mBAAmB;aACnC,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,iBAAiB,EAAE,aAAa,CAAC,CAAC;YAEvF,sDAAsD;YACtD,MAAM,aAAa,GAAG,cAAc,CAAC;gBACpC,EAAE,EAAE,iBAAiB;gBACrB,KAAK,EAAE,iBAAiB;gBACxB,oBAAoB,EAAE,CAAC,mBAAmB,CAAC;gBAC3C,cAAc,EAAE,mBAAmB;aACnC,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,iBAAiB,EAAE,aAAa,CAAC,CAAC;YAEvF,oEAAoE;YACpE,MAAM,WAAW,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,mBAAmB,CAAC,CAAC;YAC3H,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;YAEnD,qEAAqE;YACrE,MAAM,WAAW,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,mBAAmB,CAAC,CAAC;YAC3H,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;YAEnD,gEAAgE;YAChE,MAAM,mBAAmB,GAAG,GAAG,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;YACnE,MAAM,aAAa,GAAG,MAAM,qBAAqB,CAAC,gCAAgC,CAAC,mBAAmB,EAAE,mBAAmB,CAAC,CAAC;YAC7H,MAAM,CAAC,WAAW,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,wBAAwB,EAAE,GAAG,EAAE;QACpC,IAAI,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;YAC1C,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,MAAM,QAAQ,GAAG,cAAc,CAAC;gBAC/B,WAAW,EAAE,KAAK,IAAI,EAAE;oBACvB,QAAQ,GAAG,IAAI,CAAC;oBAChB,OAAO,CAAC,aAAa,EAAE,CAAC,CAAC;gBAC1B,CAAC;aACD,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,QAAQ,GAAG,MAAM,qBAAqB,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAEtE,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YACjC,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;YACvE,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,MAAM,QAAQ,GAAG,cAAc,CAAC;gBAC/B,WAAW,EAAE,KAAK,IAAI,EAAE;oBACvB,QAAQ,GAAG,IAAI,CAAC;oBAChB,OAAO,CAAC,aAAa,EAAE,CAAC,CAAC;gBAC1B,CAAC;aACD,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,qBAAqB,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,mBAAmB,EAAE,GAAG,CAAC,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC,CAAC;YACpI,MAAM,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;QACtB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,EAAE,KAAK,IAAI,EAAE;YAChC,MAAM,OAAO,GAAG,IAAI,OAAO,EAAqC,CAAC;YACjE,MAAM,QAAQ,GAAG,cAAc,CAAC;gBAC/B,mBAAmB,EAAE,OAAO,CAAC,KAAK;gBAClC,aAAa,EAAE,KAAK,IAAI,EAAE;oBACzB,MAAM,OAAO,GAAG,aAAa,EAAE,CAAC;oBAChC,OAAO,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC;oBAC7D,OAAO,OAAO,CAAC;gBAChB,CAAC;aACD,CAAC,CAAC;YACH,MAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;YAC3E,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,OAAO,GAAG,MAAM,qBAAqB,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;YAEjF,mFAAmF;YACnF,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;YACnB,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC;YAC7B,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBACxB,UAAU,EAAE,QAAQ,CAAC,EAAE;gBACvB,KAAK,EAAE,QAAQ,CAAC,KAAK;gBACrB,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE;aACrD,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,EAAE,KAAK,IAAI,EAAE;YAChC,MAAM,OAAO,GAAG,IAAI,OAAO,EAAqC,CAAC;YACjE,MAAM,OAAO,GAAG,aAAa,EAAE,CAAC;YAChC,MAAM,QAAQ,GAAG,cAAc,CAAC;gBAC/B,mBAAmB,EAAE,OAAO,CAAC,KAAK;gBAClC,aAAa,EAAE,KAAK,IAAI,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC;aACvF,CAAC,CAAC;YACH,MAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;YAC3E,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAC5E,MAAM,qBAAqB,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;YAEnE,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC;YAC7B,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBACxB,UAAU,EAAE,QAAQ,CAAC,EAAE;gBACvB,KAAK,EAAE,QAAQ,CAAC,KAAK;gBACrB,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE;aACrD,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,qBAAqB,EAAE,KAAK,IAAI,EAAE;YACtC,MAAM,OAAO,GAAG,IAAI,OAAO,EAAqC,CAAC;YACjE,MAAM,QAAQ,GAAG,cAAc,CAAC;gBAC/B,mBAAmB,EAAE,OAAO,CAAC,KAAK;gBAClC,WAAW,EAAE,KAAK,IAAI,EAAE,CAAC,EAAE;aAC3B,CAAC,CAAC;YACH,qBAAqB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;YAE5E,MAAM,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;YAC3E,MAAM,OAAO,GAAG,aAAa,EAAE,CAAC;YAChC,OAAO,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAE7D,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC;YAC7B,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBACxB,UAAU,EAAE,QAAQ,CAAC,EAAE;gBACvB,KAAK,EAAE,QAAQ,CAAC,KAAK;gBACrB,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,EAAE;aACrD,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"authenticationService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { AuthenticationAccessService } from '../../browser/authenticationAccessService.js';\nimport { AuthenticationService } from '../../browser/authenticationService.js';\nimport { AuthenticationProviderInformation, AuthenticationSessionsChangeEvent, IAuthenticationProvider } from '../../common/authentication.js';\nimport { TestEnvironmentService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestExtensionService, TestProductService, TestStorageService } from '../../../../test/common/workbenchTestServices.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\n\nfunction createSession() {\n\treturn { id: 'session1', accessToken: 'token1', account: { id: 'account', label: 'Account' }, scopes: ['test'] };\n}\n\nfunction createProvider(overrides: Partial<IAuthenticationProvider> = {}): IAuthenticationProvider {\n\treturn {\n\t\tsupportsMultipleAccounts: false,\n\t\tonDidChangeSessions: new Emitter<AuthenticationSessionsChangeEvent>().event,\n\t\tid: 'test',\n\t\tlabel: 'Test',\n\t\tgetSessions: async () => [],\n\t\tcreateSession: async () => createSession(),\n\t\tremoveSession: async () => { },\n\t\t...overrides\n\t};\n}\n\nsuite('AuthenticationService', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet authenticationService: AuthenticationService;\n\n\tsetup(() => {\n\t\tconst storageService = disposables.add(new TestStorageService());\n\t\tconst authenticationAccessService = disposables.add(new AuthenticationAccessService(storageService, TestProductService));\n\t\tauthenticationService = disposables.add(new AuthenticationService(new TestExtensionService(), authenticationAccessService, TestEnvironmentService, new NullLogService()));\n\t});\n\n\tteardown(() => {\n\t\t// Dispose the authentication service after each test\n\t\tauthenticationService.dispose();\n\t});\n\n\tsuite('declaredAuthenticationProviders', () => {\n\t\ttest('registerDeclaredAuthenticationProvider', async () => {\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeDeclaredProviders);\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub'\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Assert that the provider is added to the declaredProviders array and the event fires\n\t\t\tassert.equal(authenticationService.declaredProviders.length, 1);\n\t\t\tassert.deepEqual(authenticationService.declaredProviders[0], provider);\n\t\t\tawait changed;\n\t\t});\n\n\t\ttest('unregisterDeclaredAuthenticationProvider', async () => {\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub'\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeDeclaredProviders);\n\t\t\tauthenticationService.unregisterDeclaredAuthenticationProvider(provider.id);\n\n\t\t\t// Assert that the provider is removed from the declaredProviders array and the event fires\n\t\t\tassert.equal(authenticationService.declaredProviders.length, 0);\n\t\t\tawait changed;\n\t\t});\n\t});\n\n\tsuite('authenticationProviders', () => {\n\t\ttest('isAuthenticationProviderRegistered', async () => {\n\t\t\tconst registered = Event.toPromise(authenticationService.onDidRegisterAuthenticationProvider);\n\t\t\tconst provider = createProvider();\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), false);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), true);\n\t\t\tconst result = await registered;\n\t\t\tassert.deepEqual(result, { id: provider.id, label: provider.label });\n\t\t});\n\n\t\ttest('unregisterAuthenticationProvider', async () => {\n\t\t\tconst unregistered = Event.toPromise(authenticationService.onDidUnregisterAuthenticationProvider);\n\t\t\tconst provider = createProvider();\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), true);\n\t\t\tauthenticationService.unregisterAuthenticationProvider(provider.id);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), false);\n\t\t\tconst result = await unregistered;\n\t\t\tassert.deepEqual(result, { id: provider.id, label: provider.label });\n\t\t});\n\n\t\ttest('getProviderIds', () => {\n\t\t\tconst provider1 = createProvider({\n\t\t\t\tid: 'provider1',\n\t\t\t\tlabel: 'Provider 1'\n\t\t\t});\n\t\t\tconst provider2 = createProvider({\n\t\t\t\tid: 'provider2',\n\t\t\t\tlabel: 'Provider 2'\n\t\t\t});\n\n\t\t\tauthenticationService.registerAuthenticationProvider(provider1.id, provider1);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider2.id, provider2);\n\n\t\t\tconst providerIds = authenticationService.getProviderIds();\n\n\t\t\t// Assert that the providerIds array contains the registered provider ids\n\t\t\tassert.deepEqual(providerIds, [provider1.id, provider2.id]);\n\t\t});\n\n\t\ttest('getProvider', () => {\n\t\t\tconst provider = createProvider();\n\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\n\t\t\tconst retrievedProvider = authenticationService.getProvider(provider.id);\n\n\t\t\t// Assert that the retrieved provider is the same as the registered provider\n\t\t\tassert.deepEqual(retrievedProvider, provider);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return undefined when no provider matches the authorization server', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://example.com');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return provider id if authorizationServerGlobs matches and authorizationServers match', async () => {\n\t\t\t// Register a declared provider with an authorization server glob\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Register an authentication provider with matching authorization servers\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/login')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', authProvider);\n\n\t\t\t// Test with a matching URI\n\t\t\tconst authorizationServer = URI.parse('https://github.com/login');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'github');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return undefined if authorizationServerGlobs match but authorizationServers do not match', async () => {\n\t\t\t// Register a declared provider with an authorization server glob\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Register an authentication provider with non-matching authorization servers\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/different')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', authProvider);\n\n\t\t\t// Test with a non-matching URI\n\t\t\tconst authorizationServer = URI.parse('https://github.com/login');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForAuthorizationServer - should check multiple providers and return the first match', async () => {\n\t\t\t// Register two declared providers with authorization server globs\n\t\t\tconst provider1: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tconst provider2: AuthenticationProviderInformation = {\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServerGlobs: ['https://login.microsoftonline.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider1);\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider2);\n\n\t\t\t// Register authentication providers\n\t\t\tconst githubProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/different')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', githubProvider);\n\n\t\t\tconst microsoftProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [URI.parse('https://login.microsoftonline.com/common')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', microsoftProvider);\n\n\t\t\t// Test with a URI that should match the second provider\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when resourceServer matches provider resourceServer', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server and resource server\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, resourceServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should not match when resourceServer does not match provider resourceServer', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\t\t\tconst differentResourceServer = URI.parse('https://vault.azure.net');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server but different resource server\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, differentResourceServer);\n\n\t\t\t// Verify the result - should not match because resource servers don't match\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when provider has no resourceServer and resourceServer is provided', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider without a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server and a resource server\n\t\t\t// Should match because provider has no resourceServer defined\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, resourceServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when provider has resourceServer but no resourceServer is provided', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server but no resource server provided\n\t\t\t// Should match because no resourceServer is provided to check against\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should distinguish between providers with same authorization server but different resource servers', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst graphResourceServer = URI.parse('https://graph.microsoft.com');\n\t\t\tconst vaultResourceServer = URI.parse('https://vault.azure.net');\n\n\t\t\t// Register first provider with Graph resource server\n\t\t\tconst graphProvider = createProvider({\n\t\t\t\tid: 'microsoft-graph',\n\t\t\t\tlabel: 'Microsoft Graph',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: graphResourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft-graph', graphProvider);\n\n\t\t\t// Register second provider with Vault resource server\n\t\t\tconst vaultProvider = createProvider({\n\t\t\t\tid: 'microsoft-vault',\n\t\t\t\tlabel: 'Microsoft Vault',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: vaultResourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft-vault', vaultProvider);\n\n\t\t\t// Test with Graph resource server - should match the first provider\n\t\t\tconst graphResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, graphResourceServer);\n\t\t\tassert.strictEqual(graphResult, 'microsoft-graph');\n\n\t\t\t// Test with Vault resource server - should match the second provider\n\t\t\tconst vaultResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, vaultResourceServer);\n\t\t\tassert.strictEqual(vaultResult, 'microsoft-vault');\n\n\t\t\t// Test with different resource server - should not match either\n\t\t\tconst otherResourceServer = URI.parse('https://storage.azure.com');\n\t\t\tconst noMatchResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, otherResourceServer);\n\t\t\tassert.strictEqual(noMatchResult, undefined);\n\t\t});\n\t});\n\n\tsuite('authenticationSessions', () => {\n\t\ttest('getSessions - base case', async () => {\n\t\t\tlet isCalled = false;\n\t\t\tconst provider = createProvider({\n\t\t\t\tgetSessions: async () => {\n\t\t\t\t\tisCalled = true;\n\t\t\t\t\treturn [createSession()];\n\t\t\t\t},\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tconst sessions = await authenticationService.getSessions(provider.id);\n\n\t\t\tassert.equal(sessions.length, 1);\n\t\t\tassert.ok(isCalled);\n\t\t});\n\n\t\ttest('getSessions - authorization server is not registered', async () => {\n\t\t\tlet isCalled = false;\n\t\t\tconst provider = createProvider({\n\t\t\t\tgetSessions: async () => {\n\t\t\t\t\tisCalled = true;\n\t\t\t\t\treturn [createSession()];\n\t\t\t\t},\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.rejects(() => authenticationService.getSessions(provider.id, [], { authorizationServer: URI.parse('https://example.com') }));\n\t\t\tassert.ok(!isCalled);\n\t\t});\n\n\t\ttest('createSession', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tcreateSession: async () => {\n\t\t\t\t\tconst session = createSession();\n\t\t\t\t\temitter.fire({ added: [session], removed: [], changed: [] });\n\t\t\t\t\treturn session;\n\t\t\t\t},\n\t\t\t});\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tconst session = await authenticationService.createSession(provider.id, ['repo']);\n\n\t\t\t// Assert that the created session matches the expected session and the event fires\n\t\t\tassert.ok(session);\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [session], removed: [], changed: [] }\n\t\t\t});\n\t\t});\n\n\t\ttest('removeSession', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst session = createSession();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tremoveSession: async () => emitter.fire({ added: [], removed: [session], changed: [] })\n\t\t\t});\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tawait authenticationService.removeSession(provider.id, session.id);\n\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [], removed: [session], changed: [] }\n\t\t\t});\n\t\t});\n\n\t\ttest('onDidChangeSessions', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tgetSessions: async () => []\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tconst session = createSession();\n\t\t\temitter.fire({ added: [], removed: [], changed: [session] });\n\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [], removed: [], changed: [session] }\n\t\t\t});\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { AuthenticationAccessService } from '../../browser/authenticationAccessService.js';\nimport { AuthenticationService } from '../../browser/authenticationService.js';\nimport { AuthenticationProviderInformation, AuthenticationSessionsChangeEvent, IAuthenticationProvider } from '../../common/authentication.js';\nimport { TestEnvironmentService } from '../../../../test/browser/workbenchTestServices.js';\nimport { TestExtensionService, TestProductService, TestStorageService } from '../../../../test/common/workbenchTestServices.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\n\nfunction createSession() {\n\treturn { id: 'session1', accessToken: 'token1', account: { id: 'account', label: 'Account' }, scopes: ['test'] };\n}\n\nfunction createProvider(overrides: Partial<IAuthenticationProvider> = {}): IAuthenticationProvider {\n\treturn {\n\t\tsupportsMultipleAccounts: false,\n\t\tonDidChangeSessions: new Emitter<AuthenticationSessionsChangeEvent>().event,\n\t\tid: 'test',\n\t\tlabel: 'Test',\n\t\tgetSessions: async () => [],\n\t\tcreateSession: async () => createSession(),\n\t\tremoveSession: async () => { },\n\t\t...overrides\n\t};\n}\n\nsuite('AuthenticationService', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet authenticationService: AuthenticationService;\n\n\tsetup(() => {\n\t\tconst storageService = disposables.add(new TestStorageService());\n\t\tconst authenticationAccessService = disposables.add(new AuthenticationAccessService(storageService, TestProductService));\n\t\tauthenticationService = disposables.add(new AuthenticationService(new TestExtensionService(), authenticationAccessService, TestEnvironmentService, new NullLogService()));\n\t});\n\n\tteardown(() => {\n\t\t// Dispose the authentication service after each test\n\t\tauthenticationService.dispose();\n\t});\n\n\tsuite('declaredAuthenticationProviders', () => {\n\t\ttest('registerDeclaredAuthenticationProvider', async () => {\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeDeclaredProviders);\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub'\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Assert that the provider is added to the declaredProviders array and the event fires\n\t\t\tassert.equal(authenticationService.declaredProviders.length, 1);\n\t\t\tassert.deepEqual(authenticationService.declaredProviders[0], provider);\n\t\t\tawait changed;\n\t\t});\n\n\t\ttest('unregisterDeclaredAuthenticationProvider', async () => {\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub'\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeDeclaredProviders);\n\t\t\tauthenticationService.unregisterDeclaredAuthenticationProvider(provider.id);\n\n\t\t\t// Assert that the provider is removed from the declaredProviders array and the event fires\n\t\t\tassert.equal(authenticationService.declaredProviders.length, 0);\n\t\t\tawait changed;\n\t\t});\n\t});\n\n\tsuite('authenticationProviders', () => {\n\t\ttest('isAuthenticationProviderRegistered', async () => {\n\t\t\tconst registered = Event.toPromise(authenticationService.onDidRegisterAuthenticationProvider);\n\t\t\tconst provider = createProvider();\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), false);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), true);\n\t\t\tconst result = await registered;\n\t\t\tassert.deepEqual(result, { id: provider.id, label: provider.label });\n\t\t});\n\n\t\ttest('unregisterAuthenticationProvider', async () => {\n\t\t\tconst unregistered = Event.toPromise(authenticationService.onDidUnregisterAuthenticationProvider);\n\t\t\tconst provider = createProvider();\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), true);\n\t\t\tauthenticationService.unregisterAuthenticationProvider(provider.id);\n\t\t\tassert.equal(authenticationService.isAuthenticationProviderRegistered(provider.id), false);\n\t\t\tconst result = await unregistered;\n\t\t\tassert.deepEqual(result, { id: provider.id, label: provider.label });\n\t\t});\n\n\t\ttest('getProviderIds', () => {\n\t\t\tconst provider1 = createProvider({\n\t\t\t\tid: 'provider1',\n\t\t\t\tlabel: 'Provider 1'\n\t\t\t});\n\t\t\tconst provider2 = createProvider({\n\t\t\t\tid: 'provider2',\n\t\t\t\tlabel: 'Provider 2'\n\t\t\t});\n\n\t\t\tauthenticationService.registerAuthenticationProvider(provider1.id, provider1);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider2.id, provider2);\n\n\t\t\tconst providerIds = authenticationService.getProviderIds();\n\n\t\t\t// Assert that the providerIds array contains the registered provider ids\n\t\t\tassert.deepEqual(providerIds, [provider1.id, provider2.id]);\n\t\t});\n\n\t\ttest('getProvider', () => {\n\t\t\tconst provider = createProvider();\n\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\n\t\t\tconst retrievedProvider = authenticationService.getProvider(provider.id);\n\n\t\t\t// Assert that the retrieved provider is the same as the registered provider\n\t\t\tassert.deepEqual(retrievedProvider, provider);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return undefined when no provider matches the authorization server', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://example.com');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return provider id if authorizationServerGlobs matches and authorizationServers match', async () => {\n\t\t\t// Register a declared provider with an authorization server glob\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Register an authentication provider with matching authorization servers\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/login')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', authProvider);\n\n\t\t\t// Test with a matching URI\n\t\t\tconst authorizationServer = URI.parse('https://github.com/login');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'github');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should return undefined if authorizationServerGlobs match but authorizationServers do not match', async () => {\n\t\t\t// Register a declared provider with an authorization server glob\n\t\t\tconst provider: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider);\n\n\t\t\t// Register an authentication provider with non-matching authorization servers\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/different')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', authProvider);\n\n\t\t\t// Test with a non-matching URI\n\t\t\tconst authorizationServer = URI.parse('https://github.com/login');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForAuthorizationServer - should check multiple providers and return the first match', async () => {\n\t\t\t// Register two declared providers with authorization server globs\n\t\t\tconst provider1: AuthenticationProviderInformation = {\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServerGlobs: ['https://github.com/*']\n\t\t\t};\n\t\t\tconst provider2: AuthenticationProviderInformation = {\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServerGlobs: ['https://login.microsoftonline.com/*']\n\t\t\t};\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider1);\n\t\t\tauthenticationService.registerDeclaredAuthenticationProvider(provider2);\n\n\t\t\t// Register authentication providers\n\t\t\tconst githubProvider = createProvider({\n\t\t\t\tid: 'github',\n\t\t\t\tlabel: 'GitHub',\n\t\t\t\tauthorizationServers: [URI.parse('https://github.com/different')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('github', githubProvider);\n\n\t\t\tconst microsoftProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [URI.parse('https://login.microsoftonline.com/common')]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', microsoftProvider);\n\n\t\t\t// Test with a URI that should match the second provider\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when resourceServer matches provider resourceServer', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server and resource server\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, resourceServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should not match when resourceServer does not match provider resourceServer', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\t\t\tconst differentResourceServer = URI.parse('https://vault.azure.net');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server but different resource server\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, differentResourceServer);\n\n\t\t\t// Verify the result - should not match because resource servers don't match\n\t\t\tassert.strictEqual(result, undefined);\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when provider has no resourceServer and resourceServer is provided', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider without a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer]\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server and a resource server\n\t\t\t// Should match because provider has no resourceServer defined\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, resourceServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should match when provider has resourceServer but no resourceServer is provided', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst resourceServer = URI.parse('https://graph.microsoft.com');\n\n\t\t\t// Register an authentication provider with a resourceServer\n\t\t\tconst authProvider = createProvider({\n\t\t\t\tid: 'microsoft',\n\t\t\t\tlabel: 'Microsoft',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: resourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft', authProvider);\n\n\t\t\t// Test with matching authorization server but no resource server provided\n\t\t\t// Should match because no resourceServer is provided to check against\n\t\t\tconst result = await authenticationService.getOrActivateProviderIdForServer(authorizationServer);\n\n\t\t\t// Verify the result\n\t\t\tassert.strictEqual(result, 'microsoft');\n\t\t});\n\n\t\ttest('getOrActivateProviderIdForServer - should distinguish between providers with same authorization server but different resource servers', async () => {\n\t\t\tconst authorizationServer = URI.parse('https://login.microsoftonline.com/common');\n\t\t\tconst graphResourceServer = URI.parse('https://graph.microsoft.com');\n\t\t\tconst vaultResourceServer = URI.parse('https://vault.azure.net');\n\n\t\t\t// Register first provider with Graph resource server\n\t\t\tconst graphProvider = createProvider({\n\t\t\t\tid: 'microsoft-graph',\n\t\t\t\tlabel: 'Microsoft Graph',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: graphResourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft-graph', graphProvider);\n\n\t\t\t// Register second provider with Vault resource server\n\t\t\tconst vaultProvider = createProvider({\n\t\t\t\tid: 'microsoft-vault',\n\t\t\t\tlabel: 'Microsoft Vault',\n\t\t\t\tauthorizationServers: [authorizationServer],\n\t\t\t\tresourceServer: vaultResourceServer\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider('microsoft-vault', vaultProvider);\n\n\t\t\t// Test with Graph resource server - should match the first provider\n\t\t\tconst graphResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, graphResourceServer);\n\t\t\tassert.strictEqual(graphResult, 'microsoft-graph');\n\n\t\t\t// Test with Vault resource server - should match the second provider\n\t\t\tconst vaultResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, vaultResourceServer);\n\t\t\tassert.strictEqual(vaultResult, 'microsoft-vault');\n\n\t\t\t// Test with different resource server - should not match either\n\t\t\tconst otherResourceServer = URI.parse('https://storage.azure.com');\n\t\t\tconst noMatchResult = await authenticationService.getOrActivateProviderIdForServer(authorizationServer, otherResourceServer);\n\t\t\tassert.strictEqual(noMatchResult, undefined);\n\t\t});\n\t});\n\n\tsuite('authenticationSessions', () => {\n\t\ttest('getSessions - base case', async () => {\n\t\t\tlet isCalled = false;\n\t\t\tconst provider = createProvider({\n\t\t\t\tgetSessions: async () => {\n\t\t\t\t\tisCalled = true;\n\t\t\t\t\treturn [createSession()];\n\t\t\t\t},\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tconst sessions = await authenticationService.getSessions(provider.id);\n\n\t\t\tassert.equal(sessions.length, 1);\n\t\t\tassert.ok(isCalled);\n\t\t});\n\n\t\ttest('getSessions - authorization server is not registered', async () => {\n\t\t\tlet isCalled = false;\n\t\t\tconst provider = createProvider({\n\t\t\t\tgetSessions: async () => {\n\t\t\t\t\tisCalled = true;\n\t\t\t\t\treturn [createSession()];\n\t\t\t\t},\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tassert.rejects(() => authenticationService.getSessions(provider.id, [], { authorizationServer: URI.parse('https://example.com') }));\n\t\t\tassert.ok(!isCalled);\n\t\t});\n\n\t\ttest('createSession', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tcreateSession: async () => {\n\t\t\t\t\tconst session = createSession();\n\t\t\t\t\temitter.fire({ added: [session], removed: [], changed: [] });\n\t\t\t\t\treturn session;\n\t\t\t\t},\n\t\t\t});\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tconst session = await authenticationService.createSession(provider.id, ['repo']);\n\n\t\t\t// Assert that the created session matches the expected session and the event fires\n\t\t\tassert.ok(session);\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [session], removed: [], changed: [] }\n\t\t\t});\n\t\t});\n\n\t\ttest('removeSession', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst session = createSession();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tremoveSession: async () => emitter.fire({ added: [], removed: [session], changed: [] })\n\t\t\t});\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\t\t\tawait authenticationService.removeSession(provider.id, session.id);\n\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [], removed: [session], changed: [] }\n\t\t\t});\n\t\t});\n\n\t\ttest('onDidChangeSessions', async () => {\n\t\t\tconst emitter = new Emitter<AuthenticationSessionsChangeEvent>();\n\t\t\tconst provider = createProvider({\n\t\t\t\tonDidChangeSessions: emitter.event,\n\t\t\t\tgetSessions: async () => []\n\t\t\t});\n\t\t\tauthenticationService.registerAuthenticationProvider(provider.id, provider);\n\n\t\t\tconst changed = Event.toPromise(authenticationService.onDidChangeSessions);\n\t\t\tconst session = createSession();\n\t\t\temitter.fire({ added: [], removed: [], changed: [session] });\n\n\t\t\tconst result = await changed;\n\t\t\tassert.deepEqual(result, {\n\t\t\t\tproviderId: provider.id,\n\t\t\t\tlabel: provider.label,\n\t\t\t\tevent: { added: [], removed: [], changed: [session] }\n\t\t\t});\n\t\t});\n\t});\n});\n"]}