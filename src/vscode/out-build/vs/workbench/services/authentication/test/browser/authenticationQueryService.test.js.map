{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/authentication/test/browser/authenticationQueryService.test.ts","vs/workbench/services/authentication/test/browser/authenticationQueryService.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,OAAO,EAAE,uCAAuC,EAAE,MAAM,0CAA0C,CAAC;AACnG,OAAO,EAAE,wBAAwB,EAAE,MAAM,+EAA+E,CAAC;AACzH,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE,MAAM,2CAA2C,CAAC;AACxF,OAAO,EAAE,eAAe,EAAE,MAAM,mDAAmD,CAAC;AACpF,OAAO,EAAE,kBAAkB,EAAE,MAAM,kDAAkD,CAAC;AAEtF,OAAO,EAAE,0BAA0B,EAAE,MAAM,6CAA6C,CAAC;AACzF,OAAO,EAAE,sBAAsB,EAAE,gCAAgC,EAAE,MAAM,gCAAgC,CAAC;AAC1G,OAAO,EAAE,2BAA2B,EAAE,MAAM,6CAA6C,CAAC;AAC1F,OAAO,EAAE,8BAA8B,EAAE,MAAM,gDAAgD,CAAC;AAChG,OAAO,EAAE,4BAA4B,EAAE,MAAM,8CAA8C,CAAC;AAC5F,OAAO,EAAE,+BAA+B,EAAE,MAAM,iDAAiD,CAAC;AAClG,OAAO,EAAE,yBAAyB,EAAE,MAAM,2CAA2C,CAAC;AACtF,OAAO,EACN,gBAAgB,EAChB,mBAAmB,EACnB,iBAAiB,EACjB,oBAAoB,EACpB,qBAAqB,EACrB,cAAc,EACd,yBAAyB,EACzB,cAAc,GACd,MAAM,sCAAsC,CAAC;AAE9C;;GAEG;AACH,KAAK,CAAC,8CAA8C,EAAE,GAAG,EAAE;IAC1D,MAAM,WAAW,GAAG,uCAAuC,EAAE,CAAC;IAE9D,IAAI,YAAyC,CAAC;IAC9C,IAAI,WAAsC,CAAC;IAC3C,IAAI,YAA8B,CAAC;IACnC,IAAI,eAAoC,CAAC;IACzC,IAAI,aAAgC,CAAC;IACrC,IAAI,gBAAsC,CAAC;IAE3C,KAAK,CAAC,GAAG,EAAE;QACV,MAAM,oBAAoB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,wBAAwB,EAAE,CAAC,CAAC;QAE7E,yBAAyB;QACzB,MAAM,cAAc,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,kBAAkB,EAAE,CAAC,CAAC;QACjE,oBAAoB,CAAC,IAAI,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC;QAE3D,qBAAqB;QACrB,oBAAoB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,cAAc,EAAE,CAAC,CAAC;QAE7D,oCAAoC;QACpC,WAAW,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,yBAAyB,EAAE,CAAC,CAAC;QAC/D,oBAAoB,CAAC,IAAI,CAAC,sBAAsB,EAAE,WAAW,CAAC,CAAC;QAE/D,YAAY,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,gBAAgB,EAAE,CAAC,CAAC;QACvD,eAAe,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,mBAAmB,EAAE,CAAC,CAAC;QAC7D,aAAa,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAC;QACzD,gBAAgB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,oBAAoB,EAAE,CAAC,CAAC;QAE/D,oBAAoB,CAAC,IAAI,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QACrE,oBAAoB,CAAC,IAAI,CAAC,8BAA8B,EAAE,eAAe,CAAC,CAAC;QAC3E,oBAAoB,CAAC,IAAI,CAAC,4BAA4B,EAAE,aAAa,CAAC,CAAC;QACvE,oBAAoB,CAAC,IAAI,CAAC,+BAA+B,EAAE,gBAAgB,CAAC,CAAC;QAC7E,oBAAoB,CAAC,IAAI,CAAC,gCAAgC,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,qBAAqB,EAAE,CAAC,CAAC,CAAC;QAC1G,oBAAoB,CAAC,IAAI,CAAC,yBAAyB,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,cAAc,EAAE,CAAC,CAAC,CAAC;QAE5F,2BAA2B;QAC3B,YAAY,GAAG,WAAW,CAAC,GAAG,CAAC,oBAAoB,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC;IACjG,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oDAAoD,EAAE,GAAG,EAAE;QAC/D,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,qBAAqB;QACrB,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAExD,mCAAmC;QACnC,cAAc,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QAC3D,MAAM,KAAK,GAAG,cAAc,CAAC,QAAQ,EAAE,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACpC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QAC3D,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;QAE3D,yCAAyC;QACzC,cAAc,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QACnD,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,wCAAwC,EAAE,GAAG,EAAE;QACnD,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,wBAAwB;QACxB,cAAc,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACtD,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAE3D,2DAA2D;QAC3D,MAAM,kBAAkB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QACjH,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAE/D,2CAA2C;QAC3C,MAAM,mBAAmB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QACrH,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;IACtE,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,0CAA0C,EAAE,GAAG,EAAE;QACrD,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QACjF,MAAM,QAAQ,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAExE,2BAA2B;QAC3B,cAAc,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC/E,QAAQ,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC;QAE1E,wDAAwD;QACxD,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,mBAAmB,EAAE,EAAE,kBAAkB,CAAC,CAAC;QAC7E,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,mBAAmB,EAAE,EAAE,mBAAmB,CAAC,CAAC;QAExE,4BAA4B;QAC5B,MAAM,kBAAkB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QACjH,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAE1G,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QAC3D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QAEtD,8BAA8B;QAC9B,MAAM,mBAAmB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QACnH,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4CAA4C,EAAE,GAAG,EAAE;QACvD,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,uCAAuC;QACvC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;QACjE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACtE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QAEnE,qBAAqB;QACrB,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAExE,iBAAiB;QACjB,YAAY,CAAC,MAAM,EAAE,CAAC;QAEtB,gCAAgC;QAChC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACzE,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,yCAAyC,EAAE,GAAG,EAAE;QACpD,yBAAyB;QACzB,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE5D,sBAAsB;QACtB,MAAM,QAAQ,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACnE,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAE/D,4BAA4B;QAC5B,MAAM,WAAW,GAAG,YAAY,CAAC,cAAc,EAAE,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC1C,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,kCAAkC,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC;IACpF,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,yDAAyD,EAAE,GAAG,EAAE;QACpE,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC7G,MAAM,QAAQ,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAEpG,uBAAuB;QACvB,cAAc,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACtD,cAAc,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,cAAc,CAAC,CAAC;QAElD,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;QAC9C,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,WAAW,CAAC,CAAC;QAE1C,6BAA6B;QAC7B,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAC3D,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;QAEtD,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;QAC7E,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;QAEpE,gCAAgC;QAChC,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACnD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gDAAgD,EAAE,GAAG,EAAE;QAC3D,kCAAkC;QAClC,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,aAAa,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAEnE,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9D,MAAM,QAAQ,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAErD,0CAA0C;QAC1C,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,yBAAyB,EAAE,CAAC,CAAC;QACzG,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,wBAAwB,EAAE,CAAC,CAAC;QACvG,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,wBAAwB,EAAE,CAAC,CAAC;QAElG,sDAAsD;QACtD,MAAM,oBAAoB,GAAG,cAAc,CAAC,wBAAwB,EAAE,CAAC;QACvE,MAAM,cAAc,GAAG,QAAQ,CAAC,wBAAwB,EAAE,CAAC;QAE3D,+BAA+B;QAC/B,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,yBAAyB,CAAC,CAAC;QAClF,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,wBAAwB,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAEjD,yBAAyB;QACzB,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,wBAAwB,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAE3C,8CAA8C;QAC9C,MAAM,CAAC,cAAc,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;IACzF,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oCAAoC,EAAE,GAAG,EAAE;QAC/C,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,4BAA4B;QAC5B,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;QACjE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,aAAa,CAAC,CAAC;QAClE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QAEnE,4CAA4C;QAC5C,MAAM,YAAY,GAAa,EAAE,CAAC;QAClC,YAAY,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;YAClD,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3C,MAAM,CAAC,EAAE,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,EAAE,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;QAEzC,6CAA6C;QAC7C,MAAM,YAAY,GAAa,EAAE,CAAC;QAClC,YAAY,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;YAClD,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3C,MAAM,CAAC,EAAE,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,mCAAmC,EAAE,GAAG,EAAE;QAC9C,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,cAAc;QACd,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAEtE,yCAAyC;QACzC,YAAY,CAAC,MAAM,EAAE,CAAC;QAEtB,sBAAsB;QACtB,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;IACjF,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,iDAAiD,EAAE,GAAG,EAAE;QAC5D,8BAA8B;QAC9B,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,aAAa,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAEnE,4CAA4C;QAC5C,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC7H,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;QAE9H,mEAAmE;QACnE,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9D,MAAM,WAAW,GAAG,cAAc,CAAC,wBAAwB,EAAE,CAAC;QAE9D,gCAAgC;QAChC,MAAM,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,+CAA+C;QAEjF,uDAAuD;QACvD,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAClG,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC;QAElG,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,EAAE,EAAE,kBAAkB,CAAC,CAAC;QAChG,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,EAAE,EAAE,mBAAmB,CAAC,CAAC;IACjG,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oDAAoD,EAAE,GAAG,EAAE;QAC/D,IAAI,UAAU,GAAG,KAAK,CAAC;QAEvB,4DAA4D;QAC5D,MAAM,UAAU,GAAG,YAAY,CAAC,iBAAiB,CAAC,GAAG,EAAE;YACtD,UAAU,GAAG,IAAI,CAAC;QACnB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC;YACJ,qDAAqD;YACrD,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;YAE7H,6BAA6B;YAC7B,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QACtC,CAAC;gBAAS,CAAC;YACV,UAAU,CAAC,OAAO,EAAE,CAAC;QACtB,CAAC;IACF,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,mDAAmD,EAAE,GAAG,EAAE;QAC9D,kCAAkC;QAClC,MAAM,oBAAoB,GAAG,YAAY,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC;QAE5E,iDAAiD;QACjD,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE;YACxB,oBAAoB,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,CAAC;QAC9F,CAAC,CAAC,CAAC;QAEH,wCAAwC;QACxC,MAAM,iBAAiB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAChG,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE;YACxB,iBAAiB,CAAC,eAAe,EAAE,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,gCAAgC;QAChC,MAAM,mBAAmB,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;QACtG,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE;YACxB,mBAAmB,CAAC,eAAe,EAAE,CAAC;QACvC,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gCAAgC,EAAE,GAAG,EAAE;QAC3C,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,0DAA0D;QAC1D,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;QACtE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QAErE,gCAAgC;QAChC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;QACjE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,aAAa,CAAC,CAAC;QAElE,wBAAwB;QACxB,IAAI,cAAc,GAAG,CAAC,CAAC;QACvB,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAI,UAAU,GAAG,CAAC,CAAC;QAEnB,YAAY,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;YAClD,cAAc,EAAE,CAAC;YACjB,IAAI,cAAc,CAAC,eAAe,EAAE,KAAK,IAAI,EAAE,CAAC;gBAC/C,YAAY,EAAE,CAAC;YAChB,CAAC;YACD,IAAI,cAAc,CAAC,QAAQ,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;gBAC1C,UAAU,EAAE,CAAC;YACd,CAAC;QACF,CAAC,CAAC,CAAC;QAEH,gCAAgC;QAChC,MAAM,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC,CAAC,gBAAgB;QACrD,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC,CAAC,gBAAgB;QAEnD,uCAAuC;QACvC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC/D,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;QAEhE,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,YAAY,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;YAC5C,QAAQ,EAAE,CAAC;QACZ,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;IACjC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,+CAA+C,EAAE,GAAG,EAAE;QAC1D,mCAAmC;QACnC,MAAM,eAAe,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9G,eAAe,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACvD,eAAe,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QAE5D,qEAAqE;QACrE,MAAM,eAAe,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAElF,+DAA+D;QAC/D,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAC5D,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEzD,wCAAwC;QACxC,eAAe,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC/E,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,mBAAmB,EAAE,EAAE,kBAAkB,CAAC,CAAC;QAE9E,0BAA0B;QAC1B,eAAe,CAAC,gBAAgB,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;QAExD,oEAAoE;QACpE,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,iDAAiD,EAAE,GAAG,EAAE;QAC5D,8BAA8B;QAC9B,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,aAAa,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAEnE,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE9D,oDAAoD;QACpD,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,yBAAyB,EAAE,CAAC,CAAC;QACzG,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,wBAAwB,EAAE,CAAC,CAAC;QAEvG,4BAA4B;QAC5B,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,EAAE,EAAE,yBAAyB,CAAC,CAAC;QACvG,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,EAAE,EAAE,wBAAwB,CAAC,CAAC;QAErG,sEAAsE;QACtE,MAAM,CAAC,WAAW,CACjB,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,WAAW,EAAE,EAC1G,IAAI,CACJ,CAAC;QACF,MAAM,CAAC,WAAW,CACjB,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,WAAW,EAAE,EACxG,IAAI,CACJ,CAAC;QACF,MAAM,CAAC,WAAW,CACjB,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,WAAW,EAAE,EACpG,KAAK,CACL,CAAC;QAEF,wDAAwD;QACxD,MAAM,QAAQ,GAAG,cAAc,CAAC,wBAAwB,EAAE,CAAC;QAC3D,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,yBAAyB,CAAC,CAAC;QACtE,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,wBAAwB,CAAC,CAAC;QACpE,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IACtC,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,oDAAoD,EAAE,GAAG,EAAE;QAC/D,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,iEAAiE;QACjE,MAAM,MAAM,GAAG,iBAAiB,CAAC;QACjC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACnE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,WAAW,CAAC,CAAC;QAEpE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,YAAY,CAAC,CAAC;QAErE,4BAA4B;QAC5B,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;QAE5E,MAAM,QAAQ,GAAG,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC3D,MAAM,QAAQ,GAAG,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAE3D,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;QACpD,MAAM,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;QAElE,4BAA4B;QAC5B,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,UAAU,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC;QACpH,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,UAAU,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC;QAEpH,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,EAAE,EAAE,iBAAiB,CAAC,CAAC;QAC/G,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,EAAE,EAAE,iBAAiB,CAAC,CAAC;IAChH,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,+CAA+C,EAAE,GAAG,EAAE;QAC1D,sDAAsD;QACtD,MAAM,gBAAgB,GAAG,YAAY,CAAC,cAAc,EAAE,CAAC;QACvD,MAAM,YAAY,GAAG,gBAAgB,CAAC,MAAM,CAAC;QAE7C,0BAA0B;QAC1B,MAAM,WAAW,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,eAAe,EAAE,KAAK,EAAE,eAAe,EAAE,CAAC,CAAC;QACpF,WAAW,CAAC,8BAA8B,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;QAEzE,+BAA+B;QAC/B,MAAM,gBAAgB,GAAG,YAAY,CAAC,cAAc,EAAE,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC,MAAM,EAAE,YAAY,GAAG,CAAC,CAAC,CAAC;QAC9D,MAAM,CAAC,EAAE,CAAC,gBAAgB,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC;QAEtD,2CAA2C;QAC3C,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;QAC7D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,UAAU,EAAE,eAAe,CAAC,CAAC;QAE9D,qDAAqD;QACrD,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,kCAAkC,CAAC,eAAe,CAAC,EAAE,IAAI,CAAC,CAAC;IAC3F,CAAC,CAAC,CAAC;IAEH;;;;OAIG;IACH,IAAI,CAAC,wEAAwE,EAAE,GAAG,EAAE;QACnF,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,2BAA2B;QAC3B,aAAa,CAAC,gBAAgB,EAAE,CAAC;QAEjC,wBAAwB;QACxB,cAAc,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAEtD,qDAAqD;QACrD,MAAM,KAAK,GAAG,aAAa,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC;QACnE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,EAAE,UAAU,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC5D,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,cAAc,CAAC,CAAC;QACrD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,wDAAwD,EAAE,GAAG,EAAE;QACnE,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAE/G,2BAA2B;QAC3B,YAAY,CAAC,gBAAgB,EAAE,CAAC;QAEhC,gBAAgB;QAChB,cAAc,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,gBAAgB,CAAC,CAAC;QAE7D,qDAAqD;QACrD,MAAM,KAAK,GAAG,YAAY,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;QAC1D,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,EAAE,MAAM,EAAE,WAAW,EAAE,aAAa,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,mBAAmB,CAAC,CAAC;QACrD,MAAM,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kEAAkE,EAAE,GAAG,EAAE;QAC7E,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,2BAA2B;QAC3B,aAAa,CAAC,gBAAgB,EAAE,CAAC;QAEjC,uBAAuB;QACvB,cAAc,CAAC,eAAe,EAAE,CAAC;QAEjC,qDAAqD;QACrD,MAAM,KAAK,GAAG,aAAa,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;QAC3D,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,EAAE,WAAW,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC7D,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,0DAA0D,EAAE,GAAG,EAAE;QACrE,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,2BAA2B;QAC3B,YAAY,CAAC,gBAAgB,EAAE,CAAC;QAEhC,gBAAgB;QAChB,cAAc,CAAC,QAAQ,EAAE,CAAC;QAE1B,qDAAqD;QACrD,MAAM,KAAK,GAAG,YAAY,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;QAC5D,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAChD,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4EAA4E,EAAE,GAAG,EAAE;QACvF,MAAM,QAAQ,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAEpG,2BAA2B;QAC3B,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;QAEpC,wBAAwB;QACxB,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC;QAElD,qDAAqD;QACrD,MAAM,KAAK,GAAG,gBAAgB,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC;QACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,EAAE,OAAO,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QACrD,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4DAA4D,EAAE,GAAG,EAAE;QACvE,MAAM,QAAQ,GAAG,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAEtG,2BAA2B;QAC3B,eAAe,CAAC,gBAAgB,EAAE,CAAC;QAEnC,gBAAgB;QAChB,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,iBAAiB,CAAC,CAAC;QAEhD,qDAAqD;QACrD,MAAM,KAAK,GAAG,eAAe,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;QAC7D,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEpC,MAAM,CAAC,UAAU,EAAE,WAAW,EAAE,MAAM,EAAE,QAAQ,EAAE,UAAU,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC9E,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,mBAAmB,CAAC,CAAC;QACrD,MAAM,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;QAC1C,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;QAC5C,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,iBAAiB,CAAC,CAAC;IACnD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,uDAAuD,EAAE,GAAG,EAAE;QAClE,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,yBAAyB;QACzB,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;QACjE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACtE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,cAAc,CAAC,CAAC;QAEnE,+CAA+C;QAC/C,YAAY,CAAC,gBAAgB,EAAE,CAAC;QAChC,eAAe,CAAC,gBAAgB,EAAE,CAAC;QACnC,aAAa,CAAC,gBAAgB,EAAE,CAAC;QACjC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;QAEpC,cAAc;QACd,YAAY,CAAC,MAAM,EAAE,CAAC;QAEtB,yCAAyC;QACzC,MAAM,qBAAqB,GAAG,YAAY,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QAC7E,MAAM,eAAe,GAAG,eAAe,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QAC1E,MAAM,sBAAsB,GAAG,aAAa,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC;QACpF,MAAM,gBAAgB,GAAG,gBAAgB,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC;QAEjF,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,sBAAsB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACrD,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE/C,0CAA0C;QAC1C,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC,CAAC,EAAE,sBAAsB,CAAC,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YAC7G,MAAM,CAAC,UAAU,EAAE,WAAW,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC;YAC5C,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,kEAAkE,EAAE,GAAG,EAAE;QAC7E,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QAEjF,mBAAmB;QACnB,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QACrE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;QAEjE,qBAAqB;QACrB,YAAY,CAAC,gBAAgB,EAAE,CAAC;QAChC,aAAa,CAAC,gBAAgB,EAAE,CAAC;QAEjC,yBAAyB;QACzB,YAAY,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE;YACtC,uDAAuD;QACxD,CAAC,CAAC,CAAC;QAEH,kEAAkE;QAClE,MAAM,UAAU,GAAG,YAAY,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;QACjE,MAAM,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC;QAEvE,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE1C,oBAAoB;QACpB,UAAU,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YAC7C,MAAM,CAAC,UAAU,EAAE,WAAW,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC;YAC5C,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,kBAAkB,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,wDAAwD,EAAE,GAAG,EAAE;QACnE,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE7G,qBAAqB;QACrB,aAAa,CAAC,gBAAgB,EAAE,CAAC;QACjC,YAAY,CAAC,gBAAgB,EAAE,CAAC;QAEhC,8BAA8B;QAC9B,cAAc,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACtD,cAAc,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,cAAc,CAAC,CAAC;QAClD,cAAc,CAAC,eAAe,EAAE,CAAC;QACjC,cAAc,CAAC,QAAQ,EAAE,CAAC;QAC1B,cAAc,CAAC,gBAAgB,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;QAEvD,qBAAqB;QACrB,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACnF,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC1E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IAC7E,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8DAA8D,EAAE,KAAK,IAAI,EAAE;QAC/E,sDAAsD;QACtD,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,aAAa,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,MAAM,iBAAiB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,qBAAqB,EAAE,CAAC,CAAC;QAC9F,MAAM,iBAAiB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,qBAAqB,EAAE,CAAC,CAAC;QAE9F,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QACnE,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;QAC7E,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;QAE7E,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,CAAC,CAAC,CAAC;QAC7E,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC,CAAC,CAAC;QAC1F,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC,CAAC,CAAC;QAE1F,kCAAkC;QAClC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC5H,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC1H,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACvI,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAEvI,sEAAsE;QACtE,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9D,MAAM,mBAAmB,GAAG,MAAM,cAAc,CAAC,sBAAsB,EAAE,CAAC;QAE1E,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;QACjD,MAAM,CAAC,EAAE,CAAC,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,mEAAmE,EAAE,KAAK,IAAI,EAAE;QACpF,sDAAsD;QACtD,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,gBAAgB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC;QAE3F,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;QAE5E,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC,CAAC;QAEzF,kCAAkC;QAClC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC5H,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAEtI,0EAA0E;QAC1E,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9D,MAAM,mBAAmB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QAE9E,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,yEAAyE,EAAE,KAAK,IAAI,EAAE;QAC1F,sDAAsD;QACtD,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,aAAa,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;QACtE,MAAM,iBAAiB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,qBAAqB,EAAE,CAAC,CAAC;QAC9F,MAAM,iBAAiB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,qBAAqB,EAAE,CAAC,CAAC;QAE9F,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QACnE,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;QAC7E,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;QAE7E,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,CAAC,CAAC,CAAC;QAC7E,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC,CAAC,CAAC;QAC1F,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC,CAAC,CAAC;QAE1F,sCAAsC;QACtC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACtH,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACpH,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACjI,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAEjI,uEAAuE;QACvE,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC3D,MAAM,mBAAmB,GAAG,MAAM,cAAc,CAAC,sBAAsB,EAAE,CAAC;QAE1E,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;QACjD,MAAM,CAAC,EAAE,CAAC,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8EAA8E,EAAE,KAAK,IAAI,EAAE;QAC/F,sDAAsD;QACtD,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzE,MAAM,gBAAgB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC;QAE3F,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;QAE5E,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC,CAAC;QAEzF,sCAAsC;QACtC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QACtH,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAEhI,2EAA2E;QAC3E,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC3D,MAAM,mBAAmB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QAE9E,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,8DAA8D,EAAE,KAAK,IAAI,EAAE;QAC/E,2BAA2B;QAC3B,MAAM,cAAc,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC;QAClF,MAAM,gBAAgB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC;QAC1F,MAAM,gBAAgB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,oBAAoB,EAAE,CAAC,CAAC;QAE1F,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACrE,WAAW,CAAC,8BAA8B,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;QAC3E,WAAW,CAAC,8BAA8B,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;QAE1E,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC,CAAC;QACxF,WAAW,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,mBAAmB,EAAE,CAAC,CAAC,CAAC;QAEpF,uDAAuD;QACvD,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC5H,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACrI,0DAA0D;QAE1D,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE9D,8DAA8D;QAC9D,MAAM,wBAAwB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,wBAAwB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACvD,MAAM,CAAC,EAAE,CAAC,wBAAwB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QACvD,MAAM,CAAC,EAAE,CAAC,CAAC,wBAAwB,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;QAC5D,MAAM,CAAC,EAAE,CAAC,CAAC,wBAAwB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;QAE3D,+DAA+D;QAC/D,MAAM,qBAAqB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,CAAC,qBAAqB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;QAC7E,kDAAkD;QAClD,MAAM,eAAe,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC;QACrF,MAAM,kBAAkB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,4BAA4B,EAAE,CAAC,CAAC;QAClG,MAAM,wBAAwB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,UAAU,EAAE,KAAK,EAAE,4BAA4B,EAAE,CAAC,CAAC;QACzG,MAAM,wBAAwB,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,4BAA4B,EAAE,CAAC,CAAC;QAC1G,MAAM,0BAA0B,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,gBAAgB,EAAE,KAAK,EAAE,4BAA4B,EAAE,CAAC,CAAC;QAEjH,WAAW,CAAC,8BAA8B,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;QACvE,WAAW,CAAC,8BAA8B,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;QAC1E,WAAW,CAAC,8BAA8B,CAAC,UAAU,EAAE,wBAAwB,CAAC,CAAC;QACjF,WAAW,CAAC,8BAA8B,CAAC,WAAW,EAAE,wBAAwB,CAAC,CAAC;QAClF,WAAW,CAAC,8BAA8B,CAAC,gBAAgB,EAAE,0BAA0B,CAAC,CAAC;QAEzF,gCAAgC;QAChC,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC,CAAC,CAAC;QACjF,WAAW,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAChF,WAAW,CAAC,WAAW,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QACjF,WAAW,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAClF,WAAW,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAEvF,kCAAkC;QAClC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC9H,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC7H,YAAY,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC9H,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC/H,YAAY,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAEpI,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAE9D,oFAAoF;QACpF,MAAM,wBAAwB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC;QACpF,MAAM,CAAC,WAAW,CAAC,wBAAwB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACvD,MAAM,CAAC,EAAE,CAAC,wBAAwB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,wBAAwB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,EAAE,CAAC,CAAC,wBAAwB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAC,EAAE,CAAC,CAAC,wBAAwB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,6CAA6C;QACzG,MAAM,CAAC,EAAE,CAAC,wBAAwB,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAE/D,qDAAqD;QACrD,MAAM,qBAAqB,GAAG,MAAM,cAAc,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QAChF,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;QACrD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;QACrD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;QACtD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC;QACvD,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC,CAAC;IAC7D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,+EAA+E,EAAE,GAAG,EAAE;QAC1F,qBAAqB;QACrB,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;QACrG,WAAW,CAAC,8BAA8B,CAAC,YAAY,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;QAElH,kBAAkB;QAClB,MAAM,cAAc,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC9D,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC;QACjG,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,CAAC,CAAC;QAC/F,cAAc,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC;QAE1G,6DAA6D;QAC7D,MAAM,oBAAoB,GAAG,cAAc,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;QAC5E,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACjD,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,iBAAiB,CAAC,CAAC;QAC1E,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,gBAAgB,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAC;QAEtE,qDAAqD;QACrD,MAAM,iBAAiB,GAAG,cAAc,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,iBAAiB,CAAC,CAAC;QACvE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,gBAAgB,CAAC,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,sBAAsB,CAAC,CAAC;QAEhF,sDAAsD;QACtD,MAAM,YAAY,GAAG,cAAc,CAAC,wBAAwB,EAAE,CAAC;QAC/D,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAC;IAC/D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gFAAgF,EAAE,GAAG,EAAE;QAC3F,qBAAqB;QACrB,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,8BAA8B,CAAC,OAAO,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;QACrG,WAAW,CAAC,8BAA8B,CAAC,YAAY,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;QAElH,kBAAkB;QAClB,MAAM,QAAQ,GAAG,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QACrD,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC;QAC3F,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,CAAC,CAAC;QACzF,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC;QAEpG,6DAA6D;QAC7D,MAAM,oBAAoB,GAAG,QAAQ,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;QACtE,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACjD,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,iBAAiB,CAAC,CAAC;QAC1E,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,gBAAgB,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAC;QAEtE,qDAAqD;QACrD,MAAM,iBAAiB,GAAG,QAAQ,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;QAClE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,iBAAiB,CAAC,CAAC;QACvE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,gBAAgB,CAAC,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,sBAAsB,CAAC,CAAC;QAEhF,sDAAsD;QACtD,MAAM,YAAY,GAAG,QAAQ,CAAC,wBAAwB,EAAE,CAAC;QACzD,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAC;IAC/D,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;QACtE,qBAAqB;QACrB,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,8BAA8B,CAAC,YAAY,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;QAElH,eAAe;QACf,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC,CAAC;QAExF,mBAAmB;QACnB,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC5H,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAErI,qBAAqB;QACrB,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QACjI,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;QAE1I,gEAAgE;QAChE,MAAM,YAAY,CAAC,YAAY,CAAC,qBAAqB,CAAC,CAAC;QAEvD,6BAA6B;QAC7B,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;QACtI,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;IAChJ,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;QAC7E,qBAAqB;QACrB,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,8BAA8B,CAAC,YAAY,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;QAElH,eAAe;QACf,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC/E,WAAW,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,sBAAsB,EAAE,CAAC,CAAC,CAAC;QAExF,mBAAmB;QACnB,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAC5H,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QAErI,0CAA0C;QAC1C,MAAM,YAAY,CAAC,YAAY,CAAC,qBAAqB,EAAE,KAAK,CAAC,CAAC;QAE9D,2CAA2C;QAC3C,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,SAAS,CAAC,CAAC;QACtI,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;IAC3I,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,0CAA0C,EAAE,GAAG,EAAE;QACrD,oCAAoC;QACpC,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAE/E,uDAAuD;QACvD,gBAAgB,CAAC,uBAAuB,CAAC,QAAQ,EAAE,iBAAiB,EAAE,CAAC;gBACtE,EAAE,EAAE,gBAAgB;gBACpB,IAAI,EAAE,gBAAgB;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,IAAI;aACb,CAAC,CAAC,CAAC;QAEJ,2BAA2B;QAC3B,gBAAgB,CAAC,uBAAuB,CAAC,QAAQ,EAAE,iBAAiB,EAAE,CAAC;gBACtE,EAAE,EAAE,oBAAoB;gBACxB,IAAI,EAAE,oBAAoB;gBAC1B,OAAO,EAAE,IAAI;aACb,CAAC,CAAC,CAAC;QAEJ,sBAAsB;QACtB,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QAC5G,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE,IAAI,CAAC,CAAC;QAEnD,0BAA0B;QAC1B,MAAM,eAAe,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,oBAAoB,CAAC,CAAC;QACnH,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,EAAE,EAAE,KAAK,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gEAAgE,EAAE,GAAG,EAAE;QAC3E,oCAAoC;QACpC,WAAW,CAAC,8BAA8B,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QACxG,WAAW,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAE/E,mCAAmC;QACnC,gBAAgB,CAAC,uBAAuB,CAAC,QAAQ,EAAE,iBAAiB,EAAE;YACrE;gBACC,EAAE,EAAE,gBAAgB;gBACpB,IAAI,EAAE,gBAAgB;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,IAAI;aACb;YACD;gBACC,EAAE,EAAE,aAAa;gBACjB,IAAI,EAAE,aAAa;gBACnB,OAAO,EAAE,IAAI;aACb;SACD,CAAC,CAAC;QAEH,0BAA0B;QAC1B,MAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,UAAU,EAAE,CAAC,oBAAoB,EAAE,CAAC;QAEtH,2BAA2B;QAC3B,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE7C,0BAA0B;QAC1B,MAAM,aAAa,GAAG,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,gBAAgB,CAAC,CAAC;QAC1E,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;QACzB,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAChD,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAEhD,+BAA+B;QAC/B,MAAM,UAAU,GAAG,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,aAAa,CAAC,CAAC;QACpE,MAAM,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QACtB,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAC9C,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,gEAAgE,EAAE,GAAG,EAAE;QAC3E,oCAAoC;QACpC,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QACjF,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QACvE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QACvE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,eAAe,CAAC,CAAC;QAEnE,MAAM,iBAAiB,GAAG,YAAY,CAAC,UAAU,EAAE,CAAC,oBAAoB,EAAE,CAAC;QAE3E,8BAA8B;QAC9B,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEhD,2BAA2B;QAC3B,MAAM,IAAI,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,CAAC;QAC1D,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;QAChB,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QACvC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,sBAAsB;QAC/D,MAAM,CAAC,EAAE,CAAC,OAAO,IAAI,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC;QAE7C,4BAA4B;QAC5B,MAAM,IAAI,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,CAAC;QAC1D,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;QAChB,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;QAC/C,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QACvC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,sBAAsB;QAC/D,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,CAAC,WAAW;IAC1D,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,wBAAwB,EAAE,GAAG,EAAE;QACpC,IAAI,CAAC,6CAA6C,EAAE,GAAG,EAAE;YACxD,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,QAAQ,EAAE,CAAC;YAC9F,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,mDAAmD,EAAE,GAAG,EAAE;YAC9D,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YACjF,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,gBAAgB,CAAC,CAAC;YAExE,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oDAAoD,EAAE,GAAG,EAAE;YAC/D,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YACjF,YAAY,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,aAAa,CAAC,CAAC;YAEzE,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oDAAoD,EAAE,GAAG,EAAE;YAC/D,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YACjF,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;YAE5E,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAChE,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YACjF,YAAY,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;YAE5E,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,uCAAuC,EAAE,GAAG,EAAE;YAClD,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YAEjF,mBAAmB;YACnB,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;YAEvE,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,MAAM,GAAG,aAAa,CAAC,cAAc,EAAE,CAAC;YAE9C,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,+CAA+C,EAAE,GAAG,EAAE;YAC1D,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,QAAQ,EAAE,CAAC;YAC9F,MAAM,MAAM,GAAG,aAAa,CAAC,cAAc,EAAE,CAAC;YAE9C,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAChE,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YAEjF,mBAAmB;YACnB,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;YAEvE,uBAAuB;YACvB,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;YAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;YAC3E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;YAC9E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,CAAC;YAE9E,oBAAoB;YACpB,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,aAAa,CAAC,eAAe,EAAE,CAAC;YAEhC,+BAA+B;YAC/B,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;YAC5E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;YAC5E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;YAC/E,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,CAAC,CAAC;QAChF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,wCAAwC,EAAE,GAAG,EAAE;YACnD,MAAM,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;YAEjF,mBAAmB;YACnB,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,eAAe,CAAC,CAAC;YACnE,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;YACvE,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,EAAE,YAAY,CAAC,CAAC;YAEpE,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAC9C,MAAM,eAAe,GAA2D,EAAE,CAAC;YAEnF,aAAa,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,UAAU,EAAE,EAAE;gBAC9C,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,CAAC;YAC1D,CAAC,CAAC,CAAC;YAEH,sDAAsD;YACtD,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAE9C,MAAM,UAAU,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC;YACvE,MAAM,UAAU,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC;YAEvE,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAEzC,uCAAuC;YACvC,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC;YAChF,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC;YAChF,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,SAAS,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC;YACnF,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,SAAS,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC;QACpF,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC","file":"authenticationQueryService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { TestStorageService } from '../../../../test/common/workbenchTestServices.js';\nimport { IAuthenticationQueryService } from '../../common/authenticationQuery.js';\nimport { AuthenticationQueryService } from '../../browser/authenticationQueryService.js';\nimport { IAuthenticationService, IAuthenticationExtensionsService } from '../../common/authentication.js';\nimport { IAuthenticationUsageService } from '../../browser/authenticationUsageService.js';\nimport { IAuthenticationMcpUsageService } from '../../browser/authenticationMcpUsageService.js';\nimport { IAuthenticationAccessService } from '../../browser/authenticationAccessService.js';\nimport { IAuthenticationMcpAccessService } from '../../browser/authenticationMcpAccessService.js';\nimport { IAuthenticationMcpService } from '../../browser/authenticationMcpService.js';\nimport {\n\tTestUsageService,\n\tTestMcpUsageService,\n\tTestAccessService,\n\tTestMcpAccessService,\n\tTestExtensionsService,\n\tTestMcpService,\n\tTestAuthenticationService,\n\tcreateProvider,\n} from './authenticationQueryServiceMocks.js';\n\n/**\n * Real integration tests for AuthenticationQueryService\n */\nsuite('AuthenticationQueryService Integration Tests', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet queryService: IAuthenticationQueryService;\n\tlet authService: TestAuthenticationService;\n\tlet usageService: TestUsageService;\n\tlet mcpUsageService: TestMcpUsageService;\n\tlet accessService: TestAccessService;\n\tlet mcpAccessService: TestMcpAccessService;\n\n\tsetup(() => {\n\t\tconst instantiationService = disposables.add(new TestInstantiationService());\n\n\t\t// Set up storage service\n\t\tconst storageService = disposables.add(new TestStorageService());\n\t\tinstantiationService.stub(IStorageService, storageService);\n\n\t\t// Set up log service\n\t\tinstantiationService.stub(ILogService, new NullLogService());\n\n\t\t// Create and register test services\n\t\tauthService = disposables.add(new TestAuthenticationService());\n\t\tinstantiationService.stub(IAuthenticationService, authService);\n\n\t\tusageService = disposables.add(new TestUsageService());\n\t\tmcpUsageService = disposables.add(new TestMcpUsageService());\n\t\taccessService = disposables.add(new TestAccessService());\n\t\tmcpAccessService = disposables.add(new TestMcpAccessService());\n\n\t\tinstantiationService.stub(IAuthenticationUsageService, usageService);\n\t\tinstantiationService.stub(IAuthenticationMcpUsageService, mcpUsageService);\n\t\tinstantiationService.stub(IAuthenticationAccessService, accessService);\n\t\tinstantiationService.stub(IAuthenticationMcpAccessService, mcpAccessService);\n\t\tinstantiationService.stub(IAuthenticationExtensionsService, disposables.add(new TestExtensionsService()));\n\t\tinstantiationService.stub(IAuthenticationMcpService, disposables.add(new TestMcpService()));\n\n\t\t// Create the query service\n\t\tqueryService = disposables.add(instantiationService.createInstance(AuthenticationQueryService));\n\t});\n\n\ttest('usage tracking stores and retrieves data correctly', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Initially no usage\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 0);\n\n\t\t// Add usage and verify it's stored\n\t\textensionQuery.addUsage(['read', 'write'], 'My Extension');\n\t\tconst usage = extensionQuery.getUsage();\n\t\tassert.strictEqual(usage.length, 1);\n\t\tassert.strictEqual(usage[0].extensionId, 'my-extension');\n\t\tassert.strictEqual(usage[0].extensionName, 'My Extension');\n\t\tassert.deepStrictEqual(usage[0].scopes, ['read', 'write']);\n\n\t\t// Add more usage and verify accumulation\n\t\textensionQuery.addUsage(['admin'], 'My Extension');\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 2);\n\t});\n\n\ttest('access control persists across queries', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Set access and verify\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\tassert.strictEqual(extensionQuery.isAccessAllowed(), true);\n\n\t\t// Create new query object for same target - should persist\n\t\tconst sameExtensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tassert.strictEqual(sameExtensionQuery.isAccessAllowed(), true);\n\n\t\t// Different extension should be unaffected\n\t\tconst otherExtensionQuery = queryService.provider('github').account('user@example.com').extension('other-extension');\n\t\tassert.strictEqual(otherExtensionQuery.isAccessAllowed(), undefined);\n\t});\n\n\ttest('account preferences work across services', () => {\n\t\tconst extensionQuery = queryService.provider('github').extension('my-extension');\n\t\tconst mcpQuery = queryService.provider('github').mcpServer('my-server');\n\n\t\t// Set preferences for both\n\t\textensionQuery.setPreferredAccount({ id: 'user1', label: 'user@example.com' });\n\t\tmcpQuery.setPreferredAccount({ id: 'user2', label: 'admin@example.com' });\n\n\t\t// Verify different preferences are stored independently\n\t\tassert.strictEqual(extensionQuery.getPreferredAccount(), 'user@example.com');\n\t\tassert.strictEqual(mcpQuery.getPreferredAccount(), 'admin@example.com');\n\n\t\t// Test preference detection\n\t\tconst userExtensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tconst adminMcpQuery = queryService.provider('github').account('admin@example.com').mcpServer('my-server');\n\n\t\tassert.strictEqual(userExtensionQuery.isPreferred(), true);\n\t\tassert.strictEqual(adminMcpQuery.isPreferred(), true);\n\n\t\t// Test non-preferred accounts\n\t\tconst wrongExtensionQuery = queryService.provider('github').account('wrong@example.com').extension('my-extension');\n\t\tassert.strictEqual(wrongExtensionQuery.isPreferred(), false);\n\t});\n\n\ttest('account removal cleans up all related data', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up data across multiple services\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['write'], 'MCP Server 1');\n\n\t\t// Verify data exists\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.extension('ext1').getUsage().length, 1);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').getUsage().length, 1);\n\n\t\t// Remove account\n\t\taccountQuery.remove();\n\n\t\t// Verify all data is cleaned up\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.extension('ext1').getUsage().length, 0);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').getUsage().length, 0);\n\t});\n\n\ttest('provider registration and listing works', () => {\n\t\t// Initially no providers\n\t\tassert.strictEqual(queryService.getProviderIds().length, 0);\n\n\t\t// Register a provider\n\t\tconst provider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tauthService.registerAuthenticationProvider('github', provider);\n\n\t\t// Verify provider is listed\n\t\tconst providerIds = queryService.getProviderIds();\n\t\tassert.ok(providerIds.includes('github'));\n\t\tassert.strictEqual(authService.isAuthenticationProviderRegistered('github'), true);\n\t});\n\n\ttest('MCP usage and access work independently from extensions', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tconst mcpQuery = queryService.provider('github').account('user@example.com').mcpServer('my-server');\n\n\t\t// Set up data for both\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery.addUsage(['read'], 'My Extension');\n\n\t\tmcpQuery.setAccessAllowed(false, 'My Server');\n\t\tmcpQuery.addUsage(['write'], 'My Server');\n\n\t\t// Verify they're independent\n\t\tassert.strictEqual(extensionQuery.isAccessAllowed(), true);\n\t\tassert.strictEqual(mcpQuery.isAccessAllowed(), false);\n\n\t\tassert.strictEqual(extensionQuery.getUsage()[0].extensionId, 'my-extension');\n\t\tassert.strictEqual(mcpQuery.getUsage()[0].mcpServerId, 'my-server');\n\n\t\t// Verify no cross-contamination\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 1);\n\t\tassert.strictEqual(mcpQuery.getUsage().length, 1);\n\t});\n\n\ttest('getAllAccountPreferences returns synchronously', () => {\n\t\t// Register providers for the test\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst mcpQuery = queryService.mcpServer('my-server');\n\n\t\t// Set preferences for different providers\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'github-user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'azure-user@example.com' });\n\t\tmcpQuery.provider('github').setPreferredAccount({ id: 'user3', label: 'github-mcp@example.com' });\n\n\t\t// Get all preferences synchronously (no await needed)\n\t\tconst extensionPreferences = extensionQuery.getAllAccountPreferences();\n\t\tconst mcpPreferences = mcpQuery.getAllAccountPreferences();\n\n\t\t// Verify extension preferences\n\t\tassert.strictEqual(extensionPreferences.get('github'), 'github-user@example.com');\n\t\tassert.strictEqual(extensionPreferences.get('azure'), 'azure-user@example.com');\n\t\tassert.strictEqual(extensionPreferences.size, 2);\n\n\t\t// Verify MCP preferences\n\t\tassert.strictEqual(mcpPreferences.get('github'), 'github-mcp@example.com');\n\t\tassert.strictEqual(mcpPreferences.size, 1);\n\n\t\t// Verify they don't interfere with each other\n\t\tassert.notStrictEqual(extensionPreferences.get('github'), mcpPreferences.get('github'));\n\t});\n\n\ttest('forEach methods work synchronously', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Add some usage data first\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.extension('ext2').addUsage(['write'], 'Extension 2');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['admin'], 'MCP Server 1');\n\n\t\t// Test extensions forEach - no await needed\n\t\tconst extensionIds: string[] = [];\n\t\taccountQuery.extensions().forEach(extensionQuery => {\n\t\t\textensionIds.push(extensionQuery.extensionId);\n\t\t});\n\n\t\tassert.strictEqual(extensionIds.length, 2);\n\t\tassert.ok(extensionIds.includes('ext1'));\n\t\tassert.ok(extensionIds.includes('ext2'));\n\n\t\t// Test MCP servers forEach - no await needed\n\t\tconst mcpServerIds: string[] = [];\n\t\taccountQuery.mcpServers().forEach(mcpServerQuery => {\n\t\t\tmcpServerIds.push(mcpServerQuery.mcpServerId);\n\t\t});\n\n\t\tassert.strictEqual(mcpServerIds.length, 1);\n\t\tassert.ok(mcpServerIds.includes('mcp1'));\n\t});\n\n\ttest('remove method works synchronously', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up data\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\n\t\t// Remove synchronously - no await needed\n\t\taccountQuery.remove();\n\n\t\t// Verify data is gone\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), undefined);\n\t});\n\n\ttest('cross-provider extension queries work correctly', () => {\n\t\t// Register multiple providers\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\t// Set up data using provider-first approach\n\t\tqueryService.provider('github').account('user@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('azure').account('admin@example.com').extension('my-extension').setAccessAllowed(false, 'My Extension');\n\n\t\t// Query using extension-first approach should return all providers\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst githubPrefs = extensionQuery.getAllAccountPreferences();\n\n\t\t// Should include both providers\n\t\tassert.ok(githubPrefs.size >= 0); // Extension query should work across providers\n\n\t\t// Test preferences using extension-first query pattern\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'admin@example.com' });\n\n\t\tassert.strictEqual(extensionQuery.provider('github').getPreferredAccount(), 'user@example.com');\n\t\tassert.strictEqual(extensionQuery.provider('azure').getPreferredAccount(), 'admin@example.com');\n\t});\n\n\ttest('event forwarding from authentication service works', () => {\n\t\tlet eventFired = false;\n\n\t\t// Listen for access change events through the query service\n\t\tconst disposable = queryService.onDidChangeAccess(() => {\n\t\t\teventFired = true;\n\t\t});\n\n\t\ttry {\n\t\t\t// Trigger an access change that should fire an event\n\t\t\tqueryService.provider('github').account('user@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t\t// Verify the event was fired\n\t\t\tassert.strictEqual(eventFired, true);\n\t\t} finally {\n\t\t\tdisposable.dispose();\n\t\t}\n\t});\n\n\ttest('error handling for invalid inputs works correctly', () => {\n\t\t// Test with non-existent provider\n\t\tconst invalidProviderQuery = queryService.provider('non-existent-provider');\n\n\t\t// Should not throw, but should handle gracefully\n\t\tassert.doesNotThrow(() => {\n\t\t\tinvalidProviderQuery.account('user@example.com').extension('my-extension').isAccessAllowed();\n\t\t});\n\n\t\t// Test with empty/invalid account names\n\t\tconst emptyAccountQuery = queryService.provider('github').account('').extension('my-extension');\n\t\tassert.doesNotThrow(() => {\n\t\t\temptyAccountQuery.isAccessAllowed();\n\t\t});\n\n\t\t// Test with empty extension IDs\n\t\tconst emptyExtensionQuery = queryService.provider('github').account('user@example.com').extension('');\n\t\tassert.doesNotThrow(() => {\n\t\t\temptyExtensionQuery.isAccessAllowed();\n\t\t});\n\t});\n\n\ttest('bulk operations work correctly', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up multiple extensions with different access levels\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext2').setAccessAllowed(false, 'Extension 2');\n\t\taccountQuery.extension('ext3').setAccessAllowed(true, 'Extension 3');\n\n\t\t// Add usage for some extensions\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.extension('ext3').addUsage(['write'], 'Extension 3');\n\n\t\t// Test bulk enumeration\n\t\tlet extensionCount = 0;\n\t\tlet allowedCount = 0;\n\t\tlet usageCount = 0;\n\n\t\taccountQuery.extensions().forEach(extensionQuery => {\n\t\t\textensionCount++;\n\t\t\tif (extensionQuery.isAccessAllowed() === true) {\n\t\t\t\tallowedCount++;\n\t\t\t}\n\t\t\tif (extensionQuery.getUsage().length > 0) {\n\t\t\t\tusageCount++;\n\t\t\t}\n\t\t});\n\n\t\t// Verify bulk operation results\n\t\tassert.strictEqual(extensionCount, 3);\n\t\tassert.strictEqual(allowedCount, 2); // ext1 and ext3\n\t\tassert.strictEqual(usageCount, 2); // ext1 and ext3\n\n\t\t// Test bulk operations for MCP servers\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP 1');\n\t\taccountQuery.mcpServer('mcp2').setAccessAllowed(false, 'MCP 2');\n\n\t\tlet mcpCount = 0;\n\t\taccountQuery.mcpServers().forEach(mcpQuery => {\n\t\t\tmcpCount++;\n\t\t});\n\n\t\tassert.strictEqual(mcpCount, 2);\n\t});\n\n\ttest('data consistency across different query paths', () => {\n\t\t// Set up data using one query path\n\t\tconst extensionQuery1 = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\textensionQuery1.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery1.addUsage(['read', 'write'], 'My Extension');\n\n\t\t// Access same data using different query path (cross-provider query)\n\t\tconst extensionQuery2 = queryService.extension('my-extension').provider('github');\n\n\t\t// Data should be consistent through provider preference access\n\t\tassert.strictEqual(extensionQuery1.isAccessAllowed(), true);\n\t\tassert.strictEqual(extensionQuery1.getUsage().length, 1);\n\n\t\t// Set preferences and check consistency\n\t\textensionQuery2.setPreferredAccount({ id: 'user', label: 'user@example.com' });\n\t\tassert.strictEqual(extensionQuery2.getPreferredAccount(), 'user@example.com');\n\n\t\t// Modify through one path\n\t\textensionQuery1.setAccessAllowed(false, 'My Extension');\n\n\t\t// Should be reflected when accessing through provider->account path\n\t\tassert.strictEqual(extensionQuery1.isAccessAllowed(), false);\n\t});\n\n\ttest('preference management handles complex scenarios', () => {\n\t\t// Register multiple providers\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Set different preferences for different providers\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'github-user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'azure-user@example.com' });\n\n\t\t// Test preference retrieval\n\t\tassert.strictEqual(extensionQuery.provider('github').getPreferredAccount(), 'github-user@example.com');\n\t\tassert.strictEqual(extensionQuery.provider('azure').getPreferredAccount(), 'azure-user@example.com');\n\n\t\t// Test account preference detection through provider->account queries\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('github').account('github-user@example.com').extension('my-extension').isPreferred(),\n\t\t\ttrue\n\t\t);\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('azure').account('azure-user@example.com').extension('my-extension').isPreferred(),\n\t\t\ttrue\n\t\t);\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('github').account('wrong@example.com').extension('my-extension').isPreferred(),\n\t\t\tfalse\n\t\t);\n\n\t\t// Test getAllAccountPreferences with multiple providers\n\t\tconst allPrefs = extensionQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(allPrefs.get('github'), 'github-user@example.com');\n\t\tassert.strictEqual(allPrefs.get('azure'), 'azure-user@example.com');\n\t\tassert.strictEqual(allPrefs.size, 2);\n\t});\n\n\ttest('MCP server vs extension data isolation is complete', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up similar data for extension and MCP server with same IDs\n\t\tconst sameId = 'same-identifier';\n\t\taccountQuery.extension(sameId).setAccessAllowed(true, 'Extension');\n\t\taccountQuery.extension(sameId).addUsage(['ext-scope'], 'Extension');\n\n\t\taccountQuery.mcpServer(sameId).setAccessAllowed(false, 'MCP Server');\n\t\taccountQuery.mcpServer(sameId).addUsage(['mcp-scope'], 'MCP Server');\n\n\t\t// Verify complete isolation\n\t\tassert.strictEqual(accountQuery.extension(sameId).isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.mcpServer(sameId).isAccessAllowed(), false);\n\n\t\tconst extUsage = accountQuery.extension(sameId).getUsage();\n\t\tconst mcpUsage = accountQuery.mcpServer(sameId).getUsage();\n\n\t\tassert.strictEqual(extUsage.length, 1);\n\t\tassert.strictEqual(mcpUsage.length, 1);\n\t\tassert.strictEqual(extUsage[0].extensionId, sameId);\n\t\tassert.strictEqual(mcpUsage[0].mcpServerId, sameId);\n\t\tassert.notDeepStrictEqual(extUsage[0].scopes, mcpUsage[0].scopes);\n\n\t\t// Test preference isolation\n\t\tqueryService.extension(sameId).provider('github').setPreferredAccount({ id: 'ext-user', label: 'ext@example.com' });\n\t\tqueryService.mcpServer(sameId).provider('github').setPreferredAccount({ id: 'mcp-user', label: 'mcp@example.com' });\n\n\t\tassert.strictEqual(queryService.extension(sameId).provider('github').getPreferredAccount(), 'ext@example.com');\n\t\tassert.strictEqual(queryService.mcpServer(sameId).provider('github').getPreferredAccount(), 'mcp@example.com');\n\t});\n\n\ttest('provider listing and registration integration', () => {\n\t\t// Initially should have providers from setup (if any)\n\t\tconst initialProviders = queryService.getProviderIds();\n\t\tconst initialCount = initialProviders.length;\n\n\t\t// Register a new provider\n\t\tconst newProvider = createProvider({ id: 'test-provider', label: 'Test Provider' });\n\t\tauthService.registerAuthenticationProvider('test-provider', newProvider);\n\n\t\t// Should now appear in listing\n\t\tconst updatedProviders = queryService.getProviderIds();\n\t\tassert.strictEqual(updatedProviders.length, initialCount + 1);\n\t\tassert.ok(updatedProviders.includes('test-provider'));\n\n\t\t// Should be able to query the new provider\n\t\tconst providerQuery = queryService.provider('test-provider');\n\t\tassert.strictEqual(providerQuery.providerId, 'test-provider');\n\n\t\t// Should integrate with authentication service state\n\t\tassert.strictEqual(authService.isAuthenticationProviderRegistered('test-provider'), true);\n\t});\n\n\t/**\n\t * Service Call Verification Tests\n\t * These tests verify that the AuthenticationQueryService properly delegates to underlying services\n\t * with the correct parameters. This is important for ensuring the facade works correctly.\n\t */\n\ttest('setAccessAllowed calls updateAllowedExtensions with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\taccessService.clearCallHistory();\n\n\t\t// Call setAccessAllowed\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = accessService.getCallsFor('updateAllowedExtensions');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, extensions] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(extensions.length, 1);\n\t\tassert.strictEqual(extensions[0].id, 'my-extension');\n\t\tassert.strictEqual(extensions[0].name, 'My Extension');\n\t\tassert.strictEqual(extensions[0].allowed, true);\n\t});\n\n\ttest('addUsage calls addAccountUsage with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('azure').account('admin@company.com').extension('test-extension');\n\n\t\t// Clear any previous calls\n\t\tusageService.clearCallHistory();\n\n\t\t// Call addUsage\n\t\textensionQuery.addUsage(['read', 'write'], 'Test Extension');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = usageService.getCallsFor('addAccountUsage');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, scopes, extensionId, extensionName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'azure');\n\t\tassert.strictEqual(accountName, 'admin@company.com');\n\t\tassert.deepStrictEqual(scopes, ['read', 'write']);\n\t\tassert.strictEqual(extensionId, 'test-extension');\n\t\tassert.strictEqual(extensionName, 'Test Extension');\n\t});\n\n\ttest('isAccessAllowed calls underlying service with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\taccessService.clearCallHistory();\n\n\t\t// Call isAccessAllowed\n\t\textensionQuery.isAccessAllowed();\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = accessService.getCallsFor('isAccessAllowed');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, extensionId] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(extensionId, 'my-extension');\n\t});\n\n\ttest('getUsage calls readAccountUsages with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\tusageService.clearCallHistory();\n\n\t\t// Call getUsage\n\t\textensionQuery.getUsage();\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = usageService.getCallsFor('readAccountUsages');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t});\n\n\ttest('MCP setAccessAllowed calls updateAllowedMcpServers with correct parameters', () => {\n\t\tconst mcpQuery = queryService.provider('github').account('user@example.com').mcpServer('my-server');\n\n\t\t// Clear any previous calls\n\t\tmcpAccessService.clearCallHistory();\n\n\t\t// Call setAccessAllowed\n\t\tmcpQuery.setAccessAllowed(false, 'My MCP Server');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = mcpAccessService.getCallsFor('updateAllowedMcpServers');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, servers] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(servers.length, 1);\n\t\tassert.strictEqual(servers[0].id, 'my-server');\n\t\tassert.strictEqual(servers[0].name, 'My MCP Server');\n\t\tassert.strictEqual(servers[0].allowed, false);\n\t});\n\n\ttest('MCP addUsage calls addAccountUsage with correct parameters', () => {\n\t\tconst mcpQuery = queryService.provider('azure').account('admin@company.com').mcpServer('test-server');\n\n\t\t// Clear any previous calls\n\t\tmcpUsageService.clearCallHistory();\n\n\t\t// Call addUsage\n\t\tmcpQuery.addUsage(['admin'], 'Test MCP Server');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = mcpUsageService.getCallsFor('addAccountUsage');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, scopes, serverId, serverName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'azure');\n\t\tassert.strictEqual(accountName, 'admin@company.com');\n\t\tassert.deepStrictEqual(scopes, ['admin']);\n\t\tassert.strictEqual(serverId, 'test-server');\n\t\tassert.strictEqual(serverName, 'Test MCP Server');\n\t});\n\n\ttest('account removal calls all appropriate cleanup methods', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up some data first\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['write'], 'MCP Server 1');\n\n\t\t// Clear call history to focus on removal calls\n\t\tusageService.clearCallHistory();\n\t\tmcpUsageService.clearCallHistory();\n\t\taccessService.clearCallHistory();\n\t\tmcpAccessService.clearCallHistory();\n\n\t\t// Call remove\n\t\taccountQuery.remove();\n\n\t\t// Verify all cleanup methods were called\n\t\tconst extensionUsageRemoval = usageService.getCallsFor('removeAccountUsage');\n\t\tconst mcpUsageRemoval = mcpUsageService.getCallsFor('removeAccountUsage');\n\t\tconst extensionAccessRemoval = accessService.getCallsFor('removeAllowedExtensions');\n\t\tconst mcpAccessRemoval = mcpAccessService.getCallsFor('removeAllowedMcpServers');\n\n\t\tassert.strictEqual(extensionUsageRemoval.length, 1);\n\t\tassert.strictEqual(mcpUsageRemoval.length, 1);\n\t\tassert.strictEqual(extensionAccessRemoval.length, 1);\n\t\tassert.strictEqual(mcpAccessRemoval.length, 1);\n\n\t\t// Verify all calls use correct parameters\n\t\t[extensionUsageRemoval[0], mcpUsageRemoval[0], extensionAccessRemoval[0], mcpAccessRemoval[0]].forEach(call => {\n\t\t\tconst [providerId, accountName] = call.args;\n\t\t\tassert.strictEqual(providerId, 'github');\n\t\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\t});\n\t});\n\n\ttest('bulk operations call readAccountUsages and readAllowedExtensions', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up some data\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext2').addUsage(['read'], 'Extension 2');\n\n\t\t// Clear call history\n\t\tusageService.clearCallHistory();\n\t\taccessService.clearCallHistory();\n\n\t\t// Perform bulk operation\n\t\taccountQuery.extensions().forEach(() => {\n\t\t\t// Just iterate to trigger the underlying service calls\n\t\t});\n\n\t\t// Verify the underlying services were called for bulk enumeration\n\t\tconst usageCalls = usageService.getCallsFor('readAccountUsages');\n\t\tconst accessCalls = accessService.getCallsFor('readAllowedExtensions');\n\n\t\tassert.strictEqual(usageCalls.length, 1);\n\t\tassert.strictEqual(accessCalls.length, 1);\n\n\t\t// Verify parameters\n\t\tusageCalls.concat(accessCalls).forEach(call => {\n\t\t\tconst [providerId, accountName] = call.args;\n\t\t\tassert.strictEqual(providerId, 'github');\n\t\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\t});\n\t});\n\n\ttest('multiple operations accumulate service calls correctly', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear call history\n\t\taccessService.clearCallHistory();\n\t\tusageService.clearCallHistory();\n\n\t\t// Perform multiple operations\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery.addUsage(['read'], 'My Extension');\n\t\textensionQuery.isAccessAllowed();\n\t\textensionQuery.getUsage();\n\t\textensionQuery.setAccessAllowed(false, 'My Extension');\n\n\t\t// Verify call counts\n\t\tassert.strictEqual(accessService.getCallsFor('updateAllowedExtensions').length, 2);\n\t\tassert.strictEqual(accessService.getCallsFor('isAccessAllowed').length, 1);\n\t\tassert.strictEqual(usageService.getCallsFor('addAccountUsage').length, 1);\n\t\tassert.strictEqual(usageService.getCallsFor('readAccountUsages').length, 1);\n\t});\n\n\ttest('getProvidersWithAccess filters internal providers by default', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tconst internalProvider1 = createProvider({ id: '__internal1', label: 'Internal Provider 1' });\n\t\tconst internalProvider2 = createProvider({ id: '__internal2', label: 'Internal Provider 2' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider1);\n\t\tauthService.registerAuthenticationProvider('__internal2', internalProvider2);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('azure', [{ id: 'user2', label: 'user@azure.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user3', label: 'internal1@example.com' }]);\n\t\tauthService.addAccounts('__internal2', [{ id: 'user4', label: 'internal2@example.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('azure').account('user@azure.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal1').account('internal1@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal2').account('internal2@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Test extension query - should exclude internal providers by default\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst providersWithAccess = await extensionQuery.getProvidersWithAccess();\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('azure'));\n\t\tassert.ok(!providersWithAccess.includes('__internal1'));\n\t\tassert.ok(!providersWithAccess.includes('__internal2'));\n\t});\n\n\ttest('getProvidersWithAccess includes internal providers when requested', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst internalProvider = createProvider({ id: '__internal1', label: 'Internal Provider' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal1').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Test extension query - should include internal providers when requested\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst providersWithAccess = await extensionQuery.getProvidersWithAccess(true);\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('__internal1'));\n\t});\n\n\ttest('MCP server getProvidersWithAccess filters internal providers by default', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tconst internalProvider1 = createProvider({ id: '__internal1', label: 'Internal Provider 1' });\n\t\tconst internalProvider2 = createProvider({ id: '__internal2', label: 'Internal Provider 2' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider1);\n\t\tauthService.registerAuthenticationProvider('__internal2', internalProvider2);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('azure', [{ id: 'user2', label: 'user@azure.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user3', label: 'internal1@example.com' }]);\n\t\tauthService.addAccounts('__internal2', [{ id: 'user4', label: 'internal2@example.com' }]);\n\n\t\t// Set up MCP access for all providers\n\t\tqueryService.provider('github').account('user@github.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('azure').account('user@azure.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal1').account('internal1@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal2').account('internal2@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\n\t\t// Test MCP server query - should exclude internal providers by default\n\t\tconst mcpServerQuery = queryService.mcpServer('my-server');\n\t\tconst providersWithAccess = await mcpServerQuery.getProvidersWithAccess();\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('azure'));\n\t\tassert.ok(!providersWithAccess.includes('__internal1'));\n\t\tassert.ok(!providersWithAccess.includes('__internal2'));\n\t});\n\n\ttest('MCP server getProvidersWithAccess includes internal providers when requested', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst internalProvider = createProvider({ id: '__internal1', label: 'Internal Provider' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up MCP access for all providers\n\t\tqueryService.provider('github').account('user@github.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal1').account('internal@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\n\t\t// Test MCP server query - should include internal providers when requested\n\t\tconst mcpServerQuery = queryService.mcpServer('my-server');\n\t\tconst providersWithAccess = await mcpServerQuery.getProvidersWithAccess(true);\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('__internal1'));\n\t});\n\n\ttest('internal provider filtering works with mixed access patterns', async () => {\n\t\t// Register mixed providers\n\t\tconst normalProvider = createProvider({ id: 'normal', label: 'Normal Provider' });\n\t\tconst internalProvider = createProvider({ id: '__internal', label: 'Internal Provider' });\n\t\tconst noAccessProvider = createProvider({ id: 'no-access', label: 'No Access Provider' });\n\n\t\tauthService.registerAuthenticationProvider('normal', normalProvider);\n\t\tauthService.registerAuthenticationProvider('__internal', internalProvider);\n\t\tauthService.registerAuthenticationProvider('no-access', noAccessProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('normal', [{ id: 'user1', label: 'user@normal.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\t\tauthService.addAccounts('no-access', [{ id: 'user3', label: 'user@noaccess.com' }]);\n\n\t\t// Set up access only for normal and internal providers\n\t\tqueryService.provider('normal').account('user@normal.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\t// Note: no-access provider deliberately has no access set\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Without includeInternal: should only return normal provider\n\t\tconst providersWithoutInternal = await extensionQuery.getProvidersWithAccess(false);\n\t\tassert.strictEqual(providersWithoutInternal.length, 1);\n\t\tassert.ok(providersWithoutInternal.includes('normal'));\n\t\tassert.ok(!providersWithoutInternal.includes('__internal'));\n\t\tassert.ok(!providersWithoutInternal.includes('no-access'));\n\n\t\t// With includeInternal: should return both normal and internal\n\t\tconst providersWithInternal = await extensionQuery.getProvidersWithAccess(true);\n\t\tassert.strictEqual(providersWithInternal.length, 2);\n\t\tassert.ok(providersWithInternal.includes('normal'));\n\t\tassert.ok(providersWithInternal.includes('__internal'));\n\t\tassert.ok(!providersWithInternal.includes('no-access'));\n\t});\n\n\ttest('internal provider filtering respects the __ prefix exactly', async () => {\n\t\t// Register providers with various naming patterns\n\t\tconst regularProvider = createProvider({ id: 'regular', label: 'Regular Provider' });\n\t\tconst underscoreProvider = createProvider({ id: '_single', label: 'Single Underscore Provider' });\n\t\tconst doubleUnderscoreProvider = createProvider({ id: '__double', label: 'Double Underscore Provider' });\n\t\tconst tripleUnderscoreProvider = createProvider({ id: '___triple', label: 'Triple Underscore Provider' });\n\t\tconst underscoreInMiddleProvider = createProvider({ id: 'mid_underscore', label: 'Middle Underscore Provider' });\n\n\t\tauthService.registerAuthenticationProvider('regular', regularProvider);\n\t\tauthService.registerAuthenticationProvider('_single', underscoreProvider);\n\t\tauthService.registerAuthenticationProvider('__double', doubleUnderscoreProvider);\n\t\tauthService.registerAuthenticationProvider('___triple', tripleUnderscoreProvider);\n\t\tauthService.registerAuthenticationProvider('mid_underscore', underscoreInMiddleProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('regular', [{ id: 'user1', label: 'user@regular.com' }]);\n\t\tauthService.addAccounts('_single', [{ id: 'user2', label: 'user@single.com' }]);\n\t\tauthService.addAccounts('__double', [{ id: 'user3', label: 'user@double.com' }]);\n\t\tauthService.addAccounts('___triple', [{ id: 'user4', label: 'user@triple.com' }]);\n\t\tauthService.addAccounts('mid_underscore', [{ id: 'user5', label: 'user@middle.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('regular').account('user@regular.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('_single').account('user@single.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__double').account('user@double.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('___triple').account('user@triple.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('mid_underscore').account('user@middle.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Without includeInternal: should exclude only providers starting with exactly \"__\"\n\t\tconst providersWithoutInternal = await extensionQuery.getProvidersWithAccess(false);\n\t\tassert.strictEqual(providersWithoutInternal.length, 3);\n\t\tassert.ok(providersWithoutInternal.includes('regular'));\n\t\tassert.ok(providersWithoutInternal.includes('_single'));\n\t\tassert.ok(!providersWithoutInternal.includes('__double'));\n\t\tassert.ok(!providersWithoutInternal.includes('___triple')); // This starts with __, so should be filtered\n\t\tassert.ok(providersWithoutInternal.includes('mid_underscore'));\n\n\t\t// With includeInternal: should include all providers\n\t\tconst providersWithInternal = await extensionQuery.getProvidersWithAccess(true);\n\t\tassert.strictEqual(providersWithInternal.length, 5);\n\t\tassert.ok(providersWithInternal.includes('regular'));\n\t\tassert.ok(providersWithInternal.includes('_single'));\n\t\tassert.ok(providersWithInternal.includes('__double'));\n\t\tassert.ok(providersWithInternal.includes('___triple'));\n\t\tassert.ok(providersWithInternal.includes('mid_underscore'));\n\t});\n\n\ttest('getAllAccountPreferences filters internal providers by default for extensions', () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('azure', createProvider({ id: 'azure', label: 'Azure' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Set preferences\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@github.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'user@azure.com' });\n\t\textensionQuery.provider('__internal').setPreferredAccount({ id: 'user3', label: 'internal@example.com' });\n\n\t\t// Without includeInternal: should exclude internal providers\n\t\tconst prefsWithoutInternal = extensionQuery.getAllAccountPreferences(false);\n\t\tassert.strictEqual(prefsWithoutInternal.size, 2);\n\t\tassert.strictEqual(prefsWithoutInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('__internal'), undefined);\n\n\t\t// With includeInternal: should include all providers\n\t\tconst prefsWithInternal = extensionQuery.getAllAccountPreferences(true);\n\t\tassert.strictEqual(prefsWithInternal.size, 3);\n\t\tassert.strictEqual(prefsWithInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithInternal.get('__internal'), 'internal@example.com');\n\n\t\t// Default behavior: should exclude internal providers\n\t\tconst prefsDefault = extensionQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(prefsDefault.size, 2);\n\t\tassert.strictEqual(prefsDefault.get('__internal'), undefined);\n\t});\n\n\ttest('getAllAccountPreferences filters internal providers by default for MCP servers', () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('azure', createProvider({ id: 'azure', label: 'Azure' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Set preferences\n\t\tconst mcpQuery = queryService.mcpServer('my-server');\n\t\tmcpQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@github.com' });\n\t\tmcpQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'user@azure.com' });\n\t\tmcpQuery.provider('__internal').setPreferredAccount({ id: 'user3', label: 'internal@example.com' });\n\n\t\t// Without includeInternal: should exclude internal providers\n\t\tconst prefsWithoutInternal = mcpQuery.getAllAccountPreferences(false);\n\t\tassert.strictEqual(prefsWithoutInternal.size, 2);\n\t\tassert.strictEqual(prefsWithoutInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('__internal'), undefined);\n\n\t\t// With includeInternal: should include all providers\n\t\tconst prefsWithInternal = mcpQuery.getAllAccountPreferences(true);\n\t\tassert.strictEqual(prefsWithInternal.size, 3);\n\t\tassert.strictEqual(prefsWithInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithInternal.get('__internal'), 'internal@example.com');\n\n\t\t// Default behavior: should exclude internal providers\n\t\tconst prefsDefault = mcpQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(prefsDefault.size, 2);\n\t\tassert.strictEqual(prefsDefault.get('__internal'), undefined);\n\t});\n\n\ttest('clearAllData includes internal providers by default', async () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Add accounts\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up some data\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Verify data exists\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), true);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), true);\n\n\t\t// Clear all data (should include internal providers by default)\n\t\tawait queryService.clearAllData('CLEAR_ALL_AUTH_DATA');\n\n\t\t// Verify all data is cleared\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), undefined);\n\t});\n\n\ttest('clearAllData can exclude internal providers when specified', async () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Add accounts\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up some data\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Clear data excluding internal providers\n\t\tawait queryService.clearAllData('CLEAR_ALL_AUTH_DATA', false);\n\n\t\t// Verify only non-internal data is cleared\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), true);\n\t});\n\n\ttest('isTrusted method works with mock service', () => {\n\t\t// Register provider and add account\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\n\t\t// Add a server with trusted state manually to the mock\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [{\n\t\t\tid: 'trusted-server',\n\t\t\tname: 'Trusted Server',\n\t\t\tallowed: true,\n\t\t\ttrusted: true\n\t\t}]);\n\n\t\t// Add a non-trusted server\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [{\n\t\t\tid: 'non-trusted-server',\n\t\t\tname: 'Non-Trusted Server',\n\t\t\tallowed: true\n\t\t}]);\n\n\t\t// Test trusted server\n\t\tconst trustedQuery = queryService.provider('github').account('user@github.com').mcpServer('trusted-server');\n\t\tassert.strictEqual(trustedQuery.isTrusted(), true);\n\n\t\t// Test non-trusted server\n\t\tconst nonTrustedQuery = queryService.provider('github').account('user@github.com').mcpServer('non-trusted-server');\n\t\tassert.strictEqual(nonTrustedQuery.isTrusted(), false);\n\t});\n\n\ttest('getAllowedMcpServers method returns servers with trusted state', () => {\n\t\t// Register provider and add account\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\n\t\t// Add servers manually to the mock\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [\n\t\t\t{\n\t\t\t\tid: 'trusted-server',\n\t\t\t\tname: 'Trusted Server',\n\t\t\t\tallowed: true,\n\t\t\t\ttrusted: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'user-server',\n\t\t\t\tname: 'User Server',\n\t\t\t\tallowed: true\n\t\t\t}\n\t\t]);\n\n\t\t// Get all allowed servers\n\t\tconst allowedServers = queryService.provider('github').account('user@github.com').mcpServers().getAllowedMcpServers();\n\n\t\t// Should have both servers\n\t\tassert.strictEqual(allowedServers.length, 2);\n\n\t\t// Find the trusted server\n\t\tconst trustedServer = allowedServers.find(s => s.id === 'trusted-server');\n\t\tassert.ok(trustedServer);\n\t\tassert.strictEqual(trustedServer.trusted, true);\n\t\tassert.strictEqual(trustedServer.allowed, true);\n\n\t\t// Find the user-allowed server\n\t\tconst userServer = allowedServers.find(s => s.id === 'user-server');\n\t\tassert.ok(userServer);\n\t\tassert.strictEqual(userServer.trusted, undefined);\n\t\tassert.strictEqual(userServer.allowed, true);\n\t});\n\n\ttest('getAllowedExtensions returns extension data with trusted state', () => {\n\t\t// Set up some extension access data\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension One');\n\n\t\tconst allowedExtensions = accountQuery.extensions().getAllowedExtensions();\n\n\t\t// Should have both extensions\n\t\tassert.strictEqual(allowedExtensions.length, 2);\n\n\t\t// Find the first extension\n\t\tconst ext1 = allowedExtensions.find(e => e.id === 'ext1');\n\t\tassert.ok(ext1);\n\t\tassert.strictEqual(ext1.name, 'Extension One');\n\t\tassert.strictEqual(ext1.allowed, true);\n\t\tassert.strictEqual(ext1.trusted, false); // Not in trusted list\n\t\tassert.ok(typeof ext1.lastUsed === 'number');\n\n\t\t// Find the second extension\n\t\tconst ext2 = allowedExtensions.find(e => e.id === 'ext2');\n\t\tassert.ok(ext2);\n\t\tassert.strictEqual(ext2.name, 'Extension Two');\n\t\tassert.strictEqual(ext2.allowed, true);\n\t\tassert.strictEqual(ext2.trusted, false); // Not in trusted list\n\t\tassert.strictEqual(ext2.lastUsed, undefined); // No usage\n\t});\n\n\tsuite('Account entities query', () => {\n\t\ttest('hasAnyUsage returns false for clean account', () => {\n\t\t\tconst entitiesQuery = queryService.provider('github').account('clean@example.com').entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), false);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when extension has usage', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.extension('test-ext').addUsage(['read'], 'Test Extension');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when MCP server has usage', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.mcpServer('test-server').addUsage(['write'], 'Test Server');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when extension has access', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.extension('test-ext').setAccessAllowed(true, 'Test Extension');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when MCP server has access', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.mcpServer('test-server').setAccessAllowed(true, 'Test Server');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('getEntityCount returns correct counts', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tconst counts = entitiesQuery.getEntityCount();\n\n\t\t\tassert.strictEqual(counts.extensions, 2);\n\t\t\tassert.strictEqual(counts.mcpServers, 1);\n\t\t\tassert.strictEqual(counts.total, 3);\n\t\t});\n\n\t\ttest('getEntityCount returns zero for clean account', () => {\n\t\t\tconst entitiesQuery = queryService.provider('github').account('clean@example.com').entities();\n\t\t\tconst counts = entitiesQuery.getEntityCount();\n\n\t\t\tassert.strictEqual(counts.extensions, 0);\n\t\t\tassert.strictEqual(counts.mcpServers, 0);\n\t\t\tassert.strictEqual(counts.total, 0);\n\t\t});\n\n\t\ttest('removeAllAccess removes access for all entity types', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\t\t\taccountQuery.mcpServer('server2').setAccessAllowed(true, 'Server Two');\n\n\t\t\t// Verify initial state\n\t\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.extension('ext2').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server1').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server2').isAccessAllowed(), true);\n\n\t\t\t// Remove all access\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tentitiesQuery.removeAllAccess();\n\n\t\t\t// Verify all access is removed\n\t\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.extension('ext2').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server1').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server2').isAccessAllowed(), false);\n\t\t});\n\n\t\ttest('forEach iterates over all entity types', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').addUsage(['read'], 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\t\t\taccountQuery.mcpServer('server2').addUsage(['write'], 'Server Two');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tconst visitedEntities: Array<{ id: string; type: 'extension' | 'mcpServer' }> = [];\n\n\t\t\tentitiesQuery.forEach((entityId, entityType) => {\n\t\t\t\tvisitedEntities.push({ id: entityId, type: entityType });\n\t\t\t});\n\n\t\t\t// Should visit all entities that have usage or access\n\t\t\tassert.strictEqual(visitedEntities.length, 4);\n\n\t\t\tconst extensions = visitedEntities.filter(e => e.type === 'extension');\n\t\t\tconst mcpServers = visitedEntities.filter(e => e.type === 'mcpServer');\n\n\t\t\tassert.strictEqual(extensions.length, 2);\n\t\t\tassert.strictEqual(mcpServers.length, 2);\n\n\t\t\t// Check specific entities were visited\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'ext1' && e.type === 'extension'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'ext2' && e.type === 'extension'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'server1' && e.type === 'mcpServer'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'server2' && e.type === 'mcpServer'));\n\t\t});\n\t});\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { TestInstantiationService } from '../../../../../platform/instantiation/test/common/instantiationServiceMock.js';\nimport { ILogService, NullLogService } from '../../../../../platform/log/common/log.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { TestStorageService } from '../../../../test/common/workbenchTestServices.js';\nimport { IAuthenticationQueryService } from '../../common/authenticationQuery.js';\nimport { AuthenticationQueryService } from '../../browser/authenticationQueryService.js';\nimport { IAuthenticationService, IAuthenticationExtensionsService } from '../../common/authentication.js';\nimport { IAuthenticationUsageService } from '../../browser/authenticationUsageService.js';\nimport { IAuthenticationMcpUsageService } from '../../browser/authenticationMcpUsageService.js';\nimport { IAuthenticationAccessService } from '../../browser/authenticationAccessService.js';\nimport { IAuthenticationMcpAccessService } from '../../browser/authenticationMcpAccessService.js';\nimport { IAuthenticationMcpService } from '../../browser/authenticationMcpService.js';\nimport {\n\tTestUsageService,\n\tTestMcpUsageService,\n\tTestAccessService,\n\tTestMcpAccessService,\n\tTestExtensionsService,\n\tTestMcpService,\n\tTestAuthenticationService,\n\tcreateProvider,\n} from './authenticationQueryServiceMocks.js';\n\n/**\n * Real integration tests for AuthenticationQueryService\n */\nsuite('AuthenticationQueryService Integration Tests', () => {\n\tconst disposables = ensureNoDisposablesAreLeakedInTestSuite();\n\n\tlet queryService: IAuthenticationQueryService;\n\tlet authService: TestAuthenticationService;\n\tlet usageService: TestUsageService;\n\tlet mcpUsageService: TestMcpUsageService;\n\tlet accessService: TestAccessService;\n\tlet mcpAccessService: TestMcpAccessService;\n\n\tsetup(() => {\n\t\tconst instantiationService = disposables.add(new TestInstantiationService());\n\n\t\t// Set up storage service\n\t\tconst storageService = disposables.add(new TestStorageService());\n\t\tinstantiationService.stub(IStorageService, storageService);\n\n\t\t// Set up log service\n\t\tinstantiationService.stub(ILogService, new NullLogService());\n\n\t\t// Create and register test services\n\t\tauthService = disposables.add(new TestAuthenticationService());\n\t\tinstantiationService.stub(IAuthenticationService, authService);\n\n\t\tusageService = disposables.add(new TestUsageService());\n\t\tmcpUsageService = disposables.add(new TestMcpUsageService());\n\t\taccessService = disposables.add(new TestAccessService());\n\t\tmcpAccessService = disposables.add(new TestMcpAccessService());\n\n\t\tinstantiationService.stub(IAuthenticationUsageService, usageService);\n\t\tinstantiationService.stub(IAuthenticationMcpUsageService, mcpUsageService);\n\t\tinstantiationService.stub(IAuthenticationAccessService, accessService);\n\t\tinstantiationService.stub(IAuthenticationMcpAccessService, mcpAccessService);\n\t\tinstantiationService.stub(IAuthenticationExtensionsService, disposables.add(new TestExtensionsService()));\n\t\tinstantiationService.stub(IAuthenticationMcpService, disposables.add(new TestMcpService()));\n\n\t\t// Create the query service\n\t\tqueryService = disposables.add(instantiationService.createInstance(AuthenticationQueryService));\n\t});\n\n\ttest('usage tracking stores and retrieves data correctly', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Initially no usage\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 0);\n\n\t\t// Add usage and verify it's stored\n\t\textensionQuery.addUsage(['read', 'write'], 'My Extension');\n\t\tconst usage = extensionQuery.getUsage();\n\t\tassert.strictEqual(usage.length, 1);\n\t\tassert.strictEqual(usage[0].extensionId, 'my-extension');\n\t\tassert.strictEqual(usage[0].extensionName, 'My Extension');\n\t\tassert.deepStrictEqual(usage[0].scopes, ['read', 'write']);\n\n\t\t// Add more usage and verify accumulation\n\t\textensionQuery.addUsage(['admin'], 'My Extension');\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 2);\n\t});\n\n\ttest('access control persists across queries', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Set access and verify\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\tassert.strictEqual(extensionQuery.isAccessAllowed(), true);\n\n\t\t// Create new query object for same target - should persist\n\t\tconst sameExtensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tassert.strictEqual(sameExtensionQuery.isAccessAllowed(), true);\n\n\t\t// Different extension should be unaffected\n\t\tconst otherExtensionQuery = queryService.provider('github').account('user@example.com').extension('other-extension');\n\t\tassert.strictEqual(otherExtensionQuery.isAccessAllowed(), undefined);\n\t});\n\n\ttest('account preferences work across services', () => {\n\t\tconst extensionQuery = queryService.provider('github').extension('my-extension');\n\t\tconst mcpQuery = queryService.provider('github').mcpServer('my-server');\n\n\t\t// Set preferences for both\n\t\textensionQuery.setPreferredAccount({ id: 'user1', label: 'user@example.com' });\n\t\tmcpQuery.setPreferredAccount({ id: 'user2', label: 'admin@example.com' });\n\n\t\t// Verify different preferences are stored independently\n\t\tassert.strictEqual(extensionQuery.getPreferredAccount(), 'user@example.com');\n\t\tassert.strictEqual(mcpQuery.getPreferredAccount(), 'admin@example.com');\n\n\t\t// Test preference detection\n\t\tconst userExtensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tconst adminMcpQuery = queryService.provider('github').account('admin@example.com').mcpServer('my-server');\n\n\t\tassert.strictEqual(userExtensionQuery.isPreferred(), true);\n\t\tassert.strictEqual(adminMcpQuery.isPreferred(), true);\n\n\t\t// Test non-preferred accounts\n\t\tconst wrongExtensionQuery = queryService.provider('github').account('wrong@example.com').extension('my-extension');\n\t\tassert.strictEqual(wrongExtensionQuery.isPreferred(), false);\n\t});\n\n\ttest('account removal cleans up all related data', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up data across multiple services\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['write'], 'MCP Server 1');\n\n\t\t// Verify data exists\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.extension('ext1').getUsage().length, 1);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').getUsage().length, 1);\n\n\t\t// Remove account\n\t\taccountQuery.remove();\n\n\t\t// Verify all data is cleaned up\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.extension('ext1').getUsage().length, 0);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').getUsage().length, 0);\n\t});\n\n\ttest('provider registration and listing works', () => {\n\t\t// Initially no providers\n\t\tassert.strictEqual(queryService.getProviderIds().length, 0);\n\n\t\t// Register a provider\n\t\tconst provider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tauthService.registerAuthenticationProvider('github', provider);\n\n\t\t// Verify provider is listed\n\t\tconst providerIds = queryService.getProviderIds();\n\t\tassert.ok(providerIds.includes('github'));\n\t\tassert.strictEqual(authService.isAuthenticationProviderRegistered('github'), true);\n\t});\n\n\ttest('MCP usage and access work independently from extensions', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\tconst mcpQuery = queryService.provider('github').account('user@example.com').mcpServer('my-server');\n\n\t\t// Set up data for both\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery.addUsage(['read'], 'My Extension');\n\n\t\tmcpQuery.setAccessAllowed(false, 'My Server');\n\t\tmcpQuery.addUsage(['write'], 'My Server');\n\n\t\t// Verify they're independent\n\t\tassert.strictEqual(extensionQuery.isAccessAllowed(), true);\n\t\tassert.strictEqual(mcpQuery.isAccessAllowed(), false);\n\n\t\tassert.strictEqual(extensionQuery.getUsage()[0].extensionId, 'my-extension');\n\t\tassert.strictEqual(mcpQuery.getUsage()[0].mcpServerId, 'my-server');\n\n\t\t// Verify no cross-contamination\n\t\tassert.strictEqual(extensionQuery.getUsage().length, 1);\n\t\tassert.strictEqual(mcpQuery.getUsage().length, 1);\n\t});\n\n\ttest('getAllAccountPreferences returns synchronously', () => {\n\t\t// Register providers for the test\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst mcpQuery = queryService.mcpServer('my-server');\n\n\t\t// Set preferences for different providers\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'github-user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'azure-user@example.com' });\n\t\tmcpQuery.provider('github').setPreferredAccount({ id: 'user3', label: 'github-mcp@example.com' });\n\n\t\t// Get all preferences synchronously (no await needed)\n\t\tconst extensionPreferences = extensionQuery.getAllAccountPreferences();\n\t\tconst mcpPreferences = mcpQuery.getAllAccountPreferences();\n\n\t\t// Verify extension preferences\n\t\tassert.strictEqual(extensionPreferences.get('github'), 'github-user@example.com');\n\t\tassert.strictEqual(extensionPreferences.get('azure'), 'azure-user@example.com');\n\t\tassert.strictEqual(extensionPreferences.size, 2);\n\n\t\t// Verify MCP preferences\n\t\tassert.strictEqual(mcpPreferences.get('github'), 'github-mcp@example.com');\n\t\tassert.strictEqual(mcpPreferences.size, 1);\n\n\t\t// Verify they don't interfere with each other\n\t\tassert.notStrictEqual(extensionPreferences.get('github'), mcpPreferences.get('github'));\n\t});\n\n\ttest('forEach methods work synchronously', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Add some usage data first\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.extension('ext2').addUsage(['write'], 'Extension 2');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['admin'], 'MCP Server 1');\n\n\t\t// Test extensions forEach - no await needed\n\t\tconst extensionIds: string[] = [];\n\t\taccountQuery.extensions().forEach(extensionQuery => {\n\t\t\textensionIds.push(extensionQuery.extensionId);\n\t\t});\n\n\t\tassert.strictEqual(extensionIds.length, 2);\n\t\tassert.ok(extensionIds.includes('ext1'));\n\t\tassert.ok(extensionIds.includes('ext2'));\n\n\t\t// Test MCP servers forEach - no await needed\n\t\tconst mcpServerIds: string[] = [];\n\t\taccountQuery.mcpServers().forEach(mcpServerQuery => {\n\t\t\tmcpServerIds.push(mcpServerQuery.mcpServerId);\n\t\t});\n\n\t\tassert.strictEqual(mcpServerIds.length, 1);\n\t\tassert.ok(mcpServerIds.includes('mcp1'));\n\t});\n\n\ttest('remove method works synchronously', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up data\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\n\t\t// Remove synchronously - no await needed\n\t\taccountQuery.remove();\n\n\t\t// Verify data is gone\n\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(accountQuery.mcpServer('mcp1').isAccessAllowed(), undefined);\n\t});\n\n\ttest('cross-provider extension queries work correctly', () => {\n\t\t// Register multiple providers\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\t// Set up data using provider-first approach\n\t\tqueryService.provider('github').account('user@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('azure').account('admin@example.com').extension('my-extension').setAccessAllowed(false, 'My Extension');\n\n\t\t// Query using extension-first approach should return all providers\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst githubPrefs = extensionQuery.getAllAccountPreferences();\n\n\t\t// Should include both providers\n\t\tassert.ok(githubPrefs.size >= 0); // Extension query should work across providers\n\n\t\t// Test preferences using extension-first query pattern\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'admin@example.com' });\n\n\t\tassert.strictEqual(extensionQuery.provider('github').getPreferredAccount(), 'user@example.com');\n\t\tassert.strictEqual(extensionQuery.provider('azure').getPreferredAccount(), 'admin@example.com');\n\t});\n\n\ttest('event forwarding from authentication service works', () => {\n\t\tlet eventFired = false;\n\n\t\t// Listen for access change events through the query service\n\t\tconst disposable = queryService.onDidChangeAccess(() => {\n\t\t\teventFired = true;\n\t\t});\n\n\t\ttry {\n\t\t\t// Trigger an access change that should fire an event\n\t\t\tqueryService.provider('github').account('user@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t\t// Verify the event was fired\n\t\t\tassert.strictEqual(eventFired, true);\n\t\t} finally {\n\t\t\tdisposable.dispose();\n\t\t}\n\t});\n\n\ttest('error handling for invalid inputs works correctly', () => {\n\t\t// Test with non-existent provider\n\t\tconst invalidProviderQuery = queryService.provider('non-existent-provider');\n\n\t\t// Should not throw, but should handle gracefully\n\t\tassert.doesNotThrow(() => {\n\t\t\tinvalidProviderQuery.account('user@example.com').extension('my-extension').isAccessAllowed();\n\t\t});\n\n\t\t// Test with empty/invalid account names\n\t\tconst emptyAccountQuery = queryService.provider('github').account('').extension('my-extension');\n\t\tassert.doesNotThrow(() => {\n\t\t\temptyAccountQuery.isAccessAllowed();\n\t\t});\n\n\t\t// Test with empty extension IDs\n\t\tconst emptyExtensionQuery = queryService.provider('github').account('user@example.com').extension('');\n\t\tassert.doesNotThrow(() => {\n\t\t\temptyExtensionQuery.isAccessAllowed();\n\t\t});\n\t});\n\n\ttest('bulk operations work correctly', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up multiple extensions with different access levels\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext2').setAccessAllowed(false, 'Extension 2');\n\t\taccountQuery.extension('ext3').setAccessAllowed(true, 'Extension 3');\n\n\t\t// Add usage for some extensions\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.extension('ext3').addUsage(['write'], 'Extension 3');\n\n\t\t// Test bulk enumeration\n\t\tlet extensionCount = 0;\n\t\tlet allowedCount = 0;\n\t\tlet usageCount = 0;\n\n\t\taccountQuery.extensions().forEach(extensionQuery => {\n\t\t\textensionCount++;\n\t\t\tif (extensionQuery.isAccessAllowed() === true) {\n\t\t\t\tallowedCount++;\n\t\t\t}\n\t\t\tif (extensionQuery.getUsage().length > 0) {\n\t\t\t\tusageCount++;\n\t\t\t}\n\t\t});\n\n\t\t// Verify bulk operation results\n\t\tassert.strictEqual(extensionCount, 3);\n\t\tassert.strictEqual(allowedCount, 2); // ext1 and ext3\n\t\tassert.strictEqual(usageCount, 2); // ext1 and ext3\n\n\t\t// Test bulk operations for MCP servers\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP 1');\n\t\taccountQuery.mcpServer('mcp2').setAccessAllowed(false, 'MCP 2');\n\n\t\tlet mcpCount = 0;\n\t\taccountQuery.mcpServers().forEach(mcpQuery => {\n\t\t\tmcpCount++;\n\t\t});\n\n\t\tassert.strictEqual(mcpCount, 2);\n\t});\n\n\ttest('data consistency across different query paths', () => {\n\t\t// Set up data using one query path\n\t\tconst extensionQuery1 = queryService.provider('github').account('user@example.com').extension('my-extension');\n\t\textensionQuery1.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery1.addUsage(['read', 'write'], 'My Extension');\n\n\t\t// Access same data using different query path (cross-provider query)\n\t\tconst extensionQuery2 = queryService.extension('my-extension').provider('github');\n\n\t\t// Data should be consistent through provider preference access\n\t\tassert.strictEqual(extensionQuery1.isAccessAllowed(), true);\n\t\tassert.strictEqual(extensionQuery1.getUsage().length, 1);\n\n\t\t// Set preferences and check consistency\n\t\textensionQuery2.setPreferredAccount({ id: 'user', label: 'user@example.com' });\n\t\tassert.strictEqual(extensionQuery2.getPreferredAccount(), 'user@example.com');\n\n\t\t// Modify through one path\n\t\textensionQuery1.setAccessAllowed(false, 'My Extension');\n\n\t\t// Should be reflected when accessing through provider->account path\n\t\tassert.strictEqual(extensionQuery1.isAccessAllowed(), false);\n\t});\n\n\ttest('preference management handles complex scenarios', () => {\n\t\t// Register multiple providers\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Set different preferences for different providers\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'github-user@example.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'azure-user@example.com' });\n\n\t\t// Test preference retrieval\n\t\tassert.strictEqual(extensionQuery.provider('github').getPreferredAccount(), 'github-user@example.com');\n\t\tassert.strictEqual(extensionQuery.provider('azure').getPreferredAccount(), 'azure-user@example.com');\n\n\t\t// Test account preference detection through provider->account queries\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('github').account('github-user@example.com').extension('my-extension').isPreferred(),\n\t\t\ttrue\n\t\t);\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('azure').account('azure-user@example.com').extension('my-extension').isPreferred(),\n\t\t\ttrue\n\t\t);\n\t\tassert.strictEqual(\n\t\t\tqueryService.provider('github').account('wrong@example.com').extension('my-extension').isPreferred(),\n\t\t\tfalse\n\t\t);\n\n\t\t// Test getAllAccountPreferences with multiple providers\n\t\tconst allPrefs = extensionQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(allPrefs.get('github'), 'github-user@example.com');\n\t\tassert.strictEqual(allPrefs.get('azure'), 'azure-user@example.com');\n\t\tassert.strictEqual(allPrefs.size, 2);\n\t});\n\n\ttest('MCP server vs extension data isolation is complete', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up similar data for extension and MCP server with same IDs\n\t\tconst sameId = 'same-identifier';\n\t\taccountQuery.extension(sameId).setAccessAllowed(true, 'Extension');\n\t\taccountQuery.extension(sameId).addUsage(['ext-scope'], 'Extension');\n\n\t\taccountQuery.mcpServer(sameId).setAccessAllowed(false, 'MCP Server');\n\t\taccountQuery.mcpServer(sameId).addUsage(['mcp-scope'], 'MCP Server');\n\n\t\t// Verify complete isolation\n\t\tassert.strictEqual(accountQuery.extension(sameId).isAccessAllowed(), true);\n\t\tassert.strictEqual(accountQuery.mcpServer(sameId).isAccessAllowed(), false);\n\n\t\tconst extUsage = accountQuery.extension(sameId).getUsage();\n\t\tconst mcpUsage = accountQuery.mcpServer(sameId).getUsage();\n\n\t\tassert.strictEqual(extUsage.length, 1);\n\t\tassert.strictEqual(mcpUsage.length, 1);\n\t\tassert.strictEqual(extUsage[0].extensionId, sameId);\n\t\tassert.strictEqual(mcpUsage[0].mcpServerId, sameId);\n\t\tassert.notDeepStrictEqual(extUsage[0].scopes, mcpUsage[0].scopes);\n\n\t\t// Test preference isolation\n\t\tqueryService.extension(sameId).provider('github').setPreferredAccount({ id: 'ext-user', label: 'ext@example.com' });\n\t\tqueryService.mcpServer(sameId).provider('github').setPreferredAccount({ id: 'mcp-user', label: 'mcp@example.com' });\n\n\t\tassert.strictEqual(queryService.extension(sameId).provider('github').getPreferredAccount(), 'ext@example.com');\n\t\tassert.strictEqual(queryService.mcpServer(sameId).provider('github').getPreferredAccount(), 'mcp@example.com');\n\t});\n\n\ttest('provider listing and registration integration', () => {\n\t\t// Initially should have providers from setup (if any)\n\t\tconst initialProviders = queryService.getProviderIds();\n\t\tconst initialCount = initialProviders.length;\n\n\t\t// Register a new provider\n\t\tconst newProvider = createProvider({ id: 'test-provider', label: 'Test Provider' });\n\t\tauthService.registerAuthenticationProvider('test-provider', newProvider);\n\n\t\t// Should now appear in listing\n\t\tconst updatedProviders = queryService.getProviderIds();\n\t\tassert.strictEqual(updatedProviders.length, initialCount + 1);\n\t\tassert.ok(updatedProviders.includes('test-provider'));\n\n\t\t// Should be able to query the new provider\n\t\tconst providerQuery = queryService.provider('test-provider');\n\t\tassert.strictEqual(providerQuery.providerId, 'test-provider');\n\n\t\t// Should integrate with authentication service state\n\t\tassert.strictEqual(authService.isAuthenticationProviderRegistered('test-provider'), true);\n\t});\n\n\t/**\n\t * Service Call Verification Tests\n\t * These tests verify that the AuthenticationQueryService properly delegates to underlying services\n\t * with the correct parameters. This is important for ensuring the facade works correctly.\n\t */\n\ttest('setAccessAllowed calls updateAllowedExtensions with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\taccessService.clearCallHistory();\n\n\t\t// Call setAccessAllowed\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = accessService.getCallsFor('updateAllowedExtensions');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, extensions] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(extensions.length, 1);\n\t\tassert.strictEqual(extensions[0].id, 'my-extension');\n\t\tassert.strictEqual(extensions[0].name, 'My Extension');\n\t\tassert.strictEqual(extensions[0].allowed, true);\n\t});\n\n\ttest('addUsage calls addAccountUsage with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('azure').account('admin@company.com').extension('test-extension');\n\n\t\t// Clear any previous calls\n\t\tusageService.clearCallHistory();\n\n\t\t// Call addUsage\n\t\textensionQuery.addUsage(['read', 'write'], 'Test Extension');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = usageService.getCallsFor('addAccountUsage');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, scopes, extensionId, extensionName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'azure');\n\t\tassert.strictEqual(accountName, 'admin@company.com');\n\t\tassert.deepStrictEqual(scopes, ['read', 'write']);\n\t\tassert.strictEqual(extensionId, 'test-extension');\n\t\tassert.strictEqual(extensionName, 'Test Extension');\n\t});\n\n\ttest('isAccessAllowed calls underlying service with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\taccessService.clearCallHistory();\n\n\t\t// Call isAccessAllowed\n\t\textensionQuery.isAccessAllowed();\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = accessService.getCallsFor('isAccessAllowed');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, extensionId] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(extensionId, 'my-extension');\n\t});\n\n\ttest('getUsage calls readAccountUsages with correct parameters', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear any previous calls\n\t\tusageService.clearCallHistory();\n\n\t\t// Call getUsage\n\t\textensionQuery.getUsage();\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = usageService.getCallsFor('readAccountUsages');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t});\n\n\ttest('MCP setAccessAllowed calls updateAllowedMcpServers with correct parameters', () => {\n\t\tconst mcpQuery = queryService.provider('github').account('user@example.com').mcpServer('my-server');\n\n\t\t// Clear any previous calls\n\t\tmcpAccessService.clearCallHistory();\n\n\t\t// Call setAccessAllowed\n\t\tmcpQuery.setAccessAllowed(false, 'My MCP Server');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = mcpAccessService.getCallsFor('updateAllowedMcpServers');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, servers] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'github');\n\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\tassert.strictEqual(servers.length, 1);\n\t\tassert.strictEqual(servers[0].id, 'my-server');\n\t\tassert.strictEqual(servers[0].name, 'My MCP Server');\n\t\tassert.strictEqual(servers[0].allowed, false);\n\t});\n\n\ttest('MCP addUsage calls addAccountUsage with correct parameters', () => {\n\t\tconst mcpQuery = queryService.provider('azure').account('admin@company.com').mcpServer('test-server');\n\n\t\t// Clear any previous calls\n\t\tmcpUsageService.clearCallHistory();\n\n\t\t// Call addUsage\n\t\tmcpQuery.addUsage(['admin'], 'Test MCP Server');\n\n\t\t// Verify the underlying service was called correctly\n\t\tconst calls = mcpUsageService.getCallsFor('addAccountUsage');\n\t\tassert.strictEqual(calls.length, 1);\n\n\t\tconst [providerId, accountName, scopes, serverId, serverName] = calls[0].args;\n\t\tassert.strictEqual(providerId, 'azure');\n\t\tassert.strictEqual(accountName, 'admin@company.com');\n\t\tassert.deepStrictEqual(scopes, ['admin']);\n\t\tassert.strictEqual(serverId, 'test-server');\n\t\tassert.strictEqual(serverName, 'Test MCP Server');\n\t});\n\n\ttest('account removal calls all appropriate cleanup methods', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up some data first\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension 1');\n\t\taccountQuery.mcpServer('mcp1').setAccessAllowed(true, 'MCP Server 1');\n\t\taccountQuery.mcpServer('mcp1').addUsage(['write'], 'MCP Server 1');\n\n\t\t// Clear call history to focus on removal calls\n\t\tusageService.clearCallHistory();\n\t\tmcpUsageService.clearCallHistory();\n\t\taccessService.clearCallHistory();\n\t\tmcpAccessService.clearCallHistory();\n\n\t\t// Call remove\n\t\taccountQuery.remove();\n\n\t\t// Verify all cleanup methods were called\n\t\tconst extensionUsageRemoval = usageService.getCallsFor('removeAccountUsage');\n\t\tconst mcpUsageRemoval = mcpUsageService.getCallsFor('removeAccountUsage');\n\t\tconst extensionAccessRemoval = accessService.getCallsFor('removeAllowedExtensions');\n\t\tconst mcpAccessRemoval = mcpAccessService.getCallsFor('removeAllowedMcpServers');\n\n\t\tassert.strictEqual(extensionUsageRemoval.length, 1);\n\t\tassert.strictEqual(mcpUsageRemoval.length, 1);\n\t\tassert.strictEqual(extensionAccessRemoval.length, 1);\n\t\tassert.strictEqual(mcpAccessRemoval.length, 1);\n\n\t\t// Verify all calls use correct parameters\n\t\t[extensionUsageRemoval[0], mcpUsageRemoval[0], extensionAccessRemoval[0], mcpAccessRemoval[0]].forEach(call => {\n\t\t\tconst [providerId, accountName] = call.args;\n\t\t\tassert.strictEqual(providerId, 'github');\n\t\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\t});\n\t});\n\n\ttest('bulk operations call readAccountUsages and readAllowedExtensions', () => {\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t// Set up some data\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension 1');\n\t\taccountQuery.extension('ext2').addUsage(['read'], 'Extension 2');\n\n\t\t// Clear call history\n\t\tusageService.clearCallHistory();\n\t\taccessService.clearCallHistory();\n\n\t\t// Perform bulk operation\n\t\taccountQuery.extensions().forEach(() => {\n\t\t\t// Just iterate to trigger the underlying service calls\n\t\t});\n\n\t\t// Verify the underlying services were called for bulk enumeration\n\t\tconst usageCalls = usageService.getCallsFor('readAccountUsages');\n\t\tconst accessCalls = accessService.getCallsFor('readAllowedExtensions');\n\n\t\tassert.strictEqual(usageCalls.length, 1);\n\t\tassert.strictEqual(accessCalls.length, 1);\n\n\t\t// Verify parameters\n\t\tusageCalls.concat(accessCalls).forEach(call => {\n\t\t\tconst [providerId, accountName] = call.args;\n\t\t\tassert.strictEqual(providerId, 'github');\n\t\t\tassert.strictEqual(accountName, 'user@example.com');\n\t\t});\n\t});\n\n\ttest('multiple operations accumulate service calls correctly', () => {\n\t\tconst extensionQuery = queryService.provider('github').account('user@example.com').extension('my-extension');\n\n\t\t// Clear call history\n\t\taccessService.clearCallHistory();\n\t\tusageService.clearCallHistory();\n\n\t\t// Perform multiple operations\n\t\textensionQuery.setAccessAllowed(true, 'My Extension');\n\t\textensionQuery.addUsage(['read'], 'My Extension');\n\t\textensionQuery.isAccessAllowed();\n\t\textensionQuery.getUsage();\n\t\textensionQuery.setAccessAllowed(false, 'My Extension');\n\n\t\t// Verify call counts\n\t\tassert.strictEqual(accessService.getCallsFor('updateAllowedExtensions').length, 2);\n\t\tassert.strictEqual(accessService.getCallsFor('isAccessAllowed').length, 1);\n\t\tassert.strictEqual(usageService.getCallsFor('addAccountUsage').length, 1);\n\t\tassert.strictEqual(usageService.getCallsFor('readAccountUsages').length, 1);\n\t});\n\n\ttest('getProvidersWithAccess filters internal providers by default', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tconst internalProvider1 = createProvider({ id: '__internal1', label: 'Internal Provider 1' });\n\t\tconst internalProvider2 = createProvider({ id: '__internal2', label: 'Internal Provider 2' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider1);\n\t\tauthService.registerAuthenticationProvider('__internal2', internalProvider2);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('azure', [{ id: 'user2', label: 'user@azure.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user3', label: 'internal1@example.com' }]);\n\t\tauthService.addAccounts('__internal2', [{ id: 'user4', label: 'internal2@example.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('azure').account('user@azure.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal1').account('internal1@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal2').account('internal2@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Test extension query - should exclude internal providers by default\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst providersWithAccess = await extensionQuery.getProvidersWithAccess();\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('azure'));\n\t\tassert.ok(!providersWithAccess.includes('__internal1'));\n\t\tassert.ok(!providersWithAccess.includes('__internal2'));\n\t});\n\n\ttest('getProvidersWithAccess includes internal providers when requested', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst internalProvider = createProvider({ id: '__internal1', label: 'Internal Provider' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal1').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Test extension query - should include internal providers when requested\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\tconst providersWithAccess = await extensionQuery.getProvidersWithAccess(true);\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('__internal1'));\n\t});\n\n\ttest('MCP server getProvidersWithAccess filters internal providers by default', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst azureProvider = createProvider({ id: 'azure', label: 'Azure' });\n\t\tconst internalProvider1 = createProvider({ id: '__internal1', label: 'Internal Provider 1' });\n\t\tconst internalProvider2 = createProvider({ id: '__internal2', label: 'Internal Provider 2' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('azure', azureProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider1);\n\t\tauthService.registerAuthenticationProvider('__internal2', internalProvider2);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('azure', [{ id: 'user2', label: 'user@azure.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user3', label: 'internal1@example.com' }]);\n\t\tauthService.addAccounts('__internal2', [{ id: 'user4', label: 'internal2@example.com' }]);\n\n\t\t// Set up MCP access for all providers\n\t\tqueryService.provider('github').account('user@github.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('azure').account('user@azure.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal1').account('internal1@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal2').account('internal2@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\n\t\t// Test MCP server query - should exclude internal providers by default\n\t\tconst mcpServerQuery = queryService.mcpServer('my-server');\n\t\tconst providersWithAccess = await mcpServerQuery.getProvidersWithAccess();\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('azure'));\n\t\tassert.ok(!providersWithAccess.includes('__internal1'));\n\t\tassert.ok(!providersWithAccess.includes('__internal2'));\n\t});\n\n\ttest('MCP server getProvidersWithAccess includes internal providers when requested', async () => {\n\t\t// Register multiple providers including internal ones\n\t\tconst githubProvider = createProvider({ id: 'github', label: 'GitHub' });\n\t\tconst internalProvider = createProvider({ id: '__internal1', label: 'Internal Provider' });\n\n\t\tauthService.registerAuthenticationProvider('github', githubProvider);\n\t\tauthService.registerAuthenticationProvider('__internal1', internalProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal1', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up MCP access for all providers\n\t\tqueryService.provider('github').account('user@github.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\t\tqueryService.provider('__internal1').account('internal@example.com').mcpServer('my-server').setAccessAllowed(true, 'My Server');\n\n\t\t// Test MCP server query - should include internal providers when requested\n\t\tconst mcpServerQuery = queryService.mcpServer('my-server');\n\t\tconst providersWithAccess = await mcpServerQuery.getProvidersWithAccess(true);\n\n\t\tassert.strictEqual(providersWithAccess.length, 2);\n\t\tassert.ok(providersWithAccess.includes('github'));\n\t\tassert.ok(providersWithAccess.includes('__internal1'));\n\t});\n\n\ttest('internal provider filtering works with mixed access patterns', async () => {\n\t\t// Register mixed providers\n\t\tconst normalProvider = createProvider({ id: 'normal', label: 'Normal Provider' });\n\t\tconst internalProvider = createProvider({ id: '__internal', label: 'Internal Provider' });\n\t\tconst noAccessProvider = createProvider({ id: 'no-access', label: 'No Access Provider' });\n\n\t\tauthService.registerAuthenticationProvider('normal', normalProvider);\n\t\tauthService.registerAuthenticationProvider('__internal', internalProvider);\n\t\tauthService.registerAuthenticationProvider('no-access', noAccessProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('normal', [{ id: 'user1', label: 'user@normal.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\t\tauthService.addAccounts('no-access', [{ id: 'user3', label: 'user@noaccess.com' }]);\n\n\t\t// Set up access only for normal and internal providers\n\t\tqueryService.provider('normal').account('user@normal.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\t// Note: no-access provider deliberately has no access set\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Without includeInternal: should only return normal provider\n\t\tconst providersWithoutInternal = await extensionQuery.getProvidersWithAccess(false);\n\t\tassert.strictEqual(providersWithoutInternal.length, 1);\n\t\tassert.ok(providersWithoutInternal.includes('normal'));\n\t\tassert.ok(!providersWithoutInternal.includes('__internal'));\n\t\tassert.ok(!providersWithoutInternal.includes('no-access'));\n\n\t\t// With includeInternal: should return both normal and internal\n\t\tconst providersWithInternal = await extensionQuery.getProvidersWithAccess(true);\n\t\tassert.strictEqual(providersWithInternal.length, 2);\n\t\tassert.ok(providersWithInternal.includes('normal'));\n\t\tassert.ok(providersWithInternal.includes('__internal'));\n\t\tassert.ok(!providersWithInternal.includes('no-access'));\n\t});\n\n\ttest('internal provider filtering respects the __ prefix exactly', async () => {\n\t\t// Register providers with various naming patterns\n\t\tconst regularProvider = createProvider({ id: 'regular', label: 'Regular Provider' });\n\t\tconst underscoreProvider = createProvider({ id: '_single', label: 'Single Underscore Provider' });\n\t\tconst doubleUnderscoreProvider = createProvider({ id: '__double', label: 'Double Underscore Provider' });\n\t\tconst tripleUnderscoreProvider = createProvider({ id: '___triple', label: 'Triple Underscore Provider' });\n\t\tconst underscoreInMiddleProvider = createProvider({ id: 'mid_underscore', label: 'Middle Underscore Provider' });\n\n\t\tauthService.registerAuthenticationProvider('regular', regularProvider);\n\t\tauthService.registerAuthenticationProvider('_single', underscoreProvider);\n\t\tauthService.registerAuthenticationProvider('__double', doubleUnderscoreProvider);\n\t\tauthService.registerAuthenticationProvider('___triple', tripleUnderscoreProvider);\n\t\tauthService.registerAuthenticationProvider('mid_underscore', underscoreInMiddleProvider);\n\n\t\t// Add accounts to all providers\n\t\tauthService.addAccounts('regular', [{ id: 'user1', label: 'user@regular.com' }]);\n\t\tauthService.addAccounts('_single', [{ id: 'user2', label: 'user@single.com' }]);\n\t\tauthService.addAccounts('__double', [{ id: 'user3', label: 'user@double.com' }]);\n\t\tauthService.addAccounts('___triple', [{ id: 'user4', label: 'user@triple.com' }]);\n\t\tauthService.addAccounts('mid_underscore', [{ id: 'user5', label: 'user@middle.com' }]);\n\n\t\t// Set up access for all providers\n\t\tqueryService.provider('regular').account('user@regular.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('_single').account('user@single.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__double').account('user@double.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('___triple').account('user@triple.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('mid_underscore').account('user@middle.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\n\t\t// Without includeInternal: should exclude only providers starting with exactly \"__\"\n\t\tconst providersWithoutInternal = await extensionQuery.getProvidersWithAccess(false);\n\t\tassert.strictEqual(providersWithoutInternal.length, 3);\n\t\tassert.ok(providersWithoutInternal.includes('regular'));\n\t\tassert.ok(providersWithoutInternal.includes('_single'));\n\t\tassert.ok(!providersWithoutInternal.includes('__double'));\n\t\tassert.ok(!providersWithoutInternal.includes('___triple')); // This starts with __, so should be filtered\n\t\tassert.ok(providersWithoutInternal.includes('mid_underscore'));\n\n\t\t// With includeInternal: should include all providers\n\t\tconst providersWithInternal = await extensionQuery.getProvidersWithAccess(true);\n\t\tassert.strictEqual(providersWithInternal.length, 5);\n\t\tassert.ok(providersWithInternal.includes('regular'));\n\t\tassert.ok(providersWithInternal.includes('_single'));\n\t\tassert.ok(providersWithInternal.includes('__double'));\n\t\tassert.ok(providersWithInternal.includes('___triple'));\n\t\tassert.ok(providersWithInternal.includes('mid_underscore'));\n\t});\n\n\ttest('getAllAccountPreferences filters internal providers by default for extensions', () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('azure', createProvider({ id: 'azure', label: 'Azure' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Set preferences\n\t\tconst extensionQuery = queryService.extension('my-extension');\n\t\textensionQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@github.com' });\n\t\textensionQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'user@azure.com' });\n\t\textensionQuery.provider('__internal').setPreferredAccount({ id: 'user3', label: 'internal@example.com' });\n\n\t\t// Without includeInternal: should exclude internal providers\n\t\tconst prefsWithoutInternal = extensionQuery.getAllAccountPreferences(false);\n\t\tassert.strictEqual(prefsWithoutInternal.size, 2);\n\t\tassert.strictEqual(prefsWithoutInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('__internal'), undefined);\n\n\t\t// With includeInternal: should include all providers\n\t\tconst prefsWithInternal = extensionQuery.getAllAccountPreferences(true);\n\t\tassert.strictEqual(prefsWithInternal.size, 3);\n\t\tassert.strictEqual(prefsWithInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithInternal.get('__internal'), 'internal@example.com');\n\n\t\t// Default behavior: should exclude internal providers\n\t\tconst prefsDefault = extensionQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(prefsDefault.size, 2);\n\t\tassert.strictEqual(prefsDefault.get('__internal'), undefined);\n\t});\n\n\ttest('getAllAccountPreferences filters internal providers by default for MCP servers', () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('azure', createProvider({ id: 'azure', label: 'Azure' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Set preferences\n\t\tconst mcpQuery = queryService.mcpServer('my-server');\n\t\tmcpQuery.provider('github').setPreferredAccount({ id: 'user1', label: 'user@github.com' });\n\t\tmcpQuery.provider('azure').setPreferredAccount({ id: 'user2', label: 'user@azure.com' });\n\t\tmcpQuery.provider('__internal').setPreferredAccount({ id: 'user3', label: 'internal@example.com' });\n\n\t\t// Without includeInternal: should exclude internal providers\n\t\tconst prefsWithoutInternal = mcpQuery.getAllAccountPreferences(false);\n\t\tassert.strictEqual(prefsWithoutInternal.size, 2);\n\t\tassert.strictEqual(prefsWithoutInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithoutInternal.get('__internal'), undefined);\n\n\t\t// With includeInternal: should include all providers\n\t\tconst prefsWithInternal = mcpQuery.getAllAccountPreferences(true);\n\t\tassert.strictEqual(prefsWithInternal.size, 3);\n\t\tassert.strictEqual(prefsWithInternal.get('github'), 'user@github.com');\n\t\tassert.strictEqual(prefsWithInternal.get('azure'), 'user@azure.com');\n\t\tassert.strictEqual(prefsWithInternal.get('__internal'), 'internal@example.com');\n\n\t\t// Default behavior: should exclude internal providers\n\t\tconst prefsDefault = mcpQuery.getAllAccountPreferences();\n\t\tassert.strictEqual(prefsDefault.size, 2);\n\t\tassert.strictEqual(prefsDefault.get('__internal'), undefined);\n\t});\n\n\ttest('clearAllData includes internal providers by default', async () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Add accounts\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up some data\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Verify data exists\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), true);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), true);\n\n\t\t// Clear all data (should include internal providers by default)\n\t\tawait queryService.clearAllData('CLEAR_ALL_AUTH_DATA');\n\n\t\t// Verify all data is cleared\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), undefined);\n\t});\n\n\ttest('clearAllData can exclude internal providers when specified', async () => {\n\t\t// Register providers\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.registerAuthenticationProvider('__internal', createProvider({ id: '__internal', label: 'Internal' }));\n\n\t\t// Add accounts\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\t\tauthService.addAccounts('__internal', [{ id: 'user2', label: 'internal@example.com' }]);\n\n\t\t// Set up some data\n\t\tqueryService.provider('github').account('user@github.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\t\tqueryService.provider('__internal').account('internal@example.com').extension('my-extension').setAccessAllowed(true, 'My Extension');\n\n\t\t// Clear data excluding internal providers\n\t\tawait queryService.clearAllData('CLEAR_ALL_AUTH_DATA', false);\n\n\t\t// Verify only non-internal data is cleared\n\t\tassert.strictEqual(queryService.provider('github').account('user@github.com').extension('my-extension').isAccessAllowed(), undefined);\n\t\tassert.strictEqual(queryService.provider('__internal').account('internal@example.com').extension('my-extension').isAccessAllowed(), true);\n\t});\n\n\ttest('isTrusted method works with mock service', () => {\n\t\t// Register provider and add account\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\n\t\t// Add a server with trusted state manually to the mock\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [{\n\t\t\tid: 'trusted-server',\n\t\t\tname: 'Trusted Server',\n\t\t\tallowed: true,\n\t\t\ttrusted: true\n\t\t}]);\n\n\t\t// Add a non-trusted server\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [{\n\t\t\tid: 'non-trusted-server',\n\t\t\tname: 'Non-Trusted Server',\n\t\t\tallowed: true\n\t\t}]);\n\n\t\t// Test trusted server\n\t\tconst trustedQuery = queryService.provider('github').account('user@github.com').mcpServer('trusted-server');\n\t\tassert.strictEqual(trustedQuery.isTrusted(), true);\n\n\t\t// Test non-trusted server\n\t\tconst nonTrustedQuery = queryService.provider('github').account('user@github.com').mcpServer('non-trusted-server');\n\t\tassert.strictEqual(nonTrustedQuery.isTrusted(), false);\n\t});\n\n\ttest('getAllowedMcpServers method returns servers with trusted state', () => {\n\t\t// Register provider and add account\n\t\tauthService.registerAuthenticationProvider('github', createProvider({ id: 'github', label: 'GitHub' }));\n\t\tauthService.addAccounts('github', [{ id: 'user1', label: 'user@github.com' }]);\n\n\t\t// Add servers manually to the mock\n\t\tmcpAccessService.updateAllowedMcpServers('github', 'user@github.com', [\n\t\t\t{\n\t\t\t\tid: 'trusted-server',\n\t\t\t\tname: 'Trusted Server',\n\t\t\t\tallowed: true,\n\t\t\t\ttrusted: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'user-server',\n\t\t\t\tname: 'User Server',\n\t\t\t\tallowed: true\n\t\t\t}\n\t\t]);\n\n\t\t// Get all allowed servers\n\t\tconst allowedServers = queryService.provider('github').account('user@github.com').mcpServers().getAllowedMcpServers();\n\n\t\t// Should have both servers\n\t\tassert.strictEqual(allowedServers.length, 2);\n\n\t\t// Find the trusted server\n\t\tconst trustedServer = allowedServers.find(s => s.id === 'trusted-server');\n\t\tassert.ok(trustedServer);\n\t\tassert.strictEqual(trustedServer.trusted, true);\n\t\tassert.strictEqual(trustedServer.allowed, true);\n\n\t\t// Find the user-allowed server\n\t\tconst userServer = allowedServers.find(s => s.id === 'user-server');\n\t\tassert.ok(userServer);\n\t\tassert.strictEqual(userServer.trusted, undefined);\n\t\tassert.strictEqual(userServer.allowed, true);\n\t});\n\n\ttest('getAllowedExtensions returns extension data with trusted state', () => {\n\t\t// Set up some extension access data\n\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\taccountQuery.extension('ext1').addUsage(['read'], 'Extension One');\n\n\t\tconst allowedExtensions = accountQuery.extensions().getAllowedExtensions();\n\n\t\t// Should have both extensions\n\t\tassert.strictEqual(allowedExtensions.length, 2);\n\n\t\t// Find the first extension\n\t\tconst ext1 = allowedExtensions.find(e => e.id === 'ext1');\n\t\tassert.ok(ext1);\n\t\tassert.strictEqual(ext1.name, 'Extension One');\n\t\tassert.strictEqual(ext1.allowed, true);\n\t\tassert.strictEqual(ext1.trusted, false); // Not in trusted list\n\t\tassert.ok(typeof ext1.lastUsed === 'number');\n\n\t\t// Find the second extension\n\t\tconst ext2 = allowedExtensions.find(e => e.id === 'ext2');\n\t\tassert.ok(ext2);\n\t\tassert.strictEqual(ext2.name, 'Extension Two');\n\t\tassert.strictEqual(ext2.allowed, true);\n\t\tassert.strictEqual(ext2.trusted, false); // Not in trusted list\n\t\tassert.strictEqual(ext2.lastUsed, undefined); // No usage\n\t});\n\n\tsuite('Account entities query', () => {\n\t\ttest('hasAnyUsage returns false for clean account', () => {\n\t\t\tconst entitiesQuery = queryService.provider('github').account('clean@example.com').entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), false);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when extension has usage', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.extension('test-ext').addUsage(['read'], 'Test Extension');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when MCP server has usage', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.mcpServer('test-server').addUsage(['write'], 'Test Server');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when extension has access', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.extension('test-ext').setAccessAllowed(true, 'Test Extension');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('hasAnyUsage returns true when MCP server has access', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\t\t\taccountQuery.mcpServer('test-server').setAccessAllowed(true, 'Test Server');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tassert.strictEqual(entitiesQuery.hasAnyUsage(), true);\n\t\t});\n\n\t\ttest('getEntityCount returns correct counts', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tconst counts = entitiesQuery.getEntityCount();\n\n\t\t\tassert.strictEqual(counts.extensions, 2);\n\t\t\tassert.strictEqual(counts.mcpServers, 1);\n\t\t\tassert.strictEqual(counts.total, 3);\n\t\t});\n\n\t\ttest('getEntityCount returns zero for clean account', () => {\n\t\t\tconst entitiesQuery = queryService.provider('github').account('clean@example.com').entities();\n\t\t\tconst counts = entitiesQuery.getEntityCount();\n\n\t\t\tassert.strictEqual(counts.extensions, 0);\n\t\t\tassert.strictEqual(counts.mcpServers, 0);\n\t\t\tassert.strictEqual(counts.total, 0);\n\t\t});\n\n\t\ttest('removeAllAccess removes access for all entity types', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').setAccessAllowed(true, 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\t\t\taccountQuery.mcpServer('server2').setAccessAllowed(true, 'Server Two');\n\n\t\t\t// Verify initial state\n\t\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.extension('ext2').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server1').isAccessAllowed(), true);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server2').isAccessAllowed(), true);\n\n\t\t\t// Remove all access\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tentitiesQuery.removeAllAccess();\n\n\t\t\t// Verify all access is removed\n\t\t\tassert.strictEqual(accountQuery.extension('ext1').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.extension('ext2').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server1').isAccessAllowed(), false);\n\t\t\tassert.strictEqual(accountQuery.mcpServer('server2').isAccessAllowed(), false);\n\t\t});\n\n\t\ttest('forEach iterates over all entity types', () => {\n\t\t\tconst accountQuery = queryService.provider('github').account('user@example.com');\n\n\t\t\t// Set up test data\n\t\t\taccountQuery.extension('ext1').setAccessAllowed(true, 'Extension One');\n\t\t\taccountQuery.extension('ext2').addUsage(['read'], 'Extension Two');\n\t\t\taccountQuery.mcpServer('server1').setAccessAllowed(true, 'Server One');\n\t\t\taccountQuery.mcpServer('server2').addUsage(['write'], 'Server Two');\n\n\t\t\tconst entitiesQuery = accountQuery.entities();\n\t\t\tconst visitedEntities: Array<{ id: string; type: 'extension' | 'mcpServer' }> = [];\n\n\t\t\tentitiesQuery.forEach((entityId, entityType) => {\n\t\t\t\tvisitedEntities.push({ id: entityId, type: entityType });\n\t\t\t});\n\n\t\t\t// Should visit all entities that have usage or access\n\t\t\tassert.strictEqual(visitedEntities.length, 4);\n\n\t\t\tconst extensions = visitedEntities.filter(e => e.type === 'extension');\n\t\t\tconst mcpServers = visitedEntities.filter(e => e.type === 'mcpServer');\n\n\t\t\tassert.strictEqual(extensions.length, 2);\n\t\t\tassert.strictEqual(mcpServers.length, 2);\n\n\t\t\t// Check specific entities were visited\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'ext1' && e.type === 'extension'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'ext2' && e.type === 'extension'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'server1' && e.type === 'mcpServer'));\n\t\t\tassert.ok(visitedEntities.some(e => e.id === 'server2' && e.type === 'mcpServer'));\n\t\t});\n\t});\n});\n"]}