{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/workingCopy/browser/workingCopyBackupTracker.ts","vs/workbench/services/workingCopy/browser/workingCopyBackupTracker.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,yBAAyB,EAAE,MAAM,gCAAgC,CAAC;AAE3E,OAAO,EAAE,0BAA0B,EAAE,MAAM,8DAA8D,CAAC;AAC1G,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AACtE,OAAO,EAAE,iBAAiB,EAAkB,MAAM,qCAAqC,CAAC;AACxF,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,wBAAwB,EAAE,MAAM,uCAAuC,CAAC;AACjF,OAAO,EAAE,yBAAyB,EAAE,MAAM,uCAAuC,CAAC;AAClF,OAAO,EAAE,cAAc,EAAE,MAAM,sCAAsC,CAAC;AACtE,OAAO,EAAE,oBAAoB,EAAE,MAAM,4CAA4C,CAAC;AAE3E,IAAM,+BAA+B,GAArC,MAAM,+BAAgC,SAAQ,wBAAwB;aAE5D,OAAE,GAAG,mDAAH,AAAsD,CAAC;IAEzE,YAC4B,wBAAmD,EAClD,yBAAqD,EAC5D,kBAAuC,EACzC,gBAAmC,EACzC,UAAuB,EACT,wBAAmD,EAC9D,aAA6B,EACvB,kBAAwC;QAE9D,KAAK,CAAC,wBAAwB,EAAE,kBAAkB,EAAE,UAAU,EAAE,gBAAgB,EAAE,yBAAyB,EAAE,wBAAwB,EAAE,aAAa,EAAE,kBAAkB,CAAC,CAAC;IAC3K,CAAC;IAES,qBAAqB,CAAC,MAAsB;QAErD,4DAA4D;QAC5D,kEAAkE;QAClE,+DAA+D;QAC/D,gCAAgC;QAEhC,MAAM,qBAAqB,GAAG,IAAI,CAAC,kBAAkB,CAAC,qBAAqB,CAAC;QAC5E,IAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE,CAAC;YACnC,OAAO,KAAK,CAAC,CAAC,4BAA4B;QAC3C,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,gBAAgB,EAAE,CAAC;YACtD,OAAO,IAAI,CAAC,CAAC,gCAAgC;QAC9C,CAAC;QAED,KAAK,MAAM,mBAAmB,IAAI,qBAAqB,EAAE,CAAC;YACzD,IAAI,CAAC,IAAI,CAAC,wBAAwB,CAAC,aAAa,CAAC,mBAAmB,EAAE,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC;gBACpH,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;gBAErD,OAAO,IAAI,CAAC,CAAC,gCAAgC;YAC9C,CAAC;QACF,CAAC;QAED,OAAO,KAAK,CAAC,CAAC,kCAAkC;IACjD,CAAC;;AA1CW,+BAA+B;IAKzC,WAAA,yBAAyB,CAAA;IACzB,WAAA,0BAA0B,CAAA;IAC1B,WAAA,mBAAmB,CAAA;IACnB,WAAA,iBAAiB,CAAA;IACjB,WAAA,WAAW,CAAA;IACX,WAAA,yBAAyB,CAAA;IACzB,WAAA,cAAc,CAAA;IACd,WAAA,oBAAoB,CAAA;GAZV,+BAA+B,CA2C3C","file":"workingCopyBackupTracker.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IWorkingCopyBackupService } from '../common/workingCopyBackup.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IFilesConfigurationService } from '../../filesConfiguration/common/filesConfigurationService.js';\nimport { IWorkingCopyService } from '../common/workingCopyService.js';\nimport { ILifecycleService, ShutdownReason } from '../../lifecycle/common/lifecycle.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { WorkingCopyBackupTracker } from '../common/workingCopyBackupTracker.js';\nimport { IWorkingCopyEditorService } from '../common/workingCopyEditorService.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { IEditorGroupsService } from '../../editor/common/editorGroupsService.js';\n\nexport class BrowserWorkingCopyBackupTracker extends WorkingCopyBackupTracker implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.browserWorkingCopyBackupTracker';\n\n\tconstructor(\n\t\t@IWorkingCopyBackupService workingCopyBackupService: IWorkingCopyBackupService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@IWorkingCopyService workingCopyService: IWorkingCopyService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@ILogService logService: ILogService,\n\t\t@IWorkingCopyEditorService workingCopyEditorService: IWorkingCopyEditorService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService\n\t) {\n\t\tsuper(workingCopyBackupService, workingCopyService, logService, lifecycleService, filesConfigurationService, workingCopyEditorService, editorService, editorGroupService);\n\t}\n\n\tprotected onFinalBeforeShutdown(reason: ShutdownReason): boolean {\n\n\t\t// Web: we cannot perform long running in the shutdown phase\n\t\t// As such we need to check sync if there are any modified working\n\t\t// copies that have not been backed up yet and then prevent the\n\t\t// shutdown if that is the case.\n\n\t\tconst modifiedWorkingCopies = this.workingCopyService.modifiedWorkingCopies;\n\t\tif (!modifiedWorkingCopies.length) {\n\t\t\treturn false; // nothing modified: no veto\n\t\t}\n\n\t\tif (!this.filesConfigurationService.isHotExitEnabled) {\n\t\t\treturn true; // modified without backup: veto\n\t\t}\n\n\t\tfor (const modifiedWorkingCopy of modifiedWorkingCopies) {\n\t\t\tif (!this.workingCopyBackupService.hasBackupSync(modifiedWorkingCopy, this.getContentVersion(modifiedWorkingCopy))) {\n\t\t\t\tthis.logService.warn('Unload veto: pending backups');\n\n\t\t\t\treturn true; // modified without backup: veto\n\t\t\t}\n\t\t}\n\n\t\treturn false; // modified and backed up: no veto\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IWorkingCopyBackupService } from '../common/workingCopyBackup.js';\nimport { IWorkbenchContribution } from '../../../common/contributions.js';\nimport { IFilesConfigurationService } from '../../filesConfiguration/common/filesConfigurationService.js';\nimport { IWorkingCopyService } from '../common/workingCopyService.js';\nimport { ILifecycleService, ShutdownReason } from '../../lifecycle/common/lifecycle.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { WorkingCopyBackupTracker } from '../common/workingCopyBackupTracker.js';\nimport { IWorkingCopyEditorService } from '../common/workingCopyEditorService.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { IEditorGroupsService } from '../../editor/common/editorGroupsService.js';\n\nexport class BrowserWorkingCopyBackupTracker extends WorkingCopyBackupTracker implements IWorkbenchContribution {\n\n\tstatic readonly ID = 'workbench.contrib.browserWorkingCopyBackupTracker';\n\n\tconstructor(\n\t\t@IWorkingCopyBackupService workingCopyBackupService: IWorkingCopyBackupService,\n\t\t@IFilesConfigurationService filesConfigurationService: IFilesConfigurationService,\n\t\t@IWorkingCopyService workingCopyService: IWorkingCopyService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@ILogService logService: ILogService,\n\t\t@IWorkingCopyEditorService workingCopyEditorService: IWorkingCopyEditorService,\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService\n\t) {\n\t\tsuper(workingCopyBackupService, workingCopyService, logService, lifecycleService, filesConfigurationService, workingCopyEditorService, editorService, editorGroupService);\n\t}\n\n\tprotected onFinalBeforeShutdown(reason: ShutdownReason): boolean {\n\n\t\t// Web: we cannot perform long running in the shutdown phase\n\t\t// As such we need to check sync if there are any modified working\n\t\t// copies that have not been backed up yet and then prevent the\n\t\t// shutdown if that is the case.\n\n\t\tconst modifiedWorkingCopies = this.workingCopyService.modifiedWorkingCopies;\n\t\tif (!modifiedWorkingCopies.length) {\n\t\t\treturn false; // nothing modified: no veto\n\t\t}\n\n\t\tif (!this.filesConfigurationService.isHotExitEnabled) {\n\t\t\treturn true; // modified without backup: veto\n\t\t}\n\n\t\tfor (const modifiedWorkingCopy of modifiedWorkingCopies) {\n\t\t\tif (!this.workingCopyBackupService.hasBackupSync(modifiedWorkingCopy, this.getContentVersion(modifiedWorkingCopy))) {\n\t\t\t\tthis.logService.warn('Unload veto: pending backups');\n\n\t\t\t\treturn true; // modified without backup: veto\n\t\t\t}\n\t\t}\n\n\t\treturn false; // modified and backed up: no veto\n\t}\n}\n"]}