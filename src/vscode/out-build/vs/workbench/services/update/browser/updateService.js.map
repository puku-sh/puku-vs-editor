{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/update/browser/updateService.ts","vs/workbench/services/update/browser/updateService.ts"],"names":[],"mappings":"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","file":"updateService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { IUpdateService, State, UpdateType } from '../../../../platform/update/common/update.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\nimport { IHostService } from '../../host/browser/host.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport interface IUpdate {\n\tversion: string;\n}\n\nexport interface IUpdateProvider {\n\n\t/**\n\t * Should return with the `IUpdate` object if an update is\n\t * available or `null` otherwise to signal that there are\n\t * no updates.\n\t */\n\tcheckForUpdate(): Promise<IUpdate | null>;\n}\n\nexport class BrowserUpdateService extends Disposable implements IUpdateService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _onStateChange = this._register(new Emitter<State>());\n\treadonly onStateChange: Event<State> = this._onStateChange.event;\n\n\tprivate _state: State = State.Uninitialized;\n\tget state(): State { return this._state; }\n\tset state(state: State) {\n\t\tthis._state = state;\n\t\tthis._onStateChange.fire(state);\n\t}\n\n\tconstructor(\n\t\t@IBrowserWorkbenchEnvironmentService private readonly environmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@IHostService private readonly hostService: IHostService\n\t) {\n\t\tsuper();\n\n\t\tthis.checkForUpdates(false);\n\t}\n\n\tasync isLatestVersion(): Promise<boolean | undefined> {\n\t\tconst update = await this.doCheckForUpdates(false);\n\t\tif (update === undefined) {\n\t\t\treturn undefined; // no update provider\n\t\t}\n\n\t\treturn !!update;\n\t}\n\n\tasync checkForUpdates(explicit: boolean): Promise<void> {\n\t\tawait this.doCheckForUpdates(explicit);\n\t}\n\n\tprivate async doCheckForUpdates(explicit: boolean): Promise<IUpdate | null /* no update available */ | undefined /* no update provider */> {\n\t\tif (this.environmentService.options && this.environmentService.options.updateProvider) {\n\t\t\tconst updateProvider = this.environmentService.options.updateProvider;\n\n\t\t\t// State -> Checking for Updates\n\t\t\tthis.state = State.CheckingForUpdates(explicit);\n\n\t\t\tconst update = await updateProvider.checkForUpdate();\n\t\t\tif (update) {\n\t\t\t\t// State -> Downloaded\n\t\t\t\tthis.state = State.Ready({ version: update.version, productVersion: update.version });\n\t\t\t} else {\n\t\t\t\t// State -> Idle\n\t\t\t\tthis.state = State.Idle(UpdateType.Archive);\n\t\t\t}\n\n\t\t\treturn update;\n\t\t}\n\n\t\treturn undefined; // no update provider to ask\n\t}\n\n\tasync downloadUpdate(): Promise<void> {\n\t\t// no-op\n\t}\n\n\tasync applyUpdate(): Promise<void> {\n\t\tthis.hostService.reload();\n\t}\n\n\tasync quitAndInstall(): Promise<void> {\n\t\tthis.hostService.reload();\n\t}\n\n\tasync _applySpecificUpdate(packagePath: string): Promise<void> {\n\t\t// noop\n\t}\n}\n\nregisterSingleton(IUpdateService, BrowserUpdateService, InstantiationType.Eager);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { IUpdateService, State, UpdateType } from '../../../../platform/update/common/update.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\nimport { IHostService } from '../../host/browser/host.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport interface IUpdate {\n\tversion: string;\n}\n\nexport interface IUpdateProvider {\n\n\t/**\n\t * Should return with the `IUpdate` object if an update is\n\t * available or `null` otherwise to signal that there are\n\t * no updates.\n\t */\n\tcheckForUpdate(): Promise<IUpdate | null>;\n}\n\nexport class BrowserUpdateService extends Disposable implements IUpdateService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _onStateChange = this._register(new Emitter<State>());\n\treadonly onStateChange: Event<State> = this._onStateChange.event;\n\n\tprivate _state: State = State.Uninitialized;\n\tget state(): State { return this._state; }\n\tset state(state: State) {\n\t\tthis._state = state;\n\t\tthis._onStateChange.fire(state);\n\t}\n\n\tconstructor(\n\t\t@IBrowserWorkbenchEnvironmentService private readonly environmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@IHostService private readonly hostService: IHostService\n\t) {\n\t\tsuper();\n\n\t\tthis.checkForUpdates(false);\n\t}\n\n\tasync isLatestVersion(): Promise<boolean | undefined> {\n\t\tconst update = await this.doCheckForUpdates(false);\n\t\tif (update === undefined) {\n\t\t\treturn undefined; // no update provider\n\t\t}\n\n\t\treturn !!update;\n\t}\n\n\tasync checkForUpdates(explicit: boolean): Promise<void> {\n\t\tawait this.doCheckForUpdates(explicit);\n\t}\n\n\tprivate async doCheckForUpdates(explicit: boolean): Promise<IUpdate | null /* no update available */ | undefined /* no update provider */> {\n\t\tif (this.environmentService.options && this.environmentService.options.updateProvider) {\n\t\t\tconst updateProvider = this.environmentService.options.updateProvider;\n\n\t\t\t// State -> Checking for Updates\n\t\t\tthis.state = State.CheckingForUpdates(explicit);\n\n\t\t\tconst update = await updateProvider.checkForUpdate();\n\t\t\tif (update) {\n\t\t\t\t// State -> Downloaded\n\t\t\t\tthis.state = State.Ready({ version: update.version, productVersion: update.version });\n\t\t\t} else {\n\t\t\t\t// State -> Idle\n\t\t\t\tthis.state = State.Idle(UpdateType.Archive);\n\t\t\t}\n\n\t\t\treturn update;\n\t\t}\n\n\t\treturn undefined; // no update provider to ask\n\t}\n\n\tasync downloadUpdate(): Promise<void> {\n\t\t// no-op\n\t}\n\n\tasync applyUpdate(): Promise<void> {\n\t\tthis.hostService.reload();\n\t}\n\n\tasync quitAndInstall(): Promise<void> {\n\t\tthis.hostService.reload();\n\t}\n\n\tasync _applySpecificUpdate(packagePath: string): Promise<void> {\n\t\t// noop\n\t}\n}\n\nregisterSingleton(IUpdateService, BrowserUpdateService, InstantiationType.Eager);\n"]}