{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/driver/browser/driver.ts","vs/workbench/services/driver/browser/driver.ts"],"names":[],"mappings":"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","file":"driver.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getClientArea, getTopLeftOffset, isHTMLDivElement, isHTMLTextAreaElement } from '../../../../base/browser/dom.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { language, locale } from '../../../../base/common/platform.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport localizedStrings from '../../../../platform/languagePacks/common/localizedStrings.js';\nimport { ILogFile, getLogs } from '../../../../platform/log/browser/log.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from '../../../common/contributions.js';\nimport { IWindowDriver, IElement, ILocaleInfo, ILocalizedStrings } from '../common/driver.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport type { Terminal as XtermTerminal } from '@xterm/xterm';\n\nexport class BrowserWindowDriver implements IWindowDriver {\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t}\n\n\tasync getLogs(): Promise<ILogFile[]> {\n\t\treturn getLogs(this.fileService, this.environmentService);\n\t}\n\n\tasync whenWorkbenchRestored(): Promise<void> {\n\t\tthis.logService.info('[driver] Waiting for restored lifecycle phase...');\n\t\tawait this.lifecycleService.when(LifecyclePhase.Restored);\n\t\tthis.logService.info('[driver] Restored lifecycle phase reached. Waiting for contributions...');\n\t\tawait Registry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).whenRestored;\n\t\tthis.logService.info('[driver] Workbench contributions created.');\n\t}\n\n\tasync setValue(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst inputElement = element as HTMLInputElement;\n\t\tinputElement.value = text;\n\n\t\tconst event = new Event('input', { bubbles: true, cancelable: true });\n\t\tinputElement.dispatchEvent(event);\n\t}\n\n\tasync isActiveElement(selector: string): Promise<boolean> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (element !== mainWindow.document.activeElement) {\n\t\t\tconst chain: string[] = [];\n\t\t\tlet el = mainWindow.document.activeElement;\n\n\t\t\twhile (el) {\n\t\t\t\tconst tagName = el.tagName;\n\t\t\t\tconst id = el.id ? `#${el.id}` : '';\n\t\t\t\tconst classes = coalesce(el.className.split(/\\s+/g).map(c => c.trim())).map(c => `.${c}`).join('');\n\t\t\t\tchain.unshift(`${tagName}${id}${classes}`);\n\n\t\t\t\tel = el.parentElement;\n\t\t\t}\n\n\t\t\tthrow new Error(`Active element not found. Current active element is '${chain.join(' > ')}'. Looking for ${selector}`);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync getElements(selector: string, recursive: boolean): Promise<IElement[]> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst query = mainWindow.document.querySelectorAll(selector);\n\t\tconst result: IElement[] = [];\n\t\tfor (let i = 0; i < query.length; i++) {\n\t\t\tconst element = query.item(i);\n\t\t\tresult.push(this.serializeElement(element, recursive));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate serializeElement(element: Element, recursive: boolean): IElement {\n\t\tconst attributes = Object.create(null);\n\n\t\tfor (let j = 0; j < element.attributes.length; j++) {\n\t\t\tconst attr = element.attributes.item(j);\n\t\t\tif (attr) {\n\t\t\t\tattributes[attr.name] = attr.value;\n\t\t\t}\n\t\t}\n\n\t\tconst children: IElement[] = [];\n\n\t\tif (recursive) {\n\t\t\tfor (let i = 0; i < element.children.length; i++) {\n\t\t\t\tconst child = element.children.item(i);\n\t\t\t\tif (child) {\n\t\t\t\t\tchildren.push(this.serializeElement(child, true));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\n\t\treturn {\n\t\t\ttagName: element.tagName,\n\t\t\tclassName: element.className,\n\t\t\ttextContent: element.textContent || '',\n\t\t\tattributes,\n\t\t\tchildren,\n\t\t\tleft,\n\t\t\ttop\n\t\t};\n\t}\n\n\tasync getElementXY(selector: string, xoffset?: number, yoffset?: number): Promise<{ x: number; y: number }> {\n\t\tconst offset = typeof xoffset === 'number' && typeof yoffset === 'number' ? { x: xoffset, y: yoffset } : undefined;\n\t\treturn this._getElementXY(selector, offset);\n\t}\n\n\tasync typeInEditor(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Editor not found: ${selector}`);\n\t\t}\n\t\tif (isHTMLDivElement(element)) {\n\t\t\t// Edit context is enabled\n\t\t\tconst editContext = element.editContext;\n\t\t\tif (!editContext) {\n\t\t\t\tthrow new Error(`Edit context not found: ${selector}`);\n\t\t\t}\n\t\t\tconst selectionStart = editContext.selectionStart;\n\t\t\tconst selectionEnd = editContext.selectionEnd;\n\t\t\tconst event = new TextUpdateEvent('textupdate', {\n\t\t\t\tupdateRangeStart: selectionStart,\n\t\t\t\tupdateRangeEnd: selectionEnd,\n\t\t\t\ttext,\n\t\t\t\tselectionStart: selectionStart + text.length,\n\t\t\t\tselectionEnd: selectionStart + text.length,\n\t\t\t\tcompositionStart: 0,\n\t\t\t\tcompositionEnd: 0\n\t\t\t});\n\t\t\teditContext.dispatchEvent(event);\n\t\t} else if (isHTMLTextAreaElement(element)) {\n\t\t\tconst start = element.selectionStart;\n\t\t\tconst newStart = start + text.length;\n\t\t\tconst value = element.value;\n\t\t\tconst newValue = value.substr(0, start) + text + value.substr(start);\n\n\t\t\telement.value = newValue;\n\t\t\telement.setSelectionRange(newStart, newStart);\n\n\t\t\tconst event = new Event('input', { 'bubbles': true, 'cancelable': true });\n\t\t\telement.dispatchEvent(event);\n\t\t}\n\t}\n\n\tasync getEditorSelection(selector: string): Promise<{ selectionStart: number; selectionEnd: number }> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\t\tif (!element) {\n\t\t\tthrow new Error(`Editor not found: ${selector}`);\n\t\t}\n\t\tif (isHTMLDivElement(element)) {\n\t\t\tconst editContext = element.editContext;\n\t\t\tif (!editContext) {\n\t\t\t\tthrow new Error(`Edit context not found: ${selector}`);\n\t\t\t}\n\t\t\treturn { selectionStart: editContext.selectionStart, selectionEnd: editContext.selectionEnd };\n\t\t} else if (isHTMLTextAreaElement(element)) {\n\t\t\treturn { selectionStart: element.selectionStart, selectionEnd: element.selectionEnd };\n\t\t} else {\n\t\t\tthrow new Error(`Unknown type of element: ${selector}`);\n\t\t}\n\t}\n\n\tasync getTerminalBuffer(selector: string): Promise<string[]> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Terminal not found: ${selector}`);\n\t\t}\n\n\t\t// eslint-disable-next-line local/code-no-any-casts, @typescript-eslint/no-explicit-any\n\t\tconst xterm = (element as any).xterm;\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\tconst lines: string[] = [];\n\t\tfor (let i = 0; i < xterm.buffer.active.length; i++) {\n\t\t\tlines.push(xterm.buffer.active.getLine(i)!.translateToString(true));\n\t\t}\n\n\t\treturn lines;\n\t}\n\n\tasync writeInTerminal(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Element not found: ${selector}`);\n\t\t}\n\n\t\t// eslint-disable-next-line local/code-no-any-casts, @typescript-eslint/no-explicit-any\n\t\tconst xterm = (element as any).xterm as (XtermTerminal | undefined);\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\txterm.input(text);\n\t}\n\n\tgetLocaleInfo(): Promise<ILocaleInfo> {\n\t\treturn Promise.resolve({\n\t\t\tlanguage: language,\n\t\t\tlocale: locale\n\t\t});\n\t}\n\n\tgetLocalizedStrings(): Promise<ILocalizedStrings> {\n\t\treturn Promise.resolve({\n\t\t\topen: localizedStrings.open,\n\t\t\tclose: localizedStrings.close,\n\t\t\tfind: localizedStrings.find\n\t\t});\n\t}\n\n\tprotected async _getElementXY(selector: string, offset?: { x: number; y: number }): Promise<{ x: number; y: number }> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\t\tconst { width, height } = getClientArea(element as HTMLElement);\n\t\tlet x: number, y: number;\n\n\t\tif (offset) {\n\t\t\tx = left + offset.x;\n\t\t\ty = top + offset.y;\n\t\t} else {\n\t\t\tx = left + (width / 2);\n\t\t\ty = top + (height / 2);\n\t\t}\n\n\t\tx = Math.round(x);\n\t\ty = Math.round(y);\n\n\t\treturn { x, y };\n\t}\n}\n\nexport function registerWindowDriver(instantiationService: IInstantiationService): void {\n\tObject.assign(mainWindow, { driver: instantiationService.createInstance(BrowserWindowDriver) });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getClientArea, getTopLeftOffset, isHTMLDivElement, isHTMLTextAreaElement } from '../../../../base/browser/dom.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { language, locale } from '../../../../base/common/platform.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport localizedStrings from '../../../../platform/languagePacks/common/localizedStrings.js';\nimport { ILogFile, getLogs } from '../../../../platform/log/browser/log.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from '../../../common/contributions.js';\nimport { IWindowDriver, IElement, ILocaleInfo, ILocalizedStrings } from '../common/driver.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport type { Terminal as XtermTerminal } from '@xterm/xterm';\n\nexport class BrowserWindowDriver implements IWindowDriver {\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t}\n\n\tasync getLogs(): Promise<ILogFile[]> {\n\t\treturn getLogs(this.fileService, this.environmentService);\n\t}\n\n\tasync whenWorkbenchRestored(): Promise<void> {\n\t\tthis.logService.info('[driver] Waiting for restored lifecycle phase...');\n\t\tawait this.lifecycleService.when(LifecyclePhase.Restored);\n\t\tthis.logService.info('[driver] Restored lifecycle phase reached. Waiting for contributions...');\n\t\tawait Registry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench).whenRestored;\n\t\tthis.logService.info('[driver] Workbench contributions created.');\n\t}\n\n\tasync setValue(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst inputElement = element as HTMLInputElement;\n\t\tinputElement.value = text;\n\n\t\tconst event = new Event('input', { bubbles: true, cancelable: true });\n\t\tinputElement.dispatchEvent(event);\n\t}\n\n\tasync isActiveElement(selector: string): Promise<boolean> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (element !== mainWindow.document.activeElement) {\n\t\t\tconst chain: string[] = [];\n\t\t\tlet el = mainWindow.document.activeElement;\n\n\t\t\twhile (el) {\n\t\t\t\tconst tagName = el.tagName;\n\t\t\t\tconst id = el.id ? `#${el.id}` : '';\n\t\t\t\tconst classes = coalesce(el.className.split(/\\s+/g).map(c => c.trim())).map(c => `.${c}`).join('');\n\t\t\t\tchain.unshift(`${tagName}${id}${classes}`);\n\n\t\t\t\tel = el.parentElement;\n\t\t\t}\n\n\t\t\tthrow new Error(`Active element not found. Current active element is '${chain.join(' > ')}'. Looking for ${selector}`);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync getElements(selector: string, recursive: boolean): Promise<IElement[]> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst query = mainWindow.document.querySelectorAll(selector);\n\t\tconst result: IElement[] = [];\n\t\tfor (let i = 0; i < query.length; i++) {\n\t\t\tconst element = query.item(i);\n\t\t\tresult.push(this.serializeElement(element, recursive));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate serializeElement(element: Element, recursive: boolean): IElement {\n\t\tconst attributes = Object.create(null);\n\n\t\tfor (let j = 0; j < element.attributes.length; j++) {\n\t\t\tconst attr = element.attributes.item(j);\n\t\t\tif (attr) {\n\t\t\t\tattributes[attr.name] = attr.value;\n\t\t\t}\n\t\t}\n\n\t\tconst children: IElement[] = [];\n\n\t\tif (recursive) {\n\t\t\tfor (let i = 0; i < element.children.length; i++) {\n\t\t\t\tconst child = element.children.item(i);\n\t\t\t\tif (child) {\n\t\t\t\t\tchildren.push(this.serializeElement(child, true));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\n\t\treturn {\n\t\t\ttagName: element.tagName,\n\t\t\tclassName: element.className,\n\t\t\ttextContent: element.textContent || '',\n\t\t\tattributes,\n\t\t\tchildren,\n\t\t\tleft,\n\t\t\ttop\n\t\t};\n\t}\n\n\tasync getElementXY(selector: string, xoffset?: number, yoffset?: number): Promise<{ x: number; y: number }> {\n\t\tconst offset = typeof xoffset === 'number' && typeof yoffset === 'number' ? { x: xoffset, y: yoffset } : undefined;\n\t\treturn this._getElementXY(selector, offset);\n\t}\n\n\tasync typeInEditor(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Editor not found: ${selector}`);\n\t\t}\n\t\tif (isHTMLDivElement(element)) {\n\t\t\t// Edit context is enabled\n\t\t\tconst editContext = element.editContext;\n\t\t\tif (!editContext) {\n\t\t\t\tthrow new Error(`Edit context not found: ${selector}`);\n\t\t\t}\n\t\t\tconst selectionStart = editContext.selectionStart;\n\t\t\tconst selectionEnd = editContext.selectionEnd;\n\t\t\tconst event = new TextUpdateEvent('textupdate', {\n\t\t\t\tupdateRangeStart: selectionStart,\n\t\t\t\tupdateRangeEnd: selectionEnd,\n\t\t\t\ttext,\n\t\t\t\tselectionStart: selectionStart + text.length,\n\t\t\t\tselectionEnd: selectionStart + text.length,\n\t\t\t\tcompositionStart: 0,\n\t\t\t\tcompositionEnd: 0\n\t\t\t});\n\t\t\teditContext.dispatchEvent(event);\n\t\t} else if (isHTMLTextAreaElement(element)) {\n\t\t\tconst start = element.selectionStart;\n\t\t\tconst newStart = start + text.length;\n\t\t\tconst value = element.value;\n\t\t\tconst newValue = value.substr(0, start) + text + value.substr(start);\n\n\t\t\telement.value = newValue;\n\t\t\telement.setSelectionRange(newStart, newStart);\n\n\t\t\tconst event = new Event('input', { 'bubbles': true, 'cancelable': true });\n\t\t\telement.dispatchEvent(event);\n\t\t}\n\t}\n\n\tasync getEditorSelection(selector: string): Promise<{ selectionStart: number; selectionEnd: number }> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\t\tif (!element) {\n\t\t\tthrow new Error(`Editor not found: ${selector}`);\n\t\t}\n\t\tif (isHTMLDivElement(element)) {\n\t\t\tconst editContext = element.editContext;\n\t\t\tif (!editContext) {\n\t\t\t\tthrow new Error(`Edit context not found: ${selector}`);\n\t\t\t}\n\t\t\treturn { selectionStart: editContext.selectionStart, selectionEnd: editContext.selectionEnd };\n\t\t} else if (isHTMLTextAreaElement(element)) {\n\t\t\treturn { selectionStart: element.selectionStart, selectionEnd: element.selectionEnd };\n\t\t} else {\n\t\t\tthrow new Error(`Unknown type of element: ${selector}`);\n\t\t}\n\t}\n\n\tasync getTerminalBuffer(selector: string): Promise<string[]> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Terminal not found: ${selector}`);\n\t\t}\n\n\t\t// eslint-disable-next-line local/code-no-any-casts, @typescript-eslint/no-explicit-any\n\t\tconst xterm = (element as any).xterm;\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\tconst lines: string[] = [];\n\t\tfor (let i = 0; i < xterm.buffer.active.length; i++) {\n\t\t\tlines.push(xterm.buffer.active.getLine(i)!.translateToString(true));\n\t\t}\n\n\t\treturn lines;\n\t}\n\n\tasync writeInTerminal(selector: string, text: string): Promise<void> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Element not found: ${selector}`);\n\t\t}\n\n\t\t// eslint-disable-next-line local/code-no-any-casts, @typescript-eslint/no-explicit-any\n\t\tconst xterm = (element as any).xterm as (XtermTerminal | undefined);\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\txterm.input(text);\n\t}\n\n\tgetLocaleInfo(): Promise<ILocaleInfo> {\n\t\treturn Promise.resolve({\n\t\t\tlanguage: language,\n\t\t\tlocale: locale\n\t\t});\n\t}\n\n\tgetLocalizedStrings(): Promise<ILocalizedStrings> {\n\t\treturn Promise.resolve({\n\t\t\topen: localizedStrings.open,\n\t\t\tclose: localizedStrings.close,\n\t\t\tfind: localizedStrings.find\n\t\t});\n\t}\n\n\tprotected async _getElementXY(selector: string, offset?: { x: number; y: number }): Promise<{ x: number; y: number }> {\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tconst element = mainWindow.document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\t\tconst { width, height } = getClientArea(element as HTMLElement);\n\t\tlet x: number, y: number;\n\n\t\tif (offset) {\n\t\t\tx = left + offset.x;\n\t\t\ty = top + offset.y;\n\t\t} else {\n\t\t\tx = left + (width / 2);\n\t\t\ty = top + (height / 2);\n\t\t}\n\n\t\tx = Math.round(x);\n\t\ty = Math.round(y);\n\n\t\treturn { x, y };\n\t}\n}\n\nexport function registerWindowDriver(instantiationService: IInstantiationService): void {\n\tObject.assign(mainWindow, { driver: instantiationService.createInstance(BrowserWindowDriver) });\n}\n"]}