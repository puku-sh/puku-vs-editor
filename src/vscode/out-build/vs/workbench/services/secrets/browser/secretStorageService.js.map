{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/secrets/browser/secretStorageService.ts","vs/workbench/services/secrets/browser/secretStorageService.ts"],"names":[],"mappings":"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","file":"secretStorageService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { SequencerByKey } from '../../../../base/common/async.js';\nimport { IEncryptionService } from '../../../../platform/encryption/common/encryptionService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ISecretStorageProvider, ISecretStorageService, BaseSecretStorageService } from '../../../../platform/secrets/common/secrets.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\n\nexport class BrowserSecretStorageService extends BaseSecretStorageService {\n\n\tprivate readonly _secretStorageProvider: ISecretStorageProvider | undefined;\n\tprivate readonly _embedderSequencer: SequencerByKey<string> | undefined;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IEncryptionService encryptionService: IEncryptionService,\n\t\t@IBrowserWorkbenchEnvironmentService environmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\t// We don't have encryption in the browser so instead we use the\n\t\t// in-memory base class implementation instead.\n\t\tsuper(true, storageService, encryptionService, logService);\n\n\t\tif (environmentService.options?.secretStorageProvider) {\n\t\t\tthis._secretStorageProvider = environmentService.options.secretStorageProvider;\n\t\t\tthis._embedderSequencer = new SequencerByKey<string>();\n\t\t}\n\t}\n\n\toverride get(key: string): Promise<string | undefined> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, () => this._secretStorageProvider!.get(key));\n\t\t}\n\n\t\treturn super.get(key);\n\t}\n\n\toverride set(key: string, value: string): Promise<void> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, async () => {\n\t\t\t\tawait this._secretStorageProvider!.set(key, value);\n\t\t\t\tthis.onDidChangeSecretEmitter.fire(key);\n\t\t\t});\n\t\t}\n\n\t\treturn super.set(key, value);\n\t}\n\n\toverride delete(key: string): Promise<void> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, async () => {\n\t\t\t\tawait this._secretStorageProvider!.delete(key);\n\t\t\t\tthis.onDidChangeSecretEmitter.fire(key);\n\t\t\t});\n\t\t}\n\n\t\treturn super.delete(key);\n\t}\n\n\toverride get type() {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._secretStorageProvider.type;\n\t\t}\n\n\t\treturn super.type;\n\t}\n\n\toverride keys(): Promise<string[]> {\n\t\tif (this._secretStorageProvider) {\n\t\t\tif (!this._secretStorageProvider.keys) {\n\t\t\t\tthrow new Error('Secret storage provider does not support keys() method');\n\t\t\t}\n\t\t\treturn this._secretStorageProvider!.keys();\n\t\t}\n\n\t\treturn super.keys();\n\n\t}\n}\n\nregisterSingleton(ISecretStorageService, BrowserSecretStorageService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { SequencerByKey } from '../../../../base/common/async.js';\nimport { IEncryptionService } from '../../../../platform/encryption/common/encryptionService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ISecretStorageProvider, ISecretStorageService, BaseSecretStorageService } from '../../../../platform/secrets/common/secrets.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\n\nexport class BrowserSecretStorageService extends BaseSecretStorageService {\n\n\tprivate readonly _secretStorageProvider: ISecretStorageProvider | undefined;\n\tprivate readonly _embedderSequencer: SequencerByKey<string> | undefined;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IEncryptionService encryptionService: IEncryptionService,\n\t\t@IBrowserWorkbenchEnvironmentService environmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\t// We don't have encryption in the browser so instead we use the\n\t\t// in-memory base class implementation instead.\n\t\tsuper(true, storageService, encryptionService, logService);\n\n\t\tif (environmentService.options?.secretStorageProvider) {\n\t\t\tthis._secretStorageProvider = environmentService.options.secretStorageProvider;\n\t\t\tthis._embedderSequencer = new SequencerByKey<string>();\n\t\t}\n\t}\n\n\toverride get(key: string): Promise<string | undefined> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, () => this._secretStorageProvider!.get(key));\n\t\t}\n\n\t\treturn super.get(key);\n\t}\n\n\toverride set(key: string, value: string): Promise<void> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, async () => {\n\t\t\t\tawait this._secretStorageProvider!.set(key, value);\n\t\t\t\tthis.onDidChangeSecretEmitter.fire(key);\n\t\t\t});\n\t\t}\n\n\t\treturn super.set(key, value);\n\t}\n\n\toverride delete(key: string): Promise<void> {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._embedderSequencer!.queue(key, async () => {\n\t\t\t\tawait this._secretStorageProvider!.delete(key);\n\t\t\t\tthis.onDidChangeSecretEmitter.fire(key);\n\t\t\t});\n\t\t}\n\n\t\treturn super.delete(key);\n\t}\n\n\toverride get type() {\n\t\tif (this._secretStorageProvider) {\n\t\t\treturn this._secretStorageProvider.type;\n\t\t}\n\n\t\treturn super.type;\n\t}\n\n\toverride keys(): Promise<string[]> {\n\t\tif (this._secretStorageProvider) {\n\t\t\tif (!this._secretStorageProvider.keys) {\n\t\t\t\tthrow new Error('Secret storage provider does not support keys() method');\n\t\t\t}\n\t\t\treturn this._secretStorageProvider!.keys();\n\t\t}\n\n\t\treturn super.keys();\n\n\t}\n}\n\nregisterSingleton(ISecretStorageService, BrowserSecretStorageService, InstantiationType.Delayed);\n"]}