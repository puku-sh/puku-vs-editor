{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/storage/test/browser/storageService.test.ts","vs/workbench/services/storage/test/browser/storageService.test.ts"],"names":[],"mappings":"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","file":"storageService.test.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IStorageChangeEvent, Storage } from '../../../../../base/parts/storage/common/storage.js';\nimport { flakySuite } from '../../../../../base/test/common/testUtils.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { InMemoryFileSystemProvider } from '../../../../../platform/files/common/inMemoryFilesystemProvider.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\nimport { createSuite } from '../../../../../platform/storage/test/common/storageService.test.js';\nimport { IUserDataProfile } from '../../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { BrowserStorageService, IndexedDBStorageDatabase } from '../../browser/storageService.js';\nimport { UserDataProfileService } from '../../../userDataProfile/common/userDataProfileService.js';\n\nasync function createStorageService(): Promise<[DisposableStore, BrowserStorageService]> {\n\tconst disposables = new DisposableStore();\n\tconst logService = new NullLogService();\n\n\tconst fileService = disposables.add(new FileService(logService));\n\n\tconst userDataProvider = disposables.add(new InMemoryFileSystemProvider());\n\tdisposables.add(fileService.registerProvider(Schemas.vscodeUserData, userDataProvider));\n\n\tconst profilesRoot = URI.file('/profiles').with({ scheme: Schemas.inMemory });\n\n\tconst inMemoryExtraProfileRoot = joinPath(profilesRoot, 'extra');\n\tconst inMemoryExtraProfile: IUserDataProfile = {\n\t\tid: 'id',\n\t\tname: 'inMemory',\n\t\tisDefault: false,\n\t\tlocation: inMemoryExtraProfileRoot,\n\t\tglobalStorageHome: joinPath(inMemoryExtraProfileRoot, 'globalStorageHome'),\n\t\tsettingsResource: joinPath(inMemoryExtraProfileRoot, 'settingsResource'),\n\t\tkeybindingsResource: joinPath(inMemoryExtraProfileRoot, 'keybindingsResource'),\n\t\ttasksResource: joinPath(inMemoryExtraProfileRoot, 'tasksResource'),\n\t\tmcpResource: joinPath(inMemoryExtraProfileRoot, 'mcp.json'),\n\t\tsnippetsHome: joinPath(inMemoryExtraProfileRoot, 'snippetsHome'),\n\t\tpromptsHome: joinPath(inMemoryExtraProfileRoot, 'promptsHome'),\n\t\textensionsResource: joinPath(inMemoryExtraProfileRoot, 'extensionsResource'),\n\t\tcacheHome: joinPath(inMemoryExtraProfileRoot, 'cache')\n\t};\n\n\tconst storageService = disposables.add(new BrowserStorageService({ id: 'workspace-storage-test' }, disposables.add(new UserDataProfileService(inMemoryExtraProfile)), logService));\n\n\tawait storageService.initialize();\n\n\treturn [disposables, storageService];\n}\n\nflakySuite('StorageService (browser)', function () {\n\tconst disposables = new DisposableStore();\n\tlet storageService: BrowserStorageService;\n\n\tcreateSuite<BrowserStorageService>({\n\t\tsetup: async () => {\n\t\t\tconst res = await createStorageService();\n\t\t\tdisposables.add(res[0]);\n\t\t\tstorageService = res[1];\n\n\t\t\treturn storageService;\n\t\t},\n\t\tteardown: async () => {\n\t\t\tawait storageService.clear();\n\t\t\tdisposables.clear();\n\t\t}\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n\nflakySuite('StorageService (browser specific)', () => {\n\tconst disposables = new DisposableStore();\n\tlet storageService: BrowserStorageService;\n\n\tsetup(async () => {\n\t\tconst res = await createStorageService();\n\t\tdisposables.add(res[0]);\n\n\t\tstorageService = res[1];\n\t});\n\n\tteardown(async () => {\n\t\tawait storageService.clear();\n\t\tdisposables.clear();\n\t});\n\n\ttest.skip('clear', () => { // slow test and also only ever being used as a developer action\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tstorageService.store('bar', 'foo', StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t\tstorageService.store('bar', 'foo', StorageScope.PROFILE, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.PROFILE, StorageTarget.USER);\n\t\t\tstorageService.store('bar', 'foo', StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.WORKSPACE, StorageTarget.USER);\n\n\t\t\tawait storageService.clear();\n\n\t\t\tfor (const scope of [StorageScope.APPLICATION, StorageScope.PROFILE, StorageScope.WORKSPACE]) {\n\t\t\t\tfor (const target of [StorageTarget.USER, StorageTarget.MACHINE]) {\n\t\t\t\t\tstrictEqual(storageService.get('bar', scope), undefined);\n\t\t\t\t\tstrictEqual(storageService.keys(scope, target).length, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n\nflakySuite('IndexDBStorageDatabase (browser)', () => {\n\n\tconst id = 'workspace-storage-db-test';\n\tconst logService = new NullLogService();\n\n\tconst disposables = new DisposableStore();\n\n\tteardown(async () => {\n\t\tconst storage = disposables.add(await IndexedDBStorageDatabase.create({ id }, logService));\n\t\tawait storage.clear();\n\n\t\tdisposables.clear();\n\t});\n\n\ttest('Basics', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Insert initial data\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\t\tstorage.set('barUndefined', undefined);\n\t\tstorage.set('barNull', null);\n\n\t\tstrictEqual(storage.get('bar'), 'foo');\n\t\tstrictEqual(storage.get('barNumber'), '55');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Check initial data still there\n\t\tstrictEqual(storage.get('bar'), 'foo');\n\t\tstrictEqual(storage.get('barNumber'), '55');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\t// Update data\n\t\tstorage.set('bar', 'foo2');\n\t\tstorage.set('barNumber', 552);\n\n\t\tstrictEqual(storage.get('bar'), 'foo2');\n\t\tstrictEqual(storage.get('barNumber'), '552');\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Check initial data still there\n\t\tstrictEqual(storage.get('bar'), 'foo2');\n\t\tstrictEqual(storage.get('barNumber'), '552');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\t// Delete data\n\t\tstorage.delete('bar');\n\t\tstorage.delete('barNumber');\n\t\tstorage.delete('barBoolean');\n\n\t\tstrictEqual(storage.get('bar', 'undefined'), 'undefined');\n\t\tstrictEqual(storage.get('barNumber', 'undefinedNumber'), 'undefinedNumber');\n\t\tstrictEqual(storage.get('barBoolean', 'undefinedBoolean'), 'undefinedBoolean');\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar', 'undefined'), 'undefined');\n\t\tstrictEqual(storage.get('barNumber', 'undefinedNumber'), 'undefinedNumber');\n\t\tstrictEqual(storage.get('barBoolean', 'undefinedBoolean'), 'undefinedBoolean');\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\t});\n\n\ttest('Clear', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\n\t\tawait storage.close();\n\n\t\tconst db = disposables.add(await IndexedDBStorageDatabase.create({ id }, logService));\n\t\tstorage = disposables.add(new Storage(db));\n\n\t\tawait storage.init();\n\t\tawait db.clear();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar'), undefined);\n\t\tstrictEqual(storage.get('barNumber'), undefined);\n\t\tstrictEqual(storage.get('barBoolean'), undefined);\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\t});\n\n\ttest('Inserts and Deletes at the same time', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foobar');\n\t\tconst largeItem = JSON.stringify({ largeItem: 'Hello World'.repeat(1000) });\n\t\tstorage.set('largeItem', largeItem);\n\t\tstorage.delete('barNumber');\n\t\tstorage.delete('barBoolean');\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar'), 'foobar');\n\t\tstrictEqual(storage.get('largeItem'), largeItem);\n\t\tstrictEqual(storage.get('barNumber'), undefined);\n\t\tstrictEqual(storage.get('barBoolean'), undefined);\n\t});\n\n\ttest('Storage change event', async () => {\n\t\tconst storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\t\tlet storageChangeEvents: IStorageChangeEvent[] = [];\n\t\tdisposables.add(storage.onDidChangeStorage(e => storageChangeEvents.push(e)));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('notExternal', 42);\n\t\tlet storageValueChangeEvent = storageChangeEvents.find(e => e.key === 'notExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, false);\n\t\tstorageChangeEvents = [];\n\n\t\tstorage.set('isExternal', 42, true);\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'isExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, true);\n\n\t\tstorage.delete('notExternal');\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'notExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, false);\n\n\t\tstorage.delete('isExternal', true);\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'isExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { strictEqual } from 'assert';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { joinPath } from '../../../../../base/common/resources.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { IStorageChangeEvent, Storage } from '../../../../../base/parts/storage/common/storage.js';\nimport { flakySuite } from '../../../../../base/test/common/testUtils.js';\nimport { runWithFakedTimers } from '../../../../../base/test/common/timeTravelScheduler.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { FileService } from '../../../../../platform/files/common/fileService.js';\nimport { InMemoryFileSystemProvider } from '../../../../../platform/files/common/inMemoryFilesystemProvider.js';\nimport { NullLogService } from '../../../../../platform/log/common/log.js';\nimport { StorageScope, StorageTarget } from '../../../../../platform/storage/common/storage.js';\nimport { createSuite } from '../../../../../platform/storage/test/common/storageService.test.js';\nimport { IUserDataProfile } from '../../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { BrowserStorageService, IndexedDBStorageDatabase } from '../../browser/storageService.js';\nimport { UserDataProfileService } from '../../../userDataProfile/common/userDataProfileService.js';\n\nasync function createStorageService(): Promise<[DisposableStore, BrowserStorageService]> {\n\tconst disposables = new DisposableStore();\n\tconst logService = new NullLogService();\n\n\tconst fileService = disposables.add(new FileService(logService));\n\n\tconst userDataProvider = disposables.add(new InMemoryFileSystemProvider());\n\tdisposables.add(fileService.registerProvider(Schemas.vscodeUserData, userDataProvider));\n\n\tconst profilesRoot = URI.file('/profiles').with({ scheme: Schemas.inMemory });\n\n\tconst inMemoryExtraProfileRoot = joinPath(profilesRoot, 'extra');\n\tconst inMemoryExtraProfile: IUserDataProfile = {\n\t\tid: 'id',\n\t\tname: 'inMemory',\n\t\tisDefault: false,\n\t\tlocation: inMemoryExtraProfileRoot,\n\t\tglobalStorageHome: joinPath(inMemoryExtraProfileRoot, 'globalStorageHome'),\n\t\tsettingsResource: joinPath(inMemoryExtraProfileRoot, 'settingsResource'),\n\t\tkeybindingsResource: joinPath(inMemoryExtraProfileRoot, 'keybindingsResource'),\n\t\ttasksResource: joinPath(inMemoryExtraProfileRoot, 'tasksResource'),\n\t\tmcpResource: joinPath(inMemoryExtraProfileRoot, 'mcp.json'),\n\t\tsnippetsHome: joinPath(inMemoryExtraProfileRoot, 'snippetsHome'),\n\t\tpromptsHome: joinPath(inMemoryExtraProfileRoot, 'promptsHome'),\n\t\textensionsResource: joinPath(inMemoryExtraProfileRoot, 'extensionsResource'),\n\t\tcacheHome: joinPath(inMemoryExtraProfileRoot, 'cache')\n\t};\n\n\tconst storageService = disposables.add(new BrowserStorageService({ id: 'workspace-storage-test' }, disposables.add(new UserDataProfileService(inMemoryExtraProfile)), logService));\n\n\tawait storageService.initialize();\n\n\treturn [disposables, storageService];\n}\n\nflakySuite('StorageService (browser)', function () {\n\tconst disposables = new DisposableStore();\n\tlet storageService: BrowserStorageService;\n\n\tcreateSuite<BrowserStorageService>({\n\t\tsetup: async () => {\n\t\t\tconst res = await createStorageService();\n\t\t\tdisposables.add(res[0]);\n\t\t\tstorageService = res[1];\n\n\t\t\treturn storageService;\n\t\t},\n\t\tteardown: async () => {\n\t\t\tawait storageService.clear();\n\t\t\tdisposables.clear();\n\t\t}\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n\nflakySuite('StorageService (browser specific)', () => {\n\tconst disposables = new DisposableStore();\n\tlet storageService: BrowserStorageService;\n\n\tsetup(async () => {\n\t\tconst res = await createStorageService();\n\t\tdisposables.add(res[0]);\n\n\t\tstorageService = res[1];\n\t});\n\n\tteardown(async () => {\n\t\tawait storageService.clear();\n\t\tdisposables.clear();\n\t});\n\n\ttest.skip('clear', () => { // slow test and also only ever being used as a developer action\n\t\treturn runWithFakedTimers({ useFakeTimers: true }, async () => {\n\t\t\tstorageService.store('bar', 'foo', StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.APPLICATION, StorageTarget.USER);\n\t\t\tstorageService.store('bar', 'foo', StorageScope.PROFILE, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.PROFILE, StorageTarget.USER);\n\t\t\tstorageService.store('bar', 'foo', StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t\t\tstorageService.store('bar', 3, StorageScope.WORKSPACE, StorageTarget.USER);\n\n\t\t\tawait storageService.clear();\n\n\t\t\tfor (const scope of [StorageScope.APPLICATION, StorageScope.PROFILE, StorageScope.WORKSPACE]) {\n\t\t\t\tfor (const target of [StorageTarget.USER, StorageTarget.MACHINE]) {\n\t\t\t\t\tstrictEqual(storageService.get('bar', scope), undefined);\n\t\t\t\t\tstrictEqual(storageService.keys(scope, target).length, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n\nflakySuite('IndexDBStorageDatabase (browser)', () => {\n\n\tconst id = 'workspace-storage-db-test';\n\tconst logService = new NullLogService();\n\n\tconst disposables = new DisposableStore();\n\n\tteardown(async () => {\n\t\tconst storage = disposables.add(await IndexedDBStorageDatabase.create({ id }, logService));\n\t\tawait storage.clear();\n\n\t\tdisposables.clear();\n\t});\n\n\ttest('Basics', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Insert initial data\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\t\tstorage.set('barUndefined', undefined);\n\t\tstorage.set('barNull', null);\n\n\t\tstrictEqual(storage.get('bar'), 'foo');\n\t\tstrictEqual(storage.get('barNumber'), '55');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Check initial data still there\n\t\tstrictEqual(storage.get('bar'), 'foo');\n\t\tstrictEqual(storage.get('barNumber'), '55');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\t// Update data\n\t\tstorage.set('bar', 'foo2');\n\t\tstorage.set('barNumber', 552);\n\n\t\tstrictEqual(storage.get('bar'), 'foo2');\n\t\tstrictEqual(storage.get('barNumber'), '552');\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\t// Check initial data still there\n\t\tstrictEqual(storage.get('bar'), 'foo2');\n\t\tstrictEqual(storage.get('barNumber'), '552');\n\t\tstrictEqual(storage.get('barBoolean'), 'true');\n\t\tstrictEqual(storage.get('barUndefined'), undefined);\n\t\tstrictEqual(storage.get('barNull'), undefined);\n\n\t\tstrictEqual(storage.size, 3);\n\t\tstrictEqual(storage.items.size, 3);\n\n\t\t// Delete data\n\t\tstorage.delete('bar');\n\t\tstorage.delete('barNumber');\n\t\tstorage.delete('barBoolean');\n\n\t\tstrictEqual(storage.get('bar', 'undefined'), 'undefined');\n\t\tstrictEqual(storage.get('barNumber', 'undefinedNumber'), 'undefinedNumber');\n\t\tstrictEqual(storage.get('barBoolean', 'undefinedBoolean'), 'undefinedBoolean');\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar', 'undefined'), 'undefined');\n\t\tstrictEqual(storage.get('barNumber', 'undefinedNumber'), 'undefinedNumber');\n\t\tstrictEqual(storage.get('barBoolean', 'undefinedBoolean'), 'undefinedBoolean');\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\t});\n\n\ttest('Clear', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\n\t\tawait storage.close();\n\n\t\tconst db = disposables.add(await IndexedDBStorageDatabase.create({ id }, logService));\n\t\tstorage = disposables.add(new Storage(db));\n\n\t\tawait storage.init();\n\t\tawait db.clear();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar'), undefined);\n\t\tstrictEqual(storage.get('barNumber'), undefined);\n\t\tstrictEqual(storage.get('barBoolean'), undefined);\n\n\t\tstrictEqual(storage.size, 0);\n\t\tstrictEqual(storage.items.size, 0);\n\t});\n\n\ttest('Inserts and Deletes at the same time', async () => {\n\t\tlet storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foo');\n\t\tstorage.set('barNumber', 55);\n\t\tstorage.set('barBoolean', true);\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('bar', 'foobar');\n\t\tconst largeItem = JSON.stringify({ largeItem: 'Hello World'.repeat(1000) });\n\t\tstorage.set('largeItem', largeItem);\n\t\tstorage.delete('barNumber');\n\t\tstorage.delete('barBoolean');\n\n\t\tawait storage.close();\n\n\t\tstorage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\n\t\tawait storage.init();\n\n\t\tstrictEqual(storage.get('bar'), 'foobar');\n\t\tstrictEqual(storage.get('largeItem'), largeItem);\n\t\tstrictEqual(storage.get('barNumber'), undefined);\n\t\tstrictEqual(storage.get('barBoolean'), undefined);\n\t});\n\n\ttest('Storage change event', async () => {\n\t\tconst storage = disposables.add(new Storage(disposables.add(await IndexedDBStorageDatabase.create({ id }, logService))));\n\t\tlet storageChangeEvents: IStorageChangeEvent[] = [];\n\t\tdisposables.add(storage.onDidChangeStorage(e => storageChangeEvents.push(e)));\n\n\t\tawait storage.init();\n\n\t\tstorage.set('notExternal', 42);\n\t\tlet storageValueChangeEvent = storageChangeEvents.find(e => e.key === 'notExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, false);\n\t\tstorageChangeEvents = [];\n\n\t\tstorage.set('isExternal', 42, true);\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'isExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, true);\n\n\t\tstorage.delete('notExternal');\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'notExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, false);\n\n\t\tstorage.delete('isExternal', true);\n\t\tstorageValueChangeEvent = storageChangeEvents.find(e => e.key === 'isExternal');\n\t\tstrictEqual(storageValueChangeEvent?.external, true);\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"]}