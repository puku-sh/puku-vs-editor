{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/timer/browser/timerService.ts","vs/workbench/services/timer/browser/timerService.ts"],"names":[],"mappings":"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","file":"timerService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as perf from '../../../../base/common/performance.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkspaceContextService, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\nimport { IUpdateService } from '../../../../platform/update/common/update.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ITelemetryData, ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { Barrier, timeout } from '../../../../base/common/async.js';\nimport { IWorkbenchLayoutService } from '../../layout/browser/layoutService.js';\nimport { IPaneCompositePartService } from '../../panecomposite/browser/panecomposite.js';\nimport { ViewContainerLocation } from '../../../common/views.js';\nimport { TelemetryTrustedValue } from '../../../../platform/telemetry/common/telemetryUtils.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { createBlobWorker } from '../../../../platform/webWorker/browser/webWorkerServiceImpl.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ITerminalBackendRegistry, TerminalExtensions } from '../../../../platform/terminal/common/terminal.js';\n\n/* __GDPR__FRAGMENT__\n\t\"IMemoryInfo\" : {\n\t\t\"workingSetSize\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"privateBytes\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"sharedBytes\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true }\n\t}\n*/\nexport interface IMemoryInfo {\n\treadonly workingSetSize: number;\n\treadonly privateBytes: number;\n\treadonly sharedBytes: number;\n}\n\n/* __GDPR__FRAGMENT__\n\t\"IStartupMetrics\" : {\n\t\t\"ellapsed\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"isLatestVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"didUseCachedData\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"windowKind\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"windowCount\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"viewletId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"panelId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"editorIds\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"timers.ellapsedAppReady\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedNlsGeneration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedLoadMainBundle\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRunMainBundle\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedCrashReporter\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedMainServer\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowCreate\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowLoad\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowLoadToRequire\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWaitForWindowConfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedStorageInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkspaceServiceInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedSharedProcesConnected\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRequiredUserDataInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedOtherUserDataInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRequire\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedExtensions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedExtensionsReady\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedViewletRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedAuxiliaryViewletRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedPanelRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedEditorRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkbenchContributions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkbench\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"platform\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"release\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"arch\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"totalmem\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"freemem\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"meminfo\" : { \"${inline}\": [ \"${IMemoryInfo}\" ] },\n\t\t\"cpus.count\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"cpus.speed\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"cpus.model\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"initialStartup\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"hasAccessibilitySupport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"isVMLikelyhood\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"emptyWorkbench\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"loadavg\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"isARM64Emulated\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true }\n\t}\n*/\nexport interface IStartupMetrics {\n\n\t/**\n\t * If this started the main process and renderer or just a renderer (new or reloaded).\n\t */\n\treadonly initialStartup: boolean;\n\n\t/**\n\t * No folder, no file, no workspace has been opened\n\t */\n\treadonly emptyWorkbench: boolean;\n\n\t/**\n\t * This is the latest (stable/insider) version. Iff not we should ignore this\n\t * measurement.\n\t */\n\treadonly isLatestVersion: boolean;\n\n\t/**\n\t * Whether we asked for and V8 accepted cached data.\n\t */\n\treadonly didUseCachedData: boolean;\n\n\t/**\n\t * How/why the window was created. See https://github.com/microsoft/vscode/blob/d1f57d871722f4d6ba63e4ef6f06287121ceb045/src/vs/platform/lifecycle/common/lifecycle.ts#L50\n\t */\n\treadonly windowKind: number;\n\n\t/**\n\t * The total number of windows that have been restored/created\n\t */\n\treadonly windowCount: number;\n\n\t/**\n\t * The active viewlet id or `undedined`\n\t */\n\treadonly viewletId?: string;\n\n\t/**\n\t * The active auxiliary viewlet id or `undedined`\n\t */\n\treadonly auxiliaryViewletId?: string;\n\n\t/**\n\t * The active panel id or `undefined`\n\t */\n\treadonly panelId?: string;\n\n\t/**\n\t * The editor input types or `[]`\n\t */\n\treadonly editorIds: string[];\n\n\t/**\n\t * The time it took to create the workbench.\n\t *\n\t * * Happens in the main-process *and* the renderer-process\n\t * * Measured with the *start* and `didStartWorkbench`-performance mark. The *start* is either the start of the\n\t * main process or the start of the renderer.\n\t * * This should be looked at carefully because times vary depending on\n\t *  * This being the first window, the only window, or a reloaded window\n\t *  * Cached data being present and used or not\n\t *  * The numbers and types of editors being restored\n\t *  * The numbers of windows being restored (when starting 'fresh')\n\t *  * The viewlet being restored (esp. when it's a contributed viewlet)\n\t */\n\treadonly ellapsed: number;\n\n\t/**\n\t * Individual timers...\n\t */\n\treadonly timers: {\n\t\t/**\n\t\t * The time it took to receieve the [`ready`](https://electronjs.org/docs/api/app#event-ready)-event. Measured from the first line\n\t\t * of JavaScript code till receiving that event.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `main:started` and `main:appReady` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * This should be looked at per OS version and per electron version.\n\t\t * * This is often affected by AV software (and can change with AV software updates outside of our release-cycle).\n\t\t * * It is not our code running here and we can only observe what's happening.\n\t\t */\n\t\treadonly ellapsedAppReady?: number;\n\n\t\t/**\n\t\t * The time it took to generate NLS data.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `nlsGeneration:start` and `nlsGeneration:end` performance marks.\n\t\t * * This only happens when a non-english locale is being used.\n\t\t * * It is our code running here and we should monitor this carefully for regressions.\n\t\t */\n\t\treadonly ellapsedNlsGeneration?: number;\n\n\t\t/**\n\t\t * The time it took to load the main bundle.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willLoadMainBundle` and `didLoadMainBundle` performance marks.\n\t\t */\n\t\treadonly ellapsedLoadMainBundle?: number;\n\n\t\t/**\n\t\t * The time it took to run the main bundle.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `didStartMain` and `didRunMainBundle` performance marks.\n\t\t */\n\t\treadonly ellapsedRunMainBundle?: number;\n\n\t\t/**\n\t\t * The time it took to start the crash reporter.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willStartCrashReporter` and `didStartCrashReporter` performance marks.\n\t\t */\n\t\treadonly ellapsedCrashReporter?: number;\n\n\t\t/**\n\t\t * The time it took to create the main instance server.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willStartMainServer` and `didStartMainServer` performance marks.\n\t\t */\n\t\treadonly ellapsedMainServer?: number;\n\n\t\t/**\n\t\t * The time it took to create the window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willCreateCodeWindow` and `didCreateCodeWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowCreate?: number;\n\n\t\t/**\n\t\t * The time it took to create the electron browser window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willCreateCodeBrowserWindow` and `didCreateCodeBrowserWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedBrowserWindowCreate?: number;\n\n\t\t/**\n\t\t * The time it took to restore and validate window state.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willRestoreCodeWindowState` and `didRestoreCodeWindowState` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowRestoreState?: number;\n\n\t\t/**\n\t\t * The time it took to maximize/show the window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willMaximizeCodeWindow` and `didMaximizeCodeWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowMaximize?: number;\n\n\t\t/**\n\t\t * The time it took to tell electron to open/restore a renderer (browser window).\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `main:appReady` and `code/willOpenNewWindow` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * It is our code running here and we should monitor this carefully for regressions.\n\t\t */\n\t\treadonly ellapsedWindowLoad?: number;\n\n\t\t/**\n\t\t * The time it took to create a new renderer (browser window) and to initialize that to the point\n\t\t * of load the main-bundle (`workbench.desktop.main.js`).\n\t\t *\n\t\t * * Happens in the main-process *and* the renderer-process\n\t\t * * Measured with the `code/willOpenNewWindow` and `willLoadWorkbenchMain` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * It is mostly not our code running here and we can only observe what's happening.\n\t\t *\n\t\t */\n\t\treadonly ellapsedWindowLoadToRequire: number;\n\n\t\t/**\n\t\t * The time it took to wait for resolving the window configuration. This time the workbench\n\t\t * will not continue to load and be blocked entirely.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willWaitForWindowConfig` and `didWaitForWindowConfig` performance marks.\n\t\t */\n\t\treadonly ellapsedWaitForWindowConfig: number;\n\n\t\t/**\n\t\t * The time it took to init the storage database connection from the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `code/willInitStorage` and `code/didInitStorage` performance marks.\n\t\t */\n\t\treadonly ellapsedStorageInit: number;\n\n\t\t/**\n\t\t * The time it took to initialize the workspace and configuration service.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willInitWorkspaceService` and `didInitWorkspaceService` performance marks.\n\t\t */\n\t\treadonly ellapsedWorkspaceServiceInit: number;\n\n\t\t/**\n\t\t * The time it took to connect to the shared process.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willConnectSharedProcess` and `didConnectSharedProcess` performance marks.\n\t\t */\n\t\treadonly ellapsedSharedProcesConnected: number;\n\n\t\t/**\n\t\t * The time it took to initialize required user data (settings & global state) using settings sync service.\n\t\t *\n\t\t * * Happens in the renderer-process (only in Web)\n\t\t * * Measured with the `willInitRequiredUserData` and `didInitRequiredUserData` performance marks.\n\t\t */\n\t\treadonly ellapsedRequiredUserDataInit: number;\n\n\t\t/**\n\t\t * The time it took to initialize other user data (keybindings, snippets & extensions) using settings sync service.\n\t\t *\n\t\t * * Happens in the renderer-process (only in Web)\n\t\t * * Measured with the `willInitOtherUserData` and `didInitOtherUserData` performance marks.\n\t\t */\n\t\treadonly ellapsedOtherUserDataInit: number;\n\n\t\t/**\n\t\t * The time it took to load the main-bundle of the workbench, e.g. `workbench.desktop.main.js`.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willLoadWorkbenchMain` and `didLoadWorkbenchMain` performance marks.\n\t\t * * This varies *a lot* when V8 cached data could be used or not\n\t\t * * This should be looked at with and without V8 cached data usage and per electron/v8 version\n\t\t * * This is affected by the size of our code bundle (which  grows about 3-5% per release)\n\t\t */\n\t\treadonly ellapsedRequire: number;\n\n\t\t/**\n\t\t * The time it took to read extensions' package.json-files *and* interpret them (invoking\n\t\t * the contribution points).\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willLoadExtensions` and `didLoadExtensions` performance marks.\n\t\t * * Reading of package.json-files is avoided by caching them all in a single file (after the read,\n\t\t * until another extension is installed)\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedExtensions: number;\n\n\t\t// the time from start till `didLoadExtensions`\n\t\t// remove?\n\t\treadonly ellapsedExtensionsReady: number;\n\n\t\t/**\n\t\t * The time it took to restore the primary sidebar viewlet.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreViewlet` and `didRestoreViewlet` performance marks.\n\t\t * * This should be looked at per viewlet-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedViewletRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore the auxiliary bar viewlet.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreAuxiliaryBar` and `didRestoreAuxiliaryBar` performance marks.\n\t\t * * This should be looked at per viewlet-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedAuxiliaryViewletRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore the panel.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestorePanel` and `didRestorePanel` performance marks.\n\t\t * * This should be looked at per panel-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedPanelRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore and fully resolve visible editors - that is text editor\n\t\t * and complex editor likes the settings UI or webviews (markdown preview).\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreEditors` and `didRestoreEditors` performance marks.\n\t\t * * This should be looked at per editor and per editor type.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedEditorRestore: number;\n\n\t\t/**\n\t\t * The time it took to create all workbench contributions on the starting and ready\n\t\t * lifecycle phase, thus blocking `ellapsedWorkbench`.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willCreateWorkbenchContributions/1` and `didCreateWorkbenchContributions/2` performance marks.\n\t\t *\n\t\t */\n\t\treadonly ellapsedWorkbenchContributions: number;\n\n\t\t/**\n\t\t * The time it took to create the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willStartWorkbench` and `didStartWorkbench` performance marks.\n\t\t */\n\t\treadonly ellapsedWorkbench: number;\n\n\t\t/**\n\t\t * This time it took inside the renderer to start the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `renderer/started` and `didStartWorkbench` performance marks\n\t\t */\n\t\treadonly ellapsedRenderer: number;\n\t};\n\n\treadonly hasAccessibilitySupport: boolean;\n\treadonly isVMLikelyhood?: number;\n\treadonly platform?: string;\n\treadonly release?: string;\n\treadonly arch?: string;\n\treadonly totalmem?: number;\n\treadonly freemem?: number;\n\treadonly meminfo?: IMemoryInfo;\n\treadonly cpus?: { count: number; speed: number; model: string };\n\treadonly loadavg?: number[];\n\treadonly isARM64Emulated?: boolean;\n}\n\nexport interface ITimerService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * A promise that resolved when startup timings and perf marks\n\t * are available. This depends on lifecycle phases and extension\n\t * hosts being started.\n\t */\n\twhenReady(): Promise<boolean>;\n\n\t/**\n\t * A baseline performance indicator for this machine. The value will only available\n\t * late after startup because computing it takes away CPU resources\n\t *\n\t * NOTE that this returns -1 if the machine is hopelessly slow...\n\t */\n\tperfBaseline: Promise<number>;\n\n\t/**\n\t * Startup metrics. Can ONLY be accessed after `whenReady` has resolved.\n\t */\n\treadonly startupMetrics: IStartupMetrics;\n\n\t/**\n\t * Deliver performance marks from a source, like the main process or extension hosts.\n\t * The source argument acts as an identifier and therefore it must be unique.\n\t */\n\tsetPerformanceMarks(source: string, marks: perf.PerformanceMark[]): void;\n\n\t/**\n\t * Get all currently known performance marks by source. There is no sorting of the\n\t * returned tuples but the marks of a tuple are guaranteed to be sorted by start times.\n\t */\n\tgetPerformanceMarks(): [source: string, marks: readonly perf.PerformanceMark[]][];\n\n\t/**\n\t * Return the duration between two marks.\n\t * @param from from mark name\n\t * @param to to mark name\n\t */\n\tgetDuration(from: string, to: string): number;\n\n\t/**\n\t * Return the timestamp of a mark.\n\t * @param mark mark name\n\t */\n\tgetStartTime(mark: string): number;\n}\n\nexport const ITimerService = createDecorator<ITimerService>('timerService');\n\n\nclass PerfMarks {\n\n\tprivate readonly _entries: [string, perf.PerformanceMark[]][] = [];\n\n\tsetMarks(source: string, entries: perf.PerformanceMark[]): void {\n\t\tthis._entries.push([source, entries]);\n\t}\n\n\tgetDuration(from: string, to: string): number {\n\t\tconst fromEntry = this._findEntry(from);\n\t\tif (!fromEntry) {\n\t\t\treturn 0;\n\t\t}\n\t\tconst toEntry = this._findEntry(to);\n\t\tif (!toEntry) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn toEntry.startTime - fromEntry.startTime;\n\t}\n\n\tgetStartTime(mark: string): number {\n\t\tconst entry = this._findEntry(mark);\n\t\treturn entry ? entry.startTime : -1;\n\t}\n\n\tprivate _findEntry(name: string): perf.PerformanceMark | void {\n\t\tfor (const [, marks] of this._entries) {\n\t\t\tfor (let i = marks.length - 1; i >= 0; i--) {\n\t\t\t\tif (marks[i].name === name) {\n\t\t\t\t\treturn marks[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEntries() {\n\t\treturn this._entries.slice(0);\n\t}\n}\n\nexport type Writeable<T> = { -readonly [P in keyof T]: Writeable<T[P]> };\n\nexport abstract class AbstractTimerService implements ITimerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _barrier = new Barrier();\n\tprivate readonly _marks = new PerfMarks();\n\tprivate readonly _rndValueShouldSendTelemetry = Math.random() < .03; // 3% of users\n\n\tprivate _startupMetrics?: IStartupMetrics;\n\n\treadonly perfBaseline: Promise<number>;\n\n\tconstructor(\n\t\t@ILifecycleService private readonly _lifecycleService: ILifecycleService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@IUpdateService private readonly _updateService: IUpdateService,\n\t\t@IPaneCompositePartService private readonly _paneCompositeService: IPaneCompositePartService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@IWorkbenchLayoutService layoutService: IWorkbenchLayoutService\n\t) {\n\t\tPromise.all([\n\t\t\tthis._extensionService.whenInstalledExtensionsRegistered(), // extensions registered\n\t\t\t_lifecycleService.when(LifecyclePhase.Restored),\t\t\t// workbench created and parts restored\n\t\t\tlayoutService.whenRestored,\t\t\t\t\t\t\t\t\t// layout restored (including visible editors resolved)\n\t\t\tPromise.all(Array.from(Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).backends.values()).map(e => e.whenReady))\n\t\t]).then(() => {\n\t\t\t// set perf mark from renderer\n\t\t\tthis.setPerformanceMarks('renderer', perf.getMarks());\n\t\t\treturn this._computeStartupMetrics();\n\t\t}).then(metrics => {\n\t\t\tthis._startupMetrics = metrics;\n\t\t\tthis._reportStartupTimes(metrics);\n\t\t\tthis._barrier.open();\n\t\t});\n\n\n\t\tthis.perfBaseline = this._barrier.wait()\n\t\t\t.then(() => this._lifecycleService.when(LifecyclePhase.Eventually))\n\t\t\t.then(() => timeout(this._startupMetrics!.timers.ellapsedRequire))\n\t\t\t.then(() => {\n\n\t\t\t\t// we use fibonacci numbers to have a performance baseline that indicates\n\t\t\t\t// how slow/fast THIS machine actually is.\n\n\t\t\t\tconst jsSrc = (function (this: WindowOrWorkerGlobalScope) {\n\t\t\t\t\t// the following operation took ~16ms (one frame at 64FPS) to complete on my machine. We derive performance observations\n\t\t\t\t\t// from that. We also bail if that took too long (>1s)\n\t\t\t\t\tlet tooSlow = false;\n\t\t\t\t\tfunction fib(n: number): number {\n\t\t\t\t\t\tif (tooSlow) {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (performance.now() - t1 >= 1000) {\n\t\t\t\t\t\t\ttooSlow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (n <= 2) {\n\t\t\t\t\t\t\treturn n;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn fib(n - 1) + fib(n - 2);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst t1 = performance.now();\n\t\t\t\t\tfib(24);\n\t\t\t\t\tconst value = Math.round(performance.now() - t1);\n\t\t\t\t\tself.postMessage({ value: tooSlow ? -1 : value });\n\n\t\t\t\t}).toString();\n\n\t\t\t\tconst blob = new Blob([`(${jsSrc})();`], { type: 'application/javascript' });\n\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\n\n\t\t\t\tconst worker = createBlobWorker(blobUrl, { name: 'perfBaseline' });\n\t\t\t\treturn new Promise<number>(resolve => {\n\t\t\t\t\tworker.onmessage = e => resolve(e.data.value);\n\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tworker.terminate();\n\t\t\t\t\tURL.revokeObjectURL(blobUrl);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\twhenReady(): Promise<boolean> {\n\t\treturn this._barrier.wait();\n\t}\n\n\tget startupMetrics(): IStartupMetrics {\n\t\tif (!this._startupMetrics) {\n\t\t\tthrow new Error('illegal state, MUST NOT access startupMetrics before whenReady has resolved');\n\t\t}\n\t\treturn this._startupMetrics;\n\t}\n\n\tsetPerformanceMarks(source: string, marks: perf.PerformanceMark[]): void {\n\t\t// Perf marks are a shared resource because anyone can generate them\n\t\t// and because of that we only accept marks that start with 'code/'\n\t\tconst codeMarks = marks.filter(mark => mark.name.startsWith('code/'));\n\t\tthis._marks.setMarks(source, codeMarks);\n\t\tthis._reportPerformanceMarks(source, codeMarks);\n\t}\n\n\tgetPerformanceMarks(): [source: string, marks: readonly perf.PerformanceMark[]][] {\n\t\treturn this._marks.getEntries();\n\t}\n\n\tgetDuration(from: string, to: string): number {\n\t\treturn this._marks.getDuration(from, to);\n\t}\n\n\tgetStartTime(mark: string): number {\n\t\treturn this._marks.getStartTime(mark);\n\t}\n\n\tprivate _reportStartupTimes(metrics: IStartupMetrics): void {\n\t\t// report IStartupMetrics as telemetry\n\t\t/* __GDPR__\n\t\t\t\"startupTimeVaried\" : {\n\t\t\t\t\"owner\": \"jrieken\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${IStartupMetrics}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis._telemetryService.publicLog('startupTimeVaried', metrics as unknown as ITelemetryData);\n\t}\n\n\tprotected _shouldReportPerfMarks(): boolean {\n\t\treturn this._rndValueShouldSendTelemetry;\n\t}\n\n\tprivate _reportPerformanceMarks(source: string, marks: perf.PerformanceMark[]) {\n\n\t\tif (!this._shouldReportPerfMarks()) {\n\t\t\t// the `startup.timer.mark` event is send very often. In order to save resources\n\t\t\t// we let some of our instances/sessions send this event\n\t\t\treturn;\n\t\t}\n\n\t\t// report raw timers as telemetry. each mark is send a separate telemetry\n\t\t// event and it is \"normalized\" to a relative timestamp where the first mark\n\t\t// defines the start\n\n\t\ttype Mark = { source: string; name: TelemetryTrustedValue<string>; startTime: number };\n\t\ttype MarkClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Information about a performance marker';\n\t\t\tsource: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Where this marker was generated, e.g main, renderer, extension host' };\n\t\t\tname: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The name of this marker (as defined in source code)' };\n\t\t\tstartTime: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The absolute timestamp (unix time)' };\n\t\t};\n\n\t\tfor (const mark of marks) {\n\t\t\tthis._telemetryService.publicLog2<Mark, MarkClassification>('startup.timer.mark', {\n\t\t\t\tsource,\n\t\t\t\tname: new TelemetryTrustedValue(mark.name),\n\t\t\t\tstartTime: mark.startTime\n\t\t\t});\n\t\t}\n\n\t}\n\n\tprivate async _computeStartupMetrics(): Promise<IStartupMetrics> {\n\t\tconst initialStartup = this._isInitialStartup();\n\t\tlet startMark: string;\n\t\tif (isWeb) {\n\t\t\tstartMark = 'code/timeOrigin';\n\t\t} else {\n\t\t\tstartMark = initialStartup ? 'code/didStartMain' : 'code/willOpenNewWindow';\n\t\t}\n\n\t\tconst activeViewlet = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.Sidebar);\n\t\tconst activeAuxiliaryViewlet = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.AuxiliaryBar);\n\t\tconst activePanel = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.Panel);\n\t\tconst info: Writeable<IStartupMetrics> = {\n\n\t\t\tellapsed: this._marks.getDuration(startMark, 'code/didStartWorkbench'),\n\n\t\t\t// reflections\n\t\t\tisLatestVersion: Boolean(await this._updateService.isLatestVersion()),\n\t\t\tdidUseCachedData: this._didUseCachedData(),\n\t\t\twindowKind: this._lifecycleService.startupKind,\n\t\t\twindowCount: await this._getWindowCount(),\n\t\t\tviewletId: activeViewlet?.getId(),\n\t\t\tauxiliaryViewletId: activeAuxiliaryViewlet?.getId(),\n\t\t\teditorIds: this._editorService.visibleEditors.map(input => input.typeId),\n\t\t\tpanelId: activePanel ? activePanel.getId() : undefined,\n\n\t\t\t// timers\n\t\t\ttimers: {\n\t\t\t\tellapsedAppReady: initialStartup ? this._marks.getDuration('code/didStartMain', 'code/mainAppReady') : undefined,\n\t\t\t\tellapsedNlsGeneration: initialStartup ? this._marks.getDuration('code/willGenerateNls', 'code/didGenerateNls') : undefined,\n\t\t\t\tellapsedLoadMainBundle: initialStartup ? this._marks.getDuration('code/willLoadMainBundle', 'code/didLoadMainBundle') : undefined,\n\t\t\t\tellapsedRunMainBundle: initialStartup ? this._marks.getDuration('code/didStartMain', 'code/didRunMainBundle') : undefined,\n\t\t\t\tellapsedCrashReporter: initialStartup ? this._marks.getDuration('code/willStartCrashReporter', 'code/didStartCrashReporter') : undefined,\n\t\t\t\tellapsedMainServer: initialStartup ? this._marks.getDuration('code/willStartMainServer', 'code/didStartMainServer') : undefined,\n\t\t\t\tellapsedWindowCreate: initialStartup ? this._marks.getDuration('code/willCreateCodeWindow', 'code/didCreateCodeWindow') : undefined,\n\t\t\t\tellapsedWindowRestoreState: initialStartup ? this._marks.getDuration('code/willRestoreCodeWindowState', 'code/didRestoreCodeWindowState') : undefined,\n\t\t\t\tellapsedBrowserWindowCreate: initialStartup ? this._marks.getDuration('code/willCreateCodeBrowserWindow', 'code/didCreateCodeBrowserWindow') : undefined,\n\t\t\t\tellapsedWindowMaximize: initialStartup ? this._marks.getDuration('code/willMaximizeCodeWindow', 'code/didMaximizeCodeWindow') : undefined,\n\t\t\t\tellapsedWindowLoad: initialStartup ? this._marks.getDuration('code/mainAppReady', 'code/willOpenNewWindow') : undefined,\n\t\t\t\tellapsedWindowLoadToRequire: this._marks.getDuration('code/willOpenNewWindow', 'code/willLoadWorkbenchMain'),\n\t\t\t\tellapsedRequire: this._marks.getDuration('code/willLoadWorkbenchMain', 'code/didLoadWorkbenchMain'),\n\t\t\t\tellapsedWaitForWindowConfig: this._marks.getDuration('code/willWaitForWindowConfig', 'code/didWaitForWindowConfig'),\n\t\t\t\tellapsedStorageInit: this._marks.getDuration('code/willInitStorage', 'code/didInitStorage'),\n\t\t\t\tellapsedSharedProcesConnected: this._marks.getDuration('code/willConnectSharedProcess', 'code/didConnectSharedProcess'),\n\t\t\t\tellapsedWorkspaceServiceInit: this._marks.getDuration('code/willInitWorkspaceService', 'code/didInitWorkspaceService'),\n\t\t\t\tellapsedRequiredUserDataInit: this._marks.getDuration('code/willInitRequiredUserData', 'code/didInitRequiredUserData'),\n\t\t\t\tellapsedOtherUserDataInit: this._marks.getDuration('code/willInitOtherUserData', 'code/didInitOtherUserData'),\n\t\t\t\tellapsedExtensions: this._marks.getDuration('code/willLoadExtensions', 'code/didLoadExtensions'),\n\t\t\t\tellapsedEditorRestore: this._marks.getDuration('code/willRestoreEditors', 'code/didRestoreEditors'),\n\t\t\t\tellapsedViewletRestore: this._marks.getDuration('code/willRestoreViewlet', 'code/didRestoreViewlet'),\n\t\t\t\tellapsedAuxiliaryViewletRestore: this._marks.getDuration('code/willRestoreAuxiliaryBar', 'code/didRestoreAuxiliaryBar'),\n\t\t\t\tellapsedPanelRestore: this._marks.getDuration('code/willRestorePanel', 'code/didRestorePanel'),\n\t\t\t\tellapsedWorkbenchContributions: this._marks.getDuration('code/willCreateWorkbenchContributions/1', 'code/didCreateWorkbenchContributions/2'),\n\t\t\t\tellapsedWorkbench: this._marks.getDuration('code/willStartWorkbench', 'code/didStartWorkbench'),\n\t\t\t\tellapsedExtensionsReady: this._marks.getDuration(startMark, 'code/didLoadExtensions'),\n\t\t\t\tellapsedRenderer: this._marks.getDuration('code/didStartRenderer', 'code/didStartWorkbench')\n\t\t\t},\n\n\t\t\t// system info\n\t\t\tplatform: undefined,\n\t\t\trelease: undefined,\n\t\t\tarch: undefined,\n\t\t\ttotalmem: undefined,\n\t\t\tfreemem: undefined,\n\t\t\tmeminfo: undefined,\n\t\t\tcpus: undefined,\n\t\t\tloadavg: undefined,\n\t\t\tisVMLikelyhood: undefined,\n\t\t\tinitialStartup,\n\t\t\thasAccessibilitySupport: this._accessibilityService.isScreenReaderOptimized(),\n\t\t\temptyWorkbench: this._contextService.getWorkbenchState() === WorkbenchState.EMPTY\n\t\t};\n\n\t\tawait this._extendStartupInfo(info);\n\t\treturn info;\n\t}\n\n\tprotected abstract _isInitialStartup(): boolean;\n\n\tprotected abstract _didUseCachedData(): boolean;\n\n\tprotected abstract _getWindowCount(): Promise<number>;\n\n\tprotected abstract _extendStartupInfo(info: Writeable<IStartupMetrics>): Promise<void>;\n}\n\n\nexport class TimerService extends AbstractTimerService {\n\n\tprotected _isInitialStartup(): boolean {\n\t\treturn false;\n\t}\n\tprotected _didUseCachedData(): boolean {\n\t\treturn false;\n\t}\n\tprotected async _getWindowCount(): Promise<number> {\n\t\treturn 1;\n\t}\n\tprotected async _extendStartupInfo(info: Writeable<IStartupMetrics>): Promise<void> {\n\t\tinfo.isVMLikelyhood = 0;\n\t\tinfo.isARM64Emulated = false;\n\t\tinfo.platform = navigator.userAgent;\n\t\tinfo.release = navigator.appVersion;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as perf from '../../../../base/common/performance.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkspaceContextService, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\nimport { IUpdateService } from '../../../../platform/update/common/update.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ITelemetryData, ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { Barrier, timeout } from '../../../../base/common/async.js';\nimport { IWorkbenchLayoutService } from '../../layout/browser/layoutService.js';\nimport { IPaneCompositePartService } from '../../panecomposite/browser/panecomposite.js';\nimport { ViewContainerLocation } from '../../../common/views.js';\nimport { TelemetryTrustedValue } from '../../../../platform/telemetry/common/telemetryUtils.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { createBlobWorker } from '../../../../platform/webWorker/browser/webWorkerServiceImpl.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ITerminalBackendRegistry, TerminalExtensions } from '../../../../platform/terminal/common/terminal.js';\n\n/* __GDPR__FRAGMENT__\n\t\"IMemoryInfo\" : {\n\t\t\"workingSetSize\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"privateBytes\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"sharedBytes\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true }\n\t}\n*/\nexport interface IMemoryInfo {\n\treadonly workingSetSize: number;\n\treadonly privateBytes: number;\n\treadonly sharedBytes: number;\n}\n\n/* __GDPR__FRAGMENT__\n\t\"IStartupMetrics\" : {\n\t\t\"ellapsed\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"isLatestVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"didUseCachedData\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"windowKind\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"windowCount\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"viewletId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"panelId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"editorIds\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"timers.ellapsedAppReady\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedNlsGeneration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedLoadMainBundle\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRunMainBundle\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedCrashReporter\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedMainServer\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowCreate\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowLoad\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWindowLoadToRequire\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWaitForWindowConfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedStorageInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkspaceServiceInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedSharedProcesConnected\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRequiredUserDataInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedOtherUserDataInit\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedRequire\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedExtensions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedExtensionsReady\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedViewletRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedAuxiliaryViewletRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedPanelRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedEditorRestore\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkbenchContributions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"timers.ellapsedWorkbench\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"platform\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"release\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"arch\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"totalmem\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"freemem\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"meminfo\" : { \"${inline}\": [ \"${IMemoryInfo}\" ] },\n\t\t\"cpus.count\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"cpus.speed\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"cpus.model\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"initialStartup\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"hasAccessibilitySupport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"isVMLikelyhood\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"emptyWorkbench\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true },\n\t\t\"loadavg\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\"isARM64Emulated\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\", \"isMeasurement\": true }\n\t}\n*/\nexport interface IStartupMetrics {\n\n\t/**\n\t * If this started the main process and renderer or just a renderer (new or reloaded).\n\t */\n\treadonly initialStartup: boolean;\n\n\t/**\n\t * No folder, no file, no workspace has been opened\n\t */\n\treadonly emptyWorkbench: boolean;\n\n\t/**\n\t * This is the latest (stable/insider) version. Iff not we should ignore this\n\t * measurement.\n\t */\n\treadonly isLatestVersion: boolean;\n\n\t/**\n\t * Whether we asked for and V8 accepted cached data.\n\t */\n\treadonly didUseCachedData: boolean;\n\n\t/**\n\t * How/why the window was created. See https://github.com/microsoft/vscode/blob/d1f57d871722f4d6ba63e4ef6f06287121ceb045/src/vs/platform/lifecycle/common/lifecycle.ts#L50\n\t */\n\treadonly windowKind: number;\n\n\t/**\n\t * The total number of windows that have been restored/created\n\t */\n\treadonly windowCount: number;\n\n\t/**\n\t * The active viewlet id or `undedined`\n\t */\n\treadonly viewletId?: string;\n\n\t/**\n\t * The active auxiliary viewlet id or `undedined`\n\t */\n\treadonly auxiliaryViewletId?: string;\n\n\t/**\n\t * The active panel id or `undefined`\n\t */\n\treadonly panelId?: string;\n\n\t/**\n\t * The editor input types or `[]`\n\t */\n\treadonly editorIds: string[];\n\n\t/**\n\t * The time it took to create the workbench.\n\t *\n\t * * Happens in the main-process *and* the renderer-process\n\t * * Measured with the *start* and `didStartWorkbench`-performance mark. The *start* is either the start of the\n\t * main process or the start of the renderer.\n\t * * This should be looked at carefully because times vary depending on\n\t *  * This being the first window, the only window, or a reloaded window\n\t *  * Cached data being present and used or not\n\t *  * The numbers and types of editors being restored\n\t *  * The numbers of windows being restored (when starting 'fresh')\n\t *  * The viewlet being restored (esp. when it's a contributed viewlet)\n\t */\n\treadonly ellapsed: number;\n\n\t/**\n\t * Individual timers...\n\t */\n\treadonly timers: {\n\t\t/**\n\t\t * The time it took to receieve the [`ready`](https://electronjs.org/docs/api/app#event-ready)-event. Measured from the first line\n\t\t * of JavaScript code till receiving that event.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `main:started` and `main:appReady` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * This should be looked at per OS version and per electron version.\n\t\t * * This is often affected by AV software (and can change with AV software updates outside of our release-cycle).\n\t\t * * It is not our code running here and we can only observe what's happening.\n\t\t */\n\t\treadonly ellapsedAppReady?: number;\n\n\t\t/**\n\t\t * The time it took to generate NLS data.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `nlsGeneration:start` and `nlsGeneration:end` performance marks.\n\t\t * * This only happens when a non-english locale is being used.\n\t\t * * It is our code running here and we should monitor this carefully for regressions.\n\t\t */\n\t\treadonly ellapsedNlsGeneration?: number;\n\n\t\t/**\n\t\t * The time it took to load the main bundle.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willLoadMainBundle` and `didLoadMainBundle` performance marks.\n\t\t */\n\t\treadonly ellapsedLoadMainBundle?: number;\n\n\t\t/**\n\t\t * The time it took to run the main bundle.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `didStartMain` and `didRunMainBundle` performance marks.\n\t\t */\n\t\treadonly ellapsedRunMainBundle?: number;\n\n\t\t/**\n\t\t * The time it took to start the crash reporter.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willStartCrashReporter` and `didStartCrashReporter` performance marks.\n\t\t */\n\t\treadonly ellapsedCrashReporter?: number;\n\n\t\t/**\n\t\t * The time it took to create the main instance server.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willStartMainServer` and `didStartMainServer` performance marks.\n\t\t */\n\t\treadonly ellapsedMainServer?: number;\n\n\t\t/**\n\t\t * The time it took to create the window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willCreateCodeWindow` and `didCreateCodeWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowCreate?: number;\n\n\t\t/**\n\t\t * The time it took to create the electron browser window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willCreateCodeBrowserWindow` and `didCreateCodeBrowserWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedBrowserWindowCreate?: number;\n\n\t\t/**\n\t\t * The time it took to restore and validate window state.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willRestoreCodeWindowState` and `didRestoreCodeWindowState` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowRestoreState?: number;\n\n\t\t/**\n\t\t * The time it took to maximize/show the window.\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `willMaximizeCodeWindow` and `didMaximizeCodeWindow` performance marks.\n\t\t */\n\t\treadonly ellapsedWindowMaximize?: number;\n\n\t\t/**\n\t\t * The time it took to tell electron to open/restore a renderer (browser window).\n\t\t *\n\t\t * * Happens in the main-process\n\t\t * * Measured with the `main:appReady` and `code/willOpenNewWindow` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * It is our code running here and we should monitor this carefully for regressions.\n\t\t */\n\t\treadonly ellapsedWindowLoad?: number;\n\n\t\t/**\n\t\t * The time it took to create a new renderer (browser window) and to initialize that to the point\n\t\t * of load the main-bundle (`workbench.desktop.main.js`).\n\t\t *\n\t\t * * Happens in the main-process *and* the renderer-process\n\t\t * * Measured with the `code/willOpenNewWindow` and `willLoadWorkbenchMain` performance marks.\n\t\t * * This can be compared between insider and stable builds.\n\t\t * * It is mostly not our code running here and we can only observe what's happening.\n\t\t *\n\t\t */\n\t\treadonly ellapsedWindowLoadToRequire: number;\n\n\t\t/**\n\t\t * The time it took to wait for resolving the window configuration. This time the workbench\n\t\t * will not continue to load and be blocked entirely.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willWaitForWindowConfig` and `didWaitForWindowConfig` performance marks.\n\t\t */\n\t\treadonly ellapsedWaitForWindowConfig: number;\n\n\t\t/**\n\t\t * The time it took to init the storage database connection from the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `code/willInitStorage` and `code/didInitStorage` performance marks.\n\t\t */\n\t\treadonly ellapsedStorageInit: number;\n\n\t\t/**\n\t\t * The time it took to initialize the workspace and configuration service.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willInitWorkspaceService` and `didInitWorkspaceService` performance marks.\n\t\t */\n\t\treadonly ellapsedWorkspaceServiceInit: number;\n\n\t\t/**\n\t\t * The time it took to connect to the shared process.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willConnectSharedProcess` and `didConnectSharedProcess` performance marks.\n\t\t */\n\t\treadonly ellapsedSharedProcesConnected: number;\n\n\t\t/**\n\t\t * The time it took to initialize required user data (settings & global state) using settings sync service.\n\t\t *\n\t\t * * Happens in the renderer-process (only in Web)\n\t\t * * Measured with the `willInitRequiredUserData` and `didInitRequiredUserData` performance marks.\n\t\t */\n\t\treadonly ellapsedRequiredUserDataInit: number;\n\n\t\t/**\n\t\t * The time it took to initialize other user data (keybindings, snippets & extensions) using settings sync service.\n\t\t *\n\t\t * * Happens in the renderer-process (only in Web)\n\t\t * * Measured with the `willInitOtherUserData` and `didInitOtherUserData` performance marks.\n\t\t */\n\t\treadonly ellapsedOtherUserDataInit: number;\n\n\t\t/**\n\t\t * The time it took to load the main-bundle of the workbench, e.g. `workbench.desktop.main.js`.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willLoadWorkbenchMain` and `didLoadWorkbenchMain` performance marks.\n\t\t * * This varies *a lot* when V8 cached data could be used or not\n\t\t * * This should be looked at with and without V8 cached data usage and per electron/v8 version\n\t\t * * This is affected by the size of our code bundle (which  grows about 3-5% per release)\n\t\t */\n\t\treadonly ellapsedRequire: number;\n\n\t\t/**\n\t\t * The time it took to read extensions' package.json-files *and* interpret them (invoking\n\t\t * the contribution points).\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willLoadExtensions` and `didLoadExtensions` performance marks.\n\t\t * * Reading of package.json-files is avoided by caching them all in a single file (after the read,\n\t\t * until another extension is installed)\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedExtensions: number;\n\n\t\t// the time from start till `didLoadExtensions`\n\t\t// remove?\n\t\treadonly ellapsedExtensionsReady: number;\n\n\t\t/**\n\t\t * The time it took to restore the primary sidebar viewlet.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreViewlet` and `didRestoreViewlet` performance marks.\n\t\t * * This should be looked at per viewlet-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedViewletRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore the auxiliary bar viewlet.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreAuxiliaryBar` and `didRestoreAuxiliaryBar` performance marks.\n\t\t * * This should be looked at per viewlet-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedAuxiliaryViewletRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore the panel.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestorePanel` and `didRestorePanel` performance marks.\n\t\t * * This should be looked at per panel-type/id.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedPanelRestore: number;\n\n\t\t/**\n\t\t * The time it took to restore and fully resolve visible editors - that is text editor\n\t\t * and complex editor likes the settings UI or webviews (markdown preview).\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willRestoreEditors` and `didRestoreEditors` performance marks.\n\t\t * * This should be looked at per editor and per editor type.\n\t\t * * Happens in parallel to other things, depends on async timing\n\t\t */\n\t\treadonly ellapsedEditorRestore: number;\n\n\t\t/**\n\t\t * The time it took to create all workbench contributions on the starting and ready\n\t\t * lifecycle phase, thus blocking `ellapsedWorkbench`.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willCreateWorkbenchContributions/1` and `didCreateWorkbenchContributions/2` performance marks.\n\t\t *\n\t\t */\n\t\treadonly ellapsedWorkbenchContributions: number;\n\n\t\t/**\n\t\t * The time it took to create the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `willStartWorkbench` and `didStartWorkbench` performance marks.\n\t\t */\n\t\treadonly ellapsedWorkbench: number;\n\n\t\t/**\n\t\t * This time it took inside the renderer to start the workbench.\n\t\t *\n\t\t * * Happens in the renderer-process\n\t\t * * Measured with the `renderer/started` and `didStartWorkbench` performance marks\n\t\t */\n\t\treadonly ellapsedRenderer: number;\n\t};\n\n\treadonly hasAccessibilitySupport: boolean;\n\treadonly isVMLikelyhood?: number;\n\treadonly platform?: string;\n\treadonly release?: string;\n\treadonly arch?: string;\n\treadonly totalmem?: number;\n\treadonly freemem?: number;\n\treadonly meminfo?: IMemoryInfo;\n\treadonly cpus?: { count: number; speed: number; model: string };\n\treadonly loadavg?: number[];\n\treadonly isARM64Emulated?: boolean;\n}\n\nexport interface ITimerService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * A promise that resolved when startup timings and perf marks\n\t * are available. This depends on lifecycle phases and extension\n\t * hosts being started.\n\t */\n\twhenReady(): Promise<boolean>;\n\n\t/**\n\t * A baseline performance indicator for this machine. The value will only available\n\t * late after startup because computing it takes away CPU resources\n\t *\n\t * NOTE that this returns -1 if the machine is hopelessly slow...\n\t */\n\tperfBaseline: Promise<number>;\n\n\t/**\n\t * Startup metrics. Can ONLY be accessed after `whenReady` has resolved.\n\t */\n\treadonly startupMetrics: IStartupMetrics;\n\n\t/**\n\t * Deliver performance marks from a source, like the main process or extension hosts.\n\t * The source argument acts as an identifier and therefore it must be unique.\n\t */\n\tsetPerformanceMarks(source: string, marks: perf.PerformanceMark[]): void;\n\n\t/**\n\t * Get all currently known performance marks by source. There is no sorting of the\n\t * returned tuples but the marks of a tuple are guaranteed to be sorted by start times.\n\t */\n\tgetPerformanceMarks(): [source: string, marks: readonly perf.PerformanceMark[]][];\n\n\t/**\n\t * Return the duration between two marks.\n\t * @param from from mark name\n\t * @param to to mark name\n\t */\n\tgetDuration(from: string, to: string): number;\n\n\t/**\n\t * Return the timestamp of a mark.\n\t * @param mark mark name\n\t */\n\tgetStartTime(mark: string): number;\n}\n\nexport const ITimerService = createDecorator<ITimerService>('timerService');\n\n\nclass PerfMarks {\n\n\tprivate readonly _entries: [string, perf.PerformanceMark[]][] = [];\n\n\tsetMarks(source: string, entries: perf.PerformanceMark[]): void {\n\t\tthis._entries.push([source, entries]);\n\t}\n\n\tgetDuration(from: string, to: string): number {\n\t\tconst fromEntry = this._findEntry(from);\n\t\tif (!fromEntry) {\n\t\t\treturn 0;\n\t\t}\n\t\tconst toEntry = this._findEntry(to);\n\t\tif (!toEntry) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn toEntry.startTime - fromEntry.startTime;\n\t}\n\n\tgetStartTime(mark: string): number {\n\t\tconst entry = this._findEntry(mark);\n\t\treturn entry ? entry.startTime : -1;\n\t}\n\n\tprivate _findEntry(name: string): perf.PerformanceMark | void {\n\t\tfor (const [, marks] of this._entries) {\n\t\t\tfor (let i = marks.length - 1; i >= 0; i--) {\n\t\t\t\tif (marks[i].name === name) {\n\t\t\t\t\treturn marks[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEntries() {\n\t\treturn this._entries.slice(0);\n\t}\n}\n\nexport type Writeable<T> = { -readonly [P in keyof T]: Writeable<T[P]> };\n\nexport abstract class AbstractTimerService implements ITimerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _barrier = new Barrier();\n\tprivate readonly _marks = new PerfMarks();\n\tprivate readonly _rndValueShouldSendTelemetry = Math.random() < .03; // 3% of users\n\n\tprivate _startupMetrics?: IStartupMetrics;\n\n\treadonly perfBaseline: Promise<number>;\n\n\tconstructor(\n\t\t@ILifecycleService private readonly _lifecycleService: ILifecycleService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@IUpdateService private readonly _updateService: IUpdateService,\n\t\t@IPaneCompositePartService private readonly _paneCompositeService: IPaneCompositePartService,\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@IWorkbenchLayoutService layoutService: IWorkbenchLayoutService\n\t) {\n\t\tPromise.all([\n\t\t\tthis._extensionService.whenInstalledExtensionsRegistered(), // extensions registered\n\t\t\t_lifecycleService.when(LifecyclePhase.Restored),\t\t\t// workbench created and parts restored\n\t\t\tlayoutService.whenRestored,\t\t\t\t\t\t\t\t\t// layout restored (including visible editors resolved)\n\t\t\tPromise.all(Array.from(Registry.as<ITerminalBackendRegistry>(TerminalExtensions.Backend).backends.values()).map(e => e.whenReady))\n\t\t]).then(() => {\n\t\t\t// set perf mark from renderer\n\t\t\tthis.setPerformanceMarks('renderer', perf.getMarks());\n\t\t\treturn this._computeStartupMetrics();\n\t\t}).then(metrics => {\n\t\t\tthis._startupMetrics = metrics;\n\t\t\tthis._reportStartupTimes(metrics);\n\t\t\tthis._barrier.open();\n\t\t});\n\n\n\t\tthis.perfBaseline = this._barrier.wait()\n\t\t\t.then(() => this._lifecycleService.when(LifecyclePhase.Eventually))\n\t\t\t.then(() => timeout(this._startupMetrics!.timers.ellapsedRequire))\n\t\t\t.then(() => {\n\n\t\t\t\t// we use fibonacci numbers to have a performance baseline that indicates\n\t\t\t\t// how slow/fast THIS machine actually is.\n\n\t\t\t\tconst jsSrc = (function (this: WindowOrWorkerGlobalScope) {\n\t\t\t\t\t// the following operation took ~16ms (one frame at 64FPS) to complete on my machine. We derive performance observations\n\t\t\t\t\t// from that. We also bail if that took too long (>1s)\n\t\t\t\t\tlet tooSlow = false;\n\t\t\t\t\tfunction fib(n: number): number {\n\t\t\t\t\t\tif (tooSlow) {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (performance.now() - t1 >= 1000) {\n\t\t\t\t\t\t\ttooSlow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (n <= 2) {\n\t\t\t\t\t\t\treturn n;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn fib(n - 1) + fib(n - 2);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst t1 = performance.now();\n\t\t\t\t\tfib(24);\n\t\t\t\t\tconst value = Math.round(performance.now() - t1);\n\t\t\t\t\tself.postMessage({ value: tooSlow ? -1 : value });\n\n\t\t\t\t}).toString();\n\n\t\t\t\tconst blob = new Blob([`(${jsSrc})();`], { type: 'application/javascript' });\n\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\n\n\t\t\t\tconst worker = createBlobWorker(blobUrl, { name: 'perfBaseline' });\n\t\t\t\treturn new Promise<number>(resolve => {\n\t\t\t\t\tworker.onmessage = e => resolve(e.data.value);\n\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tworker.terminate();\n\t\t\t\t\tURL.revokeObjectURL(blobUrl);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\twhenReady(): Promise<boolean> {\n\t\treturn this._barrier.wait();\n\t}\n\n\tget startupMetrics(): IStartupMetrics {\n\t\tif (!this._startupMetrics) {\n\t\t\tthrow new Error('illegal state, MUST NOT access startupMetrics before whenReady has resolved');\n\t\t}\n\t\treturn this._startupMetrics;\n\t}\n\n\tsetPerformanceMarks(source: string, marks: perf.PerformanceMark[]): void {\n\t\t// Perf marks are a shared resource because anyone can generate them\n\t\t// and because of that we only accept marks that start with 'code/'\n\t\tconst codeMarks = marks.filter(mark => mark.name.startsWith('code/'));\n\t\tthis._marks.setMarks(source, codeMarks);\n\t\tthis._reportPerformanceMarks(source, codeMarks);\n\t}\n\n\tgetPerformanceMarks(): [source: string, marks: readonly perf.PerformanceMark[]][] {\n\t\treturn this._marks.getEntries();\n\t}\n\n\tgetDuration(from: string, to: string): number {\n\t\treturn this._marks.getDuration(from, to);\n\t}\n\n\tgetStartTime(mark: string): number {\n\t\treturn this._marks.getStartTime(mark);\n\t}\n\n\tprivate _reportStartupTimes(metrics: IStartupMetrics): void {\n\t\t// report IStartupMetrics as telemetry\n\t\t/* __GDPR__\n\t\t\t\"startupTimeVaried\" : {\n\t\t\t\t\"owner\": \"jrieken\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${IStartupMetrics}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis._telemetryService.publicLog('startupTimeVaried', metrics as unknown as ITelemetryData);\n\t}\n\n\tprotected _shouldReportPerfMarks(): boolean {\n\t\treturn this._rndValueShouldSendTelemetry;\n\t}\n\n\tprivate _reportPerformanceMarks(source: string, marks: perf.PerformanceMark[]) {\n\n\t\tif (!this._shouldReportPerfMarks()) {\n\t\t\t// the `startup.timer.mark` event is send very often. In order to save resources\n\t\t\t// we let some of our instances/sessions send this event\n\t\t\treturn;\n\t\t}\n\n\t\t// report raw timers as telemetry. each mark is send a separate telemetry\n\t\t// event and it is \"normalized\" to a relative timestamp where the first mark\n\t\t// defines the start\n\n\t\ttype Mark = { source: string; name: TelemetryTrustedValue<string>; startTime: number };\n\t\ttype MarkClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Information about a performance marker';\n\t\t\tsource: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Where this marker was generated, e.g main, renderer, extension host' };\n\t\t\tname: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The name of this marker (as defined in source code)' };\n\t\t\tstartTime: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The absolute timestamp (unix time)' };\n\t\t};\n\n\t\tfor (const mark of marks) {\n\t\t\tthis._telemetryService.publicLog2<Mark, MarkClassification>('startup.timer.mark', {\n\t\t\t\tsource,\n\t\t\t\tname: new TelemetryTrustedValue(mark.name),\n\t\t\t\tstartTime: mark.startTime\n\t\t\t});\n\t\t}\n\n\t}\n\n\tprivate async _computeStartupMetrics(): Promise<IStartupMetrics> {\n\t\tconst initialStartup = this._isInitialStartup();\n\t\tlet startMark: string;\n\t\tif (isWeb) {\n\t\t\tstartMark = 'code/timeOrigin';\n\t\t} else {\n\t\t\tstartMark = initialStartup ? 'code/didStartMain' : 'code/willOpenNewWindow';\n\t\t}\n\n\t\tconst activeViewlet = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.Sidebar);\n\t\tconst activeAuxiliaryViewlet = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.AuxiliaryBar);\n\t\tconst activePanel = this._paneCompositeService.getActivePaneComposite(ViewContainerLocation.Panel);\n\t\tconst info: Writeable<IStartupMetrics> = {\n\n\t\t\tellapsed: this._marks.getDuration(startMark, 'code/didStartWorkbench'),\n\n\t\t\t// reflections\n\t\t\tisLatestVersion: Boolean(await this._updateService.isLatestVersion()),\n\t\t\tdidUseCachedData: this._didUseCachedData(),\n\t\t\twindowKind: this._lifecycleService.startupKind,\n\t\t\twindowCount: await this._getWindowCount(),\n\t\t\tviewletId: activeViewlet?.getId(),\n\t\t\tauxiliaryViewletId: activeAuxiliaryViewlet?.getId(),\n\t\t\teditorIds: this._editorService.visibleEditors.map(input => input.typeId),\n\t\t\tpanelId: activePanel ? activePanel.getId() : undefined,\n\n\t\t\t// timers\n\t\t\ttimers: {\n\t\t\t\tellapsedAppReady: initialStartup ? this._marks.getDuration('code/didStartMain', 'code/mainAppReady') : undefined,\n\t\t\t\tellapsedNlsGeneration: initialStartup ? this._marks.getDuration('code/willGenerateNls', 'code/didGenerateNls') : undefined,\n\t\t\t\tellapsedLoadMainBundle: initialStartup ? this._marks.getDuration('code/willLoadMainBundle', 'code/didLoadMainBundle') : undefined,\n\t\t\t\tellapsedRunMainBundle: initialStartup ? this._marks.getDuration('code/didStartMain', 'code/didRunMainBundle') : undefined,\n\t\t\t\tellapsedCrashReporter: initialStartup ? this._marks.getDuration('code/willStartCrashReporter', 'code/didStartCrashReporter') : undefined,\n\t\t\t\tellapsedMainServer: initialStartup ? this._marks.getDuration('code/willStartMainServer', 'code/didStartMainServer') : undefined,\n\t\t\t\tellapsedWindowCreate: initialStartup ? this._marks.getDuration('code/willCreateCodeWindow', 'code/didCreateCodeWindow') : undefined,\n\t\t\t\tellapsedWindowRestoreState: initialStartup ? this._marks.getDuration('code/willRestoreCodeWindowState', 'code/didRestoreCodeWindowState') : undefined,\n\t\t\t\tellapsedBrowserWindowCreate: initialStartup ? this._marks.getDuration('code/willCreateCodeBrowserWindow', 'code/didCreateCodeBrowserWindow') : undefined,\n\t\t\t\tellapsedWindowMaximize: initialStartup ? this._marks.getDuration('code/willMaximizeCodeWindow', 'code/didMaximizeCodeWindow') : undefined,\n\t\t\t\tellapsedWindowLoad: initialStartup ? this._marks.getDuration('code/mainAppReady', 'code/willOpenNewWindow') : undefined,\n\t\t\t\tellapsedWindowLoadToRequire: this._marks.getDuration('code/willOpenNewWindow', 'code/willLoadWorkbenchMain'),\n\t\t\t\tellapsedRequire: this._marks.getDuration('code/willLoadWorkbenchMain', 'code/didLoadWorkbenchMain'),\n\t\t\t\tellapsedWaitForWindowConfig: this._marks.getDuration('code/willWaitForWindowConfig', 'code/didWaitForWindowConfig'),\n\t\t\t\tellapsedStorageInit: this._marks.getDuration('code/willInitStorage', 'code/didInitStorage'),\n\t\t\t\tellapsedSharedProcesConnected: this._marks.getDuration('code/willConnectSharedProcess', 'code/didConnectSharedProcess'),\n\t\t\t\tellapsedWorkspaceServiceInit: this._marks.getDuration('code/willInitWorkspaceService', 'code/didInitWorkspaceService'),\n\t\t\t\tellapsedRequiredUserDataInit: this._marks.getDuration('code/willInitRequiredUserData', 'code/didInitRequiredUserData'),\n\t\t\t\tellapsedOtherUserDataInit: this._marks.getDuration('code/willInitOtherUserData', 'code/didInitOtherUserData'),\n\t\t\t\tellapsedExtensions: this._marks.getDuration('code/willLoadExtensions', 'code/didLoadExtensions'),\n\t\t\t\tellapsedEditorRestore: this._marks.getDuration('code/willRestoreEditors', 'code/didRestoreEditors'),\n\t\t\t\tellapsedViewletRestore: this._marks.getDuration('code/willRestoreViewlet', 'code/didRestoreViewlet'),\n\t\t\t\tellapsedAuxiliaryViewletRestore: this._marks.getDuration('code/willRestoreAuxiliaryBar', 'code/didRestoreAuxiliaryBar'),\n\t\t\t\tellapsedPanelRestore: this._marks.getDuration('code/willRestorePanel', 'code/didRestorePanel'),\n\t\t\t\tellapsedWorkbenchContributions: this._marks.getDuration('code/willCreateWorkbenchContributions/1', 'code/didCreateWorkbenchContributions/2'),\n\t\t\t\tellapsedWorkbench: this._marks.getDuration('code/willStartWorkbench', 'code/didStartWorkbench'),\n\t\t\t\tellapsedExtensionsReady: this._marks.getDuration(startMark, 'code/didLoadExtensions'),\n\t\t\t\tellapsedRenderer: this._marks.getDuration('code/didStartRenderer', 'code/didStartWorkbench')\n\t\t\t},\n\n\t\t\t// system info\n\t\t\tplatform: undefined,\n\t\t\trelease: undefined,\n\t\t\tarch: undefined,\n\t\t\ttotalmem: undefined,\n\t\t\tfreemem: undefined,\n\t\t\tmeminfo: undefined,\n\t\t\tcpus: undefined,\n\t\t\tloadavg: undefined,\n\t\t\tisVMLikelyhood: undefined,\n\t\t\tinitialStartup,\n\t\t\thasAccessibilitySupport: this._accessibilityService.isScreenReaderOptimized(),\n\t\t\temptyWorkbench: this._contextService.getWorkbenchState() === WorkbenchState.EMPTY\n\t\t};\n\n\t\tawait this._extendStartupInfo(info);\n\t\treturn info;\n\t}\n\n\tprotected abstract _isInitialStartup(): boolean;\n\n\tprotected abstract _didUseCachedData(): boolean;\n\n\tprotected abstract _getWindowCount(): Promise<number>;\n\n\tprotected abstract _extendStartupInfo(info: Writeable<IStartupMetrics>): Promise<void>;\n}\n\n\nexport class TimerService extends AbstractTimerService {\n\n\tprotected _isInitialStartup(): boolean {\n\t\treturn false;\n\t}\n\tprotected _didUseCachedData(): boolean {\n\t\treturn false;\n\t}\n\tprotected async _getWindowCount(): Promise<number> {\n\t\treturn 1;\n\t}\n\tprotected async _extendStartupInfo(info: Writeable<IStartupMetrics>): Promise<void> {\n\t\tinfo.isVMLikelyhood = 0;\n\t\tinfo.isARM64Emulated = false;\n\t\tinfo.platform = navigator.userAgent;\n\t\tinfo.release = navigator.appVersion;\n\t}\n}\n"]}