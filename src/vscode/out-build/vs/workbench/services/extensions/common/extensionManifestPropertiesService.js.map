{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/extensions/common/extensionManifestPropertiesService.ts","vs/workbench/services/extensions/common/extensionManifestPropertiesService.ts"],"names":[],"mappings":"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","file":"extensionManifestPropertiesService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IExtensionManifest, ExtensionUntrustedWorkspaceSupportType, ExtensionVirtualWorkspaceSupportType, IExtensionIdentifier, ALL_EXTENSION_KINDS, ExtensionIdentifierMap } from '../../../../platform/extensions/common/extensions.js';\nimport { ExtensionKind } from '../../../../platform/environment/common/environment.js';\nimport { ExtensionsRegistry } from './extensionsRegistry.js';\nimport { getGalleryExtensionId } from '../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ExtensionUntrustedWorkspaceSupport } from '../../../../base/common/product.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { WORKSPACE_TRUST_EXTENSION_SUPPORT } from '../../workspaces/common/workspaceTrust.js';\nimport { isBoolean } from '../../../../base/common/types.js';\nimport { IWorkspaceTrustEnablementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { isWeb } from '../../../../base/common/platform.js';\n\nexport const IExtensionManifestPropertiesService = createDecorator<IExtensionManifestPropertiesService>('extensionManifestPropertiesService');\n\nexport interface IExtensionManifestPropertiesService {\n\treadonly _serviceBrand: undefined;\n\n\tprefersExecuteOnUI(manifest: IExtensionManifest): boolean;\n\tprefersExecuteOnWorkspace(manifest: IExtensionManifest): boolean;\n\tprefersExecuteOnWeb(manifest: IExtensionManifest): boolean;\n\n\tcanExecuteOnUI(manifest: IExtensionManifest): boolean;\n\tcanExecuteOnWorkspace(manifest: IExtensionManifest): boolean;\n\tcanExecuteOnWeb(manifest: IExtensionManifest): boolean;\n\n\tgetExtensionKind(manifest: IExtensionManifest): ExtensionKind[];\n\tgetUserConfiguredExtensionKind(extensionIdentifier: IExtensionIdentifier): ExtensionKind[] | undefined;\n\tgetExtensionUntrustedWorkspaceSupportType(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType;\n\tgetExtensionVirtualWorkspaceSupportType(manifest: IExtensionManifest): ExtensionVirtualWorkspaceSupportType;\n}\n\nexport class ExtensionManifestPropertiesService extends Disposable implements IExtensionManifestPropertiesService {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _extensionPointExtensionKindsMap: Map<string, ExtensionKind[]> | null = null;\n\tprivate _productExtensionKindsMap: ExtensionIdentifierMap<ExtensionKind[]> | null = null;\n\tprivate _configuredExtensionKindsMap: ExtensionIdentifierMap<ExtensionKind | ExtensionKind[]> | null = null;\n\n\tprivate _productVirtualWorkspaceSupportMap: ExtensionIdentifierMap<{ default?: boolean; override?: boolean }> | null = null;\n\tprivate _configuredVirtualWorkspaceSupportMap: ExtensionIdentifierMap<boolean> | null = null;\n\n\tprivate readonly _configuredExtensionWorkspaceTrustRequestMap: ExtensionIdentifierMap<{ supported: ExtensionUntrustedWorkspaceSupportType; version?: string }>;\n\tprivate readonly _productExtensionWorkspaceTrustRequestMap: Map<string, ExtensionUntrustedWorkspaceSupport>;\n\n\tconstructor(\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspaceTrustEnablementService private readonly workspaceTrustEnablementService: IWorkspaceTrustEnablementService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\n\t\t// Workspace trust request type (settings.json)\n\t\tthis._configuredExtensionWorkspaceTrustRequestMap = new ExtensionIdentifierMap<{ supported: ExtensionUntrustedWorkspaceSupportType; version?: string }>();\n\t\tconst configuredExtensionWorkspaceTrustRequests = configurationService.inspect<{ [key: string]: { supported: ExtensionUntrustedWorkspaceSupportType; version?: string } }>(WORKSPACE_TRUST_EXTENSION_SUPPORT).userValue || {};\n\t\tfor (const id of Object.keys(configuredExtensionWorkspaceTrustRequests)) {\n\t\t\tthis._configuredExtensionWorkspaceTrustRequestMap.set(id, configuredExtensionWorkspaceTrustRequests[id]);\n\t\t}\n\n\t\t// Workspace trust request type (product.json)\n\t\tthis._productExtensionWorkspaceTrustRequestMap = new Map<string, ExtensionUntrustedWorkspaceSupport>();\n\t\tif (productService.extensionUntrustedWorkspaceSupport) {\n\t\t\tfor (const id of Object.keys(productService.extensionUntrustedWorkspaceSupport)) {\n\t\t\t\tthis._productExtensionWorkspaceTrustRequestMap.set(id, productService.extensionUntrustedWorkspaceSupport[id]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprefersExecuteOnUI(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'ui');\n\t}\n\n\tprefersExecuteOnWorkspace(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'workspace');\n\t}\n\n\tprefersExecuteOnWeb(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'web');\n\t}\n\n\tcanExecuteOnUI(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'ui');\n\t}\n\n\tcanExecuteOnWorkspace(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'workspace');\n\t}\n\n\tcanExecuteOnWeb(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'web');\n\t}\n\n\tgetExtensionKind(manifest: IExtensionManifest): ExtensionKind[] {\n\t\tconst deducedExtensionKind = this.deduceExtensionKind(manifest);\n\t\tconst configuredExtensionKind = this.getConfiguredExtensionKind(manifest);\n\n\t\tif (configuredExtensionKind && configuredExtensionKind.length > 0) {\n\t\t\tconst result: ExtensionKind[] = [];\n\t\t\tfor (const extensionKind of configuredExtensionKind) {\n\t\t\t\tif (extensionKind !== '-web') {\n\t\t\t\t\tresult.push(extensionKind);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If opted out from web without specifying other extension kinds then default to ui, workspace\n\t\t\tif (configuredExtensionKind.includes('-web') && !result.length) {\n\t\t\t\tresult.push('ui');\n\t\t\t\tresult.push('workspace');\n\t\t\t}\n\n\t\t\t// Add web kind if not opted out from web and can run in web\n\t\t\tif (isWeb && !configuredExtensionKind.includes('-web') && !configuredExtensionKind.includes('web') && deducedExtensionKind.includes('web')) {\n\t\t\t\tresult.push('web');\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn deducedExtensionKind;\n\t}\n\n\tgetUserConfiguredExtensionKind(extensionIdentifier: IExtensionIdentifier): ExtensionKind[] | undefined {\n\t\tif (this._configuredExtensionKindsMap === null) {\n\t\t\tconst configuredExtensionKindsMap = new ExtensionIdentifierMap<ExtensionKind | ExtensionKind[]>();\n\t\t\tconst configuredExtensionKinds = this.configurationService.getValue<{ [key: string]: ExtensionKind | ExtensionKind[] }>('remote.extensionKind') || {};\n\t\t\tfor (const id of Object.keys(configuredExtensionKinds)) {\n\t\t\t\tconfiguredExtensionKindsMap.set(id, configuredExtensionKinds[id]);\n\t\t\t}\n\t\t\tthis._configuredExtensionKindsMap = configuredExtensionKindsMap;\n\t\t}\n\n\t\tconst userConfiguredExtensionKind = this._configuredExtensionKindsMap.get(extensionIdentifier.id);\n\t\treturn userConfiguredExtensionKind ? this.toArray(userConfiguredExtensionKind) : undefined;\n\t}\n\n\tgetExtensionUntrustedWorkspaceSupportType(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType {\n\t\t// Workspace trust feature is disabled, or extension has no entry point\n\t\tif (!this.workspaceTrustEnablementService.isWorkspaceTrustEnabled() || !manifest.main) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Get extension workspace trust requirements from settings.json\n\t\tconst configuredWorkspaceTrustRequest = this.getConfiguredExtensionWorkspaceTrustRequest(manifest);\n\n\t\t// Get extension workspace trust requirements from product.json\n\t\tconst productWorkspaceTrustRequest = this.getProductExtensionWorkspaceTrustRequest(manifest);\n\n\t\t// Use settings.json override value if it exists\n\t\tif (configuredWorkspaceTrustRequest !== undefined) {\n\t\t\treturn configuredWorkspaceTrustRequest;\n\t\t}\n\n\t\t// Use product.json override value if it exists\n\t\tif (productWorkspaceTrustRequest?.override !== undefined) {\n\t\t\treturn productWorkspaceTrustRequest.override;\n\t\t}\n\n\t\t// Use extension manifest value if it exists\n\t\tif (manifest.capabilities?.untrustedWorkspaces?.supported !== undefined) {\n\t\t\treturn manifest.capabilities.untrustedWorkspaces.supported;\n\t\t}\n\n\t\t// Use product.json default value if it exists\n\t\tif (productWorkspaceTrustRequest?.default !== undefined) {\n\t\t\treturn productWorkspaceTrustRequest.default;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetExtensionVirtualWorkspaceSupportType(manifest: IExtensionManifest): ExtensionVirtualWorkspaceSupportType {\n\t\t// check user configured\n\t\tconst userConfiguredVirtualWorkspaceSupport = this.getConfiguredVirtualWorkspaceSupport(manifest);\n\t\tif (userConfiguredVirtualWorkspaceSupport !== undefined) {\n\t\t\treturn userConfiguredVirtualWorkspaceSupport;\n\t\t}\n\n\t\tconst productConfiguredWorkspaceSchemes = this.getProductVirtualWorkspaceSupport(manifest);\n\n\t\t// check override from product\n\t\tif (productConfiguredWorkspaceSchemes?.override !== undefined) {\n\t\t\treturn productConfiguredWorkspaceSchemes.override;\n\t\t}\n\n\t\t// check the manifest\n\t\tconst virtualWorkspaces = manifest.capabilities?.virtualWorkspaces;\n\t\tif (isBoolean(virtualWorkspaces)) {\n\t\t\treturn virtualWorkspaces;\n\t\t} else if (virtualWorkspaces) {\n\t\t\tconst supported = virtualWorkspaces.supported;\n\t\t\tif (isBoolean(supported) || supported === 'limited') {\n\t\t\t\treturn supported;\n\t\t\t}\n\t\t}\n\n\t\t// check default from product\n\t\tif (productConfiguredWorkspaceSchemes?.default !== undefined) {\n\t\t\treturn productConfiguredWorkspaceSchemes.default;\n\t\t}\n\n\t\t// Default - supports virtual workspace\n\t\treturn true;\n\t}\n\n\tprivate deduceExtensionKind(manifest: IExtensionManifest): ExtensionKind[] {\n\t\t// Not an UI extension if it has main\n\t\tif (manifest.main) {\n\t\t\tif (manifest.browser) {\n\t\t\t\treturn isWeb ? ['workspace', 'web'] : ['workspace'];\n\t\t\t}\n\t\t\treturn ['workspace'];\n\t\t}\n\n\t\tif (manifest.browser) {\n\t\t\treturn ['web'];\n\t\t}\n\n\t\tlet result = [...ALL_EXTENSION_KINDS];\n\n\t\tif (isNonEmptyArray(manifest.extensionPack) || isNonEmptyArray(manifest.extensionDependencies)) {\n\t\t\t// Extension pack defaults to [workspace, web] in web and only [workspace] in desktop\n\t\t\tresult = isWeb ? ['workspace', 'web'] : ['workspace'];\n\t\t}\n\n\t\tif (manifest.contributes) {\n\t\t\tfor (const contribution of Object.keys(manifest.contributes)) {\n\t\t\t\tconst supportedExtensionKinds = this.getSupportedExtensionKindsForExtensionPoint(contribution);\n\t\t\t\tif (supportedExtensionKinds.length) {\n\t\t\t\t\tresult = result.filter(extensionKind => supportedExtensionKinds.includes(extensionKind));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!result.length) {\n\t\t\tthis.logService.warn('Cannot deduce extensionKind for extension', getGalleryExtensionId(manifest.publisher, manifest.name));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate getSupportedExtensionKindsForExtensionPoint(extensionPoint: string): ExtensionKind[] {\n\t\tif (this._extensionPointExtensionKindsMap === null) {\n\t\t\tconst extensionPointExtensionKindsMap = new Map<string, ExtensionKind[]>();\n\t\t\tExtensionsRegistry.getExtensionPoints().forEach(e => extensionPointExtensionKindsMap.set(e.name, e.defaultExtensionKind || [] /* supports all */));\n\t\t\tthis._extensionPointExtensionKindsMap = extensionPointExtensionKindsMap;\n\t\t}\n\n\t\tlet extensionPointExtensionKind = this._extensionPointExtensionKindsMap.get(extensionPoint);\n\t\tif (extensionPointExtensionKind) {\n\t\t\treturn extensionPointExtensionKind;\n\t\t}\n\n\t\textensionPointExtensionKind = this.productService.extensionPointExtensionKind ? this.productService.extensionPointExtensionKind[extensionPoint] : undefined;\n\t\tif (extensionPointExtensionKind) {\n\t\t\treturn extensionPointExtensionKind;\n\t\t}\n\n\t\t/* Unknown extension point */\n\t\treturn isWeb ? ['workspace', 'web'] : ['workspace'];\n\t}\n\n\tprivate getConfiguredExtensionKind(manifest: IExtensionManifest): (ExtensionKind | '-web')[] | null {\n\t\tconst extensionIdentifier = { id: getGalleryExtensionId(manifest.publisher, manifest.name) };\n\n\t\t// check in config\n\t\tlet result: ExtensionKind | ExtensionKind[] | undefined = this.getUserConfiguredExtensionKind(extensionIdentifier);\n\t\tif (typeof result !== 'undefined') {\n\t\t\treturn this.toArray(result);\n\t\t}\n\n\t\t// check product.json\n\t\tresult = this.getProductExtensionKind(manifest);\n\t\tif (typeof result !== 'undefined') {\n\t\t\treturn result;\n\t\t}\n\n\t\t// check the manifest itself\n\t\tresult = manifest.extensionKind;\n\t\tif (typeof result !== 'undefined') {\n\t\t\tresult = this.toArray(result);\n\t\t\treturn result.filter(r => ['ui', 'workspace'].includes(r));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate getProductExtensionKind(manifest: IExtensionManifest): ExtensionKind[] | undefined {\n\t\tif (this._productExtensionKindsMap === null) {\n\t\t\tconst productExtensionKindsMap = new ExtensionIdentifierMap<ExtensionKind[]>();\n\t\t\tif (this.productService.extensionKind) {\n\t\t\t\tfor (const id of Object.keys(this.productService.extensionKind)) {\n\t\t\t\t\tproductExtensionKindsMap.set(id, this.productService.extensionKind[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._productExtensionKindsMap = productExtensionKindsMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productExtensionKindsMap.get(extensionId);\n\t}\n\n\tprivate getProductVirtualWorkspaceSupport(manifest: IExtensionManifest): { default?: boolean; override?: boolean } | undefined {\n\t\tif (this._productVirtualWorkspaceSupportMap === null) {\n\t\t\tconst productWorkspaceSchemesMap = new ExtensionIdentifierMap<{ default?: boolean; override?: boolean }>();\n\t\t\tif (this.productService.extensionVirtualWorkspacesSupport) {\n\t\t\t\tfor (const id of Object.keys(this.productService.extensionVirtualWorkspacesSupport)) {\n\t\t\t\t\tproductWorkspaceSchemesMap.set(id, this.productService.extensionVirtualWorkspacesSupport[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._productVirtualWorkspaceSupportMap = productWorkspaceSchemesMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productVirtualWorkspaceSupportMap.get(extensionId);\n\t}\n\n\tprivate getConfiguredVirtualWorkspaceSupport(manifest: IExtensionManifest): boolean | undefined {\n\t\tif (this._configuredVirtualWorkspaceSupportMap === null) {\n\t\t\tconst configuredWorkspaceSchemesMap = new ExtensionIdentifierMap<boolean>();\n\t\t\tconst configuredWorkspaceSchemes = this.configurationService.getValue<{ [key: string]: boolean }>('extensions.supportVirtualWorkspaces') || {};\n\t\t\tfor (const id of Object.keys(configuredWorkspaceSchemes)) {\n\t\t\t\tif (configuredWorkspaceSchemes[id] !== undefined) {\n\t\t\t\t\tconfiguredWorkspaceSchemesMap.set(id, configuredWorkspaceSchemes[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._configuredVirtualWorkspaceSupportMap = configuredWorkspaceSchemesMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._configuredVirtualWorkspaceSupportMap.get(extensionId);\n\t}\n\n\tprivate getConfiguredExtensionWorkspaceTrustRequest(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType | undefined {\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\tconst extensionWorkspaceTrustRequest = this._configuredExtensionWorkspaceTrustRequestMap.get(extensionId);\n\n\t\tif (extensionWorkspaceTrustRequest && (extensionWorkspaceTrustRequest.version === undefined || extensionWorkspaceTrustRequest.version === manifest.version)) {\n\t\t\treturn extensionWorkspaceTrustRequest.supported;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate getProductExtensionWorkspaceTrustRequest(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupport | undefined {\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productExtensionWorkspaceTrustRequestMap.get(extensionId);\n\t}\n\n\tprivate toArray(extensionKind: ExtensionKind | ExtensionKind[]): ExtensionKind[] {\n\t\tif (Array.isArray(extensionKind)) {\n\t\t\treturn extensionKind;\n\t\t}\n\t\treturn extensionKind === 'ui' ? ['ui', 'workspace'] : [extensionKind];\n\t}\n}\n\nregisterSingleton(IExtensionManifestPropertiesService, ExtensionManifestPropertiesService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IExtensionManifest, ExtensionUntrustedWorkspaceSupportType, ExtensionVirtualWorkspaceSupportType, IExtensionIdentifier, ALL_EXTENSION_KINDS, ExtensionIdentifierMap } from '../../../../platform/extensions/common/extensions.js';\nimport { ExtensionKind } from '../../../../platform/environment/common/environment.js';\nimport { ExtensionsRegistry } from './extensionsRegistry.js';\nimport { getGalleryExtensionId } from '../../../../platform/extensionManagement/common/extensionManagementUtil.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ExtensionUntrustedWorkspaceSupport } from '../../../../base/common/product.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { WORKSPACE_TRUST_EXTENSION_SUPPORT } from '../../workspaces/common/workspaceTrust.js';\nimport { isBoolean } from '../../../../base/common/types.js';\nimport { IWorkspaceTrustEnablementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { isWeb } from '../../../../base/common/platform.js';\n\nexport const IExtensionManifestPropertiesService = createDecorator<IExtensionManifestPropertiesService>('extensionManifestPropertiesService');\n\nexport interface IExtensionManifestPropertiesService {\n\treadonly _serviceBrand: undefined;\n\n\tprefersExecuteOnUI(manifest: IExtensionManifest): boolean;\n\tprefersExecuteOnWorkspace(manifest: IExtensionManifest): boolean;\n\tprefersExecuteOnWeb(manifest: IExtensionManifest): boolean;\n\n\tcanExecuteOnUI(manifest: IExtensionManifest): boolean;\n\tcanExecuteOnWorkspace(manifest: IExtensionManifest): boolean;\n\tcanExecuteOnWeb(manifest: IExtensionManifest): boolean;\n\n\tgetExtensionKind(manifest: IExtensionManifest): ExtensionKind[];\n\tgetUserConfiguredExtensionKind(extensionIdentifier: IExtensionIdentifier): ExtensionKind[] | undefined;\n\tgetExtensionUntrustedWorkspaceSupportType(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType;\n\tgetExtensionVirtualWorkspaceSupportType(manifest: IExtensionManifest): ExtensionVirtualWorkspaceSupportType;\n}\n\nexport class ExtensionManifestPropertiesService extends Disposable implements IExtensionManifestPropertiesService {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _extensionPointExtensionKindsMap: Map<string, ExtensionKind[]> | null = null;\n\tprivate _productExtensionKindsMap: ExtensionIdentifierMap<ExtensionKind[]> | null = null;\n\tprivate _configuredExtensionKindsMap: ExtensionIdentifierMap<ExtensionKind | ExtensionKind[]> | null = null;\n\n\tprivate _productVirtualWorkspaceSupportMap: ExtensionIdentifierMap<{ default?: boolean; override?: boolean }> | null = null;\n\tprivate _configuredVirtualWorkspaceSupportMap: ExtensionIdentifierMap<boolean> | null = null;\n\n\tprivate readonly _configuredExtensionWorkspaceTrustRequestMap: ExtensionIdentifierMap<{ supported: ExtensionUntrustedWorkspaceSupportType; version?: string }>;\n\tprivate readonly _productExtensionWorkspaceTrustRequestMap: Map<string, ExtensionUntrustedWorkspaceSupport>;\n\n\tconstructor(\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspaceTrustEnablementService private readonly workspaceTrustEnablementService: IWorkspaceTrustEnablementService,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\n\t\t// Workspace trust request type (settings.json)\n\t\tthis._configuredExtensionWorkspaceTrustRequestMap = new ExtensionIdentifierMap<{ supported: ExtensionUntrustedWorkspaceSupportType; version?: string }>();\n\t\tconst configuredExtensionWorkspaceTrustRequests = configurationService.inspect<{ [key: string]: { supported: ExtensionUntrustedWorkspaceSupportType; version?: string } }>(WORKSPACE_TRUST_EXTENSION_SUPPORT).userValue || {};\n\t\tfor (const id of Object.keys(configuredExtensionWorkspaceTrustRequests)) {\n\t\t\tthis._configuredExtensionWorkspaceTrustRequestMap.set(id, configuredExtensionWorkspaceTrustRequests[id]);\n\t\t}\n\n\t\t// Workspace trust request type (product.json)\n\t\tthis._productExtensionWorkspaceTrustRequestMap = new Map<string, ExtensionUntrustedWorkspaceSupport>();\n\t\tif (productService.extensionUntrustedWorkspaceSupport) {\n\t\t\tfor (const id of Object.keys(productService.extensionUntrustedWorkspaceSupport)) {\n\t\t\t\tthis._productExtensionWorkspaceTrustRequestMap.set(id, productService.extensionUntrustedWorkspaceSupport[id]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprefersExecuteOnUI(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'ui');\n\t}\n\n\tprefersExecuteOnWorkspace(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'workspace');\n\t}\n\n\tprefersExecuteOnWeb(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn (extensionKind.length > 0 && extensionKind[0] === 'web');\n\t}\n\n\tcanExecuteOnUI(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'ui');\n\t}\n\n\tcanExecuteOnWorkspace(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'workspace');\n\t}\n\n\tcanExecuteOnWeb(manifest: IExtensionManifest): boolean {\n\t\tconst extensionKind = this.getExtensionKind(manifest);\n\t\treturn extensionKind.some(kind => kind === 'web');\n\t}\n\n\tgetExtensionKind(manifest: IExtensionManifest): ExtensionKind[] {\n\t\tconst deducedExtensionKind = this.deduceExtensionKind(manifest);\n\t\tconst configuredExtensionKind = this.getConfiguredExtensionKind(manifest);\n\n\t\tif (configuredExtensionKind && configuredExtensionKind.length > 0) {\n\t\t\tconst result: ExtensionKind[] = [];\n\t\t\tfor (const extensionKind of configuredExtensionKind) {\n\t\t\t\tif (extensionKind !== '-web') {\n\t\t\t\t\tresult.push(extensionKind);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If opted out from web without specifying other extension kinds then default to ui, workspace\n\t\t\tif (configuredExtensionKind.includes('-web') && !result.length) {\n\t\t\t\tresult.push('ui');\n\t\t\t\tresult.push('workspace');\n\t\t\t}\n\n\t\t\t// Add web kind if not opted out from web and can run in web\n\t\t\tif (isWeb && !configuredExtensionKind.includes('-web') && !configuredExtensionKind.includes('web') && deducedExtensionKind.includes('web')) {\n\t\t\t\tresult.push('web');\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn deducedExtensionKind;\n\t}\n\n\tgetUserConfiguredExtensionKind(extensionIdentifier: IExtensionIdentifier): ExtensionKind[] | undefined {\n\t\tif (this._configuredExtensionKindsMap === null) {\n\t\t\tconst configuredExtensionKindsMap = new ExtensionIdentifierMap<ExtensionKind | ExtensionKind[]>();\n\t\t\tconst configuredExtensionKinds = this.configurationService.getValue<{ [key: string]: ExtensionKind | ExtensionKind[] }>('remote.extensionKind') || {};\n\t\t\tfor (const id of Object.keys(configuredExtensionKinds)) {\n\t\t\t\tconfiguredExtensionKindsMap.set(id, configuredExtensionKinds[id]);\n\t\t\t}\n\t\t\tthis._configuredExtensionKindsMap = configuredExtensionKindsMap;\n\t\t}\n\n\t\tconst userConfiguredExtensionKind = this._configuredExtensionKindsMap.get(extensionIdentifier.id);\n\t\treturn userConfiguredExtensionKind ? this.toArray(userConfiguredExtensionKind) : undefined;\n\t}\n\n\tgetExtensionUntrustedWorkspaceSupportType(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType {\n\t\t// Workspace trust feature is disabled, or extension has no entry point\n\t\tif (!this.workspaceTrustEnablementService.isWorkspaceTrustEnabled() || !manifest.main) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Get extension workspace trust requirements from settings.json\n\t\tconst configuredWorkspaceTrustRequest = this.getConfiguredExtensionWorkspaceTrustRequest(manifest);\n\n\t\t// Get extension workspace trust requirements from product.json\n\t\tconst productWorkspaceTrustRequest = this.getProductExtensionWorkspaceTrustRequest(manifest);\n\n\t\t// Use settings.json override value if it exists\n\t\tif (configuredWorkspaceTrustRequest !== undefined) {\n\t\t\treturn configuredWorkspaceTrustRequest;\n\t\t}\n\n\t\t// Use product.json override value if it exists\n\t\tif (productWorkspaceTrustRequest?.override !== undefined) {\n\t\t\treturn productWorkspaceTrustRequest.override;\n\t\t}\n\n\t\t// Use extension manifest value if it exists\n\t\tif (manifest.capabilities?.untrustedWorkspaces?.supported !== undefined) {\n\t\t\treturn manifest.capabilities.untrustedWorkspaces.supported;\n\t\t}\n\n\t\t// Use product.json default value if it exists\n\t\tif (productWorkspaceTrustRequest?.default !== undefined) {\n\t\t\treturn productWorkspaceTrustRequest.default;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetExtensionVirtualWorkspaceSupportType(manifest: IExtensionManifest): ExtensionVirtualWorkspaceSupportType {\n\t\t// check user configured\n\t\tconst userConfiguredVirtualWorkspaceSupport = this.getConfiguredVirtualWorkspaceSupport(manifest);\n\t\tif (userConfiguredVirtualWorkspaceSupport !== undefined) {\n\t\t\treturn userConfiguredVirtualWorkspaceSupport;\n\t\t}\n\n\t\tconst productConfiguredWorkspaceSchemes = this.getProductVirtualWorkspaceSupport(manifest);\n\n\t\t// check override from product\n\t\tif (productConfiguredWorkspaceSchemes?.override !== undefined) {\n\t\t\treturn productConfiguredWorkspaceSchemes.override;\n\t\t}\n\n\t\t// check the manifest\n\t\tconst virtualWorkspaces = manifest.capabilities?.virtualWorkspaces;\n\t\tif (isBoolean(virtualWorkspaces)) {\n\t\t\treturn virtualWorkspaces;\n\t\t} else if (virtualWorkspaces) {\n\t\t\tconst supported = virtualWorkspaces.supported;\n\t\t\tif (isBoolean(supported) || supported === 'limited') {\n\t\t\t\treturn supported;\n\t\t\t}\n\t\t}\n\n\t\t// check default from product\n\t\tif (productConfiguredWorkspaceSchemes?.default !== undefined) {\n\t\t\treturn productConfiguredWorkspaceSchemes.default;\n\t\t}\n\n\t\t// Default - supports virtual workspace\n\t\treturn true;\n\t}\n\n\tprivate deduceExtensionKind(manifest: IExtensionManifest): ExtensionKind[] {\n\t\t// Not an UI extension if it has main\n\t\tif (manifest.main) {\n\t\t\tif (manifest.browser) {\n\t\t\t\treturn isWeb ? ['workspace', 'web'] : ['workspace'];\n\t\t\t}\n\t\t\treturn ['workspace'];\n\t\t}\n\n\t\tif (manifest.browser) {\n\t\t\treturn ['web'];\n\t\t}\n\n\t\tlet result = [...ALL_EXTENSION_KINDS];\n\n\t\tif (isNonEmptyArray(manifest.extensionPack) || isNonEmptyArray(manifest.extensionDependencies)) {\n\t\t\t// Extension pack defaults to [workspace, web] in web and only [workspace] in desktop\n\t\t\tresult = isWeb ? ['workspace', 'web'] : ['workspace'];\n\t\t}\n\n\t\tif (manifest.contributes) {\n\t\t\tfor (const contribution of Object.keys(manifest.contributes)) {\n\t\t\t\tconst supportedExtensionKinds = this.getSupportedExtensionKindsForExtensionPoint(contribution);\n\t\t\t\tif (supportedExtensionKinds.length) {\n\t\t\t\t\tresult = result.filter(extensionKind => supportedExtensionKinds.includes(extensionKind));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!result.length) {\n\t\t\tthis.logService.warn('Cannot deduce extensionKind for extension', getGalleryExtensionId(manifest.publisher, manifest.name));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate getSupportedExtensionKindsForExtensionPoint(extensionPoint: string): ExtensionKind[] {\n\t\tif (this._extensionPointExtensionKindsMap === null) {\n\t\t\tconst extensionPointExtensionKindsMap = new Map<string, ExtensionKind[]>();\n\t\t\tExtensionsRegistry.getExtensionPoints().forEach(e => extensionPointExtensionKindsMap.set(e.name, e.defaultExtensionKind || [] /* supports all */));\n\t\t\tthis._extensionPointExtensionKindsMap = extensionPointExtensionKindsMap;\n\t\t}\n\n\t\tlet extensionPointExtensionKind = this._extensionPointExtensionKindsMap.get(extensionPoint);\n\t\tif (extensionPointExtensionKind) {\n\t\t\treturn extensionPointExtensionKind;\n\t\t}\n\n\t\textensionPointExtensionKind = this.productService.extensionPointExtensionKind ? this.productService.extensionPointExtensionKind[extensionPoint] : undefined;\n\t\tif (extensionPointExtensionKind) {\n\t\t\treturn extensionPointExtensionKind;\n\t\t}\n\n\t\t/* Unknown extension point */\n\t\treturn isWeb ? ['workspace', 'web'] : ['workspace'];\n\t}\n\n\tprivate getConfiguredExtensionKind(manifest: IExtensionManifest): (ExtensionKind | '-web')[] | null {\n\t\tconst extensionIdentifier = { id: getGalleryExtensionId(manifest.publisher, manifest.name) };\n\n\t\t// check in config\n\t\tlet result: ExtensionKind | ExtensionKind[] | undefined = this.getUserConfiguredExtensionKind(extensionIdentifier);\n\t\tif (typeof result !== 'undefined') {\n\t\t\treturn this.toArray(result);\n\t\t}\n\n\t\t// check product.json\n\t\tresult = this.getProductExtensionKind(manifest);\n\t\tif (typeof result !== 'undefined') {\n\t\t\treturn result;\n\t\t}\n\n\t\t// check the manifest itself\n\t\tresult = manifest.extensionKind;\n\t\tif (typeof result !== 'undefined') {\n\t\t\tresult = this.toArray(result);\n\t\t\treturn result.filter(r => ['ui', 'workspace'].includes(r));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate getProductExtensionKind(manifest: IExtensionManifest): ExtensionKind[] | undefined {\n\t\tif (this._productExtensionKindsMap === null) {\n\t\t\tconst productExtensionKindsMap = new ExtensionIdentifierMap<ExtensionKind[]>();\n\t\t\tif (this.productService.extensionKind) {\n\t\t\t\tfor (const id of Object.keys(this.productService.extensionKind)) {\n\t\t\t\t\tproductExtensionKindsMap.set(id, this.productService.extensionKind[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._productExtensionKindsMap = productExtensionKindsMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productExtensionKindsMap.get(extensionId);\n\t}\n\n\tprivate getProductVirtualWorkspaceSupport(manifest: IExtensionManifest): { default?: boolean; override?: boolean } | undefined {\n\t\tif (this._productVirtualWorkspaceSupportMap === null) {\n\t\t\tconst productWorkspaceSchemesMap = new ExtensionIdentifierMap<{ default?: boolean; override?: boolean }>();\n\t\t\tif (this.productService.extensionVirtualWorkspacesSupport) {\n\t\t\t\tfor (const id of Object.keys(this.productService.extensionVirtualWorkspacesSupport)) {\n\t\t\t\t\tproductWorkspaceSchemesMap.set(id, this.productService.extensionVirtualWorkspacesSupport[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._productVirtualWorkspaceSupportMap = productWorkspaceSchemesMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productVirtualWorkspaceSupportMap.get(extensionId);\n\t}\n\n\tprivate getConfiguredVirtualWorkspaceSupport(manifest: IExtensionManifest): boolean | undefined {\n\t\tif (this._configuredVirtualWorkspaceSupportMap === null) {\n\t\t\tconst configuredWorkspaceSchemesMap = new ExtensionIdentifierMap<boolean>();\n\t\t\tconst configuredWorkspaceSchemes = this.configurationService.getValue<{ [key: string]: boolean }>('extensions.supportVirtualWorkspaces') || {};\n\t\t\tfor (const id of Object.keys(configuredWorkspaceSchemes)) {\n\t\t\t\tif (configuredWorkspaceSchemes[id] !== undefined) {\n\t\t\t\t\tconfiguredWorkspaceSchemesMap.set(id, configuredWorkspaceSchemes[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._configuredVirtualWorkspaceSupportMap = configuredWorkspaceSchemesMap;\n\t\t}\n\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._configuredVirtualWorkspaceSupportMap.get(extensionId);\n\t}\n\n\tprivate getConfiguredExtensionWorkspaceTrustRequest(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupportType | undefined {\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\tconst extensionWorkspaceTrustRequest = this._configuredExtensionWorkspaceTrustRequestMap.get(extensionId);\n\n\t\tif (extensionWorkspaceTrustRequest && (extensionWorkspaceTrustRequest.version === undefined || extensionWorkspaceTrustRequest.version === manifest.version)) {\n\t\t\treturn extensionWorkspaceTrustRequest.supported;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate getProductExtensionWorkspaceTrustRequest(manifest: IExtensionManifest): ExtensionUntrustedWorkspaceSupport | undefined {\n\t\tconst extensionId = getGalleryExtensionId(manifest.publisher, manifest.name);\n\t\treturn this._productExtensionWorkspaceTrustRequestMap.get(extensionId);\n\t}\n\n\tprivate toArray(extensionKind: ExtensionKind | ExtensionKind[]): ExtensionKind[] {\n\t\tif (Array.isArray(extensionKind)) {\n\t\t\treturn extensionKind;\n\t\t}\n\t\treturn extensionKind === 'ui' ? ['ui', 'workspace'] : [extensionKind];\n\t}\n}\n\nregisterSingleton(IExtensionManifestPropertiesService, ExtensionManifestPropertiesService, InstantiationType.Delayed);\n"]}