{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/extensions/common/remoteExtensionHost.ts","vs/workbench/services/extensions/common/remoteExtensionHost.ts"],"names":[],"mappings":"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","file":"remoteExtensionHost.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IMessagePassingProtocol } from '../../../../base/parts/ipc/common/ipc.js';\nimport { PersistentProtocol } from '../../../../base/parts/ipc/common/ipc.net.js';\nimport { IExtensionHostDebugService } from '../../../../platform/debug/common/extensionHostDebug.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ILogService, ILoggerService } from '../../../../platform/log/common/log.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { IConnectionOptions, IRemoteExtensionHostStartParams, connectRemoteAgentExtensionHost } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { IRemoteAuthorityResolverService, IRemoteConnectionData } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IRemoteSocketFactoryService } from '../../../../platform/remote/common/remoteSocketFactoryService.js';\nimport { ISignService } from '../../../../platform/sign/common/sign.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { isLoggingOnly } from '../../../../platform/telemetry/common/telemetryUtils.js';\nimport { IWorkspaceContextService, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { parseExtensionDevOptions } from './extensionDevOptions.js';\nimport { IExtensionHostInitData, MessageType, UIKind, createMessageOfType, isMessageOfType } from './extensionHostProtocol.js';\nimport { RemoteRunningLocation } from './extensionRunningLocation.js';\nimport { ExtensionHostExtensions, ExtensionHostStartup, IExtensionHost } from './extensions.js';\n\nexport interface IRemoteExtensionHostInitData {\n\treadonly connectionData: IRemoteConnectionData | null;\n\treadonly pid: number;\n\treadonly appRoot: URI;\n\treadonly extensionHostLogsPath: URI;\n\treadonly globalStorageHome: URI;\n\treadonly workspaceStorageHome: URI;\n\treadonly extensions: ExtensionHostExtensions;\n}\n\nexport interface IRemoteExtensionHostDataProvider {\n\treadonly remoteAuthority: string;\n\tgetInitData(): Promise<IRemoteExtensionHostInitData>;\n}\n\nexport class RemoteExtensionHost extends Disposable implements IExtensionHost {\n\n\tpublic readonly pid = null;\n\tpublic readonly remoteAuthority: string;\n\tpublic readonly startup = ExtensionHostStartup.EagerAutoStart;\n\tpublic extensions: ExtensionHostExtensions | null = null;\n\n\tprivate _onExit: Emitter<[number, string | null]> = this._register(new Emitter<[number, string | null]>());\n\tpublic readonly onExit: Event<[number, string | null]> = this._onExit.event;\n\n\tprivate _protocol: PersistentProtocol | null;\n\tprivate _hasLostConnection: boolean;\n\tprivate _terminating: boolean;\n\tprivate _hasDisconnected = false;\n\tprivate readonly _isExtensionDevHost: boolean;\n\n\tconstructor(\n\t\tpublic readonly runningLocation: RemoteRunningLocation,\n\t\tprivate readonly _initDataProvider: IRemoteExtensionHostDataProvider,\n\t\t@IRemoteSocketFactoryService private readonly remoteSocketFactoryService: IRemoteSocketFactoryService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@ILoggerService protected readonly _loggerService: ILoggerService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t\t@IRemoteAuthorityResolverService private readonly remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IExtensionHostDebugService private readonly _extensionHostDebugService: IExtensionHostDebugService,\n\t\t@IProductService private readonly _productService: IProductService,\n\t\t@ISignService private readonly _signService: ISignService\n\t) {\n\t\tsuper();\n\t\tthis.remoteAuthority = this._initDataProvider.remoteAuthority;\n\t\tthis._protocol = null;\n\t\tthis._hasLostConnection = false;\n\t\tthis._terminating = false;\n\n\t\tconst devOpts = parseExtensionDevOptions(this._environmentService);\n\t\tthis._isExtensionDevHost = devOpts.isExtensionDevHost;\n\t}\n\n\tpublic start(): Promise<IMessagePassingProtocol> {\n\t\tconst options: IConnectionOptions = {\n\t\t\tcommit: this._productService.commit,\n\t\t\tquality: this._productService.quality,\n\t\t\taddressProvider: {\n\t\t\t\tgetAddress: async () => {\n\t\t\t\t\tconst { authority } = await this.remoteAuthorityResolverService.resolveAuthority(this._initDataProvider.remoteAuthority);\n\t\t\t\t\treturn { connectTo: authority.connectTo, connectionToken: authority.connectionToken };\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoteSocketFactoryService: this.remoteSocketFactoryService,\n\t\t\tsignService: this._signService,\n\t\t\tlogService: this._logService,\n\t\t\tipcLogger: null\n\t\t};\n\t\treturn this.remoteAuthorityResolverService.resolveAuthority(this._initDataProvider.remoteAuthority).then((resolverResult) => {\n\n\t\t\tconst startParams: IRemoteExtensionHostStartParams = {\n\t\t\t\tlanguage: platform.language,\n\t\t\t\tdebugId: this._environmentService.debugExtensionHost.debugId,\n\t\t\t\tbreak: this._environmentService.debugExtensionHost.break,\n\t\t\t\tport: this._environmentService.debugExtensionHost.port,\n\t\t\t\tenv: { ...this._environmentService.debugExtensionHost.env, ...resolverResult.options?.extensionHostEnv },\n\t\t\t};\n\n\t\t\tconst extDevLocs = this._environmentService.extensionDevelopmentLocationURI;\n\n\t\t\tlet debugOk = true;\n\t\t\tif (extDevLocs && extDevLocs.length > 0) {\n\t\t\t\t// TODO@AW: handles only first path in array\n\t\t\t\tif (extDevLocs[0].scheme === Schemas.file) {\n\t\t\t\t\tdebugOk = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!debugOk) {\n\t\t\t\tstartParams.break = false;\n\t\t\t}\n\n\t\t\treturn connectRemoteAgentExtensionHost(options, startParams).then(result => {\n\t\t\t\tthis._register(result);\n\t\t\t\tconst { protocol, debugPort, reconnectionToken } = result;\n\t\t\t\tconst isExtensionDevelopmentDebug = typeof debugPort === 'number';\n\t\t\t\tif (debugOk && this._environmentService.isExtensionDevelopment && this._environmentService.debugExtensionHost.debugId && debugPort) {\n\t\t\t\t\tthis._extensionHostDebugService.attachSession(this._environmentService.debugExtensionHost.debugId, debugPort, this._initDataProvider.remoteAuthority);\n\t\t\t\t}\n\n\t\t\t\tprotocol.onDidDispose(() => {\n\t\t\t\t\tthis._onExtHostConnectionLost(reconnectionToken);\n\t\t\t\t});\n\n\t\t\t\tprotocol.onSocketClose(() => {\n\t\t\t\t\tif (this._isExtensionDevHost) {\n\t\t\t\t\t\tthis._onExtHostConnectionLost(reconnectionToken);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// 1) wait for the incoming `ready` event and send the initialization data.\n\t\t\t\t// 2) wait for the incoming `initialized` event.\n\t\t\t\treturn new Promise<IMessagePassingProtocol>((resolve, reject) => {\n\n\t\t\t\t\tconst handle = setTimeout(() => {\n\t\t\t\t\t\treject('The remote extension host took longer than 60s to send its ready message.');\n\t\t\t\t\t}, 60 * 1000);\n\n\t\t\t\t\tconst disposable = protocol.onMessage(msg => {\n\n\t\t\t\t\t\tif (isMessageOfType(msg, MessageType.Ready)) {\n\t\t\t\t\t\t\t// 1) Extension Host is ready to receive messages, initialize it\n\t\t\t\t\t\t\tthis._createExtHostInitData(isExtensionDevelopmentDebug).then(data => {\n\t\t\t\t\t\t\t\tprotocol.send(VSBuffer.fromString(JSON.stringify(data)));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isMessageOfType(msg, MessageType.Initialized)) {\n\t\t\t\t\t\t\t// 2) Extension Host is initialized\n\n\t\t\t\t\t\t\tclearTimeout(handle);\n\n\t\t\t\t\t\t\t// stop listening for messages here\n\t\t\t\t\t\t\tdisposable.dispose();\n\n\t\t\t\t\t\t\t// release this promise\n\t\t\t\t\t\t\tthis._protocol = protocol;\n\t\t\t\t\t\t\tresolve(protocol);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.error(`received unexpected message during handshake phase from the extension host: `, msg);\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _onExtHostConnectionLost(reconnectionToken: string): void {\n\t\tif (this._hasLostConnection) {\n\t\t\t// avoid re-entering this method\n\t\t\treturn;\n\t\t}\n\t\tthis._hasLostConnection = true;\n\n\t\tif (this._isExtensionDevHost && this._environmentService.debugExtensionHost.debugId) {\n\t\t\tthis._extensionHostDebugService.close(this._environmentService.debugExtensionHost.debugId);\n\t\t}\n\n\t\tif (this._terminating) {\n\t\t\t// Expected termination path (we asked the process to terminate)\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onExit.fire([0, reconnectionToken]);\n\t}\n\n\tprivate async _createExtHostInitData(isExtensionDevelopmentDebug: boolean): Promise<IExtensionHostInitData> {\n\t\tconst remoteInitData = await this._initDataProvider.getInitData();\n\t\tthis.extensions = remoteInitData.extensions;\n\t\tconst workspace = this._contextService.getWorkspace();\n\t\treturn {\n\t\t\tcommit: this._productService.commit,\n\t\t\tversion: this._productService.version,\n\t\t\tquality: this._productService.quality,\n\t\t\tdate: this._productService.date,\n\t\t\tparentPid: remoteInitData.pid,\n\t\t\tenvironment: {\n\t\t\t\tisExtensionDevelopmentDebug,\n\t\t\t\tappRoot: remoteInitData.appRoot,\n\t\t\t\tappName: this._productService.nameLong,\n\t\t\t\tappHost: this._productService.embedderIdentifier || 'desktop',\n\t\t\t\tappUriScheme: this._productService.urlProtocol,\n\t\t\t\tisExtensionTelemetryLoggingOnly: isLoggingOnly(this._productService, this._environmentService),\n\t\t\t\tappLanguage: platform.language,\n\t\t\t\textensionDevelopmentLocationURI: this._environmentService.extensionDevelopmentLocationURI,\n\t\t\t\textensionTestsLocationURI: this._environmentService.extensionTestsLocationURI,\n\t\t\t\tglobalStorageHome: remoteInitData.globalStorageHome,\n\t\t\t\tworkspaceStorageHome: remoteInitData.workspaceStorageHome,\n\t\t\t\textensionLogLevel: this._environmentService.extensionLogLevel\n\t\t\t},\n\t\t\tworkspace: this._contextService.getWorkbenchState() === WorkbenchState.EMPTY ? null : {\n\t\t\t\tconfiguration: workspace.configuration,\n\t\t\t\tid: workspace.id,\n\t\t\t\tname: this._labelService.getWorkspaceLabel(workspace),\n\t\t\t\ttransient: workspace.transient\n\t\t\t},\n\t\t\tremote: {\n\t\t\t\tisRemote: true,\n\t\t\t\tauthority: this._initDataProvider.remoteAuthority,\n\t\t\t\tconnectionData: remoteInitData.connectionData\n\t\t\t},\n\t\t\tconsoleForward: {\n\t\t\t\tincludeStack: false,\n\t\t\t\tlogNative: Boolean(this._environmentService.debugExtensionHost.debugId)\n\t\t\t},\n\t\t\textensions: this.extensions.toSnapshot(),\n\t\t\ttelemetryInfo: {\n\t\t\t\tsessionId: this._telemetryService.sessionId,\n\t\t\t\tmachineId: this._telemetryService.machineId,\n\t\t\t\tsqmId: this._telemetryService.sqmId,\n\t\t\t\tdevDeviceId: this._telemetryService.devDeviceId ?? this._telemetryService.machineId,\n\t\t\t\tfirstSessionDate: this._telemetryService.firstSessionDate,\n\t\t\t\tmsftInternal: this._telemetryService.msftInternal\n\t\t\t},\n\t\t\tlogLevel: this._logService.getLevel(),\n\t\t\tloggers: [...this._loggerService.getRegisteredLoggers()],\n\t\t\tlogsLocation: remoteInitData.extensionHostLogsPath,\n\t\t\tautoStart: (this.startup === ExtensionHostStartup.EagerAutoStart),\n\t\t\tuiKind: platform.isWeb ? UIKind.Web : UIKind.Desktop\n\t\t};\n\t}\n\n\tgetInspectPort(): undefined {\n\t\treturn undefined;\n\t}\n\n\tenableInspectPort(): Promise<boolean> {\n\t\treturn Promise.resolve(false);\n\t}\n\n\tasync disconnect() {\n\t\tif (this._protocol && !this._hasDisconnected) {\n\t\t\tthis._protocol.send(createMessageOfType(MessageType.Terminate));\n\t\t\tthis._protocol.sendDisconnect();\n\t\t\tthis._hasDisconnected = true;\n\t\t\tawait this._protocol.drain();\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._terminating = true;\n\t\tthis.disconnect();\n\n\t\tif (this._protocol) {\n\t\t\t// Send the extension host a request to terminate itself\n\t\t\t// (graceful termination)\n\t\t\t// setTimeout(() => {\n\t\t\t// console.log(`SENDING TERMINATE TO REMOTE EXT HOST!`);\n\t\t\tthis._protocol.getSocket().end();\n\t\t\t// this._protocol.drain();\n\t\t\tthis._protocol = null;\n\t\t\t// }, 1000);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IMessagePassingProtocol } from '../../../../base/parts/ipc/common/ipc.js';\nimport { PersistentProtocol } from '../../../../base/parts/ipc/common/ipc.net.js';\nimport { IExtensionHostDebugService } from '../../../../platform/debug/common/extensionHostDebug.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { ILogService, ILoggerService } from '../../../../platform/log/common/log.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { IConnectionOptions, IRemoteExtensionHostStartParams, connectRemoteAgentExtensionHost } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { IRemoteAuthorityResolverService, IRemoteConnectionData } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IRemoteSocketFactoryService } from '../../../../platform/remote/common/remoteSocketFactoryService.js';\nimport { ISignService } from '../../../../platform/sign/common/sign.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { isLoggingOnly } from '../../../../platform/telemetry/common/telemetryUtils.js';\nimport { IWorkspaceContextService, WorkbenchState } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { parseExtensionDevOptions } from './extensionDevOptions.js';\nimport { IExtensionHostInitData, MessageType, UIKind, createMessageOfType, isMessageOfType } from './extensionHostProtocol.js';\nimport { RemoteRunningLocation } from './extensionRunningLocation.js';\nimport { ExtensionHostExtensions, ExtensionHostStartup, IExtensionHost } from './extensions.js';\n\nexport interface IRemoteExtensionHostInitData {\n\treadonly connectionData: IRemoteConnectionData | null;\n\treadonly pid: number;\n\treadonly appRoot: URI;\n\treadonly extensionHostLogsPath: URI;\n\treadonly globalStorageHome: URI;\n\treadonly workspaceStorageHome: URI;\n\treadonly extensions: ExtensionHostExtensions;\n}\n\nexport interface IRemoteExtensionHostDataProvider {\n\treadonly remoteAuthority: string;\n\tgetInitData(): Promise<IRemoteExtensionHostInitData>;\n}\n\nexport class RemoteExtensionHost extends Disposable implements IExtensionHost {\n\n\tpublic readonly pid = null;\n\tpublic readonly remoteAuthority: string;\n\tpublic readonly startup = ExtensionHostStartup.EagerAutoStart;\n\tpublic extensions: ExtensionHostExtensions | null = null;\n\n\tprivate _onExit: Emitter<[number, string | null]> = this._register(new Emitter<[number, string | null]>());\n\tpublic readonly onExit: Event<[number, string | null]> = this._onExit.event;\n\n\tprivate _protocol: PersistentProtocol | null;\n\tprivate _hasLostConnection: boolean;\n\tprivate _terminating: boolean;\n\tprivate _hasDisconnected = false;\n\tprivate readonly _isExtensionDevHost: boolean;\n\n\tconstructor(\n\t\tpublic readonly runningLocation: RemoteRunningLocation,\n\t\tprivate readonly _initDataProvider: IRemoteExtensionHostDataProvider,\n\t\t@IRemoteSocketFactoryService private readonly remoteSocketFactoryService: IRemoteSocketFactoryService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@ITelemetryService private readonly _telemetryService: ITelemetryService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@ILoggerService protected readonly _loggerService: ILoggerService,\n\t\t@ILabelService private readonly _labelService: ILabelService,\n\t\t@IRemoteAuthorityResolverService private readonly remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IExtensionHostDebugService private readonly _extensionHostDebugService: IExtensionHostDebugService,\n\t\t@IProductService private readonly _productService: IProductService,\n\t\t@ISignService private readonly _signService: ISignService\n\t) {\n\t\tsuper();\n\t\tthis.remoteAuthority = this._initDataProvider.remoteAuthority;\n\t\tthis._protocol = null;\n\t\tthis._hasLostConnection = false;\n\t\tthis._terminating = false;\n\n\t\tconst devOpts = parseExtensionDevOptions(this._environmentService);\n\t\tthis._isExtensionDevHost = devOpts.isExtensionDevHost;\n\t}\n\n\tpublic start(): Promise<IMessagePassingProtocol> {\n\t\tconst options: IConnectionOptions = {\n\t\t\tcommit: this._productService.commit,\n\t\t\tquality: this._productService.quality,\n\t\t\taddressProvider: {\n\t\t\t\tgetAddress: async () => {\n\t\t\t\t\tconst { authority } = await this.remoteAuthorityResolverService.resolveAuthority(this._initDataProvider.remoteAuthority);\n\t\t\t\t\treturn { connectTo: authority.connectTo, connectionToken: authority.connectionToken };\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoteSocketFactoryService: this.remoteSocketFactoryService,\n\t\t\tsignService: this._signService,\n\t\t\tlogService: this._logService,\n\t\t\tipcLogger: null\n\t\t};\n\t\treturn this.remoteAuthorityResolverService.resolveAuthority(this._initDataProvider.remoteAuthority).then((resolverResult) => {\n\n\t\t\tconst startParams: IRemoteExtensionHostStartParams = {\n\t\t\t\tlanguage: platform.language,\n\t\t\t\tdebugId: this._environmentService.debugExtensionHost.debugId,\n\t\t\t\tbreak: this._environmentService.debugExtensionHost.break,\n\t\t\t\tport: this._environmentService.debugExtensionHost.port,\n\t\t\t\tenv: { ...this._environmentService.debugExtensionHost.env, ...resolverResult.options?.extensionHostEnv },\n\t\t\t};\n\n\t\t\tconst extDevLocs = this._environmentService.extensionDevelopmentLocationURI;\n\n\t\t\tlet debugOk = true;\n\t\t\tif (extDevLocs && extDevLocs.length > 0) {\n\t\t\t\t// TODO@AW: handles only first path in array\n\t\t\t\tif (extDevLocs[0].scheme === Schemas.file) {\n\t\t\t\t\tdebugOk = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!debugOk) {\n\t\t\t\tstartParams.break = false;\n\t\t\t}\n\n\t\t\treturn connectRemoteAgentExtensionHost(options, startParams).then(result => {\n\t\t\t\tthis._register(result);\n\t\t\t\tconst { protocol, debugPort, reconnectionToken } = result;\n\t\t\t\tconst isExtensionDevelopmentDebug = typeof debugPort === 'number';\n\t\t\t\tif (debugOk && this._environmentService.isExtensionDevelopment && this._environmentService.debugExtensionHost.debugId && debugPort) {\n\t\t\t\t\tthis._extensionHostDebugService.attachSession(this._environmentService.debugExtensionHost.debugId, debugPort, this._initDataProvider.remoteAuthority);\n\t\t\t\t}\n\n\t\t\t\tprotocol.onDidDispose(() => {\n\t\t\t\t\tthis._onExtHostConnectionLost(reconnectionToken);\n\t\t\t\t});\n\n\t\t\t\tprotocol.onSocketClose(() => {\n\t\t\t\t\tif (this._isExtensionDevHost) {\n\t\t\t\t\t\tthis._onExtHostConnectionLost(reconnectionToken);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// 1) wait for the incoming `ready` event and send the initialization data.\n\t\t\t\t// 2) wait for the incoming `initialized` event.\n\t\t\t\treturn new Promise<IMessagePassingProtocol>((resolve, reject) => {\n\n\t\t\t\t\tconst handle = setTimeout(() => {\n\t\t\t\t\t\treject('The remote extension host took longer than 60s to send its ready message.');\n\t\t\t\t\t}, 60 * 1000);\n\n\t\t\t\t\tconst disposable = protocol.onMessage(msg => {\n\n\t\t\t\t\t\tif (isMessageOfType(msg, MessageType.Ready)) {\n\t\t\t\t\t\t\t// 1) Extension Host is ready to receive messages, initialize it\n\t\t\t\t\t\t\tthis._createExtHostInitData(isExtensionDevelopmentDebug).then(data => {\n\t\t\t\t\t\t\t\tprotocol.send(VSBuffer.fromString(JSON.stringify(data)));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (isMessageOfType(msg, MessageType.Initialized)) {\n\t\t\t\t\t\t\t// 2) Extension Host is initialized\n\n\t\t\t\t\t\t\tclearTimeout(handle);\n\n\t\t\t\t\t\t\t// stop listening for messages here\n\t\t\t\t\t\t\tdisposable.dispose();\n\n\t\t\t\t\t\t\t// release this promise\n\t\t\t\t\t\t\tthis._protocol = protocol;\n\t\t\t\t\t\t\tresolve(protocol);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.error(`received unexpected message during handshake phase from the extension host: `, msg);\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _onExtHostConnectionLost(reconnectionToken: string): void {\n\t\tif (this._hasLostConnection) {\n\t\t\t// avoid re-entering this method\n\t\t\treturn;\n\t\t}\n\t\tthis._hasLostConnection = true;\n\n\t\tif (this._isExtensionDevHost && this._environmentService.debugExtensionHost.debugId) {\n\t\t\tthis._extensionHostDebugService.close(this._environmentService.debugExtensionHost.debugId);\n\t\t}\n\n\t\tif (this._terminating) {\n\t\t\t// Expected termination path (we asked the process to terminate)\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onExit.fire([0, reconnectionToken]);\n\t}\n\n\tprivate async _createExtHostInitData(isExtensionDevelopmentDebug: boolean): Promise<IExtensionHostInitData> {\n\t\tconst remoteInitData = await this._initDataProvider.getInitData();\n\t\tthis.extensions = remoteInitData.extensions;\n\t\tconst workspace = this._contextService.getWorkspace();\n\t\treturn {\n\t\t\tcommit: this._productService.commit,\n\t\t\tversion: this._productService.version,\n\t\t\tquality: this._productService.quality,\n\t\t\tdate: this._productService.date,\n\t\t\tparentPid: remoteInitData.pid,\n\t\t\tenvironment: {\n\t\t\t\tisExtensionDevelopmentDebug,\n\t\t\t\tappRoot: remoteInitData.appRoot,\n\t\t\t\tappName: this._productService.nameLong,\n\t\t\t\tappHost: this._productService.embedderIdentifier || 'desktop',\n\t\t\t\tappUriScheme: this._productService.urlProtocol,\n\t\t\t\tisExtensionTelemetryLoggingOnly: isLoggingOnly(this._productService, this._environmentService),\n\t\t\t\tappLanguage: platform.language,\n\t\t\t\textensionDevelopmentLocationURI: this._environmentService.extensionDevelopmentLocationURI,\n\t\t\t\textensionTestsLocationURI: this._environmentService.extensionTestsLocationURI,\n\t\t\t\tglobalStorageHome: remoteInitData.globalStorageHome,\n\t\t\t\tworkspaceStorageHome: remoteInitData.workspaceStorageHome,\n\t\t\t\textensionLogLevel: this._environmentService.extensionLogLevel\n\t\t\t},\n\t\t\tworkspace: this._contextService.getWorkbenchState() === WorkbenchState.EMPTY ? null : {\n\t\t\t\tconfiguration: workspace.configuration,\n\t\t\t\tid: workspace.id,\n\t\t\t\tname: this._labelService.getWorkspaceLabel(workspace),\n\t\t\t\ttransient: workspace.transient\n\t\t\t},\n\t\t\tremote: {\n\t\t\t\tisRemote: true,\n\t\t\t\tauthority: this._initDataProvider.remoteAuthority,\n\t\t\t\tconnectionData: remoteInitData.connectionData\n\t\t\t},\n\t\t\tconsoleForward: {\n\t\t\t\tincludeStack: false,\n\t\t\t\tlogNative: Boolean(this._environmentService.debugExtensionHost.debugId)\n\t\t\t},\n\t\t\textensions: this.extensions.toSnapshot(),\n\t\t\ttelemetryInfo: {\n\t\t\t\tsessionId: this._telemetryService.sessionId,\n\t\t\t\tmachineId: this._telemetryService.machineId,\n\t\t\t\tsqmId: this._telemetryService.sqmId,\n\t\t\t\tdevDeviceId: this._telemetryService.devDeviceId ?? this._telemetryService.machineId,\n\t\t\t\tfirstSessionDate: this._telemetryService.firstSessionDate,\n\t\t\t\tmsftInternal: this._telemetryService.msftInternal\n\t\t\t},\n\t\t\tlogLevel: this._logService.getLevel(),\n\t\t\tloggers: [...this._loggerService.getRegisteredLoggers()],\n\t\t\tlogsLocation: remoteInitData.extensionHostLogsPath,\n\t\t\tautoStart: (this.startup === ExtensionHostStartup.EagerAutoStart),\n\t\t\tuiKind: platform.isWeb ? UIKind.Web : UIKind.Desktop\n\t\t};\n\t}\n\n\tgetInspectPort(): undefined {\n\t\treturn undefined;\n\t}\n\n\tenableInspectPort(): Promise<boolean> {\n\t\treturn Promise.resolve(false);\n\t}\n\n\tasync disconnect() {\n\t\tif (this._protocol && !this._hasDisconnected) {\n\t\t\tthis._protocol.send(createMessageOfType(MessageType.Terminate));\n\t\t\tthis._protocol.sendDisconnect();\n\t\t\tthis._hasDisconnected = true;\n\t\t\tawait this._protocol.drain();\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._terminating = true;\n\t\tthis.disconnect();\n\n\t\tif (this._protocol) {\n\t\t\t// Send the extension host a request to terminate itself\n\t\t\t// (graceful termination)\n\t\t\t// setTimeout(() => {\n\t\t\t// console.log(`SENDING TERMINATE TO REMOTE EXT HOST!`);\n\t\t\tthis._protocol.getSocket().end();\n\t\t\t// this._protocol.drain();\n\t\t\tthis._protocol = null;\n\t\t\t// }, 1000);\n\t\t}\n\t}\n}\n"]}