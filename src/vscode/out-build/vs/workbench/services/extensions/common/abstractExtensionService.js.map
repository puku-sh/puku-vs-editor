{"version":3,"sources":["vs/workbench/services/extensions/common/abstractExtensionService.ts"],"names":[],"mappings":"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","file":"abstractExtensionService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Barrier } from '../../../../base/common/async.js';\nimport { toErrorMessage } from '../../../../base/common/errorMessage.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as perf from '../../../../base/common/performance.js';\nimport { isCI } from '../../../../base/common/platform.js';\nimport { isEqualOrParent } from '../../../../base/common/resources.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { InstallOperation } from '../../../../platform/extensionManagement/common/extensionManagement.js';\nimport { ImplicitActivationEvents } from '../../../../platform/extensionManagement/common/implicitActivationEvents.js';\nimport { ExtensionIdentifier, ExtensionIdentifierMap, IExtension, IExtensionContributions, IExtensionDescription, IExtensionManifest } from '../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { SyncDescriptor } from '../../../../platform/instantiation/common/descriptors.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { handleVetos } from '../../../../platform/lifecycle/common/lifecycle.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { IRemoteAuthorityResolverService, RemoteAuthorityResolverError, RemoteAuthorityResolverErrorCode, ResolverResult, getRemoteAuthorityPrefix } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IRemoteExtensionsScannerService } from '../../../../platform/remote/common/remoteExtensionsScanner.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { IExtensionFeaturesRegistry, Extensions as ExtensionFeaturesExtensions, IExtensionFeatureMarkdownRenderer, IRenderedData, } from '../../extensionManagement/common/extensionFeatures.js';\nimport { IWorkbenchExtensionEnablementService, IWorkbenchExtensionManagementService } from '../../extensionManagement/common/extensionManagement.js';\nimport { ExtensionDescriptionRegistryLock, ExtensionDescriptionRegistrySnapshot, IActivationEventsReader, LockableExtensionDescriptionRegistry } from './extensionDescriptionRegistry.js';\nimport { parseExtensionDevOptions } from './extensionDevOptions.js';\nimport { ExtensionHostKind, ExtensionRunningPreference, IExtensionHostKindPicker } from './extensionHostKind.js';\nimport { ExtensionHostManager } from './extensionHostManager.js';\nimport { IExtensionHostManager } from './extensionHostManagers.js';\nimport { IResolveAuthorityErrorResult } from './extensionHostProxy.js';\nimport { IExtensionManifestPropertiesService } from './extensionManifestPropertiesService.js';\nimport { ExtensionRunningLocation, LocalProcessRunningLocation, LocalWebWorkerRunningLocation, RemoteRunningLocation } from './extensionRunningLocation.js';\nimport { ExtensionRunningLocationTracker, filterExtensionIdentifiers } from './extensionRunningLocationTracker.js';\nimport { ActivationKind, ActivationTimes, ExtensionActivationReason, ExtensionHostStartup, ExtensionPointContribution, IExtensionHost, IExtensionInspectInfo, IExtensionService, IExtensionsStatus, IInternalExtensionService, IMessage, IResponsiveStateChangeEvent, IWillActivateEvent, WillStopExtensionHostsEvent, toExtension, toExtensionDescription } from './extensions.js';\nimport { ExtensionsProposedApi } from './extensionsProposedApi.js';\nimport { ExtensionMessageCollector, ExtensionPoint, ExtensionsRegistry, IExtensionPoint, IExtensionPointUser } from './extensionsRegistry.js';\nimport { LazyCreateExtensionHostManager } from './lazyCreateExtensionHostManager.js';\nimport { ResponsiveState } from './rpcProtocol.js';\nimport { IExtensionActivationHost as IWorkspaceContainsActivationHost, checkActivateWorkspaceContainsExtension, checkGlobFileExists } from './workspaceContains.js';\nimport { ILifecycleService, WillShutdownJoinerOrder } from '../../lifecycle/common/lifecycle.js';\nimport { IExtensionHostExitInfo, IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\n\nconst hasOwnProperty = Object.hasOwnProperty;\nconst NO_OP_VOID_PROMISE = Promise.resolve<void>(undefined);\n\nexport abstract class AbstractExtensionService extends Disposable implements IExtensionService {\n\n\tpublic _serviceBrand: undefined;\n\n\tprivate readonly _hasLocalProcess: boolean;\n\tprivate readonly _allowRemoteExtensionsInLocalWebWorker: boolean;\n\n\tprivate readonly _onDidRegisterExtensions = this._register(new Emitter<void>());\n\tpublic readonly onDidRegisterExtensions = this._onDidRegisterExtensions.event;\n\n\tprivate readonly _onDidChangeExtensionsStatus = this._register(new Emitter<ExtensionIdentifier[]>());\n\tpublic readonly onDidChangeExtensionsStatus = this._onDidChangeExtensionsStatus.event;\n\n\tprivate readonly _onDidChangeExtensions = this._register(new Emitter<{ readonly added: ReadonlyArray<IExtensionDescription>; readonly removed: ReadonlyArray<IExtensionDescription> }>({ leakWarningThreshold: 400 }));\n\tpublic readonly onDidChangeExtensions = this._onDidChangeExtensions.event;\n\n\tprivate readonly _onWillActivateByEvent = this._register(new Emitter<IWillActivateEvent>());\n\tpublic readonly onWillActivateByEvent = this._onWillActivateByEvent.event;\n\n\tprivate readonly _onDidChangeResponsiveChange = this._register(new Emitter<IResponsiveStateChangeEvent>());\n\tpublic readonly onDidChangeResponsiveChange = this._onDidChangeResponsiveChange.event;\n\n\tprivate readonly _onWillStop = this._register(new Emitter<WillStopExtensionHostsEvent>());\n\tpublic readonly onWillStop = this._onWillStop.event;\n\n\tprivate readonly _activationEventReader = new ImplicitActivationAwareReader();\n\tprivate readonly _registry = new LockableExtensionDescriptionRegistry(this._activationEventReader);\n\tprivate readonly _installedExtensionsReady = new Barrier();\n\tprivate readonly _extensionStatus = new ExtensionIdentifierMap<ExtensionStatus>();\n\tprivate readonly _allRequestedActivateEvents = new Set<string>();\n\tprivate readonly _runningLocations: ExtensionRunningLocationTracker;\n\tprivate readonly _remoteCrashTracker = new ExtensionHostCrashTracker();\n\n\tprivate _deltaExtensionsQueue: DeltaExtensionsQueueItem[] = [];\n\tprivate _inHandleDeltaExtensions = false;\n\n\tprivate readonly _extensionHostManagers = this._register(new ExtensionHostCollection());\n\n\tprivate _resolveAuthorityAttempt: number = 0;\n\n\tconstructor(\n\t\toptions: { hasLocalProcess: boolean; allowRemoteExtensionsInLocalWebWorker: boolean },\n\t\tprivate readonly _extensionsProposedApi: ExtensionsProposedApi,\n\t\tprivate readonly _extensionHostFactory: IExtensionHostFactory,\n\t\tprivate readonly _extensionHostKindPicker: IExtensionHostKindPicker,\n\t\t@IInstantiationService protected readonly _instantiationService: IInstantiationService,\n\t\t@INotificationService protected readonly _notificationService: INotificationService,\n\t\t@IWorkbenchEnvironmentService protected readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@ITelemetryService protected readonly _telemetryService: ITelemetryService,\n\t\t@IWorkbenchExtensionEnablementService protected readonly _extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IFileService protected readonly _fileService: IFileService,\n\t\t@IProductService protected readonly _productService: IProductService,\n\t\t@IWorkbenchExtensionManagementService protected readonly _extensionManagementService: IWorkbenchExtensionManagementService,\n\t\t@IWorkspaceContextService private readonly _contextService: IWorkspaceContextService,\n\t\t@IConfigurationService protected readonly _configurationService: IConfigurationService,\n\t\t@IExtensionManifestPropertiesService private readonly _extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t\t@ILogService protected readonly _logService: ILogService,\n\t\t@IRemoteAgentService protected readonly _remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteExtensionsScannerService protected readonly _remoteExtensionsScannerService: IRemoteExtensionsScannerService,\n\t\t@ILifecycleService private readonly _lifecycleService: ILifecycleService,\n\t\t@IRemoteAuthorityResolverService protected readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IDialogService private readonly _dialogService: IDialogService,\n\t) {\n\t\tsuper();\n\n\t\tthis._hasLocalProcess = options.hasLocalProcess;\n\t\tthis._allowRemoteExtensionsInLocalWebWorker = options.allowRemoteExtensionsInLocalWebWorker;\n\n\t\t// help the file service to activate providers by activating extensions by file system event\n\t\tthis._register(this._fileService.onWillActivateFileSystemProvider(e => {\n\t\t\tif (e.scheme !== Schemas.vscodeRemote) {\n\t\t\t\te.join(this.activateByEvent(`onFileSystem:${e.scheme}`));\n\t\t\t}\n\t\t}));\n\n\t\tthis._runningLocations = new ExtensionRunningLocationTracker(\n\t\t\tthis._registry,\n\t\t\tthis._extensionHostKindPicker,\n\t\t\tthis._environmentService,\n\t\t\tthis._configurationService,\n\t\t\tthis._logService,\n\t\t\tthis._extensionManifestPropertiesService\n\t\t);\n\n\t\tthis._register(this._extensionEnablementService.onEnablementChanged((extensions) => {\n\t\t\tconst toAdd: IExtension[] = [];\n\t\t\tconst toRemove: IExtension[] = [];\n\t\t\tfor (const extension of extensions) {\n\t\t\t\tif (this._safeInvokeIsEnabled(extension)) {\n\t\t\t\t\t// an extension has been enabled\n\t\t\t\t\ttoAdd.push(extension);\n\t\t\t\t} else {\n\t\t\t\t\t// an extension has been disabled\n\t\t\t\t\ttoRemove.push(extension);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isCI) {\n\t\t\t\tthis._logService.info(`AbstractExtensionService.onEnablementChanged fired for ${extensions.map(e => e.identifier.id).join(', ')}`);\n\t\t\t}\n\t\t\tthis._handleDeltaExtensions(new DeltaExtensionsQueueItem(toAdd, toRemove));\n\t\t}));\n\n\t\tthis._register(this._extensionManagementService.onDidChangeProfile(({ added, removed }) => {\n\t\t\tif (added.length || removed.length) {\n\t\t\t\tif (isCI) {\n\t\t\t\t\tthis._logService.info(`AbstractExtensionService.onDidChangeProfile fired`);\n\t\t\t\t}\n\t\t\t\tthis._handleDeltaExtensions(new DeltaExtensionsQueueItem(added, removed));\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._extensionManagementService.onDidEnableExtensions(extensions => {\n\t\t\tif (extensions.length) {\n\t\t\t\tif (isCI) {\n\t\t\t\t\tthis._logService.info(`AbstractExtensionService.onDidEnableExtensions fired`);\n\t\t\t\t}\n\t\t\t\tthis._handleDeltaExtensions(new DeltaExtensionsQueueItem(extensions, []));\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._extensionManagementService.onDidInstallExtensions((result) => {\n\t\t\tconst extensions: IExtension[] = [];\n\t\t\tfor (const { local, operation } of result) {\n\t\t\t\tif (local && local.isValid && operation !== InstallOperation.Migrate && this._safeInvokeIsEnabled(local)) {\n\t\t\t\t\textensions.push(local);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (extensions.length) {\n\t\t\t\tif (isCI) {\n\t\t\t\t\tthis._logService.info(`AbstractExtensionService.onDidInstallExtensions fired for ${extensions.map(e => e.identifier.id).join(', ')}`);\n\t\t\t\t}\n\t\t\t\tthis._handleDeltaExtensions(new DeltaExtensionsQueueItem(extensions, []));\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._extensionManagementService.onDidUninstallExtension((event) => {\n\t\t\tif (!event.error) {\n\t\t\t\t// an extension has been uninstalled\n\t\t\t\tif (isCI) {\n\t\t\t\t\tthis._logService.info(`AbstractExtensionService.onDidUninstallExtension fired for ${event.identifier.id}`);\n\t\t\t\t}\n\t\t\t\tthis._handleDeltaExtensions(new DeltaExtensionsQueueItem([], [event.identifier.id]));\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._lifecycleService.onWillShutdown(event => {\n\t\t\tif (this._remoteAgentService.getConnection()) {\n\t\t\t\tevent.join(async () => {\n\t\t\t\t\t// We need to disconnect the management connection before killing the local extension host.\n\t\t\t\t\t// Otherwise, the local extension host might terminate the underlying tunnel before the\n\t\t\t\t\t// management connection has a chance to send its disconnection message.\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this._remoteAgentService.endConnection();\n\t\t\t\t\t\tawait this._doStopExtensionHosts();\n\t\t\t\t\t\tthis._remoteAgentService.getConnection()?.dispose();\n\t\t\t\t\t} catch {\n\t\t\t\t\t\tthis._logService.warn('Error while disconnecting remote agent');\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tid: 'join.disconnectRemote',\n\t\t\t\t\tlabel: nls.localize('disconnectRemote', \"Disconnect Remote Agent\"),\n\t\t\t\t\torder: WillShutdownJoinerOrder.Last // after others have joined that might depend on a remote connection\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tevent.join(this._doStopExtensionHosts(), {\n\t\t\t\t\tid: 'join.stopExtensionHosts',\n\t\t\t\t\tlabel: nls.localize('stopExtensionHosts', \"Stopping Extension Hosts\"),\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t}\n\n\tprotected _getExtensionHostManagers(kind: ExtensionHostKind): IExtensionHostManager[] {\n\t\treturn this._extensionHostManagers.getByKind(kind);\n\t}\n\n\t//#region deltaExtensions\n\n\tprivate async _handleDeltaExtensions(item: DeltaExtensionsQueueItem): Promise<void> {\n\t\tthis._deltaExtensionsQueue.push(item);\n\t\tif (this._inHandleDeltaExtensions) {\n\t\t\t// Let the current item finish, the new one will be picked up\n\t\t\treturn;\n\t\t}\n\n\t\tlet lock: ExtensionDescriptionRegistryLock | null = null;\n\t\ttry {\n\t\t\tthis._inHandleDeltaExtensions = true;\n\n\t\t\t// wait for _initialize to finish before hanlding any delta extension events\n\t\t\tawait this._installedExtensionsReady.wait();\n\n\t\t\tlock = await this._registry.acquireLock('handleDeltaExtensions');\n\t\t\twhile (this._deltaExtensionsQueue.length > 0) {\n\t\t\t\tconst item = this._deltaExtensionsQueue.shift()!;\n\t\t\t\tawait this._deltaExtensions(lock, item.toAdd, item.toRemove);\n\t\t\t}\n\t\t} finally {\n\t\t\tthis._inHandleDeltaExtensions = false;\n\t\t\tlock?.dispose();\n\t\t}\n\t}\n\n\tprivate async _deltaExtensions(lock: ExtensionDescriptionRegistryLock, _toAdd: IExtension[], _toRemove: string[] | IExtension[]): Promise<void> {\n\t\tif (isCI) {\n\t\t\tthis._logService.info(`AbstractExtensionService._deltaExtensions: toAdd: [${_toAdd.map(e => e.identifier.id).join(',')}] toRemove: [${_toRemove.map(e => typeof e === 'string' ? e : e.identifier.id).join(',')}]`);\n\t\t}\n\t\tlet toRemove: IExtensionDescription[] = [];\n\t\tfor (let i = 0, len = _toRemove.length; i < len; i++) {\n\t\t\tconst extensionOrId = _toRemove[i];\n\t\t\tconst extensionId = (typeof extensionOrId === 'string' ? extensionOrId : extensionOrId.identifier.id);\n\t\t\tconst extension = (typeof extensionOrId === 'string' ? null : extensionOrId);\n\t\t\tconst extensionDescription = this._registry.getExtensionDescription(extensionId);\n\t\t\tif (!extensionDescription) {\n\t\t\t\t// ignore disabling/uninstalling an extension which is not running\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (extension && extensionDescription.extensionLocation.scheme !== extension.location.scheme) {\n\t\t\t\t// this event is for a different extension than mine (maybe for the local extension, while I have the remote extension)\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!this.canRemoveExtension(extensionDescription)) {\n\t\t\t\t// uses non-dynamic extension point or is activated\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttoRemove.push(extensionDescription);\n\t\t}\n\n\t\tconst toAdd: IExtensionDescription[] = [];\n\t\tfor (let i = 0, len = _toAdd.length; i < len; i++) {\n\t\t\tconst extension = _toAdd[i];\n\n\t\t\tconst extensionDescription = toExtensionDescription(extension, false);\n\t\t\tif (!extensionDescription) {\n\t\t\t\t// could not scan extension...\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!this._canAddExtension(extensionDescription, toRemove)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttoAdd.push(extensionDescription);\n\t\t}\n\n\t\tif (toAdd.length === 0 && toRemove.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Update the local registry\n\t\tconst result = this._registry.deltaExtensions(lock, toAdd, toRemove.map(e => e.identifier));\n\t\tthis._onDidChangeExtensions.fire({ added: toAdd, removed: toRemove });\n\n\t\ttoRemove = toRemove.concat(result.removedDueToLooping);\n\t\tif (result.removedDueToLooping.length > 0) {\n\t\t\tthis._notificationService.notify({\n\t\t\t\tseverity: Severity.Error,\n\t\t\t\tmessage: nls.localize('looping', \"The following extensions contain dependency loops and have been disabled: {0}\", result.removedDueToLooping.map(e => `'${e.identifier.value}'`).join(', '))\n\t\t\t});\n\t\t}\n\n\t\t// enable or disable proposed API per extension\n\t\tthis._extensionsProposedApi.updateEnabledApiProposals(toAdd);\n\n\t\t// Update extension points\n\t\tthis._doHandleExtensionPoints((<IExtensionDescription[]>[]).concat(toAdd).concat(toRemove), false);\n\n\t\t// Update the extension host\n\t\tawait this._updateExtensionsOnExtHosts(result.versionId, toAdd, toRemove.map(e => e.identifier));\n\n\t\tfor (let i = 0; i < toAdd.length; i++) {\n\t\t\tthis._activateAddedExtensionIfNeeded(toAdd[i]);\n\t\t}\n\t}\n\n\tprivate async _updateExtensionsOnExtHosts(versionId: number, toAdd: IExtensionDescription[], toRemove: ExtensionIdentifier[]): Promise<void> {\n\t\tconst removedRunningLocation = this._runningLocations.deltaExtensions(toAdd, toRemove);\n\t\tconst promises = this._extensionHostManagers.map(\n\t\t\textHostManager => this._updateExtensionsOnExtHost(extHostManager, versionId, toAdd, toRemove, removedRunningLocation)\n\t\t);\n\t\tawait Promise.all(promises);\n\t}\n\n\tprivate async _updateExtensionsOnExtHost(extensionHostManager: IExtensionHostManager, versionId: number, toAdd: IExtensionDescription[], toRemove: ExtensionIdentifier[], removedRunningLocation: ExtensionIdentifierMap<ExtensionRunningLocation | null>): Promise<void> {\n\t\tconst myToAdd = this._runningLocations.filterByExtensionHostManager(toAdd, extensionHostManager);\n\t\tconst myToRemove = filterExtensionIdentifiers(toRemove, removedRunningLocation, extRunningLocation => extensionHostManager.representsRunningLocation(extRunningLocation));\n\t\tconst addActivationEvents = ImplicitActivationEvents.createActivationEventsMap(toAdd);\n\t\tif (isCI) {\n\t\t\tconst printExtIds = (extensions: IExtensionDescription[]) => extensions.map(e => e.identifier.value).join(',');\n\t\t\tconst printIds = (extensions: ExtensionIdentifier[]) => extensions.map(e => e.value).join(',');\n\t\t\tthis._logService.info(`AbstractExtensionService: Calling deltaExtensions: toRemove: [${printIds(toRemove)}], toAdd: [${printExtIds(toAdd)}], myToRemove: [${printIds(myToRemove)}], myToAdd: [${printExtIds(myToAdd)}],`);\n\t\t}\n\t\tawait extensionHostManager.deltaExtensions({ versionId, toRemove, toAdd, addActivationEvents, myToRemove, myToAdd: myToAdd.map(extension => extension.identifier) });\n\t}\n\n\tpublic canAddExtension(extension: IExtensionDescription): boolean {\n\t\treturn this._canAddExtension(extension, []);\n\t}\n\n\tprivate _canAddExtension(extension: IExtensionDescription, extensionsBeingRemoved: IExtensionDescription[]): boolean {\n\t\t// (Also check for renamed extensions)\n\t\tconst existing = this._registry.getExtensionDescriptionByIdOrUUID(extension.identifier, extension.id);\n\t\tif (existing) {\n\t\t\t// This extension is already known (most likely at a different version)\n\t\t\t// so it cannot be added again unless it is removed first\n\t\t\tconst isBeingRemoved = extensionsBeingRemoved.some((extensionDescription) => ExtensionIdentifier.equals(extension.identifier, extensionDescription.identifier));\n\t\t\tif (!isBeingRemoved) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tconst extensionKinds = this._runningLocations.readExtensionKinds(extension);\n\t\tconst isRemote = extension.extensionLocation.scheme === Schemas.vscodeRemote;\n\t\tconst extensionHostKind = this._extensionHostKindPicker.pickExtensionHostKind(extension.identifier, extensionKinds, !isRemote, isRemote, ExtensionRunningPreference.None);\n\t\tif (extensionHostKind === null) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic canRemoveExtension(extension: IExtensionDescription): boolean {\n\t\tconst extensionDescription = this._registry.getExtensionDescription(extension.identifier);\n\t\tif (!extensionDescription) {\n\t\t\t// Can't remove an extension that is unknown!\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._extensionStatus.get(extensionDescription.identifier)?.activationStarted) {\n\t\t\t// Extension is running, cannot remove it safely\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate async _activateAddedExtensionIfNeeded(extensionDescription: IExtensionDescription): Promise<void> {\n\t\tlet shouldActivate = false;\n\t\tlet shouldActivateReason: string | null = null;\n\t\tlet hasWorkspaceContains = false;\n\t\tconst activationEvents = this._activationEventReader.readActivationEvents(extensionDescription);\n\t\tfor (const activationEvent of activationEvents) {\n\t\t\tif (this._allRequestedActivateEvents.has(activationEvent)) {\n\t\t\t\t// This activation event was fired before the extension was added\n\t\t\t\tshouldActivate = true;\n\t\t\t\tshouldActivateReason = activationEvent;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (activationEvent === '*') {\n\t\t\t\tshouldActivate = true;\n\t\t\t\tshouldActivateReason = activationEvent;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (/^workspaceContains/.test(activationEvent)) {\n\t\t\t\thasWorkspaceContains = true;\n\t\t\t}\n\n\t\t\tif (activationEvent === 'onStartupFinished') {\n\t\t\t\tshouldActivate = true;\n\t\t\t\tshouldActivateReason = activationEvent;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (shouldActivate) {\n\t\t\tawait Promise.all(\n\t\t\t\tthis._extensionHostManagers.map(extHostManager => extHostManager.activate(extensionDescription.identifier, { startup: false, extensionId: extensionDescription.identifier, activationEvent: shouldActivateReason! }))\n\t\t\t).then(() => { });\n\t\t} else if (hasWorkspaceContains) {\n\t\t\tconst workspace = await this._contextService.getCompleteWorkspace();\n\t\t\tconst forceUsingSearch = !!this._environmentService.remoteAuthority;\n\t\t\tconst host: IWorkspaceContainsActivationHost = {\n\t\t\t\tlogService: this._logService,\n\t\t\t\tfolders: workspace.folders.map(folder => folder.uri),\n\t\t\t\tforceUsingSearch: forceUsingSearch,\n\t\t\t\texists: (uri) => this._fileService.exists(uri),\n\t\t\t\tcheckExists: (folders, includes, token) => this._instantiationService.invokeFunction((accessor) => checkGlobFileExists(accessor, folders, includes, token))\n\t\t\t};\n\n\t\t\tconst result = await checkActivateWorkspaceContainsExtension(host, extensionDescription);\n\t\t\tif (!result) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait Promise.all(\n\t\t\t\tthis._extensionHostManagers.map(extHostManager => extHostManager.activate(extensionDescription.identifier, { startup: false, extensionId: extensionDescription.identifier, activationEvent: result.activationEvent }))\n\t\t\t).then(() => { });\n\t\t}\n\t}\n\n\t//#endregion\n\n\tprotected async _initialize(): Promise<void> {\n\t\tperf.mark('code/willLoadExtensions');\n\t\tthis._startExtensionHostsIfNecessary(true, []);\n\n\t\tconst lock = await this._registry.acquireLock('_initialize');\n\t\ttry {\n\t\t\tawait this._resolveAndProcessExtensions(lock);\n\t\t\t// Start extension hosts which are not automatically started\n\t\t\tthis._startOnDemandExtensionHosts();\n\t\t} finally {\n\t\t\tlock.dispose();\n\t\t}\n\n\t\tthis._releaseBarrier();\n\t\tperf.mark('code/didLoadExtensions');\n\t\tawait this._handleExtensionTests();\n\t}\n\n\tprivate async _resolveAndProcessExtensions(lock: ExtensionDescriptionRegistryLock,): Promise<void> {\n\t\tlet resolverExtensions: IExtensionDescription[] = [];\n\t\tlet localExtensions: IExtensionDescription[] = [];\n\t\tlet remoteExtensions: IExtensionDescription[] = [];\n\n\t\tfor await (const extensions of this._resolveExtensions()) {\n\t\t\tif (extensions instanceof ResolverExtensions) {\n\t\t\t\tresolverExtensions = checkEnabledAndProposedAPI(this._logService, this._extensionEnablementService, this._extensionsProposedApi, extensions.extensions, false);\n\t\t\t\tthis._registry.deltaExtensions(lock, resolverExtensions, []);\n\t\t\t\tthis._doHandleExtensionPoints(resolverExtensions, true);\n\t\t\t}\n\t\t\tif (extensions instanceof LocalExtensions) {\n\t\t\t\tlocalExtensions = checkEnabledAndProposedAPI(this._logService, this._extensionEnablementService, this._extensionsProposedApi, extensions.extensions, false);\n\t\t\t}\n\t\t\tif (extensions instanceof RemoteExtensions) {\n\t\t\t\tremoteExtensions = checkEnabledAndProposedAPI(this._logService, this._extensionEnablementService, this._extensionsProposedApi, extensions.extensions, false);\n\t\t\t}\n\t\t}\n\n\t\t// `initializeRunningLocation` will look at the complete picture (e.g. an extension installed on both sides),\n\t\t// takes care of duplicates and picks a running location for each extension\n\t\tthis._runningLocations.initializeRunningLocation(localExtensions, remoteExtensions);\n\n\t\tthis._startExtensionHostsIfNecessary(true, []);\n\n\t\t// Some remote extensions could run locally in the web worker, so store them\n\t\tconst remoteExtensionsThatNeedToRunLocally = (this._allowRemoteExtensionsInLocalWebWorker ? this._runningLocations.filterByExtensionHostKind(remoteExtensions, ExtensionHostKind.LocalWebWorker) : []);\n\t\tconst localProcessExtensions = (this._hasLocalProcess ? this._runningLocations.filterByExtensionHostKind(localExtensions, ExtensionHostKind.LocalProcess) : []);\n\t\tconst localWebWorkerExtensions = this._runningLocations.filterByExtensionHostKind(localExtensions, ExtensionHostKind.LocalWebWorker);\n\t\tremoteExtensions = this._runningLocations.filterByExtensionHostKind(remoteExtensions, ExtensionHostKind.Remote);\n\n\t\t// Add locally the remote extensions that need to run locally in the web worker\n\t\tfor (const ext of remoteExtensionsThatNeedToRunLocally) {\n\t\t\tif (!includes(localWebWorkerExtensions, ext.identifier)) {\n\t\t\t\tlocalWebWorkerExtensions.push(ext);\n\t\t\t}\n\t\t}\n\n\t\tconst allExtensions = remoteExtensions.concat(localProcessExtensions).concat(localWebWorkerExtensions);\n\t\tlet toAdd = allExtensions;\n\n\t\tif (resolverExtensions.length) {\n\t\t\t// Add extensions that are not registered as resolvers but are in the final resolved set\n\t\t\ttoAdd = allExtensions.filter(extension => !resolverExtensions.some(e => ExtensionIdentifier.equals(e.identifier, extension.identifier) && e.extensionLocation.toString() === extension.extensionLocation.toString()));\n\t\t\t// Remove extensions that are registered as resolvers but are not in the final resolved set\n\t\t\tif (allExtensions.length < toAdd.length + resolverExtensions.length) {\n\t\t\t\tconst toRemove = resolverExtensions.filter(registered => !allExtensions.some(e => ExtensionIdentifier.equals(e.identifier, registered.identifier) && e.extensionLocation.toString() === registered.extensionLocation.toString()));\n\t\t\t\tif (toRemove.length) {\n\t\t\t\t\tthis._registry.deltaExtensions(lock, [], toRemove.map(e => e.identifier));\n\t\t\t\t\tthis._doHandleExtensionPoints(toRemove, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst result = this._registry.deltaExtensions(lock, toAdd, []);\n\t\tif (result.removedDueToLooping.length > 0) {\n\t\t\tthis._notificationService.notify({\n\t\t\t\tseverity: Severity.Error,\n\t\t\t\tmessage: nls.localize('looping', \"The following extensions contain dependency loops and have been disabled: {0}\", result.removedDueToLooping.map(e => `'${e.identifier.value}'`).join(', '))\n\t\t\t});\n\t\t}\n\n\t\tthis._doHandleExtensionPoints(this._registry.getAllExtensionDescriptions(), false);\n\t}\n\n\tprivate async _handleExtensionTests(): Promise<void> {\n\t\tif (!this._environmentService.isExtensionDevelopment || !this._environmentService.extensionTestsLocationURI) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst extensionHostManager = this.findTestExtensionHost(this._environmentService.extensionTestsLocationURI);\n\t\tif (!extensionHostManager) {\n\t\t\tconst msg = nls.localize('extensionTestError', \"No extension host found that can launch the test runner at {0}.\", this._environmentService.extensionTestsLocationURI.toString());\n\t\t\tconsole.error(msg);\n\t\t\tthis._notificationService.error(msg);\n\t\t\treturn;\n\t\t}\n\n\n\t\tlet exitCode: number;\n\t\ttry {\n\t\t\texitCode = await extensionHostManager.extensionTestsExecute();\n\t\t\tif (isCI) {\n\t\t\t\tthis._logService.info(`Extension host test runner exit code: ${exitCode}`);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (isCI) {\n\t\t\t\tthis._logService.error(`Extension host test runner error`, err);\n\t\t\t}\n\t\t\tconsole.error(err);\n\t\t\texitCode = 1 /* ERROR */;\n\t\t}\n\n\t\tthis._onExtensionHostExit(exitCode);\n\t}\n\n\tprivate findTestExtensionHost(testLocation: URI): IExtensionHostManager | null {\n\t\tlet runningLocation: ExtensionRunningLocation | null = null;\n\n\t\tfor (const extension of this._registry.getAllExtensionDescriptions()) {\n\t\t\tif (isEqualOrParent(testLocation, extension.extensionLocation)) {\n\t\t\t\trunningLocation = this._runningLocations.getRunningLocation(extension.identifier);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (runningLocation === null) {\n\t\t\t// not sure if we should support that, but it was possible to have an test outside an extension\n\n\t\t\tif (testLocation.scheme === Schemas.vscodeRemote) {\n\t\t\t\trunningLocation = new RemoteRunningLocation();\n\t\t\t} else {\n\t\t\t\t// When a debugger attaches to the extension host, it will surface all console.log messages from the extension host,\n\t\t\t\t// but not necessarily from the window. So it would be best if any errors get printed to the console of the extension host.\n\t\t\t\t// That is why here we use the local process extension host even for non-file URIs\n\t\t\t\trunningLocation = new LocalProcessRunningLocation(0);\n\t\t\t}\n\t\t}\n\t\tif (runningLocation !== null) {\n\t\t\treturn this._extensionHostManagers.getByRunningLocation(runningLocation);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _releaseBarrier(): void {\n\t\tthis._installedExtensionsReady.open();\n\t\tthis._onDidRegisterExtensions.fire(undefined);\n\t\tthis._onDidChangeExtensionsStatus.fire(this._registry.getAllExtensionDescriptions().map(e => e.identifier));\n\t}\n\n\t//#region remote authority resolving\n\n\tprotected async _resolveAuthorityInitial(remoteAuthority: string): Promise<ResolverResult> {\n\t\tconst MAX_ATTEMPTS = 5;\n\n\t\tfor (let attempt = 1; ; attempt++) {\n\t\t\ttry {\n\t\t\t\treturn this._resolveAuthorityWithLogging(remoteAuthority);\n\t\t\t} catch (err) {\n\t\t\t\tif (RemoteAuthorityResolverError.isNoResolverFound(err)) {\n\t\t\t\t\t// There is no point in retrying if there is no resolver found\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\n\t\t\t\tif (RemoteAuthorityResolverError.isNotAvailable(err)) {\n\t\t\t\t\t// The resolver is not available and asked us to not retry\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\n\t\t\t\tif (attempt >= MAX_ATTEMPTS) {\n\t\t\t\t\t// Too many failed attempts, give up\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected async _resolveAuthorityAgain(): Promise<void> {\n\t\tconst remoteAuthority = this._environmentService.remoteAuthority;\n\t\tif (!remoteAuthority) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._remoteAuthorityResolverService._clearResolvedAuthority(remoteAuthority);\n\t\ttry {\n\t\t\tconst result = await this._resolveAuthorityWithLogging(remoteAuthority);\n\t\t\tthis._remoteAuthorityResolverService._setResolvedAuthority(result.authority, result.options);\n\t\t} catch (err) {\n\t\t\tthis._remoteAuthorityResolverService._setResolvedAuthorityError(remoteAuthority, err);\n\t\t}\n\t}\n\n\tprivate async _resolveAuthorityWithLogging(remoteAuthority: string): Promise<ResolverResult> {\n\t\tconst authorityPrefix = getRemoteAuthorityPrefix(remoteAuthority);\n\t\tconst sw = StopWatch.create(false);\n\t\tthis._logService.info(`Invoking resolveAuthority(${authorityPrefix})...`);\n\t\ttry {\n\t\t\tperf.mark(`code/willResolveAuthority/${authorityPrefix}`);\n\t\t\tconst result = await this._resolveAuthority(remoteAuthority);\n\t\t\tperf.mark(`code/didResolveAuthorityOK/${authorityPrefix}`);\n\t\t\tthis._logService.info(`resolveAuthority(${authorityPrefix}) returned '${result.authority.connectTo}' after ${sw.elapsed()} ms`);\n\t\t\treturn result;\n\t\t} catch (err) {\n\t\t\tperf.mark(`code/didResolveAuthorityError/${authorityPrefix}`);\n\t\t\tthis._logService.error(`resolveAuthority(${authorityPrefix}) returned an error after ${sw.elapsed()} ms`, err);\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tprotected async _resolveAuthorityOnExtensionHosts(kind: ExtensionHostKind, remoteAuthority: string): Promise<ResolverResult> {\n\n\t\tconst extensionHosts = this._getExtensionHostManagers(kind);\n\t\tif (extensionHosts.length === 0) {\n\t\t\t// no local process extension hosts\n\t\t\tthrow new Error(`Cannot resolve authority`);\n\t\t}\n\n\t\tthis._resolveAuthorityAttempt++;\n\t\tconst results = await Promise.all(extensionHosts.map(extHost => extHost.resolveAuthority(remoteAuthority, this._resolveAuthorityAttempt)));\n\n\t\tlet bestErrorResult: IResolveAuthorityErrorResult | null = null;\n\t\tfor (const result of results) {\n\t\t\tif (result.type === 'ok') {\n\t\t\t\treturn result.value;\n\t\t\t}\n\t\t\tif (!bestErrorResult) {\n\t\t\t\tbestErrorResult = result;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst bestErrorIsUnknown = (bestErrorResult.error.code === RemoteAuthorityResolverErrorCode.Unknown);\n\t\t\tconst errorIsUnknown = (result.error.code === RemoteAuthorityResolverErrorCode.Unknown);\n\t\t\tif (bestErrorIsUnknown && !errorIsUnknown) {\n\t\t\t\tbestErrorResult = result;\n\t\t\t}\n\t\t}\n\n\t\t// we can only reach this if there is an error\n\t\tthrow new RemoteAuthorityResolverError(bestErrorResult!.error.message, bestErrorResult!.error.code, bestErrorResult!.error.detail);\n\t}\n\n\t//#endregion\n\n\t//#region Stopping / Starting / Restarting\n\n\tpublic stopExtensionHosts(reason: string, auto?: boolean): Promise<boolean> {\n\t\treturn this._doStopExtensionHostsWithVeto(reason, auto);\n\t}\n\n\tprotected async _doStopExtensionHosts(): Promise<void> {\n\t\tconst previouslyActivatedExtensionIds: ExtensionIdentifier[] = [];\n\t\tfor (const extensionStatus of this._extensionStatus.values()) {\n\t\t\tif (extensionStatus.activationStarted) {\n\t\t\t\tpreviouslyActivatedExtensionIds.push(extensionStatus.id);\n\t\t\t}\n\t\t}\n\n\t\tawait this._extensionHostManagers.stopAllInReverse();\n\t\tfor (const extensionStatus of this._extensionStatus.values()) {\n\t\t\textensionStatus.clearRuntimeStatus();\n\t\t}\n\n\t\tif (previouslyActivatedExtensionIds.length > 0) {\n\t\t\tthis._onDidChangeExtensionsStatus.fire(previouslyActivatedExtensionIds);\n\t\t}\n\t}\n\n\tprivate async _doStopExtensionHostsWithVeto(reason: string, auto: boolean = false): Promise<boolean> {\n\t\tif (auto && this._environmentService.isExtensionDevelopment) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst vetos: (boolean | Promise<boolean>)[] = [];\n\t\tconst vetoReasons = new Set<string>();\n\n\t\tthis._onWillStop.fire({\n\t\t\treason,\n\t\t\tauto,\n\t\t\tveto(value, reason) {\n\t\t\t\tvetos.push(value);\n\n\t\t\t\tif (typeof value === 'boolean') {\n\t\t\t\t\tif (value === true) {\n\t\t\t\t\t\tvetoReasons.add(reason);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalue.then(value => {\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tvetoReasons.add(reason);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\tvetoReasons.add(nls.localize('extensionStopVetoError', \"{0} (Error: {1})\", reason, toErrorMessage(error)));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst veto = await handleVetos(vetos, error => this._logService.error(error));\n\t\tif (!veto) {\n\t\t\tawait this._doStopExtensionHosts();\n\t\t} else {\n\t\t\tif (!auto) {\n\t\t\t\tconst vetoReasonsArray = Array.from(vetoReasons);\n\n\t\t\t\tthis._logService.warn(`Extension host was not stopped because of veto (stop reason: ${reason}, veto reason: ${vetoReasonsArray.join(', ')})`);\n\n\t\t\t\tconst { confirmed } = await this._dialogService.confirm({\n\t\t\t\t\ttype: Severity.Warning,\n\t\t\t\t\tmessage: nls.localize('extensionStopVetoMessage', \"Please confirm restart of extensions.\"),\n\t\t\t\t\tdetail: vetoReasonsArray.length === 1 ?\n\t\t\t\t\t\tvetoReasonsArray[0] :\n\t\t\t\t\t\tvetoReasonsArray.join('\\n -'),\n\t\t\t\t\tprimaryButton: nls.localize('proceedAnyways', \"Restart Anyway\")\n\t\t\t\t});\n\n\t\t\t\tif (confirmed) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn !veto;\n\t}\n\n\tprivate _startExtensionHostsIfNecessary(isInitialStart: boolean, initialActivationEvents: string[]): void {\n\t\tconst locations: ExtensionRunningLocation[] = [];\n\t\tfor (let affinity = 0; affinity <= this._runningLocations.maxLocalProcessAffinity; affinity++) {\n\t\t\tlocations.push(new LocalProcessRunningLocation(affinity));\n\t\t}\n\t\tfor (let affinity = 0; affinity <= this._runningLocations.maxLocalWebWorkerAffinity; affinity++) {\n\t\t\tlocations.push(new LocalWebWorkerRunningLocation(affinity));\n\t\t}\n\t\tlocations.push(new RemoteRunningLocation());\n\t\tfor (const location of locations) {\n\t\t\tif (this._extensionHostManagers.getByRunningLocation(location)) {\n\t\t\t\t// already running\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst res = this._createExtensionHostManager(location, isInitialStart, initialActivationEvents);\n\t\t\tif (res) {\n\t\t\t\tconst [extHostManager, disposableStore] = res;\n\t\t\t\tthis._extensionHostManagers.add(extHostManager, disposableStore);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _createExtensionHostManager(runningLocation: ExtensionRunningLocation, isInitialStart: boolean, initialActivationEvents: string[]): null | [IExtensionHostManager, DisposableStore] {\n\t\tconst extensionHost = this._extensionHostFactory.createExtensionHost(this._runningLocations, runningLocation, isInitialStart);\n\t\tif (!extensionHost) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst processManager: IExtensionHostManager = this._doCreateExtensionHostManager(extensionHost, initialActivationEvents);\n\t\tconst disposableStore = new DisposableStore();\n\t\tdisposableStore.add(processManager.onDidExit(([code, signal]) => this._onExtensionHostCrashOrExit(processManager, code, signal)));\n\t\tdisposableStore.add(processManager.onDidChangeResponsiveState((responsiveState) => {\n\t\t\tthis._logService.info(`Extension host (${processManager.friendyName}) is ${responsiveState === ResponsiveState.Responsive ? 'responsive' : 'unresponsive'}.`);\n\t\t\tthis._onDidChangeResponsiveChange.fire({\n\t\t\t\textensionHostKind: processManager.kind,\n\t\t\t\tisResponsive: responsiveState === ResponsiveState.Responsive,\n\t\t\t\tgetInspectListener: (tryEnableInspector: boolean) => {\n\t\t\t\t\treturn processManager.getInspectPort(tryEnableInspector);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t\treturn [processManager, disposableStore];\n\t}\n\n\tprotected _doCreateExtensionHostManager(extensionHost: IExtensionHost, initialActivationEvents: string[]): IExtensionHostManager {\n\t\tconst internalExtensionService = this._acquireInternalAPI(extensionHost);\n\t\tif (extensionHost.startup === ExtensionHostStartup.LazyAutoStart) {\n\t\t\treturn this._instantiationService.createInstance(LazyCreateExtensionHostManager, extensionHost, initialActivationEvents, internalExtensionService);\n\t\t}\n\t\treturn this._instantiationService.createInstance(ExtensionHostManager, extensionHost, initialActivationEvents, internalExtensionService);\n\t}\n\n\tprivate _onExtensionHostCrashOrExit(extensionHost: IExtensionHostManager, code: number, signal: string | null): void {\n\n\t\t// Unexpected termination\n\t\tconst isExtensionDevHost = parseExtensionDevOptions(this._environmentService).isExtensionDevHost;\n\t\tif (!isExtensionDevHost) {\n\t\t\tthis._onExtensionHostCrashed(extensionHost, code, signal);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onExtensionHostExit(code);\n\t}\n\n\tprotected _onExtensionHostCrashed(extensionHost: IExtensionHostManager, code: number, signal: string | null): void {\n\t\tconsole.error(`Extension host (${extensionHost.friendyName}) terminated unexpectedly. Code: ${code}, Signal: ${signal}`);\n\t\tif (extensionHost.kind === ExtensionHostKind.LocalProcess) {\n\t\t\tthis._doStopExtensionHosts();\n\t\t} else if (extensionHost.kind === ExtensionHostKind.Remote) {\n\t\t\tif (signal) {\n\t\t\t\tthis._onRemoteExtensionHostCrashed(extensionHost, signal);\n\t\t\t}\n\t\t\tthis._extensionHostManagers.stopOne(extensionHost);\n\t\t}\n\t}\n\n\tprivate _getExtensionHostExitInfoWithTimeout(reconnectionToken: string): Promise<IExtensionHostExitInfo | null> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst timeoutHandle = setTimeout(() => {\n\t\t\t\treject(new Error('getExtensionHostExitInfo timed out'));\n\t\t\t}, 2000);\n\t\t\tthis._remoteAgentService.getExtensionHostExitInfo(reconnectionToken).then(\n\t\t\t\t(r) => {\n\t\t\t\t\tclearTimeout(timeoutHandle);\n\t\t\t\t\tresolve(r);\n\t\t\t\t},\n\t\t\t\treject\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate async _onRemoteExtensionHostCrashed(extensionHost: IExtensionHostManager, reconnectionToken: string): Promise<void> {\n\t\ttry {\n\t\t\tconst info = await this._getExtensionHostExitInfoWithTimeout(reconnectionToken);\n\t\t\tif (info) {\n\t\t\t\tthis._logService.error(`Extension host (${extensionHost.friendyName}) terminated unexpectedly with code ${info.code}.`);\n\t\t\t}\n\n\t\t\tthis._logExtensionHostCrash(extensionHost);\n\t\t\tthis._remoteCrashTracker.registerCrash();\n\n\t\t\tif (this._remoteCrashTracker.shouldAutomaticallyRestart()) {\n\t\t\t\tthis._logService.info(`Automatically restarting the remote extension host.`);\n\t\t\t\tthis._notificationService.status(nls.localize('extensionService.autoRestart', \"The remote extension host terminated unexpectedly. Restarting...\"), { hideAfter: 5000 });\n\t\t\t\tthis._startExtensionHostsIfNecessary(false, Array.from(this._allRequestedActivateEvents.keys()));\n\t\t\t} else {\n\t\t\t\tthis._notificationService.prompt(Severity.Error, nls.localize('extensionService.crash', \"Remote Extension host terminated unexpectedly 3 times within the last 5 minutes.\"),\n\t\t\t\t\t[{\n\t\t\t\t\t\tlabel: nls.localize('restart', \"Restart Remote Extension Host\"),\n\t\t\t\t\t\trun: () => {\n\t\t\t\t\t\t\tthis._startExtensionHostsIfNecessary(false, Array.from(this._allRequestedActivateEvents.keys()));\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\t// maybe this wasn't an extension host crash and it was a permanent disconnection\n\t\t}\n\t}\n\n\tprotected _logExtensionHostCrash(extensionHost: IExtensionHostManager): void {\n\n\t\tconst activatedExtensions: ExtensionIdentifier[] = [];\n\t\tfor (const extensionStatus of this._extensionStatus.values()) {\n\t\t\tif (extensionStatus.activationStarted && extensionHost.containsExtension(extensionStatus.id)) {\n\t\t\t\tactivatedExtensions.push(extensionStatus.id);\n\t\t\t}\n\t\t}\n\n\t\tif (activatedExtensions.length > 0) {\n\t\t\tthis._logService.error(`Extension host (${extensionHost.friendyName}) terminated unexpectedly. The following extensions were running: ${activatedExtensions.map(id => id.value).join(', ')}`);\n\t\t} else {\n\t\t\tthis._logService.error(`Extension host (${extensionHost.friendyName}) terminated unexpectedly. No extensions were activated.`);\n\t\t}\n\t}\n\n\tpublic async startExtensionHosts(updates?: { toAdd: IExtension[]; toRemove: string[] }): Promise<void> {\n\t\tawait this._doStopExtensionHosts();\n\n\t\tif (updates) {\n\t\t\tawait this._handleDeltaExtensions(new DeltaExtensionsQueueItem(updates.toAdd, updates.toRemove));\n\t\t}\n\n\t\tconst lock = await this._registry.acquireLock('startExtensionHosts');\n\t\ttry {\n\t\t\tthis._startExtensionHostsIfNecessary(false, Array.from(this._allRequestedActivateEvents.keys()));\n\t\t\tthis._startOnDemandExtensionHosts();\n\n\t\t\tconst localProcessExtensionHosts = this._getExtensionHostManagers(ExtensionHostKind.LocalProcess);\n\t\t\tawait Promise.all(localProcessExtensionHosts.map(extHost => extHost.ready()));\n\t\t} finally {\n\t\t\tlock.dispose();\n\t\t}\n\t}\n\n\tprivate _startOnDemandExtensionHosts(): void {\n\t\tconst snapshot = this._registry.getSnapshot();\n\t\tfor (const extHostManager of this._extensionHostManagers) {\n\t\t\tif (extHostManager.startup !== ExtensionHostStartup.EagerAutoStart) {\n\t\t\t\tconst extensions = this._runningLocations.filterByExtensionHostManager(snapshot.extensions, extHostManager);\n\t\t\t\textHostManager.start(snapshot.versionId, snapshot.extensions, extensions.map(extension => extension.identifier));\n\t\t\t}\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region IExtensionService\n\n\tpublic activateByEvent(activationEvent: string, activationKind: ActivationKind = ActivationKind.Normal): Promise<void> {\n\t\tif (this._installedExtensionsReady.isOpen()) {\n\t\t\t// Extensions have been scanned and interpreted\n\n\t\t\t// Record the fact that this activationEvent was requested (in case of a restart)\n\t\t\tthis._allRequestedActivateEvents.add(activationEvent);\n\n\t\t\tif (!this._registry.containsActivationEvent(activationEvent)) {\n\t\t\t\t// There is no extension that is interested in this activation event\n\t\t\t\treturn NO_OP_VOID_PROMISE;\n\t\t\t}\n\n\t\t\treturn this._activateByEvent(activationEvent, activationKind);\n\t\t} else {\n\t\t\t// Extensions have not been scanned yet.\n\n\t\t\t// Record the fact that this activationEvent was requested (in case of a restart)\n\t\t\tthis._allRequestedActivateEvents.add(activationEvent);\n\n\t\t\tif (activationKind === ActivationKind.Immediate) {\n\t\t\t\t// Do not wait for the normal start-up of the extension host(s)\n\t\t\t\treturn this._activateByEvent(activationEvent, activationKind);\n\t\t\t}\n\n\t\t\treturn this._installedExtensionsReady.wait().then(() => this._activateByEvent(activationEvent, activationKind));\n\t\t}\n\t}\n\n\tprivate _activateByEvent(activationEvent: string, activationKind: ActivationKind): Promise<void> {\n\t\tconst result = Promise.all(\n\t\t\tthis._extensionHostManagers.map(extHostManager => extHostManager.activateByEvent(activationEvent, activationKind))\n\t\t).then(() => { });\n\t\tthis._onWillActivateByEvent.fire({\n\t\t\tevent: activationEvent,\n\t\t\tactivation: result\n\t\t});\n\t\treturn result;\n\t}\n\n\tpublic activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> {\n\t\treturn this._activateById(extensionId, reason);\n\t}\n\n\tpublic activationEventIsDone(activationEvent: string): boolean {\n\t\tif (!this._installedExtensionsReady.isOpen()) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this._registry.containsActivationEvent(activationEvent)) {\n\t\t\t// There is no extension that is interested in this activation event\n\t\t\treturn true;\n\t\t}\n\t\treturn this._extensionHostManagers.every(manager => manager.activationEventIsDone(activationEvent));\n\t}\n\n\tpublic whenInstalledExtensionsRegistered(): Promise<boolean> {\n\t\treturn this._installedExtensionsReady.wait();\n\t}\n\n\tget extensions(): IExtensionDescription[] {\n\t\treturn this._registry.getAllExtensionDescriptions();\n\t}\n\n\tprotected _getExtensionRegistrySnapshotWhenReady(): Promise<ExtensionDescriptionRegistrySnapshot> {\n\t\treturn this._installedExtensionsReady.wait().then(() => this._registry.getSnapshot());\n\t}\n\n\tpublic getExtension(id: string): Promise<IExtensionDescription | undefined> {\n\t\treturn this._installedExtensionsReady.wait().then(() => {\n\t\t\treturn this._registry.getExtensionDescription(id);\n\t\t});\n\t}\n\n\tpublic readExtensionPointContributions<T extends IExtensionContributions[keyof IExtensionContributions]>(extPoint: IExtensionPoint<T>): Promise<ExtensionPointContribution<T>[]> {\n\t\treturn this._installedExtensionsReady.wait().then(() => {\n\t\t\tconst availableExtensions = this._registry.getAllExtensionDescriptions();\n\n\t\t\tconst result: ExtensionPointContribution<T>[] = [];\n\t\t\tfor (const desc of availableExtensions) {\n\t\t\t\tif (desc.contributes && hasOwnProperty.call(desc.contributes, extPoint.name)) {\n\t\t\t\t\tresult.push(new ExtensionPointContribution<T>(desc, desc.contributes[extPoint.name as keyof typeof desc.contributes] as T));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tpublic getExtensionsStatus(): { [id: string]: IExtensionsStatus } {\n\t\tconst result: { [id: string]: IExtensionsStatus } = Object.create(null);\n\t\tif (this._registry) {\n\t\t\tconst extensions = this._registry.getAllExtensionDescriptions();\n\t\t\tfor (const extension of extensions) {\n\t\t\t\tconst extensionStatus = this._extensionStatus.get(extension.identifier);\n\t\t\t\tresult[extension.identifier.value] = {\n\t\t\t\t\tid: extension.identifier,\n\t\t\t\t\tmessages: extensionStatus?.messages ?? [],\n\t\t\t\t\tactivationStarted: extensionStatus?.activationStarted ?? false,\n\t\t\t\t\tactivationTimes: extensionStatus?.activationTimes ?? undefined,\n\t\t\t\t\truntimeErrors: extensionStatus?.runtimeErrors ?? [],\n\t\t\t\t\trunningLocation: this._runningLocations.getRunningLocation(extension.identifier),\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic async getInspectPorts(extensionHostKind: ExtensionHostKind, tryEnableInspector: boolean): Promise<IExtensionInspectInfo[]> {\n\t\tconst result = await Promise.all(\n\t\t\tthis._getExtensionHostManagers(extensionHostKind).map(async extHost => {\n\t\t\t\tlet portInfo = await extHost.getInspectPort(tryEnableInspector);\n\t\t\t\tif (portInfo !== undefined) {\n\t\t\t\t\tportInfo = { ...portInfo, devtoolsLabel: extHost.friendyName };\n\t\t\t\t}\n\t\t\t\treturn portInfo;\n\t\t\t})\n\t\t);\n\t\t// remove 0s:\n\t\treturn result.filter(isDefined);\n\t}\n\n\tpublic async setRemoteEnvironment(env: { [key: string]: string | null }): Promise<void> {\n\t\tawait this._extensionHostManagers\n\t\t\t.map(manager => manager.setRemoteEnvironment(env));\n\t}\n\n\t//#endregion\n\n\t// --- impl\n\n\tprivate _safeInvokeIsEnabled(extension: IExtension): boolean {\n\t\ttry {\n\t\t\treturn this._extensionEnablementService.isEnabled(extension);\n\t\t} catch (err) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate _doHandleExtensionPoints(affectedExtensions: IExtensionDescription[], onlyResolverExtensionPoints: boolean): void {\n\t\tconst affectedExtensionPoints: { [extPointName: string]: boolean } = Object.create(null);\n\t\tfor (const extensionDescription of affectedExtensions) {\n\t\t\tif (extensionDescription.contributes) {\n\t\t\t\tfor (const extPointName in extensionDescription.contributes) {\n\t\t\t\t\tif (hasOwnProperty.call(extensionDescription.contributes, extPointName)) {\n\t\t\t\t\t\taffectedExtensionPoints[extPointName] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst messageHandler = (msg: IMessage) => this._handleExtensionPointMessage(msg);\n\t\tconst availableExtensions = this._registry.getAllExtensionDescriptions();\n\t\tconst extensionPoints = ExtensionsRegistry.getExtensionPoints();\n\t\tperf.mark(onlyResolverExtensionPoints ? 'code/willHandleResolverExtensionPoints' : 'code/willHandleExtensionPoints');\n\t\tfor (const extensionPoint of extensionPoints) {\n\t\t\tif (affectedExtensionPoints[extensionPoint.name] && (!onlyResolverExtensionPoints || extensionPoint.canHandleResolver)) {\n\t\t\t\tperf.mark(`code/willHandleExtensionPoint/${extensionPoint.name}`);\n\t\t\t\tAbstractExtensionService._handleExtensionPoint(extensionPoint, availableExtensions, messageHandler);\n\t\t\t\tperf.mark(`code/didHandleExtensionPoint/${extensionPoint.name}`);\n\t\t\t}\n\t\t}\n\t\tperf.mark(onlyResolverExtensionPoints ? 'code/didHandleResolverExtensionPoints' : 'code/didHandleExtensionPoints');\n\t}\n\n\tprivate _getOrCreateExtensionStatus(extensionId: ExtensionIdentifier): ExtensionStatus {\n\t\tif (!this._extensionStatus.has(extensionId)) {\n\t\t\tthis._extensionStatus.set(extensionId, new ExtensionStatus(extensionId));\n\t\t}\n\t\treturn this._extensionStatus.get(extensionId)!;\n\t}\n\n\tprivate _handleExtensionPointMessage(msg: IMessage) {\n\t\tconst extensionStatus = this._getOrCreateExtensionStatus(msg.extensionId);\n\t\textensionStatus.addMessage(msg);\n\n\t\tconst extension = this._registry.getExtensionDescription(msg.extensionId);\n\t\tconst strMsg = `[${msg.extensionId.value}]: ${msg.message}`;\n\n\t\tif (msg.type === Severity.Error) {\n\t\t\tif (extension && extension.isUnderDevelopment) {\n\t\t\t\t// This message is about the extension currently being developed\n\t\t\t\tthis._notificationService.notify({ severity: Severity.Error, message: strMsg });\n\t\t\t}\n\t\t\tthis._logService.error(strMsg);\n\t\t} else if (msg.type === Severity.Warning) {\n\t\t\tif (extension && extension.isUnderDevelopment) {\n\t\t\t\t// This message is about the extension currently being developed\n\t\t\t\tthis._notificationService.notify({ severity: Severity.Warning, message: strMsg });\n\t\t\t}\n\t\t\tthis._logService.warn(strMsg);\n\t\t} else {\n\t\t\tthis._logService.info(strMsg);\n\t\t}\n\n\t\tif (msg.extensionId && this._environmentService.isBuilt && !this._environmentService.isExtensionDevelopment) {\n\t\t\tconst { type, extensionId, extensionPointId, message } = msg;\n\t\t\ttype ExtensionsMessageClassification = {\n\t\t\t\towner: 'alexdima';\n\t\t\t\tcomment: 'A validation message for an extension';\n\t\t\t\ttype: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Severity of problem.' };\n\t\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The identifier of the extension that has a problem.' };\n\t\t\t\textensionPointId: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The extension point that has a problem.' };\n\t\t\t\tmessage: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The message of the problem.' };\n\t\t\t};\n\t\t\ttype ExtensionsMessageEvent = {\n\t\t\t\ttype: Severity;\n\t\t\t\textensionId: string;\n\t\t\t\textensionPointId: string;\n\t\t\t\tmessage: string;\n\t\t\t};\n\t\t\tthis._telemetryService.publicLog2<ExtensionsMessageEvent, ExtensionsMessageClassification>('extensionsMessage', {\n\t\t\t\ttype, extensionId: extensionId.value, extensionPointId, message\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate static _handleExtensionPoint<T extends IExtensionContributions[keyof IExtensionContributions]>(extensionPoint: ExtensionPoint<T>, availableExtensions: IExtensionDescription[], messageHandler: (msg: IMessage) => void): void {\n\t\tconst users: IExtensionPointUser<T>[] = [];\n\t\tfor (const desc of availableExtensions) {\n\t\t\tif (desc.contributes && hasOwnProperty.call(desc.contributes, extensionPoint.name)) {\n\t\t\t\tusers.push({\n\t\t\t\t\tdescription: desc,\n\t\t\t\t\tvalue: desc.contributes[extensionPoint.name as keyof typeof desc.contributes] as T,\n\t\t\t\t\tcollector: new ExtensionMessageCollector(messageHandler, desc, extensionPoint.name)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\textensionPoint.acceptUsers(users);\n\t}\n\n\t//#region Called by extension host\n\n\tprivate _acquireInternalAPI(extensionHost: IExtensionHost): IInternalExtensionService {\n\t\treturn {\n\t\t\t_activateById: (extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> => {\n\t\t\t\treturn this._activateById(extensionId, reason);\n\t\t\t},\n\t\t\t_onWillActivateExtension: (extensionId: ExtensionIdentifier): void => {\n\t\t\t\treturn this._onWillActivateExtension(extensionId, extensionHost.runningLocation);\n\t\t\t},\n\t\t\t_onDidActivateExtension: (extensionId: ExtensionIdentifier, codeLoadingTime: number, activateCallTime: number, activateResolvedTime: number, activationReason: ExtensionActivationReason): void => {\n\t\t\t\treturn this._onDidActivateExtension(extensionId, codeLoadingTime, activateCallTime, activateResolvedTime, activationReason);\n\t\t\t},\n\t\t\t_onDidActivateExtensionError: (extensionId: ExtensionIdentifier, error: Error): void => {\n\t\t\t\treturn this._onDidActivateExtensionError(extensionId, error);\n\t\t\t},\n\t\t\t_onExtensionRuntimeError: (extensionId: ExtensionIdentifier, err: Error): void => {\n\t\t\t\treturn this._onExtensionRuntimeError(extensionId, err);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic async _activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> {\n\t\tconst results = await Promise.all(\n\t\t\tthis._extensionHostManagers.map(manager => manager.activate(extensionId, reason))\n\t\t);\n\t\tconst activated = results.some(e => e);\n\t\tif (!activated) {\n\t\t\tthrow new Error(`Unknown extension ${extensionId.value}`);\n\t\t}\n\t}\n\n\tprivate _onWillActivateExtension(extensionId: ExtensionIdentifier, runningLocation: ExtensionRunningLocation): void {\n\t\tthis._runningLocations.set(extensionId, runningLocation);\n\t\tconst extensionStatus = this._getOrCreateExtensionStatus(extensionId);\n\t\textensionStatus.onWillActivate();\n\t}\n\n\tprivate _onDidActivateExtension(extensionId: ExtensionIdentifier, codeLoadingTime: number, activateCallTime: number, activateResolvedTime: number, activationReason: ExtensionActivationReason): void {\n\t\tconst extensionStatus = this._getOrCreateExtensionStatus(extensionId);\n\t\textensionStatus.setActivationTimes(new ActivationTimes(codeLoadingTime, activateCallTime, activateResolvedTime, activationReason));\n\t\tthis._onDidChangeExtensionsStatus.fire([extensionId]);\n\t}\n\n\tprivate _onDidActivateExtensionError(extensionId: ExtensionIdentifier, error: Error): void {\n\t\ttype ExtensionActivationErrorClassification = {\n\t\t\towner: 'alexdima';\n\t\t\tcomment: 'An extension failed to activate';\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The identifier of the extension.' };\n\t\t\terror: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The error message.' };\n\t\t};\n\t\ttype ExtensionActivationErrorEvent = {\n\t\t\textensionId: string;\n\t\t\terror: string;\n\t\t};\n\t\tthis._telemetryService.publicLog2<ExtensionActivationErrorEvent, ExtensionActivationErrorClassification>('extensionActivationError', {\n\t\t\textensionId: extensionId.value,\n\t\t\terror: error.message\n\t\t});\n\t}\n\n\tprivate _onExtensionRuntimeError(extensionId: ExtensionIdentifier, err: Error): void {\n\t\tconst extensionStatus = this._getOrCreateExtensionStatus(extensionId);\n\t\textensionStatus.addRuntimeError(err);\n\t\tthis._onDidChangeExtensionsStatus.fire([extensionId]);\n\t}\n\n\t//#endregion\n\n\tprotected abstract _resolveExtensions(): AsyncIterable<ResolvedExtensions>;\n\tprotected abstract _onExtensionHostExit(code: number): Promise<void>;\n\tprotected abstract _resolveAuthority(remoteAuthority: string): Promise<ResolverResult>;\n}\n\nclass ExtensionHostCollection extends Disposable {\n\n\tprivate _extensionHostManagers: ExtensionHostManagerData[] = [];\n\n\tpublic override dispose() {\n\t\tfor (let i = this._extensionHostManagers.length - 1; i >= 0; i--) {\n\t\t\tconst manager = this._extensionHostManagers[i];\n\t\t\tmanager.extensionHost.disconnect();\n\t\t\tmanager.dispose();\n\t\t}\n\t\tthis._extensionHostManagers = [];\n\t\tsuper.dispose();\n\t}\n\n\tpublic add(extensionHostManager: IExtensionHostManager, disposableStore: DisposableStore): void {\n\t\tthis._extensionHostManagers.push(new ExtensionHostManagerData(extensionHostManager, disposableStore));\n\t}\n\n\tpublic async stopAllInReverse(): Promise<void> {\n\t\t// See https://github.com/microsoft/vscode/issues/152204\n\t\t// Dispose extension hosts in reverse creation order because the local extension host\n\t\t// might be critical in sustaining a connection to the remote extension host\n\t\tfor (let i = this._extensionHostManagers.length - 1; i >= 0; i--) {\n\t\t\tconst manager = this._extensionHostManagers[i];\n\t\t\tawait manager.extensionHost.disconnect();\n\t\t\tmanager.dispose();\n\t\t}\n\t\tthis._extensionHostManagers = [];\n\t}\n\n\tpublic async stopOne(extensionHostManager: IExtensionHostManager): Promise<void> {\n\t\tconst index = this._extensionHostManagers.findIndex(el => el.extensionHost === extensionHostManager);\n\t\tif (index >= 0) {\n\t\t\tthis._extensionHostManagers.splice(index, 1);\n\t\t\tawait extensionHostManager.disconnect();\n\t\t\textensionHostManager.dispose();\n\t\t}\n\t}\n\n\tpublic getByKind(kind: ExtensionHostKind): IExtensionHostManager[] {\n\t\treturn this.filter(el => el.kind === kind);\n\t}\n\n\tpublic getByRunningLocation(runningLocation: ExtensionRunningLocation): IExtensionHostManager | null {\n\t\tfor (const el of this._extensionHostManagers) {\n\t\t\tif (el.extensionHost.representsRunningLocation(runningLocation)) {\n\t\t\t\treturn el.extensionHost;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t*[Symbol.iterator]() {\n\t\tfor (const extensionHostManager of this._extensionHostManagers) {\n\t\t\tyield extensionHostManager.extensionHost;\n\t\t}\n\t}\n\n\tpublic map<T>(callback: (extHostManager: IExtensionHostManager) => T): T[] {\n\t\treturn this._extensionHostManagers.map(el => callback(el.extensionHost));\n\t}\n\n\tpublic every(callback: (extHostManager: IExtensionHostManager) => unknown): boolean {\n\t\treturn this._extensionHostManagers.every(el => callback(el.extensionHost));\n\t}\n\n\tpublic filter(callback: (extHostManager: IExtensionHostManager) => unknown): IExtensionHostManager[] {\n\t\treturn this._extensionHostManagers.filter(el => callback(el.extensionHost)).map(el => el.extensionHost);\n\t}\n}\n\nclass ExtensionHostManagerData {\n\tconstructor(\n\t\tpublic readonly extensionHost: IExtensionHostManager,\n\t\tpublic readonly disposableStore: DisposableStore\n\t) { }\n\n\tpublic dispose(): void {\n\t\tthis.disposableStore.dispose();\n\t\tthis.extensionHost.dispose();\n\t}\n}\n\nexport class ResolverExtensions {\n\tconstructor(\n\t\tpublic readonly extensions: IExtensionDescription[],\n\t) { }\n}\n\nexport class LocalExtensions {\n\tconstructor(\n\t\tpublic readonly extensions: IExtensionDescription[],\n\t) { }\n}\n\nexport class RemoteExtensions {\n\tconstructor(\n\t\tpublic readonly extensions: IExtensionDescription[],\n\t) { }\n}\n\nexport type ResolvedExtensions = ResolverExtensions | LocalExtensions | RemoteExtensions;\n\nexport interface IExtensionHostFactory {\n\tcreateExtensionHost(runningLocations: ExtensionRunningLocationTracker, runningLocation: ExtensionRunningLocation, isInitialStart: boolean): IExtensionHost | null;\n}\n\nclass DeltaExtensionsQueueItem {\n\tconstructor(\n\t\tpublic readonly toAdd: IExtension[],\n\t\tpublic readonly toRemove: string[] | IExtension[]\n\t) { }\n}\n\nexport function isResolverExtension(extension: IExtensionDescription): boolean {\n\treturn !!extension.activationEvents?.some(activationEvent => activationEvent.startsWith('onResolveRemoteAuthority:'));\n}\n\n/**\n * @argument extensions The extensions to be checked.\n * @argument ignoreWorkspaceTrust Do not take workspace trust into account.\n */\nexport function checkEnabledAndProposedAPI(logService: ILogService, extensionEnablementService: IWorkbenchExtensionEnablementService, extensionsProposedApi: ExtensionsProposedApi, extensions: IExtensionDescription[], ignoreWorkspaceTrust: boolean): IExtensionDescription[] {\n\t// enable or disable proposed API per extension\n\textensionsProposedApi.updateEnabledApiProposals(extensions);\n\n\t// keep only enabled extensions\n\treturn filterEnabledExtensions(logService, extensionEnablementService, extensions, ignoreWorkspaceTrust);\n}\n\n/**\n * Return the subset of extensions that are enabled.\n * @argument ignoreWorkspaceTrust Do not take workspace trust into account.\n */\nexport function filterEnabledExtensions(logService: ILogService, extensionEnablementService: IWorkbenchExtensionEnablementService, extensions: IExtensionDescription[], ignoreWorkspaceTrust: boolean): IExtensionDescription[] {\n\tconst enabledExtensions: IExtensionDescription[] = [], extensionsToCheck: IExtensionDescription[] = [], mappedExtensions: IExtension[] = [];\n\tfor (const extension of extensions) {\n\t\tif (extension.isUnderDevelopment) {\n\t\t\t// Never disable extensions under development\n\t\t\tenabledExtensions.push(extension);\n\t\t} else {\n\t\t\textensionsToCheck.push(extension);\n\t\t\tmappedExtensions.push(toExtension(extension));\n\t\t}\n\t}\n\n\tconst enablementStates = extensionEnablementService.getEnablementStates(mappedExtensions, ignoreWorkspaceTrust ? { trusted: true } : undefined);\n\tfor (let index = 0; index < enablementStates.length; index++) {\n\t\tif (extensionEnablementService.isEnabledEnablementState(enablementStates[index])) {\n\t\t\tenabledExtensions.push(extensionsToCheck[index]);\n\t\t} else {\n\t\t\tif (isCI) {\n\t\t\t\tlogService.info(`filterEnabledExtensions: extension '${extensionsToCheck[index].identifier.value}' is disabled`);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn enabledExtensions;\n}\n\n/**\n * @argument extension The extension to be checked.\n * @argument ignoreWorkspaceTrust Do not take workspace trust into account.\n */\nexport function extensionIsEnabled(logService: ILogService, extensionEnablementService: IWorkbenchExtensionEnablementService, extension: IExtensionDescription, ignoreWorkspaceTrust: boolean): boolean {\n\treturn filterEnabledExtensions(logService, extensionEnablementService, [extension], ignoreWorkspaceTrust).includes(extension);\n}\n\nfunction includes(extensions: IExtensionDescription[], identifier: ExtensionIdentifier): boolean {\n\tfor (const extension of extensions) {\n\t\tif (ExtensionIdentifier.equals(extension.identifier, identifier)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport class ExtensionStatus {\n\n\tprivate readonly _messages: IMessage[] = [];\n\tpublic get messages(): IMessage[] {\n\t\treturn this._messages;\n\t}\n\n\tprivate _activationTimes: ActivationTimes | null = null;\n\tpublic get activationTimes(): ActivationTimes | null {\n\t\treturn this._activationTimes;\n\t}\n\n\tprivate _runtimeErrors: Error[] = [];\n\tpublic get runtimeErrors(): Error[] {\n\t\treturn this._runtimeErrors;\n\t}\n\n\tprivate _activationStarted: boolean = false;\n\tpublic get activationStarted(): boolean {\n\t\treturn this._activationStarted;\n\t}\n\n\tconstructor(\n\t\tpublic readonly id: ExtensionIdentifier,\n\t) { }\n\n\tpublic clearRuntimeStatus(): void {\n\t\tthis._activationStarted = false;\n\t\tthis._activationTimes = null;\n\t\tthis._runtimeErrors = [];\n\t}\n\n\tpublic addMessage(msg: IMessage): void {\n\t\tthis._messages.push(msg);\n\t}\n\n\tpublic setActivationTimes(activationTimes: ActivationTimes) {\n\t\tthis._activationTimes = activationTimes;\n\t}\n\n\tpublic addRuntimeError(err: Error): void {\n\t\tthis._runtimeErrors.push(err);\n\t}\n\n\tpublic onWillActivate() {\n\t\tthis._activationStarted = true;\n\t}\n}\n\ninterface IExtensionHostCrashInfo {\n\ttimestamp: number;\n}\n\nexport class ExtensionHostCrashTracker {\n\n\tprivate static _TIME_LIMIT = 5 * 60 * 1000; // 5 minutes\n\tprivate static _CRASH_LIMIT = 3;\n\n\tprivate readonly _recentCrashes: IExtensionHostCrashInfo[] = [];\n\n\tprivate _removeOldCrashes(): void {\n\t\tconst limit = Date.now() - ExtensionHostCrashTracker._TIME_LIMIT;\n\t\twhile (this._recentCrashes.length > 0 && this._recentCrashes[0].timestamp < limit) {\n\t\t\tthis._recentCrashes.shift();\n\t\t}\n\t}\n\n\tpublic registerCrash(): void {\n\t\tthis._removeOldCrashes();\n\t\tthis._recentCrashes.push({ timestamp: Date.now() });\n\t}\n\n\tpublic shouldAutomaticallyRestart(): boolean {\n\t\tthis._removeOldCrashes();\n\t\treturn (this._recentCrashes.length < ExtensionHostCrashTracker._CRASH_LIMIT);\n\t}\n}\n\n/**\n * This can run correctly only on the renderer process because that is the only place\n * where all extension points and all implicit activation events generators are known.\n */\nexport class ImplicitActivationAwareReader implements IActivationEventsReader {\n\tpublic readActivationEvents(extensionDescription: IExtensionDescription): string[] {\n\t\treturn ImplicitActivationEvents.readActivationEvents(extensionDescription);\n\t}\n}\n\nclass ActivationFeatureMarkdowneRenderer extends Disposable implements IExtensionFeatureMarkdownRenderer {\n\n\treadonly type = 'markdown';\n\n\tshouldRender(manifest: IExtensionManifest): boolean {\n\t\treturn !!manifest.activationEvents;\n\t}\n\n\trender(manifest: IExtensionManifest): IRenderedData<IMarkdownString> {\n\t\tconst activationEvents = manifest.activationEvents || [];\n\t\tconst data = new MarkdownString();\n\t\tif (activationEvents.length) {\n\t\t\tfor (const activationEvent of activationEvents) {\n\t\t\t\tdata.appendMarkdown(`- \\`${activationEvent}\\`\\n`);\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tdata,\n\t\t\tdispose: () => { }\n\t\t};\n\t}\n}\n\nRegistry.as<IExtensionFeaturesRegistry>(ExtensionFeaturesExtensions.ExtensionFeaturesRegistry).registerExtensionFeature({\n\tid: 'activationEvents',\n\tlabel: nls.localize('activation', \"Activation Events\"),\n\taccess: {\n\t\tcanToggle: false\n\t},\n\trenderer: new SyncDescriptor(ActivationFeatureMarkdowneRenderer),\n});\n"]}