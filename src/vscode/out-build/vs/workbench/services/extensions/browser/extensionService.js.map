{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/extensions/browser/extensionService.ts","vs/workbench/services/extensions/browser/extensionService.ts"],"names":[],"mappings":"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","file":"extensionService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { ExtensionKind } from '../../../../platform/environment/common/environment.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IAutomatedWindow, getLogs } from '../../../../platform/log/browser/log.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { PersistentConnectionEventType } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { IRemoteAuthorityResolverService, RemoteAuthorityResolverError, ResolverResult } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IRemoteExtensionsScannerService } from '../../../../platform/remote/common/remoteExtensionsScanner.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\nimport { IWebExtensionsScannerService, IWorkbenchExtensionEnablementService, IWorkbenchExtensionManagementService } from '../../extensionManagement/common/extensionManagement.js';\nimport { IWebWorkerExtensionHostDataProvider, IWebWorkerExtensionHostInitData, WebWorkerExtensionHost } from './webWorkerExtensionHost.js';\nimport { FetchFileSystemProvider } from './webWorkerFileSystemProvider.js';\nimport { AbstractExtensionService, IExtensionHostFactory, LocalExtensions, RemoteExtensions, ResolvedExtensions, ResolverExtensions, checkEnabledAndProposedAPI, isResolverExtension } from '../common/abstractExtensionService.js';\nimport { ExtensionDescriptionRegistrySnapshot } from '../common/extensionDescriptionRegistry.js';\nimport { ExtensionHostKind, ExtensionRunningPreference, IExtensionHostKindPicker, extensionHostKindToString, extensionRunningPreferenceToString } from '../common/extensionHostKind.js';\nimport { IExtensionManifestPropertiesService } from '../common/extensionManifestPropertiesService.js';\nimport { ExtensionRunningLocation } from '../common/extensionRunningLocation.js';\nimport { ExtensionRunningLocationTracker, filterExtensionDescriptions } from '../common/extensionRunningLocationTracker.js';\nimport { ExtensionHostExtensions, ExtensionHostStartup, IExtensionHost, IExtensionService, toExtensionDescription } from '../common/extensions.js';\nimport { ExtensionsProposedApi } from '../common/extensionsProposedApi.js';\nimport { dedupExtensions } from '../common/extensionsUtil.js';\nimport { IRemoteExtensionHostDataProvider, IRemoteExtensionHostInitData, RemoteExtensionHost } from '../common/remoteExtensionHost.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\nimport { IRemoteExplorerService } from '../../remote/common/remoteExplorerService.js';\nimport { IUserDataInitializationService } from '../../userData/browser/userDataInit.js';\nimport { IUserDataProfileService } from '../../userDataProfile/common/userDataProfile.js';\nimport { AsyncIterableEmitter, AsyncIterableProducer } from '../../../../base/common/async.js';\n\nexport class ExtensionService extends AbstractExtensionService implements IExtensionService {\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IBrowserWorkbenchEnvironmentService private readonly _browserEnvironmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IWorkbenchExtensionEnablementService extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IProductService productService: IProductService,\n\t\t@IWorkbenchExtensionManagementService extensionManagementService: IWorkbenchExtensionManagementService,\n\t\t@IWorkspaceContextService contextService: IWorkspaceContextService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IExtensionManifestPropertiesService extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t\t@IWebExtensionsScannerService private readonly _webExtensionsScannerService: IWebExtensionsScannerService,\n\t\t@ILogService logService: ILogService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteExtensionsScannerService remoteExtensionsScannerService: IRemoteExtensionsScannerService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IRemoteAuthorityResolverService remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IUserDataInitializationService private readonly _userDataInitializationService: IUserDataInitializationService,\n\t\t@IUserDataProfileService private readonly _userDataProfileService: IUserDataProfileService,\n\t\t@IWorkspaceTrustManagementService private readonly _workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@IRemoteExplorerService private readonly _remoteExplorerService: IRemoteExplorerService,\n\t\t@IDialogService dialogService: IDialogService,\n\t) {\n\t\tconst extensionsProposedApi = instantiationService.createInstance(ExtensionsProposedApi);\n\t\tconst extensionHostFactory = new BrowserExtensionHostFactory(\n\t\t\textensionsProposedApi,\n\t\t\t() => this._scanWebExtensions(),\n\t\t\t() => this._getExtensionRegistrySnapshotWhenReady(),\n\t\t\tinstantiationService,\n\t\t\tremoteAgentService,\n\t\t\tremoteAuthorityResolverService,\n\t\t\textensionEnablementService,\n\t\t\tlogService\n\t\t);\n\t\tsuper(\n\t\t\t{ hasLocalProcess: false, allowRemoteExtensionsInLocalWebWorker: true },\n\t\t\textensionsProposedApi,\n\t\t\textensionHostFactory,\n\t\t\tnew BrowserExtensionHostKindPicker(logService),\n\t\t\tinstantiationService,\n\t\t\tnotificationService,\n\t\t\t_browserEnvironmentService,\n\t\t\ttelemetryService,\n\t\t\textensionEnablementService,\n\t\t\tfileService,\n\t\t\tproductService,\n\t\t\textensionManagementService,\n\t\t\tcontextService,\n\t\t\tconfigurationService,\n\t\t\textensionManifestPropertiesService,\n\t\t\tlogService,\n\t\t\tremoteAgentService,\n\t\t\tremoteExtensionsScannerService,\n\t\t\tlifecycleService,\n\t\t\tremoteAuthorityResolverService,\n\t\t\tdialogService\n\t\t);\n\n\t\t// Initialize installed extensions first and do it only after workbench is ready\n\t\tlifecycleService.when(LifecyclePhase.Ready).then(async () => {\n\t\t\tawait this._userDataInitializationService.initializeInstalledExtensions(this._instantiationService);\n\t\t\tthis._initialize();\n\t\t});\n\n\t\tthis._initFetchFileSystem();\n\t}\n\n\tprivate _initFetchFileSystem(): void {\n\t\tconst provider = new FetchFileSystemProvider();\n\t\tthis._register(this._fileService.registerProvider(Schemas.http, provider));\n\t\tthis._register(this._fileService.registerProvider(Schemas.https, provider));\n\t}\n\n\tprivate _scanWebExtensionsPromise: Promise<IExtensionDescription[]> | undefined;\n\tprivate async _scanWebExtensions(): Promise<IExtensionDescription[]> {\n\t\tif (!this._scanWebExtensionsPromise) {\n\t\t\tthis._scanWebExtensionsPromise = (async () => {\n\t\t\t\tconst system: IExtensionDescription[] = [], user: IExtensionDescription[] = [], development: IExtensionDescription[] = [];\n\t\t\t\ttry {\n\t\t\t\t\tawait Promise.all([\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanSystemExtensions().then(extensions => system.push(...extensions.map(e => toExtensionDescription(e)))),\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanUserExtensions(this._userDataProfileService.currentProfile.extensionsResource, { skipInvalidExtensions: true }).then(extensions => user.push(...extensions.map(e => toExtensionDescription(e)))),\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanExtensionsUnderDevelopment().then(extensions => development.push(...extensions.map(e => toExtensionDescription(e, true))))\n\t\t\t\t\t]);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis._logService.error(error);\n\t\t\t\t}\n\t\t\t\treturn dedupExtensions(system, user, [], development, this._logService);\n\t\t\t})();\n\t\t}\n\t\treturn this._scanWebExtensionsPromise;\n\t}\n\n\tprivate async _resolveExtensionsDefault(emitter: AsyncIterableEmitter<ResolvedExtensions>) {\n\t\tconst [localExtensions, remoteExtensions] = await Promise.all([\n\t\t\tthis._scanWebExtensions(),\n\t\t\tthis._remoteExtensionsScannerService.scanExtensions()\n\t\t]);\n\n\t\tif (remoteExtensions.length) {\n\t\t\temitter.emitOne(new RemoteExtensions(remoteExtensions));\n\t\t}\n\t\temitter.emitOne(new LocalExtensions(localExtensions));\n\t}\n\n\tprotected _resolveExtensions(): AsyncIterable<ResolvedExtensions> {\n\t\treturn new AsyncIterableProducer(emitter => this._doResolveExtensions(emitter));\n\t}\n\n\tprivate async _doResolveExtensions(emitter: AsyncIterableEmitter<ResolvedExtensions>): Promise<void> {\n\t\tif (!this._browserEnvironmentService.expectsResolverExtension) {\n\t\t\treturn this._resolveExtensionsDefault(emitter);\n\t\t}\n\n\t\tconst remoteAuthority = this._environmentService.remoteAuthority!;\n\n\t\t// Now that the canonical URI provider has been registered, we need to wait for the trust state to be\n\t\t// calculated. The trust state will be used while resolving the authority, however the resolver can\n\t\t// override the trust state through the resolver result.\n\t\tawait this._workspaceTrustManagementService.workspaceResolved;\n\n\t\tconst localExtensions = await this._scanWebExtensions();\n\t\tconst resolverExtensions = localExtensions.filter(extension => isResolverExtension(extension));\n\t\tif (resolverExtensions.length) {\n\t\t\temitter.emitOne(new ResolverExtensions(resolverExtensions));\n\t\t}\n\n\t\tlet resolverResult: ResolverResult;\n\t\ttry {\n\t\t\tresolverResult = await this._resolveAuthorityInitial(remoteAuthority);\n\t\t} catch (err) {\n\t\t\tif (RemoteAuthorityResolverError.isHandled(err)) {\n\t\t\t\tconsole.log(`Error handled: Not showing a notification for the error`);\n\t\t\t}\n\t\t\tthis._remoteAuthorityResolverService._setResolvedAuthorityError(remoteAuthority, err);\n\n\t\t\t// Proceed with the local extension host\n\t\t\treturn this._resolveExtensionsDefault(emitter);\n\t\t}\n\n\t\t// set the resolved authority\n\t\tthis._remoteAuthorityResolverService._setResolvedAuthority(resolverResult.authority, resolverResult.options);\n\t\tthis._remoteExplorerService.setTunnelInformation(resolverResult.tunnelInformation);\n\n\t\t// monitor for breakage\n\t\tconst connection = this._remoteAgentService.getConnection();\n\t\tif (connection) {\n\t\t\tconnection.onDidStateChange(async (e) => {\n\t\t\t\tif (e.type === PersistentConnectionEventType.ConnectionLost) {\n\t\t\t\t\tthis._remoteAuthorityResolverService._clearResolvedAuthority(remoteAuthority);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconnection.onReconnecting(() => this._resolveAuthorityAgain());\n\t\t}\n\n\t\treturn this._resolveExtensionsDefault(emitter);\n\t}\n\n\tprotected async _onExtensionHostExit(code: number): Promise<void> {\n\t\t// Dispose everything associated with the extension host\n\t\tawait this._doStopExtensionHosts();\n\n\t\t// If we are running extension tests, forward logs and exit code\n\t\tconst automatedWindow = mainWindow as unknown as IAutomatedWindow;\n\t\tif (typeof automatedWindow.codeAutomationExit === 'function') {\n\t\t\tautomatedWindow.codeAutomationExit(code, await getLogs(this._fileService, this._environmentService));\n\t\t}\n\t}\n\n\tprotected async _resolveAuthority(remoteAuthority: string): Promise<ResolverResult> {\n\t\treturn this._resolveAuthorityOnExtensionHosts(ExtensionHostKind.LocalWebWorker, remoteAuthority);\n\t}\n}\n\nclass BrowserExtensionHostFactory implements IExtensionHostFactory {\n\n\tconstructor(\n\t\tprivate readonly _extensionsProposedApi: ExtensionsProposedApi,\n\t\tprivate readonly _scanWebExtensions: () => Promise<IExtensionDescription[]>,\n\t\tprivate readonly _getExtensionRegistrySnapshotWhenReady: () => Promise<ExtensionDescriptionRegistrySnapshot>,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IRemoteAgentService private readonly _remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteAuthorityResolverService private readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IWorkbenchExtensionEnablementService private readonly _extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tcreateExtensionHost(runningLocations: ExtensionRunningLocationTracker, runningLocation: ExtensionRunningLocation, isInitialStart: boolean): IExtensionHost | null {\n\t\tswitch (runningLocation.kind) {\n\t\t\tcase ExtensionHostKind.LocalProcess: {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tcase ExtensionHostKind.LocalWebWorker: {\n\t\t\t\tconst startup = (\n\t\t\t\t\tisInitialStart\n\t\t\t\t\t\t? ExtensionHostStartup.EagerManualStart\n\t\t\t\t\t\t: ExtensionHostStartup.EagerAutoStart\n\t\t\t\t);\n\t\t\t\treturn this._instantiationService.createInstance(WebWorkerExtensionHost, runningLocation, startup, this._createLocalExtensionHostDataProvider(runningLocations, runningLocation, isInitialStart));\n\t\t\t}\n\t\t\tcase ExtensionHostKind.Remote: {\n\t\t\t\tconst remoteAgentConnection = this._remoteAgentService.getConnection();\n\t\t\t\tif (remoteAgentConnection) {\n\t\t\t\t\treturn this._instantiationService.createInstance(RemoteExtensionHost, runningLocation, this._createRemoteExtensionHostDataProvider(runningLocations, remoteAgentConnection.remoteAuthority));\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _createLocalExtensionHostDataProvider(runningLocations: ExtensionRunningLocationTracker, desiredRunningLocation: ExtensionRunningLocation, isInitialStart: boolean): IWebWorkerExtensionHostDataProvider {\n\t\treturn {\n\t\t\tgetInitData: async (): Promise<IWebWorkerExtensionHostInitData> => {\n\t\t\t\tif (isInitialStart) {\n\t\t\t\t\t// Here we load even extensions that would be disabled by workspace trust\n\t\t\t\t\tconst localExtensions = checkEnabledAndProposedAPI(this._logService, this._extensionEnablementService, this._extensionsProposedApi, await this._scanWebExtensions(), /* ignore workspace trust */true);\n\t\t\t\t\tconst runningLocation = runningLocations.computeRunningLocation(localExtensions, [], false);\n\t\t\t\t\tconst myExtensions = filterExtensionDescriptions(localExtensions, runningLocation, extRunningLocation => desiredRunningLocation.equals(extRunningLocation));\n\t\t\t\t\tconst extensions = new ExtensionHostExtensions(0, localExtensions, myExtensions.map(extension => extension.identifier));\n\t\t\t\t\treturn { extensions };\n\t\t\t\t} else {\n\t\t\t\t\t// restart case\n\t\t\t\t\tconst snapshot = await this._getExtensionRegistrySnapshotWhenReady();\n\t\t\t\t\tconst myExtensions = runningLocations.filterByRunningLocation(snapshot.extensions, desiredRunningLocation);\n\t\t\t\t\tconst extensions = new ExtensionHostExtensions(snapshot.versionId, snapshot.extensions, myExtensions.map(extension => extension.identifier));\n\t\t\t\t\treturn { extensions };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _createRemoteExtensionHostDataProvider(runningLocations: ExtensionRunningLocationTracker, remoteAuthority: string): IRemoteExtensionHostDataProvider {\n\t\treturn {\n\t\t\tremoteAuthority: remoteAuthority,\n\t\t\tgetInitData: async (): Promise<IRemoteExtensionHostInitData> => {\n\t\t\t\tconst snapshot = await this._getExtensionRegistrySnapshotWhenReady();\n\n\t\t\t\tconst remoteEnv = await this._remoteAgentService.getEnvironment();\n\t\t\t\tif (!remoteEnv) {\n\t\t\t\t\tthrow new Error('Cannot provide init data for remote extension host!');\n\t\t\t\t}\n\n\t\t\t\tconst myExtensions = runningLocations.filterByExtensionHostKind(snapshot.extensions, ExtensionHostKind.Remote);\n\t\t\t\tconst extensions = new ExtensionHostExtensions(snapshot.versionId, snapshot.extensions, myExtensions.map(extension => extension.identifier));\n\n\t\t\t\treturn {\n\t\t\t\t\tconnectionData: this._remoteAuthorityResolverService.getConnectionData(remoteAuthority),\n\t\t\t\t\tpid: remoteEnv.pid,\n\t\t\t\t\tappRoot: remoteEnv.appRoot,\n\t\t\t\t\textensionHostLogsPath: remoteEnv.extensionHostLogsPath,\n\t\t\t\t\tglobalStorageHome: remoteEnv.globalStorageHome,\n\t\t\t\t\tworkspaceStorageHome: remoteEnv.workspaceStorageHome,\n\t\t\t\t\textensions,\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport class BrowserExtensionHostKindPicker implements IExtensionHostKindPicker {\n\n\tconstructor(\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tpickExtensionHostKind(extensionId: ExtensionIdentifier, extensionKinds: ExtensionKind[], isInstalledLocally: boolean, isInstalledRemotely: boolean, preference: ExtensionRunningPreference): ExtensionHostKind | null {\n\t\tconst result = BrowserExtensionHostKindPicker.pickRunningLocation(extensionKinds, isInstalledLocally, isInstalledRemotely, preference);\n\t\tthis._logService.trace(`pickRunningLocation for ${extensionId.value}, extension kinds: [${extensionKinds.join(', ')}], isInstalledLocally: ${isInstalledLocally}, isInstalledRemotely: ${isInstalledRemotely}, preference: ${extensionRunningPreferenceToString(preference)} => ${extensionHostKindToString(result)}`);\n\t\treturn result;\n\t}\n\n\tpublic static pickRunningLocation(extensionKinds: ExtensionKind[], isInstalledLocally: boolean, isInstalledRemotely: boolean, preference: ExtensionRunningPreference): ExtensionHostKind | null {\n\t\tconst result: ExtensionHostKind[] = [];\n\t\tlet canRunRemotely = false;\n\t\tfor (const extensionKind of extensionKinds) {\n\t\t\tif (extensionKind === 'ui' && isInstalledRemotely) {\n\t\t\t\t// ui extensions run remotely if possible (but only as a last resort)\n\t\t\t\tif (preference === ExtensionRunningPreference.Remote) {\n\t\t\t\t\treturn ExtensionHostKind.Remote;\n\t\t\t\t} else {\n\t\t\t\t\tcanRunRemotely = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (extensionKind === 'workspace' && isInstalledRemotely) {\n\t\t\t\t// workspace extensions run remotely if possible\n\t\t\t\tif (preference === ExtensionRunningPreference.None || preference === ExtensionRunningPreference.Remote) {\n\t\t\t\t\treturn ExtensionHostKind.Remote;\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ExtensionHostKind.Remote);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (extensionKind === 'web' && (isInstalledLocally || isInstalledRemotely)) {\n\t\t\t\t// web worker extensions run in the local web worker if possible\n\t\t\t\tif (preference === ExtensionRunningPreference.None || preference === ExtensionRunningPreference.Local) {\n\t\t\t\t\treturn ExtensionHostKind.LocalWebWorker;\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ExtensionHostKind.LocalWebWorker);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (canRunRemotely) {\n\t\t\tresult.push(ExtensionHostKind.Remote);\n\t\t}\n\t\treturn (result.length > 0 ? result[0] : null);\n\t}\n}\n\nregisterSingleton(IExtensionService, ExtensionService, InstantiationType.Eager);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { ExtensionKind } from '../../../../platform/environment/common/environment.js';\nimport { ExtensionIdentifier, IExtensionDescription } from '../../../../platform/extensions/common/extensions.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IAutomatedWindow, getLogs } from '../../../../platform/log/browser/log.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { PersistentConnectionEventType } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { IRemoteAuthorityResolverService, RemoteAuthorityResolverError, ResolverResult } from '../../../../platform/remote/common/remoteAuthorityResolver.js';\nimport { IRemoteExtensionsScannerService } from '../../../../platform/remote/common/remoteExtensionsScanner.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\nimport { IWebExtensionsScannerService, IWorkbenchExtensionEnablementService, IWorkbenchExtensionManagementService } from '../../extensionManagement/common/extensionManagement.js';\nimport { IWebWorkerExtensionHostDataProvider, IWebWorkerExtensionHostInitData, WebWorkerExtensionHost } from './webWorkerExtensionHost.js';\nimport { FetchFileSystemProvider } from './webWorkerFileSystemProvider.js';\nimport { AbstractExtensionService, IExtensionHostFactory, LocalExtensions, RemoteExtensions, ResolvedExtensions, ResolverExtensions, checkEnabledAndProposedAPI, isResolverExtension } from '../common/abstractExtensionService.js';\nimport { ExtensionDescriptionRegistrySnapshot } from '../common/extensionDescriptionRegistry.js';\nimport { ExtensionHostKind, ExtensionRunningPreference, IExtensionHostKindPicker, extensionHostKindToString, extensionRunningPreferenceToString } from '../common/extensionHostKind.js';\nimport { IExtensionManifestPropertiesService } from '../common/extensionManifestPropertiesService.js';\nimport { ExtensionRunningLocation } from '../common/extensionRunningLocation.js';\nimport { ExtensionRunningLocationTracker, filterExtensionDescriptions } from '../common/extensionRunningLocationTracker.js';\nimport { ExtensionHostExtensions, ExtensionHostStartup, IExtensionHost, IExtensionService, toExtensionDescription } from '../common/extensions.js';\nimport { ExtensionsProposedApi } from '../common/extensionsProposedApi.js';\nimport { dedupExtensions } from '../common/extensionsUtil.js';\nimport { IRemoteExtensionHostDataProvider, IRemoteExtensionHostInitData, RemoteExtensionHost } from '../common/remoteExtensionHost.js';\nimport { ILifecycleService, LifecyclePhase } from '../../lifecycle/common/lifecycle.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\nimport { IRemoteExplorerService } from '../../remote/common/remoteExplorerService.js';\nimport { IUserDataInitializationService } from '../../userData/browser/userDataInit.js';\nimport { IUserDataProfileService } from '../../userDataProfile/common/userDataProfile.js';\nimport { AsyncIterableEmitter, AsyncIterableProducer } from '../../../../base/common/async.js';\n\nexport class ExtensionService extends AbstractExtensionService implements IExtensionService {\n\n\tconstructor(\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IBrowserWorkbenchEnvironmentService private readonly _browserEnvironmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IWorkbenchExtensionEnablementService extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IFileService fileService: IFileService,\n\t\t@IProductService productService: IProductService,\n\t\t@IWorkbenchExtensionManagementService extensionManagementService: IWorkbenchExtensionManagementService,\n\t\t@IWorkspaceContextService contextService: IWorkspaceContextService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IExtensionManifestPropertiesService extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t\t@IWebExtensionsScannerService private readonly _webExtensionsScannerService: IWebExtensionsScannerService,\n\t\t@ILogService logService: ILogService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteExtensionsScannerService remoteExtensionsScannerService: IRemoteExtensionsScannerService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IRemoteAuthorityResolverService remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IUserDataInitializationService private readonly _userDataInitializationService: IUserDataInitializationService,\n\t\t@IUserDataProfileService private readonly _userDataProfileService: IUserDataProfileService,\n\t\t@IWorkspaceTrustManagementService private readonly _workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@IRemoteExplorerService private readonly _remoteExplorerService: IRemoteExplorerService,\n\t\t@IDialogService dialogService: IDialogService,\n\t) {\n\t\tconst extensionsProposedApi = instantiationService.createInstance(ExtensionsProposedApi);\n\t\tconst extensionHostFactory = new BrowserExtensionHostFactory(\n\t\t\textensionsProposedApi,\n\t\t\t() => this._scanWebExtensions(),\n\t\t\t() => this._getExtensionRegistrySnapshotWhenReady(),\n\t\t\tinstantiationService,\n\t\t\tremoteAgentService,\n\t\t\tremoteAuthorityResolverService,\n\t\t\textensionEnablementService,\n\t\t\tlogService\n\t\t);\n\t\tsuper(\n\t\t\t{ hasLocalProcess: false, allowRemoteExtensionsInLocalWebWorker: true },\n\t\t\textensionsProposedApi,\n\t\t\textensionHostFactory,\n\t\t\tnew BrowserExtensionHostKindPicker(logService),\n\t\t\tinstantiationService,\n\t\t\tnotificationService,\n\t\t\t_browserEnvironmentService,\n\t\t\ttelemetryService,\n\t\t\textensionEnablementService,\n\t\t\tfileService,\n\t\t\tproductService,\n\t\t\textensionManagementService,\n\t\t\tcontextService,\n\t\t\tconfigurationService,\n\t\t\textensionManifestPropertiesService,\n\t\t\tlogService,\n\t\t\tremoteAgentService,\n\t\t\tremoteExtensionsScannerService,\n\t\t\tlifecycleService,\n\t\t\tremoteAuthorityResolverService,\n\t\t\tdialogService\n\t\t);\n\n\t\t// Initialize installed extensions first and do it only after workbench is ready\n\t\tlifecycleService.when(LifecyclePhase.Ready).then(async () => {\n\t\t\tawait this._userDataInitializationService.initializeInstalledExtensions(this._instantiationService);\n\t\t\tthis._initialize();\n\t\t});\n\n\t\tthis._initFetchFileSystem();\n\t}\n\n\tprivate _initFetchFileSystem(): void {\n\t\tconst provider = new FetchFileSystemProvider();\n\t\tthis._register(this._fileService.registerProvider(Schemas.http, provider));\n\t\tthis._register(this._fileService.registerProvider(Schemas.https, provider));\n\t}\n\n\tprivate _scanWebExtensionsPromise: Promise<IExtensionDescription[]> | undefined;\n\tprivate async _scanWebExtensions(): Promise<IExtensionDescription[]> {\n\t\tif (!this._scanWebExtensionsPromise) {\n\t\t\tthis._scanWebExtensionsPromise = (async () => {\n\t\t\t\tconst system: IExtensionDescription[] = [], user: IExtensionDescription[] = [], development: IExtensionDescription[] = [];\n\t\t\t\ttry {\n\t\t\t\t\tawait Promise.all([\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanSystemExtensions().then(extensions => system.push(...extensions.map(e => toExtensionDescription(e)))),\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanUserExtensions(this._userDataProfileService.currentProfile.extensionsResource, { skipInvalidExtensions: true }).then(extensions => user.push(...extensions.map(e => toExtensionDescription(e)))),\n\t\t\t\t\t\tthis._webExtensionsScannerService.scanExtensionsUnderDevelopment().then(extensions => development.push(...extensions.map(e => toExtensionDescription(e, true))))\n\t\t\t\t\t]);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis._logService.error(error);\n\t\t\t\t}\n\t\t\t\treturn dedupExtensions(system, user, [], development, this._logService);\n\t\t\t})();\n\t\t}\n\t\treturn this._scanWebExtensionsPromise;\n\t}\n\n\tprivate async _resolveExtensionsDefault(emitter: AsyncIterableEmitter<ResolvedExtensions>) {\n\t\tconst [localExtensions, remoteExtensions] = await Promise.all([\n\t\t\tthis._scanWebExtensions(),\n\t\t\tthis._remoteExtensionsScannerService.scanExtensions()\n\t\t]);\n\n\t\tif (remoteExtensions.length) {\n\t\t\temitter.emitOne(new RemoteExtensions(remoteExtensions));\n\t\t}\n\t\temitter.emitOne(new LocalExtensions(localExtensions));\n\t}\n\n\tprotected _resolveExtensions(): AsyncIterable<ResolvedExtensions> {\n\t\treturn new AsyncIterableProducer(emitter => this._doResolveExtensions(emitter));\n\t}\n\n\tprivate async _doResolveExtensions(emitter: AsyncIterableEmitter<ResolvedExtensions>): Promise<void> {\n\t\tif (!this._browserEnvironmentService.expectsResolverExtension) {\n\t\t\treturn this._resolveExtensionsDefault(emitter);\n\t\t}\n\n\t\tconst remoteAuthority = this._environmentService.remoteAuthority!;\n\n\t\t// Now that the canonical URI provider has been registered, we need to wait for the trust state to be\n\t\t// calculated. The trust state will be used while resolving the authority, however the resolver can\n\t\t// override the trust state through the resolver result.\n\t\tawait this._workspaceTrustManagementService.workspaceResolved;\n\n\t\tconst localExtensions = await this._scanWebExtensions();\n\t\tconst resolverExtensions = localExtensions.filter(extension => isResolverExtension(extension));\n\t\tif (resolverExtensions.length) {\n\t\t\temitter.emitOne(new ResolverExtensions(resolverExtensions));\n\t\t}\n\n\t\tlet resolverResult: ResolverResult;\n\t\ttry {\n\t\t\tresolverResult = await this._resolveAuthorityInitial(remoteAuthority);\n\t\t} catch (err) {\n\t\t\tif (RemoteAuthorityResolverError.isHandled(err)) {\n\t\t\t\tconsole.log(`Error handled: Not showing a notification for the error`);\n\t\t\t}\n\t\t\tthis._remoteAuthorityResolverService._setResolvedAuthorityError(remoteAuthority, err);\n\n\t\t\t// Proceed with the local extension host\n\t\t\treturn this._resolveExtensionsDefault(emitter);\n\t\t}\n\n\t\t// set the resolved authority\n\t\tthis._remoteAuthorityResolverService._setResolvedAuthority(resolverResult.authority, resolverResult.options);\n\t\tthis._remoteExplorerService.setTunnelInformation(resolverResult.tunnelInformation);\n\n\t\t// monitor for breakage\n\t\tconst connection = this._remoteAgentService.getConnection();\n\t\tif (connection) {\n\t\t\tconnection.onDidStateChange(async (e) => {\n\t\t\t\tif (e.type === PersistentConnectionEventType.ConnectionLost) {\n\t\t\t\t\tthis._remoteAuthorityResolverService._clearResolvedAuthority(remoteAuthority);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconnection.onReconnecting(() => this._resolveAuthorityAgain());\n\t\t}\n\n\t\treturn this._resolveExtensionsDefault(emitter);\n\t}\n\n\tprotected async _onExtensionHostExit(code: number): Promise<void> {\n\t\t// Dispose everything associated with the extension host\n\t\tawait this._doStopExtensionHosts();\n\n\t\t// If we are running extension tests, forward logs and exit code\n\t\tconst automatedWindow = mainWindow as unknown as IAutomatedWindow;\n\t\tif (typeof automatedWindow.codeAutomationExit === 'function') {\n\t\t\tautomatedWindow.codeAutomationExit(code, await getLogs(this._fileService, this._environmentService));\n\t\t}\n\t}\n\n\tprotected async _resolveAuthority(remoteAuthority: string): Promise<ResolverResult> {\n\t\treturn this._resolveAuthorityOnExtensionHosts(ExtensionHostKind.LocalWebWorker, remoteAuthority);\n\t}\n}\n\nclass BrowserExtensionHostFactory implements IExtensionHostFactory {\n\n\tconstructor(\n\t\tprivate readonly _extensionsProposedApi: ExtensionsProposedApi,\n\t\tprivate readonly _scanWebExtensions: () => Promise<IExtensionDescription[]>,\n\t\tprivate readonly _getExtensionRegistrySnapshotWhenReady: () => Promise<ExtensionDescriptionRegistrySnapshot>,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IRemoteAgentService private readonly _remoteAgentService: IRemoteAgentService,\n\t\t@IRemoteAuthorityResolverService private readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IWorkbenchExtensionEnablementService private readonly _extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tcreateExtensionHost(runningLocations: ExtensionRunningLocationTracker, runningLocation: ExtensionRunningLocation, isInitialStart: boolean): IExtensionHost | null {\n\t\tswitch (runningLocation.kind) {\n\t\t\tcase ExtensionHostKind.LocalProcess: {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tcase ExtensionHostKind.LocalWebWorker: {\n\t\t\t\tconst startup = (\n\t\t\t\t\tisInitialStart\n\t\t\t\t\t\t? ExtensionHostStartup.EagerManualStart\n\t\t\t\t\t\t: ExtensionHostStartup.EagerAutoStart\n\t\t\t\t);\n\t\t\t\treturn this._instantiationService.createInstance(WebWorkerExtensionHost, runningLocation, startup, this._createLocalExtensionHostDataProvider(runningLocations, runningLocation, isInitialStart));\n\t\t\t}\n\t\t\tcase ExtensionHostKind.Remote: {\n\t\t\t\tconst remoteAgentConnection = this._remoteAgentService.getConnection();\n\t\t\t\tif (remoteAgentConnection) {\n\t\t\t\t\treturn this._instantiationService.createInstance(RemoteExtensionHost, runningLocation, this._createRemoteExtensionHostDataProvider(runningLocations, remoteAgentConnection.remoteAuthority));\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _createLocalExtensionHostDataProvider(runningLocations: ExtensionRunningLocationTracker, desiredRunningLocation: ExtensionRunningLocation, isInitialStart: boolean): IWebWorkerExtensionHostDataProvider {\n\t\treturn {\n\t\t\tgetInitData: async (): Promise<IWebWorkerExtensionHostInitData> => {\n\t\t\t\tif (isInitialStart) {\n\t\t\t\t\t// Here we load even extensions that would be disabled by workspace trust\n\t\t\t\t\tconst localExtensions = checkEnabledAndProposedAPI(this._logService, this._extensionEnablementService, this._extensionsProposedApi, await this._scanWebExtensions(), /* ignore workspace trust */true);\n\t\t\t\t\tconst runningLocation = runningLocations.computeRunningLocation(localExtensions, [], false);\n\t\t\t\t\tconst myExtensions = filterExtensionDescriptions(localExtensions, runningLocation, extRunningLocation => desiredRunningLocation.equals(extRunningLocation));\n\t\t\t\t\tconst extensions = new ExtensionHostExtensions(0, localExtensions, myExtensions.map(extension => extension.identifier));\n\t\t\t\t\treturn { extensions };\n\t\t\t\t} else {\n\t\t\t\t\t// restart case\n\t\t\t\t\tconst snapshot = await this._getExtensionRegistrySnapshotWhenReady();\n\t\t\t\t\tconst myExtensions = runningLocations.filterByRunningLocation(snapshot.extensions, desiredRunningLocation);\n\t\t\t\t\tconst extensions = new ExtensionHostExtensions(snapshot.versionId, snapshot.extensions, myExtensions.map(extension => extension.identifier));\n\t\t\t\t\treturn { extensions };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _createRemoteExtensionHostDataProvider(runningLocations: ExtensionRunningLocationTracker, remoteAuthority: string): IRemoteExtensionHostDataProvider {\n\t\treturn {\n\t\t\tremoteAuthority: remoteAuthority,\n\t\t\tgetInitData: async (): Promise<IRemoteExtensionHostInitData> => {\n\t\t\t\tconst snapshot = await this._getExtensionRegistrySnapshotWhenReady();\n\n\t\t\t\tconst remoteEnv = await this._remoteAgentService.getEnvironment();\n\t\t\t\tif (!remoteEnv) {\n\t\t\t\t\tthrow new Error('Cannot provide init data for remote extension host!');\n\t\t\t\t}\n\n\t\t\t\tconst myExtensions = runningLocations.filterByExtensionHostKind(snapshot.extensions, ExtensionHostKind.Remote);\n\t\t\t\tconst extensions = new ExtensionHostExtensions(snapshot.versionId, snapshot.extensions, myExtensions.map(extension => extension.identifier));\n\n\t\t\t\treturn {\n\t\t\t\t\tconnectionData: this._remoteAuthorityResolverService.getConnectionData(remoteAuthority),\n\t\t\t\t\tpid: remoteEnv.pid,\n\t\t\t\t\tappRoot: remoteEnv.appRoot,\n\t\t\t\t\textensionHostLogsPath: remoteEnv.extensionHostLogsPath,\n\t\t\t\t\tglobalStorageHome: remoteEnv.globalStorageHome,\n\t\t\t\t\tworkspaceStorageHome: remoteEnv.workspaceStorageHome,\n\t\t\t\t\textensions,\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport class BrowserExtensionHostKindPicker implements IExtensionHostKindPicker {\n\n\tconstructor(\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tpickExtensionHostKind(extensionId: ExtensionIdentifier, extensionKinds: ExtensionKind[], isInstalledLocally: boolean, isInstalledRemotely: boolean, preference: ExtensionRunningPreference): ExtensionHostKind | null {\n\t\tconst result = BrowserExtensionHostKindPicker.pickRunningLocation(extensionKinds, isInstalledLocally, isInstalledRemotely, preference);\n\t\tthis._logService.trace(`pickRunningLocation for ${extensionId.value}, extension kinds: [${extensionKinds.join(', ')}], isInstalledLocally: ${isInstalledLocally}, isInstalledRemotely: ${isInstalledRemotely}, preference: ${extensionRunningPreferenceToString(preference)} => ${extensionHostKindToString(result)}`);\n\t\treturn result;\n\t}\n\n\tpublic static pickRunningLocation(extensionKinds: ExtensionKind[], isInstalledLocally: boolean, isInstalledRemotely: boolean, preference: ExtensionRunningPreference): ExtensionHostKind | null {\n\t\tconst result: ExtensionHostKind[] = [];\n\t\tlet canRunRemotely = false;\n\t\tfor (const extensionKind of extensionKinds) {\n\t\t\tif (extensionKind === 'ui' && isInstalledRemotely) {\n\t\t\t\t// ui extensions run remotely if possible (but only as a last resort)\n\t\t\t\tif (preference === ExtensionRunningPreference.Remote) {\n\t\t\t\t\treturn ExtensionHostKind.Remote;\n\t\t\t\t} else {\n\t\t\t\t\tcanRunRemotely = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (extensionKind === 'workspace' && isInstalledRemotely) {\n\t\t\t\t// workspace extensions run remotely if possible\n\t\t\t\tif (preference === ExtensionRunningPreference.None || preference === ExtensionRunningPreference.Remote) {\n\t\t\t\t\treturn ExtensionHostKind.Remote;\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ExtensionHostKind.Remote);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (extensionKind === 'web' && (isInstalledLocally || isInstalledRemotely)) {\n\t\t\t\t// web worker extensions run in the local web worker if possible\n\t\t\t\tif (preference === ExtensionRunningPreference.None || preference === ExtensionRunningPreference.Local) {\n\t\t\t\t\treturn ExtensionHostKind.LocalWebWorker;\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(ExtensionHostKind.LocalWebWorker);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (canRunRemotely) {\n\t\t\tresult.push(ExtensionHostKind.Remote);\n\t\t}\n\t\treturn (result.length > 0 ? result[0] : null);\n\t}\n}\n\nregisterSingleton(IExtensionService, ExtensionService, InstantiationType.Eager);\n"]}