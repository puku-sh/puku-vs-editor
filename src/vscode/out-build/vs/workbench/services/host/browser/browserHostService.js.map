{"version":3,"sources":["vs/workbench/services/host/browser/browserHostService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAEhG,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,kCAAkC,CAAC;AAClE,OAAO,EAAE,YAAY,EAAE,MAAM,WAAW,CAAC;AACzC,OAAO,EAAqB,iBAAiB,EAAE,MAAM,yDAAyD,CAAC;AAC/G,OAAO,EAAE,cAAc,EAAE,MAAM,sDAAsD,CAAC;AACtF,OAAO,EAAE,cAAc,EAAE,MAAM,sCAAsC,CAAC;AACtE,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAwD,cAAc,EAAE,iBAAiB,EAAE,YAAY,EAA8F,MAAM,8CAA8C,CAAC;AACjQ,OAAO,EAAE,qBAAqB,EAAE,cAAc,EAAE,MAAM,2BAA2B,CAAC;AAClF,OAAO,EAAE,gBAAgB,EAAE,MAAM,4BAA4B,CAAC;AAE9D,OAAO,EAAE,YAAY,EAAE,MAAM,4CAA4C,CAAC;AAC1E,OAAO,EAAE,aAAa,EAAa,MAAM,4CAA4C,CAAC;AACtF,OAAO,EAAE,SAAS,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,8BAA8B,EAAE,gBAAgB,EAAE,wBAAwB,EAAE,iBAAiB,EAAE,eAAe,EAAE,WAAW,EAAE,mBAAmB,EAAE,UAAU,EAAE,UAAU,IAAI,aAAa,EAAE,MAAM,iCAAiC,CAAC;AAClS,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE,YAAY,EAAE,MAAM,sCAAsC,CAAC;AACjG,OAAO,EAAE,mCAAmC,EAAE,MAAM,iDAAiD,CAAC;AACtG,OAAO,EAAE,OAAO,EAAE,MAAM,uCAAuC,CAAC;AAChE,OAAO,EAAE,uBAAuB,EAAE,MAAM,oCAAoC,CAAC;AAE7E,OAAO,EAAE,wBAAwB,EAAE,MAAM,6CAA6C,CAAC;AACvF,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AACnG,OAAO,EAAE,iBAAiB,EAAuC,MAAM,qCAAqC,CAAC;AAE7G,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,sBAAsB,EAAE,MAAM,wCAAwC,CAAC;AAChF,OAAO,EAAE,QAAQ,EAAE,MAAM,oBAAoB,CAAC;AAC9C,OAAO,QAAQ,MAAM,qCAAqC,CAAC;AAC3D,OAAO,EAAE,cAAc,EAAE,MAAM,gDAAgD,CAAC;AAChF,OAAO,EAAE,UAAU,EAAE,MAAM,mCAAmC,CAAC;AAC/D,OAAO,EAAE,WAAW,EAAE,MAAM,kCAAkC,CAAC;AAC/D,OAAO,EAAE,oBAAoB,EAAE,wBAAwB,EAAE,qBAAqB,EAAE,MAAM,oDAAoD,CAAC;AAE3I,OAAO,EAAE,OAAO,EAAE,MAAM,oCAAoC,CAAC;AAE7D,OAAO,EAAE,QAAQ,EAAE,MAAM,mCAAmC,CAAC;AAC7D,OAAO,EAAE,UAAU,EAAE,iBAAiB,EAAE,MAAM,oCAAoC,CAAC;AACnF,OAAO,EAAE,KAAK,EAAE,WAAW,EAAE,MAAM,qCAAqC,CAAC;AACzE,OAAO,EAAE,wBAAwB,EAAE,MAAM,gEAAgE,CAAC;AAE1G,OAAO,EAAE,QAAQ,EAAE,MAAM,mCAAmC,CAAC;AAC7D,OAAO,EAAE,cAAc,EAAE,MAAM,wCAAwC,CAAC;AAExE,IAAK,kBAgBJ;AAhBD,WAAK,kBAAkB;IAEtB;;OAEG;IACH,iEAAW,CAAA;IAEX;;OAEG;IACH,mEAAY,CAAA;IAEZ;;OAEG;IACH,yDAAO,CAAA;AACR,CAAC,EAhBI,kBAAkB,KAAlB,kBAAkB,QAgBtB;AAEM,IAAM,kBAAkB,GAAxB,MAAM,kBAAmB,SAAQ,UAAU;IAQjD,YACiB,aAA8C,EACvC,oBAA4D,EACrE,WAA0C,EACzC,YAA4C,EACtB,kBAAwE,EACtF,oBAA4D,EAChE,gBAA0D,EAChE,UAAwC,EACrC,aAA8C,EACpC,cAAyD,EACzD,uBAAkE;QAE5F,KAAK,EAAE,CAAC;QAZyB,kBAAa,GAAb,aAAa,CAAgB;QACtB,yBAAoB,GAApB,oBAAoB,CAAuB;QACpD,gBAAW,GAAX,WAAW,CAAc;QACxB,iBAAY,GAAZ,YAAY,CAAe;QACL,uBAAkB,GAAlB,kBAAkB,CAAqC;QACrE,yBAAoB,GAApB,oBAAoB,CAAuB;QAC/C,qBAAgB,GAAhB,gBAAgB,CAAyB;QAC/C,eAAU,GAAV,UAAU,CAAa;QACpB,kBAAa,GAAb,aAAa,CAAgB;QACnB,mBAAc,GAAd,cAAc,CAA0B;QACxC,4BAAuB,GAAvB,uBAAuB,CAA0B;QAbrF,mBAAc,GAAG,kBAAkB,CAAC,OAAO,CAAC;QAiBnD,IAAI,kBAAkB,CAAC,OAAO,EAAE,iBAAiB,EAAE,CAAC;YACnD,IAAI,CAAC,iBAAiB,GAAG,kBAAkB,CAAC,OAAO,CAAC,iBAAiB,CAAC;QACvE,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,iBAAiB,GAAG,IAAI;gBAAA;oBACnB,cAAS,GAAG,SAAS,CAAC;oBACtB,YAAO,GAAG,SAAS,CAAC;gBAE9B,CAAC;gBADA,KAAK,CAAC,IAAI,KAAK,OAAO,IAAI,CAAC,CAAC,CAAC;aAC7B,CAAC;QACH,CAAC;QAED,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC1B,CAAC;IAGO,iBAAiB;QAExB,iEAAiE;QACjE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEtF,iDAAiD;QACjD,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,6BAA6B,EAAE,CAAC,CAAC,CAAC;IACpG,CAAC;IAEO,gBAAgB,CAAC,CAAsB;QAE9C,QAAQ,IAAI,CAAC,cAAc,EAAE,CAAC;YAE7B,qDAAqD;YACrD,KAAK,kBAAkB,CAAC,OAAO,CAAC;YAChC,KAAK,kBAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAClC,MAAM,kBAAkB,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,2BAA2B,CAAC,CAAC;gBAC3F,IAAI,kBAAkB,KAAK,QAAQ,IAAI,CAAC,kBAAkB,KAAK,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,kBAAkB,CAAC,QAAQ,CAAC,EAAE,CAAC;oBACvI,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,yBAAyB,CAAC,CAAC;gBACzC,CAAC;gBACD,MAAM;YACP,CAAC;YACD,uBAAuB;YACvB,KAAK,kBAAkB,CAAC,GAAG;gBAC1B,MAAM;QACR,CAAC;QAED,0BAA0B;QAC1B,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC,OAAO,CAAC;IAClD,CAAC;IAEO,6BAA6B;QACpC,IAAI,IAAI,CAAC,cAAc,KAAK,kBAAkB,CAAC,GAAG,EAAE,CAAC;YACpD,OAAO,CAAC,sDAAsD;QAC/D,CAAC;QAED,IAAI,kBAAkB,CAAC,WAAW,EAAE,CAAC,iBAAiB,EAAE,CAAC;YACxD,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC,QAAQ,CAAC;QACnD,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC,OAAO,CAAC;QAClD,CAAC;IACF,CAAC;IAED,eAAe;IAGf,IAAI,gBAAgB;QACnB,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAW,CAAC,CAAC;QAEvD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,eAAe,CAAC,mBAAmB,EAAE,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,EAAE;YACrF,MAAM,YAAY,GAAG,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;YACzD,MAAM,iBAAiB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,UAAU,CAAC,MAAM,CAAC,QAAQ,EAAE,kBAAkB,CAAC,CAAC,CAAC;YAE/F,KAAK,CAAC,GAAG,CACR,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,EACpE,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,EACnE,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC,KAAK,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,EACpE,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,uBAAuB,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,CACzE,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC;QACzD,CAAC,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEtD,OAAO,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IAC3D,CAAC;IAED,IAAI,QAAQ;QACX,OAAO,iBAAiB,EAAE,CAAC,QAAQ,EAAE,CAAC;IACvC,CAAC;IAED,KAAK,CAAC,YAAY;QACjB,OAAO,IAAI,CAAC;IACb,CAAC;IAED,KAAK,CAAC,KAAK,CAAC,YAAoB;QAC/B,YAAY,CAAC,KAAK,EAAE,CAAC;IACtB,CAAC;IAED,YAAY;IAGZ,gBAAgB;IAGhB,IAAI,uBAAuB;QAC1B,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAAU,CAAC,CAAC;QAEtD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,eAAe,CAAC,mBAAmB,EAAE,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,EAAE;YACrF,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;YAErC,0BAA0B;YAC1B,MAAM,YAAY,GAAG,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;YACzD,WAAW,CAAC,GAAG,CAAC,YAAY,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAEvE,mEAAmE;YACnE,gEAAgE;YAChE,iDAAiD;YACjD,IAAI,iBAAiB,CAAC,MAAM,CAAC,EAAE,CAAC;gBAC/B,WAAW,CAAC,GAAG,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,EAAE;oBACrD,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;oBAC5C,IAAI,QAAQ,EAAE,CAAC;wBACd,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBACxB,CAAC;oBAED,OAAO,QAAQ,CAAC;gBACjB,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC;YACd,CAAC;QACF,CAAC,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEtD,OAAO,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IAC3D,CAAC;IAGD,IAAI,qBAAqB;QACxB,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,OAAO,EAA6C,CAAC,CAAC;QAEzF,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,eAAe,CAAC,mBAAmB,EAAE,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,EAAE;YACrF,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;YACrC,MAAM,QAAQ,GAAG,KAAK,IAAI,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,sBAAsB,CAAC,CAAC,CAAC,MAAM,CAAC,sBAAsB,CAAC;YAE/H,uBAAuB;YACvB,KAAK,MAAM,KAAK,IAAI,CAAC,SAAS,CAAC,iBAAiB,EAAE,SAAS,CAAC,oBAAoB,CAAC,EAAE,CAAC;gBACnF,WAAW,CAAC,GAAG,CAAC,qBAAqB,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;YAC1I,CAAC;YAED,sBAAsB;YACtB,WAAW,CAAC,GAAG,CAAC,8BAA8B,CAAC,QAAQ,EAAE,SAAS,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,gCAAgC,CAAC,CAAC,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC,CAAC;QACpP,CAAC,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAEtD,OAAO,OAAO,CAAC,KAAK,CAAC;IACtB,CAAC;IAID,UAAU,CAAC,IAAkD,EAAE,IAAyB;QACvF,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;YACzB,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACtC,CAAC;QAED,OAAO,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;IACrC,CAAC;IAEO,KAAK,CAAC,YAAY,CAAC,MAAyB,EAAE,OAA4B;QACjF,MAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,yBAAyB,EAAE,OAAO,CAAC,CAAC;QAC/E,MAAM,aAAa,GAAkB,EAAE,CAAC;QAExC,MAAM,YAAY,GAAmC,EAAE,CAAC;QACxD,MAAM,eAAe,GAAU,EAAE,CAAC;QAElC,KAAK,MAAM,QAAQ,IAAI,MAAM,EAAE,CAAC;YAC/B,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,IAAI,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAEjE,SAAS;YACT,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;gBAC9B,IAAI,OAAO,EAAE,OAAO,EAAE,CAAC;oBACtB,YAAY,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC;gBAChD,CAAC;qBAAM,IAAI,OAAO,EAAE,UAAU,EAAE,CAAC;oBAChC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;gBAC1C,CAAC;qBAAM,CAAC;oBACP,IAAI,CAAC,MAAM,CAAC,EAAE,SAAS,EAAE,QAAQ,CAAC,SAAS,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,aAAa,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC;gBACpH,CAAC;YACF,CAAC;YAED,YAAY;iBACP,IAAI,iBAAiB,CAAC,QAAQ,CAAC,EAAE,CAAC;gBACtC,IAAI,CAAC,MAAM,CAAC,EAAE,YAAY,EAAE,QAAQ,CAAC,YAAY,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,aAAa,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC;YAC1H,CAAC;YAED,+BAA+B;iBAC1B,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE,CAAC;gBACjC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,CAAC;QACF,CAAC;QAED,kCAAkC;QAClC,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC3D,IAAI,CAAC,YAAY,CAAC,KAAK,EAAC,QAAQ,EAAC,EAAE;gBAClC,MAAM,uBAAuB,GAA6B,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gBACjG,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBAC7B,MAAM,uBAAuB,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;gBACxD,CAAC;gBAED,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;oBAChC,MAAM,uBAAuB,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;gBAC9D,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;QAED,eAAe;QACf,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YAC9B,IAAI,CAAC,YAAY,CAAC,KAAK,EAAC,QAAQ,EAAC,EAAE;gBAClC,MAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;gBAEnD,oBAAoB;gBACpB,IAAI,OAAO,EAAE,SAAS,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBACtD,MAAM,OAAO,GAAG,QAAQ,CAAC,MAAM,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;oBACjG,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;wBAClL,OAAO,CAAC,oBAAoB;oBAC7B,CAAC;oBAED,yDAAyD;oBACzD,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;wBAChD,aAAa,CAAC,UAAU,CAAC;4BACxB,MAAM,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BACzC,MAAM,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BACzC,IAAI,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BACvC,MAAM,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BACzC,OAAO,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE;yBACzB,CAAC,CAAC;oBACJ,CAAC;oBAED,qCAAqC;yBAChC,CAAC;wBACL,MAAM,WAAW,GAAG,IAAI,GAAG,EAAkB,CAAC;wBAC9C,WAAW,CAAC,GAAG,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBAC9D,WAAW,CAAC,GAAG,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBAC9D,WAAW,CAAC,GAAG,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBACjE,WAAW,CAAC,GAAG,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBAEnE,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;oBACxE,CAAC;gBACF,CAAC;gBAED,mBAAmB;qBACd,IAAI,OAAO,EAAE,QAAQ,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;oBAC1D,MAAM,OAAO,GAAG,QAAQ,CAAC,MAAM,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;oBACjG,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;wBACtG,OAAO,CAAC,oBAAoB;oBAC7B,CAAC;oBAED,yDAAyD;oBACzD,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;wBAChD,aAAa,CAAC,UAAU,CAAC;4BACxB,QAAQ,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BAC3C,QAAQ,EAAE,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;4BAC3C,OAAO,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE;yBACzB,CAAC,CAAC;oBACJ,CAAC;oBAED,qCAAqC;yBAChC,CAAC;wBACL,MAAM,WAAW,GAAG,IAAI,GAAG,EAAkB,CAAC;wBAC9C,WAAW,CAAC,GAAG,CAAC,mBAAmB,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBACrE,WAAW,CAAC,GAAG,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;wBAEnE,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;oBACxE,CAAC;gBACF,CAAC;gBAED,qBAAqB;qBAChB,CAAC;oBACL,KAAK,MAAM,QAAQ,IAAI,aAAa,EAAE,CAAC;wBAEtC,yDAAyD;wBACzD,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC;4BAChD,IAAI,SAAS,GAAoC,EAAE,CAAC;4BAEpD,gDAAgD;4BAChD,IAAI,OAAO,EAAE,YAAY,EAAE,CAAC;gCAC3B,MAAM,eAAe,GAAG,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gCACvE,SAAS,GAAG,CAAC;wCACZ,OAAO,EAAE,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,eAAe,CAAC,IAAI,EAAE,CAAC;wCAC9D,OAAO,EAAE;4CACR,SAAS,EAAE,CAAC,WAAW,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,eAAe,EAAE,eAAe,CAAC,IAAI,EAAE,WAAW,EAAE,eAAe,CAAC,MAAM,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS;yCAC/I;qCACD,CAAC,CAAC;4BACJ,CAAC;iCAAM,CAAC;gCACP,SAAS,GAAG,CAAC,QAAQ,CAAC,CAAC;4BACxB,CAAC;4BAED,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,cAAc,CAAC,SAAS,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC;wBAC7I,CAAC;wBAED,qCAAqC;6BAChC,CAAC;4BACL,MAAM,WAAW,GAAG,IAAI,GAAG,EAAkB,CAAC;4BAC9C,WAAW,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC;4BAEzD,IAAI,OAAO,EAAE,YAAY,EAAE,CAAC;gCAC3B,WAAW,CAAC,GAAG,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;4BACzC,CAAC;4BAED,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;wBACxE,CAAC;oBACF,CAAC;gBACF,CAAC;gBAED,oBAAoB;gBACpB,MAAM,iBAAiB,GAAG,OAAO,EAAE,iBAAiB,CAAC;gBACrD,IAAI,iBAAiB,EAAE,CAAC;oBACvB,CAAC,KAAK,IAAI,EAAE;wBAEX,4DAA4D;wBAC5D,MAAM,cAAc,GAAU,EAAE,CAAC;wBACjC,IAAI,OAAO,CAAC,SAAS,EAAE,CAAC;4BACvB,cAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,qCAAqC,CAAC,CAAC;wBACrF,CAAC;6BAAM,CAAC;4BACP,cAAc,CAAC,IAAI,CAAC,GAAG,aAAa,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;wBACjF,CAAC;wBACD,MAAM,IAAI,CAAC,oBAAoB,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC,gBAAgB,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC,CAAC;wBAEvG,0CAA0C;wBAC1C,MAAM,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;oBAC/C,CAAC,CAAC,EAAE,CAAC;gBACN,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;IAEO,YAAY,CAAC,EAA2C;QAC/D,8DAA8D;QAC9D,+DAA+D;QAC/D,sDAAsD;QACtD,IAAI,CAAC,oBAAoB,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC;IACpE,CAAC;IAEO,eAAe,CAAC,aAAsB,EAAE,OAA4B;QAE3E,uFAAuF;QACvF,MAAM,UAAU,GAAmB,EAAE,CAAC;QACtC,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,kBAAkB,CAAC,+BAA+B,EAAE,CAAC;YAC/E,UAAU,CAAC,IAAI,CAAC,CAAC,0BAA0B,EAAE,IAAI,CAAC,kBAAkB,CAAC,+BAA+B,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YAElH,IAAI,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,OAAO,EAAE,CAAC;gBACxD,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC;YAClF,CAAC;YAED,IAAI,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;gBACrD,UAAU,CAAC,IAAI,CAAC,CAAC,wBAAwB,EAAE,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACtG,CAAC;QACF,CAAC;QAED,MAAM,gBAAgB,GAAG,OAAO,EAAE,YAAY;YAC7C,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,KAAK,OAAO,EAAE,YAAY,CAAC;YAC/F,CAAC,CAAC,SAAS,CAAC;QACb,IAAI,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC;YACrD,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC;QACrD,CAAC;QAED,OAAO,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC;IACnD,CAAC;IAEO,cAAc,CAAC,QAAyB;QAC/C,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC9B,OAAO,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,QAAQ,CAAC,SAAS,EAAE,EAAE,OAAO,wBAAgB,EAAE,CAAC,CAAC;QAC7F,CAAC;QAED,IAAI,iBAAiB,CAAC,QAAQ,CAAC,EAAE,CAAC;YACjC,OAAO,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,EAAE,OAAO,wBAAgB,EAAE,CAAC,CAAC;QACxH,CAAC;QAED,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,EAAE,EAAE,qBAAqB,EAAE,IAAI,EAAE,CAAC,CAAC;IACzF,CAAC;IAEO,WAAW,CAAC,UAA8B,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,MAAe;QACrF,IAAI,OAAO,CAAC,iBAAiB,EAAE,CAAC;YAC/B,OAAO,IAAI,CAAC,CAAC,sCAAsC;QACpD,CAAC;QAED,MAAM,YAAY,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAA8B,QAAQ,CAAC,CAAC;QAC/F,MAAM,qBAAqB,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,oBAAoB,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,sBAAsB,IAAI,SAAS,CAAC,aAAa,CAAC,CAAC;QAEvK,IAAI,eAAe,GAAG,CAAC,OAAO,CAAC,eAAe,IAAI,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC;QACzG,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,CAAC,OAAO,CAAC,gBAAgB,IAAI,CAAC,qBAAqB,KAAK,IAAI,IAAI,qBAAqB,KAAK,KAAK,CAAC,EAAE,CAAC;YACjI,eAAe,GAAG,CAAC,qBAAqB,KAAK,IAAI,CAAC,CAAC;QACpD,CAAC;QAED,OAAO,CAAC,eAAe,CAAC;IACzB,CAAC;IAEO,KAAK,CAAC,iBAAiB,CAAC,OAAiC;QAChE,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;YAC7B,KAAK,EAAE,OAAO,EAAE,gBAAgB;YAChC,OAAO,EAAE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,kBAAkB,EAAE,OAAO,CAAC;SAC/D,CAAC,CAAC;IACJ,CAAC;IAEO,KAAK,CAAC,MAAM,CAAC,SAAqB,EAAE,OAA+C;QAE1F,4EAA4E;QAC5E,0EAA0E;QAC1E,yEAAyE;QACzE,yBAAyB;QACzB,IAAI,SAAS,IAAI,cAAc,CAAC,SAAS,CAAC,IAAI,SAAS,CAAC,SAAS,CAAC,MAAM,KAAK,OAAO,CAAC,IAAI,IAAI,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,EAAE,CAAC;YACvJ,IAAI,CAAC,YAAY,CAAC,KAAK,EAAC,QAAQ,EAAC,EAAE;gBAClC,MAAM,uBAAuB,GAA6B,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gBAEjG,MAAM,uBAAuB,CAAC,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,SAAS,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;YACnI,CAAC,CAAC,CAAC;YAEH,OAAO;QACR,CAAC;QAED,gEAAgE;QAChE,2DAA2D;QAC3D,IAAI,OAAO,EAAE,KAAK,EAAE,CAAC;YACpB,MAAM,IAAI,CAAC,sBAAsB,6BAAqB,CAAC;QACxD,CAAC;QAED,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;QACrE,IAAI,CAAC,MAAM,EAAE,CAAC;YACb,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;gBAC/B,IAAI,EAAE,QAAQ,CAAC,OAAO;gBACtB,OAAO,EAAE,SAAS,CAAC,CAAC;oBACnB,QAAQ,CAAC,KAA+B,EAAE,IAAwF,EAAE,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;oBACrK,QAAQ,CAAC,KAAsB,EAAE,IAA8E,CAAC;gBACjH,MAAM,EAAE;oBACP,eAAe,EAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,cAAc,CAAC,QAAQ,CAAC,KAA0B,EAAE,IAAwE,EAAE,mCAAmC,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC;iBAC9M;gBACD,OAAO,EAAE;oBACR;wBACC,KAAK,EAAE,QAAQ,CAAC,EAAE,GAAG,AAA+C,EAA7C,AAA+C,IAAS,CAAC,EAAlD,EAAE,OAAO,EAAE,CAAC,uBAAuB,CAAC;wBAClE,GAAG,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC;qBAC1D;iBACD;gBACD,YAAY,EAAE,IAAI;aAClB,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,YAAoB;QAC1C,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;QAE7D,WAAW;QACX,IAAI,YAAY,CAAC,QAAQ,CAAC,UAAU,KAAK,SAAS,EAAE,CAAC;YACpD,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;gBACvC,IAAI,CAAC;oBACJ,OAAO,MAAM,MAAM,CAAC,iBAAiB,EAAE,CAAC;gBACzC,CAAC;gBAAC,OAAO,KAAK,EAAE,CAAC;oBAChB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,8CAA8C,CAAC,CAAC,CAAC,6EAA6E;gBACpJ,CAAC;YACF,CAAC;iBAAM,CAAC;gBACP,IAAI,CAAC;oBACJ,OAAO,MAAM,YAAY,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC;gBACrD,CAAC;gBAAC,OAAO,KAAK,EAAE,CAAC;oBAChB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC;gBACnE,CAAC;YACF,CAAC;QACF,CAAC;QAcD,MAAM,cAAc,GAAG,YAAY,CAAC,QAA0B,CAAC;QAC/D,MAAM,aAAa,GAAG,MAA2B,CAAC;QAClD,IAAI,cAAc,CAAC,kBAAkB,KAAK,SAAS,EAAE,CAAC;YACrD,IAAI,CAAC;gBACJ,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,CAAC;oBACxC,aAAa,CAAC,uBAAuB,EAAE,CAAC,CAAC,gDAAgD;gBAC1F,CAAC;qBAAM,CAAC;oBACP,cAAc,CAAC,oBAAoB,EAAE,CAAC,CAAC,gDAAgD;gBACxF,CAAC;YACF,CAAC;YAAC,MAAM,CAAC;gBACR,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,6DAA6D,CAAC,CAAC;YACrF,CAAC;QACF,CAAC;IACF,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,YAAoB;QACjC,kEAAkE;IACnE,CAAC;IAED,KAAK,CAAC,oBAAoB;QACzB,OAAO,SAAS,CAAC;IAClB,CAAC;IAID,KAAK,CAAC,UAAU,CAAC,OAA6C;QAC7D,MAAM,YAAY,GAAG,eAAe,EAAE,CAAC;QACvC,MAAM,cAAc,GAAG,WAAW,CAAC,YAAY,CAAC,CAAC;QAEjD,cAAc;QACd,MAAM,MAAM,GAAsD,CAAC;gBAClE,EAAE,EAAE,cAAc;gBAClB,KAAK,EAAE,YAAY,CAAC,QAAQ,CAAC,KAAK;gBAClC,SAAS,EAAE,qBAAqB,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;gBACpE,KAAK,EAAE,KAAK;aACZ,CAAC,CAAC;QAEH,oBAAoB;QACpB,IAAI,OAAO,CAAC,uBAAuB,EAAE,CAAC;YACrC,KAAK,MAAM,EAAE,MAAM,EAAE,IAAI,aAAa,EAAE,EAAE,CAAC;gBAC1C,MAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;gBACrC,IAAI,QAAQ,KAAK,cAAc,IAAI,iBAAiB,CAAC,MAAM,CAAC,EAAE,CAAC;oBAC9D,MAAM,CAAC,IAAI,CAAC;wBACX,EAAE,EAAE,QAAQ;wBACZ,KAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,KAAK;wBAC5B,QAAQ,EAAE,cAAc;qBACxB,CAAC,CAAC;gBACJ,CAAC;YACF,CAAC;QACF,CAAC;QAED,OAAO,MAAM,CAAC;IACf,CAAC;IAED,YAAY;IAEZ,mBAAmB;IAEnB,KAAK,CAAC,OAAO;QACZ,IAAI,CAAC,MAAM,EAAE,CAAC;IACf,CAAC;IAED,KAAK,CAAC,MAAM;QACX,MAAM,IAAI,CAAC,sBAAsB,+BAAuB,CAAC;QAEzD,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;IAC9B,CAAC;IAED,KAAK,CAAC,KAAK;QACV,MAAM,IAAI,CAAC,sBAAsB,8BAAsB,CAAC;QAExD,UAAU,CAAC,KAAK,EAAE,CAAC;IACpB,CAAC;IAED,KAAK,CAAC,oBAAoB,CAAI,oBAAsC;QACnE,MAAM,sBAAsB,GAAG,IAAI,CAAC,cAAc,CAAC;QACnD,IAAI,CAAC;YACJ,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC,GAAG,CAAC;YAC7C,OAAO,MAAM,oBAAoB,EAAE,CAAC;QACrC,CAAC;gBAAS,CAAC;YACV,IAAI,CAAC,cAAc,GAAG,sBAAsB,CAAC;QAC9C,CAAC;IACF,CAAC;IAEO,KAAK,CAAC,sBAAsB,CAAC,MAAsB;QAE1D,6CAA6C;QAC7C,+CAA+C;QAC/C,YAAY;QACZ,IAAI,CAAC,cAAc,GAAG,kBAAkB,CAAC,GAAG,CAAC;QAE7C,sCAAsC;QACtC,OAAO,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;IAC3D,CAAC;IAED,YAAY;IAEZ,qBAAqB;IAErB,KAAK,CAAC,aAAa;QAClB,yFAAyF;QACzF,yFAAyF;QACzF,0FAA0F;QAC1F,sEAAsE;QACtE,MAAM,KAAK,GAAG,IAAI,eAAe,EAAE,CAAC;QAEpC,4DAA4D;QAC5D,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC9C,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC9C,IAAI,MAA+B,CAAC;QACpC,IAAI,CAAC;YACJ,wEAAwE;YACxE,MAAM,GAAG,MAAM,SAAS,CAAC,YAAY,CAAC,eAAe,CAAC;gBACrD,KAAK,EAAE,KAAK;gBACZ,KAAK,EAAE,IAAI;aACX,CAAC,CAAC;YAEH,oDAAoD;YACpD,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;YACzB,KAAK,CAAC,IAAI,EAAE,CAAC;YAEb,sEAAsE;YACtE,MAAM,OAAO,CAAC,GAAG,CAAC;gBACjB,IAAI,OAAO,CAAO,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,qBAAqB,CAAC,KAAK,EAAE,gBAAgB,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC5F,IAAI,OAAO,CAAO,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,qBAAqB,CAAC,KAAK,EAAE,gBAAgB,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aAC5F,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YAChD,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC;YAChC,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC;YAElC,MAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACpC,IAAI,CAAC,GAAG,EAAE,CAAC;gBACV,OAAO,SAAS,CAAC;YAClB,CAAC;YAED,2EAA2E;YAC3E,GAAG,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;YAExD,kEAAkE;YAClE,MAAM,IAAI,GAAgB,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC,CAAC;YACrH,IAAI,CAAC,IAAI,EAAE,CAAC;gBACX,MAAM,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC;YACtD,CAAC;YAED,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,KAAK,EAAE,CAAC;YAC/B,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAE3B,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YAChB,OAAO,CAAC,KAAK,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;YACjD,OAAO,SAAS,CAAC;QAClB,CAAC;gBAAS,CAAC;YACV,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACZ,KAAK,MAAM,KAAK,IAAI,MAAM,CAAC,SAAS,EAAE,EAAE,CAAC;oBACxC,KAAK,CAAC,IAAI,EAAE,CAAC;gBACd,CAAC;YACF,CAAC;QACF,CAAC;IACF,CAAC;IAED,KAAK,CAAC,YAAY;QACjB,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,YAAY;IAEZ,uBAAuB;IAEvB,KAAK,CAAC,qBAAqB,CAAC,SAAiB;QAC5C,OAAO,SAAS,CAAC;IAClB,CAAC;CAGD,CAAA;AAlkBA;IADC,OAAO;0DAiBP;AAoBD;IADC,OAAO;iEA2BP;AAGD;IADC,OAAO;+DAkBP;AArKW,kBAAkB;IAS5B,WAAA,cAAc,CAAA;IACd,WAAA,qBAAqB,CAAA;IACrB,WAAA,YAAY,CAAA;IACZ,WAAA,aAAa,CAAA;IACb,WAAA,mCAAmC,CAAA;IACnC,WAAA,qBAAqB,CAAA;IACrB,WAAA,iBAAiB,CAAA;IACjB,WAAA,WAAW,CAAA;IACX,WAAA,cAAc,CAAA;IACd,WAAA,wBAAwB,CAAA;IACxB,YAAA,wBAAwB,CAAA;GAnBd,kBAAkB,CAqpB9B;;AAED,iBAAiB,CAAC,YAAY,EAAE,kBAAkB,oCAA4B,CAAC","file":"browserHostService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IHostService } from './host.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { IEditorService } from '../../editor/common/editorService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IWindowSettings, IWindowOpenable, IOpenWindowOptions, isFolderToOpen, isWorkspaceToOpen, isFileToOpen, IOpenEmptyWindowOptions, IPathData, IFileToOpen, IOpenedMainWindow, IOpenedAuxiliaryWindow } from '../../../../platform/window/common/window.js';\nimport { isResourceEditorInput, pathsToEditors } from '../../../common/editor.js';\nimport { whenEditorClosed } from '../../../browser/editor.js';\nimport { IWorkspace, IWorkspaceProvider } from '../../../browser/web.api.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { ILabelService, Verbosity } from '../../../../platform/label/common/label.js';\nimport { EventType, ModifierKeyEmitter, addDisposableListener, addDisposableThrottledListener, detectFullscreen, disposableWindowInterval, getActiveDocument, getActiveWindow, getWindowId, onDidRegisterWindow, trackFocus, getWindows as getDOMWindows } from '../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../../environment/browser/environmentService.js';\nimport { memoize } from '../../../../base/common/decorators.js';\nimport { parseLineAndColumnAware } from '../../../../base/common/extpath.js';\nimport { IWorkspaceFolderCreationData } from '../../../../platform/workspaces/common/workspaces.js';\nimport { IWorkspaceEditingService } from '../../workspaces/common/workspaceEditing.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILifecycleService, BeforeShutdownEvent, ShutdownReason } from '../../lifecycle/common/lifecycle.js';\nimport { BrowserLifecycleService } from '../../lifecycle/browser/lifecycleService.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { getWorkspaceIdentifier } from '../../workspaces/browser/workspaces.js';\nimport { localize } from '../../../../nls.js';\nimport Severity from '../../../../base/common/severity.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { DomEmitter } from '../../../../base/browser/event.js';\nimport { isUndefined } from '../../../../base/common/types.js';\nimport { isTemporaryWorkspace, IWorkspaceContextService, toWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ITextEditorOptions } from '../../../../platform/editor/common/editor.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { mainWindow, isAuxiliaryWindow } from '../../../../base/browser/window.js';\nimport { isIOS, isMacintosh } from '../../../../base/common/platform.js';\nimport { IUserDataProfilesService } from '../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\n\nenum HostShutdownReason {\n\n\t/**\n\t * An unknown shutdown reason.\n\t */\n\tUnknown = 1,\n\n\t/**\n\t * A shutdown that was potentially triggered by keyboard use.\n\t */\n\tKeyboard = 2,\n\n\t/**\n\t * An explicit shutdown via code.\n\t */\n\tApi = 3\n}\n\nexport class BrowserHostService extends Disposable implements IHostService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate workspaceProvider: IWorkspaceProvider;\n\n\tprivate shutdownReason = HostShutdownReason.Unknown;\n\n\tconstructor(\n\t\t@ILayoutService private readonly layoutService: ILayoutService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IBrowserWorkbenchEnvironmentService private readonly environmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ILifecycleService private readonly lifecycleService: BrowserLifecycleService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IUserDataProfilesService private readonly userDataProfilesService: IUserDataProfilesService\n\t) {\n\t\tsuper();\n\n\t\tif (environmentService.options?.workspaceProvider) {\n\t\t\tthis.workspaceProvider = environmentService.options.workspaceProvider;\n\t\t} else {\n\t\t\tthis.workspaceProvider = new class implements IWorkspaceProvider {\n\t\t\t\treadonly workspace = undefined;\n\t\t\t\treadonly trusted = undefined;\n\t\t\t\tasync open() { return true; }\n\t\t\t};\n\t\t}\n\n\t\tthis.registerListeners();\n\t}\n\n\n\tprivate registerListeners(): void {\n\n\t\t// Veto shutdown depending on `window.confirmBeforeClose` setting\n\t\tthis._register(this.lifecycleService.onBeforeShutdown(e => this.onBeforeShutdown(e)));\n\n\t\t// Track modifier keys to detect keybinding usage\n\t\tthis._register(ModifierKeyEmitter.getInstance().event(() => this.updateShutdownReasonFromEvent()));\n\t}\n\n\tprivate onBeforeShutdown(e: BeforeShutdownEvent): void {\n\n\t\tswitch (this.shutdownReason) {\n\n\t\t\t// Unknown / Keyboard shows veto depending on setting\n\t\t\tcase HostShutdownReason.Unknown:\n\t\t\tcase HostShutdownReason.Keyboard: {\n\t\t\t\tconst confirmBeforeClose = this.configurationService.getValue('window.confirmBeforeClose');\n\t\t\t\tif (confirmBeforeClose === 'always' || (confirmBeforeClose === 'keyboardOnly' && this.shutdownReason === HostShutdownReason.Keyboard)) {\n\t\t\t\t\te.veto(true, 'veto.confirmBeforeClose');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// Api never shows veto\n\t\t\tcase HostShutdownReason.Api:\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Unset for next shutdown\n\t\tthis.shutdownReason = HostShutdownReason.Unknown;\n\t}\n\n\tprivate updateShutdownReasonFromEvent(): void {\n\t\tif (this.shutdownReason === HostShutdownReason.Api) {\n\t\t\treturn; // do not overwrite any explicitly set shutdown reason\n\t\t}\n\n\t\tif (ModifierKeyEmitter.getInstance().isModifierPressed) {\n\t\t\tthis.shutdownReason = HostShutdownReason.Keyboard;\n\t\t} else {\n\t\t\tthis.shutdownReason = HostShutdownReason.Unknown;\n\t\t}\n\t}\n\n\t//#region Focus\n\n\t@memoize\n\tget onDidChangeFocus(): Event<boolean> {\n\t\tconst emitter = this._register(new Emitter<boolean>());\n\n\t\tthis._register(Event.runAndSubscribe(onDidRegisterWindow, ({ window, disposables }) => {\n\t\t\tconst focusTracker = disposables.add(trackFocus(window));\n\t\t\tconst visibilityTracker = disposables.add(new DomEmitter(window.document, 'visibilitychange'));\n\n\t\t\tEvent.any(\n\t\t\t\tEvent.map(focusTracker.onDidFocus, () => this.hasFocus, disposables),\n\t\t\t\tEvent.map(focusTracker.onDidBlur, () => this.hasFocus, disposables),\n\t\t\t\tEvent.map(visibilityTracker.event, () => this.hasFocus, disposables),\n\t\t\t\tEvent.map(this.onDidChangeActiveWindow, () => this.hasFocus, disposables),\n\t\t\t)(focus => emitter.fire(focus), undefined, disposables);\n\t\t}, { window: mainWindow, disposables: this._store }));\n\n\t\treturn Event.latch(emitter.event, undefined, this._store);\n\t}\n\n\tget hasFocus(): boolean {\n\t\treturn getActiveDocument().hasFocus();\n\t}\n\n\tasync hadLastFocus(): Promise<boolean> {\n\t\treturn true;\n\t}\n\n\tasync focus(targetWindow: Window): Promise<void> {\n\t\ttargetWindow.focus();\n\t}\n\n\t//#endregion\n\n\n\t//#region Window\n\n\t@memoize\n\tget onDidChangeActiveWindow(): Event<number> {\n\t\tconst emitter = this._register(new Emitter<number>());\n\n\t\tthis._register(Event.runAndSubscribe(onDidRegisterWindow, ({ window, disposables }) => {\n\t\t\tconst windowId = getWindowId(window);\n\n\t\t\t// Emit via focus tracking\n\t\t\tconst focusTracker = disposables.add(trackFocus(window));\n\t\t\tdisposables.add(focusTracker.onDidFocus(() => emitter.fire(windowId)));\n\n\t\t\t// Emit via interval: immediately when opening an auxiliary window,\n\t\t\t// it is possible that document focus has not yet changed, so we\n\t\t\t// poll for a while to ensure we catch the event.\n\t\t\tif (isAuxiliaryWindow(window)) {\n\t\t\t\tdisposables.add(disposableWindowInterval(window, () => {\n\t\t\t\t\tconst hasFocus = window.document.hasFocus();\n\t\t\t\t\tif (hasFocus) {\n\t\t\t\t\t\temitter.fire(windowId);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn hasFocus;\n\t\t\t\t}, 100, 20));\n\t\t\t}\n\t\t}, { window: mainWindow, disposables: this._store }));\n\n\t\treturn Event.latch(emitter.event, undefined, this._store);\n\t}\n\n\t@memoize\n\tget onDidChangeFullScreen(): Event<{ windowId: number; fullscreen: boolean }> {\n\t\tconst emitter = this._register(new Emitter<{ windowId: number; fullscreen: boolean }>());\n\n\t\tthis._register(Event.runAndSubscribe(onDidRegisterWindow, ({ window, disposables }) => {\n\t\t\tconst windowId = getWindowId(window);\n\t\t\tconst viewport = isIOS && window.visualViewport ? window.visualViewport /** Visual viewport */ : window /** Layout viewport */;\n\n\t\t\t// Fullscreen (Browser)\n\t\t\tfor (const event of [EventType.FULLSCREEN_CHANGE, EventType.WK_FULLSCREEN_CHANGE]) {\n\t\t\t\tdisposables.add(addDisposableListener(window.document, event, () => emitter.fire({ windowId, fullscreen: !!detectFullscreen(window) })));\n\t\t\t}\n\n\t\t\t// Fullscreen (Native)\n\t\t\tdisposables.add(addDisposableThrottledListener(viewport, EventType.RESIZE, () => emitter.fire({ windowId, fullscreen: !!detectFullscreen(window) }), undefined, isMacintosh ? 2000 /* adjust for macOS animation */ : 800 /* can be throttled */));\n\t\t}, { window: mainWindow, disposables: this._store }));\n\n\t\treturn emitter.event;\n\t}\n\n\topenWindow(options?: IOpenEmptyWindowOptions): Promise<void>;\n\topenWindow(toOpen: IWindowOpenable[], options?: IOpenWindowOptions): Promise<void>;\n\topenWindow(arg1?: IOpenEmptyWindowOptions | IWindowOpenable[], arg2?: IOpenWindowOptions): Promise<void> {\n\t\tif (Array.isArray(arg1)) {\n\t\t\treturn this.doOpenWindow(arg1, arg2);\n\t\t}\n\n\t\treturn this.doOpenEmptyWindow(arg1);\n\t}\n\n\tprivate async doOpenWindow(toOpen: IWindowOpenable[], options?: IOpenWindowOptions): Promise<void> {\n\t\tconst payload = this.preservePayload(false /* not an empty window */, options);\n\t\tconst fileOpenables: IFileToOpen[] = [];\n\n\t\tconst foldersToAdd: IWorkspaceFolderCreationData[] = [];\n\t\tconst foldersToRemove: URI[] = [];\n\n\t\tfor (const openable of toOpen) {\n\t\t\topenable.label = openable.label || this.getRecentLabel(openable);\n\n\t\t\t// Folder\n\t\t\tif (isFolderToOpen(openable)) {\n\t\t\t\tif (options?.addMode) {\n\t\t\t\t\tfoldersToAdd.push({ uri: openable.folderUri });\n\t\t\t\t} else if (options?.removeMode) {\n\t\t\t\t\tfoldersToRemove.push(openable.folderUri);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doOpen({ folderUri: openable.folderUri }, { reuse: this.shouldReuse(options, false /* no file */), payload });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Workspace\n\t\t\telse if (isWorkspaceToOpen(openable)) {\n\t\t\t\tthis.doOpen({ workspaceUri: openable.workspaceUri }, { reuse: this.shouldReuse(options, false /* no file */), payload });\n\t\t\t}\n\n\t\t\t// File (handled later in bulk)\n\t\t\telse if (isFileToOpen(openable)) {\n\t\t\t\tfileOpenables.push(openable);\n\t\t\t}\n\t\t}\n\n\t\t// Handle Folders to add or remove\n\t\tif (foldersToAdd.length > 0 || foldersToRemove.length > 0) {\n\t\t\tthis.withServices(async accessor => {\n\t\t\t\tconst workspaceEditingService: IWorkspaceEditingService = accessor.get(IWorkspaceEditingService);\n\t\t\t\tif (foldersToAdd.length > 0) {\n\t\t\t\t\tawait workspaceEditingService.addFolders(foldersToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (foldersToRemove.length > 0) {\n\t\t\t\t\tawait workspaceEditingService.removeFolders(foldersToRemove);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Handle Files\n\t\tif (fileOpenables.length > 0) {\n\t\t\tthis.withServices(async accessor => {\n\t\t\t\tconst editorService = accessor.get(IEditorService);\n\n\t\t\t\t// Support mergeMode\n\t\t\t\tif (options?.mergeMode && fileOpenables.length === 4) {\n\t\t\t\t\tconst editors = coalesce(await pathsToEditors(fileOpenables, this.fileService, this.logService));\n\t\t\t\t\tif (editors.length !== 4 || !isResourceEditorInput(editors[0]) || !isResourceEditorInput(editors[1]) || !isResourceEditorInput(editors[2]) || !isResourceEditorInput(editors[3])) {\n\t\t\t\t\t\treturn; // invalid resources\n\t\t\t\t\t}\n\n\t\t\t\t\t// Same Window: open via editor service in current window\n\t\t\t\t\tif (this.shouldReuse(options, true /* file */)) {\n\t\t\t\t\t\teditorService.openEditor({\n\t\t\t\t\t\t\tinput1: { resource: editors[0].resource },\n\t\t\t\t\t\t\tinput2: { resource: editors[1].resource },\n\t\t\t\t\t\t\tbase: { resource: editors[2].resource },\n\t\t\t\t\t\t\tresult: { resource: editors[3].resource },\n\t\t\t\t\t\t\toptions: { pinned: true }\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// New Window: open into empty window\n\t\t\t\t\telse {\n\t\t\t\t\t\tconst environment = new Map<string, string>();\n\t\t\t\t\t\tenvironment.set('mergeFile1', editors[0].resource.toString());\n\t\t\t\t\t\tenvironment.set('mergeFile2', editors[1].resource.toString());\n\t\t\t\t\t\tenvironment.set('mergeFileBase', editors[2].resource.toString());\n\t\t\t\t\t\tenvironment.set('mergeFileResult', editors[3].resource.toString());\n\n\t\t\t\t\t\tthis.doOpen(undefined, { payload: Array.from(environment.entries()) });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Support diffMode\n\t\t\t\telse if (options?.diffMode && fileOpenables.length === 2) {\n\t\t\t\t\tconst editors = coalesce(await pathsToEditors(fileOpenables, this.fileService, this.logService));\n\t\t\t\t\tif (editors.length !== 2 || !isResourceEditorInput(editors[0]) || !isResourceEditorInput(editors[1])) {\n\t\t\t\t\t\treturn; // invalid resources\n\t\t\t\t\t}\n\n\t\t\t\t\t// Same Window: open via editor service in current window\n\t\t\t\t\tif (this.shouldReuse(options, true /* file */)) {\n\t\t\t\t\t\teditorService.openEditor({\n\t\t\t\t\t\t\toriginal: { resource: editors[0].resource },\n\t\t\t\t\t\t\tmodified: { resource: editors[1].resource },\n\t\t\t\t\t\t\toptions: { pinned: true }\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// New Window: open into empty window\n\t\t\t\t\telse {\n\t\t\t\t\t\tconst environment = new Map<string, string>();\n\t\t\t\t\t\tenvironment.set('diffFileSecondary', editors[0].resource.toString());\n\t\t\t\t\t\tenvironment.set('diffFilePrimary', editors[1].resource.toString());\n\n\t\t\t\t\t\tthis.doOpen(undefined, { payload: Array.from(environment.entries()) });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Just open normally\n\t\t\t\telse {\n\t\t\t\t\tfor (const openable of fileOpenables) {\n\n\t\t\t\t\t\t// Same Window: open via editor service in current window\n\t\t\t\t\t\tif (this.shouldReuse(options, true /* file */)) {\n\t\t\t\t\t\t\tlet openables: IPathData<ITextEditorOptions>[] = [];\n\n\t\t\t\t\t\t\t// Support: --goto parameter to open on line/col\n\t\t\t\t\t\t\tif (options?.gotoLineMode) {\n\t\t\t\t\t\t\t\tconst pathColumnAware = parseLineAndColumnAware(openable.fileUri.path);\n\t\t\t\t\t\t\t\topenables = [{\n\t\t\t\t\t\t\t\t\tfileUri: openable.fileUri.with({ path: pathColumnAware.path }),\n\t\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\t\tselection: !isUndefined(pathColumnAware.line) ? { startLineNumber: pathColumnAware.line, startColumn: pathColumnAware.column || 1 } : undefined\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\topenables = [openable];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\teditorService.openEditors(coalesce(await pathsToEditors(openables, this.fileService, this.logService)), undefined, { validateTrust: true });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// New Window: open into empty window\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst environment = new Map<string, string>();\n\t\t\t\t\t\t\tenvironment.set('openFile', openable.fileUri.toString());\n\n\t\t\t\t\t\t\tif (options?.gotoLineMode) {\n\t\t\t\t\t\t\t\tenvironment.set('gotoLineMode', 'true');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.doOpen(undefined, { payload: Array.from(environment.entries()) });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Support wait mode\n\t\t\t\tconst waitMarkerFileURI = options?.waitMarkerFileURI;\n\t\t\t\tif (waitMarkerFileURI) {\n\t\t\t\t\t(async () => {\n\n\t\t\t\t\t\t// Wait for the resources to be closed in the text editor...\n\t\t\t\t\t\tconst filesToWaitFor: URI[] = [];\n\t\t\t\t\t\tif (options.mergeMode) {\n\t\t\t\t\t\t\tfilesToWaitFor.push(fileOpenables[3].fileUri /* [3] is the resulting merge file */);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfilesToWaitFor.push(...fileOpenables.map(fileOpenable => fileOpenable.fileUri));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait this.instantiationService.invokeFunction(accessor => whenEditorClosed(accessor, filesToWaitFor));\n\n\t\t\t\t\t\t// ...before deleting the wait marker file\n\t\t\t\t\t\tawait this.fileService.del(waitMarkerFileURI);\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate withServices(fn: (accessor: ServicesAccessor) => unknown): void {\n\t\t// Host service is used in a lot of contexts and some services\n\t\t// need to be resolved dynamically to avoid cyclic dependencies\n\t\t// (https://github.com/microsoft/vscode/issues/108522)\n\t\tthis.instantiationService.invokeFunction(accessor => fn(accessor));\n\t}\n\n\tprivate preservePayload(isEmptyWindow: boolean, options?: IOpenWindowOptions): Array<unknown> | undefined {\n\n\t\t// Selectively copy payload: for now only extension debugging properties are considered\n\t\tconst newPayload: Array<unknown> = [];\n\t\tif (!isEmptyWindow && this.environmentService.extensionDevelopmentLocationURI) {\n\t\t\tnewPayload.push(['extensionDevelopmentPath', this.environmentService.extensionDevelopmentLocationURI.toString()]);\n\n\t\t\tif (this.environmentService.debugExtensionHost.debugId) {\n\t\t\t\tnewPayload.push(['debugId', this.environmentService.debugExtensionHost.debugId]);\n\t\t\t}\n\n\t\t\tif (this.environmentService.debugExtensionHost.port) {\n\t\t\t\tnewPayload.push(['inspect-brk-extensions', String(this.environmentService.debugExtensionHost.port)]);\n\t\t\t}\n\t\t}\n\n\t\tconst newWindowProfile = options?.forceProfile\n\t\t\t? this.userDataProfilesService.profiles.find(profile => profile.name === options?.forceProfile)\n\t\t\t: undefined;\n\t\tif (newWindowProfile && !newWindowProfile.isDefault) {\n\t\t\tnewPayload.push(['profile', newWindowProfile.name]);\n\t\t}\n\n\t\treturn newPayload.length ? newPayload : undefined;\n\t}\n\n\tprivate getRecentLabel(openable: IWindowOpenable): string {\n\t\tif (isFolderToOpen(openable)) {\n\t\t\treturn this.labelService.getWorkspaceLabel(openable.folderUri, { verbose: Verbosity.LONG });\n\t\t}\n\n\t\tif (isWorkspaceToOpen(openable)) {\n\t\t\treturn this.labelService.getWorkspaceLabel(getWorkspaceIdentifier(openable.workspaceUri), { verbose: Verbosity.LONG });\n\t\t}\n\n\t\treturn this.labelService.getUriLabel(openable.fileUri, { appendWorkspaceSuffix: true });\n\t}\n\n\tprivate shouldReuse(options: IOpenWindowOptions = Object.create(null), isFile: boolean): boolean {\n\t\tif (options.waitMarkerFileURI) {\n\t\t\treturn true; // always handle --wait in same window\n\t\t}\n\n\t\tconst windowConfig = this.configurationService.getValue<IWindowSettings | undefined>('window');\n\t\tconst openInNewWindowConfig = isFile ? (windowConfig?.openFilesInNewWindow || 'off' /* default */) : (windowConfig?.openFoldersInNewWindow || 'default' /* default */);\n\n\t\tlet openInNewWindow = (options.preferNewWindow || !!options.forceNewWindow) && !options.forceReuseWindow;\n\t\tif (!options.forceNewWindow && !options.forceReuseWindow && (openInNewWindowConfig === 'on' || openInNewWindowConfig === 'off')) {\n\t\t\topenInNewWindow = (openInNewWindowConfig === 'on');\n\t\t}\n\n\t\treturn !openInNewWindow;\n\t}\n\n\tprivate async doOpenEmptyWindow(options?: IOpenEmptyWindowOptions): Promise<void> {\n\t\treturn this.doOpen(undefined, {\n\t\t\treuse: options?.forceReuseWindow,\n\t\t\tpayload: this.preservePayload(true /* empty window */, options)\n\t\t});\n\t}\n\n\tprivate async doOpen(workspace: IWorkspace, options?: { reuse?: boolean; payload?: object }): Promise<void> {\n\n\t\t// When we are in a temporary workspace and are asked to open a local folder\n\t\t// we swap that folder into the workspace to avoid a window reload. Access\n\t\t// to local resources is only possible without a window reload because it\n\t\t// needs user activation.\n\t\tif (workspace && isFolderToOpen(workspace) && workspace.folderUri.scheme === Schemas.file && isTemporaryWorkspace(this.contextService.getWorkspace())) {\n\t\t\tthis.withServices(async accessor => {\n\t\t\t\tconst workspaceEditingService: IWorkspaceEditingService = accessor.get(IWorkspaceEditingService);\n\n\t\t\t\tawait workspaceEditingService.updateFolders(0, this.contextService.getWorkspace().folders.length, [{ uri: workspace.folderUri }]);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We know that `workspaceProvider.open` will trigger a shutdown\n\t\t// with `options.reuse` so we handle this expected shutdown\n\t\tif (options?.reuse) {\n\t\t\tawait this.handleExpectedShutdown(ShutdownReason.LOAD);\n\t\t}\n\n\t\tconst opened = await this.workspaceProvider.open(workspace, options);\n\t\tif (!opened) {\n\t\t\tawait this.dialogService.prompt({\n\t\t\t\ttype: Severity.Warning,\n\t\t\t\tmessage: workspace ?\n\t\t\t\t\tlocalize('unableToOpenExternalWorkspace', \"The browser blocked opening a new tab or window for '{0}'. Press 'Retry' to try again.\", this.getRecentLabel(workspace)) :\n\t\t\t\t\tlocalize('unableToOpenExternal', \"The browser blocked opening a new tab or window. Press 'Retry' to try again.\"),\n\t\t\t\tcustom: {\n\t\t\t\t\tmarkdownDetails: [{ markdown: new MarkdownString(localize('unableToOpenWindowDetail', \"Please allow pop-ups for this website in your [browser settings]({0}).\", 'https://aka.ms/allow-vscode-popup'), true) }]\n\t\t\t\t},\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize({ key: 'retry', comment: ['&& denotes a mnemonic'] }, \"&&Retry\"),\n\t\t\t\t\t\trun: () => this.workspaceProvider.open(workspace, options)\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcancelButton: true\n\t\t\t});\n\t\t}\n\t}\n\n\tasync toggleFullScreen(targetWindow: Window): Promise<void> {\n\t\tconst target = this.layoutService.getContainer(targetWindow);\n\n\t\t// Chromium\n\t\tif (targetWindow.document.fullscreen !== undefined) {\n\t\t\tif (!targetWindow.document.fullscreen) {\n\t\t\t\ttry {\n\t\t\t\t\treturn await target.requestFullscreen();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.logService.warn('toggleFullScreen(): requestFullscreen failed'); // https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\treturn await targetWindow.document.exitFullscreen();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.logService.warn('toggleFullScreen(): exitFullscreen failed');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Safari and Edge 14 are all using webkit prefix\n\n\t\tinterface WebkitDocument extends Document {\n\t\t\twebkitFullscreenElement: Element | null;\n\t\t\twebkitExitFullscreen(): Promise<void>;\n\t\t\twebkitIsFullScreen: boolean;\n\t\t}\n\n\t\tinterface WebkitHTMLElement extends HTMLElement {\n\t\t\twebkitRequestFullscreen(): Promise<void>;\n\t\t}\n\n\t\tconst webkitDocument = targetWindow.document as WebkitDocument;\n\t\tconst webkitElement = target as WebkitHTMLElement;\n\t\tif (webkitDocument.webkitIsFullScreen !== undefined) {\n\t\t\ttry {\n\t\t\t\tif (!webkitDocument.webkitIsFullScreen) {\n\t\t\t\t\twebkitElement.webkitRequestFullscreen(); // it's async, but doesn't return a real promise\n\t\t\t\t} else {\n\t\t\t\t\twebkitDocument.webkitExitFullscreen(); // it's async, but doesn't return a real promise\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\tthis.logService.warn('toggleFullScreen(): requestFullscreen/exitFullscreen failed');\n\t\t\t}\n\t\t}\n\t}\n\n\tasync moveTop(targetWindow: Window): Promise<void> {\n\t\t// There seems to be no API to bring a window to front in browsers\n\t}\n\n\tasync getCursorScreenPoint(): Promise<undefined> {\n\t\treturn undefined;\n\t}\n\n\tgetWindows(options: { includeAuxiliaryWindows: true }): Promise<Array<IOpenedMainWindow | IOpenedAuxiliaryWindow>>;\n\tgetWindows(options: { includeAuxiliaryWindows: false }): Promise<Array<IOpenedMainWindow>>;\n\tasync getWindows(options: { includeAuxiliaryWindows: boolean }): Promise<Array<IOpenedMainWindow | IOpenedAuxiliaryWindow>> {\n\t\tconst activeWindow = getActiveWindow();\n\t\tconst activeWindowId = getWindowId(activeWindow);\n\n\t\t// Main window\n\t\tconst result: Array<IOpenedMainWindow | IOpenedAuxiliaryWindow> = [{\n\t\t\tid: activeWindowId,\n\t\t\ttitle: activeWindow.document.title,\n\t\t\tworkspace: toWorkspaceIdentifier(this.contextService.getWorkspace()),\n\t\t\tdirty: false\n\t\t}];\n\n\t\t// Auxiliary windows\n\t\tif (options.includeAuxiliaryWindows) {\n\t\t\tfor (const { window } of getDOMWindows()) {\n\t\t\t\tconst windowId = getWindowId(window);\n\t\t\t\tif (windowId !== activeWindowId && isAuxiliaryWindow(window)) {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tid: windowId,\n\t\t\t\t\t\ttitle: window.document.title,\n\t\t\t\t\t\tparentId: activeWindowId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t//#endregion\n\n\t//#region Lifecycle\n\n\tasync restart(): Promise<void> {\n\t\tthis.reload();\n\t}\n\n\tasync reload(): Promise<void> {\n\t\tawait this.handleExpectedShutdown(ShutdownReason.RELOAD);\n\n\t\tmainWindow.location.reload();\n\t}\n\n\tasync close(): Promise<void> {\n\t\tawait this.handleExpectedShutdown(ShutdownReason.CLOSE);\n\n\t\tmainWindow.close();\n\t}\n\n\tasync withExpectedShutdown<T>(expectedShutdownTask: () => Promise<T>): Promise<T> {\n\t\tconst previousShutdownReason = this.shutdownReason;\n\t\ttry {\n\t\t\tthis.shutdownReason = HostShutdownReason.Api;\n\t\t\treturn await expectedShutdownTask();\n\t\t} finally {\n\t\t\tthis.shutdownReason = previousShutdownReason;\n\t\t}\n\t}\n\n\tprivate async handleExpectedShutdown(reason: ShutdownReason): Promise<void> {\n\n\t\t// Update shutdown reason in a way that we do\n\t\t// not show a dialog because this is a expected\n\t\t// shutdown.\n\t\tthis.shutdownReason = HostShutdownReason.Api;\n\n\t\t// Signal shutdown reason to lifecycle\n\t\treturn this.lifecycleService.withExpectedShutdown(reason);\n\t}\n\n\t//#endregion\n\n\t//#region Screenshots\n\n\tasync getScreenshot(): Promise<VSBuffer | undefined> {\n\t\t// Gets a screenshot from the browser. This gets the screenshot via the browser's display\n\t\t// media API which will typically offer a picker of all available screens and windows for\n\t\t// the user to select. Using the video stream provided by the display media API, this will\n\t\t// capture a single frame of the video and convert it to a JPEG image.\n\t\tconst store = new DisposableStore();\n\n\t\t// Create a video element to play the captured screen source\n\t\tconst video = document.createElement('video');\n\t\tstore.add(toDisposable(() => video.remove()));\n\t\tlet stream: MediaStream | undefined;\n\t\ttry {\n\t\t\t// Create a stream from the screen source (capture screen without audio)\n\t\t\tstream = await navigator.mediaDevices.getDisplayMedia({\n\t\t\t\taudio: false,\n\t\t\t\tvideo: true\n\t\t\t});\n\n\t\t\t// Set the stream as the source of the video element\n\t\t\tvideo.srcObject = stream;\n\t\t\tvideo.play();\n\n\t\t\t// Wait for the video to load properly before capturing the screenshot\n\t\t\tawait Promise.all([\n\t\t\t\tnew Promise<void>(r => store.add(addDisposableListener(video, 'loadedmetadata', () => r()))),\n\t\t\t\tnew Promise<void>(r => store.add(addDisposableListener(video, 'canplaythrough', () => r())))\n\t\t\t]);\n\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tcanvas.width = video.videoWidth;\n\t\t\tcanvas.height = video.videoHeight;\n\n\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\tif (!ctx) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\t// Draw the portion of the video (x, y) with the specified width and height\n\t\t\tctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n\t\t\t// Convert the canvas to a Blob (JPEG format), use .95 for quality\n\t\t\tconst blob: Blob | null = await new Promise((resolve) => canvas.toBlob((blob) => resolve(blob), 'image/jpeg', 0.95));\n\t\t\tif (!blob) {\n\t\t\t\tthrow new Error('Failed to create blob from canvas');\n\t\t\t}\n\n\t\t\tconst buf = await blob.bytes();\n\t\t\treturn VSBuffer.wrap(buf);\n\n\t\t} catch (error) {\n\t\t\tconsole.error('Error taking screenshot:', error);\n\t\t\treturn undefined;\n\t\t} finally {\n\t\t\tstore.dispose();\n\t\t\tif (stream) {\n\t\t\t\tfor (const track of stream.getTracks()) {\n\t\t\t\t\ttrack.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tasync getBrowserId(): Promise<string | undefined> {\n\t\treturn undefined;\n\t}\n\n\t//#endregion\n\n\t//#region Native Handle\n\n\tasync getNativeWindowHandle(_windowId: number) {\n\t\treturn undefined;\n\t}\n\n\t//#endregion\n}\n\nregisterSingleton(IHostService, BrowserHostService, InstantiationType.Delayed);\n"]}