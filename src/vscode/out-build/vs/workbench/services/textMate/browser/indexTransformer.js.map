{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/textMate/browser/indexTransformer.ts","vs/workbench/services/textMate/browser/indexTransformer.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAQhG;;EAEE;AACF,MAAM,OAAO,0BAA0B;IAC/B,MAAM,CAAC,QAAQ,CAAC,eAA0B;QAChD,8DAA8D;QAC9D,MAAM,YAAY,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,0BAA0B,CAAC,CAAC,CAAC,CAAC,CAAC;QACjF,OAAO,IAAI,wBAAwB,CAAC,YAAY,CAAC,CAAC;IACnD,CAAC;IAKD,YAA6B,cAAuB;QAAvB,mBAAc,GAAd,cAAc,CAAS;QAH5C,QAAG,GAAG,CAAC,CAAC;QACR,WAAM,GAAG,CAAC,CAAC;IAGnB,CAAC;IAED;;OAEG;IACH,SAAS,CAAC,KAAa;QACtB,IAAI,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC/D,OAAO,UAAU,IAAI,UAAU,CAAC,YAAY,CAAC,YAAY,IAAI,KAAK,EAAE,CAAC;YACpE,IAAI,CAAC,MAAM,IAAI,UAAU,CAAC,cAAc,EAAE,CAAC;YAC3C,IAAI,CAAC,GAAG,EAAE,CAAC;YACX,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC5D,CAAC;QACD,mFAAmF;QAEnF,IAAI,UAAU,IAAI,UAAU,CAAC,YAAY,CAAC,KAAK,IAAI,KAAK,EAAE,CAAC;YAC1D,kCAAkC;YAClC,OAAO,SAAS,CAAC;QAClB,CAAC;QAED,OAAO,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;IAC5B,CAAC;CACD;AAED,MAAM,OAAO,wBAAwB;IACpC,YACkB,YAAiC;QAAjC,iBAAY,GAAZ,YAAY,CAAqB;IAC/C,CAAC;IAEL,SAAS,CAAC,KAAa;QACtB,KAAK,MAAM,WAAW,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YAC7C,MAAM,MAAM,GAAG,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;gBAC1B,OAAO,SAAS,CAAC;YAClB,CAAC;YACD,KAAK,GAAG,MAAM,CAAC;QAChB,CAAC;QACD,OAAO,KAAK,CAAC;IACd,CAAC;CACD","file":"indexTransformer.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AnyEdit } from '../../../../editor/common/core/edits/edit.js';\n\nexport interface IIndexTransformer {\n\ttransform(index: number): number | undefined;\n}\n\n/**\n * Can only be called with increasing values of `index`.\n*/\nexport class MonotonousIndexTransformer implements IIndexTransformer {\n\tpublic static fromMany(transformations: AnyEdit[]): IIndexTransformer {\n\t\t// TODO improve performance by combining transformations first\n\t\tconst transformers = transformations.map(t => new MonotonousIndexTransformer(t));\n\t\treturn new CombinedIndexTransformer(transformers);\n\t}\n\n\tprivate idx = 0;\n\tprivate offset = 0;\n\n\tconstructor(private readonly transformation: AnyEdit) {\n\t}\n\n\t/**\n\t * Precondition: index >= previous-value-of(index).\n\t */\n\ttransform(index: number): number | undefined {\n\t\tlet nextChange = this.transformation.replacements.at(this.idx);\n\t\twhile (nextChange && nextChange.replaceRange.endExclusive <= index) {\n\t\t\tthis.offset += nextChange.getLengthDelta();\n\t\t\tthis.idx++;\n\t\t\tnextChange = this.transformation.replacements.at(this.idx);\n\t\t}\n\t\t// assert nextChange === undefined || index < nextChange.offset + nextChange.length\n\n\t\tif (nextChange && nextChange.replaceRange.start <= index) {\n\t\t\t// Offset is touched by the change\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn index + this.offset;\n\t}\n}\n\nexport class CombinedIndexTransformer implements IIndexTransformer {\n\tconstructor(\n\t\tprivate readonly transformers: IIndexTransformer[]\n\t) { }\n\n\ttransform(index: number): number | undefined {\n\t\tfor (const transformer of this.transformers) {\n\t\t\tconst result = transformer.transform(index);\n\t\t\tif (result === undefined) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tindex = result;\n\t\t}\n\t\treturn index;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AnyEdit } from '../../../../editor/common/core/edits/edit.js';\n\nexport interface IIndexTransformer {\n\ttransform(index: number): number | undefined;\n}\n\n/**\n * Can only be called with increasing values of `index`.\n*/\nexport class MonotonousIndexTransformer implements IIndexTransformer {\n\tpublic static fromMany(transformations: AnyEdit[]): IIndexTransformer {\n\t\t// TODO improve performance by combining transformations first\n\t\tconst transformers = transformations.map(t => new MonotonousIndexTransformer(t));\n\t\treturn new CombinedIndexTransformer(transformers);\n\t}\n\n\tprivate idx = 0;\n\tprivate offset = 0;\n\n\tconstructor(private readonly transformation: AnyEdit) {\n\t}\n\n\t/**\n\t * Precondition: index >= previous-value-of(index).\n\t */\n\ttransform(index: number): number | undefined {\n\t\tlet nextChange = this.transformation.replacements.at(this.idx);\n\t\twhile (nextChange && nextChange.replaceRange.endExclusive <= index) {\n\t\t\tthis.offset += nextChange.getLengthDelta();\n\t\t\tthis.idx++;\n\t\t\tnextChange = this.transformation.replacements.at(this.idx);\n\t\t}\n\t\t// assert nextChange === undefined || index < nextChange.offset + nextChange.length\n\n\t\tif (nextChange && nextChange.replaceRange.start <= index) {\n\t\t\t// Offset is touched by the change\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn index + this.offset;\n\t}\n}\n\nexport class CombinedIndexTransformer implements IIndexTransformer {\n\tconstructor(\n\t\tprivate readonly transformers: IIndexTransformer[]\n\t) { }\n\n\ttransform(index: number): number | undefined {\n\t\tfor (const transformer of this.transformers) {\n\t\t\tconst result = transformer.transform(index);\n\t\t\tif (result === undefined) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tindex = result;\n\t\t}\n\t\treturn index;\n\t}\n}\n"]}