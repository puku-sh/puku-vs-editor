{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/terminal/common/embedderTerminalService.ts","vs/workbench/services/terminal/common/embedderTerminalService.ts"],"names":[],"mappings":"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","file":"embedderTerminalService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IProcessDataEvent, IProcessProperty, IProcessPropertyMap, IProcessReadyEvent, IShellLaunchConfig, ITerminalChildProcess, ITerminalLaunchError, ProcessPropertyType } from '../../../../platform/terminal/common/terminal.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport const IEmbedderTerminalService = createDecorator<IEmbedderTerminalService>('embedderTerminalService');\n\n/**\n * Manages terminals that the embedder can create before the terminal contrib is available.\n */\nexport interface IEmbedderTerminalService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidCreateTerminal: Event<IShellLaunchConfig>;\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void;\n}\n\nexport type EmbedderTerminal = IShellLaunchConfig & Required<Pick<IShellLaunchConfig, 'customPtyImplementation'>>;\n\nexport interface IEmbedderTerminalOptions {\n\tname: string;\n\tpty: IEmbedderTerminalPty;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   iconPath?: URI | { light: URI; dark: URI } | ThemeIcon;\n\t//   color?: ThemeColor;\n\t//   location?: TerminalLocation | TerminalEditorLocationOptions | TerminalSplitLocationOptions;\n\t//   isTransient?: boolean;\n}\n\n/**\n * See Pseudoterminal on the vscode API for usage.\n */\nexport interface IEmbedderTerminalPty {\n\treadonly onDidWrite: Event<string>;\n\treadonly onDidClose?: Event<void | number>;\n\treadonly onDidChangeName?: Event<string>;\n\n\topen(): void;\n\tclose(): void;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   onDidOverrideDimensions?: Event<TerminalDimensions | undefined>;\n\t//   handleInput?(data: string): void;\n\t//   setDimensions?(dimensions: TerminalDimensions): void;\n}\n\nclass EmbedderTerminalService implements IEmbedderTerminalService {\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _onDidCreateTerminal = new Emitter<IShellLaunchConfig>();\n\treadonly onDidCreateTerminal = Event.buffer(this._onDidCreateTerminal.event);\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void {\n\t\tconst slc: EmbedderTerminal = {\n\t\t\tname: options.name,\n\t\t\tisFeatureTerminal: true,\n\t\t\tcustomPtyImplementation(terminalId, cols, rows) {\n\t\t\t\treturn new EmbedderTerminalProcess(terminalId, options.pty);\n\t\t\t},\n\t\t};\n\t\tthis._onDidCreateTerminal.fire(slc);\n\t}\n}\n\n\nclass EmbedderTerminalProcess extends Disposable implements ITerminalChildProcess {\n\tprivate readonly _pty: IEmbedderTerminalPty;\n\n\treadonly shouldPersist = false;\n\n\treadonly onProcessData: Event<IProcessDataEvent | string>;\n\tprivate readonly _onProcessReady = this._register(new Emitter<IProcessReadyEvent>());\n\treadonly onProcessReady = this._onProcessReady.event;\n\tprivate readonly _onDidChangeProperty = this._register(new Emitter<IProcessProperty>());\n\treadonly onDidChangeProperty = this._onDidChangeProperty.event;\n\tprivate readonly _onProcessExit = this._register(new Emitter<number | undefined>());\n\treadonly onProcessExit = this._onProcessExit.event;\n\n\tconstructor(\n\t\treadonly id: number,\n\t\tpty: IEmbedderTerminalPty\n\t) {\n\t\tsuper();\n\n\t\tthis._pty = pty;\n\t\tthis.onProcessData = this._pty.onDidWrite;\n\t\tif (this._pty.onDidClose) {\n\t\t\tthis._register(this._pty.onDidClose(e => this._onProcessExit.fire(e || undefined)));\n\t\t}\n\t\tif (this._pty.onDidChangeName) {\n\t\t\tthis._register(this._pty.onDidChangeName(e => this._onDidChangeProperty.fire({\n\t\t\t\ttype: ProcessPropertyType.Title,\n\t\t\t\tvalue: e\n\t\t\t})));\n\t\t}\n\t}\n\n\tasync start(): Promise<ITerminalLaunchError | undefined> {\n\t\tthis._onProcessReady.fire({ pid: -1, cwd: '', windowsPty: undefined });\n\t\tthis._pty.open();\n\t\treturn undefined;\n\t}\n\tshutdown(): void {\n\t\tthis._pty.close();\n\t}\n\n\t// TODO: A lot of these aren't useful for some implementations of ITerminalChildProcess, should\n\t// they be optional? Should there be a base class for \"external\" consumers to implement?\n\n\tinput(): void {\n\t\t// not supported\n\t}\n\tsendSignal(): void {\n\t\t// not supported\n\t}\n\tasync processBinary(): Promise<void> {\n\t\t// not supported\n\t}\n\tresize(): void {\n\t\t// no-op\n\t}\n\tclearBuffer(): void {\n\t\t// no-op\n\t}\n\tacknowledgeDataEvent(): void {\n\t\t// no-op, flow control not currently implemented\n\t}\n\tasync setUnicodeVersion(): Promise<void> {\n\t\t// no-op\n\t}\n\tasync getInitialCwd(): Promise<string> {\n\t\treturn '';\n\t}\n\tasync getCwd(): Promise<string> {\n\t\treturn '';\n\t}\n\trefreshProperty<T extends ProcessPropertyType>(property: ProcessPropertyType): Promise<IProcessPropertyMap[T]> {\n\t\tthrow new Error(`refreshProperty is not suppported in EmbedderTerminalProcess. property: ${property}`);\n\t}\n\n\tupdateProperty(property: ProcessPropertyType, value: unknown): Promise<void> {\n\t\tthrow new Error(`updateProperty is not suppported in EmbedderTerminalProcess. property: ${property}, value: ${value}`);\n\t}\n}\n\nregisterSingleton(IEmbedderTerminalService, EmbedderTerminalService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { IProcessDataEvent, IProcessProperty, IProcessPropertyMap, IProcessReadyEvent, IShellLaunchConfig, ITerminalChildProcess, ITerminalLaunchError, ProcessPropertyType } from '../../../../platform/terminal/common/terminal.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport const IEmbedderTerminalService = createDecorator<IEmbedderTerminalService>('embedderTerminalService');\n\n/**\n * Manages terminals that the embedder can create before the terminal contrib is available.\n */\nexport interface IEmbedderTerminalService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidCreateTerminal: Event<IShellLaunchConfig>;\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void;\n}\n\nexport type EmbedderTerminal = IShellLaunchConfig & Required<Pick<IShellLaunchConfig, 'customPtyImplementation'>>;\n\nexport interface IEmbedderTerminalOptions {\n\tname: string;\n\tpty: IEmbedderTerminalPty;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   iconPath?: URI | { light: URI; dark: URI } | ThemeIcon;\n\t//   color?: ThemeColor;\n\t//   location?: TerminalLocation | TerminalEditorLocationOptions | TerminalSplitLocationOptions;\n\t//   isTransient?: boolean;\n}\n\n/**\n * See Pseudoterminal on the vscode API for usage.\n */\nexport interface IEmbedderTerminalPty {\n\treadonly onDidWrite: Event<string>;\n\treadonly onDidClose?: Event<void | number>;\n\treadonly onDidChangeName?: Event<string>;\n\n\topen(): void;\n\tclose(): void;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   onDidOverrideDimensions?: Event<TerminalDimensions | undefined>;\n\t//   handleInput?(data: string): void;\n\t//   setDimensions?(dimensions: TerminalDimensions): void;\n}\n\nclass EmbedderTerminalService implements IEmbedderTerminalService {\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _onDidCreateTerminal = new Emitter<IShellLaunchConfig>();\n\treadonly onDidCreateTerminal = Event.buffer(this._onDidCreateTerminal.event);\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void {\n\t\tconst slc: EmbedderTerminal = {\n\t\t\tname: options.name,\n\t\t\tisFeatureTerminal: true,\n\t\t\tcustomPtyImplementation(terminalId, cols, rows) {\n\t\t\t\treturn new EmbedderTerminalProcess(terminalId, options.pty);\n\t\t\t},\n\t\t};\n\t\tthis._onDidCreateTerminal.fire(slc);\n\t}\n}\n\n\nclass EmbedderTerminalProcess extends Disposable implements ITerminalChildProcess {\n\tprivate readonly _pty: IEmbedderTerminalPty;\n\n\treadonly shouldPersist = false;\n\n\treadonly onProcessData: Event<IProcessDataEvent | string>;\n\tprivate readonly _onProcessReady = this._register(new Emitter<IProcessReadyEvent>());\n\treadonly onProcessReady = this._onProcessReady.event;\n\tprivate readonly _onDidChangeProperty = this._register(new Emitter<IProcessProperty>());\n\treadonly onDidChangeProperty = this._onDidChangeProperty.event;\n\tprivate readonly _onProcessExit = this._register(new Emitter<number | undefined>());\n\treadonly onProcessExit = this._onProcessExit.event;\n\n\tconstructor(\n\t\treadonly id: number,\n\t\tpty: IEmbedderTerminalPty\n\t) {\n\t\tsuper();\n\n\t\tthis._pty = pty;\n\t\tthis.onProcessData = this._pty.onDidWrite;\n\t\tif (this._pty.onDidClose) {\n\t\t\tthis._register(this._pty.onDidClose(e => this._onProcessExit.fire(e || undefined)));\n\t\t}\n\t\tif (this._pty.onDidChangeName) {\n\t\t\tthis._register(this._pty.onDidChangeName(e => this._onDidChangeProperty.fire({\n\t\t\t\ttype: ProcessPropertyType.Title,\n\t\t\t\tvalue: e\n\t\t\t})));\n\t\t}\n\t}\n\n\tasync start(): Promise<ITerminalLaunchError | undefined> {\n\t\tthis._onProcessReady.fire({ pid: -1, cwd: '', windowsPty: undefined });\n\t\tthis._pty.open();\n\t\treturn undefined;\n\t}\n\tshutdown(): void {\n\t\tthis._pty.close();\n\t}\n\n\t// TODO: A lot of these aren't useful for some implementations of ITerminalChildProcess, should\n\t// they be optional? Should there be a base class for \"external\" consumers to implement?\n\n\tinput(): void {\n\t\t// not supported\n\t}\n\tsendSignal(): void {\n\t\t// not supported\n\t}\n\tasync processBinary(): Promise<void> {\n\t\t// not supported\n\t}\n\tresize(): void {\n\t\t// no-op\n\t}\n\tclearBuffer(): void {\n\t\t// no-op\n\t}\n\tacknowledgeDataEvent(): void {\n\t\t// no-op, flow control not currently implemented\n\t}\n\tasync setUnicodeVersion(): Promise<void> {\n\t\t// no-op\n\t}\n\tasync getInitialCwd(): Promise<string> {\n\t\treturn '';\n\t}\n\tasync getCwd(): Promise<string> {\n\t\treturn '';\n\t}\n\trefreshProperty<T extends ProcessPropertyType>(property: ProcessPropertyType): Promise<IProcessPropertyMap[T]> {\n\t\tthrow new Error(`refreshProperty is not suppported in EmbedderTerminalProcess. property: ${property}`);\n\t}\n\n\tupdateProperty(property: ProcessPropertyType, value: unknown): Promise<void> {\n\t\tthrow new Error(`updateProperty is not suppported in EmbedderTerminalProcess. property: ${property}, value: ${value}`);\n\t}\n}\n\nregisterSingleton(IEmbedderTerminalService, EmbedderTerminalService, InstantiationType.Delayed);\n"]}