{"version":3,"sources":["vs/workbench/services/request/browser/requestService.ts"],"names":[],"mappings":"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","file":"requestService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IRequestOptions, IRequestContext } from '../../../../base/parts/request/common/request.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RequestChannelClient } from '../../../../platform/request/common/requestIpc.js';\nimport { IRemoteAgentService, IRemoteAgentConnection } from '../../remote/common/remoteAgentService.js';\nimport { ServicesAccessor } from '../../../../editor/browser/editorExtensions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { AbstractRequestService, AuthInfo, Credentials, IRequestService } from '../../../../platform/request/common/request.js';\nimport { request } from '../../../../base/parts/request/common/requestImpl.js';\nimport { ILoggerService } from '../../../../platform/log/common/log.js';\nimport { localize } from '../../../../nls.js';\nimport { LogService } from '../../../../platform/log/common/logService.js';\nimport { windowLogGroup } from '../../log/common/logConstants.js';\n\nexport class BrowserRequestService extends AbstractRequestService implements IRequestService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IRemoteAgentService private readonly remoteAgentService: IRemoteAgentService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ILoggerService loggerService: ILoggerService,\n\t) {\n\t\tconst logger = loggerService.createLogger(`network`, { name: localize('network', \"Network\"), group: windowLogGroup });\n\t\tconst logService = new LogService(logger);\n\t\tsuper(logService);\n\t\tthis._register(logger);\n\t\tthis._register(logService);\n\t}\n\n\tasync request(options: IRequestOptions, token: CancellationToken): Promise<IRequestContext> {\n\t\ttry {\n\t\t\tif (!options.proxyAuthorization) {\n\t\t\t\toptions.proxyAuthorization = this.configurationService.inspect<string>('http.proxyAuthorization').userLocalValue;\n\t\t\t}\n\t\t\tconst context = await this.logAndRequest(options, () => request(options, token, () => navigator.onLine));\n\n\t\t\tconst connection = this.remoteAgentService.getConnection();\n\t\t\tif (connection && context.res.statusCode === 405) {\n\t\t\t\treturn this._makeRemoteRequest(connection, options, token);\n\t\t\t}\n\t\t\treturn context;\n\t\t} catch (error) {\n\t\t\tconst connection = this.remoteAgentService.getConnection();\n\t\t\tif (connection) {\n\t\t\t\treturn this._makeRemoteRequest(connection, options, token);\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync resolveProxy(url: string): Promise<string | undefined> {\n\t\treturn undefined; // not implemented in the web\n\t}\n\n\tasync lookupAuthorization(authInfo: AuthInfo): Promise<Credentials | undefined> {\n\t\treturn undefined; // not implemented in the web\n\t}\n\n\tasync lookupKerberosAuthorization(url: string): Promise<string | undefined> {\n\t\treturn undefined; // not implemented in the web\n\t}\n\n\tasync loadCertificates(): Promise<string[]> {\n\t\treturn []; // not implemented in the web\n\t}\n\n\tprivate _makeRemoteRequest(connection: IRemoteAgentConnection, options: IRequestOptions, token: CancellationToken): Promise<IRequestContext> {\n\t\treturn connection.withChannel('request', channel => new RequestChannelClient(channel).request(options, token));\n\t}\n}\n\n// --- Internal commands to help authentication for extensions\n\nCommandsRegistry.registerCommand('_workbench.fetchJSON', async function (accessor: ServicesAccessor, url: string, method: string) {\n\tconst result = await fetch(url, { method, headers: { Accept: 'application/json' } });\n\n\tif (result.ok) {\n\t\treturn result.json();\n\t} else {\n\t\tthrow new Error(result.statusText);\n\t}\n});\n"]}