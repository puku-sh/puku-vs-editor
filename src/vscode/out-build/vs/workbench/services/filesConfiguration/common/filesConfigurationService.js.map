{"version":3,"sources":["vs/workbench/services/filesConfiguration/common/filesConfigurationService.ts"],"names":[],"mappings":"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","file":"filesConfigurationService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { Disposable, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { RawContextKey, IContextKeyService, IContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IFilesConfiguration, AutoSaveConfiguration, HotExitConfiguration, FILES_READONLY_INCLUDE_CONFIG, FILES_READONLY_EXCLUDE_CONFIG, IFileStatWithMetadata, IFileService, IBaseFileStat, hasReadonlyCapability, IFilesConfigurationNode } from '../../../../platform/files/common/files.js';\nimport { equals } from '../../../../base/common/objects.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { ResourceGlobMatcher } from '../../../common/resources.js';\nimport { GlobalIdleValue } from '../../../../base/common/async.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nimport { LRUCache, ResourceMap } from '../../../../base/common/map.js';\nimport { IMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { EditorResourceAccessor, SaveReason, SideBySideEditor } from '../../../common/editor.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { ITextResourceConfigurationService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { IStringDictionary } from '../../../../base/common/collections.js';\n\nexport const AutoSaveAfterShortDelayContext = new RawContextKey<boolean>('autoSaveAfterShortDelayContext', false, true);\n\nexport interface IAutoSaveConfiguration {\n\tautoSave?: 'afterDelay' | 'onFocusChange' | 'onWindowChange';\n\tautoSaveDelay?: number;\n\tautoSaveWorkspaceFilesOnly?: boolean;\n\tautoSaveWhenNoErrors?: boolean;\n}\n\ninterface ICachedAutoSaveConfiguration extends IAutoSaveConfiguration {\n\n\t// Some extra state that we cache to reduce the amount\n\t// of lookup we have to do since auto save methods\n\t// are being called very often, e.g. when content changes\n\n\tisOutOfWorkspace?: boolean;\n\tisShortAutoSaveDelay?: boolean;\n}\n\nexport const enum AutoSaveMode {\n\tOFF,\n\tAFTER_SHORT_DELAY,\n\tAFTER_LONG_DELAY,\n\tON_FOCUS_CHANGE,\n\tON_WINDOW_CHANGE\n}\n\nexport const enum AutoSaveDisabledReason {\n\tSETTINGS = 1,\n\tOUT_OF_WORKSPACE,\n\tERRORS,\n\tDISABLED\n}\n\nexport type IAutoSaveMode = IEnabledAutoSaveMode | IDisabledAutoSaveMode;\n\nexport interface IEnabledAutoSaveMode {\n\treadonly mode: AutoSaveMode.AFTER_SHORT_DELAY | AutoSaveMode.AFTER_LONG_DELAY | AutoSaveMode.ON_FOCUS_CHANGE | AutoSaveMode.ON_WINDOW_CHANGE;\n}\n\nexport interface IDisabledAutoSaveMode {\n\treadonly mode: AutoSaveMode.OFF;\n\treadonly reason: AutoSaveDisabledReason;\n}\n\nexport const IFilesConfigurationService = createDecorator<IFilesConfigurationService>('filesConfigurationService');\n\nexport interface IFilesConfigurationService {\n\n\treadonly _serviceBrand: undefined;\n\n\t//#region Auto Save\n\n\treadonly onDidChangeAutoSaveConfiguration: Event<void>;\n\n\treadonly onDidChangeAutoSaveDisabled: Event<URI>;\n\n\tgetAutoSaveConfiguration(resourceOrEditor: EditorInput | URI | undefined): IAutoSaveConfiguration;\n\n\thasShortAutoSaveDelay(resourceOrEditor: EditorInput | URI | undefined): boolean;\n\n\tgetAutoSaveMode(resourceOrEditor: EditorInput | URI | undefined, saveReason?: SaveReason): IAutoSaveMode;\n\n\ttoggleAutoSave(): Promise<void>;\n\n\tenableAutoSaveAfterShortDelay(resourceOrEditor: EditorInput | URI): IDisposable;\n\tdisableAutoSave(resourceOrEditor: EditorInput | URI): IDisposable;\n\n\t//#endregion\n\n\t//#region Configured Readonly\n\n\treadonly onDidChangeReadonly: Event<void>;\n\n\tisReadonly(resource: URI, stat?: IBaseFileStat): boolean | IMarkdownString;\n\n\tupdateReadonly(resource: URI, readonly: true | false | 'toggle' | 'reset'): Promise<void>;\n\n\t//#endregion\n\n\treadonly onDidChangeFilesAssociation: Event<void>;\n\n\treadonly isHotExitEnabled: boolean;\n\n\treadonly hotExitConfiguration: string | undefined;\n\n\tpreventSaveConflicts(resource: URI, language?: string): boolean;\n}\n\nexport class FilesConfigurationService extends Disposable implements IFilesConfigurationService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static readonly DEFAULT_AUTO_SAVE_MODE = isWeb ? AutoSaveConfiguration.AFTER_DELAY : AutoSaveConfiguration.OFF;\n\tprivate static readonly DEFAULT_AUTO_SAVE_DELAY = 1000;\n\n\tprivate static readonly READONLY_MESSAGES = {\n\t\tproviderReadonly: { value: localize('providerReadonly', \"Editor is read-only because the file system of the file is read-only.\"), isTrusted: true },\n\t\tsessionReadonly: { value: localize({ key: 'sessionReadonly', comment: ['Please do not translate the word \"command\", it is part of our internal syntax which must not change', '{Locked=\"](command:{0})\"}'] }, \"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.\", 'workbench.action.files.setActiveEditorWriteableInSession'), isTrusted: true },\n\t\tconfiguredReadonly: { value: localize({ key: 'configuredReadonly', comment: ['Please do not translate the word \"command\", it is part of our internal syntax which must not change', '{Locked=\"](command:{0})\"}'] }, \"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).\", `workbench.action.openSettings?${encodeURIComponent('[\"files.readonly\"]')}`, 'workbench.action.files.toggleActiveEditorReadonlyInSession'), isTrusted: true },\n\t\tfileLocked: { value: localize({ key: 'fileLocked', comment: ['Please do not translate the word \"command\", it is part of our internal syntax which must not change', '{Locked=\"](command:{0})\"}'] }, \"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.\", 'workbench.action.files.setActiveEditorWriteableInSession'), isTrusted: true },\n\t\tfileReadonly: { value: localize('fileReadonly', \"Editor is read-only because the file is read-only.\"), isTrusted: true }\n\t};\n\n\tprivate readonly _onDidChangeAutoSaveConfiguration = this._register(new Emitter<void>());\n\treadonly onDidChangeAutoSaveConfiguration = this._onDidChangeAutoSaveConfiguration.event;\n\n\tprivate readonly _onDidChangeAutoSaveDisabled = this._register(new Emitter<URI>());\n\treadonly onDidChangeAutoSaveDisabled = this._onDidChangeAutoSaveDisabled.event;\n\n\tprivate readonly _onDidChangeFilesAssociation = this._register(new Emitter<void>());\n\treadonly onDidChangeFilesAssociation = this._onDidChangeFilesAssociation.event;\n\n\tprivate readonly _onDidChangeReadonly = this._register(new Emitter<void>());\n\treadonly onDidChangeReadonly = this._onDidChangeReadonly.event;\n\n\tprivate currentGlobalAutoSaveConfiguration: IAutoSaveConfiguration;\n\tprivate currentFilesAssociationConfiguration: IStringDictionary<string> | undefined;\n\tprivate currentHotExitConfiguration: string;\n\n\tprivate readonly autoSaveConfigurationCache = new LRUCache<URI, ICachedAutoSaveConfiguration>(1000);\n\n\tprivate readonly autoSaveAfterShortDelayOverrides = new ResourceMap<number /* counter */>();\n\tprivate readonly autoSaveDisabledOverrides = new ResourceMap<number /* counter */>();\n\n\tprivate readonly autoSaveAfterShortDelayContext: IContextKey<boolean>;\n\n\tprivate readonly readonlyIncludeMatcher = this._register(new GlobalIdleValue(() => this.createReadonlyMatcher(FILES_READONLY_INCLUDE_CONFIG)));\n\tprivate readonly readonlyExcludeMatcher = this._register(new GlobalIdleValue(() => this.createReadonlyMatcher(FILES_READONLY_EXCLUDE_CONFIG)));\n\tprivate configuredReadonlyFromPermissions: boolean | undefined;\n\n\tprivate readonly sessionReadonlyOverrides = new ResourceMap<boolean>(resource => this.uriIdentityService.extUri.getComparisonKey(resource));\n\n\tconstructor(\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IMarkerService private readonly markerService: IMarkerService,\n\t\t@ITextResourceConfigurationService private readonly textResourceConfigurationService: ITextResourceConfigurationService\n\t) {\n\t\tsuper();\n\n\t\tthis.autoSaveAfterShortDelayContext = AutoSaveAfterShortDelayContext.bindTo(contextKeyService);\n\n\t\tconst configuration = configurationService.getValue<IFilesConfiguration>();\n\n\t\tthis.currentGlobalAutoSaveConfiguration = this.computeAutoSaveConfiguration(undefined, configuration.files);\n\t\tthis.currentFilesAssociationConfiguration = configuration?.files?.associations;\n\t\tthis.currentHotExitConfiguration = configuration?.files?.hotExit || HotExitConfiguration.ON_EXIT;\n\n\t\tthis.onFilesConfigurationChange(configuration, false);\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate createReadonlyMatcher(config: string) {\n\t\tconst matcher = this._register(new ResourceGlobMatcher(\n\t\t\tresource => this.configurationService.getValue(config, { resource }),\n\t\t\tevent => event.affectsConfiguration(config),\n\t\t\tthis.contextService,\n\t\t\tthis.configurationService\n\t\t));\n\n\t\tthis._register(matcher.onExpressionChange(() => this._onDidChangeReadonly.fire()));\n\n\t\treturn matcher;\n\t}\n\n\tisReadonly(resource: URI, stat?: IBaseFileStat): boolean | IMarkdownString {\n\n\t\t// if the entire file system provider is readonly, we respect that\n\t\t// and do not allow to change readonly. we take this as a hint that\n\t\t// the provider has no capabilities of writing.\n\t\tconst provider = this.fileService.getProvider(resource.scheme);\n\t\tif (provider && hasReadonlyCapability(provider)) {\n\t\t\treturn provider.readOnlyMessage ?? FilesConfigurationService.READONLY_MESSAGES.providerReadonly;\n\t\t}\n\n\t\t// session override always wins over the others\n\t\tconst sessionReadonlyOverride = this.sessionReadonlyOverrides.get(resource);\n\t\tif (typeof sessionReadonlyOverride === 'boolean') {\n\t\t\treturn sessionReadonlyOverride === true ? FilesConfigurationService.READONLY_MESSAGES.sessionReadonly : false;\n\t\t}\n\n\t\tif (\n\t\t\tthis.uriIdentityService.extUri.isEqualOrParent(resource, this.environmentService.userRoamingDataHome) ||\n\t\t\tthis.uriIdentityService.extUri.isEqual(resource, this.contextService.getWorkspace().configuration ?? undefined)\n\t\t) {\n\t\t\treturn false; // explicitly exclude some paths from readonly that we need for configuration\n\t\t}\n\n\t\t// configured glob patterns win over stat information\n\t\tif (this.readonlyIncludeMatcher.value.matches(resource)) {\n\t\t\treturn !this.readonlyExcludeMatcher.value.matches(resource) ? FilesConfigurationService.READONLY_MESSAGES.configuredReadonly : false;\n\t\t}\n\n\t\t// check if file is locked and configured to treat as readonly\n\t\tif (this.configuredReadonlyFromPermissions && stat?.locked) {\n\t\t\treturn FilesConfigurationService.READONLY_MESSAGES.fileLocked;\n\t\t}\n\n\t\t// check if file is marked readonly from the file system provider\n\t\tif (stat?.readonly) {\n\t\t\treturn FilesConfigurationService.READONLY_MESSAGES.fileReadonly;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tasync updateReadonly(resource: URI, readonly: true | false | 'toggle' | 'reset'): Promise<void> {\n\t\tif (readonly === 'toggle') {\n\t\t\tlet stat: IFileStatWithMetadata | undefined = undefined;\n\t\t\ttry {\n\t\t\t\tstat = await this.fileService.resolve(resource, { resolveMetadata: true });\n\t\t\t} catch (error) {\n\t\t\t\t// ignore\n\t\t\t}\n\n\t\t\treadonly = !this.isReadonly(resource, stat);\n\t\t}\n\n\t\tif (readonly === 'reset') {\n\t\t\tthis.sessionReadonlyOverrides.delete(resource);\n\t\t} else {\n\t\t\tthis.sessionReadonlyOverrides.set(resource, readonly);\n\t\t}\n\n\t\tthis._onDidChangeReadonly.fire();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Files configuration changes\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('files')) {\n\t\t\t\tthis.onFilesConfigurationChange(this.configurationService.getValue<IFilesConfiguration>(), true);\n\t\t\t}\n\t\t}));\n\t}\n\n\tprotected onFilesConfigurationChange(configuration: IFilesConfiguration, fromEvent: boolean): void {\n\n\t\t// Auto Save\n\t\tthis.currentGlobalAutoSaveConfiguration = this.computeAutoSaveConfiguration(undefined, configuration.files);\n\t\tthis.autoSaveConfigurationCache.clear();\n\t\tthis.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(undefined).mode === AutoSaveMode.AFTER_SHORT_DELAY);\n\t\tif (fromEvent) {\n\t\t\tthis._onDidChangeAutoSaveConfiguration.fire();\n\t\t}\n\n\t\t// Check for change in files associations\n\t\tconst filesAssociation = configuration?.files?.associations;\n\t\tif (!equals(this.currentFilesAssociationConfiguration, filesAssociation)) {\n\t\t\tthis.currentFilesAssociationConfiguration = filesAssociation;\n\t\t\tif (fromEvent) {\n\t\t\t\tthis._onDidChangeFilesAssociation.fire();\n\t\t\t}\n\t\t}\n\n\t\t// Hot exit\n\t\tconst hotExitMode = configuration?.files?.hotExit;\n\t\tif (hotExitMode === HotExitConfiguration.OFF || hotExitMode === HotExitConfiguration.ON_EXIT_AND_WINDOW_CLOSE) {\n\t\t\tthis.currentHotExitConfiguration = hotExitMode;\n\t\t} else {\n\t\t\tthis.currentHotExitConfiguration = HotExitConfiguration.ON_EXIT;\n\t\t}\n\n\t\t// Readonly\n\t\tconst readonlyFromPermissions = Boolean(configuration?.files?.readonlyFromPermissions);\n\t\tif (readonlyFromPermissions !== Boolean(this.configuredReadonlyFromPermissions)) {\n\t\t\tthis.configuredReadonlyFromPermissions = readonlyFromPermissions;\n\t\t\tif (fromEvent) {\n\t\t\t\tthis._onDidChangeReadonly.fire();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAutoSaveConfiguration(resourceOrEditor: EditorInput | URI | undefined): ICachedAutoSaveConfiguration {\n\t\tconst resource = this.toResource(resourceOrEditor);\n\t\tif (resource) {\n\t\t\tlet resourceAutoSaveConfiguration = this.autoSaveConfigurationCache.get(resource);\n\t\t\tif (!resourceAutoSaveConfiguration) {\n\t\t\t\tresourceAutoSaveConfiguration = this.computeAutoSaveConfiguration(resource, this.textResourceConfigurationService.getValue<IFilesConfigurationNode>(resource, 'files'));\n\t\t\t\tthis.autoSaveConfigurationCache.set(resource, resourceAutoSaveConfiguration);\n\t\t\t}\n\n\t\t\treturn resourceAutoSaveConfiguration;\n\t\t}\n\n\t\treturn this.currentGlobalAutoSaveConfiguration;\n\t}\n\n\tprivate computeAutoSaveConfiguration(resource: URI | undefined, filesConfiguration: IFilesConfigurationNode | undefined): ICachedAutoSaveConfiguration {\n\t\tlet autoSave: 'afterDelay' | 'onFocusChange' | 'onWindowChange' | undefined;\n\t\tlet autoSaveDelay: number | undefined;\n\t\tlet autoSaveWorkspaceFilesOnly: boolean | undefined;\n\t\tlet autoSaveWhenNoErrors: boolean | undefined;\n\n\t\tlet isOutOfWorkspace: boolean | undefined;\n\t\tlet isShortAutoSaveDelay: boolean | undefined;\n\n\t\tswitch (filesConfiguration?.autoSave ?? FilesConfigurationService.DEFAULT_AUTO_SAVE_MODE) {\n\t\t\tcase AutoSaveConfiguration.AFTER_DELAY: {\n\t\t\t\tautoSave = 'afterDelay';\n\t\t\t\tautoSaveDelay = typeof filesConfiguration?.autoSaveDelay === 'number' && filesConfiguration.autoSaveDelay >= 0 ? filesConfiguration.autoSaveDelay : FilesConfigurationService.DEFAULT_AUTO_SAVE_DELAY;\n\t\t\t\tisShortAutoSaveDelay = autoSaveDelay <= FilesConfigurationService.DEFAULT_AUTO_SAVE_DELAY;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase AutoSaveConfiguration.ON_FOCUS_CHANGE:\n\t\t\t\tautoSave = 'onFocusChange';\n\t\t\t\tbreak;\n\n\t\t\tcase AutoSaveConfiguration.ON_WINDOW_CHANGE:\n\t\t\t\tautoSave = 'onWindowChange';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (filesConfiguration?.autoSaveWorkspaceFilesOnly === true) {\n\t\t\tautoSaveWorkspaceFilesOnly = true;\n\n\t\t\tif (resource && !this.contextService.isInsideWorkspace(resource)) {\n\t\t\t\tisOutOfWorkspace = true;\n\t\t\t\tisShortAutoSaveDelay = undefined; // out of workspace file are not auto saved with this configuration\n\t\t\t}\n\t\t}\n\n\t\tif (filesConfiguration?.autoSaveWhenNoErrors === true) {\n\t\t\tautoSaveWhenNoErrors = true;\n\t\t\tisShortAutoSaveDelay = undefined; // this configuration disables short auto save delay\n\t\t}\n\n\t\treturn {\n\t\t\tautoSave,\n\t\t\tautoSaveDelay,\n\t\t\tautoSaveWorkspaceFilesOnly,\n\t\t\tautoSaveWhenNoErrors,\n\t\t\tisOutOfWorkspace,\n\t\t\tisShortAutoSaveDelay\n\t\t};\n\t}\n\n\tprivate toResource(resourceOrEditor: EditorInput | URI | undefined): URI | undefined {\n\t\tif (resourceOrEditor instanceof EditorInput) {\n\t\t\treturn EditorResourceAccessor.getOriginalUri(resourceOrEditor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t}\n\n\t\treturn resourceOrEditor;\n\t}\n\n\thasShortAutoSaveDelay(resourceOrEditor: EditorInput | URI | undefined): boolean {\n\t\tconst resource = this.toResource(resourceOrEditor);\n\n\t\tif (resource && this.autoSaveAfterShortDelayOverrides.has(resource)) {\n\t\t\treturn true; // overridden to be enabled after short delay\n\t\t}\n\n\t\tif (this.getAutoSaveConfiguration(resource).isShortAutoSaveDelay) {\n\t\t\treturn !resource || !this.autoSaveDisabledOverrides.has(resource);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetAutoSaveMode(resourceOrEditor: EditorInput | URI | undefined, saveReason?: SaveReason): IAutoSaveMode {\n\t\tconst resource = this.toResource(resourceOrEditor);\n\t\tif (resource && this.autoSaveAfterShortDelayOverrides.has(resource)) {\n\t\t\treturn { mode: AutoSaveMode.AFTER_SHORT_DELAY }; // overridden to be enabled after short delay\n\t\t}\n\n\t\tif (resource && this.autoSaveDisabledOverrides.has(resource)) {\n\t\t\treturn { mode: AutoSaveMode.OFF, reason: AutoSaveDisabledReason.DISABLED };\n\t\t}\n\n\t\tconst autoSaveConfiguration = this.getAutoSaveConfiguration(resource);\n\t\tif (typeof autoSaveConfiguration.autoSave === 'undefined') {\n\t\t\treturn { mode: AutoSaveMode.OFF, reason: AutoSaveDisabledReason.SETTINGS };\n\t\t}\n\n\t\tif (typeof saveReason === 'number') {\n\t\t\tif (\n\t\t\t\t(autoSaveConfiguration.autoSave === 'afterDelay' && saveReason !== SaveReason.AUTO) ||\n\t\t\t\t(autoSaveConfiguration.autoSave === 'onFocusChange' && saveReason !== SaveReason.FOCUS_CHANGE && saveReason !== SaveReason.WINDOW_CHANGE) ||\n\t\t\t\t(autoSaveConfiguration.autoSave === 'onWindowChange' && saveReason !== SaveReason.WINDOW_CHANGE)\n\t\t\t) {\n\t\t\t\treturn { mode: AutoSaveMode.OFF, reason: AutoSaveDisabledReason.SETTINGS };\n\t\t\t}\n\t\t}\n\n\t\tif (resource) {\n\t\t\tif (autoSaveConfiguration.autoSaveWorkspaceFilesOnly && autoSaveConfiguration.isOutOfWorkspace) {\n\t\t\t\treturn { mode: AutoSaveMode.OFF, reason: AutoSaveDisabledReason.OUT_OF_WORKSPACE };\n\t\t\t}\n\n\t\t\tif (autoSaveConfiguration.autoSaveWhenNoErrors && this.markerService.read({ resource, take: 1, severities: MarkerSeverity.Error }).length > 0) {\n\t\t\t\treturn { mode: AutoSaveMode.OFF, reason: AutoSaveDisabledReason.ERRORS };\n\t\t\t}\n\t\t}\n\n\t\tswitch (autoSaveConfiguration.autoSave) {\n\t\t\tcase 'afterDelay':\n\t\t\t\tif (typeof autoSaveConfiguration.autoSaveDelay === 'number' && autoSaveConfiguration.autoSaveDelay <= FilesConfigurationService.DEFAULT_AUTO_SAVE_DELAY) {\n\t\t\t\t\t// Explicitly mark auto save configurations as long running\n\t\t\t\t\t// if they are configured to not run when there are errors.\n\t\t\t\t\t// The rationale here is that errors may come in after auto\n\t\t\t\t\t// save has been scheduled and then further delay the auto\n\t\t\t\t\t// save until resolved.\n\t\t\t\t\treturn { mode: autoSaveConfiguration.autoSaveWhenNoErrors ? AutoSaveMode.AFTER_LONG_DELAY : AutoSaveMode.AFTER_SHORT_DELAY };\n\t\t\t\t}\n\t\t\t\treturn { mode: AutoSaveMode.AFTER_LONG_DELAY };\n\t\t\tcase 'onFocusChange':\n\t\t\t\treturn { mode: AutoSaveMode.ON_FOCUS_CHANGE };\n\t\t\tcase 'onWindowChange':\n\t\t\t\treturn { mode: AutoSaveMode.ON_WINDOW_CHANGE };\n\t\t}\n\t}\n\n\tasync toggleAutoSave(): Promise<void> {\n\t\tconst currentSetting = this.configurationService.getValue('files.autoSave');\n\n\t\tlet newAutoSaveValue: string;\n\t\tif ([AutoSaveConfiguration.AFTER_DELAY, AutoSaveConfiguration.ON_FOCUS_CHANGE, AutoSaveConfiguration.ON_WINDOW_CHANGE].some(setting => setting === currentSetting)) {\n\t\t\tnewAutoSaveValue = AutoSaveConfiguration.OFF;\n\t\t} else {\n\t\t\tnewAutoSaveValue = AutoSaveConfiguration.AFTER_DELAY;\n\t\t}\n\n\t\treturn this.configurationService.updateValue('files.autoSave', newAutoSaveValue);\n\t}\n\n\tenableAutoSaveAfterShortDelay(resourceOrEditor: EditorInput | URI): IDisposable {\n\t\tconst resource = this.toResource(resourceOrEditor);\n\t\tif (!resource) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tconst counter = this.autoSaveAfterShortDelayOverrides.get(resource) ?? 0;\n\t\tthis.autoSaveAfterShortDelayOverrides.set(resource, counter + 1);\n\n\t\treturn toDisposable(() => {\n\t\t\tconst counter = this.autoSaveAfterShortDelayOverrides.get(resource) ?? 0;\n\t\t\tif (counter <= 1) {\n\t\t\t\tthis.autoSaveAfterShortDelayOverrides.delete(resource);\n\t\t\t} else {\n\t\t\t\tthis.autoSaveAfterShortDelayOverrides.set(resource, counter - 1);\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAutoSave(resourceOrEditor: EditorInput | URI): IDisposable {\n\t\tconst resource = this.toResource(resourceOrEditor);\n\t\tif (!resource) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tconst counter = this.autoSaveDisabledOverrides.get(resource) ?? 0;\n\t\tthis.autoSaveDisabledOverrides.set(resource, counter + 1);\n\n\t\tif (counter === 0) {\n\t\t\tthis._onDidChangeAutoSaveDisabled.fire(resource);\n\t\t}\n\n\t\treturn toDisposable(() => {\n\t\t\tconst counter = this.autoSaveDisabledOverrides.get(resource) ?? 0;\n\t\t\tif (counter <= 1) {\n\t\t\t\tthis.autoSaveDisabledOverrides.delete(resource);\n\t\t\t\tthis._onDidChangeAutoSaveDisabled.fire(resource);\n\t\t\t} else {\n\t\t\t\tthis.autoSaveDisabledOverrides.set(resource, counter - 1);\n\t\t\t}\n\t\t});\n\t}\n\n\tget isHotExitEnabled(): boolean {\n\t\tif (this.contextService.getWorkspace().transient) {\n\t\t\t// Transient workspace: hot exit is disabled because\n\t\t\t// transient workspaces are not restored upon restart\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.currentHotExitConfiguration !== HotExitConfiguration.OFF;\n\t}\n\n\tget hotExitConfiguration(): string {\n\t\treturn this.currentHotExitConfiguration;\n\t}\n\n\tpreventSaveConflicts(resource: URI, language?: string): boolean {\n\t\treturn this.configurationService.getValue('files.saveConflictResolution', { resource, overrideIdentifier: language }) !== 'overwriteFileOnDisk';\n\t}\n}\n\nregisterSingleton(IFilesConfigurationService, FilesConfigurationService, InstantiationType.Eager);\n"]}