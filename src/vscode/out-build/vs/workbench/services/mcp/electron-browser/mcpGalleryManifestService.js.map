{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/mcp/electron-browser/mcpGalleryManifestService.ts","vs/workbench/services/mcp/electron-browser/mcpGalleryManifestService.ts"],"names":[],"mappings":"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","file":"mcpGalleryManifestService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IMcpGalleryManifestService, IMcpGalleryManifest, McpGalleryManifestStatus } from '../../../../platform/mcp/common/mcpGalleryManifest.js';\nimport { McpGalleryManifestService as McpGalleryManifestService } from '../../../../platform/mcp/common/mcpGalleryManifestService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ISharedProcessService } from '../../../../platform/ipc/electron-browser/services.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\nimport { IMcpGalleryConfig, mcpGalleryServiceUrlConfig } from '../../../../platform/mcp/common/mcpManagement.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IRequestService } from '../../../../platform/request/common/request.js';\n\nexport class WorkbenchMcpGalleryManifestService extends McpGalleryManifestService implements IMcpGalleryManifestService {\n\n\tprivate mcpGalleryManifest: IMcpGalleryManifest | null = null;\n\n\tprivate _onDidChangeMcpGalleryManifest = this._register(new Emitter<IMcpGalleryManifest | null>());\n\toverride readonly onDidChangeMcpGalleryManifest = this._onDidChangeMcpGalleryManifest.event;\n\n\tprivate currentStatus: McpGalleryManifestStatus = McpGalleryManifestStatus.Unavailable;\n\toverride get mcpGalleryManifestStatus(): McpGalleryManifestStatus { return this.currentStatus; }\n\tprivate _onDidChangeMcpGalleryManifestStatus = this._register(new Emitter<McpGalleryManifestStatus>());\n\toverride readonly onDidChangeMcpGalleryManifestStatus = this._onDidChangeMcpGalleryManifestStatus.event;\n\n\tconstructor(\n\t\t@IProductService productService: IProductService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IRequestService requestService: IRequestService,\n\t\t@ILogService logService: ILogService,\n\t\t@ISharedProcessService sharedProcessService: ISharedProcessService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(productService, requestService, logService);\n\n\t\tconst channels = [sharedProcessService.getChannel('mcpGalleryManifest')];\n\t\tconst remoteConnection = remoteAgentService.getConnection();\n\t\tif (remoteConnection) {\n\t\t\tchannels.push(remoteConnection.getChannel('mcpGalleryManifest'));\n\t\t}\n\t\tthis.getMcpGalleryManifest().then(manifest => {\n\t\t\tchannels.forEach(channel => channel.call('setMcpGalleryManifest', [manifest]));\n\t\t});\n\t}\n\n\tprivate initPromise: Promise<void> | undefined;\n\toverride async getMcpGalleryManifest(): Promise<IMcpGalleryManifest | null> {\n\t\tif (!this.initPromise) {\n\t\t\tthis.initPromise = this.doGetMcpGalleryManifest();\n\t\t}\n\t\tawait this.initPromise;\n\t\treturn this.mcpGalleryManifest;\n\t}\n\n\tprivate async doGetMcpGalleryManifest(): Promise<void> {\n\t\tawait this.getAndUpdateMcpGalleryManifest();\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(mcpGalleryServiceUrlConfig) || e.affectsConfiguration('chat.mcp.gallery.version')) {\n\t\t\t\tthis.getAndUpdateMcpGalleryManifest();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate async getAndUpdateMcpGalleryManifest(): Promise<void> {\n\t\tconst mcpGalleryConfig = this.configurationService.getValue<IMcpGalleryConfig | undefined>('chat.mcp.gallery');\n\t\tif (mcpGalleryConfig?.serviceUrl) {\n\t\t\tthis.update(await this.createMcpGalleryManifest(mcpGalleryConfig.serviceUrl, mcpGalleryConfig.version));\n\t\t} else {\n\t\t\tthis.update(await super.getMcpGalleryManifest());\n\t\t}\n\t}\n\n\tprivate update(manifest: IMcpGalleryManifest | null): void {\n\t\tif (this.mcpGalleryManifest?.url === manifest?.url && this.mcpGalleryManifest?.version === manifest?.version) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mcpGalleryManifest = manifest;\n\t\tif (this.mcpGalleryManifest) {\n\t\t\tthis.logService.info('MCP Registry configured:', this.mcpGalleryManifest.url);\n\t\t} else {\n\t\t\tthis.logService.info('No MCP Registry configured');\n\t\t}\n\t\tthis.currentStatus = this.mcpGalleryManifest ? McpGalleryManifestStatus.Available : McpGalleryManifestStatus.Unavailable;\n\t\tthis._onDidChangeMcpGalleryManifest.fire(this.mcpGalleryManifest);\n\t\tthis._onDidChangeMcpGalleryManifestStatus.fire(this.currentStatus);\n\t}\n\n}\n\nregisterSingleton(IMcpGalleryManifestService, WorkbenchMcpGalleryManifestService, InstantiationType.Eager);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IMcpGalleryManifestService, IMcpGalleryManifest, McpGalleryManifestStatus } from '../../../../platform/mcp/common/mcpGalleryManifest.js';\nimport { McpGalleryManifestService as McpGalleryManifestService } from '../../../../platform/mcp/common/mcpGalleryManifestService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ISharedProcessService } from '../../../../platform/ipc/electron-browser/services.js';\nimport { IProductService } from '../../../../platform/product/common/productService.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\nimport { IMcpGalleryConfig, mcpGalleryServiceUrlConfig } from '../../../../platform/mcp/common/mcpManagement.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IRequestService } from '../../../../platform/request/common/request.js';\n\nexport class WorkbenchMcpGalleryManifestService extends McpGalleryManifestService implements IMcpGalleryManifestService {\n\n\tprivate mcpGalleryManifest: IMcpGalleryManifest | null = null;\n\n\tprivate _onDidChangeMcpGalleryManifest = this._register(new Emitter<IMcpGalleryManifest | null>());\n\toverride readonly onDidChangeMcpGalleryManifest = this._onDidChangeMcpGalleryManifest.event;\n\n\tprivate currentStatus: McpGalleryManifestStatus = McpGalleryManifestStatus.Unavailable;\n\toverride get mcpGalleryManifestStatus(): McpGalleryManifestStatus { return this.currentStatus; }\n\tprivate _onDidChangeMcpGalleryManifestStatus = this._register(new Emitter<McpGalleryManifestStatus>());\n\toverride readonly onDidChangeMcpGalleryManifestStatus = this._onDidChangeMcpGalleryManifestStatus.event;\n\n\tconstructor(\n\t\t@IProductService productService: IProductService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IRequestService requestService: IRequestService,\n\t\t@ILogService logService: ILogService,\n\t\t@ISharedProcessService sharedProcessService: ISharedProcessService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(productService, requestService, logService);\n\n\t\tconst channels = [sharedProcessService.getChannel('mcpGalleryManifest')];\n\t\tconst remoteConnection = remoteAgentService.getConnection();\n\t\tif (remoteConnection) {\n\t\t\tchannels.push(remoteConnection.getChannel('mcpGalleryManifest'));\n\t\t}\n\t\tthis.getMcpGalleryManifest().then(manifest => {\n\t\t\tchannels.forEach(channel => channel.call('setMcpGalleryManifest', [manifest]));\n\t\t});\n\t}\n\n\tprivate initPromise: Promise<void> | undefined;\n\toverride async getMcpGalleryManifest(): Promise<IMcpGalleryManifest | null> {\n\t\tif (!this.initPromise) {\n\t\t\tthis.initPromise = this.doGetMcpGalleryManifest();\n\t\t}\n\t\tawait this.initPromise;\n\t\treturn this.mcpGalleryManifest;\n\t}\n\n\tprivate async doGetMcpGalleryManifest(): Promise<void> {\n\t\tawait this.getAndUpdateMcpGalleryManifest();\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(mcpGalleryServiceUrlConfig) || e.affectsConfiguration('chat.mcp.gallery.version')) {\n\t\t\t\tthis.getAndUpdateMcpGalleryManifest();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate async getAndUpdateMcpGalleryManifest(): Promise<void> {\n\t\tconst mcpGalleryConfig = this.configurationService.getValue<IMcpGalleryConfig | undefined>('chat.mcp.gallery');\n\t\tif (mcpGalleryConfig?.serviceUrl) {\n\t\t\tthis.update(await this.createMcpGalleryManifest(mcpGalleryConfig.serviceUrl, mcpGalleryConfig.version));\n\t\t} else {\n\t\t\tthis.update(await super.getMcpGalleryManifest());\n\t\t}\n\t}\n\n\tprivate update(manifest: IMcpGalleryManifest | null): void {\n\t\tif (this.mcpGalleryManifest?.url === manifest?.url && this.mcpGalleryManifest?.version === manifest?.version) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mcpGalleryManifest = manifest;\n\t\tif (this.mcpGalleryManifest) {\n\t\t\tthis.logService.info('MCP Registry configured:', this.mcpGalleryManifest.url);\n\t\t} else {\n\t\t\tthis.logService.info('No MCP Registry configured');\n\t\t}\n\t\tthis.currentStatus = this.mcpGalleryManifest ? McpGalleryManifestStatus.Available : McpGalleryManifestStatus.Unavailable;\n\t\tthis._onDidChangeMcpGalleryManifest.fire(this.mcpGalleryManifest);\n\t\tthis._onDidChangeMcpGalleryManifestStatus.fire(this.currentStatus);\n\t}\n\n}\n\nregisterSingleton(IMcpGalleryManifestService, WorkbenchMcpGalleryManifestService, InstantiationType.Eager);\n"]}