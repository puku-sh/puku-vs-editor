{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/remote/common/remoteFileSystemProviderClient.ts","vs/workbench/services/remote/common/remoteFileSystemProviderClient.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,eAAe,EAAE,MAAM,mCAAmC,CAAC;AACpE,OAAO,EAAE,UAAU,EAAE,eAAe,EAAe,MAAM,sCAAsC,CAAC;AAChG,OAAO,EAAE,OAAO,EAAE,MAAM,oCAAoC,CAAC;AAG7D,OAAO,EAAE,4BAA4B,EAAE,MAAM,mEAAmE,CAAC;AAKjH,MAAM,CAAC,MAAM,+BAA+B,GAAG,kBAAkB,CAAC;AAElE,MAAM,OAAO,8BAA+B,SAAQ,4BAA4B;IAE/E,MAAM,CAAC,QAAQ,CAAC,kBAAuC,EAAE,WAAyB,EAAE,UAAuB;QAC1G,MAAM,UAAU,GAAG,kBAAkB,CAAC,aAAa,EAAE,CAAC;QACtD,IAAI,CAAC,UAAU,EAAE,CAAC;YACjB,OAAO,UAAU,CAAC,IAAI,CAAC;QACxB,CAAC;QAED,MAAM,WAAW,GAAG,IAAI,eAAe,EAAE,CAAC;QAE1C,MAAM,kBAAkB,GAAG,CAAC,KAAK,IAAI,EAAE;YACtC,IAAI,CAAC;gBACJ,MAAM,WAAW,GAAG,MAAM,kBAAkB,CAAC,iBAAiB,EAAE,CAAC;gBACjE,IAAI,WAAW,EAAE,CAAC;oBACjB,0DAA0D;oBAC1D,sDAAsD;oBACtD,uCAAuC;oBACvC,WAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,YAAY,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,8BAA8B,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;gBAClI,CAAC;qBAAM,CAAC;oBACP,UAAU,CAAC,KAAK,CAAC,+EAA+E,CAAC,CAAC;gBACnG,CAAC;YACF,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBAChB,UAAU,CAAC,KAAK,CAAC,sFAAsF,EAAE,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC;YAClI,CAAC;QACF,CAAC,CAAC,EAAE,CAAC;QAEL,WAAW,CAAC,GAAG,CAAC,WAAW,CAAC,gCAAgC,CAAC,CAAC,CAAC,EAAE;YAChE,IAAI,CAAC,CAAC,MAAM,KAAK,OAAO,CAAC,YAAY,EAAE,CAAC;gBACvC,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC5B,CAAC;QACF,CAAC,CAAC,CAAC,CAAC;QAEJ,OAAO,WAAW,CAAC;IACpB,CAAC;IAED,YAAoB,sBAA+C,EAAE,UAAkC;QACtG,KAAK,CAAC,UAAU,CAAC,UAAU,CAAC,+BAA+B,CAAC,EAAE,EAAE,iBAAiB,EAAE,sBAAsB,CAAC,EAAE,kCAA0B,EAAE,CAAC,CAAC;IAC3I,CAAC;CACD","file":"remoteFileSystemProviderClient.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getErrorMessage } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { OperatingSystem } from '../../../../base/common/platform.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { DiskFileSystemProviderClient } from '../../../../platform/files/common/diskFileSystemProviderClient.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IRemoteAgentEnvironment } from '../../../../platform/remote/common/remoteAgentEnvironment.js';\nimport { IRemoteAgentConnection, IRemoteAgentService } from './remoteAgentService.js';\n\nexport const REMOTE_FILE_SYSTEM_CHANNEL_NAME = 'remoteFilesystem';\n\nexport class RemoteFileSystemProviderClient extends DiskFileSystemProviderClient {\n\n\tstatic register(remoteAgentService: IRemoteAgentService, fileService: IFileService, logService: ILogService): IDisposable {\n\t\tconst connection = remoteAgentService.getConnection();\n\t\tif (!connection) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\n\t\tconst environmentPromise = (async () => {\n\t\t\ttry {\n\t\t\t\tconst environment = await remoteAgentService.getRawEnvironment();\n\t\t\t\tif (environment) {\n\t\t\t\t\t// Register remote fsp even before it is asked to activate\n\t\t\t\t\t// because, some features (configuration) wait for its\n\t\t\t\t\t// registration before making fs calls.\n\t\t\t\t\tfileService.registerProvider(Schemas.vscodeRemote, disposables.add(new RemoteFileSystemProviderClient(environment, connection)));\n\t\t\t\t} else {\n\t\t\t\t\tlogService.error('Cannot register remote filesystem provider. Remote environment doesnot exist.');\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogService.error('Cannot register remote filesystem provider. Error while fetching remote environment.', getErrorMessage(error));\n\t\t\t}\n\t\t})();\n\n\t\tdisposables.add(fileService.onWillActivateFileSystemProvider(e => {\n\t\t\tif (e.scheme === Schemas.vscodeRemote) {\n\t\t\t\te.join(environmentPromise);\n\t\t\t}\n\t\t}));\n\n\t\treturn disposables;\n\t}\n\n\tprivate constructor(remoteAgentEnvironment: IRemoteAgentEnvironment, connection: IRemoteAgentConnection) {\n\t\tsuper(connection.getChannel(REMOTE_FILE_SYSTEM_CHANNEL_NAME), { pathCaseSensitive: remoteAgentEnvironment.os === OperatingSystem.Linux });\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getErrorMessage } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, IDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { OperatingSystem } from '../../../../base/common/platform.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { DiskFileSystemProviderClient } from '../../../../platform/files/common/diskFileSystemProviderClient.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { IRemoteAgentEnvironment } from '../../../../platform/remote/common/remoteAgentEnvironment.js';\nimport { IRemoteAgentConnection, IRemoteAgentService } from './remoteAgentService.js';\n\nexport const REMOTE_FILE_SYSTEM_CHANNEL_NAME = 'remoteFilesystem';\n\nexport class RemoteFileSystemProviderClient extends DiskFileSystemProviderClient {\n\n\tstatic register(remoteAgentService: IRemoteAgentService, fileService: IFileService, logService: ILogService): IDisposable {\n\t\tconst connection = remoteAgentService.getConnection();\n\t\tif (!connection) {\n\t\t\treturn Disposable.None;\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\n\t\tconst environmentPromise = (async () => {\n\t\t\ttry {\n\t\t\t\tconst environment = await remoteAgentService.getRawEnvironment();\n\t\t\t\tif (environment) {\n\t\t\t\t\t// Register remote fsp even before it is asked to activate\n\t\t\t\t\t// because, some features (configuration) wait for its\n\t\t\t\t\t// registration before making fs calls.\n\t\t\t\t\tfileService.registerProvider(Schemas.vscodeRemote, disposables.add(new RemoteFileSystemProviderClient(environment, connection)));\n\t\t\t\t} else {\n\t\t\t\t\tlogService.error('Cannot register remote filesystem provider. Remote environment doesnot exist.');\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogService.error('Cannot register remote filesystem provider. Error while fetching remote environment.', getErrorMessage(error));\n\t\t\t}\n\t\t})();\n\n\t\tdisposables.add(fileService.onWillActivateFileSystemProvider(e => {\n\t\t\tif (e.scheme === Schemas.vscodeRemote) {\n\t\t\t\te.join(environmentPromise);\n\t\t\t}\n\t\t}));\n\n\t\treturn disposables;\n\t}\n\n\tprivate constructor(remoteAgentEnvironment: IRemoteAgentEnvironment, connection: IRemoteAgentConnection) {\n\t\tsuper(connection.getChannel(REMOTE_FILE_SYSTEM_CHANNEL_NAME), { pathCaseSensitive: remoteAgentEnvironment.os === OperatingSystem.Linux });\n\t}\n}\n"]}