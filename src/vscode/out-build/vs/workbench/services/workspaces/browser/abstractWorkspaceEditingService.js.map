{"version":3,"sources":["vs/workbench/services/workspaces/browser/abstractWorkspaceEditingService.ts"],"names":[],"mappings":"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","file":"abstractWorkspaceEditingService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IWorkspaceEditingService } from '../common/workspaceEditing.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { hasWorkspaceFileExtension, isSavedWorkspace, isUntitledWorkspace, isWorkspaceIdentifier, IWorkspaceContextService, IWorkspaceIdentifier, toWorkspaceIdentifier, WorkbenchState, WORKSPACE_EXTENSION, WORKSPACE_FILTER } from '../../../../platform/workspace/common/workspace.js';\nimport { IJSONEditingService, JSONEditingError, JSONEditingErrorCode } from '../../configuration/common/jsonEditing.js';\nimport { IWorkspaceFolderCreationData, IWorkspacesService, rewriteWorkspaceFileForNewLocation, IEnterWorkspaceResult, IStoredWorkspace } from '../../../../platform/workspaces/common/workspaces.js';\nimport { WorkspaceService } from '../../configuration/browser/configurationService.js';\nimport { ConfigurationScope, IConfigurationRegistry, Extensions as ConfigurationExtensions, IConfigurationPropertySchema } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { distinct } from '../../../../base/common/arrays.js';\nimport { basename, isEqual, isEqualAuthority, joinPath, removeTrailingPathSeparator } from '../../../../base/common/resources.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { IFileDialogService, IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nimport { ITextFileService } from '../../textfile/common/textfiles.js';\nimport { IHostService } from '../../host/browser/host.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { SaveReason } from '../../../common/editor.js';\nimport { IUriIdentityService } from '../../../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nimport { IWorkbenchConfigurationService } from '../../configuration/common/configuration.js';\nimport { IUserDataProfilesService } from '../../../../platform/userDataProfile/common/userDataProfile.js';\nimport { IUserDataProfileService } from '../../userDataProfile/common/userDataProfile.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport abstract class AbstractWorkspaceEditingService extends Disposable implements IWorkspaceEditingService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@IJSONEditingService private readonly jsonEditingService: IJSONEditingService,\n\t\t@IWorkspaceContextService protected readonly contextService: WorkspaceService,\n\t\t@IWorkbenchConfigurationService protected readonly configurationService: IWorkbenchConfigurationService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IWorkspacesService protected readonly workspacesService: IWorkspacesService,\n\t\t@IWorkbenchEnvironmentService protected readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IFileDialogService private readonly fileDialogService: IFileDialogService,\n\t\t@IDialogService protected readonly dialogService: IDialogService,\n\t\t@IHostService protected readonly hostService: IHostService,\n\t\t@IUriIdentityService protected readonly uriIdentityService: IUriIdentityService,\n\t\t@IWorkspaceTrustManagementService private readonly workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@IUserDataProfilesService private readonly userDataProfilesService: IUserDataProfilesService,\n\t\t@IUserDataProfileService private readonly userDataProfileService: IUserDataProfileService,\n\t) {\n\t\tsuper();\n\t}\n\n\tasync pickNewWorkspacePath(): Promise<URI | undefined> {\n\t\tconst availableFileSystems = [Schemas.file];\n\t\tif (this.environmentService.remoteAuthority) {\n\t\t\tavailableFileSystems.unshift(Schemas.vscodeRemote);\n\t\t}\n\t\tlet workspacePath = await this.fileDialogService.showSaveDialog({\n\t\t\tsaveLabel: localize('save', \"Save\"),\n\t\t\ttitle: localize('saveWorkspace', \"Save Workspace\"),\n\t\t\tfilters: WORKSPACE_FILTER,\n\t\t\tdefaultUri: joinPath(await this.fileDialogService.defaultWorkspacePath(), this.getNewWorkspaceName()),\n\t\t\tavailableFileSystems\n\t\t});\n\n\t\tif (!workspacePath) {\n\t\t\treturn; // canceled\n\t\t}\n\n\t\tif (!hasWorkspaceFileExtension(workspacePath)) {\n\t\t\t// Always ensure we have workspace file extension\n\t\t\t// (see https://github.com/microsoft/vscode/issues/84818)\n\t\t\tworkspacePath = workspacePath.with({ path: `${workspacePath.path}.${WORKSPACE_EXTENSION}` });\n\t\t}\n\n\t\treturn workspacePath;\n\t}\n\n\tprivate getNewWorkspaceName(): string {\n\n\t\t// First try with existing workspace name\n\t\tconst configPathURI = this.getCurrentWorkspaceIdentifier()?.configPath;\n\t\tif (configPathURI && isSavedWorkspace(configPathURI, this.environmentService)) {\n\t\t\treturn basename(configPathURI);\n\t\t}\n\n\t\t// Then fallback to first folder if any\n\t\tconst folder = this.contextService.getWorkspace().folders.at(0);\n\t\tif (folder) {\n\t\t\treturn `${basename(folder.uri)}.${WORKSPACE_EXTENSION}`;\n\t\t}\n\n\t\t// Finally pick a good default\n\t\treturn `workspace.${WORKSPACE_EXTENSION}`;\n\t}\n\n\tasync updateFolders(index: number, deleteCount?: number, foldersToAddCandidates?: IWorkspaceFolderCreationData[], donotNotifyError?: boolean): Promise<void> {\n\t\tconst folders = this.contextService.getWorkspace().folders;\n\n\t\tlet foldersToDelete: URI[] = [];\n\t\tif (typeof deleteCount === 'number') {\n\t\t\tfoldersToDelete = folders.slice(index, index + deleteCount).map(folder => folder.uri);\n\t\t}\n\n\t\tlet foldersToAdd: IWorkspaceFolderCreationData[] = [];\n\t\tif (Array.isArray(foldersToAddCandidates)) {\n\t\t\tfoldersToAdd = foldersToAddCandidates.map(folderToAdd => ({ uri: removeTrailingPathSeparator(folderToAdd.uri), name: folderToAdd.name })); // Normalize\n\t\t}\n\n\t\tconst wantsToDelete = foldersToDelete.length > 0;\n\t\tconst wantsToAdd = foldersToAdd.length > 0;\n\n\t\tif (!wantsToAdd && !wantsToDelete) {\n\t\t\treturn; // return early if there is nothing to do\n\t\t}\n\n\t\t// Add Folders\n\t\tif (wantsToAdd && !wantsToDelete) {\n\t\t\treturn this.doAddFolders(foldersToAdd, index, donotNotifyError);\n\t\t}\n\n\t\t// Delete Folders\n\t\tif (wantsToDelete && !wantsToAdd) {\n\t\t\treturn this.removeFolders(foldersToDelete);\n\t\t}\n\n\t\t// Add & Delete Folders\n\t\telse {\n\n\t\t\t// if we are in single-folder state and the folder is replaced with\n\t\t\t// other folders, we handle this specially and just enter workspace\n\t\t\t// mode with the folders that are being added.\n\t\t\tif (this.includesSingleFolderWorkspace(foldersToDelete)) {\n\t\t\t\treturn this.createAndEnterWorkspace(foldersToAdd);\n\t\t\t}\n\n\t\t\t// if we are not in workspace-state, we just add the folders\n\t\t\tif (this.contextService.getWorkbenchState() !== WorkbenchState.WORKSPACE) {\n\t\t\t\treturn this.doAddFolders(foldersToAdd, index, donotNotifyError);\n\t\t\t}\n\n\t\t\t// finally, update folders within the workspace\n\t\t\treturn this.doUpdateFolders(foldersToAdd, foldersToDelete, index, donotNotifyError);\n\t\t}\n\t}\n\n\tprivate async doUpdateFolders(foldersToAdd: IWorkspaceFolderCreationData[], foldersToDelete: URI[], index?: number, donotNotifyError = false): Promise<void> {\n\t\ttry {\n\t\t\tawait this.contextService.updateFolders(foldersToAdd, foldersToDelete, index);\n\t\t} catch (error) {\n\t\t\tif (donotNotifyError) {\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tthis.handleWorkspaceConfigurationEditingError(error);\n\t\t}\n\t}\n\n\taddFolders(foldersToAddCandidates: IWorkspaceFolderCreationData[], donotNotifyError = false): Promise<void> {\n\n\t\t// Normalize\n\t\tconst foldersToAdd = foldersToAddCandidates.map(folderToAdd => ({ uri: removeTrailingPathSeparator(folderToAdd.uri), name: folderToAdd.name }));\n\n\t\treturn this.doAddFolders(foldersToAdd, undefined, donotNotifyError);\n\t}\n\n\tprivate async doAddFolders(foldersToAdd: IWorkspaceFolderCreationData[], index?: number, donotNotifyError = false): Promise<void> {\n\t\tconst state = this.contextService.getWorkbenchState();\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tif (remoteAuthority) {\n\t\t\t// https://github.com/microsoft/vscode/issues/94191\n\t\t\tfoldersToAdd = foldersToAdd.filter(folder => folder.uri.scheme !== Schemas.file && (folder.uri.scheme !== Schemas.vscodeRemote || isEqualAuthority(folder.uri.authority, remoteAuthority)));\n\t\t}\n\n\t\t// If we are in no-workspace or single-folder workspace, adding folders has to\n\t\t// enter a workspace.\n\t\tif (state !== WorkbenchState.WORKSPACE) {\n\t\t\tlet newWorkspaceFolders = this.contextService.getWorkspace().folders.map(folder => ({ uri: folder.uri }));\n\t\t\tnewWorkspaceFolders.splice(typeof index === 'number' ? index : newWorkspaceFolders.length, 0, ...foldersToAdd);\n\t\t\tnewWorkspaceFolders = distinct(newWorkspaceFolders, folder => this.uriIdentityService.extUri.getComparisonKey(folder.uri));\n\n\t\t\tif (state === WorkbenchState.EMPTY && newWorkspaceFolders.length === 0 || state === WorkbenchState.FOLDER && newWorkspaceFolders.length === 1) {\n\t\t\t\treturn; // return if the operation is a no-op for the current state\n\t\t\t}\n\n\t\t\treturn this.createAndEnterWorkspace(newWorkspaceFolders);\n\t\t}\n\n\t\t// Delegate addition of folders to workspace service otherwise\n\t\ttry {\n\t\t\tawait this.contextService.addFolders(foldersToAdd, index);\n\t\t} catch (error) {\n\t\t\tif (donotNotifyError) {\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tthis.handleWorkspaceConfigurationEditingError(error);\n\t\t}\n\t}\n\n\tasync removeFolders(foldersToRemove: URI[], donotNotifyError = false): Promise<void> {\n\n\t\t// If we are in single-folder state and the opened folder is to be removed,\n\t\t// we create an empty workspace and enter it.\n\t\tif (this.includesSingleFolderWorkspace(foldersToRemove)) {\n\t\t\treturn this.createAndEnterWorkspace([]);\n\t\t}\n\n\t\t// Delegate removal of folders to workspace service otherwise\n\t\ttry {\n\t\t\tawait this.contextService.removeFolders(foldersToRemove);\n\t\t} catch (error) {\n\t\t\tif (donotNotifyError) {\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tthis.handleWorkspaceConfigurationEditingError(error);\n\t\t}\n\t}\n\n\tprivate includesSingleFolderWorkspace(folders: URI[]): boolean {\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\tconst workspaceFolder = this.contextService.getWorkspace().folders[0];\n\t\t\treturn (folders.some(folder => this.uriIdentityService.extUri.isEqual(folder, workspaceFolder.uri)));\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tasync createAndEnterWorkspace(folders: IWorkspaceFolderCreationData[], path?: URI): Promise<void> {\n\t\tif (path && !await this.isValidTargetWorkspacePath(path)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tconst untitledWorkspace = await this.workspacesService.createUntitledWorkspace(folders, remoteAuthority);\n\t\tif (path) {\n\t\t\ttry {\n\t\t\t\tawait this.saveWorkspaceAs(untitledWorkspace, path);\n\t\t\t} finally {\n\t\t\t\tawait this.workspacesService.deleteUntitledWorkspace(untitledWorkspace); // https://github.com/microsoft/vscode/issues/100276\n\t\t\t}\n\t\t} else {\n\t\t\tpath = untitledWorkspace.configPath;\n\t\t\tif (!this.userDataProfileService.currentProfile.isDefault) {\n\t\t\t\tawait this.userDataProfilesService.setProfileForWorkspace(untitledWorkspace, this.userDataProfileService.currentProfile);\n\t\t\t}\n\t\t}\n\n\t\treturn this.enterWorkspace(path);\n\t}\n\n\tasync saveAndEnterWorkspace(workspaceUri: URI): Promise<void> {\n\t\tconst workspaceIdentifier = this.getCurrentWorkspaceIdentifier();\n\t\tif (!workspaceIdentifier) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Allow to save the workspace of the current window\n\t\t// if we have an identical match on the path\n\t\tif (isEqual(workspaceIdentifier.configPath, workspaceUri)) {\n\t\t\treturn this.saveWorkspace(workspaceIdentifier);\n\t\t}\n\n\t\t// From this moment on we require a valid target that is not opened already\n\t\tif (!await this.isValidTargetWorkspacePath(workspaceUri)) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.saveWorkspaceAs(workspaceIdentifier, workspaceUri);\n\n\t\treturn this.enterWorkspace(workspaceUri);\n\t}\n\n\tasync isValidTargetWorkspacePath(workspaceUri: URI): Promise<boolean> {\n\t\treturn true; // OK\n\t}\n\n\tprotected async saveWorkspaceAs(workspace: IWorkspaceIdentifier, targetConfigPathURI: URI): Promise<void> {\n\t\tconst configPathURI = workspace.configPath;\n\n\t\tconst isNotUntitledWorkspace = !isUntitledWorkspace(targetConfigPathURI, this.environmentService);\n\t\tif (isNotUntitledWorkspace && !this.userDataProfileService.currentProfile.isDefault) {\n\t\t\tconst newWorkspace = await this.workspacesService.getWorkspaceIdentifier(targetConfigPathURI);\n\t\t\tawait this.userDataProfilesService.setProfileForWorkspace(newWorkspace, this.userDataProfileService.currentProfile);\n\t\t}\n\n\t\t// Return early if target is same as source\n\t\tif (this.uriIdentityService.extUri.isEqual(configPathURI, targetConfigPathURI)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isFromUntitledWorkspace = isUntitledWorkspace(configPathURI, this.environmentService);\n\n\t\t// Read the contents of the workspace file, update it to new location and save it.\n\t\tconst raw = await this.fileService.readFile(configPathURI);\n\t\tconst newRawWorkspaceContents = rewriteWorkspaceFileForNewLocation(raw.value.toString(), configPathURI, isFromUntitledWorkspace, targetConfigPathURI, this.uriIdentityService.extUri);\n\t\tawait this.textFileService.create([{ resource: targetConfigPathURI, value: newRawWorkspaceContents, options: { overwrite: true } }]);\n\n\t\t// Set trust for the workspace file\n\t\tawait this.trustWorkspaceConfiguration(targetConfigPathURI);\n\t}\n\n\tprotected async saveWorkspace(workspace: IWorkspaceIdentifier): Promise<void> {\n\t\tconst configPathURI = workspace.configPath;\n\n\t\t// First: try to save any existing model as it could be dirty\n\t\tconst existingModel = this.textFileService.files.get(configPathURI);\n\t\tif (existingModel) {\n\t\t\tawait existingModel.save({ force: true, reason: SaveReason.EXPLICIT });\n\t\t\treturn;\n\t\t}\n\n\t\t// Second: if the file exists on disk, simply return\n\t\tconst workspaceFileExists = await this.fileService.exists(configPathURI);\n\t\tif (workspaceFileExists) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Finally, we need to re-create the file as it was deleted\n\t\tconst newWorkspace: IStoredWorkspace = { folders: [] };\n\t\tconst newRawWorkspaceContents = rewriteWorkspaceFileForNewLocation(JSON.stringify(newWorkspace, null, '\\t'), configPathURI, false, configPathURI, this.uriIdentityService.extUri);\n\t\tawait this.textFileService.create([{ resource: configPathURI, value: newRawWorkspaceContents }]);\n\t}\n\n\tprivate handleWorkspaceConfigurationEditingError(error: JSONEditingError): void {\n\t\tswitch (error.code) {\n\t\t\tcase JSONEditingErrorCode.ERROR_INVALID_FILE:\n\t\t\t\tthis.onInvalidWorkspaceConfigurationFileError();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.notificationService.error(error.message);\n\t\t}\n\t}\n\n\tprivate onInvalidWorkspaceConfigurationFileError(): void {\n\t\tconst message = localize('errorInvalidTaskConfiguration', \"Unable to write into workspace configuration file. Please open the file to correct errors/warnings in it and try again.\");\n\t\tthis.askToOpenWorkspaceConfigurationFile(message);\n\t}\n\n\tprivate askToOpenWorkspaceConfigurationFile(message: string): void {\n\t\tthis.notificationService.prompt(Severity.Error, message,\n\t\t\t[{\n\t\t\t\tlabel: localize('openWorkspaceConfigurationFile', \"Open Workspace Configuration\"),\n\t\t\t\trun: () => this.commandService.executeCommand('workbench.action.openWorkspaceConfigFile')\n\t\t\t}]\n\t\t);\n\t}\n\n\tabstract enterWorkspace(workspaceUri: URI): Promise<void>;\n\n\tprotected async doEnterWorkspace(workspaceUri: URI): Promise<IEnterWorkspaceResult | undefined> {\n\t\tif (this.environmentService.extensionTestsLocationURI) {\n\t\t\tthrow new Error('Entering a new workspace is not possible in tests.');\n\t\t}\n\n\t\tconst workspace = await this.workspacesService.getWorkspaceIdentifier(workspaceUri);\n\n\t\t// Settings migration (only if we come from a folder workspace)\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\tawait this.migrateWorkspaceSettings(workspace);\n\t\t}\n\n\t\tawait this.configurationService.initialize(workspace);\n\n\t\treturn this.workspacesService.enterWorkspace(workspaceUri);\n\t}\n\n\tprivate migrateWorkspaceSettings(toWorkspace: IWorkspaceIdentifier): Promise<void> {\n\t\treturn this.doCopyWorkspaceSettings(toWorkspace, setting => setting.scope === ConfigurationScope.WINDOW);\n\t}\n\n\tcopyWorkspaceSettings(toWorkspace: IWorkspaceIdentifier): Promise<void> {\n\t\treturn this.doCopyWorkspaceSettings(toWorkspace);\n\t}\n\n\tprivate doCopyWorkspaceSettings(toWorkspace: IWorkspaceIdentifier, filter?: (config: IConfigurationPropertySchema) => boolean): Promise<void> {\n\t\tconst configurationProperties = Registry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration).getConfigurationProperties();\n\t\tconst targetWorkspaceConfiguration: Record<string, unknown> = {};\n\t\tfor (const key of this.configurationService.keys().workspace) {\n\t\t\tif (configurationProperties[key]) {\n\t\t\t\tif (filter && !filter(configurationProperties[key])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttargetWorkspaceConfiguration[key] = this.configurationService.inspect(key).workspaceValue;\n\t\t\t}\n\t\t}\n\n\t\treturn this.jsonEditingService.write(toWorkspace.configPath, [{ path: ['settings'], value: targetWorkspaceConfiguration }], true);\n\t}\n\n\tprivate async trustWorkspaceConfiguration(configPathURI: URI): Promise<void> {\n\t\tif (this.contextService.getWorkbenchState() !== WorkbenchState.EMPTY && this.workspaceTrustManagementService.isWorkspaceTrusted()) {\n\t\t\tawait this.workspaceTrustManagementService.setUrisTrust([configPathURI], true);\n\t\t}\n\t}\n\n\tprotected getCurrentWorkspaceIdentifier(): IWorkspaceIdentifier | undefined {\n\t\tconst identifier = toWorkspaceIdentifier(this.contextService.getWorkspace());\n\t\tif (isWorkspaceIdentifier(identifier)) {\n\t\t\treturn identifier;\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n"]}