{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/workspaces/common/editSessionIdentityService.ts","vs/workbench/services/workspaces/common/editSessionIdentityService.ts"],"names":[],"mappings":"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","file":"editSessionIdentityService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { insert } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { EditSessionIdentityMatch, IEditSessionIdentityCreateParticipant, IEditSessionIdentityProvider, IEditSessionIdentityService } from '../../../../platform/workspace/common/editSessions.js';\nimport { IWorkspaceFolder } from '../../../../platform/workspace/common/workspace.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\n\nexport class EditSessionIdentityService implements IEditSessionIdentityService {\n\treadonly _serviceBrand: undefined;\n\n\tprivate _editSessionIdentifierProviders = new Map<string, IEditSessionIdentityProvider>();\n\n\tconstructor(\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tregisterEditSessionIdentityProvider(provider: IEditSessionIdentityProvider): IDisposable {\n\t\tif (this._editSessionIdentifierProviders.get(provider.scheme)) {\n\t\t\tthrow new Error(`A provider has already been registered for scheme ${provider.scheme}`);\n\t\t}\n\n\t\tthis._editSessionIdentifierProviders.set(provider.scheme, provider);\n\t\treturn toDisposable(() => {\n\t\t\tthis._editSessionIdentifierProviders.delete(provider.scheme);\n\t\t});\n\t}\n\n\tasync getEditSessionIdentifier(workspaceFolder: IWorkspaceFolder, token: CancellationToken): Promise<string | undefined> {\n\t\tconst { scheme } = workspaceFolder.uri;\n\n\t\tconst provider = await this.activateProvider(scheme);\n\t\tthis._logService.trace(`EditSessionIdentityProvider for scheme ${scheme} available: ${!!provider}`);\n\n\t\treturn provider?.getEditSessionIdentifier(workspaceFolder, token);\n\t}\n\n\tasync provideEditSessionIdentityMatch(workspaceFolder: IWorkspaceFolder, identity1: string, identity2: string, cancellationToken: CancellationToken): Promise<EditSessionIdentityMatch | undefined> {\n\t\tconst { scheme } = workspaceFolder.uri;\n\n\t\tconst provider = await this.activateProvider(scheme);\n\t\tthis._logService.trace(`EditSessionIdentityProvider for scheme ${scheme} available: ${!!provider}`);\n\n\t\treturn provider?.provideEditSessionIdentityMatch?.(workspaceFolder, identity1, identity2, cancellationToken);\n\t}\n\n\tasync onWillCreateEditSessionIdentity(workspaceFolder: IWorkspaceFolder, cancellationToken: CancellationToken): Promise<void> {\n\t\tthis._logService.debug('Running onWillCreateEditSessionIdentity participants...');\n\n\t\t// TODO@joyceerhl show progress notification?\n\t\tfor (const participant of this._participants) {\n\t\t\tawait participant.participate(workspaceFolder, cancellationToken);\n\t\t}\n\n\t\tthis._logService.debug(`Done running ${this._participants.length} onWillCreateEditSessionIdentity participants.`);\n\t}\n\n\tprivate _participants: IEditSessionIdentityCreateParticipant[] = [];\n\n\taddEditSessionIdentityCreateParticipant(participant: IEditSessionIdentityCreateParticipant): IDisposable {\n\t\tconst dispose = insert(this._participants, participant);\n\n\t\treturn toDisposable(() => dispose());\n\t}\n\n\tprivate async activateProvider(scheme: string) {\n\t\tconst transformedScheme = scheme === 'vscode-remote' ? 'file' : scheme;\n\n\t\tconst provider = this._editSessionIdentifierProviders.get(scheme);\n\t\tif (provider) {\n\t\t\treturn provider;\n\t\t}\n\n\t\tawait this._extensionService.activateByEvent(`onEditSession:${transformedScheme}`);\n\t\treturn this._editSessionIdentifierProviders.get(scheme);\n\t}\n}\n\nregisterSingleton(IEditSessionIdentityService, EditSessionIdentityService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { insert } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { EditSessionIdentityMatch, IEditSessionIdentityCreateParticipant, IEditSessionIdentityProvider, IEditSessionIdentityService } from '../../../../platform/workspace/common/editSessions.js';\nimport { IWorkspaceFolder } from '../../../../platform/workspace/common/workspace.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\n\nexport class EditSessionIdentityService implements IEditSessionIdentityService {\n\treadonly _serviceBrand: undefined;\n\n\tprivate _editSessionIdentifierProviders = new Map<string, IEditSessionIdentityProvider>();\n\n\tconstructor(\n\t\t@IExtensionService private readonly _extensionService: IExtensionService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) { }\n\n\tregisterEditSessionIdentityProvider(provider: IEditSessionIdentityProvider): IDisposable {\n\t\tif (this._editSessionIdentifierProviders.get(provider.scheme)) {\n\t\t\tthrow new Error(`A provider has already been registered for scheme ${provider.scheme}`);\n\t\t}\n\n\t\tthis._editSessionIdentifierProviders.set(provider.scheme, provider);\n\t\treturn toDisposable(() => {\n\t\t\tthis._editSessionIdentifierProviders.delete(provider.scheme);\n\t\t});\n\t}\n\n\tasync getEditSessionIdentifier(workspaceFolder: IWorkspaceFolder, token: CancellationToken): Promise<string | undefined> {\n\t\tconst { scheme } = workspaceFolder.uri;\n\n\t\tconst provider = await this.activateProvider(scheme);\n\t\tthis._logService.trace(`EditSessionIdentityProvider for scheme ${scheme} available: ${!!provider}`);\n\n\t\treturn provider?.getEditSessionIdentifier(workspaceFolder, token);\n\t}\n\n\tasync provideEditSessionIdentityMatch(workspaceFolder: IWorkspaceFolder, identity1: string, identity2: string, cancellationToken: CancellationToken): Promise<EditSessionIdentityMatch | undefined> {\n\t\tconst { scheme } = workspaceFolder.uri;\n\n\t\tconst provider = await this.activateProvider(scheme);\n\t\tthis._logService.trace(`EditSessionIdentityProvider for scheme ${scheme} available: ${!!provider}`);\n\n\t\treturn provider?.provideEditSessionIdentityMatch?.(workspaceFolder, identity1, identity2, cancellationToken);\n\t}\n\n\tasync onWillCreateEditSessionIdentity(workspaceFolder: IWorkspaceFolder, cancellationToken: CancellationToken): Promise<void> {\n\t\tthis._logService.debug('Running onWillCreateEditSessionIdentity participants...');\n\n\t\t// TODO@joyceerhl show progress notification?\n\t\tfor (const participant of this._participants) {\n\t\t\tawait participant.participate(workspaceFolder, cancellationToken);\n\t\t}\n\n\t\tthis._logService.debug(`Done running ${this._participants.length} onWillCreateEditSessionIdentity participants.`);\n\t}\n\n\tprivate _participants: IEditSessionIdentityCreateParticipant[] = [];\n\n\taddEditSessionIdentityCreateParticipant(participant: IEditSessionIdentityCreateParticipant): IDisposable {\n\t\tconst dispose = insert(this._participants, participant);\n\n\t\treturn toDisposable(() => dispose());\n\t}\n\n\tprivate async activateProvider(scheme: string) {\n\t\tconst transformedScheme = scheme === 'vscode-remote' ? 'file' : scheme;\n\n\t\tconst provider = this._editSessionIdentifierProviders.get(scheme);\n\t\tif (provider) {\n\t\t\treturn provider;\n\t\t}\n\n\t\tawait this._extensionService.activateByEvent(`onEditSession:${transformedScheme}`);\n\t\treturn this._editSessionIdentifierProviders.get(scheme);\n\t}\n}\n\nregisterSingleton(IEditSessionIdentityService, EditSessionIdentityService, InstantiationType.Delayed);\n"]}