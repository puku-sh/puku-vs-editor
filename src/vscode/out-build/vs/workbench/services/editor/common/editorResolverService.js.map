{"version":3,"sources":["vs/workbench/services/editor/common/editorResolverService.ts"],"names":[],"mappings":"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","file":"editorResolverService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from '../../../../base/common/glob.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { posix } from '../../../../base/common/path.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { localize } from '../../../../nls.js';\nimport { workbenchConfigurationNodeBase } from '../../../common/configuration.js';\nimport { Extensions as ConfigurationExtensions, IConfigurationNode, IConfigurationRegistry } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { IResourceEditorInput, ITextResourceEditorInput } from '../../../../platform/editor/common/editor.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { EditorInputWithOptions, EditorInputWithOptionsAndGroup, IResourceDiffEditorInput, IResourceMultiDiffEditorInput, IResourceMergeEditorInput, IUntitledTextResourceEditorInput, IUntypedEditorInput } from '../../../common/editor.js';\nimport { IEditorGroup } from './editorGroupsService.js';\nimport { PreferredGroup } from './editorService.js';\nimport { AtLeastOne } from '../../../../base/common/types.js';\n\nexport const IEditorResolverService = createDecorator<IEditorResolverService>('editorResolverService');\n\n//#region Editor Associations\n\n// Static values for registered editors\n\nexport type EditorAssociation = {\n\treadonly viewType: string;\n\treadonly filenamePattern?: string;\n};\n\nexport type EditorAssociations = readonly EditorAssociation[];\n\nexport const editorsAssociationsSettingId = 'workbench.editorAssociations';\n\nconst configurationRegistry = Registry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration);\n\nconst editorAssociationsConfigurationNode: IConfigurationNode = {\n\t...workbenchConfigurationNodeBase,\n\tproperties: {\n\t\t'workbench.editorAssociations': {\n\t\t\ttype: 'object',\n\t\t\tmarkdownDescription: localize('editor.editorAssociations', \"Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `\\\"*.hex\\\": \\\"hexEditor.hexedit\\\"`). These have precedence over the default behavior.\"),\n\t\t\tadditionalProperties: {\n\t\t\t\ttype: 'string'\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport interface IEditorType {\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly providerDisplayName: string;\n}\n\nconfigurationRegistry.registerConfiguration(editorAssociationsConfigurationNode);\n//#endregion\n\n//#region EditorResolverService types\nexport enum RegisteredEditorPriority {\n\tbuiltin = 'builtin',\n\toption = 'option',\n\texclusive = 'exclusive',\n\tdefault = 'default'\n}\n\n/**\n * If we didn't resolve an editor dictates what to do with the opening state\n * ABORT = Do not continue with opening the editor\n * NONE = Continue as if the resolution has been disabled as the service could not resolve one\n */\nexport const enum ResolvedStatus {\n\tABORT = 1,\n\tNONE = 2,\n}\n\nexport type ResolvedEditor = EditorInputWithOptionsAndGroup | ResolvedStatus;\n\nexport type RegisteredEditorOptions = {\n\t/**\n\t * If your editor cannot be opened in multiple groups for the same resource\n\t */\n\tsinglePerResource?: boolean | (() => boolean);\n\n\t/**\n\t * Whether or not you can support opening the given resource.\n\t * If omitted we assume you can open everything\n\t */\n\tcanSupportResource?: (resource: URI) => boolean;\n};\n\nexport type RegisteredEditorInfo = {\n\tid: string;\n\tlabel: string;\n\tdetail?: string;\n\tpriority: RegisteredEditorPriority;\n};\n\ntype EditorInputFactoryResult = EditorInputWithOptions | Promise<EditorInputWithOptions>;\n\nexport type EditorInputFactoryFunction = (editorInput: IResourceEditorInput | ITextResourceEditorInput, group: IEditorGroup) => EditorInputFactoryResult;\n\nexport type UntitledEditorInputFactoryFunction = (untitledEditorInput: IUntitledTextResourceEditorInput, group: IEditorGroup) => EditorInputFactoryResult;\n\nexport type DiffEditorInputFactoryFunction = (diffEditorInput: IResourceDiffEditorInput, group: IEditorGroup) => EditorInputFactoryResult;\n\nexport type MultiDiffEditorInputFactoryFunction = (multiDiffEditorInput: IResourceMultiDiffEditorInput, group: IEditorGroup) => EditorInputFactoryResult;\n\nexport type MergeEditorInputFactoryFunction = (mergeEditorInput: IResourceMergeEditorInput, group: IEditorGroup) => EditorInputFactoryResult;\n\ntype EditorInputFactories = {\n\tcreateEditorInput?: EditorInputFactoryFunction;\n\tcreateUntitledEditorInput?: UntitledEditorInputFactoryFunction;\n\tcreateDiffEditorInput?: DiffEditorInputFactoryFunction;\n\tcreateMultiDiffEditorInput?: MultiDiffEditorInputFactoryFunction;\n\tcreateMergeEditorInput?: MergeEditorInputFactoryFunction;\n};\n\nexport type EditorInputFactoryObject = AtLeastOne<EditorInputFactories>;\n\nexport interface IEditorResolverService {\n\treadonly _serviceBrand: undefined;\n\t/**\n\t * Given a resource finds the editor associations that match it from the user's settings\n\t * @param resource The resource to match\n\t * @return The matching associations\n\t */\n\tgetAssociationsForResource(resource: URI): EditorAssociations;\n\n\t/**\n\t * Updates the user's association to include a specific editor ID as a default for the given glob pattern\n\t * @param globPattern The glob pattern (must be a string as settings don't support relative glob)\n\t * @param editorID The ID of the editor to make a user default\n\t */\n\tupdateUserAssociations(globPattern: string, editorID: string): void;\n\n\t/**\n\t * Emitted when an editor is registered or unregistered.\n\t */\n\treadonly onDidChangeEditorRegistrations: Event<void>;\n\n\t/**\n\t * Given a callback, run the callback pausing the registration emitter\n\t */\n\tbufferChangeEvents(callback: Function): void;\n\n\t/**\n\t * Registers a specific editor. Editors with the same glob pattern and ID will be grouped together by the resolver.\n\t * This allows for registration of the factories in different locations\n\t * @param globPattern The glob pattern for this registration\n\t * @param editorInfo Information about the registration\n\t * @param options Specific options which apply to this registration\n\t * @param editorFactoryObject The editor input factory functions\n\t */\n\tregisterEditor(\n\t\tglobPattern: string | glob.IRelativePattern,\n\t\teditorInfo: RegisteredEditorInfo,\n\t\toptions: RegisteredEditorOptions,\n\t\teditorFactoryObject: EditorInputFactoryObject\n\t): IDisposable;\n\n\t/**\n\t * Given an editor resolves it to the suitable ResolvedEditor based on user extensions, settings, and built-in editors\n\t * @param editor The editor to resolve\n\t * @param preferredGroup The group you want to open the editor in\n\t * @returns An EditorInputWithOptionsAndGroup if there is an available editor or a status of how to proceed\n\t */\n\tresolveEditor(editor: IUntypedEditorInput, preferredGroup: PreferredGroup | undefined): Promise<ResolvedEditor>;\n\n\t/**\n\t * Given a resource returns all the editor ids that match that resource. If there is exclusive editor we return an empty array\n\t * @param resource The resource\n\t * @returns A list of editor ids\n\t */\n\tgetEditors(resource: URI): RegisteredEditorInfo[];\n\n\t/**\n\t * A set of all the editors that are registered to the editor resolver.\n\t */\n\tgetEditors(): RegisteredEditorInfo[];\n\n\t/**\n\t * Get a complete list of editor associations.\n\t */\n\tgetAllUserAssociations(): EditorAssociations;\n}\n\n//#endregion\n\n//#region Util functions\nexport function priorityToRank(priority: RegisteredEditorPriority): number {\n\tswitch (priority) {\n\t\tcase RegisteredEditorPriority.exclusive:\n\t\t\treturn 5;\n\t\tcase RegisteredEditorPriority.default:\n\t\t\treturn 4;\n\t\tcase RegisteredEditorPriority.builtin:\n\t\t\treturn 3;\n\t\t// Text editor is priority 2\n\t\tcase RegisteredEditorPriority.option:\n\t\tdefault:\n\t\t\treturn 1;\n\t}\n}\n\nexport function globMatchesResource(globPattern: string | glob.IRelativePattern, resource: URI): boolean {\n\tconst excludedSchemes = new Set([\n\t\tSchemas.extension,\n\t\tSchemas.webviewPanel,\n\t\tSchemas.vscodeWorkspaceTrust,\n\t\tSchemas.vscodeSettings\n\t]);\n\t// We want to say that the above schemes match no glob patterns\n\tif (excludedSchemes.has(resource.scheme)) {\n\t\treturn false;\n\t}\n\tconst matchOnPath = typeof globPattern === 'string' && globPattern.indexOf(posix.sep) >= 0;\n\tconst target = matchOnPath ? `${resource.scheme}:${resource.path}` : basename(resource);\n\treturn glob.match(globPattern, target, { ignoreCase: true });\n}\n//#endregion\n"]}