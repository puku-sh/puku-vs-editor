{"version":3,"sources":["vs/workbench/services/editor/browser/editorResolverService.ts"],"names":[],"mappings":"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","file":"editorResolverService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from '../../../../base/common/glob.js';\nimport { distinct, insert } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename, extname, isEqual } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { EditorActivation, EditorResolution, IEditorOptions } from '../../../../platform/editor/common/editor.js';\nimport { DEFAULT_EDITOR_ASSOCIATION, EditorResourceAccessor, EditorInputWithOptions, IResourceSideBySideEditorInput, isEditorInputWithOptions, isEditorInputWithOptionsAndGroup, isResourceDiffEditorInput, isResourceSideBySideEditorInput, isUntitledResourceEditorInput, isResourceMergeEditorInput, IUntypedEditorInput, SideBySideEditor, isResourceMultiDiffEditorInput } from '../../../common/editor.js';\nimport { EditorInput } from '../../../common/editor/editorInput.js';\nimport { IEditorGroup, IEditorGroupsService } from '../common/editorGroupsService.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { RegisteredEditorInfo, RegisteredEditorPriority, RegisteredEditorOptions, EditorAssociation, EditorAssociations, editorsAssociationsSettingId, globMatchesResource, IEditorResolverService, priorityToRank, ResolvedEditor, ResolvedStatus, EditorInputFactoryObject } from '../common/editorResolverService.js';\nimport { QuickPickItem, IKeyMods, IQuickInputService, IQuickPickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { localize } from '../../../../nls.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { IExtensionService } from '../../extensions/common/extensions.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { findGroup } from '../common/editorGroupFinder.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { PreferredGroup } from '../common/editorService.js';\nimport { SideBySideEditorInput } from '../../../common/editor/sideBySideEditorInput.js';\nimport { PauseableEmitter } from '../../../../base/common/event.js';\n\ninterface RegisteredEditor {\n\tglobPattern: string | glob.IRelativePattern;\n\teditorInfo: RegisteredEditorInfo;\n\toptions?: RegisteredEditorOptions;\n\teditorFactoryObject: EditorInputFactoryObject;\n}\n\ntype RegisteredEditors = Array<RegisteredEditor>;\n\nexport class EditorResolverService extends Disposable implements IEditorResolverService {\n\treadonly _serviceBrand: undefined;\n\n\t// Events\n\tprivate readonly _onDidChangeEditorRegistrations = this._register(new PauseableEmitter<void>());\n\treadonly onDidChangeEditorRegistrations = this._onDidChangeEditorRegistrations.event;\n\n\t// Constants\n\tprivate static readonly configureDefaultID = 'promptOpenWith.configureDefault';\n\tprivate static readonly cacheStorageID = 'editorOverrideService.cache';\n\tprivate static readonly conflictingDefaultsStorageID = 'editorOverrideService.conflictingDefaults';\n\n\t// Data Stores\n\tprivate _editors: Map<string | glob.IRelativePattern, Map<string, RegisteredEditors>> = new Map<string | glob.IRelativePattern, Map<string, RegisteredEditors>>();\n\tprivate _flattenedEditors: Map<string | glob.IRelativePattern, RegisteredEditors> = new Map();\n\tprivate _shouldReFlattenEditors = true;\n\tprivate cache: Set<string> | undefined;\n\n\tconstructor(\n\t\t@IEditorGroupsService private readonly editorGroupService: IEditorGroupsService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IQuickInputService private readonly quickInputService: IQuickInputService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IExtensionService private readonly extensionService: IExtensionService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper();\n\t\t// Read in the cache on statup\n\t\tthis.cache = new Set<string>(JSON.parse(this.storageService.get(EditorResolverService.cacheStorageID, StorageScope.PROFILE, JSON.stringify([]))));\n\t\tthis.storageService.remove(EditorResolverService.cacheStorageID, StorageScope.PROFILE);\n\n\t\tthis._register(this.storageService.onWillSaveState(() => {\n\t\t\t// We want to store the glob patterns we would activate on, this allows us to know if we need to await the ext host on startup for opening a resource\n\t\t\tthis.cacheEditors();\n\t\t}));\n\n\t\t// When extensions have registered we no longer need the cache\n\t\tthis._register(this.extensionService.onDidRegisterExtensions(() => {\n\t\t\tthis.cache = undefined;\n\t\t}));\n\t}\n\n\tprivate resolveUntypedInputAndGroup(editor: IUntypedEditorInput, preferredGroup: PreferredGroup | undefined): Promise<[IUntypedEditorInput, IEditorGroup, EditorActivation | undefined] | undefined> | [IUntypedEditorInput, IEditorGroup, EditorActivation | undefined] | undefined {\n\t\tconst untypedEditor = editor;\n\n\t\t// Use the untyped editor to find a group\n\t\tconst findGroupResult = this.instantiationService.invokeFunction(findGroup, untypedEditor, preferredGroup);\n\t\tif (findGroupResult instanceof Promise) {\n\t\t\treturn findGroupResult.then(([group, activation]) => [untypedEditor, group, activation]);\n\t\t} else {\n\t\t\tconst [group, activation] = findGroupResult;\n\t\t\treturn [untypedEditor, group, activation];\n\t\t}\n\t}\n\n\tasync resolveEditor(editor: IUntypedEditorInput, preferredGroup: PreferredGroup | undefined): Promise<ResolvedEditor> {\n\t\t// Update the flattened editors\n\t\tthis._flattenedEditors = this._flattenEditorsMap();\n\n\t\t// Special case: side by side editors requires us to\n\t\t// independently resolve both sides and then build\n\t\t// a side by side editor with the result\n\t\tif (isResourceSideBySideEditorInput(editor)) {\n\t\t\treturn this.doResolveSideBySideEditor(editor, preferredGroup);\n\t\t}\n\n\t\tlet resolvedUntypedAndGroup: [IUntypedEditorInput, IEditorGroup, EditorActivation | undefined] | undefined;\n\t\tconst resolvedUntypedAndGroupResult = this.resolveUntypedInputAndGroup(editor, preferredGroup);\n\t\tif (resolvedUntypedAndGroupResult instanceof Promise) {\n\t\t\tresolvedUntypedAndGroup = await resolvedUntypedAndGroupResult;\n\t\t} else {\n\t\t\tresolvedUntypedAndGroup = resolvedUntypedAndGroupResult;\n\t\t}\n\n\t\tif (!resolvedUntypedAndGroup) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t}\n\t\t// Get the resolved untyped editor, group, and activation\n\t\tconst [untypedEditor, group, activation] = resolvedUntypedAndGroup;\n\t\tif (activation) {\n\t\t\tuntypedEditor.options = { ...untypedEditor.options, activation };\n\t\t}\n\n\t\tlet resource = EditorResourceAccessor.getCanonicalUri(untypedEditor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\n\t\t// If it was resolved before we await for the extensions to activate and then proceed with resolution or else the backing extensions won't be registered\n\t\tif (this.cache && resource && this.resourceMatchesCache(resource)) {\n\t\t\tawait this.extensionService.whenInstalledExtensionsRegistered();\n\t\t}\n\n\t\t// Undefined resource -> untilted. Other malformed URI's are unresolvable\n\t\tif (resource === undefined) {\n\t\t\tresource = URI.from({ scheme: Schemas.untitled });\n\t\t} else if (resource.scheme === undefined || resource === null) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t}\n\n\t\tif (untypedEditor.options?.override === EditorResolution.PICK) {\n\t\t\tconst picked = await this.doPickEditor(untypedEditor);\n\t\t\t// If the picker was cancelled we will stop resolving the editor\n\t\t\tif (!picked) {\n\t\t\t\treturn ResolvedStatus.ABORT;\n\t\t\t}\n\t\t\t// Populate the options with the new ones\n\t\t\tuntypedEditor.options = picked;\n\t\t}\n\n\t\t// Resolved the editor ID as much as possible, now find a given editor (cast here is ok because we resolve down to a string above)\n\t\tlet { editor: selectedEditor, conflictingDefault } = this.getEditor(resource, untypedEditor.options?.override as (string | EditorResolution.EXCLUSIVE_ONLY | undefined));\n\t\t// If no editor was found and this was a typed editor or an editor with an explicit override we could not resolve it\n\t\tif (!selectedEditor && (untypedEditor.options?.override || isEditorInputWithOptions(editor))) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t} else if (!selectedEditor) {\n\t\t\t// Simple untyped editors that we could not resolve will be resolved to the default editor\n\t\t\tconst resolvedEditor = this.getEditor(resource, DEFAULT_EDITOR_ASSOCIATION.id);\n\t\t\tselectedEditor = resolvedEditor?.editor;\n\t\t\tconflictingDefault = resolvedEditor?.conflictingDefault;\n\t\t\tif (!selectedEditor) {\n\t\t\t\treturn ResolvedStatus.NONE;\n\t\t\t}\n\t\t}\n\n\t\t// In the special case of diff editors we do some more work to determine the correct editor for both sides\n\t\tif (isResourceDiffEditorInput(untypedEditor) && untypedEditor.options?.override === undefined) {\n\t\t\tlet resource2 = EditorResourceAccessor.getCanonicalUri(untypedEditor, { supportSideBySide: SideBySideEditor.SECONDARY });\n\t\t\tif (!resource2) {\n\t\t\t\tresource2 = URI.from({ scheme: Schemas.untitled });\n\t\t\t}\n\t\t\tconst { editor: selectedEditor2 } = this.getEditor(resource2, undefined);\n\t\t\tif (!selectedEditor2 || selectedEditor.editorInfo.id !== selectedEditor2.editorInfo.id) {\n\t\t\t\tconst { editor: selectedDiff, conflictingDefault: conflictingDefaultDiff } = this.getEditor(resource, DEFAULT_EDITOR_ASSOCIATION.id);\n\t\t\t\tselectedEditor = selectedDiff;\n\t\t\t\tconflictingDefault = conflictingDefaultDiff;\n\t\t\t}\n\t\t\tif (!selectedEditor) {\n\t\t\t\treturn ResolvedStatus.NONE;\n\t\t\t}\n\t\t}\n\n\t\t// If no override we take the selected editor id so that matches works with the isActive check\n\t\tuntypedEditor.options = { override: selectedEditor.editorInfo.id, ...untypedEditor.options };\n\n\t\t// Check if diff can be created based on prescene of factory function\n\t\tif (selectedEditor.editorFactoryObject.createDiffEditorInput === undefined && isResourceDiffEditorInput(untypedEditor)) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t}\n\n\t\tconst input = await this.doResolveEditor(untypedEditor, group, selectedEditor);\n\t\tif (conflictingDefault && input) {\n\t\t\t// Show the conflicting default dialog\n\t\t\tawait this.doHandleConflictingDefaults(resource, selectedEditor.editorInfo.label, untypedEditor, input.editor, group);\n\t\t}\n\n\t\tif (input) {\n\t\t\tif (input.editor.editorId !== selectedEditor.editorInfo.id) {\n\t\t\t\tthis.logService.warn(`Editor ID Mismatch: ${input.editor.editorId} !== ${selectedEditor.editorInfo.id}. This will cause bugs. Please ensure editorInput.editorId matches the registered id`);\n\t\t\t}\n\t\t\treturn { ...input, group };\n\t\t}\n\t\treturn ResolvedStatus.ABORT;\n\t}\n\n\tprivate async doResolveSideBySideEditor(editor: IResourceSideBySideEditorInput, preferredGroup: PreferredGroup | undefined): Promise<ResolvedEditor> {\n\t\tconst primaryResolvedEditor = await this.resolveEditor(editor.primary, preferredGroup);\n\t\tif (!isEditorInputWithOptionsAndGroup(primaryResolvedEditor)) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t}\n\t\tconst secondaryResolvedEditor = await this.resolveEditor(editor.secondary, primaryResolvedEditor.group ?? preferredGroup);\n\t\tif (!isEditorInputWithOptionsAndGroup(secondaryResolvedEditor)) {\n\t\t\treturn ResolvedStatus.NONE;\n\t\t}\n\t\treturn {\n\t\t\tgroup: primaryResolvedEditor.group ?? secondaryResolvedEditor.group,\n\t\t\teditor: this.instantiationService.createInstance(SideBySideEditorInput, editor.label, editor.description, secondaryResolvedEditor.editor, primaryResolvedEditor.editor),\n\t\t\toptions: editor.options\n\t\t};\n\t}\n\n\tbufferChangeEvents(callback: Function): void {\n\t\tthis._onDidChangeEditorRegistrations.pause();\n\t\ttry {\n\t\t\tcallback();\n\t\t} finally {\n\t\t\tthis._onDidChangeEditorRegistrations.resume();\n\t\t}\n\t}\n\n\tregisterEditor(\n\t\tglobPattern: string | glob.IRelativePattern,\n\t\teditorInfo: RegisteredEditorInfo,\n\t\toptions: RegisteredEditorOptions,\n\t\teditorFactoryObject: EditorInputFactoryObject\n\t): IDisposable {\n\t\tlet registeredEditor = this._editors.get(globPattern);\n\t\tif (registeredEditor === undefined) {\n\t\t\tregisteredEditor = new Map<string, RegisteredEditors>();\n\t\t\tthis._editors.set(globPattern, registeredEditor);\n\t\t}\n\n\t\tlet editorsWithId = registeredEditor.get(editorInfo.id);\n\t\tif (editorsWithId === undefined) {\n\t\t\teditorsWithId = [];\n\t\t}\n\t\tconst remove = insert(editorsWithId, {\n\t\t\tglobPattern,\n\t\t\teditorInfo,\n\t\t\toptions,\n\t\t\teditorFactoryObject\n\t\t});\n\t\tregisteredEditor.set(editorInfo.id, editorsWithId);\n\t\tthis._shouldReFlattenEditors = true;\n\t\tthis._onDidChangeEditorRegistrations.fire();\n\t\treturn toDisposable(() => {\n\t\t\tremove();\n\t\t\tif (editorsWithId && editorsWithId.length === 0) {\n\t\t\t\tregisteredEditor?.delete(editorInfo.id);\n\t\t\t}\n\t\t\tthis._shouldReFlattenEditors = true;\n\t\t\tthis._onDidChangeEditorRegistrations.fire();\n\t\t});\n\t}\n\n\tgetAssociationsForResource(resource: URI): EditorAssociations {\n\t\tconst associations = this.getAllUserAssociations();\n\t\tlet matchingAssociations = associations.filter(association => association.filenamePattern && globMatchesResource(association.filenamePattern, resource));\n\t\t// Sort matching associations based on glob length as a longer glob will be more specific\n\t\tmatchingAssociations = matchingAssociations.sort((a, b) => (b.filenamePattern?.length ?? 0) - (a.filenamePattern?.length ?? 0));\n\t\tconst allEditors: RegisteredEditors = this._registeredEditors;\n\t\t// Ensure that the settings are valid editors\n\t\treturn matchingAssociations.filter(association => allEditors.find(c => c.editorInfo.id === association.viewType));\n\t}\n\n\tgetAllUserAssociations(): EditorAssociations {\n\t\tconst inspectedEditorAssociations = this.configurationService.inspect<{ [fileNamePattern: string]: string }>(editorsAssociationsSettingId) || {};\n\t\tconst defaultAssociations = inspectedEditorAssociations.defaultValue ?? {};\n\t\tconst workspaceAssociations = inspectedEditorAssociations.workspaceValue ?? {};\n\t\tconst userAssociations = inspectedEditorAssociations.userValue ?? {};\n\t\tconst rawAssociations: { [fileNamePattern: string]: string } = { ...workspaceAssociations };\n\t\t// We want to apply the default associations and user associations on top of the workspace associations but ignore duplicate keys.\n\t\tfor (const [key, value] of Object.entries({ ...defaultAssociations, ...userAssociations })) {\n\t\t\tif (rawAssociations[key] === undefined) {\n\t\t\t\trawAssociations[key] = value;\n\t\t\t}\n\t\t}\n\t\tconst associations = [];\n\t\tfor (const [key, value] of Object.entries(rawAssociations)) {\n\t\t\tconst association: EditorAssociation = {\n\t\t\t\tfilenamePattern: key,\n\t\t\t\tviewType: value\n\t\t\t};\n\t\t\tassociations.push(association);\n\t\t}\n\t\treturn associations;\n\t}\n\n\t/**\n\t * Given the nested nature of the editors map, we merge factories of the same glob and id to make it flat\n\t * and easier to work with\n\t */\n\tprivate _flattenEditorsMap() {\n\t\t// If we shouldn't be re-flattening (due to lack of update) then return early\n\t\tif (!this._shouldReFlattenEditors) {\n\t\t\treturn this._flattenedEditors;\n\t\t}\n\t\tthis._shouldReFlattenEditors = false;\n\t\tconst editors = new Map<string | glob.IRelativePattern, RegisteredEditors>();\n\t\tfor (const [glob, value] of this._editors) {\n\t\t\tconst registeredEditors: RegisteredEditors = [];\n\t\t\tfor (const editors of value.values()) {\n\t\t\t\tlet registeredEditor: RegisteredEditor | undefined = undefined;\n\t\t\t\t// Merge all editors with the same id and glob pattern together\n\t\t\t\tfor (const editor of editors) {\n\t\t\t\t\tif (!registeredEditor) {\n\t\t\t\t\t\tregisteredEditor = {\n\t\t\t\t\t\t\teditorInfo: editor.editorInfo,\n\t\t\t\t\t\t\tglobPattern: editor.globPattern,\n\t\t\t\t\t\t\toptions: {},\n\t\t\t\t\t\t\teditorFactoryObject: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\t// Merge options and factories\n\t\t\t\t\tregisteredEditor.options = { ...registeredEditor.options, ...editor.options };\n\t\t\t\t\tregisteredEditor.editorFactoryObject = { ...registeredEditor.editorFactoryObject, ...editor.editorFactoryObject };\n\t\t\t\t}\n\t\t\t\tif (registeredEditor) {\n\t\t\t\t\tregisteredEditors.push(registeredEditor);\n\t\t\t\t}\n\t\t\t}\n\t\t\teditors.set(glob, registeredEditors);\n\t\t}\n\t\treturn editors;\n\t}\n\n\t/**\n\t * Returns all editors as an array. Possible to contain duplicates\n\t */\n\tprivate get _registeredEditors(): RegisteredEditors {\n\t\treturn Array.from(this._flattenedEditors.values()).flat();\n\t}\n\n\tupdateUserAssociations(globPattern: string, editorID: string): void {\n\t\tconst newAssociation: EditorAssociation = { viewType: editorID, filenamePattern: globPattern };\n\t\tconst currentAssociations = this.getAllUserAssociations();\n\t\tconst newSettingObject = Object.create(null);\n\t\t// Form the new setting object including the newest associations\n\t\tfor (const association of [...currentAssociations, newAssociation]) {\n\t\t\tif (association.filenamePattern) {\n\t\t\t\tnewSettingObject[association.filenamePattern] = association.viewType;\n\t\t\t}\n\t\t}\n\t\tthis.configurationService.updateValue(editorsAssociationsSettingId, newSettingObject);\n\t}\n\n\tprivate findMatchingEditors(resource: URI): RegisteredEditor[] {\n\t\t// The user setting should be respected even if the editor doesn't specify that resource in package.json\n\t\tconst userSettings = this.getAssociationsForResource(resource);\n\t\tconst matchingEditors: RegisteredEditor[] = [];\n\t\t// Then all glob patterns\n\t\tfor (const [key, editors] of this._flattenedEditors) {\n\t\t\tfor (const editor of editors) {\n\t\t\t\tconst foundInSettings = userSettings.find(setting => setting.viewType === editor.editorInfo.id);\n\t\t\t\tif ((foundInSettings && editor.editorInfo.priority !== RegisteredEditorPriority.exclusive) || globMatchesResource(key, resource)) {\n\t\t\t\t\tmatchingEditors.push(editor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Return the editors sorted by their priority\n\t\treturn matchingEditors.sort((a, b) => {\n\t\t\t// Very crude if priorities match longer glob wins as longer globs are normally more specific\n\t\t\tif (priorityToRank(b.editorInfo.priority) === priorityToRank(a.editorInfo.priority) && typeof b.globPattern === 'string' && typeof a.globPattern === 'string') {\n\t\t\t\treturn b.globPattern.length - a.globPattern.length;\n\t\t\t}\n\t\t\treturn priorityToRank(b.editorInfo.priority) - priorityToRank(a.editorInfo.priority);\n\t\t});\n\t}\n\n\tpublic getEditors(resource?: URI): RegisteredEditorInfo[] {\n\t\tthis._flattenedEditors = this._flattenEditorsMap();\n\n\t\t// By resource\n\t\tif (URI.isUri(resource)) {\n\t\t\tconst editors = this.findMatchingEditors(resource);\n\t\t\tif (editors.find(e => e.editorInfo.priority === RegisteredEditorPriority.exclusive)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\treturn editors.map(editor => editor.editorInfo);\n\t\t}\n\n\t\t// All\n\t\treturn distinct(this._registeredEditors.map(editor => editor.editorInfo), editor => editor.id);\n\t}\n\n\t/**\n\t * Given a resource and an editorId selects the best possible editor\n\t * @returns The editor and whether there was another default which conflicted with it\n\t */\n\tprivate getEditor(resource: URI, editorId: string | EditorResolution.EXCLUSIVE_ONLY | undefined): { editor: RegisteredEditor | undefined; conflictingDefault: boolean } {\n\n\t\tconst findMatchingEditor = (editors: RegisteredEditors, viewType: string) => {\n\t\t\treturn editors.find((editor) => {\n\t\t\t\tif (editor.options?.canSupportResource !== undefined) {\n\t\t\t\t\treturn editor.editorInfo.id === viewType && editor.options.canSupportResource(resource);\n\t\t\t\t}\n\t\t\t\treturn editor.editorInfo.id === viewType;\n\t\t\t});\n\t\t};\n\n\t\tif (editorId && editorId !== EditorResolution.EXCLUSIVE_ONLY) {\n\t\t\t// Specific id passed in doesn't have to match the resource, it can be anything\n\t\t\tconst registeredEditors = this._registeredEditors;\n\t\t\treturn {\n\t\t\t\teditor: findMatchingEditor(registeredEditors, editorId),\n\t\t\t\tconflictingDefault: false\n\t\t\t};\n\t\t}\n\n\t\tconst editors = this.findMatchingEditors(resource);\n\n\t\tconst associationsFromSetting = this.getAssociationsForResource(resource);\n\t\t// We only want minPriority+ if no user defined setting is found, else we won't resolve an editor\n\t\tconst minPriority = editorId === EditorResolution.EXCLUSIVE_ONLY ? RegisteredEditorPriority.exclusive : RegisteredEditorPriority.builtin;\n\t\tlet possibleEditors = editors.filter(editor => priorityToRank(editor.editorInfo.priority) >= priorityToRank(minPriority) && editor.editorInfo.id !== DEFAULT_EDITOR_ASSOCIATION.id);\n\t\tif (possibleEditors.length === 0) {\n\t\t\treturn {\n\t\t\t\teditor: associationsFromSetting[0] && minPriority !== RegisteredEditorPriority.exclusive ? findMatchingEditor(editors, associationsFromSetting[0].viewType) : undefined,\n\t\t\t\tconflictingDefault: false\n\t\t\t};\n\t\t}\n\t\t// If the editor is exclusive we use that, else use the user setting, else we check canSupportResource, else take the viewtype of first possible editor\n\t\tconst selectedViewType = possibleEditors[0].editorInfo.priority === RegisteredEditorPriority.exclusive ?\n\t\t\tpossibleEditors[0].editorInfo.id :\n\t\t\tassociationsFromSetting[0]?.viewType ||\n\t\t\t(possibleEditors.find(editor => (!editor.options?.canSupportResource || editor.options.canSupportResource(resource)))?.editorInfo.id) ||\n\t\t\tpossibleEditors[0].editorInfo.id;\n\n\t\tlet conflictingDefault = false;\n\n\t\t// Filter out exclusive before we check for conflicts as exclusive editors cannot be manually chosen\n\t\t// similar to above, need to check canSupportResource if nothing is exclusive\n\t\tpossibleEditors = possibleEditors\n\t\t\t.filter(editor => editor.editorInfo.priority !== RegisteredEditorPriority.exclusive)\n\t\t\t.filter(editor => !editor.options?.canSupportResource || editor.options.canSupportResource(resource));\n\t\tif (associationsFromSetting.length === 0 && possibleEditors.length > 1) {\n\t\t\tconflictingDefault = true;\n\t\t}\n\n\t\treturn {\n\t\t\teditor: findMatchingEditor(editors, selectedViewType),\n\t\t\tconflictingDefault\n\t\t};\n\t}\n\n\tprivate async doResolveEditor(editor: IUntypedEditorInput, group: IEditorGroup, selectedEditor: RegisteredEditor): Promise<EditorInputWithOptions | undefined> {\n\t\tlet options = editor.options;\n\t\tconst resource = EditorResourceAccessor.getCanonicalUri(editor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t// If no activation option is provided, populate it.\n\t\tif (options && typeof options.activation === 'undefined') {\n\t\t\toptions = { ...options, activation: options.preserveFocus ? EditorActivation.RESTORE : undefined };\n\t\t}\n\n\t\t// If it's a merge editor we trigger the create merge editor input\n\t\tif (isResourceMergeEditorInput(editor)) {\n\t\t\tif (!selectedEditor.editorFactoryObject.createMergeEditorInput) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst inputWithOptions = await selectedEditor.editorFactoryObject.createMergeEditorInput(editor, group);\n\t\t\treturn { editor: inputWithOptions.editor, options: inputWithOptions.options ?? options };\n\t\t}\n\n\t\t// If it's a diff editor we trigger the create diff editor input\n\t\tif (isResourceDiffEditorInput(editor)) {\n\t\t\tif (!selectedEditor.editorFactoryObject.createDiffEditorInput) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst inputWithOptions = await selectedEditor.editorFactoryObject.createDiffEditorInput(editor, group);\n\t\t\treturn { editor: inputWithOptions.editor, options: inputWithOptions.options ?? options };\n\t\t}\n\n\t\t// If it's a diff list editor we trigger the create diff list editor input\n\t\tif (isResourceMultiDiffEditorInput(editor)) {\n\t\t\tif (!selectedEditor.editorFactoryObject.createMultiDiffEditorInput) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst inputWithOptions = await selectedEditor.editorFactoryObject.createMultiDiffEditorInput(editor, group);\n\t\t\treturn { editor: inputWithOptions.editor, options: inputWithOptions.options ?? options };\n\t\t}\n\n\t\tif (isResourceSideBySideEditorInput(editor)) {\n\t\t\tthrow new Error(`Untyped side by side editor input not supported here.`);\n\t\t}\n\n\t\tif (isUntitledResourceEditorInput(editor)) {\n\t\t\tif (!selectedEditor.editorFactoryObject.createUntitledEditorInput) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst inputWithOptions = await selectedEditor.editorFactoryObject.createUntitledEditorInput(editor, group);\n\t\t\treturn { editor: inputWithOptions.editor, options: inputWithOptions.options ?? options };\n\t\t}\n\n\t\t// Should no longer have an undefined resource so lets throw an error if that's somehow the case\n\t\tif (resource === undefined) {\n\t\t\tthrow new Error(`Undefined resource on non untitled editor input.`);\n\t\t}\n\n\t\t// If the editor states it can only be opened once per resource we must close all existing ones except one and move the new one into the group\n\t\tconst singleEditorPerResource = typeof selectedEditor.options?.singlePerResource === 'function' ? selectedEditor.options.singlePerResource() : selectedEditor.options?.singlePerResource;\n\t\tif (singleEditorPerResource) {\n\t\t\tconst existingEditors = this.findExistingEditorsForResource(resource, selectedEditor.editorInfo.id);\n\t\t\tif (existingEditors.length) {\n\t\t\t\tconst editor = await this.moveExistingEditorForResource(existingEditors, group);\n\t\t\t\tif (editor) {\n\t\t\t\t\treturn { editor, options };\n\t\t\t\t} else {\n\t\t\t\t\treturn; // failed to move\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If no factory is above, return flow back to caller letting them know we could not resolve it\n\t\tif (!selectedEditor.editorFactoryObject.createEditorInput) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Respect options passed back\n\t\tconst inputWithOptions = await selectedEditor.editorFactoryObject.createEditorInput(editor, group);\n\t\toptions = inputWithOptions.options ?? options;\n\t\tconst input = inputWithOptions.editor;\n\n\t\treturn { editor: input, options };\n\t}\n\n\t/**\n\t * Moves the first existing editor for a resource to the target group unless already opened there.\n\t * Additionally will close any other editors that are open for that resource and viewtype besides the first one found\n\t * @param resource The resource of the editor\n\t * @param viewType the viewtype of the editor\n\t * @param targetGroup The group to move it to\n\t * @returns The moved editor input or `undefined` if the editor could not be moved\n\t */\n\tprivate async moveExistingEditorForResource(\n\t\texistingEditorsForResource: Array<{ editor: EditorInput; group: IEditorGroup }>,\n\t\ttargetGroup: IEditorGroup,\n\t): Promise<EditorInput | undefined> {\n\t\tconst editorToUse = existingEditorsForResource[0];\n\n\t\t// We should only have one editor but if there are multiple we close the others\n\t\tfor (const { editor, group } of existingEditorsForResource) {\n\t\t\tif (editor !== editorToUse.editor) {\n\t\t\t\tconst closed = await group.closeEditor(editor);\n\t\t\t\tif (!closed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Move the editor already opened to the target group\n\t\tif (targetGroup.id !== editorToUse.group.id) {\n\t\t\tconst moved = editorToUse.group.moveEditor(editorToUse.editor, targetGroup);\n\t\t\tif (!moved) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\treturn editorToUse.editor;\n\t}\n\n\t/**\n\t * Given a resource and an editorId, returns all editors open for that resource and editorId.\n\t * @param resource The resource specified\n\t * @param editorId The editorID\n\t * @returns A list of editors\n\t */\n\tprivate findExistingEditorsForResource(\n\t\tresource: URI,\n\t\teditorId: string,\n\t): Array<{ editor: EditorInput; group: IEditorGroup }> {\n\t\tconst out: Array<{ editor: EditorInput; group: IEditorGroup }> = [];\n\t\tconst orderedGroups = distinct([\n\t\t\t...this.editorGroupService.groups,\n\t\t]);\n\n\t\tfor (const group of orderedGroups) {\n\t\t\tfor (const editor of group.editors) {\n\t\t\t\tif (isEqual(editor.resource, resource) && editor.editorId === editorId) {\n\t\t\t\t\tout.push({ editor, group });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn out;\n\t}\n\n\tprivate async doHandleConflictingDefaults(resource: URI, editorName: string, untypedInput: IUntypedEditorInput, currentEditor: EditorInput, group: IEditorGroup) {\n\t\ttype StoredChoice = {\n\t\t\t[key: string]: string[];\n\t\t};\n\t\tconst editors = this.findMatchingEditors(resource);\n\t\tconst storedChoices: StoredChoice = JSON.parse(this.storageService.get(EditorResolverService.conflictingDefaultsStorageID, StorageScope.PROFILE, '{}'));\n\t\tconst globForResource = `*${extname(resource)}`;\n\t\t// Writes to the storage service that a choice has been made for the currently installed editors\n\t\tconst writeCurrentEditorsToStorage = () => {\n\t\t\tstoredChoices[globForResource] = [];\n\t\t\teditors.forEach(editor => storedChoices[globForResource].push(editor.editorInfo.id));\n\t\t\tthis.storageService.store(EditorResolverService.conflictingDefaultsStorageID, JSON.stringify(storedChoices), StorageScope.PROFILE, StorageTarget.MACHINE);\n\t\t};\n\n\t\t// If the user has already made a choice for this editor we don't want to ask them again\n\t\tif (storedChoices[globForResource]?.find(editorID => editorID === currentEditor.editorId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handle = this.notificationService.prompt(Severity.Warning,\n\t\t\tlocalize('editorResolver.conflictingDefaults', 'There are multiple default editors available for the resource.'),\n\t\t\t[{\n\t\t\t\tlabel: localize('editorResolver.configureDefault', 'Configure Default'),\n\t\t\t\trun: async () => {\n\t\t\t\t\t// Show the picker and tell it to update the setting to whatever the user selected\n\t\t\t\t\tconst picked = await this.doPickEditor(untypedInput, true);\n\t\t\t\t\tif (!picked) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tuntypedInput.options = picked;\n\t\t\t\t\tconst replacementEditor = await this.resolveEditor(untypedInput, group);\n\t\t\t\t\tif (replacementEditor === ResolvedStatus.ABORT || replacementEditor === ResolvedStatus.NONE) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Replace the current editor with the picked one\n\t\t\t\t\tgroup.replaceEditors([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: currentEditor,\n\t\t\t\t\t\t\treplacement: replacementEditor.editor,\n\t\t\t\t\t\t\toptions: replacementEditor.options ?? picked,\n\t\t\t\t\t\t}\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize('editorResolver.keepDefault', 'Keep {0}', editorName),\n\t\t\t\trun: writeCurrentEditorsToStorage\n\t\t\t}\n\t\t\t]);\n\t\t// If the user pressed X we assume they want to keep the current editor as default\n\t\tconst onCloseListener = handle.onDidClose(() => {\n\t\t\twriteCurrentEditorsToStorage();\n\t\t\tonCloseListener.dispose();\n\t\t});\n\t}\n\n\tprivate mapEditorsToQuickPickEntry(resource: URI, showDefaultPicker?: boolean) {\n\t\tconst currentEditor = this.editorGroupService.activeGroup.findEditors(resource).at(0);\n\t\t// If untitled, we want all registered editors\n\t\tlet registeredEditors = resource.scheme === Schemas.untitled ? this._registeredEditors.filter(e => e.editorInfo.priority !== RegisteredEditorPriority.exclusive) : this.findMatchingEditors(resource);\n\t\t// We don't want duplicate Id entries\n\t\tregisteredEditors = distinct(registeredEditors, c => c.editorInfo.id);\n\t\tconst defaultSetting = this.getAssociationsForResource(resource)[0]?.viewType;\n\t\t// Not the most efficient way to do this, but we want to ensure the text editor is at the top of the quickpick\n\t\tregisteredEditors = registeredEditors.sort((a, b) => {\n\t\t\tif (a.editorInfo.id === DEFAULT_EDITOR_ASSOCIATION.id) {\n\t\t\t\treturn -1;\n\t\t\t} else if (b.editorInfo.id === DEFAULT_EDITOR_ASSOCIATION.id) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn priorityToRank(b.editorInfo.priority) - priorityToRank(a.editorInfo.priority);\n\t\t\t}\n\t\t});\n\t\tconst quickPickEntries: Array<QuickPickItem> = [];\n\t\tconst currentlyActiveLabel = localize('promptOpenWith.currentlyActive', \"Active\");\n\t\tconst currentDefaultLabel = localize('promptOpenWith.currentDefault', \"Default\");\n\t\tconst currentDefaultAndActiveLabel = localize('promptOpenWith.currentDefaultAndActive', \"Active and Default\");\n\t\t// Default order = setting -> highest priority -> text\n\t\tlet defaultViewType = defaultSetting;\n\t\tif (!defaultViewType && registeredEditors.length > 2 && registeredEditors[1]?.editorInfo.priority !== RegisteredEditorPriority.option) {\n\t\t\tdefaultViewType = registeredEditors[1]?.editorInfo.id;\n\t\t}\n\t\tif (!defaultViewType) {\n\t\t\tdefaultViewType = DEFAULT_EDITOR_ASSOCIATION.id;\n\t\t}\n\t\t// Map the editors to quickpick entries\n\t\tregisteredEditors.forEach(editor => {\n\t\t\tconst currentViewType = currentEditor?.editorId ?? DEFAULT_EDITOR_ASSOCIATION.id;\n\t\t\tconst isActive = currentEditor ? editor.editorInfo.id === currentViewType : false;\n\t\t\tconst isDefault = editor.editorInfo.id === defaultViewType;\n\t\t\tconst quickPickEntry: IQuickPickItem = {\n\t\t\t\tid: editor.editorInfo.id,\n\t\t\t\tlabel: editor.editorInfo.label,\n\t\t\t\tdescription: isActive && isDefault ? currentDefaultAndActiveLabel : isActive ? currentlyActiveLabel : isDefault ? currentDefaultLabel : undefined,\n\t\t\t\tdetail: editor.editorInfo.detail ?? editor.editorInfo.priority,\n\t\t\t};\n\t\t\tquickPickEntries.push(quickPickEntry);\n\t\t});\n\t\tif (!showDefaultPicker && extname(resource) !== '') {\n\t\t\tconst separator: IQuickPickSeparator = { type: 'separator' };\n\t\t\tquickPickEntries.push(separator);\n\t\t\tconst configureDefaultEntry = {\n\t\t\t\tid: EditorResolverService.configureDefaultID,\n\t\t\t\tlabel: localize('promptOpenWith.configureDefault', \"Configure default editor for '{0}'...\", `*${extname(resource)}`),\n\t\t\t};\n\t\t\tquickPickEntries.push(configureDefaultEntry);\n\t\t}\n\t\treturn quickPickEntries;\n\t}\n\n\tprivate async doPickEditor(editor: IUntypedEditorInput, showDefaultPicker?: boolean): Promise<IEditorOptions | undefined> {\n\n\t\ttype EditorPick = {\n\t\t\treadonly item: IQuickPickItem;\n\t\t\treadonly keyMods?: IKeyMods;\n\t\t\treadonly openInBackground: boolean;\n\t\t};\n\n\t\tlet resource = EditorResourceAccessor.getOriginalUri(editor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\n\t\tif (resource === undefined) {\n\t\t\tresource = URI.from({ scheme: Schemas.untitled });\n\t\t}\n\n\t\t// Get all the editors for the resource as quickpick entries\n\t\tconst editorPicks = this.mapEditorsToQuickPickEntry(resource, showDefaultPicker);\n\n\t\t// Create the editor picker\n\t\tconst disposables = new DisposableStore();\n\t\tconst editorPicker = disposables.add(this.quickInputService.createQuickPick<IQuickPickItem>({ useSeparators: true }));\n\t\tconst placeHolderMessage = showDefaultPicker ?\n\t\t\tlocalize('promptOpenWith.updateDefaultPlaceHolder', \"Select new default editor for '{0}'\", `*${extname(resource)}`) :\n\t\t\tlocalize('promptOpenWith.placeHolder', \"Select editor for '{0}'\", basename(resource));\n\t\teditorPicker.placeholder = placeHolderMessage;\n\t\teditorPicker.canAcceptInBackground = true;\n\t\teditorPicker.items = editorPicks;\n\t\tconst firstItem = editorPicker.items.find(item => item.type === 'item') as IQuickPickItem | undefined;\n\t\tif (firstItem) {\n\t\t\teditorPicker.selectedItems = [firstItem];\n\t\t}\n\n\t\t// Prompt the user to select an editor\n\t\tconst picked: EditorPick | undefined = await new Promise<EditorPick | undefined>(resolve => {\n\t\t\tdisposables.add(editorPicker.onDidAccept(e => {\n\t\t\t\tlet result: EditorPick | undefined = undefined;\n\n\t\t\t\tif (editorPicker.selectedItems.length === 1) {\n\t\t\t\t\tresult = {\n\t\t\t\t\t\titem: editorPicker.selectedItems[0],\n\t\t\t\t\t\tkeyMods: editorPicker.keyMods,\n\t\t\t\t\t\topenInBackground: e.inBackground\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// If asked to always update the setting then update it even if the gear isn't clicked\n\t\t\t\tif (resource && showDefaultPicker && result?.item.id) {\n\t\t\t\t\tthis.updateUserAssociations(`*${extname(resource)}`, result.item.id,);\n\t\t\t\t}\n\n\t\t\t\tresolve(result);\n\t\t\t}));\n\n\t\t\tdisposables.add(editorPicker.onDidHide(() => {\n\t\t\t\tdisposables.dispose();\n\t\t\t\tresolve(undefined);\n\t\t\t}));\n\n\t\t\tdisposables.add(editorPicker.onDidTriggerItemButton(e => {\n\n\t\t\t\t// Trigger opening and close picker\n\t\t\t\tresolve({ item: e.item, openInBackground: false });\n\n\t\t\t\t// Persist setting\n\t\t\t\tif (resource && e.item?.id) {\n\t\t\t\t\tthis.updateUserAssociations(`*${extname(resource)}`, e.item.id,);\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\teditorPicker.show();\n\t\t});\n\n\t\t// Close picker\n\t\teditorPicker.dispose();\n\n\t\t// If the user picked an editor, look at how the picker was\n\t\t// used (e.g. modifier keys, open in background) and create the\n\t\t// options and group to use accordingly\n\t\tif (picked) {\n\n\t\t\t// If the user selected to configure default we trigger this picker again and tell it to show the default picker\n\t\t\tif (picked.item.id === EditorResolverService.configureDefaultID) {\n\t\t\t\treturn this.doPickEditor(editor, true);\n\t\t\t}\n\n\t\t\t// Figure out options\n\t\t\tconst targetOptions: IEditorOptions = {\n\t\t\t\t...editor.options,\n\t\t\t\toverride: picked.item.id,\n\t\t\t\tpreserveFocus: picked.openInBackground || editor.options?.preserveFocus,\n\t\t\t};\n\n\t\t\treturn targetOptions;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate cacheEditors() {\n\t\t// Create a set to store glob patterns\n\t\tconst cacheStorage: Set<string> = new Set<string>();\n\n\t\t// Store just the relative pattern pieces without any path info\n\t\tfor (const [globPattern, contribPoint] of this._flattenedEditors) {\n\t\t\tconst nonOptional = !!contribPoint.find(c => c.editorInfo.priority !== RegisteredEditorPriority.option && c.editorInfo.id !== DEFAULT_EDITOR_ASSOCIATION.id);\n\t\t\t// Don't keep a cache of the optional ones as those wouldn't be opened on start anyways\n\t\t\tif (!nonOptional) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (glob.isRelativePattern(globPattern)) {\n\t\t\t\tcacheStorage.add(`${globPattern.pattern}`);\n\t\t\t} else {\n\t\t\t\tcacheStorage.add(globPattern);\n\t\t\t}\n\t\t}\n\n\t\t// Also store the users settings as those would have to activate on startup as well\n\t\tconst userAssociations = this.getAllUserAssociations();\n\t\tfor (const association of userAssociations) {\n\t\t\tif (association.filenamePattern) {\n\t\t\t\tcacheStorage.add(association.filenamePattern);\n\t\t\t}\n\t\t}\n\t\tthis.storageService.store(EditorResolverService.cacheStorageID, JSON.stringify(Array.from(cacheStorage)), StorageScope.PROFILE, StorageTarget.MACHINE);\n\t}\n\n\tprivate resourceMatchesCache(resource: URI): boolean {\n\t\tif (!this.cache) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const cacheEntry of this.cache) {\n\t\t\tif (globMatchesResource(cacheEntry, resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\nregisterSingleton(IEditorResolverService, EditorResolverService, InstantiationType.Eager);\n"]}