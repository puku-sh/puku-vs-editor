{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/editor/browser/codeEditorService.ts","vs/workbench/services/editor/browser/codeEditorService.ts"],"names":[],"mappings":"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","file":"codeEditorService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ICodeEditor, isCodeEditor, isDiffEditor, isCompositeEditor, getCodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { AbstractCodeEditorService } from '../../../../editor/browser/services/abstractCodeEditorService.js';\nimport { ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { IResourceEditorInput } from '../../../../platform/editor/common/editor.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IWorkbenchEditorConfiguration } from '../../../common/editor.js';\nimport { ACTIVE_GROUP, IEditorService, SIDE_GROUP } from '../common/editorService.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { applyTextEditorOptions } from '../../../common/editor/editorOptions.js';\n\nexport class CodeEditorService extends AbstractCodeEditorService {\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(themeService);\n\n\t\tthis._register(this.registerCodeEditorOpenHandler(this.doOpenCodeEditor.bind(this)));\n\t\tthis._register(this.registerCodeEditorOpenHandler(this.doOpenCodeEditorFromDiff.bind(this)));\n\t}\n\n\tgetActiveCodeEditor(): ICodeEditor | null {\n\t\tconst activeTextEditorControl = this.editorService.activeTextEditorControl;\n\t\tif (isCodeEditor(activeTextEditorControl)) {\n\t\t\treturn activeTextEditorControl;\n\t\t}\n\n\t\tif (isDiffEditor(activeTextEditorControl)) {\n\t\t\treturn activeTextEditorControl.getModifiedEditor();\n\t\t}\n\n\t\tconst activeControl = this.editorService.activeEditorPane?.getControl();\n\t\tif (isCompositeEditor(activeControl) && isCodeEditor(activeControl.activeCodeEditor)) {\n\t\t\treturn activeControl.activeCodeEditor;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate async doOpenCodeEditorFromDiff(input: IResourceEditorInput, source: ICodeEditor | null, sideBySide?: boolean): Promise<ICodeEditor | null> {\n\n\t\t// Special case: If the active editor is a diff editor and the request to open originates and\n\t\t// targets the modified side of it, we just apply the request there to prevent opening the modified\n\t\t// side as separate editor.\n\t\tconst activeTextEditorControl = this.editorService.activeTextEditorControl;\n\t\tif (\n\t\t\t!sideBySide &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need the current active group to be the target\n\t\t\tisDiffEditor(activeTextEditorControl) && \t\t\t\t\t\t\t\t\t// we only support this for active text diff editors\n\t\t\tinput.options &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need options to apply\n\t\t\tinput.resource &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need a request resource to compare with\n\t\t\tsource === activeTextEditorControl.getModifiedEditor() && \t\t\t\t\t// we need the source of this request to be the modified side of the diff editor\n\t\t\tactiveTextEditorControl.getModel() &&\t\t\t\t\t\t\t\t\t\t// we need a target model to compare with\n\t\t\tisEqual(input.resource, activeTextEditorControl.getModel()?.modified.uri) \t// we need the input resources to match with modified side\n\t\t) {\n\t\t\tconst targetEditor = activeTextEditorControl.getModifiedEditor();\n\n\t\t\tapplyTextEditorOptions(input.options, targetEditor, ScrollType.Smooth);\n\n\t\t\treturn targetEditor;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// Open using our normal editor service\n\tprivate async doOpenCodeEditor(input: IResourceEditorInput, source: ICodeEditor | null, sideBySide?: boolean): Promise<ICodeEditor | null> {\n\n\t\t// Special case: we want to detect the request to open an editor that\n\t\t// is different from the current one to decide whether the current editor\n\t\t// should be pinned or not. This ensures that the source of a navigation\n\t\t// is not being replaced by the target. An example is \"Goto definition\"\n\t\t// that otherwise would replace the editor everytime the user navigates.\n\t\tconst enablePreviewFromCodeNavigation = this.configurationService.getValue<IWorkbenchEditorConfiguration>().workbench?.editor?.enablePreviewFromCodeNavigation;\n\t\tif (\n\t\t\t!enablePreviewFromCodeNavigation &&              \t// we only need to do this if the configuration requires it\n\t\t\tsource &&\t\t\t\t\t\t\t\t\t\t\t// we need to know the origin of the navigation\n\t\t\t!input.options?.pinned &&\t\t\t\t\t\t\t// we only need to look at preview editors that open\n\t\t\t!sideBySide &&\t\t\t\t\t\t\t\t\t\t// we only need to care if editor opens in same group\n\t\t\t!isEqual(source.getModel()?.uri, input.resource)\t// we only need to do this if the editor is about to change\n\t\t) {\n\t\t\tfor (const visiblePane of this.editorService.visibleEditorPanes) {\n\t\t\t\tif (getCodeEditor(visiblePane.getControl()) === source) {\n\t\t\t\t\tvisiblePane.group.pinEditor();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Open as editor\n\t\tconst control = await this.editorService.openEditor(input, sideBySide ? SIDE_GROUP : ACTIVE_GROUP);\n\t\tif (control) {\n\t\t\tconst widget = control.getControl();\n\t\t\tif (isCodeEditor(widget)) {\n\t\t\t\treturn widget;\n\t\t\t}\n\n\t\t\tif (isCompositeEditor(widget) && isCodeEditor(widget.activeCodeEditor)) {\n\t\t\t\treturn widget.activeCodeEditor;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nregisterSingleton(ICodeEditorService, CodeEditorService, InstantiationType.Delayed);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ICodeEditor, isCodeEditor, isDiffEditor, isCompositeEditor, getCodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { AbstractCodeEditorService } from '../../../../editor/browser/services/abstractCodeEditorService.js';\nimport { ScrollType } from '../../../../editor/common/editorCommon.js';\nimport { IResourceEditorInput } from '../../../../platform/editor/common/editor.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { IWorkbenchEditorConfiguration } from '../../../common/editor.js';\nimport { ACTIVE_GROUP, IEditorService, SIDE_GROUP } from '../common/editorService.js';\nimport { ICodeEditorService } from '../../../../editor/browser/services/codeEditorService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { applyTextEditorOptions } from '../../../common/editor/editorOptions.js';\n\nexport class CodeEditorService extends AbstractCodeEditorService {\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t) {\n\t\tsuper(themeService);\n\n\t\tthis._register(this.registerCodeEditorOpenHandler(this.doOpenCodeEditor.bind(this)));\n\t\tthis._register(this.registerCodeEditorOpenHandler(this.doOpenCodeEditorFromDiff.bind(this)));\n\t}\n\n\tgetActiveCodeEditor(): ICodeEditor | null {\n\t\tconst activeTextEditorControl = this.editorService.activeTextEditorControl;\n\t\tif (isCodeEditor(activeTextEditorControl)) {\n\t\t\treturn activeTextEditorControl;\n\t\t}\n\n\t\tif (isDiffEditor(activeTextEditorControl)) {\n\t\t\treturn activeTextEditorControl.getModifiedEditor();\n\t\t}\n\n\t\tconst activeControl = this.editorService.activeEditorPane?.getControl();\n\t\tif (isCompositeEditor(activeControl) && isCodeEditor(activeControl.activeCodeEditor)) {\n\t\t\treturn activeControl.activeCodeEditor;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate async doOpenCodeEditorFromDiff(input: IResourceEditorInput, source: ICodeEditor | null, sideBySide?: boolean): Promise<ICodeEditor | null> {\n\n\t\t// Special case: If the active editor is a diff editor and the request to open originates and\n\t\t// targets the modified side of it, we just apply the request there to prevent opening the modified\n\t\t// side as separate editor.\n\t\tconst activeTextEditorControl = this.editorService.activeTextEditorControl;\n\t\tif (\n\t\t\t!sideBySide &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need the current active group to be the target\n\t\t\tisDiffEditor(activeTextEditorControl) && \t\t\t\t\t\t\t\t\t// we only support this for active text diff editors\n\t\t\tinput.options &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need options to apply\n\t\t\tinput.resource &&\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// we need a request resource to compare with\n\t\t\tsource === activeTextEditorControl.getModifiedEditor() && \t\t\t\t\t// we need the source of this request to be the modified side of the diff editor\n\t\t\tactiveTextEditorControl.getModel() &&\t\t\t\t\t\t\t\t\t\t// we need a target model to compare with\n\t\t\tisEqual(input.resource, activeTextEditorControl.getModel()?.modified.uri) \t// we need the input resources to match with modified side\n\t\t) {\n\t\t\tconst targetEditor = activeTextEditorControl.getModifiedEditor();\n\n\t\t\tapplyTextEditorOptions(input.options, targetEditor, ScrollType.Smooth);\n\n\t\t\treturn targetEditor;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// Open using our normal editor service\n\tprivate async doOpenCodeEditor(input: IResourceEditorInput, source: ICodeEditor | null, sideBySide?: boolean): Promise<ICodeEditor | null> {\n\n\t\t// Special case: we want to detect the request to open an editor that\n\t\t// is different from the current one to decide whether the current editor\n\t\t// should be pinned or not. This ensures that the source of a navigation\n\t\t// is not being replaced by the target. An example is \"Goto definition\"\n\t\t// that otherwise would replace the editor everytime the user navigates.\n\t\tconst enablePreviewFromCodeNavigation = this.configurationService.getValue<IWorkbenchEditorConfiguration>().workbench?.editor?.enablePreviewFromCodeNavigation;\n\t\tif (\n\t\t\t!enablePreviewFromCodeNavigation &&              \t// we only need to do this if the configuration requires it\n\t\t\tsource &&\t\t\t\t\t\t\t\t\t\t\t// we need to know the origin of the navigation\n\t\t\t!input.options?.pinned &&\t\t\t\t\t\t\t// we only need to look at preview editors that open\n\t\t\t!sideBySide &&\t\t\t\t\t\t\t\t\t\t// we only need to care if editor opens in same group\n\t\t\t!isEqual(source.getModel()?.uri, input.resource)\t// we only need to do this if the editor is about to change\n\t\t) {\n\t\t\tfor (const visiblePane of this.editorService.visibleEditorPanes) {\n\t\t\t\tif (getCodeEditor(visiblePane.getControl()) === source) {\n\t\t\t\t\tvisiblePane.group.pinEditor();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Open as editor\n\t\tconst control = await this.editorService.openEditor(input, sideBySide ? SIDE_GROUP : ACTIVE_GROUP);\n\t\tif (control) {\n\t\t\tconst widget = control.getControl();\n\t\t\tif (isCodeEditor(widget)) {\n\t\t\t\treturn widget;\n\t\t\t}\n\n\t\t\tif (isCompositeEditor(widget) && isCodeEditor(widget.activeCodeEditor)) {\n\t\t\t\treturn widget.activeCodeEditor;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nregisterSingleton(ICodeEditorService, CodeEditorService, InstantiationType.Delayed);\n"]}