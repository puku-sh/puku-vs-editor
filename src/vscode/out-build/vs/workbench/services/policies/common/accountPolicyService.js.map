{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/policies/common/accountPolicyService.ts","vs/workbench/services/policies/common/accountPolicyService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;AAIhG,OAAO,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAC;AACrE,OAAO,EAAE,qBAAqB,EAAoC,MAAM,8CAA8C,CAAC;AACvH,OAAO,EAAE,sBAAsB,EAAE,MAAM,yCAAyC,CAAC;AAG1E,IAAM,oBAAoB,GAA1B,MAAM,oBAAqB,SAAQ,qBAAqB;IAI9D,YACc,UAAwC,EAC7B,qBAA8D;QAEtF,KAAK,EAAE,CAAC;QAHsB,eAAU,GAAV,UAAU,CAAa;QACZ,0BAAqB,GAArB,qBAAqB,CAAwB;QAJ/E,YAAO,GAA2B,IAAI,CAAC;QAQ9C,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,EAAE;aAC5C,IAAI,CAAC,OAAO,CAAC,EAAE;YACf,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;YACvB,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACtD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,qBAAqB,CAAC,yBAAyB,CAAC,OAAO,CAAC,EAAE;gBAC7E,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;gBACvB,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACvD,CAAC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAES,KAAK,CAAC,wBAAwB,CAAC,iBAAsD;QAC9F,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,sDAAsD,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,MAAM,qBAAqB,CAAC,CAAC;QACxI,MAAM,OAAO,GAAa,EAAE,CAAC;QAE7B,KAAK,MAAM,GAAG,IAAI,iBAAiB,EAAE,CAAC;YACrC,MAAM,MAAM,GAAG,iBAAiB,CAAC,GAAG,CAAC,CAAC;YACtC,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAC1F,IAAI,WAAW,KAAK,SAAS,EAAE,CAAC;gBAC/B,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,WAAW,EAAE,CAAC;oBAC5C,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;oBACpC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACnB,CAAC;YACF,CAAC;iBAAM,CAAC;gBACP,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC;oBAC5B,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;oBAC1B,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACnB,CAAC;YACF,CAAC;QACF,CAAC;QAED,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC;YACpB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC;IACF,CAAC;CACD,CAAA;AA7CY,oBAAoB;IAK9B,WAAA,WAAW,CAAA;IACX,WAAA,sBAAsB,CAAA;GANZ,oBAAoB,CA6ChC","file":"accountPolicyService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../../base/common/collections.js';\nimport { IDefaultAccount } from '../../../../base/common/defaultAccount.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition } from '../../../../platform/policy/common/policy.js';\nimport { IDefaultAccountService } from '../../accounts/common/defaultAccount.js';\n\n\nexport class AccountPolicyService extends AbstractPolicyService implements IPolicyService {\n\n\tprivate account: IDefaultAccount | null = null;\n\n\tconstructor(\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IDefaultAccountService private readonly defaultAccountService: IDefaultAccountService\n\t) {\n\t\tsuper();\n\n\t\tthis.defaultAccountService.getDefaultAccount()\n\t\t\t.then(account => {\n\t\t\t\tthis.account = account;\n\t\t\t\tthis._updatePolicyDefinitions(this.policyDefinitions);\n\t\t\t\tthis._register(this.defaultAccountService.onDidChangeDefaultAccount(account => {\n\t\t\t\t\tthis.account = account;\n\t\t\t\t\tthis._updatePolicyDefinitions(this.policyDefinitions);\n\t\t\t\t}));\n\t\t\t});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tthis.logService.trace(`AccountPolicyService#_updatePolicyDefinitions: Got ${Object.keys(policyDefinitions).length} policy definitions`);\n\t\tconst updated: string[] = [];\n\n\t\tfor (const key in policyDefinitions) {\n\t\t\tconst policy = policyDefinitions[key];\n\t\t\tconst policyValue = this.account && policy.value ? policy.value(this.account) : undefined;\n\t\t\tif (policyValue !== undefined) {\n\t\t\t\tif (this.policies.get(key) !== policyValue) {\n\t\t\t\t\tthis.policies.set(key, policyValue);\n\t\t\t\t\tupdated.push(key);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.policies.has(key)) {\n\t\t\t\t\tthis.policies.delete(key);\n\t\t\t\t\tupdated.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (updated.length) {\n\t\t\tthis._onDidChange.fire(updated);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../../base/common/collections.js';\nimport { IDefaultAccount } from '../../../../base/common/defaultAccount.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition } from '../../../../platform/policy/common/policy.js';\nimport { IDefaultAccountService } from '../../accounts/common/defaultAccount.js';\n\n\nexport class AccountPolicyService extends AbstractPolicyService implements IPolicyService {\n\n\tprivate account: IDefaultAccount | null = null;\n\n\tconstructor(\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IDefaultAccountService private readonly defaultAccountService: IDefaultAccountService\n\t) {\n\t\tsuper();\n\n\t\tthis.defaultAccountService.getDefaultAccount()\n\t\t\t.then(account => {\n\t\t\t\tthis.account = account;\n\t\t\t\tthis._updatePolicyDefinitions(this.policyDefinitions);\n\t\t\t\tthis._register(this.defaultAccountService.onDidChangeDefaultAccount(account => {\n\t\t\t\t\tthis.account = account;\n\t\t\t\t\tthis._updatePolicyDefinitions(this.policyDefinitions);\n\t\t\t\t}));\n\t\t\t});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tthis.logService.trace(`AccountPolicyService#_updatePolicyDefinitions: Got ${Object.keys(policyDefinitions).length} policy definitions`);\n\t\tconst updated: string[] = [];\n\n\t\tfor (const key in policyDefinitions) {\n\t\t\tconst policy = policyDefinitions[key];\n\t\t\tconst policyValue = this.account && policy.value ? policy.value(this.account) : undefined;\n\t\t\tif (policyValue !== undefined) {\n\t\t\t\tif (this.policies.get(key) !== policyValue) {\n\t\t\t\t\tthis.policies.set(key, policyValue);\n\t\t\t\t\tupdated.push(key);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.policies.has(key)) {\n\t\t\t\t\tthis.policies.delete(key);\n\t\t\t\t\tupdated.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (updated.length) {\n\t\t\tthis._onDidChange.fire(updated);\n\t\t}\n\t}\n}\n"]}