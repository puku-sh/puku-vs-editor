{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/services/policies/common/multiplexPolicyService.ts","vs/workbench/services/policies/common/multiplexPolicyService.ts"],"names":[],"mappings":"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","file":"multiplexPolicyService.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../../base/common/collections.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition, PolicyValue } from '../../../../platform/policy/common/policy.js';\n\nexport class MultiplexPolicyService extends AbstractPolicyService implements IPolicyService {\n\n\tconstructor(\n\t\tprivate readonly policyServices: ReadonlyArray<IPolicyService>,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\n\t\tthis.updatePolicies();\n\t\tthis._register(Event.any(...this.policyServices.map(service => service.onDidChange))(names => {\n\t\t\tthis.updatePolicies();\n\t\t\tthis._onDidChange.fire(names);\n\t\t}));\n\t}\n\n\toverride async updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<IStringDictionary<PolicyValue>> {\n\t\tawait this._updatePolicyDefinitions(policyDefinitions);\n\t\treturn Iterable.reduce(this.policies.entries(), (r, [name, value]) => ({ ...r, [name]: value }), {});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tawait Promise.all(this.policyServices.map(service => service.updatePolicyDefinitions(policyDefinitions)));\n\t\tthis.updatePolicies();\n\t}\n\n\tprivate updatePolicies(): void {\n\t\tthis.policies.clear();\n\t\tconst updated: string[] = [];\n\t\tfor (const service of this.policyServices) {\n\t\t\tconst definitions = service.policyDefinitions;\n\t\t\tfor (const name in definitions) {\n\t\t\t\tconst value = service.getPolicyValue(name);\n\t\t\t\tthis.policyDefinitions[name] = definitions[name];\n\t\t\t\tif (value !== undefined) {\n\t\t\t\t\tupdated.push(name);\n\t\t\t\t\tthis.policies.set(name, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check that no results have overlapping keys\n\t\tconst changed = new Set<string>();\n\t\tfor (const key of updated) {\n\t\t\tif (changed.has(key)) {\n\t\t\t\tthis.logService.warn(`MultiplexPolicyService#_updatePolicyDefinitions - Found overlapping keys in policy services: ${key}`);\n\t\t\t}\n\t\t\tchanged.add(key);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../../base/common/collections.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition, PolicyValue } from '../../../../platform/policy/common/policy.js';\n\nexport class MultiplexPolicyService extends AbstractPolicyService implements IPolicyService {\n\n\tconstructor(\n\t\tprivate readonly policyServices: ReadonlyArray<IPolicyService>,\n\t\t@ILogService private readonly logService: ILogService,\n\t) {\n\t\tsuper();\n\n\t\tthis.updatePolicies();\n\t\tthis._register(Event.any(...this.policyServices.map(service => service.onDidChange))(names => {\n\t\t\tthis.updatePolicies();\n\t\t\tthis._onDidChange.fire(names);\n\t\t}));\n\t}\n\n\toverride async updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<IStringDictionary<PolicyValue>> {\n\t\tawait this._updatePolicyDefinitions(policyDefinitions);\n\t\treturn Iterable.reduce(this.policies.entries(), (r, [name, value]) => ({ ...r, [name]: value }), {});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tawait Promise.all(this.policyServices.map(service => service.updatePolicyDefinitions(policyDefinitions)));\n\t\tthis.updatePolicies();\n\t}\n\n\tprivate updatePolicies(): void {\n\t\tthis.policies.clear();\n\t\tconst updated: string[] = [];\n\t\tfor (const service of this.policyServices) {\n\t\t\tconst definitions = service.policyDefinitions;\n\t\t\tfor (const name in definitions) {\n\t\t\t\tconst value = service.getPolicyValue(name);\n\t\t\t\tthis.policyDefinitions[name] = definitions[name];\n\t\t\t\tif (value !== undefined) {\n\t\t\t\t\tupdated.push(name);\n\t\t\t\t\tthis.policies.set(name, value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check that no results have overlapping keys\n\t\tconst changed = new Set<string>();\n\t\tfor (const key of updated) {\n\t\t\tif (changed.has(key)) {\n\t\t\t\tthis.logService.warn(`MultiplexPolicyService#_updatePolicyDefinitions - Found overlapping keys in policy services: ${key}`);\n\t\t\t}\n\t\t\tchanged.add(key);\n\t\t}\n\t}\n}\n"]}