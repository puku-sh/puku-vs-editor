{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/workbench/browser/codeeditor.ts","vs/workbench/browser/codeeditor.ts"],"names":[],"mappings":"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","file":"codeeditor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from '../../base/common/actions.js';\nimport { Emitter } from '../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../base/common/lifecycle.js';\nimport { isEqual } from '../../base/common/resources.js';\nimport { URI } from '../../base/common/uri.js';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, OverlayWidgetPositionPreference, isCodeEditor, isCompositeEditor } from '../../editor/browser/editorBrowser.js';\nimport { EmbeddedCodeEditorWidget } from '../../editor/browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EditorOption } from '../../editor/common/config/editorOptions.js';\nimport { IRange } from '../../editor/common/core/range.js';\nimport { CursorChangeReason, ICursorPositionChangedEvent } from '../../editor/common/cursorEvents.js';\nimport { IEditorContribution } from '../../editor/common/editorCommon.js';\nimport { IModelDecorationsChangeAccessor, TrackedRangeStickiness } from '../../editor/common/model.js';\nimport { ModelDecorationOptions } from '../../editor/common/model/textModel.js';\nimport { AbstractFloatingClickMenu, FloatingClickWidget } from '../../platform/actions/browser/floatingMenu.js';\nimport { IMenuService, MenuId } from '../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../platform/keybinding/common/keybinding.js';\nimport { IEditorService } from '../services/editor/common/editorService.js';\n\nexport interface IRangeHighlightDecoration {\n\tresource: URI;\n\trange: IRange;\n\tisWholeLine?: boolean;\n}\n\nexport class RangeHighlightDecorations extends Disposable {\n\n\tprivate readonly _onHighlightRemoved = this._register(new Emitter<void>());\n\treadonly onHighlightRemoved = this._onHighlightRemoved.event;\n\n\tprivate rangeHighlightDecorationId: string | null = null;\n\tprivate editor: ICodeEditor | null = null;\n\tprivate readonly editorDisposables = this._register(new DisposableStore());\n\n\tconstructor(@IEditorService private readonly editorService: IEditorService) {\n\t\tsuper();\n\t}\n\n\tremoveHighlightRange() {\n\t\tif (this.editor && this.rangeHighlightDecorationId) {\n\t\t\tconst decorationId = this.rangeHighlightDecorationId;\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\taccessor.removeDecoration(decorationId);\n\t\t\t});\n\t\t\tthis._onHighlightRemoved.fire();\n\t\t}\n\n\t\tthis.rangeHighlightDecorationId = null;\n\t}\n\n\thighlightRange(range: IRangeHighlightDecoration, editor?: unknown) {\n\t\teditor = editor ?? this.getEditor(range);\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.doHighlightRange(editor, range);\n\t\t} else if (isCompositeEditor(editor) && isCodeEditor(editor.activeCodeEditor)) {\n\t\t\tthis.doHighlightRange(editor.activeCodeEditor, range);\n\t\t}\n\t}\n\n\tprivate doHighlightRange(editor: ICodeEditor, selectionRange: IRangeHighlightDecoration) {\n\t\tthis.removeHighlightRange();\n\n\t\teditor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\tthis.rangeHighlightDecorationId = changeAccessor.addDecoration(selectionRange.range, this.createRangeHighlightDecoration(selectionRange.isWholeLine));\n\t\t});\n\n\t\tthis.setEditor(editor);\n\t}\n\n\tprivate getEditor(resourceRange: IRangeHighlightDecoration): ICodeEditor | undefined {\n\t\tconst resource = this.editorService.activeEditor?.resource;\n\t\tif (resource && isEqual(resource, resourceRange.resource) && isCodeEditor(this.editorService.activeTextEditorControl)) {\n\t\t\treturn this.editorService.activeTextEditorControl;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setEditor(editor: ICodeEditor) {\n\t\tif (this.editor !== editor) {\n\t\t\tthis.editorDisposables.clear();\n\t\t\tthis.editor = editor;\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeCursorPosition((e: ICursorPositionChangedEvent) => {\n\t\t\t\tif (\n\t\t\t\t\te.reason === CursorChangeReason.NotSet\n\t\t\t\t\t|| e.reason === CursorChangeReason.Explicit\n\t\t\t\t\t|| e.reason === CursorChangeReason.Undo\n\t\t\t\t\t|| e.reason === CursorChangeReason.Redo\n\t\t\t\t) {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeModel(() => { this.removeHighlightRange(); }));\n\t\t\tthis.editorDisposables.add(this.editor.onDidDispose(() => {\n\t\t\t\tthis.removeHighlightRange();\n\t\t\t\tthis.editor = null;\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate static readonly _WHOLE_LINE_RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight-whole',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight'\n\t});\n\n\tprivate createRangeHighlightDecoration(isWholeLine: boolean = true): ModelDecorationOptions {\n\t\treturn (isWholeLine ? RangeHighlightDecorations._WHOLE_LINE_RANGE_HIGHLIGHT : RangeHighlightDecorations._RANGE_HIGHLIGHT);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this.editor?.getModel()) {\n\t\t\tthis.removeHighlightRange();\n\t\t\tthis.editor = null;\n\t\t}\n\t}\n}\n\nexport class FloatingEditorClickWidget extends FloatingClickWidget implements IOverlayWidget {\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\tlabel: string,\n\t\tkeyBindingAction: string | null,\n\t\t@IKeybindingService keybindingService: IKeybindingService\n\t) {\n\t\tsuper(\n\t\t\tkeyBindingAction && keybindingService.lookupKeybinding(keyBindingAction)\n\t\t\t\t? `${label} (${keybindingService.lookupKeybinding(keyBindingAction)!.getLabel()})`\n\t\t\t\t: label\n\t\t);\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.overlayWidget.floatingClickWidget';\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER\n\t\t};\n\t}\n\n\toverride render() {\n\t\tsuper.render();\n\t\tthis.editor.addOverlayWidget(this);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.editor.removeOverlayWidget(this);\n\t\tsuper.dispose();\n\t}\n\n}\n\nexport class FloatingEditorClickMenu extends AbstractFloatingClickMenu implements IEditorContribution {\n\tstatic readonly ID = 'editor.contrib.floatingClickMenu';\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(MenuId.EditorContent, menuService, contextKeyService);\n\t\tthis.render();\n\t}\n\n\tprotected override createWidget(action: IAction): FloatingClickWidget {\n\t\treturn this.instantiationService.createInstance(FloatingEditorClickWidget, this.editor, action.label, action.id);\n\t}\n\n\tprotected override isVisible() {\n\t\treturn !(this.editor instanceof EmbeddedCodeEditorWidget) && this.editor?.hasModel() && !this.editor.getOption(EditorOption.inDiffEditor);\n\t}\n\n\tprotected override getActionArg(): unknown {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from '../../base/common/actions.js';\nimport { Emitter } from '../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../base/common/lifecycle.js';\nimport { isEqual } from '../../base/common/resources.js';\nimport { URI } from '../../base/common/uri.js';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, OverlayWidgetPositionPreference, isCodeEditor, isCompositeEditor } from '../../editor/browser/editorBrowser.js';\nimport { EmbeddedCodeEditorWidget } from '../../editor/browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EditorOption } from '../../editor/common/config/editorOptions.js';\nimport { IRange } from '../../editor/common/core/range.js';\nimport { CursorChangeReason, ICursorPositionChangedEvent } from '../../editor/common/cursorEvents.js';\nimport { IEditorContribution } from '../../editor/common/editorCommon.js';\nimport { IModelDecorationsChangeAccessor, TrackedRangeStickiness } from '../../editor/common/model.js';\nimport { ModelDecorationOptions } from '../../editor/common/model/textModel.js';\nimport { AbstractFloatingClickMenu, FloatingClickWidget } from '../../platform/actions/browser/floatingMenu.js';\nimport { IMenuService, MenuId } from '../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../platform/keybinding/common/keybinding.js';\nimport { IEditorService } from '../services/editor/common/editorService.js';\n\nexport interface IRangeHighlightDecoration {\n\tresource: URI;\n\trange: IRange;\n\tisWholeLine?: boolean;\n}\n\nexport class RangeHighlightDecorations extends Disposable {\n\n\tprivate readonly _onHighlightRemoved = this._register(new Emitter<void>());\n\treadonly onHighlightRemoved = this._onHighlightRemoved.event;\n\n\tprivate rangeHighlightDecorationId: string | null = null;\n\tprivate editor: ICodeEditor | null = null;\n\tprivate readonly editorDisposables = this._register(new DisposableStore());\n\n\tconstructor(@IEditorService private readonly editorService: IEditorService) {\n\t\tsuper();\n\t}\n\n\tremoveHighlightRange() {\n\t\tif (this.editor && this.rangeHighlightDecorationId) {\n\t\t\tconst decorationId = this.rangeHighlightDecorationId;\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\taccessor.removeDecoration(decorationId);\n\t\t\t});\n\t\t\tthis._onHighlightRemoved.fire();\n\t\t}\n\n\t\tthis.rangeHighlightDecorationId = null;\n\t}\n\n\thighlightRange(range: IRangeHighlightDecoration, editor?: unknown) {\n\t\teditor = editor ?? this.getEditor(range);\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.doHighlightRange(editor, range);\n\t\t} else if (isCompositeEditor(editor) && isCodeEditor(editor.activeCodeEditor)) {\n\t\t\tthis.doHighlightRange(editor.activeCodeEditor, range);\n\t\t}\n\t}\n\n\tprivate doHighlightRange(editor: ICodeEditor, selectionRange: IRangeHighlightDecoration) {\n\t\tthis.removeHighlightRange();\n\n\t\teditor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\tthis.rangeHighlightDecorationId = changeAccessor.addDecoration(selectionRange.range, this.createRangeHighlightDecoration(selectionRange.isWholeLine));\n\t\t});\n\n\t\tthis.setEditor(editor);\n\t}\n\n\tprivate getEditor(resourceRange: IRangeHighlightDecoration): ICodeEditor | undefined {\n\t\tconst resource = this.editorService.activeEditor?.resource;\n\t\tif (resource && isEqual(resource, resourceRange.resource) && isCodeEditor(this.editorService.activeTextEditorControl)) {\n\t\t\treturn this.editorService.activeTextEditorControl;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setEditor(editor: ICodeEditor) {\n\t\tif (this.editor !== editor) {\n\t\t\tthis.editorDisposables.clear();\n\t\t\tthis.editor = editor;\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeCursorPosition((e: ICursorPositionChangedEvent) => {\n\t\t\t\tif (\n\t\t\t\t\te.reason === CursorChangeReason.NotSet\n\t\t\t\t\t|| e.reason === CursorChangeReason.Explicit\n\t\t\t\t\t|| e.reason === CursorChangeReason.Undo\n\t\t\t\t\t|| e.reason === CursorChangeReason.Redo\n\t\t\t\t) {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeModel(() => { this.removeHighlightRange(); }));\n\t\t\tthis.editorDisposables.add(this.editor.onDidDispose(() => {\n\t\t\t\tthis.removeHighlightRange();\n\t\t\t\tthis.editor = null;\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate static readonly _WHOLE_LINE_RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight-whole',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight'\n\t});\n\n\tprivate createRangeHighlightDecoration(isWholeLine: boolean = true): ModelDecorationOptions {\n\t\treturn (isWholeLine ? RangeHighlightDecorations._WHOLE_LINE_RANGE_HIGHLIGHT : RangeHighlightDecorations._RANGE_HIGHLIGHT);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this.editor?.getModel()) {\n\t\t\tthis.removeHighlightRange();\n\t\t\tthis.editor = null;\n\t\t}\n\t}\n}\n\nexport class FloatingEditorClickWidget extends FloatingClickWidget implements IOverlayWidget {\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\tlabel: string,\n\t\tkeyBindingAction: string | null,\n\t\t@IKeybindingService keybindingService: IKeybindingService\n\t) {\n\t\tsuper(\n\t\t\tkeyBindingAction && keybindingService.lookupKeybinding(keyBindingAction)\n\t\t\t\t? `${label} (${keybindingService.lookupKeybinding(keyBindingAction)!.getLabel()})`\n\t\t\t\t: label\n\t\t);\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.overlayWidget.floatingClickWidget';\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER\n\t\t};\n\t}\n\n\toverride render() {\n\t\tsuper.render();\n\t\tthis.editor.addOverlayWidget(this);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.editor.removeOverlayWidget(this);\n\t\tsuper.dispose();\n\t}\n\n}\n\nexport class FloatingEditorClickMenu extends AbstractFloatingClickMenu implements IEditorContribution {\n\tstatic readonly ID = 'editor.contrib.floatingClickMenu';\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(MenuId.EditorContent, menuService, contextKeyService);\n\t\tthis.render();\n\t}\n\n\tprotected override createWidget(action: IAction): FloatingClickWidget {\n\t\treturn this.instantiationService.createInstance(FloatingEditorClickWidget, this.editor, action.label, action.id);\n\t}\n\n\tprotected override isVisible() {\n\t\treturn !(this.editor instanceof EmbeddedCodeEditorWidget) && this.editor?.hasModel() && !this.editor.getOption(EditorOption.inDiffEditor);\n\t}\n\n\tprotected override getActionArg(): unknown {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n}\n"]}