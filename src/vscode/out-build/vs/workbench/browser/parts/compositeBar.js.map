{"version":3,"sources":["vs/workbench/browser/parts/compositeBar.ts"],"names":[],"mappings":"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","file":"compositeBar.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../nls.js';\nimport { IAction, toAction } from '../../../base/common/actions.js';\nimport { IActivity } from '../../services/activity/common/activity.js';\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { ActionBar, ActionsOrientation } from '../../../base/browser/ui/actionbar/actionbar.js';\nimport { CompositeActionViewItem, CompositeOverflowActivityAction, CompositeOverflowActivityActionViewItem, CompositeBarAction, ICompositeBar, ICompositeBarColors, IActivityHoverOptions } from './compositeBarActions.js';\nimport { Dimension, $, addDisposableListener, EventType, EventHelper, isAncestor, getWindow } from '../../../base/browser/dom.js';\nimport { StandardMouseEvent } from '../../../base/browser/mouseEvent.js';\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\nimport { Widget } from '../../../base/browser/ui/widget.js';\nimport { isUndefinedOrNull } from '../../../base/common/types.js';\nimport { IColorTheme } from '../../../platform/theme/common/themeService.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { ViewContainerLocation, IViewDescriptorService } from '../../common/views.js';\nimport { IPaneComposite } from '../../common/panecomposite.js';\nimport { IComposite } from '../../common/composite.js';\nimport { CompositeDragAndDropData, CompositeDragAndDropObserver, IDraggedCompositeData, ICompositeDragAndDrop, Before2D, toggleDropEffect, ICompositeDragAndDropObserverCallbacks } from '../dnd.js';\nimport { Gesture, EventType as TouchEventType, GestureEvent } from '../../../base/browser/touch.js';\n\nexport interface ICompositeBarItem {\n\n\treadonly id: string;\n\n\tname?: string;\n\tpinned: boolean;\n\torder?: number;\n\tvisible: boolean;\n}\n\nexport class CompositeDragAndDrop implements ICompositeDragAndDrop {\n\n\tconstructor(\n\t\tprivate viewDescriptorService: IViewDescriptorService,\n\t\tprivate targetContainerLocation: ViewContainerLocation,\n\t\tprivate orientation: ActionsOrientation,\n\t\tprivate openComposite: (id: string, focus?: boolean) => Promise<IPaneComposite | null>,\n\t\tprivate moveComposite: (from: string, to: string, before?: Before2D) => void,\n\t\tprivate getItems: () => ICompositeBarItem[]\n\t) { }\n\n\tdrop(data: CompositeDragAndDropData, targetCompositeId: string | undefined, originalEvent: DragEvent, before?: Before2D): void {\n\t\tconst dragData = data.getData();\n\n\t\tif (dragData.type === 'composite') {\n\t\t\tconst currentContainer = this.viewDescriptorService.getViewContainerById(dragData.id)!;\n\t\t\tconst currentLocation = this.viewDescriptorService.getViewContainerLocation(currentContainer);\n\t\t\tlet moved = false;\n\n\t\t\t// ... on the same composite bar\n\t\t\tif (currentLocation === this.targetContainerLocation) {\n\t\t\t\tif (targetCompositeId) {\n\t\t\t\t\tthis.moveComposite(dragData.id, targetCompositeId, before);\n\t\t\t\t\tmoved = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// ... on a different composite bar\n\t\t\telse {\n\t\t\t\tthis.viewDescriptorService.moveViewContainerToLocation(currentContainer, this.targetContainerLocation, this.getTargetIndex(targetCompositeId, before), 'dnd');\n\t\t\t\tmoved = true;\n\t\t\t}\n\n\t\t\tif (moved) {\n\t\t\t\tthis.openComposite(currentContainer.id, true);\n\t\t\t}\n\t\t}\n\n\t\tif (dragData.type === 'view') {\n\t\t\tconst viewToMove = this.viewDescriptorService.getViewDescriptorById(dragData.id)!;\n\t\t\tif (viewToMove.canMoveView) {\n\t\t\t\tthis.viewDescriptorService.moveViewToLocation(viewToMove, this.targetContainerLocation, 'dnd');\n\n\t\t\t\tconst newContainer = this.viewDescriptorService.getViewContainerByViewId(viewToMove.id)!;\n\n\t\t\t\tif (targetCompositeId) {\n\t\t\t\t\tthis.moveComposite(newContainer.id, targetCompositeId, before);\n\t\t\t\t}\n\n\t\t\t\tthis.openComposite(newContainer.id, true).then(composite => {\n\t\t\t\t\tcomposite?.openView(viewToMove.id, true);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tonDragEnter(data: CompositeDragAndDropData, targetCompositeId: string | undefined, originalEvent: DragEvent): boolean {\n\t\treturn this.canDrop(data, targetCompositeId);\n\t}\n\n\tonDragOver(data: CompositeDragAndDropData, targetCompositeId: string | undefined, originalEvent: DragEvent): boolean {\n\t\treturn this.canDrop(data, targetCompositeId);\n\t}\n\n\tprivate getTargetIndex(targetId: string | undefined, before2d: Before2D | undefined): number | undefined {\n\t\tif (!targetId) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst items = this.getItems();\n\t\tconst before = this.orientation === ActionsOrientation.HORIZONTAL ? before2d?.horizontallyBefore : before2d?.verticallyBefore;\n\t\treturn items.filter(item => item.visible).findIndex(item => item.id === targetId) + (before ? 0 : 1);\n\t}\n\n\tprivate canDrop(data: CompositeDragAndDropData, targetCompositeId: string | undefined): boolean {\n\t\tconst dragData = data.getData();\n\n\t\tif (dragData.type === 'composite') {\n\n\t\t\t// Dragging a composite\n\t\t\tconst currentContainer = this.viewDescriptorService.getViewContainerById(dragData.id)!;\n\t\t\tconst currentLocation = this.viewDescriptorService.getViewContainerLocation(currentContainer);\n\n\t\t\t// ... to the same composite location\n\t\t\tif (currentLocation === this.targetContainerLocation) {\n\t\t\t\treturn dragData.id !== targetCompositeId;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t} else {\n\n\t\t\t// Dragging an individual view\n\t\t\tconst viewDescriptor = this.viewDescriptorService.getViewDescriptorById(dragData.id);\n\n\t\t\t// ... that cannot move\n\t\t\tif (!viewDescriptor?.canMoveView) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// ... to create a view container\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nexport interface ICompositeBarOptions {\n\n\treadonly icon: boolean;\n\treadonly orientation: ActionsOrientation;\n\treadonly colors: (theme: IColorTheme) => ICompositeBarColors;\n\treadonly compact?: boolean;\n\treadonly compositeSize: number;\n\treadonly overflowActionSize: number;\n\treadonly dndHandler: ICompositeDragAndDrop;\n\treadonly activityHoverOptions: IActivityHoverOptions;\n\treadonly preventLoopNavigation?: boolean;\n\n\treadonly getActivityAction: (compositeId: string) => CompositeBarAction;\n\treadonly getCompositePinnedAction: (compositeId: string) => IAction;\n\treadonly getCompositeBadgeAction: (compositeId: string) => IAction;\n\treadonly getOnCompositeClickAction: (compositeId: string) => IAction;\n\treadonly fillExtraContextMenuActions: (actions: IAction[], e?: MouseEvent | GestureEvent) => void;\n\treadonly getContextMenuActionsForComposite: (compositeId: string) => IAction[];\n\n\treadonly openComposite: (compositeId: string, preserveFocus?: boolean) => Promise<IComposite | null>;\n\treadonly getDefaultCompositeId: () => string | undefined;\n}\n\nclass CompositeBarDndCallbacks implements ICompositeDragAndDropObserverCallbacks {\n\n\tprivate insertDropBefore: Before2D | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly compositeBarContainer: HTMLElement,\n\t\tprivate readonly actionBarContainer: HTMLElement,\n\t\tprivate readonly compositeBarModel: CompositeBarModel,\n\t\tprivate readonly dndHandler: ICompositeDragAndDrop,\n\t\tprivate readonly orientation: ActionsOrientation,\n\t) { }\n\n\tonDragOver(e: IDraggedCompositeData) {\n\n\t\t// don't add feedback if this is over the composite bar actions or there are no actions\n\t\tconst visibleItems = this.compositeBarModel.visibleItems;\n\t\tif (!visibleItems.length || (e.eventData.target && isAncestor(e.eventData.target as HTMLElement, this.actionBarContainer))) {\n\t\t\tthis.insertDropBefore = this.updateFromDragging(this.compositeBarContainer, false, false, true);\n\t\t\treturn;\n\t\t}\n\n\t\tconst insertAtFront = this.insertAtFront(this.actionBarContainer, e.eventData);\n\t\tconst target = insertAtFront ? visibleItems[0] : visibleItems[visibleItems.length - 1];\n\t\tconst validDropTarget = this.dndHandler.onDragOver(e.dragAndDropData, target.id, e.eventData);\n\t\ttoggleDropEffect(e.eventData.dataTransfer, 'move', validDropTarget);\n\t\tthis.insertDropBefore = this.updateFromDragging(this.compositeBarContainer, validDropTarget, insertAtFront, true);\n\t}\n\n\tonDragLeave(e: IDraggedCompositeData) {\n\t\tthis.insertDropBefore = this.updateFromDragging(this.compositeBarContainer, false, false, false);\n\t}\n\n\tonDragEnd(e: IDraggedCompositeData) {\n\t\tthis.insertDropBefore = this.updateFromDragging(this.compositeBarContainer, false, false, false);\n\t}\n\n\tonDrop(e: IDraggedCompositeData) {\n\t\tconst visibleItems = this.compositeBarModel.visibleItems;\n\t\tlet targetId = undefined;\n\t\tif (visibleItems.length) {\n\t\t\ttargetId = this.insertAtFront(this.actionBarContainer, e.eventData) ? visibleItems[0].id : visibleItems[visibleItems.length - 1].id;\n\t\t}\n\t\tthis.dndHandler.drop(e.dragAndDropData, targetId, e.eventData, this.insertDropBefore);\n\t\tthis.insertDropBefore = this.updateFromDragging(this.compositeBarContainer, false, false, false);\n\t}\n\n\tprivate insertAtFront(element: HTMLElement, event: DragEvent): boolean {\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst posX = event.clientX;\n\t\tconst posY = event.clientY;\n\n\t\tswitch (this.orientation) {\n\t\t\tcase ActionsOrientation.HORIZONTAL:\n\t\t\t\treturn posX < rect.left;\n\t\t\tcase ActionsOrientation.VERTICAL:\n\t\t\t\treturn posY < rect.top;\n\t\t}\n\t}\n\n\tprivate updateFromDragging(element: HTMLElement, showFeedback: boolean, front: boolean, isDragging: boolean): Before2D | undefined {\n\t\telement.classList.toggle('dragged-over', isDragging);\n\t\telement.classList.toggle('dragged-over-head', showFeedback && front);\n\t\telement.classList.toggle('dragged-over-tail', showFeedback && !front);\n\n\t\tif (!showFeedback) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn { verticallyBefore: front, horizontallyBefore: front };\n\t}\n}\n\nexport class CompositeBar extends Widget implements ICompositeBar {\n\n\tprivate readonly _onDidChange = this._register(new Emitter<void>());\n\treadonly onDidChange = this._onDidChange.event;\n\n\tprivate dimension: Dimension | undefined;\n\n\tprivate compositeSwitcherBar: ActionBar | undefined;\n\tprivate compositeOverflowAction: CompositeOverflowActivityAction | undefined;\n\tprivate compositeOverflowActionViewItem: CompositeOverflowActivityActionViewItem | undefined;\n\n\tprivate readonly model: CompositeBarModel;\n\tprivate readonly visibleComposites: string[];\n\tprivate readonly compositeSizeInBar: Map<string, number>;\n\n\tconstructor(\n\t\titems: ICompositeBarItem[],\n\t\tprivate readonly options: ICompositeBarOptions,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IViewDescriptorService private readonly viewDescriptorService: IViewDescriptorService,\n\t) {\n\t\tsuper();\n\n\t\tthis.model = new CompositeBarModel(items, options);\n\t\tthis.visibleComposites = [];\n\t\tthis.compositeSizeInBar = new Map<string, number>();\n\t\tthis.computeSizes(this.model.visibleItems);\n\t}\n\n\tgetCompositeBarItems(): ICompositeBarItem[] {\n\t\treturn [...this.model.items];\n\t}\n\n\tsetCompositeBarItems(items: ICompositeBarItem[]): void {\n\t\tthis.model.setItems(items);\n\t\tthis.updateCompositeSwitcher(true);\n\t}\n\n\tgetPinnedComposites(): ICompositeBarItem[] {\n\t\treturn this.model.pinnedItems;\n\t}\n\n\tgetPinnedCompositeIds(): string[] {\n\t\treturn this.getPinnedComposites().map(c => c.id);\n\t}\n\n\tgetVisibleComposites(): ICompositeBarItem[] {\n\t\treturn this.model.visibleItems;\n\t}\n\n\tcreate(parent: HTMLElement): HTMLElement {\n\t\tconst actionBarDiv = parent.appendChild($('.composite-bar'));\n\t\tthis.compositeSwitcherBar = this._register(new ActionBar(actionBarDiv, {\n\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\tif (action instanceof CompositeOverflowActivityAction) {\n\t\t\t\t\treturn this.compositeOverflowActionViewItem;\n\t\t\t\t}\n\t\t\t\tconst item = this.model.findItem(action.id);\n\t\t\t\treturn item && this.instantiationService.createInstance(\n\t\t\t\t\tCompositeActionViewItem,\n\t\t\t\t\t{ ...options, draggable: true, colors: this.options.colors, icon: this.options.icon, hoverOptions: this.options.activityHoverOptions, compact: this.options.compact },\n\t\t\t\t\taction as CompositeBarAction,\n\t\t\t\t\titem.pinnedAction,\n\t\t\t\t\titem.toggleBadgeAction,\n\t\t\t\t\tcompositeId => this.options.getContextMenuActionsForComposite(compositeId),\n\t\t\t\t\t() => this.getContextMenuActions(),\n\t\t\t\t\tthis.options.dndHandler,\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t},\n\t\t\torientation: this.options.orientation,\n\t\t\tariaLabel: localize('activityBarAriaLabel', \"Active View Switcher\"),\n\t\t\tariaRole: 'tablist',\n\t\t\tpreventLoopNavigation: this.options.preventLoopNavigation,\n\t\t\ttriggerKeys: { keyDown: true }\n\t\t}));\n\n\t\t// Contextmenu for composites\n\t\tthis._register(addDisposableListener(parent, EventType.CONTEXT_MENU, e => this.showContextMenu(getWindow(parent), e)));\n\t\tthis._register(Gesture.addTarget(parent));\n\t\tthis._register(addDisposableListener(parent, TouchEventType.Contextmenu, e => this.showContextMenu(getWindow(parent), e)));\n\n\t\t// Register a drop target on the whole bar to prevent forbidden feedback\n\t\tconst dndCallback = new CompositeBarDndCallbacks(parent, actionBarDiv, this.model, this.options.dndHandler, this.options.orientation);\n\t\tthis._register(CompositeDragAndDropObserver.INSTANCE.registerTarget(parent, dndCallback));\n\n\t\treturn actionBarDiv;\n\t}\n\n\tfocus(index?: number): void {\n\t\tthis.compositeSwitcherBar?.focus(index);\n\t}\n\n\trecomputeSizes(): void {\n\t\tthis.computeSizes(this.model.visibleItems);\n\t\tthis.updateCompositeSwitcher();\n\t}\n\n\tlayout(dimension: Dimension): void {\n\t\tthis.dimension = dimension;\n\n\t\tif (dimension.height === 0 || dimension.width === 0) {\n\t\t\t// Do not layout if not visible. Otherwise the size measurment would be computed wrongly\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.compositeSizeInBar.size === 0) {\n\t\t\t// Compute size of each composite by getting the size from the css renderer\n\t\t\t// Size is later used for overflow computation\n\t\t\tthis.computeSizes(this.model.visibleItems);\n\t\t}\n\n\t\tthis.updateCompositeSwitcher();\n\t}\n\n\taddComposite({ id, name, order, requestedIndex }: { id: string; name: string; order?: number; requestedIndex?: number }): void {\n\t\tif (this.model.add(id, name, order, requestedIndex)) {\n\t\t\tthis.computeSizes([this.model.findItem(id)]);\n\t\t\tthis.updateCompositeSwitcher();\n\t\t}\n\t}\n\n\tremoveComposite(id: string): void {\n\n\t\t// If it pinned, unpin it first\n\t\tif (this.isPinned(id)) {\n\t\t\tthis.unpin(id);\n\t\t}\n\n\t\t// Remove from the model\n\t\tif (this.model.remove(id)) {\n\t\t\tthis.updateCompositeSwitcher();\n\t\t}\n\t}\n\n\thideComposite(id: string): void {\n\t\tif (this.model.hide(id)) {\n\t\t\tthis.resetActiveComposite(id);\n\t\t\tthis.updateCompositeSwitcher();\n\t\t}\n\t}\n\n\tactivateComposite(id: string): void {\n\t\tconst previousActiveItem = this.model.activeItem;\n\t\tif (this.model.activate(id)) {\n\t\t\t// Update if current composite is neither visible nor pinned\n\t\t\t// or previous active composite is not pinned\n\t\t\tif (this.visibleComposites.indexOf(id) === - 1 || (!!this.model.activeItem && !this.model.activeItem.pinned) || (previousActiveItem && !previousActiveItem.pinned)) {\n\t\t\t\tthis.updateCompositeSwitcher();\n\t\t\t}\n\t\t}\n\t}\n\n\tdeactivateComposite(id: string): void {\n\t\tconst previousActiveItem = this.model.activeItem;\n\t\tif (this.model.deactivate()) {\n\t\t\tif (previousActiveItem && !previousActiveItem.pinned) {\n\t\t\t\tthis.updateCompositeSwitcher();\n\t\t\t}\n\t\t}\n\t}\n\n\tasync pin(compositeId: string, open?: boolean): Promise<void> {\n\t\tif (this.model.setPinned(compositeId, true)) {\n\t\t\tthis.updateCompositeSwitcher();\n\n\t\t\tif (open) {\n\t\t\t\tawait this.options.openComposite(compositeId);\n\t\t\t\tthis.activateComposite(compositeId); // Activate after opening\n\t\t\t}\n\t\t}\n\t}\n\n\tunpin(compositeId: string): void {\n\t\tif (this.model.setPinned(compositeId, false)) {\n\n\t\t\tthis.updateCompositeSwitcher();\n\n\t\t\tthis.resetActiveComposite(compositeId);\n\t\t}\n\t}\n\n\tareBadgesEnabled(compositeId: string): boolean {\n\t\treturn this.viewDescriptorService.getViewContainerBadgeEnablementState(compositeId);\n\t}\n\n\ttoggleBadgeEnablement(compositeId: string): void {\n\t\tthis.viewDescriptorService.setViewContainerBadgeEnablementState(compositeId, !this.areBadgesEnabled(compositeId));\n\t\tthis.updateCompositeSwitcher();\n\t\tconst item = this.model.findItem(compositeId);\n\t\tif (item) {\n\t\t\t// TODO @lramos15 how do we tell the activity to re-render the badge? This triggers an onDidChange but isn't the right way to do it.\n\t\t\t// I could add another specific function like `activity.updateBadgeEnablement` would then the activity store the sate?\n\t\t\titem.activityAction.activities = item.activityAction.activities;\n\t\t}\n\t}\n\n\tprivate resetActiveComposite(compositeId: string) {\n\t\tconst defaultCompositeId = this.options.getDefaultCompositeId();\n\n\t\t// Case: composite is not the active one or the active one is a different one\n\t\t// Solv: we do nothing\n\t\tif (!this.model.activeItem || this.model.activeItem.id !== compositeId) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Deactivate itself\n\t\tthis.deactivateComposite(compositeId);\n\n\t\t// Case: composite is not the default composite and default composite is still showing\n\t\t// Solv: we open the default composite\n\t\tif (defaultCompositeId && defaultCompositeId !== compositeId && this.isPinned(defaultCompositeId)) {\n\t\t\tthis.options.openComposite(defaultCompositeId, true);\n\t\t}\n\n\t\t// Case: we closed the default composite\n\t\t// Solv: we open the next visible composite from top\n\t\telse {\n\t\t\tconst visibleComposite = this.visibleComposites.find(cid => cid !== compositeId);\n\t\t\tif (visibleComposite) {\n\t\t\t\tthis.options.openComposite(visibleComposite);\n\t\t\t}\n\t\t}\n\t}\n\n\tisPinned(compositeId: string): boolean {\n\t\tconst item = this.model.findItem(compositeId);\n\t\treturn item?.pinned;\n\t}\n\n\tmove(compositeId: string, toCompositeId: string, before?: boolean): void {\n\t\tif (before !== undefined) {\n\t\t\tconst fromIndex = this.model.items.findIndex(c => c.id === compositeId);\n\t\t\tlet toIndex = this.model.items.findIndex(c => c.id === toCompositeId);\n\n\t\t\tif (fromIndex >= 0 && toIndex >= 0) {\n\t\t\t\tif (!before && fromIndex > toIndex) {\n\t\t\t\t\ttoIndex++;\n\t\t\t\t}\n\n\t\t\t\tif (before && fromIndex < toIndex) {\n\t\t\t\t\ttoIndex--;\n\t\t\t\t}\n\n\t\t\t\tif (toIndex < this.model.items.length && toIndex >= 0 && toIndex !== fromIndex) {\n\t\t\t\t\tif (this.model.move(this.model.items[fromIndex].id, this.model.items[toIndex].id)) {\n\t\t\t\t\t\t// timeout helps to prevent artifacts from showing up\n\t\t\t\t\t\tsetTimeout(() => this.updateCompositeSwitcher(), 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.model.move(compositeId, toCompositeId)) {\n\t\t\t\t// timeout helps to prevent artifacts from showing up\n\t\t\t\tsetTimeout(() => this.updateCompositeSwitcher(), 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAction(compositeId: string): CompositeBarAction {\n\t\tconst item = this.model.findItem(compositeId);\n\n\t\treturn item?.activityAction;\n\t}\n\n\tprivate computeSizes(items: ICompositeBarModelItem[]): void {\n\t\tconst size = this.options.compositeSize;\n\t\tif (size) {\n\t\t\titems.forEach(composite => this.compositeSizeInBar.set(composite.id, size));\n\t\t} else {\n\t\t\tconst compositeSwitcherBar = this.compositeSwitcherBar;\n\t\t\tif (compositeSwitcherBar && this.dimension && this.dimension.height !== 0 && this.dimension.width !== 0) {\n\n\t\t\t\t// Compute sizes only if visible. Otherwise the size measurment would be computed wrongly.\n\t\t\t\tconst currentItemsLength = compositeSwitcherBar.viewItems.length;\n\t\t\t\tcompositeSwitcherBar.push(items.map(composite => composite.activityAction));\n\t\t\t\titems.map((composite, index) => this.compositeSizeInBar.set(composite.id, this.options.orientation === ActionsOrientation.VERTICAL\n\t\t\t\t\t? compositeSwitcherBar.getHeight(currentItemsLength + index)\n\t\t\t\t\t: compositeSwitcherBar.getWidth(currentItemsLength + index)\n\t\t\t\t));\n\t\t\t\titems.forEach(() => compositeSwitcherBar.pull(compositeSwitcherBar.viewItems.length - 1));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateCompositeSwitcher(donotTrigger?: boolean): void {\n\t\tconst compositeSwitcherBar = this.compositeSwitcherBar;\n\t\tif (!compositeSwitcherBar || !this.dimension) {\n\t\t\treturn; // We have not been rendered yet so there is nothing to update.\n\t\t}\n\n\t\tlet compositesToShow = this.model.visibleItems.filter(item =>\n\t\t\titem.pinned\n\t\t\t|| (this.model.activeItem && this.model.activeItem.id === item.id) /* Show the active composite even if it is not pinned */\n\t\t).map(item => item.id);\n\n\t\t// Ensure we are not showing more composites than we have height for\n\t\tlet maxVisible = compositesToShow.length;\n\t\tconst totalComposites = compositesToShow.length;\n\t\tlet size = 0;\n\t\tconst limit = this.options.orientation === ActionsOrientation.VERTICAL ? this.dimension.height : this.dimension.width;\n\n\t\t// Add composites while they fit\n\t\tfor (let i = 0; i < compositesToShow.length; i++) {\n\t\t\tconst compositeSize = this.compositeSizeInBar.get(compositesToShow[i])!;\n\t\t\t// Adding this composite will overflow available size, so don't\n\t\t\tif (size + compositeSize > limit) {\n\t\t\t\tmaxVisible = i;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsize += compositeSize;\n\t\t}\n\n\t\t// Remove the tail of composites that did not fit\n\t\tif (totalComposites > maxVisible) {\n\t\t\tcompositesToShow = compositesToShow.slice(0, maxVisible);\n\t\t}\n\n\t\t// We always try show the active composite, so re-add it if it was sliced out\n\t\tif (this.model.activeItem && compositesToShow.every(compositeId => !!this.model.activeItem && compositeId !== this.model.activeItem.id)) {\n\t\t\tsize += this.compositeSizeInBar.get(this.model.activeItem.id)!;\n\t\t\tcompositesToShow.push(this.model.activeItem.id);\n\t\t}\n\n\t\t// The active composite might have pushed us over the limit\n\t\t// Keep popping the composite before the active one until it fits\n\t\t// If even the active one doesn't fit, we will resort to overflow\n\t\twhile (size > limit && compositesToShow.length) {\n\t\t\tconst removedComposite = compositesToShow.length > 1 ? compositesToShow.splice(compositesToShow.length - 2, 1)[0] : compositesToShow.pop();\n\t\t\tsize -= this.compositeSizeInBar.get(removedComposite!)!;\n\t\t}\n\n\t\t// We are overflowing, add the overflow size\n\t\tif (totalComposites > compositesToShow.length) {\n\t\t\tsize += this.options.overflowActionSize;\n\t\t}\n\n\t\t// Check if we need to make extra room for the overflow action\n\t\twhile (size > limit && compositesToShow.length) {\n\t\t\tconst removedComposite = compositesToShow.length > 1 && compositesToShow[compositesToShow.length - 1] === this.model.activeItem?.id ?\n\t\t\t\tcompositesToShow.splice(compositesToShow.length - 2, 1)[0] : compositesToShow.pop();\n\t\t\tsize -= this.compositeSizeInBar.get(removedComposite!)!;\n\t\t}\n\n\t\t// Remove the overflow action if there are no overflows\n\t\tif (totalComposites === compositesToShow.length && this.compositeOverflowAction) {\n\t\t\tcompositeSwitcherBar.pull(compositeSwitcherBar.length() - 1);\n\n\t\t\tthis.compositeOverflowAction.dispose();\n\t\t\tthis.compositeOverflowAction = undefined;\n\n\t\t\tthis.compositeOverflowActionViewItem?.dispose();\n\t\t\tthis.compositeOverflowActionViewItem = undefined;\n\t\t}\n\n\t\t// Pull out composites that overflow or got hidden\n\t\tconst compositesToRemove: number[] = [];\n\t\tthis.visibleComposites.forEach((compositeId, index) => {\n\t\t\tif (!compositesToShow.includes(compositeId)) {\n\t\t\t\tcompositesToRemove.push(index);\n\t\t\t}\n\t\t});\n\t\tcompositesToRemove.reverse().forEach(index => {\n\t\t\tcompositeSwitcherBar.pull(index);\n\t\t\tthis.visibleComposites.splice(index, 1);\n\t\t});\n\n\t\t// Update the positions of the composites\n\t\tcompositesToShow.forEach((compositeId, newIndex) => {\n\t\t\tconst currentIndex = this.visibleComposites.indexOf(compositeId);\n\t\t\tif (newIndex !== currentIndex) {\n\t\t\t\tif (currentIndex !== -1) {\n\t\t\t\t\tcompositeSwitcherBar.pull(currentIndex);\n\t\t\t\t\tthis.visibleComposites.splice(currentIndex, 1);\n\t\t\t\t}\n\n\t\t\t\tcompositeSwitcherBar.push(this.model.findItem(compositeId).activityAction, { label: true, icon: this.options.icon, index: newIndex });\n\t\t\t\tthis.visibleComposites.splice(newIndex, 0, compositeId);\n\t\t\t}\n\t\t});\n\n\t\t// Add overflow action as needed\n\t\tif (totalComposites > compositesToShow.length && !this.compositeOverflowAction) {\n\t\t\tthis.compositeOverflowAction = this._register(this.instantiationService.createInstance(CompositeOverflowActivityAction, () => {\n\t\t\t\tthis.compositeOverflowActionViewItem?.showMenu();\n\t\t\t}));\n\t\t\tthis.compositeOverflowActionViewItem = this._register(this.instantiationService.createInstance(\n\t\t\t\tCompositeOverflowActivityActionViewItem,\n\t\t\t\tthis.compositeOverflowAction,\n\t\t\t\t() => this.getOverflowingComposites(),\n\t\t\t\t() => this.model.activeItem ? this.model.activeItem.id : undefined,\n\t\t\t\tcompositeId => {\n\t\t\t\t\tconst item = this.model.findItem(compositeId);\n\t\t\t\t\treturn item?.activity[0]?.badge;\n\t\t\t\t},\n\t\t\t\tthis.options.getOnCompositeClickAction,\n\t\t\t\tthis.options.colors,\n\t\t\t\tthis.options.activityHoverOptions\n\t\t\t));\n\n\t\t\tcompositeSwitcherBar.push(this.compositeOverflowAction, { label: false, icon: true });\n\t\t}\n\n\t\tif (!donotTrigger) {\n\t\t\tthis._onDidChange.fire();\n\t\t}\n\t}\n\n\tprivate getOverflowingComposites(): { id: string; name?: string }[] {\n\t\tlet overflowingIds = this.model.visibleItems.filter(item => item.pinned).map(item => item.id);\n\n\t\t// Show the active composite even if it is not pinned\n\t\tif (this.model.activeItem && !this.model.activeItem.pinned) {\n\t\t\toverflowingIds.push(this.model.activeItem.id);\n\t\t}\n\n\t\toverflowingIds = overflowingIds.filter(compositeId => !this.visibleComposites.includes(compositeId));\n\t\treturn this.model.visibleItems.filter(c => overflowingIds.includes(c.id)).map(item => { return { id: item.id, name: this.getAction(item.id)?.label || item.name }; });\n\t}\n\n\tprivate showContextMenu(targetWindow: Window, e: MouseEvent | GestureEvent): void {\n\t\tEventHelper.stop(e, true);\n\n\t\tconst event = new StandardMouseEvent(targetWindow, e);\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => event,\n\t\t\tgetActions: () => this.getContextMenuActions(e)\n\t\t});\n\t}\n\n\tgetContextMenuActions(e?: MouseEvent | GestureEvent): IAction[] {\n\t\tconst actions: IAction[] = this.model.visibleItems\n\t\t\t.map(({ id, name, activityAction }) => {\n\t\t\t\tconst isPinned = this.isPinned(id);\n\t\t\t\treturn toAction({\n\t\t\t\t\tid,\n\t\t\t\t\tlabel: this.getAction(id).label || name || id,\n\t\t\t\t\tchecked: isPinned,\n\t\t\t\t\tenabled: activityAction.enabled && (!isPinned || this.getPinnedCompositeIds().length > 1),\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tif (this.isPinned(id)) {\n\t\t\t\t\t\t\tthis.unpin(id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.pin(id, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\tthis.options.fillExtraContextMenuActions(actions, e);\n\n\t\treturn actions;\n\t}\n}\n\ninterface ICompositeBarModelItem extends ICompositeBarItem {\n\treadonly activityAction: CompositeBarAction;\n\treadonly pinnedAction: IAction;\n\treadonly toggleBadgeAction: IAction;\n\treadonly activity: IActivity[];\n}\n\nclass CompositeBarModel {\n\n\tprivate _items: ICompositeBarModelItem[] = [];\n\tget items(): ICompositeBarModelItem[] { return this._items; }\n\n\tprivate readonly options: ICompositeBarOptions;\n\n\tactiveItem?: ICompositeBarModelItem;\n\n\tconstructor(\n\t\titems: ICompositeBarItem[],\n\t\toptions: ICompositeBarOptions\n\t) {\n\t\tthis.options = options;\n\t\tthis.setItems(items);\n\t}\n\n\tsetItems(items: ICompositeBarItem[]): void {\n\t\tthis._items = [];\n\t\tthis._items = items\n\t\t\t.map(i => this.createCompositeBarItem(i.id, i.name, i.order, i.pinned, i.visible));\n\t}\n\n\tget visibleItems(): ICompositeBarModelItem[] {\n\t\treturn this.items.filter(item => item.visible);\n\t}\n\n\tget pinnedItems(): ICompositeBarModelItem[] {\n\t\treturn this.items.filter(item => item.visible && item.pinned);\n\t}\n\n\tprivate createCompositeBarItem(id: string, name: string | undefined, order: number | undefined, pinned: boolean, visible: boolean): ICompositeBarModelItem {\n\t\tconst options = this.options;\n\t\treturn {\n\t\t\tid, name, pinned, order, visible,\n\t\t\tactivity: [],\n\t\t\tget activityAction() {\n\t\t\t\treturn options.getActivityAction(id);\n\t\t\t},\n\t\t\tget pinnedAction() {\n\t\t\t\treturn options.getCompositePinnedAction(id);\n\t\t\t},\n\t\t\tget toggleBadgeAction() {\n\t\t\t\treturn options.getCompositeBadgeAction(id);\n\t\t\t}\n\t\t};\n\t}\n\n\tadd(id: string, name: string, order: number | undefined, requestedIndex: number | undefined): boolean {\n\t\tconst item = this.findItem(id);\n\t\tif (item) {\n\t\t\tlet changed = false;\n\t\t\titem.name = name;\n\t\t\tif (!isUndefinedOrNull(order)) {\n\t\t\t\tchanged = item.order !== order;\n\t\t\t\titem.order = order;\n\t\t\t}\n\t\t\tif (!item.visible) {\n\t\t\t\titem.visible = true;\n\t\t\t\tchanged = true;\n\t\t\t}\n\n\t\t\treturn changed;\n\t\t} else {\n\t\t\tconst item = this.createCompositeBarItem(id, name, order, true, true);\n\t\t\tif (!isUndefinedOrNull(requestedIndex)) {\n\t\t\t\tlet index = 0;\n\t\t\t\tlet rIndex = requestedIndex;\n\t\t\t\twhile (rIndex > 0 && index < this.items.length) {\n\t\t\t\t\tif (this.items[index++].visible) {\n\t\t\t\t\t\trIndex--;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.items.splice(index, 0, item);\n\t\t\t} else if (isUndefinedOrNull(order)) {\n\t\t\t\tthis.items.push(item);\n\t\t\t} else {\n\t\t\t\tlet index = 0;\n\t\t\t\twhile (index < this.items.length && typeof this.items[index].order === 'number' && this.items[index].order! < order) {\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\t\t\t\tthis.items.splice(index, 0, item);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tremove(id: string): boolean {\n\t\tfor (let index = 0; index < this.items.length; index++) {\n\t\t\tif (this.items[index].id === id) {\n\t\t\t\tthis.items.splice(index, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\thide(id: string): boolean {\n\t\tfor (const item of this.items) {\n\t\t\tif (item.id === id) {\n\t\t\t\tif (item.visible) {\n\t\t\t\t\titem.visible = false;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tmove(compositeId: string, toCompositeId: string): boolean {\n\n\t\tconst fromIndex = this.findIndex(compositeId);\n\t\tconst toIndex = this.findIndex(toCompositeId);\n\n\t\t// Make sure both items are known to the model\n\t\tif (fromIndex === -1 || toIndex === -1) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst sourceItem = this.items.splice(fromIndex, 1)[0];\n\t\tthis.items.splice(toIndex, 0, sourceItem);\n\n\t\t// Make sure a moved composite gets pinned\n\t\tsourceItem.pinned = true;\n\n\t\treturn true;\n\t}\n\n\tsetPinned(id: string, pinned: boolean): boolean {\n\t\tfor (const item of this.items) {\n\t\t\tif (item.id === id) {\n\t\t\t\tif (item.pinned !== pinned) {\n\t\t\t\t\titem.pinned = pinned;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tactivate(id: string): boolean {\n\t\tif (!this.activeItem || this.activeItem.id !== id) {\n\t\t\tif (this.activeItem) {\n\t\t\t\tthis.deactivate();\n\t\t\t}\n\t\t\tfor (const item of this.items) {\n\t\t\t\tif (item.id === id) {\n\t\t\t\t\tthis.activeItem = item;\n\t\t\t\t\tthis.activeItem.activityAction.activate();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tdeactivate(): boolean {\n\t\tif (this.activeItem) {\n\t\t\tthis.activeItem.activityAction.deactivate();\n\t\t\tthis.activeItem = undefined;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfindItem(id: string): ICompositeBarModelItem {\n\t\treturn this.items.filter(item => item.id === id)[0];\n\t}\n\n\tprivate findIndex(id: string): number {\n\t\tfor (let index = 0; index < this.items.length; index++) {\n\t\t\tif (this.items[index].id === id) {\n\t\t\t\treturn index;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n}\n"]}