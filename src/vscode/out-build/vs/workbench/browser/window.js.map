{"version":3,"sources":["vs/workbench/browser/window.ts"],"names":[],"mappings":"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","file":"window.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isSafari, setFullscreen } from '../../base/browser/browser.js';\nimport { addDisposableListener, EventHelper, EventType, getActiveWindow, getWindow, getWindowById, getWindows, getWindowsCount, windowOpenNoOpener, windowOpenPopup, windowOpenWithSuccess } from '../../base/browser/dom.js';\nimport { DomEmitter } from '../../base/browser/event.js';\nimport { HidDeviceData, requestHidDevice, requestSerialPort, requestUsbDevice, SerialPortData, UsbDeviceData } from '../../base/browser/deviceAccess.js';\nimport { timeout } from '../../base/common/async.js';\nimport { Event } from '../../base/common/event.js';\nimport { Disposable, IDisposable, dispose, toDisposable } from '../../base/common/lifecycle.js';\nimport { matchesScheme, Schemas } from '../../base/common/network.js';\nimport { isIOS, isMacintosh } from '../../base/common/platform.js';\nimport Severity from '../../base/common/severity.js';\nimport { URI } from '../../base/common/uri.js';\nimport { localize } from '../../nls.js';\nimport { CommandsRegistry } from '../../platform/commands/common/commands.js';\nimport { IDialogService, IPromptButton } from '../../platform/dialogs/common/dialogs.js';\nimport { IInstantiationService, ServicesAccessor } from '../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../platform/label/common/label.js';\nimport { IOpenerService } from '../../platform/opener/common/opener.js';\nimport { IProductService } from '../../platform/product/common/productService.js';\nimport { IBrowserWorkbenchEnvironmentService } from '../services/environment/browser/environmentService.js';\nimport { IWorkbenchLayoutService } from '../services/layout/browser/layoutService.js';\nimport { BrowserLifecycleService } from '../services/lifecycle/browser/lifecycleService.js';\nimport { ILifecycleService, ShutdownReason } from '../services/lifecycle/common/lifecycle.js';\nimport { IHostService } from '../services/host/browser/host.js';\nimport { registerWindowDriver } from '../services/driver/browser/driver.js';\nimport { CodeWindow, isAuxiliaryWindow, mainWindow } from '../../base/browser/window.js';\nimport { createSingleCallFunction } from '../../base/common/functional.js';\nimport { IConfigurationService } from '../../platform/configuration/common/configuration.js';\nimport { IWorkbenchEnvironmentService } from '../services/environment/common/environmentService.js';\nimport { MarkdownString } from '../../base/common/htmlContent.js';\nimport { IContextMenuService } from '../../platform/contextview/browser/contextView.js';\n\nexport abstract class BaseWindow extends Disposable {\n\n\tprivate static TIMEOUT_HANDLES = Number.MIN_SAFE_INTEGER; // try to not compete with the IDs of native `setTimeout`\n\tprivate static readonly TIMEOUT_DISPOSABLES = new Map<number, Set<IDisposable>>();\n\n\tconstructor(\n\t\ttargetWindow: CodeWindow,\n\t\tdom = { getWindowsCount, getWindows }, /* for testing */\n\t\t@IHostService protected readonly hostService: IHostService,\n\t\t@IWorkbenchEnvironmentService protected readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IContextMenuService protected readonly contextMenuService: IContextMenuService,\n\t\t@IWorkbenchLayoutService protected readonly layoutService: IWorkbenchLayoutService,\n\t) {\n\t\tsuper();\n\n\t\tthis.enableWindowFocusOnElementFocus(targetWindow);\n\t\tthis.enableMultiWindowAwareTimeout(targetWindow, dom);\n\n\t\tthis.registerFullScreenListeners(targetWindow.vscodeWindowId);\n\t\tthis.registerContextMenuListeners(targetWindow);\n\t}\n\n\t//#region focus handling in multi-window applications\n\n\tprotected enableWindowFocusOnElementFocus(targetWindow: CodeWindow): void {\n\t\tconst originalFocus = targetWindow.HTMLElement.prototype.focus;\n\n\t\tconst that = this;\n\t\ttargetWindow.HTMLElement.prototype.focus = function (this: HTMLElement, options?: FocusOptions | undefined): void {\n\n\t\t\t// Ensure the window the element belongs to is focused\n\t\t\t// in scenarios where auxiliary windows are present\n\t\t\tthat.onElementFocus(getWindow(this));\n\n\t\t\t// Pass to original focus() method\n\t\t\toriginalFocus.apply(this, [options]);\n\t\t};\n\t}\n\n\tprivate onElementFocus(targetWindow: CodeWindow): void {\n\t\tconst activeWindow = getActiveWindow();\n\t\tif (activeWindow !== targetWindow && activeWindow.document.hasFocus()) {\n\n\t\t\t// Call original focus()\n\t\t\ttargetWindow.focus();\n\n\t\t\t// In Electron, `window.focus()` fails to bring the window\n\t\t\t// to the front if multiple windows exist in the same process\n\t\t\t// group (floating windows). As such, we ask the host service\n\t\t\t// to focus the window which can take care of bringin the\n\t\t\t// window to the front.\n\t\t\t//\n\t\t\t// To minimise disruption by bringing windows to the front\n\t\t\t// by accident, we only do this if the window is not already\n\t\t\t// focused and the active window is not the target window\n\t\t\t// but has focus. This is an indication that multiple windows\n\t\t\t// are opened in the same process group while the target window\n\t\t\t// is not focused.\n\n\t\t\tif (\n\t\t\t\t!this.environmentService.extensionTestsLocationURI &&\n\t\t\t\t!targetWindow.document.hasFocus()\n\t\t\t) {\n\t\t\t\tthis.hostService.focus(targetWindow);\n\t\t\t}\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region timeout handling in multi-window applications\n\n\tprotected enableMultiWindowAwareTimeout(targetWindow: Window, dom = { getWindowsCount, getWindows }): void {\n\n\t\t// Override `setTimeout` and `clearTimeout` on the provided window to make\n\t\t// sure timeouts are dispatched to all opened windows. Some browsers may decide\n\t\t// to throttle timeouts in minimized windows, so with this we can ensure the\n\t\t// timeout is scheduled without being throttled (unless all windows are minimized).\n\n\t\tconst originalSetTimeout = targetWindow.setTimeout;\n\t\tObject.defineProperty(targetWindow, 'vscodeOriginalSetTimeout', { get: () => originalSetTimeout });\n\n\t\tconst originalClearTimeout = targetWindow.clearTimeout;\n\t\tObject.defineProperty(targetWindow, 'vscodeOriginalClearTimeout', { get: () => originalClearTimeout });\n\n\t\ttargetWindow.setTimeout = function (this: unknown, handler: TimerHandler, timeout = 0, ...args: unknown[]): number {\n\t\t\tif (dom.getWindowsCount() === 1 || typeof handler === 'string' || timeout === 0 /* immediates are never throttled */) {\n\t\t\t\treturn originalSetTimeout.apply(this, [handler, timeout, ...args]);\n\t\t\t}\n\n\t\t\tconst timeoutDisposables = new Set<IDisposable>();\n\t\t\tconst timeoutHandle = BaseWindow.TIMEOUT_HANDLES++;\n\t\t\tBaseWindow.TIMEOUT_DISPOSABLES.set(timeoutHandle, timeoutDisposables);\n\n\t\t\tconst handlerFn = createSingleCallFunction(handler, () => {\n\t\t\t\tdispose(timeoutDisposables);\n\t\t\t\tBaseWindow.TIMEOUT_DISPOSABLES.delete(timeoutHandle);\n\t\t\t});\n\n\t\t\tfor (const { window, disposables } of dom.getWindows()) {\n\t\t\t\tif (isAuxiliaryWindow(window) && window.document.visibilityState === 'hidden') {\n\t\t\t\t\tcontinue; // skip over hidden windows (but never over main window)\n\t\t\t\t}\n\n\t\t\t\t// we track didClear in case the browser does not properly clear the timeout\n\t\t\t\t// this can happen for timeouts on unfocused windows\n\t\t\t\tlet didClear = false;\n\n\t\t\t\tconst handle = (window as { vscodeOriginalSetTimeout?: typeof window.setTimeout }).vscodeOriginalSetTimeout?.apply(this, [(...args: unknown[]) => {\n\t\t\t\t\tif (didClear) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\thandlerFn(...args);\n\t\t\t\t}, timeout, ...args]);\n\n\t\t\t\tconst timeoutDisposable = toDisposable(() => {\n\t\t\t\t\tdidClear = true;\n\t\t\t\t\t(window as { vscodeOriginalClearTimeout?: typeof window.clearTimeout }).vscodeOriginalClearTimeout?.apply(this, [handle]);\n\t\t\t\t\ttimeoutDisposables.delete(timeoutDisposable);\n\t\t\t\t});\n\n\t\t\t\tdisposables.add(timeoutDisposable);\n\t\t\t\ttimeoutDisposables.add(timeoutDisposable);\n\t\t\t}\n\n\t\t\treturn timeoutHandle;\n\t\t};\n\n\t\ttargetWindow.clearTimeout = function (this: unknown, timeoutHandle: number | undefined): void {\n\t\t\tconst timeoutDisposables = typeof timeoutHandle === 'number' ? BaseWindow.TIMEOUT_DISPOSABLES.get(timeoutHandle) : undefined;\n\t\t\tif (timeoutDisposables) {\n\t\t\t\tdispose(timeoutDisposables);\n\t\t\t\tBaseWindow.TIMEOUT_DISPOSABLES.delete(timeoutHandle!);\n\t\t\t} else {\n\t\t\t\toriginalClearTimeout.apply(this, [timeoutHandle]);\n\t\t\t}\n\t\t};\n\t}\n\n\t//#endregion\n\n\t//#region Confirm on Shutdown\n\n\tstatic async confirmOnShutdown(accessor: ServicesAccessor, reason: ShutdownReason): Promise<boolean> {\n\t\tconst dialogService = accessor.get(IDialogService);\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\n\t\tconst message = reason === ShutdownReason.QUIT ?\n\t\t\t(isMacintosh ? localize('quitMessageMac', \"Are you sure you want to quit?\") : localize('quitMessage', \"Are you sure you want to exit?\")) :\n\t\t\tlocalize('closeWindowMessage', \"Are you sure you want to close the window?\");\n\t\tconst primaryButton = reason === ShutdownReason.QUIT ?\n\t\t\t(isMacintosh ? localize({ key: 'quitButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Quit\") : localize({ key: 'exitButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Exit\")) :\n\t\t\tlocalize({ key: 'closeWindowButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Close Window\");\n\n\t\tconst res = await dialogService.confirm({\n\t\t\tmessage,\n\t\t\tprimaryButton,\n\t\t\tcheckbox: {\n\t\t\t\tlabel: localize('doNotAskAgain', \"Do not ask me again\")\n\t\t\t}\n\t\t});\n\n\t\t// Update setting if checkbox checked\n\t\tif (res.confirmed && res.checkboxChecked) {\n\t\t\tawait configurationService.updateValue('window.confirmBeforeClose', 'never');\n\t\t}\n\n\t\treturn res.confirmed;\n\t}\n\n\t//#endregion\n\n\tprivate registerFullScreenListeners(targetWindowId: number): void {\n\t\tthis._register(this.hostService.onDidChangeFullScreen(({ windowId, fullscreen }) => {\n\t\t\tif (windowId === targetWindowId) {\n\t\t\t\tconst targetWindow = getWindowById(targetWindowId);\n\t\t\t\tif (targetWindow) {\n\t\t\t\t\tsetFullscreen(fullscreen, targetWindow.window);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate registerContextMenuListeners(targetWindow: Window): void {\n\t\tif (targetWindow !== mainWindow) {\n\t\t\t// we only need to listen in the main window as the code\n\t\t\t// will go by the active container and update accordingly\n\t\t\treturn;\n\t\t}\n\n\t\tconst update = (visible: boolean) => this.layoutService.activeContainer.classList.toggle('context-menu-visible', visible);\n\t\tthis._register(this.contextMenuService.onDidShowContextMenu(() => update(true)));\n\t\tthis._register(this.contextMenuService.onDidHideContextMenu(() => update(false)));\n\t}\n}\n\nexport class BrowserWindow extends BaseWindow {\n\n\tconstructor(\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@ILifecycleService private readonly lifecycleService: BrowserLifecycleService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IBrowserWorkbenchEnvironmentService private readonly browserEnvironmentService: IBrowserWorkbenchEnvironmentService,\n\t\t@IWorkbenchLayoutService layoutService: IWorkbenchLayoutService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IHostService hostService: IHostService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t) {\n\t\tsuper(mainWindow, undefined, hostService, browserEnvironmentService, contextMenuService, layoutService);\n\n\t\tthis.registerListeners();\n\t\tthis.create();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Lifecycle\n\t\tthis._register(this.lifecycleService.onWillShutdown(() => this.onWillShutdown()));\n\n\t\t// Layout\n\t\tconst viewport = isIOS && mainWindow.visualViewport ? mainWindow.visualViewport /** Visual viewport */ : mainWindow /** Layout viewport */;\n\t\tthis._register(addDisposableListener(viewport, EventType.RESIZE, () => {\n\t\t\tthis.layoutService.layout();\n\n\t\t\t// Sometimes the keyboard appearing scrolls the whole workbench out of view, as a workaround scroll back into view #121206\n\t\t\tif (isIOS) {\n\t\t\t\tmainWindow.scrollTo(0, 0);\n\t\t\t}\n\t\t}));\n\n\t\t// Prevent the back/forward gestures in macOS\n\t\tthis._register(addDisposableListener(this.layoutService.mainContainer, EventType.WHEEL, e => e.preventDefault(), { passive: false }));\n\n\t\t// Prevent native context menus in web\n\t\tthis._register(addDisposableListener(this.layoutService.mainContainer, EventType.CONTEXT_MENU, e => EventHelper.stop(e, true)));\n\n\t\t// Prevent default navigation on drop\n\t\tthis._register(addDisposableListener(this.layoutService.mainContainer, EventType.DROP, e => EventHelper.stop(e, true)));\n\t}\n\n\tprivate onWillShutdown(): void {\n\n\t\t// Try to detect some user interaction with the workbench\n\t\t// when shutdown has happened to not show the dialog e.g.\n\t\t// when navigation takes a longer time.\n\t\tEvent.toPromise(Event.any(\n\t\t\tEvent.once(new DomEmitter(mainWindow.document.body, EventType.KEY_DOWN, true).event),\n\t\t\tEvent.once(new DomEmitter(mainWindow.document.body, EventType.MOUSE_DOWN, true).event)\n\t\t)).then(async () => {\n\n\t\t\t// Delay the dialog in case the user interacted\n\t\t\t// with the page before it transitioned away\n\t\t\tawait timeout(3000);\n\n\t\t\t// This should normally not happen, but if for some reason\n\t\t\t// the workbench was shutdown while the page is still there,\n\t\t\t// inform the user that only a reload can bring back a working\n\t\t\t// state.\n\t\t\tawait this.dialogService.prompt({\n\t\t\t\ttype: Severity.Error,\n\t\t\t\tmessage: localize('shutdownError', \"An unexpected error occurred that requires a reload of this page.\"),\n\t\t\t\tdetail: localize('shutdownErrorDetail', \"The workbench was unexpectedly disposed while running.\"),\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize({ key: 'reload', comment: ['&& denotes a mnemonic'] }, \"&&Reload\"),\n\t\t\t\t\t\trun: () => mainWindow.location.reload() // do not use any services at this point since they are likely not functional at this point\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate create(): void {\n\n\t\t// Handle open calls\n\t\tthis.setupOpenHandlers();\n\n\t\t// Label formatting\n\t\tthis.registerLabelFormatters();\n\n\t\t// Commands\n\t\tthis.registerCommands();\n\n\t\t// Smoke Test Driver\n\t\tthis.setupDriver();\n\t}\n\n\tprivate setupDriver(): void {\n\t\tif (this.environmentService.enableSmokeTestDriver) {\n\t\t\tregisterWindowDriver(this.instantiationService);\n\t\t}\n\t}\n\n\tprivate setupOpenHandlers(): void {\n\n\t\t// We need to ignore the `beforeunload` event while\n\t\t// we handle external links to open specifically for\n\t\t// the case of application protocols that e.g. invoke\n\t\t// vscode itself. We do not want to open these links\n\t\t// in a new window because that would leave a blank\n\t\t// window to the user, but using `window.location.href`\n\t\t// will trigger the `beforeunload`.\n\t\tthis.openerService.setDefaultExternalOpener({\n\t\t\topenExternal: async (href: string) => {\n\t\t\t\tlet isAllowedOpener = false;\n\t\t\t\tif (this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes) {\n\t\t\t\t\tfor (const trustedPopupPrefix of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes) {\n\t\t\t\t\t\tif (href.startsWith(trustedPopupPrefix)) {\n\t\t\t\t\t\t\tisAllowedOpener = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// HTTP(s): open in new window and deal with potential popup blockers\n\t\t\t\tif (matchesScheme(href, Schemas.http) || matchesScheme(href, Schemas.https)) {\n\t\t\t\t\tif (isSafari) {\n\t\t\t\t\t\tconst opened = windowOpenWithSuccess(href, !isAllowedOpener);\n\t\t\t\t\t\tif (!opened) {\n\t\t\t\t\t\t\tawait this.dialogService.prompt({\n\t\t\t\t\t\t\t\ttype: Severity.Warning,\n\t\t\t\t\t\t\t\tmessage: localize('unableToOpenExternal', \"The browser blocked opening a new tab or window. Press 'Retry' to try again.\"),\n\t\t\t\t\t\t\t\tcustom: {\n\t\t\t\t\t\t\t\t\tmarkdownDetails: [{ markdown: new MarkdownString(localize('unableToOpenWindowDetail', \"Please allow pop-ups for this website in your [browser settings]({0}).\", 'https://aka.ms/allow-vscode-popup'), true) }]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: localize({ key: 'retry', comment: ['&& denotes a mnemonic'] }, \"&&Retry\"),\n\t\t\t\t\t\t\t\t\t\trun: () => isAllowedOpener ? windowOpenPopup(href) : windowOpenNoOpener(href)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\tcancelButton: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isAllowedOpener) {\n\t\t\t\t\t\t\twindowOpenPopup(href);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindowOpenNoOpener(href);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Anything else: set location to trigger protocol handler in the browser\n\t\t\t\t// but make sure to signal this as an expected unload and disable unload\n\t\t\t\t// handling explicitly to prevent the workbench from going down.\n\t\t\t\telse {\n\t\t\t\t\tconst invokeProtocolHandler = () => {\n\t\t\t\t\t\tthis.lifecycleService.withExpectedShutdown({ disableShutdownHandling: true }, () => mainWindow.location.href = href);\n\t\t\t\t\t};\n\n\t\t\t\t\tinvokeProtocolHandler();\n\n\t\t\t\t\tconst showProtocolUrlOpenedDialog = async () => {\n\t\t\t\t\t\tconst { downloadUrl } = this.productService;\n\t\t\t\t\t\tlet detail: string;\n\n\t\t\t\t\t\tconst buttons: IPromptButton<void>[] = [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: localize({ key: 'openExternalDialogButtonRetry.v2', comment: ['&& denotes a mnemonic'] }, \"&&Try Again\"),\n\t\t\t\t\t\t\t\trun: () => invokeProtocolHandler()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t];\n\n\t\t\t\t\t\tif (downloadUrl !== undefined) {\n\t\t\t\t\t\t\tdetail = localize(\n\t\t\t\t\t\t\t\t'openExternalDialogDetail.v2',\n\t\t\t\t\t\t\t\t\"We launched {0} on your computer.\\n\\nIf {1} did not launch, try again or install it below.\",\n\t\t\t\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t\t\t\t\tthis.productService.nameLong\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tbuttons.push({\n\t\t\t\t\t\t\t\tlabel: localize({ key: 'openExternalDialogButtonInstall.v3', comment: ['&& denotes a mnemonic'] }, \"&&Install\"),\n\t\t\t\t\t\t\t\trun: async () => {\n\t\t\t\t\t\t\t\t\tawait this.openerService.open(URI.parse(downloadUrl));\n\n\t\t\t\t\t\t\t\t\t// Re-show the dialog so that the user can come back after installing and try again\n\t\t\t\t\t\t\t\t\tshowProtocolUrlOpenedDialog();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdetail = localize(\n\t\t\t\t\t\t\t\t'openExternalDialogDetailNoInstall',\n\t\t\t\t\t\t\t\t\"We launched {0} on your computer.\\n\\nIf {1} did not launch, try again below.\",\n\t\t\t\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t\t\t\t\tthis.productService.nameLong\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// While this dialog shows, closing the tab will not display a confirmation dialog\n\t\t\t\t\t\t// to avoid showing the user two dialogs at once\n\t\t\t\t\t\tawait this.hostService.withExpectedShutdown(() => this.dialogService.prompt({\n\t\t\t\t\t\t\ttype: Severity.Info,\n\t\t\t\t\t\t\tmessage: localize('openExternalDialogTitle', \"All done. You can close this tab now.\"),\n\t\t\t\t\t\t\tdetail,\n\t\t\t\t\t\t\tbuttons,\n\t\t\t\t\t\t\tcancelButton: true\n\t\t\t\t\t\t}));\n\t\t\t\t\t};\n\n\t\t\t\t\t// We cannot know whether the protocol handler succeeded.\n\t\t\t\t\t// Display guidance in case it did not, e.g. the app is not installed locally.\n\t\t\t\t\tif (matchesScheme(href, this.productService.urlProtocol)) {\n\t\t\t\t\t\tawait showProtocolUrlOpenedDialog();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate registerLabelFormatters(): void {\n\t\tthis._register(this.labelService.registerFormatter({\n\t\t\tscheme: Schemas.vscodeUserData,\n\t\t\tpriority: true,\n\t\t\tformatting: {\n\t\t\t\tlabel: '(Settings) ${path}',\n\t\t\t\tseparator: '/',\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate registerCommands(): void {\n\n\t\t// Allow extensions to request USB devices in Web\n\t\tCommandsRegistry.registerCommand('workbench.experimental.requestUsbDevice', async (_accessor: ServicesAccessor, options?: { filters?: unknown[] }): Promise<UsbDeviceData | undefined> => {\n\t\t\treturn requestUsbDevice(options);\n\t\t});\n\n\t\t// Allow extensions to request Serial devices in Web\n\t\tCommandsRegistry.registerCommand('workbench.experimental.requestSerialPort', async (_accessor: ServicesAccessor, options?: { filters?: unknown[] }): Promise<SerialPortData | undefined> => {\n\t\t\treturn requestSerialPort(options);\n\t\t});\n\n\t\t// Allow extensions to request HID devices in Web\n\t\tCommandsRegistry.registerCommand('workbench.experimental.requestHidDevice', async (_accessor: ServicesAccessor, options?: { filters?: unknown[] }): Promise<HidDeviceData | undefined> => {\n\t\t\treturn requestHidDevice(options);\n\t\t});\n\t}\n}\n"]}