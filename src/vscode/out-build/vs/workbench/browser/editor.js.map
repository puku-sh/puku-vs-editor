{"version":3,"sources":["vs/workbench/browser/editor.ts"],"names":[],"mappings":"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","file":"editor.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../nls.js';\nimport { EditorResourceAccessor, EditorExtensions, SideBySideEditor, IEditorDescriptor as ICommonEditorDescriptor, EditorCloseContext, IWillInstantiateEditorPaneEvent } from '../common/editor.js';\nimport { EditorInput } from '../common/editor/editorInput.js';\nimport { SyncDescriptor } from '../../platform/instantiation/common/descriptors.js';\nimport { Registry } from '../../platform/registry/common/platform.js';\nimport { EditorPane } from './parts/editor/editorPane.js';\nimport { IConstructorSignature, IInstantiationService, BrandedService, ServicesAccessor } from '../../platform/instantiation/common/instantiation.js';\nimport { IDisposable, toDisposable } from '../../base/common/lifecycle.js';\nimport { Promises } from '../../base/common/async.js';\nimport { IEditorService } from '../services/editor/common/editorService.js';\nimport { IUriIdentityService } from '../../platform/uriIdentity/common/uriIdentity.js';\nimport { IWorkingCopyService } from '../services/workingCopy/common/workingCopyService.js';\nimport { URI } from '../../base/common/uri.js';\nimport { Schemas } from '../../base/common/network.js';\nimport { IEditorGroup } from '../services/editor/common/editorGroupsService.js';\nimport { Iterable } from '../../base/common/iterator.js';\nimport { Emitter } from '../../base/common/event.js';\n\n//#region Editor Pane Registry\n\nexport interface IEditorPaneDescriptor extends ICommonEditorDescriptor<EditorPane> { }\n\nexport interface IEditorPaneRegistry {\n\n\t/**\n\t * Registers an editor pane to the platform for the given editor type. The second parameter also supports an\n\t * array of input classes to be passed in. If the more than one editor is registered for the same editor\n\t * input, the input itself will be asked which editor it prefers if this method is provided. Otherwise\n\t * the first editor in the list will be returned.\n\t *\n\t * @param editorDescriptors A set of constructor functions that return an instance of `EditorInput` for which the\n\t * registered editor should be used for.\n\t */\n\tregisterEditorPane(editorPaneDescriptor: IEditorPaneDescriptor, editorDescriptors: readonly SyncDescriptor<EditorInput>[]): IDisposable;\n\n\t/**\n\t * Returns the editor pane descriptor for the given editor or `undefined` if none.\n\t */\n\tgetEditorPane(editor: EditorInput): IEditorPaneDescriptor | undefined;\n}\n\n/**\n * A lightweight descriptor of an editor pane. The descriptor is deferred so that heavy editor\n * panes can load lazily in the workbench.\n */\nexport class EditorPaneDescriptor implements IEditorPaneDescriptor {\n\n\tprivate static readonly instantiatedEditorPanes = new Set<string>();\n\tstatic didInstantiateEditorPane(typeId: string): boolean {\n\t\treturn EditorPaneDescriptor.instantiatedEditorPanes.has(typeId);\n\t}\n\n\tprivate static readonly _onWillInstantiateEditorPane = new Emitter<IWillInstantiateEditorPaneEvent>();\n\tstatic readonly onWillInstantiateEditorPane = EditorPaneDescriptor._onWillInstantiateEditorPane.event;\n\n\tstatic create<Services extends BrandedService[]>(\n\t\tctor: { new(group: IEditorGroup, ...services: Services): EditorPane },\n\t\ttypeId: string,\n\t\tname: string\n\t): EditorPaneDescriptor {\n\t\treturn new EditorPaneDescriptor(ctor as IConstructorSignature<EditorPane, [IEditorGroup]>, typeId, name);\n\t}\n\n\tprivate constructor(\n\t\tprivate readonly ctor: IConstructorSignature<EditorPane, [IEditorGroup]>,\n\t\treadonly typeId: string,\n\t\treadonly name: string\n\t) { }\n\n\tinstantiate(instantiationService: IInstantiationService, group: IEditorGroup): EditorPane {\n\t\tEditorPaneDescriptor._onWillInstantiateEditorPane.fire({ typeId: this.typeId });\n\n\t\tconst pane = instantiationService.createInstance(this.ctor, group);\n\t\tEditorPaneDescriptor.instantiatedEditorPanes.add(this.typeId);\n\n\t\treturn pane;\n\t}\n\n\tdescribes(editorPane: EditorPane): boolean {\n\t\treturn editorPane.getId() === this.typeId;\n\t}\n}\n\nexport class EditorPaneRegistry implements IEditorPaneRegistry {\n\n\tprivate readonly mapEditorPanesToEditors = new Map<EditorPaneDescriptor, readonly SyncDescriptor<EditorInput>[]>();\n\n\tregisterEditorPane(editorPaneDescriptor: EditorPaneDescriptor, editorDescriptors: readonly SyncDescriptor<EditorInput>[]): IDisposable {\n\t\tthis.mapEditorPanesToEditors.set(editorPaneDescriptor, editorDescriptors);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis.mapEditorPanesToEditors.delete(editorPaneDescriptor);\n\t\t});\n\t}\n\n\tgetEditorPane(editor: EditorInput): EditorPaneDescriptor | undefined {\n\t\tconst descriptors = this.findEditorPaneDescriptors(editor);\n\n\t\tif (descriptors.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (descriptors.length === 1) {\n\t\t\treturn descriptors[0];\n\t\t}\n\n\t\treturn editor.prefersEditorPane(descriptors);\n\t}\n\n\tprivate findEditorPaneDescriptors(editor: EditorInput, byInstanceOf?: boolean): EditorPaneDescriptor[] {\n\t\tconst matchingEditorPaneDescriptors: EditorPaneDescriptor[] = [];\n\n\t\tfor (const editorPane of this.mapEditorPanesToEditors.keys()) {\n\t\t\tconst editorDescriptors = this.mapEditorPanesToEditors.get(editorPane) || [];\n\t\t\tfor (const editorDescriptor of editorDescriptors) {\n\t\t\t\tconst editorClass = editorDescriptor.ctor;\n\n\t\t\t\t// Direct check on constructor type (ignores prototype chain)\n\t\t\t\tif (!byInstanceOf && editor.constructor === editorClass) {\n\t\t\t\t\tmatchingEditorPaneDescriptors.push(editorPane);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Normal instanceof check\n\t\t\t\telse if (byInstanceOf && editor instanceof editorClass) {\n\t\t\t\t\tmatchingEditorPaneDescriptors.push(editorPane);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If no descriptors found, continue search using instanceof and prototype chain\n\t\tif (!byInstanceOf && matchingEditorPaneDescriptors.length === 0) {\n\t\t\treturn this.findEditorPaneDescriptors(editor, true);\n\t\t}\n\n\t\treturn matchingEditorPaneDescriptors;\n\t}\n\n\t//#region Used for tests only\n\n\tgetEditorPaneByType(typeId: string): EditorPaneDescriptor | undefined {\n\t\treturn Iterable.find(this.mapEditorPanesToEditors.keys(), editor => editor.typeId === typeId);\n\t}\n\n\tgetEditorPanes(): readonly EditorPaneDescriptor[] {\n\t\treturn Array.from(this.mapEditorPanesToEditors.keys());\n\t}\n\n\tgetEditors(): SyncDescriptor<EditorInput>[] {\n\t\tconst editorClasses: SyncDescriptor<EditorInput>[] = [];\n\t\tfor (const editorPane of this.mapEditorPanesToEditors.keys()) {\n\t\t\tconst editorDescriptors = this.mapEditorPanesToEditors.get(editorPane);\n\t\t\tif (editorDescriptors) {\n\t\t\t\teditorClasses.push(...editorDescriptors.map(editorDescriptor => editorDescriptor.ctor));\n\t\t\t}\n\t\t}\n\n\t\treturn editorClasses;\n\t}\n\n\t//#endregion\n}\n\nRegistry.add(EditorExtensions.EditorPane, new EditorPaneRegistry());\n\n//#endregion\n\n//#region Editor Close Tracker\n\nexport function whenEditorClosed(accessor: ServicesAccessor, resources: URI[]): Promise<void> {\n\tconst editorService = accessor.get(IEditorService);\n\tconst uriIdentityService = accessor.get(IUriIdentityService);\n\tconst workingCopyService = accessor.get(IWorkingCopyService);\n\n\treturn new Promise(resolve => {\n\t\tlet remainingResources = [...resources];\n\n\t\t// Observe any editor closing from this moment on\n\t\tconst listener = editorService.onDidCloseEditor(async event => {\n\t\t\tif (event.context === EditorCloseContext.MOVE) {\n\t\t\t\treturn; // ignore move events where the editor will open in another group\n\t\t\t}\n\n\t\t\tlet primaryResource = EditorResourceAccessor.getOriginalUri(event.editor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t\tlet secondaryResource = EditorResourceAccessor.getOriginalUri(event.editor, { supportSideBySide: SideBySideEditor.SECONDARY });\n\n\t\t\t// Specially handle an editor getting replaced: if the new active editor\n\t\t\t// matches any of the resources from the closed editor, ignore those\n\t\t\t// resources because they were actually not closed, but replaced.\n\t\t\t// (see https://github.com/microsoft/vscode/issues/134299)\n\t\t\tif (event.context === EditorCloseContext.REPLACE) {\n\t\t\t\tconst newPrimaryResource = EditorResourceAccessor.getOriginalUri(editorService.activeEditor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t\t\tconst newSecondaryResource = EditorResourceAccessor.getOriginalUri(editorService.activeEditor, { supportSideBySide: SideBySideEditor.SECONDARY });\n\n\t\t\t\tif (uriIdentityService.extUri.isEqual(primaryResource, newPrimaryResource)) {\n\t\t\t\t\tprimaryResource = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (uriIdentityService.extUri.isEqual(secondaryResource, newSecondaryResource)) {\n\t\t\t\t\tsecondaryResource = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove from resources to wait for being closed based on the\n\t\t\t// resources from editors that got closed\n\t\t\tremainingResources = remainingResources.filter(resource => {\n\n\t\t\t\t// Closing editor matches resource directly: remove from remaining\n\t\t\t\tif (uriIdentityService.extUri.isEqual(resource, primaryResource) || uriIdentityService.extUri.isEqual(resource, secondaryResource)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Closing editor is untitled with associated resource\n\t\t\t\t// that matches resource directly: remove from remaining\n\t\t\t\t// but only if the editor was not replaced, otherwise\n\t\t\t\t// saving an untitled with associated resource would\n\t\t\t\t// release the `--wait` call.\n\t\t\t\t// (see https://github.com/microsoft/vscode/issues/141237)\n\t\t\t\tif (event.context !== EditorCloseContext.REPLACE) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(primaryResource?.scheme === Schemas.untitled && uriIdentityService.extUri.isEqual(resource, primaryResource.with({ scheme: resource.scheme }))) ||\n\t\t\t\t\t\t(secondaryResource?.scheme === Schemas.untitled && uriIdentityService.extUri.isEqual(resource, secondaryResource.with({ scheme: resource.scheme })))\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Editor is not yet closed, so keep it in waiting mode\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\t// All resources to wait for being closed are closed\n\t\t\tif (remainingResources.length === 0) {\n\n\t\t\t\t// If auto save is configured with the default delay (1s) it is possible\n\t\t\t\t// to close the editor while the save still continues in the background. As such\n\t\t\t\t// we have to also check if the editors to track for are dirty and if so wait\n\t\t\t\t// for them to get saved.\n\t\t\t\tconst dirtyResources = resources.filter(resource => workingCopyService.isDirty(resource));\n\t\t\t\tif (dirtyResources.length > 0) {\n\t\t\t\t\tawait Promises.settled(dirtyResources.map(async resource => await new Promise<void>(resolve => {\n\t\t\t\t\t\tif (!workingCopyService.isDirty(resource)) {\n\t\t\t\t\t\t\treturn resolve(); // return early if resource is not dirty\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Otherwise resolve promise when resource is saved\n\t\t\t\t\t\tconst listener = workingCopyService.onDidChangeDirty(workingCopy => {\n\t\t\t\t\t\t\tif (!workingCopy.isDirty() && uriIdentityService.extUri.isEqual(resource, workingCopy.resource)) {\n\t\t\t\t\t\t\t\tlistener.dispose();\n\n\t\t\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})));\n\t\t\t\t}\n\n\t\t\t\tlistener.dispose();\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t});\n}\n\n//#endregion\n\n//#region ARIA\n\nexport function computeEditorAriaLabel(input: EditorInput, index: number | undefined, group: IEditorGroup | undefined, groupCount: number | undefined): string {\n\tlet ariaLabel = input.getAriaLabel();\n\tif (group && !group.isPinned(input)) {\n\t\tariaLabel = localize('preview', \"{0}, preview\", ariaLabel);\n\t}\n\n\tif (group?.isSticky(index ?? input)) {\n\t\tariaLabel = localize('pinned', \"{0}, pinned\", ariaLabel);\n\t}\n\n\t// Apply group information to help identify in\n\t// which group we are (only if more than one group\n\t// is actually opened)\n\tif (group && typeof groupCount === 'number' && groupCount > 1) {\n\t\tariaLabel = `${ariaLabel}, ${group.ariaLabel}`;\n\t}\n\n\treturn ariaLabel;\n}\n\n//#endregion\n"]}