{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/server/node/remoteAgentEnvironmentImpl.ts","vs/server/node/remoteAgentEnvironmentImpl.ts"],"names":[],"mappings":"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","file":"remoteAgentEnvironmentImpl.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../base/common/event.js';\nimport * as platform from '../../base/common/platform.js';\nimport * as performance from '../../base/common/performance.js';\nimport { URI } from '../../base/common/uri.js';\nimport { createURITransformer } from '../../base/common/uriTransformer.js';\nimport { IRemoteAgentEnvironmentDTO, IGetEnvironmentDataArguments, IGetExtensionHostExitInfoArguments } from '../../workbench/services/remote/common/remoteAgentEnvironmentChannel.js';\nimport { IServerEnvironmentService } from './serverEnvironmentService.js';\nimport { IServerChannel } from '../../base/parts/ipc/common/ipc.js';\nimport { transformOutgoingURIs } from '../../base/common/uriIpc.js';\nimport { listProcesses } from '../../base/node/ps.js';\nimport { getMachineInfo, collectWorkspaceStats } from '../../platform/diagnostics/node/diagnosticsService.js';\nimport { IDiagnosticInfoOptions, IDiagnosticInfo } from '../../platform/diagnostics/common/diagnostics.js';\nimport { basename } from '../../base/common/path.js';\nimport { ProcessItem } from '../../base/common/processes.js';\nimport { ServerConnectionToken, ServerConnectionTokenType } from './serverConnectionToken.js';\nimport { IExtensionHostStatusService } from './extensionHostStatusService.js';\nimport { IUserDataProfilesService } from '../../platform/userDataProfile/common/userDataProfile.js';\nimport { joinPath } from '../../base/common/resources.js';\nimport { ILogService } from '../../platform/log/common/log.js';\n\nexport class RemoteAgentEnvironmentChannel implements IServerChannel {\n\n\tprivate static _namePool = 1;\n\n\tconstructor(\n\t\tprivate readonly _connectionToken: ServerConnectionToken,\n\t\tprivate readonly _environmentService: IServerEnvironmentService,\n\t\tprivate readonly _userDataProfilesService: IUserDataProfilesService,\n\t\tprivate readonly _extensionHostStatusService: IExtensionHostStatusService,\n\t\tprivate readonly _logService: ILogService,\n\t) {\n\t}\n\n\tasync call(_: any, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\n\t\t\tcase 'getEnvironmentData': {\n\t\t\t\tconst args = <IGetEnvironmentDataArguments>arg;\n\t\t\t\tconst uriTransformer = createURITransformer(args.remoteAuthority);\n\n\t\t\t\tlet environmentData = await this._getEnvironmentData(args.profile);\n\t\t\t\tenvironmentData = transformOutgoingURIs(environmentData, uriTransformer);\n\n\t\t\t\treturn environmentData;\n\t\t\t}\n\n\t\t\tcase 'getExtensionHostExitInfo': {\n\t\t\t\tconst args = <IGetExtensionHostExitInfoArguments>arg;\n\t\t\t\treturn this._extensionHostStatusService.getExitInfo(args.reconnectionToken);\n\t\t\t}\n\n\t\t\tcase 'getDiagnosticInfo': {\n\t\t\t\tconst options = <IDiagnosticInfoOptions>arg;\n\t\t\t\tconst diagnosticInfo: IDiagnosticInfo = {\n\t\t\t\t\tmachineInfo: getMachineInfo()\n\t\t\t\t};\n\n\t\t\t\tconst processesPromise: Promise<ProcessItem | void> = options.includeProcesses ? listProcesses(process.pid) : Promise.resolve();\n\n\t\t\t\tlet workspaceMetadataPromises: Promise<void>[] = [];\n\t\t\t\tconst workspaceMetadata: { [key: string]: any } = {};\n\t\t\t\tif (options.folders) {\n\t\t\t\t\t// only incoming paths are transformed, so remote authority is unneeded.\n\t\t\t\t\tconst uriTransformer = createURITransformer('');\n\t\t\t\t\tconst folderPaths = options.folders\n\t\t\t\t\t\t.map(folder => URI.revive(uriTransformer.transformIncoming(folder)))\n\t\t\t\t\t\t.filter(uri => uri.scheme === 'file');\n\n\t\t\t\t\tworkspaceMetadataPromises = folderPaths.map(folder => {\n\t\t\t\t\t\treturn collectWorkspaceStats(folder.fsPath, ['node_modules', '.git'])\n\t\t\t\t\t\t\t.then(stats => {\n\t\t\t\t\t\t\t\tworkspaceMetadata[basename(folder.fsPath)] = stats;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all([processesPromise, ...workspaceMetadataPromises]).then(([processes, _]) => {\n\t\t\t\t\tdiagnosticInfo.processes = processes || undefined;\n\t\t\t\t\tdiagnosticInfo.workspaceMetadata = options.folders ? workspaceMetadata : undefined;\n\t\t\t\t\treturn diagnosticInfo;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(`IPC Command ${command} not found`);\n\t}\n\n\tlisten(_: any, event: string, arg: any): Event<any> {\n\t\tthrow new Error('Not supported');\n\t}\n\n\tprivate async _getEnvironmentData(profile?: string): Promise<IRemoteAgentEnvironmentDTO> {\n\t\tif (profile && !this._userDataProfilesService.profiles.some(p => p.id === profile)) {\n\t\t\tawait this._userDataProfilesService.createProfile(profile, profile);\n\t\t}\n\t\ttype ProcessWithGlibc = NodeJS.Process & {\n\t\t\tglibcVersion?: string;\n\t\t};\n\t\tlet isUnsupportedGlibc = false;\n\t\tif (process.platform === 'linux') {\n\t\t\tconst glibcVersion = (process as ProcessWithGlibc).glibcVersion;\n\t\t\tconst minorVersion = glibcVersion ? parseInt(glibcVersion.split('.')[1]) : 28;\n\t\t\tisUnsupportedGlibc = (minorVersion <= 27) || !!process.env['VSCODE_SERVER_CUSTOM_GLIBC_LINKER'];\n\t\t}\n\t\tthis._logService.trace(`[reconnection-grace-time] Server sending grace time to client: ${this._environmentService.reconnectionGraceTime}ms (${Math.floor(this._environmentService.reconnectionGraceTime / 1000)}s)`);\n\t\treturn {\n\t\t\tpid: process.pid,\n\t\t\tconnectionToken: (this._connectionToken.type !== ServerConnectionTokenType.None ? this._connectionToken.value : ''),\n\t\t\tappRoot: URI.file(this._environmentService.appRoot),\n\t\t\tsettingsPath: this._environmentService.machineSettingsResource,\n\t\t\tmcpResource: this._environmentService.mcpResource,\n\t\t\tlogsPath: this._environmentService.logsHome,\n\t\t\textensionHostLogsPath: joinPath(this._environmentService.logsHome, `exthost${RemoteAgentEnvironmentChannel._namePool++}`),\n\t\t\tglobalStorageHome: this._userDataProfilesService.defaultProfile.globalStorageHome,\n\t\t\tworkspaceStorageHome: this._environmentService.workspaceStorageHome,\n\t\t\tlocalHistoryHome: this._environmentService.localHistoryHome,\n\t\t\tuserHome: this._environmentService.userHome,\n\t\t\tos: platform.OS,\n\t\t\tarch: process.arch,\n\t\t\tmarks: performance.getMarks(),\n\t\t\tuseHostProxy: !!this._environmentService.args['use-host-proxy'],\n\t\t\tprofiles: {\n\t\t\t\thome: this._userDataProfilesService.profilesHome,\n\t\t\t\tall: [...this._userDataProfilesService.profiles].map(profile => ({ ...profile }))\n\t\t\t},\n\t\t\tisUnsupportedGlibc,\n\t\t\treconnectionGraceTime: this._environmentService.reconnectionGraceTime\n\t\t};\n\t}\n\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../base/common/event.js';\nimport * as platform from '../../base/common/platform.js';\nimport * as performance from '../../base/common/performance.js';\nimport { URI } from '../../base/common/uri.js';\nimport { createURITransformer } from '../../base/common/uriTransformer.js';\nimport { IRemoteAgentEnvironmentDTO, IGetEnvironmentDataArguments, IGetExtensionHostExitInfoArguments } from '../../workbench/services/remote/common/remoteAgentEnvironmentChannel.js';\nimport { IServerEnvironmentService } from './serverEnvironmentService.js';\nimport { IServerChannel } from '../../base/parts/ipc/common/ipc.js';\nimport { transformOutgoingURIs } from '../../base/common/uriIpc.js';\nimport { listProcesses } from '../../base/node/ps.js';\nimport { getMachineInfo, collectWorkspaceStats } from '../../platform/diagnostics/node/diagnosticsService.js';\nimport { IDiagnosticInfoOptions, IDiagnosticInfo } from '../../platform/diagnostics/common/diagnostics.js';\nimport { basename } from '../../base/common/path.js';\nimport { ProcessItem } from '../../base/common/processes.js';\nimport { ServerConnectionToken, ServerConnectionTokenType } from './serverConnectionToken.js';\nimport { IExtensionHostStatusService } from './extensionHostStatusService.js';\nimport { IUserDataProfilesService } from '../../platform/userDataProfile/common/userDataProfile.js';\nimport { joinPath } from '../../base/common/resources.js';\nimport { ILogService } from '../../platform/log/common/log.js';\n\nexport class RemoteAgentEnvironmentChannel implements IServerChannel {\n\n\tprivate static _namePool = 1;\n\n\tconstructor(\n\t\tprivate readonly _connectionToken: ServerConnectionToken,\n\t\tprivate readonly _environmentService: IServerEnvironmentService,\n\t\tprivate readonly _userDataProfilesService: IUserDataProfilesService,\n\t\tprivate readonly _extensionHostStatusService: IExtensionHostStatusService,\n\t\tprivate readonly _logService: ILogService,\n\t) {\n\t}\n\n\tasync call(_: any, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\n\t\t\tcase 'getEnvironmentData': {\n\t\t\t\tconst args = <IGetEnvironmentDataArguments>arg;\n\t\t\t\tconst uriTransformer = createURITransformer(args.remoteAuthority);\n\n\t\t\t\tlet environmentData = await this._getEnvironmentData(args.profile);\n\t\t\t\tenvironmentData = transformOutgoingURIs(environmentData, uriTransformer);\n\n\t\t\t\treturn environmentData;\n\t\t\t}\n\n\t\t\tcase 'getExtensionHostExitInfo': {\n\t\t\t\tconst args = <IGetExtensionHostExitInfoArguments>arg;\n\t\t\t\treturn this._extensionHostStatusService.getExitInfo(args.reconnectionToken);\n\t\t\t}\n\n\t\t\tcase 'getDiagnosticInfo': {\n\t\t\t\tconst options = <IDiagnosticInfoOptions>arg;\n\t\t\t\tconst diagnosticInfo: IDiagnosticInfo = {\n\t\t\t\t\tmachineInfo: getMachineInfo()\n\t\t\t\t};\n\n\t\t\t\tconst processesPromise: Promise<ProcessItem | void> = options.includeProcesses ? listProcesses(process.pid) : Promise.resolve();\n\n\t\t\t\tlet workspaceMetadataPromises: Promise<void>[] = [];\n\t\t\t\tconst workspaceMetadata: { [key: string]: any } = {};\n\t\t\t\tif (options.folders) {\n\t\t\t\t\t// only incoming paths are transformed, so remote authority is unneeded.\n\t\t\t\t\tconst uriTransformer = createURITransformer('');\n\t\t\t\t\tconst folderPaths = options.folders\n\t\t\t\t\t\t.map(folder => URI.revive(uriTransformer.transformIncoming(folder)))\n\t\t\t\t\t\t.filter(uri => uri.scheme === 'file');\n\n\t\t\t\t\tworkspaceMetadataPromises = folderPaths.map(folder => {\n\t\t\t\t\t\treturn collectWorkspaceStats(folder.fsPath, ['node_modules', '.git'])\n\t\t\t\t\t\t\t.then(stats => {\n\t\t\t\t\t\t\t\tworkspaceMetadata[basename(folder.fsPath)] = stats;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all([processesPromise, ...workspaceMetadataPromises]).then(([processes, _]) => {\n\t\t\t\t\tdiagnosticInfo.processes = processes || undefined;\n\t\t\t\t\tdiagnosticInfo.workspaceMetadata = options.folders ? workspaceMetadata : undefined;\n\t\t\t\t\treturn diagnosticInfo;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(`IPC Command ${command} not found`);\n\t}\n\n\tlisten(_: any, event: string, arg: any): Event<any> {\n\t\tthrow new Error('Not supported');\n\t}\n\n\tprivate async _getEnvironmentData(profile?: string): Promise<IRemoteAgentEnvironmentDTO> {\n\t\tif (profile && !this._userDataProfilesService.profiles.some(p => p.id === profile)) {\n\t\t\tawait this._userDataProfilesService.createProfile(profile, profile);\n\t\t}\n\t\ttype ProcessWithGlibc = NodeJS.Process & {\n\t\t\tglibcVersion?: string;\n\t\t};\n\t\tlet isUnsupportedGlibc = false;\n\t\tif (process.platform === 'linux') {\n\t\t\tconst glibcVersion = (process as ProcessWithGlibc).glibcVersion;\n\t\t\tconst minorVersion = glibcVersion ? parseInt(glibcVersion.split('.')[1]) : 28;\n\t\t\tisUnsupportedGlibc = (minorVersion <= 27) || !!process.env['VSCODE_SERVER_CUSTOM_GLIBC_LINKER'];\n\t\t}\n\t\tthis._logService.trace(`[reconnection-grace-time] Server sending grace time to client: ${this._environmentService.reconnectionGraceTime}ms (${Math.floor(this._environmentService.reconnectionGraceTime / 1000)}s)`);\n\t\treturn {\n\t\t\tpid: process.pid,\n\t\t\tconnectionToken: (this._connectionToken.type !== ServerConnectionTokenType.None ? this._connectionToken.value : ''),\n\t\t\tappRoot: URI.file(this._environmentService.appRoot),\n\t\t\tsettingsPath: this._environmentService.machineSettingsResource,\n\t\t\tmcpResource: this._environmentService.mcpResource,\n\t\t\tlogsPath: this._environmentService.logsHome,\n\t\t\textensionHostLogsPath: joinPath(this._environmentService.logsHome, `exthost${RemoteAgentEnvironmentChannel._namePool++}`),\n\t\t\tglobalStorageHome: this._userDataProfilesService.defaultProfile.globalStorageHome,\n\t\t\tworkspaceStorageHome: this._environmentService.workspaceStorageHome,\n\t\t\tlocalHistoryHome: this._environmentService.localHistoryHome,\n\t\t\tuserHome: this._environmentService.userHome,\n\t\t\tos: platform.OS,\n\t\t\tarch: process.arch,\n\t\t\tmarks: performance.getMarks(),\n\t\t\tuseHostProxy: !!this._environmentService.args['use-host-proxy'],\n\t\t\tprofiles: {\n\t\t\t\thome: this._userDataProfilesService.profilesHome,\n\t\t\t\tall: [...this._userDataProfilesService.profiles].map(profile => ({ ...profile }))\n\t\t\t},\n\t\t\tisUnsupportedGlibc,\n\t\t\treconnectionGraceTime: this._environmentService.reconnectionGraceTime\n\t\t};\n\t}\n\n}\n"]}