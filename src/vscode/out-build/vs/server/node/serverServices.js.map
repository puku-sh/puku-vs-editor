{"version":3,"sources":["vs/server/node/serverServices.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,IAAI,CAAC;AACvC,OAAO,EAAE,OAAO,EAAS,MAAM,4BAA4B,CAAC;AAC5D,OAAO,EAAmB,YAAY,EAAE,MAAM,gCAAgC,CAAC;AAC/E,OAAO,EAAE,OAAO,EAAE,MAAM,8BAA8B,CAAC;AACvD,OAAO,KAAK,IAAI,MAAM,2BAA2B,CAAC;AAElD,OAAO,EAAE,YAAY,EAAE,eAAe,EAAE,cAAc,EAAE,MAAM,uBAAuB,CAAC;AACtF,OAAO,EAAE,QAAQ,EAAE,MAAM,wBAAwB,CAAC;AAClD,OAAO,EAAkD,SAAS,EAAE,YAAY,EAAE,MAAM,oCAAoC,CAAC;AAE7H,OAAO,EAAE,qBAAqB,EAAE,MAAM,sDAAsD,CAAC;AAC7F,OAAO,EAAE,oBAAoB,EAAE,MAAM,6DAA6D,CAAC;AACnG,OAAO,EAAE,kCAAkC,EAAE,MAAM,sDAAsD,CAAC;AAC1G,OAAO,EAAE,gBAAgB,EAAE,MAAM,4CAA4C,CAAC;AAC9E,OAAO,EAAE,4BAA4B,EAAE,MAAM,+CAA+C,CAAC;AAC7F,OAAO,EAAE,mBAAmB,EAAE,yBAAyB,EAAE,MAAM,kDAAkD,CAAC;AAClH,OAAO,EAAE,2CAA2C,EAAE,MAAM,sEAAsE,CAAC;AACnI,OAAO,EAAE,yBAAyB,EAAE,wBAAwB,EAAE,MAAM,kEAAkE,CAAC;AACvI,OAAO,EAAE,qCAAqC,EAAE,sCAAsC,EAAE,MAAM,kFAAkF,CAAC;AACjL,OAAO,EAAE,sBAAsB,EAAE,MAAM,qEAAqE,CAAC;AAC7G,OAAO,EAAE,0BAA0B,EAAE,MAAM,qEAAqE,CAAC;AACjH,OAAO,EAAE,0BAA0B,EAAE,uCAAuC,EAAE,MAAM,uEAAuE,CAAC;AAC5J,OAAO,EAAE,YAAY,EAAE,MAAM,sCAAsC,CAAC;AACpE,OAAO,EAAE,WAAW,EAAE,MAAM,4CAA4C,CAAC;AACzE,OAAO,EAAE,sBAAsB,EAAE,MAAM,qDAAqD,CAAC;AAC7F,OAAO,EAAE,cAAc,EAAE,MAAM,oDAAoD,CAAC;AAEpF,OAAO,EAAE,oBAAoB,EAAE,MAAM,6DAA6D,CAAC;AACnG,OAAO,EAAE,iBAAiB,EAAE,MAAM,0DAA0D,CAAC;AAC7F,OAAO,EAAE,oBAAoB,EAAE,MAAM,sDAAsD,CAAC;AAC5F,OAAO,EAAE,yBAAyB,EAAE,MAAM,oDAAoD,CAAC;AAC/F,OAAO,EAAE,cAAc,EAAE,iBAAiB,EAAE,WAAW,EAAE,cAAc,EAAE,WAAW,EAAE,GAAG,EAAE,QAAQ,EAAE,gBAAgB,EAAE,MAAM,kCAAkC,CAAC;AAChK,OAAO,OAAO,MAAM,0CAA0C,CAAC;AAC/D,OAAO,EAAE,eAAe,EAAE,MAAM,iDAAiD,CAAC;AAElF,OAAO,EAAE,eAAe,EAAE,MAAM,0CAA0C,CAAC;AAC3E,OAAO,EAAE,cAAc,EAAE,MAAM,6CAA6C,CAAC;AAC7E,OAAO,EAAE,cAAc,EAAE,MAAM,+CAA+C,CAAC;AAC/E,OAAO,EAAE,uBAAuB,EAAE,MAAM,qDAAqD,CAAC;AAC9F,OAAO,EAAE,iBAAiB,EAAkB,MAAM,8CAA8C,CAAC;AAEjG,OAAO,EAAE,0BAA0B,EAAE,mBAAmB,EAAE,aAAa,EAAsB,YAAY,EAAE,iBAAiB,EAAE,MAAM,mDAAmD,CAAC;AACxL,OAAO,cAAc,MAAM,iDAAiD,CAAC;AAC7E,OAAO,EAAE,WAAW,EAAqB,MAAM,4CAA4C,CAAC;AAC5F,OAAO,EAAE,cAAc,EAAE,MAAM,gDAAgD,CAAC;AAChF,OAAO,EAAE,mBAAmB,EAAE,MAAM,kDAAkD,CAAC;AACvF,OAAO,EAAE,kBAAkB,EAAE,MAAM,yDAAyD,CAAC;AAC7F,OAAO,EAAE,6BAA6B,EAAE,MAAM,iCAAiC,CAAC;AAChF,OAAO,EAAE,oCAAoC,EAAE,MAAM,qCAAqC,CAAC;AAC3F,OAAO,EAAE,sBAAsB,EAAE,MAAM,2DAA2D,CAAC;AACnG,OAAO,EAAE,uBAAuB,EAAE,0BAA0B,EAAE,sBAAsB,EAAE,MAAM,2DAA2D,CAAC;AACxJ,OAAO,EAAE,qBAAqB,EAAE,MAAM,4BAA4B,CAAC;AACnE,OAAO,EAAE,oBAAoB,EAAE,MAAM,qCAAqC,CAAC;AAE3E,OAAO,EAAE,wBAAwB,EAAoB,MAAM,+BAA+B,CAAC;AAC3F,OAAO,EAAE,4BAA4B,EAAE,MAAM,yEAAyE,CAAC;AACvH,OAAO,EAAE,+BAA+B,EAAE,MAAM,0EAA0E,CAAC;AAC3H,OAAO,EAAE,0BAA0B,EAAE,2BAA2B,EAAE,MAAM,iCAAiC,CAAC;AAC1G,OAAO,EAAE,yBAAyB,EAAE,MAAM,uEAAuE,CAAC;AAClH,OAAO,EAAE,wBAAwB,EAAE,MAAM,+BAA+B,CAAC;AACzE,OAAO,EAAE,gCAAgC,EAAE,MAAM,8EAA8E,CAAC;AAChI,OAAO,EAAE,wBAAwB,EAAE,MAAM,0DAA0D,CAAC;AACpG,OAAO,EAAE,iBAAiB,EAAE,MAAM,wCAAwC,CAAC;AAC3E,OAAO,EAAE,qBAAqB,EAAE,MAAM,8CAA8C,CAAC;AACrF,OAAO,EAAE,aAAa,EAAE,MAAM,0CAA0C,CAAC;AACzE,OAAO,EAAE,6BAA6B,EAAE,MAAM,wDAAwD,CAAC;AACvG,OAAO,EAAE,+BAA+B,EAAE,MAAM,4EAA4E,CAAC;AAC7H,OAAO,EAAE,UAAU,EAAE,MAAM,yCAAyC,CAAC;AACrE,OAAO,EAAE,aAAa,EAAE,MAAM,qCAAqC,CAAC;AACpE,OAAO,EAAE,QAAQ,EAAE,MAAM,cAAc,CAAC;AACxC,OAAO,EAAE,8BAA8B,EAAE,8BAA8B,EAAE,MAAM,8BAA8B,CAAC;AAC9G,OAAO,EAAE,kCAAkC,EAAE,MAAM,yDAAyD,CAAC;AAC7G,OAAO,EAAE,oCAAoC,EAAE,MAAM,6DAA6D,CAAC;AACnH,OAAO,EAAE,kBAAkB,EAAE,MAAM,oDAAoD,CAAC;AACxF,OAAO,EAAE,qBAAqB,EAAE,sBAAsB,EAAE,MAAM,6CAA6C,CAAC;AAC5G,OAAO,EAAE,wBAAwB,EAAE,MAAM,uEAAuE,CAAC;AACjH,OAAO,EAAE,oBAAoB,EAAE,MAAM,yDAAyD,CAAC;AAC/F,OAAO,EAAE,gCAAgC,EAAE,mCAAmC,EAAE,MAAM,uDAAuD,CAAC;AAC9I,OAAO,EAAE,+BAA+B,EAAE,MAAM,4DAA4D,CAAC;AAC7G,OAAO,EAAE,+BAA+B,EAAE,MAAM,4DAA4D,CAAC;AAC7G,OAAO,EAAE,gCAAgC,EAAE,MAAM,uEAAuE,CAAC;AACzH,OAAO,EAAE,kCAAkC,EAAE,MAAM,iFAAiF,CAAC;AACrI,OAAO,EAAE,yBAAyB,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,MAAM,4CAA4C,CAAC;AAClI,OAAO,EAAE,oBAAoB,EAAE,MAAM,iDAAiD,CAAC;AACvF,OAAO,EAAE,iBAAiB,EAAE,MAAM,gDAAgD,CAAC;AACnF,OAAO,EAAE,0BAA0B,EAAE,yBAAyB,EAAE,MAAM,wDAAwD,CAAC;AAC/H,OAAO,EAAE,oBAAoB,EAAE,MAAM,+CAA+C,CAAC;AACrF,OAAO,EAAE,wBAAwB,EAAE,MAAM,uDAAuD,CAAC;AACjG,OAAO,EAAE,0BAA0B,EAAE,MAAM,iDAAiD,CAAC;AAC7F,OAAO,EAAE,4BAA4B,EAAE,MAAM,2DAA2D,CAAC;AAEzG,MAAM,WAAW,GAAG,iBAAiB,CAAC;AAEtC,MAAM,CAAC,KAAK,UAAU,mBAAmB,CAAC,eAAsC,EAAE,IAAsB,EAAE,kBAA0B,EAAE,WAA4B;IACjK,MAAM,QAAQ,GAAG,IAAI,iBAAiB,EAAE,CAAC;IACzC,MAAM,YAAY,GAAG,IAAI,YAAY,EAAgC,CAAC;IAEtE,MAAM,cAAc,GAAoB,EAAE,aAAa,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,CAAC;IACjF,QAAQ,CAAC,GAAG,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC;IAE9C,MAAM,kBAAkB,GAAG,IAAI,wBAAwB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;IAC9E,QAAQ,CAAC,GAAG,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC;IACtD,QAAQ,CAAC,GAAG,CAAC,yBAAyB,EAAE,kBAAkB,CAAC,CAAC;IAE5D,MAAM,aAAa,GAAG,IAAI,aAAa,CAAC,WAAW,CAAC,kBAAkB,CAAC,EAAE,kBAAkB,CAAC,QAAQ,CAAC,CAAC;IACtG,QAAQ,CAAC,GAAG,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;IAC5C,YAAY,CAAC,eAAe,CAAC,QAAQ,EAAE,IAAI,aAAa,CAAC,aAAa,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;IAExJ,MAAM,MAAM,GAAG,aAAa,CAAC,YAAY,CAAC,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAoB,EAAE,IAAQ,CAAC,EAAE,CAAC,CAAC;IAC7G,MAAM,UAAU,GAAG,IAAI,UAAU,CAAC,MAAM,EAAE,CAAC,IAAI,YAAY,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,CAAC;IAC/F,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC;IACtC,UAAU,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;IACtJ,UAAU,CAAC,mBAAmB,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,EAAE,wBAAwB,gBAAgB,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAEzI,UAAU,CAAC,KAAK,CAAC,gCAAgC,kBAAkB,EAAE,CAAC,CAAC;IACvE,UAAU,CAAC,KAAK,CAAC,oBAAoB,EAAE,kBAAkB,CAAC,IAAI,CAAC,CAAC;IAChE,IAAI,KAAK,CAAC,OAAO,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE,CAAC;QAClD,UAAU,CAAC,IAAI,CAAC,OAAO,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACxE,CAAC;IAED,wCAAwC;IACxC,YAAY,CAAC,eAAe,CAAC,kCAAkC,CAAC,WAAW,EAAE,IAAI,kCAAkC,EAAE,CAAC,CAAC;IAEvH,uDAAuD;IACvD,MAAM,MAAM,GAAG,IAAI,YAAY,CAA+B,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,UAAU,CAAC,CAAC;IAElG,QAAQ;IACR,MAAM,WAAW,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC;IACjE,QAAQ,CAAC,GAAG,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;IACxC,WAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;IAEpG,eAAe;IACf,MAAM,kBAAkB,GAAG,IAAI,kBAAkB,CAAC,WAAW,CAAC,CAAC;IAC/D,QAAQ,CAAC,GAAG,CAAC,mBAAmB,EAAE,kBAAkB,CAAC,CAAC;IAEtD,gBAAgB;IAChB,MAAM,oBAAoB,GAAG,IAAI,oBAAoB,CAAC,kBAAkB,CAAC,uBAAuB,EAAE,WAAW,EAAE,IAAI,iBAAiB,EAAE,EAAE,UAAU,CAAC,CAAC;IACpJ,QAAQ,CAAC,GAAG,CAAC,qBAAqB,EAAE,oBAAoB,CAAC,CAAC;IAE1D,qBAAqB;IACrB,MAAM,uBAAuB,GAAG,IAAI,6BAA6B,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,WAAW,EAAE,UAAU,CAAC,CAAC;IACnI,QAAQ,CAAC,GAAG,CAAC,wBAAwB,EAAE,uBAAuB,CAAC,CAAC;IAChE,YAAY,CAAC,eAAe,CAAC,kBAAkB,EAAE,IAAI,oCAAoC,CAAC,uBAAuB,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;IAEnM,kCAAkC;IAClC,QAAQ,CAAC,GAAG,CAAC,sBAAsB,EAAE,IAAI,cAAc,CAAC,qBAAqB,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC;IAEjG,aAAa;IACb,MAAM,CAAC,EAAC,AAAC,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC;QAC7D,oBAAoB,CAAC,UAAU,EAAE;QACjC,uBAAuB,CAAC,IAAI,EAAE;QAC9B,YAAY,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC/C,eAAe,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAClD,cAAc,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;KACjD,CAAC,CAAC;IAEH,MAAM,0BAA0B,GAAG,IAAI,0BAA0B,EAAE,CAAC;IACpE,QAAQ,CAAC,GAAG,CAAC,2BAA2B,EAAE,0BAA0B,CAAC,CAAC;IAEtE,UAAU;IACV,MAAM,cAAc,GAAG,IAAI,cAAc,CAAC,QAAQ,EAAE,oBAAoB,EAAE,kBAAkB,EAAE,UAAU,CAAC,CAAC;IAC1G,QAAQ,CAAC,GAAG,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC;IAE9C,IAAI,aAAa,GAAuB,YAAY,CAAC;IACrD,MAAM,UAAU,GAAG,mBAAmB,CAAC,cAAc,EAAE,oBAAoB,CAAC,CAAC;IAC7E,IAAI,iBAAiB,CAAC,cAAc,EAAE,kBAAkB,CAAC,EAAE,CAAC;QAC3D,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,kBAAkB,CAAC,IAAI,cAAc,CAAC,QAAQ,EAAE,OAAO,EAAE,CAAC;YAC5F,aAAa,GAAG,IAAI,qBAAqB,CAAC,cAAc,EAAE,UAAU,EAAE,WAAW,EAAE,IAAI,EAAE,cAAc,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YAC1H,WAAW,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,aAAa,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,uEAAuE;QACrI,CAAC;QAED,MAAM,MAAM,GAA4B;YACvC,SAAS,EAAE,CAAC,aAAa,EAAE,IAAI,oBAAoB,CAAC,EAAE,EAAE,IAAI,EAAE,aAAa,EAAE,kBAAkB,EAAE,cAAc,CAAC,CAAC;YACjH,gBAAgB,EAAE,uBAAuB,CAAC,OAAO,EAAE,EAAE,QAAQ,EAAE,EAAE,OAAO,CAAC,IAAI,EAAE,cAAc,CAAC,MAAM,EAAE,cAAc,CAAC,OAAO,GAAG,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,EAAE,UAAU,EAAE,cAAc,CAAC,IAAI,EAAE,aAAa,CAAC;YACxN,QAAQ,EAAE,0BAA0B,CAAC,kBAAkB,CAAC;SACxD,CAAC;QACF,MAAM,wBAAwB,GAAG,kBAAkB,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAC5E,IAAI,sBAAsB,+BAAuC,CAAC;QAClE,sFAAsF;QACtF,IAAI,wBAAwB,KAAK,KAAK,EAAE,CAAC;YACxC,sBAAsB,+BAAuB,CAAC;QAC/C,CAAC;aAAM,IAAI,wBAAwB,KAAK,OAAO,EAAE,CAAC;YACjD,sBAAsB,+BAAuB,CAAC;QAC/C,CAAC;aAAM,IAAI,wBAAwB,KAAK,OAAO,EAAE,CAAC;YACjD,sBAAsB,+BAAuB,CAAC;QAC/C,CAAC;aAAM,IAAI,wBAAwB,KAAK,SAAS,EAAE,CAAC;YACnD,sBAAsB,8BAAsB,CAAC;QAC9C,CAAC;QACD,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,IAAI,cAAc,CAAC,sBAAsB,EAAE,CAAC,MAAM,EAAE,sBAAsB,CAAC,CAAC,CAAC,CAAC;IACrH,CAAC;SAAM,CAAC;QACP,QAAQ,CAAC,GAAG,CAAC,uBAAuB,EAAE,0BAA0B,CAAC,CAAC;IACnE,CAAC;IAED,QAAQ,CAAC,GAAG,CAAC,gCAAgC,EAAE,IAAI,kCAAkC,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC,CAAC;IACrH,QAAQ,CAAC,GAAG,CAAC,0BAA0B,EAAE,IAAI,4BAA4B,CAAC,YAAY,CAAC,CAAC,CAAC;IACzF,QAAQ,CAAC,GAAG,CAAC,wBAAwB,EAAE,IAAI,cAAc,CAAC,2CAA2C,CAAC,CAAC,CAAC;IAExG,MAAM,eAAe,GAAG,YAAY,CAAC,UAAU,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;IACpE,QAAQ,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,4BAA4B,CAAC,eAAe,EAAE,GAAG,EAAE,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC,0DAA0D,CAAC,CAAC,CAAC;IAElL,QAAQ,CAAC,GAAG,CAAC,gCAAgC,EAAE,IAAI,cAAc,CAAC,+BAA+B,CAAC,CAAC,CAAC;IACpG,QAAQ,CAAC,GAAG,CAAC,yBAAyB,EAAE,IAAI,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACtF,QAAQ,CAAC,GAAG,CAAC,sCAAsC,EAAE,IAAI,cAAc,CAAC,qCAAqC,CAAC,CAAC,CAAC;IAChH,QAAQ,CAAC,GAAG,CAAC,yBAAyB,EAAE,IAAI,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACtF,QAAQ,CAAC,GAAG,CAAC,uCAAuC,EAAE,IAAI,cAAc,CAAC,0BAA0B,CAAC,CAAC,CAAC;IACtG,QAAQ,CAAC,GAAG,CAAC,gCAAgC,EAAE,IAAI,cAAc,CAAC,+BAA+B,CAAC,CAAC,CAAC;IAEpG,MAAM,oBAAoB,GAA0B,IAAI,oBAAoB,CAAC,QAAQ,CAAC,CAAC;IACvF,QAAQ,CAAC,GAAG,CAAC,oBAAoB,EAAE,oBAAoB,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC,CAAC;IAEnG,MAAM,cAAc,GAAG,oBAAoB,CAAC,cAAc,CACzD,kBAAkB,EAClB;QACC,SAAS,EAAE,kBAAkB,CAAC,qBAAqB;QACnD,cAAc,EAAE,kBAAkB,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,4DAA+C,kBAAkB,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC,CAAC;QACnK,UAAU,EAAE,oBAAoB,CAAC,QAAQ,uGAAuD,IAAI,GAAG;KACvG,CACD,CAAC;IACF,MAAM,cAAc,GAAG,oBAAoB,CAAC,cAAc,CAAC,cAAc,EAAE,cAAc,CAAC,CAAC;IAC3F,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;IAE1C,QAAQ,CAAC,GAAG,CAAC,yBAAyB,EAAE,IAAI,cAAc,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACtF,QAAQ,CAAC,GAAG,CAAC,0BAA0B,EAAE,IAAI,cAAc,CAAC,yBAAyB,CAAC,CAAC,CAAC;IACxF,QAAQ,CAAC,GAAG,CAAC,kBAAkB,EAAE,IAAI,cAAc,CAAC,iBAAiB,CAAC,CAAC,CAAC;IACxE,QAAQ,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,cAAc,CAAC,oBAAoB,CAAC,CAAC,CAAC;IAE9E,oBAAoB,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;QAC9C,MAAM,oBAAoB,GAAG,QAAQ,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;QACjE,MAAM,0BAA0B,GAAG,QAAQ,CAAC,GAAG,CAAC,uCAAuC,CAAC,CAAC;QACzF,MAAM,wBAAwB,GAAG,QAAQ,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;QACzE,MAAM,uBAAuB,GAAG,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;QACvE,MAAM,mBAAmB,GAAG,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;QAC/D,MAAM,iCAAiC,GAAG,IAAI,6BAA6B,CAAC,eAAe,EAAE,kBAAkB,EAAE,uBAAuB,EAAE,0BAA0B,EAAE,UAAU,CAAC,CAAC;QAClL,YAAY,CAAC,eAAe,CAAC,6BAA6B,EAAE,iCAAiC,CAAC,CAAC;QAE/F,MAAM,gBAAgB,GAAG,IAAI,sBAAsB,CAAC,QAAQ,CAAC,GAAG,CAAC,uBAAuB,CAAC,EAAE,aAAa,CAAC,CAAC;QAC1G,YAAY,CAAC,eAAe,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;QAE5D,YAAY,CAAC,eAAe,CAAC,4BAA4B,EAAE,IAAI,qBAAqB,CAAC,kBAAkB,EAAE,UAAU,EAAE,cAAc,EAAE,cAAc,EAAE,0BAA0B,EAAE,oBAAoB,CAAC,CAAC,CAAC;QAExM,MAAM,uBAAuB,GAAG,IAAI,8BAA8B,CAAC,oBAAoB,CAAC,cAAc,CAAC,sBAAsB,EAAE,UAAU,CAAC,EAAE,kBAAkB,EAAE,uBAAuB,EAAE,wBAAwB,EAAE,UAAU,EAAE,uBAAuB,EAAE,mBAAmB,EAAE,0BAA0B,CAAC,CAAC;QACzS,YAAY,CAAC,eAAe,CAAC,kCAAkC,EAAE,IAAI,8BAA8B,CAAC,uBAAuB,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAE7M,YAAY,CAAC,eAAe,CAAC,mCAAmC,EAAE,oBAAoB,CAAC,cAAc,CAAC,+BAA+B,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAEvN,MAAM,uBAAuB,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,oCAAoC,CAAC,UAAU,EAAE,kBAAkB,EAAE,oBAAoB,CAAC,CAAC,CAAC;QAChJ,YAAY,CAAC,eAAe,CAAC,+BAA+B,EAAE,uBAAuB,CAAC,CAAC;QAEvF,YAAY,CAAC,eAAe,CAAC,SAAS,EAAE,IAAI,cAAc,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAE3F,MAAM,OAAO,GAAG,IAAI,0BAA0B,CAAC,0BAA0B,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC;QAC1J,YAAY,CAAC,eAAe,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;QAEpD,YAAY,CAAC,eAAe,CAAC,eAAe,EAAE,IAAI,oBAAoB,CAAC,oBAAoB,EAAE,CAAC,GAAiC,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAE7K,6BAA6B;QAC7B,uBAAuB,CAAC,mBAAmB,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,0BAA0B,CAAC,OAAO,EAAE,CAAC,CAAC;QAE/F,WAAW,CAAC,GAAG,CAAC,IAAI,cAAc,CAAC,QAAQ,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;QAErE,OAAO;YACN,gBAAgB,EAAE,QAAQ,CAAC,GAAG,CAAC,iBAAiB,CAAC;SACjD,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,OAAO,EAAE,YAAY,EAAE,oBAAoB,EAAE,CAAC;AAC/C,CAAC;AAED,MAAM,oBAAoB,GAAmD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAEjG,SAAS,iBAAiB,CAAC,eAAuB;IACjD,IAAI,CAAC,oBAAoB,CAAC,eAAe,CAAC,EAAE,CAAC;QAC5C,oBAAoB,CAAC,eAAe,CAAC,GAAG,oBAAoB,CAAC,eAAe,CAAC,CAAC;IAC/E,CAAC;IACD,OAAO,oBAAoB,CAAC,eAAe,CAAC,CAAC;AAC9C,CAAC;AAED,MAAM,OAAO,YAAgC,SAAQ,SAAmB;IAIvE;QACC,MAAM,OAAO,GAAG,IAAI,OAAO,EAAyB,CAAC;QACrD,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACrB,IAAI,CAAC,oBAAoB,GAAG,OAAO,CAAC;IACrC,CAAC;IAEM,gBAAgB,CAAC,QAAiC,EAAE,qBAAkC;QAC5F,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,qBAAqB,EAAE,CAAC,CAAC;IACrE,CAAC;CACD;AAED,MAAM,YAAa,SAAQ,cAAc;IAGxC,YAAY,WAAqB,iBAAiB;QACjD,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACxB,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IAChD,CAAC;IAED,KAAK,CAAC,OAAe,EAAE,GAAG,IAAe;QACxC,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;gBACpB,OAAO,CAAC,GAAG,CAAC,YAAY,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC5D,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC7C,CAAC;QACF,CAAC;IACF,CAAC;IAED,KAAK,CAAC,OAAe,EAAE,GAAG,IAAe;QACxC,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;gBACpB,OAAO,CAAC,GAAG,CAAC,YAAY,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC5D,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC7C,CAAC;QACF,CAAC;IACF,CAAC;IAED,IAAI,CAAC,OAAe,EAAE,GAAG,IAAe;QACvC,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;YAChC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;gBACpB,OAAO,CAAC,GAAG,CAAC,YAAY,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC5D,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC7C,CAAC;QACF,CAAC;IACF,CAAC;IAED,IAAI,CAAC,OAAuB,EAAE,GAAG,IAAe;QAC/C,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;YACnC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;gBACpB,OAAO,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC7D,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,IAAI,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC9C,CAAC;QACF,CAAC;IACF,CAAC;IAED,KAAK,CAAC,OAAe,EAAE,GAAG,IAAe;QACxC,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;YACjC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;gBACpB,OAAO,CAAC,KAAK,CAAC,YAAY,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC9D,CAAC;iBAAM,CAAC;gBACP,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;YAC/C,CAAC;QACF,CAAC;IACF,CAAC;IAED,KAAK;QACJ,OAAO;IACR,CAAC;CACD;AAED,SAAS,GAAG;IACX,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;IACxB,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,EAAE,CAAC;AACxG,CAAC;AAED,SAAS,SAAS,CAAC,CAAS;IAC3B,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC;QACZ,OAAO,IAAI,CAAC,EAAE,CAAC;IAChB,CAAC;IACD,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC;AAClB,CAAC;AAED;;GAEG;AACH,KAAK,UAAU,gBAAgB,CAAC,QAAgB;IAC/C,MAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;IAC3C,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IACxC,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAClD,MAAM,WAAW,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACxE,MAAM,WAAW,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,UAAU,CAAC,CAAC;IACvE,MAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;IAE3E,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AACjF,CAAC","file":"serverServices.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { hostname, release } from 'os';\nimport { Emitter, Event } from '../../base/common/event.js';\nimport { DisposableStore, toDisposable } from '../../base/common/lifecycle.js';\nimport { Schemas } from '../../base/common/network.js';\nimport * as path from '../../base/common/path.js';\nimport { IURITransformer } from '../../base/common/uriIpc.js';\nimport { getMachineId, getSqmMachineId, getDevDeviceId } from '../../base/node/id.js';\nimport { Promises } from '../../base/node/pfs.js';\nimport { ClientConnectionEvent, IMessagePassingProtocol, IPCServer, StaticRouter } from '../../base/parts/ipc/common/ipc.js';\nimport { ProtocolConstants } from '../../base/parts/ipc/common/ipc.net.js';\nimport { IConfigurationService } from '../../platform/configuration/common/configuration.js';\nimport { ConfigurationService } from '../../platform/configuration/common/configurationService.js';\nimport { ExtensionHostDebugBroadcastChannel } from '../../platform/debug/common/extensionHostDebugIpc.js';\nimport { IDownloadService } from '../../platform/download/common/download.js';\nimport { DownloadServiceChannelClient } from '../../platform/download/common/downloadIpc.js';\nimport { IEnvironmentService, INativeEnvironmentService } from '../../platform/environment/common/environment.js';\nimport { ExtensionGalleryServiceWithNoStorageService } from '../../platform/extensionManagement/common/extensionGalleryService.js';\nimport { IAllowedExtensionsService, IExtensionGalleryService } from '../../platform/extensionManagement/common/extensionManagement.js';\nimport { ExtensionSignatureVerificationService, IExtensionSignatureVerificationService } from '../../platform/extensionManagement/node/extensionSignatureVerificationService.js';\nimport { ExtensionManagementCLI } from '../../platform/extensionManagement/common/extensionManagementCLI.js';\nimport { ExtensionManagementChannel } from '../../platform/extensionManagement/common/extensionManagementIpc.js';\nimport { ExtensionManagementService, INativeServerExtensionManagementService } from '../../platform/extensionManagement/node/extensionManagementService.js';\nimport { IFileService } from '../../platform/files/common/files.js';\nimport { FileService } from '../../platform/files/common/fileService.js';\nimport { DiskFileSystemProvider } from '../../platform/files/node/diskFileSystemProvider.js';\nimport { SyncDescriptor } from '../../platform/instantiation/common/descriptors.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { InstantiationService } from '../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../platform/instantiation/common/serviceCollection.js';\nimport { ILanguagePackService } from '../../platform/languagePacks/common/languagePacks.js';\nimport { NativeLanguagePackService } from '../../platform/languagePacks/node/languagePacks.js';\nimport { AbstractLogger, DEFAULT_LOG_LEVEL, getLogLevel, ILoggerService, ILogService, log, LogLevel, LogLevelToString } from '../../platform/log/common/log.js';\nimport product from '../../platform/product/common/product.js';\nimport { IProductService } from '../../platform/product/common/productService.js';\nimport { RemoteAgentConnectionContext } from '../../platform/remote/common/remoteAgentEnvironment.js';\nimport { IRequestService } from '../../platform/request/common/request.js';\nimport { RequestChannel } from '../../platform/request/common/requestIpc.js';\nimport { RequestService } from '../../platform/request/node/requestService.js';\nimport { resolveCommonProperties } from '../../platform/telemetry/common/commonProperties.js';\nimport { ITelemetryService, TelemetryLevel } from '../../platform/telemetry/common/telemetry.js';\nimport { ITelemetryServiceConfig } from '../../platform/telemetry/common/telemetryService.js';\nimport { getPiiPathsFromEnvironment, isInternalTelemetry, isLoggingOnly, ITelemetryAppender, NullAppender, supportsTelemetry } from '../../platform/telemetry/common/telemetryUtils.js';\nimport ErrorTelemetry from '../../platform/telemetry/node/errorTelemetry.js';\nimport { IPtyService, TerminalSettingId } from '../../platform/terminal/common/terminal.js';\nimport { PtyHostService } from '../../platform/terminal/node/ptyHostService.js';\nimport { IUriIdentityService } from '../../platform/uriIdentity/common/uriIdentity.js';\nimport { UriIdentityService } from '../../platform/uriIdentity/common/uriIdentityService.js';\nimport { RemoteAgentEnvironmentChannel } from './remoteAgentEnvironmentImpl.js';\nimport { RemoteAgentFileSystemProviderChannel } from './remoteFileSystemProviderServer.js';\nimport { ServerTelemetryChannel } from '../../platform/telemetry/common/remoteTelemetryChannel.js';\nimport { IServerTelemetryService, ServerNullTelemetryService, ServerTelemetryService } from '../../platform/telemetry/common/serverTelemetryService.js';\nimport { RemoteTerminalChannel } from './remoteTerminalChannel.js';\nimport { createURITransformer } from '../../base/common/uriTransformer.js';\nimport { ServerConnectionToken } from './serverConnectionToken.js';\nimport { ServerEnvironmentService, ServerParsedArgs } from './serverEnvironmentService.js';\nimport { REMOTE_TERMINAL_CHANNEL_NAME } from '../../workbench/contrib/terminal/common/remote/remoteTerminalChannel.js';\nimport { REMOTE_FILE_SYSTEM_CHANNEL_NAME } from '../../workbench/services/remote/common/remoteFileSystemProviderClient.js';\nimport { ExtensionHostStatusService, IExtensionHostStatusService } from './extensionHostStatusService.js';\nimport { IExtensionsScannerService } from '../../platform/extensionManagement/common/extensionsScannerService.js';\nimport { ExtensionsScannerService } from './extensionsScannerService.js';\nimport { IExtensionsProfileScannerService } from '../../platform/extensionManagement/common/extensionsProfileScannerService.js';\nimport { IUserDataProfilesService } from '../../platform/userDataProfile/common/userDataProfile.js';\nimport { NullPolicyService } from '../../platform/policy/common/policy.js';\nimport { OneDataSystemAppender } from '../../platform/telemetry/node/1dsAppender.js';\nimport { LoggerService } from '../../platform/log/node/loggerService.js';\nimport { ServerUserDataProfilesService } from '../../platform/userDataProfile/node/userDataProfile.js';\nimport { ExtensionsProfileScannerService } from '../../platform/extensionManagement/node/extensionsProfileScannerService.js';\nimport { LogService } from '../../platform/log/common/logService.js';\nimport { LoggerChannel } from '../../platform/log/common/logIpc.js';\nimport { localize } from '../../nls.js';\nimport { RemoteExtensionsScannerChannel, RemoteExtensionsScannerService } from './remoteExtensionsScanner.js';\nimport { RemoteExtensionsScannerChannelName } from '../../platform/remote/common/remoteExtensionsScanner.js';\nimport { RemoteUserDataProfilesServiceChannel } from '../../platform/userDataProfile/common/userDataProfileIpc.js';\nimport { NodePtyHostStarter } from '../../platform/terminal/node/nodePtyHostStarter.js';\nimport { CSSDevelopmentService, ICSSDevelopmentService } from '../../platform/cssDev/node/cssDevService.js';\nimport { AllowedExtensionsService } from '../../platform/extensionManagement/common/allowedExtensionsService.js';\nimport { TelemetryLogAppender } from '../../platform/telemetry/common/telemetryLogAppender.js';\nimport { INativeMcpDiscoveryHelperService, NativeMcpDiscoveryHelperChannelName } from '../../platform/mcp/common/nativeMcpDiscoveryHelper.js';\nimport { NativeMcpDiscoveryHelperChannel } from '../../platform/mcp/node/nativeMcpDiscoveryHelperChannel.js';\nimport { NativeMcpDiscoveryHelperService } from '../../platform/mcp/node/nativeMcpDiscoveryHelperService.js';\nimport { IExtensionGalleryManifestService } from '../../platform/extensionManagement/common/extensionGalleryManifest.js';\nimport { ExtensionGalleryManifestIPCService } from '../../platform/extensionManagement/common/extensionGalleryManifestServiceIpc.js';\nimport { IAllowedMcpServersService, IMcpGalleryService, IMcpManagementService } from '../../platform/mcp/common/mcpManagement.js';\nimport { McpManagementService } from '../../platform/mcp/node/mcpManagementService.js';\nimport { McpGalleryService } from '../../platform/mcp/common/mcpGalleryService.js';\nimport { IMcpResourceScannerService, McpResourceScannerService } from '../../platform/mcp/common/mcpResourceScannerService.js';\nimport { McpManagementChannel } from '../../platform/mcp/common/mcpManagementIpc.js';\nimport { AllowedMcpServersService } from '../../platform/mcp/common/allowedMcpServersService.js';\nimport { IMcpGalleryManifestService } from '../../platform/mcp/common/mcpGalleryManifest.js';\nimport { McpGalleryManifestIPCService } from '../../platform/mcp/common/mcpGalleryManifestServiceIpc.js';\n\nconst eventPrefix = 'monacoworkbench';\n\nexport async function setupServerServices(connectionToken: ServerConnectionToken, args: ServerParsedArgs, REMOTE_DATA_FOLDER: string, disposables: DisposableStore) {\n\tconst services = new ServiceCollection();\n\tconst socketServer = new SocketServer<RemoteAgentConnectionContext>();\n\n\tconst productService: IProductService = { _serviceBrand: undefined, ...product };\n\tservices.set(IProductService, productService);\n\n\tconst environmentService = new ServerEnvironmentService(args, productService);\n\tservices.set(IEnvironmentService, environmentService);\n\tservices.set(INativeEnvironmentService, environmentService);\n\n\tconst loggerService = new LoggerService(getLogLevel(environmentService), environmentService.logsHome);\n\tservices.set(ILoggerService, loggerService);\n\tsocketServer.registerChannel('logger', new LoggerChannel(loggerService, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority)));\n\n\tconst logger = loggerService.createLogger('remoteagent', { name: localize('remoteExtensionLog', \"Server\") });\n\tconst logService = new LogService(logger, [new ServerLogger(getLogLevel(environmentService))]);\n\tservices.set(ILogService, logService);\n\tsetTimeout(() => cleanupOlderLogs(environmentService.logsHome.with({ scheme: Schemas.file }).fsPath).then(null, err => logService.error(err)), 10000);\n\tlogService.onDidChangeLogLevel(logLevel => log(logService, logLevel, `Log level changed to ${LogLevelToString(logService.getLevel())}`));\n\n\tlogService.trace(`Remote configuration data at ${REMOTE_DATA_FOLDER}`);\n\tlogService.trace('process arguments:', environmentService.args);\n\tif (Array.isArray(productService.serverGreeting)) {\n\t\tlogService.info(`\\n\\n${productService.serverGreeting.join('\\n')}\\n\\n`);\n\t}\n\n\t// ExtensionHost Debug broadcast service\n\tsocketServer.registerChannel(ExtensionHostDebugBroadcastChannel.ChannelName, new ExtensionHostDebugBroadcastChannel());\n\n\t// TODO: @Sandy @Joao need dynamic context based router\n\tconst router = new StaticRouter<RemoteAgentConnectionContext>(ctx => ctx.clientId === 'renderer');\n\n\t// Files\n\tconst fileService = disposables.add(new FileService(logService));\n\tservices.set(IFileService, fileService);\n\tfileService.registerProvider(Schemas.file, disposables.add(new DiskFileSystemProvider(logService)));\n\n\t// URI Identity\n\tconst uriIdentityService = new UriIdentityService(fileService);\n\tservices.set(IUriIdentityService, uriIdentityService);\n\n\t// Configuration\n\tconst configurationService = new ConfigurationService(environmentService.machineSettingsResource, fileService, new NullPolicyService(), logService);\n\tservices.set(IConfigurationService, configurationService);\n\n\t// User Data Profiles\n\tconst userDataProfilesService = new ServerUserDataProfilesService(uriIdentityService, environmentService, fileService, logService);\n\tservices.set(IUserDataProfilesService, userDataProfilesService);\n\tsocketServer.registerChannel('userDataProfiles', new RemoteUserDataProfilesServiceChannel(userDataProfilesService, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority)));\n\n\t// Dev Only: CSS service (for ESM)\n\tservices.set(ICSSDevelopmentService, new SyncDescriptor(CSSDevelopmentService, undefined, true));\n\n\t// Initialize\n\tconst [, , machineId, sqmId, devDeviceId] = await Promise.all([\n\t\tconfigurationService.initialize(),\n\t\tuserDataProfilesService.init(),\n\t\tgetMachineId(logService.error.bind(logService)),\n\t\tgetSqmMachineId(logService.error.bind(logService)),\n\t\tgetDevDeviceId(logService.error.bind(logService))\n\t]);\n\n\tconst extensionHostStatusService = new ExtensionHostStatusService();\n\tservices.set(IExtensionHostStatusService, extensionHostStatusService);\n\n\t// Request\n\tconst requestService = new RequestService('remote', configurationService, environmentService, logService);\n\tservices.set(IRequestService, requestService);\n\n\tlet oneDsAppender: ITelemetryAppender = NullAppender;\n\tconst isInternal = isInternalTelemetry(productService, configurationService);\n\tif (supportsTelemetry(productService, environmentService)) {\n\t\tif (!isLoggingOnly(productService, environmentService) && productService.aiConfig?.ariaKey) {\n\t\t\toneDsAppender = new OneDataSystemAppender(requestService, isInternal, eventPrefix, null, productService.aiConfig.ariaKey);\n\t\t\tdisposables.add(toDisposable(() => oneDsAppender?.flush())); // Ensure the AI appender is disposed so that it flushes remaining data\n\t\t}\n\n\t\tconst config: ITelemetryServiceConfig = {\n\t\t\tappenders: [oneDsAppender, new TelemetryLogAppender('', true, loggerService, environmentService, productService)],\n\t\t\tcommonProperties: resolveCommonProperties(release(), hostname(), process.arch, productService.commit, productService.version + '-remote', machineId, sqmId, devDeviceId, isInternal, productService.date, 'remoteAgent'),\n\t\t\tpiiPaths: getPiiPathsFromEnvironment(environmentService)\n\t\t};\n\t\tconst initialTelemetryLevelArg = environmentService.args['telemetry-level'];\n\t\tlet injectedTelemetryLevel: TelemetryLevel = TelemetryLevel.USAGE;\n\t\t// Convert the passed in CLI argument into a telemetry level for the telemetry service\n\t\tif (initialTelemetryLevelArg === 'all') {\n\t\t\tinjectedTelemetryLevel = TelemetryLevel.USAGE;\n\t\t} else if (initialTelemetryLevelArg === 'error') {\n\t\t\tinjectedTelemetryLevel = TelemetryLevel.ERROR;\n\t\t} else if (initialTelemetryLevelArg === 'crash') {\n\t\t\tinjectedTelemetryLevel = TelemetryLevel.CRASH;\n\t\t} else if (initialTelemetryLevelArg !== undefined) {\n\t\t\tinjectedTelemetryLevel = TelemetryLevel.NONE;\n\t\t}\n\t\tservices.set(IServerTelemetryService, new SyncDescriptor(ServerTelemetryService, [config, injectedTelemetryLevel]));\n\t} else {\n\t\tservices.set(IServerTelemetryService, ServerNullTelemetryService);\n\t}\n\n\tservices.set(IExtensionGalleryManifestService, new ExtensionGalleryManifestIPCService(socketServer, productService));\n\tservices.set(IMcpGalleryManifestService, new McpGalleryManifestIPCService(socketServer));\n\tservices.set(IExtensionGalleryService, new SyncDescriptor(ExtensionGalleryServiceWithNoStorageService));\n\n\tconst downloadChannel = socketServer.getChannel('download', router);\n\tservices.set(IDownloadService, new DownloadServiceChannelClient(downloadChannel, () => getUriTransformer('renderer') /* TODO: @Sandy @Joao need dynamic context based router */));\n\n\tservices.set(IExtensionsProfileScannerService, new SyncDescriptor(ExtensionsProfileScannerService));\n\tservices.set(IExtensionsScannerService, new SyncDescriptor(ExtensionsScannerService));\n\tservices.set(IExtensionSignatureVerificationService, new SyncDescriptor(ExtensionSignatureVerificationService));\n\tservices.set(IAllowedExtensionsService, new SyncDescriptor(AllowedExtensionsService));\n\tservices.set(INativeServerExtensionManagementService, new SyncDescriptor(ExtensionManagementService));\n\tservices.set(INativeMcpDiscoveryHelperService, new SyncDescriptor(NativeMcpDiscoveryHelperService));\n\n\tconst instantiationService: IInstantiationService = new InstantiationService(services);\n\tservices.set(ILanguagePackService, instantiationService.createInstance(NativeLanguagePackService));\n\n\tconst ptyHostStarter = instantiationService.createInstance(\n\t\tNodePtyHostStarter,\n\t\t{\n\t\t\tgraceTime: environmentService.reconnectionGraceTime,\n\t\t\tshortGraceTime: environmentService.reconnectionGraceTime > 0 ? Math.min(ProtocolConstants.ReconnectionShortGraceTime, environmentService.reconnectionGraceTime) : 0,\n\t\t\tscrollback: configurationService.getValue<number>(TerminalSettingId.PersistentSessionScrollback) ?? 100\n\t\t}\n\t);\n\tconst ptyHostService = instantiationService.createInstance(PtyHostService, ptyHostStarter);\n\tservices.set(IPtyService, ptyHostService);\n\n\tservices.set(IAllowedMcpServersService, new SyncDescriptor(AllowedMcpServersService));\n\tservices.set(IMcpResourceScannerService, new SyncDescriptor(McpResourceScannerService));\n\tservices.set(IMcpGalleryService, new SyncDescriptor(McpGalleryService));\n\tservices.set(IMcpManagementService, new SyncDescriptor(McpManagementService));\n\n\tinstantiationService.invokeFunction(accessor => {\n\t\tconst mcpManagementService = accessor.get(IMcpManagementService);\n\t\tconst extensionManagementService = accessor.get(INativeServerExtensionManagementService);\n\t\tconst extensionsScannerService = accessor.get(IExtensionsScannerService);\n\t\tconst extensionGalleryService = accessor.get(IExtensionGalleryService);\n\t\tconst languagePackService = accessor.get(ILanguagePackService);\n\t\tconst remoteExtensionEnvironmentChannel = new RemoteAgentEnvironmentChannel(connectionToken, environmentService, userDataProfilesService, extensionHostStatusService, logService);\n\t\tsocketServer.registerChannel('remoteextensionsenvironment', remoteExtensionEnvironmentChannel);\n\n\t\tconst telemetryChannel = new ServerTelemetryChannel(accessor.get(IServerTelemetryService), oneDsAppender);\n\t\tsocketServer.registerChannel('telemetry', telemetryChannel);\n\n\t\tsocketServer.registerChannel(REMOTE_TERMINAL_CHANNEL_NAME, new RemoteTerminalChannel(environmentService, logService, ptyHostService, productService, extensionManagementService, configurationService));\n\n\t\tconst remoteExtensionsScanner = new RemoteExtensionsScannerService(instantiationService.createInstance(ExtensionManagementCLI, logService), environmentService, userDataProfilesService, extensionsScannerService, logService, extensionGalleryService, languagePackService, extensionManagementService);\n\t\tsocketServer.registerChannel(RemoteExtensionsScannerChannelName, new RemoteExtensionsScannerChannel(remoteExtensionsScanner, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority)));\n\n\t\tsocketServer.registerChannel(NativeMcpDiscoveryHelperChannelName, instantiationService.createInstance(NativeMcpDiscoveryHelperChannel, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority)));\n\n\t\tconst remoteFileSystemChannel = disposables.add(new RemoteAgentFileSystemProviderChannel(logService, environmentService, configurationService));\n\t\tsocketServer.registerChannel(REMOTE_FILE_SYSTEM_CHANNEL_NAME, remoteFileSystemChannel);\n\n\t\tsocketServer.registerChannel('request', new RequestChannel(accessor.get(IRequestService)));\n\n\t\tconst channel = new ExtensionManagementChannel(extensionManagementService, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority));\n\t\tsocketServer.registerChannel('extensions', channel);\n\n\t\tsocketServer.registerChannel('mcpManagement', new McpManagementChannel(mcpManagementService, (ctx: RemoteAgentConnectionContext) => getUriTransformer(ctx.remoteAuthority)));\n\n\t\t// clean up extensions folder\n\t\tremoteExtensionsScanner.whenExtensionsReady().then(() => extensionManagementService.cleanUp());\n\n\t\tdisposables.add(new ErrorTelemetry(accessor.get(ITelemetryService)));\n\n\t\treturn {\n\t\t\ttelemetryService: accessor.get(ITelemetryService)\n\t\t};\n\t});\n\n\treturn { socketServer, instantiationService };\n}\n\nconst _uriTransformerCache: { [remoteAuthority: string]: IURITransformer } = Object.create(null);\n\nfunction getUriTransformer(remoteAuthority: string): IURITransformer {\n\tif (!_uriTransformerCache[remoteAuthority]) {\n\t\t_uriTransformerCache[remoteAuthority] = createURITransformer(remoteAuthority);\n\t}\n\treturn _uriTransformerCache[remoteAuthority];\n}\n\nexport class SocketServer<TContext = string> extends IPCServer<TContext> {\n\n\tprivate _onDidConnectEmitter: Emitter<ClientConnectionEvent>;\n\n\tconstructor() {\n\t\tconst emitter = new Emitter<ClientConnectionEvent>();\n\t\tsuper(emitter.event);\n\t\tthis._onDidConnectEmitter = emitter;\n\t}\n\n\tpublic acceptConnection(protocol: IMessagePassingProtocol, onDidClientDisconnect: Event<void>): void {\n\t\tthis._onDidConnectEmitter.fire({ protocol, onDidClientDisconnect });\n\t}\n}\n\nclass ServerLogger extends AbstractLogger {\n\tprivate useColors: boolean;\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t\tthis.useColors = Boolean(process.stdout.isTTY);\n\t}\n\n\ttrace(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Trace)) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Debug)) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Info)) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Warning)) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.warn(`\\x1b[93m[${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.warn(`[${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\terror(message: string, ...args: unknown[]): void {\n\t\tif (this.canLog(LogLevel.Error)) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.error(`\\x1b[91m[${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.error(`[${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tflush(): void {\n\t\t// noop\n\t}\n}\n\nfunction now(): string {\n\tconst date = new Date();\n\treturn `${twodigits(date.getHours())}:${twodigits(date.getMinutes())}:${twodigits(date.getSeconds())}`;\n}\n\nfunction twodigits(n: number): string {\n\tif (n < 10) {\n\t\treturn `0${n}`;\n\t}\n\treturn String(n);\n}\n\n/**\n * Cleans up older logs, while keeping the 10 most recent ones.\n */\nasync function cleanupOlderLogs(logsPath: string): Promise<void> {\n\tconst currentLog = path.basename(logsPath);\n\tconst logsRoot = path.dirname(logsPath);\n\tconst children = await Promises.readdir(logsRoot);\n\tconst allSessions = children.filter(name => /^\\d{8}T\\d{6}$/.test(name));\n\tconst oldSessions = allSessions.sort().filter((d) => d !== currentLog);\n\tconst toDelete = oldSessions.slice(0, Math.max(0, oldSessions.length - 9));\n\n\tawait Promise.all(toDelete.map(name => Promises.rm(path.join(logsRoot, name))));\n}\n"]}