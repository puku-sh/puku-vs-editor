{"version":3,"sources":["file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src/vs/amdX.ts","vs/amdX.ts"],"names":[],"mappings":"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","file":"amdX.js","sourceRoot":"file:///Users/sahamed/Desktop/puku-vs-editor/puku-editor/github/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AppResourcePath, FileAccess, nodeModulesAsarPath, nodeModulesPath, Schemas, VSCODE_AUTHORITY } from './base/common/network.js';\nimport * as platform from './base/common/platform.js';\nimport { IProductConfiguration } from './base/common/product.js';\nimport { URI } from './base/common/uri.js';\nimport { generateUuid } from './base/common/uuid.js';\n\nexport const canASAR = false; // TODO@esm: ASAR disabled in ESM\n\ndeclare const window: any;\ndeclare const document: any;\ndeclare const self: any;\ndeclare const globalThis: any;\n\nclass DefineCall {\n\tconstructor(\n\t\tpublic readonly id: string | null | undefined,\n\t\tpublic readonly dependencies: string[] | null | undefined,\n\t\tpublic readonly callback: any\n\t) { }\n}\n\nenum AMDModuleImporterState {\n\tUninitialized = 1,\n\tInitializedInternal,\n\tInitializedExternal\n}\n\nclass AMDModuleImporter {\n\tpublic static INSTANCE = new AMDModuleImporter();\n\n\tprivate readonly _isWebWorker = (typeof self === 'object' && self.constructor && self.constructor.name === 'DedicatedWorkerGlobalScope');\n\tprivate readonly _isRenderer = typeof document === 'object';\n\n\tprivate readonly _defineCalls: DefineCall[] = [];\n\tprivate _state = AMDModuleImporterState.Uninitialized;\n\tprivate _amdPolicy: Pick<TrustedTypePolicy, 'name' | 'createScriptURL'> | undefined;\n\n\tconstructor() { }\n\n\tprivate _initialize(): void {\n\t\tif (this._state === AMDModuleImporterState.Uninitialized) {\n\t\t\tif (globalThis.define) {\n\t\t\t\tthis._state = AMDModuleImporterState.InitializedExternal;\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._state = AMDModuleImporterState.InitializedInternal;\n\n\t\tglobalThis.define = (id: any, dependencies: any, callback: any) => {\n\t\t\tif (typeof id !== 'string') {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = id;\n\t\t\t\tid = null;\n\t\t\t}\n\t\t\tif (typeof dependencies !== 'object' || !Array.isArray(dependencies)) {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = null;\n\t\t\t}\n\t\t\t// if (!dependencies) {\n\t\t\t// \tdependencies = ['require', 'exports', 'module'];\n\t\t\t// }\n\t\t\tthis._defineCalls.push(new DefineCall(id, dependencies, callback));\n\t\t};\n\n\t\tglobalThis.define.amd = true;\n\n\t\tif (this._isRenderer) {\n\t\t\tthis._amdPolicy = globalThis._VSCODE_WEB_PACKAGE_TTP ?? window.trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value: any) {\n\t\t\t\t\tif (value.startsWith(window.location.origin)) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tif (value.startsWith(`${Schemas.vscodeFileResource}://${VSCODE_AUTHORITY}`)) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tthrow new Error(`[trusted_script_src] Invalid script url: ${value}`);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (this._isWebWorker) {\n\t\t\tthis._amdPolicy = globalThis._VSCODE_WEB_PACKAGE_TTP ?? globalThis.trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value: string) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic async load<T>(scriptSrc: string): Promise<T> {\n\t\tthis._initialize();\n\n\t\tif (this._state === AMDModuleImporterState.InitializedExternal) {\n\t\t\treturn new Promise<T>(resolve => {\n\t\t\t\tconst tmpModuleId = generateUuid();\n\t\t\t\tglobalThis.define(tmpModuleId, [scriptSrc], function (moduleResult: T) {\n\t\t\t\t\tresolve(moduleResult);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tconst defineCall = await (this._isWebWorker ? this._workerLoadScript(scriptSrc) : this._isRenderer ? this._rendererLoadScript(scriptSrc) : this._nodeJSLoadScript(scriptSrc));\n\t\tif (!defineCall) {\n\t\t\tconsole.warn(`Did not receive a define call from script ${scriptSrc}`);\n\t\t\treturn <T>undefined;\n\t\t}\n\t\t// TODO@esm require, module\n\t\tconst exports = {};\n\t\tconst dependencyObjs: any[] = [];\n\t\tconst dependencyModules: string[] = [];\n\n\t\tif (Array.isArray(defineCall.dependencies)) {\n\n\t\t\tfor (const mod of defineCall.dependencies) {\n\t\t\t\tif (mod === 'exports') {\n\t\t\t\t\tdependencyObjs.push(exports);\n\t\t\t\t} else {\n\t\t\t\t\tdependencyModules.push(mod);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (dependencyModules.length > 0) {\n\t\t\tthrow new Error(`Cannot resolve dependencies for script ${scriptSrc}. The dependencies are: ${dependencyModules.join(', ')}`);\n\t\t}\n\t\tif (typeof defineCall.callback === 'function') {\n\t\t\treturn defineCall.callback(...dependencyObjs) ?? exports;\n\t\t} else {\n\t\t\treturn defineCall.callback;\n\t\t}\n\t}\n\n\tprivate _rendererLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\treturn new Promise<DefineCall | undefined>((resolve, reject) => {\n\t\t\tconst scriptElement = document.createElement('script');\n\t\t\tscriptElement.setAttribute('async', 'async');\n\t\t\tscriptElement.setAttribute('type', 'text/javascript');\n\n\t\t\tconst unbind = () => {\n\t\t\t\tscriptElement.removeEventListener('load', loadEventListener);\n\t\t\t\tscriptElement.removeEventListener('error', errorEventListener);\n\t\t\t};\n\n\t\t\tconst loadEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\tresolve(this._defineCalls.pop());\n\t\t\t};\n\n\t\t\tconst errorEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\treject(e);\n\t\t\t};\n\n\t\t\tscriptElement.addEventListener('load', loadEventListener);\n\t\t\tscriptElement.addEventListener('error', errorEventListener);\n\t\t\tif (this._amdPolicy) {\n\t\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as unknown as string;\n\t\t\t}\n\t\t\tscriptElement.setAttribute('src', scriptSrc);\n\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(scriptElement);\n\t\t});\n\t}\n\n\tprivate async _workerLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\tif (this._amdPolicy) {\n\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as unknown as string;\n\t\t}\n\t\tawait import(scriptSrc);\n\t\treturn this._defineCalls.pop();\n\t}\n\n\tprivate async _nodeJSLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\ttry {\n\t\t\tconst fs = (await import(`${'fs'}`)).default;\n\t\t\tconst vm = (await import(`${'vm'}`)).default;\n\t\t\tconst module = (await import(`${'module'}`)).default;\n\n\t\t\tconst filePath = URI.parse(scriptSrc).fsPath;\n\t\t\tconst content = fs.readFileSync(filePath).toString();\n\t\t\tconst scriptSource = module.wrap(content.replace(/^#!.*/, ''));\n\t\t\tconst script = new vm.Script(scriptSource);\n\t\t\tconst compileWrapper = script.runInThisContext();\n\t\t\tcompileWrapper.apply();\n\t\t\treturn this._defineCalls.pop();\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nconst cache = new Map<string, Promise<any>>();\n\n/**\n * Utility for importing an AMD node module. This util supports AMD and ESM contexts and should be used while the ESM adoption\n * is on its way.\n *\n * e.g. pass in `vscode-textmate/release/main.js`\n */\nexport async function importAMDNodeModule<T>(nodeModuleName: string, pathInsideNodeModule: string, isBuilt?: boolean): Promise<T> {\n\tif (isBuilt === undefined) {\n\t\tconst product = globalThis._VSCODE_PRODUCT_JSON as unknown as IProductConfiguration;\n\t\tisBuilt = Boolean((product ?? globalThis.vscode?.context?.configuration()?.product)?.commit);\n\t}\n\n\tconst nodeModulePath = pathInsideNodeModule ? `${nodeModuleName}/${pathInsideNodeModule}` : nodeModuleName;\n\tif (cache.has(nodeModulePath)) {\n\t\treturn cache.get(nodeModulePath)!;\n\t}\n\tlet scriptSrc: string;\n\tif (/^\\w[\\w\\d+.-]*:\\/\\//.test(nodeModulePath)) {\n\t\t// looks like a URL\n\t\t// bit of a special case for: src/vs/workbench/services/languageDetection/browser/languageDetectionWebWorker.ts\n\t\tscriptSrc = nodeModulePath;\n\t} else {\n\t\tconst useASAR = (canASAR && isBuilt && !platform.isWeb);\n\t\tconst actualNodeModulesPath = (useASAR ? nodeModulesAsarPath : nodeModulesPath);\n\t\tconst resourcePath: AppResourcePath = `${actualNodeModulesPath}/${nodeModulePath}`;\n\t\tscriptSrc = FileAccess.asBrowserUri(resourcePath).toString(true);\n\t}\n\tconst result = AMDModuleImporter.INSTANCE.load<T>(scriptSrc);\n\tcache.set(nodeModulePath, result);\n\treturn result;\n}\n\nexport function resolveAmdNodeModulePath(nodeModuleName: string, pathInsideNodeModule: string): string {\n\tconst product = globalThis._VSCODE_PRODUCT_JSON as unknown as IProductConfiguration;\n\tconst isBuilt = Boolean((product ?? globalThis.vscode?.context?.configuration()?.product)?.commit);\n\tconst useASAR = (canASAR && isBuilt && !platform.isWeb);\n\n\tconst nodeModulePath = `${nodeModuleName}/${pathInsideNodeModule}`;\n\tconst actualNodeModulesPath = (useASAR ? nodeModulesAsarPath : nodeModulesPath);\n\tconst resourcePath: AppResourcePath = `${actualNodeModulesPath}/${nodeModulePath}`;\n\treturn FileAccess.asBrowserUri(resourcePath).toString(true);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AppResourcePath, FileAccess, nodeModulesAsarPath, nodeModulesPath, Schemas, VSCODE_AUTHORITY } from './base/common/network.js';\nimport * as platform from './base/common/platform.js';\nimport { IProductConfiguration } from './base/common/product.js';\nimport { URI } from './base/common/uri.js';\nimport { generateUuid } from './base/common/uuid.js';\n\nexport const canASAR = false; // TODO@esm: ASAR disabled in ESM\n\ndeclare const window: any;\ndeclare const document: any;\ndeclare const self: any;\ndeclare const globalThis: any;\n\nclass DefineCall {\n\tconstructor(\n\t\tpublic readonly id: string | null | undefined,\n\t\tpublic readonly dependencies: string[] | null | undefined,\n\t\tpublic readonly callback: any\n\t) { }\n}\n\nenum AMDModuleImporterState {\n\tUninitialized = 1,\n\tInitializedInternal,\n\tInitializedExternal\n}\n\nclass AMDModuleImporter {\n\tpublic static INSTANCE = new AMDModuleImporter();\n\n\tprivate readonly _isWebWorker = (typeof self === 'object' && self.constructor && self.constructor.name === 'DedicatedWorkerGlobalScope');\n\tprivate readonly _isRenderer = typeof document === 'object';\n\n\tprivate readonly _defineCalls: DefineCall[] = [];\n\tprivate _state = AMDModuleImporterState.Uninitialized;\n\tprivate _amdPolicy: Pick<TrustedTypePolicy, 'name' | 'createScriptURL'> | undefined;\n\n\tconstructor() { }\n\n\tprivate _initialize(): void {\n\t\tif (this._state === AMDModuleImporterState.Uninitialized) {\n\t\t\tif (globalThis.define) {\n\t\t\t\tthis._state = AMDModuleImporterState.InitializedExternal;\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._state = AMDModuleImporterState.InitializedInternal;\n\n\t\tglobalThis.define = (id: any, dependencies: any, callback: any) => {\n\t\t\tif (typeof id !== 'string') {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = id;\n\t\t\t\tid = null;\n\t\t\t}\n\t\t\tif (typeof dependencies !== 'object' || !Array.isArray(dependencies)) {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = null;\n\t\t\t}\n\t\t\t// if (!dependencies) {\n\t\t\t// \tdependencies = ['require', 'exports', 'module'];\n\t\t\t// }\n\t\t\tthis._defineCalls.push(new DefineCall(id, dependencies, callback));\n\t\t};\n\n\t\tglobalThis.define.amd = true;\n\n\t\tif (this._isRenderer) {\n\t\t\tthis._amdPolicy = globalThis._VSCODE_WEB_PACKAGE_TTP ?? window.trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value: any) {\n\t\t\t\t\tif (value.startsWith(window.location.origin)) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tif (value.startsWith(`${Schemas.vscodeFileResource}://${VSCODE_AUTHORITY}`)) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tthrow new Error(`[trusted_script_src] Invalid script url: ${value}`);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (this._isWebWorker) {\n\t\t\tthis._amdPolicy = globalThis._VSCODE_WEB_PACKAGE_TTP ?? globalThis.trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value: string) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic async load<T>(scriptSrc: string): Promise<T> {\n\t\tthis._initialize();\n\n\t\tif (this._state === AMDModuleImporterState.InitializedExternal) {\n\t\t\treturn new Promise<T>(resolve => {\n\t\t\t\tconst tmpModuleId = generateUuid();\n\t\t\t\tglobalThis.define(tmpModuleId, [scriptSrc], function (moduleResult: T) {\n\t\t\t\t\tresolve(moduleResult);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tconst defineCall = await (this._isWebWorker ? this._workerLoadScript(scriptSrc) : this._isRenderer ? this._rendererLoadScript(scriptSrc) : this._nodeJSLoadScript(scriptSrc));\n\t\tif (!defineCall) {\n\t\t\tconsole.warn(`Did not receive a define call from script ${scriptSrc}`);\n\t\t\treturn <T>undefined;\n\t\t}\n\t\t// TODO@esm require, module\n\t\tconst exports = {};\n\t\tconst dependencyObjs: any[] = [];\n\t\tconst dependencyModules: string[] = [];\n\n\t\tif (Array.isArray(defineCall.dependencies)) {\n\n\t\t\tfor (const mod of defineCall.dependencies) {\n\t\t\t\tif (mod === 'exports') {\n\t\t\t\t\tdependencyObjs.push(exports);\n\t\t\t\t} else {\n\t\t\t\t\tdependencyModules.push(mod);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (dependencyModules.length > 0) {\n\t\t\tthrow new Error(`Cannot resolve dependencies for script ${scriptSrc}. The dependencies are: ${dependencyModules.join(', ')}`);\n\t\t}\n\t\tif (typeof defineCall.callback === 'function') {\n\t\t\treturn defineCall.callback(...dependencyObjs) ?? exports;\n\t\t} else {\n\t\t\treturn defineCall.callback;\n\t\t}\n\t}\n\n\tprivate _rendererLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\treturn new Promise<DefineCall | undefined>((resolve, reject) => {\n\t\t\tconst scriptElement = document.createElement('script');\n\t\t\tscriptElement.setAttribute('async', 'async');\n\t\t\tscriptElement.setAttribute('type', 'text/javascript');\n\n\t\t\tconst unbind = () => {\n\t\t\t\tscriptElement.removeEventListener('load', loadEventListener);\n\t\t\t\tscriptElement.removeEventListener('error', errorEventListener);\n\t\t\t};\n\n\t\t\tconst loadEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\tresolve(this._defineCalls.pop());\n\t\t\t};\n\n\t\t\tconst errorEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\treject(e);\n\t\t\t};\n\n\t\t\tscriptElement.addEventListener('load', loadEventListener);\n\t\t\tscriptElement.addEventListener('error', errorEventListener);\n\t\t\tif (this._amdPolicy) {\n\t\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as unknown as string;\n\t\t\t}\n\t\t\tscriptElement.setAttribute('src', scriptSrc);\n\t\t\twindow.document.getElementsByTagName('head')[0].appendChild(scriptElement);\n\t\t});\n\t}\n\n\tprivate async _workerLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\tif (this._amdPolicy) {\n\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as unknown as string;\n\t\t}\n\t\tawait import(scriptSrc);\n\t\treturn this._defineCalls.pop();\n\t}\n\n\tprivate async _nodeJSLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\ttry {\n\t\t\tconst fs = (await import(`${'fs'}`)).default;\n\t\t\tconst vm = (await import(`${'vm'}`)).default;\n\t\t\tconst module = (await import(`${'module'}`)).default;\n\n\t\t\tconst filePath = URI.parse(scriptSrc).fsPath;\n\t\t\tconst content = fs.readFileSync(filePath).toString();\n\t\t\tconst scriptSource = module.wrap(content.replace(/^#!.*/, ''));\n\t\t\tconst script = new vm.Script(scriptSource);\n\t\t\tconst compileWrapper = script.runInThisContext();\n\t\t\tcompileWrapper.apply();\n\t\t\treturn this._defineCalls.pop();\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nconst cache = new Map<string, Promise<any>>();\n\n/**\n * Utility for importing an AMD node module. This util supports AMD and ESM contexts and should be used while the ESM adoption\n * is on its way.\n *\n * e.g. pass in `vscode-textmate/release/main.js`\n */\nexport async function importAMDNodeModule<T>(nodeModuleName: string, pathInsideNodeModule: string, isBuilt?: boolean): Promise<T> {\n\tif (isBuilt === undefined) {\n\t\tconst product = globalThis._VSCODE_PRODUCT_JSON as unknown as IProductConfiguration;\n\t\tisBuilt = Boolean((product ?? globalThis.vscode?.context?.configuration()?.product)?.commit);\n\t}\n\n\tconst nodeModulePath = pathInsideNodeModule ? `${nodeModuleName}/${pathInsideNodeModule}` : nodeModuleName;\n\tif (cache.has(nodeModulePath)) {\n\t\treturn cache.get(nodeModulePath)!;\n\t}\n\tlet scriptSrc: string;\n\tif (/^\\w[\\w\\d+.-]*:\\/\\//.test(nodeModulePath)) {\n\t\t// looks like a URL\n\t\t// bit of a special case for: src/vs/workbench/services/languageDetection/browser/languageDetectionWebWorker.ts\n\t\tscriptSrc = nodeModulePath;\n\t} else {\n\t\tconst useASAR = (canASAR && isBuilt && !platform.isWeb);\n\t\tconst actualNodeModulesPath = (useASAR ? nodeModulesAsarPath : nodeModulesPath);\n\t\tconst resourcePath: AppResourcePath = `${actualNodeModulesPath}/${nodeModulePath}`;\n\t\tscriptSrc = FileAccess.asBrowserUri(resourcePath).toString(true);\n\t}\n\tconst result = AMDModuleImporter.INSTANCE.load<T>(scriptSrc);\n\tcache.set(nodeModulePath, result);\n\treturn result;\n}\n\nexport function resolveAmdNodeModulePath(nodeModuleName: string, pathInsideNodeModule: string): string {\n\tconst product = globalThis._VSCODE_PRODUCT_JSON as unknown as IProductConfiguration;\n\tconst isBuilt = Boolean((product ?? globalThis.vscode?.context?.configuration()?.product)?.commit);\n\tconst useASAR = (canASAR && isBuilt && !platform.isWeb);\n\n\tconst nodeModulePath = `${nodeModuleName}/${pathInsideNodeModule}`;\n\tconst actualNodeModulesPath = (useASAR ? nodeModulesAsarPath : nodeModulesPath);\n\tconst resourcePath: AppResourcePath = `${actualNodeModulesPath}/${nodeModulePath}`;\n\treturn FileAccess.asBrowserUri(resourcePath).toString(true);\n}\n"]}